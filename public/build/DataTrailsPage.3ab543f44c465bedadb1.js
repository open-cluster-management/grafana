"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[4785],{89858:(W,C,s)=>{s.r(C),s.d(C,{DataTrailsPage:()=>z,default:()=>K});var t=s(74848),p=s(96540),f=s(24180),k=s(64388),F=s(39601),m=s(80943),N=s(69444),i=s(32196),A=s(40845),g=s(67061),M=s(55852),B=s(94753),U=s(72724),v=s(10860),V=s(78369),$=s(29158),l=s(74764),y=s(4200),c=s(51080);function L(e){const{onSelect:a,onDelete:o,bookmark:r}=e,n=(0,A.of)(E),T=(0,p.useMemo)(()=>{let x=e.trail||r&&(0,l._r)().getTrailForBookmark(r);if(!x)return null;const H=m.jh.lookupVariable(y.Ao,x);if(!(H instanceof m.H9))return null;const Q=r?.createdAt||x.state.createdAt;return{dsValue:(0,c.U4)(x),filters:H.state.filters,metric:x.state.metric,createdAt:Q}},[e.trail,r]);if(!T)return null;const{dsValue:d,filters:h,metric:u,createdAt:I}=T;return(0,t.jsxs)(v.Z,{onClick:a,className:n.card,children:[(0,t.jsx)(v.Z.Heading,{children:(0,c.aO)(u)}),(0,t.jsx)("div",{className:n.description,children:(0,t.jsx)(g.B,{gap:1.5,wrap:"wrap",children:h.map(x=>(0,t.jsx)(V.v,{name:`${x.key}: ${x.value}`,colorIndex:12},x.key))})}),(0,t.jsx)(v.Z.Actions,{className:n.actions,children:(0,t.jsxs)(g.B,{gap:1,justifyContent:"space-between",grow:1,children:[(0,t.jsxs)("div",{className:n.secondary,children:[(0,t.jsx)("b",{children:"Datasource:"})," ",(0,c.nH)(d)]}),I&&(0,t.jsxs)("i",{className:n.secondary,children:[(0,t.jsx)("b",{children:"Created:"})," ",(0,U.LE)(I,{format:"LL"})]})]})}),o&&(0,t.jsx)(v.Z.SecondaryActions,{children:(0,t.jsx)($.K,{name:"trash-alt",className:n.secondary,tooltip:"Remove bookmark",onClick:o},"delete")})]})}function E(e){return{tag:(0,i.css)({maxWidth:"260px",overflow:"hidden",textOverflow:"ellipsis"}),card:(0,i.css)({padding:e.spacing(1)}),secondary:(0,i.css)({color:e.colors.text.secondary,fontSize:"12px"}),description:(0,i.css)({width:"100%",gridArea:"Description",margin:e.spacing(1,0,0),color:e.colors.text.secondary,lineHeight:e.typography.body.lineHeight}),actions:(0,i.css)({marginRight:e.spacing(1)})}}var j=s(40588);class O extends m.Bs{constructor(a){super(a),this.onNewMetricsTrail=()=>{const o=S(this),r=(0,c.ef)((0,c.hR)());(0,j.z)("exploration_started",{cause:"new_clicked"}),(0,l._r)().setRecentTrail(r),o.goToUrlForTrail(r)},this.onSelectRecentTrail=o=>{const r=S(this);(0,j.z)("exploration_started",{cause:"recent_clicked"}),(0,l._r)().setRecentTrail(o),r.goToUrlForTrail(o)},this.onSelectBookmark=o=>{const r=S(this);(0,j.z)("exploration_started",{cause:"bookmark_clicked"});const n=(0,l._r)().getTrailForBookmarkIndex(o);(0,l._r)().setRecentTrail(n),r.goToUrlForTrail(n)}}static{this.Component=({model:a})=>{const[o,r]=(0,p.useState)(Date.now()),n=(0,A.of)(P),T=d=>{(0,l._r)().removeBookmark(d),(0,j.z)("bookmark_changed",{action:"deleted"}),r(Date.now())};if(!(0,l._r)().recent.length){const d=(0,c.ef)((0,c.hR)());return(0,t.jsx)(f.rd,{to:(0,c.xi)(d)})}return(0,t.jsxs)("div",{className:n.container,children:[(0,t.jsx)(g.B,{direction:"column",gap:1,alignItems:"start",children:(0,t.jsx)(M.$n,{icon:"plus",size:"md",variant:"primary",onClick:a.onNewMetricsTrail,children:"New metric exploration"})}),(0,t.jsxs)(g.B,{gap:5,children:[(0,t.jsxs)("div",{className:n.column,children:[(0,t.jsx)(B.E,{variant:"h4",children:"Recent metrics explorations"}),(0,t.jsx)("div",{className:n.trailList,children:(0,l._r)().recent.map((d,h)=>{const u=d.resolve();return(0,t.jsx)(L,{trail:u,onSelect:()=>a.onSelectRecentTrail(u)},(u.state.key||"")+h)})})]}),(0,t.jsx)("div",{className:n.verticalLine}),(0,t.jsxs)("div",{className:n.column,children:[(0,t.jsx)(B.E,{variant:"h4",children:"Bookmarks"}),(0,t.jsx)("div",{className:n.trailList,children:(0,l._r)().bookmarks.map((d,h)=>(0,t.jsx)(L,{bookmark:d,onSelect:()=>a.onSelectBookmark(h),onDelete:()=>T(h)},(0,l.yn)(d)))})]})]})]})}}}function S(e){return m.jh.getAncestor(e,R)}function P(e){return{container:(0,i.css)({flexGrow:1,display:"flex",flexDirection:"column",gap:e.spacing(3)}),column:(0,i.css)({display:"flex",flexGrow:1,flexDirection:"column",gap:e.spacing(2)}),newTrail:(0,i.css)({height:"auto",justifyContent:"center",fontSize:e.typography.h5.fontSize}),trailCard:(0,i.css)({}),trailList:(0,i.css)({display:"flex",flexDirection:"column",gap:e.spacing(2)}),verticalLine:(0,i.css)({borderLeft:`1px solid ${e.colors.border.weak}`})}}var Z=s(90623);class R extends m.Bs{constructor(a){super(a)}goToUrlForTrail(a){F.Ny.push((0,c.xi)(a)),this.setState({trail:a})}static{this.Component=({model:a})=>{const{trail:o,home:r}=a.useState();return(0,t.jsxs)(f.dO,{children:[(0,t.jsx)(f.qh,{exact:!0,path:y.QX,render:()=>(0,t.jsx)(N.Y,{navId:"explore/metrics",layout:k.k.Standard,renderTitle:()=>(0,t.jsx)(Z.p,{}),subTitle:"",children:(0,t.jsx)(r.Component,{model:r})})}),(0,t.jsx)(f.qh,{exact:!0,path:y.km,render:()=>(0,t.jsx)(G,{trail:o})})]})}}}function G({trail:e}){const[a,o]=(0,p.useState)(!1),{metric:r}=e.useState();return(0,p.useEffect)(()=>{a||((0,l._r)().setRecentTrail(e),o(!0))},[e,a]),a?(0,t.jsx)(m.$L,{scene:e,children:(0,t.jsx)(N.Y,{navId:"explore/metrics",pageNav:{text:(0,c.aO)(r)},layout:k.k.Custom,children:(0,t.jsx)(e.Component,{model:e})})}):null}let D;function Y(){return D||(D=new R({trail:(0,c.ef)(),home:new O({})})),D}function z(){const e=Y();return(0,t.jsx)(e.Component,{model:e})}const K=z}}]);

//# sourceMappingURL=DataTrailsPage.3ab543f44c465bedadb1.js.map