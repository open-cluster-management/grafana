"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[2154],{72557:(te,$,a)=>{a.d($,{A:()=>i});var e=a(74848),g=a(96540),u=a(14186),h=a(67647),p=a(55852),y=a(73725);class i extends g.PureComponent{render(){const{searchQuery:P,linkButton:m,setSearchQuery:G,target:O,placeholder:M="Search by name or type",sortPicker:F}=this.props,T={href:m?.href,disabled:m?.disabled};return O&&(T.target=O),(0,e.jsxs)("div",{className:"page-action-bar",children:[(0,e.jsx)(u.I,{grow:!0,children:(0,e.jsx)(h.Z,{value:P,onChange:G,placeholder:M})}),F&&(0,e.jsx)(y.r,{onChange:F.onChange,value:F.value,getSortOptions:F.getSortOptions}),m&&(0,e.jsx)(p.z9,{...T,children:m.title})]})}}},19514:(te,$,a)=>{a.r($),a.d($,{default:()=>ts});var e=a(74848),g=a(24180),u=a(85464),h=a(31678),p=a(6320),y=a(69444),i=a(32196),N=a(96540),P=a(43429),m=a(40845),G=a(39558),O=a(69529),M=a(10096),F=a(83277),T=a(8484),De=a(31036),W=a(83391),Ce=a(71259),f=a(10860),Ne=a(50691);const be=t=>({heading:(0,i.css)({fontSize:t.typography.h5.fontSize,fontWeight:"inherit"}),figure:(0,i.css)({width:"inherit",marginRight:"0px","> img":{width:t.spacing(7)}}),meta:(0,i.css)({marginTop:"6px",position:"relative"}),description:(0,i.css)({margin:"0px",fontSize:t.typography.bodySmall.fontSize}),card:(0,i.css)({gridTemplateAreas:`
        "Figure   Heading   Actions"
        "Figure Description Actions"
        "Figure    Meta     Actions"
        "Figure     -       Actions"`}),logo:(0,i.css)({marginRight:t.spacing(3),marginLeft:t.spacing(1),width:t.spacing(7),maxHeight:t.spacing(7)})}),Pe=({items:t,onClickItem:s})=>{const n=(0,m.of)(be);return(0,e.jsx)(Ce.x,{gap:1.5,minColumnWidth:44,children:t.map(o=>(0,e.jsxs)(f.Z,{className:n.card,href:o.url,onClick:r=>{s&&s(r,o)},children:[(0,e.jsx)(f.Z.Heading,{className:n.heading,children:o.name}),(0,e.jsx)(f.Z.Figure,{align:"center",className:n.figure,children:(0,e.jsx)("img",{className:n.logo,src:o.logo,alt:""})}),o.angularDetected?(0,e.jsx)(f.Z.Meta,{className:n.meta,children:(0,e.jsx)(Ne.fk,{})}):null]},o.id))})};var K=a(14578);const Te=t=>({categoryHeader:(0,i.css)`
    align-items: center;
    display: flex;
    margin-bottom: 24px;
  `,categoryLabel:(0,i.css)`
    margin-bottom: 0px;
    margin-left: 8px;
  `}),Ae=({iconName:t,label:s})=>{const n=(0,m.of)(Te);return(0,e.jsxs)("div",{className:n.categoryHeader,children:[(0,e.jsx)(K.I,{name:t,size:"xl"}),(0,e.jsx)("h3",{className:n.categoryLabel,children:s})]})};var Ee=a(37390),j=a(55852);const se=t=>({modal:(0,i.css)`
    width: 500px;
  `,modalContent:(0,i.css)`
    overflow: visible;
    color: ${t.colors.text.secondary};

    a {
      color: ${t.colors.text.link};
    }
  `,description:(0,i.css)`
    margin-bottom: ${t.spacing(2)};
  `,bottomSection:(0,i.css)`
    display: flex;
    border-top: 1px solid ${t.colors.border.weak};
    padding-top: ${t.spacing(3)};
    margin-top: ${t.spacing(3)};
  `,actionsSection:(0,i.css)`
    display: flex;
    justify-content: end;
    margin-top: ${t.spacing(3)};
  `,warningIcon:(0,i.css)`
    color: ${t.colors.warning.main};
    padding-right: ${t.spacing()};
    margin-top: ${t.spacing(.25)};
  `,header:(0,i.css)`
    display: flex;
    align-items: center;
  `,headerTitle:(0,i.css)`
    margin: 0;
  `,headerLogo:(0,i.css)`
    margin-right: ${t.spacing(2)};
    width: 32px;
    height: 32px;
  `});function Ie({item:t,isOpen:s,onDismiss:n}){const o=(0,m.of)(se);return(0,e.jsx)(Ee.a,{className:o.modal,contentClassName:o.modalContent,title:(0,e.jsx)(Me,{item:t}),isOpen:s,onDismiss:n,children:(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{children:[t.description&&(0,e.jsx)("div",{className:o.description,children:t.description}),(0,e.jsxs)("div",{children:["Links",(0,e.jsx)("br",{}),(0,e.jsx)("a",{href:`https://grafana.com/grafana/plugins/${t.id}`,title:`${t.name} on Grafana.com`,target:"_blank",rel:"noopener noreferrer",children:t.name})]})]}),(0,e.jsxs)("div",{className:o.bottomSection,children:[(0,e.jsx)("div",{className:o.warningIcon,children:(0,e.jsx)(K.I,{name:"exclamation-triangle"})}),(0,e.jsxs)("div",{children:[(0,e.jsxs)("p",{children:["Editors cannot add new connections. You may check to see if it is already configured in"," ",(0,e.jsx)("a",{href:"/connections/datasources",children:"Data sources"}),"."]}),(0,e.jsx)("p",{children:"To add a new connection, contact your Grafana admin."})]})]}),(0,e.jsx)("div",{className:o.actionsSection,children:(0,e.jsx)(j.$n,{onClick:n,children:"Okay"})})]})})}function Me({item:t}){const s=(0,m.of)(se);return(0,e.jsx)("div",{children:(0,e.jsxs)("div",{className:s.header,children:[t.logo&&(0,e.jsx)("img",{className:s.headerLogo,src:t.logo,alt:`logo of ${t.name}`}),(0,e.jsx)("h4",{className:s.headerTitle,children:t.name})]})})}var Le=a(23172),L=a(32264),ne=a(10354);const Be=(t,s)=>({searchContainer:(0,i.css)({display:"flex",justifyContent:"space-between",position:"sticky",top:s,backgroundColor:t.colors.background.primary,zIndex:2,padding:t.spacing(2,0)})}),we=(0,T.t)("connections.search.placeholder","Search all"),Re=({onChange:t,value:s})=>{const n=(0,Le.k)(),o=(0,m.of)(Be,L.$.featureToggles.bodyScrolling?n??0:0);return(0,e.jsx)("div",{className:o.searchContainer,children:(0,e.jsx)(ne.p,{value:s,onChange:t,prefix:(0,e.jsx)(K.I,{name:"search"}),placeholder:we,"aria-label":"Search all"})})},$e=t=>({spacer:(0,i.css)({height:t.spacing(2)}),modal:(0,i.css)({width:"500px"}),modalContent:(0,i.css)({overflow:"visible"})});function Oe(){const[t,s]=(0,F.s)(),n=t.search?String(t.search):"",[o,r]=(0,N.useState)(!1),[l,c]=(0,N.useState)(null),d=(0,m.of)($e),v=M.TP.hasPermission(h.AccessControlAction.DataSourcesCreate),A=x=>{s({search:x.currentTarget.value.toLowerCase()})},{error:S,plugins:C,isLoading:E}=(0,W.PW)({keyword:n,type:P.QE.datasource}),R=(0,N.useMemo)(()=>C.map(x=>({id:x.id,name:x.name,description:x.description,logo:x.info.logos.small,url:p.b.DataSourcesDetails.replace(":id",x.id),angularDetected:x.angularDetected})),[C]),b=(x,H)=>{v||(x.preventDefault(),x.stopPropagation(),k(H))},k=x=>{r(!0),c(x)},B=()=>{r(!1),c(null)},I=(0,N.useMemo)(()=>!E&&!S&&C.length<1,[E,S,C]),Y=(0,T.t)("connections.connect-data.category-header-label","Data sources");return(0,e.jsxs)(e.Fragment,{children:[l&&(0,e.jsx)(Ie,{item:l,isOpen:o,onDismiss:B}),(0,e.jsx)(Re,{onChange:A,value:n}),(0,e.jsx)("div",{className:d.spacer}),(0,e.jsx)(Ae,{iconName:"database",label:Y}),E?(0,e.jsx)(G._,{text:"Loading..."}):S?(0,e.jsxs)("p",{children:["Error: ",S.message]}):(0,e.jsx)(Pe,{items:R,onClickItem:b}),I&&(0,e.jsx)(O.p,{variant:"not-found",message:(0,T.t)("connections.connect-data.empty-message","No results matching your query were found")}),(0,e.jsx)(De.E,{})]})}function Fe(){return(0,e.jsx)(y.Y,{navId:"connections-add-new-connection",children:(0,e.jsx)(y.Y.Contents,{children:(0,e.jsx)(Oe,{})})})}var z=a(42418),ae=a(39938),ze=a(93418);function ke(){const t="standalone-plugin-page-/connections/add-new-connection",{id:s}=(0,g.g)(),r=!!(0,h.useSelector)(l=>l.navIndex)[t]?t:"connections-add-new-connection";return(0,e.jsx)(ze.V,{pluginId:s,navId:r,notFoundComponent:(0,e.jsx)(Ue,{}),notFoundNavModel:{text:"Unknown datasource",subTitle:"No datasource with this ID could be found.",active:!0}})}function Ue(){const{id:t}=(0,g.g)();return(0,e.jsxs)(z.F,{severity:h.AppNotificationSeverity.Warning,title:"",children:["Maybe you mistyped the URL or the plugin with the id ",(0,e.jsx)(ae.E,{text:t,color:"orange"})," is unavailable.",(0,e.jsx)("br",{}),"To see a list of available datasources please ",(0,e.jsx)("a",{href:p.b.AddNewConnection,children:"click here"}),"."]})}function Ze(){const t=M.TP.hasPermission(h.AccessControlAction.DataSourcesCreate),s=(0,u.aM)();return t?(0,e.jsx)(j.z9,{icon:"plus",href:L.$.appSubUrl+s.New,children:(0,e.jsx)(T.x6,{i18nKey:"data-sources.datasource-add-button.label",children:"Add new data source"})}):null}var He=a(72109),D=a(4589),Z=a(70255),We=a(78369),oe=a(67061),re=a(11959);function Q({dataSource:t,hasWriteRights:s,hasExploreRights:n}){const o=(0,u.aM)(),r=L.$.appSubUrl+o.Edit.replace(/:uid/gi,t.uid),l=(0,m.of)(Ve);return(0,e.jsxs)(f.Z,{href:s?r:void 0,children:[(0,e.jsx)(f.Z.Heading,{children:t.name}),(0,e.jsx)(f.Z.Figure,{children:(0,e.jsx)("img",{src:t.typeLogoUrl,alt:"",height:"40px",width:"40px",className:l.logo})}),(0,e.jsx)(f.Z.Meta,{children:[t.typeName,t.url,t.isDefault&&(0,e.jsx)(We.v,{name:"default",colorIndex:1},"default-tag")]}),(0,e.jsxs)(f.Z.Tags,{children:[(0,e.jsx)(j.z9,{icon:"apps",fill:"outline",variant:"secondary",href:`dashboard/new-with-ds/${t.uid}`,onClick:()=>{(0,D.TR)({grafana_version:L.$.buildInfo.version,datasource_uid:t.uid,plugin_name:t.typeName,path:location.pathname})},children:"Build a dashboard"}),n&&(0,e.jsx)(j.z9,{icon:"compass",fill:"outline",variant:"secondary",className:l.button,href:(0,re.h)(t),onClick:()=>{(0,D.M1)({grafana_version:L.$.buildInfo.version,datasource_uid:t.uid,plugin_name:t.typeName,path:location.pathname})},children:"Explore"})]})]})}function Ke({hasExploreRights:t}){const s=(0,m.of)(Ye);return(0,e.jsxs)(f.Z,{children:[(0,e.jsx)(f.Z.Heading,{children:(0,e.jsx)(Z.A,{width:140})}),(0,e.jsx)(f.Z.Figure,{children:(0,e.jsx)(Z.A,{width:40,height:40,containerClassName:s.figure})}),(0,e.jsx)(f.Z.Meta,{children:(0,e.jsx)(Z.A,{width:120})}),(0,e.jsx)(f.Z.Tags,{children:(0,e.jsxs)(oe.B,{direction:"row",gap:2,children:[(0,e.jsx)(Z.A,{height:32,width:179,containerClassName:s.button}),t&&(0,e.jsx)(Z.A,{height:32,width:107,containerClassName:s.button})]})})]})}Q.Skeleton=Ke;const Ye=()=>({button:(0,i.css)({lineHeight:1}),figure:(0,i.css)({lineHeight:1})}),Ve=t=>({logo:(0,i.css)({objectFit:"contain"}),button:(0,i.css)({marginLeft:t.spacing(2)})});var Ge=a(72557);const J="alpha-asc",ie="alpha-desc",Qe=[{label:"Sort by A\u2013Z",value:J},{label:"Sort by Z\u2013A",value:ie}];function Je(){const t=(0,h.useDispatch)(),s=(0,N.useCallback)(c=>t((0,u.Bs)(c)),[t]),n=(0,h.useSelector)(({dataSources:c})=>(0,u.xs)(c)),o=(0,N.useCallback)(c=>t((0,u.Tk)(c.value===J)),[t]),r=(0,h.useSelector)(({dataSources:c})=>(0,u.lv)(c)),l={onChange:o,value:r?J:ie,getSortOptions:()=>Promise.resolve(Qe)};return(0,e.jsx)(Ge.A,{searchQuery:n,setSearchQuery:s,sortPicker:l},"action-bar")}function Xe(){const{isLoading:t}=(0,u.US)(),s=(0,h.useSelector)(c=>(0,u.zC)(c.dataSources)),n=(0,h.useSelector)(({dataSources:c})=>(0,u.wC)(c)),o=M.TP.hasPermission(h.AccessControlAction.DataSourcesCreate),r=M.TP.hasPermission(h.AccessControlAction.DataSourcesWrite),l=M.TP.hasAccessToExplore();return(0,e.jsx)(qe,{dataSources:s,dataSourcesCount:n,isLoading:t,hasCreateRights:o,hasWriteRights:r,hasExploreRights:l})}function qe({dataSources:t,dataSourcesCount:s,isLoading:n,hasCreateRights:o,hasWriteRights:r,hasExploreRights:l}){const c=(0,m.of)(_e),d=(0,u.aM)(),v=(0,g.zy)();if((0,N.useEffect)(()=>{(0,D.kg)({grafana_version:L.$.buildInfo.version,path:v.pathname})},[v]),!n&&s===0)return(0,e.jsx)(O.p,{variant:"call-to-action",button:(0,e.jsx)(j.z9,{disabled:!o,href:d.New,icon:"database",size:"lg",children:(0,e.jsx)(T.x6,{i18nKey:"data-source-list.empty-state.button-title",children:"Add data source"})}),message:(0,T.t)("data-source-list.empty-state.title","No data sources defined"),children:(0,e.jsxs)(T.x6,{i18nKey:"data-source-list.empty-state.pro-tip",children:["You can also define data sources through configuration files."," ",(0,e.jsx)(He.Y,{external:!0,href:"http://docs.grafana.org/administration/provisioning/?utm_source=grafana_ds_list#data-sources",children:"Learn more"})]})});const A=()=>n?new Array(20).fill(null).map((S,C)=>(0,e.jsx)(Q.Skeleton,{hasExploreRights:l},C)):t.map(S=>(0,e.jsx)("li",{children:(0,e.jsx)(Q,{dataSource:S,hasWriteRights:r,hasExploreRights:l})},S.uid));return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Je,{}),t.length===0&&!n?(0,e.jsx)(O.p,{variant:"not-found",message:(0,T.t)("data-sources.empty-state.message","No data sources found")}):(0,e.jsx)("ul",{className:c.list,children:A()})]})}const _e=t=>({list:(0,i.css)({listStyle:"none",display:"grid"})});function et(){const s=(0,h.useSelector)(({dataSources:n})=>(0,u.wC)(n))>0?(0,e.jsx)(Ze,{}):void 0;return(0,e.jsx)(y.Y,{navId:"connections-datasources",actions:s,children:(0,e.jsx)(y.Y.Contents,{children:(0,e.jsx)(Xe,{})})})}var X=a(39419),ce=a(3673),tt=a(20701),st=a(38348);function nt({uid:t}){(0,u.oU)(t);const s=(0,h.useDispatch)(),n=(0,h.useSelector)(d=>d.dataSources.dataSource),o=(0,h.useSelector)(d=>d.plugins.dashboards),r=(0,h.useSelector)(d=>d.plugins.isLoadingPluginDashboards);(0,N.useEffect)(()=>{n.id>0&&s((0,tt.h9)())},[s,n.id]);const l=(d,v)=>{s((0,ce.Q9)({pluginId:d.pluginId,path:d.path,overwrite:v,inputs:[{name:"*",type:"datasource",pluginId:n.type,value:n.name}]},d.title))},c=({uid:d})=>{s((0,ce.TA)(d))};return(0,e.jsx)(at,{dashboards:o,isLoading:r,onImportDashboard:l,onRemoveDashboard:c})}const at=({isLoading:t,dashboards:s,onImportDashboard:n,onRemoveDashboard:o})=>t?(0,e.jsx)(X.A,{}):(0,e.jsx)(st.A,{dashboards:s,onImport:n,onRemove:o});var le=a(19347),de=a(17422),q=a(11084),_=a(74984);function ue(t){const{uid:s}=(0,g.g)(),n=(0,g.zy)(),o=(0,q.xw)(s),r=(0,q.S4)(o.type),l=(0,W.ob)(o.type),c=new URLSearchParams(n.search),d=t||c.get("page"),{plugin:v,loadError:A,loading:S}=(0,q._e)(),C=(0,le.l)()?.getInstanceSettings(s),E=!!(C?.meta?.alerting??!1),R=C?.type==="alertmanager",b=E||R,k=(0,h.useSelector)(x=>x.navIndex),B=d?`datasource-${d}-${s}`:`datasource-settings-${s}`;let I={node:{text:"Data Source Nav Node"},main:{text:"Data Source Nav Node"}};if(A){const x={text:A,subTitle:"Data Source Error",icon:"exclamation-triangle"};I={node:x,main:x}}return(S||!v)&&(I=(0,de.tc)(k,B,(0,_.$m)("settings"))),v&&(I=(0,de.tc)(k,B,(0,_.Vh)((0,_.R4)(o,v),d||"settings"))),{navId:"connections-datasources",pageNav:{...I.main,dataSourcePluginName:l?.name||v?.meta.name||"",active:!0,text:o.name,subTitle:`Type: ${r.name}`,children:(I.main.children||[]).map(x=>({...x,url:x.url?.replace("datasources/edit/","/connections/datasources/edit/")}))},dataSourceHeader:{alertingSupported:b}}}function ot(){const{uid:t}=(0,g.g)(),{navId:s,pageNav:n}=ue("dashboards");return(0,e.jsx)(y.Y,{navId:s,pageNav:n,children:(0,e.jsx)(y.Y.Contents,{children:(0,e.jsx)(nt,{uid:t})})})}var ee=a(2543),rt=a(69129),it=a(74135),ge=a(76287),ct=a(3197),lt=a(28138),w=a(13544),he=a(14186),dt=a(15292);function ut({dataSourceName:t,isDefault:s,onDefaultChange:n,onNameChange:o,disabled:r}){return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)("div",{className:"gf-form-group","aria-label":"Datasource settings page basic settings",children:(0,e.jsxs)("div",{className:"gf-form-inline",children:[(0,e.jsx)("div",{className:"gf-form max-width-30",children:(0,e.jsx)(he.I,{label:"Name",tooltip:`The name is used when you select the data source in panels. The default data source is
              'preselected in new panels.`,grow:!0,disabled:r,labelWidth:14,children:(0,e.jsx)(ne.p,{id:"basic-settings-name",type:"text",value:t,placeholder:"Name",onChange:l=>o(l.currentTarget.value),required:!0,"data-testid":w.Tp.pages.DataSource.name})})}),(0,e.jsx)(he.I,{label:"Default",labelWidth:8,disabled:r,children:(0,e.jsx)(dt.K,{id:"basic-settings-default",value:s,onChange:l=>{n(l.currentTarget.checked)}})})]})})})}function os({enabled:t}){const s=useStyles2(gt);return jsx("div",{className:s.badge,children:t?jsx(Badge,{color:"green",icon:"check-circle",text:"Alerting supported"}):jsx(Badge,{color:"orange",icon:"exclamation-triangle",text:"Alerting not supported"})})}const gt=t=>({badge:css`
    margin-bottom: ${t.spacing(2)};
  `});function ht({canSave:t,canDelete:s,onDelete:n,onSubmit:o,onTest:r}){return(0,e.jsxs)("div",{className:"gf-form-button-row",children:[(0,e.jsx)(j.$n,{type:"button",variant:"destructive",disabled:!s,onClick:n,"data-testid":w.Tp.pages.DataSource.delete,children:"Delete"}),t&&(0,e.jsx)(j.$n,{type:"submit",variant:"primary",disabled:!t,onClick:o,"data-testid":w.Tp.pages.DataSource.saveAndTest,children:"Save & test"}),!t&&(0,e.jsx)(j.$n,{variant:"primary",onClick:r,children:"Test"})]})}var pt=a(61268),xt=a(61680),mt=a(2913);const ft="datasources.settings.cloudInfoBox.isDismissed";function vt({dataSource:t}){let s="",n="";if(t.readOnly||(t.version??0)>2||mt.config.buildInfo.edition!==pt.r.OpenSource)return null;switch(t.type){case"prometheus":s="Prometheus",n="Loki";break;case"loki":s="Loki",n="Prometheus";break;default:return null}return(0,e.jsx)(xt.b,{storageKey:ft,defaultValue:!1,children:(o,r)=>o?null:(0,e.jsxs)(z.F,{title:`Configure your ${s} data source below`,severity:"info",bottomSpacing:4,onRemove:()=>{r(!0)},children:["Or skip the effort and get ",s," (and ",n,") as fully-managed, scalable, and hosted data sources from Grafana Labs with the"," ",(0,e.jsx)("a",{className:"external-link",href:`https://grafana.com/signup/cloud/connect-account?src=grafana-oss&cnt=${t.type}-settings`,target:"_blank",rel:"noreferrer",title:"The free plan includes 10k active metrics and 50gb storage.",children:"free-forever Grafana Cloud plan"}),"."]})})}const jt="This data source was added by config and cannot be modified using the UI. Please contact your server admin to update this data source.";function pe(){return(0,e.jsx)(z.F,{"data-testid":w.Tp.pages.DataSource.readOnly,severity:"info",title:"Provisioned data source",children:jt})}function St({dataSourceRights:t,onDelete:s}){const{readOnly:n,hasDeleteRights:o}=t,r=!n&&o,l=()=>history.back();return(0,e.jsxs)(e.Fragment,{children:[n&&(0,e.jsx)(pe,{}),(0,e.jsxs)("div",{className:"gf-form-button-row",children:[r&&(0,e.jsx)(j.$n,{type:"submit",variant:"destructive",onClick:s,children:"Delete"}),(0,e.jsx)(j.$n,{variant:"secondary",fill:"outline",type:"button",onClick:l,children:"Back"})]})]})}const yt="You are not allowed to modify this data source. Please contact your server admin to update this data source.";function Dt(){return(0,e.jsx)(z.F,{severity:"info",title:"Missing rights",children:yt})}function Ct({plugin:t,pageId:s}){if(!t||!t.configPages)return null;const n=t.configPages.find(({id:o})=>o===s);return n?(0,e.jsx)(n.body,{plugin:t,query:{}}):(0,e.jsxs)("div",{children:["Page not found: ",n]})}var Nt=a(7376);class bt extends N.PureComponent{constructor(s){super(s),this.element=null,this.onModelChanged=n=>{this.props.onModelChange(n)},this.scopeProps={ctrl:{datasourceMeta:s.dataSourceMeta,current:(0,ee.cloneDeep)(s.dataSource)},onModelChanged:this.onModelChanged},this.onModelChanged=this.onModelChanged.bind(this)}componentDidMount(){const{plugin:s}=this.props;if(this.element&&!s.components.ConfigEditor){const n=(0,Nt.E)(),o='<plugin-component type="datasource-config-ctrl" />';this.component=n.load(this.element,this.scopeProps,o)}}componentDidUpdate(s){const{plugin:n}=this.props;!n.components.ConfigEditor&&this.props.dataSource!==s.dataSource&&(this.scopeProps.ctrl.current=(0,ee.cloneDeep)(this.props.dataSource),this.component?.digest())}componentWillUnmount(){this.component&&this.component.destroy()}render(){const{plugin:s,dataSource:n}=this.props;return s?(0,e.jsx)("div",{ref:o=>this.element=o,children:s.components.ConfigEditor&&(0,N.createElement)(s.components.ConfigEditor,{options:n,onOptionsChange:this.onModelChanged})}):null}}var Pt=a(10803);function Tt({state:t}){return(0,e.jsxs)("div",{className:"gf-form",children:[(0,e.jsx)("div",{className:"gf-form-label width-10",children:"Plugin state"}),(0,e.jsx)("div",{className:"gf-form-label gf-form-label--transparent",children:(0,e.jsx)(Pt.p,{state:t})})]})}var xe=a(50720);const At=(t,s)=>({content:(0,i.css)({color:t.colors.text.secondary,paddingTop:s?t.spacing(1):0,maxHeight:"50vh",overflowY:"auto"}),disabled:(0,i.css)({pointerEvents:"none",color:t.colors.text.secondary})}),me=({title:t,exploreUrl:s,dataSourceId:n,onDashboardLinkClicked:o})=>{const r=(0,m.$j)(),c=At(r,!!t),d=M.TP.hasAccessToExplore();return(0,e.jsxs)("div",{className:c.content,children:["Next, you can start to visualize data by"," ",(0,e.jsx)(xe.N,{"aria-label":"Create a dashboard",href:`/dashboard/new-with-ds/${n}`,className:"external-link",onClick:o,children:"building a dashboard"}),", or by querying data in the"," ",(0,e.jsx)(xe.N,{"aria-label":"Explore data",className:(0,i.cx)("external-link",{[`${c.disabled}`]:!d,"test-disabled":!d}),href:s,children:"Explore view"}),"."]})};me.displayName="AlertSuccessMessage";const Et=new Set(["success","info","warning","error"]),It=t=>Et.has(t),Mt=t=>t.toLowerCase()==="ok"?"success":It(t)?t:"info";function Lt({testingStatus:t,exploreUrl:s,dataSource:n}){const o=Mt(t?.status??"error"),r=t?.message,l=t?.details?.message,c=t?.details?.verboseMessage,d=()=>{(0,D.TR)({grafana_version:L.$.buildInfo.version,datasource_uid:n.uid,plugin_name:n.typeName,path:location.pathname})},v=(0,m.of)(Bt);return r?(0,e.jsx)("div",{className:(0,i.cx)("gf-form-group",v.container),children:(0,e.jsx)(z.F,{severity:o,title:r,"data-testid":w.Tp.pages.DataSource.alert,children:t?.details&&(0,e.jsxs)(e.Fragment,{children:[l,o==="success"?(0,e.jsx)(me,{title:r,exploreUrl:s,dataSourceId:n.uid,onDashboardLinkClicked:d}):null,c?(0,e.jsx)("details",{style:{whiteSpace:"pre-wrap"},children:String(c)}):null]})})}):null}const Bt=t=>({container:(0,i.css)({paddingTop:t.spacing(3)})});function wt({uid:t,pageId:s}){(0,u.oU)(t);const n=(0,h.useDispatch)(),o=(0,u.xw)(t),r=(0,u.S4)(o.type),l=(0,u._e)(),c=(0,u.u1)(t),d=(0,u.Tn)(t),v=(0,u.$k)(),A=(0,u.BY)(t),S=(0,u.k9)(),C=b=>n((0,u.C_)(b)),E=b=>n((0,u.rb)(b)),R=b=>n((0,u.jz)(b));return(0,e.jsx)(Rt,{pageId:s,dataSource:o,dataSourceMeta:r,dataSourceSettings:l,dataSourceRights:c,exploreUrl:d,onDelete:v,onDefaultChange:C,onNameChange:E,onOptionsChange:R,onTest:A,onUpdate:S})}function Rt({pageId:t,dataSource:s,dataSourceMeta:n,dataSourceSettings:o,dataSourceRights:r,exploreUrl:l,onDelete:c,onDefaultChange:d,onNameChange:v,onOptionsChange:A,onTest:S,onUpdate:C}){const{plugin:E,loadError:R,testingStatus:b,loading:k}=o,{readOnly:B,hasWriteRights:I,hasDeleteRights:Y}=r,x=s.id>0,H=(0,le.l)()?.getInstanceSettings(s.uid),Se=async U=>{U.preventDefault(),(0,D._i)("save_and_test");try{await C({...s}),(0,D.m3)({item:"success"}),lt.A.publish(new rt.wE)}catch{(0,D.m3)({item:"fail"});return}S()},ss=it.S.DataSourceConfig,{extensions:ye}=(0,ct.kr)({extensionPointId:ss}),ns=(0,N.useMemo)(()=>{const U=["grafana-pdc-app","grafana-auth-app"];return ye.filter(V=>U.includes(V.pluginId))},[ye]);return R?(0,e.jsx)(St,{dataSourceRights:r,onDelete:()=>{(0,D._i)("delete"),c()}}):k?(0,e.jsx)(X.A,{}):!x||!H?null:t?(0,e.jsx)(ge.p,{instanceSettings:H,children:(0,e.jsx)(Ct,{pageId:t,plugin:E})}):(0,e.jsxs)("form",{onSubmit:Se,children:[!I&&(0,e.jsx)(Dt,{}),B&&(0,e.jsx)(pe,{}),n.state&&(0,e.jsx)(Tt,{state:n.state}),(0,e.jsx)(vt,{dataSource:s}),(0,e.jsx)(ut,{dataSourceName:s.name,isDefault:s.isDefault,onDefaultChange:d,onNameChange:v,disabled:B||!I}),E&&(0,e.jsx)(ge.p,{instanceSettings:H,children:(0,e.jsx)(bt,{plugin:E,dataSource:s,dataSourceMeta:n,onModelChange:A})}),ns.map(U=>{const V=U.component;return(0,e.jsx)("div",{children:(0,e.jsx)(V,{context:{dataSource:(0,ee.omit)(s,["secureJsonData"]),dataSourceMeta:n,testingStatus:b,setJsonData:as=>A({...s,jsonData:{...s.jsonData,...as}})}})},U.id)}),(0,e.jsx)(Lt,{testingStatus:b,exploreUrl:l,dataSource:s}),(0,e.jsx)(ht,{onSubmit:Se,onDelete:()=>{(0,D._i)("delete"),c()},onTest:()=>{(0,D._i)("test"),S()},canDelete:!B&&Y,canSave:!B&&I})]})}function $t({uid:t}){const s=(0,u.xw)(t),n=M.TP.hasAccessToExplore();return(0,e.jsxs)(e.Fragment,{children:[n&&(0,e.jsx)(j.z9,{variant:"secondary",size:"sm",href:(0,re.h)(s),onClick:()=>{(0,D._i)("explore"),(0,D.M1)({grafana_version:L.$.buildInfo.version,datasource_uid:s.uid,plugin_name:s.typeName,path:location.pathname})},children:"Explore data"}),(0,e.jsx)(j.z9,{size:"sm",variant:"secondary",href:`dashboard/new-with-ds/${s.uid}`,onClick:()=>{(0,D._i)("build_a_dashboard"),(0,D.TR)({grafana_version:L.$.buildInfo.version,datasource_uid:s.uid,plugin_name:s.typeName,path:location.pathname})},children:"Build a dashboard"})]})}const Ot=t=>{const s=[],n=t.alertingSupported;return s.push({label:"Type",value:t.dataSourcePluginName}),s.push({label:"Alerting",value:(0,e.jsx)(ae.E,{color:n?"green":"red",text:n?"Supported":"Not supported"})}),s};function Ft({title:t}){const s=(0,m.of)(zt);return(0,e.jsx)("div",{className:s.container,children:(0,e.jsx)("h1",{className:s.title,children:t})})}const zt=t=>({container:(0,i.css)({marginBottom:t.spacing(2),h1:{display:"inline-block"}}),title:(0,i.css)({display:"inline-block",margin:"0 0 0 0",maxWidth:"40vw",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"})});function kt({uid:t,pageId:s}){const{navId:n,pageNav:o,dataSourceHeader:r}=ue(),l=Ot({dataSourcePluginName:o.dataSourcePluginName,alertingSupported:r.alertingSupported});return(0,e.jsx)(y.Y,{navId:n,pageNav:o,renderTitle:c=>(0,e.jsx)(Ft,{title:c}),info:l,actions:(0,e.jsx)($t,{uid:t}),children:(0,e.jsx)(y.Y.Contents,{children:(0,e.jsx)(wt,{uid:t,pageId:s})})})}const Ut=kt;function Zt(){const{uid:t}=(0,g.g)(),s=(0,g.zy)(),o=new URLSearchParams(s.search).get("page");return(0,e.jsx)(Ut,{uid:t,pageId:o})}var Ht=a(67647),fe=a(33552),ve=a(98624);function Wt({filterByPluginType:t}){let s=(0,W.F9)(t);const{isLoading:n}=(0,W.m5)(),o=(0,m.of)(Yt);return n||s.length===0?null:(0,e.jsxs)(z.F,{title:"Unsigned plugins were found during plugin initialization. Grafana Labs cannot guarantee the integrity of these plugins. We recommend only using signed plugins.","data-testid":w.Tp.pages.PluginsList.signatureErrorNotice,severity:"warning",children:[(0,e.jsx)("p",{children:"The following plugins are disabled and not shown in the list below:"}),(0,e.jsx)(fe.B,{items:s,className:o.list,renderItem:r=>(0,e.jsx)("div",{className:o.wrapper,children:(0,e.jsxs)(oe.B,{justifyContent:"flex-start",alignItems:"center",children:[(0,e.jsx)("strong",{children:r.pluginId}),(0,e.jsx)(ve.B,{status:Kt(r.errorCode),className:o.badge})]})})}),(0,e.jsxs)("a",{href:"https://grafana.com/docs/grafana/latest/plugins/plugin-signatures/",className:o.docsLink,target:"_blank",rel:"noreferrer",children:[(0,e.jsx)(K.I,{name:"book"})," Read more about plugin signing"]})]})}function Kt(t){switch(t){case P.ZK.invalidSignature:return P.Ac.invalid;case P.ZK.missingSignature:return P.Ac.missing;case P.ZK.modifiedSignature:return P.Ac.modified;default:return P.Ac.missing}}function Yt(t){return{list:(0,i.css)({listStyleType:"circle"}),wrapper:(0,i.css)({marginTop:t.spacing(1)}),badge:(0,i.css)({marginTop:0}),docsLink:(0,i.css)({display:"inline-block",color:t.colors.text.link,marginTop:t.spacing(2)})}}function Vt({onClick:t,dataSourcePlugin:s}){const n=s.module==="phantom",o=!n&&!s.unlicensed,r=s.info?.links?.length>0?s.info.links[0]:null,l=r?.target??"_blank",c=(0,m.of)(Gt);return(0,e.jsxs)(f.Z,{className:(0,i.cx)(c.card,"card-parent"),onClick:o?t:()=>{},children:[(0,e.jsx)(f.Z.Heading,{className:c.heading,"aria-label":w.Tp.pages.AddDataSource.dataSourcePluginsV2(s.name),children:s.name}),(0,e.jsx)(f.Z.Figure,{align:"center",className:c.figure,children:(0,e.jsx)("img",{className:c.logo,src:s.info.logos.small,alt:""})}),(0,e.jsx)(f.Z.Description,{className:c.description,children:s.info.description}),!n&&(0,e.jsx)(f.Z.Meta,{className:c.meta,children:(0,e.jsx)(ve.B,{status:s.signature})}),(0,e.jsx)(f.Z.Actions,{className:c.actions,children:r&&(0,e.jsx)(j.z9,{"aria-label":`${s.name}, learn more.`,href:`${r.url}?utm_source=grafana_add_ds`,onClick:d=>d.stopPropagation(),rel:"noopener",target:l,variant:"secondary",children:r.name})})]})}function Gt(t){return{heading:(0,i.css)({fontSize:t.v1.typography.heading.h5,fontWeight:"inherit"}),figure:(0,i.css)({width:"inherit",marginRight:"0px","> img":{width:t.spacing(7)}}),meta:(0,i.css)({marginTop:"6px",position:"relative"}),description:(0,i.css)({margin:"0px",fontSize:t.typography.size.sm}),actions:(0,i.css)({position:"relative",alignSelf:"center",marginTop:"0px",opacity:0,".card-parent:hover &, .card-parent:focus-within &":{opacity:1}}),card:(0,i.css)({gridTemplateAreas:`
        "Figure   Heading   Actions"
        "Figure Description Actions"
        "Figure    Meta     Actions"
        "Figure     -       Actions"`}),logo:(0,i.css)({marginRight:t.v1.spacing.lg,marginLeft:t.v1.spacing.sm,width:t.spacing(7),maxHeight:t.spacing(7)})}}function je({dataSourcePlugins:t,onClickDataSourceType:s}){return!t||!t.length?null:(0,e.jsx)(fe.B,{items:t,getItemKey:n=>n.id.toString(),renderItem:n=>(0,e.jsx)(Vt,{dataSourcePlugin:n,onClick:()=>s(n)}),className:(0,i.css)`
        > li {
          margin-bottom: 2px;
        }
      `})}function Qt({categories:t,onClickDataSourceType:s}){const n=`${p.b.AddNewConnection}?cat=data-source`,o=(0,m.of)(Jt);return(0,e.jsxs)(e.Fragment,{children:[t.map(({id:r,title:l,plugins:c})=>(0,e.jsxs)("div",{className:o.category,children:[(0,e.jsx)("div",{className:o.header,id:r,children:l}),(0,e.jsx)(je,{dataSourcePlugins:c,onClickDataSourceType:s})]},r)),(0,e.jsx)("div",{className:o.more,children:(0,e.jsx)(j.z9,{variant:"secondary",href:n,target:"_self",rel:"noopener",children:"Find more data source plugins"})})]})}const Jt=t=>({category:(0,i.css)({marginBottom:t.spacing(2)}),header:(0,i.css)({fontSize:t.typography.h5.fontSize,marginBottom:t.spacing(1)}),more:(0,i.css)({margin:t.spacing(4),textAlign:"center"})});function Xt(){(0,u.hx)();const t=(0,h.useDispatch)(),s=(0,h.useSelector)(d=>(0,u.hp)(d.dataSources)),n=(0,h.useSelector)(d=>d.dataSources.dataSourceTypeSearchQuery),o=(0,h.useSelector)(d=>d.dataSources.isLoadingDataSourcePlugins),r=(0,h.useSelector)(d=>d.dataSources.categories),l=(0,u.Um)(),c=d=>t((0,u.eB)(d));return(0,e.jsx)(qt,{dataSources:s,dataSourceCategories:r,searchQuery:n,isLoading:o,onAddDataSource:l,onSetSearchQuery:c})}function qt({dataSources:t,dataSourceCategories:s,searchQuery:n,isLoading:o,onAddDataSource:r,onSetSearchQuery:l}){const c=(0,u.aM)();return o?(0,e.jsx)(X.A,{}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"page-action-bar",children:[(0,e.jsx)(Ht.Z,{value:n,onChange:l,placeholder:"Filter by name or type"}),(0,e.jsx)("div",{className:"page-action-bar__spacer"}),(0,e.jsx)(j.z9,{href:c.List,fill:"outline",variant:"secondary",icon:"arrow-left",children:"Cancel"})]}),!n&&(0,e.jsx)(Wt,{filterByPluginType:P.QE.datasource}),(0,e.jsxs)("div",{children:[n&&(0,e.jsx)(je,{dataSourcePlugins:t,onClickDataSourceType:r}),!n&&(0,e.jsx)(Qt,{categories:s,onClickDataSourceType:r})]})]})}function _t(){return(0,e.jsx)(y.Y,{navId:"connections-datasources",pageNav:{text:"Add data source",subTitle:"Choose a data source type",active:!0},children:(0,e.jsx)(y.Y.Contents,{children:(0,e.jsx)(Xt,{})})})}function es(){const{search:t}=(0,g.zy)();return(0,e.jsx)(g.rd,{to:{pathname:p.b.AddNewConnection,search:t}})}function ts(){const s=!!(0,h.useSelector)(n=>n.navIndex)["standalone-plugin-page-/connections/add-new-connection"];return(0,e.jsx)(u.CR.Provider,{value:{New:p.b.DataSourcesNew,List:p.b.DataSources,Edit:p.b.DataSourcesEdit,Dashboards:p.b.DataSourcesDashboards},children:(0,e.jsxs)(g.dO,{children:[(0,e.jsx)(g.qh,{exact:!0,sensitive:!0,path:p.b.Base,component:()=>(0,e.jsx)(g.rd,{to:p.b.AddNewConnection})}),(0,e.jsx)(g.qh,{exact:!0,sensitive:!0,path:p.b.DataSources,component:et}),(0,e.jsx)(g.qh,{exact:!0,sensitive:!0,path:p.b.DataSourcesNew,component:_t}),(0,e.jsx)(g.qh,{exact:!0,sensitive:!0,path:p.b.DataSourcesDetails,component:ke}),(0,e.jsx)(g.qh,{exact:!0,sensitive:!0,path:p.b.DataSourcesEdit,component:Zt}),(0,e.jsx)(g.qh,{exact:!0,sensitive:!0,path:p.b.DataSourcesDashboards,component:ot}),!s&&(0,e.jsx)(g.qh,{exact:!0,sensitive:!0,path:p.b.AddNewConnection,component:Fe}),(0,e.jsx)(g.qh,{exact:!0,path:p.b.ConnectDataOutdated,component:es}),(0,e.jsx)(g.rd,{from:`${p.b.Base}/your-connections/:page`,to:`${p.b.Base}/:page`}),(0,e.jsx)(g.rd,{from:p.b.YourConnectionsOutdated,to:p.b.DataSources}),(0,e.jsx)(g.qh,{component:()=>(0,e.jsx)(g.rd,{to:"/notfound"})})]})})}},31036:(te,$,a)=>{a.d($,{E:()=>y});var e=a(74848),g=a(14110),u=a(68402),h=a(72109),p=a(8484);const y=()=>(0,e.jsxs)("div",{children:[(0,e.jsx)(u.$,{v:2}),(0,e.jsx)(h.Y,{href:"https://github.com/grafana/grafana/issues/new?assignees=&labels=area%2Fdatasource%2Ctype%2Fnew-plugin-request&projects=&template=3-data_source_request.yaml&title=%5BNew+Data+Source%5D%3A+%3Cname-of-service%3E",onClick:()=>(0,g.rR)("connections_data_source_request_clicked"),external:!0,children:(0,e.jsx)(p.x6,{i18nKey:"connections.connect-data.request-data-source",children:"Request a new data source"})}),(0,e.jsx)("br",{}),(0,e.jsx)(h.Y,{href:"https://github.com/orgs/grafana/projects/619/views/1?pane=info",onClick:()=>(0,g.rR)("connections_data_source_roadmap_clicked"),external:!0,children:(0,e.jsx)(p.x6,{i18nKey:"connections.connect-data.roadmap",children:"View roadmap"})})]})}}]);

//# sourceMappingURL=Connections.e30e1a867756c003056a.js.map