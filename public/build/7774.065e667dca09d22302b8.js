(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[7774],{29020:(xe,ve,y)=>{"use strict";y.d(ve,{I:()=>Y});var D=y(96540),A=y(47433),x=Object.defineProperty,$=Object.defineProperties,z=Object.getOwnPropertyDescriptors,T=Object.getOwnPropertySymbols,E=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable,j=(Z,de,H)=>de in Z?x(Z,de,{enumerable:!0,configurable:!0,writable:!0,value:H}):Z[de]=H,W=(Z,de)=>{for(var H in de||(de={}))E.call(de,H)&&j(Z,H,de[H]);if(T)for(var H of T(de))I.call(de,H)&&j(Z,H,de[H]);return Z},X=(Z,de)=>$(Z,z(de)),ee=(Z,de)=>{var H={};for(var Oe in Z)E.call(Z,Oe)&&de.indexOf(Oe)<0&&(H[Oe]=Z[Oe]);if(Z!=null&&T)for(var Oe of T(Z))de.indexOf(Oe)<0&&I.call(Z,Oe)&&(H[Oe]=Z[Oe]);return H};const Y=Z=>{var de=Z,{children:H}=de,Oe=ee(de,["children"]);return D.createElement(A.x,X(W({},Oe),{kind:"sub-section"}),H)}},47433:(xe,ve,y)=>{"use strict";y.d(ve,{x:()=>Z});var D=y(96540),A=y(32196),x=y(40845),$=y(29158),z=Object.defineProperty,T=Object.defineProperties,E=Object.getOwnPropertyDescriptors,I=Object.getOwnPropertySymbols,j=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable,X=(de,H,Oe)=>H in de?z(de,H,{enumerable:!0,configurable:!0,writable:!0,value:Oe}):de[H]=Oe,ee=(de,H)=>{for(var Oe in H||(H={}))j.call(H,Oe)&&X(de,Oe,H[Oe]);if(I)for(var Oe of I(H))W.call(H,Oe)&&X(de,Oe,H[Oe]);return de},Y=(de,H)=>T(de,E(H));const Z=({children:de,title:H,description:Oe,isCollapsible:We=!1,isInitiallyOpen:Je=!0,kind:ke="section",className:je})=>{const{colors:he,typography:qe,spacing:Ue}=(0,x.$j)(),[er,fr]=(0,D.useState)(We?Je:!0),Be=er?"angle-up":"angle-down",Qe=ke==="sub-section",pr=`${er?"Collapse":"Expand"} section ${H}`,Ir={header:(0,A.css)({display:"flex",justifyContent:"space-between",alignItems:"center"}),title:(0,A.css)({margin:0}),subtitle:(0,A.css)({margin:0,fontWeight:qe.fontWeightRegular}),descriptionText:(0,A.css)(Y(ee({marginTop:Ue(Qe?.25:.5),marginBottom:0},qe.bodySmall),{color:he.text.secondary})),content:(0,A.css)({marginTop:Ue(2)})};return D.createElement("div",{className:je},D.createElement("div",{className:Ir.header},ke==="section"?D.createElement("h3",{className:Ir.title},H):D.createElement("h6",{className:Ir.subtitle},H),We&&D.createElement($.K,{name:Be,onClick:()=>fr(!er),type:"button",size:"xl","aria-label":pr})),Oe&&D.createElement("p",{className:Ir.descriptionText},Oe),er&&D.createElement("div",{className:Ir.content},de))}},6191:(xe,ve,y)=>{"use strict";y.d(ve,{X:()=>$});var D=y(32196),A=y(96540),x=y(40845);const $=({children:T})=>{const E=(0,x.of)(z);return A.createElement("div",{className:E.root},T)},z=T=>({root:(0,D.css)({display:"flex",flexWrap:"wrap",alignItems:"center",gap:T.spacing(3),minHeight:T.spacing(4)})})},31347:(xe,ve,y)=>{"use strict";y.d(ve,{Z:()=>A});var D=y(96540);const A=({grow:x,shrink:$})=>D.createElement("div",{style:{display:"block",flexGrow:x,flexShrink:$}})},22354:(xe,ve,y)=>{"use strict";y.d(ve,{W:()=>H});var D=y(32196),A=y(96540),x=y(40845),$=y(90182),z=y(4603),T=Object.defineProperty,E=Object.defineProperties,I=Object.getOwnPropertyDescriptors,j=Object.getOwnPropertySymbols,W=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable,ee=(ke,je,he)=>je in ke?T(ke,je,{enumerable:!0,configurable:!0,writable:!0,value:he}):ke[je]=he,Y=(ke,je)=>{for(var he in je||(je={}))W.call(je,he)&&ee(ke,he,je[he]);if(j)for(var he of j(je))X.call(je,he)&&ee(ke,he,je[he]);return ke},Z=(ke,je)=>E(ke,I(je)),de=(ke,je)=>{var he={};for(var qe in ke)W.call(ke,qe)&&je.indexOf(qe)<0&&(he[qe]=ke[qe]);if(ke!=null&&j)for(var qe of j(ke))je.indexOf(qe)<0&&X.call(ke,qe)&&(he[qe]=ke[qe]);return he};function H(ke){var je=ke,{label:he}=je,qe=de(je,["label"]);const Ue=(0,x.of)(Je),[er]=(0,A.useState)(()=>Math.random().toString(16).slice(2)),fr={SelectContainer:Oe,ValueContainer:We,SingleValue:We};return A.createElement("div",{className:Ue.root},he&&A.createElement("label",{className:Ue.label,htmlFor:er},he,":","\xA0"),A.createElement($.l6,Z(Y({openMenuOnFocus:!0,inputId:er},qe),{components:fr})))}const Oe=ke=>{const{children:je}=ke,he=(0,x.of)(Je);return A.createElement(z.K,Z(Y({},ke),{className:(0,D.cx)(ke.className,he.container)}),je)},We=ke=>{const{className:je,children:he}=ke,qe=(0,x.of)(Je);return A.createElement("div",{className:(0,D.cx)(je,qe.valueContainer)},he)},Je=ke=>({root:(0,D.css)({display:"flex",fontSize:12,alignItems:"center"}),label:(0,D.css)({color:ke.colors.text.secondary,whiteSpace:"nowrap"}),container:(0,D.css)({background:"none",borderColor:"transparent"}),valueContainer:(0,D.css)({display:"flex",alignItems:"center",flex:"initial",color:ke.colors.text.secondary,fontSize:12})})},1779:(xe,ve,y)=>{var D=y(48287).Buffer,A=function(){"use strict";function x(Y,Z){return Z!=null&&Y instanceof Z}var $;try{$=Map}catch{$=function(){}}var z;try{z=Set}catch{z=function(){}}var T;try{T=Promise}catch{T=function(){}}function E(Y,Z,de,H,Oe){typeof Z=="object"&&(de=Z.depth,H=Z.prototype,Oe=Z.includeNonEnumerable,Z=Z.circular);var We=[],Je=[],ke=typeof D<"u";typeof Z>"u"&&(Z=!0),typeof de>"u"&&(de=1/0);function je(he,qe){if(he===null)return null;if(qe===0)return he;var Ue,er;if(typeof he!="object")return he;if(x(he,$))Ue=new $;else if(x(he,z))Ue=new z;else if(x(he,T))Ue=new T(function(ut,be){he.then(function(ue){ut(je(ue,qe-1))},function(ue){be(je(ue,qe-1))})});else if(E.__isArray(he))Ue=[];else if(E.__isRegExp(he))Ue=new RegExp(he.source,ee(he)),he.lastIndex&&(Ue.lastIndex=he.lastIndex);else if(E.__isDate(he))Ue=new Date(he.getTime());else{if(ke&&D.isBuffer(he))return D.allocUnsafe?Ue=D.allocUnsafe(he.length):Ue=new D(he.length),he.copy(Ue),Ue;x(he,Error)?Ue=Object.create(he):typeof H>"u"?(er=Object.getPrototypeOf(he),Ue=Object.create(er)):(Ue=Object.create(H),er=H)}if(Z){var fr=We.indexOf(he);if(fr!=-1)return Je[fr];We.push(he),Je.push(Ue)}x(he,$)&&he.forEach(function(ut,be){var ue=je(be,qe-1),fe=je(ut,qe-1);Ue.set(ue,fe)}),x(he,z)&&he.forEach(function(ut){var be=je(ut,qe-1);Ue.add(be)});for(var Be in he){var Qe;er&&(Qe=Object.getOwnPropertyDescriptor(er,Be)),!(Qe&&Qe.set==null)&&(Ue[Be]=je(he[Be],qe-1))}if(Object.getOwnPropertySymbols)for(var pr=Object.getOwnPropertySymbols(he),Be=0;Be<pr.length;Be++){var Ir=pr[Be],rt=Object.getOwnPropertyDescriptor(he,Ir);rt&&!rt.enumerable&&!Oe||(Ue[Ir]=je(he[Ir],qe-1),rt.enumerable||Object.defineProperty(Ue,Ir,{enumerable:!1}))}if(Oe)for(var jt=Object.getOwnPropertyNames(he),Be=0;Be<jt.length;Be++){var vr=jt[Be],rt=Object.getOwnPropertyDescriptor(he,vr);rt&&rt.enumerable||(Ue[vr]=je(he[vr],qe-1),Object.defineProperty(Ue,vr,{enumerable:!1}))}return Ue}return je(Y,de)}E.clonePrototype=function(Z){if(Z===null)return null;var de=function(){};return de.prototype=Z,new de};function I(Y){return Object.prototype.toString.call(Y)}E.__objToStr=I;function j(Y){return typeof Y=="object"&&I(Y)==="[object Date]"}E.__isDate=j;function W(Y){return typeof Y=="object"&&I(Y)==="[object Array]"}E.__isArray=W;function X(Y){return typeof Y=="object"&&I(Y)==="[object RegExp]"}E.__isRegExp=X;function ee(Y){var Z="";return Y.global&&(Z+="g"),Y.ignoreCase&&(Z+="i"),Y.multiline&&(Z+="m"),Z}return E.__getRegExpFlags=ee,E}();xe.exports&&(xe.exports=A)},87774:(xe,ve,y)=>{"use strict";y.d(ve,{jN:()=>Mb,gv:()=>he,oK:()=>Db,e_:()=>xp,To:()=>ln,oF:()=>ca,se:()=>Nb.s,YW:()=>Wt,nj:()=>Bb});var D={};y.r(D),y.d(D,{applyToJS:()=>Ko,cleanJSX:()=>zo,deepEqual:()=>qa,deepFreeze:()=>Fu,escapeRegExp:()=>Ou,getFirstDefined:()=>Eu,getLogger:()=>Tu,getOpCardinality:()=>Br,isDirtyJSX:()=>Oa,isImmutable:()=>zn,isImmutableList:()=>Qa,isJSX:()=>Ho,isJsonCompatible:()=>Cu,isJsonLogic:()=>st,isObject:()=>Ja,logger:()=>Cn,mergeArraysSmart:()=>Ya,mergeCustomizerNoArrays:()=>bu,omit:()=>Pt,opDefKeysToOmit:()=>Kn,shallowCopy:()=>yu,shallowEqual:()=>ya,sleep:()=>Su,toImmutableList:()=>$r,uuid:()=>cr,widgetDefKeysToOmit:()=>In});var A={};y.r(A),y.d(A,{getItemInListValues:()=>ba,getListValue:()=>ro,getTitleInListValues:()=>ju,getValueInListValues:()=>Qp,listValuesToArray:()=>wu,makeCustomListValue:()=>qo,mapListValues:()=>Qo,searchListValue:()=>Yp,toListValue:()=>vn});var x={};y.r(x),y.d(x,{_fixImmutableValue:()=>ti,expandTreePath:()=>Te,expandTreeSubpath:()=>Yo,fixEmptyGroupsInTree:()=>to,fixPathsInTree:()=>Ht,getFlatTree:()=>Xo,getItemByPath:()=>Hn,getLightTree:()=>Pu,getSwitchValues:()=>xu,getTotalReordableNodesCountInTree:()=>Xp,getTotalRulesCountInTree:()=>Zo,getTreeBadFields:()=>yi,hasChildren:()=>ri,immutableToJs:()=>Ko,isEmptyTree:()=>ei,isImmutable:()=>zn,jsToImmutable:()=>Sa,removeIsLockedInTree:()=>Ru,toImmutableList:()=>$r});var $={};y.r($),y.d($,{SqlString:()=>Tn,mongoEmptyValue:()=>Ku,spelEscape:()=>Qn,spelFixList:()=>zu,spelFormatConcat:()=>Sv,spelImportConcat:()=>Fv,sqlEmptyValue:()=>Wu,stringifyForDisplay:()=>Hu,wrapWithBrackets:()=>Ju});var z={};y.r(z),y.d(z,{_loadFromJsonLogic:()=>Mu,_loadFromSpel:()=>fl,checkTree:()=>Oi,getTree:()=>Zp,isImmutableTree:()=>Iu,isJsonLogic:()=>st,isTree:()=>Vu,isValidTree:()=>hi,jsToImmutable:()=>Sa,loadFromJsonLogic:()=>nv,loadFromSpel:()=>Iv,loadTree:()=>ni});var T={};y.r(T),y.d(T,{createListFromArray:()=>Fl,createListWithOneElement:()=>Jv,defaultConjunction:()=>tn,defaultGroupConjunction:()=>La,defaultGroupProperties:()=>En,defaultItemProperties:()=>bl,defaultOperatorOptions:()=>Aa,defaultRoot:()=>Hv,defaultRule:()=>Sl,defaultRuleProperties:()=>rn,emptyProperties:()=>qv,getDefaultField:()=>yl,getDefaultFieldSrc:()=>si,getDefaultOperator:()=>ci,getDefaultSubField:()=>Ol});var E={};y.r(E),y.d(E,{_validateTree:()=>wa,checkTree:()=>Oi,getNewValueForFieldOp:()=>Vn,getTreeBadFields:()=>yi,isValidTree:()=>hi,sanitizeTree:()=>ds,translateValidation:()=>Jt,validateAndFixTree:()=>fs,validateRange:()=>bi,validateTree:()=>cs,validateValue:()=>Xn});var I={};y.r(I),y.d(I,{completeFuncValue:()=>ms,getCompatibleArgsOnFuncChange:()=>bs,setArgValue:()=>Fi,setArgValueSrc:()=>Os,setFunc:()=>hs,setFuncDefaultArg:()=>ao});var j={};y.r(j),y.d(j,{calculateValueType:()=>Fs,completeValue:()=>Nn,filterValueSourcesForField:()=>Dn,formatFieldName:()=>mn,getFieldPartsConfigs:()=>Cs,getFieldPathLabels:()=>ja,getFirstOperator:()=>Ci,getFuncPathLabels:()=>fg,getOneChildOrDescendant:()=>ji,getOperatorsForField:()=>io,getOperatorsForType:()=>Ss,getValueLabel:()=>pg,getValueSourcesForFieldOp:()=>Ts,getWidgetForFieldOp:()=>wr,getWidgetsForFieldOp:()=>vg,isEmptyGroupChildren:()=>Ai,isEmptyItem:()=>Ei,isEmptyRuleGroupExtPropertiesAndChildren:()=>Es,isEmptyRuleProperties:()=>Li,selectTypes:()=>oo,whatRulePropertiesAreCompleted:()=>wi});var W={};y.r(W),y.d(W,{_getFromConfigCache:()=>vo,_saveToConfigCache:()=>go,_widgetDefKeysToOmit:()=>Kg,applyJsonLogic:()=>Fg,cleanJSX:()=>zo,compileConfig:()=>Ms,compressConfig:()=>ks,configKeys:()=>nn,createConfigMemo:()=>Ks,decompressConfig:()=>_s,extendConfig:()=>xt,findExtendedConfigInAllMemos:()=>Ws,getCommonMemo:()=>$s,getFieldConfig:()=>Re,getFieldId:()=>po,getFieldParts:()=>Nr,getFieldPath:()=>an,getFieldPathParts:()=>zg,getFieldRawConfig:()=>qt,getFieldSrc:()=>Zs,getFieldWidgetConfig:()=>dt,getFirstField:()=>ec,getFuncArgConfig:()=>Ni,getFuncConfig:()=>Wr,getFuncSignature:()=>Di,getOperatorConfig:()=>lr,isDirtyJSX:()=>Oa,isFieldDescendantOfField:()=>Xs,isJSX:()=>Ho,iterateFields:()=>Ys,iterateFuncs:()=>ta,normalizeField:()=>fo});var X={};y.r(X),y.d(X,{_mongodbFormat:()=>hc,_spelFormat:()=>el,_sqlFormat:()=>Fc,elasticSearchFormat:()=>jc,jsonLogicFormat:()=>Yg,mongodbFormat:()=>nm,queryBuilderFormat:()=>Hg,queryString:()=>Ll,spelFormat:()=>Ev,sqlFormat:()=>sm});var ee={};y.r(ee),y.d(ee,{fixListValuesGroupOrder:()=>Im,getListValue:()=>ro,listValueToOption:()=>xm,mergeListValues:()=>jm,optionToListValue:()=>Rm,optionsToListValues:()=>Pm,simulateAsyncFetch:()=>wm});var Y={};y.r(Y),y.d(Y,{Autocomplete:()=>ee,ConfigUtils:()=>W,DefaultUtils:()=>T,ExportUtils:()=>$,FuncUtils:()=>I,ListUtils:()=>A,OtherUtils:()=>D,RuleUtils:()=>j,TreeUtils:()=>x,Validation:()=>E,checkTree:()=>Oi,clone:()=>kt(),compressConfig:()=>ks,decompressConfig:()=>_s,getSwitchValues:()=>xu,i18n:()=>ag,isValidTree:()=>hi,moment:()=>Jn(),sanitizeTree:()=>ds,uuid:()=>cr,validateAndFixTree:()=>fs,validateTree:()=>cs});var Z={};y.r(Z),y.d(Z,{LINEAR_REGRESSION:()=>_m,LOWER:()=>Nm,NOW:()=>Vm,RELATIVE_DATETIME:()=>Dm,UPPER:()=>km});var de={};y.r(de),y.d(de,{addCaseGroup:()=>Th,addDefaultCaseGroup:()=>Ch,addGroup:()=>Eh,addRule:()=>Sh,moveItem:()=>Lh,removeGroup:()=>Ah,removeRule:()=>Fh,setTree:()=>bh});var H={};y.r(H),y.d(H,{setConjunction:()=>wh,setLock:()=>Rh,setNot:()=>jh});var Oe={};y.r(Oe),y.d(Oe,{setField:()=>Ph,setFieldSrc:()=>xh,setFuncValue:()=>Nh,setOperator:()=>Ih,setOperatorOption:()=>kh,setValue:()=>Vh,setValueSrc:()=>Dh});var We={};y.r(We),y.d(We,{bindActionCreators:()=>Ld,isUsingLegacyReactDomRender:()=>Ad,liteShouldComponentUpdate:()=>Fo,pureShouldComponentUpdate:()=>aa,useOnPropsChanged:()=>ht});var Je={};y.r(Je),y.d(Je,{FuncWidget:()=>uu,ValueFieldWidget:()=>gp,VanillaBooleanWidget:()=>kO,VanillaButton:()=>XO,VanillaButtonGroup:()=>eb,VanillaConjs:()=>QO,VanillaDateTimeWidget:()=>BO,VanillaDateWidget:()=>GO,VanillaFieldSelect:()=>qO,VanillaIcon:()=>ZO,VanillaMultiSelectWidget:()=>WO,VanillaNumberWidget:()=>HO,VanillaProvider:()=>ab,VanillaSelectWidget:()=>zO,VanillaSliderWidget:()=>JO,VanillaSwitch:()=>tb,VanillaTextAreaWidget:()=>MO,VanillaTextWidget:()=>_O,VanillaTimeWidget:()=>UO,VanillaValueSources:()=>rb,vanillaConfirm:()=>nb});var ke={};y.r(ke),y.d(ke,{ProximityOperator:()=>fu});var je=y(50877),he=(n=>(n.Timeseries="time_series",n.Table="table",n))(he||{});const qe=[{label:"Time series",value:"time_series"},{label:"Table",value:"table"}],Ue=n=>({label:n,value:n}),er=je.z??Ue;var fr=y(13288),Be=y(75505),Qe=y(81160),pr=y(41987),Ir=y(92053),rt=y(43127),jt=y(78368),vr=y(98765),ut=y(26657),be=y(72574),ue=y(14110),fe=y(17172),_e=y(47773),Me=y(2543);class oe{transformMetricFindResponse(e){const t=[],r=e.fields.find(o=>o.name==="__text"),a=e.fields.find(o=>o.name==="__value");if(r&&a)for(let o=0;o<r.values.length;o++)t.push({text:""+r.values[o],value:""+a.values[o]});else for(const o of e.fields)for(const u of o.values)t.push({text:u});return(0,Me.uniqBy)(t,"text")}}var k=y(74848),F=y(96540),rr=y(16817),gt=y(68402),Jr=(n=>(n.String="string",n))(Jr||{}),br=(n=>(n.Property="property",n.Operator="operator",n.Or="or",n.And="and",n.GroupBy="groupBy",n.Function="function",n.FunctionParameter="functionParameter",n))(br||{});function ca(n){return`SELECT ${n.map(t=>{let r="";return t.name&&t.alias?r+=`${t.name}(${t.parameters?.map(a=>`${a.name}`)}) AS ${t.alias}`:t.name?r+=`${t.name}(${t.parameters?.map(a=>`${a.name}`)})`:t.alias?r+=`${t.parameters?.map(a=>`${a.name}`)} AS ${t.alias}`:r+=`${t.parameters?.map(a=>`${a.name}`)}`,r}).join(", ")} `}const Wt=n=>{if(!n)return!1;const e=n.some(r=>r.parameters?.length||r.parameters?.some(a=>a.name)),t=n.some(r=>r.name);return e||t};function da(n){return{type:br.GroupBy,property:{type:Jr.String,name:n}}}function fa(n){return{type:br.Property,property:{type:Jr.String,name:n}}}function On(n){return{type:br.Function,name:n,parameters:[]}}function ln(n){let e=n?.editorMode||vr.lX.Builder;return n?.editorMode===void 0&&n?.rawSql!==void 0&&(e=vr.lX.Code),{...n,refId:n?.refId||"A",format:n?.format!==void 0?n.format:he.Table,rawSql:n?.rawSql||"",editorMode:e,sql:n?.sql??{columns:[On()],groupBy:[da()],limit:50}}}var pa=y(73287),qr=y(13544),Do=y(6191),No=y(22354),tt=y(31347),sn=y(9e4),Rt=y(81580),bn=y(15292),Kt=y(55852),cn=y(56034),va=y(94354),Yr=y(32196),Sn=y(40845),ga=y(37390),dn=y(14578);function ko({isOpen:n,onCancel:e,onDiscard:t,onCopy:r}){const a=(0,F.useRef)(null),o=(0,Sn.of)(_a);return(0,F.useEffect)(()=>{n&&a.current?.focus()},[n]),(0,k.jsxs)(ga.a,{title:(0,k.jsxs)("div",{className:"modal-header-title",children:[(0,k.jsx)(dn.I,{name:"exclamation-triangle",size:"lg"}),(0,k.jsx)("span",{className:o.titleText,children:"Warning"})]}),onDismiss:e,isOpen:n,children:[(0,k.jsx)("p",{children:"Builder mode does not display changes made in code. The query builder will display the last changes you made in builder mode."}),(0,k.jsx)("p",{children:"Do you want to copy your code to the clipboard?"}),(0,k.jsxs)(ga.a.ButtonRow,{children:[(0,k.jsx)(Kt.$n,{type:"button",variant:"secondary",onClick:e,fill:"outline",children:"Cancel"}),(0,k.jsx)(Kt.$n,{variant:"destructive",type:"button",onClick:t,ref:a,children:"Discard code and switch"}),(0,k.jsx)(Kt.$n,{variant:"primary",onClick:r,children:"Copy code and switch"})]})]})}const _a=n=>({titleText:(0,Yr.css)({paddingLeft:n.spacing(2)})});var Tt=y(90182),fn=y(32264);const Rn=()=>!!fn.$.featureToggles.sqlDatasourceDatabaseSelection,mu=({dataset:n,db:e,dialect:t,onChange:r,inputId:a,preconfiguredDataset:o})=>{const u=!!o||t==="postgres",i=(0,rr.A)(async()=>Rn()&&u?(r(er(o)),[er(o)]):(n&&r(er(n)),(await e.datasets()).map(er)),[]);return(0,F.useEffect)(()=>{Rn()||(n?i.value&&i.value.find(l=>l.value===n)===void 0&&i.value.length>0&&r(i.value[0]):i.value&&i.value[0]&&r(i.value[0]))},[i.value,r,n]),(0,k.jsx)(Tt.l6,{"aria-label":"Dataset selector",inputId:a,value:n,options:i.value,onChange:r,disabled:i.loading,isLoading:i.loading,menuShouldPortal:!0})},_o=({db:n,dataset:e,table:t,className:r,onChange:a,inputId:o})=>{const u=(0,rr.A)(async()=>e?(await n.tables(e)).map(je.z):[],[e]);return(0,k.jsx)(Tt.l6,{className:r,disabled:u.loading,"aria-label":"Table selector",inputId:o,"data-testid":qr.Tp.components.SQLQueryEditor.headerTableSelector,value:t,options:u.value,onChange:a,isLoading:u.loading,menuShouldPortal:!0,placeholder:u.loading?"Loading tables":"Select table"})},Mo=[{label:"Builder",value:vr.lX.Builder},{label:"Code",value:vr.lX.Code}];function Go({db:n,dialect:e,isQueryRunnable:t,onChange:r,onQueryRowChange:a,onRunQuery:o,preconfiguredDataset:u,query:i,queryRowFilter:l}){const{editorMode:s}=i,[c,d]=(0,pa.A)(),[f,p]=(0,F.useState)(!1),g=n.toRawSql,v=(0,F.useId)(),m=(0,F.useCallback)(C=>{if(C===vr.lX.Code&&(0,ue.rR)("grafana_sql_editor_mode_changed",{datasource:i.datasource?.type,selectedEditorMode:vr.lX.Code}),s===vr.lX.Code){p(!0);return}r({...i,editorMode:C})},[s,r,i]),h=C=>{const L={...i,format:C.value!==void 0?C.value:he.Table};(0,ue.rR)("grafana_sql_format_changed",{datasource:i.datasource?.type,selectedFormat:L.format}),r(L)},O=C=>{if(C.value===i.dataset)return;const L={...i,dataset:C.value,table:void 0,sql:void 0,rawSql:""};r(L)},b=C=>{if(C.value===i.table)return;const L={...i,table:C.value,sql:void 0,rawSql:""};r(L)},S=()=>!(e==="influx"||!Rn()&&e==="postgres");return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)(Do.X,{children:[(0,k.jsx)(No.W,{label:"Format",value:i.format,placeholder:"Select format",menuShouldPortal:!0,onChange:h,options:qe}),s===vr.lX.Builder&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(bn.K,{id:`sql-filter-${v}`,label:"Filter","data-testid":qr.Tp.components.SQLQueryEditor.headerFilterSwitch,transparent:!0,showLabel:!0,value:l.filter,onChange:C=>{C.target instanceof HTMLInputElement&&((0,ue.rR)("grafana_sql_filter_toggled",{datasource:i.datasource?.type,displayed:C.target.checked}),a({...l,filter:C.target.checked}))}}),(0,k.jsx)(bn.K,{id:`sql-group-${v}`,label:"Group","data-testid":qr.Tp.components.SQLQueryEditor.headerGroupSwitch,transparent:!0,showLabel:!0,value:l.group,onChange:C=>{C.target instanceof HTMLInputElement&&((0,ue.rR)("grafana_sql_group_toggled",{datasource:i.datasource?.type,displayed:C.target.checked}),a({...l,group:C.target.checked}))}}),(0,k.jsx)(bn.K,{id:`sql-order-${v}`,label:"Order","data-testid":qr.Tp.components.SQLQueryEditor.headerOrderSwitch,transparent:!0,showLabel:!0,value:l.order,onChange:C=>{C.target instanceof HTMLInputElement&&((0,ue.rR)("grafana_sql_order_toggled",{datasource:i.datasource?.type,displayed:C.target.checked}),a({...l,order:C.target.checked}))}}),(0,k.jsx)(bn.K,{id:`sql-preview-${v}`,label:"Preview","data-testid":qr.Tp.components.SQLQueryEditor.headerPreviewSwitch,transparent:!0,showLabel:!0,value:l.preview,onChange:C=>{C.target instanceof HTMLInputElement&&((0,ue.rR)("grafana_sql_preview_toggled",{datasource:i.datasource?.type,displayed:C.target.checked}),a({...l,preview:C.target.checked}))}})]}),(0,k.jsx)(tt.Z,{grow:1}),t?(0,k.jsx)(Kt.$n,{icon:"play",variant:"primary",size:"sm",onClick:()=>o(),children:"Run query"}):(0,k.jsx)(cn.m,{theme:"error",content:(0,k.jsxs)(k.Fragment,{children:["Your query is invalid. Check below for details. ",(0,k.jsx)("br",{}),"However, you can still run this query."]}),placement:"top",children:(0,k.jsx)(Kt.$n,{icon:"exclamation-triangle",variant:"secondary",size:"sm",onClick:()=>o(),children:"Run query"})}),(0,k.jsx)(va.z,{options:Mo,size:"sm",value:s,onChange:m}),(0,k.jsx)(ko,{isOpen:f,onCopy:()=>{(0,ue.rR)("grafana_sql_editor_mode_changed",{datasource:i.datasource?.type,selectedEditorMode:vr.lX.Builder,type:"copy"}),p(!1),d(i.rawSql),r({...i,rawSql:g(i),editorMode:vr.lX.Builder})},onDiscard:()=>{(0,ue.rR)("grafana_sql_editor_mode_changed",{datasource:i.datasource?.type,selectedEditorMode:vr.lX.Builder,type:"discard"}),p(!1),r({...i,rawSql:g(i),editorMode:vr.lX.Builder})},onCancel:()=>{(0,ue.rR)("grafana_sql_editor_mode_changed",{datasource:i.datasource?.type,selectedEditorMode:vr.lX.Builder,type:"cancel"}),p(!1)}})]}),s===vr.lX.Builder&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(gt.$,{v:.5}),(0,k.jsxs)(sn.U,{children:[S()&&(0,k.jsx)(Rt.c,{label:"Dataset",width:25,children:(0,k.jsx)(mu,{db:n,inputId:`sql-dataset-${v}`,dataset:i.dataset,dialect:e,preconfiguredDataset:u,onChange:O})}),(0,k.jsx)(Rt.c,{label:"Table",width:25,children:(0,k.jsx)(_o,{db:n,inputId:`sql-tableselect-${v}`,dataset:i.dataset||u,table:i.table,onChange:b})})]})]})]})}var Ma=y(49185),Ga=y(70713),Ua=y(6867);function Ba({children:n,onChange:e,query:t,width:r,height:a,editorLanguageDefinition:o}){const u=(0,F.useRef)(t);(0,F.useEffect)(()=>{u.current=t},[t]);const i=(0,F.useCallback)((l,s)=>{const c={...u.current,rawQuery:!0,rawSql:l};e(c,s)},[e]);return(0,k.jsx)(Ua.Y,{width:r,height:a,query:t.rawSql,onChange:i,language:o,children:n})}var $a=y(66864),ma=y(29158),Uo=y(41053),Wa=y(75198),Ka=y(83195),Er=y(62930);function Nt({db:n,query:e,onValidate:t,range:r}){const[a,o]=(0,F.useState)(),u=(0,Sn.$j)(),i=(0,F.useMemo)(()=>(0,Ka.j_)("bytes"),[]),l=(0,F.useMemo)(()=>({error:(0,Yr.css)({color:u.colors.error.text,fontSize:u.typography.bodySmall.fontSize,fontFamily:u.typography.fontFamilyMonospace}),valid:(0,Yr.css)({color:u.colors.success.text}),info:(0,Yr.css)({color:u.colors.text.secondary})}),[u]),[s,c]=(0,Uo.A)(async f=>f.rawSql?.trim()===""?null:await n.validateQuery(f,r),[n]),[,]=(0,Wa.A)(async()=>{const f=await c(e);return f&&o(f),null},1e3,[e,c]);if((0,F.useEffect)(()=>{a?.isError&&t(!1),a?.isValid&&t(!0)},[a,t]),!s.value&&!s.loading)return null;const d=s.value?.error?Bo(s.value.error):"";return(0,k.jsxs)(k.Fragment,{children:[s.loading&&(0,k.jsxs)("div",{className:l.info,children:[(0,k.jsx)(Er.y,{inline:!0,size:"xs"})," Validating query..."]}),!s.loading&&s.value&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(k.Fragment,{children:s.value.isValid&&s.value.statistics&&(0,k.jsxs)("div",{className:l.valid,children:[(0,k.jsx)(dn.I,{name:"check"})," This query will process"," ",(0,k.jsx)("strong",{children:(0,Ka.cN)(i(s.value.statistics.TotalBytesProcessed))})," ","when run."]})}),(0,k.jsx)(k.Fragment,{children:s.value.isError&&(0,k.jsx)("div",{className:l.error,children:d})})]})]})}function Bo(n){const e=n.split(":");return e.length>2?e.slice(2).join(":"):n}function za({showTools:n,onFormatCode:e,onExpand:t,isExpanded:r,...a}){const o=(0,Sn.$j)(),[u,i]=(0,F.useState)(),l=(0,F.useMemo)(()=>({container:(0,Yr.css)({border:`1px solid ${o.colors.border.medium}`,borderTop:"none",padding:o.spacing(.5,.5,.5,.5),display:"flex",flexGrow:1,justifyContent:"space-between",fontSize:o.typography.bodySmall.fontSize}),error:(0,Yr.css)({color:o.colors.error.text,fontSize:o.typography.bodySmall.fontSize,fontFamily:o.typography.fontFamilyMonospace}),valid:(0,Yr.css)({color:o.colors.success.text}),info:(0,Yr.css)({color:o.colors.text.secondary}),hint:(0,Yr.css)({color:o.colors.text.disabled,whiteSpace:"nowrap",cursor:"help"})}),[o]);let s={};return!n&&u===void 0&&(s={height:0,padding:0,visibility:"hidden"}),(0,k.jsxs)("div",{className:l.container,style:s,children:[(0,k.jsx)("div",{children:a.onValidate&&(0,k.jsx)(Nt,{...a,onValidate:c=>{i(c),a.onValidate(c)}})}),n&&(0,k.jsx)("div",{children:(0,k.jsxs)($a.Gy,{spacing:"sm",children:[e&&(0,k.jsx)(ma.K,{onClick:()=>{(0,ue.rR)("grafana_sql_query_formatted",{datasource:a.query.datasource?.type}),e()},name:"brackets-curly",size:"xs",tooltip:"Format query"}),t&&(0,k.jsx)(ma.K,{onClick:()=>{(0,ue.rR)("grafana_sql_editor_expand",{datasource:a.query.datasource?.type,expanded:!r}),t(!r)},name:r?"angle-up":"angle-down",size:"xs",tooltip:r?"Collapse editor":"Expand editor"}),(0,k.jsx)(cn.m,{content:"Hit CTRL/CMD+Return to run query",children:(0,k.jsx)(dn.I,{className:l.hint,name:"keyboard"})})]})})]})}function $o({db:n,query:e,onChange:t,onRunQuery:r,onValidate:a,queryToValidate:o,range:u}){const i=(0,Sn.$j)(),l=(0,Sn.of)(_r),[s,c]=(0,F.useState)(!1),[d,f]=(0,Ma.A)(),[p,g]=(0,Ma.A)(),v=(0,F.useMemo)(()=>n.getEditorLanguageDefinition(),[n]),m=(b,S)=>(0,k.jsx)(Ba,{editorLanguageDefinition:v,query:e,width:b,height:S?S-f.height:void 0,onChange:t,children:({formatQuery:C})=>(0,k.jsx)("div",{ref:d,children:(0,k.jsx)(za,{db:n,query:o,onValidate:a,onFormatCode:C,showTools:!0,range:u,onExpand:c,isExpanded:s})})}),h=(b=!1)=>b?(0,k.jsx)(Ga.Ay,{children:({width:S,height:C})=>m(S,C)}):(0,k.jsx)("div",{ref:p,children:m()}),O=()=>(0,k.jsx)("div",{style:{width:g.width,height:g.height,background:i.colors.background.primary,display:"flex",alignItems:"center",justifyContent:"center"},children:"Editing in expanded code editor"});return(0,k.jsxs)(k.Fragment,{children:[s?O():h(),s&&(0,k.jsx)(ga.a,{title:`Query ${e.refId}`,closeOnBackdropClick:!1,closeOnEscape:!1,className:l.modal,contentClassName:l.modalContent,isOpen:s,onDismiss:()=>{(0,ue.rR)("grafana_sql_editor_expand",{datasource:e.datasource?.type,expanded:!1}),c(!1)},children:h(!0)})]})}function _r(n){return{modal:(0,Yr.css)({width:"95vw",height:"95vh"}),modalContent:(0,Yr.css)({height:"100%",paddingTop:0})}}var Mr=y(71087),Et=y(11807);function zt({query:n,onQueryChange:e,db:t}){return{onSqlChange:(0,F.useCallback)(a=>{const o=t.toRawSql,u=o({sql:a,dataset:n.dataset,table:n.table,refId:n.refId}),i={...n,sql:a,rawSql:u};e(i)},[t,e,n])}}var Pn=y(85269),Ha=y(81392),Fn=y(3721);function Sr({sql:n,columns:e,onSqlChange:t}){const r=(0,F.useCallback)(a=>{const o=a.map(i=>da(i.property?.name)),u={...n,groupBy:o};t(u)},[t,n]);return(0,k.jsx)(Pn.o,{items:n.groupBy,onChange:r,renderItem:Ar({options:e})})}function Ar({options:n}){return function(t,r,a){return(0,k.jsxs)(Ha.M,{children:[(0,k.jsx)(Tt.l6,{value:t.property?.name?(0,je.z)(t.property.name):null,"aria-label":"Group by",options:n,menuShouldPortal:!0,onChange:({value:o})=>o&&r(da(o))}),(0,k.jsx)(Fn.Z,{title:"Remove group by column",icon:"times",variant:"secondary",onClick:a})]})}}function nt({fields:n,query:e,onQueryChange:t,db:r}){const{onSqlChange:a}=zt({query:e,onQueryChange:t,db:r});return(0,k.jsx)(Sr,{columns:n,sql:e.sql,onSqlChange:a})}var xn=y(10354);const Wn=[{description:"Sort by ascending",value:"ASC",icon:"sort-amount-up"},{description:"Sort by descending",value:"DESC",icon:"sort-amount-down"}];function Wo({sql:n,onSqlChange:e,columns:t,showOffset:r}){const a=(0,F.useCallback)(l=>{const s={...n,orderByDirection:l};e(s)},[e,n]),o=(0,F.useCallback)(l=>{const s={...n,limit:Number.parseInt(l.currentTarget.value,10)};e(s)},[e,n]),u=(0,F.useCallback)(l=>{const s={...n,offset:Number.parseInt(l.currentTarget.value,10)};e(s)},[e,n]),i=(0,F.useCallback)(l=>{const s={...n,orderBy:fa(l?.value)};l===null&&(s.orderByDirection=void 0),e(s)},[e,n]);return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Rt.c,{label:"Order by",width:25,children:(0,k.jsxs)(Ha.M,{children:[(0,k.jsx)(Tt.l6,{"aria-label":"Order by",options:t,value:n.orderBy?.property.name?(0,je.z)(n.orderBy.property.name):null,isClearable:!0,menuShouldPortal:!0,onChange:i}),(0,k.jsx)(gt.$,{h:1.5}),(0,k.jsx)(va.z,{options:Wn,disabled:!n?.orderBy?.property.name,value:n.orderByDirection,onChange:a})]})}),(0,k.jsx)(Rt.c,{label:"Limit",optional:!0,width:25,children:(0,k.jsx)(xn.p,{type:"number",min:0,id:(0,Me.uniqueId)("limit-"),value:n.limit||"",onChange:o})}),r&&(0,k.jsx)(Rt.c,{label:"Offset",optional:!0,width:25,children:(0,k.jsx)(xn.p,{type:"number",id:(0,Me.uniqueId)("offset-"),value:n.offset||"",onChange:u})})]})}function ha({fields:n,query:e,onQueryChange:t,db:r}){const{onSqlChange:a}=zt({query:e,onQueryChange:t,db:r});let o=[];return n&&(o=[{value:"",label:"Selected columns",options:e.sql?.columns?.map((i,l)=>{const s=i.name?`${i.name}(${i.parameters?.map(c=>c.name)})`:i.parameters?.map(c=>c.name);return{value:s,label:`${l+1} - ${s}`}}),expanded:!0},...n]),(0,k.jsx)(Wo,{sql:e.sql,onSqlChange:a,columns:o})}const Ke=["AVG","COUNT","MAX","MIN","SUM"],At=["$__time","$__timeEpoch","$__timeFilter","$__timeFrom","$__timeTo","$__timeGroup","$__timeGroupAlias","$__unixEpochFilter","$__unixEpochNanoFilter","$__unixEpochNanoFrom","$__unixEpochNanoTo","$__unixEpochGroup","$__unixEpochGroupAlias"];var G=y(46819);const re={label:"*",value:"*"};function Se({sql:n,format:e,columns:t,onSqlChange:r,functions:a}){const o=(0,Sn.of)(He),u=[re,...t||[]],i=[];e===he.Timeseries&&(i.push({label:"time",value:"time"}),i.push({label:"value",value:"value"}));const l=(0,F.useCallback)((p,g)=>v=>{let m={...p};p.parameters?.length?m.parameters=p.parameters.map(O=>O.type===br.FunctionParameter?{...O,name:v.value}:O):m.parameters=[{type:br.FunctionParameter,name:v.value}];const h={...n,columns:n.columns?.map((O,b)=>b===g?m:O)};r(h)},[r,n]),s=(0,F.useCallback)((p,g)=>v=>{const m={...p,name:v?.value},h={...n,columns:n.columns?.map((O,b)=>b===g?m:O)};r(h)},[r,n]),c=(0,F.useCallback)((p,g)=>v=>{let m={...p};v!==null?m={...p,alias:`"${v?.value?.trim()}"`}:delete m.alias;const h={...n,columns:n.columns?.map((O,b)=>b===g?m:O)};r(h)},[r,n]),d=(0,F.useCallback)(p=>()=>{const g=[...n.columns];g.splice(p,1);const v={...n,columns:g};r(v)},[r,n]),f=(0,F.useCallback)(()=>{const p={...n,columns:[...n.columns,On()]};r(p)},[r,n]);return(0,k.jsxs)(G.B,{gap:2,wrap:!0,direction:"column",children:[n.columns?.map((p,g)=>(0,k.jsx)("div",{children:(0,k.jsxs)(G.B,{gap:2,alignItems:"end",children:[(0,k.jsx)(Rt.c,{label:"Column",width:25,children:(0,k.jsx)(Tt.l6,{value:mt(p),"data-testid":qr.Tp.components.SQLQueryEditor.selectColumn,options:u,inputId:`select-column-${g}-${(0,Me.uniqueId)()}`,menuShouldPortal:!0,allowCustomValue:!0,onChange:l(p,g)})}),(0,k.jsx)(Rt.c,{label:"Aggregation",optional:!0,width:25,children:(0,k.jsx)(Tt.l6,{value:p.name?(0,je.z)(p.name):null,inputId:`select-aggregation-${g}-${(0,Me.uniqueId)()}`,"data-testid":qr.Tp.components.SQLQueryEditor.selectAggregation,isClearable:!0,menuShouldPortal:!0,allowCustomValue:!0,options:a,onChange:s(p,g)})}),(0,k.jsx)(Rt.c,{label:"Alias",optional:!0,width:15,children:(0,k.jsx)(Tt.l6,{value:p.alias?(0,je.z)(p.alias):null,inputId:`select-alias-${g}-${(0,Me.uniqueId)()}`,"data-testid":qr.Tp.components.SQLQueryEditor.selectAlias,options:i,onChange:c(p,g),isClearable:!0,menuShouldPortal:!0,allowCustomValue:!0})}),(0,k.jsx)(Kt.$n,{title:"Remove column",type:"button",icon:"trash-alt",variant:"secondary",size:"md",onClick:d(g)})]})},g)),(0,k.jsx)(Kt.$n,{type:"button",onClick:f,variant:"secondary",title:"Add column",size:"md",icon:"plus",className:o.addButton})]})}const He=()=>({addButton:(0,Yr.css)({alignSelf:"flex-start"})});function mt({parameters:n}){const e=n?.find(t=>t.type===br.FunctionParameter);return e?.name?(0,je.z)(e.name):null}function lt({fields:n,query:e,onQueryChange:t,db:r}){const{onSqlChange:a}=zt({query:e,onQueryChange:t,db:r}),o=[...Ke,...r.functions?.()||[]].map(je.z);return(0,k.jsx)(Se,{columns:n,sql:e.sql,format:e.format,functions:o,onSqlChange:a})}var _p=y(24705),mr=y(23029),hr=y(92901),Fr=y(56822),we=y(53954),yr=y(85501),ne=y(64467),Le=y(5544),Fe=y(60436),Cr=y(82284),ye=y(49568),Mp=0;const cr=function(){var n=(new Date().getTime().toString(16)+"FF").substr(0,11),e="ssssssss-xxxx-4xxx-yxxx-x".replace(/[xys]/g,function(t){var r=t==="s"?Math.floor(Math.random()*16):Mp++&15,a=t==="x"?r:r&3|8;return a.toString(16)});return e+n};function hu(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Gp(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?hu(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):hu(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var In=["formatValue","mongoFormatValue","sqlFormatValue","jsonLogic","elasticSearchFormatValue","spelFormatValue","spelImportFuncs","spelImportValue"],Kn=["formatOp","mongoFormatOp","sqlFormatOp","jsonLogic","spelFormatOp"],Ja=function(e){return(0,Cr.A)(e)==="object"&&e!==null&&Object.prototype.toString.call(e)==="[object Object]"},yu=function(e){if((0,Cr.A)(e)==="object"&&e!==null){if(Array.isArray(e))return(0,Fe.A)(e);if(Ja(e))return Gp({},e)}return e},Pt=function(e,t){return Object.fromEntries(Object.entries(e).filter(function(r){var a=(0,Le.A)(r,1),o=a[0];return!t.includes(o)}))},Br=function(e){var t;return(t=e?.cardinality)!==null&&t!==void 0?t:1},qa=function(e,t){return e===t?!0:ye.Map.isMap(e)?e.equals(t):JSON.stringify(e)==JSON.stringify(t)},ya=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return e===t?!0:Array.isArray(e)?Up(e,t,r):ye.Map.isMap(e)?e.equals(t):(0,Cr.A)(e)=="object"?Bp(e,t,r):e===t};function Up(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(n===e)return!0;if(!n||!e)return!1;var r=n.length;if(e.length!==r)return!1;for(var a=0;a<r;a++){var o=t?ya(n[a],e[a],t):n[a]===e[a];if(!o)return!1}return!0}function Bp(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(n===e)return!0;if(!n||!e)return!1;var r=Object.keys(n),a=Object.keys(e),o=r.length;if(a.length!==o)return!1;for(var u=0;u<o;u++){var i=r[u],l=t?ya(n[i],e[i],t):n[i]===e[i];if(!l)return!1}return!0}var zn=function(e){return(0,Cr.A)(e)==="object"&&e!==null&&typeof e.toJS=="function"},Qa=function(e){return zn(e)&&ye.default.isList(e)};function $r(n){return Qa(n)?n:new ye.default.List(n)}function Ko(n){return zn(n)?n.toJS():n}var Ou=function(e){return e.replace(/[.*+?^${}()|[\]\\/]/g,"\\$&")},bu=function(e,t,r,a,o,u){if(Array.isArray(e))return t},zo=function n(e){var t=["$$typeof","_owner","_store","ref","key"],r=function(i){return typeof i=="string"?i:typeof i=="function"?i.name:i};if(e instanceof Array)return e.map(function(u,i){return n(u)});if((0,Cr.A)(e)==="object"&&e!==null&&Oa(e)){var a,o=Pt(e,t);return o.type&&(o.type=r(o.type)),o!=null&&(a=o.props)!==null&&a!==void 0&&a.children&&(o.props.children=n(o.props.children)),o}return e},Oa=function(e){return(0,Cr.A)(e)==="object"&&e!==null&&!Array.isArray(e)&&Object.keys(e).includes("type")&&Object.keys(e).includes("props")&&Object.keys(e).includes("key")&&Object.keys(e).includes("ref")&&Object.keys(e).includes("$$typeof")},Ho=function(e){return(0,Cr.A)(e)==="object"&&e!==null&&!Array.isArray(e)&&typeof e.type=="string"&&Object.keys(e).includes("props")},st=function(e){var t=(0,Cr.A)(e)==="object"&&e!==null&&!Array.isArray(e)&&Object.keys(e).length===1;return t};function Su(n){return new Promise(function(e){setTimeout(e,n)})}function Ya(n,e){return n||(n=[]),e||(e=[]),e.map(function(t){return[t,n.indexOf(t)]}).map(function(t,r,a){var o=(0,Le.A)(t,2),u=o[0],i=o[1];if(i==-1){var l=a.slice(r+1),s=a.slice(0,r),c=s.reverse().find(function(f){var p=(0,Le.A)(f,2),g=p[0],v=p[1];return v!=-1}),d=l.find(function(f){var p=(0,Le.A)(f,2),g=p[0],v=p[1];return v!=-1});return d?[u,"before",d[0]]:c?[u,"after",c[0]]:[u,"append",null]}else return null}).filter(function(t){return t!==null}).reduce(function(t,r){var a=(0,Le.A)(r,3),o=a[0],u=a[1],i=a[2],l=t.indexOf(i);return t.indexOf(o)==-1&&(l>-1?t.splice(l+(u=="after"?1:0),0,o):t.splice(u=="append"?1/0:0,0,o)),t},n.slice())}var Fu=function n(e){(0,Cr.A)(e)==="object"&&e!==null&&!Oa(e)&&(Object.keys(e).forEach(function(t){t!=="__cache"&&n(e[t])}),Object.freeze(e))},Cu=function n(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[];if(Ja(e)){if(e.var)return r[e.var]=t,!0;if(!Ja(t))return!1;for(var o in e){var u=e[o],i=t[o];if(!n(u,i,r,[].concat((0,Fe.A)(a),[o])))return!1}return!0}else if(Array.isArray(e)){if(!Array.isArray(t))return!1;for(var l=0;l<e.length;l++){var s=e[l],c=t[l];if(!n(s,c,r,[].concat((0,Fe.A)(a),[l])))return!1}return!0}else return e===t},$p=function(){return typeof process<"u"&&process.env&&!1},Tu=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=e??$p();return t?console:{error:function(){},log:function(){},warn:function(){},debug:function(){},info:function(){}}},Eu=function(){for(var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t,r=0;r<e.length;r++){var a=e[r];if(a!==void 0){t=a;break}}return t},Cn=Tu(),Wp=y(54756),pn=y.n(Wp),Kp=y(44383),Xt=y.n(Kp),zp=y(68090),Xa=y.n(zp),Hp=y(90179),Za=y.n(Hp);function Jp(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=qp(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,u=!1,i;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return o=s.done,s},e:function(s){u=!0,i=s},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(u)throw i}}}}function qp(n,e){if(n){if(typeof n=="string")return Au(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Au(n,e)}}function Au(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function Lu(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function eo(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Lu(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Lu(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var Jo=function(e){return(0,Cr.A)(e)=="object"&&e!==null&&!Array.isArray(e)},vn=function(e,t){if(!(e==null||e==""))return Jo(e)?eo(eo({},e),{},{title:e.title||e.value}):{value:e,title:t!==void 0?t:""+e}},qo=function(e){var t=vn(e);return Jo(t)?eo(eo({},vn(e)),{},{isCustom:!0}):t},wu=function(e){if(Array.isArray(e))return e.map(function(o){return vn(o)});if(!Jo(e))return e;var t=[];for(var r in e){var a=e[r];t.push(vn(r,a))}return t},ba=function(e,t){if(Array.isArray(e)){var r=e.map(function(a){return vn(a)});return r.find(function(a){return""+a.value==""+t})}else return e[t]!==void 0?vn(t,e[t]):void 0},ju=function(e,t){if(e==null)return t;var r=ba(e,t);return r!==void 0?r.title:t},Qp=function(e,t){if(e==null)return t;var r=ba(e,t);return r!==void 0?r.value:t},Qo=function(e,t){var r=[];if(Array.isArray(e)){var a=Jp(e),o;try{for(a.s();!(o=a.n()).done;){var u=o.value,i=t(vn(u));i!=null&&r.push(i)}}catch(c){a.e(c)}finally{a.f()}}else for(var l in e){var s=t(vn(l,e[l]));s!=null&&r.push(s)}return r},Yp=function(e,t){return Qo(t,function(r){return"".concat(r.value).indexOf(e)!=-1||r.title.indexOf(e)!=-1?r:null}).filter(function(r){return r!==null}).shift()},ro=function(e,t){return Qo(t,function(r){return""+r.value==""+e?r:null}).filter(function(r){return r!==null}).shift()},Te=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];return e.interpose("children1").withMutations(function(o){return o.skip(1),o.push.apply(o,r),o})},Yo=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];return e.interpose("children1").withMutations(function(o){return o.push.apply(o,r),o})},Hn=function(e,t){var r=new ye.default.OrderedMap((0,ne.A)({},e.get("id"),e)),a=e;return t.forEach(function(o){var u;a=r.get(o),r=(u=a)===null||u===void 0?void 0:u.get("children1")}),a},Ru=function(e){var t=e;function r(a,o){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=o.push(a.get("id")),l=a.getIn(["properties","isLocked"]);u&&l&&(t=t.deleteIn(Te(i,"properties","isLocked")));var s=a.get("children1");s&&s.map(function(c,d){r(c,i,l||u)})}return r(e,new ye.default.List),t},Ht=function(e){var t=e;function r(a,o,u,i){if(a){var l=a.get("path"),s=a.get("id"),c=s||i||cr(),d=o.push(c);(!l||!l.equals(d))&&(t=t.setIn(Te(d,"path"),d)),s||(t=t.setIn(Te(d,"id"),c));var f=a.get("children1");f&&(f.constructor.name==="Map"&&(t=t.setIn(Te(d,"children1"),new ye.default.OrderedMap(f))),f.map(function(p,g){r(p,d,u+1,g)}))}}return r(e,new ye.default.List,0),t},to=function(e){var t=e;function r(a,o,u,i){if(!a)return!1;var l=a.get("id")||i,s=o.push(l),c=a.get("children1");if(c){var d=c.map(function(f,p){return r(f,s,u+1,p)}).reduce(function(f,p){return f&&p},!0);if((c.size==0||d)&&u>0)return t=t.deleteIn(Te(s)),!0}return!1}return r(e,new ye.default.List,0),t},Xo=function(e){var t=[],r={},a=[],o=0,u=0,i=0,l=0,s={};function c(v,m,h,O,b,S,C,L){var w=v===e,N=v.get("type"),V=v.get("collapsed"),P=v.get("id"),M=v.get("children1"),B=v.getIn(["properties","isLocked"]),_=M?M.map(function(Ee,Ne){return Ne}).valueSeq().toArray():null,q=N==="rule_group",K=N==="rule",J=N==="group",U=N==="case_group",te=!b&&(!M||q),Q=_?.length>0,ae=m.length?m[m.length-1]:null,ce=U?P:C;U&&(a.push(P),u=0,i=0,l=0,s={});var ie=ce?a.indexOf(ce):null,le=t.length,pe=o,se;w||(se={},se.caseNo=ie,se.globalNoByType=U?ie:s[N]||0,se.indexPath=[].concat((0,Fe.A)(m.slice(1).map(function(Ee){return r[Ee].childNo})),[L]),K?se.globalLeafNo=u:J&&(se.globalGroupNo=l)),t.push(P),r[P]={node:v,index:le,id:P,type:N,parent:ae,parentType:ae?r[ae].type:null,children:_,childNo:L,caseId:ce,caseNo:ie,path:m.concat(P),lev:S,isLeaf:!M,isAtomicRule:te,isLocked:B||O,top:h?null:pe,isDefaultCase:U?!M:void 0,atomicRulesCountInCase:U?0:void 0,position:se,collapsed:V,_top:le,leaf:!M};var me=0,Ce=0;h||(o+=1,me+=1,Q&&!V&&!q&&(Ce+=1),!w&&!U&&(J&&l++,te&&i++,K&&u++,s[N]=(s[N]||0)+1)),C&&te&&r[C].atomicRulesCountInCase++;var ge=0,Ae=0;if(Q){var Pe=0;M.map(function(Ee,Ne){if(Ee){c(Ee,m.concat(P),h||V,O||B,b||q,S+1,ce,Pe);var Xe=r[Ne];ge=Math.max(ge,Xe.depth||0),Ae+=Xe.height,Pe++}})}me+=Ae,Ce+=ge;var Ve=t.length,Ie=Ve-le,De=h?null:pe+me;Object.assign(r[P],{depth:M?Ce:void 0,_height:Ie,height:me,bottom:De})}c(e,[],!1,!1,!1,0,null,null);for(var d=0;d<t.length;d++){var f=d>0?t[d-1]:null,p=d<t.length-1?t[d+1]:null,g=r[t[d]];g.prev=f,g.next=p}return{flat:t,items:r,cases:a}},Xp=function(e){if(!e)return-1;var t=0;function r(a,o,u){var i,l,s;typeof a.get=="function"?(i=a.get("id"),l=a.get("children1"),s=a.get("type")):(i=a.id,l=a.children1,s=a.type);var c=s=="rule_group";t++,l&&!c&&l.map(function(d,f){d&&r(d,o.concat(i),u+1)})}return r(e,[],0),t-1},Zo=function(e){if(!e)return-1;var t=0;function r(a,o,u){var i,l,s;typeof a.get=="function"?(i=a.get("id"),l=a.get("children1"),s=a.get("type")):(i=a.id,l=a.children1,s=a.type),s=="rule"||s=="rule_group"?t++:l&&l.map(function(c,d){c&&r(c,o.concat(i),u+1)})}return r(e,[],0),t},Pu=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=e;function o(u,i){t&&u.path&&delete u.path,t&&!r&&i&&delete u.id;var l=u.properties;l&&l.operatorOptions==null&&delete l.operatorOptions;var s=u.children1;if(s){for(var c in s)s[c]&&o(s[c],c);r&&(u.children1=Object.values(s))}}return o(e,null),a},xu=function(e){var t=[],r=e.get("children1");return r&&r.map(function(a){var o=a.getIn(["properties","value"]),u;o&&o.size==1?(u=o.get(0),Array.isArray(u)&&u.length==0&&(u=null)):u=null,t=[].concat((0,Fe.A)(t),[u])}),t},ei=function(e){return!e.get("children1")||e.get("children1").size==0},ri=function(e,t){return e.getIn(Te(t,"children1")).size>0},ti=function(e){if(e!=null&&e.toJS){var t,r=e==null||(t=e.toJS)===null||t===void 0?void 0:t.call(e);return r!=null&&r.func?e.toOrderedMap():r}else return e},Zp=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(e){var a=e;return a=a.toJS(),a=Pu(a,t,r),a}},ni=function(e){if(Iu(e))return e;if(Vu(e))return Ht(Sa(e));if(typeof e=="string"&&e.startsWith('["~#iM"'))throw new Error("You are trying to load query in obsolete serialization format (Immutable string) which is not supported in versions starting from 2.1.17");if(typeof e=="string")return Ht(Sa(JSON.parse(e)));throw new Error("Can't load tree!")},Iu=function(e){return ye.Map.isMap(e)},Vu=function(e){return(0,Cr.A)(e)=="object"&&(e.type=="group"||e.type=="switch_group")};function Sa(n){var e=(0,ye.fromJS)(n,function(t,r,a){var o=a&&a.length>3&&a[a.length-1]==="value"&&a[a.length-3]==="args",u=a&&a.length>3&&a[a.length-1]==="value"&&a[a.length-2]==="properties",i;if(t=="properties"){i=r.toOrderedMap();for(var l=0;l<2;l++){var s,c,d;((s=i.get("value"))===null||s===void 0||(c=(d=s).get)===null||c===void 0?void 0:c.call(d,l))===null&&(i=i.setIn(["value",l],void 0))}}else o?i=ti(r):(a?u:t=="value")&&ye.default.Iterable.isIndexed(r)?i=r.map(ti).toList():t=="asyncListValues"?i=r.toJS():t=="children1"&&ye.default.Iterable.isIndexed(r)?i=new ye.default.OrderedMap(r.map(function(f){return[f?.get("id")||cr(),f]})):i=ye.default.Iterable.isIndexed(r)?r.toList():r.toOrderedMap();return i});return e}var Du=y(87695),ev=y(95093),Jn=y.n(ev);function Nu(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=rv(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,u=!1,i;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return o=s.done,s},e:function(s){u=!0,i=s},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(u)throw i}}}}function rv(n,e){if(n){if(typeof n=="string")return ku(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return ku(n,e)}}function ku(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function _u(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Zt(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?_u(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):_u(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var tv=function(e){return Array.from(new Set(e))},Jb=function(e){return e.reduce(function(t,r){var a=_slicedToArray(r,2),o=a[0],u=a[1];return Zt(Zt({},t),{},_defineProperty({},o,u))},{})},ai=function(e){return{errors:[],settings:e?.settings}},nv=function(e,t){return Mu(e,t,!1)},Mu=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=ai();a.settings={allowUnknownFields:!1,returnErrors:r};var o=xt(t,void 0,!1),u=av(o),i=e?qn(e,u,o,["rule","group","switch"],a):void 0,l=i?ni(i):void 0;return r?[l,a.errors]:(a.errors.length&&console.warn("Errors while importing from JsonLogic:",a.errors),l)},av=function(e){var t={};for(var r in e.operators){var a=e.operators[r];if(typeof a.jsonLogic=="string"){var o=(a._jsonLogicIsRevArgs?"#":"")+a.jsonLogic+"/"+Br(a);t[o]||(t[o]=[]),t[o].push(r)}else if(typeof a.jsonLogic2=="string"){var u=a.jsonLogic2+"/"+Br(a);t[u]||(t[u]=[]),t[u].push(r)}}var i={};for(var l in e.conjunctions){var s=e.conjunctions[l],c=s.jsonLogicConj||l.toLowerCase();i[c]=l}var d={},f=Nu(ta(e)),p;try{for(f.s();!(p=f.n()).done;){var g=(0,Le.A)(p.value,2),v=g[0],m=g[1],h=void 0;m.jsonLogicIsMethod?h="#"+m.jsonLogic:typeof m.jsonLogic=="string"&&(h=m.jsonLogic),h&&(d[h]||(d[h]=[]),d[h].push(v))}}catch(C){f.e(C)}finally{f.f()}var O=e.settings.jsonLogic,b=O.groupVarKey,S=O.altVarKey;return{operators:t,conjunctions:i,funcs:d,varKeys:["var",b,S]}},qn=function n(e,t,r,a,o){var u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1,i=arguments.length>6?arguments[6]:void 0,l=arguments.length>7?arguments[7]:void 0,s=arguments.length>8&&arguments[8]!==void 0?arguments[8]:null,c=arguments.length>9&&arguments[9]!==void 0?arguments[9]:!1,d,f;st(e)&&(d=Object.keys(e)[0],f=e[d],Array.isArray(f)||(f=[f]));var p,g=o.errors.length,v=r.settings.jsonLogic.lockedOp,m=d=="!"&&f.length==1&&f[0]&&st(f[0])&&t.varKeys.includes(Object.keys(f[0])[0]),h=d=="!"&&!m,O=v&&d==v,b=a.includes("switch"),S=b;O?p=n(f[0],t,r,a,o,u,i,l,s,!0):h?p=n(f[0],t,r,a,o,!u,i,l,s):a.includes("val")?p=Gu(d,f,t,r,u,o,s)||Uu(d,f,t,r,u,i,o,s)||ov(e,i,l,r,o):(a.includes("switch")&&(p=fv(d,f,t,r,u,o,s)),p==null&&a.includes("group")&&(p=Bu(d,f,t,r,u,o,s,!1)),p==null&&a.includes("rule")&&(p=dv(d,f,t,r,u,o,s)),p&&S&&!["group","switch_group"].includes(p.type)&&(p=Fa(p,r)));var C=o.errors.length;return d!="!"&&p===void 0&&C==g&&o.errors.push("Can't parse logic ".concat(JSON.stringify(e))),O&&(p.properties.isLocked=!0),p},ov=function(e,t,r,a,o){var u;if(e===void 0&&(e=t?.defaultValue),e!==void 0){r=r||t?.mainWidget;var i=a.widgets[r],l=t?.type;if(l&&!i){o.errors.push("No widget for type ".concat(l));return}if(st(e)){o.errors.push("Unexpected logic in value: ".concat(JSON.stringify(e)));return}if(l==="time"&&typeof e=="number"){var s=Math.floor(e/60/60)%24,c=Math.floor(e/60)%60,d=e%60,f=i.valueFormat;if(f){var p=new Date(e);p.setMilliseconds(0),p.setHours(s),p.setMinutes(c),p.setSeconds(d),e=Jn()(p).format(f)}else e="".concat(s,":").concat(c,":").concat(d)}if(["date","datetime"].includes(l)&&e&&!(e instanceof Date))try{var g=new Date(e);g instanceof Date&&g.toISOString()===e&&(e=g)}catch{o.errors.push("Can't convert value ".concat(e," as Date")),e=void 0}if(e instanceof Date&&t){var v=i.valueFormat;v&&(e=Jn()(e).format(v))}var m;if(e&&t!==null&&t!==void 0&&(u=t.fieldSettings)!==null&&u!==void 0&&u.asyncFetch){var h=Array.isArray(e)?e:[e];m=h}if(i!=null&&i.jsonLogicImport)try{e=i.jsonLogicImport.call(a.ctx,e)}catch(b){var O;o.errors.push("Can't import value ".concat(e," using import func of widget ").concat(r,": ").concat((O=b?.message)!==null&&O!==void 0?O:b)),e=void 0}return{valueSrc:"value",value:e,valueType:i?.type,asyncListValues:m}}},Gu=function(e,t,r,a,o,u){var i=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;if(r.varKeys.includes(e)&&typeof t[0]=="string"){var l,s=fo(a,t[0],i),c=Re(a,s);if(!c&&!((l=u.settings)!==null&&l!==void 0&&l.allowUnknownFields)){u.errors.push("No config for field ".concat(s));return}return{valueSrc:"field",value:s,valueType:c?.type}}},iv=function(e,t,r,a,o){var u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,i=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null,l=arguments.length>7?arguments[7]:void 0,s=arguments.length>8&&arguments[8]!==void 0?arguments[8]:null,c=Object.keys(t)[0],d=Object.values(t)[0],f=function(J,U){return uv(J,U,a,o,u,l,s)||lv(J,U,a,o,u,i,l,s)},p=l.errors.length,g,v,m,h,O=f(c,d);if(O&&(g=O.field,v=O.fieldSrc),e&&(h=!0,m=r[0],r=[]),c=="reduce"&&Array.isArray(d)&&d.length==3){var b=d,S=(0,Le.A)(b,3),C=S[0],L=S[1],w=S[2];if(st(C)&&w==0&&st(L)&&Array.isArray(L["+"])&&L["+"][0]==1&&st(L["+"][1])&&L["+"][1].var=="accumulator")if(c=Object.keys(C)[0],d=Object.values(C)[0],c=="filter"){var N=d,V=(0,Le.A)(N,2),P=V[0],M=V[1];if(st(P)){c=Object.keys(P)[0],d=Object.values(P)[0];var B=f(c,d);B&&(g=B.field,v=B.fieldSrc,m=M,h=!0)}}else{var _=f(c,d);_&&(g=_.field,v=_.fieldSrc,h=!0)}}var q=l.errors.length;if(!g&&q==p&&l.errors.push("Unknown LHS ".concat(JSON.stringify(t))),!!g)return{field:g,fieldSrc:v,having:m,isGroup:h,args:r}},uv=function(e,t,r,a,o,u){var i=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;Array.isArray(t)||(t=[t]);var l=Gu(e,t,r,a,o,u,i);if(l)return{fieldSrc:"field",field:l.value}},lv=function(e,t,r,a,o){var u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,i=arguments.length>6?arguments[6]:void 0,l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:null,s=Uu(e,t,r,a,o,u,i,l);if(s)return{fieldSrc:"func",field:s.value}},Uu=function(e,t,r,a,o){var u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,i=arguments.length>6?arguments[6]:void 0,l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:null;if(e){var s,c,d,f=e=="method";if(f){var p,g,v=(0,Du.A)(t);p=v[0],s=v[1],g=v.slice(2),c=[p].concat((0,Fe.A)(g))}else s=e,c=t;var m=(f?"#":"")+s,h=u?.type||u?.returnType,O=(r.funcs[m]||[]).filter(function(U){return u?Wr(a,U).returnType==h:!0});if(O.length)d=O[0];else{var b=(0,ne.A)({},e,t),S=Nu(ta(a)),C;try{for(S.s();!(C=S.n()).done;){var L=(0,Le.A)(C.value,2),w=L[0],N=L[1];if(N.jsonLogicImport&&(!h||N.returnType==h)){var V=void 0;try{V=N.jsonLogicImport(b)}catch{}V&&(d=w,c=V)}}}catch(U){S.e(U)}finally{S.f()}}if(d&&d){var P=Wr(a,d),M=Object.keys(P.args||{}),B=c.reduce(function(U,te,Q){var ae=M[Q],ce=P.args[ae],ie;return ce&&(ie=qn(te,r,a,["val"],i,!1,ce,null,l)),ie!==void 0?Zt(Zt({},U),{},(0,ne.A)({},ae,ie)):U},{});for(var _ in P.args){var q=P.args[_],K=B[_];if(K===void 0){if(K=q?.defaultValue,K!==void 0){var J;K={value:K,valueSrc:(J=K)!==null&&J!==void 0&&J.func?"func":"value",valueType:q.type}}if(K===void 0){if(!(q!=null&&q.isOptional)){i.errors.push("No value for arg ".concat(_," of func ").concat(d));return}}else B[_]=K}}return{valueSrc:"func",value:{func:d,args:B},valueType:P.returnType}}}},Bu=function(e,t,r,a,o,u){var i=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null,l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:!1,s=r.conjunctions[e],c=a.settings.fieldSeparator;if(s){var d="group",f=t.map(function(b){return qn(b,r,a,["rule","group"],u,!1,null,null,i)}).filter(function(b){return b!==void 0}).reduce(function(b,S){return Zt(Zt({},b),{},(0,ne.A)({},S.id,S))},{}),p=Object.values(f).map(function(b){var S,C;return(b==null||(S=b.properties)===null||S===void 0?void 0:S.fieldSrc)=="field"&&(b==null||(C=b.properties)===null||C===void 0?void 0:C.field)}).filter(function(b){var S;return b==null||(S=b.includes)===null||S===void 0?void 0:S.call(b,c)}),g=Object.fromEntries(tv(p).map(function(b){var S=b.split(c),C=Object.fromEntries(S.slice(0,-1).map(function(L,w,N){return[].concat((0,Fe.A)(N.slice(0,w)),[L])}).map(function(L){return[L.join(c),Re(a,L)]}).filter(function(L){var w=(0,Le.A)(L,2),N=w[0],V=w[1];return V?.type=="!group"}));return[b,Object.keys(C)]})),v={conjunction:s,not:o},m=cr(),h={},O={};return Object.entries(f).map(function(b){var S=(0,Le.A)(b,2),C=S[0],L=S[1];if(L?.type=="group"||L?.type=="rule_group")h[C]=L;else{var w,N=L==null||(w=L.properties)===null||w===void 0?void 0:w.field,V=g[N]||[],P=V[V.length-1];if(!P)L&&(h[C]=L);else{var M=h,B=Nr(i,a),_=Nr(P,a),q=ya(B,_.slice(0,B.length));q||(B=[]);var K=P.split(c).slice(B.length).map(function(J,U,te){return[].concat((0,Fe.A)(B),(0,Fe.A)(te.slice(0,U)),[J]).join(c)}).map(function(J){return{f:J,fc:Re(a,J)||{}}}).filter(function(J){var U=J.fc;return U.type!="!struct"});K.map(function(J,U){var te=J.f,Q=J.fc,ae=O[te];ae||(ae=cr(),O[te]=ae,M[ae]={type:"rule_group",id:ae,children1:{},properties:{conjunction:s,not:!1,field:te,fieldSrc:"field",mode:Q.mode}}),M=M[ae].children1}),M[C]=L}}}),{type:d,id:m,children1:h,properties:v}}},sv=function(e,t,r,a){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:void 0,u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1;if(e)return{type:"rule_group",id:cr(),children1:(0,ne.A)({},e.id,e),properties:{conjunction:o||La(a,r),not:u,field:t}}},Fa=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return{type:"group",id:cr(),children1:(0,ne.A)({},e.id,e),properties:{conjunction:tn(t),not:r}}},cv=function(e,t,r,a,o,u,i){var l=ai(i),s=$u(e,t,r,a,o,u,!1,l);if(s||(s=$u(e,t,r,a,o,u,!0,ai(i))),!s){i.errors.push(l.errors.join("; ")||"Unknown op ".concat(e,"/").concat(t));return}return s},$u=function(e,t,r,a,o,u,i,l){var s,c,d=(e==="all"||e==="some")&&st(r[1])&&Object.keys(r[1])[0]=="in"&&((s=r[1].in[0])===null||s===void 0?void 0:s.var)==="",f=!d&&u.settings.groupOperators.includes(e),p=["==","!="],g=f?0:t-1;f?g=0:p.includes(e)&&g==1&&r[1]===null&&(t=1,g=0,r=[r[0]]);var v=e+"/"+g,m=o.operators[(i?"#":"")+v];if(m){var h,O=[],b=["<","<=",">",">="];if(b.includes(e)&&t==3)h=r[1],O=[r[0],r[2]];else if(i)h=r[1],O=[r[0]];else{var S=r,C=(0,Du.A)(S);h=C[0],O=C.slice(1)}if(!st(h)){l.errors.push("Incorrect operands for ".concat(e,": ").concat(JSON.stringify(r)));return}var L=iv(f,h,O,o,u,null,null,l,a);if(L){var w=L.field,N=L.fieldSrc,V=L.having,P=L.isGroup,M=L.args,B=Re(u,w);if(!B&&!((c=l.settings)!==null&&c!==void 0&&c.allowUnknownFields)){l.errors.push("No config for LHS ".concat(w));return}var _=m[0];if(m.length>1&&B&&B.operators){if(m=m.filter(function(q){return B.operators.includes(q)}),m.length==0){l.errors.push("No corresponding ops for LHS ".concat(w));return}_=m[0]}return{field:w,fieldSrc:N,fieldConfig:B,opKey:_,args:M,having:V}}}},dv=function n(e,t,r,a,o,u){var i,l=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null,s=arguments.length>7&&arguments[7]!==void 0?arguments[7]:!1;if(e){var c=t.length;if((e==="all"||e==="some")&&st(t[1])){var d,f=Object.keys(t[1])[0],p=((d=t[1][f][0])===null||d===void 0?void 0:d.var)==="";f==="in"&&p&&(t=[t[0],t[1][f][1]],e=e+"-"+f)}var g=cv(e,c,t,l,r,a,u);if(g){var v=g.field,m=g.fieldSrc,h=g.fieldConfig,O=g.opKey,b=g.args,S=g.having,C=Re(a,l),L=a.operators[O],w=a.operators[(i=L)===null||i===void 0?void 0:i.reversedOp],N=!1,V=!!w,P=h.type=="!group",M=C?.type=="!group",B=V&&(!!a.settings.reverseOperatorsForNot||N||P&&!S||!P&&M&&!s),_=o&&B||N,q,K,J=!1;if(h?.type=="!group"&&S){for(q=Object.keys(S)[0],K=S[q],Array.isArray(K)||(K=[K]);q=="!";){var U=q=="!"&&K.length==1&&K[0]&&st(K[0])&&r.varKeys.includes(Object.keys(K[0])[0]);if(U)break;J=!J,S=S["!"],q=Object.keys(S)[0],K=S[q]}Array.isArray(K)||(K=[K])}_&&(o=!o,O=L.reversedOp,L=a.operators[O]);var te=wr(a,v,O,null),Q=b.map(function(se){return qn(se,r,a,["val"],u,!1,h,te,l)});if(!Q.filter(function(se){return se===void 0}).length){var ae,ce=h?.type;if((ce==="!group"||ce==="!struct")&&(ce=null),h?.type=="!group"&&S){if(r.conjunctions[q]!==void 0)ae=Bu(q,K,r,a,J,u,v,!0);else if(ae=n(q,K,r,a,J,u,v,!0),ae){var ie;ae.type==="rule_group"&&((ie=ae.properties)===null||ie===void 0?void 0:ie.field)!==v&&(ae=sv(ae,v,h,a)),Object.assign(ae.properties,{conjunction:La(a,h)})}if(!ae)return;ae.type="rule_group",Object.assign(ae.properties,{field:v,mode:h.mode,operator:O}),h.mode=="array"&&Object.assign(ae.properties,{value:Q.map(function(se){return se.value}),valueSrc:Q.map(function(se){return se.valueSrc}),valueType:Q.map(function(se){return se.valueType})}),o&&(ae=Fa(ae,a,o))}else if(h?.type=="!group"&&!S)ae={type:"rule_group",id:cr(),children1:{},properties:{conjunction:La(a,h),not:!1,mode:h.mode,field:v,operator:O}},h.mode==="array"&&Object.assign(ae.properties,{value:Q.map(function(se){return se.value}),valueSrc:Q.map(function(se){return se.valueSrc}),valueType:Q.map(function(se){return se.valueType})}),o&&(ae=Fa(ae,a,o));else{var le=Q.map(function(se){return se.asyncListValues}).filter(function(se){return se!=null}),pe=le.length?le[0]:void 0;ae={type:"rule",id:cr(),properties:Zt({field:v,fieldSrc:m,operator:O,value:Q.map(function(se){return se.value}),valueSrc:Q.map(function(se){return se.valueSrc}),valueType:Q.map(function(se){return se.valueType})},pe?{asyncListValues:pe}:{})},(o||s)&&(ae=Fa(ae,a,o))}return ae}}}},fv=function(e,t,r,a,o,u){var i=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;if(e?.toLowerCase()==="if"){var l=pv(t),s=l.map(function(f){var p=(0,Le.A)(f,2),g=p[0],v=p[1];return[g?qn(g,r,a,["rule","group"],u,!1,null,null,i):null,gv(a,u,r,v)]}),c=s.map(function(f){var p=(0,Le.A)(f,2),g=p[0],v=p[1];return vv(g,v,a,u)}),d={type:"switch_group",id:cr(),children1:c,properties:{}};return d}},pv=function(e){var t=[];function r(a){var o=(0,Le.A)(a,3),u=o[0],i=o[1],l=o[2];t.push([u,i]);var s=st(l)?Object.keys(l)[0]:null;s?.toLowerCase()==="if"?r(l[s]):t.push([void 0,l])}return r(e),t},vv=function(e,t,r,a){var o;return e?(o=Zt({},e),o.type?(o.type!="group"&&(o=Fa(o,r)),o.type="case_group"):(a.errors.push("Unexpected case: ".concat(JSON.stringify(o))),o=void 0)):o={id:cr(),type:"case_group",properties:{}},o&&(o.properties=Zt(Zt({},o.properties),t)),o},gv=function(e,t,r,a){var o=Re(e,"!case_value");if(!o){t.errors.push("Missing caseValueField in settings");return}var u=o.mainWidget,i=e.widgets[u];if(!i){t.errors.push("No widget ".concat(u," for case value"));return}var l=qn(a,r,e,["val","case_val"],t,!1,o,u);if(l!=null){var s=l.value,c=l.valueSrc,d=l.valueType,f={value:[s],valueSrc:[c??"value"],valueType:[d??i?.type],field:"!case_value"};return f}},mv=y(21450),hv=y(61526),yv=y.n(hv),Tn=yv();Tn.trim=function(n){return n.charAt(0)=="'"?n.substring(1,n.length-1):n},Tn.escapeLike=function(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,r=Tn.escape(n);return r=Tn.trim(r),r=r.replace(/[%_]/g,"\\$&"),r=(e?"%":"")+r+(t?"%":""),r="'"+r+"'",r};var Wu=function(e){var t="''",r=e?.type;return r=="date"?t="'0000-00-00'":r=="datetime"?t="'0000-00-00 00:00'":r=="time"?t="'00:00'":r=="number"&&(t="0"),t},Ku=function(e){var t="",r=e?.type;return r=="number"&&(t=0),t},Ov=function(e){return"'"+e.replace(/'/g,"''")+"'"},bv=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r,a,o=["int","float"];e.map(function(l){if(l!=null){if(typeof l=="string")a="String";else if(typeof l=="number")a=Number.isInteger(l)?"int":"float";else throw new Error("spelEscape: Can't use value ".concat(l," in array"));if(!r)r=a;else if(r!=a)if(o.includes(r)&&o.includes(a))r="float";else throw new Error("spelEscape: Can't use different types in array: found ".concat(r," and ").concat(a))}}),r||(r="String");var u;r=="float"?u=e.map(function(l){return Qn(l,!0)}):u=e.map(function(l){return Qn(l)});var i;return t?i="new ".concat(r,"[]{").concat(u.join(", "),"}"):i="{".concat(u.join(", "),"}"),i},zu=function(e){return"".concat(e,".?[true]")},Qn=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(e==null)return"null";switch((0,Cr.A)(e)){case"boolean":return e?"true":"false";case"number":return!Number.isFinite(e)||isNaN(e)?void 0:e+(!Number.isInteger(e)||t?"f":"");case"object":if(Array.isArray(e))return bv(e,r);throw new Error("spelEscape: Object is not supported");default:return Ov(e)}},Sv=function(e){return e&&Array.isArray(e)&&e.length?e.map(function(t){if(t.type=="const")return Qn(t.value);if(t.type=="property")return""+t.value;if(t.type=="variable")return"#"+t.value}).filter(function(t){return t!=null}).join(" + "):"null"},Fv=function(e){if(e==null)return[void 0,[]];var t=[],r=e.valueType=="case_value"?e.value:e,a=Array.isArray(r)?r:[r],o=a.map(function(u){if(u.valueSrc==="value")return u.value===null?void 0:{type:"const",value:u.value};if(u.valueSrc==="field")return{type:u.isVariable?"variable":"property",value:u.value};t.push("Unsupported valueSrc ".concat(u.valueSrc," in concatenation"))}).filter(function(u){return u!=null});return[o,t]},Hu=function(e){return e==null?"NULL":e.toString()},Ju=function(e){return e==null||e?.[0]==="("&&e?.[e?.length-1]===")"?e:"("+e+")"};function qu(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=Cv(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,u=!1,i;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return o=s.done,s},e:function(s){u=!0,i=s},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(u)throw i}}}}function Cv(n,e){if(n){if(typeof n=="string")return Qu(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Qu(n,e)}}function Qu(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function Yu(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Xu(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Yu(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Yu(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var Zu="${0}.compareTo(${1})",Tv={datetime:!0,time:!0,date:!0},Ev=function(e,t){return el(e,t,!1)},el=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a={errors:[]},o=xt(t,void 0,!1),u=rl(e,o,a,null);return r?[u,a.errors]:(a.errors.length&&console.warn("Errors while exporting to SpEL:",a.errors),u)},rl=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(e){var o=e.get("type");if(o==="group"||o==="rule_group")return nl(e,t,r,a);if(o==="rule")return wv(e,t,r,a);if(o=="switch_group")return Av(e,t,r,a);if(o=="case_group")return tl(e,t,r,a)}},tl=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=e.get("type");if(o!="case_group"){r.errors.push("Unexpected child of type ".concat(o," inside switch"));return}var u=e.get("properties")||new ye.Map,i=oi(t,u,r,null,a,"!case_value"),l=(0,Le.A)(i,3),s=l[0],c=l[1],d=l[2],f=nl(e,t,r,a);return[f,s]},Av=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=e.get("properties")||new ye.Map,u=e.get("children1");if(u){var i=u.map(function(m){return tl(m,t,r,null)}).filter(function(m){return typeof m<"u"}).valueSeq().toArray();if(i.length){if(i.length==1&&!i[0][0])return i[0][1];for(var l=[],s=0;s<i.length;s++)s!=i.length-1&&!i[s][0]?r.errors.push("No condition for case ".concat(s)):(l.push(i[s]),s==i.length-1&&i[s][0]&&l.push([void 0,null]));for(var c="",d="",f=0;f<l.length;f++){var p=(0,Le.A)(l[f],2),g=p[0],v=p[1];v==null&&(v="null"),g==null&&(g="true"),f!=l.length-1?(c+="(".concat(g," ? ").concat(v," : "),d+=")"):c+="".concat(v)}return c+d}}},nl=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=e.get("type"),u=e.get("properties")||new ye.Map,i=u.get("mode"),l=e.get("children1")||new ye.List,s=u.get("field"),c=u.get("conjunction");c||(c=tn(t));var d=t.conjunctions[c],f=u.get("not"),p=o==="rule_group",g=p&&i!="struct",v=g?s:a,m=Re(t,v)||{},h=m.isSpelArray,O=t.settings.fieldSeparator,b=u.get("operator");!b&&(!i||i=="some")&&(b="some");var S=ol(t,b,s),C=S!=b,L=b&&lr(t,S,s)||null,w=p&&(!S||L.cardinality==0),N=oi(t,u,r,S,a,null),V=(0,Le.A)(N,3),P=V[0],M=V[1],B=V[2],_=l.map(function(le){return rl(le,t,r,v)}).filter(function(le){return typeof le<"u"});if(g&&!w){if(P==null)return}else if(!_.size)return;var q=p,K=_.size?d.spelFormatConj.call(t.ctx,_,c,f,q):null,J;if(g){var U=ui(r,t,s,a),te=O||".",Q=te+(h?"length":"size()"),ae="".concat(U).concat(Q),ce=K?"".concat(U,".?[").concat(K,"]").concat(Q):ae,ie=w?ae:P;J=al(r,t,u,ce,ie,S,M,B,C)}else J=K;return J},Lv=function(e,t,r){var a=t.spelOp;if(a){var o=a.includes("${0}"),u=Tv[r],i=a,l,s=Br(t);return u?l=function(d,f,p,g,v,m,h,O){var b=Zu.replace(/\${(\w+)}/g,function(S,C){return C==0?d:s>1?p[C-1]:p});return"".concat(b," ").concat(i," 0")}:o?l=function(d,f,p,g,v,m,h,O){return a.replace(/\${(\w+)}/g,function(b,S){return S==0?d:s>1?p[S-1]:p})}:s==0?l=function(d,f,p,g,v,m,h,O){return"".concat(d," ").concat(i)}:s==1&&(l=function(d,f,p,g,v,m,h,O){return"".concat(d," ").concat(i," ").concat(p)}),l}},al=function(e,t,r,a,o,u,i,l){var s=arguments.length>8&&arguments[8]!==void 0?arguments[8]:!1,c=r.get("field"),d=lr(t,u,c)||{},f=Re(t,c)||{},p=r.get("operatorOptions"),g=d.spelFormatOp||Lv(u,d,l);if(!g){e.errors.push("Operator ".concat(u," is not supported"));return}var v=[a,u,o,i,l,Pt(d,Kn),p,f],m;return m=g.call.apply(g,[t.ctx].concat(v)),s&&(m=t.settings.spelFormatReverse.call(t.ctx,m)),m===void 0&&e.errors.push("Operator ".concat(u," is not supported for value source ").concat(i)),m},ol=function(e,t,r){if(t){var a=lr(e,t,r)||{},o=a.reversedOp,u=lr(e,o,r)||{},i=!1,l=a.spelOp||a.spelFormatOp,s=u.spelOp||u.spelFormatOp;if(!(!l&&!s)){if(!l&&s){i=!0;var c=[o,t];t=c[0],o=c[1];var d=[u,a];a=d[0],u=d[1]}return t}}},wv=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=e.get("properties")||new ye.Map,u=o.get("field"),i=o.get("fieldSrc"),l=o.get("operator");if(!(u==null||l==null)){var s=ol(t,l,u);if(!s){r.errors.push("Operator ".concat(l," is not supported"));return}var c=s!=l,d=oi(t,o,r,s,a,null),f=(0,Le.A)(d,3),p=f[0],g=f[1],v=f[2];if(p!==void 0){var m=jv(r,t,u,i,a);if(m!==void 0){var h=al(r,t,o,m,p,s,g,v,c);return h}}}},jv=function(e,t,r,a){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;return a==="func"?il(e,t,r,o):ui(e,t,r,o)},oi=function(e,t,r,a,o){var u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,i=t.get("field"),l=t.get("valueSrc"),s=t.get("valueType");(u=="!case_value"||s&&s.get(0)=="case_value")&&(i="!case_value");var c=Re(e,i)||{},d=lr(e,a,i)||{},f=Br(d),p=t.get("value"),g=t.get("asyncListValues"),v=[],m=[],h;if(p!=null){var O=p.map(function(S,C){var L=l?l.get(C):null,w=s?s.get(C):null,N=Nn(S,L,e),V=wr(e,i,a,L),P=dt(e,i,a,V,L,{forExport:!0}),M=ii(r,e,N,L,w,P,c,a,d,o,g);return M!==void 0&&(v.push(L),m.push(w)),M}),b=O.filter(function(S){return S===void 0}).size>0;O.size<f||b||(h=f>1?O.toArray():f==1?O.first():null)}return[h,v.length>1?v:v[0],m.length>1?m:m[0]]},ii=function(e,t,r,a,o,u,i,l,s){var c=arguments.length>9&&arguments[9]!==void 0?arguments[9]:null,d=arguments.length>10?arguments[10]:void 0;if(r!==void 0){var f;if(a==="field")f=ui(e,t,r,c);else if(a==="func")f=il(e,t,r,c);else if(typeof u?.spelFormatValue=="function"){var p=u.spelFormatValue,g=[r,Xu(Xu({},Xt()(i,["fieldSettings","listValues"])),{},{asyncListValues:d}),Pt(u,In)];if(l&&(g.push(l),g.push(s)),a=="field"){var v=Re(t,r)||{};g.push(v)}f=p.call.apply(p,[t.ctx].concat(g))}else f=Qn(r);return f}},ui=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(r){var o=t.settings.fieldSeparator,u=Re(t,r)||{},i=Nr(r,t),l=Cs(r,t,a),s=t.settings.formatSpelField,c=mn(r,t,e,a),d=l.map(function(p){var g=(0,Le.A)(p,3),v=g[0],m=g[1],h=g[2],O;h&&(h.type=="!struct"||h.type=="!group"&&h.mode=="struct"?O=m.isSpelMap?"map":"class":h.type=="!group"?O=m.isSpelItemMap?"[map]":"[class]":O="class");var b=m?.isSpelVariable;return{key:v,parent:O,isSpelVariable:b,fieldSeparator:o}}),f=s.call(t.ctx,c,a,i,d,u,t);return f}},il=function(e,t,r){var a,o,u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,i=(a=r.get)===null||a===void 0?void 0:a.call(r,"func"),l=(o=r.get)===null||o===void 0?void 0:o.call(r,"args"),s=Wr(t,i);if(!s){e.errors.push("Func ".concat(i," is not defined in config"));return}var c={},d=[],f=[];for(var p in s.args){var g,v,m=s.args[p],h=Re(t,m),O=m.defaultValue,b=m.isOptional,S=O!=null&&O.func?"func":"value",C=l?l.get(p):void 0,L=C?C.get("value"):void 0,w=C?C.get("valueSrc"):void 0;w!=="func"&&(g=L)!==null&&g!==void 0&&g.toJS&&(L=L.toJS());var N=C?C.get("asyncListValues"):void 0,V=(v=m.spelEscapeForFormat)!==null&&v!==void 0?v:!0,P=null,M=wr(t,m,P,w),B=dt(t,m,P,M,w,{forExport:!0}),_=ii(e,t,L,w,m.type,B,h,null,null,u,N);if(L!=null&&_===void 0){w!="func"&&e.errors.push("Can't format value of arg ".concat(p," for func ").concat(i));return}var q=void 0;if(_===void 0&&!b&&O!=null){var K=wr(t,m,P,S),J=dt(t,m,P,K,S,{forExport:!0});if(q=ii(e,t,O,S,m.type,J,h,null,null,u,N),q===void 0){S!="func"&&e.errors.push("Can't format default value of arg ".concat(p," for func ").concat(i));return}}var U=_??q;if(U!==void 0){var te;if(d.length){var Q=qu(d),ae;try{for(Q.s();!(ae=Q.n()).done;){var ce=ae.value;c[ce]=void 0}}catch(Ae){Q.e(Ae)}finally{Q.f()}d=[]}c[p]=V?U:(te=L)!==null&&te!==void 0?te:O}else b||f.push(p),d.push(p)}if(!f.length){var ie;if(typeof s.spelFormatFunc=="function"){var le=s.spelFormatFunc,pe=[c];ie=le.call.apply(le,[t.ctx].concat(pe))}else if(s.spelFunc){ie=s.spelFunc.replace(/\${(\w+)}/g,function(Ae,Pe){var Ve;return(Ve=c[Pe])!==null&&Ve!==void 0?Ve:Ae});var se=Object.keys(s.args||{}).reverse().filter(function(Ae){return!!s.args[Ae].isOptional}),me=qu(se),Ce;try{for(me.s();!(Ce=me.n()).done;){var ge=Ce.value;if(c[ge]!=null)break;ie=ie.replace(new RegExp("(, )?\\${"+ge+"}","g"),"")}}catch(Ae){me.e(Ae)}finally{me.f()}ie=ie.replace(/\${(\w+)}/g,"null")}else e.errors.push("Func ".concat(i," is not supported"));return ie}};function en(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=Rv(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,u=!1,i;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return o=s.done,s},e:function(s){u=!0,i=s},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(u)throw i}}}}function Rv(n,e){if(n){if(typeof n=="string")return ul(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return ul(n,e)}}function ul(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function ll(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Rr(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ll(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):ll(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var sl={number:"number",string:"text",boolean:"boolean",null:"null"},cl={String:"text"},Pv="multiselect",xv=function(e){return["length"].includes(e)},dl=function(e){return(0,Cr.A)(e)=="object"&&e!==null&&!Array.isArray(e)},Iv=function(e,t){return fl(e,t,!0)},fl=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a={errors:[]},o=xt(t,void 0,!1),u=Nv(o),i,l,s=void 0;try{var c=mv.SpelExpressionEvaluator.compile(e);i=c._compiledExpression}catch(f){a.errors.push(f)}i&&(l=Vv(i,a),Cn.debug("convertedObj:",l,a),s=Ca(l,u,o,a),s&&s.type!="group"&&s.type!="switch_group"&&(s=Ea(s,o,l.not)),Cn.debug("jsTree:",s));var d=s?ni(s):void 0;return r?[d,a.errors]:(a.errors.length&&console.warn("Errors while importing from SpEL:",a.errors),d)},Vv=function n(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,a=e.getType(),o=e.getChildren().map(function(_){return n(_,t,e)});if((a=="op-or"||a=="op-and")&&(o=o.reduce(function(_,q){var K=q.type==a&&!q.not,J=K?q.children:[q];return[].concat((0,Fe.A)(_),(0,Fe.A)(J))},[])),a=="op-not")return o.length!=1&&t.errors.push("Operator NOT should have 1 child, but got ".concat(o.length,"}")),Rr(Rr({},o[0]),{},{not:!o[0].not});if(a=="compound"){o=o.filter(function(_){var q=_.type=="selection"&&_.children.length==1&&_.children[0].type=="boolean"&&_.children[0].val==!0;return!q});var u=o.find(function(_){return _.type=="selection"});u&&u.children.length!=1&&t.errors.push("Selection should have 1 child, but got ".concat(u.children.length));var i=u?u.children[0]:null,l=o[o.length-1],s=l.type=="method"&&l.val.methodName=="size"||l.type=="!func"&&l.methodName=="size",c=l.type=="property"&&l.val=="length",d=o.filter(function(_){return _!==u&&_!==l}),f={type:"compound",children:d},p=(s||c)&&pl(d)!=null;if(p)return{type:"!aggr",filter:i,source:f};if(o=o.filter(function(_){var q=_.type=="variable"&&_.val=="this",K=_.type=="variable"&&_.val=="root";return!(q||K)}),o=o.map(function(_){return _.type=="indexer"&&_.children.length==1?{type:"indexer",val:_.children[0].val,itype:_.children[0].type}:_}),l.type=="!func"){var g={},v=g;do{var m,h;Object.assign(v,l),o=o.filter(function(_){return _!==l}),l=o[o.length-1],((h=l)===null||h===void 0?void 0:h.type)=="!func"?(v.obj={},v=v.obj):o.length>1?v.obj={type:"compound",children:o}:v.obj=l}while(((m=l)===null||m===void 0?void 0:m.type)=="!func");return g}}var O;try{e.getRaw?O=e.getRaw():e.getValue.length==0&&(O=e.getValue())}catch(_){Cn.error("[spel2js] Error in getValue()",_)}if(a=="ternary"&&(O=Dv(o)),(0,Cr.A)(O)==="object"&&O!==null&&(O.methodName||O.functionName)&&(O.args=O.args.map(function(_){return n(_,t,e)})),a=="list"&&(O=O.map(function(_){return n(_,t,e)}),!r&&O.length==1))return O[0];if(a=="constructorref"){var b=o.find(function(_){return _.type=="qualifiedidentifier"}),S=b?.val;if(!S){t.errors.push("Can't find qualifiedidentifier in constructorref children: ".concat(JSON.stringify(o)));return}var C=o.filter(function(_){return _.type!="qualifiedidentifier"});return{type:"!new",cls:S,args:C}}if(a=="typeref"){var L=o.find(function(_){return _.type=="qualifiedidentifier"}),w=L?.val;if(!w){t.errors.push("Can't find qualifiedidentifier in typeref children: ".concat(JSON.stringify(o)));return}var N=o.filter(function(_){return _.type!="qualifiedidentifier"});return{type:"!type",cls:w}}if(a=="function"||a=="method"){var V=O,P=V.functionName,M=V.methodName,B=V.args;return{type:"!func",methodName:P||M,isVar:a=="function",args:B}}return{type:a,children:o,val:O}},Dv=function(e){var t=[];function r(a){var o=(0,Le.A)(a,3),u=o[0],i=o[1],l=o[2];t.push([u,i]),l?.type=="ternary"?r(l.children):t.push([void 0,l])}return r(e),t},Nv=function(e){var t={},r=function(K){var J=e.operators[K];if(J.spelOps)J.spelOps.forEach(function(te){var Q=te;t[Q]||(t[Q]=[]),t[Q].push(K)});else if(J.spelOp){var U=J.spelOp;t[U]||(t[U]=[]),t[U].push(K)}else Cn.log("[spel] No spelOp for operator ".concat(K))};for(var a in e.operators)r(a);var o={};for(var u in e.conjunctions){var i=e.conjunctions[u],l=i.spelConj||u.toLowerCase();o[l]=u}var s={},c=en(ta(e)),d;try{var f=function(){var K=(0,Le.A)(d.value,2),J=K[0],U=K[1],te=[],Q=U.spelFunc;if(typeof Q=="string"){var ae=Object.keys(U.args||{}).reverse().filter(function(me){return!!U.args[me].isOptional||U.args[me].defaultValue!=null}),ce=Q.replace(/\${(\w+)}/g,function(me,Ce){return"?"}),ie=ae.reduce(function(me,Ce){return[].concat((0,Fe.A)(me),[[Ce].concat((0,Fe.A)(me[me.length-1]||[]))])},[]).map(function(me){return Q.replace(/(?:, )?\${(\w+)}/g,function(Ce,ge){return me.includes(ge)?"":Ce}).replace(/\${(\w+)}/g,function(Ce,ge){return"?"})});te=[ce].concat((0,Fe.A)(ie))}var le=en(te),pe;try{for(le.s();!(pe=le.n()).done;){var se=pe.value;s[se]||(s[se]=[]),s[se].push(J)}}catch(me){le.e(me)}finally{le.f()}};for(c.s();!(d=c.n()).done;)f()}catch(q){c.e(q)}finally{c.f()}var p={};for(var g in e.widgets){var v=e.widgets[g],m=v.spelImportFuncs,h=v.type;if(m){var O=en(m),b;try{for(O.s();!(b=O.n()).done;){var S=b.value;if(typeof S=="string"){var C=S.replace(/\${(\w+)}/g,function(q,K){return"?"}),L=(0,Fe.A)(S.matchAll(/\${(\w+)}/g)).map(function(q){var K=(0,Le.A)(q,2),J=K[0],U=K[1];return U});p[C]||(p[C]=[]),p[C].push({w:g,argsOrder:L})}}}catch(q){O.e(q)}finally{O.f()}}}var w={};for(var N in e.operators){var V=e.operators[N],P=V.spelOp;if(P!=null&&P.includes("${0}")){var M=P.replace(/\${(\w+)}/g,function(q,K){return"?"}),B=(0,Fe.A)(P.matchAll(/\${(\w+)}/g)).map(function(q){var K=(0,Le.A)(q,2),J=K[0],U=K[1];return U});w[M]||(w[M]=[]),w[M].push({op:N,argsOrder:B})}}var _=Zu.replace(/\${(\w+)}/g,function(q,K){return"?"});return w[_]=[{op:"!compare",argsOrder:["0","1"]}],{operators:t,conjunctions:o,funcs:s,valueFuncs:p,opFuncs:w}},Ca=function n(e,t,r,a){var o,u=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;if(e){e._groupField=(o=e._groupField)!==null&&o!==void 0?o:u?._groupField;var i,l=!0;if(e.type.indexOf("op-")===0||e.type==="matches")i=kv(e,t,r,a,u);else if(e.type=="!aggr"){var s,c=n(e.source,t,r,a,e);e._groupField=c?.value;var d=n(e.filter,t,r,a,e);((s=d)===null||s===void 0?void 0:s.type)=="rule"&&(d=Ea(d,r,e.filter.not)),i={groupFilter:d,groupFieldValue:c},u||(i=void 0,a.errors.push("Unexpected !aggr in root"),l=!1)}else if(e.type=="ternary"){var f={};e.val.forEach(function(g){var v=(0,Le.A)(g,2),m=v[0],h=v[1],O=gl(m,h,t,r,a,e);O&&(f[O.id]=O)}),i={type:"switch_group",id:cr(),children1:f,properties:{}}}if(!i&&l&&(i=Ta(e,t,r,a,u)),i&&!i.type&&!u){var p=vl(e,t,r,a);p?i=p:(i=void 0,a.errors.push("Can't convert rule of type ".concat(e.type,", it looks like var/literal")))}return i}},kv=function n(e,t,r,a){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,u,i=e.type.startsWith("op-")?e.type.slice(3):e.type,l=(i=="minus"||i=="plus")&&e.children.length==1;if(l){var s=e.negative;return i=="minus"&&(s=!s),e.children[0].negative=s,Ca(e.children[0],t,r,a,o)}var c=i=="and"&&e.children.length==2&&e.children[0].type=="op-ge"&&e.children[1].type=="op-le",d=i=="or"&&e.children.length==2&&e.children[0].type=="op-lt"&&e.children[1].type=="op-gt",f=c||d;if(f){var p=(0,Le.A)(e.children[0].children,2),g=p[0],v=p[1],m=(0,Le.A)(e.children[1].children,2),h=m[0],O=m[1],b=Wv(g,h,e,t,r,a,o);if(b){var S=v.val,C=O.val,L={type:"op-between",children:[g,v,O],not:d};return L._groupField=o?._groupField,n(L,t,r,a,o)}}var w=t.operators[i];i=="eq"&&e.children[1].type=="null"?w=["is_null"]:i=="ne"&&e.children[1].type=="null"?w=["is_not_null"]:i=="le"&&e.children[1].type=="string"&&e.children[1].val==""?w=["is_empty"]:i=="gt"&&e.children[1].type=="string"&&e.children[1].val==""?w=["is_not_empty"]:i=="between"&&(w=["between"]);var N=function(){var Ne,Xe=e.children.map(function(ar){return Ca(ar,t,r,a,e)});return Xe.length>=2&&((Ne=Xe)===null||Ne===void 0||(Ne=Ne[0])===null||Ne===void 0?void 0:Ne.type)=="!compare"&&(Xe=Xe[0].children),Xe};if(i=="and"||i=="or"){var V={},P=N();P.forEach(function(Ee){if(Ee){var Ne=cr();Ee.id=Ne,Ee.type!=null?V[Ne]=Ee:a.errors.push("Bad item in AND/OR: ".concat(JSON.stringify(Ee)))}}),u={type:"group",id:cr(),children1:V,properties:{conjunction:t.conjunctions[i],not:e.not}}}else if(w){var M,B,_,q=N(),K=q[0],J=q.slice(1),U=K==null||(M=K.groupFieldValue)===null||M===void 0?void 0:M.value,te=(B=J)===null||B===void 0?void 0:B[0],Q=w[0];if(w.length>1){var ae,ce,ie=((ae=q[0])===null||ae===void 0?void 0:ae.valueType)||((ce=q[1])===null||ce===void 0?void 0:ce.valueType),le=K?.value,pe=w.map(function(Ee){return{op:Ee,widget:wr(r,le,Ee)}});if(Cn.warn("[spel] Spel operator ".concat(i," can be mapped to ").concat(w,"."),"widgets:",pe,"vals:",q,"valueType=",ie),i=="eq"||i=="ne"){var se=pe.find(function(Ee){var Ne=Ee.op,Xe=Ee.widget;return Xe&&Xe!="field"});se&&(Q=se.op)}}K!=null&&K.groupFieldValue&&(te&&te.groupFieldValue&&te.groupFieldValue.valueSrc=="field"&&te.groupFieldValue.value==U?(Q="all",J=[]):Q=="equal"&&te.valueSrc=="value"&&te.valueType=="number"&&te.value==0?(Q="none",J=[]):Q=="greater"&&te.valueSrc=="value"&&te.valueType=="number"&&te.value==0&&(Q="some",J=[]));var me=r.operators[Q],Ce=r.operators[(_=me)===null||_===void 0?void 0:_.reversedOp],ge=e.not&&["between"].includes(Q),Ae=!!Ce,Pe=Ae&&(!!r.settings.reverseOperatorsForNot||ge),Ve=e.not&&Pe||ge;Ve&&(Q=me.reversedOp,me=r.operators[Q],e.not=!e.not);var Ie=!!e.not;if(e.not=!1,K)if(K.groupFieldValue)K.groupFieldValue.valueSrc!="field"&&a.errors.push("Expected group field ".concat(JSON.stringify(K))),u=$v(K,Q,J,r,a);else{K.valueSrc!="field"&&K.valueSrc!="func"&&a.errors.push("Expected field/func at LHS, but got ".concat(JSON.stringify(K)));var De=K.value;u=li(r,a,De,Q,J,e)}Ie&&(u.type!=="group"?u=Ea(u,r,!0):u.properties.not=!u.properties.not)}else o||(u=vl(e,t,r,a));return u},pl=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=!1,o=e.map(function(u){if(u.type=="variable"||u.type=="property"||u.type=="indexer"&&u.itype=="string")return u.val;var i,l;a=!0,r&&(t==null||(i=t.errors)===null||i===void 0||(l=i.push)===null||l===void 0||l.call(i,"Unexpected item in field path compound: ".concat(JSON.stringify(u))))});return a?void 0:o},Ta=function n(e,t,r,a){var o,u,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;if(e!=null){var l=r.settings.fieldSeparator;if(e._groupField=(o=e._groupField)!==null&&o!==void 0?o:i?._groupField,e.type=="variable"||e.type=="property"){var s=fo(r,e.val,e._groupField),c=Re(r,s),d=e.type=="variable";return{valueSrc:"field",valueType:c?.type,isVariable:d,value:s}}else if(e.type=="compound"){var f=pl(e.children,a);if(f){var p,g=fo(r,f.join(l),e._groupField),v=Re(r,g),m=((p=e.children)===null||p===void 0||(p=p[0])===null||p===void 0?void 0:p.type)=="variable";return{valueSrc:"field",valueType:v?.type,isVariable:m,value:g}}}else if(sl[e.type]){var h=e.val,O=sl[e.type];return e.negative&&(h=-h),{valueSrc:"value",valueType:O,value:h}}else if(e.type=="!new"&&cl[e.cls.at(-1)]){var b=e.args.map(function(B){return n(B,t,r,a,e)}),S=b?.[0],C=cl[e.cls.at(-1)];return Rr(Rr({},S),{},{valueType:C})}else if(e.type=="list"){var L,w=e.val.map(function(B){return n(B,t,r,a,e)}),N=w.length?(L=w[0])===null||L===void 0?void 0:L.valueType:null,V=w.map(function(B){return B?.value}),P=Pv;return{valueSrc:"value",valueType:P,value:V}}else if(e.type==="op-plus"&&i?.type==="ternary"&&((u=r.settings.caseValueField)===null||u===void 0?void 0:u.type)==="case_value")return ml(e,t,r,a);var M=Gv(e,t,r,a,i);if(M!==void 0)return M;a.errors.push("Can't convert arg of type ".concat(e.type))}},_v=function(e){var t=[{s:"",params:[],objs:[]}];return Mv(e,t),t.map(function(r){var a=r.s,o=r.params;return{s:a,params:o}}).reverse().filter(function(r){var a=r.s;return a!==""&&a!=="?"})},Mv=function n(e,t){var r=[],a="",o=e.type,u=e.methodName,i=e.val,l=e.obj,s=e.args,c=e.isVar,d=e.cls,f=e.children,p=f?.[f.length-1],g=t[t.length-1];if(o==="!func"){for(var v=l;v;){var m,h=n(Rr(Rr({},v),{},{obj:null}),[{}]),O=(0,Le.A)(h,2),b=O[0],S=O[1];if(b!=="?"){var C={s:g.s,params:(0,Fe.A)(g.params),objs:(0,Fe.A)(g.objs)};g.objs.unshift("?"),g.params.unshift(v),t.push(C),g=t[t.length-1]}g.objs.unshift(b),(m=g.params).unshift.apply(m,(0,Fe.A)(S)),v=v.type==="!func"?v.obj:null}var L=en(t),w;try{for(L.s();!(w=L.n()).done;){var N,V=w.value;r=[].concat((0,Fe.A)(V?.params||[]),(0,Fe.A)(s||[])),a="",V!=null&&(N=V.objs)!==null&&N!==void 0&&N.length&&(a+=V.objs.join(".")+"."),a+=(c?"#":"")+u,a+="("+(s||[]).map(function(P){return"?"}).join(", ")+")",V.s=a,V.params=r}}catch(P){L.e(P)}finally{L.f()}}else o==="!new"?(r=s||[],a="new ".concat(d.join("."),"(").concat(r.map(function(P){return"?"}).join(", "),")")):o==="!type"?a="T(".concat(d.join("."),")"):o==="compound"&&p.type==="property"&&xv(p.val)?a=f.map(function(P){var M;if(P===p)return P.val;var B=n(Rr(Rr({},P),{},{obj:null}),[{}]),_=(0,Le.A)(B,2),q=_[0],K=_[1];return(M=r).push.apply(M,(0,Fe.A)(K)),q}).join("."):(r=[e],a="?");return g&&(g.s=a,g.params=r),[a,r]},Gv=function(e,t,r,a){var o,u=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,i=function(J){return Ca(J,t,r,a,e)},l=_v(e),s=l==null||(o=l[0])===null||o===void 0?void 0:o.s;l.length&&Cn.debug("Signatures for ",e,":",s,l);var c=Uv(e,t,r,a,u,l,i);if(c!==void 0)return c;var d=Bv(e,t,r,a,u,l,i);if(d!==void 0)return d;var f,p,g,v=en(l),m;try{var h=function(){var J=m.value,U=J.s,te=J.params,Q=t.funcs[U];if(Q){f=Q[0],p=Wr(r,f);var ae=p,ce=ae.spelFunc,ie=te.map(i),le=(0,Fe.A)(ce.matchAll(/\${(\w+)}/g)).map(function(pe){var se=(0,Le.A)(pe,2),me=se[0],Ce=se[1];return Ce});return g=Object.fromEntries(le.map(function(pe,se){return[pe,ie[se]]})),1}};for(v.s();!(m=v.n()).done&&!h(););}catch(K){v.e(K)}finally{v.f()}if(!f){var O=en(ta(r)),b;try{for(O.s();!(b=O.n()).done;){var S=(0,Le.A)(b.value,2),C=S[0],L=S[1];if(L.spelImport){var w=void 0;try{w=L.spelImport(e)}catch{}if(w){f=C,p=Wr(r,f),g={};for(var N in w)g[N]=i(w[N])}}}}catch(K){O.e(K)}finally{O.f()}}if(f){var V={};for(var P in p.args){var M=p.args[P],B=g[P];if(B===void 0)if(B=M?.defaultValue,B===void 0){if(!(M!=null&&M.isOptional)){a.errors.push("No value for arg ".concat(P," of func ").concat(f));return}}else{var _;B={value:B,valueSrc:(_=B)!==null&&_!==void 0&&_.func?"func":"value",valueType:M.type}}B&&(V[P]=B)}return{valueSrc:"func",value:{func:f,args:V},valueType:p.returnType}}var q=e.methodName;q&&a.errors.push("Signature ".concat(s," - failed to convert"))},Uv=function(e,t,r,a,o,u,i){var l,s,c,d=[];for(var f in r.widgets){var p=r.widgets[f],g=p.spelImportFuncs;if(g)for(var v=0;v<g.length;v++){var m=g[v];if(dl(m)){var h={};if(Cu(m,e,h)){for(var O in h)h[O]=i(h[O]);d.push({s:"widgets.".concat(f,".spelImportFuncs[").concat(v,"]"),w:f,argsObj:h})}}}}var b=en(u),S;try{for(b.s();!(S=b.n()).done;){var C=S.value,L=C.s,w=C.params,N=t.valueFuncs[L]||[],V=en(N),P;try{var M=function(){var me=P.value,Ce=me.w,ge=me.argsOrder,Ae=w.map(i),Pe=Object.fromEntries(ge.map(function(Ve,Ie){return[Ve,Ae[Ie]]}));d.push({s:L,w:Ce,argsObj:Pe})};for(V.s();!(P=V.n()).done;)M()}catch(se){V.e(se)}finally{V.f()}}}catch(se){b.e(se)}finally{b.f()}for(var B=0,_=d;B<_.length;B++){var q=_[B],K=q.s,J=q.w,U=q.argsObj,te=r.widgets[J],Q=te.spelImportValue,ae=te.type;c=J,s=K,l=[];for(var ce in U)["value"].includes(U[ce].valueSrc)||l.push("".concat(ce," has unsupported value src ").concat(U[ce].valueSrc));var ie=U.v.value;if(Q&&!l.length){var le=Q.call(r.ctx,U.v,te,U),pe=(0,Le.A)(le,2);ie=pe[0],l=pe[1],l&&!Array.isArray(l)&&(l=[l])}if(!l.length)return{valueSrc:"value",valueType:ae,value:ie}}c&&l.length&&a.errors.push("Signature ".concat(s," - looks like convertable to ").concat(c,", but: ").concat(l.join("; ")))},Bv=function(e,t,r,a,o,u,i){var l,s,c,d=en(u),f;try{for(d.s();!(f=d.n()).done;){var p=f.value,g=p.s,v=p.params,m=t.opFuncs[g]||[],h=en(m),O;try{var b=function(){var L,w=O.value,N=w.op,V=w.argsOrder,P=v.map(i);if(s=N,N==="!compare"){if(o.type.startsWith("op-")&&o.children.length==2&&o.children[1].type=="number"&&o.children[1].val===0)return{v:{type:"!compare",children:P}};l.push("Result of compareTo() should be compared to 0")}c=g,l=[];var M=r.operators[s],B=M.spelOp,_=M.valueTypes,q=Object.fromEntries(V.map(function(te,Q){return[te,P[Q]]})),K=q[0],J=Object.keys(q).filter(function(te){return parseInt(te)>0}).map(function(te){return q[te]}),U=(L=P.filter(function(te){return!!te}).find(function(te){var Q=te.valueSrc;return Q==="value"}))===null||L===void 0?void 0:L.valueType;if(_&&U&&!_.includes(U)&&l.push("Op supports types ".concat(_,", but got ").concat(U)),!l.length)return{v:li(r,a,K,s,J,e)}},S;for(h.s();!(O=h.n()).done;)if(S=b(),S)return S.v}catch(C){h.e(C)}finally{h.f()}}}catch(C){d.e(C)}finally{d.f()}s&&l.length&&a.errors.push("Signature ".concat(c," - looks like convertable to ").concat(s,", but: ").concat(l.join("; ")))},li=function(e,t,r,a,o,u){var i,l;if(!o.filter(function(M){return M===void 0}).length){var s=(i=r)!==null&&i!==void 0&&i.func?"func":"field";dl(r)&&r.valueSrc&&(s=r.valueSrc,r=r.value);var c=Re(e,r);if(!c){t.errors.push("No config for field ".concat(r));return}var d=Re(e,u?._groupField),f=c.type=="!group",p=f&&c.mode=="array",g=d?.type=="!group",v=e.operators[a],m=e.operators[(l=v)===null||l===void 0?void 0:l.reversedOp],h=u?.not&&["between"].includes(a),O=!!m,b=O&&(!!e.settings.reverseOperatorsForNot||h||!f&&g),S=u?.not&&b||h;S&&(a=v.reversedOp,v=e.operators[a],u.not=!u.not);var C=!!(u!=null&&u.not),L=wr(e,r,a),w=e.widgets[L||c.mainWidget],N=o.map(function(M){return M.asyncListValues}).filter(function(M){return M!=null}),V=N.length?N[0]:void 0,P={type:"rule",id:cr(),properties:Rr({field:r,fieldSrc:s,operator:a,value:o.map(function(M){return M.value}),valueSrc:o.map(function(M){return M.valueSrc}),valueType:o.map(function(M){return M.valueSrc=="value"&&(w?.type||c?.type)||M.valueType})},V?{asyncListValues:V}:{})};return C&&(P=Ea(P,e,u.not)),P}},$v=function(e,t,r,a,o){var u=e.groupFilter,i=e.groupFieldValue;if(i.valueSrc!="field")throw"Bad groupFieldValue: ".concat(JSON.stringify(i));var l=i.value,s=li(a,o,l,t,r);if(s){var c=Re(a,l),d=c?.mode,f;return u?.type==="group"?f=Rr(Rr({},u||{}),{},{type:"rule_group",properties:Rr(Rr(Rr({},s.properties),u?.properties||{}),{},{mode:d})}):u?f=Rr(Rr({},s||{}),{},{type:"rule_group",children1:[u],properties:Rr(Rr({},s.properties),{},{mode:d})}):f=Rr(Rr({},s||{}),{},{type:"rule_group",properties:Rr(Rr({},s.properties),{},{mode:d})}),f.id||(f.id=cr()),f}},Wv=function(e,t,r,a,o,u){if(e.type==t.type)if(e.type=="!aggr"){var i=[e.source,t.source].map(function(v){return Ta(v,a,o,u,r)}),l=(0,Le.A)(i,2),s=l[0],c=l[1];return s.value==c.value}else{var d=[e,t].map(function(v){return Ta(v,a,o,u,r)}),f=(0,Le.A)(d,2),p=f[0],g=f[1];return p.value==g.value}return!1},vl=function(e,t,r,a){var o={},u=null,i=gl(u,e,t,r,a);i&&(o[i.id]=i);var l={type:"switch_group",id:cr(),children1:o,properties:{}};return l},gl=function(e,t,r,a,o){var u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,i=Kv(a,o,r,t,u),l;return e?(l=Ca(e,r,a,o,u),l&&l.type?(l.type!="group"&&(l=Ea(l,a)),l.type="case_group"):(o.errors.push("Unexpected case: ".concat(JSON.stringify(l))),l=void 0)):l={id:cr(),type:"case_group",properties:{}},l&&(l.properties=Rr(Rr({},l.properties),i)),l},ml=function(e,t,r,a){var o=[];function u(i){i.map(function(l){if(l.type==="op-plus")u(l.children);else{var s=Ta(l,t,r,a,e);s?o.push(s):a.errors.push("Can't convert ".concat(l.type," in concatenation"))}})}return u(e.children),{valueSrc:"value",valueType:"case_value",value:o}},Kv=function(e,t,r,a){var o,u,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,l={},s,c,d,f=Re(e,"!case_value");if(a?.type==="op-plus"&&((o=e.settings.caseValueField)===null||o===void 0?void 0:o.type)==="case_value")c="case_value",s=ml(a,r,e,t);else if(c=f?.mainWidget,d=e.widgets[c],s=Ta(a,r,e,t,i),s&&s.valueSrc==="value"){var p;s.valueType=((p=d)===null||p===void 0?void 0:p.type)||f?.type||s.valueType}var g=e.widgets[c];if(c==="case_value"){var v=g?.spelImportValue;if(v){var m=v.call(e.ctx,s),h=(0,Le.A)(m,2),O=h[0],b=h[1];if(b.map(function(C){return t.errors.push(C)}),O!=null){var S;l={value:[O],valueSrc:["value"],valueType:[(S=g?.type)!==null&&S!==void 0?S:"case_value"],field:"!case_value"}}}}else s!=null&&((u=s)===null||u===void 0?void 0:u.value)!=null&&(l={value:[s.value],valueSrc:[s.valueSrc],valueType:[s.valueType],field:"!case_value"});return l},Ea=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return{type:"group",id:cr(),children1:(0,ne.A)({},e.id,e),properties:{conjunction:tn(t),not:r||!1}}};function hl(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function zv(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?hl(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):hl(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var yl=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,a=e.settings.defaultField,o=(r?Ol(e,r):a)||t&&ec(e,r)||null;return o!=null&&typeof o!="string"&&!zn(o)&&(o=Sa(o)),o},Ol=function(e){var t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!r)return null;var a=(e==null||(t=e.settings)===null||t===void 0?void 0:t.fieldSeparator)||".",o=Re(e,r),u=o?.defaultField;return u&&(u=[].concat((0,Fe.A)(Nr(r)),[u]).join(a)),u},si=function(e){var t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return r&&((t=e.settings.fieldSources)===null||t===void 0?void 0:t[0])||"field"},ci=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=Re(e,t),o=a?.operators||[],u=e.settings.defaultOperator;u&&!o.includes(u)&&(u=null);var i=a?.defaultOperator,l=a?.ownDefaultOperator,s=r?Ci(e,t):null,c=l||u||i||s;return c},Aa=function(e,t,r){var a=t?lr(e,t,r):null;return a&&a.options?new ye.default.Map(a.options&&a.options.defaults||{}):null},rn=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,u=null,i=null,l=null,s=e.settings.showErrorMessage;if(r){var c,d,f;l=r==null||(c=r.properties)===null||c===void 0?void 0:c.fieldSrc,u=r==null||(d=r.properties)===null||d===void 0?void 0:d.field,i=r==null||(f=r.properties)===null||f===void 0?void 0:f.operator}else a?(u=yl(e,o,t),u?l=zn(u)?"func":"field":l=si(e),i=ci(e,u,!0)):l=si(e);var p=new ye.default.Map({fieldSrc:l,field:u,operator:i,value:new ye.default.List,valueSrc:new ye.default.List,operatorOptions:Aa(e,i,u)});if(s&&(p=p.set("valueError",new ye.default.List)),u&&i){var g=!1,v=Vn(e,e,p,u,i,"operator",g),m=v.newValue,h=v.newValueSrc,O=v.newValueType,b=v.newValueError,S=v.newFieldError;p=p.set("value",m).set("valueSrc",h).set("valueType",O),s&&(p=p.set("valueError",b).set("fieldError",S))}return p},La=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;t=Re(e,t);var r=t&&t.conjunctions||Object.keys(e.conjunctions);return r.length==1?r[0]:e.settings.defaultGroupConjunction||e.settings.defaultConjunction||r[0]},tn=function(e){return e.settings.defaultConjunction||Object.keys(e.conjunctions)[0]},En=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return new ye.default.Map({conjunction:La(e,t),not:!1})},bl=function(e,t){var r;return t&&t.type=="group"?En(e,t==null||(r=t.properties)===null||r===void 0?void 0:r.field):rn(e,null,t)},Sl=function(e,t){return(0,ne.A)({},e,new ye.default.Map({type:"rule",id:e,properties:rn(t)}))},Hv=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return new ye.default.Map({type:"group",id:cr(),children1:new ye.default.OrderedMap(t?zv({},Sl(cr(),e)):{}),properties:En(e)})},Jv=function(e){return Qa(e)?e:Fl([e])},Fl=function(e){return Qa(e)?e:new ye.default.List(e)},qv=function(){return new ye.default.Map};function Cl(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=Qv(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,u=!1,i;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return o=s.done,s},e:function(s){u=!0,i=s},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(u)throw i}}}}function Qv(n,e){if(n){if(typeof n=="string")return Tl(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Tl(n,e)}}function Tl(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function El(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Al(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?El(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):El(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var Ll=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o={errors:[],settings:{isForDisplay:r,isDebugMode:a}},u=xt(t,void 0,!1),i=wl(e,u,o,null);return o.errors.length&&console.warn("Errors while exporting to string:",o.errors),i},wl=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(e){var o=e.get("type"),u=e.get("children1");if(o==="group"||o==="rule_group")return Yv(e,t,r,a);if(o==="rule")return jl(e,t,r,a)}},Yv=function(e,t,r){var a,o,u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,i=r.settings,l=i.isForDisplay,s=i.isDebugMode,c=e.get("type"),d=e.get("properties")||new ye.Map,f=d.get("mode"),p=e.get("children1")||new ye.List,g=c==="rule_group",v=g&&f=="array"?d.get("field"):null,m=c==="rule_group"?d.get("operator"):null,h=m?(a=(o=t.operators[m])===null||o===void 0?void 0:o.cardinality)!==null&&a!==void 0?a:1:void 0,O=g&&f==="array"&&h>=1,b=d.get("not"),S=p.map(function(_){return wl(_,t,r,v)}).filter(function(_){return typeof _<"u"});if(!(!O&&!S.size&&!s)){var C=d.get("conjunction");C||(C=tn(t));var L=t.conjunctions[C],w=S.size?L.formatConj.call(t.ctx,S,C,b,l):null,N;if(v){var V=jl(e,t,r,u,!0);if(V){var P,M=V.pop(),B=[w].concat((0,Fe.A)(V));N=(P=t.settings.formatAggr).call.apply(P,[t.ctx].concat((0,Fe.A)(B))),M&&(N=t.settings.formatReverse.call(t.ctx,N,null,null,null,null,l))}}else N=w;return s&&N==null&&(N="?"),N}},Xv=function(e,t,r,a,o){var u=r.settings,i=u.isForDisplay,l=u.isDebugMode,s=t.get("field"),c=t.get("valueSrc"),d=t.get("valueType"),f=Re(e,s)||{},p=a||t.get("operator"),g=lr(e,p,s)||{},v=Br(g),m=t.get("value"),h=t.get("asyncListValues"),O=[],b=[],S,C;if(m!=null){C=m.map(function(N,V){var P=c?c.get(V):null,M=d?d.get(V):null,B=l?N:Nn(N,P,e),_=wr(e,s,p,P),q=dt(e,s,p,_,P,{forExport:!0}),K=di(e,r,B,P,M,q,f,p,g,o,h);return K!==void 0&&(O.push(P),b.push(M)),K});var L=C.filter(function(N){return N===void 0}).size>0,w=!L&&C.size===v;w&&(S=v==1?C.first():C)}return l&&!S&&(S=v>1?new ye.List(Array.from({length:v}).map(function(N,V){var P,M;return(P=(M=C)===null||M===void 0?void 0:M.get(V))!==null&&P!==void 0?P:"?"})):"?"),[S,O.length>1?O:O[0],b.length>1?b:b[0]]},Zv=function(e,t,r){var a=r.settings.isDebugMode,o=t?.labelForFormat||e,u=Br(t),i;return u==0?i=function(s,c,d,f,p,g,v,m){return"".concat(s," ").concat(o)}:u==1?i=function(s,c,d,f,p,g,v,m){return a&&c==="?"&&d==="?"?s&&s!=="?"?"".concat(s," ?"):"?":"".concat(s," ").concat(o," ").concat(d)}:u==2&&(i=function(s,c,d,f,p,g,v,m){var h,O,b=d==null||(h=d.first)===null||h===void 0?void 0:h.call(d),S=d==null||(O=d.get)===null||O===void 0?void 0:O.call(d,1);return"".concat(s," ").concat(o," ").concat(b," AND ").concat(S)}),i},jl=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,u=r.settings,i=u.isForDisplay,l=u.isDebugMode,s=e.get("properties")||new ye.Map,c=s.get("field"),d=s.get("fieldSrc"),f=s.get("operator"),p=s.get("operatorOptions");if(!((c==null||f==null)&&!l)){var g=Re(t,c)||{},v=lr(t,f,c)||{},m=v.reversedOp,h=lr(t,m,c)||{},O=!1,b=v.formatOp;if(!b&&m&&(b=h.formatOp,b)){O=!0;var S=[m,f];f=S[0],m=S[1];var C=[h,v];v=C[0],h=C[1]}if(l&&!f&&(f="?"),b||(b=Zv(f,v,r)),!!b){var L=d==="func"?Pl(t,r,c,a):Rl(t,r,c,a);if(L!=null){var w=Xv(t,s,r,f,a),N=(0,Le.A)(w,3),V=N[0],P=N[1],M=N[2];if(V!==void 0){var B=[L,f,V,P,M,Pt(v,Kn),p,i,g,O];if(o)return B;var _,q=(_=b).call.apply(_,[t.ctx].concat(B));return O&&(q=t.settings.formatReverse.call(t.ctx,q,f,m,v,h,i)),q}}}}},di=function(e,t,r,a,o,u,i,l,s){var c=arguments.length>9&&arguments[9]!==void 0?arguments[9]:null,d=arguments.length>10?arguments[10]:void 0,f=t.settings,p=f.isForDisplay,g=f.isDebugMode;if(r===void 0)return g?u?.jsType==="array"?[]:"?":void 0;var v;if(a=="field")v=Rl(e,t,r,c);else if(a=="func")v=Pl(e,t,r,c);else if(typeof u?.formatValue=="function"){var m=u.formatValue,h=[r,Al(Al({},Xt()(i,["fieldSettings","listValues"])),{},{asyncListValues:d}),Pt(u,In),p];if(l&&(h.push(l),h.push(s)),a=="field"){var O=Re(e,r)||{};h.push(O)}v=m.call.apply(m,[e.ctx].concat(h))}else v=r;return v},Rl=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,u=t.settings,i=u.isForDisplay,l=u.isDebugMode,s=e.settings,c=s.fieldSeparator,d=s.fieldSeparatorDisplay,f=null;if(r){var p=Re(e,r)||{},g=Nr(r,e),v=ja(r,e,o?a:null),m=v?v.join(d):null,h=p.label2||m,O=e.settings.formatField,b=mn(r,e,t,o?a:null,{useTableName:!0});f=O(b,g,h,p,e,i)}else l&&(f="?");return f},Pl=function(e,t,r){var a,o,u,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,l=t.settings,s=l.isForDisplay,c=l.isDebugMode,d=r==null||(a=r.get)===null||a===void 0?void 0:a.call(r,"func");if(!d)return c?"?()":void 0;var f=(o=r.get)===null||o===void 0?void 0:o.call(r,"args"),p=Wr(e,d);if(!p&&!c){t.errors.push("Func ".concat(d," is not defined in config"));return}var g=Nr(d,e),v=g[g.length-1],m=s&&p?.label||v,h={},O=[],b=[],S={},C=p?Object.keys(p.args||{}):(f==null||(u=f.keySeq)===null||u===void 0?void 0:u.call(f).toArray())||[],L=Cl(C),w;try{for(L.s();!(w=L.n()).done;){var N,V=w.value,P=p?.args[V],M=Re(e,P),B=P||{},_=B.defaultValue,q=B.isOptional,K=_!=null&&_.func?"func":"value",J=s&&P?.label||V,U=f?f.get(V):void 0,te=U?U.get("value"):void 0,Q=U?U.get("valueSrc"):void 0;Q!=="func"&&(N=te)!==null&&N!==void 0&&N.toJS&&(te=te.toJS());var ae=U?U.get("asyncListValues"):void 0,ce=di(e,t,te,Q,P?.type,M,P,null,null,i,ae);te!=null&&ce===void 0&&Q!="func"&&t.errors.push("Can't format value of arg ".concat(V," for func ").concat(d));var ie=void 0;if(ce===void 0&&!q&&_!=null&&(ie=di(e,t,_,K,P?.type,M,P,null,null,i,ae),ie===void 0)){K!="func"&&t.errors.push("Can't format default value of arg ".concat(V," for func ").concat(d));return}var le=ce??ie;if(le!==void 0){if(O.length){var pe=Cl(V),se;try{for(pe.s();!(se=pe.n()).done;){var me=(0,Le.A)(se.value,2),Ce=me[0],ge=me[1];h[Ce]=void 0}}catch(De){pe.e(De)}finally{pe.f()}O=[]}h[V]=le,S[J]=le}else q||b.push(V),O.push([V,J])}}catch(De){L.e(De)}finally{L.f()}if(!(b.length&&!c)){var Ae=null;if(typeof p?.formatFunc=="function"){var Pe=p.formatFunc,Ve=[h,s];Ae=Pe.call.apply(Pe,[e.ctx].concat(Ve))}else{var Ie=Object.entries(s?S:h).map(function(De){var Ee=(0,Le.A)(De,2),Ne=Ee[0],Xe=Ee[1];return s?"".concat(Ne,": ").concat(Xe):"".concat(Xe)}).join(", ");Ae="".concat(m,"(").concat(Ie,")")}return Ae}},xl="EMPTY_GROUP",Il="EMPTY_RULE_GROUP",Vl="EMPTY_QUERY",Dl="EMPTY_CASE",Nl="NO_CONFIG_FOR_FIELD",kl="NO_CONFIG_FOR_OPERATOR",eg="FIXED_OPERATOR",_l="NO_CONFIG_FOR_FUNCTION",Ml="INVALID_VALUE",Gl="INVALID_FUNC_ARG_VALUE",Ul="UNSUPPORTED_FIELD_TYPE",Bl="UNSUPPORTED_OPERATOR_FOR_FIELD",$l="INVALID_VALUE_SRC",fi="INCOMPLETE_RULE",Wl="INCOMPLETE_LHS",Kl="INCOMPLETE_RHS",pi="BAD_MULTISELECT_VALUES",zl="BAD_SELECT_VALUE",Hl="INCORRECT_VALUE_TYPE",Jl="INCORRECT_VALUE_JS_TYPE",ql="VALUE_LENGTH_CONSTRAINT_FAIL",vi="VALUE_MIN_CONSTRAINT_FAIL",gi="VALUE_MAX_CONSTRAINT_FAIL",Ql="NO_CONFIG_FOR_FIELD_VALUE",Yl="CANT_COMPARE_FIELD_WITH_ITSELF",Xl="CANT_COMPARE_FIELD_WITH_FIELD",Zl="INCORRECT_FIELD_TYPE",es="UNSUPPORTED_FUNCTION_FOR_FIELD",rs="REQUIRED_FUNCTION_ARG",ts="INCORRECT_FUNCTION_RETURN_TYPE",ns="INVALID_RANGE",gn="ITEM_POSITION",as="ITEM_POSITION_ROOT",os="ITEM_POSITION_WITH_INDEX_PATH",is="ITEM_POSITION_IN_CASE",mi="range",rg=y(72635),Yn,tg=(Yn={},(0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)(Yn,xl,"Empty group"),Il,"No conditions for group field {{field}}"),Vl,"Empty query"),Dl,"Empty case"),Nl,"No config for field {{field}}"),eg,"Fixed operator {{from}} to {{to}} for field {{field}}"),kl,"No config for operator {{operator}}"),_l,"No config for function {{funcKey}}"),Ml,"Invalid value"),Gl,"Invalid value of arg {{argName}} for func {{funcName}}: {{argValidationError}}"),(0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)(Yn,Ul,"Type of field {{field}} is not supported"),Bl,"Operator {{operator}} is not supported for field {{field}}"),fi,"Incomplete rule"),Wl,"Incomplete LHS"),Kl,"Incomplete RHS"),$l,"Invalid value src {{valueSrcs, list}}"),pi+"_one","Value {{badValues, list}} is not in the list of allowed values"),pi+"_other","Values {{badValues, list}} are not in the list of allowed values"),zl,"Value {{value}} is not in the list of allowed values"),Hl,"Value should have type {{wType}}, but got value of type {{valueType}}"),(0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)(Yn,Jl,"Value should have JS type {{jsType}}, but got value of type {{valueTypeof}}"),ql,"Value {{value}} should have max length {{fieldSettings.maxLength}} but got {{length}}"),vi,"Value {{value}} should be greater than or equal to {{fieldSettings.min}}"),vi+"_"+mi,"Value {{value}} should be from {{fieldSettings.min}} to {{fieldSettings.max}}"),gi,"Value {{value}} should be less than or equal to {{fieldSettings.max}}"),gi+"_"+mi,"Value {{value}} should be from {{fieldSettings.min}} to {{fieldSettings.max}}"),Ql,"No config for field {{field}}"),Yl,"Can't compare field {{field}} with itself"),Xl,"Can't compare field {{leftField}} with {{rightField}}"),Zl,"Field {{field}} is of type {{type}}, but expected {{expected}}"),(0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)(Yn,es,"Unsupported function {{funcKey}} for field {{field}}"),rs,"Value of arg {{argName}} for func {{funcName}} is required"),ts,"Function {{funcKey}} should return value of type {{returnType}}, but got {{valueType}}"),ns,"Invalid range"),as,"Root"),gn+"__rule","Leaf #{{globalLeafNo}}"),gn+"__group","Group #{{globalGroupNo}}"),gn+"__rule_group","Rule-group #{{globalNoByType}}"),gn+"__case_group","Case #{{globalNoByType}}"),gn+"__rule__deleted","Deleted leaf #{{globalLeafNo}}"),(0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)(Yn,gn+"__group__deleted","Deleted group #{{globalGroupNo}}"),gn+"__rule_group__deleted","Deleted rule-group #{{globalNoByType}}"),gn+"__case_group__deleted","Deleted case #{{globalNoByType}}"),is,"{{str}} in case #{{caseNo}}"),os,"{{str}} (index path: {{indexPath, list}})")),us="raqbvalidation",ng="".concat(us,":"),no=rg.default.createInstance();no.init({fallbackLng:"en"}),no.addResources("en",us,tg);var Jt=function n(e,t){return e!=null&&e.str?e.str:e!=null&&e.key?n(e.key,e.args):t===null?e:no.t(e.includes(":")?e:ng+e,t)};const ag=no;function ls(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Lr(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ls(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):ls(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var ss=function(e){return(0,Cr.A)(e)==="object"&&e!==null&&Array.isArray(e)?"array":(0,Cr.A)(e)},og=function(e,t){return ss(e)===t||t==="number"&&!isNaN(e)},hi=function(e,t){return yi(e,t).length===0},yi=function(e,t){var r=t.settings.showErrorMessage,a=[];function o(u,i,l){var s,c,d=u.get("id"),f=u.get("children1"),p=u.getIn(["properties","valueError"]),g=u.getIn(["properties","fieldError"]),v=u.getIn(["properties","field"]),m=(s=v==null||(c=v.get)===null||c===void 0?void 0:c.call(v,"func"))!==null&&s!==void 0?s:v,h=p?.size>0&&p.filter(function(b){return b!=null}).size>0,O=h||!!g;O&&r&&a.push(m),f&&f.map(function(b,S){b&&o(b,i.concat(d),l+1)})}return e&&o(e,[],0),Array.from(new Set(a))},Oi=function(e,t){var r=xt(t,void 0,!0),a={removeEmptyGroups:t.settings.removeEmptyGroupsOnLoad,removeIncompleteRules:t.settings.removeIncompleteRulesOnLoad,removeEmptyRules:t.settings.removeEmptyRulesOnLoad,forceFix:!1},o=wa(e,null,r,r,a),u=o.fixedTree,i=o.allErrors,l=o.isSanitized;return l&&i.length&&console.warn("Tree check errors: ",i),u},cs=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=xt(t,void 0,!0),o=Lr(Lr({},r),{},{removeEmptyGroups:!1,removeEmptyRules:!1,removeIncompleteRules:!1,forceFix:!1}),u=wa(e,null,a,a,o),i=u.allErrors;return i},ds=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=xt(t,void 0,!0),o=Lr({removeEmptyGroups:!0,removeEmptyRules:!0,removeIncompleteRules:!0,forceFix:!1},r),u=wa(e,null,a,a,o),i=u.fixedTree,l=u.fixedErrors,s=u.nonFixedErrors,c=u.allErrors;return{fixedTree:i,fixedErrors:l,nonFixedErrors:s,allErrors:c}},fs=function(e,t,r,a,o,u,i){o===void 0&&(o=r.settings.removeEmptyGroupsOnLoad),u===void 0&&(u=r.settings.removeEmptyRulesOnLoad),i===void 0&&(i=r.settings.removeIncompleteRulesOnLoad);var l={removeEmptyGroups:o,removeEmptyRules:u,removeIncompleteRules:i,forceFix:!1},s=wa(e,t,r,a,l),c=s.fixedTree,d=s.allErrors,f=s.fixedErrors,p=s.nonFixedErrors,g=s.isSanitized;return g&&f.length&&console.warn("Fixed tree errors: ",f),c=Ht(c),c},wa=function(e,t,r,a,o){if(!e)return{fixedTree:e,allErrors:[],fixedErrors:[],nonFixedErrors:[],isSanitized:!1};var u=o||{},i=u.removeEmptyGroups,l=u.removeEmptyRules,s=u.removeIncompleteRules,c=u.forceFix,d=u.translateErrors,f=d===void 0?!0:d,p=u.includeStringifiedItems,g=p===void 0?!0:p,v=u.stringifyFixedItems,m=v===void 0?!1:v,h=u.stringifyItemsUserFriendly,O=h===void 0?!0:h,b=u.includeItemsPositions,S=b===void 0?!0:b,C={config:r,oldConfig:a,removeEmptyGroups:i,removeEmptyRules:l,removeIncompleteRules:s,forceFix:c},L={errors:{}},w=vs(e,[],null,L,C),N=L.sanitized,V=[],P,M;S&&(P=Xo(w).items);for(var B in L.errors){var _=L.errors[B],q=_.path,K=_.errors;f&&(K=K.map(function(Ze){return Lr(Lr({},Ze),{},{str:Jt(Ze)})}));var J={path:q,errors:K};if(g){var U=Hn(m?w:e,q),te=q.length===1;if(!te&&U.get("type")!=="group"){var Q=!0,ae=O,ce=Ll(U,r,ae,Q);J.itemStr=ce}}if(S){var ie=P[B],le=!ie;if(le&&(M||(M=Xo(e).items),ie=M[B]),ie){var pe=Lr(Lr({},ie.position),{},{index:ie.index,type:ie.type,isDeleted:le});J.itemPosition=pe;var se=ie.index?gn+"__"+ie.type+(le?"__deleted":""):as,me=Lr({},pe);if(O){for(var Ce,ge=0,Ae=["caseNo","globalLeafNo","globalGroupNo","globalNoByType"];ge<Ae.length;ge++){var Pe=Ae[ge];me[Pe]!=null&&(me[Pe]=me[Pe]+1)}me.indexPath=(Ce=pe.indexPath)===null||Ce===void 0?void 0:Ce.map(function(Ze){return Ze+1})}J.itemPositionStr=Jt(se,me),ie.index&&(ie.caseId&&ie.type!=="case_group"&&(J.itemPositionStr=Jt(is,Lr(Lr({},me),{},{str:J.itemPositionStr}))),ie.type!=="case_group"&&(J.itemPositionStr=Jt(os,Lr(Lr({},me),{},{str:J.itemPositionStr}))))}}V.push(J)}for(var Ve=[],Ie=[],De=0,Ee=V;De<Ee.length;De++){var Ne=Ee[De],Xe=Ne.errors.filter(function(Ze){return!!Ze.fixed}),ar=Ne.errors.filter(function(Ze){return!Ze.fixed&&Ze.key!=="EMPTY_QUERY"});Xe.length&&Ve.push(Lr(Lr({},Ne),{},{errors:Xe})),ar.length&&Ie.push(Lr(Lr({},Ne),{},{errors:ar}))}return{fixedTree:w,allErrors:V,fixedErrors:Ve,nonFixedErrors:Ie,isSanitized:N}};function An(n,e,t,r){var a=e.get("id");n.errors[a]||(n.errors[a]={path:[].concat((0,Fe.A)(t),[a]),errors:[]}),n.errors[a].errors.push(r)}function ps(n,e){var t=e.get("id");n.errors[t]&&n.errors[t].errors.map(function(r){r.fixed=!0})}function vs(n,e,t,r,a){var o=n?.get("type");return o==="group"||o==="rule_group"||o=="case_group"||o=="switch_group"?ig(n,e,t,r,a):o==="rule"?gs(n,e,t,r,a):n}function ig(n,e,t,r,a){var o,u,i,l,s,c,d=a.removeEmptyGroups,f=a.removeIncompleteRules,p=a.forceFix,g=a.config,v=g.settings.showErrorMessage,m=!v||p,h=n.get("id"),O=n.get("children1"),b=!e.length,S=O,C=n.get("type"),L=n.get("properties"),w=L?.get("field"),N=L?.get("mode"),V=L==null||(o=L.get)===null||o===void 0?void 0:o.call(L,"operator"),P=C==="rule_group"&&N==="array",M=C==="case_group",B=M&&O==null,_=V?(u=(i=g.operators[V])===null||i===void 0?void 0:i.cardinality)!==null&&u!==void 0?u:1:void 0,q=M?!B:P?_==0:d,K=P||M;!h&&t&&(h=t,n=n.set("id",h),r.sanitized=!0),K&&(n=gs(n,e,t,r,a));var J={errors:{}};O=(l=O)===null||l===void 0?void 0:l.map(function(ce,ie){return vs(ce,e.concat(h),ie,J,a)});var U=(s=O)===null||s===void 0?void 0:s.filter(function(ce){return ce!=null});d&&(O=U);var te=J.sanitized||S?.size!=((c=O)===null||c===void 0?void 0:c.size),Q=!(U!=null&&U.size),ae=d&&!b;return P&&w&&(ae=f),Q&&q&&(An(r,n,e,{key:b?Vl:M?Dl:P?Il:xl,args:{field:w},fixed:ae}),ae&&(ps(r,n),n=void 0)),te&&(r.sanitized=!0),te&&n&&(n=n.set("children1",O)),r.errors=Lr(Lr({},r.errors),J?.errors||{}),n}function gs(n,e,t,r,a){var o=a.removeIncompleteRules,u=a.removeEmptyRules,i=a.forceFix,l=a.config,s=a.oldConfig,c=l.settings.showErrorMessage,d=!c||i,f=n,p=n.get("id"),g=n.get("type"),v=g==="case_group",m=n.get("properties");if(!m)if(v)m=new ye.default.Map;else{var h={key:fi,args:{},fixed:o||u};An(r,n,e,h);return}var O=m.get("field")||null;v&&(O="!case_value");var b=m.get("fieldSrc")||null,S=m.get("operator")||null,C=m.get("operatorOptions"),L=m.get("valueSrc"),w=m.get("value"),N=m.get("valueError"),V=m.get("fieldError"),P=function(){var Ee,Ne;return{field:((Ee=O)===null||Ee===void 0||(Ne=Ee.toJS)===null||Ne===void 0?void 0:Ne.call(Ee))||O,fieldSrc:b,operator:S,operatorOptions:C?C.toJS():{},valueSrc:L?L.toJS():null,value:w?w.toJS():null,valueError:N?N.toJS():null,fieldError:V||null}},M=P();!p&&t&&(p=t,n=n.set("id",p),r.sanitized=!0);var B=O?Re(l,O):null;O&&!B&&(An(r,n,e,{key:Nl,args:{field:O},side:"lhs",fixed:o||u}),O=null),O==null&&!v&&(m=["operator","operatorOptions","valueSrc","value","valueError","fieldError","field"].reduce(function(De,Ee){return De.delete(Ee)},m),S=null),!b&&O&&!v&&(b=Zs(O),m=m.set("fieldSrc",b)),(S==="range_between"||S==="range_not_between")&&(S=S==="range_between"?"between":"not_between",m=m.set("operator",S));var _=S?lr(l,S,O):null;S&&!_&&(An(r,n,e,{key:kl,args:{operator:S},side:"op",fixed:o||u}),S=null);var q=O?io(l,O):[];O&&!v&&(q!=null&&q.length?S&&q.indexOf(S)==-1&&(S==="is_empty"||S==="is_not_empty"?(S=S==="is_empty"?"is_null":"is_not_null",m=m.set("operator",S)):(An(r,n,e,{key:Bl,args:{operator:S,field:O},side:"lhs",fixed:o||u}),S=null)):(An(r,n,e,{key:Ul,args:{field:O},side:"lhs",fixed:o||u}),S=null)),S==null&&!v&&(m=["operatorOptions","valueSrc","value","valueError"].reduce(function(De,Ee){return De.delete(Ee)},m)),C=m.get("operatorOptions"),!S||C&&!_.options?(C=null,m=m.delete("operatorOptions")):S&&!C&&_.options&&(C=Aa(l,S,O),m=m.set("operatorOptions",C)),L=m.get("valueSrc"),w=m.get("value");var K=!0,J=Vn(l,s,m,O,S,null,d,K),U=J.newValue,te=J.newValueSrc,Q=J.newValueError,ae=J.validationErrors,ce=J.newFieldError,ie=J.fixedField;w=U,L=te,N=Q,V=ce,O=ie,m=m.set("field",O),m=m.set("value",w),m=m.set("valueSrc",L),c?m=m.set("valueError",N).set("fieldError",V):m=m.delete("valueError").delete("fieldError");var le=P(),pe=!qa(M,le),se=wi(m.toObject(),l),me=v?se.parts.value:se.score>=3;if(pe&&(r.sanitized=!0,n=n.set("properties",m)),ae?.map(function(De){return An(r,n,e,De)}),!me&&!v){var Ce=se.score?o:u,ge={key:fi,args:{}};if(!se.parts.field)ge.key=Wl,ge.side="lhs";else if(!se.parts.value){var Ae,Pe,Ve,Ie;ge.key=Kl,ge.side="rhs",(Ae=le.valueSrc)!==null&&Ae!==void 0&&Ae[0]&&((Pe=le.valueSrc)===null||Pe===void 0?void 0:Pe[0])!=((Ve=M.valueSrc)===null||Ve===void 0?void 0:Ve[0])&&((Ie=le.value)===null||Ie===void 0?void 0:Ie[0])!=null&&(ge.key=$l,ge.args={valueSrcs:le.valueSrc})}ge.fixed=Ce,An(r,n,e,ge),Ce&&(ps(r,n),n=void 0)}return n}var Xn=function(e,t,r,a,o,u,i,l){var s=arguments.length>8&&arguments[8]!==void 0?arguments[8]:!1,c=arguments.length>9&&arguments[9]!==void 0?arguments[9]:!1,d=arguments.length>10&&arguments[10]!==void 0?arguments[10]:!1,f=[],p=o;if(o!=null){var g,v,m,h;if(i==="field"){var O=sg(t,r,o,i,u,l,e,a,s,c),b=(0,Le.A)(O,2);p=b[0],f=b[1]}else if(i==="func"){var S=cg(t,r,o,i,u,l,e,a,s,c,d),C=(0,Le.A)(S,2);p=C[0],f=C[1]}else if(i==="value"||!i){var L=lg(r,o,i,u,l,e,a,s,c),w=(0,Le.A)(L,2);p=w[0],f=w[1]}var N=!((g=f)!==null&&g!==void 0&&g.find(function(pe){return!pe.fixed})),V=!!r&&!["field","func"].includes(i)&&(!((v=f)!==null&&v!==void 0&&v.length)||N);if(V){var P=wr(e,r,a,i),M=a?lr(e,a,r):null,B=dt(e,r,a,P,i,{forExport:!0}),_=i==="field"?Re(e,o):null,q=B,K=B.validateValue;if(typeof K=="function"){var J=[p,q,a,M];i==="field"&&J.push(_);var U=K.call.apply(K,[e.ctx].concat(J));if((0,Cr.A)(U)==="object"&&U!==null&&!Array.isArray(U)){var te,Q;(te=U.error)!==null&&te!==void 0&&te.key?Q=Lr({},U.error):Q={key:U.error,args:null},U.fixedValue!==void 0&&s&&(Q.fixed=!0,Q.fixedFrom=p,Q.fixedTo=U.fixedValue,p=U.fixedValue),f.push(Q)}else typeof U=="boolean"?U==!1&&f.push({key:Ml,args:{}}):typeof U=="string"&&f.push({key:U,args:null})}}if(N=!((m=f)!==null&&m!==void 0&&m.find(function(pe){return!pe.fixed})),(h=f)!==null&&h!==void 0&&h.length&&!N&&s){var ae=Re(e,r),ce=ae?.fieldSettings,ie=ce?.defaultValue;if(ie!==void 0){var le=f[f.length-1];le.fixed=!0,le.fixedFrom=p,le.fixedTo=ie,p=ie,f.map(function(pe){pe.fixed=!0})}}}return[p,f]},ug=function(e,t,r,a,o){var u=ye.default.List.isList(e)?e.toJS():e instanceof Array?(0,Fe.A)(e):void 0,i=e,l=[];if(u){var s=u.reduce(function(m,h){var O=(0,Le.A)(m,2),b=O[0],S=O[1],C=ba(t,h);return C==null?[b,[].concat((0,Fe.A)(S),[h])]:[[].concat((0,Fe.A)(b),[C.value]),S]},[[],[]]),c=(0,Le.A)(s,2),d=c[0],f=c[1],p=f.length>0;if(r=r||o===!0,i=r&&p?d:e,f.length){var g=r&&p;l.push({key:pi,args:{badValues:f,count:f.length},fixed:g,fixedFrom:g?u:void 0,fixedTo:g?i:void 0})}return[i,l]}else{var v=ba(t,e);return v==null?(i=r?null:e,l.push({key:zl,args:{value:e},fixed:r,fixedFrom:r?e:void 0,fixedTo:r?i:void 0})):i=v.value,[i,l]}},lg=function(e,t,r,a,o,u){var i=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null,l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:!1,s=arguments.length>8&&arguments[8]!==void 0?arguments[8]:!1,c=[],d=t;if(e){var f=Re(u,e),p=wr(u,e,i,r),g=u.widgets[p],v=g?.type,m=g?.jsType,h=f?.fieldSettings,O=h?.treeValues||h?.listValues,b=!!(h!=null&&h.asyncFetch),S=O||b;if(a&&v&&a!=v)return c.push({key:Hl,args:{wType:v,valueType:a}}),[t,c];if(m&&!og(t,m)&&!S)return c.push({key:Jl,args:{jsType:m,valueTypeof:ss(t)}}),[t,c];if(h){var C=o||O;if(C&&!h.allowCustomValues&&p!=="case_value"){var L=ug(t,C,l,s,u.settings.removeInvalidMultiSelectValuesOnLoad),w=(0,Le.A)(L,2);d=w[0],c=w[1]}h.maxLength>0&&t!=null&&String(t).length>h.maxLength&&(d=l?String(t).substring(0,h.maxLength):t,c.push({key:ql,args:{value:t,length:String(t).length,fieldSettings:h},fixed:l,fixedFrom:l?t:void 0,fixedTo:l?d:void 0}));var N=h.min!=null&&h.max!=null?mi:void 0;h.min!=null&&t<h.min&&(d=l?h.min:t,c.push({key:vi,args:{value:t,fieldSettings:h,context:N},fixed:l,fixedFrom:l?t:void 0,fixedTo:l?d:void 0})),h.max!=null&&t>h.max&&(d=l?h.max:t,c.push({key:gi,args:{value:t,fieldSettings:h,context:N},fixed:l,fixedFrom:l?t:void 0,fixedTo:l?d:void 0}))}}return[d,c]},sg=function(e,t,r,a,o,u,i){var l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:null,s=arguments.length>8&&arguments[8]!==void 0?arguments[8]:!1,c=arguments.length>9&&arguments[9]!==void 0?arguments[9]:!1,d=[],f=i.settings,p=f.fieldSeparator,g=f.canCompareFieldWithField,v=(0,Cr.A)(t)=="object"&&t?._isFuncArg,m=Array.isArray(e)?e.join(p):e,h=Re(i,e),O=Array.isArray(r)?r.join(p):r,b=Re(i,r);if(!b)return d.push({key:Ql,args:{field:O}}),[r,d];if(e&&O===m&&!v)return d.push({key:Yl,args:{field:m}}),[r,d];if(o&&o!=b.type)return d.push({key:Zl,args:{field:O,type:b.type,expected:o}}),[r,d];if(e&&!v&&g){var S=g(m,h,O,b,l);if(!S)return d.push({key:Xl,args:{leftField:m,rightField:O}}),[r,d]}return[r]},cg=function(e,t,r,a,o,u,i){var l,s,c=arguments.length>7&&arguments[7]!==void 0?arguments[7]:null,d=arguments.length>8&&arguments[8]!==void 0?arguments[8]:!1,f=arguments.length>9&&arguments[9]!==void 0?arguments[9]:!1,p=arguments.length>10&&arguments[10]!==void 0?arguments[10]:!1,g=r,v=[];if(!r)return[r];var m=(l=r.get)===null||l===void 0?void 0:l.call(r,"func");if(!m)return[r];var h=Re(i,t);if(h!=null&&h.funcs&&!h.funcs.includes(m))return v.push({key:es,args:{funcKey:m,field:t}}),[r,v];var O=Wr(i,m);if(!O)return v.push({key:_l,args:{funcKey:m}}),[r,v];var b=(s=O.label)!==null&&s!==void 0?s:m;if(o&&O.returnType!=o)return v.push({key:ts,args:{funcKey:m,funcName:b,returnType:O.returnType,valueType:o}}),[r,v];d=d||p;for(var S in O.args){var C,L=O.args[S],w=g.get("args"),N=w?w.get(S):void 0,V=Re(i,L),P=(C=V?.label)!==null&&C!==void 0?C:S,M=N?N.get("value"):void 0,B=N?N.get("valueSrc"):void 0;if(M!==void 0){var _=Xn(i,e,V,c,M,L.type,B,u,d,f,p),q=(0,Le.A)(_,2),K=q[0],J=q[1],U=!(J!=null&&J.length),te=d&&K!==M,Q=d&&!U&&!te&&(f||p);if(te&&(g=g.setIn(["args",S,"value"],K)),Q&&(g=g.deleteIn(["args",S]),g=ao(i,g,O,S)),!U){var ae,ce,ie=(ae=(ce=J.find(function(ge){return!ge.fixed&&!ge.ignore}))!==null&&ce!==void 0?ce:J.find(function(ge){return!ge.fixed}))!==null&&ae!==void 0?ae:J[0],le=te||Q,pe=J.filter(function(ge){return!ge.ignore}).length===0;if(ie){var se=Jt(ie);v.push({key:Gl,args:{funcKey:m,funcName:b,argKey:S,argName:P,argValidationError:se,argErrors:J},ignore:pe,fixed:le,fixedFrom:le?M:void 0,fixedTo:le?te?K:L.defaultValue:void 0})}}}else if(!L.isOptional&&(f||p)){var me=d&&L.defaultValue!==void 0&&(f||p),Ce=f;Ce&&v.push({key:rs,args:{funcKey:m,funcName:b,argKey:S,argName:P},fixed:me,fixedTo:me?L.defaultValue:void 0,ignore:!me}),me&&(g=g.deleteIn(["args",S]),g=ao(i,g,O,S))}}return[g,v]},bi=function(e,t,r,a,o){var u=lr(e,r,t),i=r?Br(u):null,l=o.toJS?o.toJS():o,s=a.toJS?a.toJS():a,c=l.filter(function(h){return h=="value"||h==null}).length==i,d;if(u!=null&&u.validateValues&&c){var f=l[0],p=wr(e,t,r,f),g=dt(e,t,r,p,f),v=g!=null&&g.toJS?s.map(function(h){var O=g.toJS.call(e.ctx,h,g);return O instanceof Date&&(O=O.getTime()),O}):s,m=u.validateValues(v);typeof m=="boolean"&&m==!1&&(d={key:ns,args:{jsValues:v,values:s}})}return d},Vn=function(e){var t,r,a,o,u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=arguments.length>2?arguments[2]:void 0,l=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,c=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,d=arguments.length>6&&arguments[6]!==void 0?arguments[6]:!1,f=arguments.length>7&&arguments[7]!==void 0?arguments[7]:!1,p=arguments.length>8&&arguments[8]!==void 0?arguments[8]:!1;u||(u=e);var g=e.settings,v=g.keepInputOnChangeFieldSrc,m=g.convertableWidgets,h=g.clearValueOnChangeField,O=g.clearValueOnChangeOp,b=l=="!case_value",S=i.get("field");!S&&b&&(S=l);var C=i.get("fieldType"),L=i.get("fieldSrc"),w=i.get("operator"),N=i.get("value"),V=i.get("valueSrc",new ye.default.List),P=i.get("valueType",new ye.default.List),M=i.get("valueError",new ye.default.List),B=i.get("asyncListValues"),_=b,q=lr(u,w),K=lr(e,s,l),J=b?1:w?Br(q):null,U=b?1:s?Br(K):null,te=Re(u,S),Q=Re(e,l),ae=!S&&C&&v,ce=te?.type||C,ie=Q?.type||!l&&ae&&ce,le=te?.listValuesType,pe=Q?.listValuesType,se=((t=S)===null||t===void 0||(r=t.get)===null||r===void 0?void 0:r.call(t,"func"))||S,me=((a=l)===null||a===void 0||(o=a.get)===null||o===void 0?void 0:o.call(a,"func"))||l,Ce=me!=se,ge=[],Ae=(S||ae)&&(w&&s||_)&&N!=null;(!(ce&&ie&&ce==ie)||c==="field"&&Ce&&h||c==="operator"&&O)&&(Ae=!1),Ce&&oo.includes(ie)&&(pe&&pe===le||(Ae=!1)),!_&&(!(N!=null&&N.size)&&U||N!=null&&N.size&&!U)&&(Ae=!1);var Pe;if(L==="func"&&l){var Ve=Xn(e,null,null,s,l,ie,L,B,d,f,p),Ie=(0,Le.A)(Ve,2),De=Ie[0],Ee=Ie[1],Ne=!(Ee!=null&&Ee.length),Xe=De!==l,ar=!Ne&&Xe&&!Ee.find(function(vt){return!vt.fixed}),Ze=d&&!Ne&&!ar&&!!c&&l!==S,Xr=!1;if(Xr?l=null:Ze?l=S:Xe&&(l=De),!Ne){var Tr=!Ne&&!ar&&!Xr&&!Ze,Pr=Ee.find(function(vt){return!vt.fixed&&!vt.ignore});Tr&&Pr&&(Pe=Jt(Pr)),Ee.map(function(vt){return ge.push(Lr(Lr({side:"lhs"},vt),{},{fixed:vt.fixed||Ze||Xr}))})}}for(var or=0;or<U;or++){var at=V.get(or)||null,bt=wr(u,S,w,at),ot=wr(e,l,s,at),St=at==="value"?bt:wr(u,S,w,"value"),ir=at==="value"?ot:wr(e,l,s,"value"),Lt=ir==St||(m[St]||[]).includes(ir)||!St&&ae;Lt||(Ae=!1)}w!=s&&[w,s].includes("proximity")&&(Ae=!1);var Vt=V.first(),Hr=dt(e,l,s,null,Vt),it=Ts(e,l,s,null);!l&&ae&&(it=Object.keys(e.settings.valueSourcesInfo));var ur=it[0],Zr;U===1&&Hr&&Hr.type!==void 0?Zr=Hr.type:U===1&&Q&&Q.type!==void 0&&(Zr=Q.type==="!group"?"number":Q.type);var Qr=Ae&&c==="operator"&&J===1&&U===2,Gr=[],ft=[],wn=[],pt=Array.from({length:U},function(){return null});if(Ae)for(var Ur=function(jr){var gr=N.get(jr),Dt=P.get(jr)||null,yn=V.get(jr)||null;Qr&&jr===1&&(gr=Gr[0]!==void 0?Gr[0]:N.get(0),Gr[jr]=gr,Dt=P.get(0)||null,yn=V.get(0)||null);var $b=yn?it.find(function($t){return $t==yn})!==void 0:!0,Wb=Xn(e,l,l,s,gr,Dt,yn,B,d,f,p),Vp=(0,Le.A)(Wb,2),Dp=Vp[0],Ct=Vp[1],ka=!(Ct!=null&&Ct.length),Vo=Dp!==gr,Kb=!ka&&Vo&&!(Ct!=null&&Ct.find(function($t){return!$t.fixed})),zb=!(Ct!=null&&Ct.find(function($t){return!$t.fixed&&!$t.ignore})),Np=!$b||d&&!ka&&!Kb&&(!zb||Ce);ka||Ct?.map(function($t){return ge.push(Lr(Lr({side:"rhs",delta:jr},$t),{},{fixed:$t.fixed||Np}))}),Np&&(Gr[jr]=null,jr===0&&delete Gr[1]);var Hb=!ka&&!Vo,kp=Ct?.find(function($t){return!$t.fixed&&!$t.ignore});Hb&&kp&&(pt[jr]=Jt(kp)),Vo&&(Gr[jr]=Dp),Qr&&jr===0&&!ka&&!Vo&&(Qr=!1),Qr&&jr===0&&["func","field"].includes(yn)&&(Qr=!1)},Ge=0;Ge<U;Ge++)Ur(Ge);if(!Ae){for(var $e=0;$e<U;$e++)if(U===1){var tr,sr=Eu([Q?.defaultValue,Q==null||(tr=Q.fieldSettings)===null||tr===void 0?void 0:tr.defaultValue,Hr?.defaultValue]);Gr[$e]=sr,sr!=null&&sr.func&&(ft[$e]="func")}}for(var Or=0;Or<U;Or++){var Dr=Ae&&V.get(Or)||null,xr=Ae&&P.get(Or)||null;if(Ae&&Qr&&Or===1){var wt,kr;Dr=(wt=ft[Or])!==null&&wt!==void 0?wt:V.get(0),xr=(kr=wn[Or])!==null&&kr!==void 0?kr:P.get(0),ft[Or]=Dr,wn[Or]=xr}var jn=it.includes(Dr);jn||(ft[Or]=ur),xr||(wn[Or]=Zr)}var et=N;(Gr.length>0||!Ae)&&(et=new ye.default.List(Array.from({length:U},function(vt,jr){return Gr[jr]!==void 0?Gr[jr]:Ae?N.get(jr):void 0})));var Qt=V;(ft.length>0||!Ae)&&(Qt=new ye.default.List(Array.from({length:U},function(vt,jr){var gr;return(gr=ft[jr])!==null&&gr!==void 0?gr:Ae&&V.get(jr)||null})));var hn=P;(wn.length>0||!Ae)&&(hn=new ye.default.List(Array.from({length:U},function(vt,jr){var gr;return(gr=wn[jr])!==null&&gr!==void 0?gr:Ae&&P.get(jr)||null})));var Gt=bi(e,l,s,et,Qt);if(Gt){var Yt=Jt(Gt),Ut=d&&U>=2,Bt=et;Ut&&(Gr[1]=et.get(0),et=et.set(1,Gr[1]),pt[1]=pt[0]);var Na=!Ut;Na&&pt.push(Yt),ge.push(Lr(Lr({side:"rhs",delta:-1},Gt),{},{fixed:Ut,fixedFrom:Ut?[Bt.get(0),Bt.get(1)]:void 0,fixedTo:Ut?[et.get(0),et.get(1)]:void 0}))}var Ft=M,Io=M?.size!==pt.length||pt.filter(function(vt,jr){return vt!=M.get(jr)}).length>0;return Io&&(Ft=new ye.default.List(pt)),{canReuseValue:Ae,newValue:et,newValueSrc:Qt,newValueType:hn,operatorCardinality:U,fixedField:l,newValueError:Ft,newFieldError:Pe,validationErrors:ge}},Si=function(e){return(0,Cr.A)(e)=="object"&&e!==null&&!Array.isArray(e)},ms=function(e,t){if(e){var r=e.get("func"),a=r&&Wr(t,r);if(a){var o=e,u=!1;for(var i in a.args){var l=a.args[i],s=l.valueSources,c=l.isOptional,d=l.defaultValue,f=Dn(t,s,l),p=o.get("args"),g=f.length==1?f[0]:void 0,v=p?p.get(i):void 0,m=v?v.get("value"):void 0,h=(v?v.get("valueSrc"):void 0)||g;if(m!==void 0){var O=Nn(m,h,t);if(O===void 0||(O!==m&&(o=o.setIn(["args",i,"value"],O)),u))return}else if(d!==void 0&&!Si(d))o=o.setIn(["args",i,"value"],ys(l)),o=o.setIn(["args",i,"valueSrc"],"value");else if(c)u=!0;else return}return o}}},hs=function(e,t,r,a){var o=r.settings.fieldSeparator;e=e||new ye.default.Map,Array.isArray(t)&&(t=t.join(o));var u=e.get("func"),i=e.get("args");e=e.set("func",t);var l=t&&Wr(r,t),s=t&&Di(r,t),c=u&&Di(r,u),d=bs(c,s,i,r,a);if(d.length){var f=Object.keys(s.args),p=f.filter(function(g){return!d.includes(g)});e=p.reduce(function(g,v){return g.deleteIn(["args",v])},e)}else e=e.set("args",new ye.default.Map);return e=dg(r,e,l),e},dg=function(e,t,r){if(r)for(var a in r.args)t=ao(e,t,r,a);return t},ao=function(e,t,r,a){var o=r.args[a],u=o.valueSources,i=o.defaultValue,l=Dn(e,u,o),s=l.length?l[0]:void 0,c=i?Si(i)&&i.func?"func":"value":void 0,d=c||s,f=t.getIn(["args",a]);return f||(i!==void 0&&(t=t.setIn(["args",a,"value"],ys(o))),d&&(t=t.setIn(["args",a,"valueSrc"],d))),t},ys=function(e){var t=e.defaultValue;return Si(t)&&!ye.default.Map.isMap(t)&&t.func?ye.default.fromJS(t,function(r,a){return ye.default.Iterable.isIndexed(a)?a.toList():a.toOrderedMap()}):t},Fi=function(e,t,r,a,o){if(e&&e.get("func")){e=e.setIn(["args",t,"value"],r);var u=e.getIn(["args",t,"valueSrc"]),i=a.valueSources,l=Dn(o,i,a),s=l.length==1?l[0]:void 0;!s&&l.includes("value")&&(s="value"),!u&&s&&(e=e.setIn(["args",t,"valueSrc"],s))}return e},Os=function(e,t,r,a,o){return e&&e.get("func")&&(e=e.setIn(["args",t],new ye.default.Map({valueSrc:r}))),e},bs=function(e,t,r,a){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(e?.returnType!=t?.returnType)return[];var u=!1,i=Object.keys(t.args),l=i.filter(function(s,c){var d=t.args[s],f=e.args[s],p=Object.keys(e.args).indexOf(s);if(!f&&(d.defaultValue!==void 0||d.isOptional))return!0;if(u&&c!==p||f?.type!=d.type||oo.includes(d.type)&&(!f.listValuesType||f.listValuesType!==d.listValuesType))return!1;if(r){var g,v=r.get(s),m=v?.get("value"),h=v?.get("valueSrc");if(h&&d.valueSources&&!d.valueSources.includes(h))return!1;var O=null,b=null,S=d,C=null,L=!0,w=Xn(a,O,S,b,m,S.type,h,C,o,L),N=(0,Le.A)(w,2),V=N[0],P=N[1];if(P!=null&&(g=P.filter(function(M){return!M.fixed}))!==null&&g!==void 0&&g.length)return!1}return!0});return l},oo=["select","multiselect","treeselect","treemultiselect"],Ss=function(e,t){var r;return((r=e.types[t])===null||r===void 0?void 0:r.operators)||null},io=function(e,t){var r=Re(e,t),a=r?r.operators:[];return a},Ci=function(e,t){var r,a=io(e,t);return(r=a?.[0])!==null&&r!==void 0?r:null},Fs=function(e,t,r){var a=null;if(e){if(t==="field"){var o=Re(r,e);o&&(a=o.type)}else if(t==="func"){var u=e.get("func");if(u){var i=Wr(r,u);i&&(a=i.returnType||i.type)}}}return a},fg=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return ja(e,t,r,"funcs","subfields")},ja=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"fields",o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"subfields";if(!e)return null;var u=t.settings.fieldSeparator,i=Nr(e,t),l=Nr(r,t),s=i.slice(l.length).map(function(c,d,f){return f.slice(0,d+1)}).map(function(c){return[].concat((0,Fe.A)(l),(0,Fe.A)(c)).join(u)}).map(function(c){var d=qt(t,c,a,o);return d&&d.label||Xa()(c.split(u))}).filter(function(c){return c!=null});return s},Cs=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(!e)return null;var a=r&&qt(t,r)||null,o=t.settings.fieldSeparator,u=Nr(e,t),i=Xs(e,r,t),l=i?Nr(r,t):[];return u.slice(l.length).map(function(s,c,d){return d.slice(0,c+1)}).map(function(s){return{part:[].concat((0,Fe.A)(l),(0,Fe.A)(s)).join(o),key:s[s.length-1]}}).map(function(s){var c=s.part,d=s.key,f=qt(t,c);return{key:d,cnf:f}}).map(function(s,c,d){var f=s.key,p=s.cnf,g=c>0?d[c-1].cnf:a;return[f,p,g]})},pg=function(e,t,r,a){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1,i=dt(e,t,r,null,o)||{},l=lr(e,r,t)||{},s=u?1:l.cardinality,c=null;if(s>1){var d=i.valueLabels||l.valueLabels;d&&(c=d[a]),c&&(0,Cr.A)(c)!=="object"&&(c={label:c,placeholder:c}),c||(c={label:e.settings.valueLabel+" "+(a+1),placeholder:e.settings.valuePlaceholder+" "+(a+1)})}else{var f=i.valueLabel,p=i.valuePlaceholder;c={label:f||e.settings.valueLabel,placeholder:p||e.settings.valuePlaceholder}}return c};function Ti(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,a=[],o=[];if(!e)return{widgets:a,valueSrcs:o};var u=po(e),i=u?"".concat(u,"__").concat(t,"__").concat(r):null,l=vo(n,"_getWidgetsAndSrcsForFieldOp",i);if(l)return l;var s=(0,Cr.A)(e)==="object"&&(!!e.func&&!!e.arg||e._isFuncArg),c=Re(n,e),d=t?n.operators[t]:null;if(c!=null&&c.widgets){var f=function(){var h=c.widgets[p];if(!n.widgets[p])return 1;var O=n.widgets[p].valueSrc||"value",b=!0;if(p==="field"&&(b=b&&Dn(n,["field"],c).length>0),p==="func"&&(b=b&&Dn(n,["func"],c).length>0),r==="value"&&!h.operators&&!s&&e!=="!case_value"&&(b=!1),h.operators&&t&&(b=b&&h.operators.indexOf(t)!=-1),r&&r!=O&&r!=="const"&&(b=!1),d&&d.cardinality==0&&O!=="value"&&(b=!1),b){var S,C;a.push(p);var L=((S=c.valueSources)===null||S===void 0?void 0:S.indexOf(O))!=-1;(d==null||(C=d.valueSources)===null||C===void 0?void 0:C.indexOf(O))==-1&&(L=!1),L&&!o.find(function(w){return w==O})&&o.push(O)}};for(var p in c.widgets)f()}var g=function(h){var O=0;return c.preferWidgets?c.preferWidgets.includes(h)&&(O+=10-c.preferWidgets.indexOf(h)):h==c.mainWidget&&(O+=100),h==="field"&&(O-=1),h==="func"&&(O-=2),O};a.sort(function(m,h){return g(h)-g(m)});var v={widgets:a,valueSrcs:o};return go(n,"_getWidgetsAndSrcsForFieldOp",i,v),v}var vg=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=Ti(e,t,r,a),u=o.widgets;return u},Dn=function(e,t,r){var a;if(!r)return t;var o=(a=r.type)!==null&&a!==void 0?a:r.returnType;return o==="!group"&&(o="number"),t||(t=Object.keys(e.settings.valueSourcesInfo)),t.filter(function(u){var i=!0;if(u==="field"&&e.__fieldsCntByType){var l=r._isFuncArg?0:1;i=i&&e.__fieldsCntByType[o]>l}return u==="func"&&(r.funcs&&(i=i&&r.funcs.length>0),e.__funcsCntByType&&(i=i&&e.__funcsCntByType[o]>0)),i})},Ts=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=Ti(e,t,r,null),u=o.valueSrcs,i=Dn(e,u,a);return i},wr=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=Ti(e,t,r,a),u=o.widgets,i=null;return u.length&&(i=u[0]),i},mn=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};if(e){var u=Re(t,e)||{},i=t.settings.fieldSeparator,l=Nr(e,t),s=Array.isArray(e)?e.join(i):e;if(o!=null&&o.useTableName&&u.tableName){var c=(0,Fe.A)(l);c[0]=u.tableName,s=c.join(i)}if(u.fieldName&&(s=u.fieldName),a){var d=Re(t,a)||{},f=a;s.indexOf(f+i)==0?s=s.slice((f+i).length):u.fieldName||r.errors.push("Can't cut group ".concat(f," from field ").concat(s))}return s}},Ei=function(e,t){var r=e.get("type"),a=e.getIn(["properties","mode"]);return r=="rule_group"&&a=="array"?gg(e,t):r=="group"||r=="rule_group"?mg(e,t):hg(e,t)},gg=function(e,t){var r=e.get("children1"),a=e.get("properties");return Es(a.toObject(),r,t)},Es=function(e,t,r){var a,o,u=e.operator,i=(a=(o=r.operators[u])===null||o===void 0?void 0:o.cardinality)!==null&&a!==void 0?a:1,l=i==0,s={group:!Li(e,r),children:!Ai(t,r)},c=s.group&&(l?s.children:!0);return!c},mg=function(e,t){var r=e.get("children1");return Ai(r,t)},Ai=function(e,t){var r=e?.size>0&&e.filter(function(a){return!Ei(a,t)}).size>0;return!r},hg=function(e,t){var r=e.get("properties");return Li(r?.toObject()||{},t)},Li=function(e,t){var r=!0,a=3,o=wi(e,t,r),u=o.score>=a;return!u},wi=function(e,t){var r,a,o,u=e.field,i=e.fieldSrc,l=e.fieldType,s=e.operator,c=e.value,d=e.valueSrc,f=e.valueType,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,g=(r=(a=t.operators[s])===null||a===void 0?void 0:a.cardinality)!==null&&r!==void 0?r:1,v=d!=null&&d.get?d.toJS():d,m={parts:{},score:0};if(m.parts.field=p?u!=null:uo(u,i,t),m.parts.operator=!!s,m.parts.value=(c==null||(o=c.filter(function(O,b){return uo(O,v?.[b],t,p)}))===null||o===void 0?void 0:o.size)>=(p?Math.min(g,1):g),m.score=Object.keys(m.parts).filter(function(O){return!!m.parts[O]}).length,p&&m.score<3){var h=!0;!m.parts.value&&i==="func"&&uo(u,i,t,!1,h)&&m.score++,m.parts.field||c?.map(function(O,b){v?.[b]==="func"&&uo(O,v?.[b],t,!1,h)&&m.score++})}return m},uo=function n(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0;if(!a&&t=="func"&&e){var u,i=(u=e.get)===null||u===void 0?void 0:u.call(e,"func"),l=Wr(r,i);if(l){var s=e.get("args");for(var c in l.args){var d=l.args[c],f=s?s.get(c):void 0,p=f?f.get("value"):void 0,g=f?f.get("valueSrc"):void 0;if(p==null&&d?.defaultValue===void 0&&!(d!=null&&d.isOptional)||p!=null&&!n(p,g,r,o?a:!0))return!1}return!0}}return e!=null},Nn=function(e,t,r){return t=="func"?ms(e,r):e},ji=function n(e){var t=e.get("children1");if(t?.size==1){var r=t.first(),a=r.get("type");return a==="group"?n(r):r}return null},yg=y(55364),Og=y.n(yg),bg=y(1779),kt=y.n(bg),Sg=y(18678),Ri=y.n(Sg);function As(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Ls(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?As(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):As(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function Fg(n,e){return Ri().apply(n,e)}function Cg(n,e){return Ri().add_operation(n,e)}var ws={CALL:function(e,t){for(var r=arguments.length,a=new Array(r>2?r-2:0),o=2;o<r;o++)a[o-2]=arguments[o];return e.call.apply(e,[t].concat(a))},JSX:function(e,t){return{type:e,props:t}},mergeObjects:function(e,t){return Ls(Ls({},e),t)},fromEntries:function(e){return Object.fromEntries(e)},strlen:function(e){return e?.length||0},regexTest:function(e,t,r){return e?.match(new RegExp(t,r))!=null},now:function(){return new Date},date_add:function(e,t,r){return Jn()(e).add(t,r).toDate()},toLowerCase:function(e){return e.toLowerCase()},toUpperCase:function(e){return e.toUpperCase()}};function Tg(){for(var n in ws)Cg(n,ws[n])}function Eg(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=Ag(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,u=!1,i;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return o=s.done,s},e:function(s){u=!0,i=s},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(u)throw i}}}}function Ag(n,e){if(n){if(typeof n=="string")return js(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return js(n,e)}}function js(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function Rs(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function ct(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Rs(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Rs(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}Tg();function Ps(n,e,t){var r;try{r=Ri().apply(n,e)}catch(a){throw a.message="".concat(t.join(".")," :: ").concat(a.message),a}return r}function xs(n,e,t,r){var a;try{a=e.call.apply(e,[n].concat((0,Fe.A)(t)))}catch(o){throw o.message="".concat(r.join(".")," :: ").concat(o.message),o}return a}var nn=["conjunctions","fields","types","operators","widgets","settings","funcs","ctx"],Ra={asyncFetch:{type:"f",args:["search","offset"]},labelYes:{type:"r"},labelNo:{type:"r"},marks:{type:"r",isArr:!0},validateValue:{type:"f",args:["val","fieldSettings","op","opDef","rightFieldDef"]}},Pi=ct(ct({},Ra),{},{factory:{type:"rf"},formatValue:{type:"f",args:["val","fieldDef","wgtDef","isForDisplay","op","opDef","rightFieldDef"]},sqlFormatValue:{type:"f",args:["val","fieldDef","wgtDef","op","opDef","rightFieldDef"]},spelFormatValue:{type:"f",args:["val","fieldDef","wgtDef","op","opDef","rightFieldDef"]},spelImportValue:{type:"f",args:["val","wgtDef","args"]},mongoFormatValue:{type:"f",args:["val","fieldDef","wgtDef","op","opDef"]},elasticSearchFormatValue:{type:"f",args:["queryType","val","op","field","config"]},jsonLogic:{type:"f",args:["val","fieldDef","wgtDef","op","opDef"]},jsonLogicImport:{type:"f",args:["val"]},validateValue:{type:"f",args:["val","fieldSettings","op","opDef","rightFieldDef"]},toJS:{type:"f",args:["val"]}}),Is={options:{factory:{type:"rf"}},formatOp:{type:"f",args:["field","op","vals","valueSrc","valueType","opDef","operatorOptions","isForDisplay","fieldDef"]},mongoFormatOp:{type:"f",args:["field","op","vals","useExpr","valueSrc","valueType","opDef","operatorOptions","fieldDef"]},sqlFormatOp:{type:"f",args:["field","op","vals","valueSrc","valueType","opDef","operatorOptions","fieldDef"]},spelFormatOp:{type:"f",args:["field","op","vals","valueSrc","valueType","opDef","operatorOptions","fieldDef"]},jsonLogic:{type:"f",ignore:"string",args:["field","op","vals","opDef","operatorOptions","fieldDef"]},elasticSearchQueryType:{type:"f",ignore:"string",args:["valueType"]},textSeparators:{type:"r",isArr:!0}},Lg={formatConj:{type:"f",args:["children","conj","not","isForDisplay"]},sqlFormatConj:{type:"f",args:["children","conj","not"]},spelFormatConj:{type:"f",args:["children","conj","not","omitBrackets"]}},Vs={widgetProps:Pi,opProps:Is},wg={renderBrackets:{type:"r",isArr:!0},renderSeps:{type:"r",isArr:!0},jsonLogic:{type:"f",ignore:"string",args:["formattedArgs"]},jsonLogicImport:{type:"f",args:["val"]},spelImport:{type:"f",args:["spel"]},formatFunc:{type:"f",args:["formattedArgs","isForDisplay"]},sqlFormatFunc:{type:"f",args:["formattedArgs"]},mongoFormatFunc:{type:"f",args:["formattedArgs"]},spelFormatFunc:{type:"f",args:["formattedArgs"]}},Ds=ct(ct({},Ra),{},{fieldSettings:Ra}),Ns=ct(ct({},Ra),{},{fieldSettings:Ra,widgets:{x:Vs},mainWidgetProps:Pi}),jg={locale:{mui:{type:"f",args:[],invokeWith:[],ignore:"jl"}},caseValueField:Ns,canCompareFieldWithField:{type:"f",args:["leftField","leftFieldConfig","rightField","rightFieldConfig","op"]},formatReverse:{type:"f",args:["q","op","reversedOp","operatorDefinition","revOperatorDefinition","isForDisplay"]},sqlFormatReverse:{type:"f",args:["q"]},spelFormatReverse:{type:"f",args:["q"]},formatField:{type:"f",args:["field","parts","label2","fieldDefinition","config","isForDisplay"]},formatSpelField:{type:"f",args:["field","parentField","parts","partsExt","fieldDefinition","config"]},formatAggr:{type:"f",args:["whereStr","aggrField","operator","value","valueSrc","valueType","opDef","operatorOptions","isForDisplay","aggrFieldDef"]},normalizeListValues:{type:"f",args:["listValues","type","fieldSettings"]},renderConfirm:{type:"f",args:["props"]},useConfirm:{type:"f",args:[]},renderField:{type:"rf"},renderOperator:{type:"rf"},renderFunc:{type:"rf"},renderConjs:{type:"rf"},renderButton:{type:"rf"},renderIcon:{type:"rf"},renderButtonGroup:{type:"rf"},renderValueSources:{type:"rf"},renderFieldSources:{type:"rf"},renderProvider:{type:"rf"},renderSwitch:{type:"rf"},renderSwitchPrefix:{type:"r"},renderItem:{type:"rf"},renderBeforeWidget:{type:"rf"},renderAfterWidget:{type:"rf"},renderBeforeActions:{type:"rf"},renderAfterActions:{type:"rf"},renderBeforeCaseValue:{type:"rf"},renderAfterCaseValue:{type:"rf"},renderRuleError:{type:"rf"}},Rg={fields:{x:Ns},widgets:{x:Pi},conjunctions:{x:Lg},operators:{x:Is},types:{x:{widgets:{x:Vs}}},funcs:{x:ct(ct(ct({},Ds),wg),{},{args:{x:ct({},Ds)}})},settings:jg},Zn=function(e){return(0,Cr.A)(e)=="object"&&e!==null&&!Array.isArray(e)},ks=function(e,t){if(e.__fieldNames)throw new Error("Don't apply `compressConfig()` to extended config");var r=Xt()(e,nn);delete r.ctx;for(var a=function s(c,d,f,p){if(Zn(c)){if(Oa(c)&&(c=zo(c)),f[0]==="funcs"&&!d){var g=f[f.length-1];d=qt({funcs:p.BasicFuncs},g,"funcs","subfields")||void 0,d&&(c.$$key=g)}if(d!==void 0&&Zn(d))for(var v in d)Object.prototype.hasOwnProperty.call(d,v)&&(!Object.keys(c).includes(v)||c[v]===void 0&&d[v]!==void 0?c[v]="$$deleted":(c[v]=s(c[v],d[v],[].concat((0,Fe.A)(f),[v]),p),c[v]===void 0&&delete c[v]));for(var m in c)if(Object.prototype.hasOwnProperty.call(c,m)){if(!d||!Object.keys(d).includes(m)){var h;c[m]=s(c[m],(h=d)===null||h===void 0?void 0:h[m],[].concat((0,Fe.A)(f),[m]),p)}c[m]===void 0&&delete c[m]}Object.keys(c).length===0&&(c=void 0)}else Array.isArray(c)&&c.forEach(function(O,b){c[b]=s(c[b],void 0,[].concat((0,Fe.A)(f),[b]),p)});if(!(d!==void 0&&ya(c,d,!0))){if(typeof c=="function")throw new Error("compressConfig: function at ".concat(f.join(".")," should be converted to JsonLogic"));return c}},o=0,u=nn;o<u.length;o++){var i=u[o];if(i!=="ctx")if(i==="fields")r[i]=kt()(r[i]),a(r[i],{},[i]);else if(i==="funcs"){r[i]=kt()(r[i]||{});for(var l in r[i])a(r[i][l],null,[i,l],{BasicFuncs:Z})}else r[i]=kt()(r[i]),a(r[i],t[i],[i])}return r},_s=function(e,t,r){if(!e.settings.useConfigCompress)throw new Error("Please enable `useConfigCompress` in config settings to use decompressConfig()");for(var a={},o=function c(d,f,p){if(Zn(f)){Zn(d)||(d={});for(var g in f)Object.prototype.hasOwnProperty.call(f,g)&&(f[g]==="$$deleted"?delete d[g]:d[g]=c(d[g],f[g],[].concat((0,Fe.A)(p),[g])))}else Array.isArray(f)?d=kt()(f):d=f;return d},u=function c(d,f,p){var g=!1;if(Zn(d)&&Object.prototype.hasOwnProperty.call(d,"$$key")&&d.$$key){var v=qt({funcs:p.BasicFuncs},d.$$key,"funcs","subfields");if(v)delete d.$$key,d=o(kt()(v),d,f),g=!0;else throw new Error("decompressConfig: basic function not found by key ".concat(d.$$key," at ").concat(f.join(".")))}if(!g){if(Zn(d))for(var m in d)Object.prototype.hasOwnProperty.call(d,m)&&(d[m]=c(d[m],[].concat((0,Fe.A)(f),[m]),p));else if(Array.isArray(d)){var h=Eg(d),O;try{for(h.s();!(O=h.n()).done;){var b=O.value;d[b]=c(d[b],[].concat((0,Fe.A)(f),[b]),p)}}catch(S){h.e(S)}finally{h.f()}}}return d},i=0,l=nn;i<l.length;i++){var s=l[i];s==="ctx"?a[s]=Og()({},t.ctx||{},r||{}):s==="funcs"?(a[s]=kt()(e[s]||{}),u(a[s],[s],{BasicFuncs:Z})):s==="fields"?a[s]=kt()(e[s]||{}):(a[s]=kt()(t[s]||{}),o(a[s],e[s]||{},[s]))}return a},Ms=function(e){if(e.__compliled)return e;e=kt()(e);var t={ctx:e.ctx},r=[];return lo(e,e,t,Rg,r),Object.defineProperty(e,"__compliled",{enumerable:!1,writable:!1,value:!0}),e};function lo(n,e,t,r,a){var o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:[];if(e){var u=!o.length;for(var i in r){var l=r[i],s=i==="x"?o:[].concat((0,Fe.A)(o),[i]);if(l.type==="r"){var c=e,d=c[i];if(l.isArr)for(var f in d){var p=ea(d[f],t,[].concat((0,Fe.A)(s),[f]));p!==d[f]&&(a.push("Compiled ".concat(s.join("."),"[").concat(f,"]")),d[f]=p)}else{var g=ea(d,t,s,void 0);g!==d&&(a.push("Compiled R ".concat(s.join("."))),c[i]=g)}}else if(l.type==="rf"){var v=e,m=v[i],h=Pg(m,t,s,l.ignore);h!==m&&(a.push("Compiled JL-RF ".concat(s.join("."))),v[i]=h)}else if(l.type==="f"){var O=e,b=O[i],S=xg(b,t,s,l.args,l.ignore);if(l.invokeWith&&S&&typeof S=="function"){var C;S=(C=S).call.apply(C,[null].concat((0,Fe.A)(l.invokeWith)))}S!==b&&(a.push("Compiled JL-F ".concat(s.join("."))),O[i]=S)}else if(i==="x")for(var L in e){s=[].concat((0,Fe.A)(o),[L]);var w=e[L];lo(n,w,t,l,a,s),w.subfields&&lo(n,w.subfields,t,r,a,s)}else{var N=e[i];lo(n,N,t,l,a,s)}}}}function Pg(n,e,t){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:void 0;return st(n)?function(a,o){o=o||e?.ctx;var u={props:a,ctx:o},i=Ps(n,u,t);typeof i=="string"&&(i={type:i,props:a});var l=ea(i,{ctx:o},t);return l}:typeof n=="string"?function(a,o){o=o||e?.ctx;var u=n.split(".").reduce(function(s,c){return s?.[c]},o);if(u)return xs(this,u,[a,o],t);var i={type:n,props:a},l=ea(i,{ctx:o},t);return l}:n}function xg(n,e,t,r){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:void 0;return st(n)&&a!=="jl"?function(){for(var o=arguments.length,u=new Array(o),i=0;i<o;i++)u[i]=arguments[i];var l=this||e?.ctx,s=(r||[]).reduce(function(d,f,p){return ct(ct({},d),{},(0,ne.A)({},f,u[p]))},{args:u,ctx:l}),c=Ps(n,s,t);return c}.bind(e?.ctx):typeof n=="string"&&a!=="string"?function(){var o=this||e?.ctx,u=n.split(".").reduce(function(c,d){return c?.[d]},o);if(u){for(var i=arguments.length,l=new Array(i),s=0;s<i;s++)l[s]=arguments[s];return xs(this,u,l,t)}else throw new Error("".concat(t.join(".")," :: Function ").concat(n," is not found in ctx"))}.bind(e?.ctx):n}function Ig(n,e){var t;return(e==null||(t=e.components)===null||t===void 0?void 0:t[n])||e.W[n]||e.O[n]}function ea(n,e,t){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:void 0;if(Ho(n)){var a,o=n.type,u=n.props;if(typeof o!="string")throw new Error("renderReactElement for ".concat(t.join("."),": type should be string"));var i=Ig(o,e.ctx)||o.toLowerCase(),l;r!==void 0&&(u=ct(ct({},u),{},{key:r})),(a=u)!==null&&a!==void 0&&a.children&&(l=ea(u.children,e,t),u=ct(ct({},u),{},{children:l}));var s=e.ctx.RCE(i,u);return s}else if(n instanceof Array)return n.map(function(c,d){return ea(c,e,t,""+d)});return n}var Vg=y(6924),Dg=y.n(Vg),Gs={reverseOperatorsForNot:!1,canShortMongoQuery:!0,formatField:function(e,t,r,a,o,u){return u?r:e},caseValueField:{type:"case_value"},fieldSources:["field"],keepInputOnChangeFieldSrc:!0,fieldItemKeysForSearch:["label","path","altLabel","grouplabel"],listKeysForSearch:["title","value"],valueSourcesInfo:{value:{}},fieldSeparator:".",fieldSeparatorDisplay:".",canReorder:!0,canRegroup:!0,canDeleteLocked:!1,canLeaveEmptyGroup:!0,shouldCreateEmptyGroup:!1,exportPreserveGroups:!1,removeEmptyGroupsOnLoad:!0,removeEmptyRulesOnLoad:!0,removeIncompleteRulesOnLoad:!1,removeInvalidMultiSelectValuesOnLoad:!0,showErrorMessage:!1,setOpOnChangeField:["keep","default"],groupOperators:["some","all","none"],defaultGroupConjunction:"AND",locale:{moment:"en"},valueLabel:"Value",valuePlaceholder:"Value",fieldLabel:"Field",operatorLabel:"Operator",funcLabel:"Function",fieldPlaceholder:"Select field",funcPlaceholder:"Select function",operatorPlaceholder:"Select operator",lockLabel:"Lock",lockedLabel:"Locked",deleteLabel:"Delete",addGroupLabel:"Add group",addCaseLabel:"Add condition",addDefaultCaseLabel:"Add default condition",defaultCaseLabel:"Default:",addRuleLabel:"Add rule",addSubRuleLabel:"Add sub rule",delGroupLabel:"Delete",notLabel:"Not",fieldSourcesPopupTitle:"Select source",valueSourcesPopupTitle:"Select value source",removeRuleConfirmOptions:null,removeGroupConfirmOptions:null};function xi(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=Ng(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,u=!1,i;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return o=s.done,s},e:function(s){u=!0,i=s},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(u)throw i}}}}function Ng(n,e){if(n){if(typeof n=="string")return Us(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Us(n,e)}}function Us(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}var kg=0,Bs=0,ra,so={},$s=function(){return ra||(ra=Ks({reactIndex:void 0,maxSize:3,canCompile:void 0})),ra},Ws=function(e,t){var r;for(var a in so){var o=so[a].findExtendedConfig(e,t);if(o){r=o;break}}return r},Ks=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{reactIndex:void 0,maxSize:2,canCompile:!0},t=new Map,r=e.maxSize||2,a=++kg,o,u=!0,i=function(m){return Xt()(m,nn)},l=function(m){var h=xt(m,++Bs,e.canCompile);return c(m,h),h},s=function(){return t.size},c=function(m,h){t.size+1>r&&t.delete(t.keys().next().value),t.set(m,h)},d=function(m){var h=xi(t.keys()),O;try{var b=function(){var L=O.value,w=t.get(L),N=nn.map(function(V){return w[V]===m[V]}).filter(function(V){return!V}).length===0;if(N)return{v:L}},S;for(h.s();!(O=h.n()).done;)if(S=b(),S)return S.v}catch(C){h.e(C)}finally{h.f()}return m},f=function(m,h){var O=xi(t.keys()),b;try{var S=function(){var M=b.value,B=nn.filter(function(q){return M[q]===m[q]}),_=B.length===nn.length&&(h?M.__compliled:!0);if(_)return{v:t.get(M)}},C;for(O.s();!(b=O.n()).done;)if(C=S(),C)return C.v}catch(P){O.e(P)}finally{O.f()}var L=xi(t.values()),w;try{var N=function(){var M=w.value,B=nn.filter(function(q){return M[q]===m[q]}),_=B.length===nn.length&&(h?M.__compliled:!0);if(_)return{v:M}},V;for(L.s();!(w=L.n()).done;)if(V=N(),V)return V.v}catch(P){L.e(P)}finally{L.f()}return null},p=function(m){return f(m)||l(m)},g=function(){u=!1,t.clear(),delete so[a],ra===o&&(ra=void 0)};return o={getExtendedConfig:function(m){return p(i(m))},findExtendedConfig:f,getBasicConfig:d,clearConfigMemo:g,configId:Bs,storeConfigPair:c,getSize:s,configStore:t,memoId:a,meta:e},e.reactIndex===void 0&&(ra=o),so[a]=o,o};function Ii(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=_g(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,u=!1,i;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return o=s.done,s},e:function(s){u=!0,i=s},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(u)throw i}}}}function _g(n,e){if(n){if(typeof n=="string")return zs(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return zs(n,e)}}function zs(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function Hs(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function _t(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Hs(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Hs(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var xt=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(r=r&&e.settings.useConfigCompress,e.__configId)return e;var a=Ws(e,r);if(a)return a;var o=e;r?e.__compliled?e=kt()(e):e=Ms(e):e=kt()(e),e.settings=Dg()({},Gs,e.settings,bu),e.__fieldsCntByType={},e.__funcsCntByType={},e.__fieldNames={},Mg(e.types,e),Js(e.fields,e),qs(e.funcs,e);var u=e.settings.caseValueField;u&&co(u,e,[],!1,!0);var i=e.settings.locale.moment;i&&Jn().locale(i),Object.defineProperty(e,"__configId",{enumerable:!1,writable:!1,value:t||cr()}),e.__cache={},Fu(e);var l=$s();return l.storeConfigPair(o,e),e};function Mg(n,e){for(var t in n){var r=n[t];Gg(t,r,e)}}function Gg(n,e,t){var r=null,a=null;e.mainWidget=e.mainWidget||Object.keys(e.widgets).filter(function(p){return p!="field"&&p!="func"})[0];var o=e.excludeOperators||[];for(var u in e.widgets){var i=e.widgets[u],l=i.defaultOperator;if(i.operators){var s=i.operators.filter(function(p){return!o.includes(p)});r=Ya(r,s)}l&&!o.includes(l)&&(!a||u===e.mainWidget)&&(a=l),u==e.mainWidget&&(i.widgetProps=_t(_t({},e.mainWidgetProps||{}),i.widgetProps||{})),e.widgets[u]=i}e.valueSources||(e.valueSources=Object.keys(t.settings.valueSourcesInfo));var c=Ii(e.valueSources),d;try{for(c.s();!(d=c.n()).done;){var f=d.value;f!="value"&&!e.widgets[f]&&(e.widgets[f]={})}}catch(p){c.e(p)}finally{c.f()}!e.operators&&r&&(e.operators=Array.from(new Set(r))),!e.defaultOperator&&a&&(e.defaultOperator=a)}function Js(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];for(var r in n){var a=[].concat((0,Fe.A)(t),[r]);co(n[r],e,a),n[r].subfields&&Js(n[r].subfields,e,a)}}function qs(n,e){var t,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];if(n){var a=(e==null||(t=e.settings)===null||t===void 0?void 0:t.fieldSeparator)||".";for(var o in n){var u=[].concat((0,Fe.A)(r),[o]),i=u.join(a),l=n[o];if(l.returnType&&(l.type=l.returnType,e.__funcsCntByType[l.returnType]||(e.__funcsCntByType[l.returnType]=0),e.__funcsCntByType[l.returnType]++),co(l,e,u,!1),l.args){for(var s in l.args)co(l.args[s],e,[].concat((0,Fe.A)(u),[s]),!0);var c=Object.keys(l.args),d=!0,f=Ii(c.reverse()),p;try{for(f.s();!(p=f.n()).done;){var g=p.value,v=l.args[g];!d&&v.isOptional&&(Cn.info("Arg ".concat(g," for func ").concat(i," can't be optional")),delete v.isOptional),v.isOptional||(d=!1)}}catch(m){f.e(m)}finally{f.f()}}l.subfields&&qs(l.subfields,e,[].concat((0,Fe.A)(r),[o]))}}}function Ug(n,e,t){for(var r,a,o=["listValues","treeValues","allowCustomValues","validateValue"],u=0,i=o;u<i.length;u++){var l=i[u];n[l]&&(n.fieldSettings||(n.fieldSettings={}),n.fieldSettings[l]=n[l],delete n[l])}(r=n.fieldSettings)!==null&&r!==void 0&&r.listValues&&e.settings.normalizeListValues&&(n.fieldSettings.listValues=e.settings.normalizeListValues.call(e.ctx,n.fieldSettings.listValues,t,n.fieldSettings)),(a=n.fieldSettings)!==null&&a!==void 0&&a.treeValues&&e.settings.normalizeListValues&&(n.fieldSettings.treeValues=e.settings.normalizeListValues.call(e.ctx,n.fieldSettings.treeValues,t,n.fieldSettings))}function co(n,e){var t,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,u=e.settings,i=u.showLabels,l=u.fieldSeparator;l=(t=l)!==null&&t!==void 0?t:".";var s=r[r.length-1],c=a?r.slice(0,r.length-1).join(l):r.join(l),d=!!n.returnType,f=n.type||n.returnType,p=e.types[f],g=n.excludeOperators||[],v=(n.operators||p?.operators||[]).filter(function(V){return!g.includes(V)}),m=n.defaultOperator||p?.defaultOperator;g.includes(m)&&(m=void 0);var h=!!m&&m==n.defaultOperator;if(h&&(n.ownDefaultOperator=n.defaultOperator),!p){n.disabled=!0;return}!a&&!d&&!o&&(e.__fieldsCntByType[f]||(e.__fieldsCntByType[f]=0),e.__fieldsCntByType[f]++),a&&(n._isFuncArg=!0,n._argKey=s,n._funcKey=c),d&&(n._isFunc=!0,n._funcKey=c),o&&(n._isCaseValue=!0),Ug(n,e,f);var O=["widgets","operators","defaultOperator"];Object.keys(p).filter(function(V){return!O.includes(V)}).map(function(V){n[V]||(n[V]=yu(p[V]))});var b=p.excludeOperators||[];n.operators&&(b=b.filter(function(V){return!n.operators.includes(V)})),n.widgets||(n.widgets={});var S=function(){var P=_t({},n.widgets[C]||{}),M=p.widgets[C]||{};if(!a){var B=P.defaultOperator,_=[].concat((0,Fe.A)(g),(0,Fe.A)(b)),q=n.preferWidgets&&(C==="field"||n.preferWidgets.includes(C))||_.length>0;if(P.operators){var K=P.operators.filter(function(Ce){return!_.includes(Ce)});P.operators=K,v=Ya(v,K)}else if(q&&M.operators){var J=M.operators.filter(function(Ce){return!_.includes(Ce)});P.operators=J,v=Ya(v,J)}B&&!_.includes(B)&&(!m||!h&&C===n.mainWidget)&&(m=B)}C===n.mainWidget?P.widgetProps=_t(_t(_t({},M.widgetProps||{}),n.mainWidgetProps||{}),P.widgetProps||{}):P.widgetProps=_t(_t({},M.widgetProps||{}),P.widgetProps||{});var U=Array.from(new Set([].concat((0,Fe.A)(Object.keys(M.opProps||{})),(0,Fe.A)(Object.keys(P.opProps||{})))));if(U.length){var te={},Q=Ii(U),ae;try{for(Q.s();!(ae=Q.n()).done;){var ce,ie,le=ae.value;te[le]=_t(_t({},((ce=M.opProps)===null||ce===void 0?void 0:ce[le])||{}),((ie=P.opProps)===null||ie===void 0?void 0:ie[le])||{})}}catch(Ce){Q.e(Ce)}finally{Q.f()}P.opProps=te}var pe=P,se=pe.valueLabel,me=pe.valuePlaceholder;a&&(se||(P.valueLabel=n.label||s),!me&&!i&&(P.valuePlaceholder=n.label||s)),P=_t(_t({},M),P),n.widgets[C]=P};for(var C in p.widgets)S();if(a||(n.operators||(n.operators=Array.from(new Set(v))),n.defaultOperator||(n.defaultOperator=m)),!a&&!d&&!o){var L=Bg(e,r),w=L.fieldName,N=L.inGroup;w&&(n.fieldName=w,e.__fieldNames[w]||(e.__fieldNames[w]=[]),e.__fieldNames[w].push({fullPath:r,inGroup:N}))}}function Bg(n,e){if(!e)return{};var t=n.settings.fieldSeparator,r=(0,Fe.A)(e).reduce(function(i,l,s,c){var d=i.computedPath,f=i.computed,p=i.inGroup,g=[].concat((0,Fe.A)(c.slice(0,s)),[l]),v=qt(n,g);return v?.type==="!group"&&s<c.length-1?(p=g.join(t),d=[]):v!=null&&v.fieldName?(f=!0,d=[v.fieldName]):d=[].concat((0,Fe.A)(d),[l]),{computedPath:d,computed:f,inGroup:p}},{computedPath:[],computed:!1,inGroup:void 0}),a=r.computedPath,o=r.computed,u=r.inGroup;return o?{fieldName:a.join(t),inGroup:u}:{}}function Qs(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function kn(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Qs(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Qs(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var $g=pn().mark(ta),Wg=pn().mark(Ys),Kg=In;function ta(n){return pn().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.delegateYield(Vi(n,n.funcs||{},[]),"t0",1);case 1:case"end":return t.stop()}},$g)}function Ys(n){return pn().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.delegateYield(Vi(n,n.fields||{},[]),"t0",1);case 1:case"end":return t.stop()}},Wg)}function Vi(n,e,t){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"subfields";return pn().mark(function a(o){var u,i,l;return pn().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:u=(n==null||(o=n.settings)===null||o===void 0?void 0:o.fieldSeparator)||".",c.t0=pn().keys(e);case 2:if((c.t1=c.t0()).done){c.next=13;break}if(i=c.t1.value,l=e[i],!l[r]){c.next=9;break}return c.delegateYield(Vi(n,l[r],[].concat((0,Fe.A)(t),[i]),r),"t2",7);case 7:c.next=11;break;case 9:return c.next=11,[[].concat((0,Fe.A)(t),[i]).join(u),l];case 11:c.next=2;break;case 13:case"end":return c.stop()}},a)})()}var qt=function(e,t){var r,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"fields",o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"subfields";if(!t)return null;if(t==="!case_value"){var u;return e==null||(u=e.settings)===null||u===void 0?void 0:u.caseValueField}var i=(e==null||(r=e.settings)===null||r===void 0?void 0:r.fieldSeparator)||".",l=Nr(t,e),s=e[a];if(!s)return null;for(var c=s,d=null,f=[],p=0;p<l.length;p++){var g=l[p];f.push(g);var v=f.join(i);d=c[v],p<l.length-1&&(d&&d[o]?(c=d[o],f=[]):d=null)}return d},fo=function(e,t){var r,a,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,u=e.settings.fieldSeparator,i=[o].concat((0,Fe.A)(t.split(u))).filter(function(c){return c!=null}),l=t,s=(r=e.__fieldNames[l])===null||r===void 0||(a=r.find)===null||a===void 0||(a=a.call(r,function(c){var d=c.inGroup;return d?o?.startsWith(d):!0}))===null||a===void 0?void 0:a.fullPath;return(s||i).join(u)},Di=function(e,t){if(!t)return null;var r=qt(e,t,"funcs","subfields");if(!r)return null;var a=r.returnType,o=r.args,u=Object.fromEntries(Object.entries(o||{}).map(function(l){var s=(0,Le.A)(l,2),c=s[0],d=s[1],f=Xt()(d,["type","valueSources","defaultValue","fieldSettings","isOptional","_funcKey","_argKey","_isFuncArg"]);return[c,f]})),i={returnType:a,args:u};return i},Wr=function(e,t){if(!t)return null;var r=qt(e,t,"funcs","subfields");return r||null},Ni=function(e,t,r){var a=Wr(e,t);if(!a)return null;var o=a.args&&a.args[r]||null;return o||null},Xs=function(e,t){var r,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(!t)return!1;var o=(a==null||(r=a.settings)===null||r===void 0?void 0:r.fieldSeparator)||".",u=an(e,a),i=an(t,a);return u.startsWith(i+o)},an=function(e){var t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(typeof e=="string")return e;var a=(r==null||(t=r.settings)===null||t===void 0?void 0:t.fieldSeparator)||".";return Nr(e,r).join(a)},Nr=function(e){var t,r,a,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!e)return[];if(Array.isArray(e))return e;var u=(o==null||(t=o.settings)===null||t===void 0?void 0:t.fieldSeparator)||".";if(e!=null&&e.func)return Array.isArray(e.func)?e.func:e.func.split(u);if(e!=null&&(r=e.get)!==null&&r!==void 0&&r.call(e,"func")){var i;return e==null||(i=e.get)===null||i===void 0?void 0:i.call(e,"func").split(u)}return(e==null||(a=e.split)===null||a===void 0?void 0:a.call(e,u))||[]},zg=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!e)return null;var a=t.settings.fieldSeparator,o=Nr(e,t);return r?o:o.map(function(u,i,l){return l.slice(0,i+1)}).map(function(u){return u.join(a)})},po=function(e){var t;if(typeof e=="string"||Array.isArray(e))return"field:".concat(an(e));if((0,Cr.A)(e)==="object"&&e){if(e._funcKey&&e._argKey)return"arg:".concat(an(e._funcKey),"__").concat(e._argKey);if(e._funcKey)return"func:".concat(an(e._funcKey));if(e.func&&e.arg)return"arg:".concat(an(e.func),"__").concat(e.arg);if(e.func)return"func:".concat(an(e.func));if(e.type)return null}return e!=null&&(t=e.get)!==null&&t!==void 0&&t.call(e,"func")?e!=null&&e.get("arg")?"arg:".concat(an(e.get("func")),"__").concat(e.get("arg")):"func:".concat(an(e.get("func"))):null},vo=function(e,t,r){var a;return(a=e.__cache)===null||a===void 0||(a=a[t])===null||a===void 0?void 0:a[r]},go=function(e,t,r,a){!e.__cache||!r||(e.__cache[t]||(e.__cache[t]={}),e.__cache[t][r]=a)},Zs=function(e){var t;if(!e)return null;if((0,Cr.A)(e)==="object"){if(!e.func&&e.type)return"field";if(e.func)return e.func&&e.arg?null:"func"}return e!=null&&(t=e.get)!==null&&t!==void 0&&t.call(e,"func")?e!=null&&e.get("arg")?null:"func":"field"},Re=function(e,t){var r;if(!t)return null;if((0,Cr.A)(t)=="object"){if(!t.func&&t.type)return t;if(t.func)return t.func&&t.arg?Ni(e,t.func,t.arg):Wr(e,t.func)}if(t!=null&&(r=t.get)!==null&&r!==void 0&&r.call(t,"func"))return t!=null&&t.get("arg")?Ni(e,t.get("func"),t.get("arg")):Wr(e,t.get("func"));var a=qt(e,t);return a||null},lr=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(!t)return null;var a=e.operators[t];if(r){var o,u,i=po(r),l=i?"".concat(i,"__").concat(t):null,s=vo(e,"getOperatorConfig",l);if(s)return s;var c=Re(e,r),d=wr(e,r,t,null),f=e.widgets[d]||{},p=(c&&c.widgets?c.widgets[d]:{})||{},g=((o=f.opProps)===null||o===void 0?void 0:o[t])||{},v=((u=p.opProps)===null||u===void 0?void 0:u[t])||{},m=kn(kn(kn({},a),g),v);return go(e,"getOperatorConfig",l,m),m}else return a},dt=function(e,t){var r,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,u=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,i=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{};if(!t)return null;var l=Re(e,t),s=po(t);o||(o=wr(e,t,a,u));var c=s?"".concat(s,"__").concat(a,"__").concat(o,"__").concat(u):null,d=vo(e,"getFieldWidgetConfig",c);if(d)return d;var f=e.widgets[o]||{},p=(l==null||(r=l.widgets)===null||r===void 0?void 0:r[o])||{},g=p.widgetProps||{},v=u==="value"||!u?l?.fieldSettings:{},m=kn(kn(kn(kn({},f),p),g),v);return go(e,"getFieldWidgetConfig",c,m),i.forExport&&(m=Pt(m,"factory")),m},ec=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=e.settings.fieldSeparator,a=Nr(t,e),o=t?qt(e,t):e,u=o,i=null,l=[];do{var s,c=u===e?e.fields:(s=u)===null||s===void 0?void 0:s.subfields;if(!c||!Object.keys(c).length){u=i=null;break}i=Object.keys(c)[0],l.push(i),u=c[i]}while(u.type=="!struct"||u.type=="!group");return(a||[]).concat(l).join(r)};function rc(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function tc(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?rc(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):rc(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var Hg=function(e,t){var r={usedFields:[]},a=nc(e,t,r);if(a)return tc(tc({},a),r)},nc=function(e,t,r){if(e){var a=e.get("type"),o=e.get("children1");if((a==="group"||a==="rule_group")&&o&&o.size)return Jg(e,t,r);if(a==="rule")return qg(e,t,r)}},Jg=function(e,t,r){var a=e.get("properties")||new ye.Map,o=e.get("children1"),u=e.get("id"),i=o.map(function(d){return nc(d,t,r)}).filter(function(d){return typeof d<"u"});if(i.size){var l=a.get("conjunction");l||(l=tn(t));var s=a.get("not"),c={id:u,rules:i.toList(),condition:l.toUpperCase(),not:s};return c}},qg=function(e,t,r){var a,o=e.get("properties")||new ye.Map,u=e.get("id"),i=o.get("operator"),l=o.get("operatorOptions"),s=o.get("field"),c=o.get("value"),d=o.get("valueSrc"),f=o.get("valueType"),p=c.filter(function(P){return P===void 0}).size>0;if(!(s==null||i==null||p)){var g=Re(t,s)||{},v=lr(t,i,s)||{},m=g.type||"undefined",h=Br(v),O=t.types[g.type]||{},b=mn(s,t,r);if(!(c.size<h)){r.usedFields.indexOf(s)==-1&&r.usedFields.push(s),c=c.toArray(),d=d.toArray(),f=((a=f)===null||a===void 0?void 0:a.toArray())||[];for(var S=[],C=0;C<c.length;C++){var L={type:f[C],value:c[C]};if(S.push(L),d[C]=="field"){var w=c[C];r.usedFields.indexOf(w)==-1&&r.usedFields.push(w)}}var N=l?l.toJS():null;N&&!Object.keys(N).length&&(N=null);var V={id:u,fieldName:b,type:m,input:O.mainWidget,operator:i};return N&&(V.operatorOptions=N),V.values=S,V}}};function ac(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function oc(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ac(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):ac(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function ic(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=Qg(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,u=!1,i;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return o=s.done,s},e:function(s){u=!0,i=s},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(u)throw i}}}}function Qg(n,e){if(n){if(typeof n=="string")return uc(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return uc(n,e)}}function uc(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}var Yg=function(e,t){var r={usedFields:[],errors:[]},a=xt(t,void 0,!1),o=lc(e,a,r,!1,!0),u=r.errors,i=r.usedFields,l=a.settings.fieldSeparator,s={},c=ic(i),d;try{for(c.s();!(d=c.n()).done;)for(var f=d.value,p=Nr(f,t),g=Re(a,f)||{},v=s,m=0;m<p.length;m++){var h=p[m],O=Re(a,p.slice(0,m+1))||{};m!=p.length-1?O.type=="!group"&&O.mode!="struct"?(v[h]||(v[h]=[{}]),v=v[h][0]):(v[h]||(v[h]={}),v=v[h]):v[h]||(v[h]=null)}}catch(b){c.e(b)}finally{c.f()}return{errors:u,logic:o,data:s}},lc=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null;if(e){var i=e.get("type"),l=e.get("properties")||new ye.Map,s=l.get("isLocked"),c=t.settings.jsonLogic.lockedOp,d;return i==="group"||i==="rule_group"?d=sc(e,t,r,a,o,u):i==="rule"?d=Xg(e,t,r,a,u):i=="switch_group"?d=Zg(e,t,r,a):i=="case_group"&&(d=cc(e,t,r,a,u)),s&&d&&c&&(d=(0,ne.A)({},c,d)),d}},sc=function(e,t,r){var a,o,u,i,l,s,c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,d=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,f=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,p=e.get("type"),g=e.get("properties")||new ye.Map,v=g.get("mode"),m=e.get("children1")||new ye.List,h=g.get("field"),O=Re(t,h),b=g.get("conjunction");b||(b=tn(t));var S=t.conjunctions[b],C=S.jsonLogicConj||b.toLowerCase(),L=!!g.get("not"),w=p==="rule_group"&&!d,N=w&&v!="struct",V=N?h:f,P=g.get("operator"),M=P&&lr(t,P,h)||null,B=ki(t,g,r,P,f),_=w&&(!P||((a=M)===null||a===void 0?void 0:a.cardinality)==0),q=w&&m?.size>0,K=w&&!(m!=null&&m.size),J=L,U=!1;q?(U=L,J=c):c&&(J=!J);var te=!1,Q=(o=M)===null||o===void 0?void 0:o.reversedOp,ae=lr(t,Q,h),ce=!((u=M)!==null&&u!==void 0&&u.jsonLogic)&&!!((i=ae)!==null&&i!==void 0&&i.jsonLogic),ie=!!((l=ae)!==null&&l!==void 0&&l.jsonLogic),le=(s=ji(e))===null||s===void 0?void 0:s.get("type"),pe=!!t.settings.reverseOperatorsForNot&&(!w&&J&&le==="rule"||U&&m?.size===1);pe&&(q?U=!U:J=!J,te=!0);var se=J&&w&&ie&&(!!t.settings.reverseOperatorsForNot||ce);if(se){J=!J;var me=[Q,P];P=me[0],Q=me[1];var Ce=[ae,M];M=Ce[0],ae=Ce[1]}var ge=m.map(function(Ne){return lc(Ne,t,r,te,!1,V)}).filter(function(Ne){return typeof Ne<"u"}),Ae=!!t.settings.exportPreserveGroups;if(N&&!_){if(B==null)return}else if(!ge.size&&!Ae)return;var Pe={};if(ge.size==1&&!d&&!Ae?Pe=ge.first():Pe[C]=ge.toList().toJS(),U&&(Pe={"!":Pe}),N){var Ve=Mi(r,t,h,f);if(_){var Ie=P||"some";Pe=(0,ne.A)({},Ie,[Ve,Pe])}else{var De=ge.size?{filter:[Ve,Pe]}:Ve,Ee={reduce:[De,{"+":[1,{var:"accumulator"}]},0]};Pe=fc(t,g,Ee,B,P,null,O)}}return J&&(Pe={"!":Pe}),Pe},Xg=function(e,t,r){var a,o,u,i,l,s,c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,d=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,f=e.get("properties")||new ye.Map,p=f.get("field"),g=f.get("fieldSrc"),v=f.get("operator"),m=f.get("operatorOptions");if(m=m?m.toJS():null,m&&!Object.keys(m).length&&(m=null),!(p==null||v==null)){var h=Re(t,p),O=lr(t,v,p),b=(a=O)===null||a===void 0?void 0:a.reversedOp,S=lr(t,b,p);if(!((o=O)!==null&&o!==void 0&&o.jsonLogic)&&!((u=S)!==null&&u!==void 0&&u.jsonLogic)){r.errors.push("Operator ".concat(v," is not supported"));return}var C=c,L=!((i=O)!==null&&i!==void 0&&i.jsonLogic)&&!!((l=S)!==null&&l!==void 0&&l.jsonLogic),w=!!((s=S)!==null&&s!==void 0&&s.jsonLogic),N=w&&(!!t.settings.reverseOperatorsForNot||L),V=C&&N||L;if(V){C=!C;var P=[b,v];v=P[0],b=P[1];var M=[S,O];O=M[0],S=M[1]}var B=ki(t,f,r,v,d);if(B!==void 0){var _=g==="func"?dc(r,t,p,d):Mi(r,t,p,d);if(_!==void 0)return fc(t,f,_,B,v,m,h,C)}}},Zg=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=e.get("children1");if(o){for(var u=o.map(function(L){return cc(L,t,r,a,null)}).filter(function(L){return typeof L<"u"}).valueSeq().toArray(),i=[],l=0;l<u.length;l++)l!==u.length-1&&!u[l][0]?r.errors.push("No condition for case ".concat(l)):(i.push(u[l]),l===u.length-1&&u[l][0]&&i.push([void 0,null]));if(i.length){if(i.length===1){var s=(0,Le.A)(i[0],2),c=s[0],d=s[1];return d==null&&(d=null),d}for(var f={if:[]},p=f.if,g=(0,Le.A)(i[i.length-1],2),v=g[0],m=g[1],h=0;h<i.length-1;h++){var O=h===i.length-2,b=(0,Le.A)(i[h],2),S=b[0],C=b[1];C==null&&(C=null),S==null&&(S=!0),p.push(S),p.push(C),O?p.push(m):(p.push({if:[]}),p=p[p.length-1].if)}return f}}},cc=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,u=e.get("type");if(u!="case_group"){r.errors.push("Unexpected child of type ".concat(u," inside switch"));return}var i=e.get("properties")||new ye.Map,l=sc(e,t,r,a,o),s=ki(t,i,r,null,o,"!case_value");return[l,s]},ki=function(e,t,r,a,o){var u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,i=t.get("field"),l=t.get("valueSrc"),s=t.get("valueType");(u=="!case_value"||s&&s.get(0)=="case_value")&&(i="!case_value");var c=Re(e,i),d=lr(e,a,i),f=Br(d),p=t.get("value"),g=t.get("asyncListValues");if(p!=null){var v=[],m=[],h=r.usedFields,O=p.map(function(S,C){var L=l?l.get(C):null,w=s?s.get(C):null,N=Nn(S,L,e),V=wr(e,i,a,L),P=dt(e,i,a,V,L,{forExport:!0}),M=_i(r,e,N,L,w,P,c,a,d,o,g);return M!==void 0&&(v.push(L),m.push(w)),M}),b=O.filter(function(S){return S===void 0}).size>0;if(O.size<f||b){r.usedFields=h;return}return f>1?O.toArray():f==1?O.first():null}},_i=function(e,t,r,a,o,u,i,l,s){var c=arguments.length>9&&arguments[9]!==void 0?arguments[9]:null,d=arguments.length>10?arguments[10]:void 0;if(r!==void 0){var f;if(a=="field")f=Mi(e,t,r,c);else if(a=="func")f=dc(e,t,r,c);else if(typeof u?.jsonLogic=="function"){var p=u.jsonLogic,g=[r,oc(oc({},i?Xt()(i,["fieldSettings","listValues"]):{}),{},{asyncListValues:d}),Pt(u,In)];l&&(g.push(l),g.push(s)),f=p.call.apply(p,[t.ctx].concat(g))}else f=r;return f}},dc=function(e,t,r){var a,o,u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,i=(a=r.get)===null||a===void 0?void 0:a.call(r,"func"),l=(o=r.get)===null||o===void 0?void 0:o.call(r,"args"),s=Wr(t,i),c=Nr(i,t),d=c[c.length-1];if(!s){e.errors.push("Func ".concat(i," is not defined in config"));return}if(!(s!=null&&s.jsonLogic)){e.errors.push("Func ".concat(i," is not supported"));return}var f={},p=[],g=[];for(var v in s.args){var m,h=s.args[v],O=Re(t,h),b=h.defaultValue,S=h.isOptional,C=b!=null&&b.func?"func":"value",L=l?l.get(v):void 0,w=L?L.get("value"):void 0,N=L?L.get("valueSrc"):void 0;N!=="func"&&(m=w)!==null&&m!==void 0&&m.toJS&&(w=w.toJS());var V=null,P=wr(t,h,V,N),M=dt(t,h,V,P,N,{forExport:!0}),B=_i(e,t,w,N,h.type,M,O,null,null,u);if(w!=null&&B===void 0){N!="func"&&e.errors.push("Can't format value of arg ".concat(v," for func ").concat(i));return}var _=void 0;if(B===void 0&&!S&&b!=null){var q=wr(t,h,V,C),K=dt(t,h,V,q,C,{forExport:!0});if(_=_i(e,t,b,C,h.type,K,O,null,null,u),_===void 0){C!="func"&&e.errors.push("Can't format default value of arg ".concat(v," for func ").concat(i));return}}var J=B??_;if(J!==void 0){if(p.length){var U=ic(p),te;try{for(U.s();!(te=U.n()).done;){var Q=te.value;f[Q]=void 0}}catch(ge){U.e(ge)}finally{U.f()}p=[]}f[v]=J}else S||g.push(v),p.push(v)}if(!g.length){var ae=Object.values(f),ce;if(typeof s.jsonLogic=="function"){var ie=s.jsonLogic,le=[f];ce=ie.call.apply(ie,[t.ctx].concat(le))}else{var pe=s.jsonLogic||d,se=!!s.jsonLogicIsMethod;if(se){var me=ae[0],Ce=ae.slice(1);Ce.length?ce={method:[me,pe,Ce]}:ce={method:[me,pe]}}else ce=(0,ne.A)({},pe,ae)}return ce}},Mi=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=t.settings,u=o.fieldSeparator,i=o.jsonLogic,l;if(r){Array.isArray(r)&&(r=r.join(u));var s=Re(t,r)||{},c=mn(r,t,e,a),d=s.jsonLogicVar||(s.type=="!group"?i.groupVarKey:"var");l=(0,ne.A)({},d,c),e.usedFields.indexOf(r)==-1&&e.usedFields.push(r)}return l},em=function(e,t,r,a){var o,u=e,i=Br(t),l=(o=t._jsonLogicIsRevArgs)!==null&&o!==void 0?o:!1;typeof t.jsonLogic=="string"&&(u=t.jsonLogic);var s=["<","<=",">",">="],c=["==","!="],d=function(p,g,v,m,h){return i==0&&c.includes(u)?(0,ne.A)({},u,[r,null]):i==0?(0,ne.A)({},u,r):i==1&&l?(0,ne.A)({},u,[a,r]):i==1?(0,ne.A)({},u,[r,a]):i==2&&s.includes(u)?(0,ne.A)({},u,[a[0],r,a[1]]):(0,ne.A)({},u,[r].concat((0,Fe.A)(a)))};return d},fc=function(e,t,r,a,o){var u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,i=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null,l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:!1,s=t.get("field"),c=lr(e,o,s)||{},d=typeof c.jsonLogic=="function"?c.jsonLogic:em(o,c,r,a),f=[r,o,a,Pt(c,Kn),u,i],p=d.call.apply(d,[e.ctx].concat(f));return l&&(p={"!":p}),p};function rm(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=tm(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,u=!1,i;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return o=s.done,s},e:function(s){u=!0,i=s},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(u)throw i}}}}function tm(n,e){if(n){if(typeof n=="string")return pc(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return pc(n,e)}}function pc(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function vc(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function gc(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?vc(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):vc(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var mc=function(e){return(0,Cr.A)(e)=="object"&&e!==null&&!Array.isArray(e)},nm=function(e,t){return hc(e,t,!1)},hc=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a={errors:[]},o=xt(t,void 0,!1),u=Gi([],e,o,a);return r?[u,a.errors]:(a.errors.length&&console.warn("Errors while exporting to MongoDb:",a.errors),u)},Gi=function(e,t,r,a){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,i=arguments.length>6&&arguments[6]!==void 0?arguments[6]:void 0,l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:void 0;if(t){var s=t.get("type");if(s==="group"||s==="rule_group")return am(e,t,r,a,o,u,i,l);if(s==="rule")return om(e,t,r,a,o,u,i,l)}},am=function(e,t,r,a){var o,u,i,l,s,c,d,f,p=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,g=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,v=arguments.length>6&&arguments[6]!==void 0?arguments[6]:void 0,m=arguments.length>7&&arguments[7]!==void 0?arguments[7]:void 0,h=t.get("type"),O=t.get("properties")||new ye.Map,b=!!O.get("not"),S=t.get("children1")||new ye.List,C=r.settings,L=C.canShortMongoQuery,w=C.fieldSeparator,N=w,V=e.filter(function(ir){return ir.get("type")=="rule_group"}).length>0,P=e.filter(function(ir){return ir.get("type")=="rule_group"}).map(function(ir){return ir.get("properties").get("field")}).slice(-1).pop(),M=V&&P,B=h==="rule_group",_=B?O.get("field"):null,q=B?O.get("operator"):null,K=q&&lr(r,q,_)||null,J=q?(o=(u=K)===null||u===void 0?void 0:u.cardinality)!==null&&o!==void 0?o:1:void 0,U=mn(_,r,a,M),te=Re(r,_)||{},Q=te.mode,ae=_&&Q==="array"&&J>=1,ce=B&&Q!="struct",ie=B&&S?.size>0,le=B&&!(S!=null&&S.size),pe=!1,se=b,me=!1;ie?(me=b,se=p):p&&(se=!se);var Ce=(i=K)===null||i===void 0?void 0:i.reversedOp,ge=lr(r,Ce,_),Ae=!((l=K)!==null&&l!==void 0&&l.mongoFormatOp)&&!!((s=ge)!==null&&s!==void 0&&s.mongoFormatOp),Pe=!!((c=ge)!==null&&c!==void 0&&c.mongoFormatOp),Ve=(d=ji(t))===null||d===void 0?void 0:d.get("type"),Ie=!!r.settings.reverseOperatorsForNot&&(!B&&se&&Ve==="rule"||me&&S?.size===1);Ie&&(ie?me=!me:se=!se,pe=!0);var De=se&&B&&Pe&&(!!r.settings.reverseOperatorsForNot||Ae);if(De){se=!se;var Ee=[Ce,q];q=Ee[0],Ce=Ee[1];var Ne=[ge,K];K=Ne[0],ge=Ne[1]}var Xe=O.get("conjunction");Xe||(Xe=tn(r));var ar=r.conjunctions[Xe];if(ar){var Ze=ar.reversedConj,Xr=se&&((f=Xe)===null||f===void 0?void 0:f.toLowerCase())==="or"&&Ze&&!B&&!!r.settings.canShortMongoQuery&&!!r.settings.reverseOperatorsForNot;Xr&&(Xe=Ze,ar=r.conjunctions[Xe],se=!se,pe=!0);var Tr=ar.mongoConj,Pr=S.map(function(ir){return Gi([].concat((0,Fe.A)(e),[t]),ir,r,a,pe,Q!="array",Q=="array"?function(Lt){return"$$el".concat(N).concat(Lt)}:void 0)}).filter(function(ir){return typeof ir<"u"});if(!(!ae&&!Pr.size)){var or;if(Pr.size==1)or=Pr.first();else if(Pr.size>1){var at=Pr.toList().toJS(),bt=L&&Tr=="$and";bt&&(or=at.reduce(function(ir,Lt){if(ir){for(var Vt in Lt){if(Vt[0]=="$"){ir=void 0;break}if(ir[Vt]==null)ir[Vt]=Lt[Vt];else{var Hr=ir[Vt],it=Lt[Vt];mc(Hr)||(Hr={$eq:Hr}),mc(it)||(it={$eq:it});var ur=Object.keys(Hr)[0],Zr=Object.keys(it)[0];if(ur==Zr){ir=void 0;break}ir[Vt]=Object.assign({},Hr,it)}}return ir}},{})),or||(or=(0,ne.A)({},Tr,at))}if(_)if(Q=="array"){var ot={$size:{$ifNull:["$"+U,[]]}},St=or?{$size:{$ifNull:[{$filter:{input:"$"+U,as:"el",cond:or}},[]]}}:ot;or=Gi(e,t.set("type","rule"),r,a,me,!1,function(ir){return St},ot),or={$expr:or}}else or=(0,ne.A)({},U,{$elemMatch:or});return se&&(or={$not:or}),or}}},om=function(e,t,r,a){var o,u,i,l,s,c,d,f=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,p=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,g=arguments.length>6&&arguments[6]!==void 0?arguments[6]:void 0,v=arguments.length>7&&arguments[7]!==void 0?arguments[7]:void 0,m=t.get("properties")||new ye.Map,h=e.filter(function(Ze){return Ze.get("type")=="rule_group"}).length>0,O=e.filter(function(Ze){return Ze.get("type")=="rule_group"}).map(function(Ze){return Ze.get("properties").get("field")}).slice(-1).pop(),b=h&&O,S=m.get("operator"),C=m.get("operatorOptions"),L=m.get("field"),w=m.get("fieldSrc"),N=m.get("value"),V=m.get("valueSrc"),P=m.get("valueType"),M=m.get("asyncListValues");if(!(L==null||S==null||N===void 0)){var B=Re(r,L),_=lr(r,S,L),q=(o=_)===null||o===void 0?void 0:o.reversedOp,K=lr(r,q,L),J=Br(_);if(!((u=_)!==null&&u!==void 0&&u.mongoFormatOp)&&!((i=K)!==null&&i!==void 0&&i.mongoFormatOp)){a.errors.push("Operator ".concat(S," is not supported"));return}var U=f,te=!((l=_)!==null&&l!==void 0&&l.mongoFormatOp)&&!!((s=K)!==null&&s!==void 0&&s.mongoFormatOp),Q=!!((c=K)!==null&&c!==void 0&&c.mongoFormatOp),ae=Q&&(!!r.settings.reverseOperatorsForNot||te),ce=ae&&U||te,ie=!1;if(ce){var le=[q,S];S=le[0],q=le[1];var pe=[K,_];_=pe[0],K=pe[1],U=!U,ie=!0}var se,me=!1;if(w=="func"){var Ce=yc(a,r,L,b),ge=(0,Le.A)(Ce,2);se=ge[0],me=ge[1]}else se=mn(L,r,a,b),g&&(me=!0,se=g(se));if(se!=null){var Ae=[],Pe=[],Ve;if(N!=null){var Ie=N.map(function(Ze,Xr){var Tr=V?V.get(Xr):null,Pr=P?P.get(Xr):null,or=Nn(Ze,Tr,r),at=wr(r,L,S,Tr),bt=dt(r,L,S,at,Tr,{forExport:!0}),ot=Ui(a,r,or,Tr,Pr,bt,B,b,S,_,M),St=(0,Le.A)(ot,2),ir=St[0],Lt=St[1];return ir!==void 0&&(me=me||Lt,Ae.push(Tr),Pe.push(Pr)),ir}),De=Ie.filter(function(Ze){return Ze===void 0}).size>0;if(Ie.size<J||De)return;Ve=J>1?Ie.toArray():J==1?Ie.first():null}var Ee=me&&p,Ne=(d=_)===null||d===void 0?void 0:d.mongoFormatOp,Xe=[se,S,v!==void 0&&Ve==null?v:Ve,me,Ae.length>1?Ae:Ae[0],Pe.length>1?Pe:Pe[0],Pt(_,Kn),C,B],ar=Ne.call.apply(Ne,[r.ctx].concat(Xe));return Ee&&(ar={$expr:ar}),U&&(ar={$not:ar}),ar}}},Ui=function(e,t,r,a,o,u,i,l,s,c,d){if(r===void 0)return[void 0,!1];var f,p=!1;if(a=="field"){var g=im(e,t,r,l),v=(0,Le.A)(g,2);f=v[0],p=v[1]}else if(a=="func"){var m=yc(e,t,r,l),h=(0,Le.A)(m,2);f=h[0],p=h[1]}else if(typeof u?.mongoFormatValue=="function"){var O=u.mongoFormatValue,b=[r,gc(gc({},i?Xt()(i,["fieldSettings","listValues"]):{}),{},{asyncListValues:d}),Pt(u,In)];s&&(b.push(s),b.push(c)),f=O.call.apply(O,[t.ctx].concat(b))}else f=r;return[f,p]},im=function(e,t,r,a){var o=t.settings.fieldSeparator,u,i=!0;if(r){var l=Re(t,r)||{},s=Nr(r,t),c=ja(r,t),d=c?c.join(o):null,f=t.settings.formatField,p=mn(r,t,e,a),g=f(p,s,d,l,t,!1);u="$"+g}return[u,i]},yc=function(e,t,r,a){var o,u,i=!0,l,s=(o=r.get)===null||o===void 0?void 0:o.call(r,"func"),c=(u=r.get)===null||u===void 0?void 0:u.call(r,"args"),d=Wr(t,s);if(!d)return e.errors.push("Func ".concat(s," is not defined in config")),[void 0,!1];var f=Nr(s,t),p=f[f.length-1],g=d.mongoFunc||p,v=d.mongoArgsAsObject,m={},h=0,O=void 0,b=[],S=[];for(var C in d.args){var L;h++;var w=d.args[C],N=Re(t,w),V=w.defaultValue,P=w.isOptional,M=V!=null&&V.func?"func":"value",B=c?c.get(C):void 0,_=B?B.get("value"):void 0,q=B?B.get("valueSrc"):void 0;q!=="func"&&(L=_)!==null&&L!==void 0&&L.toJS&&(_=_.toJS());var K=B?B.get("asyncListValues"):void 0,J=null,U=wr(t,w,J,q),te=dt(t,w,J,U,q,{forExport:!0}),Q=Ui(e,t,_,q,w.type,te,N,a,null,null,K),ae=(0,Le.A)(Q,2),ce=ae[0],ie=ae[1];if(_!=null&&ce===void 0)return q!="func"&&e.errors.push("Can't format value of arg ".concat(C," for func ").concat(s)),[void 0,!1];var le=void 0;if(ce===void 0&&!P&&V!=null){var pe=wr(t,w,J,M),se=dt(t,w,J,pe,M,{forExport:!0}),me=void 0,Ce=Ui(e,t,V,M,w.type,se,N,a,null,null,K),ge=(0,Le.A)(Ce,2);if(le=ge[0],me=ge[1],le===void 0)return M!="func"&&e.errors.push("Can't format default value of arg ".concat(C," for func ").concat(s)),[void 0,!1]}var Ae=ce??le;if(Ae!==void 0){if(b.length){var Pe=rm(b),Ve;try{for(Pe.s();!(Ve=Pe.n()).done;){var Ie=Ve.value;m[Ie]=void 0}}catch(Ne){Pe.e(Ne)}finally{Pe.f()}b=[]}m[C]=Ae,O=Ae}else P||S.push(C),b.push(C)}if(S.length)return[void 0,!1];if(typeof d.mongoFormatFunc=="function"){var De=d.mongoFormatFunc,Ee=[m];l=De.call.apply(De,[t.ctx].concat(Ee))}else{if(d.mongoFormatFunc===null)return e.errors.push("Functon ".concat(g," is not supported")),[void 0,!1];v?l=(0,ne.A)({},g,m):h==1&&O!==void 0?l=(0,ne.A)({},g,O):l=(0,ne.A)({},g,Object.values(m))}return[l,i]};function um(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=lm(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,u=!1,i;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return o=s.done,s},e:function(s){u=!0,i=s},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(u)throw i}}}}function lm(n,e){if(n){if(typeof n=="string")return Oc(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Oc(n,e)}}function Oc(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function bc(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Sc(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?bc(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):bc(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var sm=function(e,t){return Fc(e,t,!1)},Fc=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a={errors:[]},o=xt(t,void 0,!1),u=Cc(e,o,a);return r?[u,a.errors]:(a.errors.length&&console.warn("Errors while exporting to SQL:",a.errors),u)},Cc=function(e,t,r){if(e){var a=e.get("type"),o=e.get("children1");if(a==="group"||a==="rule_group")return cm(e,t,r);if(a==="rule")return fm(e,t,r)}},cm=function(e,t,r){var a=e.get("type"),o=e.get("properties")||new ye.Map,u=e.get("children1")||new ye.List,i=a==="rule_group",l=i?o.get("field"):null,s=Re(t,l)||{},c=s.mode;c=="array"&&r.errors.push("Aggregation is not supported for ".concat(l));var d=o.get("not"),f=!1,p=u.map(function(m){return Cc(m,t,r)}).filter(function(m){return typeof m<"u"});if(!(!f&&!p.size)){var g=o.get("conjunction");g||(g=tn(t));var v=t.conjunctions[g];return v.sqlFormatConj.call(t.ctx,p,g,d)}},dm=function(e,t){var r=t.sqlOp||e,a=Br(t),o;return a==0?o=function(i,l,s,c,d,f,p,g){return"".concat(i," ").concat(r)}:a==1?o=function(i,l,s,c,d,f,p,g){return"".concat(i," ").concat(r," ").concat(s)}:a==2&&(o=function(i,l,s,c,d,f,p,g){var v,m,h=s==null||(v=s.first)===null||v===void 0?void 0:v.call(s),O=s==null||(m=s.get)===null||m===void 0?void 0:m.call(s,1);return"".concat(i," ").concat(r," ").concat(h," AND ").concat(O)}),o},fm=function(e,t,r){var a=e.get("properties")||new ye.Map,o=a.get("field"),u=a.get("fieldSrc"),i=a.get("operator"),l=a.get("operatorOptions"),s=a.get("valueSrc"),c=a.get("valueType"),d=a.get("value"),f=a.get("asyncListValues");if(!(o==null||i==null)){var p=Re(t,o)||{},g=lr(t,i,o)||{},v=g.reversedOp,m=lr(t,v,o)||{},h=Br(g),O=!1,b=g.sqlOp||g.sqlFormatOp,S=m.sqlOp||m.sqlFormatOp;if(!b&&!S){r.errors.push("Operator ".concat(i," is not supported"));return}if(!b&&S){O=!0;var C=[v,i];i=C[0],v=C[1];var L=[m,g];g=L[0],m=L[1]}var w=[],N=[],V;if(d!=null){var P=d.map(function(J,U){var te=s?s.get(U):null,Q=c?c.get(U):null,ae=Nn(J,te,t),ce=wr(t,o,i,te),ie=dt(t,o,i,ce,te,{forExport:!0}),le=Bi(r,t,ae,te,Q,ie,p,i,g,f);return le!==void 0&&(w.push(te),N.push(Q)),le}),M=P.filter(function(J){return J===void 0}).size>0;if(M||P.size<h)return;V=h==1?P.first():P}var B=g.sqlFormatOp||dm(i,g);if(!B){r.errors.push("Operator ".concat(i," is not supported"));return}var _=u=="func"?Ec(r,t,o):Tc(r,t,o);if(_!=null){var q=[_,i,V,w.length>1?w:w[0],N.length>1?N:N[0],Pt(g,Kn),l,p],K;if(K=B.call.apply(B,[t.ctx].concat(q)),O&&(K=t.settings.sqlFormatReverse.call(t.ctx,K)),K===void 0){r.errors.push("Operator ".concat(i," is not supported for value source ").concat(w.join(", ")));return}return K}}},Bi=function(e,t,r,a,o,u,i,l,s,c){if(r!==void 0){var d;if(a=="field")d=Tc(e,t,r);else if(a=="func")d=Ec(e,t,r);else if(typeof u?.sqlFormatValue=="function"){var f=u.sqlFormatValue,p=[r,Sc(Sc({},Xt()(i,["fieldSettings","listValues"])),{},{asyncListValues:c}),Pt(u,In)];if(l&&(p.push(l),p.push(s)),a=="field"){var g=Re(t,r)||{};p.push(g)}d=f.call.apply(f,[t.ctx].concat(p))}else Array.isArray(r)?d=r.map(function(v){return Tn.escape(v)}):d=Tn.escape(r);return d}},Tc=function(e,t,r){if(r){var a=t.settings.fieldSeparator,o=Re(t,r)||{},u=Nr(r,t),i=ja(r,t),l=i?i.join(a):null,s=t.settings.formatField,c=mn(r,t,e,null,{useTableName:!0}),d=s(c,u,l,o,t);return d}},Ec=function(e,t,r){var a,o,u=(a=r.get)===null||a===void 0?void 0:a.call(r,"func"),i=(o=r.get)===null||o===void 0?void 0:o.call(r,"args"),l=Wr(t,u);if(!l){e.errors.push("Func ".concat(u," is not defined in config"));return}var s=Nr(u,t),c=s[s.length-1],d=l.sqlFunc||c,f={},p=[],g=[];for(var v in l.args){var m,h=l.args[v],O=Re(t,h),b=h.defaultValue,S=h.isOptional,C=b!=null&&b.func?"func":"value",L=i?i.get(v):void 0,w=L?L.get("value"):void 0,N=L?L.get("valueSrc"):void 0;N!=="func"&&(m=w)!==null&&m!==void 0&&m.toJS&&(w=w.toJS());var V=L?L.get("asyncListValues"):void 0,P=Bi(e,t,w,N,h.type,O,h,null,null,V);if(w!=null&&P===void 0){N!="func"&&e.errors.push("Can't format value of arg ".concat(v," for func ").concat(u));return}var M=void 0;if(P===void 0&&!S&&b!=null&&(M=Bi(e,t,b,C,h.type,O,h,null,null,V),M===void 0)){C!="func"&&e.errors.push("Can't format default value of arg ".concat(v," for func ").concat(u));return}var B=P??M;if(B!==void 0){if(p.length){var _=um(v),q;try{for(_.s();!(q=_.n()).done;){var K=q.value;f[K]=void 0}}catch(ae){_.e(ae)}finally{_.f()}p=[]}f[v]=B}else S||g.push(v),p.push(v)}if(!g.length){var J;if(typeof l.sqlFormatFunc=="function"){var U=l.sqlFormatFunc,te=[f];J=U.call.apply(U,[t.ctx].concat(te))}else{var Q=Object.entries(f).map(function(ae){var ce=(0,Le.A)(ae,2),ie=ce[0],le=ce[1];return le}).join(", ");J="".concat(d,"(").concat(Q,")")}return J}};function Ac(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Lc(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Ac(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Ac(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function pm(n){if(n==null)return null;var e=n.split(",").map(Number);return{top_left:{lat:e[0],lon:e[1]},bottom_right:{lat:e[2],lon:e[3]}}}function vm(n,e){if(n.length>1)return{gte:"".concat(n[0]),lte:"".concat(n[1])};var t=n[0];switch(e){case"on_date":case"not_on_date":case"equal":case"select_equals":case"not_equal":return{gte:"".concat(t,"||/d"),lte:"".concat(t,"||+1d")};case"less_or_equal":return{lte:"".concat(t)};case"greater_or_equal":return{gte:"".concat(t)};case"less":return{lt:"".concat(t)};case"greater":return{gt:"".concat(t)};default:return}}function gm(n){return{value:"*"+n+"*"}}function mm(n,e){switch(n){case"AND":return e?"must_not":"must";case"OR":return e?"should_not":"should";case"NOT":return e?"must":"must_not";default:return}}function hm(n){return{value:n}}function ym(n,e){return n}function Om(n,e,t,r,a,o){var u=ym(r,a);switch(n){case"filter":return{script:a.operators[t].elasticSearchScript(r,e)};case"exists":return{field:r};case"match":return(0,ne.A)({},u,e[0]);case"term":return o===Sm?(0,ne.A)({},r,{value:e[0]}):(0,ne.A)({},r,e[0]);case"geo_bounding_box":return(0,ne.A)({},r,pm(e[0]));case"range":return(0,ne.A)({},r,vm(e,t));case"wildcard":return(0,ne.A)({},r,gm(e[0]));case"regexp":return(0,ne.A)({},r,hm(e[0]));default:return}}function wc(n,e,t,r,a,o){if(!(!n||!t||e==null)){var u=t,i=r.operators[u];if(i){var l=i,s=l.elasticSearchQueryType,c=!1;if(!s&&i.reversedOp){c=!0,u=i.reversedOp,i=r.operators[u];var d=i;s=d.elasticSearchQueryType}var f=wr(r,n,u,a),p=r.widgets[f];if(p){var g=p.elasticSearchFormatValue,v;if(typeof s=="function"?v=s(f):v=s,!!v){var m;return typeof g=="function"?m=g(v,e,u,n,r):m=Om(v,e,u,n,r,o),c?{bool:{must_not:(0,ne.A)({},v,Lc({},m))}}:(0,ne.A)({},v,Lc({},m))}}}}}function bm(n,e,t,r,a,o){if(!(!n||!n.size)){var u=n.valueSeq().toArray(),i=mm(e,t),l=u.map(function(c){return r(c,a,o)}).filter(function(c){return c!==void 0});if(l.length){var s=l.flat(1/0);return{bool:(0,ne.A)({},i,s)}}}}var Sm="ES_7_SYNTAX",Fm="ES_6_SYNTAX";function jc(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Fm,r=xt(e,void 0,!1);if(n){var a=n.get("type"),o=n.get("properties")||new Map;if(a==="rule"&&o.get("field")){var u,i,l,s=o.get("operator"),c=o.get("field"),d=o.get("fieldSrc"),f=(u=o.get("value"))===null||u===void 0?void 0:u.toJS(),p=(i=o.get("valueType"))===null||i===void 0?void 0:i.get(0),g=(l=o.get("valueSrc"))===null||l===void 0?void 0:l.get(0);return g==="func"||d=="func"?void 0:f&&Array.isArray(f[0])?f[0].map(function(O){return wc(c,[O],s,r,g,t)}):wc(c,f,s,r,g,t)}if(a==="group"||a==="rule_group"){var v=o.get("not"),m=o.get("conjunction");m||(m=tn(r));var h=n.get("children1");return bm(h,m,v,jc,r,t)}}}var _n=y(80045);function Rc(n,e,t,r,a,o,u){try{var i=n[o](u),l=i.value}catch(s){return void t(s)}i.done?e(l):Promise.resolve(l).then(r,a)}function Cm(n){return function(){var e=this,t=arguments;return new Promise(function(r,a){var o=n.apply(e,t);function u(l){Rc(o,r,a,u,i,"next",l)}function i(l){Rc(o,r,a,u,i,"throw",l)}u(void 0)})}}var Tm=["title","value","disabled","groupTitle","grouplabel","renderTitle","children","label","isCustom","isHidden"];function Em(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=Am(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,u=!1,i;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return o=s.done,s},e:function(s){u=!0,i=s},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(u)throw i}}}}function Am(n,e){if(n){if(typeof n=="string")return Pc(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Pc(n,e)}}function Pc(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function xc(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Ln(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?xc(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):xc(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var Lm=function(e,t){if(e.findLastIndex)return e.findLastIndex(t);var r=(0,Fe.A)(e).reverse().findIndex(t);return r==-1?-1:e.length-1-r},wm=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1e3;return function(){var a=Cm(pn().mark(function o(u,i,l){var s,c,d,f,p,g,v,m;return pn().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(s=l?.pageSize!=null?l.pageSize:t,c=wu(e).filter(function(b){var S=b.title,C=b.value;return u==null?!0:S.toUpperCase().indexOf(u.toUpperCase())!=-1||"".concat(C).toUpperCase().indexOf(u.toUpperCase())!=-1}),d=s?Math.ceil(c.length/s):0,f=i||0,p=s?Math.ceil(f/s):null,g=s?c.slice(f,f+s):c,v=s?f+g.length:null,m=s?v<c.length:!1,!r){O.next=11;break}return O.next=11,Su(r);case 11:return O.abrupt("return",{values:g,hasMore:m});case 12:case"end":return O.stop()}},o)}));return function(o,u,i){return a.apply(this,arguments)}}()},jm=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!t)return e;var o=e||[],u=t.filter(function(l){return o.find(function(s){return""+s.value==""+l.value})==null}).map(function(l){return a?Ln(Ln({},l),{},{isHidden:!0}):l}),i=r?[].concat((0,Fe.A)(u),(0,Fe.A)(o)):[].concat((0,Fe.A)(o),(0,Fe.A)(u));return i},Rm=function(e,t,r){var a,o=e==null||e==""?void 0:(a=e?.value)!==null&&a!==void 0?a:e,u=ro(o,t),i=r&&!u?qo(o):void 0,l=u||i,s=l?[l]:void 0;return[o,s]},Pm=function(e,t,r){var a=e.map(function(u,i){var l,s=u==null||u==""?void 0:(l=u?.value)!==null&&l!==void 0?l:u,c=ro(s,t),d=r&&!c?qo(s):void 0,f=c||d;return f}).filter(function(u){return u!=null}),o=a.map(function(u){var i;return(i=u?.value)!==null&&i!==void 0?i:u});return o.length||(o=void 0),[o,a]},xm=function(e){if(e==null)return null;var t=e.title,r=e.value,a=e.disabled,o=e.groupTitle,u=e.grouplabel,i=e.renderTitle,l=e.children,s=e.label,c=e.isCustom,d=e.isHidden,f=(0,_n.A)(e,Tm),p={value:r,title:t||s||l};return a&&(p.disabled=a),c&&(p.isCustom=c),d&&(p.isHidden=d),(o||u)&&(p.groupTitle=o||u),i&&(p.renderTitle=i),p=Ln(Ln({},p),f),p},Im=function(e){var t=[],r=[],a=Em(e),o;try{var u=function(){var l=o.value,s=Lm(t,function(c){var d,f;return((d=c.groupTitle)!==null&&d!==void 0?d:"")==((f=l.groupTitle)!==null&&f!==void 0?f:"")});l.groupTitle!=null&&!r.includes(l.groupTitle)&&(r.push(l.groupTitle),r.length===1&&(t=t.map(function(c){return Ln(Ln({},c),{},{groupTitle:""})}))),l.groupTitle==null&&r.length&&(l=Ln(Ln({},l),{},{groupTitle:""})),s!=-1?t.splice(s+1,0,l):t.push(l)};for(a.s();!(o=a.n()).done;)u()}catch(i){a.e(i)}finally{a.f()}return t},Vm={label:"Now",returnType:"datetime",jsonLogic:"now",jsonLogicCustomOps:{now:{}},spelFunc:"T(java.time.LocalDateTime).now()",sqlFormatFunc:function(){return"NOW()"},mongoFormatFunc:function(){return new Date},formatFunc:function(){return"NOW"}},Dm={label:"Relative",returnType:"datetime",renderBrackets:["",""],renderSeps:["","",""],spelFormatFunc:function(e){var t=e.date,r=e.op,a=e.val,o=e.dim,u=o.charAt(0).toUpperCase()+o.slice(1)+"s",i=r+u;return"".concat(t,".").concat(i,"(").concat(a,")")},spelImport:function(e){var t,r,a,o,u,i=(t=e.methodName)===null||t===void 0?void 0:t.match(/^(minus|plus)(\w+)s$/);if(i&&(u=i[2].toLowerCase(),a=i[1],["minus","plus"].includes(a)&&["day","week","month","year"].includes(u)))return a={type:"string",val:a},u={type:"string",val:u},o=e.args[0],r=e.obj,{date:r,op:a,val:o,dim:u}},jsonLogic:function(e){var t=e.date,r=e.op,a=e.val,o=e.dim;return{date_add:[t,a*(r=="minus"?-1:1),o]}},jsonLogicImport:function(e){var t=e.date_add[0],r=Math.abs(e.date_add[1]),a=e.date_add[1]>=0?"plus":"minus",o=e.date_add[2];return[t,a,r,o]},jsonLogicCustomOps:{date_add:{}},sqlFormatFunc:function(e){var t=e.date,r=e.op,a=e.val,o=e.dim;return"DATE_ADD(".concat(t,", INTERVAL ").concat(parseInt(a)*(r=="minus"?-1:1)," ").concat(o.replace(/^'|'$/g,""),")")},mongoFormatFunc:null,formatFunc:function(e){var t=e.date,r=e.op,a=e.val,o=e.dim;return a?"".concat(t," ").concat(r=="minus"?"-":"+"," ").concat(a," ").concat(o):t},args:{date:{label:"Date",type:"datetime",defaultValue:{func:"NOW",args:[]},valueSources:["func","field","value"],spelEscapeForFormat:!0},op:{label:"Op",type:"select",defaultValue:"plus",valueSources:["value"],mainWidgetProps:{customProps:{showSearch:!1}},fieldSettings:{listValues:{plus:"+",minus:"-"}},spelEscapeForFormat:!1},val:{label:"Value",type:"number",fieldSettings:{min:0},defaultValue:0,valueSources:["value"],spelEscapeForFormat:!1},dim:{label:"Dimension",type:"select",defaultValue:"day",valueSources:["value"],mainWidgetProps:{customProps:{showSearch:!1}},fieldSettings:{listValues:{day:"day",week:"week",month:"month",year:"year"}},spelEscapeForFormat:!1}}},Nm={label:"Lowercase",mongoFunc:"$toLower",jsonLogic:"toLowerCase",spelFunc:"${str}.toLowerCase()",jsonLogicCustomOps:{toLowerCase:{}},returnType:"text",args:{str:{label:"String",type:"text",valueSources:["value","field","func"]}}},km={label:"Uppercase",mongoFunc:"$toUpper",jsonLogic:"toUpperCase",spelFunc:"${str}.toUpperCase()",jsonLogicCustomOps:{toUpperCase:{}},returnType:"text",args:{str:{label:"String",type:"text",valueSources:["value","field","func"]}}},_m={label:"Linear regression",returnType:"number",formatFunc:function(e,t){var r=e.coef,a=e.bias,o=e.val;return"(".concat(r," * ").concat(o," + ").concat(a,")")},sqlFormatFunc:function(e){var t=e.coef,r=e.bias,a=e.val;return"(".concat(t," * ").concat(a," + ").concat(r,")")},spelFormatFunc:function(e){var t=e.coef,r=e.bias,a=e.val;return"(".concat(t," * ").concat(a," + ").concat(r,")")},spelImport:function(e){var t,r,a,o;if(e.type==="op-plus"){var u=(0,Le.A)(e.children,2);if(o=u[0],a=u[1],o.type==="op-multiply"){var i=(0,Le.A)(o.children,2);return t=i[0],r=i[1],{coef:t,val:r,bias:a}}}},mongoFormatFunc:function(e){var t=e.coef,r=e.bias,a=e.val;return{$sum:[{$multiply:[t,a]},r]}},jsonLogic:function(e){var t=e.coef,r=e.bias,a=e.val;return{"+":[{"*":[t,a]},r]}},jsonLogicImport:function(e){var t=e["+"][0]["*"][0],r=e["+"][0]["*"][1],a=e["+"][1];return[t,r,a]},renderBrackets:["",""],renderSeps:[" * "," + "],args:{coef:{label:"Coef",type:"number",defaultValue:1,valueSources:["value"]},val:{label:"Value",type:"number",valueSources:["value","field"]},bias:{label:"Bias",type:"number",defaultValue:0,valueSources:["value"]}}},Mm=function(e,t,r,a,o,u,i,l,s,c,d,f){var p=typeof a=="string"&&!a.startsWith("$")?"$"+a:a,g=t(u,f);if(g!==void 0)return r?!i&&(!e||e=="$eq")?(0,ne.A)({},a,{$ne:g}):i?{$not:(0,ne.A)({},e,[p,g])}:(0,ne.A)({},a,{$not:(0,ne.A)({},e,g)}):!i&&(!e||e=="$eq")?(0,ne.A)({},a,g):i?(0,ne.A)({},e,[p,g]):(0,ne.A)({},a,(0,ne.A)({},e,g))},Gm=function(e,t,r,a,o,u,i,l,s,c,d){var f=typeof r=="string"&&!r.startsWith("$")?"$"+r:r;return t?u?{$not:{$and:[(0,ne.A)({},e[0],[f,o[0]]),(0,ne.A)({},e[1],[f,o[1]])]}}:(0,ne.A)({},r,{$not:(0,ne.A)((0,ne.A)({},e[0],o[0]),e[1],o[1])}):u?{$and:[(0,ne.A)({},e[0],[f,o[0]]),(0,ne.A)({},e[1],[f,o[1]])]}:(0,ne.A)({},r,(0,ne.A)((0,ne.A)({},e[0],o[0]),e[1],o[1]))},Um={utils:{SqlString:Tn,moment:Jn(),mongoFormatOp1:Mm,mongoFormatOp2:Gm,mongoEmptyValue:Ku,escapeRegExp:Ou,sqlEmptyValue:Wu,stringifyForDisplay:Hu,getTitleInListValues:ju,spelEscape:Qn,spelFixList:zu,wrapWithBrackets:Ju}};const Bm=Um;function $m(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=Wm(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,u=!1,i;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return o=s.done,s},e:function(s){u=!0,i=s},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(u)throw i}}}}function Wm(n,e){if(n){if(typeof n=="string")return Ic(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Ic(n,e)}}function Ic(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function Vc(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function dr(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Vc(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Vc(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var Km={AND:{label:"And",mongoConj:"$and",jsonLogicConj:"and",sqlConj:"AND",spelConj:"and",spelConjs:["and","&&"],reversedConj:"OR",formatConj:function(e,t,r,a){var o=e.size>1?e.join(" "+(a?"AND":"&&")+" "):e.first();return(e.size>1||r)&&(o=this.utils.wrapWithBrackets(o)),r&&(o="NOT "+o),o},sqlFormatConj:function(e,t,r){var a=e.size>1?e.join(" AND "):e.first();return(e.size>1||r)&&(a=this.utils.wrapWithBrackets(a)),r&&(a="NOT "+a),a},spelFormatConj:function(e,t,r,a){r&&(a=!1);var o=e.size>1?e.join(" && "):e.first();return(e.size>1||r)&&!a&&(o=this.utils.wrapWithBrackets(o)),r&&(o="!"+o),o}},OR:{label:"Or",mongoConj:"$or",jsonLogicConj:"or",sqlConj:"OR",spelConj:"or",spelConjs:["or","||"],reversedConj:"AND",formatConj:function(e,t,r,a){return e.size>1?(r?"NOT ":"")+"("+e.join(" "+(a?"OR":"||")+" ")+")":(r?"NOT (":"")+e.first()+(r?")":"")},sqlFormatConj:function(e,t,r){return e.size>1?(r?"NOT ":"")+"("+e.join(" OR ")+")":(r?"NOT (":"")+e.first()+(r?")":"")},spelFormatConj:function(e,t,r,a){return r&&(a=!1),e.size>1?(r?"!":"")+(a?"":"(")+e.join(" || ")+(a?"":")"):(r?"!(":"")+e.first()+(r?")":"")}}},zm={equal:{label:"==",labelForFormat:"==",sqlOp:"=",spelOp:"==",spelOps:["==","eq"],reversedOp:"not_equal",formatOp:function(e,t,r,a,o,u,i,l,s){var c=l?"=":u.label;return o=="boolean"&&l?r=="No"?"NOT ".concat(e):"".concat(e):"".concat(e," ").concat(c," ").concat(r)},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(o){return o},!1].concat(r))},jsonLogic:"==",elasticSearchQueryType:"term"},not_equal:{isNotOp:!0,label:"!=",labelForFormat:"!=",sqlOp:"<>",spelOp:"!=",spelOps:["!=","ne"],reversedOp:"equal",formatOp:function(e,t,r,a,o,u,i,l,s){return o=="boolean"&&l?r=="No"?"".concat(e):"NOT ".concat(e):"".concat(e," ").concat(u.label," ").concat(r)},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$ne",function(o){return o},!1].concat(r))},jsonLogic:"!="},less:{label:"<",labelForFormat:"<",sqlOp:"<",spelOp:"<",spelOps:["<","lt"],reversedOp:"greater_or_equal",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$lt",function(o){return o},!1].concat(r))},jsonLogic:"<",elasticSearchQueryType:"range"},less_or_equal:{label:"<=",labelForFormat:"<=",sqlOp:"<=",spelOp:"<=",spelOps:["<=","le"],reversedOp:"greater",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$lte",function(o){return o},!1].concat(r))},jsonLogic:"<=",elasticSearchQueryType:"range"},greater:{label:">",labelForFormat:">",sqlOp:">",spelOp:">",spelOps:[">","gt"],reversedOp:"less_or_equal",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$gt",function(o){return o},!1].concat(r))},jsonLogic:">",elasticSearchQueryType:"range"},greater_or_equal:{label:">=",labelForFormat:">=",sqlOp:">=",spelOp:">=",spelOps:[">=","ge"],reversedOp:"less",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$gte",function(o){return o},!1].concat(r))},jsonLogic:">=",elasticSearchQueryType:"range"},like:{label:"Contains",labelForFormat:"Contains",reversedOp:"not_like",sqlOp:"LIKE",spelOp:"${0}.contains(${1})",valueTypes:["text"],mongoFormatOp:function(){for(var e,t=this,r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$regex",function(u){return typeof u=="string"?t.utils.escapeRegExp(u):void 0},!1].concat(a))},jsonLogic:"in",_jsonLogicIsRevArgs:!0,valueSources:["value"],elasticSearchQueryType:"regexp"},not_like:{isNotOp:!0,label:"Not contains",reversedOp:"like",labelForFormat:"Not Contains",sqlOp:"NOT LIKE",mongoFormatOp:function(){for(var e,t=this,r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$regex",function(u){return typeof u=="string"?t.utils.escapeRegExp(u):void 0},!0].concat(a))},valueSources:["value"]},starts_with:{label:"Starts with",labelForFormat:"Starts with",sqlOp:"LIKE",spelOp:"${0}.startsWith(${1})",mongoFormatOp:function(){for(var e,t=this,r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$regex",function(u){return typeof u=="string"?"^"+t.utils.escapeRegExp(u):void 0},!1].concat(a))},jsonLogic:void 0,valueSources:["value"]},ends_with:{label:"Ends with",labelForFormat:"Ends with",sqlOp:"LIKE",spelOp:"${0}.endsWith(${1})",mongoFormatOp:function(){for(var e,t=this,r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$regex",function(u){return typeof u=="string"?t.utils.escapeRegExp(u)+"$":void 0},!1].concat(a))},jsonLogic:void 0,valueSources:["value"]},between:{label:"Between",labelForFormat:"BETWEEN",sqlOp:"BETWEEN",cardinality:2,formatOp:function(e,t,r,a,o,u,i,l){var s=r.first(),c=r.get(1);return l?"".concat(e," BETWEEN ").concat(s," AND ").concat(c):"".concat(e," >= ").concat(s," && ").concat(e," <= ").concat(c)},spelFormatOp:function(e,t,r,a,o,u,i,l){var s=r[0],c=r[1];return"".concat(e," >= ").concat(s," && ").concat(e," <= ").concat(c)},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp2.apply(e,[["$gte","$lte"],!1].concat(r))},valueLabels:["Value from","Value to"],textSeparators:[null,"and"],reversedOp:"not_between",jsonLogic:"<=",validateValues:function(e){return e[0]!=null&&e[1]!=null?e[0]<=e[1]:null},elasticSearchQueryType:function(e){return e==="time"?"filter":"range"}},not_between:{isNotOp:!0,label:"Not between",labelForFormat:"NOT BETWEEN",sqlOp:"NOT BETWEEN",cardinality:2,formatOp:function(e,t,r,a,o,u,i,l){var s=r.first(),c=r.get(1);return l?"".concat(e," NOT BETWEEN ").concat(s," AND ").concat(c):"(".concat(e," < ").concat(s," || ").concat(e," > ").concat(c,")")},spelFormatOp:function(e,t,r,a,o,u,i,l){var s=r[0],c=r[1];return"(".concat(e," < ").concat(s," || ").concat(e," > ").concat(c,")")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp2.apply(e,[["$gte","$lte"],!0].concat(r))},valueLabels:["Value from","Value to"],textSeparators:[null,"and"],reversedOp:"between",validateValues:function(e){return e[0]!=null&&e[1]!=null?e[0]<=e[1]:null}},is_empty:{label:"Is empty",labelForFormat:"IS EMPTY",cardinality:0,reversedOp:"is_not_empty",formatOp:function(e,t,r,a,o,u,i,l){return l?"".concat(e," IS EMPTY"):"!".concat(e)},sqlFormatOp:function(e,t,r,a,o,u,i,l){var s=this.utils.sqlEmptyValue(l);return"COALESCE(".concat(e,", ").concat(s,") = ").concat(s)},spelFormatOp:function(e,t,r,a,o,u,i,l){return"".concat(e," <= ''")},mongoFormatOp:function(){for(var e,t=this,r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$in",function(u,i){return[t.utils.mongoEmptyValue(i),null]},!1].concat(a))},jsonLogic:"!"},is_not_empty:{isNotOp:!0,label:"Is not empty",labelForFormat:"IS NOT EMPTY",cardinality:0,reversedOp:"is_empty",formatOp:function(e,t,r,a,o,u,i,l){return l?"".concat(e," IS NOT EMPTY"):"!!".concat(e)},sqlFormatOp:function(e,t,r,a,o,u,i,l){var s=this.utils.sqlEmptyValue(l);return"COALESCE(".concat(e,", ").concat(s,") <> ").concat(s)},spelFormatOp:function(e,t,r,a,o,u,i,l){return"".concat(e," > ''")},mongoFormatOp:function(){for(var e,t=this,r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$nin",function(u,i){return[t.utils.mongoEmptyValue(i),null]},!1].concat(a))},jsonLogic:"!!",elasticSearchQueryType:"exists"},is_null:{label:"Is null",labelForFormat:"IS NULL",sqlOp:"IS NULL",cardinality:0,reversedOp:"is_not_null",formatOp:function(e,t,r,a,o,u,i,l){return l?"".concat(e," IS NULL"):"!".concat(e)},spelFormatOp:function(e,t,r,a,o,u,i,l){return"".concat(e," == null")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(o){return null},!1].concat(r))},jsonLogic:"=="},is_not_null:{label:"Is not null",labelForFormat:"IS NOT NULL",sqlOp:"IS NOT NULL",cardinality:0,reversedOp:"is_null",formatOp:function(e,t,r,a,o,u,i,l){return l?"".concat(e," IS NOT NULL"):"!!".concat(e)},spelFormatOp:function(e,t,r,a,o,u,i,l){return"".concat(e," != null")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$ne",function(o){return null},!1].concat(r))},jsonLogic:"!=",elasticSearchQueryType:"exists"},select_equals:{label:"==",labelForFormat:"==",sqlOp:"=",formatOp:function(e,t,r,a,o,u,i,l){var s=l?"=":"==";return"".concat(e," ").concat(s," ").concat(r)},spelOp:"==",spelOps:["==","eq"],mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(o){return o},!1].concat(r))},reversedOp:"select_not_equals",jsonLogic:"==",elasticSearchQueryType:"term"},select_not_equals:{isNotOp:!0,label:"!=",labelForFormat:"!=",sqlOp:"<>",formatOp:function(e,t,r,a,o,u,i,l){return"".concat(e," != ").concat(r)},spelOp:"!=",spelOps:["!=","ne"],mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$ne",function(o){return o},!1].concat(r))},reversedOp:"select_equals",jsonLogic:"!="},select_any_in:{label:"Any in",labelForFormat:"IN",sqlOp:"IN",formatOp:function(e,t,r,a,o,u,i,l){return a=="value"?"".concat(e," IN (").concat(r.join(", "),")"):"".concat(e," IN (").concat(r,")")},sqlFormatOp:function(e,t,r,a,o,u,i,l){if(a=="value")return"".concat(e," IN (").concat(r.join(", "),")")},valueTypes:["multiselect"],spelOp:"${1}.contains(${0})",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$in",function(o){return o},!1].concat(r))},reversedOp:"select_not_any_in",jsonLogic:"in",elasticSearchQueryType:"term"},select_not_any_in:{isNotOp:!0,label:"Not in",labelForFormat:"NOT IN",sqlOp:"NOT IN",formatOp:function(e,t,r,a,o,u,i,l){return a=="value"?"".concat(e," NOT IN (").concat(r.join(", "),")"):"".concat(e," NOT IN (").concat(r,")")},sqlFormatOp:function(e,t,r,a,o,u,i,l){if(a=="value")return"".concat(e," NOT IN (").concat(r.join(", "),")")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$nin",function(o){return o},!1].concat(r))},reversedOp:"select_any_in"},multiselect_contains:{label:"Contains",labelForFormat:"CONTAINS",formatOp:function(e,t,r,a,o,u,i,l){return a=="value"?"".concat(e," CONTAINS [").concat(r.join(", "),"]"):"".concat(e," CONTAINS ").concat(r)},reversedOp:"multiselect_not_contains",jsonLogic2:"some-in",jsonLogic:function(e,t,r){return{some:[e,{in:[{var:""},r]}]}},spelOp:"T(CollectionUtils).containsAny(${0}, ${1})",elasticSearchQueryType:"term",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$in",function(o){return o},!1].concat(r))}},multiselect_not_contains:{isNotOp:!0,label:"Not contains",labelForFormat:"NOT CONTAINS",formatOp:function(e,t,r,a,o,u,i,l){return a=="value"?"".concat(e," NOT CONTAINS [").concat(r.join(", "),"]"):"".concat(e," NOT CONTAINS ").concat(r)},reversedOp:"multiselect_contains"},multiselect_equals:{label:"Equals",labelForFormat:"==",sqlOp:"=",formatOp:function(e,t,r,a,o,u,i,l){var s=l?"=":"==";return a=="value"?"".concat(e," ").concat(s," [").concat(r.join(", "),"]"):"".concat(e," ").concat(s," ").concat(r)},sqlFormatOp:function(e,t,r,a,o,u,i,l){var s=this;if(a=="value")return"".concat(e," = '").concat(r.map(function(c){return s.utils.SqlString.trim(c)}).join(","),"'")},spelOp:"${0}.equals(${1})",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(o){return o},!1].concat(r))},reversedOp:"multiselect_not_equals",jsonLogic2:"all-in",jsonLogic:function(e,t,r){return{all:[e,{in:[{var:""},r]}]}},elasticSearchQueryType:"term"},multiselect_not_equals:{isNotOp:!0,label:"Not equals",labelForFormat:"!=",sqlOp:"<>",formatOp:function(e,t,r,a,o,u,i,l){return a=="value"?"".concat(e," != [").concat(r.join(", "),"]"):"".concat(e," != ").concat(r)},sqlFormatOp:function(e,t,r,a,o,u,i,l){var s=this;if(a=="value")return"".concat(e," != '").concat(r.map(function(c){return s.utils.SqlString.trim(c)}).join(","),"'")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$ne",function(o){return o},!1].concat(r))},reversedOp:"multiselect_equals"},proximity:{label:"Proximity search",cardinality:2,valueLabels:[{label:"Word 1",placeholder:"Enter first word"},{label:"Word 2",placeholder:"Enter second word"}],textSeparators:[],formatOp:function(e,t,r,a,o,u,i,l){var s=r.first(),c=r.get(1),d=i?.get("proximity");return"".concat(e," ").concat(s," NEAR/").concat(d," ").concat(c)},sqlFormatOp:function(e,t,r,a,o,u,i,l){var s=r.first(),c=r.get(1),d=this.utils.SqlString.trim(s),f=this.utils.SqlString.trim(c),p=i?.get("proximity");return"CONTAINS(".concat(e,", 'NEAR((").concat(d,", ").concat(f,"), ").concat(p,")')")},mongoFormatOp:void 0,jsonLogic:void 0,options:{optionLabel:"Near",optionTextBefore:"Near",optionPlaceholder:"Select words between",minProximity:2,maxProximity:10,defaults:{proximity:2}}},some:{label:"Some",labelForFormat:"SOME",cardinality:0,jsonLogic:"some",spelFormatOp:function(e){return"".concat(e," > 0")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$gt",function(o){return 0},!1].concat(r))}},all:{label:"All",labelForFormat:"ALL",cardinality:0,jsonLogic:"all",spelFormatOp:function(e,t,r){return"".concat(e," == ").concat(r)},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(o){return o},!1].concat(r))}},none:{label:"None",labelForFormat:"NONE",cardinality:0,jsonLogic:"none",spelFormatOp:function(e){return"".concat(e," == 0")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(o){return 0},!1].concat(r))}}},Hm={text:{type:"text",jsType:"string",valueSrc:"value",valueLabel:"String",valuePlaceholder:"Enter string",formatValue:function(e,t,r,a){return a?this.utils.stringifyForDisplay(e):JSON.stringify(e)},spelFormatValue:function(e,t,r,a,o){return this.utils.spelEscape(e)},sqlFormatValue:function(e,t,r,a,o){return o.sqlOp=="LIKE"||o.sqlOp=="NOT LIKE"?this.utils.SqlString.escapeLike(e,a!="starts_with",a!="ends_with"):this.utils.SqlString.escape(e)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},textarea:{type:"text",jsType:"string",valueSrc:"value",valueLabel:"Text",valuePlaceholder:"Enter text",formatValue:function(e,t,r,a){return a?this.utils.stringifyForDisplay(e):JSON.stringify(e)},sqlFormatValue:function(e,t,r,a,o){return o.sqlOp=="LIKE"||o.sqlOp=="NOT LIKE"?this.utils.SqlString.escapeLike(e,a!="starts_with",a!="ends_with"):this.utils.SqlString.escape(e)},spelFormatValue:function(e){return this.utils.spelEscape(e)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e},fullWidth:!0},number:{type:"number",jsType:"number",valueSrc:"value",valueLabel:"Number",valuePlaceholder:"Enter number",valueLabels:[{label:"Number from",placeholder:"Enter number from"},{label:"Number to",placeholder:"Enter number to"}],formatValue:function(e,t,r,a){return a?this.utils.stringifyForDisplay(e):JSON.stringify(e)},sqlFormatValue:function(e,t,r,a,o){return this.utils.SqlString.escape(e)},spelFormatValue:function(e,t,r){var a=r.step&&!Number.isInteger(r.step);return this.utils.spelEscape(e,a)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},slider:{type:"number",jsType:"number",valueSrc:"value",valueLabel:"Number",valuePlaceholder:"Enter number or move slider",formatValue:function(e,t,r,a){return a?this.utils.stringifyForDisplay(e):JSON.stringify(e)},sqlFormatValue:function(e,t,r,a,o){return this.utils.SqlString.escape(e)},spelFormatValue:function(e){return this.utils.spelEscape(e)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},select:{type:"select",jsType:"string",valueSrc:"value",valueLabel:"Value",valuePlaceholder:"Select value",formatValue:function(e,t,r,a){var o=this.utils.getTitleInListValues(t.fieldSettings.listValues||t.asyncListValues,e);return a?this.utils.stringifyForDisplay(o):JSON.stringify(e)},sqlFormatValue:function(e,t,r,a,o){return this.utils.SqlString.escape(e)},spelFormatValue:function(e){return this.utils.spelEscape(e)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},multiselect:{type:"multiselect",jsType:"array",valueSrc:"value",valueLabel:"Values",valuePlaceholder:"Select values",formatValue:function(e,t,r,a){var o=this,u=e.map(function(i){return o.utils.getTitleInListValues(t.fieldSettings.listValues||t.asyncListValues,i)});return a?u.map(this.utils.stringifyForDisplay):e.map(JSON.stringify)},sqlFormatValue:function(e,t,r,a,o){var u=this;return e.map(function(i){return u.utils.SqlString.escape(i)})},spelFormatValue:function(e,t,r,a,o){var u=o&&o.spelOp&&o.spelOp.startsWith("${1}"),i=this.utils.spelEscape(e);return u&&(i=this.utils.spelFixList(i)),i},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},date:{type:"date",jsType:"string",valueSrc:"value",dateFormat:"DD.MM.YYYY",valueFormat:"YYYY-MM-DD",valueLabel:"Date",valuePlaceholder:"Enter date",valueLabels:[{label:"Date from",placeholder:"Enter date from"},{label:"Date to",placeholder:"Enter date to"}],formatValue:function(e,t,r,a){var o=this.utils.moment(e,r.valueFormat);return a?o.format(r.dateFormat):JSON.stringify(e)},sqlFormatValue:function(e,t,r,a,o){var u=this.utils.moment(e,r.valueFormat);return this.utils.SqlString.escape(u.format("YYYY-MM-DD"))},spelFormatValue:function(e,t,r,a,o){var u=this.utils.moment(e,r.valueFormat),i=u.format("YYYY-MM-DD"),l="yyyy-MM-dd";return"T(java.time.LocalDate).parse('".concat(i,"', T(java.time.format.DateTimeFormatter).ofPattern('").concat(l,"'))")},spelImportFuncs:[{obj:{cls:["java","time","LocalDate"]},methodName:"parse",args:[{var:"v"},{obj:{cls:["java","time","format","DateTimeFormatter"]},methodName:"ofPattern",args:[{var:"fmt"}]}]}],spelImportValue:function(e,t,r){var a,o,u,i;if(!t)return[void 0,"No widget def to get value format"];if(r!=null&&(a=r.fmt)!==null&&a!==void 0&&(a=a.value)!==null&&a!==void 0&&(o=a.includes)!==null&&o!==void 0&&o.call(a," ")||(u=r.fmt)!==null&&u!==void 0&&(u=u.value)!==null&&u!==void 0&&(i=u.toLowerCase)!==null&&i!==void 0&&i.call(u).includes("hh:mm"))return[void 0,"Invalid date format ".concat(JSON.stringify(r.fmt))];var l=this.utils.moment(e.value,this.utils.moment.ISO_8601);return l.isValid()?[l.format(t?.valueFormat),[]]:[void 0,"Invalid date"]},jsonLogic:function(e,t,r){return this.utils.moment(e,r.valueFormat).toDate()},toJS:function(e,t){var r=this.utils.moment(e,t.valueFormat);return r.isValid()?r.toDate():void 0},mongoFormatValue:function(e,t,r){var a=this.utils.moment(e,r.valueFormat);return a.isValid()?a.toDate():void 0}},time:{type:"time",jsType:"string",valueSrc:"value",timeFormat:"HH:mm",valueFormat:"HH:mm:ss",use12Hours:!1,valueLabel:"Time",valuePlaceholder:"Enter time",valueLabels:[{label:"Time from",placeholder:"Enter time from"},{label:"Time to",placeholder:"Enter time to"}],formatValue:function(e,t,r,a){var o=this.utils.moment(e,r.valueFormat);return a?o.format(r.timeFormat):JSON.stringify(e)},sqlFormatValue:function(e,t,r,a,o){var u=this.utils.moment(e,r.valueFormat);return this.utils.SqlString.escape(u.format("HH:mm:ss"))},spelFormatValue:function(e,t,r,a,o){var u=this.utils.moment(e,r.valueFormat),i="HH:mm:ss",l=u.format("HH:mm:ss");return"T(java.time.LocalTime).parse('".concat(l,"')")},spelImportFuncs:["T(java.time.LocalTime).parse(${v})"],spelImportValue:function(e,t,r){var a,o,u;if(!t)return[void 0,"No widget def to get value format"];if(r!=null&&r.fmt&&(!((a=r.fmt)!==null&&a!==void 0&&(a=a.value)!==null&&a!==void 0&&(o=a.toLowerCase)!==null&&o!==void 0&&o.call(a).includes("hh:mm"))||(u=r.fmt)!==null&&u!==void 0&&(u=u.value)!==null&&u!==void 0&&u.includes(" ")))return[void 0,"Invalid time format ".concat(JSON.stringify(r.fmt))];var i=this.utils.moment(e.value,"HH:mm:ss");return i.isValid()?[i.format(t?.valueFormat),[]]:[void 0,"Invalid date"]},jsonLogic:function(e,t,r){var a=this.utils.moment(e,r.valueFormat);return a.get("hour")*60*60+a.get("minute")*60+a.get("second")},toJS:function(e,t){var r=this.utils.moment(e,t.valueFormat);return r.isValid()?r.get("hour")*60*60+r.get("minute")*60+r.get("second"):void 0},mongoFormatValue:function(e,t,r){var a=this.utils.moment(e,r.valueFormat);return a.get("hour")*60*60+a.get("minute")*60+a.get("second")},elasticSearchFormatValue:function(e,t,r,a){return{script:{script:{source:"doc[".concat(a,"][0].getHour() >== params.min && doc[").concat(a,"][0].getHour() <== params.max"),params:{min:t[0],max:t[1]}}}}}},datetime:{type:"datetime",jsType:"string",valueSrc:"value",timeFormat:"HH:mm",dateFormat:"DD.MM.YYYY",valueFormat:"YYYY-MM-DD HH:mm:ss",use12Hours:!1,valueLabel:"Datetime",valuePlaceholder:"Enter datetime",valueLabels:[{label:"Datetime from",placeholder:"Enter datetime from"},{label:"Datetime to",placeholder:"Enter datetime to"}],formatValue:function(e,t,r,a){var o=this.utils.moment(e,r.valueFormat);return a?o.format(r.dateFormat+" "+r.timeFormat):JSON.stringify(e)},sqlFormatValue:function(e,t,r,a,o){var u=this.utils.moment(e,r.valueFormat);return this.utils.SqlString.escape(u.toDate())},spelFormatValue:function(e,t,r,a,o){var u=this.utils.moment(e,r.valueFormat),i=u.format("YYYY-MM-DD HH:mm:ss"),l="yyyy-MM-dd HH:mm:ss";return"T(java.time.LocalDateTime).parse('".concat(i,"', T(java.time.format.DateTimeFormatter).ofPattern('").concat(l,"'))")},spelImportFuncs:[{obj:{cls:["java","time","LocalDateTime"]},methodName:"parse",args:[{var:"v"},{obj:{cls:["java","time","format","DateTimeFormatter"]},methodName:"ofPattern",args:[{var:"fmt"}]}]}],spelImportValue:function(e,t,r){var a,o;if(!t)return[void 0,"No widget def to get value format"];if(!(r!=null&&(a=r.fmt)!==null&&a!==void 0&&(a=a.value)!==null&&a!==void 0&&(o=a.includes)!==null&&o!==void 0&&o.call(a," ")))return[void 0,"Invalid datetime format ".concat(JSON.stringify(r.fmt))];var u=this.utils.moment(e.value,this.utils.moment.ISO_8601);return u.isValid()?[u.format(t?.valueFormat),[]]:[void 0,"Invalid date"]},jsonLogic:function(e,t,r){return this.utils.moment(e,r.valueFormat).toDate()},toJS:function(e,t){var r=this.utils.moment(e,t.valueFormat);return r.isValid()?r.toDate():void 0},mongoFormatValue:function(e,t,r){var a=this.utils.moment(e,r.valueFormat);return a.isValid()?a.toDate():void 0}},boolean:{type:"boolean",jsType:"boolean",valueSrc:"value",labelYes:"Yes",labelNo:"No",formatValue:function(e,t,r,a){return a?e?"Yes":"No":JSON.stringify(!!e)},sqlFormatValue:function(e,t,r,a,o){return this.utils.SqlString.escape(e)},spelFormatValue:function(e,t,r,a,o){return this.utils.spelEscape(e)},defaultValue:!1,toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},field:{valueSrc:"field",formatValue:function(e,t,r,a,o,u,i){return a&&i.label||e},sqlFormatValue:function(e,t,r,a,o,u){return e},spelFormatValue:function(e,t,r,a,o){return e},valueLabel:"Field to compare",valuePlaceholder:"Select field to compare"},func:{valueSrc:"func",valueLabel:"Function",valuePlaceholder:"Select function"},case_value:{valueSrc:"value",type:"case_value",spelFormatValue:function(e){return this.utils.spelEscape(e===""?null:e)},spelImportValue:function(e){return[e.value,[]]},jsonLogic:function(e){return e===""?null:e}}},Jm={text:{defaultOperator:"equal",mainWidget:"text",widgets:{text:{operators:["equal","not_equal","like","not_like","starts_with","ends_with","proximity","is_empty","is_not_empty","is_null","is_not_null"],widgetProps:{},opProps:{}},textarea:{operators:["equal","not_equal","like","not_like","starts_with","ends_with","is_empty","is_not_empty","is_null","is_not_null"],widgetProps:{},opProps:{}},field:{operators:["equal","not_equal","proximity"]}}},number:{defaultOperator:"equal",mainWidget:"number",widgets:{number:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]},slider:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","is_null","is_not_null"]}}},date:{defaultOperator:"equal",widgets:{date:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]}}},time:{defaultOperator:"equal",widgets:{time:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]}}},datetime:{defaultOperator:"equal",widgets:{datetime:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]}}},select:{mainWidget:"select",defaultOperator:"select_equals",widgets:{select:{operators:["select_equals","select_not_equals","is_null","is_not_null"]},multiselect:{operators:["select_any_in","select_not_any_in","is_null","is_not_null"]}}},multiselect:{defaultOperator:"multiselect_equals",widgets:{multiselect:{operators:["multiselect_contains","multiselect_not_contains","multiselect_equals","multiselect_not_equals","is_null","is_not_null"]}}},boolean:{defaultOperator:"equal",widgets:{boolean:{operators:["equal","not_equal","is_null","is_not_null"],widgetProps:{}},field:{operators:["equal","not_equal"]}}},"!group":{defaultOperator:"some",mainWidget:"number",widgets:{number:{widgetProps:{min:0},operators:["some","all","none","equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between"],opProps:{equal:{label:"Count =="},not_equal:{label:"Count !="},less:{label:"Count <"},less_or_equal:{label:"Count <="},greater:{label:"Count >"},greater_or_equal:{label:"Count >="},between:{label:"Count between"},not_between:{label:"Count not between"}}}}},case_value:{mainWidget:"case_value",widgets:{case_value:{widgetProps:{}}}}},qm=dr(dr({},Gs),{},{convertableWidgets:{number:["slider","rangeslider"],slider:["number","rangeslider"],rangeslider:["number","slider"],text:["textarea"],textarea:["text"]},formatSpelField:function(e,t,r,a,o,u){var i=this,l=a.map(function(s,c){var d=s.key,f=s.parent,p=s.fieldSeparator;return c==0?f=="[map]"?"#this[".concat(i.utils.spelEscape(d),"]"):(f=="[class]",d):f=="map"||f=="[map]"?"[".concat(i.utils.spelEscape(d),"]"):(f=="class"||f=="[class]","".concat(p).concat(d))}).join("");return o.fieldName&&(l=e),o.isSpelVariable&&(l="#"+l),l},sqlFormatReverse:function(e){if(e!=null)return"NOT"+this.utils.wrapWithBrackets(e)},spelFormatReverse:function(e){if(e!=null)return"!"+this.utils.wrapWithBrackets(e)},formatReverse:function(e,t,r,a,o,u){if(e!=null)return u?"NOT "+this.utils.wrapWithBrackets(e):"!"+this.utils.wrapWithBrackets(e)},formatAggr:function(e,t,r,a,o,u,i,l,s,c){var d=i.labelForFormat,f=i.cardinality;if(f==0){var p=e?" HAVE ".concat(e):"";return"".concat(d," OF ").concat(t).concat(p)}else if(f==null||f==1){var g=e?" WHERE ".concat(e):"";return"COUNT OF ".concat(t).concat(g," ").concat(d," ").concat(a)}else if(f==2){var v=e?" WHERE ".concat(e):"",m=a.first(),h=a.get(1);return"COUNT OF ".concat(t).concat(v," ").concat(d," ").concat(m," AND ").concat(h)}},jsonLogic:{groupVarKey:"var",altVarKey:"var",lockedOp:"locked"},canCompareFieldWithField:function(e,t,r,a){return!0},valueSourcesInfo:{value:{label:"Value"},field:{label:"Field",widget:"field"},func:{label:"Function",widget:"func"}}}),Dc=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a={rangeslider:Xm,treeselect:Zm,treemultiselect:eh,rangeable__date:Ym("date","date")},o=$m(t),u;try{for(o.s();!(u=o.n()).done;){var i=u.value,l=a[i];if(l)e=l(e,r);else throw new Error("Can't ".concat(r?"add":"remove"," mixin ").concat(i))}}catch(s){o.e(s)}finally{o.f()}return e},Nc=function(e,t){return Dc(e,t,!0)},Qm=function(e,t){return Dc(e,t,!1)},Ym=function(e,t){return function(r){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o=r.types;return o=dr(dr({},o),{},(0,ne.A)({},e,dr(dr({},o[e]),{},{widgets:dr({},o[e].widgets)}))),a?o[e].widgets[t]=dr({opProps:{between:{isSpecialRange:!0,textSeparators:[null,null]},not_between:{isSpecialRange:!0,textSeparators:[null,null]}}},o[e].widgets[t]):delete o[e].widgets[t],dr(dr({},r),{},{types:o})}},Xm=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=e.widgets,a=e.types;return r=dr({},r),t?r.rangeslider=dr({type:"number",jsType:"number",valueSrc:"value",valueLabel:"Range",valuePlaceholder:"Select range",valueLabels:[{label:"Number from",placeholder:"Enter number from"},{label:"Number to",placeholder:"Enter number to"}],formatValue:function(u,i,l,s){return s?this.utils.stringifyForDisplay(u):JSON.stringify(u)},sqlFormatValue:function(u,i,l,s,c){return this.utils.SqlString.escape(u)},spelFormatValue:function(u){return this.utils.spelEscape(u)},singleWidget:"slider",toJS:function(u,i){return u}},r.rangeslider):delete r.rangeslider,a=dr(dr({},a),{},{number:dr(dr({},a.number),{},{widgets:dr({},a.number.widgets)})}),t?a.number.widgets.rangeslider=dr({opProps:{between:{isSpecialRange:!0},not_between:{isSpecialRange:!0}},operators:["between","not_between","is_null","is_not_null"]},a.number.widgets.rangeslider):delete a.number.widgets.rangeslider,dr(dr({},e),{},{widgets:r,types:a})},Zm=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=e.widgets,a=e.types;return r=dr({},r),t?r.treeselect=dr({type:"treeselect",jsType:"string",valueSrc:"value",valueLabel:"Value",valuePlaceholder:"Select value",formatValue:function(u,i,l,s){var c=i.fieldSettings.treeValues||i.fieldSettings.listValues||i.asyncListValues,d=this.utils.getTitleInListValues(c,u);return s?this.utils.stringifyForDisplay(d):JSON.stringify(u)},sqlFormatValue:function(u,i,l,s,c){return this.utils.SqlString.escape(u)},spelFormatValue:function(u){return this.utils.spelEscape(u)},toJS:function(u,i){return u}},r.treeselect):delete r.treeselect,a=dr({},a),t?a.treeselect=dr({mainWidget:"treeselect",defaultOperator:"select_equals",widgets:{treeselect:{operators:["select_equals","select_not_equals"]},treemultiselect:{operators:["select_any_in","select_not_any_in"]}}},a.treeselect):delete a.treeselect,dr(dr({},e),{},{widgets:r,types:a})},eh=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=e.widgets,a=e.types;return r=dr({},r),t?r.treemultiselect=dr({type:"treemultiselect",jsType:"array",valueSrc:"value",valueLabel:"Values",valuePlaceholder:"Select values",formatValue:function(u,i,l,s){var c=this,d=i.fieldSettings.treeValues||i.fieldSettings.listValues||i.asyncListValues,f=u.map(function(p){return c.utils.getTitleInListValues(d,p)});return s?f.map(this.utils.stringifyForDisplay):u.map(JSON.stringify)},sqlFormatValue:function(u,i,l,s,c){var d=this;return u.map(function(f){return d.utils.SqlString.escape(f)})},spelFormatValue:function(u){return this.utils.spelEscape(u)},toJS:function(u,i){return u}},r.treemultiselect):delete r.treemultiselect,a=dr({},a),t?a.treemultiselect=dr({defaultOperator:"multiselect_equals",widgets:{treemultiselect:{operators:["multiselect_equals","multiselect_not_equals"]}}},a.treemultiselect):delete a.treemultiselect,dr(dr({},e),{},{widgets:r,types:a})},rh={addMixins:Nc,removeMixins:Qm},$i={conjunctions:Km,operators:zm,widgets:Hm,types:Jm,settings:qm,ctx:Bm};$i=Nc($i,["rangeslider","treeselect","treemultiselect"]);const Vr=$i;var kc="ADD_GROUP",Wi="ADD_CASE_GROUP",_c="REMOVE_GROUP",Mc="SET_CONJUNCTION",Gc="SET_NOT",Uc="ADD_RULE",Bc="REMOVE_RULE",$c="SET_FIELD",Wc="SET_FIELD_SRC",Kc="SET_OPERATOR",zc="SET_VALUE",Hc="SET_VALUE_SRC",Jc="SET_FUNC_VALUE",qc="SET_OPERATOR_OPTION",Qc="SET_LOCK",Ki="SET_TREE",Yc="MOVE_ITEM",Xc="after",Zc="before",zi="append",Hi="prepend",ed="SET_DRAG_PROGRESS",rd="SET_DRAG_START",td="SET_DRAG_END",th=y(73916),mo=y.n(th);function nd(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function on(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?nd(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):nd(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function Ji(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=nh(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,u=!1,i;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return o=s.done,s},e:function(s){u=!0,i=s},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(u)throw i}}}}function nh(n,e){if(n){if(typeof n=="string")return ad(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return ad(n,e)}}function ad(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}var od=function(e,t,r,a,o,u){var i,l=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null,s=arguments.length>7&&arguments[7]!==void 0?arguments[7]:{},c=e.getIn(Te(t));if(!c)return e;var d=(o==null||(i=o.get)===null||i===void 0?void 0:i.call(o,"id"))||a,f=u.settings.shouldCreateEmptyGroup,p=t.push(d),g=!f,v=!!(s!=null&&s.isDefaultCase),m=e;return e=Mn(e,t,r,d,En(u).merge((0,ye.fromJS)(o)||{}),u,l),e!==m&&(!l&&!v&&(e=e.setIn(Te(p,"children1"),new ye.default.OrderedMap),g&&(e=Mn(e,p,"rule",cr(),rn(u),u))),e=Ht(e)),e},ah=function(e,t,r){var a=e.getIn(Te(t));if(!a)return e;e=qi(e,t);var o=r.settings.canLeaveEmptyGroup,u=t.slice(0,-1),i=!ri(e,u);if(i&&!o&&(e=to(e),ei(e)&&!o)){var l=!1,s=!1;e=Mn(e,new ye.default.List,"rule",cr(),rn(r,void 0,void 0,l,s),r)}return e=Ht(e),e},oh=function(e,t,r){var a=e.getIn(Te(t));if(!a)return e;e=qi(e,t);var o=r.settings.canLeaveEmptyGroup,u=t.pop(),i=e.getIn(Te(u)),l=i.getIn(["properties","field"]),s=i.getIn(["properties","operator"]),c=l?Re(r,l):null,d=s?lr(r,s,l):null,f=l&&s&&d.cardinality!=0,p=i.get("type")=="rule_group",g=!ri(e,u),v=p?f&&c.initialEmptyWhere:o;if(g&&!v&&(p&&(e=e.deleteIn(Te(u))),e=to(e),ei(e)&&!o)){var m=!1,h=!1;e=Mn(e,new ye.default.List,"rule",cr(),rn(r,void 0,void 0,m,h),r)}return e=Ht(e),e},ih=function(e,t,r){var a=e.getIn(Te(t));return a&&(e=e.setIn(Te(t,"properties","not"),r)),e},uh=function(e,t,r){var a=e.getIn(Te(t));return a&&(e=Ru(e.setIn(Te(t,"properties","isLocked"),r))),e},lh=function(e,t,r){var a=e.getIn(Te(t));return a&&(e=e.setIn(Te(t,"properties","conjunction"),r)),e},Mn=function(e,t,r,a,o,u){var i,l=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;if(r==="switch_group")throw new Error("Can't add switch_group programmatically");var s=e.getIn(Te(t));if(!s)return e;var c=(o==null||(i=o.get)===null||i===void 0?void 0:i.call(o,"id"))||a,d=u.settings,f=d.maxNumberOfCases,p=d.maxNumberOfRules,g=d.maxNesting,v=e.get("type"),m=v==="switch_group",h=m?e.getIn(Te(t.take(2))):null,O=Te(t,"children1"),b=e.getIn(O),S=!!b&&b.size,C=S?b.size:null,L,w;r==="case_group"?(L=C,w=f):r==="group"?(L=t.size,w=g):s?.get("type")==="rule_group"||(L=Zo(m?h:e),w=p);var N=w&&L?L<w:!0,V={type:r,id:c,properties:o};mh(u,V,l);var P=r==="case_group"&&S&&b.last().get("children1")==null;if(N){var M=new ye.default.OrderedMap((0,ne.A)({},c,new ye.default.Map(V)));if(!S)e=e.setIn(O,M);else if(P){var B=b.last(),_=new ye.default.OrderedMap((0,ne.A)((0,ne.A)({},c,new ye.default.Map(V)),B.get("id"),B));e=e.deleteIn(Te(O,"children1",B.get("id"))),e=e.mergeIn(O,_)}else e=e.mergeIn(O,M);e=Ht(e)}return e},qi=function(e,t){return e=e.deleteIn(Te(t)),e=Ht(e),e},sh=function(e,t,r,a,o){var u=Hn(e,t),i=t.pop(),l=t.size>1?Hn(e,i):null,s=l?l.get("children1"):null,c=Hn(e,r),d=a==zi||a==Hi?r:r.pop(),f=a==zi||a==Hi?c:r.size>1?Hn(e,d):null,p=f?f.get("children1"):null;if(!l||!f||!u)return e;var g=l.get("id")==f.get("id"),v=d.size<i.size&&qa(d.toArray(),i.toArray().slice(0,d.size)),m=d.size>i.size&&qa(i.toArray(),d.toArray().slice(0,i.size)),h=null,O=null;v?h=ye.default.List(i.toArray().slice(d.size)):m&&(O=ye.default.List(d.toArray().slice(i.size)));var b=p,S=s;return m||(S=S.delete(u.get("id"))),g?b=S:v&&(b=b.updateIn(Yo(h,"children1"),function(C){return S})),a==Zc||a==Xc?b=ye.default.OrderedMap().withMutations(function(C){var L=Ji(b.entries()),w;try{for(L.s();!(w=L.n()).done;){var N=(0,Le.A)(w.value,2),V=N[0],P=N[1];V==c?.get("id")&&a==Zc&&C.set(u.get("id"),u),C.set(V,P),V==c?.get("id")&&a==Xc&&C.set(u.get("id"),u)}}catch(M){L.e(M)}finally{L.f()}}):a==zi?b=b.merge(ye.default.OrderedMap((0,ne.A)({},u.get("id"),u))):a==Hi&&(b=ye.default.OrderedMap((0,ne.A)({},u.get("id"),u)).merge(b)),m&&(S=S.updateIn(Yo(O,"children1"),function(C){return b}),S=S.delete(u.get("id"))),!g&&!v&&(e=e.updateIn(Te(i,"children1"),function(C){return S})),m||(e=e.updateIn(Te(d,"children1"),function(C){return b})),e=Ht(e),e},ch=function(e,t,r,a){var o=e.getIn(Te(t));if(!o)return e;var u=a.settings.keepInputOnChangeFieldSrc,i=o.get("properties"),l=i?.get("field"),s=i?.get("fieldType"),c=Re(a,l),d=c?.type||s;(!d||d==="!group"||d==="!struct")&&(d=null);var f=!oo.includes(d),p=u&&!Ei(o,a)&&f;return p?(e=e.setIn(Te(t,"properties","field"),null),e=e.deleteIn(Te(t,"properties","fieldError")),e=e.setIn(Te(t,"properties","fieldType"),d)):e=e.setIn(Te(t,"properties"),rn(a,null,null,!1)),e=e.setIn(Te(t,"properties","fieldSrc"),r),e},dh=function(e,t,r,a,o,u,i,l,s){var c=arguments.length>9&&arguments[9]!==void 0?arguments[9]:{},d=t.getIn(Te(r));if(!d)return t;var f=a===-1,p=d.get("properties"),g=p.get("field"),v=p.get("value"),m=f?g:v.getIn([a]),h=[],O=m,b=Ji(o||[]),S;try{for(b.s();!(S=b.n()).done;){var C=(0,Le.A)(S.value,2),L=C[0],w=C[1];if(h.push([L,w,O]),L!==O.get("func")){var N=h.map(function(pe){var se=(0,Le.A)(pe,2),me=se[0],Ce=se[1];return"".concat(me,"(").concat(Ce,")")}).join("/")||"root";throw new Error("In ".concat(f?"LHS":"RHS"," for path ").concat(N," expected func key ").concat(L," but got ").concat(parent.get("func")))}O=O.getIn(["args",w,"value"])}}catch(pe){b.e(pe)}finally{b.f()}if(u){var M=O.get("func"),B=Wr(e,M),_=B.args,q=_[u];l==="!valueSrc"?O=Os(O,u,i,q,e):O=Fi(O,u,i,q,e)}else{var V=i,P=!0;O=hs(O,V,e,P),c.canDropArgs=!0}for(var K=O;h.length;){var J=h.pop(),U=(0,Le.A)(J,3),te=U[0],Q=U[1],ae=U[2],ce=Wr(e,te),ie=ce.args,le=ie[Q];K=Fi(ae,Q,K,le,e)}return f?id(t,r,K,e,s,c):ud(t,r,a,K,void 0,e,s,c)},id=function(e,t,r,a,o){var u,i,l,s,c=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},d=e.getIn(Te(t));if(!d)return{state:e};var f=c.isEndValue,p=c.canDropArgs;if(!r)return e=qi(e,t),{state:e};var g=a.settings,v=g.fieldSeparator,m=g.setOpOnChangeField,h=g.showErrorMessage;Array.isArray(r)&&(r=r.join(v));var O=d.get("type"),b=d.get("properties"),S=O=="rule_group",C=b?.get("fieldSrc"),L=Re(a,r);if(!L)return console.warn("No config for LHS ".concat(r)),{state:e};var w=L.type;(w==="!group"||w==="!struct")&&(w=null);var N=b?.get("operator"),V=b?.get("operatorOptions"),P=b?.get("field"),M=L.type=="!group",B=M&&L.mode=="array",_=S!=M,q=L&&((u=L.operators)===null||u===void 0?void 0:u.indexOf(N))!==-1?N:null,K=C==="func"&&(P==null||(i=P.get)===null||i===void 0?void 0:i.call(P,"func"))===((l=r)===null||l===void 0||(s=l.get)===null||s===void 0?void 0:s.call(l,"func")),J=K&&!!q,U=null,te=C==="func"?Ss(a,w):io(a,r);if(te&&te.length==1)U=te[0];else if(J)U=q;else if(te&&te.length>1){var Q=Ji(m),ae;try{for(Q.s();!(ae=Q.n()).done;){var ce=ae.value;if(ce=="keep"&&!_?U=q:ce=="default"?U=ci(a,r,!1):ce=="first"&&(U=Ci(a,r)),U)break}}catch(Pe){Q.e(Pe)}finally{Q.f()}}if(!M&&!L.operators)return console.warn("Type ".concat(L.type," is not supported")),{state:e};S&&!M&&(e=e.setIn(Te(t,"type"),"rule"),e=e.deleteIn(Te(t,"children1")),e=e.setIn(Te(t,"properties"),new ye.default.OrderedMap)),b||(e=e.setIn(Te(t,"properties"),new ye.default.OrderedMap));var ie=!h;if(M){e=e.setIn(Te(t,"type"),"rule_group");var le=Vn(a,a,b,r,U,"field",ie,f,p),pe=le.canReuseValue,se=le.newValue,me=le.newValueSrc,Ce=le.newValueType,ge=le.operatorCardinality,Ae=En(a,L).merge({field:r,fieldSrc:"field",mode:L.mode});B&&(Ae=Ae.merge({operator:U,value:se,valueSrc:me,valueType:Ce})),e=e.setIn(Te(t,"children1"),new ye.default.OrderedMap),e=e.setIn(Te(t,"properties"),Ae),L.initialEmptyWhere&&ge==1||(e=Mn(e,t,"rule",cr(),rn(a,r),a)),e=Ht(e)}else e=e.updateIn(Te(t,"properties"),function(Pe){return Pe.withMutations(function(Ve){var Ie=Vn(a,a,Ve,r,U,"field",ie,f,p),De=Ie.canReuseValue,Ee=Ie.newValue,Ne=Ie.newValueSrc,Xe=Ie.newValueType,ar=Ie.newValueError,Ze=Ie.newFieldError,Xr=Ie.fixedField,Tr=r,Pr=Xr!==r;Pr&&(Tr=Xr),h&&(Ve=Ve.set("fieldError",Ze),Ve=Ve.set("valueError",ar));var or=De?V:Aa(a,U,Tr);return Ve=Ve.set("field",Tr).delete("fieldType").set("fieldSrc",C).set("operator",U).set("operatorOptions",or).set("value",Ee).set("valueSrc",Ne).set("valueType",Xe),De||(Ve=Ve.delete("asyncListValues")),Ve})});return{state:e}},fh=function(e,t,r,a){var o=e.getIn(Te(t));if(!o)return e;var u=a.settings.showErrorMessage,i=o.get("properties"),l=o.get("children1"),s=i.get("field"),c=i.get("fieldSrc"),d=Re(a,s),f=d?.type=="!group",p=lr(a,r,s),g=p?Br(p):null,v=!0;return e=e.updateIn(Te(t,"properties"),function(m){return m.withMutations(function(h){var O=h.get("field"),b=h.get("operatorOptions"),S=h.get("value",new ye.default.List),C=h.get("valueSrc",new ye.default.List),L=h.get("operator"),w=Vn(a,a,h,O,r,"operator",v),N=w.canReuseValue,V=w.newValue,P=w.newValueSrc,M=w.newValueType,B=w.newValueError;u&&(h=h.set("valueError",B));var _=N?b:Aa(a,r,O);return N||(h=h.delete("asyncListValues")),h.set("operator",r).set("operatorOptions",_).set("value",V).set("valueSrc",P).set("valueType",M)})}),f&&g==0&&l.size==0&&(e=Mn(e,t,"rule",cr(),rn(a,s),a)),e},ud=function(e,t,r,a,o,u,i){var l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:{},s=e.getIn(Te(t));if(!s)return{state:e};var c=l.canDropArgs,d=l.isEndValue,f=u.settings,p=f.fieldSeparator,g=f.showErrorMessage,v=e.getIn(Te(t,"properties","valueSrc",r+""))||null;v==="field"&&Array.isArray(a)&&(a=a.join(p));var m=e.getIn(Te(t,"properties","field"))||null,h=e.getIn(Te(t,"properties","operator"))||null,O=lr(u,h,m),b=h?Br(O):null,S=o||Fs(a,v,u),C=!g,L=Xn(u,m,m,h,a,S,v,i,C,d,c),w=(0,Le.A)(L,2),N=w[0],V=w[1],P=V?.find(function(ae){return!ae.fixed&&!ae.ignore}),M=P?Jt(P):null,B=N!==a;B&&(a=N),e=ld(e,t,u,b);var _=Array.from({length:b},function(ae,ce){return ce==r?a:e.getIn(Te(t,"properties","value",ce+""))||null}),q=Array.from({length:b},function(ae,ce){return e.getIn(Te(t,"properties","valueSrc",ce+""))||null}),K=bi(u,m,h,_,q),J=K?Jt(K):null,U=!M&&!J,te=g?!0:U||B;if(te&&(e=e.deleteIn(Te(t,"properties","asyncListValues")),typeof a>"u"?(e=e.setIn(Te(t,"properties","value",r),void 0),e=e.setIn(Te(t,"properties","valueType",r),null)):(i&&(e=e.setIn(Te(t,"properties","asyncListValues"),i)),e=e.setIn(Te(t,"properties","value",r),a),e=e.setIn(Te(t,"properties","valueType",r),S))),g){var Q=e.getIn(Te(t,"properties","valueError"));Q||(e=e.setIn(Te(t,"properties","valueError"),new ye.default.List(new Array(b)))),e=e.setIn(Te(t,"properties","valueError",r),M),b>=2&&(e=e.setIn(Te(t,"properties","valueError",b),J))}return{state:e}},ph=function(e,t,r,a,o){var u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},i=e.getIn(Te(t));if(!i)return e;var l=o.settings.showErrorMessage,s=e.getIn(Te(t,"properties","field"))||null,c=e.getIn(Te(t,"properties","operator"))||null,d=lr(o,c,s),f=c?Br(d):null;if(e=ld(e,t,o,f),e=e.setIn(Te(t,"properties","value",r+""),void 0),e=e.setIn(Te(t,"properties","valueType",r+""),null),e=e.deleteIn(Te(t,"properties","asyncListValues")),l&&(e=e.setIn(Te(t,"properties","valueError",r),null),d.validateValues&&(e=e.setIn(Te(t,"properties","valueError",f),null))),typeof a>"u"?e=e.setIn(Te(t,"properties","valueSrc",r+""),null):e=e.setIn(Te(t,"properties","valueSrc",r+""),a),a){var p=e.getIn(Te(t,"properties")),g=!0,v=Vn(o,o,p,s,c,"valueSrc",g),m=v.canReuseValue,h=v.newValue,O=v.newValueSrc,b=v.newValueType,S=v.newValueError;!m&&O.get(r)==a&&(e=e.setIn(Te(t,"properties","value",r+""),h.get(r)),e=e.setIn(Te(t,"properties","valueType",r+""),b.get(r)))}return e},vh=function(e,t,r,a){var o=e.getIn(Te(t));return o?e.setIn(Te(t,"properties","operatorOptions",r),a):e},gh=function(e,t){var r=t.settings.canLeaveEmptyGroup;return r||(e=to(e)),e},ld=function(e,t,r,a){if(!a){var o=e.getIn(Te(t,"properties","field"))||null,u=e.getIn(Te(t,"properties","operator"))||null,i=lr(r,u,o);a=u?Br(i):null}for(var l=0,s=["value","valueType","valueError","valueSrc"];l<s.length;l++){var c=s[l];e.getIn(Te(t,"properties",c))||(e=e.setIn(Te(t,"properties",c),new ye.default.List(a?Array.from({length:a}):[])))}return e},mh=function n(e,t,r){r&&Array.isArray(r)&&(t.children1=new ye.default.OrderedMap(r.reduce(function(a,o){var u,i=(u=o.id)!==null&&u!==void 0?u:cr(),l=on(on({},o),{},{properties:bl(e,o).merge((0,ye.fromJS)(o.properties)||{}),id:i});return n(e,l,l.children1),on(on({},a),{},(0,ne.A)({},i,new ye.default.Map(l)))},{})))},hh=function(e,t){var r=e.getIn(Te(t,"properties","field"))||null;return r},sd={dragging:{id:null,x:null,y:null,w:null,h:null},mousePos:{},dragStart:{id:null}},yh=function(e,t){if(!e||!e.type)return null;var r=["config","asyncListValues"],a=[Ki,rd,ed,td],o=mo()(Za()(e,r),Ko),u=e.path&&hh(t.tree,e.path)||e.field;if(u){var i;(i=u)!==null&&i!==void 0&&i.toJS&&(u=u.toJS()),o.affectedField=u}return(a.includes(e.type)||e.type.indexOf("@@redux")==0)&&(o=null),o};const Oh=function(n,e,t,r,a){var o=e,u=on({tree:o},sd);return function(){var i,l,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:u,c=arguments.length>1?arguments[1]:void 0,d=(i=(l=a?.())!==null&&l!==void 0?l:c?.config)!==null&&i!==void 0?i:n,f={__lastAction:void 0},p={},g=yh(c,s);switch(c?.type){case Ki:{var v=t(d,c.tree);p.tree=v;break}case Wi:{p.tree=od(s.tree,c.path,"case_group",c.id,c.properties,d,c.children,c.meta);break}case kc:{p.tree=od(s.tree,c.path,"group",c.id,c.properties,d,c.children,c.meta);break}case _c:{p.tree=ah(s.tree,c.path,d);break}case Uc:{p.tree=Mn(s.tree,c.path,c.ruleType,c.id,c.properties,d,c.children);break}case Bc:{p.tree=oh(s.tree,c.path,d);break}case Mc:{p.tree=lh(s.tree,c.path,c.conjunction);break}case Gc:{p.tree=ih(s.tree,c.path,c.not);break}case $c:{var m=id(s.tree,c.path,c.field,d,c.asyncListValues,c._meta),h=m.state;p.tree=h;break}case Wc:{p.tree=ch(s.tree,c.path,c.srcKey,d);break}case Qc:{p.tree=uh(s.tree,c.path,c.lock);break}case Kc:{p.tree=fh(s.tree,c.path,c.operator,d);break}case zc:{var O=ud(s.tree,c.path,c.delta,c.value,c.valueType,d,c.asyncListValues,c._meta),b=O.state;p.tree=b;break}case Jc:{var S=dh(d,s.tree,c.path,c.delta,c.parentFuncs,c.argKey,c.value,c.valueType,c.asyncListValues,c._meta),C=S.state;p.tree=C;break}case Hc:{p.tree=ph(s.tree,c.path,c.delta,c.srcKey,d,c._meta);break}case qc:{p.tree=vh(s.tree,c.path,c.name,c.value);break}case Yc:{p.tree=sh(s.tree,c.fromPath,c.toPath,c.placement,d);break}case rd:{p.dragStart=c.dragStart,p.dragging=c.dragging,p.mousePos=c.mousePos;break}case ed:{p.mousePos=c.mousePos,p.dragging=c.dragging;break}case td:{p.tree=gh(s.tree,d),p=on(on({},p),sd);break}default:break}return g&&(p.__lastAction=g),r&&p.tree&&s.tree&&r(s.tree),on(on(on({},s),f),p)}};var bh=function(e,t){return{type:Ki,tree:t,config:e}},Sh=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"rule",o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null;return{type:Uc,ruleType:a,children:o,path:$r(t),id:cr(),properties:rn(e,u).merge((0,ye.fromJS)(r)||{}),config:e}},Fh=function(e,t){return{type:Bc,path:$r(t),config:e}},Ch=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;return{type:Wi,path:$r(t),children:a,id:cr(),properties:En(e).merge((0,ye.fromJS)(r)||{}),config:e,meta:{isDefaultCase:!0}}},Th=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;return{type:Wi,path:$r(t),children:a,id:cr(),properties:En(e).merge((0,ye.fromJS)(r)||{}),config:e}},Eh=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;return{type:kc,path:$r(t),children:a,id:cr(),properties:En(e).merge((0,ye.fromJS)(r)||{}),config:e}},Ah=function(e,t){return{type:_c,path:$r(t),config:e}},Lh=function(e,t,r,a){return{type:Yc,fromPath:$r(t),toPath:$r(r),placement:a,config:e}},wh=function(e,t,r){return{type:Mc,path:$r(t),conjunction:r}},jh=function(e,t,r){return{type:Gc,path:$r(t),not:r}},Rh=function(e,t,r){return{type:Qc,path:$r(t),lock:r}},Ph=function(e,t,r,a,o){return{type:$c,path:$r(t),field:r,config:e,asyncListValues:a,_meta:o}},xh=function(e,t,r){return{type:Wc,path:$r(t),srcKey:r,config:e}},Ih=function(e,t,r){return{type:Kc,path:$r(t),operator:r,config:e}},Vh=function(e,t,r,a,o,u,i){return{type:zc,path:$r(t),delta:r,value:a,valueType:o,asyncListValues:u,config:e,_meta:i}},Dh=function(e,t,r,a,o){return{type:Hc,path:$r(t),delta:r,srcKey:a,config:e,_meta:o}},Nh=function(e,t,r,a,o,u,i,l,s){return{type:Jc,path:$r(t),delta:r,parentFuncs:a,argKey:o,value:u,valueType:i,asyncListValues:l,config:e,_meta:s}},kh=function(e,t,r,a){return{type:qc,path:$r(t),name:r,value:a,config:e}};function cd(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Qi(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?cd(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):cd(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var Ye=Qi(Qi(Qi({},Y),{},{Export:X,Import:z,ConfigMixins:rh},X),z),_h=y(5556),R=y.n(_h);const Mh=Oh,Pa=F.createContext();var Gh=y(14644),Uh=y(19888),Bh=y(69242),$h=y(40961);function Wh(n){n()}let dd=Wh;const Kh=n=>dd=n,zh=()=>dd,fd=Symbol.for("react-redux-context"),pd=typeof globalThis<"u"?globalThis:{};function Hh(){var n;if(!F.createContext)return{};const e=(n=pd[fd])!=null?n:pd[fd]=new Map;let t=e.get(F.createContext);return t||(t=F.createContext(null),e.set(F.createContext,t)),t}const vd=Hh(),qb=null;function Qb(n=ReactReduxContext){return function(){return useContext(n)}}const Yb=null;let gd=null;const Jh=n=>{gd=n},qh=(n,e)=>n===e;function Xb(n=ReactReduxContext){const e=n===ReactReduxContext?useDefaultReduxContext:createReduxContextHook(n);return function(r,a={}){const{equalityFn:o=qh,stabilityCheck:u=void 0,noopCheck:i=void 0}=typeof a=="function"?{equalityFn:a}:a,{store:l,subscription:s,getServerState:c,stabilityCheck:d,noopCheck:f}=e(),p=useRef(!0),g=useCallback({[r.name](m){return r(m)}}[r.name],[r,d,u]),v=gd(s.addNestedSub,l.getState,c||l.getState,g,o);return useDebugValue(v),v}}const Zb=null;var nr=y(58168),md=y(98587),Qh=y(4146),hd=y.n(Qh),Yh=y(44363);const Xh=["initMapStateToProps","initMapDispatchToProps","initMergeProps"];function Zh(n,e,t,r,{areStatesEqual:a,areOwnPropsEqual:o,areStatePropsEqual:u}){let i=!1,l,s,c,d,f;function p(O,b){return l=O,s=b,c=n(l,s),d=e(r,s),f=t(c,d,s),i=!0,f}function g(){return c=n(l,s),e.dependsOnOwnProps&&(d=e(r,s)),f=t(c,d,s),f}function v(){return n.dependsOnOwnProps&&(c=n(l,s)),e.dependsOnOwnProps&&(d=e(r,s)),f=t(c,d,s),f}function m(){const O=n(l,s),b=!u(O,c);return c=O,b&&(f=t(c,d,s)),f}function h(O,b){const S=!o(b,s),C=!a(O,l,b,s);return l=O,s=b,S&&C?g():S?v():C?m():f}return function(b,S){return i?h(b,S):p(b,S)}}function ey(n,e){let{initMapStateToProps:t,initMapDispatchToProps:r,initMergeProps:a}=e,o=(0,md.A)(e,Xh);const u=t(n,o),i=r(n,o),l=a(n,o);return Zh(u,i,l,n,o)}function ry(n,e){const t={};for(const r in n){const a=n[r];typeof a=="function"&&(t[r]=(...o)=>e(a(...o)))}return t}function Yi(n){return function(t){const r=n(t);function a(){return r}return a.dependsOnOwnProps=!1,a}}function yd(n){return n.dependsOnOwnProps?!!n.dependsOnOwnProps:n.length!==1}function Od(n,e){return function(r,{displayName:a}){const o=function(i,l){return o.dependsOnOwnProps?o.mapToProps(i,l):o.mapToProps(i,void 0)};return o.dependsOnOwnProps=!0,o.mapToProps=function(i,l){o.mapToProps=n,o.dependsOnOwnProps=yd(n);let s=o(i,l);return typeof s=="function"&&(o.mapToProps=s,o.dependsOnOwnProps=yd(s),s=o(i,l)),s},o}}function Xi(n,e){return(t,r)=>{throw new Error(`Invalid value of type ${typeof n} for ${e} argument when connecting component ${r.wrappedComponentName}.`)}}function ty(n){return n&&typeof n=="object"?Yi(e=>ry(n,e)):n?typeof n=="function"?Od(n,"mapDispatchToProps"):Xi(n,"mapDispatchToProps"):Yi(e=>({dispatch:e}))}function ny(n){return n?typeof n=="function"?Od(n,"mapStateToProps"):Xi(n,"mapStateToProps"):Yi(()=>({}))}function ay(n,e,t){return(0,nr.A)({},t,n,e)}function oy(n){return function(t,{displayName:r,areMergedPropsEqual:a}){let o=!1,u;return function(l,s,c){const d=n(l,s,c);return o?a(d,u)||(u=d):(o=!0,u=d),u}}}function iy(n){return n?typeof n=="function"?oy(n):Xi(n,"mergeProps"):()=>ay}function uy(){const n=zh();let e=null,t=null;return{clear(){e=null,t=null},notify(){n(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){let r=[],a=e;for(;a;)r.push(a),a=a.next;return r},subscribe(r){let a=!0,o=t={callback:r,next:null,prev:t};return o.prev?o.prev.next=o:e=o,function(){!a||e===null||(a=!1,o.next?o.next.prev=o.prev:t=o.prev,o.prev?o.prev.next=o.next:e=o.next)}}}}const bd={notify(){},get:()=>[]};function Sd(n,e){let t,r=bd,a=0,o=!1;function u(v){c();const m=r.subscribe(v);let h=!1;return()=>{h||(h=!0,m(),d())}}function i(){r.notify()}function l(){g.onStateChange&&g.onStateChange()}function s(){return o}function c(){a++,t||(t=e?e.addNestedSub(l):n.subscribe(l),r=uy())}function d(){a--,t&&a===0&&(t(),t=void 0,r.clear(),r=bd)}function f(){o||(o=!0,c())}function p(){o&&(o=!1,d())}const g={addNestedSub:u,notifyNestedSubs:i,handleChangeWrapper:l,isSubscribed:s,trySubscribe:f,tryUnsubscribe:p,getListeners:()=>r};return g}const ho=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?F.useLayoutEffect:F.useEffect;function Fd(n,e){return n===e?n!==0||e!==0||1/n===1/e:n!==n&&e!==e}function Zi(n,e){if(Fd(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;const t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(let a=0;a<t.length;a++)if(!Object.prototype.hasOwnProperty.call(e,t[a])||!Fd(n[t[a]],e[t[a]]))return!1;return!0}const ly=()=>{throw new Error("uSES not initialized!")},sy=["reactReduxForwardedRef"];let Cd=ly;const cy=n=>{Cd=n},dy=null,fy=[null,null],rS=n=>{try{return JSON.stringify(n)}catch{return String(n)}};function py(n,e,t){ho(()=>n(...e),t)}function vy(n,e,t,r,a,o){n.current=r,t.current=!1,a.current&&(a.current=null,o())}function gy(n,e,t,r,a,o,u,i,l,s,c){if(!n)return()=>{};let d=!1,f=null;const p=()=>{if(d||!i.current)return;const v=e.getState();let m,h;try{m=r(v,a.current)}catch(O){h=O,f=O}h||(f=null),m===o.current?u.current||s():(o.current=m,l.current=m,u.current=!0,c())};return t.onStateChange=p,t.trySubscribe(),p(),()=>{if(d=!0,t.tryUnsubscribe(),t.onStateChange=null,f)throw f}}const tS=()=>dy;function my(n,e){return n===e}let nS=!1;function hy(n,e,t,{pure:r,areStatesEqual:a=my,areOwnPropsEqual:o=Zi,areStatePropsEqual:u=Zi,areMergedPropsEqual:i=Zi,forwardRef:l=!1,context:s=vd}={}){const c=s,d=ny(n),f=ty(e),p=iy(t),g=!!n;return m=>{const h=m.displayName||m.name||"Component",O=`Connect(${h})`,b={shouldHandleStateChanges:g,displayName:O,wrappedComponentName:h,WrappedComponent:m,initMapStateToProps:d,initMapDispatchToProps:f,initMergeProps:p,areStatesEqual:a,areStatePropsEqual:u,areOwnPropsEqual:o,areMergedPropsEqual:i};function S(w){const[N,V,P]=F.useMemo(()=>{const{reactReduxForwardedRef:De}=w,Ee=(0,md.A)(w,sy);return[w.context,De,Ee]},[w]),M=F.useMemo(()=>N&&N.Consumer&&(0,Yh.isContextConsumer)(F.createElement(N.Consumer,null))?N:c,[N,c]),B=F.useContext(M),_=!!w.store&&!!w.store.getState&&!!w.store.dispatch,q=!!B&&!!B.store,K=_?w.store:B.store,J=q?B.getServerState:K.getState,U=F.useMemo(()=>ey(K.dispatch,b),[K]),[te,Q]=F.useMemo(()=>{if(!g)return fy;const De=Sd(K,_?void 0:B.subscription),Ee=De.notifyNestedSubs.bind(De);return[De,Ee]},[K,_,B]),ae=F.useMemo(()=>_?B:(0,nr.A)({},B,{subscription:te}),[_,B,te]),ce=F.useRef(),ie=F.useRef(P),le=F.useRef(),pe=F.useRef(!1),se=F.useRef(!1),me=F.useRef(!1),Ce=F.useRef();ho(()=>(me.current=!0,()=>{me.current=!1}),[]);const ge=F.useMemo(()=>()=>le.current&&P===ie.current?le.current:U(K.getState(),P),[K,P]),Ae=F.useMemo(()=>Ee=>te?gy(g,K,te,U,ie,ce,pe,me,le,Q,Ee):()=>{},[te]);py(vy,[ie,ce,pe,P,le,Q]);let Pe;try{Pe=Cd(Ae,ge,J?()=>U(J(),P):ge)}catch(De){throw Ce.current&&(De.message+=`
The error may be correlated with this previous error:
${Ce.current.stack}

`),De}ho(()=>{Ce.current=void 0,le.current=void 0,ce.current=Pe});const Ve=F.useMemo(()=>F.createElement(m,(0,nr.A)({},Pe,{ref:V})),[V,m,Pe]);return F.useMemo(()=>g?F.createElement(M.Provider,{value:ae},Ve):Ve,[M,Ve,ae])}const L=F.memo(S);if(L.WrappedComponent=m,L.displayName=S.displayName=O,l){const N=F.forwardRef(function(P,M){return F.createElement(L,(0,nr.A)({},P,{reactReduxForwardedRef:M}))});return N.displayName=O,N.WrappedComponent=m,hd()(N,m)}return hd()(L,m)}}const yo=hy;function yy({store:n,context:e,children:t,serverState:r,stabilityCheck:a="once",noopCheck:o="once"}){const u=F.useMemo(()=>{const s=Sd(n);return{store:n,subscription:s,getServerState:r?()=>r:void 0,stabilityCheck:a,noopCheck:o}},[n,r,a,o]),i=F.useMemo(()=>n.getState(),[n]);ho(()=>{const{subscription:s}=u;return s.onStateChange=s.notifyNestedSubs,s.trySubscribe(),i!==n.getState()&&s.notifyNestedSubs(),()=>{s.tryUnsubscribe(),s.onStateChange=void 0}},[u,i]);const l=e||vd;return F.createElement(l.Provider,{value:u},t)}const Oy=yy;function aS(n=ReactReduxContext){const e=n===ReactReduxContext?useDefaultReduxContext:createReduxContextHook(n);return function(){const{store:r}=e();return r}}const oS=null;function iS(n=ReactReduxContext){const e=n===ReactReduxContext?useDefaultStore:createStoreHook(n);return function(){return e().dispatch}}const uS=null;Jh(Bh.useSyncExternalStoreWithSelector),cy(Uh.useSyncExternalStore),Kh($h.unstable_batchedUpdates);var lS="ADD_GROUP",sS="ADD_CASE_GROUP",cS="REMOVE_GROUP",dS="SET_CONJUNCTION",fS="SET_NOT",pS="ADD_RULE",vS="REMOVE_RULE",gS="SET_FIELD",mS="SET_FIELD_SRC",hS="SET_OPERATOR",yS="SET_VALUE",OS="SET_VALUE_SRC",bS="SET_OPERATOR_OPTION",SS="SET_LOCK",FS="SET_TREE",CS="MOVE_ITEM",Oo="after",bo="before",Gn="append",na="prepend",by="SET_DRAG_PROGRESS",Sy="SET_DRAG_START",Fy="SET_DRAG_END",Cy=function(e,t){return{type:by,mousePos:e,dragging:t}},Ty=function(e,t,r){return{type:Sy,dragStart:e,dragging:t,mousePos:r}},Ey=function(){return{type:Fy}},Td=de,Ay=H,Ly=Oe,wy=function(e){var t;return(t=e?.cardinality)!==null&&t!==void 0?t:1},So=function(e,t,r){if(!t||!e||e.length<=t)return e;var a=e.substr(0,t-1);return(r?a.substr(0,a.lastIndexOf(" ")):a)+"..."},Un=function(e,t){return e===t?!0:e?.equals(t)},Bn=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return e===t?!0:Array.isArray(e)?jy(e,t,r):e&&typeof e.equals=="function"?e.equals(t):(0,Cr.A)(e)==="object"?Ry(e,t,r):e===t};function jy(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(n===e)return!0;if(!n||!e)return!1;var r=n.length;if(e.length!==r)return!1;for(var a=0;a<r;a++){var o=t?Bn(n[a],e[a],t):n[a]===e[a];if(!o)return!1}return!0}function Ry(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(n===e)return!0;if(!n||!e)return!1;var r=Object.keys(n),a=Object.keys(e),o=r.length;if(a.length!==o)return!1;for(var u=0;u<o;u++){var i=r[u],l=t?Bn(n[i],e[i],t):n[i]===e[i];if(!l)return!1}return!0}var Py=function(){return typeof process<"u"&&process.env&&!1},xy=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=e??Py();return t?console:{error:function(){},log:function(){},warn:function(){},debug:function(){},info:function(){}}},Iy=xy(),Ed=Ye.Validation.validateAndFixTree,Vy=function(){var e,t,r;return function(a,o){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;return o?(a.__configId===r&&(Un(o,e)||Un(o,t))||(r=a.__configId,e=o,i===!1?t=Ed(o,null,a,u||a,!1,!1,!1):t=Ed(o,null,a,u||a)),t):null}},Dy=function(e){if(e._reactRootContainer)return"root";if(Object.getOwnPropertyNames(e).filter(function(t){return t.startsWith("__reactContainer")}).length>0)return"container"},Ny=function n(e){if(e){var t=Dy(e);return t!==void 0?t:n(e.parentNode)}},Ad=function(e){return Ny(e)==="root"},Fo=function(e,t){return function(r,a){var o=e.props,u=e.state,i=r!=o||a!=u;if(i&&u==a&&o!=r){var l=[];for(var s in r){var c=r[s]!=o[s];c&&(t[s]=="ignore"?c=!1:t[s]=="shallow_deep"?c=!Bn(r[s],o[s],!0):t[s]=="shallow"?c=!Bn(r[s],o[s]):typeof t[s]=="function"&&(c=t[s](r[s],o[s],r,o))),c&&l.push(s)}l.length||(i=!1)}return i}},aa=function(e){return function(t,r){return!Bn(e.props,t)||!Bn(e.state,r)}},ky=function(){var e=F.version.split(".").map(parseInt.bind(null,10));return e[0]==16&&e[1]<3||e[0]<16},ht=function(e){if(e.shouldComponentUpdate||(e.shouldComponentUpdate=aa(e)),ky())e.componentWillReceiveProps=function(a){e.onPropsChanged(a)};else{var t=e.shouldComponentUpdate,r=function(o,u){var i=!Bn(e.props,o);i&&e.onPropsChanged(o);var l=t.call(e,o,u);return l};e.shouldComponentUpdate=r.bind(e)}},Ld=function(e,t,r){return mo()(e,function(a){return function(){for(var o=arguments.length,u=new Array(o),i=0;i<o;i++)u[i]=arguments[i];return r(a.apply(void 0,[t].concat(u)))}})};function wd(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function eu(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?wd(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):wd(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function _y(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,jd()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function jd(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(jd=function(){return!!n})()}var Rd=function(n){function e(t){var r;(0,mr.A)(this,e),r=_y(this,e,[t]),r.shouldComponentUpdate=Fo(r,{tree:function(u){return!(u===r.oldValidatedTree&&r.oldValidatedTree===r.validatedTree)}}),ht(r),r._updateActions(t),r.validatedTree=t.getMemoizedTree(t.config,t.tree,void 0,t.sanitizeTree),r.oldValidatedTree=r.validatedTree;var a=t.getBasicConfig(t.config);return t.onInit&&t.onInit(r.validatedTree,a,void 0,r.actions),r}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"_updateActions",value:function(r){var a=r.config,o=r.dispatch;this.actions=Ld(eu(eu(eu({},Td),Ay),Ly),a,o)}},{key:"onPropsChanged",value:function(r){var a=r.onChange,o=this.props.config,u=r.tree,i=this.props.tree,l=r.config;this.oldValidatedTree=this.validatedTree,this.validatedTree=u,o!==l&&(this._updateActions(r),this.validatedTree=r.getMemoizedTree(l,u,o));var s=!Un(this.validatedTree,this.oldValidatedTree);if(s){var c=r.getBasicConfig(l);a&&a(this.validatedTree,c,r.__lastAction,this.actions)}}},{key:"render",value:function(){var r=this.props,a=r.config,o=r.renderBuilder,u=r.dispatch,i={tree:this.validatedTree,actions:this.actions,config:a,dispatch:u};return o(i)}}])}(F.Component);Rd.propTypes={config:R().object.isRequired,onChange:R().func,onInit:R().func,renderBuilder:R().func,tree:R().any};var Pd=yo(function(n){return{tree:n.tree,__lastAction:n.__lastAction}},null,null,{context:Pa})(Rd);Pd.displayName="ConnectedQuery";const My=Pd;function Gy(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,xd()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function xd(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(xd=function(){return!!n})()}var Id=Ye.DefaultUtils.defaultRoot,Uy=Ye.ConfigUtils.createConfigMemo,Vd=function(n){function e(t,r){var a,o,u;(0,mr.A)(this,e),u=Gy(this,e,[t,r]),u.setLastTree=function(S){u.prevTree&&(u.prevprevTree=u.prevTree),u.prevTree=S},u.getConfig=function(){return u.config},u.shouldComponentUpdate=Fo(u,{value:function(C,L){return!1}}),ht(u);var i=Uy({reactIndex:(a=(o=u._reactInternals)===null||o===void 0?void 0:o.index)!==null&&a!==void 0?a:-1,maxSize:2,canCompile:!0}),l=i.getExtendedConfig,s=i.getBasicConfig,c=i.clearConfigMemo;u.getMemoizedConfig=l,u.getBasicConfig=s,u.clearConfigMemo=c,u.getMemoizedTree=Vy();var d=u.getMemoizedConfig(t),f=d.settings.shouldCreateEmptyGroup,p=!f,g=Id(d,p),v=!!t.value,m=t.value||g,h=u.getMemoizedTree(d,m,void 0,v),O=Mh(d,h,u.getMemoizedTree,u.setLastTree,u.getConfig),b=(0,Gh.createStore)(O);return u.config=d,u.state={store:b},u.QueryWrapper=function(S){return d.settings.renderProvider(S,d.ctx)},u}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"componentWillUnmount",value:function(){this.clearConfigMemo()}},{key:"onPropsChanged",value:function(r){var a=this.props,o=this.config,u=this.getMemoizedConfig(r),i=o!==u,l=this.state.store.getState().tree,s=!Un(r.value,this.props.value)&&!Un(r.value,l),c=s?r.value||Id(r):l,d=s&&!Un(r.value,this.prevTree)&&!Un(r.value,this.prevprevTree);if(this.sanitizeTree=d||i,i&&(a.settings.renderProvider!==r.settings.renderProvider&&(this.QueryWrapper=function(p){return u.settings.renderProvider(p,u.ctx)}),this.config=u),s||i){var f=this.getMemoizedTree(u,c,o,this.sanitizeTree);this.state.store.dispatch(Td.setTree(u,f))}}},{key:"render",value:function(){var r=this.props,a=r.renderBuilder,o=r.get_children,u=r.onChange,i=r.onInit,l=this.state.store,s=this.config,c=this.QueryWrapper;return F.createElement(c,{config:s},F.createElement(Oy,{store:l,context:Pa},F.createElement(My,{config:s,getMemoizedTree:this.getMemoizedTree,getBasicConfig:this.getBasicConfig,sanitizeTree:this.sanitizeTree,onChange:u,onInit:i,renderBuilder:a||o})))}}])}(F.Component);Vd.propTypes={conjunctions:R().object.isRequired,fields:R().object.isRequired,types:R().object.isRequired,operators:R().object.isRequired,widgets:R().object.isRequired,settings:R().object.isRequired,ctx:R().object.isRequired,onChange:R().func,onInit:R().func,renderBuilder:R().func,value:R().any};var By=y(46942),Mt=y.n(By);function $y(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,Dd()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function Dd(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Dd=function(){return!!n})()}var Wy=Ye.ConfigUtils.getFieldConfig,Ky=function(e){var t;return t=function(r){function a(o){var u;return(0,mr.A)(this,a),u=$y(this,a,[o]),u.dummyFn=function(){},u.removeSelf=function(){u.props.actions.removeRule(u.props.path)},u.setLock=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;u.props.actions.setLock(u.props.path,i)},u.setField=function(i,l,s){u.props.actions.setField(u.props.path,i,l,s)},u.setFieldSrc=function(i){u.props.actions.setFieldSrc(u.props.path,i)},u.setOperator=function(i){u.props.actions.setOperator(u.props.path,i)},u.setOperatorOption=function(i,l){u.props.actions.setOperatorOption(u.props.path,i,l)},u.setValue=function(i,l,s,c,d){u.props.actions.setValue(u.props.path,i,l,s,c,d)},u.setValueSrc=function(i,l,s){u.props.actions.setValueSrc(u.props.path,i,l,s)},u.setFuncValue=function(i,l,s,c,d,f,p){u.props.actions.setFuncValue(u.props.path,i,l,s,c,d,f,p)},u.pureShouldComponentUpdate=aa(u),u.dummyFn.isDummyFn=!0,u}return(0,yr.A)(a,r),(0,hr.A)(a,[{key:"shouldComponentUpdate",value:function(u,i){var l=this.props,s=this.state,c=this.pureShouldComponentUpdate(u,i);if(c&&s==i&&l!=u){var d=u.dragging.id||l.dragging.id,f=d==u.id,p=[];for(var g in u){var v=u[g]!=l[g];g=="dragging"&&!f&&(v=!1),v&&p.push(g)}p.length||(c=!1)}return c}},{key:"render",value:function(){var u=this.props.dragging.id==this.props.id,i=Wy(this.props.config,this.props.field),l=this.props.fieldType||i?.type||null,s=this.props.config.settings.showErrorMessage,c=i&&i.type=="!struct",d=!u&&this.props.isDraggingTempo,f=this.props,p=f.valueError,g=f.fieldError,v=[g].concat((0,Fe.A)(p?.toArray()||[])).filter(function(h){return!!h}).shift()||null,m=v!=null&&s;return F.createElement("div",{className:Mt()("group-or-rule-container","rule-container",m?"rule-with-error":null),"data-id":this.props.id},[u?F.createElement(e,{key:"dragging",id:this.props.id,groupId:this.props.groupId,isDraggingMe:!0,isDraggingTempo:!0,dragging:this.props.dragging,setField:this.dummyFn,setFieldSrc:this.dummyFn,setFuncValue:this.dummyFn,setOperator:this.dummyFn,setOperatorOption:this.dummyFn,setLock:this.dummyFn,removeSelf:this.dummyFn,setValue:this.dummyFn,setValueSrc:this.dummyFn,selectedField:this.props.field||null,selectedFieldSrc:this.props.fieldSrc||"field",selectedFieldType:l,parentField:this.props.parentField||null,selectedOperator:this.props.operator||null,value:this.props.value||null,valueSrc:this.props.valueSrc||null,valueType:this.props.valueType||null,valueError:this.props.valueError||null,fieldError:this.props.fieldError||null,operatorOptions:this.props.operatorOptions,config:this.props.config,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,asyncListValues:this.props.asyncListValues,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt}):null,F.createElement(e,{key:this.props.id,id:this.props.id,groupId:this.props.groupId,isDraggingMe:u,isDraggingTempo:d,onDragStart:this.props.onDragStart,setLock:d?this.dummyFn:this.setLock,removeSelf:d?this.dummyFn:this.removeSelf,setField:d?this.dummyFn:this.setField,setFieldSrc:d?this.dummyFn:this.setFieldSrc,setFuncValue:d?this.dummyFn:this.setFuncValue,setOperator:d?this.dummyFn:this.setOperator,setOperatorOption:d?this.dummyFn:this.setOperatorOption,setValue:d?this.dummyFn:this.setValue,setValueSrc:d?this.dummyFn:this.setValueSrc,selectedField:this.props.field||null,selectedFieldSrc:this.props.fieldSrc||"field",selectedFieldType:l,parentField:this.props.parentField||null,selectedOperator:this.props.operator||null,value:this.props.value||null,valueSrc:this.props.valueSrc||null,valueType:this.props.valueType||null,valueError:this.props.valueError||null,fieldError:this.props.fieldError||null,operatorOptions:this.props.operatorOptions,config:this.props.config,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,asyncListValues:this.props.asyncListValues,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt})])}}])}(F.Component),t.propTypes={id:R().string.isRequired,groupId:R().string,config:R().object.isRequired,path:R().any.isRequired,operator:R().string,field:R().any,fieldSrc:R().string,fieldType:R().string,actions:R().object.isRequired,onDragStart:R().func,value:R().any,valueSrc:R().any,asyncListValues:R().array,valueError:R().any,fieldError:R().string,operatorOptions:R().object,reordableNodesCnt:R().number,parentField:R().string,isLocked:R().bool,isTrueLocked:R().bool,dragging:R().object,isDraggingTempo:R().bool},t};const zy=function(n){var e=yo(function(t){return{dragging:t.dragging}},null,null,{context:Pa})(Ky(n));return e.displayName="ConnectedRuleContainer",e};function Hy(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,Nd()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function Nd(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Nd=function(){return!!n})()}var kd=Ye.clone,Jy=Ye.TreeUtils.getFlatTree,ru=!1,qy=function(e){var t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return t=function(a){function o(u){var i;return(0,mr.A)(this,o),i=Hy(this,o,[u]),i._getEventTarget=function(l,s){return l&&l.__mocked_window||document.body||window},i.onDragStart=function(l,s,c){var d=s.closest(".query-builder");i._isUsingLegacyReactDomRender===void 0&&(i._isUsingLegacyReactDomRender=Ad(d)),document.body.classList.add("qb-dragging"),d.classList.add("qb-dragging");var f=d.closest(".query-builder-container")||d;f=i._getScrollParent(f)||document.body;var p=f.scrollTop,g=i._getDraggableNodeEl(d),v=i._getPlaceholderNodeEl(d),m=d.querySelectorAll(".group--children"),h=m.length?m[0]:null,O;h&&(O=window.getComputedStyle(h,null).getPropertyValue("padding-left"),O=parseInt(O));var b={id:l,x:s.offsetLeft,y:s.offsetTop,w:s.offsetWidth,h:s.offsetHeight,itemInfo:i.tree.items[l],paddingLeft:O},S={id:l,x:s.offsetLeft,y:s.offsetTop,scrollTop:p,clientX:c.clientX,clientY:c.clientY,itemInfo:kd(i.tree.items[l]),treeEl:d,treeElContainer:f},C={clientX:c.clientX,clientY:c.clientY},L=i._getEventTarget(c,S);i.eventTarget=L,L.addEventListener("mousemove",i.onDrag),L.addEventListener("mouseup",i.onDragEnd),i.props.setDragStart(S,b,C)},i.onDrag=function(l){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,c=Object.assign({},i.props.dragging),d=i.props.dragStart,f=c.paddingLeft,p=d.treeElContainer,g=p.scrollTop;if(c.itemInfo=i.tree.items[c.id],!!c.itemInfo){var v={clientX:l.clientX,clientY:l.clientY},m={clientX:d.clientX,clientY:d.clientY};if(l.__mock_dom){var h=d.treeEl,O=i._getDraggableNodeEl(h),b=i._getPlaceholderNodeEl(h);l.__mock_dom({treeEl:h,dragEl:O,plhEl:b})}if(!d.plX){var S=d.treeEl,C=i._getPlaceholderNodeEl(S);C&&(d.plX=C.getBoundingClientRect().left+window.scrollX,d.plY=C.getBoundingClientRect().top+window.scrollY)}var L=d.x,w=d.y,N=d.clientX,V=d.clientY,P=d.scrollTop,M={x:L+(l.clientX-N),y:w+(l.clientY-V)+(g-P)};c.x=M.x,c.y=M.y,c.paddingLeft=f,c.mousePos=v,c.startMousePos=m,i.props.setDragProgress(v,c);var B=s?i.handleDrag(c,l,r):!1;B||l.preventDefault&&l.preventDefault()}},i.onDragEnd=function(){var l=i.props.dragStart.treeEl;i.props.setDragEnd(),l.classList.remove("qb-dragging"),document.body.classList.remove("qb-dragging"),i._cacheEls={};var s=i.eventTarget||i._getEventTarget();s.removeEventListener("mousemove",i.onDrag),s.removeEventListener("mouseup",i.onDragEnd)},i.pureShouldComponentUpdate=aa(i),ht(i),i.onPropsChanged(u),i}return(0,yr.A)(o,a),(0,hr.A)(o,[{key:"onPropsChanged",value:function(i){this.tree=Jy(i.tree)}},{key:"shouldComponentUpdate",value:function(i,l){var s=this.props,c=this.state,d=this.pureShouldComponentUpdate(i,l);if(d&&c==l&&s!=i){var f=[];for(var p in i){var g=i[p]!=s[p];g&&p!="dragging"&&p!="mousePos"&&f.push(p)}f.length||(d=!1)}return d}},{key:"componentDidUpdate",value:function(i,l){var s=this.props.dragging,c=this.props.dragStart;if(ru=!1,c&&c.id&&(s.itemInfo=this.tree.items[s.id],s.itemInfo&&(s.itemInfo.index!=c.itemInfo.index||s.itemInfo.parent!=c.itemInfo.parent))){var d=c.treeEl,f=c.treeElContainer,p=this._getPlaceholderNodeEl(d,!0);if(p){var g=p.getBoundingClientRect().left+window.scrollX,v=p.getBoundingClientRect().top+window.scrollY,m=c.plX,h=c.plY,O=f.scrollTop;c.plX=g,c.plY=v,c.itemInfo=kd(s.itemInfo),c.y=p.offsetTop,c.x=p.offsetLeft,c.clientY+=v-h,c.clientX+=g-m,f!=document.body&&(c.scrollTop=O),this.onDrag(this.props.mousePos,!1)}}}},{key:"_getNodeElById",value:function(i,l){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(l==null)return null;this._cacheEls||(this._cacheEls={});var c=this._cacheEls[l];return c&&document.contains(c)&&!s||(c=i.querySelector('.group-or-rule-container[data-id="'+l+'"]'),this._cacheEls[l]=c),c}},{key:"_getDraggableNodeEl",value:function(i){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this._cacheEls||(this._cacheEls={});var s=this._cacheEls.draggable;if(s&&document.contains(s)&&!l)return s;var c=i.getElementsByClassName("qb-draggable");return s=c.length?c[0]:null,this._cacheEls.draggable=s,s}},{key:"_getPlaceholderNodeEl",value:function(i){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this._cacheEls||(this._cacheEls={});var s=this._cacheEls.placeholder;if(s&&document.contains(s)&&!l)return s;var c=i.getElementsByClassName("qb-placeholder");return s=c.length?c[0]:null,this._cacheEls.placeholder=s,s}},{key:"_isScrollable",value:function(i){var l=window.getComputedStyle(i)["overflow-y"];return(l==="scroll"||l==="auto")&&i.scrollHeight>i.offsetHeight}},{key:"_getScrollParent",value:function(i){return i==null?null:i===document.body||this._isScrollable(i)?i:this._getScrollParent(i.parentNode)}},{key:"handleDrag",value:function(i,l,s){var c=this,d=!0,f=i.itemInfo,p=i.paddingLeft,g=null,v=this.props.dragStart.treeEl,m=i.id,h=this._getDraggableNodeEl(v),O=this._getPlaceholderNodeEl(v),b,S,C,L;if(h&&O){if(b=h.getBoundingClientRect(),S=O.getBoundingClientRect(),!S.width)return;var w={hrz:0,vrt:0};b.top<S.top?w.vrt=-1:b.bottom>S.bottom&&(w.vrt=1),b.left>S.left?w.hrz=1:b.left<S.left&&(w.hrz=-1),L=v.getBoundingClientRect();var N={x:L.left+(L.right-L.left)/2,y:w.vrt>=0?b.bottom:b.top},V;if(l.__mocked_hov_container)V=l.__mocked_hov_container;else{var P=document.elementFromPoint(N.x,N.y-1);if(V=P?P.closest(".group-or-rule-container"):null,!V&&P&&P.classList.contains("query-builder-container")){var M,B=P==null||(M=P.firstChild)===null||M===void 0?void 0:M.firstChild;B&&B.classList.contains("group-or-rule-container")&&(V=B)}}if(!V)Iy.log("out of tree bounds!");else{var _=V.classList.contains("group-container"),q=V.getAttribute("data-id"),K=V,J=!1,U=!1;if(K){C=K.getBoundingClientRect();var te=C.bottom-C.top,Q=this.tree.items[q];if(!Q)throw new Error("There is an issue with rendering. If you use Next.js, please check getServerSideProps() method.");var ae=null,ce=null,ie=null,le=null;if(w.vrt==0)ie=f,ce=O,ce&&(ae=ce.getBoundingClientRect());else if(_){if(w.vrt>0){var pe=V.getElementsByClassName("group--header"),se=pe.length?pe[0]:null;if(se){var me=se.getBoundingClientRect(),Ce=me.bottom-me.top,ge=b.bottom-me.top>Ce*3/4;ge&&Q.top>i.itemInfo.top&&(ie=Q,ae=me,ce=se,U=!0)}}else if(w.vrt<0&&Q.lev>=f.lev){var Ae=C.bottom-b.top>=2;Ae&&Q.top<i.itemInfo.top&&(ie=Q,ae=C,ce=K,J=!0)}if(!U&&!J||d){var Pe=w.vrt<0?C.bottom-b.top>te-5:b.bottom-C.top>te-5;Pe&&(!U&&!J&&(ie=Q,ae=C,ce=K),d&&(le=Q))}}else{var Ve=w.vrt<0?C.bottom-b.top>te/2:b.bottom-C.top>te/2;Ve&&(ie=Q,ae=C,ce=K)}var Ie=ie&&ie.id==m;if(ae){var De=b.left-L.left,Ee=ae.left-L.left,Ne=Ee/p,Xe=Math.max(0,Math.round(De/p)),ar=[],Ze=[];if(!Ie){if(_&&(J?ar.push([Gn,ie,ie.lev+1]):U&&ar.push([na,ie,ie.lev+1]),d&&le)){var Xr=le.lev==0,Tr=le.type=="case_group"&&f.type!="case_group",Pr=le.prev&&this.tree.items[le.prev].caseId,or=le.next&&this.tree.items[le.next].caseId;f.caseId==Pr&&(Pr=null),f.caseId==or&&(or=null);var at=Pr&&this.tree.items[Pr],bt=or&&this.tree.items[or];w.vrt>0?Xr?Ze.push([Gn,le,le.lev+1]):Tr&&bt?Ze.push([na,bt,bt.lev+1]):Ze.push([Oo,le,le.lev]):w.vrt<0&&(Xr?Ze.push([na,le,le.lev+1]):Tr&&at?Ze.push([Gn,at,at.lev+1]):Ze.push([bo,le,le.lev]))}!J&&!U&&(w.vrt<0?ar.push([bo,ie,ie.lev]):w.vrt>0&&ar.push([Oo,ie,ie.lev]))}var ot=function(Zr){var Qr=Zr[1],Gr=f.caseId?c.tree.items[f.caseId]:null,ft=Qr.caseId?c.tree.items[Qr.caseId]:null;return[].concat((0,Fe.A)(Zr),[Gr,ft])};ar=ar.map(ot),Ze=Ze.map(ot),ar=ar.filter(function(ur){var Zr=ur[0],Qr=ur[1];if((Zr==bo||Zr==Oo)&&Qr.parent==null||Qr.collapsed&&(Zr==Gn||Zr==na))return!1;var Gr=Qr.id==f.id;if(!Gr){for(var ft=Qr;ft.parent;)if(ft=c.tree.items[ft.parent],ft.id==f.id){Gr=!0;break}}return!Gr}).map(function(ur){var Zr=ur[0],Qr=ur[1],Gr=ur[2],ft=ur[3],wn=ur[4],pt=null;return Zr==Gn||Zr==na?pt=Qr:pt=c.tree.items[Qr.parent],pt&&pt.parent==null&&(pt=null),ur[5]=pt,ur});var St=null,ir=ar.filter(function(ur){return c.canMove(f,ur[1],ur[0],ur[3],ur[4],ur[5],s)});d&&ir.length==0&&Ze.length>0&&(ir=Ze.filter(function(ur){return c.canMove(f,ur[1],ur[0],ur[3],ur[4],ur[5],s)}));var Lt=ir.map(function(ur){return ur[2]}),Vt=f.lev,Hr=Lt.concat(Vt),it=null;Hr.indexOf(Xe)!=-1?it=Xe:Xe>Math.max.apply(Math,(0,Fe.A)(Hr))?it=Math.max.apply(Math,(0,Fe.A)(Hr)):Xe<Math.min.apply(Math,(0,Fe.A)(Hr))&&(it=Math.min.apply(Math,(0,Fe.A)(Hr))),St=ir.find(function(ur){return ur[2]==it}),!Ie&&!St&&ir.length&&(St=ir[0]),g=St}}}}return g?(this.move(f,g[1],g[0],g[3]),!0):!1}},{key:"canMove",value:function(i,l,s,c,d,f,p){if(!i||!l||i.id===l.id)return!1;var g=this.props.config.settings,v=g.canRegroup,m=g.canRegroupCases,h=g.maxNesting,O=g.maxNumberOfRules,b=g.canLeaveEmptyCase,S=f?f.lev+1:l.lev,C=S+(i.depth||0),L=s==bo||s==Oo,w=s==na||s==Gn,N=L&&l.lev==1||w&&l.lev==0,V=i.parent!=l.parent,P=w||V,M=i.type=="case_group"&&!N||i.parentType=="rule_group"||l.type=="rule_group"||l.parentType=="rule_group"||i.type!="case_group"&&l.type=="case_group"&&L||i.type!="case_group"&&l.type=="switch_group"||!m&&i.caseId!=l.caseId,B=l.isLocked||i.isLocked||f&&f.isLocked;if(h&&C>h||P&&(!v||M||B))return!1;if(i.type!="case_group"&&i.caseId!=l.caseId){var _=c?c._height==2:!1,q=d?d.atomicRulesCountInCase+1:0;if(O&&q>O||_&&!b)return!1}if(i.type=="case_group"&&(i.isDefaultCase||l.isDefaultCase||l.type=="switch_group"&&s==Gn))return!1;var K=!0;return p&&(K=p(i.node.toJS(),l.node.toJS(),s,f?f.node.toJS():null)),K}},{key:"move",value:function(i,l,s,c){this._isUsingLegacyReactDomRender||(ru=!0),this.props.actions.moveItem(i.path,l.path,s)}},{key:"render",value:function(){return F.createElement(e,(0,nr.A)({},this.props,{onDragStart:this.onDragStart}))}}])}(F.Component),t.propTypes={tree:R().any.isRequired,actions:R().object.isRequired},t};const Qy=function(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,t=yo(function(r){return{dragging:r.dragging,dragStart:r.dragStart,mousePos:r.mousePos}},{setDragStart:Ty,setDragProgress:Cy,setDragEnd:Ey},null,{context:Pa})(qy(n,e));return t.displayName="ConnectedSortableContainer",t};var Yy=["isDraggingTempo","isDraggingMe","dragging"];function Xy(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,_d()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function _d(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_d=function(){return!!n})()}const oa=function(n){return function(e){var t;return t=function(r){function a(o){var u;return(0,mr.A)(this,a),u=Xy(this,a,[o]),u.handleDraggerMouseDown=function(i){var l=u.props.id,s=u.wrapper.current;u.props.onDragStart&&u.props.onDragStart(l,s,i)},u.wrapper=F.createRef(),u}return(0,yr.A)(a,r),(0,hr.A)(a,[{key:"render",value:function(){var u=this.props,i=u.isDraggingTempo,l=u.isDraggingMe,s=u.dragging,c=(0,_n.A)(u,Yy),d=c.isTrueLocked,f={};l&&i&&(ru||(f={top:s.y,left:s.x,width:s.w}));var p=Mt()(n,"group-or-rule",l&&i?"qb-draggable":null,l&&!i?"qb-placeholder":null,d?"locked":null);return F.createElement("div",{className:p,style:f,ref:this.wrapper,"data-id":this.props.id},F.createElement(e,(0,nr.A)({handleDraggerMouseDown:this.handleDraggerMouseDown,isDraggingMe:l,isDraggingTempo:i},c)))}}])}(F.PureComponent),t.propTypes={isDraggingTempo:R().bool,isDraggingMe:R().bool,onDragStart:R().func,dragging:R().object,isLocked:R().bool,isTrueLocked:R().bool},t}};var Zy=y(73569),ia=y.n(Zy),e0=y(71086),r0=y.n(e0);function Md(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function t0(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Md(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Md(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function n0(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,Gd()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function Gd(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Gd=function(){return!!n})()}var Ud=Ye.ConfigUtils,a0=Ud.getFieldConfig,o0=Ud.getOperatorConfig,Bd=function(n){function e(t){var r;return(0,mr.A)(this,e),r=n0(this,e,[t]),r.shouldComponentUpdate=Fo(r,{selectedField:function(o,u){return!1}}),ht(r),r.onPropsChanged(t),r}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"onPropsChanged",value:function(r){var a=this.props,o=["config","selectedField","selectedFieldSrc","selectedFieldType","selectedOperator"],u=!this.meta||o.map(function(i){return r[i]!==a[i]}).filter(function(i){return i}).length>0;u&&(this.meta=this.getMeta(r))}},{key:"getMeta",value:function(r){var a,o=r.config,u=r.selectedField,i=r.selectedFieldType,l=r.selectedOperator,s=a0(o,u),c=(0,Fe.A)(s?.operators||((a=o.types[i])===null||a===void 0?void 0:a.operators)||[]);!u&&!c.includes(l)&&c.push(l);var d=mo()(r0()(o.operators,function(S,C){return c?.indexOf(C)!==-1}),function(S,C){return o0(o,C,u)}),f=this.buildOptions(o,d,c),p=d[l]||{},g=this.props.config.settings.operatorPlaceholder,v=l,m=v?[v]:null,h=m,O=p.label,b=p.label2||p.tooltip;return{placeholder:g,items:f,selectedKey:v,selectedKeys:m,selectedPath:h,selectedLabel:O,selectedAltLabel:b,selectedOpts:p,fieldConfig:s}}},{key:"buildOptions",value:function(r,a,o){return!a||!o?null:ia()(a).sort(function(u,i){return o.indexOf(u)-o.indexOf(i)}).map(function(u){var i=a[u],l=i.label,s=i.label2,c=i.tooltip;return{key:u,path:u,label:l,altLabel:s,tooltip:c}})}},{key:"render",value:function(){var r=this.props,a=r.config,o=r.customProps,u=r.setOperator,i=r.readonly,l=r.id,s=r.groupId,c=a.settings.renderOperator,d=t0({id:l,groupId:s,config:a,customProps:o,readonly:i,setField:u},this.meta);return d.items?c(d,a.ctx):null}}])}(F.Component);Bd.propTypes={id:R().string,groupId:R().string,config:R().object.isRequired,selectedField:R().any,selectedFieldId:R().string,selectedFieldType:R().string,selectedFieldSrc:R().string,selectedOperator:R().string,readonly:R().bool,setOperator:R().func.isRequired};var i0=["children"],Kr=function(e){var t=e.children,r=(0,_n.A)(e,i0);return F.createElement("div",r,t)},yt=function(){},$d=function(){return F.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"gray",width:"18px",height:"18px"},F.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}),F.createElement("path",{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"}))},ua=function(e){return function(t){var r=t.config.settings.useConfirm,a=r?r.call(t.config.ctx,t.config.ctx):null;return F.createElement(e,(0,nr.A)({},t,{confirmFn:a}))}},Wd=function(e){var t=e.id,r=e.isLHS,a=e.delta,o=e.parentFuncs;return[t,r?"L":"R",r?-1:a||0,(o||[]).map(function(u){var i=(0,Le.A)(u,2),l=i[0],s=i[1];return"".concat(l,"(").concat(s,")")}).join("/")].join(":")},Ot=function(e,t){var r;return typeof t=="function"?(r=function(o){return t?.(o,e.ctx)},r.displayName=t.name):r=t,r};function u0(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,Kd()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function Kd(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Kd=function(){return!!n})()}var zd=function(n){function e(){return(0,mr.A)(this,e),u0(this,e,arguments)}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"render",value:function(){var r=this.props,a=r.config,o=r.selectedField,u=r.selectedFieldSrc,i=r.selectedFieldType,l=r.selectedOperator,s=r.setOperator,c=r.selectedFieldId,d=r.showOperator,f=r.showOperatorLabel,p=r.selectedFieldWidgetConfig,g=r.readonly,v=r.id,m=r.groupId,h=d&&F.createElement(Kr,{key:"operators-for-"+c,className:"rule--operator"},a.settings.showLabels&&F.createElement("label",{className:"rule--label"},a.settings.operatorLabel),F.createElement(Bd,{key:"operator",config:a,selectedField:o,selectedFieldSrc:u,selectedFieldType:i,selectedFieldId:c,selectedOperator:l,setOperator:s,readonly:g,id:v,groupId:m})),O=f&&F.createElement(Kr,{key:"operators-for-"+c,className:"rule--operator"},F.createElement("div",{className:"rule--operator-wrapper"},a.settings.showLabels?F.createElement("label",{className:"rule--label"},"\xA0"):null,F.createElement("div",{className:"rule--operator-text-wrapper"},F.createElement("span",{className:"rule--operator-text"},p.operatorInlineLabel))));return[h,O]}}])}(F.PureComponent);function Hd(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function l0(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Hd(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Hd(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function s0(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,Jd()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function Jd(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Jd=function(){return!!n})()}var qd=Ye.RuleUtils.getFieldPathLabels,tu=Ye.ConfigUtils,Qd=tu.getFieldConfig,Yd=tu.getFieldParts,Xd=tu.getFieldPathParts,Zd=function(n){function e(t){var r;return(0,mr.A)(this,e),r=s0(this,e,[t]),r.setField=function(a,o){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=r.props.id;if(!u.widgetId){var l=[i,"L",-1].join(":");u.widgetId=l}r.props.setField(a,o,u)},ht(r),r.onPropsChanged(t),r}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"onPropsChanged",value:function(r){var a=this.props,o=["selectedField","selectedFieldSrc","selectedFieldType","config","parentField"],u=!this.meta||o.map(function(i){return r[i]!==a[i]}).filter(function(i){return i}).length>0;u&&(this.meta=this.getMeta(r))}},{key:"getMeta",value:function(r){var a=r.selectedField,o=r.selectedFieldType,u=r.config,i=r.parentField,l=a,s=u.settings,c=s.maxLabelsLength,d=s.fieldSeparatorDisplay,f=s.fieldPlaceholder,p=s.fieldSeparator,g=!!a,v=g?null:So(f,c),m=g?Qd(u,l):null,h=m||{},O=Xd(l,u),b=Xd(l,u,!0),S=this.getFieldLabel(m,l,u),C=qd(l,u),L=C?C.join(d):null;(L==S||i)&&(L=null);var w=h.label2||h.tooltip,N=Yd(i,u),V=i?Qd(u,i):null,P=i?V&&V.subfields:u.fields,M=!g&&o,B=this.buildOptions(N,u,P,M,N),_=M?"Please select field":null;return l&&(0,Cr.A)(l)==="object"&&(l=void 0),{placeholder:v,items:B,parentField:i,selectedKey:l,selectedKeys:O,selectedPath:b,selectedLabel:S,selectedOpts:h,selectedAltLabel:w,selectedFullLabel:L,errorText:_}}},{key:"getFieldLabel",value:function(r,a,o){if(!a)return null;var u=o.settings.maxLabelsLength,i=Yd(a,o),l=r?.label||Xa()(i);return l=So(l,u),l}},{key:"buildOptions",value:function(r,a,o){var u=this,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:void 0,l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null;if(!o)return null;var c=a.settings,d=c.fieldSeparator,f=c.fieldSeparatorDisplay,p=l!=null&&l.length?l.join(d)+d:"",g=function v(m){return Object.keys(m||{}).reduce(function(h,O){var b=m[O];return b.type==="!struct"?h+v(b.subfields):h+(b.type===i?1:0)},0)};return ia()(o).map(function(v){var m=[].concat((0,Fe.A)(l??[]),[v]),h=o[v],O=u.getFieldLabel(h,m,a),b=qd(m,a),S=b.join(f);(S==O||r!=null&&r.length)&&(S=null);var C=h.label2,L=h.tooltip,w=h.disabled;if(!h.hideForSelect)if(h.type=="!struct"){var N=u.buildOptions(r,a,h.subfields,i,m,{label:O,tooltip:L}),V=g(h.subfields)>0;return{disabled:w,key:v,path:p+v,label:O,fullLabel:S,altLabel:C,tooltip:L,items:N,matchesType:V}}else{var P=i!==void 0?h.type===i:void 0;return{disabled:w,key:v,path:p+v,label:O,fullLabel:S,altLabel:C,tooltip:L,grouplabel:s?.label,group:s,matchesType:P}}}).filter(function(v){return!!v})}},{key:"render",value:function(){var r=this.props,a=r.config,o=r.customProps,u=r.setFieldSrc,i=r.readonly,l=r.id,s=r.groupId,c=a.settings.renderField,d=l0({id:l,groupId:s,config:a,customProps:o,readonly:i,setField:this.setField,setFieldSrc:u},this.meta);return c(d,a.ctx)}}])}(F.Component);Zd.propTypes={id:R().string,groupId:R().string,config:R().object.isRequired,selectedField:R().any,selectedFieldSrc:R().string,selectedFieldType:R().string,parentField:R().string,customProps:R().object,readonly:R().bool,setField:R().func.isRequired,setFieldSrc:R().func};function ef(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function c0(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ef(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):ef(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function d0(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,rf()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function rf(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(rf=function(){return!!n})()}var f0=Ye.clone,Co=Ye.ConfigUtils,p0=Co.getFieldConfig,tf=Co.getFuncConfig,v0=Co.getFieldParts,nf=Co.getFieldPathParts,af=Ye.RuleUtils,of=af.getFuncPathLabels,g0=af.getWidgetForFieldOp,m0=Ye.OtherUtils.shallowEqual,uf=function(n){function e(t){var r;return(0,mr.A)(this,e),r=d0(this,e,[t]),ht(r),r.onPropsChanged(t),r}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"onPropsChanged",value:function(r){var a=this.props,o=["config","field","fieldType","fieldSrc","operator","isFuncArg","isLHS","parentFuncs"],u=["config","field","fieldType","fieldSrc","value","isLHS"],i=!this.items||o.map(function(s){return s==="parentFuncs"?!m0(r[s],a[s],!0):r[s]!==a[s]}).filter(function(s){return s}).length>0,l=!this.meta||u.map(function(s){return r[s]!==a[s]}).filter(function(s){return s}).length>0;l&&(this.meta=this.getMeta(r)),i&&(this.items=this.getItems(r,this.meta))}},{key:"getItems",value:function(r,a){var o=r.config,u=r.field,i=r.fieldType,l=r.isLHS,s=r.operator,c=r.parentFuncs,d=r.fieldDefinition,f=r.isFuncArg,p=a.lookingForFieldType,g=o.settings.canUseFuncForField,v=this.filterFuncs(o,o.funcs,u,i,l,s,g,c,f,d),m=this.buildOptions(o,v,p);return m}},{key:"getMeta",value:function(r){var a=r.config,o=r._field,u=r.fieldType,i=r.value,l=r.isLHS,s=r.isFuncArg,c=a.settings,d=c.funcPlaceholder,f=c.fieldSeparatorDisplay,p=i,g=!!i,v=g?null:d,m=g?tf(a,p):null,h=m||{},O=nf(p,a),b=nf(p,a,!0),S=this.getFuncLabel(m,p,a),C=of(p,a),L=C?C.join(f):null;L==S&&(L=null);var w=l&&!s,N=w&&!g&&u,V=N?"Please select function":null;return{placeholder:v,selectedKey:p,selectedKeys:O,selectedPath:b,selectedLabel:S,selectedOpts:h,selectedFullLabel:L,errorText:V,lookingForFieldType:N}}},{key:"filterFuncs",value:function(r,a,o,u,i,l,s,c,d,f){a=f0(a);var p=r.settings.fieldSeparator,g=p0(r,o),v=!1,m,h=g,O=g0(r,o,l,"value"),b=O&&r.widgets[O];d?(h=f,m=f?.type):v&&b?m=b.type:g?m=g.type:i||(m=u);function S(C,L){for(var w in C){var N=C[w].subfields,V=(L||[]).concat(w),P=V.join(p),M=tf(r,P);if(M.type=="!struct")S(N,V)==0&&delete C[w];else{var B,_=!m||M.returnType==m;(B=h)!==null&&B!==void 0&&B.funcs&&(_=_&&h.funcs.includes(P)),s&&(_=_&&s(o,g,P,M,l)),!M.allowSelfNesting&&c&&c.map(function(q){var K=(0,Le.A)(q,2),J=K[0],U=K[1];return J}).includes(P)&&(_=!1),_||delete C[w]}}return ia()(C).length}return S(a,[]),a}},{key:"buildOptions",value:function(r,a){var o=this,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;if(!a)return null;var s=r.settings,c=s.fieldSeparator,d=s.fieldSeparatorDisplay,f=i!=null&&i.length?i.join(c)+c:"",p=function g(v){return Object.keys(v||{}).reduce(function(m,h){var O=v[h];return O.type==="!struct"?m+g(O.subfields):m+(O.type===u?1:0)},0)};return ia()(a).map(function(g){var v=[].concat((0,Fe.A)(i??[]),[g]),m=a[g],h=o.getFuncLabel(m,v,r),O=of(v,r),b=O.join(d);b==h&&(b=null);var S=m.tooltip;if(m.type=="!struct"){var C=o.buildOptions(r,m.subfields,u,v,{label:h,tooltip:S}),L=p(m.subfields)>0;return{key:g,path:f+g,label:h,fullLabel:b,tooltip:S,items:C,matchesType:L}}else{var w=u!==void 0?m.returnType===u:void 0;return{key:g,path:f+g,label:h,fullLabel:b,tooltip:S,grouplabel:l?.label,group:l,matchesType:w}}})}},{key:"getFuncLabel",value:function(r,a,o){if(!a)return null;var u=o.settings.maxLabelsLength,i=v0(a,o),l=r?.label||Xa()(i);return l=So(l,u),l}},{key:"render",value:function(){var r=this.props,a=r.config,o=r.customProps,u=r.setValue,i=r.readonly,l=r.id,s=r.groupId,c=a.settings.renderFunc,d=c0({config:a,customProps:o,readonly:i,setField:u,items:this.items,id:l,groupId:s},this.meta);return c(d,a.ctx)}}])}(F.Component);uf.propTypes={id:R().string,groupId:R().string,config:R().object.isRequired,field:R().any,fieldType:R().string,fieldSrc:R().string,operator:R().string,customProps:R().object,value:R().string,setValue:R().func.isRequired,readonly:R().bool,parentFuncs:R().array,fieldDefinition:R().object,isFuncArg:R().bool,isLHS:R().bool};var h0=y(23181),nu=y.n(h0),y0=["widgetFactory"],O0=["factory"];function lf(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function au(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?lf(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):lf(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var sf=Ye.ListUtils.getTitleInListValues,b0=Ye.ConfigUtils._widgetDefKeysToOmit,cf=Ye.TreeUtils,S0=cf._fixImmutableValue,F0=cf.isImmutable,df=(0,F.memo)(function(n){var e=n.widgetFactory,t=(0,_n.A)(n,y0),r=t.config,a=t.isFuncArg,o=t.fieldDefinition,u=o||{},i=u.fieldSettings,l=u.defaultValue,s=u.valueSources,c=a&&s?.length==1&&s?.[0]==="const",d=i?.treeValues||i?.listValues;return c&&l?typeof l=="boolean"?l?t.labelYes||"YES":t.labelNo||"NO":d?Array.isArray(l)?l.map(function(f){return sf(d,f)||f}).join(", "):sf(d,l)||l:""+l:e?e(t,r.ctx):"?"});df.displayName="WidgetFactoryMemo";var ff=function(e){var t=e.delta,r=e.isFuncArg,a=e.valueSrc,o=e.value,u=e.valueError,i=e.fieldError,l=e.asyncListValues,s=e.isSpecialRange,c=e.fieldDefinition,d=e.widget,f=e.widgetDefinition,p=e.widgetValueLabel,g=e.valueLabels,v=e.textSeparators,m=e.setValue,h=e.setFuncValue,O=e.config,b=e.field,S=e.fieldSrc,C=e.fieldPath,L=e.fieldType,w=e.isLHS,N=e.operator,V=e.readonly,P=e.parentField,M=e.parentFuncs,B=e.id,_=e.groupId,q=e.widgetId,K=f.factory,J=(0,_n.A)(f,O0),U=o?o.map(function(ge){return S0(ge)}):void 0,te=(0,F.useMemo)(function(){if(s){var ge=[U?.get(0),U?.get(1)];return ge[0]===void 0&&ge[1]===void 0&&(ge=void 0),ge}return U?.get(t)},[s,o]),Q=(0,F.useMemo)(function(){return u?s?[u.get(0),u.get(1),u.get(2)]:u?.get(t):null},[s,o]),ae=w?i:Q,ce=c||{},ie=ce.fieldSettings,le=p.label,pe=p.placeholder,se=g?g.placeholder:null,me=F0(b)?null:b,Ce=Za()(au(au(au({},J),ie),{},{config:O,field:me,fieldPath:C,fieldSrc:S,fieldType:L,isLHS:w,parentField:P,parentFuncs:M,fieldDefinition:c,operator:N,delta:t,isSpecialRange:s,isFuncArg:r,value:te,valueSrc:a,valueError:Q,fieldError:i,errorMessage:ae,label:le,placeholder:pe,placeholders:se,textSeparators:v,setValue:m,setFuncValue:h,readonly:V,asyncListValues:l,id:B,groupId:_,widgetId:q,widgetFactory:K,widget:d}),[].concat((0,Fe.A)(b0),["toJS"]));return F.createElement(df,(0,nr.A)({widgetFactory:K},Ce))};ff.displayName="WidgetFactory";const C0=ff;function T0(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,pf()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function pf(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(pf=function(){return!!n})()}var ou=Ye.ConfigUtils,E0=ou.getFieldConfig,A0=ou.getOperatorConfig,vf=ou.getFieldWidgetConfig,iu=Ye.RuleUtils,L0=iu.getValueSourcesForFieldOp,gf=iu.getWidgetForFieldOp,To=iu.getValueLabel,mf=Ye.DefaultUtils.createListWithOneElement,w0=Ye.OtherUtils.shallowEqual,TS=Ye.TreeUtils.isImmutable,j0={cardinality:1},xa=function(n){function e(t){var r;return(0,mr.A)(this,e),r=T0(this,e,[t]),r._setValue=function(a,o,u,i,l,s){var c=arguments.length>6&&arguments[6]!==void 0?arguments[6]:{};if(c.widgetId||(c.widgetId=i),a&&Array.isArray(l)){var d=[r.props.value.get(0),r.props.value.get(1)];d[0]!=l[0]&&r.props.setValue(0,l[0],u,s,c),d[1]!=l[1]&&r.props.setValue(1,l[1],u,s,c)}else r.props.setValue(o,l,u,s,c)},r._setValueSrc=function(a,o,u){var i={widgetId:o};r.props.setValueSrc(a,u,i)},r.renderWidget=function(a,o,u){var i=u.config,l=u.isFuncArg,s=u.leftField,c=u.operator,d=u.value,f=u.valueError,p=u.fieldError,g=u.readonly,v=u.parentField,m=u.parentFuncs,h=u.id,O=u.groupId,b=u.fieldSrc,S=u.fieldType,C=u.isLHS,L=u.setFuncValue,w=i.settings,N=o.widgets,V=o.iValues,P=o.aField,M=o.valueSources,B=l?V:d,_=l?s:P,q=N[a],K=q.valueSrc,J=q.valueLabel,U=q.widgetId,te=M.length>1&&!g,Q=w.showLabels?F.createElement("label",{key:"label-"+U,className:"rule--label"},J.label):null;return F.createElement("div",{key:"wrapper-"+U,className:Mt()(K==="func"?"widget--func":"widget--widget",te?"widget--has-valuerscs":"widget--has-no-valuerscs")},K==="func"?null:Q,F.createElement(C0,(0,nr.A)({key:U,id:h,groupId:O,widgetId:U,valueSrc:K,delta:a,value:B,valueError:f,fieldError:p,isFuncArg:l,isLHS:C},Xt()(o,["isSpecialRange","fieldDefinition","asyncListValues"]),Xt()(N[a],["widget","widgetDefinition","widgetValueLabel","valueLabels","textSeparators","setValue"]),{setFuncValue:L,config:i,field:_,fieldSrc:b,fieldType:S,parentField:v,parentFuncs:m,operator:c,readonly:g})))},r.renderValueSources=function(a,o,u){var i=u.config,l=u.isFuncArg,s=u.leftField,c=u.operator,d=u.readonly,f=i.settings,p=o.valueSources,g=o.widgets,v=o.aField,m=o.valueSourcesOptions,h=l?s:v,O=g[a],b=O.valueSrc,S=O.setValueSrc,C=r.ValueSources,L=f.showLabels?F.createElement("label",{className:"rule--label"},"\xA0"):null;return p.length>1&&!d&&F.createElement("div",{key:"wrapper-valuesrc-"+a,className:"widget--valuesrc"},L,F.createElement(C,{key:"valuesrc-"+a,delta:a,valueSources:m,valueSrc:b,config:i,field:h,operator:c,setValueSrc:S,readonly:d,title:f.valueSourcesPopupTitle}))},r.renderSep=function(a,o,u){var i=u.config,l=o.widgets,s=i.settings,c=l[a].sepText,d=s.showLabels?F.createElement("label",{className:"rule--label"},"\xA0"):null;return c&&F.createElement("div",{key:"widget-separators-"+a,className:Mt()("widget--sep",a==0&&"widget--sep-first")},d,F.createElement("span",null,c))},r.renderWidgetDelta=function(a){var o=r.renderSep(a,r.meta,r.props),u=r.renderValueSources(a,r.meta,r.props),i=r.renderWidget(a,r.meta,r.props);return[o,u,i]},ht(r),r.onPropsChanged(t),r}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"onPropsChanged",value:function(r){var a=this.props,o=!this.ValueSources||a?.config!==r?.config,u=["config","id","parentFuncs","field","fieldId","fieldSrc","fieldType","fieldFunc","fieldArg","leftField","operator","valueSrc","asyncListValues","isLHS","isFuncArg","isForRuleGroup","isCaseValue","value"],i=u.filter(function(d){return d==="parentFuncs"?!w0(r[d],a[d],!0):d==="field"?r.fieldId!==a.fieldId:r[d]!==a[d]}),l=!this.meta||i.length>0;if(l&&(this.meta=this.getMeta(r,i)),o){var s=r.config,c=s.settings.renderValueSources;this.ValueSources=Ot(s,c)}}},{key:"getMeta",value:function(r){var a,o,u,i,l=this,s=r.config,c=r.field,d=r.fieldSrc,f=r.fieldType,p=r.fieldFunc,g=r.fieldArg,v=r.operator,m=r.valueSrc,h=r.value,O=r.isForRuleGroup,b=r.isCaseValue,S=r.isFuncArg,C=r.leftField,L=r.asyncListValues,w=r.parentFuncs,N=r.isLHS,V=r.id,P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],M=s.settings.valueSourcesInfo,B=S?{func:p,arg:g}:c,_=!c&&f,q=m,K=h;(S||O||b)&&(q=mf(m),K=mf(h));var J=E0(s,B);!J&&_&&(J=s.types[f]);var U=gf(s,B,v);if(!U&&_){var te;U=(te=s.types[f])===null||te===void 0?void 0:te.mainWidget}var Q=S?j0:A0(s,v,B);if((J==null||Q==null)&&!b)return null;var ae=Q?.isSpecialRange,ce=ae&&(((a=q)===null||a===void 0?void 0:a.get(0))==="field"||((o=q)===null||o===void 0?void 0:o.get(1))==="field"),ie=ae&&!ce,le=ie?1:wy(Q);if(le===0)return null;var pe=(u=this.meta)===null||u===void 0?void 0:u.valueSources,se=(i=this.meta)===null||i===void 0?void 0:i.valueSourcesOptions;(!pe||["field","operator","config","fieldDefinition","isForRuleGroup"].filter(function(Ce){return P.includes(Ce)}).length)&&(pe=L0(s,B,v,J),O&&(pe=["value"]),B||(pe=Object.keys(M)),se=pe.map(function(Ce){return[Ce,{label:M[Ce].label}]}));var me=nu()(0,le).map(function(Ce){var ge,Ae,Pe,Ve,Ie=(ge=l.meta)===null||ge===void 0||(ge=ge.widgets)===null||ge===void 0?void 0:ge[Ce],De=((Ae=q)===null||Ae===void 0?void 0:Ae.get(Ce))||null,Ee=gf(s,B,v,De),Ne=vf(s,B,v,Ee,De);ce&&(Ee=Ne.singleWidget,Ne=vf(s,B,v,Ee,De)),!Ne&&_&&(Ee=["func","field"].includes(De)?De:U,Ne=s.widgets[Ee]);var Xe=(Pe=Ne)===null||Pe===void 0?void 0:Pe.type,ar=To(s,B,v,Ce,De,ie),Ze=To(s,B,v,Ce,null,ie),Xr=Q!=null&&Q.textSeparators?Q?.textSeparators[Ce]:null,Tr=null,Pr=null;ae&&(Tr=[To(s,B,v,0),To(s,B,v,1)],Tr={placeholder:[Tr[0].placeholder,Tr[1].placeholder],label:[Tr[0].label,Tr[1].label]},Pr=Q?.textSeparators);var or=Wd({id:V,isLHS:N,delta:Ce,parentFuncs:w}),at=or+":VS",bt=Ie?.setValueSrc;(!bt||Ie?.widgetId!==or)&&(bt=l._setValueSrc.bind(l,Ce,at));var ot=Ie?.setValue;return(!ot||Ie?.widgetId!==or||Ie?.widgetType!==Xe||((Ve=l.meta)===null||Ve===void 0?void 0:Ve.isSpecialRange)!==ae)&&(ot=l._setValue.bind(l,ae,Ce,Xe,or)),{valueSrc:De,valueLabel:ar,widget:Ee,sepText:Xr,widgetDefinition:Ne,widgetValueLabel:Ze,valueLabels:Tr,textSeparators:Pr,setValueSrc:bt,setValue:ot,widgetId:or,widgetType:Xe}});return{defaultWidget:U,fieldDefinition:J,operatorDefinition:Q,isSpecialRange:ie,cardinality:le,valueSources:pe,valueSourcesOptions:se,widgets:me,iValues:K,aField:B,asyncListValues:L}}},{key:"render",value:function(){if(!this.meta)return null;var r=this.meta,a=r.defaultWidget,o=r.cardinality;if(!a)return null;var u=a;return F.createElement(Kr,{className:"rule--widget rule--widget--".concat(u.toUpperCase()),key:"widget-col-"+u},nu()(0,o).map(this.renderWidgetDelta))}}])}(F.Component);xa.propTypes={config:R().object.isRequired,value:R().any,valueSrc:R().any,valueError:R().any,fieldError:R().string,field:R().any,fieldSrc:R().string,fieldType:R().string,fieldId:R().string,operator:R().string,readonly:R().bool,asyncListValues:R().array,id:R().string,groupId:R().string,setValue:R().func,setValueSrc:R().func,setFuncValue:R().func,isFuncArg:R().bool,fieldFunc:R().string,fieldArg:R().string,leftField:R().any,isForRuleGroup:R().bool,parentField:R().string,parentFuncs:R().array,isLHS:R().bool,isCaseValue:R().bool};function hf(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,yf()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function yf(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(yf=function(){return!!n})()}var R0=Ye.ConfigUtils.getFuncConfig,Of=Ye.OtherUtils.shallowEqual,uu=function(n){function e(t){var r;return(0,mr.A)(this,e),r=hf(this,e,[t]),r.setFunc=function(a){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},u=r.props,i=u.isLHS,l=u.delta,s=u.parentFuncs,c=u.id;if(!o.widgetId){var d=Wd({id:c,isLHS:i,delta:l,parentFuncs:s});o.widgetId=d}r.props.setFuncValue(i?-1:l||0,s,null,a,"!func",void 0,o)},r.setArgValue=function(a,o,u,i,l){var s=r.props,c=s.config,d=s.delta,f=s.isLHS,p=s.parentFuncs;r.props.setFuncValue(f?-1:d||0,p,a,o,u,i,l)},r.setArgValueSrc=function(a,o,u){var i=r.props,l=i.config,s=i.delta,c=i.isLHS,d=i.parentFuncs;r.props.setFuncValue(c?-1:s||0,d,a,o,"!valueSrc",void 0,u)},r.renderFuncSelect=function(){var a,o,u=r.props,i=u.config,l=u.field,s=u.fieldType,c=u.fieldSrc,d=u.isLHS,f=u.operator,p=u.customProps,g=u.value,v=u.readonly,m=u.parentFuncs,h=u.id,O=u.groupId,b=u.isFuncArg,S=u.fieldDefinition,C=(a=g==null||(o=g.get)===null||o===void 0?void 0:o.call(g,"func"))!==null&&a!==void 0?a:null,L={value:C,setValue:r.setFunc,config:i,field:l,fieldType:s,fieldSrc:c,isLHS:d,operator:f,customProps:p,readonly:v,parentFuncs:m,isFuncArg:b,fieldDefinition:S,id:h,groupId:O},w=i.settings,N=w.showLabels,V=w.funcLabel,P=N?F.createElement("label",{className:"rule--label"},V):null;return F.createElement(Kr,{key:"func",className:"rule--func"},P,F.createElement(uf,L))},r.renderArgLabel=function(a,o){var u=o.valueSources,i=o.type,l=o.showPrefix,s=o.label,c=r.props.config,d=u&&u.length==1&&u[0]=="const",f=!c.settings.showLabels&&(i=="boolean"||d)&&l;return f?F.createElement(Kr,{className:"rule--func--arg-label"},s||a):null},r.renderArgLabelSep=function(a,o){var u=o.valueSources,i=o.type,l=o.showPrefix,s=r.props.config,c=u&&u.length==1&&u[0]=="const",d=!s.settings.showLabels&&(i=="boolean"||c)&&l;return d?F.createElement(Kr,{className:"rule--func--arg-label-sep"},":"):null},r.renderArgVal=function(a,o,u){var i=r.props,l=i.config,s=i.field,c=i.fieldType,d=i.fieldSrc,f=i.isLHS,p=i.operator,g=i.value,v=i.readonly,m=i.parentFuncs,h=i.id,O=i.groupId,b=i.fieldError,S=i.valueError,C=i.setFuncValue,L=g?g.getIn(["args",o]):null,w=L?L.get("value"):void 0,N=u.valueSources.length==1?u.valueSources[0]:void 0,V=L?L.get("valueSrc")||N||"value":N,P={config:l,fieldFunc:a,fieldArg:o,leftField:s,fieldType:c,fieldSrc:d,fieldError:b,valueError:S,isLHS:f,operator:null,value:w,valueSrc:V,setValue:r.setArgValue,setValueSrc:r.setArgValueSrc,setFuncValue:C,funcKey:a,argKey:o,argDefinition:u,readonly:v,parentFuncs:m,id:h,groupId:O};return F.createElement(Kr,{className:"rule--func--arg-value"},F.createElement(bf,P))},r.renderArgSep=function(a,o,u,i){var l=i.renderSeps;return u?F.createElement(Kr,{className:"rule--func--arg-sep"},l?l[u-1]:", "):null},r.renderBracketBefore=function(a){var o=a.renderBrackets;return F.createElement(Kr,{key:"before_args",className:"rule--func--bracket-before"},o?o[0]:"(")},r.renderBracketAfter=function(a){var o=a.renderBrackets;return F.createElement(Kr,{key:"after_args",className:"rule--func--bracket-after"},o?o[1]:")")},r.renderFuncArgs=function(){var a=r.meta,o=a.funcDefinition,u=a.funcKey;if(!u)return null;var i=o||{},l=i.args;return l?F.createElement(F.Fragment,null,r.renderBracketBefore(o),F.createElement(Kr,{key:"args-".concat(u),className:"rule--func--args rule--func--".concat(u,"--args")},Object.keys(l).map(function(s,c){return F.createElement(Kr,{key:"arg-".concat(s,"-").concat(c),className:"rule--func--arg rule--func--".concat(u,"--arg--").concat(s)},r.renderArgSep(s,l[s],c,o),r.renderArgLabel(s,l[s]),r.renderArgLabelSep(s,l[s]),r.renderArgVal(u,s,l[s]))})),r.renderBracketAfter(o)):null},ht(r),r.onPropsChanged(t),r}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"onPropsChanged",value:function(r){var a=this.props,o=["config","field","operator","value","fieldSrc","fieldType","isLHS"],u=!this.meta||o.map(function(i){return i==="parentFuncs"?!Of(r[i],a[i],!0):r[i]!==a[i]}).filter(function(i){return i}).length>0;u&&(this.meta=this.getMeta(r))}},{key:"getMeta",value:function(r){var a,o,u=r.config,i=r.field,l=r.operator,s=r.value,c=(a=s==null||(o=s.get)===null||o===void 0?void 0:o.call(s,"func"))!==null&&a!==void 0?a:null,d=c?R0(u,c):null;return{funcDefinition:d,funcKey:c}}},{key:"render",value:function(){var r=this.props.parentFuncs,a=r?r.map(function(u){var i=(0,Le.A)(u,2),l=i[0],s=i[1];return"".concat(l,"_").concat(s)}).join("-"):"root",o=r?.length||0;return F.createElement(Kr,{className:"rule--func--wrapper rule--func--wrapper--under-".concat(a," rule--func--wrapper--lev-").concat(o)},this.renderFuncSelect(),this.renderFuncArgs())}}])}(F.Component);uu.propTypes={id:R().string,groupId:R().string,config:R().object.isRequired,field:R().any,fieldSrc:R().string,fieldType:R().string,fieldError:R().string,operator:R().string,customProps:R().object,value:R().object,setValue:R().func.isRequired,setFuncValue:R().func,readonly:R().bool,parentFuncs:R().array,fieldDefinition:R().object,isFuncArg:R().bool,isLHS:R().bool,valueError:R().string};var bf=function(n){function e(t){var r;return(0,mr.A)(this,e),r=hf(this,e,[t]),r.setValue=function(a,o,u,i,l){var s=r.props,c=s.setValue,d=s.argKey;c(d,o,u,i,l)},r.setValueSrc=function(a,o,u){var i=r.props,l=i.setValueSrc,s=i.argKey;l(s,o,u)},ht(r),r.onPropsChanged(t),r}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"onPropsChanged",value:function(r){var a=this.props,o=["parentFuncs","funcKey","argKey"],u=!this.meta||o.map(function(i){return i==="parentFuncs"?!Of(r[i],a[i],!0):r[i]!==a[i]}).filter(function(i){return i}).length>0;u&&(this.meta=this.getMeta(r))}},{key:"getMeta",value:function(r){var a=r.parentFuncs,o=r.funcKey,u=r.argKey,i=[].concat((0,Fe.A)(a||[]),[[o,u]]);return{parentFuncs:i}}},{key:"render",value:function(){var r=this.meta.parentFuncs;return F.createElement(xa,(0,nr.A)({},this.props,{setValue:this.setValue,setValueSrc:this.setValueSrc,isFuncArg:!0,parentFuncs:r}))}}])}(F.Component);bf.propTypes={funcKey:R().string.isRequired,argKey:R().string.isRequired,setValue:R().func.isRequired,setValueSrc:R().func.isRequired,readonly:R().bool,isLHS:R().bool,parentFuncs:R().array,id:R().string,groupId:R().string};function P0(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,Sf()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function Sf(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Sf=function(){return!!n})()}var lu=function(n){function e(t){var r;return(0,mr.A)(this,e),r=P0(this,e,[t]),r.renderField=function(){var a=r.props,o=a.config,u=a.classname,i=a.selectedField,l=a.selectedFieldSrc,s=a.selectedFieldType,c=a.setField,d=a.setFuncValue,f=a.parentField,p=a.readonly,g=a.id,v=a.groupId,m=a.fieldError,h=a.valueError,O=["func","field"];if(!O.includes(l))return"?";var b=l==="func"?F.createElement(uu,{isLHS:!0,config:o,value:i,fieldSrc:l,fieldType:s,fieldError:m,valueError:h,parentField:f,setValue:c,setFuncValue:d,readonly:p,id:g,groupId:v,key:"field-func-"+g}):F.createElement(Zd,{config:o,selectedField:i,selectedFieldSrc:l,selectedFieldType:s,parentField:f,setField:c,customProps:o.settings.customFieldSelectProps,readonly:p,id:g,groupId:v,key:"field-"+g}),S=l==="func"?o.settings.funcLabel:o.settings.fieldLabel,C=o.settings.showLabels&&l!=="func"&&F.createElement("label",{className:"rule--label"},S);return F.createElement("div",{key:l,className:u},C,b)},r.renderFieldSources=function(){if(!r.meta)return null;var a=r.props,o=a.config,u=a.readonly,i=a.selectedFieldSrc,l=a.setFieldSrc,s=a.id,c=r.meta.fieldSourcesOptions,d=o.settings,f=r.ValueSources,p=d.showLabels?F.createElement("label",{className:"rule--label"},"\xA0"):null;return c.length>1&&!u&&F.createElement("div",{key:"fieldsrc",className:"rule--fieldsrc"},p,F.createElement(f,{key:"fieldsrc-"+s,valueSources:c,valueSrc:i,config:o,setValueSrc:l,readonly:u,title:d.fieldSourcesPopupTitle}))},ht(r),r.onPropsChanged(t),r}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"onPropsChanged",value:function(r){var a=this.props,o=!this.ValueSources||a?.config!==r?.config,u=["config"],i=!this.meta||u.map(function(c){return r[c]!==a[c]}).filter(function(c){return c}).length>0;if(i&&(this.meta=this.getMeta(r)),o){var l=r.config,s=l.settings.renderValueSources;this.ValueSources=function(c){return s(c,l.ctx)}}}},{key:"getMeta",value:function(r){var a=r.config,o=a.settings,u=o.valueSourcesInfo,i=o.fieldSources,l=i.map(function(s){return[s,{label:u[s].label}]});return{fieldSourcesOptions:l}}},{key:"render",value:function(){var r=this.props,a=r.classname,o=r.canSelectFieldSource,u=o&&this.renderFieldSources(),i=this.renderField();return o?F.createElement(Kr,{className:"rule--field-wrapper"},u,i):i}}])}(F.Component),x0=["factory"];function I0(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,Ff()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function Ff(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ff=function(){return!!n})()}var V0=Ye.ConfigUtils.getOperatorConfig,Cf=function(n){function e(){return(0,mr.A)(this,e),I0(this,e,arguments)}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"render",value:function(){if(!this.props.selectedOperator)return null;var r=V0(this.props.config,this.props.selectedOperator,this.props.selectedField);if(typeof r.options>"u")return null;var a=r.options,o=a.factory,u=(0,_n.A)(a,x0),i=Object.assign({},u,{config:this.props.config,field:this.props.selectedField,fieldSrc:this.props.selectedFieldSrc,operator:this.props.selectedOperator,options:this.props.operatorOptions,setOption:this.props.setOperatorOption,readonly:this.props.readonly}),l=o(i,this.props.config.ctx),s=this.props.selectedOperator;return F.createElement("div",{className:"rule--operator rule--operator--".concat(s.toUpperCase())},l)}}])}(F.PureComponent);Cf.propTypes={config:R().object.isRequired,operatorOptions:R().any.isRequired,selectedField:R().any,selectedFieldSrc:R().string,selectedOperator:R().string.isRequired,readonly:R().bool,setOperatorOption:R().func.isRequired};function Tf(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Ef(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Tf(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Tf(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function D0(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,Af()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function Af(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Af=function(){return!!n})()}var Eo=Ye.ConfigUtils,N0=Eo.getFieldConfig,k0=Eo.getOperatorConfig,_0=Eo.getFieldWidgetConfig,M0=Eo.getFieldId,G0=Ye.RuleUtils.isEmptyRuleProperties,Lf=function(n){function e(t){var r;return(0,mr.A)(this,e),r=D0(this,e,[t]),ht(r),r.removeSelf=r.removeSelf.bind(r),r.setLock=r.setLock.bind(r),r.onPropsChanged(t),r}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"onPropsChanged",value:function(r){var a=this,o=this.props,u=!this.Icon||o?.config!==r?.config,i=["selectedField","selectedFieldSrc","selectedFieldType","selectedOperator","config","reordableNodesCnt","isLocked"],l=!this.meta||i.map(function(O){return r[O]!==o[O]}).filter(function(O){return O}).length>0;if(l&&(this.meta=this.getMeta(r)),u){var s=r.config,c=s.settings,d=c.renderIcon,f=c.renderButton,p=c.renderButtonGroup,g=c.renderSwitch,v=c.renderBeforeWidget,m=c.renderAfterWidget,h=c.renderRuleError;this.Icon=Ot(s,d),this.Btn=Ot(s,f),this.BtnGrp=Ot(s,p),this.Switch=Ot(s,g),this.BeforeWidget=Ot(s,v),this.AfterWidget=Ot(s,m),this.RuleError=Ot(s,h)}this.doRemove=function(){a.props.removeSelf()}}},{key:"getMeta",value:function(r){var a=r.selectedField,o=r.selectedFieldType,u=r.selectedOperator,i=r.config,l=r.reordableNodesCnt,s=r.isLocked,c=i.settings.keepInputOnChangeFieldSrc,d=M0(a,i),f=N0(i,a),p=f&&f.type==="!struct",g=c&&o,v=!!a||g,m=v&&u,h=k0(i,u,a),O=h&&h.options!=null,b=_0(i,a,u,null,null)||{},S=b.hideOperator,C=i.settings.canReorder&&l>1&&!s,L=v&&!S,w=v&&S&&b.operatorInlineLabel,N=m&&!p,V=m&&O;return{selectedFieldId:d,selectedFieldWidgetConfig:b,showDragIcon:C,showOperator:L,showOperatorLabel:w,showWidget:N,showOperatorOptions:V}}},{key:"setLock",value:function(r){this.props.setLock(r)}},{key:"removeSelf",value:function(){var r=this.props,a=r.confirmFn,o=r.config,u=o.settings,i=u.renderConfirm,l=u.removeRuleConfirmOptions;l&&!this.isEmptyCurrentRule()?i.call(o.ctx,Ef(Ef({},l),{},{onOk:this.doRemove,onCancel:null,confirmFn:a}),o.ctx):this.doRemove()}},{key:"_buildWidgetProps",value:function(r,a){var o=r.selectedField,u=r.selectedFieldSrc,i=r.selectedFieldType,l=r.selectedOperator,s=r.operatorOptions,c=r.value,d=r.valueType,f=r.valueSrc,p=r.asyncListValues,g=r.valueError,v=r.fieldError,m=r.parentField,h=a.selectedFieldId;return{field:o,fieldSrc:u,fieldType:i,fieldId:h,operator:l,operatorOptions:s,value:c,valueType:d,valueSrc:f,asyncListValues:p,valueError:g,fieldError:v,parentField:m}}},{key:"isEmptyCurrentRule",value:function(){var r=this.props.config,a=this._buildWidgetProps(this.props,this.meta);return G0(a,r)}},{key:"renderField",value:function(){var r=this.props,a=r.config,o=r.isLocked,u=r.parentField,i=r.groupId,l=r.id,s=r.selectedFieldSrc,c=r.selectedField,d=r.selectedFieldType,f=r.setField,p=r.setFuncValue,g=r.setFieldSrc,v=r.fieldError,m=a.settings.immutableFieldsMode,h=this.meta.selectedFieldId;return F.createElement(lu,{key:"field",classname:Mt()(s=="func"?"rule--field--func":"rule--field"),config:a,canSelectFieldSource:!u,selectedField:c,selectedFieldSrc:s,selectedFieldType:d,selectedFieldId:h,fieldError:v,setField:m?yt:f,setFuncValue:m?yt:p,setFieldSrc:m?yt:g,parentField:u,readonly:m||o,id:l,groupId:i})}},{key:"renderOperator",value:function(){var r=this.props,a=r.config,o=r.isLocked,u=this.meta,i=u.selectedFieldId,l=u.selectedFieldWidgetConfig,s=u.showOperator,c=u.showOperatorLabel,d=a.settings.immutableOpsMode;return F.createElement(zd,{key:"operator",config:a,selectedField:this.props.selectedField,selectedFieldSrc:this.props.selectedFieldSrc,selectedFieldType:this.props.selectedFieldType,selectedFieldId:i,selectedOperator:this.props.selectedOperator,setOperator:d?yt:this.props.setOperator,showOperator:s,showOperatorLabel:c,selectedFieldWidgetConfig:l,readonly:d||o,id:this.props.id,groupId:this.props.groupId})}},{key:"renderWidget",value:function(){var r=this.props,a=r.config,o=r.isLocked,u=this.meta.showWidget,i=a.settings.immutableValuesMode;if(!u)return null;var l=F.createElement(xa,(0,nr.A)({key:"values"},this._buildWidgetProps(this.props,this.meta),{config:a,setValue:i?yt:this.props.setValue,setValueSrc:i?yt:this.props.setValueSrc,setFuncValue:i?yt:this.props.setFuncValue,readonly:i||o,id:this.props.id,groupId:this.props.groupId}));return F.createElement(Kr,{key:"widget-for-"+this.props.selectedOperator,className:"rule--value"},l)}},{key:"renderOperatorOptions",value:function(){var r=this.props.config,a=this.meta.showOperatorOptions,o=r.settings,u=o.immutableOpsMode,i=o.immutableValuesMode;if(!a)return null;var l=F.createElement(Cf,{key:"operatorOptions",selectedField:this.props.selectedField,selectedOperator:this.props.selectedOperator,operatorOptions:this.props.operatorOptions,setOperatorOption:u?yt:this.props.setOperatorOption,config:r,readonly:i});return F.createElement(Kr,{key:"op-options-for-"+this.props.selectedOperator,className:"rule--operator-options"},l)}},{key:"renderBeforeWidget",value:function(){var r=this.BeforeWidget;return r?F.createElement(Kr,{key:"before-widget-for-"+this.props.selectedOperator,className:"rule--before-widget"},F.createElement(r,this.props)):null}},{key:"renderAfterWidget",value:function(){var r=this.AfterWidget;return r?F.createElement(Kr,{key:"after-widget-for-"+this.props.selectedOperator,className:"rule--after-widget"},F.createElement(r,this.props)):null}},{key:"renderError",value:function(){var r=this.props,a=r.config,o=r.valueError,u=r.fieldError,i=a.settings.showErrorMessage,l=this.RuleError,s=[u].concat((0,Fe.A)(o?.toArray()||[])).filter(function(c){return!!c}).shift()||null;return i&&s&&F.createElement("div",{className:"rule--error"},l?F.createElement(l,{error:s}):s)}},{key:"renderDrag",value:function(){var r=this.props.handleDraggerMouseDown,a=this.meta.showDragIcon,o=this.Icon,u=F.createElement(o,{type:"drag"});return a&&F.createElement("div",{key:"rule-drag-icon",onMouseDown:r,className:"qb-drag-handler rule--drag-handler"},u)}},{key:"renderDel",value:function(){var r=this.props,a=r.config,o=r.isLocked,u=a.settings,i=u.deleteLabel,l=u.immutableGroupsMode,s=u.canDeleteLocked,c=this.Icon,d=this.Btn;return!l&&(!o||o&&s)&&F.createElement(d,{key:"rule-del",type:"delRule",onClick:this.removeSelf,label:i,config:a,renderIcon:c})}},{key:"renderLock",value:function(){var r=this.props,a=r.config,o=r.isLocked,u=r.isTrueLocked,i=r.id,l=a.settings,s=l.lockLabel,c=l.lockedLabel,d=l.showLock,f=this.Switch;return d&&!(o&&!u)&&F.createElement(f,{key:"rule-lock",type:"lock",id:i,value:o,setValue:this.setLock,label:s,checkedLabel:c,hideLabel:!0,config:a})}},{key:"render",value:function(){var r=this.meta,a=r.showOperatorOptions,o=r.selectedFieldWidgetConfig,u=this.props,i=u.valueSrc,l=u.value,s=u.config,c=i?.first()=="value"&&!a&&l.size==1&&o.fullWidth,d=this.BtnGrp,f=[this.renderField(),this.renderOperator(),this.renderBeforeWidget(),this.renderWidget(),this.renderAfterWidget(),this.renderOperatorOptions()],p=F.createElement("div",{key:"rule-body",className:Mt()("rule--body",c&&"can--shrink--value")},f),g=this.renderError(),v=this.renderDrag(),m=this.renderLock(),h=this.renderDel();return F.createElement(F.Fragment,null,v,F.createElement("div",{key:"rule-body-wrapper",className:"rule--body--wrapper"},p,g),F.createElement("div",{key:"rule-header-wrapper",className:"rule--header"},F.createElement(d,{key:"rule-header-group",config:s},m,h)))}}])}(F.Component);Lf.propTypes={id:R().string.isRequired,groupId:R().string,selectedField:R().any,selectedFieldSrc:R().string,selectedFieldType:R().string,selectedOperator:R().string,operatorOptions:R().object,config:R().object.isRequired,value:R().any,valueSrc:R().any,valueType:R().any,asyncListValues:R().array,isDraggingMe:R().bool,isDraggingTempo:R().bool,parentField:R().string,valueError:R().any,fieldError:R().string,isLocked:R().bool,isTrueLocked:R().bool,handleDraggerMouseDown:R().func,setField:R().func,setFieldSrc:R().func,setOperator:R().func,setOperatorOption:R().func,setLock:R().func,removeSelf:R().func,setValue:R().func,setValueSrc:R().func,setFuncValue:R().func,reordableNodesCnt:R().number,totalRulesCnt:R().number,parentReordableNodesCnt:R().number};const U0=zy(oa("rule")(ua(Lf)));var B0=y(22331),$0=y.n(B0);function W0(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,wf()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function wf(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(wf=function(){return!!n})()}var K0=Ye.DefaultUtils.defaultGroupConjunction,z0=function(e,t){var r;return r=function(a){function o(u){var i;return(0,mr.A)(this,o),i=W0(this,o,[u]),i._selectedConjunction=function(l){return l=l||i.props,l.conjunction||K0(l.config,l.field)},i.setConjunction=function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;i.props.actions.setConjunction(i.props.path,l)},i.setNot=function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;i.props.actions.setNot(i.props.path,l)},i.setLock=function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;i.props.actions.setLock(i.props.path,l)},i.dummyFn=function(){},i.removeSelf=function(){i.props.actions.removeGroup(i.props.path)},i.addGroup=function(){i.props.actions.addGroup(i.props.path)},i.addCaseGroup=function(){i.props.actions.addCaseGroup(i.props.path)},i.addDefaultCaseGroup=function(){i.props.actions.addDefaultCaseGroup(i.props.path)},i.addRule=function(){var l=t=="rule_group"?i.props.field:null;i.props.actions.addRule(i.props.path,void 0,void 0,void 0,l)},i.setField=function(l,s,c){i.props.actions.setField(i.props.path,l,s,c)},i.setOperator=function(l){i.props.actions.setOperator(i.props.path,l)},i.setValue=function(l,s,c,d,f){i.props.actions.setValue(i.props.path,l,s,c,d,f)},i.setValueSrc=function(l,s,c){i.props.actions.setValueSrc(i.props.path,l,s,c)},i.setFuncValue=function(l,s,c,d,f,p,g){i.props.actions.setFuncValue(i.props.path,l,s,c,d,f,p,g)},i.pureShouldComponentUpdate=aa(i),ht(i),i.selectedConjunction=i._selectedConjunction(u),i.conjunctionOptions=i._getConjunctionOptions(u),i.dummyFn.isDummyFn=!0,i}return(0,yr.A)(o,a),(0,hr.A)(o,[{key:"shouldComponentUpdate",value:function(i,l){var s=this.props,c=this.state,d=this.pureShouldComponentUpdate(i,l);if(d&&c==l&&s!=i){var f=i.dragging.id||s.dragging.id,p=f==i.id,g=[];for(var v in i){var m=i[v]!=s[v];v=="dragging"&&!p&&(m=!1),m&&g.push(v)}g.length||(d=!1)}return d}},{key:"onPropsChanged",value:function(i){var l=i.config,s=i.id,c=i.conjunction,d=this.props.config,f=this.props.conjunction;(d!=l||f!=c)&&(this.selectedConjunction=this._selectedConjunction(i),this.conjunctionOptions=this._getConjunctionOptions(i))}},{key:"_getConjunctionOptions",value:function(i){var l=this;return mo()(i.config.conjunctions,function(s,c){return{id:"conjunction-".concat(i.id,"-").concat(c),name:"conjunction[".concat(i.id,"]"),key:c,label:s.label,checked:c===l._selectedConjunction(i)}})}},{key:"render",value:function(){var i=this.props.config.settings.showErrorMessage,l=this.props.dragging.id==this.props.id,s=this.props.path.size,c=this.props.config.settings.maxNesting,d=!l&&this.props.isDraggingTempo,f=this.props.fieldType||null,p=this.props.valueError,g=(0,Fe.A)(p?.toArray()||[]).filter(function(O){return!!O}).shift()||null,v=g!=null&&i,m=typeof c>"u"||s<c,h=s==1;return F.createElement("div",{className:Mt()("group-or-rule-container","group-container",v?"group-with-error":null),"data-id":this.props.id},[l?F.createElement(e,{key:"dragging",id:this.props.id,groupId:this.props.groupId,isDraggingMe:!0,isDraggingTempo:!0,dragging:this.props.dragging,isRoot:h,allowFurtherNesting:m,conjunctionOptions:this.conjunctionOptions,not:this.props.not,selectedConjunction:this.selectedConjunction,setConjunction:this.dummyFn,setNot:this.dummyFn,setLock:this.dummyFn,removeSelf:this.dummyFn,addGroup:this.dummyFn,addCaseGroup:this.dummyFn,addDefaultCaseGroup:this.dummyFn,addRule:this.dummyFn,setField:this.dummyFn,setFuncValue:this.dummyFn,setOperator:this.dummyFn,setValue:this.dummyFn,setValueSrc:this.dummyFn,value:this.props.value||null,valueError:this.props.valueError||null,valueSrc:this.props.valueSrc||null,config:this.props.config,children1:this.props.children1,actions:this.props.actions,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,selectedField:this.props.field||null,selectedFieldSrc:this.props.fieldSrc||"field",selectedFieldType:f,parentField:this.props.parentField||null,selectedOperator:this.props.operator||null,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt}):null,F.createElement(e,{key:this.props.id,id:this.props.id,groupId:this.props.groupId,isDraggingMe:l,isDraggingTempo:d,onDragStart:this.props.onDragStart,isRoot:h,allowFurtherNesting:m,conjunctionOptions:this.conjunctionOptions,not:this.props.not,selectedConjunction:this.selectedConjunction,setConjunction:d?this.dummyFn:this.setConjunction,setNot:d?this.dummyFn:this.setNot,setLock:d?this.dummyFn:this.setLock,removeSelf:d?this.dummyFn:this.removeSelf,addGroup:d?this.dummyFn:this.addGroup,addCaseGroup:d?this.dummyFn:this.addCaseGroup,addDefaultCaseGroup:d?this.dummyFn:this.addDefaultCaseGroup,addRule:d?this.dummyFn:this.addRule,setField:d?this.dummyFn:this.setField,setFuncValue:d?this.dummyFn:this.setFuncValue,setOperator:d?this.dummyFn:this.setOperator,setValue:d?this.dummyFn:this.setValue,setValueSrc:d?this.dummyFn:this.setValueSrc,value:this.props.value||null,valueError:this.props.valueError||null,valueSrc:this.props.valueSrc||null,config:this.props.config,children1:this.props.children1,actions:this.props.actions,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,selectedField:this.props.field||null,selectedFieldSrc:this.props.fieldSrc||"field",selectedFieldType:f,parentField:this.props.parentField||null,selectedOperator:this.props.operator||null,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt})])}}])}(F.Component),r.propTypes={config:R().object.isRequired,actions:R().object.isRequired,path:R().any.isRequired,id:R().string.isRequired,groupId:R().string,not:R().bool,conjunction:R().string,children1:R().any,onDragStart:R().func,reordableNodesCnt:R().number,field:R().any,fieldSrc:R().string,fieldType:R().string,parentField:R().string,value:R().any,valueSrc:R().any,valueError:R().any,isLocked:R().bool,isTrueLocked:R().bool,dragging:R().object,isDraggingTempo:R().bool},r};const Ia=function(n,e){var t=yo(function(r){return{dragging:r.dragging}},null,null,{context:Pa})(z0(n,e));return t.displayName="ConnectedGroupContainer",t};function H0(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,jf()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function jf(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(jf=function(){return!!n})()}var J0={topLeft:"group--actions--tl",topCenter:"group--actions--tc",topRight:"group--actions--tr",bottomLeft:"group--actions--bl",bottomCenter:"group--actions--bc",bottomRight:"group--actions--br"},q0="topRight",Rf=function(n){function e(){return(0,mr.A)(this,e),H0(this,e,arguments)}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"render",value:function(){var r=this.props,a=r.config,o=r.addRule,u=r.addGroup,i=r.removeSelf,l=r.setLock,s=r.isLocked,c=r.isTrueLocked,d=r.id,f=r.canAddGroup,p=r.canAddRule,g=r.canDeleteGroup,v=a.settings,m=v.immutableGroupsMode,h=v.addRuleLabel,O=v.addGroupLabel,b=v.delGroupLabel,S=v.groupActionsPosition,C=v.renderButton,L=v.renderIcon,w=v.renderSwitch,N=v.renderButtonGroup,V=v.lockLabel,P=v.lockedLabel,M=v.showLock,B=v.canDeleteLocked,_=function(le){return L(le,a.ctx)},q=function(le){return C(le,a.ctx)},K=function(le){return w(le,a.ctx)},J=function(le){return N(le,a.ctx)},U=J0[S||q0],te=M&&!(s&&!c)&&F.createElement(K,{type:"lock",id:d,value:s,setValue:l,label:V,checkedLabel:P,config:a}),Q=!m&&p&&!s&&F.createElement(q,{type:"addRule",onClick:o,label:h,readonly:s,config:a,renderIcon:_}),ae=!m&&f&&!s&&F.createElement(q,{type:"addGroup",onClick:u,label:O,readonly:s,config:a,renderIcon:_}),ce=!m&&g&&(!s||s&&B)&&F.createElement(q,{type:"delGroup",onClick:i,label:b,config:a,renderIcon:_});return F.createElement("div",{className:"group--actions ".concat(U)},F.createElement(J,{config:a},te,Q,ae,ce))}}])}(F.PureComponent);function Pf(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function xf(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Pf(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Pf(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function Q0(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,If()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function If(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(If=function(){return!!n})()}var Y0=Ye.RuleUtils.isEmptyGroupChildren,X0="topRight",un=function(n){function e(t){var r;return(0,mr.A)(this,e),r=Q0(this,e,[t]),r.childrenClassName=function(){return""},r.renderBeforeActions=function(){var a=r.BeforeActions;return a==null?null:F.createElement(a,(0,nr.A)({key:"group-actions-before"},r.props))},r.renderAfterActions=function(){var a=r.AfterActions;return a==null?null:F.createElement(a,(0,nr.A)({key:"group-actions-after"},r.props))},ht(r),r.onPropsChanged(t),r.removeSelf=r.removeSelf.bind(r),r.setLock=r.setLock.bind(r),r.renderItem=r.renderItem.bind(r),r}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"onPropsChanged",value:function(r){var a=this,o=this.props,u=!this.Icon||o?.config!==r?.config;if(u){var i=r.config,l=i.settings,s=l.renderIcon,c=l.renderConjs,d=l.renderBeforeActions,f=l.renderAfterActions;this.Icon=Ot(i,s),this.Conjs=Ot(i,c),this.BeforeActions=Ot(i,d),this.AfterActions=Ot(i,f)}this.doRemove=function(){a.props.removeSelf()}}},{key:"isGroupTopPosition",value:function(){return $0()(this.props.config.settings.groupActionsPosition||X0,"top")}},{key:"setLock",value:function(r){this.props.setLock(r)}},{key:"removeSelf",value:function(){var r=this.props,a=r.confirmFn,o=r.config,u=o.settings,i=u.renderConfirm,l=u.removeGroupConfirmOptions;l&&!this.isEmptyCurrentGroup()?i.call(o.ctx,xf(xf({},l),{},{onOk:this.doRemove,onCancel:null,confirmFn:a}),o.ctx):this.doRemove()}},{key:"isEmptyCurrentGroup",value:function(){var r=this.props,a=r.children1,o=r.config;return Y0(a,o)}},{key:"showNot",value:function(){var r=this.props.config;return r.settings.showNot}},{key:"showConjs",value:function(){var r=this.props,a=r.conjunctionOptions,o=r.children1,u=r.config,i=Object.keys(a).length;return i>1||this.showNot()}},{key:"isNoChildren",value:function(){var r=this.props.children1;return r?r.size==0:!0}},{key:"isOneChild",value:function(){var r=this.props.children1;return r?r.size<2:!0}},{key:"renderChildrenWrapper",value:function(){var r=this.props.children1;return r&&F.createElement("div",{key:"group-children",className:Mt()("group--children",this.showConjs()?"":"hide--conjs",this.isOneChild()?"hide--line":"",this.isOneChild()?"one--child":"",this.childrenClassName())},this.renderChildren())}},{key:"renderHeaderWrapper",value:function(){var r=this.isGroupTopPosition();return F.createElement("div",{key:"group-header",className:Mt()("group--header",this.isOneChild()?"one--child":"",this.showConjs()?"":"hide--conjs",this.isOneChild()?"hide--line":"",this.isNoChildren()?"no--children":"")},this.renderHeader(),r&&this.renderBeforeActions(),r&&this.renderActions(),r&&this.renderAfterActions())}},{key:"renderFooterWrapper",value:function(){var r=this.isGroupTopPosition();return!r&&F.createElement("div",{key:"group-footer",className:"group--footer"},this.renderBeforeActions(),this.renderActions(),this.renderAfterActions())}},{key:"renderActions",value:function(){var r=this.props,a=r.config,o=r.addRule,u=r.addGroup,i=r.isLocked,l=r.isTrueLocked,s=r.id;return F.createElement(Rf,{key:"group-actions",config:a,addRule:o,addGroup:u,canAddGroup:this.canAddGroup(),canAddRule:this.canAddRule(),canDeleteGroup:this.canDeleteGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:i,isTrueLocked:l,id:s})}},{key:"canAddGroup",value:function(){return this.props.allowFurtherNesting}},{key:"canAddRule",value:function(){var r=this.props.config.settings.maxNumberOfRules,a=this.props.totalRulesCnt;return r?a<r:!0}},{key:"canDeleteGroup",value:function(){return!this.props.isRoot}},{key:"renderChildren",value:function(){var r=this.props.children1;return r?r.valueSeq().toArray().map(this.renderItem):null}},{key:"renderItem",value:function(r){if(r){var a=this.props,o=a.config,u=a.actions,i=a.onDragStart,l=a.isLocked,s=r.get("type")=="group"&&r.getIn(["properties","field"])!=null,c=s?"rule_group":r.get("type");return F.createElement(cu,(0,nr.A)({},this.extraPropsForItem(r),{key:r.get("id"),id:r.get("id"),groupId:a.id,path:r.get("path"),type:c,properties:r.get("properties"),config:o,actions:u,children1:r.get("children1"),reordableNodesCnt:this.reordableNodesCntForItem(r),totalRulesCnt:this.totalRulesCntForItem(r),parentReordableNodesCnt:this.reordableNodesCnt(),onDragStart:i,isDraggingTempo:this.props.isDraggingTempo,isParentLocked:l}))}}},{key:"extraPropsForItem",value:function(r){return{}}},{key:"reordableNodesCnt",value:function(){return this.props.isLocked?0:this.props.reordableNodesCnt}},{key:"totalRulesCntForItem",value:function(r){return this.props.totalRulesCnt}},{key:"reordableNodesCntForItem",value:function(r){return this.props.isLocked?0:this.reordableNodesCnt()}},{key:"showDragIcon",value:function(){var r=this.props,a=r.config,o=r.isRoot,u=r.isLocked,i=this.reordableNodesCnt();return a.settings.canReorder&&!o&&i>1&&!u}},{key:"renderDrag",value:function(){var r=this.props.handleDraggerMouseDown,a=this.Icon,o=F.createElement(a,{type:"drag"});return this.showDragIcon()&&F.createElement("div",{key:"group-drag-icon",onMouseDown:r,className:"qb-drag-handler group--drag-handler"},o)}},{key:"conjunctionOptions",value:function(){var r=this.props.conjunctionOptions;return r}},{key:"renderConjs",value:function(){var r=this.props,a=r.config,o=r.children1,u=r.id,i=r.selectedConjunction,l=r.setConjunction,s=r.not,c=r.setNot,d=r.isLocked,f=a.settings,p=f.immutableGroupsMode,g=f.renderConjs,v=f.showNot,m=f.notLabel,h=this.conjunctionOptions();if(!this.showConjs()||!o||!o.size)return null;var O={disabled:this.isOneChild(),readonly:p||d,selectedConjunction:i,setConjunction:p?yt:l,conjunctionOptions:h,config:a,not:s||!1,id:u,setNot:p?yt:c,notLabel:m,showNot:this.showNot(),isLocked:d},b=this.Conjs;return F.createElement(b,(0,nr.A)({key:"group-conjs"},O))}},{key:"renderHeader",value:function(){return F.createElement("div",{key:"group-conjunctions",className:"group--conjunctions"},this.renderConjs(),this.renderDrag())}},{key:"render",value:function(){return F.createElement(F.Fragment,null,this.renderHeaderWrapper(),this.renderChildrenWrapper(),this.renderFooterWrapper())}}])}(F.Component);un.propTypes={reordableNodesCnt:R().number,conjunctionOptions:R().object.isRequired,allowFurtherNesting:R().bool.isRequired,isRoot:R().bool.isRequired,not:R().bool,selectedConjunction:R().string,config:R().object.isRequired,id:R().string.isRequired,groupId:R().string,path:R().any,children1:R().any,isDraggingMe:R().bool,isDraggingTempo:R().bool,isLocked:R().bool,isTrueLocked:R().bool,handleDraggerMouseDown:R().func,onDragStart:R().func,addRule:R().func.isRequired,addGroup:R().func.isRequired,removeSelf:R().func.isRequired,setConjunction:R().func.isRequired,setNot:R().func.isRequired,setLock:R().func.isRequired,actions:R().object.isRequired};const Z0=Ia(oa("group")(ua(un)),"group");function eO(n,e){for(;!{}.hasOwnProperty.call(n,e)&&(n=(0,we.A)(n))!==null;);return n}function It(){return It=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(n,e,t){var r=eO(n,e);if(r){var a=Object.getOwnPropertyDescriptor(r,e);return a.get?a.get.call(arguments.length<3?n:t):a.value}},It.apply(null,arguments)}function rO(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,Vf()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function Vf(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Vf=function(){return!!n})()}var tO=function(n){function e(){return(0,mr.A)(this,e),rO(this,e,arguments)}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"render",value:function(){var r=this.props,a=r.config,o=r.addRule,u=r.canAddRule,i=r.canDeleteGroup,l=r.removeSelf,s=r.setLock,c=r.isLocked,d=r.isTrueLocked,f=r.id,p=a.settings,g=p.immutableGroupsMode,v=p.addRuleLabel,m=p.delGroupLabel,h=p.renderButton,O=p.renderIcon,b=p.renderSwitch,S=p.renderButtonGroup,C=p.lockLabel,L=p.lockedLabel,w=p.showLock,N=p.canDeleteLocked,V=function(U){return O(U,a.ctx)},P=function(U){return h(U,a.ctx)},M=function(U){return b(U,a.ctx)},B=function(U){return S(U,a.ctx)},_=w&&!(c&&!d)&&F.createElement(M,{type:"lock",id:f,value:c,setValue:s,label:C,checkedLabel:L,hideLabel:!0,config:a}),q=!g&&u&&!c&&F.createElement(P,{type:"addRuleGroup",onClick:o,label:v,readonly:c,config:a,renderIcon:V}),K=!g&&i&&(!c||c&&N)&&F.createElement(P,{type:"delRuleGroup",onClick:l,label:m,config:a,renderIcon:V});return F.createElement("div",{className:"group--actions"},F.createElement(B,{config:a},_,q,K))}}])}(F.PureComponent);function Df(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Nf(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Df(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Df(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function nO(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,kf()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function kf(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(kf=function(){return!!n})()}var _f=function(n){function e(t){var r;return(0,mr.A)(this,e),r=nO(this,e,[t]),r.childrenClassName=function(){return"rule_group--children"},r.renderHeaderWrapper=function(){return null},r.renderFooterWrapper=function(){return null},r.renderConjs=function(){return null},r.canAddGroup=function(){return!1},r.canAddRule=function(){return!0},r.canDeleteGroup=function(){return!1},r}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"onPropsChanged",value:function(r){It((0,we.A)(e.prototype),"onPropsChanged",this).call(this,r)}},{key:"reordableNodesCntForItem",value:function(r){if(this.props.isLocked)return 0;var a=this.props.children1;return a?.size||0}},{key:"renderChildrenWrapper",value:function(){return F.createElement(F.Fragment,null,this.renderDrag(),this.renderField(),this.renderActions(),It((0,we.A)(e.prototype),"renderChildrenWrapper",this).call(this))}},{key:"renderField",value:function(){var r=this.props,a=r.config,o=r.selectedField,u=r.selectedFieldSrc,i=r.selectedFieldType,l=r.setField,s=r.setFuncValue,c=r.setFieldSrc,d=r.parentField,f=r.id,p=r.groupId,g=r.isLocked,v=a.settings.immutableFieldsMode;return F.createElement(lu,{key:"field",classname:"group--field",config:a,canSelectFieldSource:!1,selectedField:o,selectedFieldSrc:u,selectedFieldType:i,setField:l,setFuncValue:s,setFieldSrc:c,parentField:d,readonly:v||g,id:f,groupId:p})}},{key:"renderActions",value:function(){var r=this.props,a=r.config,o=r.addRule,u=r.isLocked,i=r.isTrueLocked,l=r.id;return F.createElement(tO,{config:a,addRule:o,canAddRule:this.canAddRule(),canDeleteGroup:this.canDeleteGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:u,isTrueLocked:i,id:l})}},{key:"extraPropsForItem",value:function(r){return{parentField:this.props.selectedField}}}])}(un);_f.propTypes=Nf(Nf({},un.propTypes),{},{selectedField:R().any,selectedFieldSrc:R().string,parentField:R().string,setField:R().func,setFieldSrc:R().func});const aO=Ia(oa("group rule_group")(ua(_f)),"rule_group");function oO(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,Mf()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function Mf(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Mf=function(){return!!n})()}var iO=function(n){function e(){return(0,mr.A)(this,e),oO(this,e,arguments)}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"render",value:function(){var r=this.props,a=r.config,o=r.addRule,u=r.canAddRule,i=r.canDeleteGroup,l=r.removeSelf,s=r.setLock,c=r.isLocked,d=r.isTrueLocked,f=r.id,p=a.settings,g=p.immutableGroupsMode,v=p.addSubRuleLabel,m=p.delGroupLabel,h=p.renderButton,O=p.renderIcon,b=p.renderSwitch,S=p.renderButtonGroup,C=p.lockLabel,L=p.lockedLabel,w=p.showLock,N=p.canDeleteLocked,V=function(U){return O(U,a.ctx)},P=function(U){return h(U,a.ctx)},M=function(U){return b(U,a.ctx)},B=function(U){return S(U,a.ctx)},_=w&&!(c&&!d)&&F.createElement(M,{type:"lock",id:f,value:c,setValue:s,label:C,checkedLabel:L,config:a}),q=!g&&u&&!c&&F.createElement(P,{type:"addRuleGroupExt",onClick:o,label:v,readonly:c,config:a,renderIcon:V}),K=!g&&i&&(!c||c&&N)&&F.createElement(P,{type:"delRuleGroup",onClick:l,label:m,config:a,renderIcon:V});return F.createElement("div",{className:"group--actions group--actions--tr"},F.createElement(B,{config:a},_,q,K))}}])}(F.PureComponent);function Gf(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Uf(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Gf(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Gf(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function uO(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=lO(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,u=!1,i;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return o=s.done,s},e:function(s){u=!0,i=s},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(u)throw i}}}}function lO(n,e){if(n){if(typeof n=="string")return Bf(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Bf(n,e)}}function Bf(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function sO(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,$f()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function $f(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return($f=function(){return!!n})()}var Wf=Ye.ConfigUtils,Kf=Wf.getFieldConfig,cO=Wf.getFieldWidgetConfig,dO=Ye.RuleUtils.isEmptyRuleGroupExtPropertiesAndChildren,zf=function(n){function e(t){var r;return(0,mr.A)(this,e),r=sO(this,e,[t]),r.childrenClassName=function(){return"rule_group_ext--children"},r.renderFooterWrapper=function(){return null},r.canAddGroup=function(){return!1},r.canAddRule=function(){return!0},r.canDeleteGroup=function(){return!0},r}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"onPropsChanged",value:function(r){It((0,we.A)(e.prototype),"onPropsChanged",this).call(this,r)}},{key:"renderHeaderWrapper",value:function(){return F.createElement("div",{key:"group-header",className:Mt()("group--header",this.isOneChild()?"one--child":"",this.isOneChild()?"hide--line":"",this.isNoChildren()?"no--children":"",this.showDragIcon()?"with--drag":"hide--drag",this.showConjs()&&(!this.isOneChild()||this.showNot())?"with--conjs":"hide--conjs")},this.renderHeader(),this.renderGroupField(),this.renderActions())}},{key:"renderHeader",value:function(){return F.createElement("div",{className:"group--conjunctions"},this.renderConjs(),this.renderDrag())}},{key:"renderGroupField",value:function(){return F.createElement("div",{className:"group--field--count--rule"},this.renderField(),this.renderOperator(),this.renderWidget(),this.renderError())}},{key:"renderError",value:function(){var r=this.props,a=r.config,o=r.valueError,u=a.settings,i=u.renderRuleError,l=u.showErrorMessage,s=(0,Fe.A)(o?.toArray()||[]).filter(function(c){return!!c}).shift()||null;return l&&s&&F.createElement("div",{className:"rule_group--error"},i?i({error:s},a.ctx):s)}},{key:"showNot",value:function(){var r=this.props,a=r.config,o=r.selectedField,u=r.selectedOperator,i=Kf(a,o)||{};return i.showNot!=null?i.showNot:a.settings.showNot}},{key:"conjunctionOptions",value:function(){var r=this.props,a=r.config,o=r.selectedField,u=r.selectedOperator,i=Kf(a,o)||{},l=It((0,we.A)(e.prototype),"conjunctionOptions",this).call(this);if(i.conjunctions){var s={},c=uO(i.conjunctions),d;try{for(c.s();!(d=c.n()).done;){var f=d.value,p=l[f];p&&(s[f]=p)}}catch(g){c.e(g)}finally{c.f()}l=s}return l}},{key:"renderField",value:function(){var r=this.props,a=r.config,o=r.selectedField,u=r.selectedFieldSrc,i=r.selectedFieldType,l=r.setField,s=r.setFieldSrc,c=r.setFuncValue,d=r.parentField,f=r.id,p=r.groupId,g=r.isLocked,v=a.settings.immutableFieldsMode;return F.createElement(lu,{key:"field",classname:"rule--field",config:a,canSelectFieldSource:!1,selectedField:o,selectedFieldSrc:u,selectedFieldType:i,setField:l,setFuncValue:c,setFieldSrc:s,parentField:d,readonly:v||g,id:f,groupId:p})}},{key:"renderOperator",value:function(){var r=this.props,a=r.config,o=r.selectedField,u=r.selectedFieldSrc,i=r.selectedOperator,l=r.setField,s=r.setOperator,c=r.isLocked,d=a.settings.immutableFieldsMode,f=cO(a,o,i)||{},p=f.hideOperator,g=o&&p&&f.operatorInlineLabel,v=o&&!p;return F.createElement(zd,{key:"operator",classname:"group--operator",config:a,selectedField:o,selectedFieldSrc:u,selectedOperator:i,setOperator:s,showOperator:v,showOperatorLabel:g,selectedFieldWidgetConfig:f,readonly:d||c,id:this.props.id,groupId:this.props.groupId})}},{key:"isEmptyCurrentGroup",value:function(){var r=this.props,a=r.children1,o=r.config,u=this._buildWidgetProps(this.props);return dO(u,a,o)}},{key:"_buildWidgetProps",value:function(r){var a=r.selectedField,o=r.selectedFieldSrc,u=r.selectedFieldType,i=r.selectedOperator,l=r.operatorOptions,s=r.value,c=r.valueType,d=r.valueSrc,f=r.asyncListValues,p=r.valueError,g=r.fieldError,v=r.parentField;return{field:a,fieldSrc:o,fieldType:u,operator:i,operatorOptions:l,value:s,valueType:c,valueSrc:["value"],valueError:p,fieldError:null,parentField:v}}},{key:"renderWidget",value:function(){var r=this.props,a=r.config,o=r.selectedField,u=r.selectedOperator,i=r.isLocked,l=a.settings.immutableValuesMode,s=o&&u,c=s;if(!c)return null;var d=F.createElement(xa,(0,nr.A)({key:"values",isForRuleGroup:!0},this._buildWidgetProps(this.props),{config:a,setValue:l?yt:this.props.setValue,setValueSrc:yt,readonly:l||i,id:this.props.id,groupId:this.props.groupId}));return F.createElement(Kr,{key:"widget-for-"+this.props.selectedOperator,className:"rule--value"},d)}},{key:"renderActions",value:function(){var r=this.props,a=r.config,o=r.addRule,u=r.isLocked,i=r.isTrueLocked,l=r.id;return F.createElement(iO,{config:a,addRule:o,canAddRule:this.canAddRule(),canDeleteGroup:this.canDeleteGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:u,isTrueLocked:i,id:l})}},{key:"reordableNodesCntForItem",value:function(r){if(this.props.isLocked)return 0;var a=this.props.children1;return a?.size||0}},{key:"extraPropsForItem",value:function(r){return{parentField:this.props.selectedField}}}])}(un);zf.propTypes=Uf(Uf({},un.propTypes),{},{selectedField:R().any,selectedFieldSrc:R().string,selectedOperator:R().string,value:R().any,parentField:R().string,setField:R().func,setFieldSrc:R().func,setOperator:R().func,setValue:R().func,valueError:R().any});const fO=Ia(oa("group rule_group_ext")(ua(zf)),"rule_group");function pO(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,Hf()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function Hf(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Hf=function(){return!!n})()}var vO={topLeft:"group--actions--tl",topCenter:"group--actions--tc",topRight:"group--actions--tr",bottomLeft:"group--actions--bl",bottomCenter:"group--actions--bc",bottomRight:"group--actions--br"},gO="topRight",mO=function(n){function e(){return(0,mr.A)(this,e),pO(this,e,arguments)}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"render",value:function(){var r=this.props,a=r.config,o=r.addCaseGroup,u=r.addDefaultCaseGroup,i=r.setLock,l=r.isLocked,s=r.isTrueLocked,c=r.id,d=r.canAddGroup,f=r.canAddDefault,p=a.settings,g=p.immutableGroupsMode,v=p.addCaseLabel,m=p.addDefaultCaseLabel,h=p.groupActionsPosition,O=p.renderButton,b=p.renderIcon,S=p.renderSwitch,C=p.renderButtonGroup,L=p.lockLabel,w=p.lockedLabel,N=p.showLock,V=function(te){return b(te,a.ctx)},P=function(te){return O(te,a.ctx)},M=function(te){return S(te,a.ctx)},B=function(te){return C(te,a.ctx)},_=vO[h||gO],q=N&&!(l&&!s)&&F.createElement(M,{type:"lock",id:c,value:l,setValue:i,label:L,checkedLabel:w,config:a}),K=!g&&d&&!l&&F.createElement(P,{type:"addCaseGroup",onClick:o,label:v,readonly:l,config:a,renderIcon:V}),J=!g&&f&&!l&&F.createElement(P,{type:"addDefaultCaseGroup",onClick:u,label:m,readonly:l,config:a,renderIcon:V});return F.createElement("div",{className:"group--actions ".concat(_)},F.createElement(B,{config:a},q,K,J))}}])}(F.PureComponent);function Jf(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function hO(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Jf(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Jf(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function yO(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,qf()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function qf(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(qf=function(){return!!n})()}var Qf=Ye.TreeUtils,OO=Qf.getTotalReordableNodesCountInTree,bO=Qf.getTotalRulesCountInTree,Yf=function(n){function e(t){var r;return(0,mr.A)(this,e),r=yO(this,e,[t]),r.childrenClassName=function(){return"switch_group--children"},r.renderFooterWrapper=function(){return null},r.hasDefaultCase=function(){var a;return((a=r.props.children1)===null||a===void 0?void 0:a.size)&&r.props.children1.filter(function(o){return o.get("children1")==null}).size>0},r}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"onPropsChanged",value:function(r){It((0,we.A)(e.prototype),"onPropsChanged",this).call(this,r)}},{key:"canAddGroup",value:function(){var r,a=this.props.config.settings.maxNumberOfCases,o=((r=this.props.children1)===null||r===void 0?void 0:r.size)||0;return a?o<a:!0}},{key:"canAddRule",value:function(){return!1}},{key:"reordableNodesCnt",value:function(){var r,a=((r=this.props.children1)===null||r===void 0?void 0:r.size)||0,o=a;return this.hasDefaultCase()&&o--,o}},{key:"totalRulesCntForItem",value:function(r){return bO(r)}},{key:"reordableNodesCntForItem",value:function(r){var a;if(this.props.isLocked)return 0;var o=this.props.config.settings,u=o.canLeaveEmptyCase,i=o.canRegroupCases,l=((a=this.props.children1)===null||a===void 0?void 0:a.size)||0,s=l;this.hasDefaultCase()&&s--;var c=OO(r),d=c;return d==1&&i&&u&&s>1&&(d=111),d}},{key:"renderHeaderWrapper",value:function(){return F.createElement("div",{key:"group-header",className:Mt()("group--header",this.isOneChild()?"one--child":"",this.isOneChild()?"hide--line":"",this.isNoChildren()?"no--children":"",this.showDragIcon()?"with--drag":"hide--drag")},this.renderHeader(),this.renderActions())}},{key:"renderHeader",value:function(){return F.createElement("div",{className:"group--conjunctions"},this.renderConjs(),this.renderDrag())}},{key:"renderConjs",value:function(){var r=this.props.config,a=r.settings.renderSwitchPrefix;return a||null}},{key:"showNot",value:function(){return!1}},{key:"renderActions",value:function(){var r=this.props,a=r.config,o=r.addCaseGroup,u=r.addDefaultCaseGroup,i=r.isLocked,l=r.isTrueLocked,s=r.id;return F.createElement(mO,{config:a,addCaseGroup:o,addDefaultCaseGroup:u,canAddDefault:!this.hasDefaultCase(),canAddGroup:this.canAddGroup(),setLock:this.setLock,isLocked:i,isTrueLocked:l,id:s})}}])}(un);Yf.propTypes=hO({},un.propTypes);const SO=Ia(oa("group switch_group")(ua(Yf)),"switch_group");function Xf(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Zf(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Xf(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Xf(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function FO(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,ep()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function ep(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ep=function(){return!!n})()}var rp=function(n){function e(t){var r;return(0,mr.A)(this,e),r=FO(this,e,[t]),r.childrenClassName=function(){return"case_group--children"},r.renderFooterWrapper=function(){return null},r}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"onPropsChanged",value:function(r){var a=this.props,o=!this.renderBeforeCaseValue||a?.config!==r?.config;if(It((0,we.A)(e.prototype),"onPropsChanged",this).call(this,r),o){var u=r.config,i=u.settings,l=i.renderBeforeCaseValue,s=i.renderAfterCaseValue,c=i.renderRuleError;this.BeforeCaseValue=Ot(u,l),this.AfterCaseValue=Ot(u,s),this.RuleError=Ot(u,c)}}},{key:"isDefaultCase",value:function(){return this.props.children1==null}},{key:"reordableNodesCnt",value:function(){return this.props.parentReordableNodesCnt}},{key:"reordableNodesCntForItem",value:function(r){return this.props.isLocked?0:this.props.reordableNodesCnt}},{key:"totalRulesCntForItem",value:function(r){return this.props.totalRulesCnt}},{key:"showDragIcon",value:function(){return this.isDefaultCase()?!1:It((0,we.A)(e.prototype),"showDragIcon",this).call(this)}},{key:"renderHeaderWrapper",value:function(){return F.createElement("div",{key:"group-header",className:Mt()("group--header",this.isOneChild()?"one--child":"",this.isOneChild()?"hide--line":"",this.isNoChildren()?"no--children":"",this.showDragIcon()?"with--drag":"hide--drag",this.showConjs()&&(!this.isOneChild()||this.showNot())?"with--conjs":"hide--conjs")},this.renderHeaderLeft(),this.renderHeaderCenter(),this.renderActions())}},{key:"renderChildrenWrapper",value:function(){return this.isDefaultCase()?null:F.createElement("div",{className:"case_group--body"},this.renderCondition(),this.renderBeforeValue(),this.renderValue(),this.renderAfterValue())}},{key:"renderHeaderLeft",value:function(){if(this.isDefaultCase()){var r=this.props.config.settings.defaultCaseLabel;return r||""}return F.createElement("div",{className:"group--conjunctions"},this.renderConjs(),this.renderDrag(),this.renderError())}},{key:"renderCondition",value:function(){return this.isDefaultCase()?null:It((0,we.A)(e.prototype),"renderChildrenWrapper",this).call(this)}},{key:"renderHeaderCenter",value:function(){return this.isDefaultCase()?F.createElement("div",null,this.renderValue(),this.renderError()):null}},{key:"canAddGroup",value:function(){return this.isDefaultCase()?!1:It((0,we.A)(e.prototype),"canAddGroup",this).call(this)}},{key:"canAddRule",value:function(){return this.isDefaultCase()?!1:It((0,we.A)(e.prototype),"canAddRule",this).call(this)}},{key:"renderBeforeValue",value:function(){var r=this.BeforeCaseValue;return r==null?null:F.createElement(r,(0,nr.A)({key:"values-before"},this.props))}},{key:"renderAfterValue",value:function(){var r=this.AfterCaseValue;return r==null?null:F.createElement(r,(0,nr.A)({key:"values-after"},this.props))}},{key:"renderError",value:function(){var r=this.props,a=r.config,o=r.valueError,u=a.settings.showErrorMessage,i=this.RuleError,l=(0,Fe.A)(o?.toArray()||[]).filter(function(s){return!!s}).shift()||null;return u&&l&&F.createElement("div",{className:"rule--error"},i?F.createElement(i,{error:l}):l)}},{key:"renderValue",value:function(){var r=this.props,a=r.config,o=r.isLocked,u=r.value,i=r.valueSrc,l=r.valueError,s=r.setValue,c=r.setValueSrc,d=r.setFuncValue,f=r.id,p=a.settings.immutableValuesMode,g=F.createElement(xa,{key:"values",isCaseValue:!0,field:"!case_value",operator:null,value:u,valueSrc:i??"value",valueError:l,fieldError:null,config:a,setValue:p?yt:s,setValueSrc:p?yt:c,setFuncValue:p?yt:d,readonly:p||o,id:f,groupId:null});return F.createElement(Kr,{className:"case_group--value"},g)}},{key:"renderActions",value:function(){var r=this.props,a=r.config,o=r.addGroup,u=r.addRule,i=r.isLocked,l=r.isTrueLocked,s=r.id;return F.createElement(Rf,{config:a,addGroup:o,addRule:u,canAddRule:this.canAddRule(),canAddGroup:this.canAddGroup(),canDeleteGroup:this.canDeleteGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:i,isTrueLocked:l,id:s})}},{key:"isEmptyCurrentGroup",value:function(){var r=this.props.value,a=r&&r.size?r.get(0):null,o=a!=null&&(Array.isArray(a)?a.length>0:!0);return It((0,we.A)(e.prototype),"isEmptyCurrentGroup",this).call(this)&&!o}}])}(un);rp.propTypes=Zf(Zf({},un.propTypes),{},{parentReordableNodesCnt:R().number,value:R().any,setValue:R().func});const CO=Ia(oa("group case_group")(ua(rp)),"case_group");var TO=["type"];function EO(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,tp()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function tp(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(tp=function(){return!!n})()}function np(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function su(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?np(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):np(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var AO=["rule","group","rule_group","switch_group","case_group"],la=function(e){var t,r=((t=e.properties)===null||t===void 0?void 0:t.toObject())||{},a=su({},r);return e.isParentLocked&&(a.isLocked=!0),r.isLocked&&(a.isTrueLocked=!0),a},LO={rule:function(e){return F.createElement(U0,(0,nr.A)({},la(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,config:e.config,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,parentField:e.parentField,parentReordableNodesCnt:e.parentReordableNodesCnt}))},group:function(e){return F.createElement(Z0,(0,nr.A)({},la(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:null,parentReordableNodesCnt:e.parentReordableNodesCnt}))},rule_group:function(e){return F.createElement(aO,(0,nr.A)({},la(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:e.parentField,parentReordableNodesCnt:e.parentReordableNodesCnt}))},rule_group_ext:function(e){return F.createElement(fO,(0,nr.A)({},la(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:e.parentField,parentReordableNodesCnt:e.parentReordableNodesCnt}))},switch_group:function(e){return F.createElement(SO,(0,nr.A)({},la(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:null,parentReordableNodesCnt:e.parentReordableNodesCnt}))},case_group:function(e){return F.createElement(CO,(0,nr.A)({},la(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:null,parentReordableNodesCnt:e.parentReordableNodesCnt}))}},cu=function(n){function e(){return(0,mr.A)(this,e),EO(this,e,arguments)}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"render",value:function(){var r,a=this.props,o=a.type,u=(0,_n.A)(a,TO),i=(r=u.properties)===null||r===void 0?void 0:r.get("mode"),l=i=="array"?"_ext":"",s=u.config.settings.renderItem,c=LO[o+l];return s?s(su(su({},u),{},{type:o,itemComponent:c}),u.config.ctx):c?c(u):null}}])}(F.PureComponent);cu.propTypes={config:R().object.isRequired,id:R().string.isRequired,groupId:R().string,type:R().oneOf(AO).isRequired,path:R().any.isRequired,properties:R().any,children1:R().any,actions:R().object.isRequired,reordableNodesCnt:R().number,onDragStart:R().func,parentField:R().string,isDraggingTempo:R().bool,isParentLocked:R().bool};function wO(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,ap()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function ap(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ap=function(){return!!n})()}var op=Ye.TreeUtils,jO=op.getTotalReordableNodesCountInTree,RO=op.getTotalRulesCountInTree,ip=Ye.DefaultUtils,PO=ip.createListWithOneElement,up=ip.emptyProperties,lp=function(n){function e(t){var r;return(0,mr.A)(this,e),r=wO(this,e,[t]),r.pureShouldComponentUpdate=aa(r),r._updPath(t),r}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"shouldComponentUpdate",value:function(r,a){var o=this.pureShouldComponentUpdate(r,a);return o}},{key:"_updPath",value:function(r){var a=r.tree.get("id");this.path=PO(a)}},{key:"render",value:function(){var r=this.props,a=r.tree,o=r.config,u=r.actions,i=r.onDragStart,l=a.get("type"),s=l=="switch_group",c=s?null:jO(a),d=s?null:RO(a),f=a.get("id");return F.createElement(cu,{key:f,id:f,path:this.path,type:l,properties:a.get("properties")||up(),config:o,actions:u,children1:a.get("children1")||up(),reordableNodesCnt:c,totalRulesCnt:d,parentReordableNodesCnt:0,onDragStart:i})}}])}(F.Component);lp.propTypes={tree:R().any.isRequired,config:R().object.isRequired,actions:R().object.isRequired,onDragStart:R().func};const xO=Qy(lp);function sp(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function IO(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?sp(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):sp(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function VO(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,cp()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function cp(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(cp=function(){return!!n})()}var DO=Ye.clone,du=Ye.ConfigUtils,Va=du.getFieldConfig,dp=du.getFieldParts,fp=du.getFieldPathParts,pp=Ye.RuleUtils,vp=pp.getFieldPathLabels,NO=pp.getWidgetForFieldOp,gp=function(n){function e(t){var r;return(0,mr.A)(this,e),r=VO(this,e,[t]),ht(r),r.onPropsChanged(t),r}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"onPropsChanged",value:function(r){var a=this.props,o=["config","field","fieldSrc","fieldType","operator","isFuncArg","parentField"],u=["config","field","fieldSrc","fieldType","operator","value","placeholder","isFuncArg","parentField"],i=!this.items||o.map(function(s){return r[s]!==a[s]}).filter(function(s){return s}).length>0,l=!this.meta||u.map(function(s){return r[s]!==a[s]}).filter(function(s){return s}).length>0;i&&(this.items=this.getItems(r)),l&&(this.meta=this.getMeta(r))}},{key:"getItems",value:function(r){var a=r.config,o=r.field,u=r.fieldType,i=r.operator,l=r.parentField,s=r.isFuncArg,c=r.fieldDefinition,d=a.settings.canCompareFieldWithField,f=dp(l,a),p=l?Va(a,l):null,g=l?p?.subfields:a.fields,v=this.filterFields(a,g,o,l,f,i,d,s,c,u),m=this.buildOptions(f,a,v,f);return m}},{key:"getMeta",value:function(r){var a,o=r.config,u=r.field,i=r.fieldType,l=r.operator,s=r.value,c=r.placeholder,d=r.isFuncArg,f=r.parentField,p=o.settings,g=p.fieldPlaceholder,v=p.fieldSeparatorDisplay,m=s,h=!!s,O=u?Va(o,u):{},b=O==null||(a=O.widgets)===null||a===void 0?void 0:a.field,S=b?.widgetProps||{},C=h?null:d&&c||S.valuePlaceholder||g,L=h?Va(o,m):null,w=L||{},N=fp(m,o),V=fp(m,o,!0),P=this.getFieldLabel(L,m,o),M=vp(m,o),B=M?M.join(v):null;(B==P||f)&&(B=null);var _=w.label2||w.tooltip;return{placeholder:C,selectedKey:m,selectedKeys:N,selectedPath:V,selectedLabel:P,selectedOpts:w,selectedAltLabel:_,selectedFullLabel:B}}},{key:"filterFields",value:function(r,a,o,u,i,l,s,c,d,f){a=DO(a);var p=r.settings.fieldSeparator,g=Va(r,o),v=!1,m=NO(r,o,l,"value"),h=r.widgets[m],O;c?O=d?.type:v&&h?O=h.type:g?O=g.type:O=f;function b(S,C){for(var L in S){var w=S[L].subfields,N=(C||[]).concat(L),V=N.join(p),P=Va(r,V);if(!P)delete S[L];else if(P.type=="!struct"||P.type=="!group")b(w,N)==0&&delete S[L];else{var M=(!O||P.type==O)&&(c?!0:V!=o),B=s||r.settings.canCompareFieldWithField;B&&(M=M&&B(o,g,V,P,l)),M||delete S[L]}}return ia()(S).length}return b(a,i||[]),a}},{key:"buildOptions",value:function(r,a,o){var u=this,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;if(!o)return null;var s=a.settings,c=s.fieldSeparator,d=s.fieldSeparatorDisplay,f=i!=null&&i.length?i.join(c)+c:"";return ia()(o).map(function(p){var g=[].concat((0,Fe.A)(i??[]),[p]),v=o[p],m=u.getFieldLabel(v,g,a),h=vp(g,a),O=h.join(d);(O==m||r)&&(O=null);var b=v.label2,S=v.tooltip;if(!v.hideForCompare)return v.type=="!struct"||v.type=="!group"?{key:p,path:f+p,label:m,fullLabel:O,altLabel:b,tooltip:S,items:u.buildOptions(r,a,v.subfields,g,{label:m,tooltip:S})}:{key:p,path:f+p,label:m,fullLabel:O,altLabel:b,tooltip:S,grouplabel:l?.label,group:l}}).filter(function(p){return!!p})}},{key:"getFieldLabel",value:function(r,a,o){if(!a)return null;var u=o.settings.maxLabelsLength,i=dp(a,o),l=r?.label||Xa()(i);return l=So(l,u),l}},{key:"render",value:function(){var r=this.props,a=r.config,o=r.customProps,u=r.setValue,i=r.readonly,l=r.id,s=r.groupId,c=a.settings.renderField,d=IO({isValueField:!0,config:a,customProps:o,setField:u,readonly:i,items:this.items,id:l,groupId:s},this.meta);return c(d,a.ctx)}}])}(F.Component);gp.propTypes={id:R().string,groupId:R().string,setValue:R().func.isRequired,config:R().object.isRequired,field:R().any,fieldSrc:R().string,fieldType:R().string,value:R().string,operator:R().string,customProps:R().object,readonly:R().bool,parentField:R().string,fieldDefinition:R().object,isFuncArg:R().bool};const kO=function(n){var e=n.value,t=n.setValue,r=n.config,a=n.labelYes,o=n.labelNo,u=n.readonly,i=n.widgetId,l=n.customProps,s=l===void 0?{}:l,c=s.radioYes||{},d=s.radioNo||{},f=function(v){return t(v.target.checked)},p=function(v){return t(v.target.value=="true")};return F.createElement(F.Fragment,null,F.createElement("input",(0,nr.A)({type:"radio",value:!0,checked:!!e,disabled:u,onChange:p},c))," ",a,F.createElement("input",(0,nr.A)({type:"radio",value:!1,checked:!e,disabled:u,onChange:p},d))," ",o)},_O=function(n){var e=n.value,t=n.setValue,r=n.config,a=n.readonly,o=n.placeholder,u=n.maxLength,i=n.customProps,l=function(d){var f=d.target.value;f===""&&(f=void 0),t(f)},s=e||"";return F.createElement("input",(0,nr.A)({type:"text",value:s,placeholder:o,disabled:a,onChange:l,maxLength:u},i))},MO=function(n){var e=n.value,t=n.setValue,r=n.config,a=n.readonly,o=n.placeholder,u=n.maxLength,i=n.maxRows,l=n.fullWidth,s=n.customProps,c=function(p){var g=p.target.value;g===""&&(g=void 0),t(g)},d=e||"";return F.createElement("textarea",(0,nr.A)({value:d,placeholder:o,disabled:a,onChange:c,maxLength:u,style:{width:l?"100%":void 0}},s))};var ES=Ye.moment;const GO=function(n){var e=n.value,t=n.setValue,r=n.config,a=n.valueFormat,o=n.readonly,u=n.customProps,i=function(s){var c=s.target.value;c==""&&(c=void 0),t(c)};return F.createElement("input",(0,nr.A)({type:"date",value:e||"",disabled:o,onChange:i},u))},UO=function(n){var e=n.value,t=n.setValue,r=n.config,a=n.valueFormat,o=n.use12Hours,u=n.readonly,i=n.customProps,l=function(c){var d=c.target.value;d==""&&(d=void 0),t(d)};return F.createElement("input",(0,nr.A)({type:"time",value:e||"",disabled:u,onChange:l},i))};var mp=Ye.moment;const BO=function(n){var e=n.value,t=n.setValue,r=n.config,a=n.valueFormat,o=n.use12Hours,u=n.readonly,i=n.customProps,l=function(d){var f=d.target.value;f==""?f=void 0:f=mp(new Date(f)).format(a),t(f)},s=e;return e?s=mp(e).format("YYYY-MM-DDTHH:mm"):s="",F.createElement("input",(0,nr.A)({type:"datetime-local",value:s,disabled:u,onChange:l},i))};var $O=Ye.ListUtils.mapListValues;const WO=function(n){var e=n.listValues,t=n.value,r=n.setValue,a=n.allowCustomValues,o=n.readonly,u=n.customProps,i=function(){return $O(e,function(d){var f=d.title,p=d.value;return F.createElement("option",{key:p,value:p},f)})},l=function(d){for(var f=[],p=d.options,g=0;g<p.length;g++){var v=p[g];v.selected&&f.push(v.value)}return f.length||(f=void 0),f},s=function(d){return r(l(d.target))};return F.createElement("select",(0,nr.A)({multiple:!0,onChange:s,value:t,disabled:o},Za()(u,["showSearch","input","showCheckboxes"])),i())};var KO=Ye.ListUtils.mapListValues;const zO=function(n){var e=n.listValues,t=n.value,r=n.setValue,a=n.allowCustomValues,o=n.readonly,u=n.customProps,i=function(){return KO(e,function(d){var f=d.title,p=d.value;return F.createElement("option",{key:p,value:p},f)})},l=function(d){return r(d.target.value)},s=t!=null;return F.createElement("select",(0,nr.A)({onChange:l,value:s?t:"",disabled:o},Za()(u,["showSearch","input"])),!s&&F.createElement("option",{disabled:!0,value:""}),i())},HO=function(n){var e=n.value,t=n.setValue,r=n.config,a=n.readonly,o=n.min,u=n.max,i=n.step,l=n.placeholder,s=n.customProps,c=function(p){var g=p.target.value;g===""||g===null?g=void 0:g=Number(g),t(g)},d=e??"";return F.createElement("input",(0,nr.A)({type:"number",value:d,placeholder:l,disabled:a,min:o,max:u,step:i,onChange:c},s))},JO=function(n){var e=n.value,t=n.setValue,r=n.config,a=n.readonly,o=n.min,u=n.max,i=n.step,l=n.placeholder,s=n.customProps,c=s===void 0?{}:s,d=c.input||{},f=c.slider||c,p=function(m){var h=m.target.value;h===""||h===null?h=void 0:h=Number(h),t(h)},g=e??"";return F.createElement("div",{style:{display:"inline-flex"}},F.createElement("input",(0,nr.A)({key:"number",type:"number",value:g,placeholder:l,disabled:a,min:o,max:u,step:i,onChange:p},d)),F.createElement("input",(0,nr.A)({key:"range",type:"range",value:g,disabled:a,min:o,max:u,step:i,onChange:p},f)))},qO=function(n){var e=n.items,t=n.setField,r=n.selectedKey,a=n.readonly,o=n.errorText,u=function s(c){return c.map(function(d){var f=d.items,p=d.path,g=d.label,v=d.disabled,m=d.matchesType;if(f)return F.createElement("optgroup",{disabled:v,key:p,label:g},s(f));var h=m?{fontWeight:"bold"}:{};return F.createElement("option",{disabled:v,key:p,value:p,style:h},g)})},i=function(c){return t(c.target.value)},l=r!=null;return F.createElement("select",{onChange:i,value:l?r:"",disabled:a,style:{color:o?"red":null}},!l&&F.createElement("option",{disabled:!0,value:""}),u(e))},QO=function(n){var e=n.id,t=n.not,r=n.setNot,a=n.conjunctionOptions,o=n.setConjunction,u=n.disabled,i=n.readonly,l=n.config,s=n.showNot,c=n.notLabel,d=Object.keys(a).length,f=u,p=l.settings.forceShowConj,g=p||d>1&&!f,v=function(){return Object.keys(a).map(function(S){var C=a[S],L=C.id,w=C.name,N=C.label,V=C.checked,P=o.isDummyFn?"__dummy":"";return(i||u)&&!V?null:[F.createElement("input",{key:L+P,type:"radio",id:L+P,name:w+P,checked:V,disabled:i||u,value:S,onChange:h}),F.createElement("label",{key:L+P+"label",htmlFor:L+P},N)]})},m=function(){var S="not";return[F.createElement("input",{key:e+S,type:"checkbox",id:e+S,checked:t,disabled:i,onChange:O}),F.createElement("label",{key:e+S+"label",htmlFor:e+S},c||"NOT")]},h=function(S){return o(S.target.value)},O=function(S){return r(S.target.checked)};return[s&&m(),g&&v()]};var YO={addRuleGroup:"+",addRuleGroupExt:"+",delGroup:"x",delRuleGroup:"x",delRule:"x"};const XO=function(n){var e=n.type,t=n.label,r=n.onClick,a=n.readonly,o=t||YO[e];return F.createElement("button",{onClick:r,type:"button",disabled:a},o)},ZO=function(n){var e=n.type,t={},r=t[e]||null;return!r&&e==="drag"&&(r=F.createElement($d,null)),r},eb=function(n){var e=n.children,t=n.config;return F.createElement(F.Fragment,null,e)},rb=function(n){var e=n.config,t=n.valueSources,r=n.valueSrc,a=n.title,o=n.setValueSrc,u=n.readonly,i=function(c){return c.map(function(d){var f=(0,Le.A)(d,2),p=f[0],g=f[1];return F.createElement("option",{key:p,value:p},g.label)})},l=function(c){return o(c.target.value)};return F.createElement("select",{onChange:l,value:r||"",disabled:u},i(t))},tb=function(n){var e=n.value,t=n.setValue,r=n.label,a=n.id,o=n.config,u=n.type,i=function(c){return t(c.target.checked)},l=u;return[F.createElement("input",{key:a+l,type:"checkbox",id:a+l,checked:!!e,onChange:i}),F.createElement("label",{key:a+l+"label",htmlFor:a+l},r)]},nb=function(n){var e=n.onOk,t=n.okText,r=n.cancelText,a=n.title;confirm(a)&&e()};var ab=function(e){var t=e.config,r=e.children;return r};function ob(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,hp()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function hp(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(hp=function(){return!!n})()}var fu=function(n){function e(){var t;(0,mr.A)(this,e);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return t=ob(this,e,[].concat(a)),t.handleChange=function(u){t.props.setOption("proximity",parseInt(u))},t}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"render",value:function(){var r=this.props,a=r.defaults,o=r.options,u=r.config,i=r.optionLabel,l=r.optionPlaceholder,s=r.customProps,c=r.minProximity,d=r.maxProximity,f=r.optionTextBefore,p=r.readonly,g=u.settings,v=u.widgets,m=u.ctx,h=a?a.proximity:void 0,O=g.showLabels,b=o.get("proximity",h),S=nu()(c,d+1).map(function(w){return{title:w,value:w}}),C=v.select.factory,L=function(N){return C(N,m)};return F.createElement("div",{className:"operator--PROXIMITY"},F.createElement("div",{className:"operator--options"},O&&F.createElement("label",{className:"rule--label"},i),!O&&f&&F.createElement("div",{className:"operator--options--sep"},F.createElement("span",null,f)),F.createElement(L,(0,nr.A)({config:u,value:b,listValues:S,setValue:this.handleChange,readonly:p,placeholder:l},s))),F.createElement("div",{className:"operator--widgets"},this.props.children))}}])}(F.PureComponent);fu.propTypes={config:R().object.isRequired,setOption:R().func.isRequired,options:R().any.isRequired,minProximity:R().number,maxProximity:R().number,optionPlaceholder:R().string,optionTextBefore:R().string,optionLabel:R().string,customProps:R().object,readonly:R().bool},fu.defaultProps={customProps:{},minProximity:2,maxProximity:10,optionPlaceholder:"Select words between",optionLabel:"Words between",optionTextBefore:null};function yp(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function ze(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?yp(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):yp(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var ib=ze({},Vr.conjunctions),ub=ze(ze({},Vr.operators),{},{proximity:ze(ze({},Vr.operators.proximity),{},{options:ze(ze({},Vr.operators.proximity.options),{},{factory:function(e,t){var r=t.RCE,a=t.O.ProximityOperator;return r(a,e)}})})}),lb={text:ze(ze({},Vr.widgets.text),{},{factory:function(e,t){var r=t.RCE,a=t.W.VanillaTextWidget;return r(a,e)}}),textarea:ze(ze({},Vr.widgets.textarea),{},{factory:function(e,t){var r=t.RCE,a=t.W.VanillaTextAreaWidget;return r(a,e)}}),number:ze(ze({},Vr.widgets.number),{},{factory:function(e,t){var r=t.RCE,a=t.W.VanillaNumberWidget;return r(a,e)}}),slider:ze(ze({},Vr.widgets.slider),{},{factory:function(e,t){var r=t.RCE,a=t.W.VanillaSliderWidget;return r(a,e)}}),select:ze(ze({},Vr.widgets.select),{},{factory:function(e,t){var r=t.RCE,a=t.W.VanillaSelectWidget;return r(a,e)}}),multiselect:ze(ze({},Vr.widgets.multiselect),{},{factory:function(e,t){var r=t.RCE,a=t.W.VanillaMultiSelectWidget;return r(a,e)}}),date:ze(ze({},Vr.widgets.date),{},{factory:function(e,t){var r=t.RCE,a=t.W.VanillaDateWidget;return r(a,e)}}),time:ze(ze({},Vr.widgets.time),{},{factory:function(e,t){var r=t.RCE,a=t.W.VanillaTimeWidget;return r(a,e)}}),datetime:ze(ze({},Vr.widgets.datetime),{},{factory:function(e,t){var r=t.RCE,a=t.W.VanillaDateTimeWidget;return r(a,e)}}),boolean:ze(ze({},Vr.widgets.boolean),{},{factory:function(e,t){var r=t.RCE,a=t.W.VanillaBooleanWidget;return r(a,e)}}),field:ze(ze({},Vr.widgets.field),{},{factory:function(e,t){var r=t.RCE,a=t.W.ValueFieldWidget;return r(a,e)},customProps:{showSearch:!0}}),func:ze(ze({},Vr.widgets.func),{},{factory:function(e,t){var r=t.RCE,a=t.W.FuncWidget;return r(a,e)},customProps:{}}),case_value:ze(ze({},Vr.widgets.case_value),{},{factory:function(e,t){var r=t.RCE,a=t.W.VanillaTextWidget;return r(a,e)}})},sb=ze(ze({},Vr.types),{},{select:ze(ze({},Vr.types.select),{},{widgets:ze(ze({},Vr.types.select.widgets),{},{select:ze(ze({},Vr.types.select.widgets.select),{},{widgetProps:{customProps:{showSearch:!0}}})})})}),cb=ze(ze({},Vr.settings),{},{renderField:function(e,t){var r=t.RCE,a=t.W.VanillaFieldSelect;return r(a,e)},renderOperator:function(e,t){var r=t.RCE,a=t.W.VanillaFieldSelect;return r(a,e)},renderFunc:function(e,t){var r=t.RCE,a=t.W.VanillaFieldSelect;return r(a,e)},renderConjs:function(e,t){var r=t.RCE,a=t.W.VanillaConjs;return r(a,e)},renderSwitch:function(e,t){var r=t.RCE,a=t.W.VanillaSwitch;return r(a,e)},renderButton:function(e,t){var r=t.RCE,a=t.W.VanillaButton;return r(a,e)},renderIcon:function(e,t){var r=t.RCE,a=t.W.VanillaIcon;return r(a,e)},renderButtonGroup:function(e,t){var r=t.RCE,a=t.W.VanillaButtonGroup;return r(a,e)},renderProvider:function(e,t){var r=t.RCE,a=t.W.VanillaProvider;return r(a,e)},renderValueSources:function(e,t){var r=t.RCE,a=t.W.VanillaValueSources;return r(a,e)},renderFieldSources:function(e,t){var r=t.RCE,a=t.W.VanillaValueSources;return r(a,e)},renderConfirm:function(e,t){var r=t.W.vanillaConfirm;return r(e)},renderSwitchPrefix:"IF",renderBeforeCaseValue:function(e,t){var r=t.RCE;return r("span",{children:[" then "]})},customFieldSelectProps:{showSearch:!0},defaultSliderWidth:"200px",defaultSelectWidth:"200px",defaultSearchWidth:"100px",defaultMaxRows:5,renderSize:"small",maxLabelsLength:100,showLock:!1,showNot:!0,forceShowConj:!1,groupActionsPosition:"topRight"}),db=ze(ze({},Vr.ctx),{},{W:ze({},Je),O:ze({},ke),RCE:function(e,t){return F.createElement(e,t)}}),pu={conjunctions:ib,operators:ub,widgets:lb,types:sb,settings:cb,ctx:db};pu=Ye.ConfigMixins.removeMixins(pu,["rangeslider","treeselect","treemultiselect"]);const zr=pu;var AS=y(38221);function Op(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Ao(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Op(Object(t),!0).forEach(function(r){_defineProperty(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Op(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var Da=Ye.Autocomplete,Lo=Da.mergeListValues,bp=Da.listValueToOption,fb=Da.optionToListValue,pb=Da.optionsToListValues,vb=Da.fixListValuesGroupOrder,sa=Ye.ListUtils,gb=sa.mapListValues,wo=sa.listValuesToArray,jo=sa.getListValue,mb=sa.makeCustomListValue,hb=sa.searchListValue,LS=sa.getItemInListValues;function Sp(n){return new Promise(function(e){setTimeout(e,n)})}var wS=function(e,t){var r=e.asyncFetch,a=e.useLoadMore,o=e.useAsyncSearch,u=e.forceAsyncSearch,i=e.asyncListValues,l=e.listValues,s=e.allowCustomValues,c=e.value,d=e.setValue,f=e.placeholder,p=e.config,g=t.debounceTimeout,v=t.multiple,m=t.uif,h=t.isFieldAutocomplete,O=["LOAD_MORE","LOADING_MORE"],b="Load more...",S="Loading more...",C=u?"Type to search":f,L=React.useState(!1),w=_slicedToArray(L,2),N=w[0],V=w[1],P=React.useState(void 0),M=_slicedToArray(P,2),B=M[0],_=M[1],q=React.useState(0),K=_slicedToArray(q,2),J=K[0],U=K[1],te=React.useState(!1),Q=_slicedToArray(te,2),ae=Q[0],ce=Q[1],ie=React.useState(""),le=_slicedToArray(ie,2),pe=le[0],se=le[1],me=React.useState(void 0),Ce=_slicedToArray(me,2),ge=Ce[0],Ae=Ce[1],Pe=React.useRef(0),Ve=React.useRef(0),Ie=React.useRef(!1),De=React.useMemo(function(){return wo(i)},[i]),Ee=React.useMemo(function(){return r?i?Lo(ge,De,!0):ge:wo(l)},[r,i,ge,l]),Ne=r?ge:wo(l);s&&pe&&!hb(pe,ge)&&(Ne=Lo(Ne,[mb(pe)],!0)),r&&!ge&&i&&!pe&&!N&&m==="antd"&&(Ne=Ee),r&&!s&&i&&m==="mui"&&(Ne=Lo(Ne,De,!0,!0));var Xe=J>0,ar=N&&r&&ge===void 0&&(u?pe:!0),Ze=ar&&Xe,Xr=!Ze&&Ee&&Ee.length>0&&B&&B.hasMore&&(B.filter||"")===pe,Tr=!Xe&&Xr,Pr=gb(Ne,bp),or=c!=null,at=!v&&or?jo(c,Ee):null,bt=function(){var Ur=_asyncToGenerator(_regeneratorRuntime.mark(function Ge(){var $e,tr,sr,Or,Dr,xr,wt,kr,jn,et,Qt,hn,Gt,Yt,Ut,Bt=arguments;return _regeneratorRuntime.wrap(function(Ft){for(;;)switch(Ft.prev=Ft.next){case 0:return $e=Bt.length>0&&Bt[0]!==void 0?Bt[0]:null,tr=Bt.length>1&&Bt[1]!==void 0?Bt[1]:!1,!tr&&B&&_(void 0),sr=tr&&ge?ge.length:0,Or=tr&&B||!a&&{pageSize:0},Dr=++Pe.current,Ft.next=8,r.call(p?.ctx,$e,sr,Or);case 8:if(xr=Ft.sent,wt=Pe.current!=Dr,!(wt||!Ve.current)){Ft.next=12;break}return Ft.abrupt("return",null);case 12:return kr=xr!=null&&xr.values?xr:{values:xr},jn=kr.values,et=kr.hasMore,Qt=kr.meta,hn=wo(jn),tr?(Yt=Lo(ge,hn,!1),Gt=Yt.length>ge.length):(Yt=hn,a&&(Gt=Yt.length>0)),Ut=et!=null||Qt!=null||Gt!=null?Ao(Ao(Ao(Ao({},Gt!=null?{hasMore:Gt}:{}),et!=null?{hasMore:et}:{}),Qt??{}),{},{filter:$e}):void 0,Ut&&_(Ut),Ft.abrupt("return",Yt);case 18:case"end":return Ft.stop()}},Ge)}));return function(){return Ur.apply(this,arguments)}}(),ot=function(){var Ur=_asyncToGenerator(_regeneratorRuntime.mark(function Ge(){var $e,tr,sr,Or=arguments;return _regeneratorRuntime.wrap(function(xr){for(;;)switch(xr.prev=xr.next){case 0:return $e=Or.length>0&&Or[0]!==void 0?Or[0]:null,tr=Or.length>1&&Or[1]!==void 0?Or[1]:!1,U(function(wt){return wt+1}),ce(tr),xr.next=6,bt($e,tr);case 6:if(sr=xr.sent,Ve.current){xr.next=9;break}return xr.abrupt("return");case 9:sr!=null&&Ae(sr),U(function(wt){return wt-1}),ce(!1);case 12:case"end":return xr.stop()}},Ge)}));return function(){return Ur.apply(this,arguments)}}(),St=React.useCallback(debounce(ot,g),[]);React.useEffect(function(){return Ve.current++,ar&&J==0&&Pe.current==0&&_asyncToGenerator(_regeneratorRuntime.mark(function Ur(){return _regeneratorRuntime.wrap(function($e){for(;;)switch($e.prev=$e.next){case 0:return $e.next=2,ot();case 2:case"end":return $e.stop()}},Ur)}))(),function(){Ve.current--}},[ar]);var ir=function(){V(!0)},Lt=function(){var Ur=_asyncToGenerator(_regeneratorRuntime.mark(function Ge($e){var tr,sr;return _regeneratorRuntime.wrap(function(Dr){for(;;)switch(Dr.prev=Dr.next){case 0:if(tr=Ie.current,tr?(Ie.current=!1,v&&V(!1)):V(!1),!(m==="mui"&&!tr)){Dr.next=6;break}return sr="",Dr.next=6,ur(null,sr,"my-reset");case 6:case"end":return Dr.stop()}},Ge)}));return function($e){return Ur.apply(this,arguments)}}(),Vt=function(Ge){Ge?ir():Lt()},Hr=function(Ge){var $e=Ge?.specialValue||Ge?.value;return O.includes($e)},it=function(){var Ur=_asyncToGenerator(_regeneratorRuntime.mark(function Ge($e,tr,sr){var Or,Dr,xr,wt,kr,jn,et,Qt,hn,Gt,Yt,Ut,Bt,Na,Ft,Io,vt;return _regeneratorRuntime.wrap(function(gr){for(;;)switch(gr.prev=gr.next){case 0:if(Dr=v&&m==="mui"&&sr==="clear",xr=!v&&m==="mui"&&sr==="clear"&&$e?.type==="change",wt=!v&&m==="mui"&&sr==="clear"&&$e?.type!=="change",m==="mui"&&(sr=tr,v?tr=sr.map(function(Dt){var yn;return(yn=Dt?.value)!==null&&yn!==void 0?yn:Dt}):tr=(kr=(jn=sr)===null||jn===void 0?void 0:jn.value)!==null&&kr!==void 0?kr:sr),et=v&&Array.isArray(sr)&&sr.map(function(Dt){return Dt?.specialValue}).find(function(Dt){return!!Dt})||((Or=sr)===null||Or===void 0?void 0:Or.specialValue),v&&tr&&!Array.isArray(tr)&&(tr=[].concat(_toConsumableArray(c||[]),[tr]),sr=null),Qt=Dr&&tr.length===0&&pe&&N||xr,!Qt){gr.next=9;break}return gr.abrupt("return");case 9:if(hn=v&&tr.length&&tr.length>(c||[]).length&&tr[tr.length-1]==pe&&!jo(pe,ge),et!="LOAD_MORE"){gr.next=17;break}return se(pe),Ie.current=!0,gr.next=15,ot(pe,!0);case 15:gr.next=37;break;case 17:if(et!="LOADING_MORE"){gr.next=21;break}Ie.current=!0,gr.next=37;break;case 21:if(!v){gr.next=31;break}if(Gt=pb(tr,Ee,s),Yt=_slicedToArray(Gt,2),Ut=Yt[0],Bt=Yt[1],d(Ut,r?Bt:void 0),!hn){gr.next=29;break}return gr.next=27,Sp(0);case 27:return gr.next=29,ur(null,"","my-reset");case 29:gr.next=37;break;case 31:if(Na=fb(tr,Ee,s),Ft=_slicedToArray(Na,2),Io=Ft[0],vt=Ft[1],d(Io,r?vt:void 0),!(wt&&h)){gr.next=37;break}return gr.next=36,Sp(0);case 36:V(!1);case 37:case"end":return gr.stop()}},Ge)}));return function($e,tr,sr){return Ur.apply(this,arguments)}}(),ur=function(){var Ur=_asyncToGenerator(_regeneratorRuntime.mark(function Ge($e,tr,sr){var Or,Dr,xr;return _regeneratorRuntime.wrap(function(kr){for(;;)switch(kr.prev=kr.next){case 0:if(Or=m==="mui"&&sr==="reset",Dr=tr,!(Dr===b||Dr===S||Or)){kr.next=4;break}return kr.abrupt("return");case 4:if(tr==pe){kr.next=13;break}if(se(Dr),xr=o&&(u?!!Dr:!0),!xr){kr.next=12;break}return kr.next=10,St(Dr);case 10:kr.next=13;break;case 12:o&&u&&Ae([]);case 13:case"end":return kr.stop()}},Ge)}));return function($e,tr,sr){return Ur.apply(this,arguments)}}(),Zr=function(Ge){var $e=_toConsumableArray(Ge);return a&&(Tr?$e.push({specialValue:"LOAD_MORE",title:b}):ae&&$e.push({specialValue:"LOADING_MORE",title:S,disabled:!0})),$e},Qr=function(Ge,$e){if($e==null)return null;var tr=$e.value!=null?$e.value:$e;return Ge.value===tr},Gr=function(Ge){return Ge&&Ge.disabled},ft=function(Ge){var $e;if(Ge!=null&&Ge.isCustom)return!0;var tr=($e=Ge?.value)!==null&&$e!==void 0?$e:Ge,sr=jo(tr,Ee);return sr?.isCustom||!1},wn=function(Ge){if(Ge==null)return null;var $e=Ge.value!=null?Ge:bp(jo(Ge,Ee));return!$e&&Ge.specialValue?Ge.title:!$e&&s||!$e?Ge.toString():$e.title||$e.label||$e.value.toString()},pt=m==="mui"?vb(Pr):Pr;return{options:pt,listValues:Ee,hasValue:or,selectedListValue:at,open:N,onOpen:ir,onClose:Lt,onDropdownVisibleChange:Vt,onChange:it,inputValue:pe,onInputChange:ur,canShowLoadMore:Tr,isInitialLoading:Ze,isLoading:Xe,isLoadingMore:ae,isSpecialValue:Hr,extendOptions:Zr,getOptionSelected:Qr,getOptionDisabled:Gr,getOptionIsCustom:ft,getOptionLabel:wn,aPlaceholder:C}};const jS=null;function Fp(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Cp(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Fp(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Fp(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}const $n=Cp(Cp({},Ye),{},{ReactUtils:We,DragIcon:$d});var Tp=y(47232),yb=y(63383);const vu={add:"Add",remove:"Remove"},Ep={id:$n.uuid(),type:"group"},Ap="timeFilter",Lp=[Ap],Ob={...zr.widgets,text:{...zr.widgets.text,factory:function(e){return(0,k.jsx)(xn.p,{value:e?.value||"",placeholder:e?.placeholder,onChange:t=>e?.setValue(t.currentTarget.value)})}},number:{...zr.widgets.number,factory:function(e){return(0,k.jsx)(xn.p,{value:e?.value,placeholder:e?.placeholder,type:"number",onChange:t=>e?.setValue(Number.parseInt(t.currentTarget.value,10))})}},datetime:{...zr.widgets.datetime,factory:function(e){if(e?.operator==="macros")return(0,k.jsx)(Tt.l6,{id:e.id,"aria-label":"Macros value selector",menuShouldPortal:!0,options:Lp.map(je.z),value:e?.value,onChange:r=>e.setValue(r.value)});const t=(0,Tp.KQ)(e?.value).isValid()?(0,Tp.KQ)(e?.value).utc():void 0;return(0,k.jsx)(yb.K,{onChange:r=>{e?.setValue(r?.format(zr.widgets.datetime.valueFormat))},date:t})},sqlFormatValue:(n,e,t,r,a,o)=>r==="macros"?Lp.includes(n)?n:void 0:typeof zr.widgets.datetime.sqlFormatValue=="string"||typeof zr.widgets.datetime.sqlFormatValue=="object"?void 0:zr.widgets.datetime.sqlFormatValue?.call(zr.ctx,n,e,t,r,a,o)||""}},bb={...zr.settings,canRegroup:!1,maxNesting:1,canReorder:!1,showNot:!1,addRuleLabel:vu.add,deleteLabel:vu.remove,renderConjs:function(e){return(0,k.jsx)(Tt.l6,{id:e?.id,"aria-label":"Conjunction","data-testid":qr.Tp.components.SQLQueryEditor.filterConjunction,menuShouldPortal:!0,options:e?.conjunctionOptions?Object.keys(e?.conjunctionOptions).map(je.z):void 0,value:e?.selectedConjunction,onChange:t=>e?.setConjunction(t.value)})},renderField:function(e){const t=e?.config?.fields||{};return(0,k.jsx)(Tt.l6,{id:e?.id,width:25,"aria-label":"Field","data-testid":qr.Tp.components.SQLQueryEditor.filterField,menuShouldPortal:!0,options:e?.items.map(r=>{const a=t[r.key].mainWidgetProps?.customProps?.icon;return{label:r.label,value:r.key,icon:a}}),value:e?.selectedKey,onChange:r=>{e?.setField(r.label)}})},renderButton:function(e){return(0,k.jsx)(Kt.$n,{type:"button",title:`${e?.label} filter`,onClick:e?.onClick,variant:"secondary",size:"md",icon:e?.label===vu.add?"plus":"times"})},renderOperator:function(e){return(0,k.jsx)(Tt.l6,{options:e?.items.map(t=>({label:t.label,value:t.key})),"aria-label":"Operator","data-testid":qr.Tp.components.SQLQueryEditor.filterOperator,menuShouldPortal:!0,value:e?.selectedKey,onChange:t=>{e?.setField(t.value||"")}})}};var Sb=(n=>(n.IN="select_any_in",n.NOT_IN="select_not_any_in",n.MACROS="macros",n))(Sb||{});const Fb=Lb(zr),wp=zr.types.text.widgets.text,Cb=[...wp.operators||[],"select_any_in","select_not_any_in"],Tb={...wp,operators:Cb},Eb={...zr.types,text:{...zr.types.text,widgets:{...zr.types.text.widgets,text:Tb}},datetime:{...zr.types.datetime,widgets:{...zr.types.datetime.widgets,datetime:{...zr.types.datetime.widgets.datetime,operators:["macros",...zr.types.datetime.widgets.datetime.operators||[]]}}}},Ab={...zr,widgets:Ob,settings:bb,operators:Fb,types:Eb},jp=()=>"",Rp=n=>typeof n=="function";function Lb(n){const{...e}=n.operators,t=()=>{const i=e.select_any_in.sqlFormatOp;return Rp(i)?i:jp},r=(i,l,s,c,d,f,p,g)=>t()(i,l,Pp(s),c,d,f,p,g),a=()=>{const i=e.select_not_any_in.sqlFormatOp;return Rp(i)?i:jp},o=(i,l,s,c,d,f,p,g)=>a()(i,l,Pp(s),c,d,f,p,g);return{...e,select_any_in:{...e.select_any_in,sqlFormatOp:r},select_not_any_in:{...e.select_not_any_in,sqlFormatOp:o},macros:{label:"Macros",sqlFormatOp:(i,l,s)=>s===Ap?`$__timeFilter(${i})`:s}}}function Pp(n){return(0,Me.isString)(n)?n.split(","):n}function wb({sql:n,config:e,onSqlChange:t}){const[r,a]=(0,F.useState)(),o=(0,F.useMemo)(()=>({...Ab,...e}),[e]);(0,F.useEffect)(()=>{if(!r){const i=$n.checkTree($n.loadTree(n.whereJsonTree??Ep),o);a(i)}},[o,n.whereJsonTree,r]),(0,F.useEffect)(()=>{n.whereJsonTree||a($n.checkTree($n.loadTree(Ep),o))},[o,n.whereJsonTree]);const u=(0,F.useCallback)((i,l)=>{a(i);const s={...n,whereJsonTree:$n.getTree(i),whereString:$n.sqlFormat(i,l)};t(s)},[t,n]);return r?(0,k.jsx)(Vd,{...o,value:r,onChange:u,renderBuilder:i=>(0,k.jsx)(xO,{...i})}):null}function Ro(n){return`
    display: flex;
    gap: 8px;
    flex-direction: ${n};`}(0,Yr.injectGlobal)`
  .group--header {
    ${Ro("row")}
  }

  .group-or-rule {
    ${Ro("column")}
    .rule {
      flex-direction: row;
    }
  }

  .rule--body {
    ${Ro("row")}
  }

  .group--children {
    ${Ro("column")}
  }

  .group--conjunctions:empty {
    display: none;
  }
`;function jb({query:n,fields:e,onQueryChange:t,db:r}){const a=(0,_p.A)(async()=>Rb(e),[e]),{onSqlChange:o}=zt({query:n,onQueryChange:t,db:r});return(0,k.jsx)(wb,{config:{fields:a.value||{}},sql:n.sql,onSqlChange:u=>{const i=(0,be.w)().getVariables();Pb(u,i),o(u)}},JSON.stringify(a.value))}function Rb(n){const e={};for(const t of n)e[t.value]={type:t.raqbFieldType||"text",valueSources:["value"],mainWidgetProps:{customProps:{icon:t.icon}}};return e}function Pb(n,e){const t=r=>"multi"in r&&r.multi&&(n.whereString?.includes(`\${${r.name}}`)||n.whereString?.includes(`$${r.name}`));e.some(r=>t(r))&&(n.whereString=n.whereString?.replaceAll("')",")"),n.whereString=n.whereString?.replaceAll("('","("))}const xb=({query:n,db:e,queryRowFilter:t,onChange:r,onValidate:a,range:o})=>{const u=(0,rr.A)(async()=>await e.fields(n),[e,n.dataset,n.table]);return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)(Mr.D,{children:[(0,k.jsx)(sn.U,{children:(0,k.jsx)(lt,{fields:u.value||[],query:n,onQueryChange:r,db:e})}),t.filter&&(0,k.jsx)(sn.U,{children:(0,k.jsx)(Rt.c,{label:"Filter by column value",optional:!0,children:(0,k.jsx)(jb,{fields:u.value||[],query:n,onQueryChange:r,db:e})})}),t.group&&(0,k.jsx)(sn.U,{children:(0,k.jsx)(Rt.c,{label:"Group by column",children:(0,k.jsx)(nt,{fields:u.value||[],query:n,onQueryChange:r,db:e})})}),t.order&&(0,k.jsx)(sn.U,{children:(0,k.jsx)(ha,{fields:u.value||[],query:n,onQueryChange:r,db:e})}),t.preview&&n.rawSql&&(0,k.jsx)(sn.U,{children:(0,k.jsx)(Et.l,{rawSql:n.rawSql,datasourceType:n.datasource?.type})})]}),(0,k.jsx)(za,{db:e,query:n,onValidate:a,range:o})]})};function xp({datasource:n,query:e,onChange:t,onRunQuery:r,range:a,queryHeaderProps:o}){const[u,i]=(0,F.useState)(!0),l=n.getDB(),{preconfiguredDatabase:s}=n,c=o?.dialect??"other",{loading:d,error:f}=(0,rr.A)(async()=>()=>{n.getDB(n.id).init!==void 0&&n.getDB(n.id).init()},[n]),p=ln(e),[g,v]=(0,F.useState)({filter:!!p.sql?.whereString,group:!!p.sql?.groupBy?.[0]?.property.name,order:!!p.sql?.orderBy?.property.name,preview:!0}),[m,h]=(0,F.useState)(p);(0,F.useEffect)(()=>()=>{n.getDB(n.id).dispose!==void 0&&n.getDB(n.id).dispose()},[n]);const O=(0,F.useCallback)(C=>{Ib(C)&&r&&r()},[r]),b=(C,L=!0)=>{h(C),t(C),Wt(C.sql?.columns)&&C.sql?.columns.some(w=>w.name)&&!g.group&&v({...g,group:!0}),L&&O(C)},S=C=>{h(C),t(C)};return d||f?null:(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Go,{db:l,preconfiguredDataset:s,onChange:S,onRunQuery:r,onQueryRowChange:v,queryRowFilter:g,query:p,isQueryRunnable:u,dialect:c}),(0,k.jsx)(gt.$,{v:.5}),p.editorMode!==vr.lX.Code&&(0,k.jsx)(xb,{db:l,query:p,onChange:C=>b(C,!1),queryRowFilter:g,onValidate:i,range:a}),p.editorMode===vr.lX.Code&&(0,k.jsx)($o,{db:l,query:p,queryToValidate:m,onChange:b,onRunQuery:r,onValidate:i,range:a})]})}const Ib=n=>!!n.rawSql;function Vb(n){const e=typeof n.rawQuery=="string"?n.rawQuery:null;if(!e)return n;const t=ln({refId:"Annotation",...n.target??{},rawSql:e});return{...n,rawQuery:void 0,workspace:void 0,subscription:void 0,queryType:void 0,target:t}}class Db extends ut.iy{constructor(e,t=(0,be.w)()){super(e),this.templateSrv=t,this.interpolateVariable=(a,o)=>typeof a=="string"?o.multi||o.includeAll?this.getQueryModel().quoteLiteral(a):String(a).replace(/'/g,"''"):typeof a=="number"?a:Array.isArray(a)?a.map(i=>this.getQueryModel().quoteLiteral(i)).join(","):a,this.name=e.name,this.responseParser=new oe,this.id=e.id;const r=e.jsonData||{};this.interval=r.timeInterval||"1m",this.db=this.getDB(),this.preconfiguredDatabase=r.database??"",this.annotations={prepareAnnotation:Vb,QueryEditor:xp}}getResponseParser(){return this.responseParser}interpolateVariablesInQueries(e,t){let r=e;return e&&e.length>0&&(r=e.map(a=>({...a,datasource:this.getRef(),rawSql:this.templateSrv.replace(a.rawSql,t,this.interpolateVariable),rawQuery:!0}))),r}filterQuery(e){return!e.hide}applyTemplateVariables(e,t){return{refId:e.refId,datasource:this.getRef(),rawSql:this.templateSrv.replace(e.rawSql,t,this.interpolateVariable),format:e.format}}query(e){if(Rn()){const t=this.checkForDatabaseIssue(e);if(t){const r=new Error(t);return(0,fr.$)(()=>r)}}return e.targets.forEach(t=>{e.app===pr.Jk.Dashboard||e.app===pr.Jk.PanelViewer||(0,ue.rR)("grafana_sql_query_executed",{datasource:t.datasource?.type,editorMode:t.editorMode,format:t.format,app:e.app})}),super.query(e)}checkForDatabaseIssue(e){if(this.type==="postgres"&&!this.preconfiguredDatabase)return`You do not currently have a default database configured for this data source. Postgres requires a default
             database with which to connect. Please configure one through the Data Sources Configuration page, or if you
             are using a provisioning file, update that configuration file with a default database.`;if(e.app!==pr.Jk.Explore&&this.preconfiguredDatabase){for(const t of e.targets)if(t.editorMode===vr.lX.Builder&&t.dataset!==this.preconfiguredDatabase)return`The configuration for this panel's data source has been modified. The previous database used in this panel's
                   saved query is no longer available. Please update the query to use the new database option.
                   Previous query parameters will be preserved until the query is updated.`}}async metricFindQuery(e,t){const r=t?.range;if(r==null)return[];let a="tempvar";t&&t.variable&&t.variable.name&&(a=t.variable.name);const o={...t?.scopedVars,...(0,Ir.c)({query:e,wildcardChar:"%",options:t})},u=this.templateSrv.replace(e,o,this.interpolateVariable),i={refId:a,datasource:this.getRef(),rawSql:u,format:he.Table};let l;try{l=await this.runMetaQuery(i,r)}catch(s){throw console.error(s),new Error("error when executing the sql query")}return this.getResponseParser().transformMetricFindResponse(l)}async runSql(e,t){const r=(0,rt.E2)(),a=await this.runMetaQuery({rawSql:e,format:he.Table,refId:t?.refId},r);return new jt.R(a)}runMetaQuery(e,t){const r=e.refId||"meta",a=[{...e,datasource:e.datasource||this.getRef(),refId:r}];return(0,Be.s)((0,fe.AI)().fetch({url:"/api/ds/query",method:"POST",headers:this.getRequestHeaders(),data:{from:t.from.valueOf().toString(),to:t.to.valueOf().toString(),queries:a},requestId:r}).pipe((0,Qe.T)(o=>(0,_e.bE)(o,a).data[0]??{fields:[]})))}targetContainsTemplate(e){let t=e.rawSql;return At.forEach(r=>{t=t?.replace(r,"")||""}),this.templateSrv.containsTemplate(t)}}var Nb=y(94471),kb=y(29020),Po=y(88575),xo=y(60029),_b=y(76892);function gu({value:n,defaultValue:e,onChange:t,width:r}){const[a,o]=(0,F.useState)(!1);return(0,k.jsx)(xn.p,{type:"number",placeholder:String(e),value:a?"":n,onChange:u=>{if(u.currentTarget.value?.trim()==="")o(!0),t(e);else{o(!1);const i=Number(u.currentTarget.value);Number.isNaN(i)||t(i)}},width:r})}const Mb=n=>{const{onOptionsChange:e,options:t}=n,r=t.jsonData,a=r.maxIdleConnsAuto!==void 0?r.maxIdleConnsAuto:!1,o=c=>{const d={...t,jsonData:{...r,...c}};return e(d)},u=c=>d=>{o({[c]:d})},i=c=>{o(a&&c?{maxOpenConns:c,maxIdleConns:c}:{maxOpenConns:c})},l=()=>{let c,d;a?(d=r.maxOpenConns,c=r.maxIdleConns):r.maxOpenConns!==void 0&&(d=r.maxOpenConns,c=r.maxOpenConns),o({maxIdleConnsAuto:!a,maxIdleConns:c,maxOpenConns:d})},s=40;return(0,k.jsxs)(kb.I,{title:"Connection limits",children:[(0,k.jsx)(Po.D,{label:(0,k.jsx)(xo.J,{children:(0,k.jsxs)(G.B,{gap:.5,children:[(0,k.jsx)("span",{children:"Max open"}),(0,k.jsx)(cn.m,{content:(0,k.jsxs)("span",{children:["The maximum number of open connections to the database. If ",(0,k.jsx)("i",{children:"Max idle connections"})," is greater than 0 and the ",(0,k.jsx)("i",{children:"Max open connections"})," is less than ",(0,k.jsx)("i",{children:"Max idle connections"}),", then",(0,k.jsx)("i",{children:"Max idle connections"})," will be reduced to match the ",(0,k.jsx)("i",{children:"Max open connections"})," limit. If set to 0, there is no limit on the number of open connections."]}),children:(0,k.jsx)(dn.I,{name:"info-circle",size:"sm"})})]})}),children:(0,k.jsx)(gu,{value:r.maxOpenConns,defaultValue:fn.$.sqlConnectionLimits.maxOpenConns,onChange:c=>{i(c)},width:s})}),(0,k.jsx)(Po.D,{label:(0,k.jsx)(xo.J,{children:(0,k.jsxs)(G.B,{gap:.5,children:[(0,k.jsx)("span",{children:"Auto max idle"}),(0,k.jsx)(cn.m,{content:(0,k.jsxs)("span",{children:["If enabled, automatically set the number of ",(0,k.jsx)("i",{children:"Maximum idle connections"})," to the same value as",(0,k.jsx)("i",{children:" Max open connections"}),". If the number of maximum open connections is not set it will be set to the default (",fn.$.sqlConnectionLimits.maxIdleConns,")."]}),children:(0,k.jsx)(dn.I,{name:"info-circle",size:"sm"})})]})}),children:(0,k.jsx)(bn.d,{value:a,onChange:l})}),(0,k.jsx)(Po.D,{label:(0,k.jsx)(xo.J,{children:(0,k.jsxs)(G.B,{gap:.5,children:[(0,k.jsx)("span",{children:"Max idle"}),(0,k.jsx)(cn.m,{content:(0,k.jsxs)("span",{children:["The maximum number of connections in the idle connection pool.If ",(0,k.jsx)("i",{children:"Max open connections"})," is greater than 0 but less than the ",(0,k.jsx)("i",{children:"Max idle connections"}),", then the ",(0,k.jsx)("i",{children:"Max idle connections"})," ","will be reduced to match the ",(0,k.jsx)("i",{children:"Max open connections"})," limit. If set to 0, no idle connections are retained."]}),children:(0,k.jsx)(dn.I,{name:"info-circle",size:"sm"})})]})}),children:a?(0,k.jsx)(_b.c,{width:s,children:t.jsonData.maxIdleConns}):(0,k.jsx)(gu,{value:r.maxIdleConns,defaultValue:fn.$.sqlConnectionLimits.maxIdleConns,onChange:c=>{u("maxIdleConns")(c)},width:s})}),(0,k.jsx)(Po.D,{label:(0,k.jsx)(xo.J,{children:(0,k.jsxs)(G.B,{gap:.5,children:[(0,k.jsx)("span",{children:"Max lifetime"}),(0,k.jsx)(cn.m,{content:(0,k.jsx)("span",{children:"The maximum amount of time in seconds a connection may be reused. If set to 0, connections are reused forever."}),children:(0,k.jsx)(dn.I,{name:"info-circle",size:"sm"})})]})}),children:(0,k.jsx)(gu,{value:r.connMaxLifetime,defaultValue:fn.$.sqlConnectionLimits.connMaxLifetime,onChange:c=>{u("connMaxLifetime")(c)},width:s})})]})},RS=()=>{const n=useStyles2(Gb);return jsx("hr",{className:n.horizontalDivider})},Gb=n=>({horizontalDivider:css({borderTop:`1px solid ${n.colors.border.weak}`,margin:n.spacing(2,0),width:"100%"})}),PS=n=>{const{editorProps:e,showCACert:t,showKeyPair:r=!0}=n,{secureJsonFields:a}=e.options;return jsxs(Fragment,{children:[r?jsx(Field,{label:jsx(Label,{children:jsxs(Stack,{gap:.5,children:[jsx("span",{children:"TLS/SSL Client Certificate"}),jsx(Tooltip,{content:jsx("span",{children:"To authenticate with an TLS/SSL client certificate, provide the client certificate here."}),children:jsx(Icon,{name:"info-circle",size:"sm"})})]})}),children:jsx(SecretTextArea,{placeholder:"-----BEGIN CERTIFICATE-----",cols:45,rows:7,isConfigured:a&&a.tlsClientCert,onChange:onUpdateDatasourceSecureJsonDataOption(e,"tlsClientCert"),onReset:()=>{updateDatasourcePluginResetOption(e,"tlsClientCert")}})}):null,t?jsx(Field,{label:jsx(Label,{children:jsxs(Stack,{gap:.5,children:[jsx("span",{children:"TLS/SSL Root Certificate"}),jsx(Tooltip,{content:jsx("span",{children:"If the selected TLS/SSL mode requires a server root certificate, provide it here."}),children:jsx(Icon,{name:"info-circle",size:"sm"})})]})}),children:jsx(SecretTextArea,{placeholder:"-----BEGIN CERTIFICATE-----",cols:45,rows:7,isConfigured:a&&a.tlsCACert,onChange:onUpdateDatasourceSecureJsonDataOption(e,"tlsCACert"),onReset:()=>{updateDatasourcePluginResetOption(e,"tlsCACert")}})}):null,r?jsx(Field,{label:jsx(Label,{children:jsxs(Stack,{gap:.5,children:[jsx("span",{children:"TLS/SSL Client Key"}),jsx(Tooltip,{content:jsx("span",{children:"To authenticate with a client TLS/SSL certificate, provide the key here."}),children:jsx(Icon,{name:"info-circle",size:"sm"})})]})}),children:jsx(SecretTextArea,{placeholder:"-----BEGIN RSA PRIVATE KEY-----",cols:45,rows:7,isConfigured:a&&a.tlsClientKey,onChange:onUpdateDatasourceSecureJsonDataOption(e,"tlsClientKey"),onReset:()=>{updateDatasourcePluginResetOption(e,"tlsClientKey")}})}):null]})};var Ub=y(34867);const Ip=(0,Ub.DW)("features.plugins.sql");function Bb({onOptionsChange:n,options:e}){(0,F.useEffect)(()=>{const t=e.jsonData;let r={...e},a=!1;if(e.database&&(Ip.logDebug(`Migrating from options.database with value ${e.database} for ${e.name}`),r.database="",r.jsonData={...t,database:e.database},a=!0),t.maxOpenConns===void 0&&t.maxIdleConns===void 0&&t.maxIdleConnsAuto===void 0){const{maxOpenConns:o,maxIdleConns:u}=fn.$.sqlConnectionLimits;Ip.logDebug(`Setting default max open connections to ${o} and setting max idle connection to ${u}`),r.jsonData={...r.jsonData,maxOpenConns:o,maxIdleConns:u,maxIdleConnsAuto:!0},a=!0}if(t.connMaxLifetime===void 0){const{connMaxLifetime:o}=fn.$.sqlConnectionLimits;r.jsonData={...r.jsonData,connMaxLifetime:o},a=!0}a&&n(r)},[n,e])}},18678:function(xe,ve,y){var D,A;(function(x,$){D=$,A=typeof D=="function"?D.call(ve,y,ve,xe):D,A!==void 0&&(xe.exports=A)})(this,function(){"use strict";Array.isArray||(Array.isArray=function(T){return Object.prototype.toString.call(T)==="[object Array]"});function x(T){for(var E=[],I=0,j=T.length;I<j;I++)E.indexOf(T[I])===-1&&E.push(T[I]);return E}var $={},z={"==":function(T,E){return T==E},"===":function(T,E){return T===E},"!=":function(T,E){return T!=E},"!==":function(T,E){return T!==E},">":function(T,E){return T>E},">=":function(T,E){return T>=E},"<":function(T,E,I){return I===void 0?T<E:T<E&&E<I},"<=":function(T,E,I){return I===void 0?T<=E:T<=E&&E<=I},"!!":function(T){return $.truthy(T)},"!":function(T){return!$.truthy(T)},"%":function(T,E){return T%E},log:function(T){return console.log(T),T},in:function(T,E){return!E||typeof E.indexOf>"u"?!1:E.indexOf(T)!==-1},cat:function(){return Array.prototype.join.call(arguments,"")},substr:function(T,E,I){if(I<0){var j=String(T).substr(E);return j.substr(0,j.length+I)}return String(T).substr(E,I)},"+":function(){return Array.prototype.reduce.call(arguments,function(T,E){return parseFloat(T,10)+parseFloat(E,10)},0)},"*":function(){return Array.prototype.reduce.call(arguments,function(T,E){return parseFloat(T,10)*parseFloat(E,10)})},"-":function(T,E){return E===void 0?-T:T-E},"/":function(T,E){return T/E},min:function(){return Math.min.apply(this,arguments)},max:function(){return Math.max.apply(this,arguments)},merge:function(){return Array.prototype.reduce.call(arguments,function(T,E){return T.concat(E)},[])},var:function(T,E){var I=E===void 0?null:E,j=this;if(typeof T>"u"||T===""||T===null)return j;for(var W=String(T).split("."),X=0;X<W.length;X++)if(j==null||(j=j[W[X]],j===void 0))return I;return j},missing:function(){for(var T=[],E=Array.isArray(arguments[0])?arguments[0]:arguments,I=0;I<E.length;I++){var j=E[I],W=$.apply({var:j},this);(W===null||W==="")&&T.push(j)}return T},missing_some:function(T,E){var I=$.apply({missing:E},this);return E.length-I.length>=T?[]:I}};return $.is_logic=function(T){return typeof T=="object"&&T!==null&&!Array.isArray(T)&&Object.keys(T).length===1},$.truthy=function(T){return Array.isArray(T)&&T.length===0?!1:!!T},$.get_operator=function(T){return Object.keys(T)[0]},$.get_values=function(T){return T[$.get_operator(T)]},$.apply=function(T,E){if(Array.isArray(T))return T.map(function(Oe){return $.apply(Oe,E)});if(!$.is_logic(T))return T;var I=$.get_operator(T),j=T[I],W,X,ee,Y,Z;if(Array.isArray(j)||(j=[j]),I==="if"||I=="?:"){for(W=0;W<j.length-1;W+=2)if($.truthy($.apply(j[W],E)))return $.apply(j[W+1],E);return j.length===W+1?$.apply(j[W],E):null}else if(I==="and"){for(W=0;W<j.length;W+=1)if(X=$.apply(j[W],E),!$.truthy(X))return X;return X}else if(I==="or"){for(W=0;W<j.length;W+=1)if(X=$.apply(j[W],E),$.truthy(X))return X;return X}else{if(I==="filter")return Y=$.apply(j[0],E),ee=j[1],Array.isArray(Y)?Y.filter(function(Oe){return $.truthy($.apply(ee,Oe))}):[];if(I==="map")return Y=$.apply(j[0],E),ee=j[1],Array.isArray(Y)?Y.map(function(Oe){return $.apply(ee,Oe)}):[];if(I==="reduce")return Y=$.apply(j[0],E),ee=j[1],Z=typeof j[2]<"u"?j[2]:null,Array.isArray(Y)?Y.reduce(function(Oe,We){return $.apply(ee,{current:We,accumulator:Oe})},Z):Z;if(I==="all"){if(Y=$.apply(j[0],E),ee=j[1],!Array.isArray(Y)||!Y.length)return!1;for(W=0;W<Y.length;W+=1)if(!$.truthy($.apply(ee,Y[W])))return!1;return!0}else if(I==="none"){if(Y=$.apply(j[0],E),ee=j[1],!Array.isArray(Y)||!Y.length)return!0;for(W=0;W<Y.length;W+=1)if($.truthy($.apply(ee,Y[W])))return!1;return!0}else if(I==="some"){if(Y=$.apply(j[0],E),ee=j[1],!Array.isArray(Y)||!Y.length)return!1;for(W=0;W<Y.length;W+=1)if($.truthy($.apply(ee,Y[W])))return!0;return!1}}if(j=j.map(function(Oe){return $.apply(Oe,E)}),z.hasOwnProperty(I)&&typeof z[I]=="function")return z[I].apply(E,j);if(I.indexOf(".")>0){var de=String(I).split("."),H=z;for(W=0;W<de.length;W++){if(!H.hasOwnProperty(de[W]))throw new Error("Unrecognized operation "+I+" (failed at "+de.slice(0,W+1).join(".")+")");H=H[de[W]]}return H.apply(E,j)}throw new Error("Unrecognized operation "+I)},$.uses_data=function(T){var E=[];if($.is_logic(T)){var I=$.get_operator(T),j=T[I];Array.isArray(j)||(j=[j]),I==="var"?E.push(j[0]):j.forEach(function(W){E.push.apply(E,$.uses_data(W))})}return x(E)},$.add_operation=function(T,E){z[T]=E},$.rm_operation=function(T){delete z[T]},$.rule_like=function(T,E){if(E===T||E==="@")return!0;if(E==="number")return typeof T=="number";if(E==="string")return typeof T=="string";if(E==="array")return Array.isArray(T)&&!$.is_logic(T);if($.is_logic(E)){if($.is_logic(T)){var I=$.get_operator(E),j=$.get_operator(T);if(I==="@"||I===j)return $.rule_like($.get_values(T,!1),$.get_values(E,!1))}return!1}if(Array.isArray(E))if(Array.isArray(T)){if(E.length!==T.length)return!1;for(var W=0;W<E.length;W+=1)if(!$.rule_like(T[W],E[W]))return!1;return!0}else return!1;return!1},$})},87805:(xe,ve,y)=>{var D=y(43360),A=y(75288);function x($,z,T){(T!==void 0&&!A($[z],T)||T===void 0&&!(z in $))&&D($,z,T)}xe.exports=x},85250:(xe,ve,y)=>{var D=y(37217),A=y(87805),x=y(86649),$=y(42824),z=y(23805),T=y(37241),E=y(14974);function I(j,W,X,ee,Y){j!==W&&x(W,function(Z,de){if(Y||(Y=new D),z(Z))$(j,W,de,X,I,ee,Y);else{var H=ee?ee(E(j,de),Z,de+"",j,W,Y):void 0;H===void 0&&(H=Z),A(j,de,H)}},T)}xe.exports=I},42824:(xe,ve,y)=>{var D=y(87805),A=y(93290),x=y(71961),$=y(23007),z=y(35529),T=y(72428),E=y(56449),I=y(83693),j=y(3656),W=y(1882),X=y(23805),ee=y(11331),Y=y(37167),Z=y(14974),de=y(69884);function H(Oe,We,Je,ke,je,he,qe){var Ue=Z(Oe,Je),er=Z(We,Je),fr=qe.get(er);if(fr){D(Oe,Je,fr);return}var Be=he?he(Ue,er,Je+"",Oe,We,qe):void 0,Qe=Be===void 0;if(Qe){var pr=E(er),Ir=!pr&&j(er),rt=!pr&&!Ir&&Y(er);Be=er,pr||Ir||rt?E(Ue)?Be=Ue:I(Ue)?Be=$(Ue):Ir?(Qe=!1,Be=A(er,!0)):rt?(Qe=!1,Be=x(er,!0)):Be=[]:ee(er)||T(er)?(Be=Ue,T(Ue)?Be=de(Ue):(!X(Ue)||W(Ue))&&(Be=z(er))):Qe=!1}Qe&&(qe.set(er,Be),je(Be,er,ke,he,qe),qe.delete(er)),D(Oe,Je,Be)}xe.exports=H},69302:(xe,ve,y)=>{var D=y(83488),A=y(56757),x=y(32865);function $(z,T){return x(A(z,T,D),z+"")}xe.exports=$},20999:(xe,ve,y)=>{var D=y(69302),A=y(36800);function x($){return D(function(z,T){var E=-1,I=T.length,j=I>1?T[I-1]:void 0,W=I>2?T[2]:void 0;for(j=$.length>3&&typeof j=="function"?(I--,j):void 0,W&&A(T[0],T[1],W)&&(j=I<3?void 0:j,I=1),z=Object(z);++E<I;){var X=T[E];X&&$(z,X,E,j)}return z})}xe.exports=x},14974:xe=>{function ve(y,D){if(!(D==="constructor"&&typeof y[D]=="function")&&D!="__proto__")return y[D]}xe.exports=ve},83693:(xe,ve,y)=>{var D=y(64894),A=y(40346);function x($){return A($)&&D($)}xe.exports=x},73916:(xe,ve,y)=>{var D=y(43360),A=y(30641),x=y(15389);function $(z,T){var E={};return T=x(T,3),A(z,function(I,j,W){D(E,j,T(I,j,W))}),E}xe.exports=$},55364:(xe,ve,y)=>{var D=y(85250),A=y(20999),x=A(function($,z,T){D($,z,T)});xe.exports=x},6924:(xe,ve,y)=>{var D=y(85250),A=y(20999),x=A(function($,z,T,E){D($,z,T,E)});xe.exports=x},71086:(xe,ve,y)=>{var D=y(34932),A=y(15389),x=y(97420),$=y(83349);function z(T,E){if(T==null)return{};var I=D($(T),function(j){return[j]});return E=A(E),x(T,I,function(j,W){return E(j,W[0])})}xe.exports=z},22331:(xe,ve,y)=>{var D=y(87133),A=y(77556),x=y(61489),$=y(13222);function z(T,E,I){return T=$(T),I=I==null?0:D(x(I),0,T.length),E=A(E),T.slice(I,I+E.length)==E}xe.exports=z},69884:(xe,ve,y)=>{var D=y(21791),A=y(37241);function x($){return D($,A($))}xe.exports=x},21450:function(xe){(function(y,D){xe.exports=D()})(this,function(){return function(ve){var y={};function D(A){if(y[A])return y[A].exports;var x=y[A]={i:A,l:!1,exports:{}};return ve[A].call(x.exports,x,x.exports,D),x.l=!0,x.exports}return D.m=ve,D.c=y,D.d=function(A,x,$){D.o(A,x)||Object.defineProperty(A,x,{configurable:!1,enumerable:!0,get:$})},D.n=function(A){var x=A&&A.__esModule?function(){return A.default}:function(){return A};return D.d(x,"a",x),x},D.o=function(A,x){return Object.prototype.hasOwnProperty.call(A,x)},D.p="",D(D.s=3)}([function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0});function A($,z){var T={},E=$||"Abstract",I=[],j=null,W;if(T._type=E,T.getType=function(){return E},T.setType=function(Z){E=Z},T.getChildren=function(){return I},T.addChild=function(Z){if(Z){if(!Z.setParent)throw{name:"Error",message:"Trying to add a child which is not a node: "+JSON.stringify(Z)};Z.setParent(T),I.push(Z)}},T.getParent=function(){return j},T.setParent=function(Z){j=Z},T.getContext=function(Z){return W||Z.activeContext.peek()},T.setContext=function(Z){W=Z},T.getStartPosition=function(){return z>>16},T.getEndPosition=function(){return z&65535},T.getValue=function(){throw{name:"MethodNotImplementedException",message:"SpelNode#getValue() must be overridden."}},T.toString=function(){var Z="Kind: "+T.getType();Z+=", Children: [";for(var de=0,H=T.getChildren().length;de<H;de+=1)Z+="{"+T.getChildren()[de]+"}, ";return Z+="]",Z},z===0)throw{name:"Error",message:"Position cannot be 0"};for(var X=arguments.length,ee=Array(X>2?X-2:0),Y=2;Y<X;Y++)ee[Y-2]=arguments[Y];return ee&&ee.forEach(function(Z){T.addChild(Z)}),T}var x=y.SpelNode={create:A}},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Stack=A;function A(x){this.elements=x||[]}A.prototype.push=function(x){return this.elements.push(x),x},A.prototype.pop=function(){return this.elements.pop()},A.prototype.peek=function(){return this.elements[this.elements.length-1]},A.prototype.empty=function(){return this.elements.length>0},A.prototype.search=function(x){return this.elements.length-this.elements.indexOf(x)}},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0});var A={LITERAL_INT:1,LITERAL_LONG:2,LITERAL_HEXINT:3,LITERAL_HEXLONG:4,LITERAL_STRING:5,LITERAL_REAL:6,LITERAL_REAL_FLOAT:7,LPAREN:"(",RPAREN:")",COMMA:",",IDENTIFIER:0,COLON:":",HASH:"#",RSQUARE:"]",LSQUARE:"[",LCURLY:"{",RCURLY:"}",DOT:".",PLUS:"+",STAR:"*",MINUS:"-",SELECT_FIRST:"^[",SELECT_LAST:"$[",QMARK:"?",PROJECT:"![",DIV:"/",GE:">=",GT:">",LE:"<=",LT:"<",EQ:"==",NE:"!=",MOD:"%",NOT:"!",ASSIGN:"=",INSTANCEOF:"instanceof",MATCHES:"matches",BETWEEN:"between",SELECT:"?[",POWER:"^",ELVIS:"?:",SAFE_NAVI:"?.",BEAN_REF:"@",SYMBOLIC_OR:"||",SYMBOLIC_AND:"&&",INC:"++",DEC:"--"};function x(z){this.type=z,this.tokenChars=A[z],this._hasPayload=typeof A[z]!="string",typeof A[z]=="number"&&(this._ordinal=A[z])}for(var $ in A)A.hasOwnProperty($)&&(x[$]=new x($));x.prototype.toString=function(){return this.type+(this.tokenChars.length!==0?"("+this.tokenChars+")":"")},x.prototype.getLength=function(){return this.tokenChars.length},x.prototype.hasPayload=function(){return this._hasPayload},x.prototype.valueOf=function(z){for(var T in A)if(A.hasOwnProperty(T)&&A[T]===z)return x[T]},x.prototype.ordinal=function(){return this._ordinal},y.TokenKind=x},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.StandardContext=y.SpelExpressionEvaluator=void 0;var A=D(4),x=D(50);y.SpelExpressionEvaluator=A.SpelExpressionEvaluator,y.StandardContext=x.StandardContext},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.SpelExpressionEvaluator=void 0;var A=D(5),x=D(1),$={};function z(T,E,I){var j=new x.Stack,W;return E||(E={}),j.push(E),W={rootContext:E,activeContext:j,locals:I},T.getValue(W)}$.compile=function(T){var E=(0,A.SpelExpressionParser)().parse(T);return{eval:function(j,W){return z(E,j,W)},_compiledExpression:E}},$.eval=function(T,E,I){return $.compile(T).eval(E,I)},y.SpelExpressionEvaluator=$},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.SpelExpressionParser=void 0;var A=D(2),x=D(6),$=D(8),z=D(9),T=D(10),E=D(11),I=D(12),j=D(13),W=D(14),X=D(15),ee=D(16),Y=D(17),Z=D(18),de=D(19),H=D(20),Oe=D(21),We=D(22),Je=D(23),ke=D(24),je=D(25),he=D(26),qe=D(27),Ue=D(28),er=D(29),fr=D(30),Be=D(31),Qe=D(32),pr=D(33),Ir=D(34),rt=D(35),jt=D(36),vr=D(37),ut=D(38),be=D(39),ue=D(40),fe=D(41),_e=D(42),Me=D(43),oe=D(44),k=D(45),F=D(46),rr=D(47),gt=D(48),Jr=D(49),br=y.SpelExpressionParser=function(){var Wt=new RegExp("[\\p{L}\\p{N}_$]+"),da,fa=[],On,ln,pa,qr;function Do(G){da=G}function No(G,re){try{On=G,ln=x.Tokenizer.tokenize(G),pa=ln.length,qr=0,fa=[];var Se=tt();return Fn()&&nt(Ar().startPos,"MORE_INPUT",Sr().toString()),Se}catch(He){throw He.message}}function tt(){var G=sn();if(Fn()){var re=Ar();if(re.getKind()===A.TokenKind.ASSIGN){G===null&&(G=E.NullLiteral.create(At(re.startPos-1,re.endPos-1))),Sr();var Se=sn();return Z.Assign.create(Ke(re),G,Se)}if(re.getKind()===A.TokenKind.ELVIS){G===null&&(G=E.NullLiteral.create(At(re.startPos-1,re.endPos-2))),Sr();var He=tt();return He===null&&(He=E.NullLiteral.create(At(re.startPos+1,re.endPos+1))),ut.Elvis.create(Ke(re),G,He)}if(re.getKind()===A.TokenKind.QMARK){G===null&&(G=E.NullLiteral.create(At(re.startPos-1,re.endPos-1))),Sr();var mt=tt();_r(A.TokenKind.COLON);var lt=tt();return vr.Ternary.create(Ke(re),G,mt,lt)}}return G}function sn(){for(var G=Rt();Pn("or")||Mr(A.TokenKind.SYMBOLIC_OR);){var re=Sr(),Se=Rt();Wn(re,G,Se),G=rt.OpOr.create(Ke(re),G,Se)}return G}function Rt(){for(var G=bn();Pn("and")||Mr(A.TokenKind.SYMBOLIC_AND);){var re=Sr(),Se=bn();Wn(re,G,Se),G=Ir.OpAnd.create(Ke(re),G,Se)}return G}function bn(){var G=Kt(),re=$o();if(re!==null){var Se=Sr(),He=Kt();Wn(Se,G,He);var mt=re.kind;if(re.isNumericRelationalOperator()){var lt=Ke(Se);return mt===A.TokenKind.GT?We.OpGT.create(lt,G,He):mt===A.TokenKind.LT?ke.OpLT.create(lt,G,He):mt===A.TokenKind.LE?Je.OpLE.create(lt,G,He):mt===A.TokenKind.GE?Oe.OpGE.create(lt,G,He):mt===A.TokenKind.EQ?de.OpEQ.create(lt,G,He):H.OpNE.create(lt,G,He)}return mt===A.TokenKind.INSTANCEOF?Me.OpInstanceof.create(Ke(Se),G,He):mt===A.TokenKind.MATCHES?jt.OpMatches.create(Ke(Se),G,He):oe.OpBetween.create(Ke(Se),G,He)}return G}function Kt(){for(var G=cn();zt(A.TokenKind.PLUS,A.TokenKind.MINUS,A.TokenKind.INC);){var re=Sr(),Se=cn();ha(re,Se),re.getKind()===A.TokenKind.PLUS?G=je.OpPlus.create(Ke(re),G,Se):re.getKind()===A.TokenKind.MINUS&&(G=he.OpMinus.create(Ke(re),G,Se))}return G}function cn(){for(var G=va();zt(A.TokenKind.STAR,A.TokenKind.DIV,A.TokenKind.MOD);){var re=Sr(),Se=va();Wn(re,G,Se),re.getKind()===A.TokenKind.STAR?G=qe.OpMultiply.create(Ke(re),G,Se):re.getKind()===A.TokenKind.DIV?G=Ue.OpDivide.create(Ke(re),G,Se):G=er.OpModulus.create(Ke(re),G,Se)}return G}function va(){var G=Yr(),re;if(Mr(A.TokenKind.POWER)){re=Sr();var Se=Yr();return ha(re,Se),fr.OpPower.create(Ke(re),G,Se)}return G!==null&&zt(A.TokenKind.INC,A.TokenKind.DEC)?(re=Sr(),re.getKind()===A.TokenKind.INC?Be.OpInc.create(Ke(re),!0,G):Qe.OpDec.create(Ke(re),!0,G)):G}function Yr(){var G,re;return zt(A.TokenKind.PLUS,A.TokenKind.MINUS,A.TokenKind.NOT)?(G=Sr(),re=Yr(),G.getKind()===A.TokenKind.NOT?pr.OpNot.create(Ke(G),re):G.getKind()===A.TokenKind.PLUS?je.OpPlus.create(Ke(G),re):he.OpMinus.create(Ke(G),re)):zt(A.TokenKind.INC,A.TokenKind.DEC)?(G=Sr(),re=Yr(),G.getKind()===A.TokenKind.INC?Be.OpInc.create(Ke(G),!1,re):Qe.OpDec.create(Ke(G),!1,re)):Sn()}function Sn(){var G=[],re=_o();for(G.push(re);ga();)G.push(Nt());return G.length===1?G[0]:ee.CompoundExpression.create(At(re.getStartPosition(),G[G.length-1].getEndPosition()),G)}function ga(){var G=null;return zt(A.TokenKind.DOT,A.TokenKind.SAFE_NAVI)?G=ko():G=dn(),G===null?!1:(Er(G),!0)}function dn(){return Mr(A.TokenKind.LSQUARE)&&Ba()?Nt():null}function ko(){var G=Sr(),re=G.getKind()===A.TokenKind.SAFE_NAVI;return Wa(re)||_a()||Ga(re)||$a(re)?Nt():(Ar()===null?nt(G.startPos,"OOD"):nt(G.startPos,"UNEXPECTED_DATA_AFTER_DOT",xn(Ar())),null)}function _a(){if(!Mr(A.TokenKind.HASH))return!1;var G=Sr(),re=_r(A.TokenKind.IDENTIFIER),Se=Tt();return Se===null?(Er(X.VariableReference.create(re.data,At(G.startPos,re.endPos))),!0):(Er(I.FunctionReference.create(re.data,At(G.startPos,re.endPos),Se)),!0)}function Tt(){if(!Mr(A.TokenKind.LPAREN))return null;var G=[];return Rn(G),_r(A.TokenKind.RPAREN),G}function fn(G){Mr(A.TokenKind.LPAREN)||nt(Ke(Ar()),"MISSING_CONSTRUCTOR_ARGS"),Rn(G),_r(A.TokenKind.RPAREN)}function Rn(G){var re=Ar().startPos,Se;do{Sr();var He=Ar();He===null&&nt(re,"RUN_OUT_OF_ARGUMENTS"),He.getKind()!==A.TokenKind.RPAREN&&G.push(tt()),Se=Ar()}while(Se!==null&&Se.kind===A.TokenKind.COMMA);Se===null&&nt(re,"RUN_OUT_OF_ARGUMENTS")}function mu(G){return G===null?On.length:G.startPos}function _o(){return Bo()||za()||Go()||Ma()||Ka()||Wa(!1)||_a()||Mo()||Ga(!1)||$a(!1)||Ba()||Ua()?Nt():null}function Mo(){if(Mr(A.TokenKind.BEAN_REF)){var G=Sr(),re=null,Se=null;Mr(A.TokenKind.IDENTIFIER)?(re=_r(A.TokenKind.IDENTIFIER),Se=re.data):Mr(A.TokenKind.LITERAL_STRING)?(re=_r(A.TokenKind.LITERAL_STRING),Se=re.stringValue(),Se=Se.substring(1,Se.length()-1)):nt(G.startPos,"INVALID_BEAN_REFERENCE");var He=F.BeanReference.create(Ke(re),Se);return Er(He),!0}return!1}function Go(){if(Mr(A.TokenKind.IDENTIFIER)){var G=Ar();if(G.stringValue()!=="T")return!1;var re=Sr();if(Mr(A.TokenKind.RSQUARE))return Er(W.PropertyReference.create(re.stringValue(),Ke(re))),!0;_r(A.TokenKind.LPAREN);for(var Se=ma(),He=0;Et(A.TokenKind.LSQUARE,!0);)_r(A.TokenKind.RSQUARE),He++;return _r(A.TokenKind.RPAREN),Er(k.TypeReference.create(Ke(G),Se,He)),!0}return!1}function Ma(){if(Mr(A.TokenKind.IDENTIFIER)){var G=Ar();return G.stringValue().toLowerCase()!=="null"?!1:(Sr(),Er(E.NullLiteral.create(Ke(G))),!0)}return!1}function Ga(G){var re=Ar();if(!Et(A.TokenKind.PROJECT,!0))return!1;var Se=tt();return _r(A.TokenKind.RSQUARE),Er(_e.Projection.create(G,Ke(re),Se)),!0}function Ua(){var G=Ar(),re=[];if(!Et(A.TokenKind.LCURLY,!0))return!1;var Se=null,He=Ar();if(Et(A.TokenKind.RCURLY,!0))Se=be.InlineList.create(At(G.startPos,He.endPos));else if(Et(A.TokenKind.COLON,!0))He=_r(A.TokenKind.RCURLY),Se=ue.InlineMap.create(At(G.startPos,He.endPos));else{var mt=tt();if(Mr(A.TokenKind.RCURLY))re.push(mt),He=_r(A.TokenKind.RCURLY),Se=be.InlineList.create(At(G.startPos,He.endPos),re);else if(Et(A.TokenKind.COMMA,!0)){re.push(mt);do re.push(tt());while(Et(A.TokenKind.COMMA,!0));He=_r(A.TokenKind.RCURLY),Se=be.InlineList.create(Ke(G.startPos,He.endPos),re)}else if(Et(A.TokenKind.COLON,!0)){var lt=[];for(lt.push(mt),lt.push(tt());Et(A.TokenKind.COMMA,!0);)lt.push(tt()),_r(A.TokenKind.COLON),lt.push(tt());He=_r(A.TokenKind.RCURLY),Se=ue.InlineMap.create(At(G.startPos,He.endPos),lt)}else nt(G.startPos,"OOD")}return Er(Se),!0}function Ba(){var G=Ar();if(!Et(A.TokenKind.LSQUARE,!0))return!1;var re=tt();return _r(A.TokenKind.RSQUARE),Er(Y.Indexer.create(Ke(G),re)),!0}function $a(G){var re=Ar();if(!Ha())return!1;Sr();var Se=tt();return Se===null&&nt(Ke(re),"MISSING_SELECTION_EXPRESSION"),_r(A.TokenKind.RSQUARE),re.getKind()===A.TokenKind.SELECT_FIRST?Er(fe.Selection.create(G,fe.Selection.FIRST,Ke(re),Se)):re.getKind()===A.TokenKind.SELECT_LAST?Er(fe.Selection.create(G,fe.Selection.LAST,Ke(re),Se)):Er(fe.Selection.create(G,fe.Selection.ALL,Ke(re),Se)),!0}function ma(){for(var G=[],re=Ar();Uo(re);)Sr(),re.kind!==A.TokenKind.DOT&&G.push(rr.Identifier.create(re.stringValue(),Ke(re))),re=Ar();G.length||(re===null&&nt(On.length(),"OOD"),nt(re.startPos,"NOT_EXPECTED_TOKEN","qualified ID",re.getKind().toString().toLowerCase()));var Se=At(G[0].getStartPosition(),G[G.length-1].getEndPosition());return gt.QualifiedIdentifier.create(Se,G)}function Uo(G){if(G===null||G.kind===A.TokenKind.LITERAL_STRING)return!1;if(G.kind===A.TokenKind.DOT||G.kind===A.TokenKind.IDENTIFIER)return!0;var re=G.stringValue();return re&&re.length&&Wt.test(re)}function Wa(G){if(Mr(A.TokenKind.IDENTIFIER)){var re=Sr(),Se=Tt();return Se===null?(Er(W.PropertyReference.create(G,re.stringValue(),Ke(re))),!0):(Er(j.MethodReference.create(G,re.stringValue(),Ke(re),Se)),!0)}return!1}function Ka(){if(Pn("new")){var G=Sr();if(Mr(A.TokenKind.RSQUARE))return Er(W.PropertyReference.create(G.stringValue(),Ke(G))),!0;var re=ma(),Se=[];if(Se.push(re),Mr(A.TokenKind.LSQUARE)){for(var He=[];Et(A.TokenKind.LSQUARE,!0);)Mr(A.TokenKind.RSQUARE)?He.push(null):He.push(tt()),_r(A.TokenKind.RSQUARE);Ua()&&Se.push(Nt()),Er(Jr.ConstructorReference.create(Ke(G),He,Se))}else fn(Se),Er(Jr.ConstructorReference.create(Ke(G),Se));return!0}return!1}function Er(G){fa.push(G)}function Nt(){return fa.pop()}function Bo(){var G=Ar();if(G===null)return!1;if(G.getKind()===A.TokenKind.LITERAL_INT||G.getKind()===A.TokenKind.LITERAL_LONG)Er(z.NumberLiteral.create(parseInt(G.stringValue(),10),Ke(G)));else if(G.getKind()===A.TokenKind.LITERAL_REAL||G.getKind()===A.TokenKind.LITERAL_REAL_FLOAT)Er(z.NumberLiteral.create(parseFloat(G.stringValue()),Ke(G)));else if(G.getKind()===A.TokenKind.LITERAL_HEXINT||G.getKind()===A.TokenKind.LITERAL_HEXLONG)Er(z.NumberLiteral.create(parseInt(G.stringValue(),16),Ke(G)));else if(Pn("true"))Er($.BooleanLiteral.create(!0,Ke(G)));else if(Pn("false"))Er($.BooleanLiteral.create(!1,Ke(G)));else if(G.getKind()===A.TokenKind.LITERAL_STRING)Er(T.StringLiteral.create(G.stringValue(),Ke(G)));else return!1;return Sr(),!0}function za(){if(Mr(A.TokenKind.LPAREN)){Sr();var G=tt();return _r(A.TokenKind.RPAREN),Er(G),!0}else return!1}function $o(){var G=Ar();if(G===null)return null;if(G.isNumericRelationalOperator())return G;if(G.isIdentifier()){var re=G.stringValue();if(re.toLowerCase()==="instanceof")return G.asInstanceOfToken();if(re.toLowerCase()==="matches")return G.asMatchesToken();if(re.toLowerCase()==="between")return G.asBetweenToken()}return null}function _r(G){var re=Sr();return re===null&&nt(On.length,"OOD"),re.getKind()!==G&&nt(re.startPos,"NOT_EXPECTED_TOKEN",G.toString().toLowerCase(),re.getKind().toString().toLowerCase()),re}function Mr(G){return Et(G,!1)}function Et(G,re){if(!Fn())return!1;var Se=Ar();return Se.getKind()===G?(re&&qr++,!0):G===A.TokenKind.IDENTIFIER&&Se.getKind().ordinal()>=A.TokenKind.DIV.ordinal()&&Se.getKind().ordinal()<=A.TokenKind.NOT.ordinal()&&Se.data!==null}function zt(){if(!Fn())return!1;for(var G=Ar(),re=Array.prototype.slice.call(arguments),Se=0,He=re.length;Se<He;Se+=1)if(G.getKind()===re[Se])return!0;return!1}function Pn(G){if(!Fn())return!1;var re=Ar();return re.getKind()===A.TokenKind.IDENTIFIER&&re.stringValue().toLowerCase()===G.toLowerCase()}function Ha(){if(!Fn())return!1;var G=Ar();return G.getKind()===A.TokenKind.SELECT||G.getKind()===A.TokenKind.SELECT_FIRST||G.getKind()===A.TokenKind.SELECT_LAST}function Fn(){return qr<ln.length}function Sr(){return qr>=pa?null:ln[qr++]}function Ar(){return qr>=pa?null:ln[qr]}function nt(G,re,Se,He){throw Se&&(re+=`
Expected: `+Se),He&&(re+=`
Actual: `+He),{name:"InternalParseException",message:"Error occurred while attempting to parse expression '"+On+"' at position "+G+". Message: "+re}}function xn(G){return G.getKind().hasPayload()?G.stringValue():G.getKind().toString().toLowerCase()}function Wn(G,re,Se){Wo(G,re),ha(G,Se)}function Wo(G,re){re===null&&nt(G.startPos,"LEFT_OPERAND_PROBLEM")}function ha(G,re){re===null&&nt(G.startPos,"RIGHT_OPERAND_PROBLEM")}function Ke(G){return(G.startPos<<16)+G.endPos}function At(G,re){return(G<<16)+re}return{setConfiguration:Do,parse:No}}},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Tokenizer=void 0;var A=D(7),x=D(2),$=["DIV","EQ","GE","GT","LE","LT","MOD","NE","NOT"],z=[],T=1,E=2,I=4;function j(){var ee;for(ee=48;ee<=57;ee+=1)z[ee]|=T|E;for(ee=65;ee<=70;ee+=1)z[ee]|=E;for(ee=97;ee<=102;ee+=1)z[ee]|=E;for(ee=65;ee<=90;ee+=1)z[ee]|=I;for(ee=97;ee<=122;ee+=1)z[ee]|=I}j();function W(ee){var Y=ee,Z=ee+"\0",de=Z.length,H=0,Oe=[];function We(){for(var oe;H<de;)if(oe=Z[H],_e(oe))he();else switch(oe){case"+":Be(x.TokenKind.INC)?pr(x.TokenKind.INC):Qe(x.TokenKind.PLUS);break;case"_":he();break;case"-":Be(x.TokenKind.DEC)?pr(x.TokenKind.DEC):Qe(x.TokenKind.MINUS);break;case":":Qe(x.TokenKind.COLON);break;case".":Qe(x.TokenKind.DOT);break;case",":Qe(x.TokenKind.COMMA);break;case"*":Qe(x.TokenKind.STAR);break;case"/":Qe(x.TokenKind.DIV);break;case"%":Qe(x.TokenKind.MOD);break;case"(":Qe(x.TokenKind.LPAREN);break;case")":Qe(x.TokenKind.RPAREN);break;case"[":Qe(x.TokenKind.LSQUARE);break;case"#":Qe(x.TokenKind.HASH);break;case"]":Qe(x.TokenKind.RSQUARE);break;case"{":Qe(x.TokenKind.LCURLY);break;case"}":Qe(x.TokenKind.RCURLY);break;case"@":Qe(x.TokenKind.BEAN_REF);break;case"^":Be(x.TokenKind.SELECT_FIRST)?pr(x.TokenKind.SELECT_FIRST):Qe(x.TokenKind.POWER);break;case"!":Be(x.TokenKind.NE)?pr(x.TokenKind.NE):Be(x.TokenKind.PROJECT)?pr(x.TokenKind.PROJECT):Qe(x.TokenKind.NOT);break;case"=":Be(x.TokenKind.EQ)?pr(x.TokenKind.EQ):Qe(x.TokenKind.ASSIGN);break;case"&":if(!Be(x.TokenKind.SYMBOLIC_AND))throw{name:"SpelParseException",message:"Missing character '&' in expression ("+Y+") at position "+H};pr(x.TokenKind.SYMBOLIC_AND);break;case"|":if(!Be(x.TokenKind.SYMBOLIC_OR))throw{name:"SpelParseException",message:"Missing character '|' in expression ("+Y+") at position "+H};pr(x.TokenKind.SYMBOLIC_OR);break;case"?":Be(x.TokenKind.SELECT)?pr(x.TokenKind.SELECT):Be(x.TokenKind.ELVIS)?pr(x.TokenKind.ELVIS):Be(x.TokenKind.SAFE_NAVI)?pr(x.TokenKind.SAFE_NAVI):Qe(x.TokenKind.QMARK);break;case"$":Be(x.TokenKind.SELECT_LAST)?pr(x.TokenKind.SELECT_LAST):he();break;case">":Be(x.TokenKind.GE)?pr(x.TokenKind.GE):Qe(x.TokenKind.GT);break;case"<":Be(x.TokenKind.LE)?pr(x.TokenKind.LE):Qe(x.TokenKind.LT);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":je(oe==="0");break;case" ":case"	":case"\r":case`
`:H+=1;break;case"'":Je();break;case'"':ke();break;case"\0":H+=1;break;case"\\":throw{name:"SpelParseException",message:"Unexpected escape character in expression ("+Y+") at position "+H};default:throw{name:"SpelParseException",message:"Cannot handle character '"+oe+"' in expression ("+Y+") at position "+H}}}function Je(){for(var oe=H,k=!1,F;!k;)if(H+=1,F=Z[H],F==="'"&&(Z[H+1]==="'"?H+=1:k=!0),F.charCodeAt(0)===0)throw{name:"SpelParseException",message:"Non-terminating quoted string in expression ("+Y+") at position "+H};H+=1,Oe.push(new A.Token(x.TokenKind.LITERAL_STRING,fr(oe,H),oe,H))}function ke(){for(var oe=H,k=!1,F;!k;)if(H+=1,F=Z[H],F==='"'&&(Z[H+1]==='"'?H+=1:k=!0),F.charCodeAt(0)===0)throw{name:"SpelParseException",message:"Non-terminating double-quoted string in expression ("+Y+") at position "+H};H+=1,Oe.push(new A.Token(x.TokenKind.LITERAL_STRING,fr(oe,H),oe,H))}function je(oe){var k=!1,F=H,rr=Z[H+1],gt=rr==="x"||rr==="X",Jr,br,ca,Wt;if(oe&&gt){H=H+1;do H+=1;while(Me(Z[H]));jt("L","l")?(Ue(fr(F+2,H),!0,F,H),H+=1):Ue(fr(F+2,H),!1,F,H);return}do H+=1;while(fe(Z[H]));if(rr=Z[H],rr==="."){k=!0,Jr=H;do H+=1;while(fe(Z[H]));if(H===Jr+1){H=Jr,qe(fr(F,H),!1,F,H);return}}if(br=H,jt("L","l")){if(k)throw{name:"SpelParseException",message:"Real cannot be long in expression ("+Y+") at position "+H};qe(fr(F,br),!0,F,br),H+=1}else if(vr(Z[H])){k=!0,H+=1,ca=Z[H],ue(ca)&&(H+=1);do H+=1;while(fe(Z[H]));Wt=!1,ut(Z[H])?(Wt=!0,H+=1,br=H):be(Z[H])&&(H+=1,br=H),er(fr(F,H),Wt,F,H)}else rr=Z[H],Wt=!1,ut(rr)?(k=!0,Wt=!0,H+=1,br=H):be(rr)&&(k=!0,H+=1,br=H),k?er(fr(F,br),Wt,F,br):qe(fr(F,br),!1,F,br)}function he(){var oe=H,k,F,rr;do H+=1;while(rt(Z[H]));if(k=fr(oe,H),(H-oe===2||H-oe===3)&&(F=k.toUpperCase(),rr=$.indexOf(F),rr>=0)){Ir(x.TokenKind.valueOf(F),oe,k);return}Oe.push(new A.Token(x.TokenKind.IDENTIFIER,k.replace("\0",""),oe,H))}function qe(oe,k,F,rr){k?Oe.push(new A.Token(x.TokenKind.LITERAL_LONG,oe,F,rr)):Oe.push(new A.Token(x.TokenKind.LITERAL_INT,oe,F,rr))}function Ue(oe,k,F,rr){if(oe.length===0)throw k?{name:"SpelParseException",message:"Not a long in expression ("+Y+") at position "+H}:{name:"SpelParseException",message:"Not an int in expression ("+Y+") at position "+H};k?Oe.push(new A.Token(x.TokenKind.LITERAL_HEXLONG,oe,F,rr)):Oe.push(new A.Token(x.TokenKind.LITERAL_HEXINT,oe,F,rr))}function er(oe,k,F,rr){k?Oe.push(new A.Token(x.TokenKind.LITERAL_REAL_FLOAT,oe,F,rr)):Oe.push(new A.Token(x.TokenKind.LITERAL_REAL,oe,F,rr))}function fr(oe,k){return Z.substring(oe,k)}function Be(oe){return oe.tokenChars.length===2&&Z[H]===oe.tokenChars[0]?Z[H+1]===oe.tokenChars[1]:!1}function Qe(oe){Oe.push(new A.Token(oe,null,H,H+1)),H+=1}function pr(oe){Oe.push(new A.Token(oe,null,H,H+2)),H+=2}function Ir(oe,k,F){Oe.push(new A.Token(oe,F,k,k+oe.getLength()))}function rt(oe){return _e(oe)||fe(oe)||oe==="_"||oe==="$"}function jt(oe,k){var F=Z[H];return F===oe||F===k}function vr(oe){return oe==="e"||oe==="E"}function ut(oe){return oe==="f"||oe==="F"}function be(oe){return oe==="d"||oe==="D"}function ue(oe){return oe==="+"||oe==="-"}function fe(oe){return oe.charCodeAt(0)>255?!1:(z[oe.charCodeAt(0)]&T)!==0}function _e(oe){return oe.charCodeAt(0)>255?!1:(z[oe.charCodeAt(0)]&I)!==0}function Me(oe){return oe.charCodeAt(0)>255?!1:(z[oe.charCodeAt(0)]&E)!==0}return We(),Oe}var X=y.Tokenizer={tokenize:W}},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Token=void 0;var A=D(2);function x($,z,T,E){this.kind=$,this.startPos=T,this.endPos=E,z&&(this.data=z)}x.prototype.getKind=function(){return this.kind},x.prototype.toString=function(){var $="[";return $+=this.kind.toString(),this.kind.hasPayload()&&($+=":"+this.data),$+="]",$+="("+this.startPos+","+this.endPos+")",$},x.prototype.isIdentifier=function(){return this.kind===A.TokenKind.IDENTIFIER},x.prototype.isNumericRelationalOperator=function(){return this.kind===A.TokenKind.GT||this.kind===A.TokenKind.GE||this.kind===A.TokenKind.LT||this.kind===A.TokenKind.LE||this.kind===A.TokenKind.EQ||this.kind===A.TokenKind.NE},x.prototype.stringValue=function(){return this.data},x.prototype.asInstanceOfToken=function(){return new x(A.TokenKind.INSTANCEOF,this.startPos,this.endPos)},x.prototype.asMatchesToken=function(){return new x(A.TokenKind.MATCHES,this.startPos,this.endPos)},x.prototype.asBetweenToken=function(){return new x(A.TokenKind.BETWEEN,this.startPos,this.endPos)},x.prototype.getStartPosition=function(){return this.startPos},x.prototype.getEndPosition=function(){return this.endPos},y.Token=x},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.BooleanLiteral=void 0;var A=D(0);function x(z,T){var E=A.SpelNode.create("boolean",T);return E.getValue=function(){return z},E.setValue=function(I){return z=I},E}var $=y.BooleanLiteral={create:x}},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.NumberLiteral=void 0;var A=D(0);function x(z,T){var E=A.SpelNode.create("number",T);return E.getValue=function(){return z},E.setValue=function(I){return z=I},E}var $=y.NumberLiteral={create:x}},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.StringLiteral=void 0;var A=D(0);function x(z,T){var E=A.SpelNode.create("string",T);function I(j){return(j[0]==="'"&&j[j.length-1]==="'"||j[0]==='"'&&j[j.length-1]==='"')&&(j=j.substring(1,j.length-1)),j.replace(/''/g,"'").replace(/""/g,'"')}return z=I(z),E.getValue=function(){return z},E.setValue=function(j){return z=j},E}var $=y.StringLiteral={create:x}},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.NullLiteral=void 0;var A=D(0);function x(z,T){var E=A.SpelNode.create("null",T);return E.getValue=function(){return null},E}var $=y.NullLiteral={create:x}},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.FunctionReference=void 0;var A=D(0),x=D(1);function $(T,E,I){var j=A.SpelNode.create("function",E);return j.getRaw=function(){return{functionName:T,args:I}},j.getValue=function(W){var X=W.locals||{},ee=W.rootContext,Y=[];if(I.forEach(function(Z){var de=W.activeContext;W.activeContext=new x.Stack,W.activeContext.push(W.rootContext),Y.push(Z.getValue(W)),W.activeContext=de}),X[T])return X[T].apply(ee,Y);throw{name:"FunctionDoesNotExistException",message:"Function '"+T+"' does not exist."}},j}var z=y.FunctionReference={create:$}},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.MethodReference=void 0;var A=D(0),x=D(1);function $(T,E,I,j){var W=A.SpelNode.create("method",I);return W.getRaw=function(){return{methodName:E,args:j}},W.getValue=function(X){var ee=X.activeContext.peek(),Y=[],Z;if(!ee)throw{name:"ContextDoesNotExistException",message:"Attempting to look up property '"+E+"' for an undefined context."};function de(H){if(H==null){if(T)return null;throw{name:"NullPointerException",message:"Method "+E+" does not exist."}}return H}if(j.forEach(function(H){var Oe=X.activeContext;X.activeContext=new x.Stack,X.activeContext.push(X.rootContext),Y.push(H.getValue(X)),X.activeContext=Oe}),E.substr(0,3)==="get"&&!ee[E])return de(ee[E.charAt(3).toLowerCase()+E.substring(4)]);if(E.substr(0,3)==="set"&&!ee[E])return ee[E.charAt(3).toLowerCase()+E.substring(4)]=Y[0];if(Array.isArray(ee)){if(E==="size")return ee.length;if(E==="contains")return ee.includes(Y[0])}return Z=de(ee[E]),Z?Z.apply(ee,Y):null},W}var z=y.MethodReference={create:$}},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.PropertyReference=void 0;var A=D(0);function x(z,T,E){var I=A.SpelNode.create("property",E);return I.getRaw=function(){return T},I.getValue=function(j){var W=j.activeContext.peek();if(!W){if(z)return null;throw{name:"ContextDoesNotExistException",message:"Attempting to look up property '"+T+"' for an undefined context."}}if(W[T]===void 0||W[T]===null){if(z)return null;if(T==="size"&&Array.isArray(W))return W.length;throw{name:"NullPointerException",message:"Property '"+T+"' does not exist."}}return W[T]},I.setValue=function(j,W){var X=W.activeContext.peek();if(!X)throw{name:"ContextDoesNotExistException",message:"Attempting to assign property '"+T+"' for an undefined context."};return X[T]=j},I.getName=function(){return T},I}var $=y.PropertyReference={create:x}},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.VariableReference=void 0;var A=D(0);function x(z,T){var E=A.SpelNode.create("variable",T);return E.getRaw=function(){return z},E.getValue=function(I){var j=I.activeContext.peek(),W=I.locals;if(!j)throw{name:"ContextDoesNotExistException",message:"Attempting to look up variable '"+z+"' for an undefined context."};return z==="this"?j:z==="root"?I.rootContext:W[z]},E.setValue=function(I,j){var W=j.locals;return W[z]=I},E}var $=y.VariableReference={create:x}},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.CompoundExpression=void 0;var A=D(0);function x(z,T){var E=A.SpelNode.create.apply(null,["compound",z].concat(T));function I(j){var W=E.getChildren().length,X;for(X=0;X<W;X+=1)E.getChildren()[X].getType()==="indexer"?j.activeContext.push(j.activeContext.peek()[E.getChildren()[X].getValue(j)]):j.activeContext.push(E.getChildren()[X].getValue(j));return function(){for(X=0;X<W;X+=1)j.activeContext.pop()}}return E.getValue=function(j){var W=j.activeContext.peek(),X;if(!W)throw{name:"ContextDoesNotExistException",message:"Attempting to evaluate compound expression with an undefined context."};var ee=I(j);return X=j.activeContext.peek(),ee(),X},E.setValue=function(j,W){var X=I(W),ee=E.getChildren().length;return W.activeContext.pop(),j=E.getChildren()[ee-1].setValue(j,W),W.activeContext.push(null),X(),j},E}var $=y.CompoundExpression={create:x}},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Indexer=void 0;var A=D(0),x=D(1);function $(T,E){var I=A.SpelNode.create.apply(null,["indexer",T].concat(E));return I.getValue=function(j){var W=j.activeContext,X,ee=I.getChildren().length,Y,Z;if(j.activeContext=new x.Stack,j.activeContext.push(j.rootContext),X=j.activeContext.peek(),!X)throw{name:"ContextDoesNotExistException",message:"Attempting to evaluate compound expression with an undefined context."};for(Y=0;Y<ee;Y+=1)j.activeContext.push(I.getChildren()[Y].getValue(j));for(Z=j.activeContext.peek(),Y=0;Y<ee;Y+=1)j.activeContext.pop();return j.activeContext=W,Z},I}var z=y.Indexer={create:$}},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Assign=void 0;var A=D(0);function x(z,T,E){var I=A.SpelNode.create("assign",z,T,E);return I.getValue=function(j){var W=j.activeContext.peek();if(!W)throw{name:"ContextDoesNotExistException",message:"Attempting to assign property '"+T.getValue(j)+"' for an undefined context."};return T.setValue(E.getValue(j),j)},I}var $=y.Assign={create:x}},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpEQ=void 0;var A=D(0);function x(z,T,E){var I=A.SpelNode.create("op-eq",z,T,E);return I.getValue=function(j){return T.getValue(j)===E.getValue(j)},I}var $=y.OpEQ={create:x}},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpNE=void 0;var A=D(0);function x(z,T,E){var I=A.SpelNode.create("op-ne",z,T,E);return I.getValue=function(j){return T.getValue(j)!==E.getValue(j)},I}var $=y.OpNE={create:x}},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpGE=void 0;var A=D(0);function x(z,T,E){var I=A.SpelNode.create("op-ge",z,T,E);return I.getValue=function(j){return T.getValue(j)>=E.getValue(j)},I}var $=y.OpGE={create:x}},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpGT=void 0;var A=D(0);function x(z,T,E){var I=A.SpelNode.create("op-gt",z,T,E);return I.getValue=function(j){return T.getValue(j)>E.getValue(j)},I}var $=y.OpGT={create:x}},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpLE=void 0;var A=D(0);function x(z,T,E){var I=A.SpelNode.create("op-le",z,T,E);return I.getValue=function(j){return T.getValue(j)<=E.getValue(j)},I}var $=y.OpLE={create:x}},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpLT=void 0;var A=D(0);function x(z,T,E){var I=A.SpelNode.create("op-lt",z,T,E);return I.getValue=function(j){return T.getValue(j)<E.getValue(j)},I}var $=y.OpLT={create:x}},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpPlus=void 0;var A=D(0);function x(z,T,E){var I=A.SpelNode.create("op-plus",z,T,E);return I.getValue=function(j){return E?T.getValue(j)+E.getValue(j):+T.getValue(j)},I}var $=y.OpPlus={create:x}},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpMinus=void 0;var A=D(0);function x(z,T,E){var I=A.SpelNode.create("op-minus",z,T,E);return I.getValue=function(j){return E?T.getValue(j)-E.getValue(j):-T.getValue(j)},I}var $=y.OpMinus={create:x}},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpMultiply=void 0;var A=D(0);function x(z,T,E){var I=A.SpelNode.create("op-multiply",z,T,E);return I.getValue=function(j){var W=T.getValue(j),X=E.getValue(j);if(typeof W=="number"&&typeof X=="number")return W*X;if(typeof W=="string"&&typeof X=="number"){for(var ee="",Y=0;Y<X;Y+=1)ee+=W;return ee}return null},I}var $=y.OpMultiply={create:x}},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpDivide=void 0;var A=D(0);function x(z,T,E){var I=A.SpelNode.create("op-divide",z,T,E);return I.getValue=function(j){return T.getValue(j)/E.getValue(j)},I}var $=y.OpDivide={create:x}},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpModulus=void 0;var A=D(0);function x(z,T,E){var I=A.SpelNode.create("op-modulus",z,T,E);return I.getValue=function(j){return T.getValue(j)%E.getValue(j)},I}var $=y.OpModulus={create:x}},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpPower=void 0;var A=D(0);function x(z,T,E){var I=A.SpelNode.create("op-power",z,T,E);return I.getValue=function(j){return Math.pow(T.getValue(j),E.getValue(j))},I}var $=y.OpPower={create:x}},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpInc=void 0;var A=D(0);function x(z,T,E){var I=A.SpelNode.create("op-inc",z,E);return I.getValue=function(j){var W=E.getValue(j);return E.setValue(W+1,j),T?W:W+1},I}var $=y.OpInc={create:x}},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpDec=void 0;var A=D(0);function x(z,T,E){var I=A.SpelNode.create("op-dec",z,E);return I.getValue=function(j){var W=E.getValue(j);return E.setValue(W-1,j),T?W:W-1},I}var $=y.OpDec={create:x}},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpNot=void 0;var A=D(0);function x(z,T){var E=A.SpelNode.create("op-not",z,T);return E.getValue=function(I){return!T.getValue(I)},E}var $=y.OpNot={create:x}},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpAnd=void 0;var A=D(0);function x(z,T,E){var I=A.SpelNode.create("op-and",z,T,E);return I.getValue=function(j){return!!T.getValue(j)&&!!E.getValue(j)},I}var $=y.OpAnd={create:x}},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpOr=void 0;var A=D(0);function x(z,T,E){var I=A.SpelNode.create("op-or",z,T,E);return I.getValue=function(j){return!!T.getValue(j)||!!E.getValue(j)},I}var $=y.OpOr={create:x}},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpMatches=void 0;var A=D(0);function x(z,T,E){var I=A.SpelNode.create("matches",z,T,E);return I.getValue=function(j){var W=T.getValue(j),X=E.getValue(j);try{var ee=new RegExp(X);return!!ee.exec(W)}catch(Y){throw{name:"EvaluationException",message:Y.toString()}}},I}var $=y.OpMatches={create:x}},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Ternary=void 0;var A=D(0);function x(z,T,E,I){var j=A.SpelNode.create("ternary",z,T,E,I);return j.getValue=function(W){return T.getValue(W)?E.getValue(W):I.getValue(W)},j}var $=y.Ternary={create:x}},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Elvis=void 0;var A=D(0);function x(z,T,E){var I=A.SpelNode.create("elvis",z,T,E);return I.getValue=function(j){return T.getValue(j)!==null?T.getValue(j):E.getValue(j)},I}var $=y.Elvis={create:x}},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.InlineList=void 0;var A=D(0);function x(z,T){var E=A.SpelNode.create("list",z),I=[].concat(T||[]);return E.getRaw=function(){return I},E.getValue=function(j){return I.map(function(W){return W.getValue(j)})},E}var $=y.InlineList={create:x}},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.InlineMap=void 0;var A=D(0);function x(z,T){var E=A.SpelNode.create("map",z),I=[].concat(T||[]);return E.getValue=function(j){var W=!0,X=null,ee={};return I.forEach(function(Y){W?Y.getType()==="property"?X=Y.getName():X=Y.getValue(j):ee[X]=Y.getValue(j),W=!W}),ee},E}var $=y.InlineMap={create:x}},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Selection=void 0;var A=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(j){return typeof j}:function(j){return j&&typeof Symbol=="function"&&j.constructor===Symbol&&j!==Symbol.prototype?"symbol":typeof j},x=D(0);function $(j,W,X){var ee=!1;return X.activeContext.push(j),ee=W.getValue(X),X.activeContext.pop(),ee}function z(j,W,X,ee){var Y=j.filter(function(Z){return $(Z,X,ee)});switch(W){case"ALL":return Y;case"FIRST":return Y[0]||null;case"LAST":return Y.length?Y[Y.length-1]:null}}function T(j,W,X,ee){var Y={},Z,de,H=[],Oe={};for(de in j)j.hasOwnProperty(de)&&(Z={key:de,value:j[de]},$(Z,X,ee)&&H.push(Z));switch(W){case"ALL":return H.forEach(function(We){Y[We.key]=We.value}),Y;case"FIRST":return H.length?(Oe[H[0].key]=H[0].value,Oe):null;case"LAST":return H.length?(Oe[H[H.length-1].key]=H[H.length-1].value,Oe):null}H.forEach(function(We){Y[We.key]=We.value})}function E(j,W,X,ee){var Y=x.SpelNode.create("selection",X,ee);return Y.getValue=function(Z){var de=Z.activeContext.peek();if(de){if(Array.isArray(de))return z(de,W,ee,Z);if((typeof de>"u"?"undefined":A(de))==="object")return T(de,W,ee,Z)}return null},Y}var I=y.Selection={create:E,FIRST:"FIRST",LAST:"LAST",ALL:"ALL"}},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Projection=void 0;var A=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(E){return typeof E}:function(E){return E&&typeof Symbol=="function"&&E.constructor===Symbol&&E!==Symbol.prototype?"symbol":typeof E},x=D(0);function $(E,I,j){return E.map(function(W){var X;return j.activeContext.push(W),X=I.getValue(j),j.activeContext.pop(),X})}function z(E,I,j){var W=x.SpelNode.create("projection",I,j);return W.getValue=function(X){var ee=X.activeContext.peek(),Y=[],Z;if(Array.isArray(ee))return $(ee,j,X);if((typeof ee>"u"?"undefined":A(ee))==="object"){for(Z in ee)ee.hasOwnProperty(Z)&&Y.push(ee[Z]);return $(Y,j,X)}return null},W}var T=y.Projection={create:z}},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpInstanceof=void 0;var A=D(0);function x(z,T,E){var I=A.SpelNode.create("instanceof",z,T,E);return I.getValue=function(j){throw{name:"MethodNotImplementedException",message:"OpInstanceOf: Not implemented"}},I}var $=y.OpInstanceof={create:x}},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpBetween=void 0;var A=D(0);function x(z,T,E){var I=A.SpelNode.create("between",z,T,E);return I.getValue=function(j){throw{name:"MethodNotImplementedException",message:"OpBetween: Not implemented"}},I}var $=y.OpBetween={create:x}},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.TypeReference=void 0;var A=D(0);function x(z,I,E){var I=A.SpelNode.create("typeref",z,I);return I.getValue=function(j){throw{name:"MethodNotImplementedException",message:"TypeReference: Not implemented"}},I}var $=y.TypeReference={create:x}},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.BeanReference=void 0;var A=D(0);function x(z,T){var E=A.SpelNode.create("beanref",z);return E.getValue=function(I){throw{name:"MethodNotImplementedException",message:"BeanReference: Not implemented"}},E}var $=y.BeanReference={create:x}},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Identifier=void 0;var A=D(0);function x(z,T){var E=A.SpelNode.create("identifier",T);return E.getRaw=function(){return z},E.getValue=function(I){throw{name:"MethodNotImplementedException",message:"Identifier: Not implemented"}},E}var $=y.Identifier={create:x}},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.QualifiedIdentifier=void 0;var A=D(0);function x(T){if(Array.isArray(T)){for(var E=0,I=Array(T.length);E<T.length;E++)I[E]=T[E];return I}else return Array.from(T)}function $(T,E){var I=A.SpelNode.create.apply(A.SpelNode,["qualifiedidentifier",T].concat(x(E)));return I.getRaw=function(){return E.map(function(j){return j.getRaw()})},I.getValue=function(j){throw{name:"MethodNotImplementedException",message:"QualifiedIdentifier: Not implemented"}},I}var z=y.QualifiedIdentifier={create:$}},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.ConstructorReference=void 0;var A=D(0),x=D(1);function $(I){if(Array.isArray(I)){for(var j=0,W=Array(I.length);j<I.length;j++)W[j]=I[j];return W}else return Array.from(I)}function z(I){return Array.isArray(I)?I:Array.from(I)}function T(I,j,W){var X=W!==void 0,ee;X?ee=j.length&&j[0]&&j[0].getType()==="number"?j[0].getValue():null:(W=j,j=void 0);var Y=W,Z=z(Y),de=Z[0],H=Z.slice(1),Oe=A.SpelNode.create.apply(A.SpelNode,["constructorref",I].concat($(W)));return Oe.getRaw=function(){return ee},Oe.getValue=function(We){if(X&&H.length<=1){var Je=[];return H.forEach(function(ke){var je=We.activeContext;We.activeContext=new x.Stack,We.activeContext.push(We.rootContext),Je.push(ke.getValue(We)),We.activeContext=je}),H.length===1?Je[0]:ee?new Array(ee):[]}throw{name:"MethodNotImplementedException",message:"ConstructorReference: Not implemented"}},Oe}var E=y.ConstructorReference={create:T}},function(ve,y,D){"use strict";Object.defineProperty(y,"__esModule",{value:!0});function A($,z){var T={};return T.authentication=$||{},T.principal=z||{},T.hasRole=function(E){var I=!1;return!E||!T.authentication&&!Array.isArray(T.authentication.authorities)?!1:(T.authentication.authorities.forEach(function(j){j.authority.toLowerCase()===E.toLowerCase()&&(I=!0)}),I)},T.hasPermission=function(){var E=Array.prototype.slice.call(arguments);if(E.length===1)return T.hasRole(E[0])},T}var x=y.StandardContext={create:A}}])})},61526:(xe,ve,y)=>{xe.exports=y(88319)},88319:(xe,ve,y)=>{var D=y(48287).Buffer,A=ve,x=/`/g,$=/\./g,z=/[\0\b\t\n\r\x1a\"\'\\]/g,T={"\0":"\\0","\b":"\\b","	":"\\t","\n":"\\n","\r":"\\r","":"\\Z",'"':'\\"',"'":"\\'","\\":"\\\\"};A.escapeId=function(X,ee){if(Array.isArray(X)){for(var Y="",Z=0;Z<X.length;Z++)Y+=(Z===0?"":", ")+A.escapeId(X[Z],ee);return Y}else return ee?"`"+String(X).replace(x,"``")+"`":"`"+String(X).replace(x,"``").replace($,"`.`")+"`"},A.escape=function(X,ee,Y){if(X==null)return"NULL";switch(typeof X){case"boolean":return X?"true":"false";case"number":return X+"";case"object":return Object.prototype.toString.call(X)==="[object Date]"?A.dateToString(X,Y||"local"):Array.isArray(X)?A.arrayToList(X,Y):D.isBuffer(X)?A.bufferToString(X):typeof X.toSqlString=="function"?String(X.toSqlString()):ee?E(X.toString()):A.objectToValues(X,Y);default:return E(X)}},A.arrayToList=function(X,ee){for(var Y="",Z=0;Z<X.length;Z++){var de=X[Z];Array.isArray(de)?Y+=(Z===0?"":", ")+"("+A.arrayToList(de,ee)+")":Y+=(Z===0?"":", ")+A.escape(de,!0,ee)}return Y},A.format=function(X,ee,Y,Z){if(ee==null)return X;Array.isArray(ee)||(ee=[ee]);for(var de=0,H=/\?+/g,Oe="",We=0,Je;We<ee.length&&(Je=H.exec(X));){var ke=Je[0].length;if(!(ke>2)){var je=ke===2?A.escapeId(ee[We]):A.escape(ee[We],Y,Z);Oe+=X.slice(de,Je.index)+je,de=H.lastIndex,We++}}return de===0?X:de<X.length?Oe+X.slice(de):Oe},A.dateToString=function(X,ee){var Y=new Date(X);if(isNaN(Y.getTime()))return"NULL";var Z,de,H,Oe,We,Je,ke;if(ee==="local")Z=Y.getFullYear(),de=Y.getMonth()+1,H=Y.getDate(),Oe=Y.getHours(),We=Y.getMinutes(),Je=Y.getSeconds(),ke=Y.getMilliseconds();else{var je=j(ee);je!==!1&&je!==0&&Y.setTime(Y.getTime()+je*6e4),Z=Y.getUTCFullYear(),de=Y.getUTCMonth()+1,H=Y.getUTCDate(),Oe=Y.getUTCHours(),We=Y.getUTCMinutes(),Je=Y.getUTCSeconds(),ke=Y.getUTCMilliseconds()}var he=I(Z,4)+"-"+I(de,2)+"-"+I(H,2)+" "+I(Oe,2)+":"+I(We,2)+":"+I(Je,2)+"."+I(ke,3);return E(he)},A.bufferToString=function(X){return"X"+E(X.toString("hex"))},A.objectToValues=function(X,ee){var Y="";for(var Z in X){var de=X[Z];typeof de!="function"&&(Y+=(Y.length===0?"":", ")+A.escapeId(Z)+" = "+A.escape(de,!0,ee))}return Y},A.raw=function(X){if(typeof X!="string")throw new TypeError("argument sql must be a string");return{toSqlString:function(){return X}}};function E(W){for(var X=z.lastIndex=0,ee="",Y;Y=z.exec(W);)ee+=W.slice(X,Y.index)+T[Y[0]],X=z.lastIndex;return X===0?"'"+W+"'":X<W.length?"'"+ee+W.slice(X)+"'":"'"+ee+"'"}function I(W,X){for(W=W.toString();W.length<X;)W="0"+W;return W}function j(W){if(W==="Z")return 0;var X=W.match(/([\+\-\s])(\d\d):?(\d\d)?/);return X?(X[1]==="-"?-1:1)*(parseInt(X[2],10)+(X[3]?parseInt(X[3],10):0)/60)*60:!1}},4633:(xe,ve,y)=>{var D=y(73738).default;function A(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */xe.exports=A=function(){return $},xe.exports.__esModule=!0,xe.exports.default=xe.exports;var x,$={},z=Object.prototype,T=z.hasOwnProperty,E=Object.defineProperty||function(be,ue,fe){be[ue]=fe.value},I=typeof Symbol=="function"?Symbol:{},j=I.iterator||"@@iterator",W=I.asyncIterator||"@@asyncIterator",X=I.toStringTag||"@@toStringTag";function ee(be,ue,fe){return Object.defineProperty(be,ue,{value:fe,enumerable:!0,configurable:!0,writable:!0}),be[ue]}try{ee({},"")}catch{ee=function(fe,_e,Me){return fe[_e]=Me}}function Y(be,ue,fe,_e){var Me=ue&&ue.prototype instanceof ke?ue:ke,oe=Object.create(Me.prototype),k=new vr(_e||[]);return E(oe,"_invoke",{value:pr(be,fe,k)}),oe}function Z(be,ue,fe){try{return{type:"normal",arg:be.call(ue,fe)}}catch(_e){return{type:"throw",arg:_e}}}$.wrap=Y;var de="suspendedStart",H="suspendedYield",Oe="executing",We="completed",Je={};function ke(){}function je(){}function he(){}var qe={};ee(qe,j,function(){return this});var Ue=Object.getPrototypeOf,er=Ue&&Ue(Ue(ut([])));er&&er!==z&&T.call(er,j)&&(qe=er);var fr=he.prototype=ke.prototype=Object.create(qe);function Be(be){["next","throw","return"].forEach(function(ue){ee(be,ue,function(fe){return this._invoke(ue,fe)})})}function Qe(be,ue){function fe(Me,oe,k,F){var rr=Z(be[Me],be,oe);if(rr.type!=="throw"){var gt=rr.arg,Jr=gt.value;return Jr&&D(Jr)=="object"&&T.call(Jr,"__await")?ue.resolve(Jr.__await).then(function(br){fe("next",br,k,F)},function(br){fe("throw",br,k,F)}):ue.resolve(Jr).then(function(br){gt.value=br,k(gt)},function(br){return fe("throw",br,k,F)})}F(rr.arg)}var _e;E(this,"_invoke",{value:function(oe,k){function F(){return new ue(function(rr,gt){fe(oe,k,rr,gt)})}return _e=_e?_e.then(F,F):F()}})}function pr(be,ue,fe){var _e=de;return function(Me,oe){if(_e===Oe)throw Error("Generator is already running");if(_e===We){if(Me==="throw")throw oe;return{value:x,done:!0}}for(fe.method=Me,fe.arg=oe;;){var k=fe.delegate;if(k){var F=Ir(k,fe);if(F){if(F===Je)continue;return F}}if(fe.method==="next")fe.sent=fe._sent=fe.arg;else if(fe.method==="throw"){if(_e===de)throw _e=We,fe.arg;fe.dispatchException(fe.arg)}else fe.method==="return"&&fe.abrupt("return",fe.arg);_e=Oe;var rr=Z(be,ue,fe);if(rr.type==="normal"){if(_e=fe.done?We:H,rr.arg===Je)continue;return{value:rr.arg,done:fe.done}}rr.type==="throw"&&(_e=We,fe.method="throw",fe.arg=rr.arg)}}}function Ir(be,ue){var fe=ue.method,_e=be.iterator[fe];if(_e===x)return ue.delegate=null,fe==="throw"&&be.iterator.return&&(ue.method="return",ue.arg=x,Ir(be,ue),ue.method==="throw")||fe!=="return"&&(ue.method="throw",ue.arg=new TypeError("The iterator does not provide a '"+fe+"' method")),Je;var Me=Z(_e,be.iterator,ue.arg);if(Me.type==="throw")return ue.method="throw",ue.arg=Me.arg,ue.delegate=null,Je;var oe=Me.arg;return oe?oe.done?(ue[be.resultName]=oe.value,ue.next=be.nextLoc,ue.method!=="return"&&(ue.method="next",ue.arg=x),ue.delegate=null,Je):oe:(ue.method="throw",ue.arg=new TypeError("iterator result is not an object"),ue.delegate=null,Je)}function rt(be){var ue={tryLoc:be[0]};1 in be&&(ue.catchLoc=be[1]),2 in be&&(ue.finallyLoc=be[2],ue.afterLoc=be[3]),this.tryEntries.push(ue)}function jt(be){var ue=be.completion||{};ue.type="normal",delete ue.arg,be.completion=ue}function vr(be){this.tryEntries=[{tryLoc:"root"}],be.forEach(rt,this),this.reset(!0)}function ut(be){if(be||be===""){var ue=be[j];if(ue)return ue.call(be);if(typeof be.next=="function")return be;if(!isNaN(be.length)){var fe=-1,_e=function Me(){for(;++fe<be.length;)if(T.call(be,fe))return Me.value=be[fe],Me.done=!1,Me;return Me.value=x,Me.done=!0,Me};return _e.next=_e}}throw new TypeError(D(be)+" is not iterable")}return je.prototype=he,E(fr,"constructor",{value:he,configurable:!0}),E(he,"constructor",{value:je,configurable:!0}),je.displayName=ee(he,X,"GeneratorFunction"),$.isGeneratorFunction=function(be){var ue=typeof be=="function"&&be.constructor;return!!ue&&(ue===je||(ue.displayName||ue.name)==="GeneratorFunction")},$.mark=function(be){return Object.setPrototypeOf?Object.setPrototypeOf(be,he):(be.__proto__=he,ee(be,X,"GeneratorFunction")),be.prototype=Object.create(fr),be},$.awrap=function(be){return{__await:be}},Be(Qe.prototype),ee(Qe.prototype,W,function(){return this}),$.AsyncIterator=Qe,$.async=function(be,ue,fe,_e,Me){Me===void 0&&(Me=Promise);var oe=new Qe(Y(be,ue,fe,_e),Me);return $.isGeneratorFunction(ue)?oe:oe.next().then(function(k){return k.done?k.value:oe.next()})},Be(fr),ee(fr,X,"Generator"),ee(fr,j,function(){return this}),ee(fr,"toString",function(){return"[object Generator]"}),$.keys=function(be){var ue=Object(be),fe=[];for(var _e in ue)fe.push(_e);return fe.reverse(),function Me(){for(;fe.length;){var oe=fe.pop();if(oe in ue)return Me.value=oe,Me.done=!1,Me}return Me.done=!0,Me}},$.values=ut,vr.prototype={constructor:vr,reset:function(ue){if(this.prev=0,this.next=0,this.sent=this._sent=x,this.done=!1,this.delegate=null,this.method="next",this.arg=x,this.tryEntries.forEach(jt),!ue)for(var fe in this)fe.charAt(0)==="t"&&T.call(this,fe)&&!isNaN(+fe.slice(1))&&(this[fe]=x)},stop:function(){this.done=!0;var ue=this.tryEntries[0].completion;if(ue.type==="throw")throw ue.arg;return this.rval},dispatchException:function(ue){if(this.done)throw ue;var fe=this;function _e(gt,Jr){return k.type="throw",k.arg=ue,fe.next=gt,Jr&&(fe.method="next",fe.arg=x),!!Jr}for(var Me=this.tryEntries.length-1;Me>=0;--Me){var oe=this.tryEntries[Me],k=oe.completion;if(oe.tryLoc==="root")return _e("end");if(oe.tryLoc<=this.prev){var F=T.call(oe,"catchLoc"),rr=T.call(oe,"finallyLoc");if(F&&rr){if(this.prev<oe.catchLoc)return _e(oe.catchLoc,!0);if(this.prev<oe.finallyLoc)return _e(oe.finallyLoc)}else if(F){if(this.prev<oe.catchLoc)return _e(oe.catchLoc,!0)}else{if(!rr)throw Error("try statement without catch or finally");if(this.prev<oe.finallyLoc)return _e(oe.finallyLoc)}}}},abrupt:function(ue,fe){for(var _e=this.tryEntries.length-1;_e>=0;--_e){var Me=this.tryEntries[_e];if(Me.tryLoc<=this.prev&&T.call(Me,"finallyLoc")&&this.prev<Me.finallyLoc){var oe=Me;break}}oe&&(ue==="break"||ue==="continue")&&oe.tryLoc<=fe&&fe<=oe.finallyLoc&&(oe=null);var k=oe?oe.completion:{};return k.type=ue,k.arg=fe,oe?(this.method="next",this.next=oe.finallyLoc,Je):this.complete(k)},complete:function(ue,fe){if(ue.type==="throw")throw ue.arg;return ue.type==="break"||ue.type==="continue"?this.next=ue.arg:ue.type==="return"?(this.rval=this.arg=ue.arg,this.method="return",this.next="end"):ue.type==="normal"&&fe&&(this.next=fe),Je},finish:function(ue){for(var fe=this.tryEntries.length-1;fe>=0;--fe){var _e=this.tryEntries[fe];if(_e.finallyLoc===ue)return this.complete(_e.completion,_e.afterLoc),jt(_e),Je}},catch:function(ue){for(var fe=this.tryEntries.length-1;fe>=0;--fe){var _e=this.tryEntries[fe];if(_e.tryLoc===ue){var Me=_e.completion;if(Me.type==="throw"){var oe=Me.arg;jt(_e)}return oe}}throw Error("illegal catch attempt")},delegateYield:function(ue,fe,_e){return this.delegate={iterator:ut(ue),resultName:fe,nextLoc:_e},this.method==="next"&&(this.arg=x),Je}},$}xe.exports=A,xe.exports.__esModule=!0,xe.exports.default=xe.exports},73738:xe=>{function ve(y){"@babel/helpers - typeof";return xe.exports=ve=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(D){return typeof D}:function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D},xe.exports.__esModule=!0,xe.exports.default=xe.exports,ve(y)}xe.exports=ve,xe.exports.__esModule=!0,xe.exports.default=xe.exports},54756:(xe,ve,y)=>{var D=y(4633)();xe.exports=D;try{regeneratorRuntime=D}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=D:Function("r","regeneratorRuntime = r")(D)}}}]);

//# sourceMappingURL=7774.065e667dca09d22302b8.js.map