"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[2212],{7521:(J,_,s)=>{s.d(_,{A:()=>p});var e=s(74848),T=s(32196),m=s(13544),y=s(14578),E=s(42418),v=s(55852),M=s(76442);const a=(0,T.css)({textAlign:"center"}),u=(0,T.css)({maxWidth:"700px",margin:"0 auto"}),p=({title:d,buttonIcon:x,buttonLink:W,buttonTitle:S,buttonDisabled:H,onClick:G,proTip:V,proTipLink:P,proTipLinkTitle:K,proTipTarget:L,infoBox:A,infoBoxTitle:D})=>{const j=()=>(0,e.jsxs)(e.Fragment,{children:[V?(0,e.jsxs)("span",{children:[(0,e.jsx)(y.I,{name:"rocket"}),(0,e.jsxs)(e.Fragment,{children:[" ProTip: ",V," "]}),P&&(0,e.jsx)("a",{href:P,target:L,className:"text-link",children:K})]},"proTipFooter"):"",A?(0,e.jsx)(E.F,{severity:"info",title:D??"",className:u,children:(0,e.jsx)("div",{dangerouslySetInnerHTML:A})}):""]}),r=j()?"":(0,T.css)({marginBottom:"20px"}),i=W?v.z9:v.$n,h=(0,e.jsx)(i,{size:"lg",onClick:G,href:W,icon:x,className:r,"data-testid":m.Tp.components.CallToActionCard.buttonV2(S),disabled:H,children:S});return(0,e.jsx)(M.c,{className:a,message:d,footer:j(),callToActionElement:h})}},31084:(J,_,s)=>{s.d(_,{Y:()=>a});var e=s(74848),T=s(96540),m=s(41053),y=s(10096),E=s(31678),v=s(37425),M=s(85927);const a=({teamId:u,roleOptions:n,disabled:p,roles:d,onApplyRoles:x,pendingRoles:W,apply:S=!1,maxWidth:H,width:G,isLoading:V})=>{const[{loading:P,value:K=d||[]},L]=(0,m.A)(async()=>{try{if(d)return d;if(S&&W?.length)return W;if(y.TP.hasPermission(E.AccessControlAction.ActionTeamsRolesList)&&u>0)return await(0,M.xN)(u)}catch(j){console.error("Error loading options",j)}return[]},[u,W,d]);(0,T.useEffect)(()=>{L()},[L]);const A=async j=>{S?x&&x(j):(await(0,M.G3)(j,u),await L())},D=y.TP.hasPermission(E.AccessControlAction.ActionTeamsRolesAdd)&&y.TP.hasPermission(E.AccessControlAction.ActionTeamsRolesRemove);return(0,e.jsx)(v.n,{apply:S,onRolesChange:A,roleOptions:n,appliedRoles:K,isLoading:P||V,disabled:p,basicRoleDisabled:!0,canUpdateRoles:D,maxWidth:H,width:G})}},54939:(J,_,s)=>{s.d(_,{o:()=>v});var e=s(96540),T=s(24705),m=s(10096),y=s(31678),E=s(85927);const v=M=>{const[a,u]=(0,e.useState)(M),{value:n=[]}=(0,T.A)(async()=>m.TP.licensedAccessControlEnabled()&&m.TP.hasPermission(y.AccessControlAction.ActionRolesList)?(0,E.RL)(a):Promise.resolve([]),[a]);return[{roleOptions:n},u]}},39745:(J,_,s)=>{s.d(_,{A:()=>r,u:()=>j});var e=s(74848),T=s(32196),m=s(96540),y=s(97594),E=s(41987),v=s(13544),M=s(14110),a=s(32264),u=s(84167),n=s(88575),p=s(90182),d=s(60029),x=s(20333),W=s(15648),S=s(29678),H=s(55852),G=s(3911),V=s(59429),P=s(8484),K=s(74513),L=s(65615),A=s(2769);function D(){const f=K.Yj.map(c=>({value:c.code,label:c.name})).sort((c,Z)=>c.value===K.wi?1:Z.value===K.wi?-1:c.label.localeCompare(Z.label));return[{value:"",label:(0,P.t)("common.locale.default","Default")},...f]}class j extends m.PureComponent{constructor(C){super(C),this.onSubmitForm=async c=>{if(c.preventDefault(),this.props.onConfirm?await this.props.onConfirm():!0){const{homeDashboardUID:B,theme:$,timezone:X,weekStart:z,language:b,queryHistory:Q,navbar:F}=this.state;await this.service.update({homeDashboardUID:B,theme:$,timezone:X,weekStart:z,language:b,queryHistory:Q,navbar:F}),window.location.reload()}},this.onThemeChanged=c=>{this.setState({theme:c.value}),c.value&&(0,A.K)(c.value,!0)},this.onTimeZoneChanged=c=>{typeof c=="string"&&this.setState({timezone:c})},this.onWeekStartChanged=c=>{this.setState({weekStart:c})},this.onHomeDashboardChanged=c=>{this.setState({homeDashboardUID:c})},this.onLanguageChanged=c=>{this.setState({language:c}),(0,M.rR)("grafana_preferences_language_changed",{toLanguage:c,preferenceType:this.props.preferenceType})},this.service=new L.W(C.resourceUri),this.state={theme:"",timezone:"",weekStart:"",language:"",queryHistory:{homeTab:""},navbar:{bookmarkUrls:[]}},this.themeOptions=(0,y.k)(a.$.featureToggles.extraThemes).map(c=>({value:c.id,label:h(c)})),this.themeOptions.unshift({value:"",label:(0,P.t)("shared-preferences.theme.default-label","Default")})}async componentDidMount(){const C=await this.service.load();this.setState({homeDashboardUID:C.homeDashboardUID,theme:C.theme,timezone:C.timezone,weekStart:C.weekStart,language:C.language,queryHistory:C.queryHistory,navbar:C.navbar})}render(){const{theme:C,timezone:c,weekStart:Z,homeDashboardUID:B,language:$}=this.state,{disabled:X}=this.props,z=i(),b=D(),Q=this.themeOptions.find(F=>F.value===C)??this.themeOptions[0];return(0,e.jsxs)("form",{onSubmit:this.onSubmitForm,className:z.form,children:[(0,e.jsxs)(u.n,{label:(0,e.jsx)(P.x6,{i18nKey:"shared-preferences.title",children:"Preferences"}),disabled:X,children:[(0,e.jsx)(n.D,{label:(0,P.t)("shared-preferences.fields.theme-label","Interface theme"),children:(0,e.jsx)(p.l6,{options:this.themeOptions,value:Q,onChange:this.onThemeChanged,inputId:"shared-preferences-theme-select"})}),(0,e.jsx)(n.D,{label:(0,e.jsx)(d.J,{htmlFor:"home-dashboard-select",children:(0,e.jsx)("span",{className:z.labelText,children:(0,e.jsx)(P.x6,{i18nKey:"shared-preferences.fields.home-dashboard-label",children:"Home Dashboard"})})}),"data-testid":"User preferences home dashboard drop down",children:(0,e.jsx)(V.b,{value:B,onChange:F=>this.onHomeDashboardChanged(F?.uid??""),defaultOptions:!0,isClearable:!0,placeholder:(0,P.t)("shared-preferences.fields.home-dashboard-placeholder","Default dashboard"),inputId:"home-dashboard-select"})}),(0,e.jsx)(n.D,{label:(0,P.t)("shared-dashboard.fields.timezone-label","Timezone"),"data-testid":v.Tp.components.TimeZonePicker.containerV2,children:(0,e.jsx)(x.U,{includeInternal:!0,value:c,onChange:this.onTimeZoneChanged,inputId:"shared-preferences-timezone-picker"})}),(0,e.jsx)(n.D,{label:(0,P.t)("shared-preferences.fields.week-start-label","Week start"),"data-testid":v.Tp.components.WeekStartPicker.containerV2,children:(0,e.jsx)(W.l,{value:Z||"",onChange:this.onWeekStartChanged,inputId:"shared-preferences-week-start-picker"})}),(0,e.jsx)(n.D,{label:(0,e.jsxs)(d.J,{htmlFor:"locale-select",children:[(0,e.jsx)("span",{className:z.labelText,children:(0,e.jsx)(P.x6,{i18nKey:"shared-preferences.fields.locale-label",children:"Language"})}),(0,e.jsx)(S.y,{featureState:E.Ay.beta})]}),"data-testid":"User preferences language drop down",children:(0,e.jsx)(p.l6,{value:b.find(F=>F.value===$),onChange:F=>this.onLanguageChanged(F.value??""),options:b,placeholder:(0,P.t)("shared-preferences.fields.locale-placeholder","Choose language"),inputId:"locale-select"})})]}),(0,e.jsx)(H.$n,{type:"submit",variant:"primary","data-testid":v.Tp.components.UserProfile.preferencesSaveButton,children:(0,e.jsx)(P.x6,{i18nKey:"common.save",children:"Save"})})]})}}const r=j,i=(0,G.N)(()=>({labelText:(0,T.css)({marginRight:"6px"}),form:(0,T.css)({width:"100%",maxWidth:"600px"})}));function h(f){switch(f.id){case"dark":return(0,P.t)("shared.preferences.theme.dark-label","Dark");case"light":return(0,P.t)("shared.preferences.theme.light-label","Light");case"system":return(0,P.t)("shared.preferences.theme.system-label","System preference");default:return f.name}}},76323:(J,_,s)=>{s.d(_,{J:()=>v});var e=s(74848),T=s(32196),m=s(96540),y=s(14110),E=s(40845);const v=({text:a="PRO",className:u,experimentId:n,eventVariant:p="",...d})=>{const x=(0,E.of)(M);return(0,m.useEffect)(()=>{n&&(0,y.Xp)(n,"test",p)},[n,p]),(0,e.jsx)("span",{className:(0,T.cx)(x.badge,u),...d,children:a})},M=a=>({badge:(0,T.css)`
      margin-left: ${a.spacing(1.25)};
      border-radius: ${a.shape.borderRadius(5)};
      background-color: ${a.colors.success.main};
      padding: ${a.spacing(.25,.75)};
      color: white; // use the same color for both themes
      font-weight: ${a.typography.fontWeightMedium};
      font-size: ${a.typography.pxToRem(10)};
    `})},35538:(J,_,s)=>{s.d(_,{pL:()=>T,z5:()=>y});var e=s(32264);const T=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;function m(){const E=e.$.licenseInfo?.trialExpiry;return!!(E&&E>0)}const y=()=>m()&&e.$.featureToggles.featureHighlights},92886:(J,_,s)=>{s.r(_),s.d(_,{default:()=>Ae});var e=s(74848),T=s(25508),m=s(96540),y=s(24180),E=s(16817),v=s(33378),M=s(69444),a=s(32196),u=s(14110),n=s(40845),p=s(14578),d=s(55852);const x=({featureName:t,className:o,children:l,text:g,featureId:O,eventVariant:U="",size:I="md",...R})=>{const N=(0,n.of)(W,I);return(0,m.useEffect)(()=>{(0,u.Xp)(`feature-highlights-${O}`,"test",U)},[U,O]),(0,e.jsxs)("div",{className:(0,a.cx)(N.box,o),...R,children:[(0,e.jsx)(p.I,{name:"rocket",className:N.icon}),(0,e.jsxs)("div",{className:N.inner,children:[(0,e.jsxs)("p",{className:N.text,children:["You\u2019ve discovered a Pro feature! ",g||`Get the Grafana Pro plan to access ${t}.`]}),(0,e.jsx)(d.z9,{variant:"secondary",size:I,className:N.button,href:"https://grafana.com/profile/org/subscription",target:"__blank",rel:"noopener noreferrer",children:"Upgrade"})]})]})},W=(t,o)=>{const l=t.shape.borderRadius(2),g=o==="md"?"body":"bodySmall";return{box:(0,a.css)`
      display: flex;
      align-items: center;
      position: relative;
      border-radius: ${l};
      background: ${t.colors.success.transparent};
      padding: ${t.spacing(2)};
      color: ${t.colors.success.text};
      font-size: ${t.typography[g].fontSize};
      text-align: left;
      line-height: 16px;
      margin: ${t.spacing(0,"auto",3,"auto")};
      max-width: ${t.breakpoints.values.xxl}px;
      width: 100%;
    `,inner:(0,a.css)`
      display: flex;
      align-items: center;
      width: 100%;
      justify-content: space-between;
    `,text:(0,a.css)`
      margin: 0;
    `,button:(0,a.css)`
      background-color: ${t.colors.success.main};
      font-weight: ${t.typography.fontWeightLight};
      color: white;

      &:hover {
        background-color: ${t.colors.success.main};
      }

      &:focus-visible {
        box-shadow: none;
        color: ${t.colors.text.primary};
        outline: 2px solid ${t.colors.primary.main};
      }
    `,icon:(0,a.css)`
      margin: ${t.spacing(.5,1,.5,.5)};
    `}},S=({listItems:t,image:o,featureUrl:l,featureName:g,description:O,caption:U,action:I})=>{const R=(0,n.of)(H);return(0,e.jsxs)("div",{className:R.container,children:[(0,e.jsxs)("div",{className:R.content,children:[(0,e.jsxs)("h3",{className:R.title,children:["Get started with ",g]}),O&&(0,e.jsx)("h6",{className:R.description,children:O}),(0,e.jsx)("ul",{className:R.list,children:t.map((N,w)=>(0,e.jsxs)("li",{children:[(0,e.jsx)(p.I,{name:"check",size:"xl",className:R.icon})," ",N]},w))}),I?.link&&(0,e.jsx)(d.z9,{variant:"primary",href:I.link,children:I.text}),I?.onClick&&(0,e.jsx)(d.$n,{variant:"primary",onClick:I.onClick,children:I.text}),l&&(0,e.jsx)(d.z9,{fill:"text",href:l,className:R.link,target:"_blank",rel:"noreferrer noopener",children:"Learn more"})]}),(0,e.jsxs)("div",{className:R.media,children:[(0,e.jsx)("img",{src:P(o),alt:"Feature screenshot"}),U&&(0,e.jsx)("p",{className:R.caption,children:U})]})]})},H=t=>({container:(0,a.css)`
      display: flex;
      justify-content: space-between;
    `,content:(0,a.css)`
      width: 45%;
      margin-right: ${t.spacing(4)};
    `,media:(0,a.css)`
      width: 55%;

      img {
        width: 100%;
      }
    `,title:(0,a.css)`
      color: ${t.colors.text.maxContrast};
    `,description:(0,a.css)`
      color: ${t.colors.text.primary};
      font-weight: ${t.typography.fontWeightLight};
    `,list:(0,a.css)`
      list-style: none;
      margin: ${t.spacing(4,0,2,0)};

      li {
        display: flex;
        align-items: flex-start;
        color: ${t.colors.text.primary};
        padding: ${t.spacing(1,0)};
      }
    `,icon:(0,a.css)`
      color: ${t.colors.success.main};
      margin-right: ${t.spacing(1)};
    `,link:(0,a.css)`
      margin-left: ${t.spacing(2)};
    `,caption:(0,a.css)`
      font-weight: ${t.typography.fontWeightLight};
      margin: ${t.spacing(1,0,0)};
    `}),G=({featureName:t,description:o,featureUrl:l,image:g})=>{const O=useStyles2(V);return jsxs("div",{className:O.container,children:[jsxs("h3",{className:O.title,children:["Get started with ",t]}),o&&jsx("h6",{className:O.description,children:o}),jsx(LinkButton,{fill:"text",href:l,target:"_blank",rel:"noreferrer noopener",children:"Learn more"}),jsx("div",{className:O.media,children:jsx("img",{src:P(g),alt:"Feature screenshot"})})]})},V=t=>({container:css`
      overflow: auto;
      height: 100%;
    `,title:css`
      color: ${t.colors.text.maxContrast};
    `,description:css`
      color: ${t.colors.text.primary};
      font-weight: ${t.typography.fontWeightLight};
    `,media:css`
      width: 100%;
      margin-top: ${t.spacing(2)};

      img {
        width: 100%;
      }
    `}),P=t=>t.startsWith("http")?t:"/public/img/enterprise/highlights/"+t;var K=s(2913),L=s(17422),A=s(16233),D=s(31678),j=s(71468),r=s(56034),i=s(39268),h=s(14186),f=s(10354),C=s(9025),c=s(25469),Z=s(7521),B=s(35538),$=s(33667);const X=t=>t.groups,z=(t,o)=>t.team.id===parseInt(o,10)?t.team:null;function b(t){return{groups:X(t.team)}}const Q={loadTeamGroups:$.aK,addTeamGroup:$.It,removeTeamGroup:$.nC},F=(0,j.connect)(b,Q),ee="Sync LDAP, OAuth or SAML groups with your Grafana teams.";class oe extends m.PureComponent{constructor(o){super(o),this.onToggleAdding=()=>{this.setState({isAdding:!this.state.isAdding})},this.onNewGroupIdChanged=l=>{this.setState({newGroupId:l.target.value})},this.onAddGroup=l=>{l.preventDefault(),this.props.addTeamGroup(this.state.newGroupId),this.setState({isAdding:!1,newGroupId:""})},this.onRemoveGroup=l=>{this.props.removeTeamGroup(l.groupId)},this.state={isAdding:!1,newGroupId:""}}componentDidMount(){this.fetchTeamGroups()}async fetchTeamGroups(){await this.props.loadTeamGroups()}isNewGroupValid(){return this.state.newGroupId.length>1}renderGroup(o){const{isReadOnly:l}=this.props;return(0,e.jsxs)("tr",{children:[(0,e.jsx)("td",{children:o.groupId}),(0,e.jsx)("td",{style:{width:"1%"},children:(0,e.jsx)(d.$n,{size:"sm",variant:"destructive",onClick:()=>this.onRemoveGroup(o),disabled:l,"aria-label":`Remove group ${o.groupId}`,children:(0,e.jsx)(p.I,{name:"times"})})})]},o.groupId)}render(){const{isAdding:o,newGroupId:l}=this.state,{groups:g,isReadOnly:O}=this.props,U=ie();return(0,e.jsxs)("div",{children:[(0,B.z5)()&&(0,e.jsx)(x,{featureId:"team-sync",eventVariant:"trial",featureName:"team sync",text:"Add a group to enable team sync for free during your trial of Grafana Pro."}),(0,e.jsxs)("div",{className:"page-action-bar",children:[(!(0,B.z5)()||g.length>0)&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("h3",{className:"page-sub-heading",children:"External group sync"}),(0,e.jsx)(r.m,{placement:"auto",content:ee,children:(0,e.jsx)(p.I,{className:(0,a.cx)(U.icon,"page-sub-heading-icon"),name:"question-circle"})})]}),(0,e.jsx)("div",{className:"page-action-bar__spacer"}),g.length>0&&(0,e.jsxs)(d.$n,{onClick:this.onToggleAdding,disabled:O,children:[(0,e.jsx)(p.I,{name:"plus"})," Add group"]})]}),(0,e.jsx)(C.a,{in:o,children:(0,e.jsxs)("div",{className:"cta-form",children:[(0,e.jsx)(c.J,{onClick:this.onToggleAdding}),(0,e.jsx)("form",{onSubmit:this.onAddGroup,children:(0,e.jsxs)(i.C,{children:[(0,e.jsx)(h.I,{label:"Add External Group",tooltip:"LDAP Group Example: cn=users,ou=groups,dc=grafana,dc=org.",children:(0,e.jsx)(f.p,{type:"text",id:"add-external-group",placeholder:"",value:l,onChange:this.onNewGroupIdChanged,disabled:O})}),(0,e.jsx)(d.$n,{type:"submit",disabled:O||!this.isNewGroupValid(),style:{marginLeft:4},children:"Add group"})]})})]})}),g.length===0&&!o&&((0,B.z5)()?(0,e.jsx)(se,{action:{onClick:this.onToggleAdding,text:"Add group"}}):(0,e.jsx)(Z.A,{onClick:this.onToggleAdding,buttonIcon:"users-alt",title:"There are no external groups to sync with",buttonTitle:"Add group",proTip:ee,proTipLinkTitle:"Learn more",proTipLink:"https://grafana.com/docs/grafana/latest/setup-grafana/configure-security/configure-team-sync/",proTipTarget:"_blank",buttonDisabled:O})),g.length>0&&(0,e.jsx)("div",{className:"admin-list-table",children:(0,e.jsxs)("table",{className:"filter-table filter-table--hover form-inline",children:[(0,e.jsx)("thead",{children:(0,e.jsxs)("tr",{children:[(0,e.jsx)("th",{children:"External Group ID"}),(0,e.jsx)("th",{style:{width:"1%"}})]})}),(0,e.jsx)("tbody",{children:g.map(I=>this.renderGroup(I))})]})})]})}}const se=({action:t})=>{const o=(0,n.$j)();return(0,e.jsx)(S,{action:t,listItems:["Stop managing user access in two places - assign users to groups in SAML, LDAP or Oauth, and manage access at a Team level in Grafana","Update users\u2019 permissions immediately when you add or remove them from an LDAP group, with no need for them to sign out and back in"],image:`team-sync-${o.isLight?"light":"dark"}.png`,featureName:"team sync",featureUrl:"https://grafana.com/docs/grafana/latest/enterprise/team-sync",description:"Team Sync makes it easier for you to manage users\u2019 access in Grafana, by immediately updating each user\u2019s Grafana teams and permissions based on their single sign-on group membership, instead of when users sign in."})},re=(0,j.connect)(b,Q)(oe),ie=()=>({icon:(0,a.css)({opacity:.7,"&:hover":{opacity:1}})});var ce=s(5108);const le=t=>{const o=A.TP.hasPermissionInMetadata(D.AccessControlAction.ActionTeamsPermissionsWrite,t.team);return(0,e.jsx)(ce.x,{title:"",addPermissionTitle:"Add member",buttonLabel:"Add member",emptyLabel:"There are no members in this team or you do not have the permissions to list the current members.",resource:"teams",resourceId:t.team.id,canSetPermissions:o})};var de=s(49785),me=s(67061),he=s(84167),q=s(88575),ge=s(31084),ue=s(54939),pe=s(39745);const fe={updateTeam:$.n7},Ee=(0,j.connect)(null,fe)(({team:t,updateTeam:o})=>{const l=A.TP.hasPermissionInMetadata(D.AccessControlAction.ActionTeamsWrite,t),g=A.TP.user.orgId,[{roleOptions:O}]=(0,ue.o)(g),{handleSubmit:U,register:I,formState:{errors:R}}=(0,de.mN)({defaultValues:t}),N=A.TP.hasPermission(D.AccessControlAction.ActionTeamsRolesAdd)&&A.TP.hasPermission(D.AccessControlAction.ActionTeamsRolesRemove),w=A.TP.hasPermissionInMetadata(D.AccessControlAction.ActionTeamsRolesList,t)&&A.TP.hasPermission(D.AccessControlAction.ActionRolesList),Y=async k=>{o(k.name,k.email||"")};return(0,e.jsxs)(me.B,{direction:"column",gap:3,children:[(0,e.jsx)("form",{onSubmit:U(Y),style:{maxWidth:"600px"},children:(0,e.jsxs)(he.n,{label:"Team details",children:[(0,e.jsx)(q.D,{label:"Name",disabled:!l,required:!0,invalid:!!R.name,error:"Name is required",children:(0,e.jsx)(f.p,{...I("name",{required:!0}),id:"name-input"})}),A.TP.licensedAccessControlEnabled()&&w&&(0,e.jsx)(q.D,{label:"Role",children:(0,e.jsx)(ge.Y,{teamId:t.id,roleOptions:O,disabled:!N,maxWidth:"100%"})}),(0,e.jsx)(q.D,{label:"Email",description:"This is optional and is primarily used to set the team profile avatar (via gravatar service).",disabled:!l,children:(0,e.jsx)(f.p,{...I("email"),placeholder:"team@email.com",type:"email",id:"email-input"})}),(0,e.jsx)(d.$n,{type:"submit",disabled:!l,children:"Update"})]})}),(0,e.jsx)(pe.u,{resourceUri:`teams/${t.id}`,disabled:!l,preferenceType:"team"})]})});var Pe=s(78319),Te=(t=>(t.Members="members",t.Settings="settings",t.GroupSync="groupsync",t))(Te||{});const te=["members","settings","groupsync"],ve=(0,T.Mz)([t=>t.team,(t,o)=>o],(t,o)=>z(t,o)),xe=(0,T.Mz)([t=>t.navIndex,(t,o)=>o,(t,o,l)=>l],(t,o,l)=>{const g=(0,Pe.X)(o);return(0,L.tc)(t,`team-${o}-${l}`,g).main}),ae=(0,m.memo)(()=>{const t=(0,m.useRef)((0,v.a)("teamsync")),o=(0,y.g)(),l=(0,m.useMemo)(()=>parseInt(o.id,10),[o]),g=(0,D.useSelector)(Y=>ve(Y,l));let O="members";(!g||!A.TP.hasPermissionInMetadata(D.AccessControlAction.ActionTeamsPermissionsRead,g))&&(O="settings");const U=o.page??O,I=(0,D.useSelector)(Y=>xe(Y,U,l)),R=(0,D.useDispatch)(),{loading:N}=(0,E.A)(async()=>R((0,$.eo)(l)),[l]),w=()=>{const Y=te.includes(U)?U:te[0],k=A.TP.hasPermissionInMetadata(D.AccessControlAction.ActionTeamsRead,g),ne=A.TP.hasPermissionInMetadata(D.AccessControlAction.ActionTeamsPermissionsRead,g),De=A.TP.hasPermissionInMetadata(D.AccessControlAction.ActionTeamsPermissionsWrite,g);switch(Y){case"members":if(ne)return(0,e.jsx)(le,{team:g});case"settings":return k&&(0,e.jsx)(Ee,{team:g});case"groupsync":if(t.current){if(ne)return(0,e.jsx)(re,{isReadOnly:!De})}else if(K.Ay.featureToggles.featureHighlights)return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(x,{featureName:"team sync",featureId:"team-sync"}),(0,e.jsx)(se,{})]})}return null};return(0,e.jsx)(M.Y,{navId:"teams",pageNav:I,children:(0,e.jsx)(M.Y.Contents,{isLoading:N,children:g&&Object.keys(g).length!==0&&w()})})});ae.displayName="TeamPages";const Ae=ae},33667:(J,_,s)=>{s.d(_,{Bu:()=>n,It:()=>A,To:()=>x,Vk:()=>H,aK:()=>L,eo:()=>d,n7:()=>K,nC:()=>D,nM:()=>W,yd:()=>S});var e=s(2543),T=s.n(e),m=s(17172),y=s(82467),E=s(10096),v=s(80714),M=s(31678),a=s(78319),u=s(34655);function n(r=!1){return async(i,h)=>{const{query:f,page:C,perPage:c,sort:Z}=h().teams;if(!E.TP.hasPermission(M.AccessControlAction.ActionTeamsRead)){i((0,u.Q9)({teams:[],totalCount:0,page:1,perPage:c,noTeams:!0}));return}const B=await(0,m.AI)().get("/api/teams/search",(0,v.F)({query:f,page:C,perpage:c,sort:Z}));let $=!1;if(r&&($=B.teams.length===0),E.TP.licensedAccessControlEnabled()&&E.TP.hasPermission(M.AccessControlAction.ActionTeamsRolesList)){i((0,u.dJ)());const X=B?.teams.map(b=>b.id),z=await(0,m.AI)().post("/api/access-control/teams/roles/search",{teamIds:X});B.teams.forEach(b=>{b.roles=z?z[b.id]||[]:[]}),i((0,u.jE)())}i((0,u.Q9)({noTeams:$,...B}))}}const p=(0,e.debounce)(r=>r(n()),500);function d(r){return async i=>{const h=await(0,m.AI)().get(`/api/teams/${r}`,(0,v.F)());i((0,u.$T)(h)),i((0,y.Vz)((0,a.R)(h)))}}function x(r){return async i=>{await(0,m.AI)().delete(`/api/teams/${r}`),await E.TP.fetchUserPermissions(),i(n())}}function W(r){return async i=>{i((0,u.L5)(r)),p(i)}}function S(r){return async i=>{i((0,u.EC)(r)),i(n())}}function H({sortBy:r}){const i=r.length?`${r[0].id}-${r[0].desc?"desc":"asc"}`:void 0;return async h=>{h((0,u.$u)(i)),h(n())}}function G(){return async(r,i)=>{const h=i().team.team,f=await getBackendSrv().get(`/api/teams/${h.id}/members`);r(teamMembersLoaded(f))}}function V(r){return async(i,h)=>{const f=h().team.team;await getBackendSrv().post(`/api/teams/${f.id}/members`,{userId:r}),i(G())}}function P(r){return async(i,h)=>{const f=h().team.team;await getBackendSrv().delete(`/api/teams/${f.id}/members/${r}`),i(G())}}function K(r,i){return async(h,f)=>{const C=f().team.team;await(0,m.AI)().put(`/api/teams/${C.id}`,{name:r,email:i}),h(d(C.id))}}function L(){return async(r,i)=>{const h=i().team.team,f=await(0,m.AI)().get(`/api/teams/${h.id}/groups`);r((0,u.tC)(f))}}function A(r){return async(i,h)=>{const f=h().team.team;await(0,m.AI)().post(`/api/teams/${f.id}/groups`,{groupId:r}),i(L())}}function D(r){return async(i,h)=>{const f=h().team.team;await(0,m.AI)().delete(`/api/teams/${f.id}/groups?groupId=${encodeURIComponent(r)}`),i(L())}}function j(r){return async i=>{await getBackendSrv().put(`/api/teams/${r.teamId}/members/${r.userId}`,{permission:r.permission}),i(G())}}},78319:(J,_,s)=>{s.d(_,{R:()=>a,X:()=>u});var e=s(33378),T=s(76323),m=s(2913),y=s(16233),E=s(35538),v=s(31678);const M={avatarUrl:"public/img/user_profile.png",id:1,name:"Loading",email:"loading",memberCount:0,permission:v.TeamPermissionLevel.Member,accessControl:{isEditor:!1},orgId:0,updated:""};function a(n){const p={img:n.avatarUrl,id:"team-"+n.id,subTitle:"Manage members and settings",url:"",text:n.name,children:[{active:!1,icon:"sliders-v-alt",id:`team-settings-${n.id}`,text:"Settings",url:`org/teams/edit/${n.id}/settings`}]};(n===M||y.TP.hasPermissionInMetadata(v.AccessControlAction.ActionTeamsPermissionsRead,n))&&p.children.unshift({active:!1,icon:"users-alt",id:`team-members-${n.id}`,text:"Members",url:`org/teams/edit/${n.id}/members`});const d={active:!1,icon:"sync",id:`team-groupsync-${n.id}`,text:"External group sync",url:`org/teams/edit/${n.id}/groupsync`},x=n===M;return(0,E.z5)()&&(d.tabSuffix=()=>(0,T.J)({experimentId:x?"":"feature-highlights-team-sync-badge",eventVariant:"trial"})),(0,e.a)("teamsync")?(x||y.TP.hasPermissionInMetadata(v.AccessControlAction.ActionTeamsPermissionsRead,n))&&p.children.push(d):m.Ay.featureToggles.featureHighlights&&p.children.push({...d,tabSuffix:()=>(0,T.J)({experimentId:x?"":"feature-highlights-team-sync-badge"})}),p}function u(n){const p=a(M);let d;for(const x of p.children)if(x.id.indexOf(n)>0){x.active=!0,d=x;break}return{main:p,node:d}}}}]);

//# sourceMappingURL=TeamPages.b7c7d1f1bc86e4fd47cf.js.map