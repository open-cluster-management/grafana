(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[3729],{76287:(k,R,e)=>{"use strict";e.d(R,{p:()=>s});var t=e(74848),n=e(96540),i=e(94841);function s(r){const{children:g,instanceSettings:a}=r,c=(0,n.useMemo)(()=>({instanceSettings:a,meta:a.meta}),[a]);return(0,t.jsx)(i.o.Provider,{value:c,children:g})}},94841:(k,R,e)=>{"use strict";e.d(R,{o:()=>n});var t=e(96540);const n=(0,t.createContext)(void 0)},13834:(k,R,e)=>{"use strict";e.d(R,{a:()=>i});var t=e(74848),n=e(94841);function i(s){const{children:r,...g}=s;return(0,t.jsx)(n.o.Provider,{value:g,children:r})}},95187:(k,R,e)=>{"use strict";e.d(R,{S:()=>t});function t(n){return"instanceSettings"in n&&"meta"in n}},92470:(k,R,e)=>{"use strict";e.d(R,{Q:()=>i});var t=e(96540),n=e(94841);function i(){const s=(0,t.useContext)(n.o);if(!s)throw new Error("usePluginContext must be used within a PluginContextProvider");return s}},33948:(k,R,e)=>{"use strict";e.d(R,{I:()=>s,f:()=>i});var t=e(11261),n=e(14236);class i{constructor(c,o){return this.fields=[],this.length=0,s(c,o)}}function s(a,c){const o={fields:[],length:a.length};if(!a?.length)return o;if(c){if(!g(a))throw new Error("source is not an array of objects");for(const f of c)o.fields.push(r(f,a.map(d=>d&&d[f])));return o}if(a.find(f=>f)===null)return o;if(g(a)){const f=a.find(d=>d);o.fields=Object.keys(f||{}).map(d=>r(d,a.map(p=>p&&p[d])))}else o.fields.push(r(t.Bc,a));return o}function r(a,c){const o={name:a,config:{},values:c,type:t.PU.other};return o.type=(0,n.dF)(o)??t.PU.other,o}function g(a){const c=a.find(o=>o);return a.length>0&&typeof c=="object"}},33526:(k,R,e)=>{"use strict";e.d(R,{x:()=>i});var t=e(36120),n=e(37471);class i extends n.k{constructor(r){super(void 0,g=>new t.$({...r,buffer:g}))}}},89667:(k,R,e)=>{"use strict";e.d(R,{EL:()=>r,Nw:()=>c,or:()=>a,t:()=>s});var t=e(11261),n=e(14236);const i={Inf:1/0,NegInf:-1/0,Undef:void 0,NaN:NaN};function s(o,h){let f;for(f in o){const d=i[f];for(const p of o[f])p<h.length&&(h[p]=d)}}function r(o,h){for(let f=0;f<h.length;f++)h[f]=o[Number(h[f])]}function g(o,h){for(const f of h)if(f!=null)return(0,n.by)(o,f);return t.PU.other}function a(o){const{schema:h,data:f}=o;if(!h||!h.fields)throw new Error("JSON needs a fields definition");const d=f?f.values.reduce((m,v)=>Math.max(m,v.length),0):0,p=h.fields.map((m,v)=>{let l=f?f.values[v]:[],y=l.length,u=m.type;y!==d&&(l.length=d,l.fill(void 0,y));let D=f?.entities?.[v];D&&s(D,l);let E=f?.enums?.[v];E&&(r(E,l),u=t.PU.string);const x=f?.nanos?.[v],P={...m,type:u??g(m.name,l),config:m.config??{},values:l,entities:D??{}};return x!=null&&(P.nanos=x),P});return{...h,fields:p,length:d}}function c(o){const h={values:[]},f=[];let d=!1;const p={refId:o.refId,meta:o.meta,name:o.name,fields:o.fields.map(m=>{const{values:v,nanos:l,state:y,display:u,...D}=m;return"entities"in D&&delete D.entities,h.values.push(v),l!=null?(f.push(l),d=!0):f.push(null),D})};return d&&(h.nanos=f),{schema:p,data:h}}},78368:(k,R,e)=>{"use strict";e.d(R,{R:()=>n});var t=e(18008);class n extends t.F{constructor(s){super(),this.data=s,this.index=0;const r={},g={};for(let a=0;a<s.fields.length;a++){const c=s.fields[a];if(!c.name)continue;g[c.name]=c;const o=()=>c.values.get(this.index);r.hasOwnProperty(c.name)||Object.defineProperty(r,c.name,{enumerable:!0,get:o}),r.hasOwnProperty(a.toString())||Object.defineProperty(r,a,{enumerable:!1,get:o})}this.obj=r,this.fields=g}get dataFrame(){return this.data}get length(){return this.data.length}getFieldDisplayProcessor(s){if(!this.dataFrame||!this.dataFrame.fields)return;const r=this.dataFrame.fields[s];if(!(!r||!r.display))return r.display}get(s){return this.index=s,this.obj}toArray(){return new Array(this.data.length).fill(0).map((s,r)=>({...this.get(r)}))}}},85404:(k,R,e)=>{"use strict";e.d(R,{L:()=>i});var t=e(11261),n=e(14236);class i{constructor(r){this.fields=[],this.fieldByName={},this.fieldByType={},this.fields=r.fields.map((g,a)=>({...g,index:a}));for(let g=0;g<r.fields.length;g++){const a=r.fields[g];if(a.type===t.PU.other){const c=(0,n.dF)(a);c&&(a.type=c)}this.fieldByType[a.type]||(this.fieldByType[a.type]=[]),this.fieldByType[a.type].push({...a,index:g}),this.fieldByName[a.name]?console.warn("Duplicate field names in DataFrame: ",a.name):this.fieldByName[a.name]={...a,index:g}}}getFields(r){if(!r)return[...this.fields];const g=this.fieldByType[r];return g?[...g]:[]}hasFieldOfType(r){const g=this.fieldByType[r];return g&&g.length>0}getFirstFieldOfType(r,g=!1){return this.fieldByType[r]?.find(o=>g||!o.config.custom?.hidden)}hasFieldNamed(r){return!!this.fieldByName[r]}hasFieldWithNameAndType(r,g){return!!this.fieldByName[r]&&this.fieldByType[g].filter(a=>a.name===r).length>0}getFieldByName(r){return this.fieldByName[r]}getFieldsByLabel(r,g){return Object.values(this.fieldByName).filter(a=>a.labels&&a.labels[r]===g)}}},37471:(k,R,e)=>{"use strict";e.d(R,{p:()=>g,k:()=>a});var t=e(2543),n=e(11261),i=e(14236);function s(c,o){return o.type||(o.name==="time"||o.name==="Time"?o.type=n.PU.time:o.type=(0,i.HW)(c)),o.type===n.PU.number?h=>parseFloat(h):o.type===n.PU.boolean?h=>!(h[0]==="F"||h[0]==="f"||h[0]==="0"):h=>h}var r=e(18008);const g=void 0;class a extends r.F{constructor(o,h){if(super(),this.fields=[],this.first=[],this.parsers=void 0,this.creator=h||(f=>f??[]),o){const{name:f,refId:d,meta:p,fields:m}=o;if(f&&(this.name=f),d&&(this.refId=d),p&&(this.meta=p),m)for(const v of m)this.addField(v)}Object.defineProperty(this,"length",{enumerable:!0,get:()=>this.first.length})}get length(){return this.first.length}addFieldFor(o,h){return this.addField({name:h||"",type:(0,i.HW)(o)})}addField(o,h){let f;o.values&&(f=o.values);let d=o.type;!d&&(o.name==="time"||o.name==="Time")?d=n.PU.time:(!d&&f&&f.length&&(d=(0,i.HW)(f[0])),d||(d=n.PU.other));let p=o.name;p||(p=`Field ${this.fields.length+1}`);const m={...o,name:p,type:d,config:o.config||{},values:this.creator(f)};if(d===n.PU.other&&(d=(0,i.dF)(m),d&&(m.type=d)),this.fields.push(m),this.first=this.fields[0].values,h)for(;m.values.length<h;)m.values.push(g);else this.validate();return m}validate(){const o=this.fields.reduce((h,f)=>Math.max(h,f.values.length),0);for(const h of this.fields)for(;h.values.length!==o;)h.values.push(g)}setParser(o,h){return this.parsers||(this.parsers=new Map),this.parsers.set(o,h),h}parseValue(o,h){let f=this.parsers?.get(o);return f||(f=this.setParser(o,s(h,o))),f(h)}appendRow(o){for(let h=this.fields.length;h<o.length;h++)this.addField({name:`Field ${h+1}`,type:(0,i.HW)(o[h])});if(this.length<1)for(let h=0;h<this.fields.length;h++){const f=this.fields[h];(!f.type||f.type===n.PU.other)&&(f.type=(0,i.HW)(o[h]))}for(let h=0;h<this.fields.length;h++){const f=this.fields[h];let d=o[h];f.type!==n.PU.string&&(0,t.isString)(d)&&(d=this.parseValue(f,d)),f.values.push(d)}}push(...o){for(const h of o)this.add(h);return this.length}reverse(){for(const o of this.fields)o.values.reverse();return this}add(o){const h=o;for(const f of this.fields){let d=h[f.name];f.type!==n.PU.string&&(0,t.isString)(d)&&(d=this.parseValue(f,d)),d===void 0&&(d=g),f.values.push(d)}}set(o,h){if(o>this.length)throw new Error("Unable to set value beyond current length");const f=h||{};for(const d of this.fields)d.values[o]=f[d.name]}get(o){const h={};for(const f of this.fields)h[f.name]=f.values[o];return h}toJSON(){return(0,i.Kl)(this)}}},9631:(k,R,e)=>{"use strict";e.d(R,{Kh:()=>a,Ls:()=>p,k9:()=>h,m8:()=>f});var t=e(73060),n=e(11261),i=e(8249),s=e(43659),r=e(89667),g=e(14236),a=(E=>(E.Append="append",E.Replace="replace",E))(a||{});const c="__name__";var o=(E=>(E[E.wide=0]="wide",E[E.labels=1]="labels",E))(o||{});class h{constructor(x){this.options=x,this.meta={},this.fields=[],this.length=0,this.schemaFields=[],this.timeFieldIndex=-1,this.pushMode=0,this.labels=new Set,this.packetInfo={schemaChanged:!0,number:0,action:"replace",length:0},this.serialize=(P,b,M)=>{const O=b?Object.assign({},{...this.options,...b}):this.options,I=(0,g.By)(this,P),T=u(I.fields.map(S=>S.values??[]),typeof M?.maxLength=="number"?Math.min(M.maxLength,O.maxLength):O.maxLength,this.timeFieldIndex,O.maxDelta);I.fields=I.fields.map(S=>({...S,values:S.values?.slice(T)}));const C=I.fields[0]?.values?.length??0;return{...I,labels:this.labels,schemaFields:this.schemaFields,name:this.name,refId:this.refId,meta:this.meta,length:C,timeFieldIndex:this.timeFieldIndex,pushMode:this.pushMode,packetInfo:this.packetInfo,options:O}},this.initFromSerialized=P=>{this.name=P.name,this.refId=P.refId,this.meta=P.meta,this.length=P.length,this.labels=P.labels,this.schemaFields=P.schemaFields,this.timeFieldIndex=P.timeFieldIndex,this.pushMode=P.pushMode,this.packetInfo.length=P.packetInfo.length,this.packetInfo.number=P.packetInfo.number,this.packetInfo.action="replace",this.packetInfo.schemaChanged=!0,this.fields=P.fields.map(b=>({...b,type:b.type??n.PU.other,config:b.config??{},values:b.values??[]})),y(this.fields.map(b=>b.values),this.options.maxLength,this.timeFieldIndex,this.options.maxDelta)},this.needsResizing=({maxLength:P,maxDelta:b})=>{const M=P&&this.options.maxLength<P,O=b&&this.options.maxDelta<b,I=b&&this.options.maxDelta===1/0;return!!(M||O||I)},this.resize=({maxLength:P,maxDelta:b})=>{b&&(this.options.maxDelta===1/0?this.options.maxDelta=b:this.options.maxDelta=Math.max(b,this.options.maxDelta)),this.options.maxLength=Math.max(this.options.maxLength,P??0)},this.pushNewValues=P=>{if(!P?.length)return;this.packetInfo.action=this.options.action,this.packetInfo.number++,this.packetInfo.length=P[0].length,this.packetInfo.schemaChanged=!1,this.options.action==="append"?l(this.fields.map(M=>M.values),P,this.options.maxLength,this.timeFieldIndex,this.options.maxDelta):(P.forEach((M,O)=>{this.fields[O]&&(this.fields[O].values=M)}),y(this.fields.map(M=>M.values),this.options.maxLength,this.timeFieldIndex,this.options.maxDelta));const b=this.fields?.[0]?.values.length;b!==void 0&&(this.length=b)},this.resetStateCalculations=()=>{this.fields.forEach(P=>{P.state={...P.state??{},calcs:void 0,range:void 0}})},this.getMatchingFieldIndexes=P=>this.fields.map((b,M)=>P(b)?M:void 0).filter(b=>b!==void 0),this.getValuesFromLastPacket=()=>this.fields.map(P=>{const b=P.values;return b.slice(Math.max(b.length-this.packetInfo.length))}),this.hasAtLeastOnePacket=()=>!!this.packetInfo.length,this.getOptions=()=>this.options,Object.defineProperty(this,"length",{enumerable:!0}),Object.defineProperty(this,"fields",{enumerable:!0})}static{this.deserialize=x=>{const P=new h(x.options);return P.initFromSerialized(x),P}}static{this.empty=x=>new h(f(x))}static{this.fromDataFrameJSON=(x,P)=>{const b=new h(f(P));return b.push(x),b}}get alwaysReplace(){return this.options.action==="replace"}push(x){const{schema:P,data:b}=x;if(this.packetInfo.number++,this.packetInfo.length=0,this.packetInfo.schemaChanged=!1,P){this.pushMode=0,this.timeFieldIndex=P.fields.findIndex(T=>T.type===n.PU.time);const M=P.fields[0];this.timeFieldIndex===1&&M.type===n.PU.string&&(M.name==="labels"||M.name==="Labels")&&(this.pushMode=1,this.timeFieldIndex=0);const O=this.pushMode===1?P.fields.slice(1):P.fields;this.refId=P.refId,P.meta&&(this.meta={...P.meta});const{displayNameFormat:I}=this.options;if(D(this.schemaFields,O)){const T=O.length;this.fields.forEach((C,S)=>{const A=O[S%T];C.config=A.config??{},C.labels=A.labels}),I&&this.fields.forEach(C=>{const S={[c]:C.name,...C.labels};C.config.displayNameFromDS=(0,s.j)(I,S)})}else{this.packetInfo.schemaChanged=!0;const T=this.pushMode===0;this.fields=O.map(C=>{const S=C.config??{};if(I){const A={[c]:C.name,...C.labels};S.displayNameFromDS=(0,s.j)(I,A)}return{config:S,name:C.name,labels:C.labels,type:C.type??n.PU.other,values:T?this.fields.find(A=>A.name===C.name&&C.type===A.type)?.values??Array(this.length).fill(void 0):[]}})}this.schemaFields=O}if(b&&b.values.length&&b.values[0].length){let{values:M,entities:O}=b;if(O&&O.forEach((T,C)=>{T&&(0,r.t)(T,M[C])}),this.pushMode===1){const T=d(M);for(const A of T.keys())this.labels.has(A)||(this.packetInfo.schemaChanged=!0,this.addLabel(A));let C=Array(this.schemaFields.length).fill([]),S=[];this.labels.forEach(A=>{S.push(T.get(A)??C)}),M=(0,t.fj)(S)}if(M.length!==this.fields.length){if(this.fields.length)throw new Error(`push message mismatch.  Expected: ${this.fields.length}, received: ${M.length} (labels=${this.pushMode===1})`);this.fields=M.map((T,C)=>{let S=`Field ${C}`,A=(0,g.HW)(T[0]);return C===0&&A===n.PU.number&&T[0]>1600016688632&&(A=n.PU.time,S="Time"),{name:S,type:A,config:{},values:[]}})}let I=M;this.packetInfo.length=M[0].length,this.alwaysReplace||!this.length?this.packetInfo.action="replace":(this.packetInfo.action="append",I=this.fields.map(T=>T.values),l(I,M,this.options.maxLength,this.timeFieldIndex,this.options.maxDelta)),I.forEach((T,C)=>{const S=this.fields[C],{state:A}=S;S.values=T,A&&(A.calcs=void 0)}),this.length=I[0].length}return{...this.packetInfo}}addLabel(x){const{displayNameFormat:P}=this.options,b=this.labels.size,M=m(x);if(b===0)this.fields.forEach((O,I)=>{if(I>0&&(O.labels=M,P)){const T={[c]:O.name,...M};O.config.displayNameFromDS=(0,s.j)(P,T)}});else for(let O=1;O<this.schemaFields.length;O++){let I=this.schemaFields[O];const T=I.config??{};if(P){const C={[c]:I.name,...M};T.displayNameFromDS=(0,s.j)(P,C)}this.fields.push({...I,config:T,labels:M,values:Array(this.length).fill(void 0)})}this.labels.add(x)}}function f(E){return{maxLength:E?.maxLength??1e3,maxDelta:E?.maxDelta??1/0,action:E?.action??"append",displayNameFormat:E?.displayNameFormat}}function d(E){let x=new Set(E[0]),P=new Map;x.forEach(b=>{let M=Array(E.length-1).fill(null).map(()=>[]);P.set(b,M)});for(let b=0;b<E[0].length;b++){let M=P.get(E[0][b]);for(let O=1;O<E.length;O++)M[O-1].push(E[O][b])}return P}function p(E,x,P,b){let M;P=P||0,b=b||x.length-1;let O=b<=2147483647;for(;b-P>1;)M=O?P+b>>1:Math.floor((P+b)/2),x[M]<E?P=M:b=M;return E-x[P]<=x[b]-E?P:b}function m(E){if(!E.length)return{};if(E.charAt(0)==="{")return(0,i.Xy)(E);const x={};return E.split(",").forEach(P=>{const[b,M]=P.trim().split("=");x[b]=M}),x}function v(E){const x=E.packetInfo;return x?.action?x:void 0}function l(E,x,P=1/0,b=0,M=1/0){for(let O=0;O<E.length;O++)for(let I=0;I<x[O].length;I++)E[O].push(x[O][I]);return y(E,P,b,M)}function y(E,x=1/0,P=0,b=1/0){const M=u(E,x,P,b);if(M)for(let O=0;O<E.length;O++)E[O].splice(0,M);return M}function u(E,x=1/0,P=0,b=1/0){if(!E[0]?.length)return 0;const M=E[0].length;let O=0;if(M>x&&(O=M-x),b!==1/0&&P>=0){const I=E[P],T=I[O],C=I[M-1];C-T>b&&(O=p(C-b,I,O))}return O}function D(E,x){if(E?.length!==x.length)return!1;for(let P=0;P<E.length;P++){const b=E[P],M=x[P];if(b.name!==M.name||b.type!==M.type)return!1}return!0}},61443:(k,R,e)=>{"use strict";e.d(R,{Km:()=>r,P4:()=>i,WK:()=>s,g6:()=>n,r4:()=>t,xB:()=>g});const t=(a,c)=>({name:a,columns:c}),n=a=>a.columns,i=(a,c)=>a.columns[c],s=(a,c,o)=>a.columns[c].values[o],r=(a,c,o)=>a.columns.map(h=>h.values[o]),g=(a,c)=>a[c]},21423:(k,R,e)=>{"use strict";e.d(R,{J3:()=>s,ab:()=>g,bW:()=>i});var t=e(2543),n=e.n(t);function i(a,c,o){if(a===c)return!0;if(a?.fields?.length!==c?.fields?.length||a.name!==c.name)return!1;for(let h=0;h<a.fields.length;h++){const f=a.fields[h],d=c.fields[h];if(f.type!==d.type||f.name!==d.name)return!1;if(o)continue;if(f.labels&&d.labels&&!g(f.labels,d.labels))return!1;const p=f.config,m=d.config;if(Object.keys(p).length!==Object.keys(m).length)return!1;let v;for(v in p){if(!(v in m))return!1;if(v!=="interval"&&!(0,t.isEqual)(p[v],m[v]))return!1}}return!0}function s(a,c,o){if(a===c)return!0;if(a?.length!==c?.length)return!1;for(let h=0;h<a.length;h++)if(!o(a[h],c[h]))return!1;return!0}const r=(a,c)=>a===c;function g(a,c,o=r){if(a===c)return!0;if(Object.keys(a).length!==Object.keys(c).length)return!1;let h;for(h in a)if(!o(a[h],c[h]))return!1;return!0}},14236:(k,R,e)=>{"use strict";e.d(R,{Bt:()=>N,By:()=>S,EI:()=>w,ES:()=>O,HW:()=>y,KR:()=>A,Kl:()=>C,LI:()=>P,N$:()=>F,Vc:()=>b,XQ:()=>D,Yn:()=>T,by:()=>v,ci:()=>x,dF:()=>u,oE:()=>l,pH:()=>E,q7:()=>I,w3:()=>M});var t=e(2543),n=e.n(t),i=e(47232),s=e(48241),r=e(28240),g=e(39070),a=e(11261),c=e(33948),o=e(89667);function h(B){const U=B.columns.map(K=>{const{text:V,type:H,...Y}=K,X=[];return{name:V?.length?V:K,config:Y||{},values:X,type:H&&Object.values(a.PU).includes(H)?H:a.PU.other}});if(!(0,t.isArray)(B.rows))throw new Error(`Expected table rows to be array, got ${typeof B.rows}.`);for(const K of B.rows)for(let V=0;V<U.length;V++)U[V].values.push(K[V]);for(const K of U)if(K.type===a.PU.other){const V=u(K);V&&(K.type=V)}return{fields:U,refId:B.refId,meta:B.meta,name:B.name,length:B.rows.length}}function f(B){const U=[],K=[],V=B.datapoints||B.points;for(const Y of V)K.push(Y[0]),U.push(Y[1]);const H=[{name:a.LE,type:a.PU.time,config:{},values:U},{name:a.Bc,type:a.PU.number,config:{unit:B.unit},values:K,labels:B.tags}];return B.title&&(H[1].config.displayNameFromDS=B.title),{name:B.target||B.name,refId:B.refId,meta:B.meta,fields:H,length:K.length}}function d(B){const U=[],K=[];for(let V=0;V<B.data.length;V++){const H=B.data[V];U.push(H[1]),K.push(H[0])}return{name:B.label,fields:[{name:B.label||a.Bc,type:a.PU.number,config:{},values:U},{name:a.LE,type:a.PU.time,config:{unit:"dateTimeAsIso"},values:K}],length:U.length}}function p(B){const U=[{name:B.target,type:a.PU.other,labels:B.tags,config:{unit:B.unit,filterable:B.filterable},values:[]}];for(const K of B.datapoints)U[0].values.push(K);return{name:B.target,refId:B.target,meta:{json:!0},fields:U,length:B.datapoints.length}}const m=/^\s*(-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?|NAN)\s*$/i;function v(B,U){return B&&(B=B.toLowerCase(),B==="date"||B==="time")?a.PU.time:y(U)}function l(B){return B instanceof Date||(0,i.Ar)(B)?a.PU.time:(0,t.isNumber)(B)?a.PU.number:(0,t.isString)(B)?a.PU.string:(0,t.isBoolean)(B)?a.PU.boolean:a.PU.other}function y(B){return B instanceof Date||(0,i.Ar)(B)?a.PU.time:(0,t.isNumber)(B)?a.PU.number:(0,t.isString)(B)?m.test(B)?a.PU.number:B==="true"||B==="TRUE"||B==="True"||B==="false"||B==="FALSE"||B==="False"?a.PU.boolean:a.PU.string:(0,t.isBoolean)(B)?a.PU.boolean:a.PU.other}function u(B){if(B.name){const U=B.name.toLowerCase();if(U==="date"||U==="time")return a.PU.time}for(let U=0;U<B.values.length;U++){const K=B.values[U];if(K!=null)return y(K)}}const D=(B,U=!1)=>{for(const K of B.fields)if(!K.type||K.type===a.PU.other||U)return{...B,fields:B.fields.map(V=>V.type&&V.type!==a.PU.other&&!U?V:{...V,type:u(V)||a.PU.other})};return B},E=B=>!!(B&&B.hasOwnProperty("columns")),x=B=>!!(B&&B.hasOwnProperty("fields")),P=B=>!!(x(B)&&B.hasOwnProperty("value"));function b(B){if("fields"in B)return"length"in B&&B.fields[0]?.values?.get?B:w(B);if(B.hasOwnProperty("type")&&B.type==="docs")return p(B);if(B.hasOwnProperty("datapoints")||B.hasOwnProperty("points"))return f(B);if(B.hasOwnProperty("data"))return B.hasOwnProperty("schema")?(0,o.or)(B):d(B);if(B.hasOwnProperty("columns"))return h(B);if(Array.isArray(B))return(0,c.I)(B);throw console.warn("Can not convert",B),new Error("Unsupported data format")}const M=B=>{const{fields:U}=B,K=B.length,V=[];if(U.length===2){const{timeField:H,timeIndex:Y}=A(B);if(H){const J=U[Y===0?1:0],q=U[Y];for(let ae=0;ae<K;ae++)V.push([J.values[ae],q.values[ae]]);return{alias:B.name,target:(0,r.Ct)(J,B),datapoints:V,unit:U[0].config?U[0].config.unit:void 0,refId:B.refId,meta:B.meta}}}for(let H=0;H<K;H++){const Y=[];for(let X=0;X<U.length;X++)Y.push(U[X].values[H]);V.push(Y)}return B.meta&&B.meta.json?{alias:U[0].name||B.name,target:U[0].name||B.name,datapoints:U[0].values,filterable:U[0].config?U[0].config.filterable:void 0,type:"docs"}:{columns:U.map(H=>{const{name:Y,config:X}=H;if(X){const{...J}=X;return J.text=Y,J}return{text:Y}}),type:"table",refId:B.refId,meta:B.meta,rows:V}};function O(B,U,K=!1){const V=B.fields[U];if(!V)return B;const H=[];for(let X=0;X<B.length;X++)H.push(X);const Y=(0,s.i)(V,K);return H.sort(Y),{...B,fields:B.fields.map(X=>{const J={...X,values:X.values.map((ae,j)=>X.values[H[j]])},{nanos:q}=X;return q!==void 0&&(J.nanos=q.map((ae,j)=>q[H[j]])),J})}}function I(B){return{...B,fields:B.fields.map(U=>{const K=[...U.values];K.reverse();const V={...U,values:K},{nanos:H}=U;if(H!==void 0){const Y=[...H];Y.reverse(),V.nanos=Y}return V})}}function T(B,U){const K=[];for(const V of B.fields)K.push(V.values[U]);return K}function C(B){return S(B)}function S(B,U){return{fields:(U?B.fields.filter(U):B.fields).map(H=>{let Y=H.values;return{name:H.name,type:H.type,config:H.config,values:Y,labels:H.labels}}),refId:B.refId,meta:B.meta,name:B.name}}const A=B=>{for(let U=0;U<B.fields.length;U++)if(B.fields[U].type===a.PU.time)return{timeField:B.fields[U],timeIndex:U};return{}};function L(B){const U=D(b(B));if(U.fields&&U.fields.length)for(const K of U.fields)K.state=null;return U}function N(B){return!B||!(0,t.isArray)(B)?[]:B.map(U=>L(U))}function F(B,U){const{series:K,annotations:V}=B;if(B.state===g.Gu.Loading&&K.length===0)return U||(U=B),{...U,state:g.Gu.Loading,request:B.request};const H=performance.now(),Y=K.map(q=>L(q)),X=N(V),J=performance.now();return{...B,series:Y,annotations:X,timings:{dataProcessingTime:J-H}}}function w(B){let U=0;const K=B.fields.map((V,H)=>{const{state:Y,...X}=V;return X.name||(X.name=`Field ${H+1}`),X.config||(X.config={}),X.values?X.values.length>U&&(U=X.values.length):X.values=new Array(U),X.type||(X.type=u(X)??a.PU.other),X});return{...B,fields:K,length:U}}},19845:(k,R,e)=>{"use strict";e.d(R,{S1:()=>c,aH:()=>s,hF:()=>g,jq:()=>r,t9:()=>o,tP:()=>a,uY:()=>h});var t=e(11261),n=e(14236);const i=100;function s(f){if(f.fields.length<2)return!1;const d=f.fields.find(m=>m.type===t.PU.number);let p=!1;for(const m of f.fields)if(g(m)){p=!0;break}return p&&d!==void 0}function r(f){return!f.find(d=>!s(d))}function g(f){if(f.type!==t.PU.time)return!1;let d=null,p=f.values.length>i?i:f.values.length;for(let m=0;m<p;m++){const v=f.values[m];if(d===null||v!==null&&v>d)d=v;else return!1}return!0}function a(f){for(let d=0;d<f.length;d++){const p=(0,n.KR)(f[d]);if(p.timeField!==void 0&&p.timeIndex!==void 0)return!0}return!1}function c(f){return f.fields.some(d=>d.type===t.PU.time)}function o(f,d){if(f.meta?.uniqueRowIdFields!==void 0)return f.meta.uniqueRowIdFields.map(p=>f.fields[p].values[d]).join("-")}function h(f,d){if(d instanceof Array)for(let p=0;p<d.length;p++)f.fields[p].values.push(d[p]);else for(const p of f.fields)p.values.push(d[p.name]);try{f.length++}catch{}}},1933:(k,R,e)=>{"use strict";e.d(R,{G:()=>r,O:()=>g});var t=e(2543),n=e.n(t),i=e(43127);let s=()=>i.lE;const r=a=>{s=a??s},g=a=>a?.timeZone&&!(0,t.isEmpty)(a.timeZone)?a.timeZone:s()??i.lE},85858:(k,R,e)=>{"use strict";e.r(R),e.d(R,{isMathString:()=>r,isValid:()=>a,parse:()=>g,parseDateMath:()=>c,roundToFiscal:()=>o});var t=e(2543),n=e.n(t),i=e(47232);const s=["y","M","w","d","h","m","s","Q"];function r(h){return h?!!(typeof h=="string"&&(h.substring(0,3)==="now"||h.includes("||"))):!1}function g(h,f,d,p){if(h){if(typeof h!="string")return(0,i.Ar)(h)?h:(0,t.isDate)(h)?(0,i.KQ)(h):void 0;{let m,v="",l,y;return h.substring(0,3)==="now"?(m=(0,i.oZ)(d),v=h.substring(3)):(l=h.indexOf("||"),l===-1?(y=h,v=""):(y=h.substring(0,l),v=h.substring(l+2)),m=(0,i.KQ)(y,i.mt)),v.length?c(v,m,f,p):m}}}function a(h){const f=g(h);return f&&(0,i.Ar)(f)?f.isValid():!1}function c(h,f,d,p=0){const m=h.replace(/\s/g,""),v=(0,i.KQ)(f);let l=0;const y=m.length;for(;l<y;){const u=m.charAt(l++);let D,E,x,P=!1;if(u==="/")D=0;else if(u==="+")D=1;else if(u==="-")D=2;else return;if(isNaN(parseInt(m.charAt(l),10)))E=1;else if(m.length===2)E=parseInt(m.charAt(l),10);else{const M=l;for(;!isNaN(parseInt(m.charAt(l),10));)if(l++,l>10)return;E=parseInt(m.substring(M,l),10)}if(D===0&&E!==1)return;x=m.charAt(l++),x==="f"&&(x=m.charAt(l++),P=!0);const b=x;if((0,t.includes)(s,b))D===0?P?o(p,v,b,d):d?v.endOf(b):v.startOf(b):D===1?v.add(E,b):D===2&&v.subtract(E,b);else return}return v}function o(h,f,d,p){switch(d){case"y":return p?o(h,f,d,!1).add(11,"M").endOf("M"):f.subtract((f.month()-h+12)%12,"M").startOf("M"),f;case"Q":return p?o(h,f,d,!1).add(2,"M").endOf("M"):f.subtract((f.month()-h+12)%3,"M").startOf("M"),f;default:return}}},70416:(k,R,e)=>{"use strict";e.d(R,{E9:()=>g,Ri:()=>a,V3:()=>d,WT:()=>c,dU:()=>r,di:()=>h,pp:()=>f,vd:()=>o});var t=e(89369),n=e(68284),i=e(25579);const s={years:["y","Y","years"],months:["M","months"],weeks:["w","W","weeks"],days:["d","D","days"],hours:["h","H","hours"],minutes:["m","minutes"],seconds:["s","S","seconds"]};function r(m,v=!0){if((0,t.d)(m.start,m.end))return"";const l=(0,n.F)(m);return Object.entries(l).reduce((y,[u,D])=>D&&D!==0&&!(u==="seconds"&&!v&&y)?y+`${y!==""?" ":""}${D}${s[u][0]}`:y,"")}function g(m){return m.split(" ").reduce((v,l)=>{const y=l.match(/(\d+)(.+)/),u=y?.[1],D=y?.[2];if(!(u&&D))return v;const E=Object.entries(s).find(([P,b])=>b?.includes(y[2])),x=parseInt(u,10);return E?{...v,[E[0]]:x}:v},{})}function a(m,v){return(0,i.W)(m,v)}function c(m){const v=new Date;return a(v,m).getTime()-v.getTime()}function o(m){return!isNaN(Date.parse(m))}function h(m){for(const v of m.trim().split(" ")){const l=v.match(/(\d+)(.+)/);if(l===null||l.length!==3||!Object.entries(s).find(([u,D])=>D?.includes(l[2]))?.[0])return!1}return!0}function f(m){return p(m,["h","m","s","ms","us","\xB5s","ns"])}function d(m){return p(m,["y","M","w","d","h","m","s","ms","us","\xB5s","ns"])}function p(m,v){for(const l of m.trim().split(" ")){const y=l.match(/([0-9]*[.]?[0-9]+)(.+)/);if(y===null||y.length!==3||!v.includes(y[2]))return!1}return!0}},42994:(k,R,e)=>{"use strict";e.d(R,{JE:()=>i,Od:()=>s,WC:()=>r});const t="YYYY-MM-DD HH:mm:ss",n="YYYY-MM-DD HH:mm:ss.SSS";class i{constructor(){this.fullDate=t,this.fullDateMS=n,this.interval={millisecond:"HH:mm:ss.SSS",second:"HH:mm:ss",minute:"HH:mm",hour:"MM/DD HH:mm",day:"MM/DD",month:"YYYY-MM",year:"YYYY"}}update(c){this.fullDate=c.fullDate,this.interval=c.interval,c.useBrowserLocale&&this.useBrowserLocale()}useBrowserLocale(){this.fullDate=s({year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}),this.fullDateMS=this.fullDate.replace("ss","ss.SSS"),this.interval.millisecond=s({hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1},null,this.interval.second).replace("ss","ss.SSS"),this.interval.second=s({hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1},null,this.interval.second),this.interval.minute=s({hour:"2-digit",minute:"2-digit",hour12:!1},null,this.interval.minute),this.interval.hour=s({month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1},null,this.interval.hour),this.interval.day=s({month:"2-digit",day:"2-digit",hour12:!1},null,this.interval.day),this.interval.month=s({year:"numeric",month:"2-digit",hour12:!1},null,this.interval.month)}getTimeFieldUnit(c){return`time:${c?this.fullDateMS:this.fullDate}`}}function s(a,c,o){if(g())return o??t;!c&&navigator&&(c=[...navigator.languages]);const h=new Intl.DateTimeFormat(c||void 0,a),f=h.formatToParts(new Date),p={year:"YYYY",month:"MM",day:"DD",hour:h.resolvedOptions().hour12?"hh":"HH",minute:"mm",second:"ss",weekday:"ddd",era:"N",dayPeriod:"A",timeZoneName:"Z"};return f.map(m=>p[m.type]||m.value).join("")}const r=new i,g=()=>!("DateTimeFormat"in Intl)||!("formatToParts"in Intl.DateTimeFormat.prototype)},72724:(k,R,e)=>{"use strict";e.d(R,{LE:()=>g,M7:()=>a,_Q:()=>o,fq:()=>c,jw:()=>h});var t=e(84743),n=e.n(t),i=e(1933),s=e(42994),r=e(47232);const g=(p,m)=>d(p,(0,i.O)(m)).format(f(m)),a=(p,m)=>d(p,(0,i.O)(m)).format(),c=(p,m)=>d(p,(0,i.O)(m)).fromNow(),o=(p,m)=>d(p,(0,i.O)(m)).format(`${s.WC.fullDate} z`),h=(p,m)=>d(p,(0,i.O)(m)).format("z"),f=p=>p?.defaultWithMS?p?.format??s.WC.fullDateMS:p?.format??s.WC.fullDate,d=(p,m)=>{const v=p,l=n().tz.zone(m);if(l&&l.name)return(0,r.AN)((0,r.yT)(v)).tz(l.name);switch(m){case"utc":return(0,r.AN)((0,r.yT)(v));default:return(0,r.AN)((0,r.yT)(v)).local()}}},47232:(k,R,e)=>{"use strict";e.d(R,{$D:()=>l,AN:()=>d,Ah:()=>h,Ar:()=>c,JK:()=>r,KQ:()=>f,XN:()=>g,mt:()=>i,oZ:()=>p,pp:()=>v,u8:()=>a,xQ:()=>m,xS:()=>s,yT:()=>o});var t=e(95093),n=e.n(t);const i=n().ISO_8601,s=y=>{n().locale(y)},r=()=>n().locale(),g=()=>n().localeData(),a=y=>y===null||typeof y=="string"||typeof y=="number"||y instanceof Date||Array.isArray(y)&&y.every(u=>typeof u=="string"||typeof u=="number")||c(y),c=y=>n().isMoment(y),o=(y,u)=>n().utc(y,u),h=(y,u)=>n().duration(y,u),f=(y,u)=>n()(y,u),d=y=>f(y),p=(y,u,D)=>{if(y&&y!=="browser"){let E;if(typeof u=="string"&&D?E=n().tz(u,D,y):E=n().tz(u,y),c(E))return E}return f(u,D)},m=y=>n().weekdays().findIndex(u=>u.toLowerCase()===y.toLowerCase()),v=y=>["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].findIndex(u=>u.toLowerCase()===y.toLowerCase()),l=y=>{const u="-weekStart",D=r().replace(u,""),E=y?v(y):-1;E!==-1?n().locale(D+u,{parentLocale:D,week:{dow:E}}):s(D)}},53531:(k,R,e)=>{"use strict";e.d(R,{b:()=>o});var t=e(2543),n=e.n(t),i=e(84743),s=e.n(i),r=e(1933),g=e(85858),a=e(42994),c=e(47232);const o=(d,p)=>(0,c.Ar)(d)?d:typeof d=="string"?h(d,p):f(d,p),h=(d,p)=>{if(d.indexOf("now")!==-1)return(0,g.isValid)(d)&&(0,g.parse)(d,p?.roundUp,p?.timeZone,p?.fiscalYearStartMonth)||(0,c.KQ)();const m=(0,r.O)(p),v=s().tz.zone(m),l=p?.format??a.WC.fullDate;if(v&&v.name)return(0,c.oZ)(v.name,d,l);switch((0,t.lowerCase)(m)){case"utc":return(0,c.yT)(d,l);default:return(0,c.KQ)(d,l)}},f=(d,p)=>{const m=d,v=(0,r.O)(p),l=s().tz.zone(v);if(l&&l.name)return(0,c.oZ)(l.name,m);switch((0,t.lowerCase)(v)){case"utc":return(0,c.yT)(m);default:return(0,c.KQ)(m)}}},65879:(k,R,e)=>{"use strict";e.r(R),e.d(R,{calculateInterval:()=>x,convertRawToRange:()=>v,describeInterval:()=>M,describeTextRange:()=>f,describeTimeRange:()=>d,describeTimeRangeAbbreviation:()=>m,intervalToMs:()=>I,intervalToSeconds:()=>O,isFiscal:()=>y,isRelativeTime:()=>l,isRelativeTimeRange:()=>u,isValidTimeSpan:()=>p,msRangeToTimeString:()=>E,relativeToTimeRange:()=>S,roundInterval:()=>T,secondsToHms:()=>D,timeRangeToRelative:()=>C});var t=e(2543),n=e.n(t),i=e(85858),s=e(72724),r=e(47232),g=e(53531);const a={s:{display:"second"},m:{display:"minute"},h:{display:"hour"},d:{display:"day"},w:{display:"week"},M:{display:"month"},y:{display:"year"}},c=[{from:"now/d",to:"now/d",display:"Today"},{from:"now/d",to:"now",display:"Today so far"},{from:"now/w",to:"now/w",display:"This week"},{from:"now/w",to:"now",display:"This week so far"},{from:"now/M",to:"now/M",display:"This month"},{from:"now/M",to:"now",display:"This month so far"},{from:"now/y",to:"now/y",display:"This year"},{from:"now/y",to:"now",display:"This year so far"},{from:"now-1d/d",to:"now-1d/d",display:"Yesterday"},{from:"now-2d/d",to:"now-2d/d",display:"Day before yesterday"},{from:"now-7d/d",to:"now-7d/d",display:"This day last week"},{from:"now-1w/w",to:"now-1w/w",display:"Previous week"},{from:"now-1M/M",to:"now-1M/M",display:"Previous month"},{from:"now-1Q/fQ",to:"now-1Q/fQ",display:"Previous fiscal quarter"},{from:"now-1y/y",to:"now-1y/y",display:"Previous year"},{from:"now-1y/fy",to:"now-1y/fy",display:"Previous fiscal year"},{from:"now-5m",to:"now",display:"Last 5 minutes"},{from:"now-15m",to:"now",display:"Last 15 minutes"},{from:"now-30m",to:"now",display:"Last 30 minutes"},{from:"now-1h",to:"now",display:"Last 1 hour"},{from:"now-3h",to:"now",display:"Last 3 hours"},{from:"now-6h",to:"now",display:"Last 6 hours"},{from:"now-12h",to:"now",display:"Last 12 hours"},{from:"now-24h",to:"now",display:"Last 24 hours"},{from:"now-2d",to:"now",display:"Last 2 days"},{from:"now-7d",to:"now",display:"Last 7 days"},{from:"now-30d",to:"now",display:"Last 30 days"},{from:"now-90d",to:"now",display:"Last 90 days"},{from:"now-6M",to:"now",display:"Last 6 months"},{from:"now-1y",to:"now",display:"Last 1 year"},{from:"now-2y",to:"now",display:"Last 2 years"},{from:"now-5y",to:"now",display:"Last 5 years"},{from:"now/fQ",to:"now",display:"This fiscal quarter so far"},{from:"now/fQ",to:"now/fQ",display:"This fiscal quarter"},{from:"now/fy",to:"now",display:"This fiscal year so far"},{from:"now/fy",to:"now/fy",display:"This fiscal year"}],o=[{from:"now",to:"now+1m",display:"Next minute"},{from:"now",to:"now+5m",display:"Next 5 minutes"},{from:"now",to:"now+15m",display:"Next 15 minutes"},{from:"now",to:"now+30m",display:"Next 30 minutes"},{from:"now",to:"now+1h",display:"Next hour"},{from:"now",to:"now+3h",display:"Next 3 hours"},{from:"now",to:"now+6h",display:"Next 6 hours"},{from:"now",to:"now+12h",display:"Next 12 hours"},{from:"now",to:"now+24h",display:"Next 24 hours"},{from:"now",to:"now+2d",display:"Next 2 days"},{from:"now",to:"now+7d",display:"Next 7 days"},{from:"now",to:"now+30d",display:"Next 30 days"},{from:"now",to:"now+90d",display:"Next 90 days"},{from:"now",to:"now+6M",display:"Next 6 months"},{from:"now",to:"now+1y",display:"Next year"},{from:"now",to:"now+2y",display:"Next 2 years"},{from:"now",to:"now+5y",display:"Next 5 years"}],h={};(0,t.each)(c,A=>{h[A.from+" to "+A.to]=A}),(0,t.each)(o,A=>{h[A.from+" to "+A.to]=A});function f(A){const L=A.indexOf("+")!==0;A.indexOf("now")===-1&&(A=(L?"now-":"now")+A);let N=h[A+" to now"];if(N)return N;L?N={from:A,to:"now",display:""}:N={from:"now",to:A,display:""};const F=/^now([-+])(\d+)(\w)/.exec(A);if(F){const w=F[3],B=parseInt(F[2],10),U=a[w];U&&(N.display=L?"Last ":"Next ",N.display+=B+" "+U.display,N.section=U.section,B>1&&(N.display+="s"))}else N.display=N.from+" to "+N.to,N.invalid=!0;return N}function d(A,L){const N=h[A.from.toString()+" to "+A.to.toString()];if(N)return N.display;const F={timeZone:L};if((0,r.Ar)(A.from)&&(0,r.Ar)(A.to))return(0,s.LE)(A.from,F)+" to "+(0,s.LE)(A.to,F);if((0,r.Ar)(A.from)){const w=i.parse(A.to,!0,"utc");return w?(0,s.LE)(A.from,F)+" to "+(0,s.fq)(w,F):""}if((0,r.Ar)(A.to)){const w=i.parse(A.from,!1,"utc");return w?(0,s.fq)(w,F)+" to "+(0,s.LE)(A.to,F):""}return A.to.toString()==="now"?f(A.from).display:A.from.toString()+" to "+A.to.toString()}const p=A=>A.indexOf("$")===0||A.indexOf("+$")===0?!0:f(A).invalid!==!0,m=(A,L)=>{if((0,r.Ar)(A.from))return(0,s.jw)(A.from,{timeZone:L});const N=i.parse(A.from,!0);return N?(0,s.jw)(N,{timeZone:L}):""},v=(A,L,N,F)=>{const w=(0,g.b)(A.from,{roundUp:!1,timeZone:L,fiscalYearStartMonth:N,format:F}),B=(0,g.b)(A.to,{roundUp:!0,timeZone:L,fiscalYearStartMonth:N,format:F});return i.isMathString(A.from)||i.isMathString(A.to)?{from:w,to:B,raw:A}:{from:w,to:B,raw:{from:w,to:B}}};function l(A){return typeof A=="string"?A.indexOf("now")>=0:!1}function y(A){return typeof A.raw.from=="string"&&A.raw.from.indexOf("f")>0?!0:typeof A.raw.to=="string"&&A.raw.to.indexOf("f")>0}function u(A){return l(A.from)||l(A.to)}function D(A){const L=Math.floor(A/31536e3);if(L)return L+"y";const N=Math.floor(A%31536e3/86400);if(N)return N+"d";const F=Math.floor(A%31536e3%86400/3600);if(F)return F+"h";const w=Math.floor(A%31536e3%86400%3600/60);if(w)return w+"m";const B=Math.floor(A%31536e3%86400%3600%60);if(B)return B+"s";const U=Math.floor(A*1e3);return U?U+"ms":"less than a millisecond"}function E(A){const L=Number((A/1e3).toFixed()),N=Math.floor(L/60/60),F=Math.floor(L/60)-N*60,w=Number((L%60).toFixed());let B=N?N+"h":"",U=F?F+"min":"",K=w?w+"sec":"";return B&&U?B=B+" ":B=B,(U||B)&&K?U=U+" ":U=U,B+U+K||"less than 1sec"}function x(A,L,N){let F=1;N&&(F=I(N));let w=T((A.to.valueOf()-A.from.valueOf())/L);return F>w&&(w=F),{intervalMs:w,interval:D(w/1e3)}}const P=/(-?\d+(?:\.\d+)?)(ms|[Mwdhmsy])/,b={y:31536e3,M:2592e3,w:604800,d:86400,h:3600,m:60,s:1,ms:.001};function M(A){if(Number(A))return{sec:b.s,type:"s",count:parseInt(A,10)};const L=A.match(P);if(!L)throw new Error(`Invalid interval string, has to be either unit-less or end with one of the following units: "${Object.keys(b).join(", ")}"`);const N=b[L[2]];if(N===void 0)throw new Error("describeInterval failed: invalid interval string");return{sec:N,type:L[2],count:parseInt(L[1],10)}}function O(A){const L=M(A);return L.sec*L.count}function I(A){const L=M(A);return L.sec*1e3*L.count}function T(A){switch(!0){case A<10:return 1;case A<15:return 10;case A<35:return 20;case A<75:return 50;case A<150:return 100;case A<350:return 200;case A<750:return 500;case A<1500:return 1e3;case A<3500:return 2e3;case A<7500:return 5e3;case A<12500:return 1e4;case A<17500:return 15e3;case A<25e3:return 2e4;case A<45e3:return 3e4;case A<9e4:return 6e4;case A<21e4:return 12e4;case A<45e4:return 3e5;case A<75e4:return 6e5;case A<105e4:return 9e5;case A<15e5:return 12e5;case A<27e5:return 18e5;case A<54e5:return 36e5;case A<9e6:return 72e5;case A<162e5:return 108e5;case A<324e5:return 216e5;case A<864e5:return 432e5;case A<6048e5:return 864e5;case A<18144e5:return 6048e5;case A<36288e5:return 2592e6;default:return 31536e6}}function C(A,L=(0,r.KQ)()){const N=L.unix()-A.from.unix(),F=L.unix()-A.to.unix();return{from:N,to:F}}function S(A,L=(0,r.KQ)()){const N=(0,r.KQ)(L).subtract(A.from,"s"),F=A.to===0?(0,r.KQ)(L):(0,r.KQ)(L).subtract(A.to,"s");return{from:N,to:F,raw:{from:N,to:F}}}},91410:(k,R,e)=>{"use strict";e.d(R,{HD:()=>c,P3:()=>h,QZ:()=>o,U3:()=>f,g$:()=>g,le:()=>a});var t=e(2543),n=e.n(t),i=e(84743),s=e.n(i),r=e(1933),g=(y=>(y.default="",y.localBrowserTime="browser",y.utc="utc",y))(g||{});const a=y=>{switch((0,r.O)({timeZone:y})){case"browser":return"Local browser time";case"utc":return"UTC";default:return y}},c=y=>s().tz.zone(y),o=(y,u)=>{const D=d(y,u);return D||m(y,u)},h=(0,t.memoize)((y=!1)=>{const u=[];return y===!0?u.push("","browser","utc"):y&&u.push(...y),s().tz.names().reduce((D,E)=>{const x=l[E];return!Array.isArray(x)||x.length===0||D.push(E),D},u)}),f=(0,t.memoize)((y=!1)=>{const D=h(y).reduce((E,x)=>{const P=x.indexOf("/");if(P===-1){const M="";return E[M]=E[M]??[],E[M].push(x),E}const b=x.slice(0,P);return E[b]=E[b]??[],E[b].push(x),E},{});return Object.keys(D).map(E=>({name:E,zones:D[E]}))}),d=(y,u)=>{switch(y){case"utc":return{name:"Coordinated Universal Time",ianaName:"UTC",zone:y,countries:[],abbreviation:"UTC, GMT",offsetInMins:0};case"":{const D=(0,r.O)(),x=D==="browser"||D==="utc"?d(D,u):m(D,u);return{countries:l[D]??[],abbreviation:"",offsetInMins:0,...x,ianaName:x?.ianaName??"",name:"Default",zone:y}}case"browser":{const D=s().tz.guess(!0),E=m(D,u);return{countries:l[D]??[],abbreviation:"Your local time",offsetInMins:new Date().getTimezoneOffset(),...E,name:"Browser Time",ianaName:E?.ianaName??"",zone:y}}default:return}},p=y=>/^(\+|\-).+/.test(y)?"":y,m=(y,u)=>{const D=s().tz.zone(y);if(D)return{name:y,ianaName:D.name,zone:y,countries:l[y]??[],abbreviation:p(D.abbr(u)),offsetInMins:D.utcOffset(u)}},v={AF:"Afghanistan",AX:"Aland Islands",AL:"Albania",DZ:"Algeria",AS:"American Samoa",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antarctica",AG:"Antigua And Barbuda",AR:"Argentina",AM:"Armenia",AW:"Aruba",AU:"Australia",AT:"Austria",AZ:"Azerbaijan",BS:"Bahamas",BH:"Bahrain",BD:"Bangladesh",BB:"Barbados",BY:"Belarus",BE:"Belgium",BZ:"Belize",BJ:"Benin",BM:"Bermuda",BT:"Bhutan",BO:"Bolivia",BA:"Bosnia And Herzegovina",BW:"Botswana",BV:"Bouvet Island",BR:"Brazil",IO:"British Indian Ocean Territory",BN:"Brunei Darussalam",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",KH:"Cambodia",CM:"Cameroon",CA:"Canada",CV:"Cape Verde",KY:"Cayman Islands",CF:"Central African Republic",TD:"Chad",CL:"Chile",CN:"China",CX:"Christmas Island",CC:"Cocos (Keeling) Islands",CO:"Colombia",KM:"Comoros",CG:"Congo",CD:"Congo, Democratic Republic",CK:"Cook Islands",CR:"Costa Rica",CI:"Cote D'Ivoire",HR:"Croatia",CU:"Cuba",CY:"Cyprus",CZ:"Czech Republic",DK:"Denmark",DJ:"Djibouti",DM:"Dominica",DO:"Dominican Republic",EC:"Ecuador",EG:"Egypt",SV:"El Salvador",GQ:"Equatorial Guinea",ER:"Eritrea",EE:"Estonia",ET:"Ethiopia",FK:"Falkland Islands (Malvinas)",FO:"Faroe Islands",FJ:"Fiji",FI:"Finland",FR:"France",GF:"French Guiana",PF:"French Polynesia",TF:"French Southern Territories",GA:"Gabon",GM:"Gambia",GE:"Georgia",DE:"Germany",GH:"Ghana",GI:"Gibraltar",GR:"Greece",GL:"Greenland",GD:"Grenada",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GG:"Guernsey",GN:"Guinea",GW:"Guinea-Bissau",GY:"Guyana",HT:"Haiti",HM:"Heard Island & Mcdonald Islands",VA:"Holy See (Vatican City State)",HN:"Honduras",HK:"Hong Kong",HU:"Hungary",IS:"Iceland",IN:"India",ID:"Indonesia",IR:"Iran (Islamic Republic Of)",IQ:"Iraq",IE:"Ireland",IM:"Isle Of Man",IL:"Israel",IT:"Italy",JM:"Jamaica",JP:"Japan",JE:"Jersey",JO:"Jordan",KZ:"Kazakhstan",KE:"Kenya",KI:"Kiribati",KR:"Korea",KW:"Kuwait",KG:"Kyrgyzstan",LA:"Lao People's Democratic Republic",LV:"Latvia",LB:"Lebanon",LS:"Lesotho",LR:"Liberia",LY:"Libyan Arab Jamahiriya",LI:"Liechtenstein",LT:"Lithuania",LU:"Luxembourg",MO:"Macao",MK:"Macedonia",MG:"Madagascar",MW:"Malawi",MY:"Malaysia",MV:"Maldives",ML:"Mali",MT:"Malta",MH:"Marshall Islands",MQ:"Martinique",MR:"Mauritania",MU:"Mauritius",YT:"Mayotte",MX:"Mexico",FM:"Micronesia (Federated States Of)",MD:"Moldova",MC:"Monaco",MN:"Mongolia",ME:"Montenegro",MS:"Montserrat",MA:"Morocco",MZ:"Mozambique",MM:"Myanmar",NA:"Namibia",NR:"Nauru",NP:"Nepal",NL:"Netherlands",AN:"Netherlands Antilles",NC:"New Caledonia",NZ:"New Zealand",NI:"Nicaragua",NE:"Niger",NG:"Nigeria",NU:"Niue",NF:"Norfolk Island",MP:"Northern Mariana Islands",NO:"Norway",OM:"Oman",PK:"Pakistan",PW:"Palau",PS:"Palestine, State of",PA:"Panama",PG:"Papua New Guinea",PY:"Paraguay",PE:"Peru",PH:"Philippines",PN:"Pitcairn",PL:"Poland",PT:"Portugal",PR:"Puerto Rico",QA:"Qatar",RE:"Reunion",RO:"Romania",RU:"Russian Federation",RW:"Rwanda",BL:"Saint Barthelemy",SH:"Saint Helena",KN:"Saint Kitts And Nevis",LC:"Saint Lucia",MF:"Saint Martin",PM:"Saint Pierre And Miquelon",VC:"Saint Vincent And Grenadines",WS:"Samoa",SM:"San Marino",ST:"Sao Tome And Principe",SA:"Saudi Arabia",SN:"Senegal",RS:"Serbia",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapore",SK:"Slovakia",SI:"Slovenia",SB:"Solomon Islands",SO:"Somalia",ZA:"South Africa",GS:"South Georgia And Sandwich Isl.",ES:"Spain",LK:"Sri Lanka",SD:"Sudan",SR:"Suriname",SJ:"Svalbard And Jan Mayen",SZ:"Swaziland",SE:"Sweden",CH:"Switzerland",SY:"Syrian Arab Republic",TW:"Taiwan",TJ:"Tajikistan",TZ:"Tanzania",TH:"Thailand",TL:"Timor-Leste",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad And Tobago",TN:"Tunisia",TR:"Turkey",TM:"Turkmenistan",TC:"Turks And Caicos Islands",TV:"Tuvalu",UG:"Uganda",UA:"Ukraine",AE:"United Arab Emirates",GB:"United Kingdom",US:"United States",UM:"United States Outlying Islands",UY:"Uruguay",UZ:"Uzbekistan",VU:"Vanuatu",VE:"Venezuela",VN:"Viet Nam",VG:"Virgin Islands, British",VI:"Virgin Islands, U.S.",WF:"Wallis And Futuna",EH:"Western Sahara",YE:"Yemen",ZM:"Zambia",ZW:"Zimbabwe"},l=s().tz.countries().reduce((y,u)=>s().tz.zonesForCountry(u).reduce((E,x)=>{E[x]||(E[x]=[]);const P=v[u];return P&&E[x].push({code:u,name:P}),E},y),{})},18226:(k,R,e)=>{"use strict";e.d(R,{o:()=>s});var t=e(74486),n=e(88483),i=e(16126);class s{constructor(){this.subscribers=new Map,this.emitter=new t.A}publish(a){this.emitter.emit(a.type,a)}subscribe(a,c){return this.getStream(a).subscribe({next:c})}getStream(a){return new n.c(c=>{const o=h=>{c.next(h)};return this.emitter.on(a.type,o),this.subscribers.set(o,c),()=>{this.emitter.off(a.type,o),this.subscribers.delete(o)}})}newScopedBus(a,c){return new r([a],this,c)}emit(a,c){typeof a=="string"?this.emitter.emit(a,{type:a,payload:c}):this.emitter.emit(a.name,{type:a.name,payload:c})}on(a,c,o){if(c.wrapper=h=>{c(h.payload)},typeof a=="string"?this.emitter.on(a,c.wrapper):this.emitter.on(a.name,c.wrapper),o){const h=o.$on("$destroy",()=>{this.off(a,c),h()})}}off(a,c){if(typeof a=="string"){this.emitter.off(a,c.wrapper);return}this.emitter.off(a.name,c.wrapper)}removeAllListeners(){this.emitter.removeAllListeners();for(const[a,c]of this.subscribers)c.complete(),this.subscribers.delete(a)}}class r{constructor(a,c,o){this.path=a,this.eventBus=c,this.filterConfig=o??{onlyLocal:!1}}publish(a){a.origin||(a.origin=this),this.eventBus.publish(a)}filter(a){return this.filterConfig.onlyLocal?a.origin===this:!0}getStream(a){return this.eventBus.getStream(a).pipe((0,i.p)(this.filter.bind(this)))}subscribe(a,c){return this.getStream(a).subscribe({next:c})}removeAllListeners(){this.eventBus.removeAllListeners()}newScopedBus(a,c){return new r([...this.path,a],this,c)}}},69129:(k,R,e)=>{"use strict";e.d(R,{LL:()=>o,LO:()=>s,NI:()=>c,Tp:()=>h,We:()=>r,b_:()=>n,gc:()=>g,ql:()=>i,wE:()=>a});var t=e(65463);class n extends t.x{static{this.type="data-hover"}}class i extends t.a{static{this.type="data-hover-clear"}}class s extends t.x{static{this.type="data-select"}}class r extends t.x{static{this.type="annotation-event"}}class g extends t.x{static{this.type="dashboard-loaded"}}class a extends t.a{static{this.type="datasource-updated-successfully"}}class c extends t.a{static{this.type="datasource-test-succeeded"}}class o extends t.a{static{this.type="datasource-test-failed"}}class h extends t.x{static{this.type="set-panel-attention"}}},89550:(k,R,e)=>{"use strict";e.d(R,{R:()=>n});const t=new Set;function n(i){if(t.has(i))throw new Error(`There is already an event defined with type '${i}'`);return t.add(i),{name:i}}},65463:(k,R,e)=>{"use strict";e.d(R,{a:()=>t,x:()=>n});class t{constructor(){this.type=this.__proto__.constructor.type}setTags(s){return this.tags=new Set(s),this}}class n extends t{constructor(s){super(),this.payload=s}}},66670:(k,R,e)=>{"use strict";e.d(R,{K:()=>n});var t=e(83077);class n extends t.O{}},57875:(k,R,e)=>{"use strict";e.d(R,{H:()=>m,J:()=>d});var t=e(2543),n=e.n(t),i=e(14236),s=e(47232),r=e(53531),g=e(11261),a=e(28802),c=e(62398),o=e(83195),h=e(58563);const f={dateTimeAsIso:!0,dateTimeAsIsoNoDateIfToday:!0,dateTimeAsUS:!0,dateTimeAsUSNoDateIfToday:!0,dateTimeAsLocal:!0,dateTimeAsLocalNoDateIfToday:!0,dateTimeFromNow:!0};function d(l){if(!l||(0,t.isEmpty)(l)||!l.field)return p;const y=l.field,u=y.config??{},{palette:D}=l.theme.visualization;let E=u.unit,x=E&&(f[E]||E.startsWith("time:")),P=!1;if(y.type===g.PU.time&&!x){if(E="dateTimeAsSystem",x=!0,y.values&&y.values.length>1){let A=y.values[0],L=y.values[y.values.length-1];typeof A=="string"?(A=(0,r.b)(A).unix(),L=(0,r.b)(L).unix()):(A/=1e3,L/=1e3),P=Math.abs(L-A)<60}}else y.type===g.PU.boolean?(0,o.j9)(E)||(E="bool"):!E&&y.type===g.PU.string&&(E="string");const b=E?.startsWith("currency"),M=(0,o.j9)(E),O=y.type===g.PU.number,T=!x&&!b&&!M&&!(E==="locale")&&O&&u.decimals==null,C=(0,o.j_)(E||"none"),S=(0,h.jc)(y,l.theme);return(A,L)=>{const{mappings:N}=u,F=E==="string";x&&typeof A=="string"&&(A=(0,s.yT)(A).valueOf());let w=F?NaN:(0,a.t)(A),B,U,K,V,H,Y;if(N&&N.length>0){const J=(0,c.Zz)(N,A);J&&(J.text!=null&&(B=J.text),J.color!=null&&(V=l.theme.visualization.getColorByName(J.color)),J.icon!=null&&(H=J.icon))}else if(y.type===g.PU.enum){if(A==null)return{text:"",numeric:NaN};const J=+A;if(u&&u.type&&u.type.enum){const{text:q,color:ae}=u.type.enum;if(B=q?q[J]:`${A}`,V=ae?ae[J]:void 0,V==null){const j=D[J%D.length];V=l.theme.visualization.getColorByName(j)}}}if(!Number.isNaN(w)){if(B==null&&!(0,t.isBoolean)(A)){let J;T&&L!=null?(J=C(w,L,null,l.timeZone,P),J.text=+J.text+""):J=C(w,u.decimals,null,l.timeZone,P),B=J.text,K=J.suffix,U=J.prefix}if(V==null){const J=S(w);V=J.color,Y=J.percent}}if(B==null&&(0,t.isArray)(A)&&(B=(0,t.join)(A,", ")),B==null&&(B=(0,t.toString)(A),B||(u.noValue?B=u.noValue:B="")),!V){const J=S(-1/0);V=J.color,Y=J.percent}const X={text:B,numeric:w,prefix:U,suffix:K,color:V};return H!=null&&(X.icon=H),Y!=null&&(X.percent=Y),X}}function p(l){return{text:(0,t.toString)(l),numeric:(0,a.t)(l)}}function m(){return l=>({text:(0,i.oE)(l)==="other"?`${JSON.stringify(l,v())}`:`${l}`,numeric:null})}const v=()=>{const l=new WeakSet;return(y,u)=>{if(typeof u=="object"&&u!==null){if(l.has(u))return;l.add(u)}return u}}},8066:(k,R,e)=>{"use strict";e.d(R,{Hs:()=>m,Qi:()=>p,lz:()=>v,uf:()=>f});var t=e(21197),n=e(55459),i=e.n(n),s=e(84140),r=e(23596),g=e(75059),a=e(24293),c=e(83077),o=e(58563),h=e(47737);const f=new c.O(()=>[{id:a.Y.Fixed,name:"Single color",description:"Set a specific color",getCalculator:l},{id:a.Y.Shades,name:"Shades of a color",description:"Select shades of a specific color",getCalculator:y},{id:a.Y.Thresholds,name:"From thresholds",isByValue:!0,description:"Derive colors from thresholds",getCalculator:(u,D)=>(E,x,P)=>{const b=P??h.QS;return D.visualization.getColorByName(b.color)}},new d({id:a.Y.PaletteClassic,name:"Classic palette",isContinuous:!1,isByValue:!1,getColors:u=>u.visualization.palette}),new d({id:a.Y.PaletteClassicByName,name:"Classic palette (by series name)",isContinuous:!1,isByValue:!1,useSeriesName:!0,getColors:u=>u.visualization.palette.filter(D=>(0,r.eM)(u.visualization.getColorByName(D),u.colors.background.primary)>=u.colors.contrastThreshold)}),new d({id:a.Y.ContinuousGrYlRd,name:"Green-Yellow-Red",isContinuous:!0,isByValue:!0,getColors:u=>["green","yellow","red"]}),new d({id:a.Y.ContinuousRdYlGr,name:"Red-Yellow-Green",isContinuous:!0,isByValue:!0,getColors:u=>["red","yellow","green"]}),new d({id:a.Y.ContinuousBlYlRd,name:"Blue-Yellow-Red",isContinuous:!0,isByValue:!0,getColors:u=>["dark-blue","super-light-yellow","dark-red"]}),new d({id:a.Y.ContinuousYlRd,name:"Yellow-Red",isContinuous:!0,isByValue:!0,getColors:u=>["super-light-yellow","dark-red"]}),new d({id:a.Y.ContinuousBlPu,name:"Blue-Purple",isContinuous:!0,isByValue:!0,getColors:u=>["blue","purple"]}),new d({id:a.Y.ContinuousYlBl,name:"Yellow-Blue",isContinuous:!0,isByValue:!0,getColors:u=>["super-light-yellow","dark-blue"]}),new d({id:a.Y.ContinuousBlues,name:"Blues",isContinuous:!0,isByValue:!0,getColors:u=>["panel-bg","dark-blue"]}),new d({id:a.Y.ContinuousReds,name:"Reds",isContinuous:!0,isByValue:!0,getColors:u=>["panel-bg","dark-red"]}),new d({id:a.Y.ContinuousGreens,name:"Greens",isContinuous:!0,isByValue:!0,getColors:u=>["panel-bg","dark-green"]}),new d({id:a.Y.ContinuousPurples,name:"Purples",isContinuous:!0,isByValue:!0,getColors:u=>["panel-bg","dark-purple"]})]);class d{constructor(D){this.id=D.id,this.name=D.name,this.description=D.description,this.getNamedColors=D.getColors,this.isContinuous=D.isContinuous,this.isByValue=D.isByValue,this.useSeriesName=D.useSeriesName}getColors(D){return this.getNamedColors?this.colorCache&&this.colorCacheTheme===D?this.colorCache:(this.colorCache=this.getNamedColors(D).map(D.visualization.getColorByName),this.colorCacheTheme=D,this.colorCache):[]}getInterpolator(){return this.interpolator||(this.interpolator=(0,t.Ik)(this.colorCache)),this.interpolator}getCalculator(D,E){const x=this.getColors(E);return this.isByValue?this.isContinuous?(P,b,M)=>this.getInterpolator()(b):(P,b,M)=>x[b*(x.length-1)]:this.useSeriesName?(P,b,M)=>x[Math.abs(i()(D.state?.displayName??D.name))%x.length]:(P,b,M)=>{const O=D.state?.seriesIndex??0;return x[O%x.length]}}}function p(u){return f.get(u.config.color?.mode??a.Y.Thresholds)}function m(u){return f.get(u??a.Y.Thresholds)}function v(u,D){const E=p(u);if(!E.isByValue)return{color:E.getCalculator(u,D)(0,0),threshold:h.QS,percent:1};const x=(0,o.jc)(u,D),P=u.config.color?.seriesBy??"last",M=(0,g.Nw)({field:u,reducers:[P]})[P]??0;return x(M)}function l(u,D){return()=>D.visualization.getColorByName(u.config.color?.fixedColor??a.F)}function y(u,D){return()=>{const E=D.visualization.getColorByName(u.config.color?.fixedColor??a.F),x=[E],P=6,b=10,M=35,O=35;for(let T=1;T<P;T++)x.push((0,s.A)(E).spin(T/P*b).brighten(T/P*M).toHexString()),x.push((0,s.A)(E).spin(-(T/P)*b).darken(T/P*O).toHexString());const I=u.state?.seriesIndex??0;return x[I%x.length]}}},56323:(k,R,e)=>{"use strict";e.d(R,{PI:()=>y,Pm:()=>l,XS:()=>P,Zo:()=>O,a_:()=>v,eG:()=>x,k3:()=>f,k_:()=>m,nF:()=>p,py:()=>d});var t=e(2543),n=e.n(t),i=e(78368),s=e(14236),r=e(75059),g=e(85200),a=e(1173),c=e(11261),o=e(57875),h=e(28240);const f="__series.name",d="__field.displayName",p="__field.labels",m="__calc",v="__cell_",l=25,y=T=>{const{replaceVariables:C,reduceOptions:S,timeZone:A,theme:L}=T,N=S.calcs.length?S.calcs:[r.gy.last],F=[],w=(0,g.NS)(S.fields?{id:a.Ct.byRegexp,options:S.fields}:{id:a.Ct.numeric}),B=T.data??[],U=S.limit?S.limit:l;let K=!1;for(let V=0;V<B.length&&!K;V++){const H=B[V],{timeField:Y}=(0,s.KR)(H),X=new i.R(H);for(let J=0;J<H.fields.length&&!K;J++){const q=H.fields[J],ae=q.getLinks;if(!w(q,H,B))continue;let j=q.config;q.state?.range&&(j={...j,...q.state?.range});let te=q.config.displayName??"";const ne=q.display??(0,o.J)({field:q,theme:T.theme,timeZone:A});if(S.values)for(let le=0;le<q.values.length;le++){q.state=D(q,F.length);const z=I(q,le),ee=ne(q.values[le]),se=u(H,q,le,C,z),ie=E(se,T.fieldConfig,L);if(F.push({name:"",field:j,display:{...ee,title:se,color:ie??ee.color},view:X,colIndex:J,rowIndex:le,getLinks:ae?()=>ae({valueRowIndex:le}):()=>[],hasLinks:x(q)}),F.length>=U){K=!0;break}}else{const le=(0,r.Nw)({field:q,reducers:N});for(const z of N){const ee=q.state?.scopedVars??{};ee[m]={value:z,text:z};const se=ne(le[z]);te!==""?se.title=C(te,ee):se.title=(0,h.Ct)(q,H,B),se.percentChange=T.percentChange?(0,r.Nw)({field:q,reducers:[r.gy.diffperc]}).diffperc:void 0;let ie;T.sparkline&&(ie={y:H.fields[J],x:Y},z===r.gy.last?ie.highlightIndex=ie.y.values.length-1:z===r.gy.first&&(ie.highlightIndex=0));const Z=H.length===1?0:void 0;F.push({name:z,field:j,display:se,sparkline:ie,view:X,colIndex:J,getLinks:ae?()=>ae({calculatedValue:se,valueRowIndex:Z}):()=>[],hasLinks:x(q)})}}}}return F.length===0&&F.push(b(T)),F};function u(T,C,S,A,L){const N=C.config.displayName;if(N)return N.indexOf(v)?A(O(N),L):A(N,L);let F=[],w=0;for(const B of T.fields)if(B!==C)if(B.type===c.PU.string){const U=B.values[S]??"",K=B.display?B.display(U).text:U;K.length>0&&F.push(K)}else B.type===c.PU.number&&w++;return(w||F.length===0)&&F.push((0,h.Ct)(C,T)),F.join(" ")}function D(T,C){return{...T.state,seriesIndex:C}}function E(T,C,S){for(const A of C.overrides)if(A.matcher.id==="byName"&&A.matcher.options===T){for(const L of A.properties)if(L.id==="color"&&L.value)return S.visualization.getColorByName(L.value.fixedColor)}return null}function x(T){return T.config?.links?.length?T.config.links.length>0:!1}function P(T){let C="",S="",A="",L="";for(let N=0;N<T.length;N++){const F=T[N].display;F.text&&F.text.length>S.length&&(S=F.text),F.title&&F.title.length>C.length&&(C=F.title),F.prefix&&F.prefix.length>A.length&&(A=F.prefix),F.suffix&&F.suffix.length>L.length&&(L=F.suffix)}return{text:S,title:C,suffix:L,prefix:A}}function b(T){const C="No data",{fieldConfig:S,timeZone:A}=T,{defaults:L}=S,F=(0,o.J)({field:{type:c.PU.other,config:L},theme:T.theme,timeZone:A})(null),w=M(F,C);return{name:C,field:{...L,max:L.max??0,min:L.min??0},display:{text:w,numeric:0,color:F.color},hasLinks:!1}}function M(T,C){return!T||(0,t.isEmpty)(T.text)?C:T.text}function O(T){return T.replace(/\${__cell_(\d+)(.*?)}|\[\[__cell_(\d+)(.*?)\]\]|\$__cell_(\d+)(\S*)/g,(C,S,A,L,N,F,w)=>`\${__data.fields[${S??L??F}]${A??N??w}}`)}function I(T,C){return T.state?.scopedVars?.__dataContext?{...T.state?.scopedVars,__dataContext:{value:{...T.state?.scopedVars?.__dataContext.value,rowIndex:C}}}:T.state?.scopedVars}},90708:(k,R,e)=>{"use strict";e.d(R,{BF:()=>O,K3:()=>C,_M:()=>T,nJ:()=>u,rJ:()=>S,we:()=>D});var t=e(2543),n=e.n(t),i=e(96540),s=e(80292),r=e(52622),g=e(21423),a=e(14236),c=e(23596),o=e(75059),h=e(85200),f=e(11261),d=e(24293),p=e(6709),m=e(71733),v=e(57875),l=e(58563),y=e(69550);function u(L){let N=null,F=null;const w=[o.gy.min,o.gy.max];for(const B of L)for(const U of B.fields)if(U.type===f.PU.number){const K=(0,o.Nw)({field:U,reducers:w}),V=K[o.gy.min],H=K[o.gy.max];(N===null||V<N)&&(N=V),(F===null||H>F)&&(F=H)}return{min:N,max:F,delta:(F??0)-(N??0)}}function D(L){if(!L.data)return[];const N=L.fieldConfig;if(!N)return L.data;const F=L.fieldConfigRegistry??y.G;let w=0,B;const U=[];if(N.overrides)for(const K of N.overrides){const V=h.sJ.get(K.matcher.id);V&&U.push({match:V.get(K.matcher.options),properties:K.properties})}return L.data.map((K,V)=>{const H={...K};H.fields=H.fields.map(Y=>({...Y,config:(0,t.cloneDeep)(Y.config),state:{...Y.state}}));for(const Y of H.fields){const X=Y.config;Y.state.scopedVars={__dataContext:{value:{data:L.data,frame:H,frameIndex:V,field:Y}}};const J={field:Y,data:L.data,dataFrameIndex:V,replaceVariables:L.replaceVariables,fieldConfigRegistry:F};b(X,N.defaults,J);for(const te of U)if(te.match(Y,H,L.data))for(const ne of te.properties)P(X,ne,J);let q=Y.type;if(!q||q===f.PU.other){const te=(0,a.dF)(Y);te&&(q=te)}const{range:ae,newGlobalRange:j}=E(X,Y,B,L.data);if(B=j,Y.state.displayName=null,Y.state.seriesIndex=w,Y.state.range=ae,Y.type=q,Y.type!==f.PU.time&&w++,Y.display=(0,v.J)({field:Y,theme:L.theme,timeZone:L.timeZone}),Y.config.unit!=="dateTimeFromNow"&&(Y.display=x(Y.display,2500)),Y.getLinks=T(H,Y,Y.state.scopedVars,J.replaceVariables,L.timeZone,L.dataLinkPostProcessor),Y.type===f.PU.nestedFrames)for(const te of Y.values)for(let ne=0;ne<te.length;ne++)for(const le of te[ne].fields)le.display=(0,v.J)({field:le,theme:L.theme,timeZone:L.timeZone}),le.state={scopedVars:{__dataContext:{value:{data:te,frame:te[ne],frameIndex:ne,field:le}}}},le.getLinks=T(te[ne],le,le.state.scopedVars,J.replaceVariables,L.timeZone,L.dataLinkPostProcessor)}return H})}function E(L,N,F,w){if(N.type!==f.PU.number||(0,t.isNumber)(L.min)&&(0,t.isNumber)(L.max))return{newGlobalRange:F};if(L.fieldMinMax){const V=(0,l.AP)(N),H=L.min??V.min,Y=L.max??V.max;return{range:{min:H,max:Y,delta:Y-H},newGlobalRange:F}}const B=F??u(w),U=L.min??B.min,K=L.max??B.max;return{range:{min:U,max:K,delta:K-U},newGlobalRange:B}}function x(L,N=2500){const F=new Map;for(let w=-1;w<=15;w++)F.set(w,new Map);return(w,B)=>{let U=F.get(B??-1),K=U.get(w);return K||(U.size===N&&U.clear(),K=L(w,B),K.color&&(K.color=(0,c.ze)(K.color)),U.set(w,K)),K}}function P(L,N,F){const B=F.fieldConfigRegistry.getIfExists(N.id);if(!B)return;const U=B.process(N.value,F,B.settings);U==null?B.isCustom&&L.custom?(0,t.unset)(L.custom,B.path):(0,t.unset)(L,B.path):B.isCustom?(L.custom||(L.custom={}),(0,t.set)(L.custom,B.path,U)):(0,t.set)(L,B.path,U)}function b(L,N,F){L.links&&N.links&&(L.links=[...L.links,...N.links]);for(const w of F.fieldConfigRegistry.list())w.isCustom&&!L.custom&&(L.custom={}),M(w.isCustom?L.custom:L,w.isCustom?N.custom:N,w,F);O(L)}function M(L,N,F,w){const B=(0,t.get)(L,F.path);if(B==null){const U=w.fieldConfigRegistry.getIfExists(F.id);if(!U)return;if(U&&U.shouldApply(w.field)){const K=U.process((0,t.get)(N,U.path),w,U.settings);K!=null&&(0,t.set)(L,U.path,K)}}}function O(L){const{thresholds:N}=L;if(L.color?L.color.mode||delete L.color:N&&(L.color={mode:d.Y.Thresholds}),L.hasOwnProperty("min")&&L.hasOwnProperty("max")&&L.min>L.max){const F=L.max;L.max=L.min,L.min=F}}const I=L=>{const{link:N,linkModel:F,dataLinkScopedVars:w,field:B,replaceVariables:U}=L;return N.internal?(0,p.u)({link:N,internalLink:N.internal,scopedVars:w,field:B,range:N.internal.range,replaceVariables:U}):F},T=(L,N,F,w,B,U)=>K=>!N.config.links||N.config.links.length===0?[]:N.config.links.map(H=>{const Y=A(L,N,F),X={...F,__dataContext:Y},J=(j,te,ne)=>w(j,{...X,...te},ne);K.valueRowIndex!==void 0&&!isNaN(K.valueRowIndex)?Y.value.rowIndex=K.valueRowIndex:Y.value.calculatedValue=K.calculatedValue;let q,ae=H.onClick||!H.onBuildUrl?H.url:H.onBuildUrl({origin:N,replaceVariables:J});return ae&&(ae=m.I.assureBaseUrl(ae.replace(/\n/g,"")),ae=w(ae,X,r.$m.UriEncode),ae=m.I.processUrl(ae)),H.onClick?q={href:ae,title:w(H.title||"",X),target:H.targetBlank?"_blank":void 0,onClick:(j,te)=>{H.onClick({origin:te??N,e:j,replaceVariables:J})},origin:N}:q={href:ae,title:w(H.title||"",X),target:H.targetBlank?"_blank":void 0,origin:N},(U||I)({frame:L,field:N,dataLinkScopedVars:X,replaceVariables:w,config:K,link:H,linkModel:q})}).filter(H=>!!H);function C(L){if(!L||L.length===0)return[];const N=[...L],F=(0,v.H)();for(let w=0;w<N.length;w++){const B={...N[w]},U=[...B.fields];for(let K=0;K<U.length;K++)U[K]={...U[K],display:F};N[w]={...B,fields:U}}return N}function S(L,N,F,w,B,U,K){const V=L?.fieldConfigRegistry,H=(0,i.useRef)(0),Y=(0,s.A)(F?.series);return(0,i.useMemo)(()=>{if(!V||!N||!F)return;const X=F?.series;F.structureRev==null&&X&&Y&&!(0,g.J3)(X,Y,g.bW)&&H.current++;const J={structureRev:H.current,...F,series:D({data:X,fieldConfig:N,fieldConfigRegistry:V,replaceVariables:U,theme:B,timeZone:w,dataLinkPostProcessor:K})};return F.annotations&&F.annotations.length>0&&(J.annotations=D({data:F.annotations,fieldConfig:{defaults:{},overrides:[]},replaceVariables:U,theme:B,timeZone:w,dataLinkPostProcessor:K})),J},[V,N,F,Y,w,B,U,K])}function A(L,N,F){return F?.__dataContext?{value:{...F.__dataContext.value}}:{value:{frame:L,field:N,data:[L]}}}},28240:(k,R,e)=>{"use strict";e.d(R,{Ct:()=>a,Fm:()=>r,Ri:()=>s,fk:()=>o,j2:()=>g});var t=e(85200),n=e(11261),i=e(8249);function s(f,d){if(f.name)return f.name;const p=[];for(const m of f.fields)if(m.type!==n.PU.time){if(p.length>1)break;p.push(a(m,f))}return p.length===1?p[0]:d===void 0&&f.fields.length>0?f.fields.filter(m=>m.type!==n.PU.time).map(m=>a(m,f)).join(", "):f.refId?`Series (${f.refId})`:`Series (${d})`}function r(f){f.forEach(d=>{d.fields.forEach(p=>{a(p,d,f)})})}function g(f,d){f.forEach(p=>{p.fields.forEach(m=>{const v={legend:!1,tooltip:!1,viz:!1,...d.defaults.custom?.hideFrom},l=m.config.custom?.hideFrom;d.overrides.forEach(y=>{if("__systemRef"in y)return;if((0,t.NS)(y.matcher)(m,p,f))for(const D of y.properties)D.id==="custom.hideFrom"&&Object.assign(v,D.value)}),m.state={...m.state,hideFrom:{...l}},m.config.custom.hideFrom=v})})}function a(f,d,p){const m=f.state?.displayName,v=!!(p&&p.length>1);if(m&&v===f.state?.multipleFrames)return m;const l=c(f,d,p);return f.state=f.state||{},f.state.displayName=l,f.state.multipleFrames=v,l}function c(f,d,p){const m=f.config?.displayName&&f.config?.displayName.length,v=!!d?.meta?.timeCompare?.isTimeShiftQuery;let l=m?f.config.displayName:f.name;if(m)return v?`${l} (comparison)`:l;if(d&&f.config?.displayNameFromDS)return v?`${f.config.displayNameFromDS} (comparison)`:f.config.displayNameFromDS;if(f.type===n.PU.time&&!f.labels)return l??n.LE;let y=[],u=!1;if(p&&p.length>1){for(let x=1;x<p.length;x++)if(p[x].name!==p[x-1].name){u=!0;break}}let D=!1,E=!1;if(u&&d?.name&&(y.push(d.name),D=!0),f.name&&f.name!==n.Bc&&y.push(f.name),f.labels&&d){let x=h(p??[d]);if(x)f.labels[x]&&(y.push(f.labels[x]),E=!0);else{let P=(0,i.h6)(f.labels);P&&(y.push(P),E=!0)}}return d&&!D&&!E&&f.name===n.Bc&&d.name&&d.name.length>0&&(y.push(d.name),D=!0),y.length?l=y.join(" "):f.name?l=f.name:l=n.Bc,l===f.name&&(l=o(f,d)),v&&(l=`${l} (comparison)`),l}function o(f,d){let p=0,m=!1;if(d)for(let v=0;v<d.fields.length;v++){const l=d.fields[v];if(f===l){if(m=!0,p>0){p++;break}}else if(f.name===l.name&&(p++,m))break}return p?`${f.name} ${p}`:f.name}function h(f){let d=null;for(let p=0;p<f.length;p++){const m=f[p];for(const v of m.fields)if(v.labels){for(const l in v.labels)if(d===null)d=l;else if(l!==d)return null}}return d}},92461:(k,R,e)=>{"use strict";e.d(R,{F:()=>r});var t=e(2543),n=e.n(t),i=e(83195),s=e(57875);function r(g){return new Proxy({},{get:(a,c)=>{let o=g.frame.fields.find(p=>c===p.name);if(!o){const p=(0,t.toNumber)(c);o=g.frame.fields[p]}if(o||(o=g.frame.fields.find(p=>c===p.config.displayName)),o||(o=g.frame.fields.find(p=>p.labels?c===p.labels.name:!1)),!o)return;const h=o.display??(0,s.J)(),f=o.values[g.rowIndex],d=h(f);return d.toString=()=>(0,i.cN)(d),d}})}},27310:(k,R,e)=>{"use strict";e.d(R,{AM:()=>i,Ch:()=>s,FM:()=>h,N7:()=>c,OU:()=>a,X4:()=>f,hL:()=>g,hS:()=>t,lG:()=>o,m0:()=>n,xT:()=>r});const t=d=>d,n=(d,p,m)=>{if(d!=null)return parseFloat(d)},i=(d,p,m)=>(delete p.field?.state?.displayName,a(d,p,m)),s=(d,p,m)=>d,r=(d,p,m)=>d,g=(d,p,m)=>d,a=(d,p,m)=>d==null?d:m&&m.expandTemplateVars&&p.replaceVariables&&typeof d=="string"?p.replaceVariables(d,p.field.state.scopedVars):`${d}`,c=(d,p,m)=>d,o=(d,p,m)=>d,h=(d,p,m)=>d;var f=(d=>(d.IncludeAll="all",d.ExcludeBaseNames="exclude",d.OnlyBaseNames="only",d))(f||{})},58563:(k,R,e)=>{"use strict";e.d(R,{AP:()=>o,jc:()=>a,xg:()=>h});var t=e(2543),n=e.n(t),i=e(75059),s=e(11261),r=e(8066),g=e(47737);function a(f,d){if(f.type===s.PU.boolean)return c(f,d);const m=(0,r.Qi)(f).getCalculator(f,d),v=f.state?.range??o(f);return l=>{let y=0;l!==-1/0&&(y=(l-v.min)/v.delta,Number.isNaN(y)&&(y=0));const u=(0,g.k5)(f,l,y);return{percent:y,threshold:u,color:m(l,y,u)}}}function c(f,d){const p={color:d.visualization.getColorByName("green"),percent:1,threshold:void 0},m={color:d.visualization.getColorByName("red"),percent:0,threshold:void 0},v=(0,r.Qi)(f);if(v.isContinuous&&v.getColors){const l=v.getColors(d);p.color=l[l.length-1],m.color=l[0]}return l=>l?p:m}function o(f){if(f.type!==s.PU.number)return{min:0,max:100,delta:100};let d=f.config.min,p=f.config.max;if(!(0,t.isNumber)(d)||!(0,t.isNumber)(p))if(f.values&&f.values.length){const m=(0,i.Nw)({field:f,reducers:[i.gy.min,i.gy.max]});(0,t.isNumber)(d)||(d=m[i.gy.min]),(0,t.isNumber)(p)||(p=m[i.gy.max])}else d=0,p=100;return{min:d,max:p,delta:p-d}}function h(f,d){const{config:p}=f;let{min:m,max:v}=p;return(0,t.isNumber)(m)&&(0,t.isNumber)(v)?p:d||!f.state?.range?{...p,...o(f)}:{...p,...f.state.range}}},69550:(k,R,e)=>{"use strict";e.d(R,{D:()=>s,G:()=>i});var t=e(83077),n=e(66670);const i=new n.K,s=new t.O},47737:(k,R,e)=>{"use strict";e.d(R,{QS:()=>i,RU:()=>g,k5:()=>r,yQ:()=>s});var t=e(24293),n=e(50082);const i={value:0,color:t.F};function s(a,c){if(!c||c.length===0)return i;let o=c[0];for(const h of c)if(a>=h.value)o=h;else break;return o}function r(a,c,o){const{thresholds:h}=a.config;return h?.mode===n.O.Percentage?s(o*100,h?.steps):s(c,h?.steps)}function g(a){return a.sort((c,o)=>c.value-o.value)}},33459:(k,R,e)=>{"use strict";e.r(R),e.d(R,{AbstractLabelOperator:()=>Tn.D_,AlertState:()=>Qe.O,AnnotationChangeEvent:()=>x.We,AnnotationEventFieldSource:()=>Sn.V,AppEvents:()=>Pt.r1,AppPlugin:()=>Vn.hX,ArrayDataFrame:()=>o.f,ArrayVector:()=>Fn,BinaryOperationID:()=>ye.k,BusEventBase:()=>D.a,BusEventWithPayload:()=>D.x,ByNamesMatcherMode:()=>ze.PP,CSVHeaderStyle:()=>z.F7,CSVReader:()=>z.i8,CircularDataFrame:()=>qn.x,CircularVector:()=>Zt.$,CoreApp:()=>Vn.Jk,CustomVariableSupport:()=>pt.f5,DEFAULT_FIELD_DISPLAY_VALUES_LIMIT:()=>S.Pm,DEFAULT_SAML_NAME:()=>ut.En,DashboardCursorSync:()=>Wn.y,DashboardLoadedEvent:()=>x.gc,DataFrameType:()=>Tt.m,DataFrameView:()=>n.R,DataHoverClearEvent:()=>x.ql,DataHoverEvent:()=>x.b_,DataLinkBuiltInVars:()=>K.c,DataLinkConfigOrigin:()=>Nn.x0,DataQueryErrorType:()=>xn.v2,DataSelectEvent:()=>x.LO,DataSourceApi:()=>xn.mA,DataSourcePlugin:()=>xn.tD,DataSourcePluginContextProvider:()=>Vt.p,DataSourceTestFailed:()=>x.LL,DataSourceTestSucceeded:()=>x.NI,DataSourceUpdatedSuccessfully:()=>x.wE,DataSourceVariableSupport:()=>pt.ZV,DataTopic:()=>p.QR,DataTransformerID:()=>Ze.F,DefaultTimeZone:()=>qt.lE,DocsId:()=>V.f,EventBusSrv:()=>E.o,ExploreMode:()=>xn.ZF,FALLBACK_COLOR:()=>Pn.F,FeatureState:()=>Vn.Ay,FieldCache:()=>i.L,FieldColorModeId:()=>Pn.Y,FieldConfigEditorBuilder:()=>F.bk,FieldConfigOptionsRegistry:()=>b.K,FieldConfigProperty:()=>Ft.uo,FieldMatcherID:()=>Ne.Ct,FieldNamePickerBaseNameMode:()=>N.X4,FieldType:()=>Wt.PU,FrameGeometrySourceMode:()=>p.aG,FrameMatcherID:()=>Ne.jR,GAUGE_DEFAULT_MAXIMUM:()=>ut.d1,GAUGE_DEFAULT_MINIMUM:()=>ut.tw,GrafanaPlugin:()=>tn.Ud,GrafanaThemeType:()=>mn.I,ISO_8601:()=>he.mt,InternalTimeZones:()=>Ce.g$,LanguageProvider:()=>xn.Is,LayoutModes:()=>gt.R,LegacyGraphHoverClearEvent:()=>Pt.Tq,LegacyGraphHoverEvent:()=>Pt.kb,LegacyMappingType:()=>J.An,LiveChannelConnectionState:()=>Kn.ZF,LiveChannelEventType:()=>Kn.o4,LiveChannelScope:()=>Kn.qD,LiveChannelType:()=>Kn.os,LoadingState:()=>jt.Gu,LocalStorageValueProvider:()=>Le.b,LogLevel:()=>En.$b,LogRowContextQueryDirection:()=>En.ZF,LogsDedupDescription:()=>En._C,LogsDedupStrategy:()=>p.fY,LogsMetaKind:()=>En.tG,LogsSortOrder:()=>p.uH,LogsVolumeType:()=>En.Aj,MISSING_VALUE:()=>s.p,MappingType:()=>ln.d,MatcherID:()=>Ne.cV,MutableDataFrame:()=>s.k,NodeGraphDataFrameFieldNames:()=>ue.u,NullValueMode:()=>jt.UW,NumericLogLevel:()=>En.s5,OneClickMode:()=>Nn.yd,OrgRole:()=>At.X,PageLayoutType:()=>cn.k,PanelEvents:()=>Pt.ee,PanelOptionsEditorBuilder:()=>F.pv,PanelPlugin:()=>xt.m,PluginContextProvider:()=>Nt.a,PluginErrorCode:()=>tn.ZK,PluginExtensionPoints:()=>Bt.S,PluginExtensionTypes:()=>Bt.u,PluginIncludeType:()=>tn.ib,PluginSignatureStatus:()=>tn.Ac,PluginSignatureType:()=>tn.kv,PluginState:()=>tn.pn,PluginType:()=>tn.QE,ReducerID:()=>Pe.gy,Registry:()=>te.O,SetPanelAttentionEvent:()=>x.Tp,SpecialValue:()=>Gt.N,SpecialValueMatch:()=>ln.W,StandardVariableSupport:()=>pt.J$,StreamingDataFrame:()=>c.k9,StreamingFrameAction:()=>c.Kh,SupplementaryQueryType:()=>En.cF,SupportedTransformationType:()=>Nn.CC,SystemDateFormatsState:()=>We.JE,TIME_FORMAT:()=>qt.G$,TIME_SERIES_METRIC_FIELD_NAME:()=>Wt.aI,TIME_SERIES_TIME_FIELD_NAME:()=>Wt.LE,TIME_SERIES_VALUE_FIELD_NAME:()=>Wt.Bc,ThemeContext:()=>ve.D,ThresholdsMode:()=>Rn.O,TransformationApplicabilityLevels:()=>Gt.M,TransformerCategory:()=>$e.m,UnaryOperationID:()=>re._,VAR_CALC:()=>S.k_,VAR_CELL_PREFIX:()=>S.a_,VAR_FIELD_LABELS:()=>S.nF,VAR_FIELD_NAME:()=>S.py,VAR_SERIES_NAME:()=>S.k3,ValueMatcherID:()=>Ne.Js,VariableHide:()=>fn.zL,VariableOrigin:()=>Nn.$0,VariableRefresh:()=>fn.CO,VariableSort:()=>fn.ZG,VariableSuggestionsScope:()=>Nn.uP,VariableSupportBase:()=>pt.xi,VariableSupportType:()=>pt.Qz,VisualizationSuggestionScore:()=>Cn.nQ,VisualizationSuggestionsBuilder:()=>Cn.v2,VisualizationSuggestionsListAppender:()=>Cn.NV,VizOrientation:()=>Cn.wV,addDurationToDate:()=>nt.Ri,addRow:()=>a.uY,amendTable:()=>t.c,anySeriesWithTimeField:()=>a.tP,anyToNumber:()=>Y.t,applyFieldOverrides:()=>O.we,applyNullInsertThreshold:()=>yt.M,applyRawFieldOverrides:()=>O.K3,arrayToDataFrame:()=>o.I,arrayUtils:()=>ge,availableIconsIndex:()=>ot.az,binaryOperators:()=>ye.b,booleanOverrideProcessor:()=>N.FM,booleanValueFormatter:()=>Se.Qc,buildHistogram:()=>dt.p3,cacheFieldDisplayNames:()=>T.Fm,classicColors:()=>Z,closestIdx:()=>c.Ls,colorManipulator:()=>me.MV,compareArrayValues:()=>f.J3,compareDataFrameStructures:()=>f.bW,containsSearchFilter:()=>q.E,convertOldAngularValueMappings:()=>J.bh,createDataFrame:()=>r.EI,createDimension:()=>g.r4,createFieldConfigRegistry:()=>zt.O,createTheme:()=>pe.a,dataFrameFromJSON:()=>h.or,dataFrameToJSON:()=>h.Nw,dataLinksOverrideProcessor:()=>N.Ch,dateMath:()=>Ie,dateTime:()=>he.KQ,dateTimeAsMoment:()=>he.AN,dateTimeForTimeZone:()=>he.oZ,dateTimeFormat:()=>et.LE,dateTimeFormatISO:()=>et.M7,dateTimeFormatTimeAgo:()=>et.fq,dateTimeFormatWithAbbrevation:()=>et._Q,dateTimeParse:()=>rt.b,decodeFieldValueEntities:()=>h.t,decodeFieldValueEnums:()=>h.EL,defaultCalcs:()=>Pe.C6,deprecationWarning:()=>le.l,displayNameOverrideProcessor:()=>N.AM,doStandardCalcs:()=>Pe.H3,durationToMilliseconds:()=>nt.WT,ensureTimeField:()=>vt.ks,escapeRegex:()=>m.$f,escapeStringForRegex:()=>m.jD,eventFactory:()=>u.R,fieldColorModeRegistry:()=>P.uf,fieldMatchers:()=>je.sJ,fieldReducers:()=>Pe.AS,filterFieldConfigOverrides:()=>St.aW,findCommonLabels:()=>ee.yO,findHighlightChunksInText:()=>v.Oq,findMatchesInText:()=>v.bs,findUniqueLabels:()=>ee.s6,fixCellTemplateExpressions:()=>S.Zo,formatLabels:()=>ee.h6,formattedValueToString:()=>Se.cN,frameMatchers:()=>je.RE,getActiveThreshold:()=>M.yQ,getAllValuesFromDimension:()=>g.Km,getBuiltInThemes:()=>Ee.k,getColumnFromDimension:()=>g.P4,getColumnsFromDimension:()=>g.g6,getDataFrameRow:()=>r.Yn,getDataSourceRef:()=>ne.p$,getDataSourceUID:()=>ne.Iz,getDefaultRelativeTimeRange:()=>qt.Cn,getDefaultTimeRange:()=>qt.E2,getDimensionByName:()=>g.xB,getDisplayProcessor:()=>A.J,getDisplayValueAlignmentFactors:()=>S.XS,getFieldColorMode:()=>P.Hs,getFieldColorModeForField:()=>P.Qi,getFieldConfigWithMinMax:()=>C.xg,getFieldDisplayName:()=>T.Ct,getFieldDisplayValues:()=>S.PI,getFieldDisplayValuesProxy:()=>I.F,getFieldMatcher:()=>je.NS,getFieldSeriesColor:()=>P.lz,getFieldTypeFromValue:()=>r.oE,getFlotPairs:()=>w.R,getFlotPairsConstant:()=>w.r,getFrameDisplayName:()=>T.Ri,getFrameMatchers:()=>je.Dq,getHistogramFields:()=>dt.ix,getLinksSupplier:()=>O._M,getLocale:()=>he.JK,getLocaleData:()=>he.XN,getMinMaxAndDelta:()=>C.AP,getNextRefId:()=>d.M,getPanelOptionsWithDefaults:()=>St.F,getProcessedDataFrames:()=>r.Bt,getRawDisplayProcessor:()=>A.H,getRowUniqueId:()=>a.t9,getScaleCalculator:()=>C.jc,getSearchFilterScopedVar:()=>q.c,getSeriesTimeStep:()=>oe,getThemeById:()=>Ee.g,getTimeField:()=>r.KR,getTimeZone:()=>Re.O,getTimeZoneGroups:()=>Ce.U3,getTimeZoneInfo:()=>Ce.QZ,getTimeZones:()=>Ce.P3,getUniqueFieldName:()=>T.fk,getValueFormat:()=>Se.j_,getValueFormats:()=>Se.Ke,getValueFormatterIndex:()=>Se.uH,getValueFromDimension:()=>g.WK,getValueMatcher:()=>je.kK,getWeekdayIndex:()=>he.xQ,getWeekdayIndexByEnglishName:()=>he.pp,getZone:()=>Ce.HD,guessDecimals:()=>se.E,guessFieldTypeForField:()=>r.dF,guessFieldTypeFromNameAndValue:()=>r.by,guessFieldTypeFromValue:()=>r.HW,guessFieldTypes:()=>r.XQ,hasLinks:()=>S.eG,hasLogsContextSupport:()=>En.Ol,hasLogsContextUiSupport:()=>En.wj,hasMsResolution:()=>ce,hasQueryExportSupport:()=>Tn.Ee,hasQueryImportSupport:()=>Tn.FL,hasQueryModificationSupport:()=>En._0,hasSupplementaryQuerySupport:()=>En.Nc,hasTimeField:()=>a.S1,hasToggleableQueryFiltersSupport:()=>En.FP,histogramBucketSizes:()=>dt.rW,histogramFieldInfo:()=>dt.Rt,histogramFieldsToFrame:()=>dt.cg,histogramFrameBucketMaxFieldName:()=>dt.dA,histogramFrameBucketMinFieldName:()=>dt.d$,histogramTransformer:()=>dt.OA,identityOverrideProcessor:()=>N.hS,incrRound:()=>dt.ZU,incrRoundDn:()=>dt.rs,incrRoundUp:()=>dt.Uh,intervalToAbbreviatedDurationString:()=>nt.dU,isBooleanUnit:()=>Se.j9,isCustomFieldProp:()=>St.TQ,isDataFrame:()=>r.ci,isDataFrameWithValue:()=>r.LI,isDataSourcePluginContext:()=>Je.S,isDataSourceRef:()=>ne.fN,isDateTime:()=>he.Ar,isDateTimeInput:()=>he.u8,isEmptyObject:()=>ie.R,isHistogramFrameBucketMaxFieldName:()=>dt.H1,isHistogramFrameBucketMinFieldName:()=>dt.NX,isIconName:()=>ot.n6,isLikelyAscendingVector:()=>qe.g2,isLiveChannelJoinEvent:()=>Kn.Cz,isLiveChannelLeaveEvent:()=>Kn.jQ,isLiveChannelMessageEvent:()=>Kn.Z7,isLiveChannelStatusEvent:()=>Kn.ew,isObject:()=>jt.Gv,isReducerID:()=>Pe.Em,isStandardFieldProp:()=>St.nx,isSystemOverride:()=>Ft.Ow,isSystemOverrideWithRef:()=>Ft.ZW,isTableData:()=>r.pH,isTimeSeriesField:()=>a.hF,isTimeSeriesFrame:()=>a.aH,isTimeSeriesFrames:()=>a.jq,isTruthy:()=>jt.zz,isUnsignedPluginSignature:()=>ct.x,isValidDate:()=>nt.vd,isValidDuration:()=>nt.di,isValidGoDuration:()=>nt.pp,isValidGrafanaDuration:()=>nt.V3,isValidLiveChannelAddress:()=>Kn.aj,localTimeFormat:()=>We.Od,locale:()=>Se.Hg,locationUtil:()=>B.I,makeClassES5Compatible:()=>H.Y,makeTimeRange:()=>qt.HW,mapInternalLinkToExplore:()=>K.u,matchAllLabels:()=>ee._p,matchPluginId:()=>j._,monacoLanguageRegistry:()=>Ve.l,nullToValue:()=>st.C,numberOverrideProcessor:()=>N.m0,objRemoveUndefined:()=>ie.w,onUpdateDatasourceJsonDataOption:()=>ne.PG,onUpdateDatasourceJsonDataOptionChecked:()=>ne.EX,onUpdateDatasourceJsonDataOptionSelect:()=>ne.BD,onUpdateDatasourceOption:()=>ne.zX,onUpdateDatasourceResetOption:()=>ne.yV,onUpdateDatasourceSecureJsonDataOption:()=>ne.mn,onUpdateDatasourceSecureJsonDataOptionSelect:()=>ne.wY,outerJoinDataFrames:()=>qe.Fd,parseDuration:()=>nt.E9,parseFlags:()=>v.bQ,parseLabels:()=>ee.Xy,parseLiveChannelAddress:()=>Kn.DG,patchArrayVectorProrotypeMethods:()=>Et.V,preProcessPanelData:()=>r.N$,preferredVisualizationTypes:()=>jt.Nx,rangeUtil:()=>Oe,readCSV:()=>z.Jh,reduceField:()=>Pe.Nw,renderLegendFormat:()=>ae.j,renderMarkdown:()=>l.G,renderTextPanelMarkdown:()=>l.P,restoreCustomOverrideRules:()=>St.H9,reverseDataFrame:()=>r.q7,roundDecimals:()=>se.h,scaledUnits:()=>Se.yP,scopeFilterOperatorMap:()=>an.n,selectOverrideProcessor:()=>N.hL,serializeStateToUrlParam:()=>U.Pp,setLocale:()=>he.xS,setTimeZoneResolver:()=>Re.G,setWeekStart:()=>he.$D,shallowCompare:()=>f.ab,simpleCountUnit:()=>Se.UR,sortDataFrame:()=>r.ES,sortThresholds:()=>M.RU,standardEditorsRegistry:()=>L.D,standardFieldConfigEditorRegistry:()=>L.G,standardTransformers:()=>Ye.c,standardTransformersRegistry:()=>$e.h,store:()=>Te.M,stringFormater:()=>Se.cH,stringOverrideProcessor:()=>N.OU,stringStartsAsRegEx:()=>m.AP,stringToJsRegex:()=>m.dO,stringToMs:()=>m.dc,systemDateFormats:()=>We.WC,textUtil:()=>y.sQ,thresholdsOverrideProcessor:()=>N.N7,timeZoneAbbrevation:()=>et.jw,timeZoneFormatUserFriendly:()=>Ce.le,toCSV:()=>z._O,toDataFrame:()=>r.Vc,toDataFrameDTO:()=>r.Kl,toDuration:()=>he.Ah,toFilteredDataFrameDTO:()=>r.By,toFixed:()=>Se.Mg,toFixedScaled:()=>Se.gZ,toFixedUnit:()=>Se.G8,toFloatOrUndefined:()=>m.$D,toIconName:()=>ot.Uo,toIntegerOrUndefined:()=>m.vb,toLegacyResponseData:()=>r.w3,toLiveChannelId:()=>Kn.Qp,toNumberString:()=>m.kT,toOption:()=>De.z,toPascalCase:()=>m.MX,toURLRange:()=>U.sQ,toUtc:()=>he.yT,transformDataFrame:()=>Ue.m,trimTable:()=>t.F,unEscapeStringFromRegex:()=>m.xb,unaryOperators:()=>re.j,unitOverrideProcessor:()=>N.lG,updateDatasourcePluginJsonDataOption:()=>ne.lO,updateDatasourcePluginOption:()=>ne.pN,updateDatasourcePluginResetOption:()=>ne.QP,updateDatasourcePluginSecureJsonDataOption:()=>ne.wp,urlUtil:()=>U.kM,useFieldOverrides:()=>O.rJ,usePluginContext:()=>en.Q,userHasAllPermissions:()=>js.Fj,userHasAnyPermission:()=>js.jW,userHasPermission:()=>js.ZU,userHasPermissionInMetadata:()=>js.T6,validateFieldConfig:()=>O.BF,valueMappingsOverrideProcessor:()=>N.xT,valueMatchers:()=>je.hI,vectorator:()=>jn.E,withLoadingIndicator:()=>X.k});var t=e(67414),n=e(78368),i=e(85404),s=e(37471),r=e(14236),g=e(61443),a=e(19845),c=e(9631),o=e(33948),h=e(89667),f=e(21423),d=e(77789),p=e(52622),m=e(54479),v=e(21),l=e(36663),y=e(80997),u=e(89550),D=e(65463),E=e(18226),x=e(69129),P=e(8066),b=e(66670),M=e(47737),O=e(90708),I=e(92461),T=e(28240),C=e(58563),S=e(56323),A=e(57875),L=e(69550),N=e(27310),F=e(60264),w=e(39306),B=e(71733),U=e(76885),K=e(6709),V=e(87885),H=e(92341),Y=e(28802),X=e(72495),J=e(62398),q=e(92053),ae=e(43659),j=e(80147),te=e(83077),ne=e(22391),le=e(95344),z=e(72436),ee=e(8249),se=e(97706),ie=e(92041);const Z=["#7EB26D","#EAB839","#6ED0E0","#EF843C","#E24D42","#1F78C1","#BA43A9","#705DA0","#508642","#CCA300","#447EBC","#C15C17","#890F02","#0A437C","#6D1F62","#584477","#B7DBAB","#F4D598","#70DBED","#F9BA8F","#F29191","#82B5D8","#E5A8E2","#AEA2E0","#629E51","#E5AC0E","#64B0C8","#E0752D","#BF1B00","#0A50A1","#962D82","#614D93","#9AC48A","#F2C96D","#65C5DB","#F9934E","#EA6460","#5195CE","#D683CE","#806EB7","#3F6833","#967302","#2F575E","#99440A","#58140C","#052B51","#511749","#3F2B5B","#E0F9D7","#FCEACA","#CFFAFF","#F9E2D2","#FCE2DE","#BADFF4","#F9D9F9","#DEDAF7"],oe=ys=>{let Ps,es,_s=Number.MAX_VALUE;for(let ca=0;ca<ys.values.length;ca++){const Ks=ys.values[ca];if(Ps!==void 0){const Zs=Ks-Ps;es===void 0&&(_s=Zs),Zs<_s&&(_s=Zs)}Ps=Ks}return _s},ce=ys=>{for(let Ps=0;Ps<ys.values.length;Ps++){const es=ys.values[Ps];if(es!=null){const _s=es.toString();if(_s.length===13&&_s%1e3!==0)return!0}}return!1};var ye=e(11710),re=e(27618),ue=e(25352),De=e(50877),ge=e(14588),Te=e(68941),Le=e(7144),Ye=e(57934),je=e(85200),Ze=e(18282),Ne=e(1173),Pe=e(75059),Ue=e(2514),$e=e(97497),ze=e(58972),qe=e(73060),dt=e(77678),vt=e(50311),yt=e(46294),st=e(39624),Ve=e(96915),pe=e(75972),Ee=e(97594),me=e(23596),ve=e(60578),Se=e(83195),Ie=e(85858),Oe=e(65879),Re=e(1933),he=e(47232),Ce=e(91410),We=e(42994),et=e(72724),rt=e(53531),nt=e(70416),gt=e(19484),xt=e(65158),St=e(581),zt=e(28528),Nt=e(13834),Vt=e(76287),en=e(92470),Je=e(95187),ct=e(51527),ot=e(8887),Qe=e(43585),pt=e(29505),Pt=e(26272),At=e(62625),mn=e(25137),Pn=e(24293),fn=e(12470),Rn=e(50082),Kn=e(55004),Bt=e(74135),an=e(37891),tn=e(43429),Cn=e(47070),xn=e(40187),Vn=e(41987),Et=e(35853),Ft=e(37055),Gt=e(81010),ln=e(25019),qt=e(43127),cn=e(64388),En=e(9557),Sn=e(8790),Tn=e(73372),Wn=e(94624),Nn=e(91890),Tt=e(41260),Wt=e(11261),jt=e(39070),ut=e(58649),Zt=e(36120),jn=e(18008);const Xn="ArrayVector is deprecated and will be removed in Grafana 11. Please use plain arrays for field.values.";let Qn=!1;class Fn extends Array{get buffer(){return this}set buffer(Ps){this.length=0;const es=Ps?.length;if(es){let _s=65e3,ca=Math.ceil(es/_s);for(let Ks=0;Ks<ca;Ks++)this.push.apply(this,Ps.slice(Ks*_s,(Ks+1)*_s))}}constructor(Ps){super(),this.buffer=Ps??[],Qn||(console.warn(Xn),Qn=!0)}toJSON(){return[...this]}}var qn=e(33526),js=e(29263)},96915:(k,R,e)=>{"use strict";e.d(R,{l:()=>n});var t=e(83077);const n=new t.O},65158:(k,R,e)=>{"use strict";e.d(R,{m:()=>c});var t=e(2543),n=e.n(t),i=e(66670),s=e(43429),r=e(60264),g=e(95344),a=e(28528);class c extends s.Ud{constructor(h){super(),this._fieldConfigDefaults={defaults:{},overrides:[]},this._initConfigRegistry=()=>new i.K,this.dataSupport={annotations:!1,alertStates:!1},this.panel=h}get defaults(){let h=this._defaults||{};if(!this._defaults&&this.optionsSupplier){const f=new r.pv;this.optionsSupplier(f,{data:[]});for(const d of f.getItems())d.defaultValue!=null&&(0,t.set)(h,d.path,d.defaultValue)}return h}get fieldConfigDefaults(){const h=this._fieldConfigDefaults.defaults;h.custom={};for(const f of this.fieldConfigRegistry.list())f.defaultValue!==void 0&&(0,t.set)(h,f.id,f.defaultValue);return{defaults:{...h},overrides:this._fieldConfigDefaults.overrides}}setDefaults(h){return(0,g.l)("PanelPlugin","setDefaults","setPanelOptions"),this._defaults=h,this}get fieldConfigRegistry(){return this._fieldConfigRegistry||(this._fieldConfigRegistry=this._initConfigRegistry()),this._fieldConfigRegistry}setEditor(h){return(0,g.l)("PanelPlugin","setEditor","setPanelOptions"),this.editor=h,this}setNoPadding(){return this.noPadding=!0,this}setMigrationHandler(h){return this.onPanelMigration=h,this}setPanelChangeHandler(h){return this.onPanelTypeChanged=h,this}setPanelOptions(h){return this.optionsSupplier=h,this}getPanelOptionsSupplier(){return this.optionsSupplier??(()=>{})}setDataSupport(h){return this.dataSupport={...this.dataSupport,...h},this}useFieldConfig(h={}){return this._initConfigRegistry=()=>(0,a.O)(h,this.meta.name),this}setSuggestionsSupplier(h){return this.suggestionsSupplier=h,this}getSuggestionsSupplier(){return this.suggestionsSupplier}hasPluginId(h){return this.meta.id===h}}},581:(k,R,e)=>{"use strict";e.d(R,{F:()=>a,H9:()=>p,TQ:()=>m,aW:()=>o,nx:()=>v});var t=e(2543),n=e.n(t),i=e(8066),s=e(24293),r=e(37055),g=e(50082);function a({plugin:l,currentOptions:y,currentFieldConfig:u,isAfterPluginChange:D}){const E=(0,t.mergeWith)({},l.defaults,y||{},(b,M)=>{if((0,t.isArray)(M))return M}),x=c(u,l),P=f(l,x,D);return{options:E,fieldConfig:P}}function c(l,y){const u=y.fieldConfigDefaults,D={defaults:(0,t.mergeWith)({},u.defaults,l?l.defaults:{},(E,x)=>{if((0,t.isArray)(x))return x}),overrides:l?.overrides??[]};h(D.defaults,"",y.fieldConfigRegistry),D.defaults.thresholds&&d(D.defaults.thresholds),D.overrides=o(D.overrides,E=>y.fieldConfigRegistry.getIfExists(E.id)!==void 0);for(const E of D.overrides)for(const x of E.properties)x.id==="thresholds"&&d(x.value);return D}function o(l,y){return l.map(u=>{const D=u.properties.filter(y);return{...u,properties:D}})}function h(l,y,u){let D=!1;for(const[E,x]of Object.entries(l)){const P=`${y}${E}`,b=!!u.getIfExists(P);if(b){D=!0;continue}(0,t.isArray)(x)||!(0,t.isObject)(x)?b||(0,t.unset)(l,E):h(x,`${P}.`,u)||(0,t.unset)(l,E)}return D}function f(l,y,u){if(!u)return y;const D=l.fieldConfigRegistry.getIfExists(r.uo.Color);if(D&&D.settings){const E=D.settings,x=i.uf.getIfExists(y.defaults.color?.mode);if(!E.byValueSupport&&(!x||x.isByValue))return y.defaults.color={mode:s.Y.PaletteClassic},y;if(E.byValueSupport&&E.preferThresholdsMode&&x?.id!==s.Y.Fixed&&(!x||!x.isByValue))return y.defaults.color={mode:s.Y.Thresholds},y;if(E.bySeriesSupport&&x?.isByValue)return y.defaults.color={mode:s.Y.PaletteClassic},y}return y}function d(l){l.mode||(l.mode=g.O.Absolute),l.steps?l.steps.length&&(l.steps[0].value=-1/0):l.steps=[]}function p(l,y){const u={defaults:{...l.defaults,custom:y.defaults.custom},overrides:[...l.overrides]};for(const D of y.overrides)for(const E of D.properties)if(m(E)){const x=u.overrides.find(P=>(0,t.isEqual)(P.matcher,D.matcher));x?x!==D&&x.properties.push(E):u.overrides.push(D)}return u}function m(l){return l.id.startsWith("custom.")}function v(l){return!m(l)}},28528:(k,R,e)=>{"use strict";e.d(R,{O:()=>s});var t=e(66670),n=e(69550),i=e(60264);function s(g={},a){const c=new t.K,o=n.G.list(),h={};if(g.useCustomConfig){const f=new i.bk;g.useCustomConfig(f);for(const d of f.getRegistry().list())if(d.isCustom=!0,d.id="custom."+d.id,r(d,o)){const p=h[d.category[0]]??[];p.push(d),h[d.category[0]]=p}else c.register(d)}for(let f of o){const d=f.id;if(!(g.disableStandardOptions&&g.disableStandardOptions.indexOf(d)>-1)){if(g.standardOptions){const p=g.standardOptions[d]?.hideFromDefaults,m=g.standardOptions[d]?.defaultValue,v=g.standardOptions[d]?.settings;p&&(f={...f,hideFromDefaults:p}),m&&(f={...f,defaultValue:m}),v&&(f={...f,settings:f.settings?{...f.settings,...v}:v})}if(c.register(f),f.category&&h[f.category[0]])for(let p of h[f.category[0]])c.register(p)}}for(const f of c.list())if(f.path.indexOf("[")>0)throw new Error(`[${a}] Field config paths do not support arrays: ${f.id}`);return c}function r(g,a){return!!a.find(c=>g.category&&c.category&&g.category[0]===c.category[0])}},77789:(k,R,e)=>{"use strict";e.d(R,{M:()=>t});const t=i=>{for(let s=0;;s++){const r=n(s);if(!i.some(g=>g.refId===r))return r}};function n(i){const s="ABCDEFGHIJKLMNOPQRSTUVWXYZ";return i<s.length?s[i]:n(Math.floor(i/s.length)-1)+s[i%s.length]}},29263:(k,R,e)=>{"use strict";e.d(R,{Fj:()=>i,T6:()=>n,ZU:()=>t,jW:()=>s});function t(r,g){return!!g.permissions?.[r]}function n(r,g){return!!g.accessControl?.[r]}function i(r,g){return r.every(a=>t(a,g))}function s(r,g){return r.some(a=>t(a,g))}},67414:(k,R,e)=>{"use strict";e.d(R,{F:()=>i,c:()=>n});var t=e(9631);function n(s,r){let[g]=s,[a]=r,c=g.length,o=g[0],h=g[c-1],f=a.length,d=a[0],p=a[f-1],m;if(c)if(f){if(d>h)m=s.map((v,l)=>s[l].concat(r[l]));else if(p<o)m=r.map((v,l)=>r[l].concat(s[l]));else if(d<=o&&p>=h)m=r;else if(d>o&&p<h){let v=(0,t.Ls)(d,g);v=g[v]<d?v+1:v;let l=(0,t.Ls)(p,g);l=g[l]>p?l-1:l,m=s.map((y,u)=>s[u].slice(0,v).concat(r[u]).concat(s[u].slice(l+1)))}else if(d>=o){let v=(0,t.Ls)(d,g);v=g[v]<d?v-1:v,m=s.map((l,y)=>s[y].slice(0,v).concat(r[y]))}else if(p>=o){let v=(0,t.Ls)(p,g);v=g[v]<p?v:v+1,m=r.map((l,y)=>r[y].concat(s[y].slice(v)))}}else m=s;else f?m=r:m=[[]];return m}function i(s,r,g){let[a,...c]=s,o,h;return a[0]<r&&(o=(0,t.Ls)(r,a),a[o]<r&&o++),a[a.length-1]>g&&(h=(0,t.Ls)(g,a),a[h]>g&&h--),(o!=null||h!=null)&&(a=a.slice(o??0,h),c=c.map(f=>f.slice(o??0,h))),[a,...c]}},36663:(k,R,e)=>{"use strict";e.d(R,{G:()=>g,P:()=>a});var t=e(60023),n=e(33836),i=e(80997);let s=!1;const r={pedantic:!1,gfm:!0,breaks:!1};function g(c,o){s||(t.xI.use((0,n.z)()),t.xI.setOptions({...r}),s=!0);let h;o?.breaks&&(h={...r,breaks:!0});const f=(0,t.xI)(c||"",h);if(typeof f!="string")throw new Error("Failed to process markdown synchronously.");return o?.noSanitize?f:(0,i.G$)(f)}function a(c,o){s||(t.xI.use((0,n.z)()),t.xI.setOptions({...r}),s=!0);const h=(0,t.xI)(c||"");if(typeof h!="string")throw new Error("Failed to process markdown synchronously.");return o?.noSanitize?h:(0,i.G$)(h)}},80997:(k,R,e)=>{"use strict";e.d(R,{G$:()=>f,Jf:()=>p,aj:()=>c,sQ:()=>l});var t=e(16750),n=e(42838),i=e.n(n),s=e(34005),r=e.n(s);const g=Object.keys(s.whiteList).reduce((y,u)=>(y[u]=s.whiteList[u]?.concat(["class","style"]),y),{}),a=new s.FilterXSS({whiteList:g,css:{whiteList:{...s.getDefaultCSSWhiteList(),"flex-direction":!0,"flex-wrap":!0,"flex-basis":!0,"flex-grow":!0,"flex-shrink":!0,"flex-flow":!0,gap:!0,order:!0,"justify-content":!0,"justify-items":!0,"justify-self":!0,"align-items":!0,"align-content":!0,"align-self":!0}}});function c(y){try{return i().sanitize(y,{USE_PROFILES:{html:!0},FORBID_TAGS:["form","input"]})}catch{return console.error("String could not be sanitized",y),v(y)}}function o(y){return i().sanitize(y,{RETURN_TRUSTED_TYPE:!0,ADD_ATTR:["xmlns:atom","version","property","content"],ADD_TAGS:["rss","meta","channel","title","link","description","atom:link","item","pubDate","guid"],PARSER_MEDIA_TYPE:"application/xhtml+xml"})}function h(y){return i().sanitize(y,{RETURN_TRUSTED_TYPE:!0})}function f(y){try{return a.process(y)}catch{return console.error("String could not be sanitized",y),"Text string could not be sanitized"}}function d(y){return i().sanitize(y,{USE_PROFILES:{svg:!0,svgFilters:!0}})}function p(y){return(0,t.J)(y)}function m(y){return/\u001b\[\d{1,2}m/.test(y)}function v(y){return String(y).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")}const l={escapeHtml:v,hasAnsiCodes:m,sanitize:c,sanitizeTextPanelContent:f,sanitizeUrl:p,sanitizeSVGContent:d,sanitizeTrustedTypes:h,sanitizeTrustedTypesRSS:o}},54479:(k,R,e)=>{"use strict";e.d(R,{$D:()=>m,$f:()=>l,AP:()=>o,MX:()=>v,dO:()=>h,dc:()=>f,jD:()=>a,kT:()=>d,vb:()=>p,xb:()=>c});var t=e(2543),n=e.n(t);const s="([\\"+["(","[","{","}","]",")","\\","|","*","+","-",".","?","<",">","#","&","^","$"].join("\\")+"])",r=new RegExp(s,"g"),g=new RegExp("(\\\\)"+s,"g");function a(y){return y&&y.replace(r,"\\$1")}function c(y){return y&&y.replace(g,"$2")}function o(y){return y?y[0]==="/":!1}function h(y){if(!o(y))return new RegExp(`^${y}$`);const u=y.match(new RegExp("^/(.*?)/(g?i?m?y?s?)$"));if(!u)throw new Error(`'${y}' is not a valid regular expression.`);return new RegExp(u[1],u[2])}function f(y){if(!y)return 0;const u=parseInt(y,10),D=y.slice(String(u).length),E=1e3,x=E*60,P=x*60,b=P*24;switch(D){case"s":return u*E;case"m":return u*x;case"h":return u*P;case"d":return u*b;default:if(!D)return isNaN(u)?0:u;throw new Error("Not supported unit: "+D)}}function d(y){return y!=null&&Number.isFinite(y)?y.toString():""}function p(y){if(!y)return;const u=parseInt(y,10);return isNaN(u)?void 0:u}function m(y){if(!y)return;const u=parseFloat(y);return isNaN(u)?void 0:u}function v(y){const u=(0,t.camelCase)(y);return u.charAt(0).toUpperCase()+u.substring(1)}function l(y){return y.replace(/[\\^$*+?.()|[\]{}\/]/g,"\\$&")}},21:(k,R,e)=>{"use strict";e.d(R,{Oq:()=>t,bQ:()=>g,bs:()=>i});function t({searchWords:a,textToHighlight:c}){const o=[];for(const h of a)typeof h=="string"&&o.push(...i(c,h));return o}const n=a=>a.replace(/[[{(][\w,.\/:;<=>?:*+]+$/,"");function i(a,c){if(!a||!c)return[];const o=[],{cleaned:h,flags:f}=g(n(c));let d;try{d=new RegExp(`(?:${h})`,f)}catch{return o}return a.replace(d,(p,...m)=>{if(p){const v=m[m.length-2];o.push({text:p,start:v,length:p.length,end:v+p.length})}return""}),o}const s="-",r=/\(\?([ims-]+)\)/g;function g(a){const c=new Set(["g"]);return{cleaned:a.replace(r,(h,f)=>{const d=f.startsWith(s);for(let p=0;p<f.length;++p){const m=f.charAt(p);d||f.charAt(p-1)===s?c.delete(m):m!==s&&c.add(m)}return""}),flags:Array.from(c).join("")}}},23596:(k,R,e)=>{"use strict";e.d(R,{MV:()=>y,X4:()=>m,a:()=>l,e$:()=>v,eM:()=>f,tL:()=>p,ze:()=>g});var t=e(84140);function n(u,D=0,E=1){return Math.min(Math.max(D,u),E)}function i(u){u=u.slice(1);const D=new RegExp(`.{1,${u.length>=6?2:1}}`,"g");let E=u.match(D);if(!E)return"";let x=Array.from(E);return x[0].length===1&&(x=x.map(P=>P+P)),x?`rgb${x.length===4?"a":""}(${x.map((P,b)=>b<3?parseInt(P,16):Math.round(parseInt(P,16)/255*1e3)/1e3).join(", ")})`:""}function s(u){const D=u.toString(16);return D.length===1?`0${D}`:D}function r(u){if(u.indexOf("#")===0)return u;const{values:D}=o(u);return`#${D.map(E=>s(E)).join("")}`}function g(u){if(u[0]==="#")return u;const D=(0,t.A)(u);return D.getAlpha()===1?D.toHexString():D.toHex8String()}function a(u){return u.startsWith("rgb")?u:(0,t.A)(u).toRgbString()}function c(u){const D=o(u),{values:E}=D,x=E[0],P=E[1]/100,b=E[2]/100,M=P*Math.min(b,1-b),O=(C,S=(C+x/30)%12)=>b-M*Math.max(Math.min(S-3,9-S,1),-1);let I="rgb";const T=[Math.round(O(0)*255),Math.round(O(8)*255),Math.round(O(4)*255)];return D.type==="hsla"&&(I+="a",T.push(E[3])),h({type:I,values:T})}function o(u){if(typeof u!="string")return u;if(u.charAt(0)==="#")return o(i(u));const D=u.indexOf("("),E=u.substring(0,D);if(["rgb","rgba","hsl","hsla","color"].indexOf(E)===-1)throw new Error(`Unsupported '${u}' color. The following formats are supported: #nnn, #nnnnnn, rgb(), rgba(), hsl(), hsla(), color()`);let x=u.substring(D+1,u.length-1),P;if(E==="color"){if(x=x.split(" "),P=x.shift(),x.length===4&&x[3].charAt(0)==="/"&&(x[3]=x[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(P)===-1)throw new Error(`Unsupported ${P} color space. The following color spaces are supported: srgb, display-p3, a98-rgb, prophoto-rgb, rec-2020.`)}else x=x.split(",");return x=x.map(b=>parseFloat(b)),{type:E,values:x,colorSpace:P}}function h(u){const{type:D,colorSpace:E}=u;let x=u.values;return D.indexOf("rgb")!==-1?x=x.map((P,b)=>b<3?parseInt(P,10):P):D.indexOf("hsl")!==-1&&(x[1]=`${x[1]}%`,x[2]=`${x[2]}%`),D.indexOf("color")!==-1?x=`${E} ${x.join(" ")}`:x=`${x.join(", ")}`,`${D}(${x})`}function f(u,D,E){const x=d(u),P=d(D,E);return(Math.max(x,P)+.05)/(Math.min(x,P)+.05)}function d(u,D){const E=o(u);let x=E.type==="hsl"?o(c(u)).values:E.values;if(D&&E.type==="rgba"){const b=o(D),M=x[3];x[0]=x[0]*M+b.values[0]*(1-M),x[1]=x[1]*M+b.values[1]*(1-M),x[2]=x[2]*M+b.values[2]*(1-M)}const P=x.map(b=>(E.type!=="color"&&(b/=255),b<=.03928?b/12.92:((b+.055)/1.055)**2.4));return Number((.2126*P[0]+.7152*P[1]+.0722*P[2]).toFixed(3))}function p(u,D=.15){return d(u)>.5?v(u,D):l(u,D)}function m(u,D){if(u==="")return"#000000";if(D=n(D),u[0]==="#"){if(u.length===9)u=u.substring(0,7);else if(u.length<=5){let x="#";for(let P=1;P<4;P++)x+=u[P]+u[P];u=x}return u+Math.round(D*255).toString(16).padStart(2,"0")}else{if(u[3]==="(")return u.replace(")",`, ${D})`);if(u[4]==="(")return u.substring(0,u.lastIndexOf(","))+`, ${D})`}const E=o(u);return E.type==="color"?E.values[3]=`/${D}`:E.values[3]=D,h(E)}function v(u,D){const E=o(u);if(D=n(D),E.type.indexOf("hsl")!==-1)E.values[2]*=1-D;else if(E.type.indexOf("rgb")!==-1||E.type.indexOf("color")!==-1)for(let x=0;x<3;x+=1)E.values[x]*=1-D;return h(E)}function l(u,D){const E=o(u);if(D=n(D),E.type.indexOf("hsl")!==-1)E.values[2]+=(100-E.values[2])*D;else if(E.type.indexOf("rgb")!==-1)for(let x=0;x<3;x+=1)E.values[x]+=(255-E.values[x])*D;else if(E.type.indexOf("color")!==-1)for(let x=0;x<3;x+=1)E.values[x]+=(1-E.values[x])*D;return h(E)}const y={clamp:n,hexToRgb:i,rgbToHex:r,asHexString:g,asRgbString:a,hslToRgb:c,decomposeColor:o,recomposeColor:h,getContrastRatio:f,getLuminance:d,emphasize:p,alpha:m,darken:v,lighten:l}},60578:(k,R,e)=>{"use strict";e.d(R,{D:()=>i});var t=e(96540),n=e(75972);const i=(0,t.createContext)((0,n.a)());i.displayName="ThemeContext"},75972:(k,R,e)=>{"use strict";e.d(R,{a:()=>F});function t(){const B=["xs","sm","md","lg","xl","xxl"],U="px",K={xs:0,sm:544,md:769,lg:992,xl:1200,xxl:1440};function V(Y){return`@media (min-width:${typeof Y=="number"?Y:K[Y]}${U})`}function H(Y){return`@media (max-width:${(typeof Y=="number"?Y:K[Y])-5/100}${U})`}return{values:K,up:V,down:H,keys:B,unit:U}}var n=e(2543),i=e(23596);const s={white:"#FFFFFF",black:"#000000",gray25:"#2c3235",gray15:"#22252b",gray10:"#181b1f",gray05:"#111217",darkLayer0:"#18181A",darkLayer1:"#212124",darkLayer2:"#2a2a2f",darkBorder1:"#34343B",darkBorder2:"#64646B",gray90:"#F4F5F5",gray100:"#F4F5F5",gray80:"#D0D1D3",lightBorder1:"#E4E7E7",blueDarkMain:"#3D71D9",blueDarkText:"#6E9FFF",redDarkMain:"#D10E5C",redDarkText:"#FF5286",greenDarkMain:"#1A7F4B",greenDarkText:"#6CCF8E",orangeDarkMain:"#FF9900",orangeDarkText:"#fbad37",blueLightMain:"#3871DC",blueLightText:"#1F62E0",redLightMain:"#E0226E",redLightText:"#CF0E5B",greenLightMain:"#1B855E",greenLightText:"#0A764E",orangeLightMain:"#FF9900",orangeLightText:"#B5510D"};class r{constructor(){this.mode="dark",this.whiteBase="204, 204, 220",this.border={weak:`rgba(${this.whiteBase}, 0.12)`,medium:`rgba(${this.whiteBase}, 0.20)`,strong:`rgba(${this.whiteBase}, 0.30)`},this.text={primary:`rgb(${this.whiteBase})`,secondary:`rgba(${this.whiteBase}, 0.65)`,disabled:`rgba(${this.whiteBase}, 0.6)`,link:s.blueDarkText,maxContrast:s.white},this.primary={main:s.blueDarkMain,text:s.blueDarkText,border:s.blueDarkText},this.secondary={main:`rgba(${this.whiteBase}, 0.10)`,shade:`rgba(${this.whiteBase}, 0.14)`,transparent:`rgba(${this.whiteBase}, 0.08)`,text:this.text.primary,contrastText:`rgb(${this.whiteBase})`,border:`rgba(${this.whiteBase}, 0.08)`},this.info=this.primary,this.error={main:s.redDarkMain,text:s.redDarkText},this.success={main:s.greenDarkMain,text:s.greenDarkText},this.warning={main:s.orangeDarkMain,text:s.orangeDarkText},this.background={canvas:s.gray05,primary:s.gray10,secondary:s.gray15},this.action={hover:`rgba(${this.whiteBase}, 0.16)`,selected:`rgba(${this.whiteBase}, 0.12)`,selectedBorder:s.orangeDarkMain,focus:`rgba(${this.whiteBase}, 0.16)`,hoverOpacity:.08,disabledText:this.text.disabled,disabledBackground:`rgba(${this.whiteBase}, 0.04)`,disabledOpacity:.38},this.gradients={brandHorizontal:"linear-gradient(270deg, #F55F3E 0%, #FF8833 100%)",brandVertical:"linear-gradient(0.01deg, #F55F3E 0.01%, #FF8833 99.99%)"},this.contrastThreshold=3,this.hoverFactor=.03,this.tonalOffset=.15}}class g{constructor(){this.mode="light",this.blackBase="36, 41, 46",this.primary={main:s.blueLightMain,border:s.blueLightText,text:s.blueLightText},this.text={primary:`rgba(${this.blackBase}, 1)`,secondary:`rgba(${this.blackBase}, 0.75)`,disabled:`rgba(${this.blackBase}, 0.64)`,link:this.primary.text,maxContrast:s.black},this.border={weak:`rgba(${this.blackBase}, 0.12)`,medium:`rgba(${this.blackBase}, 0.30)`,strong:`rgba(${this.blackBase}, 0.40)`},this.secondary={main:`rgba(${this.blackBase}, 0.08)`,shade:`rgba(${this.blackBase}, 0.15)`,transparent:`rgba(${this.blackBase}, 0.08)`,contrastText:`rgba(${this.blackBase},  1)`,text:this.text.primary,border:this.border.weak},this.info={main:s.blueLightMain,text:s.blueLightText},this.error={main:s.redLightMain,text:s.redLightText,border:s.redLightText},this.success={main:s.greenLightMain,text:s.greenLightText},this.warning={main:s.orangeLightMain,text:s.orangeLightText},this.background={canvas:s.gray90,primary:s.white,secondary:s.gray100},this.action={hover:`rgba(${this.blackBase}, 0.12)`,selected:`rgba(${this.blackBase}, 0.08)`,selectedBorder:s.orangeLightMain,hoverOpacity:.08,focus:`rgba(${this.blackBase}, 0.12)`,disabledBackground:`rgba(${this.blackBase}, 0.04)`,disabledText:this.text.disabled,disabledOpacity:.38},this.gradients={brandHorizontal:"linear-gradient(90deg, #FF8833 0%, #F53E4C 100%)",brandVertical:"linear-gradient(0.01deg, #F53E4C -31.2%, #FF8833 113.07%)"},this.contrastThreshold=3,this.hoverFactor=.03,this.tonalOffset=.2}}function a(w){const B=new r,U=new g,K=(w.mode??"dark")==="dark"?B:U,{primary:V=K.primary,secondary:H=K.secondary,info:Y=K.info,warning:X=K.warning,success:J=K.success,error:q=K.error,tonalOffset:ae=K.tonalOffset,hoverFactor:j=K.hoverFactor,contrastThreshold:te=K.contrastThreshold,...ne}=w;function le(ee,se=te){return(0,i.eM)(B.text.maxContrast,ee,K.background.primary)>=se?B.text.maxContrast:U.text.maxContrast}const z=({color:ee,name:se})=>{if(ee={...ee,name:se},!ee.main)throw new Error(`Missing main color for ${se}`);return ee.text||(ee.text=ee.main),ee.border||(ee.border=ee.text),ee.shade||(ee.shade=K.mode==="light"?(0,i.e$)(ee.main,ae):(0,i.a)(ee.main,ae)),ee.transparent||(ee.transparent=(0,i.X4)(ee.main,.15)),ee.contrastText||(ee.contrastText=le(ee.main)),ee.borderTransparent||(ee.borderTransparent=(0,i.X4)(ee.border,.25)),ee};return(0,n.merge)({...K,primary:z({color:V,name:"primary"}),secondary:z({color:H,name:"secondary"}),info:z({color:Y,name:"info"}),error:z({color:q,name:"error"}),success:z({color:J,name:"success"}),warning:z({color:X,name:"warning"}),getContrastText:le,emphasize:(ee,se)=>(0,i.tL)(ee,se??j)},ne)}function c(w,B){const U={padding:1,headerHeight:4,background:w.background.primary,borderColor:w.border.weak,boxShadow:"none"},K={borderColor:w.border.medium,borderHover:w.border.strong,text:w.text.primary,background:w.mode==="dark"?w.background.canvas:w.background.primary};return{height:{sm:3,md:4,lg:6},input:K,panel:U,dropdown:{background:K.background},tooltip:{background:w.background.secondary,text:w.text.primary},dashboard:{background:w.background.canvas,padding:1},overlay:{background:w.mode==="dark"?"rgba(63, 62, 62, 0.45)":"rgba(208, 209, 211, 0.24)"},sidemenu:{width:57},menuTabs:{height:42},textHighlight:{text:w.warning.contrastText,background:w.warning.main},horizontalDrawer:{defaultHeight:400},table:{rowHoverBackground:w.action.hover,rowSelected:w.action.selected}}}function o(w){return w.mode==="dark"?{z1:"0px 1px 2px rgba(1, 4, 9, 0.75)",z2:"0px 4px 8px rgba(1, 4, 9, 0.75)",z3:"0px 8px 24px rgb(1, 4, 9)"}:{z1:"0px 1px 2px rgba(24, 26, 27, 0.2)",z2:"0px 4px 8px rgba(24, 26, 27, 0.2)",z3:"0px 13px 20px 1px rgba(24, 26, 27, 0.18)"}}function h(w){const B=w.borderRadius??2;return{radius:{default:"2px",pill:"9999px",circle:"100%"},borderRadius:V=>`${(V??1)*B}px`}}function f(w={}){const{gridSize:B=8}=w,U=V=>typeof V=="string"?V:V*B,K=(...V)=>(V.length===0&&(V[0]=1),V.map(H=>{const Y=U(H);return typeof Y=="number"?`${Y}px`:Y}).join(" "));return K.gridSize=B,K.x0="0px",K.x0_25="2px",K.x0_5="4px",K.x1="8px",K.x1_5="12px",K.x2="16px",K.x2_5="20px",K.x3="24px",K.x4="32px",K.x5="40px",K.x6="48px",K.x8="64px",K.x10="80px",K}const d={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},p={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function m(w=["all"],B={}){const{duration:U=p.standard,easing:K=d.easeInOut,delay:V=0}=B;return(Array.isArray(w)?w:[w]).map(H=>`${H} ${typeof U=="string"?U:y(U)} ${K} ${typeof V=="string"?V:y(V)}`).join(",")}function v(...w){return w.map(B=>`@media (prefers-reduced-motion: ${B})`).join(",")}function l(w){if(!w)return 0;const B=w/36;return Math.round((4+15*B**.25+B/5)*10)}function y(w){return`${Math.round(w)}ms`}function u(){return{create:m,duration:p,easing:d,getAutoHeightDuration:l,handleMotion:v}}const D='"Inter", "Helvetica", "Arial", sans-serif',E="'Roboto Mono', monospace";function x(w,B={}){const{fontFamily:U=D,fontFamilyMonospace:K=E,fontSize:V=14,fontWeightLight:H=300,fontWeightRegular:Y=400,fontWeightMedium:X=500,fontWeightBold:J=500,htmlFontSize:q=14}=B,ae=V/14,j=z=>`${z/q*ae}rem`,te=(z,ee,se,ie,Z)=>{if(se%2!==0||ee%2!==0)throw new Error("Font size and line height should be integer multiples of 2 to prevent issues with alignment");return{fontFamily:U,fontWeight:z,fontSize:j(ee),lineHeight:se/ee,...U===D?{letterSpacing:`${P(ie/ee)}em`}:{},...Z}},ne={h1:te(Y,28,32,-.25),h2:te(Y,24,28,0),h3:te(Y,22,24,0),h4:te(Y,18,22,.25),h5:te(Y,16,22,0),h6:te(X,14,22,.15),body:te(Y,V,22,.15),bodySmall:te(Y,12,18,.15),code:{...te(Y,14,16,.15),fontFamily:K}};return{htmlFontSize:q,pxToRem:j,fontFamily:U,fontFamilyMonospace:K,fontSize:V,fontWeightLight:H,fontWeightRegular:Y,fontWeightMedium:X,fontWeightBold:J,size:{base:"14px",xs:"10px",sm:"12px",md:"14px",lg:"18px"},...ne}}function P(w){return Math.round(w*1e5)/1e5}var b=e(25137);function M(w){const B={name:"Grafana Default",typography:{fontFamily:{sansSerif:w.typography.fontFamily,monospace:w.typography.fontFamilyMonospace},size:{base:`${w.typography.fontSize}px`,xs:w.typography.size.xs,sm:w.typography.size.sm,md:w.typography.size.md,lg:w.typography.size.lg},heading:{h1:w.typography.h1.fontSize,h2:w.typography.h2.fontSize,h3:w.typography.h3.fontSize,h4:w.typography.h4.fontSize,h5:w.typography.h5.fontSize,h6:w.typography.h6.fontSize},weight:{light:w.typography.fontWeightLight,regular:w.typography.fontWeightRegular,semibold:w.typography.fontWeightMedium,bold:w.typography.fontWeightBold},lineHeight:{xs:w.typography.bodySmall.lineHeight,sm:w.typography.bodySmall.lineHeight,md:w.typography.body.lineHeight,lg:w.typography.h2.lineHeight},link:{decoration:"none",hoverDecoration:"none"}},breakpoints:{xs:`${w.breakpoints.values.xs}px`,sm:`${w.breakpoints.values.sm}px`,md:`${w.breakpoints.values.md}px`,lg:`${w.breakpoints.values.lg}px`,xl:`${w.breakpoints.values.xl}px`,xxl:`${w.breakpoints.values.xxl}px`},spacing:{base:w.spacing.gridSize,insetSquishMd:w.spacing(.5,1),d:w.spacing(2),xxs:w.spacing(.25),xs:w.spacing(.5),sm:w.spacing(1),md:w.spacing(2),lg:w.spacing(3),xl:w.spacing(4),gutter:w.spacing(4),formSpacingBase:w.spacing.gridSize,formMargin:`${w.spacing.gridSize*4}px`,formFieldsetMargin:`${w.spacing.gridSize*2}px`,formInputHeight:w.spacing.gridSize*4,formButtonHeight:w.spacing.gridSize*4,formInputPaddingHorizontal:`${w.spacing.gridSize}px`,formInputAffixPaddingHorizontal:`${w.spacing.gridSize/2}px`,formInputMargin:`${w.spacing.gridSize*2}px`,formLabelPadding:"0 0 0 2px",formLabelMargin:`0 0 ${w.spacing.gridSize/2+"px"} 0`,formValidationMessagePadding:"4px 8px",formValidationMessageMargin:"4px 0 0 0",inlineFormMargin:"4px"},border:{radius:{sm:w.shape.borderRadius(1),md:w.shape.borderRadius(2),lg:w.shape.borderRadius(3)},width:{sm:"1px"}},height:{sm:w.spacing.gridSize*w.components.height.sm,md:w.spacing.gridSize*w.components.height.md,lg:w.spacing.gridSize*w.components.height.lg},panelPadding:w.components.panel.padding*w.spacing.gridSize,panelHeaderHeight:w.spacing.gridSize*w.components.panel.headerHeight,zIndex:w.zIndex},U={...O,black:"#000000",white:"#ffffff",dark1:"#141414",dark2:"#161719",dark3:"#1f1f20",dark4:"#212124",dark5:"#222426",dark6:"#262628",dark7:"#292a2d",dark8:"#2f2f32",dark9:"#343436",dark10:"#424345",gray1:"#555555",gray2:"#8e8e8e",gray3:"#b3b3b3",gray4:"#d8d9da",gray5:"#ececec",gray6:"#f4f5f8",gray7:"#fbfbfb",redBase:"#e02f44",redShade:"#c4162a",greenBase:"#299c46",greenShade:"#23843b",red:"#d44a3a",yellow:"#ecbb13",purple:"#9933cc",variable:"#32d1df",orange:"#eb7b18",orangeDark:"#ff780a"},K={bg1:w.colors.background.primary,bg2:w.colors.background.secondary,bg3:w.colors.action.hover,dashboardBg:w.colors.background.canvas,bgBlue1:w.colors.primary.main,bgBlue2:w.colors.primary.shade},V={border1:w.colors.border.weak,border2:w.colors.border.medium,border3:w.colors.border.strong},H={textStrong:w.colors.text.maxContrast,textHeading:w.colors.text.primary,text:w.colors.text.primary,textSemiWeak:w.colors.text.secondary,textWeak:w.colors.text.secondary,textFaint:w.colors.text.disabled,textBlue:w.colors.primary.text},Y={formLabel:w.colors.text.primary,formDescription:w.colors.text.secondary,formInputBg:w.components.input.background,formInputBgDisabled:w.colors.action.disabledBackground,formInputBorder:w.components.input.borderColor,formInputBorderHover:w.components.input.borderHover,formInputBorderActive:w.colors.primary.border,formInputBorderInvalid:w.colors.error.border,formInputPlaceholderText:w.colors.text.disabled,formInputText:w.components.input.text,formInputDisabledText:w.colors.action.disabledText,formFocusOutline:w.colors.primary.main,formValidationMessageText:w.colors.error.contrastText,formValidationMessageBg:w.colors.error.main};return{...B,type:w.colors.mode==="dark"?b.I.Dark:b.I.Light,isDark:w.isDark,isLight:w.isLight,name:w.name,palette:{...U,brandPrimary:U.orange,brandSuccess:w.colors.success.main,brandWarning:w.colors.warning.main,brandDanger:w.colors.error.main,queryRed:w.colors.error.text,queryGreen:w.colors.success.text,queryPurple:"#fe85fc",queryOrange:U.orange,online:w.colors.success.main,warn:w.colors.success.main,critical:w.colors.success.main},colors:{...K,...V,...Y,...H,bodyBg:w.colors.background.canvas,panelBg:w.components.panel.background,panelBorder:w.components.panel.borderColor,pageHeaderBg:w.colors.background.canvas,pageHeaderBorder:w.colors.background.canvas,dropdownBg:Y.formInputBg,dropdownShadow:U.black,dropdownOptionHoverBg:K.bg2,link:w.colors.text.primary,linkDisabled:w.colors.text.disabled,linkHover:w.colors.text.maxContrast,linkExternal:w.colors.text.link},shadows:{listItem:"none"},visualization:w.visualization}}const O={gray98:"#f7f8fa",gray97:"#f1f5f9",gray95:"#e9edf2",gray90:"#dce1e6",gray85:"#c7d0d9",gray70:"#9fa7b3",gray60:"#7b8087",gray33:"#464c54",gray25:"#2c3235",gray15:"#202226",gray10:"#141619",gray05:"#0b0c0e",blue95:"#5794f2",blue85:"#33a2e5",blue80:"#3274d9",blue77:"#1f60c4",red88:"#e02f44"};var I=e(24293);function T(w){const B=w.mode==="light"?S():C(),U={};for(const H of B)for(const Y of H.shades)if(U[Y.name]=Y.color,Y.aliases)for(const X of Y.aliases)U[X]=Y.color;U.transparent=w.mode==="light"?"rgba(255, 255, 255, 0)":"rgba(0,0,0,0)",U["panel-bg"]=w.background.primary,U.text=w.text.primary;const K=H=>{if(!H)return I.F;const Y=U[H];if(Y)return Y;if(H[0]==="#"||H.indexOf("rgb")>-1)return H;const X=L[H.toLowerCase()];return X?(U[H]=X,X):H},V=A();return{hues:B,palette:V,getColorByName:K}}function C(){return[{name:"red",shades:[{color:"#FFA6B0",name:"super-light-red"},{color:"#FF7383",name:"light-red"},{color:"#F2495C",name:"red",primary:!0},{color:"#E02F44",name:"semi-dark-red"},{color:"#C4162A",name:"dark-red"}]},{name:"orange",shades:[{color:"#FFCB7D",name:"super-light-orange",aliases:[]},{color:"#FFB357",name:"light-orange",aliases:[]},{color:"#FF9830",name:"orange",aliases:[],primary:!0},{color:"#FF780A",name:"semi-dark-orange",aliases:[]},{color:"#FA6400",name:"dark-orange",aliases:[]}]},{name:"yellow",shades:[{color:"#FFF899",name:"super-light-yellow",aliases:[]},{color:"#FFEE52",name:"light-yellow",aliases:[]},{color:"#FADE2A",name:"yellow",aliases:[],primary:!0},{color:"#F2CC0C",name:"semi-dark-yellow",aliases:[]},{color:"#E0B400",name:"dark-yellow",aliases:[]}]},{name:"green",shades:[{color:"#C8F2C2",name:"super-light-green",aliases:[]},{color:"#96D98D",name:"light-green",aliases:[]},{color:"#73BF69",name:"green",aliases:[],primary:!0},{color:"#56A64B",name:"semi-dark-green",aliases:[]},{color:"#37872D",name:"dark-green",aliases:[]}]},{name:"blue",shades:[{color:"#C0D8FF",name:"super-light-blue",aliases:[]},{color:"#8AB8FF",name:"light-blue",aliases:[]},{color:"#5794F2",name:"blue",aliases:[],primary:!0},{color:"#3274D9",name:"semi-dark-blue",aliases:[]},{color:"#1F60C4",name:"dark-blue",aliases:[]}]},{name:"purple",shades:[{color:"#DEB6F2",name:"super-light-purple",aliases:[]},{color:"#CA95E5",name:"light-purple",aliases:[]},{color:"#B877D9",name:"purple",aliases:[],primary:!0},{color:"#A352CC",name:"semi-dark-purple",aliases:[]},{color:"#8F3BB8",name:"dark-purple",aliases:[]}]}]}function S(){return[{name:"red",shades:[{color:"#FF7383",name:"super-light-red"},{color:"#F2495C",name:"light-red"},{color:"#E02F44",name:"red",primary:!0},{color:"#C4162A",name:"semi-dark-red"},{color:"#AD0317",name:"dark-red"}]},{name:"orange",shades:[{color:"#FFB357",name:"super-light-orange",aliases:[]},{color:"#FF9830",name:"light-orange",aliases:[]},{color:"#FF780A",name:"orange",aliases:[],primary:!0},{color:"#FA6400",name:"semi-dark-orange",aliases:[]},{color:"#E55400",name:"dark-orange",aliases:[]}]},{name:"yellow",shades:[{color:"#FFEE52",name:"super-light-yellow",aliases:[]},{color:"#FADE2A",name:"light-yellow",aliases:[]},{color:"#F2CC0C",name:"yellow",aliases:[],primary:!0},{color:"#E0B400",name:"semi-dark-yellow",aliases:[]},{color:"#CC9D00",name:"dark-yellow",aliases:[]}]},{name:"green",shades:[{color:"#96D98D",name:"super-light-green",aliases:[]},{color:"#73BF69",name:"light-green",aliases:[]},{color:"#56A64B",name:"green",aliases:[],primary:!0},{color:"#37872D",name:"semi-dark-green",aliases:[]},{color:"#19730E",name:"dark-green",aliases:[]}]},{name:"blue",shades:[{color:"#8AB8FF",name:"super-light-blue",aliases:[]},{color:"#5794F2",name:"light-blue",aliases:[]},{color:"#3274D9",name:"blue",aliases:[],primary:!0},{color:"#1F60C4",name:"semi-dark-blue",aliases:[]},{color:"#1250B0",name:"dark-blue",aliases:[]}]},{name:"purple",shades:[{color:"#CA95E5",name:"super-light-purple",aliases:[]},{color:"#B877D9",name:"light-purple",aliases:[]},{color:"#A352CC",name:"purple",aliases:[],primary:!0},{color:"#8F3BB8",name:"semi-dark-purple",aliases:[]},{color:"#7C2EA3",name:"dark-purple",aliases:[]}]}]}function A(){return["green","semi-dark-yellow","light-blue","semi-dark-orange","red","blue","purple","#705DA0","dark-green","yellow","#447EBC","#C15C17","#890F02","#0A437C","#6D1F62","#584477","#B7DBAB","#F4D598","#70DBED","#F9BA8F","#F29191","#82B5D8","#E5A8E2","#AEA2E0","#629E51","#E5AC0E","#64B0C8","#E0752D","#BF1B00","#0A50A1","#962D82","#614D93","#9AC48A","#F2C96D","#65C5DB","#F9934E","#EA6460","#5195CE","#D683CE","#806EB7","#3F6833","#967302","#2F575E","#99440A","#58140C","#052B51","#511749","#3F2B5B","#E0F9D7","#FCEACA","#CFFAFF","#F9E2D2","#FCE2DE","#BADFF4","#F9D9F9","#DEDAF7"]}const L={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},N={activePanel:999,navbarFixed:1e3,sidemenu:1020,dropdown:1030,typeahead:1030,tooltip:1040,modalBackdrop:1050,modal:1060,portal:1061};function F(w={}){const{colors:B={},spacing:U={},shape:K={},typography:V={}}=w,H=a(B),Y=t(),X=f(U),J=h(K),q=x(H,V),ae=o(H),j=u(),te=c(H,ae),ne=T(H),le={name:H.mode==="dark"?"Dark":"Light",isDark:H.mode==="dark",isLight:H.mode==="light",colors:H,breakpoints:Y,spacing:X,shape:J,components:te,typography:q,shadows:ae,transitions:j,visualization:ne,zIndex:{...N},flags:{}};return{...le,v1:M(le)}}},97594:(k,R,e)=>{"use strict";e.d(R,{g:()=>i,k:()=>s});var t=e(83077),n=e(75972);function i(o){return(r.getIfExists(o)??r.get("dark")).build()}function s(o){return r.list().filter(h=>o?!0:!h.isExtra)}const r=new t.O(()=>[{id:"system",name:"System preference",build:g},{id:"dark",name:"Dark",build:()=>(0,n.a)({colors:{mode:"dark"}})},{id:"light",name:"Light",build:()=>(0,n.a)({colors:{mode:"light"}})},{id:"blue-night",name:"Blue night",build:c,isExtra:!0},{id:"midnight",name:"Midnight",build:a,isExtra:!0}]);function g(){const h=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";return i(h)}function a(){const o="204, 204, 220";return(0,n.a)({name:"Midnight",colors:{mode:"dark",background:{canvas:"#000000",primary:"#000000",secondary:"#181818"},border:{weak:`rgba(${o}, 0.17)`,medium:`rgba(${o}, 0.25)`,strong:`rgba(${o}, 0.35)`}}})}function c(){return(0,n.a)({name:"Blue night",colors:{mode:"dark",background:{canvas:"#15161d",primary:"#15161d",secondary:"#1d1f2e"},border:{weak:"#2e304f",medium:"#2e304f",strong:"#2e304f"}}})}},75059:(k,R,e)=>{"use strict";e.d(R,{AS:()=>o,C6:()=>f,Em:()=>a,H3:()=>d,Nw:()=>c,gy:()=>g});var t=e(2543),n=e.n(t),i=e(39070),s=e(11261),r=e(83077),g=(x=>(x.sum="sum",x.max="max",x.min="min",x.logmin="logmin",x.mean="mean",x.variance="variance",x.stdDev="stdDev",x.last="last",x.median="median",x.first="first",x.count="count",x.range="range",x.diff="diff",x.diffperc="diffperc",x.delta="delta",x.step="step",x.firstNotNull="firstNotNull",x.lastNotNull="lastNotNull",x.changeCount="changeCount",x.distinctCount="distinctCount",x.allIsZero="allIsZero",x.allIsNull="allIsNull",x.allValues="allValues",x.uniqueValues="uniqueValues",x.p1="p1",x.p2="p2",x.p3="p3",x.p4="p4",x.p5="p5",x.p6="p6",x.p7="p7",x.p8="p8",x.p9="p9",x.p10="p10",x.p11="p11",x.p12="p12",x.p13="p13",x.p14="p14",x.p15="p15",x.p16="p16",x.p17="p17",x.p18="p18",x.p19="p19",x.p20="p20",x.p21="p21",x.p22="p22",x.p23="p23",x.p24="p24",x.p25="p25",x.p26="p26",x.p27="p27",x.p28="p28",x.p29="p29",x.p30="p30",x.p31="p31",x.p32="p32",x.p33="p33",x.p34="p34",x.p35="p35",x.p36="p36",x.p37="p37",x.p38="p38",x.p39="p39",x.p40="p40",x.p41="p41",x.p42="p42",x.p43="p43",x.p44="p44",x.p45="p45",x.p46="p46",x.p47="p47",x.p48="p48",x.p49="p49",x.p50="p50",x.p51="p51",x.p52="p52",x.p53="p53",x.p54="p54",x.p55="p55",x.p56="p56",x.p57="p57",x.p58="p58",x.p59="p59",x.p60="p60",x.p61="p61",x.p62="p62",x.p63="p63",x.p64="p64",x.p65="p65",x.p66="p66",x.p67="p67",x.p68="p68",x.p69="p69",x.p70="p70",x.p71="p71",x.p72="p72",x.p73="p73",x.p74="p74",x.p75="p75",x.p76="p76",x.p77="p77",x.p78="p78",x.p79="p79",x.p80="p80",x.p81="p81",x.p82="p82",x.p83="p83",x.p84="p84",x.p85="p85",x.p86="p86",x.p87="p87",x.p88="p88",x.p89="p89",x.p90="p90",x.p91="p91",x.p92="p92",x.p93="p93",x.p94="p94",x.p95="p95",x.p96="p96",x.p97="p97",x.p98="p98",x.p99="p99",x))(g||{});function a(x){return Object.keys(g).includes(x)}function c(x){const{field:P,reducers:b}=x;if(!P||!b||b.length<1)return{};if(P.state?.calcs){const A=[];for(const L of b)P.state.calcs.hasOwnProperty(L)||A.push(L);if(A.length<1)return{...P.state.calcs}}P.state||(P.state={});const M=o.list(b),O=P.values;if(O&&O.length<1){const A={...P.state.calcs};for(const L of M)A[L.id]=L.emptyInputResult!==null?L.emptyInputResult:null;return P.state.calcs=A}const{nullValueMode:I=i.UW.Ignore}=P.config,T=I===i.UW.Ignore,C=I===i.UW.AsZero;if(M.length===1&&M[0].reduce){const A=M[0].reduce(P,T,C);return P.state.calcs={...P.state.calcs,...A},A}let S=d(P,T,C);for(const A of M)!S.hasOwnProperty(A.id)&&A.reduce&&(S={...S,...A.reduce(P,T,C)});return P.state.calcs={...P.state.calcs,...S},S}const o=new r.O(()=>[{id:"lastNotNull",name:"Last *",description:"Last non-null value (also excludes NaNs)",standard:!0,aliasIds:["current"],reduce:l,preservesUnits:!0},{id:"last",name:"Last",description:"Last value",standard:!0,reduce:v,preservesUnits:!0},{id:"firstNotNull",name:"First *",description:"First non-null value (also excludes NaNs)",standard:!0,reduce:m,preservesUnits:!0},{id:"first",name:"First",description:"First Value",standard:!0,reduce:p,preservesUnits:!0},{id:"min",name:"Min",description:"Minimum Value",standard:!0,preservesUnits:!0},{id:"max",name:"Max",description:"Maximum Value",standard:!0,preservesUnits:!0},{id:"mean",name:"Mean",description:"Average Value",standard:!0,aliasIds:["avg"],preservesUnits:!0},{id:"median",name:"Median",description:"Median Value",standard:!0,aliasIds:["median"],preservesUnits:!0},{id:"variance",name:"Variance",description:"Variance of all values in a field",standard:!1,reduce:y,preservesUnits:!0},{id:"stdDev",name:"StdDev",description:"Standard deviation of all values in a field",standard:!1,reduce:y,preservesUnits:!0},{id:"sum",name:"Total",description:"The sum of all values",emptyInputResult:0,standard:!0,aliasIds:["total"],preservesUnits:!0},{id:"count",name:"Count",description:"Number of values in response",emptyInputResult:0,standard:!0,preservesUnits:!1},{id:"range",name:"Range",description:"Difference between minimum and maximum values",standard:!0,preservesUnits:!0},{id:"delta",name:"Delta",description:"Cumulative change in value",standard:!0,preservesUnits:!0},{id:"step",name:"Step",description:"Minimum interval between values",standard:!0,preservesUnits:!0},{id:"diff",name:"Difference",description:"Difference between first and last values",standard:!0,preservesUnits:!0},{id:"logmin",name:"Min (above zero)",description:"Used for log min scale",standard:!0,preservesUnits:!0},{id:"allIsZero",name:"All Zeros",description:"All values are zero",emptyInputResult:!1,standard:!0,preservesUnits:!0},{id:"allIsNull",name:"All Nulls",description:"All values are null",emptyInputResult:!0,standard:!0,preservesUnits:!1},{id:"changeCount",name:"Change Count",description:"Number of times the value changes",standard:!1,reduce:u,preservesUnits:!1},{id:"distinctCount",name:"Distinct Count",description:"Number of distinct values",standard:!1,reduce:D,preservesUnits:!1},{id:"diffperc",name:"Difference percent",description:"Percentage difference between first and last values",standard:!0,preservesUnits:!1},{id:"allValues",name:"All values",description:"Returns an array with all values",standard:!1,reduce:x=>({allValues:[...x.values]}),preservesUnits:!1},{id:"uniqueValues",name:"All unique values",description:"Returns an array with all unique values",standard:!1,reduce:x=>({uniqueValues:[...new Set(x.values)]}),preservesUnits:!1},...h()]),h=(x=[...Array.from({length:99},(P,b)=>b+1)])=>{const P=[],b=M=>M>3&&M<21?"th":M%10===1?"st":M%10===2?"nd":M%10===3?"rd":"th";return x.forEach(M=>{const O=M/100,I=`p${M}`,T=`${M}${b(M)} %`,C=`${M}${b(M)} percentile value`;P.push({id:I,name:T,description:C,standard:!1,reduce:(S,A,L)=>({[I]:E(S,O,A,L)}),preservesUnits:!0})}),P},f={sum:0,max:-Number.MAX_VALUE,min:Number.MAX_VALUE,logmin:Number.MAX_VALUE,mean:null,last:null,first:null,lastNotNull:null,firstNotNull:null,count:0,nonNullCount:0,allIsNull:!0,allIsZero:!0,range:null,diff:null,delta:0,step:Number.MAX_VALUE,diffperc:0,previousDeltaUp:!0};function d(x,P,b){const M={...f},O=x.values;if(!O)return M;const I=x.type===s.PU.number||x.type===s.PU.time;for(let T=0;T<O.length;T++){let C=O[T];if(T===0&&(M.first=C),M.last=C,C==null){if(P)continue;b&&(C=0)}if(M.count++,C!=null&&!Number.isNaN(C)){const S=M.firstNotNull===null;if(S&&(M.firstNotNull=C),I){if(M.sum+=C,M.allIsNull=!1,M.nonNullCount++,!S){const A=C-M.lastNotNull;M.step>A&&(M.step=A),M.lastNotNull>C?(M.previousDeltaUp=!1,T===O.length-1&&(M.delta+=C)):(M.previousDeltaUp?M.delta+=A:M.delta+=C,M.previousDeltaUp=!0)}C>M.max&&(M.max=C),C<M.min&&(M.min=C),C<M.logmin&&C>0&&(M.logmin=C)}C!==0&&(M.allIsZero=!1),M.lastNotNull=C}}return M.max===-Number.MAX_VALUE&&(M.max=null),M.min===Number.MAX_VALUE&&(M.min=null),M.step===Number.MAX_VALUE&&(M.step=null),M.nonNullCount>0&&(M.mean=M.sum/M.nonNullCount),M.allIsNull&&(M.allIsZero=!1),M.max!==null&&M.min!==null&&(M.range=M.max-M.min),(0,t.isNumber)(M.firstNotNull)&&(0,t.isNumber)(M.lastNotNull)&&(M.diff=M.lastNotNull-M.firstNotNull),(0,t.isNumber)(M.firstNotNull)&&(0,t.isNumber)(M.diff)&&(M.diffperc=M.diff/M.firstNotNull*100),M}function p(x,P,b){return{first:x.values[0]}}function m(x,P,b){const M=x.values;for(let O=0;O<M.length;O++){const I=M[O];if(I!=null&&!Number.isNaN(I))return{firstNotNull:I}}return{firstNotNull:null}}function v(x,P,b){const M=x.values;return{last:M[M.length-1]}}function l(x,P,b){const M=x.values;let O=M.length-1;for(;O>=0;){const I=M[O--];if(I!=null&&!Number.isNaN(I))return{lastNotNull:I}}return{lastNotNull:null}}function y(x,P,b){if(!(x.type===s.PU.number||x.type===s.PU.time))return{variance:0,stdDev:0};let M=0,O=0,I=0;const T=x.values;for(let C=0;C<T.length;C++){const S=T[C];if(S!=null){I++;let A=O;O+=(S-A)/I,M+=(S-A)*(S-O)}}if(I>0){const C=M/I;return{variance:C,stdDev:Math.sqrt(C)}}return{variance:0,stdDev:0}}function u(x,P,b){const M=x.values;let O=0,I=!0,T=null;for(let C=0;C<M.length;C++){let S=M[C];if(S===null){if(P)continue;b&&(S=0)}!I&&T!==S&&O++,I=!1,T=S}return{changeCount:O}}function D(x,P,b){const M=x.values,O=new Set;for(let I=0;I<M.length;I++){let T=M[I];if(T===null){if(P)continue;b&&(T=0)}O.add(T)}return{distinctCount:O.size}}function E(x,P,b,M){let O=x.values;b&&(O=O.filter(C=>C!==null)),M&&(O=O.map(C=>C===null?0:C));const I=O.slice().sort((C,S)=>C-S),T=Math.round((I.length-1)*P);return I[T]}},85200:(k,R,e)=>{"use strict";e.d(R,{Dq:()=>u,NS:()=>y,RE:()=>v,hI:()=>l,kK:()=>D,sJ:()=>m});var t=e(83077),n=e(7029),i=e(24814),s=e(58972),r=e(72693),g=e(8549),a=e(83855),c=e(60005),o=e(21262),h=e(70218),f=e(55008),d=e(16378),p=e(75754);const m=new t.O(()=>[...(0,r.nz)(),...(0,n._)(),...(0,s.P7)(),...(0,a.W)(),i.u]),v=new t.O(()=>[...(0,r.UM)(),...(0,s.Y7)(),...(0,g.i)()]),l=new t.O(()=>[...(0,o._)(),...(0,h.E)(),...(0,c.d)(),...(0,p.m)(),...(0,f.G)(),...(0,d.z)()]);function y(E){const x=m.get(E.id);if(!x)throw new Error("Unknown field matcher: "+E.id);return x.get(E.options)}function u(E){const x=v.get(E.id);if(!x)throw new Error("Unknown frame matcher: "+E.id);return x.get(E.options)}function D(E){const x=l.get(E.id);if(!x)throw new Error("Unknown value matcher: "+E.id);return x.get(E.options)}},58972:(k,R,e)=>{"use strict";e.d(R,{P7:()=>m,PP:()=>r,Y7:()=>v});var t=e(28240),n=e(54479),i=e(11261),s=e(1173),r=(l=>(l.exclude="exclude",l.include="include",l))(r||{});const g={id:s.Ct.byName,name:"Field Name",description:"match the field name",defaultOptions:"",get:l=>{const u=c(new Set([l]));return(D,E,x)=>l===D.name||l===(0,t.Ct)(D,E,x)||!!(u&&u(D,E,x))},getOptionsDisplayText:l=>`Field name: ${l}`},a={id:s.Ct.byNames,name:"Field Names",description:"match any of the given the field names",defaultOptions:{mode:"include",names:[]},get:l=>{const{names:y,mode:u="include"}=l,D=new Set(y??[]),E=c(D),x=(P,b,M)=>D.has(P.name)||D.has((0,t.Ct)(P,b,M))||!!(E&&E(P,b,M));return u==="exclude"?(P,b,M)=>!x(P,b,M):x},getOptionsDisplayText:l=>{const{names:y,mode:u}=l,D=(y??[]).join(", ");return u==="exclude"?`All except: ${D}`:`All of: ${D}`}};function c(l){let y;return window?.grafanaBootData?.settings?.featureToggles?.dataplaneFrontendFallback&&(l.has(i.Bc)?y=(D,E)=>!!D.labels&&D.labels?.__name__===D.name:(l.has("Time")||l.has("time"))&&(y=(D,E)=>E.meta?.typeVersion==null&&D.type===i.PU.time)),y}const o={id:s.Ct.byRegexp,name:"Field Name by Regexp",description:"match the field name by a given regexp pattern",defaultOptions:"/.*/",get:l=>{const y=d(l);return(u,D,E)=>{const x=(0,t.Ct)(u,D,E);return!!y&&y.test(x)}},getOptionsDisplayText:l=>`Field name by pattern: ${l}`},h={id:s.Ct.byFrameRefID,name:"Fields by frame refId",description:"match all fields returned in data frame with refId.",defaultOptions:"",get:l=>(y,u,D)=>u.refId===l,getOptionsDisplayText:l=>`Math all fields returned by query with reference ID: ${l}`},f={id:s.Ct.byRegexpOrNames,name:"Field Name by Regexp or Names",description:"match the field name by a given regexp pattern or given names",defaultOptions:{pattern:"/.*/",names:[]},get:l=>{const y=o.get(l?.pattern||""),u=a.get({mode:"include",names:l?.names??[]});return(D,E,x)=>u(D,E,x)||y(D,E,x)},getOptionsDisplayText:l=>{const y=l?.pattern??"",u=l?.names?.join(",")??"";return`Field name by pattern: ${y} or names: ${u}`}},d=l=>{if(l)try{return(0,n.dO)(l)}catch(y){console.error(y);return}},p={id:s.jR.byName,name:"Frame Name",description:"match the frame name",defaultOptions:"/.*/",get:l=>{const y=(0,n.dO)(l);return u=>y.test(u.name||"")},getOptionsDisplayText:l=>`Frame name: ${l}`};function m(){return[g,o,a,f,h]}function v(){return[p]}},72693:(k,R,e)=>{"use strict";e.d(R,{UM:()=>E,Yg:()=>h,nz:()=>D,zx:()=>p});var t=e(11261),n=e(85200),i=e(1173);const s={id:i.cV.anyMatch,name:"Any",description:"Any child matches (OR)",excludeFromPicker:!0,defaultOptions:[],get:x=>{const P=x.map(b=>(0,n.NS)(b));return(b,M,O)=>{for(const I of P)if(I(b,M,O))return!0;return!1}},getOptionsDisplayText:x=>{let P="";for(const b of x){P.length>0&&(P+=" OR ");const M=n.sJ.get(b.id);P+=M.getOptionsDisplayText?M.getOptionsDisplayText(b):M.name}return P}},r={id:i.cV.anyMatch,name:"Any",description:"Any child matches (OR)",excludeFromPicker:!0,defaultOptions:[],get:x=>{const P=x.map(b=>(0,n.Dq)(b));return b=>{for(const M of P)if(M(b))return!0;return!1}},getOptionsDisplayText:x=>{let P="";for(const b of x){P.length>0&&(P+=" OR ");const M=n.RE.get(b.id);P+=M.getOptionsDisplayText?M.getOptionsDisplayText(b):M.name}return P}},g={id:i.cV.allMatch,name:"All",description:"Everything matches (AND)",excludeFromPicker:!0,defaultOptions:[],get:x=>{const P=x.map(b=>(0,n.NS)(b));return(b,M,O)=>{for(const I of P)if(!I(b,M,O))return!1;return!0}},getOptionsDisplayText:x=>{let P="";for(const b of x){P.length>0&&(P+=" AND ");const M=n.sJ.get(b.id);P+=M.getOptionsDisplayText?M.getOptionsDisplayText(b):M.name}return P}},a={id:i.cV.allMatch,name:"All",description:"Everything matches (AND)",excludeFromPicker:!0,defaultOptions:[],get:x=>{const P=x.map(b=>(0,n.Dq)(b));return b=>{for(const M of P)if(!M(b))return!1;return!0}},getOptionsDisplayText:x=>{let P="";for(const b of x){P.length>0&&(P+=" AND ");const M=n.RE.get(b.id);P+=M.getOptionsDisplayText?M.getOptionsDisplayText(b):M.name}return P}},c={id:i.cV.invertMatch,name:"NOT",description:"Inverts other matchers",excludeFromPicker:!0,get:x=>{const P=(0,n.NS)(x);return(b,M,O)=>!P(b,M,O)},getOptionsDisplayText:x=>{const P=n.sJ.get(x.id);return"NOT "+(P.getOptionsDisplayText?P.getOptionsDisplayText(x.options):P.name)}},o={id:i.cV.invertMatch,name:"NOT",description:"Inverts other matchers",excludeFromPicker:!0,get:x=>{const P=(0,n.Dq)(x);return b=>!P(b)},getOptionsDisplayText:x=>{const P=n.RE.get(x.id);return"NOT "+(P.getOptionsDisplayText?P.getOptionsDisplayText(x.options):P.name)}},h=x=>!0,f=x=>!0,d=x=>!1,p=x=>x.type!==t.PU.time,m=x=>!1,v={id:i.cV.alwaysMatch,name:"All Fields",description:"Always Match",get:x=>h,getOptionsDisplayText:x=>"Always"},l={id:i.cV.alwaysMatch,name:"All Frames",description:"Always Match",get:x=>f,getOptionsDisplayText:x=>"Always"},y={id:i.cV.neverMatch,name:"No Fields",description:"Never Match",excludeFromPicker:!0,get:x=>d,getOptionsDisplayText:x=>"Never"},u={id:i.cV.neverMatch,name:"No Frames",description:"Never Match",get:x=>m,getOptionsDisplayText:x=>"Never"};function D(){return[s,g,c,v,y]}function E(){return[r,a,o,l,u]}},97497:(k,R,e)=>{"use strict";e.d(R,{h:()=>i,m:()=>n});var t=e(83077),n=(s=>(s.Combine="combine",s.CalculateNewFields="calculateNewFields",s.CreateNewVisualization="createNewVisualization",s.Filter="filter",s.PerformSpatialOperations="performSpatialOperations",s.Reformat="reformat",s.ReorderAndRename="reorderAndRename",s))(n||{});const i=new t.O},2514:(k,R,e)=>{"use strict";e.d(R,{m:()=>o});var t=e(62467),n=e(69862),i=e(81160),s=e(85200),r=e(97497);const g=(f,d)=>p=>{const m=r.h.get(f.id);if(!m)return p;const l={...m.transformation.defaultOptions??{},...f.options},y=f.filter?.options?(0,s.Dq)(f.filter):void 0;return p.pipe((0,n.Z)(u=>(0,t.of)(a(u,y)).pipe(m.transformation.operator(l,d),c(u,m,y))))};function a(f,d){return d?f.filter(p=>d(p)):f}const c=(f,d,p)=>m=>m.pipe((0,i.T)(v=>{if(v===f)return v;if(p){let l=0;const y=f.filter((u,D)=>{const E=!p(u);return E&&!l&&(l=D),E});y.length&&v.splice(l,0,...y)}return v}));function o(f,d,p){const m=(0,t.of)(d);if(!f.length)return m;const v=[],l=p??{interpolate:y=>y};for(let y=0;y<f.length;y++){const u=f[y];if(h(u))v.push(u(l));else{if(u.disabled)continue;v.push(g(u,l))}}return m.pipe.apply(m,v)}function h(f){return typeof f=="function"}},57934:(k,R,e)=>{"use strict";e.d(R,{c:()=>ye});var t=e(66350),n=e(82150),i=e(50311),s=e(34125),r=e(64224),g=e(35602),a=e(1173),c=e(18282);const o={id:c.F.filterByRefId,name:"Filter data by query refId",description:"select a subset of results",defaultOptions:{},operator:(re,ue)=>De=>{const ge={};return re.include&&(ge.include={id:a.jR.byRefId,options:re.include}),re.exclude&&(ge.exclude={id:a.jR.byRefId,options:re.exclude}),De.pipe(r.I.operator(ge,ue))}};var h=e(73376),f=e(15400),d=e(81160),p=e(28240),m=e(81010);const v={id:c.F.formatTime,name:"Format time",description:"Set the output format of a time field",defaultOptions:{timeField:"",outputFormat:"",useTimezone:!0},isApplicable:re=>{for(const ue of re)for(const De of ue.fields)if(De.type==="time")return m.M.Applicable;return m.M.NotApplicable},isApplicableDescription:"The Format time transformation requires a time field to work. No time field could be found.",operator:(re,ue)=>De=>De.pipe((0,d.T)(ge=>l(re,ge,ue)))},l=({timeField:re,outputFormat:ue,timezone:De},ge,Te)=>!Array.isArray(ge)||ge.length===0?ge:((0,p.Fm)(ge),ue=Te?.interpolate(ue)??ue,ge.map(Le=>({...Le,fields:Le.fields.map(Ye=>(Ye.state?.displayName===re&&(Ye=(0,i.Xv)(Ye,ue,{timeZone:De})),Ye))})));var y=e(25094),u=e(68133),D=e(11261),E=e(85200);const x="Time",P="Time",b="Value",M=m.N.Empty,O=window?.grafanaBootData?.settings?.featureToggles?.dataplaneFrontendFallback,I={id:c.F.groupingToMatrix,name:"Grouping to Matrix",description:"Groups series by field and return a matrix visualisation",defaultOptions:{columnField:x,rowField:P,valueField:b},isApplicable:re=>{let ue=0;for(const De of re)ue+=De.fields.length;return ue>=3?m.M.Applicable:m.M.NotApplicable},isApplicableDescription:re=>{let ue=0;for(const De of re)ue+=De.fields.length;return`Grouping to matrix requiers at least 3 fields to work. Currently there are ${ue} fields.`},operator:(re,ue)=>De=>De.pipe((0,d.T)(ge=>{const Te=ue.interpolate(re.columnField||x),Le=ue.interpolate(re.rowField||P),Ye=ue.interpolate(re.valueField||b),je=re.emptyValue||M;if(ge.length!==1)return ge;const Ze=ge[0],Ne=C(Ze,Te),Pe=C(Ze,Le),Ue=C(Ze,Ye),$e=`${Le}\\${Te}`;if(!Ne||!Pe||!Ue)return ge;const ze=T(Ne.values),qe=T(Pe.values),dt={};for(let yt=0;yt<Ue.values.length;yt++){const st=Ne.values[yt],Ve=Pe.values[yt],pe=Ue.values[yt];dt[st]||(dt[st]={}),dt[st][Ve]=pe}const vt=[{name:$e,values:qe,type:D.PU.string,config:{}}];for(const yt of ze){let st=[];for(const Ve of qe){const pe=dt[yt][Ve]??S(je);st.push(pe)}O&&typeof yt=="number"&&(Ue.config={...Ue.config,displayNameFromDS:void 0}),vt.push({name:yt.toString(),values:st,config:Ue.config,type:Ue.type})}return[{fields:vt,length:qe.length}]}))};function T(re){const ue=new Set;for(let De=0;De<re.length;De++)ue.add(re[De]);return Array.from(ue)}function C(re,ue){for(let De=0;De<re.fields.length;De++){const ge=re.fields[De];let Te;if(O?Te=E.sJ.get(a.Ct.byName).get(ue)(ge,re,[re]):Te=ue===(0,p.Ct)(ge),Te)return ge}return null}function S(re){switch(re){case m.N.False:return!1;case m.N.True:return!0;case m.N.Null:return null;case m.N.Empty:default:return""}}var A=e(77678),L=e(41511),N=e(6829),F=e(67641);const w=10,B={id:c.F.limit,name:"Limit",description:"Limit the number of items to the top N",defaultOptions:{limitField:w},operator:(re,ue)=>De=>De.pipe((0,d.T)(ge=>{let Te=w;return re.limitField!==void 0&&(typeof re.limitField=="string"?(0,F.w)()?Te=parseInt(ue.interpolate(re.limitField),10):Te=parseInt(re.limitField,10):Te=re.limitField),ge.map(Le=>Le.length>Te?{...Le,fields:Le.fields.map(Ye=>({...Ye,values:Ye.values.slice(0,Te)})),length:Te}:Le)}))};var U=e(58140),K=e(64586),V=e(82280);const H={id:c.F.rename,name:"Rename fields by name",description:"Rename fields based on configuration given by user",defaultOptions:{renameByName:{}},operator:re=>ue=>ue.pipe((0,d.T)(De=>{const ge=Y(re.renameByName);return!Array.isArray(De)||De.length===0?De:De.map(Te=>({...Te,fields:ge(Te)}))}))},Y=re=>ue=>!re||Object.keys(re).length===0?ue.fields:ue.fields.map(De=>{const ge=(0,p.Ct)(De,ue),Te=re[ge];return typeof Te!="string"||Te.length===0?De:{...De,config:{...De.config,displayName:Te},state:{...De.state,displayName:Te}}}),X={id:c.F.organize,name:"Organize fields by name",description:"Order, filter and rename fields based on configuration given by user",defaultOptions:{excludeByName:{},indexByName:{},renameByName:{},includeByName:{}},isApplicable:re=>re.length>1?m.M.NotPossible:m.M.Applicable,operator:(re,ue)=>De=>De.pipe(g.D.operator({include:re.includeByName?{names:J(re.includeByName)}:void 0,exclude:{names:J(re.excludeByName)}},ue),V.x.operator(re,ue),H.operator(re,ue))},J=re=>re?Object.keys(re).filter(ue=>re[ue]):[];var q=e(21128),ae=e(54479);const j={id:c.F.renameByRegex,name:"Rename fields by regex",description:"Rename fields based on regular expression by users.",defaultOptions:{regex:"(.*)",renamePattern:"$1"},operator:re=>ue=>ue.pipe((0,d.T)(De=>!Array.isArray(De)||De.length===0?De:De.map(te(re))))},te=re=>ue=>{const De=(0,ae.dO)(re.regex),ge=ue.fields.map(Te=>{const Le=(0,p.Ct)(Te,ue);if(!De.test(Le))return Te;const Ye=Le.replace(De,re.renamePattern);return{...Te,config:{...Te.config,displayName:Ye},state:{...Te.state,displayName:Ye}}});return{...ue,fields:ge}};var ne=e(2543),le=e(37471),z=e(14236),ee=e(19845);const se={id:c.F.seriesToRows,name:"Series to rows",description:"Combines multiple series into a single serie and appends a column with metric name per value.",defaultOptions:{},operator:re=>ue=>ue.pipe((0,d.T)(De=>{if(!Array.isArray(De)||De.length===0||(De=De.filter(je=>je.length>0),!(0,ee.jq)(De)))return De;const ge={},Te=new Set,Le=new le.k,Ye={name:D.aI,values:[],config:{},type:D.PU.string};for(let je=0;je<De.length;je++){const Ze=De[je];for(let Ne=0;Ne<Ze.fields.length;Ne++){const Pe=Ze.fields[Ne];if(Pe.type===D.PU.time){ge[je]=Ne,Te.has(D.LE)||(Le.addField(ie(Pe,D.LE)),Le.addField(Ye),Te.add(D.LE));continue}Te.has(D.Bc)||(Le.addField(ie(Pe,D.Bc)),Te.add(D.Bc))}}for(let je=0;je<De.length;je++){const Ze=De[je];for(let Ne=0;Ne<Ze.length;Ne++){const Pe=ge[je],Ue=Pe===0?1:0;Le.add({[D.LE]:Ze.fields[Pe].values[Ne],[D.aI]:(0,p.Ri)(Ze),[D.Bc]:Ze.fields[Ue].values[Ne]})}}return[(0,z.ES)(Le,0,!0)]}))},ie=(re,ue)=>({...(0,ne.omit)(re,["values","state","labels","config","name"]),name:ue,values:[],config:{...(0,ne.omit)(re.config,["displayName","displayNameFromDS"])}}),Z={id:c.F.sortBy,name:"Sort by",description:"Sort fields in a frame.",defaultOptions:{fields:{}},operator:(re,ue)=>De=>De.pipe((0,d.T)(ge=>!Array.isArray(ge)||ge.length===0||!re?.sort?.length?ge:oe(ge,re.sort,ue)))};function oe(re,ue,De){return re.map(ge=>{const Te=ce(ge,ue,De);return Te.length&&Te[0].index!=null?(0,z.ES)(ge,Te[0].index,Te[0].desc):ge})}function ce(re,ue,De){return ue.map(ge=>ge.index!=null?ge:(0,F.w)()?{...ge,index:re.fields.findIndex(Te=>De.interpolate(ge.field)===(0,p.Ct)(Te,re))}:{...ge,index:re.fields.findIndex(Te=>ge.field===(0,p.Ct)(Te,re))})}const ye={noopTransformer:K.W,filterFieldsTransformer:r.z,filterFieldsByNameTransformer:g.D,filterFramesTransformer:r.I,filterFramesByRefIdTransformer:o,filterByValueTransformer:h.Sv,formatStringTransformer:f.yt,formatTimeTransformer:v,orderFieldsTransformer:V.x,organizeFieldsTransformer:X,reduceTransformer:q.Wj,concatenateTransformer:n.vz,calculateFieldTransformer:t.SC,joinByFieldTransformer:L.L,seriesToColumnsTransformer:L.L,seriesToRowsTransformer:se,renameFieldsTransformer:H,labelsToFieldsTransformer:N.V,ensureColumnsTransformer:s.b,groupByTransformer:y.of,sortByTransformer:Z,mergeTransformer:U.o,renameByRegexTransformer:j,histogramTransformer:A.OA,convertFieldTypeTransformer:i.zM,groupingToMatrixTransformer:I,limitTransformer:B,groupToNestedTable:u._}},66350:(k,R,e)=>{"use strict";e.d(R,{Bp:()=>y,SC:()=>b,UY:()=>l,Uj:()=>E,ip:()=>u,sw:()=>w});var t=e(2543),n=e.n(t),i=e(81160),s=e(14236),r=e(28240),g=e(39070),a=e(11261),c=e(11710),o=e(27618),h=e(75059),f=e(85200),d=e(1173),p=e(34125),m=e(18282),v=e(64586),l=(B=>(B.ReduceRow="reduceRow",B.CumulativeFunctions="cumulativeFunctions",B.WindowFunctions="windowFunctions",B.BinaryOperation="binary",B.UnaryOperation="unary",B.Index="index",B))(l||{}),y=(B=>(B.Percentage="percentage",B.Fixed="fixed",B))(y||{}),u=(B=>(B.Trailing="trailing",B.Centered="centered",B))(u||{});const D={reducer:h.gy.sum},E={reducer:h.gy.mean,windowAlignment:"trailing",windowSizeMode:"percentage",windowSize:.1},x={left:"",operator:c.k.Add,right:""},P={operator:o._.Abs,fieldName:""},b={id:m.F.calculateField,name:"Add field from calculation",description:"Use the row values to calculate a new field",defaultOptions:{mode:"reduceRow",reduce:{reducer:h.gy.sum}},operator:(B,U)=>K=>{const V=B&&B.timeSeries!==!1?p.b.operator(null,U):v.W.operator({},U);return B.alias!=null&&(B.alias=U.interpolate(B.alias)),K.pipe(V,(0,i.T)(H=>{const Y=B.mode??"reduceRow";let X;switch(Y){case"reduceRow":X=A((0,t.defaults)(B.reduce,D),H);break;case"cumulativeFunctions":X=S((0,t.defaults)(B.cumulative,D),H);break;case"windowFunctions":X=M((0,t.defaults)(B.window,E),H);break;case"unary":X=F((0,t.defaults)(B.unary,P),H);break;case"binary":const J={...B.binary,left:U.interpolate(B.binary?.left),right:U.interpolate(B.binary?.right)};X=N((0,t.defaults)(J,x),H);break;case"index":return H.map(q=>{const ae=[...Array(q.length).keys()];if(B.index?.asPercentile)for(let te=0;te<ae.length;te++)ae[te]=ae[te]/ae.length;const j={name:B.alias??"Row",type:a.PU.number,values:ae,config:B.index?.asPercentile?{unit:"percentunit"}:{}};return{...q,fields:B.replaceFields?[j]:[...q.fields,j]}})}return X?H.map(J=>{const q=X(J);if(!q)return J;const ae={name:w(B),type:a.PU.number,config:{},values:q};let j=[];if(B.replaceFields){const{timeField:te}=(0,s.KR)(J);te&&B.timeSeries!==!1?j=[te,ae]:j=[ae]}else j=[...J.fields,ae];return{...J,fields:j}}):H}))}};function M(B,U){if(B.windowSize<=0)throw new Error("Add field from calculation transformation - Window size must be larger than 0");let K=(0,f.NS)({id:d.Ct.numeric});return B.field&&(K=(0,f.NS)({id:d.Ct.byNames,options:{names:[B.field]}})),V=>{const H=Math.ceil(B.windowSize*(B.windowSizeMode==="percentage"?V.length:1));let Y=null;for(const X of V.fields)if(K(X,V,U)){Y=X;break}if(Y){if(![h.gy.mean,h.gy.stdDev,h.gy.variance].includes(B.reducer))throw new Error(`Add field from calculation transformation - Unsupported reducer: ${B.reducer}`);return B.windowAlignment==="centered"?I(V,B.reducer,Y,H):O(V,B.reducer,Y,H)}}}function O(B,U,K,V){const H=[];let Y=0,X=0;for(let J=0;J<B.length;J++)if(U===h.gy.mean){const q=K.values[J];q!=null&&(X++,Y+=q,J>V-1&&(Y-=K.values[J-V],X--)),H.push(X===0?0:Y/X)}else if(U===h.gy.variance){const q=Math.max(0,J-V+1),ae=J+1;H.push(T(K.values.slice(q,ae)))}else if(U===h.gy.stdDev){const q=Math.max(0,J-V+1),ae=J+1;H.push(C(K.values.slice(q,ae)))}return H}function I(B,U,K,V){const H=[];let Y=0,X=0;const J=Math.ceil(V/2)-1,q=Math.floor(V/2);for(let ae=0;ae<B.length;ae++){const j=ae-q,te=ae+J;if(U===h.gy.mean){if(ae===0)for(let ne=0;ne<J+1&&ne<K.values.length;ne++)K.values[ne]!=null&&(Y+=K.values[ne],X++);else te<K.values.length&&K.values[te]!=null&&(Y+=K.values[te],X++),j>0&&K.values[j-1]!=null&&(Y-=K.values[j-1],X--);H.push(X===0?0:Y/X)}else if(U===h.gy.variance){const ne=K.values.slice(Math.max(0,j),Math.min(te+1,K.values.length));H.push(T(ne))}else if(U===h.gy.stdDev){const ne=K.values.slice(Math.max(0,j),Math.min(te+1,K.values.length));H.push(C(ne))}}return H}function T(B){if(B.length<1)return 0;let U=0,K=0,V=0;for(let Y=0;Y<B.length;Y++){const X=B[Y];if(X!=null){V++;let J=K;K+=(X-J)/V,U+=(X-J)*(X-K)}}return V===0?0:U/V}function C(B){return Math.sqrt(T(B))}function S(B,U){let K=(0,f.NS)({id:d.Ct.numeric});if(B.field&&(K=(0,f.NS)({id:d.Ct.byNames,options:{names:[B.field]}})),![h.gy.mean,h.gy.sum].includes(B.reducer))throw new Error(`Add field from calculation transformation - Unsupported reducer: ${B.reducer}`);return V=>{let H=null;for(const J of V.fields)if(K(J,V,U)){H=J;break}if(!H)return;const Y=[];let X=0;for(let J=0;J<V.length;J++)X+=H.values[J]??0,B.reducer===h.gy.sum?Y.push(X):B.reducer===h.gy.mean&&Y.push(X/(J+1));return Y}}function A(B,U){let K=(0,f.NS)({id:d.Ct.numeric});B.include&&B.include.length&&(K=(0,f.NS)({id:d.Ct.byNames,options:{names:B.include}}));const V=h.AS.get(B.reducer);if(!V)throw new Error(`Unknown reducer: ${B.reducer}`);const H=V.reduce??h.H3,Y=B.nullValueMode===g.UW.Ignore,X=B.nullValueMode===g.UW.AsZero;return J=>{const q=[];for(const ne of J.fields)K(ne,J,U)&&q.push(ne.values);const ae=q.length,j={name:"temp",values:new Array(ae),type:a.PU.number,config:{}},te=[];for(let ne=0;ne<J.length;ne++){for(let le=0;le<ae;le++)j.values[le]=q[le][ne];te.push(H(j,Y,X)[B.reducer])}return te}}function L(B,U,K){if(!U)return;for(const H of B.fields)if(U===(0,r.Ct)(H,B,K))return H.type===a.PU.boolean?H.values.map(Y=>Y?1:0):H.values;const V=parseFloat(U);if(!isNaN(V))return new Array(B.length).fill(V)}function N(B,U){const K=c.b.getIfExists(B.operator);return V=>{const H=L(V,B.left,U),Y=L(V,B.right,U);if(!H||!Y||!K)return;const X=new Array(H.length);for(let J=0;J<X.length;J++)X[J]=K.operation(H[J],Y[J]);return X}}function F(B,U){const K=o.j.getIfExists(B.operator);return V=>{let H=[];for(const X of V.fields)B.fieldName===(0,r.Ct)(X,V,U)&&X.type===a.PU.number&&(H=X.values);if(!H.length||!K)return;const Y=new Array(H.length);for(let X=0;X<Y.length;X++)Y[X]=K.operation(H[X]);return Y}}function w(B){if(B.alias?.length)return B.alias;switch(B.mode){case"cumulativeFunctions":{const{cumulative:U}=B;return`cumulative ${U?.reducer??""}${U?.field?`(${U.field})`:""}`}case"windowFunctions":{const{window:U}=B;return`${U?.windowAlignment??""} moving ${U?.reducer??""}${U?.field?`(${U.field})`:""}`}case"unary":{const{unary:U}=B;return`${U?.operator??""}${U?.fieldName?`(${U.fieldName})`:""}`}case"binary":{const{binary:U}=B;return`${U?.left??""} ${U?.operator??""} ${U?.right??""}`.replace(/\$/g,"")}case"reduceRow":{const U=h.AS.getIfExists(B.reduce?.reducer);if(U)return U.name}break;case"index":return"Row"}return"math"}},82150:(k,R,e)=>{"use strict";e.d(R,{vz:()=>r,x1:()=>s});var t=e(81160),n=e(11261),i=e(18282),s=(a=>(a.Drop="drop",a.FieldName="field",a.Label="label",a))(s||{});const r={id:i.F.concatenate,name:"Concatenate fields",description:"Combine all fields into a single frame.  Values will be appended with undefined values if not the same length.",defaultOptions:{frameNameMode:"field",frameNameLabel:"frame"},operator:a=>c=>c.pipe((0,t.T)(o=>!Array.isArray(o)||o.length<2?o:[g(o,a)]))};function g(a,c){let o=!0,h=a[0].length;const f=c.frameNameLabel??"frame";let d=[];for(const p of a){h!==p.length&&(o=!1,h=Math.max(h,p.length));for(const m of p.fields){const v={...m};v.state=void 0,p.name&&(c.frameNameMode==="drop"||(c.frameNameMode==="label"?(v.labels={...m.labels},v.labels[f]=p.name):!v.name||v.name===n.Bc?v.name=p.name:v.name=`${p.name} \xB7 ${m.name}`)),d.push(v)}}return o||(d=d.map(p=>{if(p.values.length===h)return p;const m=p.values.slice();return m.length=h,{...p,values:m}})),{fields:d,length:h}}},50311:(k,R,e)=>{"use strict";e.d(R,{Xv:()=>m,ks:()=>l,s7:()=>o,zM:()=>a});var t=e(81160),n=e(53531),i=e(11261),s=e(85200),r=e(1173),g=e(18282);const a={id:g.F.convertFieldType,name:"Convert field type",description:"Convert a field to a specified field type.",defaultOptions:{fields:{},conversions:[{targetField:void 0,destinationType:void 0,dateFormat:void 0,timezone:void 0}]},operator:(u,D)=>E=>E.pipe((0,t.T)(x=>a.transformer(u,D)(x))),transformer:u=>D=>!Array.isArray(D)||D.length===0?D:c(u,D)??[]};function c(u,D){if(!u.conversions.length)return D;const E=D.map(x=>({...x}));for(const x of u.conversions){if(!x.targetField)continue;const P=s.sJ.get(r.Ct.byName).get(x.targetField);for(const b of E)b.fields=b.fields.map(M=>P(M,b,E)?o(M,x):M)}return E}function o(u,D){switch(D.destinationType){case i.PU.time:return l(u,D.dateFormat);case i.PU.number:return d(u);case i.PU.string:return m(u,D.dateFormat,{timeZone:D.timezone},D.joinWith);case i.PU.boolean:return p(u);case i.PU.enum:return y(u,D.enumConfig);case i.PU.other:return v(u);default:return u}}const h=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:\.\d{3,})?(?:Z|[-+]\d{2}:?\d{2})$/;function f(u,D){let E=D?{format:D}:void 0;const x=u.values.slice();let P=x.find(M=>M!=null),b=typeof P=="string"&&h.test(P);for(let M=0;M<x.length;M++)if(x[M]){let O=b?Date.parse(x[M]):(0,n.b)(x[M],E).valueOf();x[M]=Number.isFinite(O)?O:null}else x[M]=null;return{...u,type:i.PU.time,values:x}}function d(u){const D=u.values.slice(),E=D.some(x=>typeof x=="string");for(let x=0;x<D.length;x++){let P=D[x];E&&P!=null&&typeof P=="string"&&(P=P.replace(/,/g,""));const b=+P;D[x]=Number.isFinite(b)?b:null}return{...u,type:i.PU.number,values:D}}function p(u){const D=u.values.slice();for(let E=0;E<D.length;E++)D[E]=!!D[E];return{...u,type:i.PU.boolean,values:D}}function m(u,D,E,x){let P=u.values;switch(u.type){case i.PU.time:P=P.map(b=>(0,n.b)(b,E).format(D));break;case i.PU.other:P=P.map(b=>x?.length&&Array.isArray(b)?b.join(x):JSON.stringify(b));break;default:P=P.map(b=>`${b}`)}return{...u,type:i.PU.string,values:P}}function v(u){const D=u.values.slice();for(let E=0;E<D.length;E++)try{D[E]=JSON.parse(D[E])}catch{D[E]=null}return{...u,type:i.PU.other,values:D}}function l(u,D){const E=typeof u.values[0]=="number";return u.type===i.PU.time&&E?u:E?{...u,type:i.PU.time}:f(u,D)}function y(u,D){const E={...D},x=u.values.slice(),P=new Map;if(E.text&&E.text.length>0)for(let b=0;b<E.text.length;b++)P.set(E.text[b],b);else return u;for(let b=0;b<x.length;b++){const M=x[b];x[b]=P.get(M)}return{...u,config:{...u.config,type:{enum:E}},type:i.PU.enum,values:x}}},34125:(k,R,e)=>{"use strict";e.d(R,{b:()=>r});var t=e(81160),n=e(14236),i=e(18282),s=e(41511);const r={id:i.F.ensureColumns,name:"Ensure Columns Transformer",description:"Will check if current data frames is series or columns. If in series it will convert to columns.",operator:(a,c)=>o=>o.pipe((0,t.T)(h=>r.transformer(a,c)(h))),transformer:(a,c)=>o=>{const h=g(o);return o.length>1&&h?s.L.transformer({byField:h},c)(o):o}};function g(a){let c;for(const o of a){const{timeField:h}=(0,n.KR)(o);if(!h)return;if(!c)c=h.name;else if(c!==h.name)return}return c}},64224:(k,R,e)=>{"use strict";e.d(R,{I:()=>g,z:()=>r});var t=e(81160),n=e(85200),i=e(18282),s=e(64586);const r={id:i.F.filterFields,name:"Filter Fields",description:"select a subset of fields",defaultOptions:{},operator:(a,c)=>o=>!a.include&&!a.exclude?o.pipe(s.W.operator({},c)):(typeof a.include?.options=="string"?a.include.options=c.interpolate(a.include?.options):typeof a.include?.options?.pattern=="string"&&(a.include.options.pattern=c.interpolate(a.include?.options.pattern)),typeof a.exclude?.options=="string"?a.exclude.options=c.interpolate(a.exclude?.options):typeof a.exclude?.options?.pattern=="string"&&(a.exclude.options.pattern=c.interpolate(a.exclude?.options.pattern)),o.pipe((0,t.T)(h=>{const f=a.include?(0,n.NS)(a.include):null,d=a.exclude?(0,n.NS)(a.exclude):null,p=[];for(const m of h){const v=[];for(let y=0;y<m.fields.length;y++){const u=m.fields[y];if(d){if(d(u,m,h))continue;f||v.push(u)}f&&f(u,m,h)&&v.push(u)}if(!v.length)continue;const l={...m,fields:v};p.push(l)}return p})))},g={id:i.F.filterFrames,name:"Filter Frames",description:"select a subset of frames",defaultOptions:{},operator:(a,c)=>o=>!a.include&&!a.exclude?o.pipe(s.W.operator({},c)):o.pipe((0,t.T)(h=>{const f=a.include?(0,n.Dq)(a.include):null,d=a.exclude?(0,n.Dq)(a.exclude):null,p=[];for(const m of h){if(d){if(d(m))continue;f||p.push(m)}f&&f(m)&&p.push(m)}return p}))}},35602:(k,R,e)=>{"use strict";e.d(R,{D:()=>s,R:()=>r});var t=e(1173),n=e(64224),i=e(18282);const s={id:i.F.filterFieldsByName,name:"Filter fields by name",description:"select a subset of fields",defaultOptions:{},operator:(g,a)=>c=>c.pipe(n.z.operator({include:r(a,g.include,g.byVariable),exclude:r(a,g.exclude,g.byVariable)},a))},r=(g,a,c)=>{if(!a)return;const{names:o,pattern:h,variable:f}=a;if(c&&f){const d=g.interpolate(f);if(/\{.*\}/.test(d)){const p=d.slice(1).slice(0,-1).split(",");return{id:t.Ct.byNames,options:{names:p}}}return{id:t.Ct.byNames,options:{names:d.split(",")}}}if(!((!Array.isArray(o)||o.length===0)&&!h))return h?!Array.isArray(o)||o.length===0?{id:t.Ct.byRegexp,options:h}:{id:t.Ct.byRegexpOrNames,options:a}:{id:t.Ct.byNames,options:{names:o}}}},73376:(k,R,e)=>{"use strict";e.d(R,{Sm:()=>o,Sv:()=>h,j4:()=>c});var t=e(81160),n=e(28240),i=e(85200),s=e(1173),r=e(18282),g=e(64586),a=e(67641),c=(p=>(p.exclude="exclude",p.include="include",p))(c||{}),o=(p=>(p.all="all",p.any="any",p))(o||{});const h={id:r.F.filterByValue,name:"Filter data by values",description:"select a subset of results based on values",defaultOptions:{filters:[],type:"include",match:"any"},operator:(p,m)=>v=>{const l=p.filters,y=p.match==="all",u=p.type==="include";if(!Array.isArray(l)||l.length===0)return v.pipe(g.W.operator({},m));const D=[];return(0,a.w)()&&D.push(...l.map(E=>{if(E.config.id===s.Js.between){let x=E.config.options.from,P=E.config.options.to;return typeof E.config.options.from=="string"&&(x=m.interpolate(x)),typeof E.config.options.to=="string"&&(P=m.interpolate(P)),{...E,config:{...E.config,options:{...E.config.options,to:P,from:x}}}}else if(E.config.options.value){let x=E.config.options.value;return typeof E.config.options.value=="string"&&(x=m.interpolate(x)),{...E,config:{...E.config,options:{...E.config.options,value:x}}}}return E})),v.pipe((0,t.T)(E=>{if(E.length===0)return E;const x=[];for(const P of E){const b=new Set,M=d(P,E);let O;(0,a.w)()?O=f(D,M):O=f(l,M);for(let C=0;C<P.length;C++){if(b.has(C))continue;let S=!0;for(const A of O){const L=A(C,P,E);if(!y&&L){S=!0;break}if(y&&!L){S=!1;break}S=L}S&&b.add(C)}const I=[],T=u?b.size:E[0].length-b.size;for(const C of P.fields){const S=[];for(let A=0;A<P.length;A++){if(u&&b.has(A)){S.push(C.values[A]);continue}if(!u&&!b.has(A)){S.push(C.values[A]);continue}}I.push({...C,values:S,state:{}})}x.push({...P,fields:I,length:T})}return x}))}},f=(p,m)=>{const v=()=>!1;return p.map(l=>{const y=m[l.fieldName]??-1;if(y<0)return console.warn(`[FilterByValue] Could not find index for field name: ${l.fieldName}`),v;const u=(0,i.kK)(l.config);return(D,E,x)=>u(D,E.fields[y],E,x)})},d=(p,m)=>{const v={};return p.fields.forEach((l,y)=>{const u=(0,n.Ct)(l,p,m);v[u]=y}),v}},15400:(k,R,e)=>{"use strict";e.d(R,{gs:()=>a,yt:()=>h});var t=e(81160),n=e(11261),i=e(81010),s=e(85200),r=e(1173),g=e(18282),a=(d=>(d.UpperCase="Upper Case",d.LowerCase="Lower Case",d.SentenceCase="Sentence Case",d.TitleCase="Title Case",d.PascalCase="Pascal Case",d.CamelCase="Camel Case",d.SnakeCase="Snake Case",d.KebabCase="Kebab Case",d.Trim="Trim",d.Substring="Substring",d))(a||{});const c=d=>{const p=d.split(" ");for(let m=0;m<p.length;m++)p[m]=p[m].charAt(0).toUpperCase()+p[m].slice(1).toLowerCase();return p},o=d=>p=>p.values.map(m=>{switch(d.outputFormat){case"Upper Case":return m.toUpperCase();case"Lower Case":return m.toLowerCase();case"Sentence Case":return m.charAt(0).toUpperCase()+m.slice(1);case"Title Case":return c(m).join(" ");case"Pascal Case":return c(m).join("");case"Camel Case":return m=c(m).join(""),m.charAt(0).toLowerCase()+m.slice(1);case"Snake Case":return m.toLowerCase().split(" ").join("_");case"Kebab Case":return m.toLowerCase().split(" ").join("-");case"Trim":return m.trim();case"Substring":return m.substring(d.substringStart,d.substringEnd)}}),h={id:g.F.formatString,name:"Format string",description:"Manipulate string fields formatting",defaultOptions:{stringField:"",outputFormat:"Upper Case"},isApplicable:d=>{for(const p of d)for(const m of p.fields)if(m.type==="string")return i.M.Applicable;return i.M.NotApplicable},operator:d=>p=>p.pipe((0,t.T)(m=>{if(m.length===0)return m;const v=s.sJ.get(r.Ct.byName).get(d.stringField),l=o(d),y=f(v,l);return m.map(u=>({...u,fields:y(u,m)}))}))},f=(d,p)=>(m,v)=>m.fields.map(l=>{if(d(l,m,v)){const y=p(l);return{...l,type:n.PU.string,values:y}}return l})},25094:(k,R,e)=>{"use strict";e.d(R,{Ce:()=>l,R3:()=>h,Y2:()=>v,of:()=>f});var t=e(81160),n=e(14236),i=e(28240),s=e(11261),r=e(81010),g=e(75059),a=e(18282),c=e(67641);const o=2;var h=(y=>(y.aggregate="aggregate",y.groupBy="groupby",y))(h||{});const f={id:a.F.groupBy,name:"Group by",description:"Group the data by a field values then process calculations for each group.",defaultOptions:{fields:{}},isApplicable:y=>(0,c.f)(y)>=o?r.M.Applicable:r.M.NotApplicable,isApplicableDescription:y=>{const u=(0,c.f)(y);return`The Group by transformation requires a series with at least ${o} fields to work. The maximum number of fields found on a series is ${u}`},operator:y=>u=>u.pipe((0,t.T)(D=>{if(!Object.keys(y.fields).find(P=>y.fields[P].operation==="groupby"))return D;const x=[];for(const P of D){const b=P.fields.filter(I=>d(I,y));if(b.length===0)continue;const M=v(P,b),O=l(b,M);for(const I of P.fields){if(!p(I,y))continue;const T=(0,i.Ct)(I),C=y.fields[T].aggregations,S={};M.forEach(A=>{const L=A[T],N=(0,g.Nw)({field:L,reducers:C});for(const F of C)Array.isArray(S[F])||(S[F]=[]),S[F].push(N[F])});for(const A of C){const L={name:`${T} (${A})`,values:S[A]??[],type:s.PU.other,config:{}};L.type=m(A,I,L),O.push(L)}}x.push({fields:O,length:M.size})}return x}))},d=(y,u)=>{const D=(0,i.Ct)(y);return u?.fields[D]?.operation==="groupby"},p=(y,u)=>{const D=(0,i.Ct)(y);return u?.fields[D]?.operation==="aggregate"&&Array.isArray(u?.fields[D].aggregations)&&u?.fields[D].aggregations.length>0};function m(y,u,D){switch(y){case g.gy.allIsNull:return s.PU.boolean;case g.gy.last:case g.gy.lastNotNull:case g.gy.first:case g.gy.firstNotNull:return u.type;default:return(0,n.dF)(D)??s.PU.string}}function v(y,u){const D=new Map;for(let E=0;E<y.length;E++){const x=String(u.map(b=>b.values[E])),P=D.get(x)??{};D.has(x)||D.set(x,P);for(let b of y.fields){const M=(0,i.Ct)(b);P[M]||(P[M]={name:M,type:b.type,config:{...b.config},values:[]}),P[M].values.push(b.values[E])}}return D}function l(y,u){const D=[];for(const E of y){const x=[],P=(0,i.Ct)(E);u.forEach(b=>{x.push(b[P].values[0])}),D.push({name:E.name,type:E.type,config:{...E.config},values:x})}return D}},68133:(k,R,e)=>{"use strict";e.d(R,{_:()=>p,l:()=>h});var t=e(81160),n=e(14236),i=e(28240),s=e(11261),r=e(81010),g=e(75059),a=e(25094),c=e(18282),o=e(67641);const h=!0,f=2;var d=(D=>(D.aggregate="aggregate",D.groupBy="groupby",D))(d||{});const p={id:c.F.groupToNestedTable,name:"Group to nested tables",description:"Group data by a field value and create nested tables with the grouped data",defaultOptions:{showSubframeHeaders:h,fields:{}},isApplicable:D=>(0,o.f)(D)>=f?r.M.Applicable:r.M.NotApplicable,isApplicableDescription:D=>{const E=(0,o.f)(D);return`The Group to nested table transformation requires a series with at least ${f} fields to work. The maximum number of fields found on a series is ${E}`},operator:D=>E=>E.pipe((0,t.T)(x=>{if(!Object.keys(D.fields).find(M=>D.fields[M].operation==="groupby"))return x;const b=[];for(const M of x){const O=M.fields.filter(S=>v(S,D));if(O.length===0)continue;const I=(0,a.Y2)(M,O),T=(0,a.Ce)(O,I),C=u(I,D);for(let S=0;S<M.fields.length;S++){const A=M.fields[S];if(!l(A,D))continue;const L=(0,i.Ct)(A),N=D.fields[L].aggregations,F={};I.forEach(w=>{const B=w[L],U=(0,g.Nw)({field:B,reducers:N});for(const K of N)Array.isArray(F[K])||(F[K]=[]),F[K].push(U[K])});for(const w of N){const B={name:`${L} (${w})`,values:F[w],type:s.PU.other,config:{}};B.type=y(w,A,B),T.push(B)}}T.push({config:{},name:"Nested frames",type:s.PU.nestedFrames,values:C}),b.push({fields:T,length:I.size})}return b}))};function m(D,E,x){return{meta:{custom:{noHeader:!(x.showSubframeHeaders===void 0?h:x.showSubframeHeaders)}},length:E,fields:D}}const v=(D,E)=>{const x=(0,i.Ct)(D);return E?.fields[x]?.operation==="groupby"},l=(D,E)=>{const x=(0,i.Ct)(D);return E?.fields[x]?.operation==="aggregate"&&Array.isArray(E?.fields[x].aggregations)&&E?.fields[x].aggregations.length>0},y=(D,E,x)=>{switch(D){case g.gy.allIsNull:return s.PU.boolean;case g.gy.last:case g.gy.lastNotNull:case g.gy.first:case g.gy.firstNotNull:return E.type;default:return(0,n.dF)(x)??s.PU.string}};function u(D,E){const x=[];for(const[,P]of D){const b=[];for(const[M,O]of Object.entries(P)){const I=E.fields[M];(I===void 0||I.aggregations===void 0||I.operation==="aggregate"&&I.aggregations.length===0||I.operation===null||I.operation===void 0)&&b.push(O)}b.length>0?x.push([m(b,b[0].values.length,E)]):x.push([m([],0,E)])}return x}},77678:(k,R,e)=>{"use strict";e.d(R,{H1:()=>E,NX:()=>u,OA:()=>l,Rt:()=>v,Uh:()=>M,ZU:()=>b,cg:()=>T,d$:()=>y,dA:()=>D,ix:()=>x,p3:()=>P,rW:()=>f,rs:()=>O});var t=e(81160),n=e(57875),i=e(75972),s=e(11261),r=e(41260),g=e(97706),a=e(18282),c=e(73060),o=e(39624),h=e(67641);const f=[1e-9,2e-9,25e-10,4e-9,5e-9,1e-8,2e-8,25e-9,4e-8,5e-8,1e-7,2e-7,25e-8,4e-7,5e-7,1e-6,2e-6,25e-7,4e-6,5e-6,1e-5,2e-5,25e-6,4e-5,5e-5,1e-4,2e-4,25e-5,4e-4,5e-4,.001,.002,.0025,.004,.005,.01,.02,.025,.04,.05,.1,.2,.25,.4,.5,1,2,4,5,10,20,25,40,50,100,200,250,400,500,1e3,2e3,2500,4e3,5e3,1e4,2e4,25e3,4e4,5e4,1e5,2e5,25e4,4e5,5e5,1e6,2e6,25e5,4e6,5e6,1e7,2e7,25e6,4e7,5e7,1e8,2e8,25e7,4e8,5e8,1e9,2e9,25e8,4e9,5e9],d=30,p=[],m=(C,S)=>C-S,v={bucketCount:{name:"Bucket count",description:"approx bucket count"},bucketSize:{name:"Bucket size",description:void 0},bucketOffset:{name:"Bucket offset",description:"for non-zero-based buckets"},combine:{name:"Combine series",description:"combine all series into a single histogram"}},l={id:a.F.histogram,name:"Histogram",description:"Calculate a histogram from input data.",defaultOptions:{fields:{}},operator:(C,S)=>A=>A.pipe((0,t.T)(L=>l.transformer(C,S)(L))),transformer:(C,S)=>A=>{if(!Array.isArray(A)||A.length===0)return A;let L,N;C.bucketSize&&((0,h.w)()&&(C.bucketSize=S.interpolate(C.bucketSize.toString())),typeof C.bucketSize=="string"?L=parseFloat(C.bucketSize):L=C.bucketSize,isNaN(L)&&(L=void 0)),C.bucketOffset&&((0,h.w)()&&(C.bucketOffset=S.interpolate(C.bucketOffset.toString())),typeof C.bucketOffset=="string"?N=parseFloat(C.bucketOffset):N=C.bucketOffset,isNaN(N)&&(N=void 0));const F={bucketSize:L,bucketOffset:N,combine:C.combine},w=P(A,F);return w==null?[]:[T(w)]}},y="xMin";function u(C){return C===y||C==="BucketMin"}const D="xMax";function E(C){return C===D||C==="BucketMax"}function x(C){if(C.meta?.type===r.m.HeatmapCells){let N=C.fields.find(H=>H.name==="yMin"),F=C.fields.find(H=>H.name==="yMax"),w=C.fields.find(H=>H.name==="count"),B=[...new Set(F.values)].sort((H,Y)=>H-Y),U=[...new Set(N.values)].sort((H,Y)=>H-Y),K=new Map;B.forEach(H=>K.set(H,0));for(let H=0;H<F.values.length;H++){let Y=F.values[H];K.set(Y,K.get(Y)+w.values[H])}return{xMin:{...N,name:"xMin",values:U},xMax:{...F,name:"xMax",values:B},counts:[{...w,values:[...K.values()]}]}}else if(C.meta?.type===r.m.HeatmapRows){let N=[],F=[],w=[],B="0";return C.fields.forEach(K=>{if(K.type===s.PU.number){let V=K.values.reduce((H,Y)=>H+Y,0);w.push(V),N.push(B),F.push(B=K.name)}}),w.push(0),N.push(B),F.push(B),{xMin:{...C.fields[1],name:"xMin",type:s.PU.string,values:N},xMax:{...C.fields[1],name:"xMax",type:s.PU.string,values:F},counts:[{...C.fields[1],name:"count",type:s.PU.number,values:w}]}}let S,A;const L=[];for(const N of C.fields)u(N.name)?S=N:E(N.name)?A=N:N.type===s.PU.number&&L.push(N);if(!A&&S&&S.values.length>1){let N=S.values,F=(0,g.h)(N[1]-N[0],6);A={...S,name:D,values:N.map(w=>w+F)}}if(!S&&A&&A?.values.length>1){let N=A.values,F=(0,g.h)(N[1]-N[0],6);S={...A,name:y,values:N.map(w=>w-F)}}if(S&&A&&L.length)return{xMin:S,xMax:A,counts:L}}function P(C,S){let A=S?.bucketSize,L=S?.bucketCount??d,N=S?.bucketOffset??0;if(C=C.map(X=>({...X,fields:X.fields.map(J=>{if(J.type===s.PU.number){const q=Number(J.config.noValue);Number.isNaN(q)?J={...J,values:J.values.filter(ae=>ae!=null)}:J=(0,o.A)(J,q)}return J})})),!A||A<0){let X=[];for(const ne of C)for(const le of ne.fields)le.type===s.PU.number&&(X=X.concat(le.values));X.sort((ne,le)=>ne-le);let J=1/0;if(X.length===1)J=1;else for(let ne=1;ne<X.length;ne++){let le=X[ne]-X[ne-1];le!==0&&(J=Math.min(J,le))}let q=X[0];const te=(X[X.length-1]-q)/L;for(let ne=0;ne<f.length;ne++){let le=f[ne];if(te<le&&le>=J){A=le;break}}}const F=X=>(0,g.h)(O(X-N,A)+N,9);let w=((""+A).match(/\.\d+$/)??["."])[0].length-1,B=[],U=[],K;for(const X of C)for(const J of X.fields)if(J.type===s.PU.number){let q=I(J.values,F,p,m);B.push(q),U.push({...J,config:{...J.config,unit:J.config.unit==="short"?"short":void 0}}),!K&&J.config.unit&&(K=J.config)}if(!U.length)return null;let V=(0,c.fj)(B);for(let X=1;X<V.length;X++){let J=V[X];for(let q=0;q<J.length;q++)J[q]==null&&(J[q]=0)}const H={name:y,values:V[0],type:s.PU.number,state:void 0,config:w===0?K??{}:{...K,decimals:w}},Y={...H,name:D,values:V[0].map(X=>X+A)};if(S?.combine){const X=new Array(V[0].length).fill(0);for(let J=1;J<V.length;J++)for(let q=0;q<X.length;q++)X[q]+=V[J][q];U=[{...U[0],name:"count",values:X,type:s.PU.number,state:{...U[0].state,displayName:"Count",multipleFrames:!1,origin:{frameIndex:0,fieldIndex:2}}}]}else U.forEach((X,J)=>{X.values=V[J+1]});return{xMin:H,xMax:Y,counts:U}}function b(C,S){return Math.round(C/S)*S}function M(C,S){return Math.ceil(C/S)*S}function O(C,S){return Math.floor(C/S)*S}function I(C,S,A,L){let N=new Map;for(let U=0;U<C.length;U++){let K=C[U];K!=null&&(K=S(K));let V=N.get(K);V?V.count++:N.set(K,{value:K,count:1})}A&&A.forEach(U=>N.delete(U));let F=[...N.values()];L&&F.sort((U,K)=>L(U.value,K.value));let w=Array(F.length),B=Array(F.length);for(let U=0;U<F.length;U++)w[U]=F[U].value,B[U]=F[U].count;return[w,B]}function T(C,S){if(!C.xMin.display){const A=(0,n.J)({field:C.xMin,theme:S??(0,i.a)()});C.xMin.display=A,C.xMax.display=A}return C.counts[0].display=(0,n.J)({field:C.counts[0],theme:S??(0,i.a)()}),{length:C.xMin.values.length,meta:{type:r.m.Histogram},fields:[C.xMin,C.xMax,...C.counts]}}},41511:(k,R,e)=>{"use strict";e.d(R,{L:()=>a,W:()=>g});var t=e(81160),n=e(85200),i=e(1173),s=e(18282),r=e(73060),g=(c=>(c.outer="outer",c.inner="inner",c.outerTabular="outerTabular",c))(g||{});const a={id:s.F.joinByField,aliasIds:[s.F.seriesToColumns],name:"Join by field",description:"Combine rows from two or more tables, based on a related field between them.  This can be used to outer join multiple time series on the _time_ field to show many time series in one table.",defaultOptions:{byField:void 0,mode:"outer"},operator:(c,o)=>h=>h.pipe((0,t.T)(f=>a.transformer(c,o)(f))),transformer:(c,o)=>{let h;return f=>{if(f.length>1){c.byField&&!h&&(h=n.sJ.get(i.Ct.byName).get(o.interpolate(c.byField)));const d=(0,r.Fd)({frames:f,joinBy:h,mode:c.mode});if(d)return[d]}return f}}}},73060:(k,R,e)=>{"use strict";e.d(R,{Fd:()=>o,JI:()=>m,RC:()=>d,WO:()=>p,Yj:()=>c,fj:()=>l,g2:()=>y});var t=e(14236),n=e(11261),i=e(85200),s=e(1173),r=e(41511);function g(u){const{timeField:D}=(0,t.KR)(u[0]);if(D)return i.sJ.get(s.Ct.firstTimeField).get({});let E=[];for(const x of u[0].fields)x.type===n.PU.number&&E.push(x.name);for(let x=1;x<u.length;x++){const P=[];for(const b of u[0].fields)b.type===n.PU.number&&P.push(b.name);E=E.filter(b=>!P.includes(b))}return i.sJ.get(s.Ct.byName).get(E[0])}function a(u){return u.joinBy??g(u.frames)}function c(u,D){if(D>=0){let E=u.fields[D];E.type!==n.PU.string&&!y(E.values)&&(u=(0,t.ES)(u,D))}return u}function o(u){if(!u.frames?.length)return;const D=u.nullMode??(T=>{let C=T.config.custom?.spanNulls;return C===!0?d:C===-1?p:m});if(u.frames.length===1){let T=u.frames[0],C=T;const S=a(u);let A=C.fields.findIndex(L=>S(L,C,u.frames));if(u.keepOriginIndices&&(C={...T,fields:T.fields.map((L,N)=>{const F={...L},w={frameIndex:0,fieldIndex:N};return F.state?F.state.origin=w:F.state={origin:w},F})},A>0)){const L=C.fields[A],N=C.fields.filter((F,w)=>w!==A);N.unshift(L),C.fields=N,A=0}if(A>=0&&(C=c(C,A)),u.keep){let L=C.fields.filter((N,F)=>F===A||u.keep(N,C,u.frames));T!==C?C.fields=L:C={...T,fields:L}}return C}const E=[],x=[],P=[],b=[];let M=1;const O=a(u);for(let T=0;T<u.frames.length;T++){const C=u.frames[T];if(!C||!C.fields?.length)continue;const S=[d];let A,L=[],N=[];for(let w=0;w<C.fields.length;w++){const B=C.fields[w];if(B.state=B.state||{},!A&&O(B,C,u.frames))A=B;else{if(u.keep&&!u.keep(B,C,u.frames))continue;S.push(D(B));let U=B.labels??{},K=B.name;C.name&&(B.name===n.Bc?K=C.name:U.name==null&&(U={...U,name:C.name})),L.push({...B,name:K,labels:U})}u.keepOriginIndices&&(B.state.origin={frameIndex:T,fieldIndex:w})}if(!A)continue;P.length===0&&P.push(A),E.push(S);const F=[A.values];for(const w of L)F.push(w.values),P.push(w),u.keepDisplayNames||delete w.state?.displayName,N.push(M),M++;b.push(N),x.push(F)}let I=[];return u.mode===r.W.outerTabular?I=h(x,b,P.length,E):u.mode===r.W.inner?I=f(x):I=l(x,E,u.mode),{length:I[0]?I[0].length:0,fields:P.map((T,C)=>({...T,values:I[C]}))}}function h(u,D,E,x){let P={};for(let M=0;M<u.length;M++){let O=u[M],I=O[0];for(let T=0;T<u.length;T++){if(T===M)continue;let C=u[T],S=C[0];for(let A=0;A<I.length;A++){const L=I[A],N=E-1;let F=[L].concat(new Array(N)),w=0;for(let B=1;B<O.length;B++){const U=D[M][w];F[U]=O[B][A],w++}for(let B=0;B<S.length;B++)if(I[A]===S[B]){let U=0;for(let K=1;K<C.length;K++){const V=D[T][U];F[V]=C[K][B],U++}break}P[JSON.stringify(F)]=F}}}let b=[];for(let M=0;M<E;M++)b.push(new Array(0));for(let M in P){const O=P[M];for(let I=0;I<O.length;I++)b[I].push(O[I])}return b}function f(u){const D=[],E=(x,P,b)=>{if(P===x.length){D.push(b);return}const M=x[P],[O,...I]=M;for(let T=0;T<O.length;T++){const C=O[T];if(P===0||b.includes(C)){const S=[...b];P===0&&S.push(C);for(let A=0;A<I.length;A++)S.push(I[A][T]);E(x,P+1,S)}}};return E(u,0,[]),D.length===0?[]:D[0].map((x,P)=>D.map(b=>b[P]))}const d=0,p=1,m=2;function v(u,D,E){for(let x=0,P,b=-1;x<D.length;x++){let M=D[x];if(M>b){for(P=M-1;P>=0&&u[P]==null;)u[P--]=null;for(P=M+1;P<E&&u[P]==null;)u[b=P++]=null}}}function l(u,D,E=r.W.outer){let x=new Set;for(let O=0;O<u.length;O++){let T=u[O][0],C=T.length;for(let S=0;S<C;S++)x.add(T[S])}let P=[Array.from(x).sort((O,I)=>O-I)],b=P[0].length,M=new Map;for(let O=0;O<b;O++)M.set(P[0][O],O);for(let O=0;O<u.length;O++){let I=u[O],T=I[0];for(let C=1;C<I.length;C++){let S=I[C],A=Array(b).fill(void 0),L=D?D[O][C]:p,N=[];for(let F=0;F<S.length;F++){let w=S[F],B=M.get(T[F]);w===null?L!==d&&(A[B]=w,L===m&&N.push(B)):A[B]=w}v(A,N,b),P.push(A)}}return P}function y(u,D=50){const E=u.length;if(E<=1)return!0;let x=0,P=E-1;for(;x<=P&&u[x]==null;)x++;for(;P>=x&&u[P]==null;)P--;if(P<=x)return!0;const b=Math.max(1,Math.floor((P-x+1)/D));for(let M=u[x],O=x+b;O<=P;O+=b){const I=u[O];if(I!=null){if(I<=M)return!1;M=I}}return!0}},6829:(k,R,e)=>{"use strict";e.d(R,{V:()=>g,n:()=>r});var t=e(81160),n=e(28240),i=e(11261),s=e(18282),r=(c=>(c.Columns="columns",c.Rows="rows",c))(r||{});const g={id:s.F.labelsToFields,name:"Labels to fields",description:"Extract time series labels to fields (columns or rows)",defaultOptions:{},operator:(c,o)=>h=>h.pipe((0,t.T)(f=>g.transformer(c,o)(f))),transformer:c=>o=>{if(c.mode==="rows")return a(o,c.keepLabels);const h=[],f=c.keepLabels?.length?new Set(c.keepLabels):void 0;for(const d of o){const p=[],m={};for(const v of d.fields){if(!v.labels){p.push(v);continue}const l={...v,config:{...v.config,displayName:void 0,displayNameFromDS:void 0},labels:void 0};p.push(l);for(const y of Object.keys(v.labels)){if(f&&!f.has(y))continue;if(c.valueLabel===y){l.name=v.labels[y];continue}(m[y]??(m[y]=new Set)).add(v.labels[y])}}for(const v in m)for(const l of m[v]){const y=new Array(d.length).fill(l);p.push({name:v,type:i.PU.string,values:y,config:{}})}h.push({...d,fields:p,length:d.length})}return h}};function a(c,o){const h=[];for(const f of c)for(const d of f.fields)if(d.labels){const p=[],m=[];if(o)for(const v of o)p.push(v),m.push(d.labels[v]);else for(const[v,l]of Object.entries(d.labels))p.push(v),m.push(l);m.length&&h.push({...f,name:(0,n.Ct)(d,f,c),fields:[{name:"label",type:i.PU.string,config:{},values:p},{name:"value",type:i.PU.string,config:{},values:m}],length:m.length})}return h}},58140:(k,R,e)=>{"use strict";e.d(R,{o:()=>a});var t=e(2543),n=e.n(t),i=e(81160),s=e(37471),r=e(81010),g=e(18282);const a={id:g.F.merge,name:"Merge series/tables",description:"Merges multiple series/tables into a single serie/table",defaultOptions:{},isApplicable:m=>m.length>1?r.M.Applicable:r.M.NotApplicable,isApplicableDescription:m=>`The merge transformation requires at least 2 data series to work. There is currently ${m.length} data series.`,operator:m=>v=>v.pipe((0,i.T)(l=>{if(!Array.isArray(l)||l.length<=1)return l;const y=l.filter(I=>I.fields.length>0);if(y.length===0)return[l[0]];const u=new Set,D={},E=[],x=new s.k;for(let I=0;I<y.length;I++){const T=y[I];for(let C=0;C<T.fields.length;C++){const S=T.fields[C];u.has(S.name)||(x.addField(c(S)),u.add(S.name)),D[S.name]=D[S.name]||{},D[S.name][I]=C,y.length-1===I&&d(D,S,y)&&E.push(S.name)}}if(E.length===0)return l;const P={},b=[],M=o(y,D,E),O=h(y,u,D);for(let I=0;I<y.length;I++){const T=y[I];for(let C=0;C<T.length;C++){const S=M(I,C),A=O(I,C);if(!Array.isArray(P[S])){P[S]=[A],b.push(p(S,P));continue}let L=!1;P[S]=P[S].map(N=>f(N,A)?(L=!0,{...N,...A}):N),L||(P[S].push(A),b.push(p(S,P)))}}for(const I of b){const T=P[I.key][I.index];T&&x.add(T)}return[x]}))},c=m=>({...(0,t.omit)(m,["values","state","labels","config"]),values:[],config:{...(0,t.omit)(m.config,"displayName")}}),o=(m,v,l)=>{const y=l.reduce((u,D)=>Object.keys(v[D]).reduce((E,x)=>(E[x]=E[x]||[],E[x].push(v[D][x]),E),u),{});return(u,D)=>y[u].reduce((E,x)=>E+m[u].fields[x].values[D],"")},h=(m,v,l)=>(y,u)=>{const D={},E=Array.from(v);for(const x of E){const P=l[x];if(!P)continue;const b=P[y];if(typeof b!="number")continue;const M=m[y];if(!M||!M.fields)continue;const O=M.fields[b];!O||!O.values||(D[x]=O.values[u])}return D},f=(m,v)=>{let l=!0;for(const y in v)if(!(typeof m[y]>"u")&&m[y]!==null&&m[y]!==v[y]){l=!1;break}return l},d=(m,v,l)=>Object.keys(m[v.name]).length===l.length,p=(m,v)=>({key:m,index:v[m].length-1})},64586:(k,R,e)=>{"use strict";e.d(R,{W:()=>n});var t=e(18282);const n={id:t.F.noop,name:"noop",description:"No-operation transformer",defaultOptions:{},operator:i=>s=>s,transformer:i=>s=>s}},46294:(k,R,e)=>{"use strict";e.d(R,{M:()=>s});var t=e(11261);const n={threshold:(g,a,c)=>g+c,midpoint:(g,a,c)=>(g+a)/2,plusone:(g,a,c)=>g+1};function i(g,a){return g.fields.find(c=>a!=null?c.name===a:c.type===t.PU.time)}function s(g){if(g.frame.length===0)return g.frame;let a=!0,{frame:c,refFieldName:o,refFieldPseudoMax:h,refFieldPseudoMin:f,insertMode:d}=g;d||(d=n.threshold);const p=i(c,o);if(p==null)return c;p.state={...p.state,nullThresholdApplied:!0};const m=c.fields.map(l=>l.config.custom?.insertNulls||p.config.interval||null),v=new Set(m);if(v.delete(null),v.size===0)return c;if(v.size===1){const l=v.values().next().value;if(l<=0)return c;const y=p.values,u=c.fields.map(E=>E.values),D=r(y,u,l,f,h,d,a);return D===u?c:{...c,length:D[0].length,fields:c.fields.map((E,x)=>({...E,values:D[x]}))}}return c}function r(g,a,c,o=null,h=null,f,d){const p=g.length,m=[];if(o!=null&&o<g[0]){let u=Math.ceil((g[0]-o)/c),D=g[0]-u*c;for(;D<g[0];)m.push(f(D-c,D,c)),D+=c}m.push(g[0]);let v=g[0];for(let u=1;u<p;u++){const D=g[u];for(;D-v>c&&(m.push(f(v,D,c)),v+=c,!!d););m.push(D),v=D}if(h!=null&&h>v)for(;v+c<h;)m.push(f(v,h,c)),v+=c;const l=m.length;if(l===p)return a;const y=[];for(let u of a){let D;if(u!==g){D=Array(l);for(let E=0,x=0;E<l;E++)D[E]=g[x]===m[E]?u[x++]:null}else D=m;y.push(D)}return y}},39624:(k,R,e)=>{"use strict";e.d(R,{A:()=>n,C:()=>t});function t(i){return{...i,fields:i.fields.map(s=>{const r=Number(s.config.noValue);return Number.isNaN(r)?s:n(s,r)})}}function n(i,s){const r=i.values.slice();for(let g=0;g<r.length;g++)r[g]===null&&(r[g]=s);return{...i,values:r}}},82280:(k,R,e)=>{"use strict";e.d(R,{X:()=>a,x:()=>g});var t=e(2543),n=e.n(t),i=e(81160),s=e(28240),r=e(18282);const g={id:r.F.order,name:"Order fields by name",description:"Order fields based on configuration given by user",defaultOptions:{indexByName:{}},operator:h=>f=>f.pipe((0,i.T)(d=>{const p=c(h.indexByName);return!Array.isArray(d)||d.length===0?d:d.map(m=>({...m,fields:p(m.fields,d,m)}))}))},a=h=>(f,d)=>o(f,h)-o(d,h),c=h=>(f,d,p)=>{if(!Array.isArray(f)||f.length===0||!h||Object.keys(h).length===0)return f;const m=a(h);return(0,t.clone)(f).sort((v,l)=>m((0,s.Ct)(v,p,d),(0,s.Ct)(l,p,d)))},o=(h,f)=>Number.isInteger(f[h])?f[h]:Number.MAX_SAFE_INTEGER},21128:(k,R,e)=>{"use strict";e.d(R,{Wj:()=>h,rV:()=>o});var t=e(81160),n=e(14236),i=e(28240),s=e(11261),r=e(75059),g=e(85200),a=e(72693),c=e(18282),o=(l=>(l.SeriesToRows="seriesToRows",l.ReduceFields="reduceFields",l))(o||{});const h={id:c.F.reduce,name:"Reduce",description:"Reduce all rows or data points to a single value using a function like max, min, mean or last.",defaultOptions:{reducers:[r.gy.max]},operator:l=>y=>y.pipe((0,t.T)(u=>{if(!l?.reducers?.length)return u;const D=l.fields?(0,g.NS)(l.fields):l.includeTimeField&&l.mode==="reduceFields"?a.Yg:a.zx;if(l.mode==="reduceFields")return m(u,D,l.reducers);const E=f(u,D,l.reducers,l.labelsToFields);return E?[E]:[]}))};function f(l,y,u,D){const E=r.AS.list(u),x=E.map(M=>M.id),P=[],b=D?d(l):[];for(const M of l){const O=M.fields.filter(L=>y(L,M,l)),I=O.length,T=[],C=new Array(I);T.push({name:"Field",type:s.PU.string,values:C,config:{}});const S={};if(D)for(const L of b)S[L]=new Array(I),T.push({name:L,type:s.PU.string,values:S[L],config:{}});const A={};for(const L of E)A[L.id]=new Array(I),T.push({name:L.name,type:s.PU.other,values:A[L.id],config:{}});for(let L=0;L<O.length;L++){const N=O[L],F=(0,r.Nw)({field:N,reducers:x});if(D){if(C[L]=N.name,N.labels)for(const w in N.labels)S[w][L]=N.labels[w]}else C[L]=(0,i.Ct)(N,M,l);for(const w of E){const B=F[w.id];B===null?A[w.id][L]=NaN:A[w.id][L]=B}}for(const L of T)if(L.type===s.PU.other){const N=(0,n.dF)(L);N&&(L.type=N)}P.push({...M,fields:T,length:I})}return p(P)}function d(l){const y=new Set;for(const u of l)for(const D of u.fields)if(D.labels)for(const E of Object.keys(D.labels))y.add(E);return[...y]}function p(l){if(!l?.length)return;const y=l[0];for(let u=1;u<l.length;u++){const D=l[u];for(let E=0;E<y.fields.length;E++){const x=y.fields[E];for(let P=0;P<D.fields.length;P++){const b=D.fields[P],M=E===0&&P===0,O=x.type===b.type&&x.name===b.name;if(M||O){const I=x.values,T=b.values;x.values=I.concat(T)}}}}return y.name=void 0,y.length=y.fields[0].values.length,y}function m(l,y,u){const E=r.AS.list(u).map(P=>P.id),x=[];for(const P of l){const b=[];for(const M of P.fields)if(y(M,P,l)){const O=(0,r.Nw)({field:M,reducers:E});for(const I of E){const T=O[I],C={...M,type:v(I,M),values:[T]};C.state=void 0,E.length>1&&(C.labels||(C.labels={}),C.labels.reducer=r.AS.get(I).name),b.push(C)}}b.length&&x.push({...P,fields:b,length:1})}return x}function v(l,y){switch(l){case r.gy.allValues:case r.gy.uniqueValues:return s.PU.other;case r.gy.first:case r.gy.firstNotNull:case r.gy.last:case r.gy.lastNotNull:return y.type;default:return s.PU.number}}},67641:(k,R,e)=>{"use strict";e.d(R,{f:()=>n,w:()=>t});const t=()=>window?.grafanaBootData?.settings?.featureToggles?.transformationsVariableSupport;function n(i){let s=0;for(const r of i)r.fields.length>s&&(s=r.fields.length);return s}},43585:(k,R,e)=>{"use strict";e.d(R,{O:()=>t});var t=(n=>(n.NoData="no_data",n.Paused="paused",n.Alerting="alerting",n.OK="ok",n.Pending="pending",n.Unknown="unknown",n))(t||{})},8790:(k,R,e)=>{"use strict";e.d(R,{V:()=>t});var t=(n=>(n.Field="field",n.Text="text",n.Skip="skip",n))(t||{})},41987:(k,R,e)=>{"use strict";e.d(R,{Ay:()=>r,Jk:()=>i,hX:()=>s});var t=e(43429),n=e(74135),i=(g=>(g.CloudAlerting="cloud-alerting",g.UnifiedAlerting="unified-alerting",g.Dashboard="dashboard",g.Explore="explore",g.Correlations="correlations",g.Unknown="unknown",g.PanelEditor="panel-editor",g.PanelViewer="panel-viewer",g))(i||{});class s extends t.Ud{constructor(){super(...arguments),this._extensionConfigs=[]}init(a){}setRootPage(a){return this.root=a,this}setComponentsFromLegacyExports(a){if(a.ConfigCtrl&&(this.angularConfigCtrl=a.ConfigCtrl),this.meta&&this.meta.includes){for(const c of this.meta.includes)if(c.type===t.ib.page&&c.component&&!a[c.component]){console.warn("App Page uses unknown component: ",c.component,this.meta);continue}}}get extensionConfigs(){return this._extensionConfigs}addLink(a){const{targets:c,...o}=a;return(Array.isArray(c)?c:[c]).forEach(f=>{this._extensionConfigs.push({...o,extensionPointId:f,type:n.u.link})}),this}addComponent(a){const{targets:c,...o}=a;return(Array.isArray(c)?c:[c]).forEach(f=>{this._extensionConfigs.push({...o,extensionPointId:f,type:n.u.component})}),this}exposeComponent(a){const{id:c,...o}=a;return this._extensionConfigs.push({...o,extensionPointId:`capabilities/${c}`,type:n.u.component}),this}configureExtensionLink(a){return this.addLink({targets:[a.extensionPointId],...a}),this}configureExtensionComponent(a){return this.addComponent({targets:[a.extensionPointId],...a}),this}}var r=(g=>(g.alpha="alpha",g.beta="beta",g.experimental="experimental",g.privatePreview="private preview",g.preview="preview",g))(r||{})},61268:(k,R,e)=>{"use strict";e.d(R,{r:()=>t});var t=(n=>(n.OpenSource="Open Source",n.Pro="Pro",n.Enterprise="Enterprise",n))(t||{})},58649:(k,R,e)=>{"use strict";e.d(R,{En:()=>i,d1:()=>n,tw:()=>t});const t=0,n=100,i="SAML"},94624:(k,R,e)=>{"use strict";e.d(R,{y:()=>t});var t=(n=>(n[n.Off=0]="Off",n[n.Crosshair=1]="Crosshair",n[n.Tooltip=2]="Tooltip",n))(t||{})},39070:(k,R,e)=>{"use strict";e.d(R,{Gu:()=>t,Gv:()=>g,Nx:()=>n,UW:()=>i,zz:()=>s});var t=(a=>(a.NotStarted="NotStarted",a.Loading="Loading",a.Streaming="Streaming",a.Done="Done",a.Error="Error",a))(t||{});const n=["graph","table","logs","trace","nodeGraph","flamegraph","rawPrometheus"];var i=(a=>(a.Null="null",a.Ignore="connected",a.AsZero="null as zero",a))(i||{});const s=a=>!!a;function r(a){return a}function g(a){return typeof a=="object"&&a!==null?!0:!1}},11261:(k,R,e)=>{"use strict";e.d(R,{Bc:()=>n,LE:()=>i,PU:()=>t,aI:()=>s});var t=(r=>(r.time="time",r.number="number",r.string="string",r.boolean="boolean",r.trace="trace",r.geo="geo",r.enum="enum",r.other="other",r.frame="frame",r.nestedFrames="nestedFrames",r))(t||{});const n="Value",i="Time",s="Metric"},41260:(k,R,e)=>{"use strict";e.d(R,{m:()=>t});var t=(n=>(n.TimeSeriesWide="timeseries-wide",n.TimeSeriesLong="timeseries-long",n.TimeSeriesMany="timeseries-many",n.TimeSeriesMulti="timeseries-multi",n.NumericWide="numeric-wide",n.NumericMulti="numeric-multi",n.NumericLong="numeric-long",n.LogLines="log-lines",n.DirectoryListing="directory-listing",n.HeatmapRows="heatmap-rows",n.HeatmapCells="heatmap-cells",n.Histogram="histogram",n))(t||{})},91890:(k,R,e)=>{"use strict";e.d(R,{$0:()=>i,CC:()=>n,uP:()=>s,x0:()=>t,yd:()=>r});var t=(g=>(g.Datasource="Datasource",g.Correlations="Correlations",g.ExploreCorrelationsEditor="CorrelationsEditor",g))(t||{}),n=(g=>(g.Regex="regex",g.Logfmt="logfmt",g))(n||{}),i=(g=>(g.Series="series",g.Field="field",g.Fields="fields",g.Value="value",g.BuiltIn="built-in",g.Template="template",g))(i||{}),s=(g=>(g.Values="values",g))(s||{}),r=(g=>(g.Link="link",g.Off="off",g))(r||{})},40187:(k,R,e)=>{"use strict";e.d(R,{Is:()=>a,ZF:()=>r,mA:()=>s,tD:()=>i,v2:()=>g});var t=e(92341),n=e(43429);class i extends n.Ud{constructor(o){super(),this.DataSourceClass=o,this.components={}}setConfigEditor(o){return this.components.ConfigEditor=o,this}setConfigCtrl(o){return this.angularConfigCtrl=o,this}setQueryCtrl(o){return this.components.QueryCtrl=o,this}setAnnotationQueryCtrl(o){return this.components.AnnotationsQueryCtrl=o,this}setQueryEditor(o){return this.components.QueryEditor=o,this}setExploreQueryField(o){return this.components.ExploreQueryField=o,this}setExploreMetricsQueryField(o){return this.components.ExploreMetricsQueryField=o,this}setExploreLogsQueryField(o){return this.components.ExploreLogsQueryField=o,this}setQueryEditorHelp(o){return this.components.QueryEditorHelp=o,this}setExploreStartPage(o){return this.setQueryEditorHelp(o)}setVariableQueryEditor(o){return this.components.VariableQueryEditor=o,this}setMetadataInspector(o){return this.components.MetadataInspector=o,this}setComponentsFromLegacyExports(o){this.angularConfigCtrl=o.ConfigCtrl,this.components.QueryCtrl=o.QueryCtrl,this.components.AnnotationsQueryCtrl=o.AnnotationsQueryCtrl,this.components.ExploreQueryField=o.ExploreQueryField,this.components.QueryEditor=o.QueryEditor,this.components.QueryEditorHelp=o.QueryEditorHelp,this.components.VariableQueryEditor=o.VariableQueryEditor}}class s{constructor(o){this.name=o.name,this.id=o.id,this.type=o.type,this.meta=o.meta,this.cachingConfig=o.cachingConfig,this.uid=o.uid,this.apiVersion=o.apiVersion}filterQuery(o){return!0}getRef(){const o={type:this.type,uid:this.uid};return this.apiVersion&&(o.apiVersion=this.apiVersion),o}}var r=(c=>(c.Logs="Logs",c.Metrics="Metrics",c.Tracing="Tracing",c))(r||{}),g=(c=>(c.Cancelled="cancelled",c.Timeout="timeout",c.Unknown="unknown",c))(g||{});class a{}a=(0,t.Y)(a),s=(0,t.Y)(s)},24293:(k,R,e)=>{"use strict";e.d(R,{F:()=>n,Y:()=>t});var t=(i=>(i.Thresholds="thresholds",i.PaletteClassic="palette-classic",i.PaletteClassicByName="palette-classic-by-name",i.PaletteSaturated="palette-saturated",i.ContinuousGrYlRd="continuous-GrYlRd",i.ContinuousRdYlGr="continuous-RdYlGr",i.ContinuousBlYlRd="continuous-BlYlRd",i.ContinuousYlRd="continuous-YlRd",i.ContinuousBlPu="continuous-BlPu",i.ContinuousYlBl="continuous-YlBl",i.ContinuousBlues="continuous-blues",i.ContinuousReds="continuous-reds",i.ContinuousGreens="continuous-greens",i.ContinuousPurples="continuous-purples",i.Fixed="fixed",i.Shades="shades",i))(t||{});const n="#808080"},37055:(k,R,e)=>{"use strict";e.d(R,{Ow:()=>n,ZW:()=>t,uo:()=>i});function t(s){return r=>"__systemRef"in r&&r.__systemRef===s}const n=s=>"__systemRef"in s&&typeof s.__systemRef=="string";var i=(s=>(s.Unit="unit",s.Min="min",s.Max="max",s.Decimals="decimals",s.DisplayName="displayName",s.NoValue="noValue",s.Thresholds="thresholds",s.Mappings="mappings",s.Links="links",s.Color="color",s.Filterable="filterable",s))(i||{})},8887:(k,R,e)=>{"use strict";e.d(R,{Uo:()=>i,az:()=>t,n6:()=>n});const t={google:!0,microsoft:!0,github:!0,gitlab:!0,okta:!0,discord:!0,hipchat:!0,amazon:!0,"google-hangouts-alt":!0,pagerduty:!0,line:!0,anchor:!0,"adjust-circle":!0,"angle-double-down":!0,"angle-double-right":!0,"angle-double-left":!0,"angle-double-up":!0,"angle-down":!0,"angle-left":!0,"angle-right":!0,"angle-up":!0,"align-left":!0,"align-right":!0,"application-observability":!0,apps:!0,"archive-alt":!0,arrow:!0,"arrow-down":!0,"arrow-from-right":!0,"arrow-left":!0,"arrow-random":!0,"arrow-right":!0,"arrow-to-right":!0,"arrow-up":!0,"arrows-h":!0,"arrows-v":!0,asserts:!0,"expand-arrows":!0,"expand-arrows-alt":!0,at:!0,ai:!0,backward:!0,bars:!0,bell:!0,"bell-slash":!0,bolt:!0,book:!0,bookmark:!0,"book-open":!0,"brackets-curly":!0,bug:!0,building:!0,"calculator-alt":!0,"calendar-alt":!0,"calendar-slash":!0,camera:!0,capture:!0,"channel-add":!0,"chart-line":!0,check:!0,"check-circle":!0,"check-square":!0,circle:!0,"circle-mono":!0,"clipboard-alt":!0,"clock-nine":!0,cloud:!0,"cloud-download":!0,"cloud-upload":!0,"code-branch":!0,cog:!0,columns:!0,"comment-alt":!0,"comment-alt-message":!0,"comment-alt-share":!0,"comments-alt":!0,compass:!0,"compress-arrows":!0,copy:!0,"corner-down-right-alt":!0,"create-dashboard":!0,"credit-card":!0,crosshair:!0,cube:!0,dashboard:!0,database:!0,"dice-three":!0,docker:!0,"document-info":!0,"document-layout-left":!0,"download-alt":!0,draggabledots:!0,edit:!0,"ellipsis-v":!0,enter:!0,envelope:!0,"exchange-alt":!0,"exclamation-triangle":!0,"exclamation-circle":!0,exclamation:!0,"external-link-alt":!0,eye:!0,"eye-slash":!0,"ellipsis-h":!0,"fa fa-spinner":!0,favorite:!0,"file-alt":!0,"file-blank":!0,"file-copy-alt":!0,"file-download":!0,"file-edit-alt":!0,"file-landscape-alt":!0,filter:!0,flip:!0,folder:!0,font:!0,fire:!0,"folder-open":!0,"folder-plus":!0,"folder-upload":!0,forward:!0,"frontend-observability":!0,"gf-bar-alignment-after":!0,"gf-bar-alignment-before":!0,"gf-bar-alignment-center":!0,"gf-glue":!0,"gf-grid":!0,"gf-interpolation-linear":!0,"gf-interpolation-smooth":!0,"gf-interpolation-step-after":!0,"gf-interpolation-step-before":!0,"gf-landscape":!0,"gf-layout-simple":!0,"gf-logs":!0,"gf-ml":!0,"gf-movepane-left":!0,"gf-movepane-right":!0,"gf-portrait":!0,"gf-service-account":!0,"gf-show-context":!0,"gf-pin":!0,"gf-prometheus":!0,"gf-traces":!0,globe:!0,grafana:!0,"graph-bar":!0,heart:!0,"heart-rate":!0,"heart-break":!0,history:!0,"history-alt":!0,home:!0,"home-alt":!0,"horizontal-align-center":!0,"horizontal-align-left":!0,"horizontal-align-right":!0,hourglass:!0,import:!0,info:!0,"info-circle":!0,k6:!0,"key-skeleton-alt":!0,keyboard:!0,kubernetes:!0,"layer-group":!0,"layers-alt":!0,"library-panel":!0,"line-alt":!0,link:!0,"list-ui-alt":!0,"list-ul":!0,"list-ol":!0,lock:!0,"map-marker":!0,"map-marker-plus":!0,"map-marker-minus":!0,message:!0,minus:!0,"minus-circle":!0,"mobile-android":!0,monitor:!0,palette:!0,"panel-add":!0,paragraph:!0,"pathfinder-unite":!0,pause:!0,"pause-circle":!0,pen:!0,percentage:!0,play:!0,plug:!0,plus:!0,"plus-circle":!0,"plus-square":!0,power:!0,"presentation-play":!0,process:!0,"question-circle":!0,"record-audio":!0,repeat:!0,rocket:!0,"ruler-combined":!0,save:!0,search:!0,"search-minus":!0,"search-plus":!0,"share-alt":!0,shield:!0,"shield-exclamation":!0,signal:!0,signin:!0,signout:!0,sitemap:!0,slack:!0,"sliders-v-alt":!0,spinner:!0,"sort-amount-down":!0,"sort-amount-up":!0,"square-shape":!0,star:!0,"step-backward":!0,stopwatch:!0,"stopwatch-slash":!0,sync:!0,"sync-slash":!0,table:!0,"table-collapse-all":!0,"table-expand-all":!0,"tag-alt":!0,"telegram-alt":!0,"text-fields":!0,"thumbs-up":!0,times:!0,"times-circle":!0,"toggle-on":!0,"toggle-off":!0,"trash-alt":!0,unarchive:!0,unlock:!0,upload:!0,user:!0,"users-alt":!0,"user-arrows":!0,"vertical-align-bottom":!0,"vertical-align-center":!0,"vertical-align-top":!0,"web-section-alt":!0,"wrap-text":!0,rss:!0,x:!0,"add-user":!0,attach:!0};function n(s){return!s||typeof s!="string"?!1:s in t}function i(s){if(n(s))return s}},19484:(k,R,e)=>{"use strict";e.d(R,{R:()=>t});var t=(n=>(n.Grid="grid",n.List="list",n))(t||{})},26272:(k,R,e)=>{"use strict";e.d(R,{Tq:()=>g,ee:()=>s,kb:()=>r,r1:()=>i});var t=e(89550),n=e(65463);const i={alertSuccess:(0,t.R)("alert-success"),alertWarning:(0,t.R)("alert-warning"),alertError:(0,t.R)("alert-error"),alertInfo:(0,t.R)("alert-info")},s={refresh:(0,t.R)("refresh"),componentDidMount:(0,t.R)("component-did-mount"),dataReceived:(0,t.R)("data-received"),dataError:(0,t.R)("data-error"),dataFramesReceived:(0,t.R)("data-frames-received"),dataSnapshotLoad:(0,t.R)("data-snapshot-load"),editModeInitialized:(0,t.R)("init-edit-mode"),initPanelActions:(0,t.R)("init-panel-actions"),initialized:(0,t.R)("panel-initialized"),panelTeardown:(0,t.R)("panel-teardown"),render:(0,t.R)("render")};class r extends n.x{static{this.type="graph-hover"}}class g extends n.a{constructor(){super(...arguments),this.payload={point:{}}}static{this.type="graph-hover-clear"}}},55004:(k,R,e)=>{"use strict";e.d(R,{Cz:()=>g,DG:()=>o,Qp:()=>f,Z7:()=>c,ZF:()=>i,aj:()=>h,ew:()=>r,jQ:()=>a,o4:()=>s,os:()=>n,qD:()=>t});var t=(d=>(d.DataSource="ds",d.Plugin="plugin",d.Grafana="grafana",d.Stream="stream",d))(t||{}),n=(d=>(d.DataStream="stream",d.DataFrame="frame",d.JSON="json",d))(n||{}),i=(d=>(d.Pending="pending",d.Connected="connected",d.Connecting="connecting",d.Disconnected="disconnected",d.Shutdown="shutdown",d.Invalid="invalid",d))(i||{}),s=(d=>(d.Status="status",d.Join="join",d.Leave="leave",d.Message="message",d))(s||{});function r(d){return d.type==="status"}function g(d){return d.type==="join"}function a(d){return d.type==="leave"}function c(d){return d.type==="message"}function o(d){if(d?.length){let p=d.trim().split("/");if(p.length>=3)return{scope:p[0],namespace:p[1],path:p.slice(2).join("/")}}}function h(d){return!!(d?.path&&d.namespace&&d.scope)}function f(d){if(!d.scope)return"";let p=d.scope;return!d.namespace||(p+="/"+d.namespace,!d.path)?p:p+"/"+d.path}},9557:(k,R,e)=>{"use strict";e.d(R,{$b:()=>t,Aj:()=>c,FP:()=>f,Nc:()=>o,Ol:()=>g,ZF:()=>r,_0:()=>d,_C:()=>s,cF:()=>a,s5:()=>n,tG:()=>i,wj:()=>h});var t=(p=>(p.emerg="critical",p.fatal="critical",p.alert="critical",p.crit="critical",p.critical="critical",p.warn="warning",p.warning="warning",p.err="error",p.eror="error",p.error="error",p.info="info",p.information="info",p.informational="info",p.notice="info",p.dbug="debug",p.debug="debug",p.trace="trace",p.unknown="unknown",p))(t||{});const n={0:"critical",1:"critical",2:"critical",3:"error",4:"warning",5:"info",6:"info",7:"debug"};var i=(p=>(p[p.Number=0]="Number",p[p.String=1]="String",p[p.LabelsMap=2]="LabelsMap",p[p.Error=3]="Error",p))(i||{}),s=(p=>(p.none="No de-duplication",p.exact="De-duplication of successive lines that are identical, ignoring ISO datetimes.",p.numbers="De-duplication of successive lines that are identical when ignoring numbers, e.g., IP addresses, latencies.",p.signature="De-duplication of successive lines that have identical punctuation and whitespace.",p))(s||{}),r=(p=>(p.Backward="BACKWARD",p.Forward="FORWARD",p))(r||{});const g=p=>!p||typeof p!="object"?!1:"getLogRowContext"in p;var a=(p=>(p.LogsVolume="LogsVolume",p.LogsSample="LogsSample",p))(a||{}),c=(p=>(p.FullRange="FullRange",p.Limited="Limited",p))(c||{});const o=(p,m)=>p?("getDataProvider"in p||"getSupplementaryRequest"in p)&&"getSupplementaryQuery"in p&&"getSupportedSupplementaryQueryTypes"in p&&p.getSupportedSupplementaryQueryTypes().includes(m):!1,h=p=>!p||typeof p!="object"?!1:"getLogRowContextUi"in p,f=p=>p!=null&&typeof p=="object"&&"toggleQueryFilter"in p&&"queryHasFilter"in p,d=p=>p!=null&&typeof p=="object"&&"modifyQuery"in p&&"getSupportedQueryModifications"in p},64388:(k,R,e)=>{"use strict";e.d(R,{k:()=>t});var t=(n=>(n[n.Standard=0]="Standard",n[n.Canvas=1]="Canvas",n[n.Custom=2]="Custom",n))(t||{})},62625:(k,R,e)=>{"use strict";e.d(R,{X:()=>t});var t=(n=>(n.None="None",n.Viewer="Viewer",n.Editor="Editor",n.Admin="Admin",n))(t||{})},47070:(k,R,e)=>{"use strict";e.d(R,{NV:()=>a,nQ:()=>r,v2:()=>g,wV:()=>s});var t=e(2543),n=e.n(t),i=e(11261),s=(c=>(c.Auto="auto",c.Vertical="vertical",c.Horizontal="horizontal",c))(s||{}),r=(c=>(c[c.Best=100]="Best",c[c.Good=70]="Good",c[c.OK=50]="OK",c))(r||{});class g{constructor(o,h){this.list=[],this.data=o,this.panel=h,this.dataSummary=this.computeDataSummary()}getListAppender(o){return new a(this.list,o)}computeDataSummary(){const o=this.data?.series||[];let h=0,f=0,d=0,p=0,m=0,v=0,l;for(const y of o){p+=y.length,y.meta?.preferredVisualisationType&&(l=y.meta.preferredVisualisationType);for(const u of y.fields)switch(v++,u.type){case i.PU.number:h+=1;break;case i.PU.time:f+=1;break;case i.PU.string:d+=1;break}y.length>m&&(m=y.length)}return{numberFieldCount:h,timeFieldCount:f,stringFieldCount:d,rowCountTotal:p,rowCountMax:m,fieldCount:v,preferredVisualisationType:l,frameCount:o.length,hasData:p>0,hasTimeField:f>0,hasNumberField:h>0,hasStringField:d>0}}getList(){return this.list}}class a{constructor(o,h){this.list=o,this.defaults=h}append(o){this.list.push((0,t.defaultsDeep)(o,this.defaults))}}},43429:(k,R,e)=>{"use strict";e.d(R,{Ac:()=>i,QE:()=>n,Ud:()=>a,ZK:()=>r,ib:()=>g,kv:()=>s,pn:()=>t});var t=(c=>(c.alpha="alpha",c.beta="beta",c.stable="stable",c.deprecated="deprecated",c))(t||{}),n=(c=>(c.panel="panel",c.datasource="datasource",c.app="app",c.renderer="renderer",c.secretsmanager="secretsmanager",c))(n||{}),i=(c=>(c.internal="internal",c.valid="valid",c.invalid="invalid",c.modified="modified",c.missing="missing",c))(i||{}),s=(c=>(c.grafana="grafana",c.commercial="commercial",c.community="community",c.private="private",c.core="core",c))(s||{}),r=(c=>(c.missingSignature="signatureMissing",c.invalidSignature="signatureInvalid",c.modifiedSignature="signatureModified",c.failedBackendStart="failedBackendStart",c.angular="angular",c))(r||{}),g=(c=>(c.dashboard="dashboard",c.page="page",c.panel="panel",c.datasource="datasource",c))(g||{});class a{addConfigPage(o){return this.configPages||(this.configPages=[]),this.configPages.push(o),this}setChannelSupport(){return console.warn("[deprecation] plugin is using ignored option: setChannelSupport",this.meta),this}constructor(){this.meta={}}}},74135:(k,R,e)=>{"use strict";e.d(R,{S:()=>n,u:()=>t});var t=(i=>(i.link="link",i.component="component",i))(t||{}),n=(i=>(i.AlertInstanceAction="grafana/alerting/instance/action",i.AlertingHomePage="grafana/alerting/home",i.AlertingAlertingRuleAction="grafana/alerting/alertingrule/action",i.AlertingRecordingRuleAction="grafana/alerting/recordingrule/action",i.CommandPalette="grafana/commandpalette/action",i.DashboardPanelMenu="grafana/dashboard/panel/menu",i.DataSourceConfig="grafana/datasources/config",i.ExploreToolbarAction="grafana/explore/toolbar/action",i.UserProfileTab="grafana/user/profile/tab",i))(n||{})},51527:(k,R,e)=>{"use strict";e.d(R,{x:()=>n});var t=e(43429);function n(i){return i&&i!==t.Ac.valid&&i!==t.Ac.internal}},73372:(k,R,e)=>{"use strict";e.d(R,{D_:()=>t,Ee:()=>i,FL:()=>n});var t=(s=>(s.Equal="Equal",s.NotEqual="NotEqual",s.EqualRegEx="EqualRegEx",s.NotEqualRegEx="NotEqualRegEx",s))(t||{});const n=s=>!s||typeof s!="object"?!1:"importFromAbstractQueries"in s,i=s=>!s||typeof s!="object"?!1:"exportToAbstractQueries"in s},37891:(k,R,e)=>{"use strict";e.d(R,{n:()=>t});const t={"=":"equals","!=":"not-equals","=~":"regex-match","!~":"regex-not-match"}},12470:(k,R,e)=>{"use strict";e.d(R,{CO:()=>t,ZG:()=>n,zL:()=>i});var t=(s=>(s[s.never=0]="never",s[s.onDashboardLoad=1]="onDashboardLoad",s[s.onTimeRangeChanged=2]="onTimeRangeChanged",s))(t||{}),n=(s=>(s[s.disabled=0]="disabled",s[s.alphabeticalAsc=1]="alphabeticalAsc",s[s.alphabeticalDesc=2]="alphabeticalDesc",s[s.numericalAsc=3]="numericalAsc",s[s.numericalDesc=4]="numericalDesc",s[s.alphabeticalCaseInsensitiveAsc=5]="alphabeticalCaseInsensitiveAsc",s[s.alphabeticalCaseInsensitiveDesc=6]="alphabeticalCaseInsensitiveDesc",s[s.naturalAsc=7]="naturalAsc",s[s.naturalDesc=8]="naturalDesc",s))(n||{}),i=(s=>(s[s.dontHide=0]="dontHide",s[s.hideLabel=1]="hideLabel",s[s.hideVariable=2]="hideVariable",s))(i||{})},25137:(k,R,e)=>{"use strict";e.d(R,{I:()=>t});var t=(n=>(n.Light="light",n.Dark="dark",n))(t||{})},50082:(k,R,e)=>{"use strict";e.d(R,{O:()=>t});var t=(n=>(n.Absolute="absolute",n.Percentage="percentage",n))(t||{})},43127:(k,R,e)=>{"use strict";e.d(R,{Cn:()=>g,E2:()=>r,G$:()=>s,HW:()=>a,lE:()=>i});var t=e(52622),n=e(47232);const i=t.vp,s="YYYY-MM-DD HH:mm:ss";function r(){const c=(0,n.KQ)();return{from:(0,n.KQ)(c).subtract(6,"hour"),to:c,raw:{from:"now-6h",to:"now"}}}function g(){return{from:600,to:0}}function a(c,o){const h=typeof c=="string"?(0,n.KQ)(c):c,f=typeof o=="string"?(0,n.KQ)(o):o;return{from:h,to:f,raw:{from:h,to:f}}}},81010:(k,R,e)=>{"use strict";e.d(R,{M:()=>t,N:()=>n});var t=(i=>(i[i.NotPossible=-1]="NotPossible",i[i.NotApplicable=0]="NotApplicable",i[i.Applicable=1]="Applicable",i[i.HighlyApplicable=2]="HighlyApplicable",i))(t||{}),n=(i=>(i.True="true",i.False="false",i.Null="null",i.Empty="empty",i))(n||{})},25019:(k,R,e)=>{"use strict";e.d(R,{W:()=>n,d:()=>t});var t=(i=>(i.ValueToText="value",i.RangeToText="range",i.RegexToText="regex",i.SpecialValue="special",i))(t||{}),n=(i=>(i.True="true",i.False="false",i.Null="null",i.NaN="nan",i.NullAndNaN="null+nan",i.Empty="empty",i))(n||{})},29505:(k,R,e)=>{"use strict";e.d(R,{J$:()=>i,Qz:()=>t,ZV:()=>r,f5:()=>s,xi:()=>n});var t=(g=>(g.Legacy="legacy",g.Standard="standard",g.Custom="custom",g.Datasource="datasource",g))(t||{});class n{}class i extends n{getType(){return"standard"}}class s extends n{getType(){return"custom"}}class r extends n{getType(){return"datasource"}}},35853:(k,R,e)=>{"use strict";e.d(R,{V:()=>t});function t(){Object.getOwnPropertyDescriptor(Array.prototype,"toArray")||Object.defineProperties(Array.prototype,{get:{value:function(n){return this[n]},writable:!0,enumerable:!1,configurable:!0},set:{value:function(n,i){this[n]=i},writable:!0,enumerable:!1,configurable:!0},add:{value:function(n){this.push(n)},writable:!0,enumerable:!1,configurable:!0},toArray:{value:function(){return this},writable:!0,enumerable:!1,configurable:!0}})}t()},7144:(k,R,e)=>{"use strict";e.d(R,{b:()=>s});var t=e(74848),n=e(96540),i=e(68941);const s=r=>{const{children:g,storageKey:a,defaultValue:c}=r,[o,h]=(0,n.useState)({value:i.M.getObject(r.storageKey,r.defaultValue)});(0,n.useEffect)(()=>{const p=m=>{m.key===a&&h({value:i.M.getObject(r.storageKey,r.defaultValue)})};return window.addEventListener("storage",p),()=>{window.removeEventListener("storage",p)}});const f=p=>{try{i.M.setObject(a,p)}catch(m){console.error(m)}h({value:p})},d=()=>{try{i.M.delete(a)}catch(p){console.log(p)}h({value:c})};return(0,t.jsx)(t.Fragment,{children:g(o.value,f,d)})}},60264:(k,R,e)=>{"use strict";e.d(R,{bk:()=>a,pv:()=>h,iF:()=>o});var t=e(2543),n=e(27310),i=e(69550),s=e(83077);class r{constructor(){this.properties=[]}addCustomEditor(d){return this.properties.push(d),this}getRegistry(){return new s.O(()=>this.properties)}getItems(){return this.properties}}var g=e(39070);class a extends r{addNumberInput(d){return this.addCustomEditor({...d,id:d.path,override:i.D.get("number").editor,editor:i.D.get("number").editor,process:n.m0,shouldApply:d.shouldApply??(()=>!0),settings:d.settings||{}})}addSliderInput(d){return this.addCustomEditor({...d,id:d.path,override:i.D.get("slider").editor,editor:i.D.get("slider").editor,process:n.m0,shouldApply:d.shouldApply??(()=>!0),settings:d.settings||{}})}addTextInput(d){return this.addCustomEditor({...d,id:d.path,override:i.D.get("text").editor,editor:i.D.get("text").editor,process:n.OU,shouldApply:d.shouldApply??(()=>!0),settings:d.settings||{}})}addSelect(d){return this.addCustomEditor({...d,id:d.path,override:i.D.get("select").editor,editor:i.D.get("select").editor,process:n.hL,shouldApply:d.shouldApply?d.shouldApply:()=>!0,settings:d.settings||{options:[]}})}addRadio(d){return this.addCustomEditor({...d,id:d.path,override:i.D.get("radio").editor,editor:i.D.get("radio").editor,process:n.hL,shouldApply:d.shouldApply?d.shouldApply:()=>!0,settings:d.settings||{options:[]}})}addBooleanSwitch(d){return this.addCustomEditor({...d,id:d.path,editor:i.D.get("boolean").editor,override:i.D.get("boolean").editor,process:n.FM,shouldApply:d.shouldApply?d.shouldApply:()=>!0,settings:d.settings||{}})}addColorPicker(d){return this.addCustomEditor({...d,id:d.path,editor:i.D.get("color").editor,override:i.D.get("color").editor,process:n.hS,shouldApply:d.shouldApply?d.shouldApply:()=>!0,settings:d.settings||{}})}addUnitPicker(d){return this.addCustomEditor({...d,id:d.path,editor:i.D.get("unit").editor,override:i.D.get("unit").editor,process:n.lG,shouldApply:d.shouldApply?d.shouldApply:()=>!0,settings:d.settings||{}})}addFieldNamePicker(d){return this.addCustomEditor({...d,id:d.path,editor:i.D.get("field-name").editor,override:i.D.get("field-name").editor,process:n.hS,shouldApply:d.shouldApply?d.shouldApply:()=>!0,settings:d.settings||{}})}addGenericEditor(d,p){return this.addCustomEditor({...d,id:d.path,editor:p,override:p,process:n.hS,shouldApply:d.shouldApply?d.shouldApply:()=>!0,settings:d.settings||{}})}}class c{constructor(d){this.cfg=d,this.path="",this.id="nested-panel-options",this.name="nested",this.editor=()=>null,this.getBuilder=()=>this.cfg.build,this.getNestedValueAccess=p=>{const m=this.cfg.values;return m?m(p):{getValue:v=>p.getValue(`${this.path}.${v}`),onChange:(v,l)=>p.onChange(`${this.path}.${v}`,l)}},this.path=d.path,this.category=d.category,this.defaultValue=this.getDefaultValue(d)}getDefaultValue(d){let p=(0,g.Gv)(d.defaultValue)?(0,t.cloneDeep)(d.defaultValue):{};const m=new h;d.build(m,{data:[]});for(const v of m.getItems())v.defaultValue!=null&&(0,t.set)(p,v.path,v.defaultValue);return p}}function o(f){return(0,g.Gv)(f)&&"id"in f&&f.id==="nested-panel-options"}class h extends r{addNestedOptions(d){const p=new c(d);return this.addCustomEditor(p)}addNumberInput(d){return this.addCustomEditor({...d,id:d.path,editor:i.D.get("number").editor})}addSliderInput(d){return this.addCustomEditor({...d,id:d.path,editor:i.D.get("slider").editor})}addTextInput(d){return this.addCustomEditor({...d,id:d.path,editor:i.D.get("text").editor})}addStringArray(d){return this.addCustomEditor({...d,id:d.path,editor:i.D.get("strings").editor})}addSelect(d){return this.addCustomEditor({...d,id:d.path,editor:i.D.get("select").editor})}addMultiSelect(d){return this.addCustomEditor({...d,id:d.path,editor:i.D.get("multi-select").editor})}addRadio(d){return this.addCustomEditor({...d,id:d.path,editor:i.D.get("radio").editor})}addBooleanSwitch(d){return this.addCustomEditor({...d,id:d.path,editor:i.D.get("boolean").editor})}addColorPicker(d){return this.addCustomEditor({...d,id:d.path,editor:i.D.get("color").editor,settings:d.settings||{}})}addTimeZonePicker(d){return this.addCustomEditor({...d,id:d.path,editor:i.D.get("timezone").editor,settings:d.settings||{}})}addUnitPicker(d){return this.addCustomEditor({...d,id:d.path,editor:i.D.get("unit").editor})}addFieldNamePicker(d){return this.addCustomEditor({...d,id:d.path,editor:i.D.get("field-name").editor})}addDashboardPicker(d){return this.addCustomEditor({...d,id:d.path,editor:i.D.get("dashboard-uid").editor})}}},28802:(k,R,e)=>{"use strict";e.d(R,{t:()=>i});var t=e(2543),n=e.n(t);function i(s){return typeof s=="number"?s:s===""||s===null||s===void 0||Array.isArray(s)?NaN:typeof s=="boolean"?s?1:0:(0,t.toNumber)(s)}},14588:(k,R,e)=>{"use strict";e.r(R),e.d(R,{insertAfterImmutably:()=>s,insertBeforeImmutably:()=>i,moveItemImmutably:()=>n,sortValues:()=>a});var t=e(52622);function n(c,o,h){const f=[...c];return Array.prototype.splice.call(f,h,0,Array.prototype.splice.call(f,o,1)[0]),f}function i(c,o,h){if(h<0||h>c.length)throw new Error("Index out of bounds");const f=[...c];return f.splice(h,0,o),f}function s(c,o,h){if(h<0||h>c.length)throw new Error("Index out of bounds");const f=[...c];return f.splice(h+1,0,o),f}const r=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"}),g=(c,o)=>c-o;function a(c){return(o,h)=>{if(o===h)return 0;if(h==null||typeof h=="string"&&h.trim()==="")return-1;if(o==null||typeof o=="string"&&o?.trim()==="")return 1;let f=r.compare;return typeof o=="number"&&typeof h=="number"&&(f=g),c===t.xB.Descending?f(h,o):f(o,h)}}},11710:(k,R,e)=>{"use strict";e.d(R,{b:()=>i,k:()=>n});var t=e(83077),n=(s=>(s.Add="+",s.Subtract="-",s.Divide="/",s.Multiply="*",s))(n||{});const i=new t.O(()=>[{id:"+",name:"Add",operation:(s,r)=>s+r,binaryOperationID:"+"},{id:"-",name:"Subtract",operation:(s,r)=>s-r,binaryOperationID:"-"},{id:"*",name:"Multiply",operation:(s,r)=>s*r,binaryOperationID:"*"},{id:"/",name:"Divide",operation:(s,r)=>s/r,binaryOperationID:"/"}])},72436:(k,R,e)=>{"use strict";e.d(R,{F7:()=>h,Jh:()=>f,_O:()=>u,i8:()=>p});var t=e(2543),n=e.n(t),i=e(44809),s=e.n(i),r=e(37471),g=e(14236),a=e(28240),c=e(11261),o=e(83195),h=(D=>(D[D.full=0]="full",D[D.name=1]="name",D[D.none=2]="none",D))(h||{});function f(D,E){return new p(E).readCSV(D)}var d=(D=>(D[D.Starting=0]="Starting",D[D.InHeader=1]="InHeader",D[D.ReadingRows=2]="ReadingRows",D))(d||{});class p{constructor(E){this.chunk=(x,P)=>{for(let b=0;b<x.data.length;b++){const M=x.data[b];if(M.length<1)continue;const O=M[0];if(O){if(O.startsWith("#")){const I=O.indexOf("#",2);if(I>0){const T=O.slice(1,I),C=T==="name";if(C||{unit:"#"}.hasOwnProperty(T)){this.state===2&&(this.current=new r.k({fields:[]}),this.data.push(this.current));const A=O.slice(I+1);if(C){this.current.addFieldFor(void 0,A);for(let L=1;L<M.length;L++)this.current.addFieldFor(void 0,M[L])}else{const{fields:L}=this.current;for(let N=0;N<L.length;N++){L[N].config||(L[N].config={});const F=L[N].config;F[T]=N===0?A:M[N]}}this.state=1;continue}}else if(this.state===0){this.state=1;continue}continue}if(this.state===0){if((0,g.HW)(O)===c.PU.string){for(const T of M)this.current.addFieldFor(void 0,T);this.state=1;continue}this.state=1}}if(this.state,this.state=2,M.length>this.current.fields.length){const{fields:I}=this.current;for(let T=I.length;T<M.length;T++)this.current.addFieldFor(M[T]);this.callback&&this.callback.onHeader(this.current.fields)}this.current.appendRow(M),this.callback&&this.callback.onRow(M)}},E||(E={}),this.config=E.config||{},this.callback=E.callback,this.current=new r.k({fields:[]}),this.state=0,this.data=[]}readCSV(E){this.current=new r.k({fields:[]}),this.data=[this.current];const x={...this.config,dynamicTyping:!1,skipEmptyLines:!0,comments:!1,chunk:this.chunk};return s().parse(E,x),this.data}}function m(D,E){if(D==null)return"";const x=D.toString();return x.includes('"')?E.quoteChar+x.replace(/"/gi,'""')+E.quoteChar:x.includes(`
`)||E.delimiter&&x.includes(E.delimiter)?E.quoteChar+x+E.quoteChar:x}function v(D,E){return D.display?x=>{const P=D.display(x);return m((0,o.cN)(P),E)}:x=>m(x,E)}function l(D,E,x){const P=D==="name",b=D==="type";for(const M of E){const O=M.config;if(P||b||O&&O.hasOwnProperty(D)){let I="#"+D+"#";for(let T=0;T<E.length;T++){T>0&&(I=I+x.delimiter);let C=E[T].name;b?C=E[T].type:P||(C=E[T].config[D]),C&&(I=I+m(C,x))}return I+x.newline}}return""}function y(){const D=["x","y"];return D.toLocaleString?D.toLocaleString().charAt(1):","}function u(D,E){if(!D)return"";E=(0,t.defaults)(E,{delimiter:y(),newline:`\r
`,quoteChar:'"',encoding:"",headerStyle:1,useExcelHeader:!1});let x=E.useExcelHeader?`sep=${E.delimiter}${E.newline}`:"";for(let P=0;P<D.length;P++){const b=D[P],{fields:M}=b;if(M.length===0)continue;if(E.headerStyle===0)x=x+l("name",M,E)+l("type",M,E)+l("unit",M,E)+l("dateFormat",M,E);else if(E.headerStyle===1){for(let I=0;I<M.length;I++)I>0&&(x+=E.delimiter),x+=`"${(0,a.Ct)(M[I],b).replace(/"/g,'""')}"`;x+=E.newline}const O=M[0].values.length;if(O>0){const I=M.map(T=>v(T,E));for(let T=0;T<O;T++){for(let C=0;C<M.length;C++){C>0&&(x=x+E.delimiter);let S=M[C].values[T];M[C].type===c.PU.frame&&M[C].values[T].value&&(S=M[C].values[T].value),S!==null&&(x=x+I[C](S))}T!==O-1&&(x=x+E.newline)}}P!==D.length-1&&(x=x+E.newline)}return x}},6709:(k,R,e)=>{"use strict";e.d(R,{c:()=>i,u:()=>s});var t=e(71733),n=e(76885);const i={keepTime:"__url_time_range",timeRangeFrom:"__from",timeRangeTo:"__to",includeVars:"__all_variables",seriesName:"__series.name",fieldName:"__field.name",valueTime:"__value.time",valueNumeric:"__value.numeric",valueText:"__value.text",valueRaw:"__value.raw",valueCalc:"__value.calc"};function s(c){const{onClickFn:o,replaceVariables:h,link:f,scopedVars:d,range:p,field:m,internalLink:v}=c,l=g(f.internal?.query,d,h),y=g(f.internal?.panelsState,d,h),u=g(f.internal?.meta?.correlationData,d,h),D=f.title?f.title:v.datasourceName;return{title:h(D,d),href:r(v.datasourceUid,l,p,y),onClick:o?E=>{E.preventDefault&&E.preventDefault(),o({datasourceUid:v.datasourceUid,queries:[l],panelsState:y,correlationHelperData:u,range:p})}:void 0,target:f?.targetBlank?"_blank":"_self",origin:m}}function r(c,o,h,f){return t.I.assureBaseUrl(`/explore?left=${encodeURIComponent((0,n.Pp)({...h?.raw?{range:(0,n.sQ)(h.raw)}:{},datasource:c,queries:[o],panelsState:f}))}`)}function g(c,o,h){if(!c)return c;if(typeof c=="string")return h(c,o);const f=JSON.parse(JSON.stringify(c));return a(f,o,h)}function a(c,o,h){for(const f of Object.keys(c))typeof c[f]=="string"?c[f]=h(c[f],o):typeof c[f]=="object"&&c[f]!==null&&(c[f]=a(c[f],o,h));return c}},22391:(k,R,e)=>{"use strict";e.d(R,{BD:()=>o,EX:()=>h,Iz:()=>r,PG:()=>a,QP:()=>l,fN:()=>s,lO:()=>m,mn:()=>c,p$:()=>i,pN:()=>p,wY:()=>f,wp:()=>v,yV:()=>d,zX:()=>g});var t=e(2543),n=e.n(t);function i(y){const u={uid:y.uid,type:y.type};return y.apiVersion&&(u.apiVersion=y.apiVersion),u}function s(y){return typeof y=="object"&&typeof y?.uid=="string"}function r(y){if(s(y))return y.uid;if((0,t.isString)(y))return y}const g=(y,u)=>D=>{p(y,u,D.currentTarget.value)},a=(y,u)=>D=>{m(y,u,D.currentTarget.value)},c=(y,u)=>D=>{v(y,u,D.currentTarget.value)},o=(y,u)=>D=>{m(y,u,D.value)},h=(y,u)=>D=>{m(y,u,D.currentTarget.checked)},f=(y,u)=>D=>{v(y,u,D.value)},d=(y,u)=>D=>{l(y,u)};function p(y,u,D){const E=y.options;y.onOptionsChange({...E,[u]:D})}const m=(y,u,D)=>{const E=y.options;y.onOptionsChange({...E,jsonData:{...E.jsonData,[u]:D}})},v=(y,u,D)=>{const E=y.options;y.onOptionsChange({...E,secureJsonData:{...E.secureJsonData?E.secureJsonData:{},[u]:D}})},l=(y,u)=>{const D=y.options;y.onOptionsChange({...D,secureJsonData:{...D.secureJsonData?D.secureJsonData:{},[u]:""},secureJsonFields:{...D.secureJsonFields,[u]:!1}})}},95344:(k,R,e)=>{"use strict";e.d(R,{l:()=>n});const t={},n=(i,s,r)=>{let g=`[Deprecation warning] ${i}: ${s} is deprecated`;r&&(g+=`. Use ${r} instead`);const a=Date.now(),c=t[g];(!c||a-c>1e4)&&(console.warn(g),t[g]=a)}},87885:(k,R,e)=>{"use strict";e.d(R,{f:()=>t});var t=(n=>(n[n.Transformations=0]="Transformations",n[n.FieldConfig=1]="FieldConfig",n[n.FieldConfigOverrides=2]="FieldConfigOverrides",n))(t||{})},39306:(k,R,e)=>{"use strict";e.d(R,{R:()=>n,r:()=>i});var t=e(39070);function n({xField:s,yField:r,nullValueMode:g}){const a=s.values,c=r.values,o=a.length;if(c.length!==o)throw new Error("Unexpected field length");const h=g===t.UW.Ignore,f=g===t.UW.AsZero,d=[];for(let p=0;p<o;p++){const m=a[p];let v=c[p];if(v===null){if(h)continue;f&&(v=0)}m!==null&&d.push([m,v])}return d}function i(s,r){if(!r.from||!r.to||!s||s.length===0)return[];const g=r.from.valueOf(),a=r.to.valueOf(),c=s[0][1];return[[g,c],[a,c]]}},8249:(k,R,e)=>{"use strict";e.d(R,{Xy:()=>n,_p:()=>r,h6:()=>g,s6:()=>s,yO:()=>i});const t=/\b(\w+)(!?=~?)"([^"\n]*?)"/g;function n(a){const c={};return a.replace(t,(o,h,f,d)=>(c[h]=d,"")),c}function i(a){return a.reduce((c,o)=>{if(!o)throw new Error("Need parsed labels to find common labels.");return Object.keys(o).forEach(h=>{(c[h]===void 0||c[h]!==o[h])&&delete c[h]}),Object.keys(c).forEach(h=>{o[h]===void 0&&delete c[h]}),c},{...a[0]})}function s(a,c){const o={...a};return Object.keys(c).forEach(h=>{delete o[h]}),o}function r(a,c){if(!a)return!0;for(const[o,h]of Object.entries(a))if(!c||c[o]!==h)return!1;return!0}function g(a,c="",o){if(!a||Object.keys(a).length===0)return c;const f=Object.keys(a).sort().map(d=>`${d}="${a[d]}"`).join(", ");return o?f:["{",f,"}"].join("")}},71733:(k,R,e)=>{"use strict";e.d(R,{I:()=>f});var t=e(80997),n=e(76885);let i={appSubUrl:""},s,r;const g=d=>{try{return new URL(d)}catch{return}},a=d=>{const p=g(d);if(p&&p.origin!==window.location.origin)return d;const m=i.appSubUrl??"",v=m.endsWith("/")?1:0,l=d.startsWith("http");let y=m;return(!d.startsWith("/")||l)&&(y=`${window.location.origin}${m}`),d.length>0&&(d.indexOf(y+"/")===0||d===y)?d.slice(y.length-v):d},c=d=>d.startsWith("/")?`${i.appSubUrl}${a(d)}`:d,f={initialize:d=>{i=d.config,s=d.getTimeRangeForUrl,r=d.getVariablesUrlParams},stripBaseFromUrl:a,assureBaseUrl:c,updateSearchParams:(d,p)=>{const m=new URLSearchParams(p);try{const v=new URL(d);return m.forEach((l,y)=>v.searchParams.set(y,l)),v.href}catch{const v=new URLSearchParams(d);return m.forEach((l,y)=>{v.set(y,l)}),"?"+v.toString()}},getTimeRangeUrlParams:()=>s?n.kM.toUrlParams(s()):null,getVariablesUrlParams:d=>{if(!r)return null;const p=r(d);return n.kM.toUrlParams(p)},getUrlForPartial:(d,p)=>{const m=n.kM.parseKeyValue(d.search.startsWith("?")?d.search.substring(1):d.search);for(const v in p)p[v]===null||p[v]===void 0?delete m[v]:m[v]=p[v];return c(n.kM.renderUrl(d.pathname,m))},processUrl:d=>i.disableSanitizeHtml?d:t.sQ.sanitizeUrl(d)}},92341:(k,R,e)=>{"use strict";e.d(R,{Y:()=>t});function t(n){return new Proxy(n,{apply(i,s,r){return(typeof Reflect>"u"||!Reflect.construct)&&alert("Browser is too old"),Reflect.construct(i,r,s.constructor)}})}},80147:(k,R,e)=>{"use strict";e.d(R,{_:()=>t});function t(n,i){return i.id===n?!0:i.aliasIDs?i.aliasIDs.includes(n):!1}},25352:(k,R,e)=>{"use strict";e.d(R,{u:()=>t});var t=(n=>(n.id="id",n.title="title",n.subTitle="subtitle",n.mainStat="mainstat",n.secondaryStat="secondarystat",n.arc="arc__",n.icon="icon",n.color="color",n.source="source",n.target="target",n.detail="detail__",n.nodeRadius="noderadius",n.thickness="thickness",n.highlighted="highlighted",n.strokeDasharray="strokedasharray",n.fixedX="fixedx",n.fixedY="fixedy",n))(t||{})},97706:(k,R,e)=>{"use strict";e.d(R,{E:()=>n,h:()=>t});function t(i,s=0){if(Number.isInteger(i))return i;let r=10**s,g=i*r*(1+Number.EPSILON);return Math.round(g)/r}function n(i){return((""+i).split(".")[1]||"").length}},92041:(k,R,e)=>{"use strict";e.d(R,{R:()=>n,w:()=>t});const t=i=>Object.keys(i).reduce((s,r)=>(i[r]!==void 0&&(s[r]=i[r]),s),{}),n=i=>typeof i=="object"&&i!==null&&Object.keys(i).length===0},50877:(k,R,e)=>{"use strict";e.d(R,{z:()=>t});const t=n=>({label:n,value:n})},68941:(k,R,e)=>{"use strict";e.d(R,{M:()=>n});class t{get(s){return window.localStorage[s]}set(s,r){window.localStorage[s]=r}getBool(s,r){return r!==void 0&&!this.exists(s)?r:window.localStorage[s]==="true"}getObject(s,r){let g=r;if(this.exists(s)){const a=window.localStorage[s];try{g=JSON.parse(a)}catch(c){console.error(`Error parsing store object: ${s}. Returning default: ${r}. [${c}]`)}}return g}setObject(s,r){let g;try{g=JSON.stringify(r)}catch(a){throw new Error(`Could not stringify object: ${s}. [${a}]`)}try{this.set(s,g)}catch(a){const c=new Error(`Could not save item in localStorage: ${s}. [${a}]`);throw a instanceof Error&&(c.name=a.name),c}return!0}exists(s){return window.localStorage[s]!==void 0}delete(s){window.localStorage.removeItem(s)}}const n=new t},27618:(k,R,e)=>{"use strict";e.d(R,{_:()=>n,j:()=>i});var t=e(83077),n=(s=>(s.Abs="abs",s.Exp="exp",s.Ln="ln",s.Floor="floor",s.Ceil="ceil",s))(n||{});const i=new t.O(()=>[{id:"abs",name:"Absolute value",operation:s=>Math.abs(s),unaryOperationID:"abs"},{id:"exp",name:"Natural exponent",operation:s=>Math.exp(s),unaryOperationID:"exp"},{id:"ln",name:"Natural logarithm",operation:s=>Math.log(s),unaryOperationID:"ln"},{id:"floor",name:"Floor",operation:s=>Math.floor(s),unaryOperationID:"floor"},{id:"ceil",name:"Ceiling",operation:s=>Math.ceil(s),unaryOperationID:"ceil"}])},76885:(k,R,e)=>{"use strict";e.d(R,{Pp:()=>f,kM:()=>h,sQ:()=>d});var t=e(47232);/**
 * @preserve jquery-param (c) 2015 KNOWLEDGECODE | MIT
 */function n(p,m){return m&&Object.keys(m).length>0&&(p+="?"+s(m)),p}function i(p,m){return encodeURIComponent(p).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%20/g,m?"%20":"+").replace(/[!'()*]/g,function(v){return"%"+v.charCodeAt(0).toString(16).toUpperCase()})}function s(p,m=!0){const v=[],l=/\[\]$/,y=m?(x,P)=>i(x,P):(x,P)=>encodeURIComponent(x),u=x=>Object.prototype.toString.call(x)==="[object Array]",D=(x,P)=>{if(P=typeof P=="function"?P():P===null||P===void 0?"":P,typeof P!="boolean")v[v.length]=y(x,!0)+"="+y(P,!0);else{const b=P?"":"="+y("false",!0);v[v.length]=y(x,!0)+b}},E=(x,P)=>{let b,M,O;if(x)if(u(P))for(b=0,M=P.length;b<M;b++)l.test(x)?D(x,P[b]):E(x,P[b]);else if(P&&String(P)==="[object Object]")for(O in P)E(x+"["+O+"]",P[O]);else D(x,P);else if(u(P))for(b=0,M=P.length;b<M;b++)D(P[b].name,P[b].value);else for(O in P)E(O,P[O]);return v};return E("",p).join("&")}function r(p){return s(p,!1)}function g(p,m){if(m!=null&&m!==""){const v=p.indexOf("?");v!==-1?p.length-v>1&&(p+="&"):p+="?",p+=m}return p}function a(){const m=window.location.search.substring(1).split("&"),v={};for(const l of m){const y=l.split("=");if(y.length>1){const u=decodeURIComponent(y[0]),D=decodeURIComponent(y[1]);u in v?v[u]=[...v[u],D]:v[u]=[D]}else if(y.length===1){const u=decodeURIComponent(y[0]);v[u]=!0}}return v}function c(p){const m={},v=(p||"").split("&");for(let l of v){let y,u,D;if(l&&(u=l=l.replace(/\+/g,"%20"),y=l.indexOf("="),y!==-1&&(u=l.substring(0,y),D=l.substring(y+1)),u=o(u),u!==void 0)){D=D!==void 0?o(D):!0;let E;typeof D=="string"&&D!==""?E=D==="true"||D==="false"?D==="true":D:E=D,m.hasOwnProperty(u)?Array.isArray(m[u])?m[u].push(D):m[u]=[m[u],isNaN(E)?D:E]:m[u]=isNaN(E)?D:E}}return m}function o(p){try{return decodeURIComponent(p)}catch{return}}const h={renderUrl:n,toUrlParams:s,appendQueryToUrl:g,getUrlSearchParams:a,parseKeyValue:c,serializeParams:r};function f(p,m){return m!==void 0&&console.warn("`compact` parameter is deprecated and will be removed in a future release"),JSON.stringify(p)}const d=p=>{let m=p.from;(0,t.Ar)(m)&&(m=m.valueOf().toString());let v=p.to;return(0,t.Ar)(v)&&(v=v.valueOf().toString()),{from:m,to:v}}},62398:(k,R,e)=>{"use strict";e.d(R,{An:()=>g,Zz:()=>s,bh:()=>a});var t=e(47737),n=e(54479),i=e(25019);function s(o,h){for(const f of o)switch(f.type){case i.d.ValueToText:if(h==null)continue;const d=f.options[h];if(d)return d;break;case i.d.RangeToText:if(h==null)continue;const p=parseFloat(h);if(isNaN(p)||!isNaN(f.options.from)&&p<f.options.from||!isNaN(f.options.to)&&p>f.options.to)continue;return f.options.result;case i.d.RegexToText:if(h==null||typeof h!="string")continue;const l=(0,n.dO)(f.options.pattern);if(h.match(l)){const y={...f.options.result};return y.text!=null&&(y.text=h.replace(l,f.options.result.text||"")),y}case i.d.SpecialValue:switch(f.options.match){case i.W.Null:{if(h==null)return f.options.result;break}case i.W.NaN:{if(typeof h=="number"&&isNaN(h))return f.options.result;break}case i.W.NullAndNaN:{if(typeof h=="number"&&isNaN(h)||h==null)return f.options.result;break}case i.W.True:{if(h===!0||h==="true")return f.options.result;break}case i.W.False:{if(h===!1||h==="false")return f.options.result;break}case i.W.Empty:{if(h==="")return f.options.result;break}}}return null}function r(o){return(typeof o=="number"||typeof o=="string"&&o.trim()!=="")&&!isNaN(o)}var g=(o=>(o[o.ValueToText=1]="ValueToText",o[o.RangeToText=2]="RangeToText",o))(g||{});function a(o,h){const f=[];let d=o.mappingType;if(o.mappingType||(o.valueMaps&&o.valueMaps.length?d=1:o.rangeMaps&&o.rangeMaps.length&&(d=2)),d===1)for(let p=0;p<o.valueMaps.length;p++){const m=o.valueMaps[p];f.push(c({...m,id:p,type:i.d.ValueToText},o.fieldConfig?.defaults?.thresholds||h))}else if(d===2)for(let p=0;p<o.rangeMaps.length;p++){const m=o.rangeMaps[p];f.push(c({...m,id:p,type:i.d.RangeToText},o.fieldConfig?.defaults?.thresholds||h))}return f}function c(o,h){const f={type:i.d.ValueToText,options:{}},d=[];let p;const m=parseFloat(o.text);if(h&&!isNaN(m)){const v=(0,t.yQ)(m,h.steps);v&&v.color&&(p=v.color)}switch(o.type){case 1:case i.d.ValueToText:o.value!=null&&(o.value==="null"?d.push({type:i.d.SpecialValue,options:{match:i.W.Null,result:{text:o.text,color:p}}}):f.options[String(o.value)]={text:o.text,color:p});break;case 2:case i.d.RangeToText:o.from==="null"||o.to==="null"?d.push({type:i.d.SpecialValue,options:{match:i.W.Null,result:{text:o.text,color:p}}}):d.push({type:i.d.RangeToText,options:{from:+o.from,to:+o.to,result:{text:o.text,color:p}}});break}return Object.keys(f.options).length>0&&d.unshift(f),d[0]}},92053:(k,R,e)=>{"use strict";e.d(R,{E:()=>n,c:()=>i});const t="__searchFilter",n=s=>s&&typeof s=="string"?s.indexOf(t)!==-1:!1,i=s=>{const{query:r,wildcardChar:g}=s;if(!n(r))return{};let{options:a}=s;return a=a||{searchFilter:""},{__searchFilter:{value:a.searchFilter?`${a.searchFilter}${g}`:`${g}`,text:""}}}},72495:(k,R,e)=>{"use strict";e.d(R,{k:()=>r});var t=e(44240),n=e(39697),i=e(65961),s=e(67791);function r({whileLoading:g,source:a}){return(0,t.h)((0,n.O)(200).pipe((0,i.u)(g),(0,s.Q)(a)),a)}},26517:(k,R,e)=>{"use strict";e.d(R,{Gl:()=>n,cL:()=>r,rT:()=>c,yW:()=>a});var t=e(83195);function n(o,h){const f=["","K","M","B","T"],d=(0,t.yP)(1e3,f);return(p,m,v)=>{if(p==null)return{text:""};const l=p<0;l&&(p=Math.abs(p));const y=d(p,m,v);return h?y.suffix=y.suffix!==void 0?`${y.suffix}${o}`:void 0:y.prefix=o,l&&(y.prefix=`-${y.prefix?.length?y.prefix:""}`),y}}const i=["f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"],s=i.indexOf("");function r(o){const h=i.findIndex(f=>f.normalize("NFKD")===o.normalize("NFKD"));return h<0?0:h-s}const g=["","Ki","Mi","Gi","Ti","Pi","Ei","Zi","Yi"];function a(o,h=0){const f=g.map(d=>" "+d+o);return(0,t.yP)(1024,f,h)}function c(o,h=0){const f=i.map(d=>" "+d+o);return(0,t.yP)(1e3,f,s+h)}},83195:(k,R,e)=>{"use strict";e.d(R,{Qc:()=>ee,cN:()=>Y,j_:()=>re,Ke:()=>De,uH:()=>ue,j9:()=>z,Hg:()=>Z,yP:()=>ie,UR:()=>oe,cH:()=>ce,Mg:()=>ae,gZ:()=>te,G8:()=>le});var t=e(2543);function n(ge,Te){return ge===null?{text:""}:{text:ae(ge,Te),suffix:"%"}}function i(ge,Te){return ge===null?{text:""}:{text:ae(100*ge,Te),suffix:"%"}}function s(ge,Te){if(ge==null)return{text:""};const Le=r(ge,Te);return Le.text.substring(0,1)==="-"?Le.text="-0x"+Le.text.substring(1):Le.text="0x"+Le.text,Le}function r(ge,Te){return ge==null?{text:""}:{text:parseFloat(ae(ge,Te)).toString(16).toUpperCase()}}function g(ge,Te){return ge==null?{text:""}:{text:ge.toExponential(Te??void 0)}}var a=e(42994),c=e(72724),o=e(47232),h=(ge=>(ge.Year="year",ge.Month="month",ge.Week="week",ge.Day="day",ge.Hour="hour",ge.Minute="minute",ge.Second="second",ge.Millisecond="millisecond",ge))(h||{});const f=["year","month","week","day","hour","minute","second","millisecond"],d={year:31536e3,month:2592e3,week:604800,day:86400,hour:3600,minute:60,second:1,millisecond:.001};function p(ge,Te){return ge===null?{text:""}:Math.abs(ge)<1e3?{text:ae(ge,Te),suffix:" ns"}:Math.abs(ge)<1e6?te(ge/1e3,Te," \xB5s"):Math.abs(ge)<1e9?te(ge/1e6,Te," ms"):Math.abs(ge)<6e10?te(ge/1e9,Te," s"):Math.abs(ge)<36e11?te(ge/6e10,Te," min"):Math.abs(ge)<864e11?te(ge/36e11,Te," hour"):te(ge/864e11,Te," day")}function m(ge,Te){return ge===null?{text:""}:Math.abs(ge)<1e3?{text:ae(ge,Te),suffix:" \xB5s"}:Math.abs(ge)<1e6?te(ge/1e3,Te," ms"):te(ge/1e6,Te," s")}function v(ge,Te,Le){return ge===null?{text:""}:Math.abs(ge)<1e3?{text:ae(ge,Te),suffix:" ms"}:Math.abs(ge)<6e4?te(ge/1e3,Te," s"):Math.abs(ge)<36e5?te(ge/6e4,Te," min"):Math.abs(ge)<864e5?te(ge/36e5,Te," hour"):Math.abs(ge)<31536e6?te(ge/864e5,Te," day"):te(ge/31536e6,Te," year")}function l(ge,Te){return ge===null?{text:""}:ge===0?{text:"0",suffix:" s"}:Math.abs(ge)<1e-6?te(ge*1e9,Te," ns"):Math.abs(ge)<.001?te(ge*1e6,Te," \xB5s"):Math.abs(ge)<1?te(ge*1e3,Te," ms"):Math.abs(ge)<60?{text:ae(ge,Te),suffix:" s"}:Math.abs(ge)<3600?te(ge/60,Te," min"):Math.abs(ge)<86400?te(ge/3600,Te," hour"):Math.abs(ge)<604800?te(ge/86400,Te," day"):Math.abs(ge)<31536e3?te(ge/604800,Te," week"):te(ge/31556900,Te," year")}function y(ge,Te){return ge===null?{text:""}:Math.abs(ge)<60?{text:ae(ge,Te),suffix:" min"}:Math.abs(ge)<1440?te(ge/60,Te," hour"):Math.abs(ge)<10080?te(ge/1440,Te," day"):Math.abs(ge)<604800?te(ge/10080,Te," week"):te(ge/525948,Te," year")}function u(ge,Te){return ge===null?{text:""}:Math.abs(ge)<24?{text:ae(ge,Te),suffix:" hour"}:Math.abs(ge)<168?te(ge/24,Te," day"):Math.abs(ge)<8760?te(ge/168,Te," week"):te(ge/8760,Te," year")}function D(ge,Te){return ge===null?{text:""}:Math.abs(ge)<7?{text:ae(ge,Te),suffix:" day"}:Math.abs(ge)<365?te(ge/7,Te," week"):te(ge/365,Te," year")}function E(ge,Te,Le){if(ge===null)return{text:""};if(ge===0)return{text:"0",suffix:" "+Le+"s"};if(ge<0){const Ne=E(-ge,Te,Le);return Ne.suffix||(Ne.suffix=""),Ne.suffix+=" ago",Ne}ge*=d[Le]*1e3;const Ye=[];let je=!1,Ze=0;Te!=null&&(Ze=Te);for(let Ne=0;Ne<f.length&&Ze>=0;Ne++){const Pe=d[f[Ne]]*1e3,Ue=ge/Pe;if(Ue>=1||je){je=!0;const $e=Math.floor(Ue),ze=f[Ne]+($e!==1?"s":"");Ye.push($e+" "+ze),ge=ge%Pe,Ze--}}return{text:Ye.join(", ")}}function x(ge,Te){if(ge===null)return{text:""};if(ge<1e3)return{text:(0,o.yT)(ge).format("SSS\\m\\s")};if(ge<6e4){let Ze="ss\\s:SSS\\m\\s";return Te===0&&(Ze="ss\\s"),{text:(0,o.yT)(ge).format(Ze)}}if(ge<36e5){let Ze="mm\\m:ss\\s:SSS\\m\\s";return Te===0?Ze="mm\\m":Te===1&&(Ze="mm\\m:ss\\s"),{text:(0,o.yT)(ge).format(Ze)}}let Le="mm\\m:ss\\s:SSS\\m\\s";const Ye=`${("0"+Math.floor((0,o.Ah)(ge,"milliseconds").asHours())).slice(-2)}h`;return Te===0?Le="":Te===1?Le="mm\\m":Te===2&&(Le="mm\\m:ss\\s"),{text:Le?`${Ye}:${(0,o.yT)(ge).format(Le)}`:Ye}}function P(ge,Te){return E(ge,Te,"millisecond")}function b(ge,Te){return E(ge,Te,"second")}function M(ge){if(ge<0){const Ze=M(-ge);return Ze.suffix||(Ze.suffix=""),Ze.suffix+=" ago",Ze}const Te=[],Le=Math.floor(ge/3600),Ye=Math.floor(ge%3600/60),je=Math.floor(ge%3600%60);return Le>9?Te.push(""+Le):Te.push("0"+Le),Ye>9?Te.push(""+Ye):Te.push("0"+Ye),je>9?Te.push(""+je):Te.push("0"+je),{text:Te.join(":")}}function O(ge){if(ge<0){const je=O(-ge);return je.suffix||(je.suffix=""),je.suffix+=" ago",je}let Te="";const Le=Math.floor(ge/(24*3600));Le>0&&(Te=Le+" d ");const Ye=M(ge-Le*24*3600);return{text:Te+Ye.text}}function I(ge,Te){return l(ge/100,Te)}function T(ge,Te){return x(ge,Te)}function C(ge,Te){return x(ge*1e3,Te)}function S(ge,Te){return(Le,Ye,je,Ze)=>Te&&(0,o.KQ)().isSame(Le,"day")?{text:(0,c.LE)(Le,{format:Te,timeZone:Ze})}:{text:(0,c.LE)(Le,{format:ge,timeZone:Ze})}}const A=S("YYYY-MM-DD HH:mm:ss"),L=S("YYYY-MM-DD HH:mm:ss","HH:mm:ss"),N=S("MM/DD/YYYY h:mm:ss a"),F=S("MM/DD/YYYY h:mm:ss a","h:mm:ss a");function w(){return S((0,a.Od)({year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}))}function B(){return S((0,a.Od)({year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}),(0,a.Od)({hour:"2-digit",minute:"2-digit",second:"2-digit"}))}function U(ge,Te,Le,Ye,je){return{text:(0,c.LE)(ge,{format:je?a.WC.fullDateMS:a.WC.fullDate,timeZone:Ye})}}function K(ge,Te,Le,Ye){return{text:(0,c.fq)(ge,{timeZone:Ye})}}var V=e(26517);const H=()=>[{name:"Misc",formats:[{name:"Number",id:"none",fn:le("")},{name:"String",id:"string",fn:ce},{name:"short",id:"short",fn:ie(1e3,[""," K"," Mil"," Bil"," Tri"," Quadr"," Quint"," Sext"," Sept"])},{name:"SI short",id:"sishort",fn:(0,V.rT)("")},{name:"Percent (0-100)",id:"percent",fn:n},{name:"Percent (0.0-1.0)",id:"percentunit",fn:i},{name:"Humidity (%H)",id:"humidity",fn:le("%H")},{name:"Decibel",id:"dB",fn:le("dB")},{name:"Candela (cd)",id:"candela",fn:(0,V.rT)("cd")},{name:"Hexadecimal (0x)",id:"hex0x",fn:s},{name:"Hexadecimal",id:"hex",fn:r},{name:"Scientific notation",id:"sci",fn:g},{name:"Locale format",id:"locale",fn:Z},{name:"Pixels",id:"pixel",fn:le("px")}]},{name:"Acceleration",formats:[{name:"Meters/sec\xB2",id:"accMS2",fn:le("m/sec\xB2")},{name:"Feet/sec\xB2",id:"accFS2",fn:le("f/sec\xB2")},{name:"G unit",id:"accG",fn:le("g")}]},{name:"Angle",formats:[{name:"Degrees (\xB0)",id:"degree",fn:le("\xB0")},{name:"Radians",id:"radian",fn:le("rad")},{name:"Gradian",id:"grad",fn:le("grad")},{name:"Arc Minutes",id:"arcmin",fn:le("arcmin")},{name:"Arc Seconds",id:"arcsec",fn:le("arcsec")}]},{name:"Area",formats:[{name:"Square Meters (m\xB2)",id:"areaM2",fn:le("m\xB2")},{name:"Square Feet (ft\xB2)",id:"areaF2",fn:le("ft\xB2")},{name:"Square Miles (mi\xB2)",id:"areaMI2",fn:le("mi\xB2")},{name:"Acres (ac)",id:"acres",fn:le("ac")},{name:"Hectares (ha)",id:"hectares",fn:le("ha")}]},{name:"Computation",formats:[{name:"FLOP/s",id:"flops",fn:(0,V.rT)("FLOPS")},{name:"MFLOP/s",id:"mflops",fn:(0,V.rT)("FLOPS",2)},{name:"GFLOP/s",id:"gflops",fn:(0,V.rT)("FLOPS",3)},{name:"TFLOP/s",id:"tflops",fn:(0,V.rT)("FLOPS",4)},{name:"PFLOP/s",id:"pflops",fn:(0,V.rT)("FLOPS",5)},{name:"EFLOP/s",id:"eflops",fn:(0,V.rT)("FLOPS",6)},{name:"ZFLOP/s",id:"zflops",fn:(0,V.rT)("FLOPS",7)},{name:"YFLOP/s",id:"yflops",fn:(0,V.rT)("FLOPS",8)}]},{name:"Concentration",formats:[{name:"parts-per-million (ppm)",id:"ppm",fn:le("ppm")},{name:"parts-per-billion (ppb)",id:"conppb",fn:le("ppb")},{name:"nanogram per cubic meter (ng/m\xB3)",id:"conngm3",fn:le("ng/m\xB3")},{name:"nanogram per normal cubic meter (ng/Nm\xB3)",id:"conngNm3",fn:le("ng/Nm\xB3")},{name:"microgram per cubic meter (\u03BCg/m\xB3)",id:"con\u03BCgm3",fn:le("\u03BCg/m\xB3")},{name:"microgram per normal cubic meter (\u03BCg/Nm\xB3)",id:"con\u03BCgNm3",fn:le("\u03BCg/Nm\xB3")},{name:"milligram per cubic meter (mg/m\xB3)",id:"conmgm3",fn:le("mg/m\xB3")},{name:"milligram per normal cubic meter (mg/Nm\xB3)",id:"conmgNm3",fn:le("mg/Nm\xB3")},{name:"gram per cubic meter (g/m\xB3)",id:"congm3",fn:le("g/m\xB3")},{name:"gram per normal cubic meter (g/Nm\xB3)",id:"congNm3",fn:le("g/Nm\xB3")},{name:"milligrams per decilitre (mg/dL)",id:"conmgdL",fn:le("mg/dL")},{name:"millimoles per litre (mmol/L)",id:"conmmolL",fn:le("mmol/L")}]},{name:"Currency",formats:[{name:"Dollars ($)",id:"currencyUSD",fn:(0,V.Gl)("$")},{name:"Pounds (\xA3)",id:"currencyGBP",fn:(0,V.Gl)("\xA3")},{name:"Euro (\u20AC)",id:"currencyEUR",fn:(0,V.Gl)("\u20AC")},{name:"Yen (\xA5)",id:"currencyJPY",fn:(0,V.Gl)("\xA5")},{name:"Rubles (\u20BD)",id:"currencyRUB",fn:(0,V.Gl)("\u20BD")},{name:"Hryvnias (\u20B4)",id:"currencyUAH",fn:(0,V.Gl)("\u20B4")},{name:"Real (R$)",id:"currencyBRL",fn:(0,V.Gl)("R$")},{name:"Danish Krone (kr)",id:"currencyDKK",fn:(0,V.Gl)("kr",!0)},{name:"Icelandic Kr\xF3na (kr)",id:"currencyISK",fn:(0,V.Gl)("kr",!0)},{name:"Norwegian Krone (kr)",id:"currencyNOK",fn:(0,V.Gl)("kr",!0)},{name:"Swedish Krona (kr)",id:"currencySEK",fn:(0,V.Gl)("kr",!0)},{name:"Czech koruna (czk)",id:"currencyCZK",fn:(0,V.Gl)("czk")},{name:"Swiss franc (CHF)",id:"currencyCHF",fn:(0,V.Gl)("CHF")},{name:"Polish Z\u0142oty (PLN)",id:"currencyPLN",fn:(0,V.Gl)("PLN")},{name:"Bitcoin (\u0E3F)",id:"currencyBTC",fn:(0,V.Gl)("\u0E3F")},{name:"Milli Bitcoin (\u0E3F)",id:"currencymBTC",fn:(0,V.Gl)("mBTC")},{name:"Micro Bitcoin (\u0E3F)",id:"currency\u03BCBTC",fn:(0,V.Gl)("\u03BCBTC")},{name:"South African Rand (R)",id:"currencyZAR",fn:(0,V.Gl)("R")},{name:"Indian Rupee (\u20B9)",id:"currencyINR",fn:(0,V.Gl)("\u20B9")},{name:"South Korean Won (\u20A9)",id:"currencyKRW",fn:(0,V.Gl)("\u20A9")},{name:"Indonesian Rupiah (Rp)",id:"currencyIDR",fn:(0,V.Gl)("Rp")},{name:"Philippine Peso (PHP)",id:"currencyPHP",fn:(0,V.Gl)("PHP")},{name:"Vietnamese Dong (VND)",id:"currencyVND",fn:(0,V.Gl)("\u0111",!0)},{name:"Turkish Lira (\u20BA)",id:"currencyTRY",fn:(0,V.Gl)("\u20BA",!0)},{name:"Malaysian Ringgit (RM)",id:"currencyMYR",fn:(0,V.Gl)("RM")},{name:"CFP franc (XPF)",id:"currencyXPF",fn:(0,V.Gl)("XPF")},{name:"Bulgarian Lev (BGN)",id:"currencyBGN",fn:(0,V.Gl)("BGN")},{name:"Guaran\xED (\u20B2)",id:"currencyPYG",fn:(0,V.Gl)("\u20B2")},{name:"Uruguay Peso (UYU)",id:"currencyUYU",fn:(0,V.Gl)("UYU")}]},{name:"Data",formats:[{name:"bytes(IEC)",id:"bytes",fn:(0,V.yW)("B")},{name:"bytes(SI)",id:"decbytes",fn:(0,V.rT)("B")},{name:"bits(IEC)",id:"bits",fn:(0,V.yW)("b")},{name:"bits(SI)",id:"decbits",fn:(0,V.rT)("b")},{name:"kibibytes",id:"kbytes",fn:(0,V.yW)("B",1)},{name:"kilobytes",id:"deckbytes",fn:(0,V.rT)("B",1)},{name:"mebibytes",id:"mbytes",fn:(0,V.yW)("B",2)},{name:"megabytes",id:"decmbytes",fn:(0,V.rT)("B",2)},{name:"gibibytes",id:"gbytes",fn:(0,V.yW)("B",3)},{name:"gigabytes",id:"decgbytes",fn:(0,V.rT)("B",3)},{name:"tebibytes",id:"tbytes",fn:(0,V.yW)("B",4)},{name:"terabytes",id:"dectbytes",fn:(0,V.rT)("B",4)},{name:"pebibytes",id:"pbytes",fn:(0,V.yW)("B",5)},{name:"petabytes",id:"decpbytes",fn:(0,V.rT)("B",5)}]},{name:"Data rate",formats:[{name:"packets/sec",id:"pps",fn:(0,V.rT)("p/s")},{name:"bytes/sec(IEC)",id:"binBps",fn:(0,V.yW)("B/s")},{name:"bytes/sec(SI)",id:"Bps",fn:(0,V.rT)("B/s")},{name:"bits/sec(IEC)",id:"binbps",fn:(0,V.yW)("b/s")},{name:"bits/sec(SI)",id:"bps",fn:(0,V.rT)("b/s")},{name:"kibibytes/sec",id:"KiBs",fn:(0,V.yW)("B/s",1)},{name:"kibibits/sec",id:"Kibits",fn:(0,V.yW)("b/s",1)},{name:"kilobytes/sec",id:"KBs",fn:(0,V.rT)("B/s",1)},{name:"kilobits/sec",id:"Kbits",fn:(0,V.rT)("b/s",1)},{name:"mebibytes/sec",id:"MiBs",fn:(0,V.yW)("B/s",2)},{name:"mebibits/sec",id:"Mibits",fn:(0,V.yW)("b/s",2)},{name:"megabytes/sec",id:"MBs",fn:(0,V.rT)("B/s",2)},{name:"megabits/sec",id:"Mbits",fn:(0,V.rT)("b/s",2)},{name:"gibibytes/sec",id:"GiBs",fn:(0,V.yW)("B/s",3)},{name:"gibibits/sec",id:"Gibits",fn:(0,V.yW)("b/s",3)},{name:"gigabytes/sec",id:"GBs",fn:(0,V.rT)("B/s",3)},{name:"gigabits/sec",id:"Gbits",fn:(0,V.rT)("b/s",3)},{name:"tebibytes/sec",id:"TiBs",fn:(0,V.yW)("B/s",4)},{name:"tebibits/sec",id:"Tibits",fn:(0,V.yW)("b/s",4)},{name:"terabytes/sec",id:"TBs",fn:(0,V.rT)("B/s",4)},{name:"terabits/sec",id:"Tbits",fn:(0,V.rT)("b/s",4)},{name:"pebibytes/sec",id:"PiBs",fn:(0,V.yW)("B/s",5)},{name:"pebibits/sec",id:"Pibits",fn:(0,V.yW)("b/s",5)},{name:"petabytes/sec",id:"PBs",fn:(0,V.rT)("B/s",5)},{name:"petabits/sec",id:"Pbits",fn:(0,V.rT)("b/s",5)}]},{name:"Date & time",formats:[{name:"Datetime ISO",id:"dateTimeAsIso",fn:A},{name:"Datetime ISO (No date if today)",id:"dateTimeAsIsoNoDateIfToday",fn:L},{name:"Datetime US",id:"dateTimeAsUS",fn:N},{name:"Datetime US (No date if today)",id:"dateTimeAsUSNoDateIfToday",fn:F},{name:"Datetime local",id:"dateTimeAsLocal",fn:w()},{name:"Datetime local (No date if today)",id:"dateTimeAsLocalNoDateIfToday",fn:B()},{name:"Datetime default",id:"dateTimeAsSystem",fn:U},{name:"From Now",id:"dateTimeFromNow",fn:K}]},{name:"Energy",formats:[{name:"Watt (W)",id:"watt",fn:(0,V.rT)("W")},{name:"Kilowatt (kW)",id:"kwatt",fn:(0,V.rT)("W",1)},{name:"Megawatt (MW)",id:"megwatt",fn:(0,V.rT)("W",2)},{name:"Gigawatt (GW)",id:"gwatt",fn:(0,V.rT)("W",3)},{name:"Milliwatt (mW)",id:"mwatt",fn:(0,V.rT)("W",-1)},{name:"Watt per square meter (W/m\xB2)",id:"Wm2",fn:le("W/m\xB2")},{name:"Volt-Ampere (VA)",id:"voltamp",fn:(0,V.rT)("VA")},{name:"Kilovolt-Ampere (kVA)",id:"kvoltamp",fn:(0,V.rT)("VA",1)},{name:"Volt-Ampere reactive (VAr)",id:"voltampreact",fn:(0,V.rT)("VAr")},{name:"Kilovolt-Ampere reactive (kVAr)",id:"kvoltampreact",fn:(0,V.rT)("VAr",1)},{name:"Watt-hour (Wh)",id:"watth",fn:(0,V.rT)("Wh")},{name:"Watt-hour per Kilogram (Wh/kg)",id:"watthperkg",fn:(0,V.rT)("Wh/kg")},{name:"Kilowatt-hour (kWh)",id:"kwatth",fn:(0,V.rT)("Wh",1)},{name:"Kilowatt-min (kWm)",id:"kwattm",fn:(0,V.rT)("W-Min",1)},{name:"Megawatt-hour (MWh)",id:"mwatth",fn:(0,V.rT)("Wh",2)},{name:"Ampere-hour (Ah)",id:"amph",fn:(0,V.rT)("Ah")},{name:"Kiloampere-hour (kAh)",id:"kamph",fn:(0,V.rT)("Ah",1)},{name:"Milliampere-hour (mAh)",id:"mamph",fn:(0,V.rT)("Ah",-1)},{name:"Joule (J)",id:"joule",fn:(0,V.rT)("J")},{name:"Electron volt (eV)",id:"ev",fn:(0,V.rT)("eV")},{name:"Ampere (A)",id:"amp",fn:(0,V.rT)("A")},{name:"Kiloampere (kA)",id:"kamp",fn:(0,V.rT)("A",1)},{name:"Milliampere (mA)",id:"mamp",fn:(0,V.rT)("A",-1)},{name:"Volt (V)",id:"volt",fn:(0,V.rT)("V")},{name:"Kilovolt (kV)",id:"kvolt",fn:(0,V.rT)("V",1)},{name:"Millivolt (mV)",id:"mvolt",fn:(0,V.rT)("V",-1)},{name:"Decibel-milliwatt (dBm)",id:"dBm",fn:(0,V.rT)("dBm")},{name:"Milliohm (m\u03A9)",id:"mohm",fn:(0,V.rT)("\u03A9",-1)},{name:"Ohm (\u03A9)",id:"ohm",fn:(0,V.rT)("\u03A9")},{name:"Kiloohm (k\u03A9)",id:"kohm",fn:(0,V.rT)("\u03A9",1)},{name:"Megaohm (M\u03A9)",id:"Mohm",fn:(0,V.rT)("\u03A9",2)},{name:"Farad (F)",id:"farad",fn:(0,V.rT)("F")},{name:"Microfarad (\xB5F)",id:"\xB5farad",fn:(0,V.rT)("F",-2)},{name:"Nanofarad (nF)",id:"nfarad",fn:(0,V.rT)("F",-3)},{name:"Picofarad (pF)",id:"pfarad",fn:(0,V.rT)("F",-4)},{name:"Femtofarad (fF)",id:"ffarad",fn:(0,V.rT)("F",-5)},{name:"Henry (H)",id:"henry",fn:(0,V.rT)("H")},{name:"Millihenry (mH)",id:"mhenry",fn:(0,V.rT)("H",-1)},{name:"Microhenry (\xB5H)",id:"\xB5henry",fn:(0,V.rT)("H",-2)},{name:"Lumens (Lm)",id:"lumens",fn:(0,V.rT)("Lm")}]},{name:"Flow",formats:[{name:"Gallons/min (gpm)",id:"flowgpm",fn:le("gpm")},{name:"Cubic meters/sec (cms)",id:"flowcms",fn:le("cms")},{name:"Cubic feet/sec (cfs)",id:"flowcfs",fn:le("cfs")},{name:"Cubic feet/min (cfm)",id:"flowcfm",fn:le("cfm")},{name:"Litre/hour",id:"litreh",fn:le("L/h")},{name:"Litre/min (L/min)",id:"flowlpm",fn:le("L/min")},{name:"milliLitre/min (mL/min)",id:"flowmlpm",fn:le("mL/min")},{name:"Lux (lx)",id:"lux",fn:le("lux")}]},{name:"Force",formats:[{name:"Newton-meters (Nm)",id:"forceNm",fn:(0,V.rT)("Nm")},{name:"Kilonewton-meters (kNm)",id:"forcekNm",fn:(0,V.rT)("Nm",1)},{name:"Newtons (N)",id:"forceN",fn:(0,V.rT)("N")},{name:"Kilonewtons (kN)",id:"forcekN",fn:(0,V.rT)("N",1)}]},{name:"Hash rate",formats:[{name:"hashes/sec",id:"Hs",fn:(0,V.rT)("H/s")},{name:"kilohashes/sec",id:"KHs",fn:(0,V.rT)("H/s",1)},{name:"megahashes/sec",id:"MHs",fn:(0,V.rT)("H/s",2)},{name:"gigahashes/sec",id:"GHs",fn:(0,V.rT)("H/s",3)},{name:"terahashes/sec",id:"THs",fn:(0,V.rT)("H/s",4)},{name:"petahashes/sec",id:"PHs",fn:(0,V.rT)("H/s",5)},{name:"exahashes/sec",id:"EHs",fn:(0,V.rT)("H/s",6)}]},{name:"Mass",formats:[{name:"milligram (mg)",id:"massmg",fn:(0,V.rT)("g",-1)},{name:"gram (g)",id:"massg",fn:(0,V.rT)("g")},{name:"pound (lb)",id:"masslb",fn:le("lb")},{name:"kilogram (kg)",id:"masskg",fn:(0,V.rT)("g",1)},{name:"metric ton (t)",id:"masst",fn:le("t")}]},{name:"Length",formats:[{name:"millimeter (mm)",id:"lengthmm",fn:(0,V.rT)("m",-1)},{name:"inch (in)",id:"lengthin",fn:le("in")},{name:"feet (ft)",id:"lengthft",fn:le("ft")},{name:"meter (m)",id:"lengthm",fn:(0,V.rT)("m")},{name:"kilometer (km)",id:"lengthkm",fn:(0,V.rT)("m",1)},{name:"mile (mi)",id:"lengthmi",fn:le("mi")}]},{name:"Pressure",formats:[{name:"Millibars",id:"pressurembar",fn:(0,V.rT)("bar",-1)},{name:"Bars",id:"pressurebar",fn:(0,V.rT)("bar")},{name:"Kilobars",id:"pressurekbar",fn:(0,V.rT)("bar",1)},{name:"Pascals",id:"pressurepa",fn:(0,V.rT)("Pa")},{name:"Hectopascals",id:"pressurehpa",fn:le("hPa")},{name:"Kilopascals",id:"pressurekpa",fn:le("kPa")},{name:"Inches of mercury",id:"pressurehg",fn:le('"Hg')},{name:"PSI",id:"pressurepsi",fn:ie(1e3,["psi","ksi","Mpsi"])}]},{name:"Radiation",formats:[{name:"Becquerel (Bq)",id:"radbq",fn:(0,V.rT)("Bq")},{name:"curie (Ci)",id:"radci",fn:(0,V.rT)("Ci")},{name:"Gray (Gy)",id:"radgy",fn:(0,V.rT)("Gy")},{name:"rad",id:"radrad",fn:(0,V.rT)("rad")},{name:"Sievert (Sv)",id:"radsv",fn:(0,V.rT)("Sv")},{name:"milliSievert (mSv)",id:"radmsv",fn:(0,V.rT)("Sv",-1)},{name:"microSievert (\xB5Sv)",id:"radusv",fn:(0,V.rT)("Sv",-2)},{name:"rem",id:"radrem",fn:(0,V.rT)("rem")},{name:"Exposure (C/kg)",id:"radexpckg",fn:(0,V.rT)("C/kg")},{name:"roentgen (R)",id:"radr",fn:(0,V.rT)("R")},{name:"Sievert/hour (Sv/h)",id:"radsvh",fn:(0,V.rT)("Sv/h")},{name:"milliSievert/hour (mSv/h)",id:"radmsvh",fn:(0,V.rT)("Sv/h",-1)},{name:"microSievert/hour (\xB5Sv/h)",id:"radusvh",fn:(0,V.rT)("Sv/h",-2)}]},{name:"Rotational Speed",formats:[{name:"Revolutions per minute (rpm)",id:"rotrpm",fn:le("rpm")},{name:"Hertz (Hz)",id:"rothz",fn:(0,V.rT)("Hz")},{name:"Kilohertz (kHz)",id:"rotkhz",fn:(0,V.rT)("Hz",1)},{name:"Megahertz (MHz)",id:"rotmhz",fn:(0,V.rT)("Hz",2)},{name:"Gigahertz (GHz)",id:"rotghz",fn:(0,V.rT)("Hz",3)},{name:"Radians per second (rad/s)",id:"rotrads",fn:le("rad/s")},{name:"Degrees per second (\xB0/s)",id:"rotdegs",fn:le("\xB0/s")}]},{name:"Temperature",formats:[{name:"Celsius (\xB0C)",id:"celsius",fn:le("\xB0C")},{name:"Fahrenheit (\xB0F)",id:"fahrenheit",fn:le("\xB0F")},{name:"Kelvin (K)",id:"kelvin",fn:le("K")}]},{name:"Time",formats:[{name:"Hertz (1/s)",id:"hertz",fn:(0,V.rT)("Hz")},{name:"nanoseconds (ns)",id:"ns",fn:p},{name:"microseconds (\xB5s)",id:"\xB5s",fn:m},{name:"milliseconds (ms)",id:"ms",fn:v},{name:"seconds (s)",id:"s",fn:l},{name:"minutes (m)",id:"m",fn:y},{name:"hours (h)",id:"h",fn:u},{name:"days (d)",id:"d",fn:D},{name:"duration (ms)",id:"dtdurationms",fn:P},{name:"duration (s)",id:"dtdurations",fn:b},{name:"duration (hh:mm:ss)",id:"dthms",fn:M},{name:"duration (d hh:mm:ss)",id:"dtdhms",fn:O},{name:"Timeticks (s/100)",id:"timeticks",fn:I},{name:"clock (ms)",id:"clockms",fn:T},{name:"clock (s)",id:"clocks",fn:C}]},{name:"Throughput",formats:[{name:"counts/sec (cps)",id:"cps",fn:oe("c/s")},{name:"ops/sec (ops)",id:"ops",fn:oe("ops/s")},{name:"requests/sec (rps)",id:"reqps",fn:oe("req/s")},{name:"reads/sec (rps)",id:"rps",fn:oe("rd/s")},{name:"writes/sec (wps)",id:"wps",fn:oe("wr/s")},{name:"I/O ops/sec (iops)",id:"iops",fn:oe("io/s")},{name:"events/sec (eps)",id:"eps",fn:oe("evt/s")},{name:"messages/sec (mps)",id:"mps",fn:oe("msg/s")},{name:"records/sec (rps)",id:"recps",fn:oe("rec/s")},{name:"rows/sec (rps)",id:"rowsps",fn:oe("rows/s")},{name:"counts/min (cpm)",id:"cpm",fn:oe("c/m")},{name:"ops/min (opm)",id:"opm",fn:oe("ops/m")},{name:"requests/min (rpm)",id:"reqpm",fn:oe("req/m")},{name:"reads/min (rpm)",id:"rpm",fn:oe("rd/m")},{name:"writes/min (wpm)",id:"wpm",fn:oe("wr/m")},{name:"events/min (epm)",id:"epm",fn:oe("evts/m")},{name:"messages/min (mpm)",id:"mpm",fn:oe("msgs/m")},{name:"records/min (rpm)",id:"recpm",fn:oe("rec/m")},{name:"rows/min (rpm)",id:"rowspm",fn:oe("rows/m")}]},{name:"Velocity",formats:[{name:"meters/second (m/s)",id:"velocityms",fn:le("m/s")},{name:"kilometers/hour (km/h)",id:"velocitykmh",fn:le("km/h")},{name:"miles/hour (mph)",id:"velocitymph",fn:le("mph")},{name:"knot (kn)",id:"velocityknot",fn:le("kn")}]},{name:"Volume",formats:[{name:"millilitre (mL)",id:"mlitre",fn:(0,V.rT)("L",-1)},{name:"litre (L)",id:"litre",fn:(0,V.rT)("L")},{name:"cubic meter",id:"m3",fn:le("m\xB3")},{name:"Normal cubic meter",id:"Nm3",fn:le("Nm\xB3")},{name:"cubic decimeter",id:"dm3",fn:le("dm\xB3")},{name:"gallons",id:"gallons",fn:le("gal")}]},{name:"Boolean",formats:[{name:"True / False",id:"bool",fn:ee("True","False")},{name:"Yes / No",id:"bool_yes_no",fn:ee("Yes","No")},{name:"On / Off",id:"bool_on_off",fn:ee("On","Off")}]}];function Y(ge){return`${ge.prefix??""}${ge.text}${ge.suffix??""}`}let X=[];const J={};let q=!1;function ae(ge,Te){if(ge===null)return"";if(ge===Number.NEGATIVE_INFINITY||ge===Number.POSITIVE_INFINITY)return ge.toLocaleString();if(Te==null&&(Te=j(ge)),ge===0)return ge.toFixed(Te);const Le=Te?Math.pow(10,Math.max(0,Te)):1,Ye=String(Math.round(ge*Le)/Le);if(Ye.indexOf("e")!==-1||ge===0)return Ye;const je=Ye.indexOf("."),Ze=je===-1?0:Ye.length-je-1;return Ze<Te?(Ze?Ye:Ye+".")+String(Le).slice(1,Te-Ze+1):Ye}function j(ge){const Te=Math.abs(ge);let Ye=-Math.floor(Math.log(Te)/Math.LN10)+1;const je=Math.pow(10,-Ye);return Te/je>2.25&&++Ye,ge%1===0&&(Ye=0),Math.max(0,Ye)}function te(ge,Te,Le){return{text:ae(ge,Te),suffix:ne(Le,Math.abs(ge)>1)}}function ne(ge,Te){if(!Te)return ge;switch(ge){case" min":case" hour":case" day":case" week":case" year":return`${ge}s`;default:return ge}}function le(ge,Te){return(Le,Ye)=>{if(Le===null)return{text:""};const je=ae(Le,Ye);return ge?Te?{text:je,prefix:ge}:{text:je,suffix:" "+ge}:{text:je}}}function z(ge){return ge&&ge.startsWith("bool")}function ee(ge,Te){return Le=>({text:Le?ge:Te})}const se=(ge,Te)=>Math.log10(Te)/Math.log10(ge);function ie(ge,Te,Le=0){return(Ye,je)=>{if(Ye==null)return{text:""};if(Ye===Number.NEGATIVE_INFINITY||Ye===Number.POSITIVE_INFINITY||isNaN(Ye))return{text:Ye.toLocaleString()};const Ze=Ye===0?0:Math.floor(se(ge,Math.abs(Ye))),Ne=Te[(0,t.clamp)(Le+Ze,0,Te.length-1)];return{text:ae(Ye/ge**(0,t.clamp)(Ze,-Le,Te.length-Le-1),je),suffix:Ne}}}function Z(ge,Te){return ge==null?{text:""}:{text:ge.toLocaleString(void 0,{maximumFractionDigits:Te??void 0})}}function oe(ge){const Le=ie(1e3,["","K","M","B","T"]);return(Ye,je,Ze)=>{if(Ye===null)return{text:""};const Ne=Le(Ye,je,Ze);return Ne.suffix+=" "+ge,Ne}}function ce(ge){return{text:`${ge}`}}function ye(){X=H();for(const ge of X)for(const Te of ge.formats)J[Te.id]=Te.fn;[{from:"farenheit",to:"fahrenheit"}].forEach(ge=>{const Te=J[ge.to];Te&&(J[ge.from]=Te)}),q=!0}function re(ge){if(!ge)return le("");q||ye();const Te=J[ge];if(!Te&&ge){let Le=ge.indexOf(":");if(Le>0){const Ye=ge.substring(0,Le),je=ge.substring(Le+1);if(Ye==="prefix")return le(je,!0);if(Ye==="suffix")return le(je,!1);if(Ye==="time")return S(je);if(Ye==="si"){const Ze=(0,V.cL)(je.charAt(0)),Ne=Ze===0?je:je.substring(1);return(0,V.rT)(Ne,Ze)}if(Ye==="count")return oe(je);if(Ye==="currency")return(0,V.Gl)(je);if(Ye==="bool"){if(Le=je.indexOf("/"),Le>=0){const Ze=je.substring(0,Le),Ne=je.substring(Le+1);return ee(Ze,Ne)}return ee(je,"-")}}return le(ge)}return Te}function ue(){return q||ye(),J}function De(){return q||ye(),X.map(ge=>({text:ge.name,submenu:ge.formats.map(Te=>({text:Te.name,value:Te.id}))}))}},36120:(k,R,e)=>{"use strict";e.d(R,{$:()=>n});var t=e(18008);class n extends t.F{constructor(s){return super(),this.buffer=s.buffer||[],this.capacity=this.buffer.length,this.tail=s.append!=="head",this.index=0,this.add=this.getAddFunction(),s.capacity&&this.setCapacity(s.capacity),new Proxy(this,{get(r,g,a){if(typeof g!="symbol"){const c=+g;if(String(c)===g)return r.get(c)}return Reflect.get(r,g,a)},set(r,g,a,c){if(typeof g!="symbol"){const o=+g;if(String(o)===g)return r.set(o,a),!0}return Reflect.set(r,g,a,c)}})}getAddFunction(){return this.capacity>this.buffer.length?this.tail?s=>{this.buffer.push(s),this.buffer.length>=this.capacity&&(this.add=this.getAddFunction())}:s=>{this.buffer.unshift(s),this.buffer.length>=this.capacity&&(this.add=this.getAddFunction())}:this.tail?s=>{this.buffer[this.index]=s,this.index=(this.index+1)%this.buffer.length}:s=>{let r=this.index-1;r<0&&(r=this.buffer.length-1),this.buffer[r]=s,this.index=r}}setCapacity(s){if(this.capacity===s)return;const r=this.toArray();if(s>this.length)this.buffer=r;else if(s<this.capacity){const g=this.length-s;this.tail?this.buffer=r.slice(g,r.length):this.buffer=r.slice(0,r.length-g)}this.capacity=s,this.index=0,this.add=this.getAddFunction()}setAppendMode(s){const r=s!=="head";r!==this.tail&&(this.buffer=this.toArray().reverse(),this.index=0,this.tail=r,this.add=this.getAddFunction())}reverse(){return this.buffer.reverse()}get(s){return this.buffer[(s+this.index)%this.buffer.length]}set(s,r){this.buffer[(s+this.index)%this.buffer.length]=r}get length(){return this.buffer.length}}},18008:(k,R,e)=>{"use strict";e.d(R,{E:()=>r,F:()=>i});var t,n;class i{constructor(){this[t]={}}*iterator(){for(let a=0;a<this.length;a++)yield this.get(a)}set(a,c){throw"unsupported operation"}add(a){throw"unsupported operation"}push(...a){for(const c of a)this.add(c);return this.length}[(n=Symbol.iterator,t=Symbol.unscopables,n)](){return this.iterator()}forEach(a){return r(this).forEach(a)}map(a){return r(this).map(a)}filter(a){return r(this).filter(a)}at(a){return this.get(a)}toArray(){const a=new Array(this.length);for(let c=0;c<this.length;c++)a[c]=this.get(c);return a}join(a){return this.toArray().join(a)}toJSON(){return this.toArray()}pop(){throw new Error("Method not implemented.")}concat(...a){throw new Error("Method not implemented.")}reverse(){throw new Error("Method not implemented.")}shift(){throw new Error("Method not implemented.")}sort(a){throw new Error("Method not implemented.")}splice(a,c,...o){throw new Error("Method not implemented.")}unshift(...a){throw new Error("Method not implemented.")}fill(a,c,o){throw new Error("Method not implemented.")}copyWithin(a,c,o){throw new Error("Method not implemented.")}slice(a,c){return this.toArray().slice(a,c)}indexOf(a,c){return this.toArray().indexOf(a,c)}lastIndexOf(a,c){return this.toArray().lastIndexOf(a,c)}every(a,c){return this.toArray().every(a,c)}some(a,c){return this.toArray().some(a,c)}reduce(a,c){throw new Error("Method not implemented.")}reduceRight(a,c){throw new Error("Method not implemented.")}find(a,c){return this.toArray().find(a,c)}findIndex(a,c){return this.toArray().findIndex(a,c)}entries(){return this.toArray().entries()}keys(){return this.toArray().keys()}values(){return this.toArray().values()}includes(a,c){return this.toArray().includes(a,c)}flatMap(a,c){return this.toArray().flatMap(a,c)}flat(a){throw new Error("Method not implemented.")}}const s=[];function r(g){return{*[Symbol.iterator](){for(let a=0;a<g.length;a++)yield g.get(a)},forEach(a){for(let c=0;c<g.length;c++)a(g.get(c),c,s)},map(a){const c=[];for(let o=0;o<g.length;o++)c.push(a(g.get(o),o,s));return c},filter(a){const c=[];let o=0;for(const h of this)a(h,o++,s)&&c.push(h);return c}}}},13390:(k,R,e)=>{"use strict";e.d(R,{X:()=>t});const t={RadioButton:{container:"data-testid radio-button"},Breadcrumbs:{breadcrumb:n=>`data-testid ${n} breadcrumb`},TimePicker:{openButton:"data-testid TimePicker Open Button",overlayContent:"data-testid TimePicker Overlay Content",fromField:"data-testid Time Range from field",toField:"data-testid Time Range to field",applyTimeRange:"data-testid TimePicker submit button",copyTimeRange:"data-testid TimePicker copy button",pasteTimeRange:"data-testid TimePicker paste button",calendar:{label:"data-testid Time Range calendar",openButton:"data-testid Open time range calendar",closeButton:"data-testid Close time range Calendar"},absoluteTimeRangeTitle:"data-testid-absolute-time-range-narrow"},DataSourcePermissions:{form:()=>'form[name="addPermission"]',roleType:"Role to add new permission to",rolePicker:"Built-in role picker",permissionLevel:"Permission Level"},DateTimePicker:{input:"data-testid date-time-input"},DataSource:{TestData:{QueryTab:{scenarioSelectContainer:"Test Data Query scenario select container",scenarioSelect:"Test Data Query scenario select",max:"TestData max",min:"TestData min",noise:"TestData noise",seriesCount:"TestData series count",spread:"TestData spread",startValue:"TestData start value",drop:"TestData drop values"}},DataSourceHttpSettings:{urlInput:"data-testid Datasource HTTP settings url"},Jaeger:{traceIDInput:"Trace ID"},Prometheus:{configPage:{connectionSettings:"Data source connection URL",manageAlerts:"prometheus-alerts-manager",scrapeInterval:"data-testid scrape interval",queryTimeout:"data-testid query timeout",defaultEditor:"data-testid default editor",disableMetricLookup:"disable-metric-lookup",prometheusType:"data-testid prometheus type",prometheusVersion:"data-testid prometheus version",cacheLevel:"data-testid cache level",incrementalQuerying:"prometheus-incremental-querying",queryOverlapWindow:"data-testid query overlap window",disableRecordingRules:"disable-recording-rules",customQueryParameters:"data-testid custom query parameters",httpMethod:"data-testid http method",exemplarsAddButton:"data-testid Add exemplar config button",internalLinkSwitch:"data-testid Internal link switch",codeModeMetricNamesSuggestionLimit:"data-testid code mode metric names suggestion limit"},queryEditor:{explain:"data-testid prometheus explain switch wrapper",editorToggle:"data-testid QueryEditorModeToggle",options:"data-testid prometheus options",legend:"data-testid prometheus legend wrapper",format:"data-testid prometheus format",step:"prometheus-step",type:"data-testid prometheus type",exemplars:"prometheus-exemplars",builder:{metricSelect:"data-testid metric select",hints:"data-testid prometheus hints",metricsExplorer:"data-testid metrics explorer",queryAdvisor:"data-testid query advisor"},code:{queryField:"data-testid prometheus query field",metricsCountInfo:"data-testid metrics count disclaimer",metricsBrowser:{openButton:"data-testid open metrics browser",selectMetric:"data-testid select a metric",seriesLimit:"data-testid series limit",metricList:"data-testid metric list",labelNamesFilter:"data-testid label names filter",labelValuesFilter:"data-testid label values filter",useQuery:"data-testid use query",useAsRateQuery:"data-testid use as rate query",validateSelector:"data-testid validate selector",clear:"data-testid clear"}}},exemplarMarker:"data-testid Exemplar marker",variableQueryEditor:{queryType:"data-testid query type",labelnames:{metricRegex:"data-testid label names metric regex"},labelValues:{labelSelect:"data-testid label values label select"},metricNames:{metricRegex:"data-testid metric names metric regex"},varQueryResult:"data-testid variable query result",seriesQuery:"data-testid prometheus series query",classicQuery:"data-testid prometheus classic query"},annotations:{minStep:"prometheus-annotation-min-step",title:"data-testid prometheus annotation title",tags:"data-testid prometheus annotation tags",text:"data-testid prometheus annotation text",seriesValueAsTimestamp:"data-testid prometheus annotation series value as timestamp"}}},Menu:{MenuComponent:n=>`${n} menu`,MenuGroup:n=>`${n} menu group`,MenuItem:n=>`${n} menu item`,SubMenu:{container:"data-testid SubMenu container",icon:"data-testid SubMenu icon"}},Panels:{Panel:{title:n=>`data-testid Panel header ${n}`,content:"data-testid panel content",headerItems:n=>`data-testid Panel header item ${n}`,menuItems:n=>`data-testid Panel menu item ${n}`,menu:n=>`data-testid Panel menu ${n}`,containerByTitle:n=>`${n} panel`,headerCornerInfo:n=>`Panel header ${n}`,status:n=>`data-testid Panel status ${n}`,loadingBar:()=>"Panel loading bar",HoverWidget:{container:"data-testid hover-header-container",dragIcon:"data-testid drag-icon"},PanelDataErrorMessage:"data-testid Panel data error message"},Visualization:{Graph:{container:"Graph container",VisualizationTab:{legendSection:"Legend section"},Legend:{legendItemAlias:n=>`gpl alias ${n}`,showLegendSwitch:"gpl show legend"},xAxis:{labels:()=>"div.flot-x-axis > div.flot-tick-label"}},BarGauge:{value:"Bar gauge value",valueV2:"data-testid Bar gauge value"},PieChart:{svgSlice:"data testid Pie Chart Slice"},Text:{container:()=>".markdown-html"},Table:{header:"table header",footer:"table-footer",body:"data-testid table body"}}},VizLegend:{seriesName:n=>`data-testid VizLegend series ${n}`},Drawer:{General:{title:n=>`Drawer title ${n}`,expand:"Drawer expand",contract:"Drawer contract",close:"data-testid Drawer close",rcContentWrapper:()=>".rc-drawer-content-wrapper",subtitle:"data-testid drawer subtitle"},DashboardSaveDrawer:{saveButton:"data-testid Save dashboard drawer button",saveAsButton:"data-testid Save as dashboard drawer button",saveAsTitleInput:"Save dashboard title field"}},PanelEditor:{General:{content:"data-testid Panel editor content"},OptionsPane:{content:"data-testid Panel editor option pane content",select:"Panel editor option pane select",fieldLabel:n=>`${n} field property editor`,fieldInput:n=>`data-testid Panel editor option pane field input ${n}`},DataPane:{content:"data-testid Panel editor data pane content"},applyButton:"data-testid Apply changes and go back to dashboard",toggleVizPicker:"data-testid toggle-viz-picker",toggleVizOptions:"data-testid toggle-viz-options",toggleTableView:"data-testid toggle-table-view",showZoomField:"Map controls Show zoom control field property editor",showAttributionField:"Map controls Show attribution field property editor",showScaleField:"Map controls Show scale field property editor",showMeasureField:"Map controls Show measure tools field property editor",showDebugField:"Map controls Show debug field property editor",measureButton:"show measure tools"},PanelInspector:{Data:{content:"Panel inspector Data content"},Stats:{content:"Panel inspector Stats content"},Json:{content:"data-testid Panel inspector Json content"},Query:{content:"Panel inspector Query content",refreshButton:"Panel inspector Query refresh button",jsonObjectKeys:()=>".json-formatter-key"}},Tab:{title:n=>`data-testid Tab ${n}`,active:()=>'[class*="-activeTabStyle"]'},RefreshPicker:{runButton:"RefreshPicker run button",intervalButton:"RefreshPicker interval button",runButtonV2:"data-testid RefreshPicker run button",intervalButtonV2:"data-testid RefreshPicker interval button"},QueryTab:{content:"Query editor tab content",queryInspectorButton:"Query inspector button",queryHistoryButton:"data-testid query-history-button",addQuery:"data-testid query-tab-add-query",queryGroupTopSection:"data-testid query group top section",addExpression:"data-testid query-tab-add-expression"},QueryHistory:{queryText:"Query text"},QueryEditorRows:{rows:"Query editor row"},QueryEditorRow:{actionButton:n=>`data-testid ${n}`,title:n=>`Query editor row title ${n}`,container:n=>`Query editor row ${n}`},AlertTab:{content:"data-testid Alert editor tab content"},AlertRules:{groupToggle:"data-testid group-collapse-toggle",toggle:"data-testid collapse-toggle",expandedContent:"data-testid expanded-content",previewButton:"data-testid alert-rule preview-button",ruleNameField:"data-testid alert-rule name-field",newFolderButton:"data-testid alert-rule new-folder-button",newFolderNameField:"data-testid alert-rule name-folder-name-field",newFolderNameCreateButton:"data-testid alert-rule name-folder-name-create-button",newEvaluationGroupButton:"data-testid alert-rule new-evaluation-group-button",newEvaluationGroupName:"data-testid alert-rule new-evaluation-group-name",newEvaluationGroupInterval:"data-testid alert-rule new-evaluation-group-interval",newEvaluationGroupCreate:"data-testid alert-rule new-evaluation-group-create-button"},Alert:{alert:n=>`Alert ${n}`,alertV2:n=>`data-testid Alert ${n}`},TransformTab:{content:"data-testid Transform editor tab content",newTransform:n=>`data-testid New transform ${n}`,transformationEditor:n=>`data-testid Transformation editor ${n}`,transformationEditorDebugger:n=>`data-testid Transformation editor debugger ${n}`},Transforms:{card:n=>`data-testid New transform ${n}`,disableTransformationButton:"data-testid Disable transformation button",Reduce:{modeLabel:"data-testid Transform mode label",calculationsLabel:"data-testid Transform calculations label"},SpatialOperations:{actionLabel:"root Action field property editor",locationLabel:"root Location Mode field property editor",location:{autoOption:"Auto location option",coords:{option:"Coords location option",latitudeFieldLabel:"root Latitude field field property editor",longitudeFieldLabel:"root Longitude field field property editor"},geohash:{option:"Geohash location option",geohashFieldLabel:"root Geohash field field property editor"},lookup:{option:"Lookup location option",lookupFieldLabel:"root Lookup field field property editor",gazetteerFieldLabel:"root Gazetteer field property editor"}}},searchInput:"data-testid search transformations",noTransformationsMessage:"data-testid no transformations message",addTransformationButton:"data-testid add transformation button",removeAllTransformationsButton:"data-testid remove all transformations button"},NavBar:{Configuration:{button:"Configuration"},Toggle:{button:"data-testid Toggle menu"},Reporting:{button:"Reporting"}},NavMenu:{Menu:"data-testid navigation mega-menu",item:"data-testid Nav menu item"},NavToolbar:{container:"data-testid Nav toolbar",shareDashboard:"data-testid Share dashboard",markAsFavorite:"data-testid Mark as favorite",editDashboard:{editButton:"data-testid Edit dashboard button",saveButton:"data-testid Save dashboard button",exitButton:"data-testid Exit edit mode button",settingsButton:"data-testid Dashboard settings",addRowButton:"data-testid Add row button",addLibraryPanelButton:"data-testid Add a panel from the panel library button",addVisualizationButton:"data-testid Add new visualization menu item",pastePanelButton:"data-testid Paste panel button",discardChangesButton:"data-testid Discard changes button",discardLibraryPanelButton:"data-testid Discard library panel button",unlinkLibraryPanelButton:"data-testid Unlink library panel button",saveLibraryPanelButton:"data-testid Save library panel button",backToDashboardButton:"data-testid Back to dashboard button"}},PageToolbar:{container:()=>".page-toolbar",item:n=>`${n}`,itemButton:n=>`data-testid ${n}`},QueryEditorToolbarItem:{button:n=>`QueryEditor toolbar item button ${n}`},BackButton:{backArrow:"data-testid Go Back"},OptionsGroup:{group:n=>n?`data-testid Options group ${n}`:"data-testid Options group",toggle:n=>n?`data-testid Options group ${n} toggle`:"data-testid Options group toggle"},PluginVisualization:{item:n=>`Plugin visualization item ${n}`,current:()=>'[class*="-currentVisualizationItem"]'},Select:{option:"data-testid Select option",input:()=>'input[id*="time-options-input"]',singleValue:()=>'div[class*="-singleValue"]'},FieldConfigEditor:{content:"Field config editor content"},OverridesConfigEditor:{content:"Field overrides editor content"},FolderPicker:{container:"Folder picker select container",containerV2:"data-testid Folder picker select container",input:"data-testid folder-picker-input"},ReadonlyFolderPicker:{container:"data-testid Readonly folder picker select container"},DataSourcePicker:{container:"data-testid Data source picker select container",input:()=>'input[id="data-source-picker"]',inputV2:"data-testid Select a data source",dataSourceList:"data-testid Data source list dropdown",advancedModal:{dataSourceList:"data-testid Data source list",builtInDataSourceList:"data-testid Built in data source list"}},TimeZonePicker:{container:"Time zone picker select container",containerV2:"data-testid Time zone picker select container",changeTimeSettingsButton:"data-testid Time zone picker Change time settings button"},WeekStartPicker:{container:"Choose starting day of the week",containerV2:"data-testid Choose starting day of the week",placeholder:"Choose starting day of the week"},TraceViewer:{spanBar:"data-testid SpanBar--wrapper"},QueryField:{container:"data-testid Query field"},QueryBuilder:{queryPatterns:"data-testid Query patterns",labelSelect:"data-testid Select label",inputSelect:"data-testid Select label-input",valueSelect:"data-testid Select value",matchOperatorSelect:"data-testid Select match operator"},ValuePicker:{button:n=>`data-testid Value picker button ${n}`,select:n=>`data-testid Value picker select ${n}`},Search:{section:"Search section",sectionV2:"data-testid Search section",items:"Search items",itemsV2:"data-testid Search items",cards:"data-testid Search cards",collapseFolder:n=>`data-testid Collapse folder ${n}`,expandFolder:n=>`data-testid Expand folder ${n}`,dashboardItem:n=>`${t.Search.dashboardItems} ${n}`,dashboardCard:n=>`data-testid Search card ${n}`,folderHeader:n=>`data-testid Folder header ${n}`,folderContent:n=>`data-testid Folder content ${n}`,dashboardItems:"data-testid Dashboard search item"},DashboardLinks:{container:"data-testid Dashboard link container",dropDown:"data-testid Dashboard link dropdown",link:"data-testid Dashboard link"},LoadingIndicator:{icon:"data-testid Loading indicator"},CallToActionCard:{button:n=>`Call to action button ${n}`,buttonV2:n=>`data-testid Call to action button ${n}`},DataLinksContextMenu:{singleLink:"data-testid Data link"},CodeEditor:{container:"data-testid Code editor container"},ReactMonacoEditor:{editorLazy:"data-testid ReactMonacoEditor editorLazy"},DashboardImportPage:{textarea:"data-testid-import-dashboard-textarea",submit:"data-testid-load-dashboard"},ImportDashboardForm:{name:"data-testid-import-dashboard-title",submit:"data-testid-import-dashboard-submit"},PanelAlertTabContent:{content:"data-testid Unified alert editor tab content"},VisualizationPreview:{card:n=>`data-testid suggestion-${n}`},ColorSwatch:{name:"data-testid-colorswatch"},DashboardRow:{title:n=>`data-testid dashboard-row-title-${n}`},UserProfile:{profileSaveButton:"data-testid-user-profile-save",preferencesSaveButton:"data-testid-shared-prefs-save",orgsTable:"data-testid-user-orgs-table",sessionsTable:"data-testid-user-sessions-table",extensionPointTabs:"data-testid-extension-point-tabs",extensionPointTab:n=>`data-testid-extension-point-tab-${n}`},FileUpload:{inputField:"data-testid-file-upload-input-field",fileNameSpan:"data-testid-file-upload-file-name"},DebugOverlay:{wrapper:"debug-overlay"},OrgRolePicker:{input:"Role"},AnalyticsToolbarButton:{button:"Dashboard insights"},Variables:{variableOption:"data-testid variable-option",variableLinkWrapper:"data-testid variable-link-wrapper"},Annotations:{annotationsTypeInput:"data-testid annotations-type-input",annotationsChoosePanelInput:"data-testid choose-panels-input",editor:{testButton:"data-testid annotations-test-button",resultContainer:"data-testid annotations-query-result-container"}},Tooltip:{container:"data-testid tooltip"},ReturnToPrevious:{buttonGroup:"data-testid dismissable button group",backButton:"data-testid back",dismissButton:"data-testid dismiss"},SQLQueryEditor:{selectColumn:"data-testid select-column",selectAggregation:"data-testid select-aggregation",selectAlias:"data-testid select-alias",filterConjunction:"data-testid filter-conjunction",filterField:"data-testid filter-field",filterOperator:"data-testid filter-operator",headerTableSelector:"data-testid header-table-selector",headerFilterSwitch:"data-testid header-filter-switch",headerGroupSwitch:"data-testid header-group-switch",headerOrderSwitch:"data-testid header-order-switch",headerPreviewSwitch:"data-testid header-preview-switch"},EntityNotFound:{container:"data-testid entity-not-found"}}},13544:(k,R,e)=>{"use strict";e.d(R,{Tp:()=>i});var t=e(13390);const i={pages:{Login:{url:"/login",username:"data-testid Username input field",password:"data-testid Password input field",submit:"data-testid Login button",skip:"data-testid Skip change password button"},Home:{url:"/"},DataSource:{name:"data-testid Data source settings page name input field",delete:"Data source settings page Delete button",readOnly:"data-testid Data source settings page read only message",saveAndTest:"data-testid Data source settings page Save and Test button",alert:"data-testid Data source settings page Alert"},DataSources:{url:"/datasources",dataSources:s=>`Data source list item ${s}`},EditDataSource:{url:s=>`/datasources/edit/${s}`,settings:"Datasource settings page basic settings"},AddDataSource:{url:"/datasources/new",dataSourcePlugins:s=>`Data source plugin item ${s}`,dataSourcePluginsV2:s=>`Add new data source ${s}`},ConfirmModal:{delete:"data-testid Confirm Modal Danger Button"},AddDashboard:{url:"/dashboard/new",itemButton:s=>`data-testid ${s}`,addNewPanel:"data-testid Add new panel",addNewRow:"data-testid Add new row",addNewPanelLibrary:"data-testid Add new panel from panel library"},Dashboard:{url:s=>`/d/${s}`,DashNav:{nav:"Dashboard navigation",navV2:"data-testid Dashboard navigation",publicDashboardTag:"data-testid public dashboard tag",shareButton:"data-testid share-button",scrollContainer:"data-testid Dashboard canvas scroll container",newShareButton:{container:"data-testid new share button",shareLink:"data-testid new share link-button",arrowMenu:"data-testid new share button arrow menu",menu:{container:"data-testid new share button menu",shareInternally:"data-testid new share button share internally",shareExternally:"data-testid new share button share externally",shareSnapshot:"data-testid new share button share snapshot"}},NewExportButton:{container:"data-testid new export button",arrowMenu:"data-testid new export button arrow menu",Menu:{container:"data-testid new export button menu",exportAsJson:"data-testid new export button export as json"}},playlistControls:{prev:"data-testid playlist previous dashboard button",stop:"data-testid playlist stop dashboard button",next:"data-testid playlist next dashboard button"}},Controls:"data-testid dashboard controls",SubMenu:{submenu:"Dashboard submenu",submenuItem:"data-testid template variable",submenuItemLabels:s=>`data-testid Dashboard template variables submenu Label ${s}`,submenuItemValueDropDownValueLinkTexts:s=>`data-testid Dashboard template variables Variable Value DropDown value link text ${s}`,submenuItemValueDropDownDropDown:"Variable options",submenuItemValueDropDownOptionTexts:s=>`data-testid Dashboard template variables Variable Value DropDown option text ${s}`,Annotations:{annotationsWrapper:"data-testid annotation-wrapper",annotationLabel:s=>`data-testid Dashboard annotations submenu Label ${s}`,annotationToggle:s=>`data-testid Dashboard annotations submenu Toggle ${s}`}},Settings:{Actions:{close:"data-testid dashboard-settings-close"},General:{deleteDashBoard:"data-testid Dashboard settings page delete dashboard button",sectionItems:s=>`Dashboard settings section item ${s}`,saveDashBoard:"Dashboard settings aside actions Save button",saveAsDashBoard:"Dashboard settings aside actions Save As button",timezone:"Time zone picker select container",title:"General"},Annotations:{List:{addAnnotationCTA:t.X.CallToActionCard.button("Add annotation query"),addAnnotationCTAV2:t.X.CallToActionCard.buttonV2("Add annotation query"),annotations:"data-testid list-annotations"},Settings:{name:"data-testid Annotations settings name input"},NewAnnotation:{panelFilterSelect:"data-testid annotations-panel-filter",showInLabel:"data-testid show-in-label",previewInDashboard:"data-testid annotations-preview",delete:"data-testid annotations-delete",apply:"data-testid annotations-apply",enable:"data-testid annotation-enable",hide:"data-testid annotation-hide"}},Variables:{List:{addVariableCTA:t.X.CallToActionCard.button("Add variable"),addVariableCTAV2:t.X.CallToActionCard.buttonV2("Add variable"),newButton:"Variable editor New variable button",table:"Variable editor Table",tableRowNameFields:s=>`Variable editor Table Name field ${s}`,tableRowDefinitionFields:s=>`Variable editor Table Definition field ${s}`,tableRowArrowUpButtons:s=>`Variable editor Table ArrowUp button ${s}`,tableRowArrowDownButtons:s=>`Variable editor Table ArrowDown button ${s}`,tableRowDuplicateButtons:s=>`Variable editor Table Duplicate button ${s}`,tableRowRemoveButtons:s=>`Variable editor Table Remove button ${s}`},Edit:{General:{headerLink:"Variable editor Header link",modeLabelNew:"Variable editor Header mode New",modeLabelEdit:"Variable editor Header mode Edit",generalNameInput:"Variable editor Form Name field",generalNameInputV2:"data-testid Variable editor Form Name field",generalTypeSelect:"Variable editor Form Type select",generalTypeSelectV2:"data-testid Variable editor Form Type select",generalLabelInput:"Variable editor Form Label field",generalLabelInputV2:"data-testid Variable editor Form Label field",generalHideSelect:"Variable editor Form Hide select",generalHideSelectV2:"data-testid Variable editor Form Hide select",selectionOptionsMultiSwitch:"data-testid Variable editor Form Multi switch",selectionOptionsIncludeAllSwitch:"data-testid Variable editor Form IncludeAll switch",selectionOptionsCustomAllInput:"data-testid Variable editor Form IncludeAll field",previewOfValuesOption:"data-testid Variable editor Preview of Values option",submitButton:"data-testid Variable editor Run Query button",applyButton:"data-testid Variable editor Apply button"},QueryVariable:{queryOptionsDataSourceSelect:t.X.DataSourcePicker.inputV2,queryOptionsRefreshSelect:"Variable editor Form Query Refresh select",queryOptionsRefreshSelectV2:"data-testid Variable editor Form Query Refresh select",queryOptionsRegExInput:"Variable editor Form Query RegEx field",queryOptionsRegExInputV2:"data-testid Variable editor Form Query RegEx field",queryOptionsSortSelect:"Variable editor Form Query Sort select",queryOptionsSortSelectV2:"data-testid Variable editor Form Query Sort select",queryOptionsQueryInput:"data-testid Variable editor Form Default Variable Query Editor textarea",valueGroupsTagsEnabledSwitch:"Variable editor Form Query UseTags switch",valueGroupsTagsTagsQueryInput:"Variable editor Form Query TagsQuery field",valueGroupsTagsTagsValuesQueryInput:"Variable editor Form Query TagsValuesQuery field"},ConstantVariable:{constantOptionsQueryInput:"Variable editor Form Constant Query field",constantOptionsQueryInputV2:"data-testid Variable editor Form Constant Query field"},DatasourceVariable:{datasourceSelect:"data-testid datasource variable datasource type"},TextBoxVariable:{textBoxOptionsQueryInput:"Variable editor Form TextBox Query field",textBoxOptionsQueryInputV2:"data-testid Variable editor Form TextBox Query field"},CustomVariable:{customValueInput:"data-testid custom-variable-input"},IntervalVariable:{intervalsValueInput:"data-testid interval variable intervals input",autoEnabledCheckbox:"data-testid interval variable auto value checkbox",stepCountIntervalSelect:"data-testid interval variable step count input",minIntervalInput:"data-testid interval variable mininum interval input"},GroupByVariable:{dataSourceSelect:t.X.DataSourcePicker.inputV2,infoText:"data-testid group by variable info text",modeToggle:"data-testid group by variable mode toggle"},AdHocFiltersVariable:{datasourceSelect:t.X.DataSourcePicker.inputV2,infoText:"data-testid ad-hoc filters variable info text",modeToggle:"data-testid ad-hoc filters variable mode toggle"}}}},Annotations:{marker:"data-testid annotation-marker"},Rows:{Repeated:{ConfigSection:{warningMessage:"data-testid Repeated rows warning message"}}}},Dashboards:{url:"/dashboards",dashboards:s=>`Dashboard search item ${s}`},SaveDashboardAsModal:{newName:"Save dashboard title field",save:"Save dashboard button"},SaveDashboardModal:{save:"Dashboard settings Save Dashboard Modal Save button",saveVariables:"Dashboard settings Save Dashboard Modal Save variables checkbox",saveTimerange:"Dashboard settings Save Dashboard Modal Save timerange checkbox",saveRefresh:"Dashboard settings Save Dashboard Modal Save refresh checkbox"},SharePanelModal:{linkToRenderedImage:"Link to rendered image"},ShareDashboardModal:{PublicDashboard:{WillBePublicCheckbox:"data-testid public dashboard will be public checkbox",LimitedDSCheckbox:"data-testid public dashboard limited datasources checkbox",CostIncreaseCheckbox:"data-testid public dashboard cost may increase checkbox",PauseSwitch:"data-testid public dashboard pause switch",EnableAnnotationsSwitch:"data-testid public dashboard on off switch for annotations",CreateButton:"data-testid public dashboard create button",DeleteButton:"data-testid public dashboard delete button",CopyUrlInput:"data-testid public dashboard copy url input",CopyUrlButton:"data-testid public dashboard copy url button",SettingsDropdown:"data-testid public dashboard settings dropdown",TemplateVariablesWarningAlert:"data-testid public dashboard disabled template variables alert",UnsupportedDataSourcesWarningAlert:"data-testid public dashboard unsupported data sources alert",NoUpsertPermissionsWarningAlert:"data-testid public dashboard no upsert permissions alert",EnableTimeRangeSwitch:"data-testid public dashboard on off switch for time range",EmailSharingConfiguration:{Container:"data-testid email sharing config container",ShareType:"data-testid public dashboard share type",EmailSharingInput:"data-testid public dashboard email sharing input",EmailSharingInviteButton:"data-testid public dashboard email sharing invite button",EmailSharingList:"data-testid public dashboard email sharing list",DeleteEmail:"data-testid public dashboard delete email button",ReshareLink:"data-testid public dashboard reshare link button"}},SnapshotScene:{url:s=>`/dashboard/snapshot/${s}`,PublishSnapshot:"data-testid publish snapshot button",CopyUrlButton:"data-testid snapshot copy url button",CopyUrlInput:"data-testid snapshot copy url input"}},ShareDashboardDrawer:{ShareExternally:{container:"data-testid share externally drawer container",copyUrlButton:"data-testid share externally copy url button",shareTypeSelect:"data-testid share externally share type select"},ShareSnapshot:{container:"data-testid share snapshot drawer container"}},ExportDashboardDrawer:{ExportAsJson:{container:"data-testid export as Json drawer container",codeEditor:"data-testid export as Json code editor",exportExternallyToggle:"data-testid export externally toggle type select",saveToFileButton:"data-testid save to file button",copyToClipboardButton:"data-testid copy to clipboard button",cancelButton:"data-testid cancel button"}},PublicDashboard:{page:"public-dashboard-page",NotAvailable:{container:"public-dashboard-not-available",title:"public-dashboard-title",pausedDescription:"public-dashboard-paused-description"},footer:"public-dashboard-footer"},PublicDashboardScene:{loadingPage:"public-dashboard-scene-loading-page",page:"public-dashboard-scene-page",controls:"public-dashboard-controls"},RequestViewAccess:{form:"request-view-access-form",recipientInput:"request-view-access-recipient-input",submitButton:"request-view-access-submit-button"},PublicDashboardConfirmAccess:{submitButton:"data-testid confirm-access-submit-button"},Explore:{url:"/explore",General:{container:"data-testid Explore",graph:"Explore Graph",table:"Explore Table",scrollView:"data-testid explorer scroll view"},QueryHistory:{container:"data-testid QueryHistory"}},SoloPanel:{url:s=>`/d-solo/${s}`},PluginsList:{page:"Plugins list page",list:"Plugins list",listItem:"Plugins list item",signatureErrorNotice:"data-testid Unsigned plugins notice"},PluginPage:{page:"Plugin page",signatureInfo:"data-testid Plugin signature info",disabledInfo:"data-testid Plugin disabled info"},PlaylistForm:{name:"Playlist name",interval:"Playlist interval",itemDelete:"data-testid playlist-form-delete-item"},BrowseDashboards:{table:{body:"data-testid browse-dashboards-table",row:s=>`data-testid browse dashboards row ${s}`,checkbox:s=>`data-testid ${s} checkbox`},NewFolderForm:{form:"data-testid new folder form",nameInput:"data-testid new-folder-name-input",createButton:"data-testid new-folder-create-button"}},Search:{url:"/?search=openn",FolderView:{url:"/?search=open&layout=folders"}},PublicDashboards:{ListItem:{linkButton:"public-dashboard-link-button",configButton:"public-dashboard-configuration-button",trashcanButton:"public-dashboard-remove-button",pauseSwitch:"data-testid public dashboard pause switch"}},UserListPage:{tabs:{allUsers:"data-testid all-users-tab",orgUsers:"data-testid org-users-tab",anonUserDevices:"data-testid anon-user-devices-tab",publicDashboardsUsers:"data-testid public-dashboards-users-tab",users:"data-testid users-tab"},org:{url:"/org/users"},admin:{url:"/admin/users"},publicDashboards:{container:"data-testid public-dashboards-users-list"},UserListAdminPage:{container:"data-testid user-list-admin-page"},UsersListPage:{container:"data-testid users-list-page"},UserAnonListPage:{container:"data-testid user-anon-list-page"},UsersListPublicDashboardsPage:{container:"data-testid users-list-public-dashboards-page",DashboardsListModal:{listItem:s=>`data-testid dashboards-list-item-${s}`}}},ProfilePage:{url:"/profile"}},components:t.X}},76365:(k,R,e)=>{"use strict";e.d(R,{S6:()=>h,Jz:()=>m,oA:()=>p,Ik:()=>d});var t=e(11261),n=e(75972),i=e(57875),s=e(5546),r=e(2543);function g(l,y){const u=a(l);return c(u,y,"parents")}function a(l){return l.map(y=>{if(!y.parents?.length)return y;const u={...y,children:[]},D=[{child:u,parent:y.parents[0]}];for(;D.length;){const E=D.shift(),x={...E.parent,children:E.child?[E.child]:[],parents:[]};E.child&&(x.value=E.child.value,E.child.parents=[x]),E.parent.parents?.length&&D.push({child:x,parent:E.parent.parents[0]})}return u})}function c(l,y,u="children"){const D=u==="parents"?"children":"parents",E=[],x=[{previous:void 0,items:l,level:0}];for(;x.length;){const P=x.shift(),b=P.items.flatMap(T=>T.itemIndexes),M={value:P.items.reduce((T,C)=>T+C.value,0),itemIndexes:b,children:[],parents:[],start:0,level:P.level};if(E[P.level]=E[P.level]||[],E[P.level].push(M),P.previous){M[D]=[P.previous];const T=P.previous[u]?.reduce((C,S)=>C+S.value,0)||0;M.start=P.previous.start+T,P.previous[u].push(M)}const O=P.items.flatMap(T=>T[u]||[]),I=(0,r.groupBy)(O,T=>y.getLabel(T.itemIndexes[0]));for(const T of Object.values(I))x.push({previous:M,items:T,level:P.level+1})}return u==="parents"&&(E.reverse(),E.forEach((P,b)=>{P.forEach(M=>{M.level=b})})),E}function o(l,y){const u=[];let D=0,E;const x={};for(let b=0;b<l.data.length;b++){const M=l.getLevel(b),O=b>0?l.getLevel(b-1):void 0;if(u[M]=u[M]||[],O&&O>=M){const T=u[M][u[M].length-1];D=T.start+l.getValue(T.itemIndexes[0])+l.getValueRight(T.itemIndexes[0]),E=T.parents[0]}const I={itemIndexes:[b],value:l.getValue(b)+l.getValueRight(b),valueRight:l.isDiffFlamegraph()?l.getValueRight(b):void 0,start:D,parents:E&&[E],children:[],level:M};x[l.getLabel(b)]?x[l.getLabel(b)].push(I):x[l.getLabel(b)]=[I],E&&E.children.push(I),E=I,u[M].push(I)}const P=new f(y?.collapsingThreshold);return y?.collapsing&&P.addTree(u[0][0]),[u,x,P.getCollapsedMap()]}class h{constructor(y){this.map=new Map,this.map=y||new Map}get(y){return this.map.get(y)}keys(){return this.map.keys()}values(){return this.map.values()}size(){return this.map.size}setCollapsedStatus(y,u){const D=new Map(this.map),E=this.map.get(y),x={...E,collapsed:u};for(const P of E.items)D.set(P,x);return new h(D)}setAllCollapsedStatus(y){const u=new Map(this.map);for(const D of this.map.keys()){const x={...this.map.get(D),collapsed:y};u.set(D,x)}return new h(u)}}class f{constructor(y){this.map=new Map,this.threshold=.99,y!==void 0&&(this.threshold=y)}addTree(y){const u=[y];for(;u.length;){const D=u.shift();D.parents?.length&&this.addItem(D,D.parents[0]),D.children.length&&u.unshift(...D.children)}}addItem(y,u){if(u&&y.value>u.value*this.threshold&&u.children.length===1)if(this.map.has(u)){const D=this.map.get(u);this.map.set(y,D),D.items.push(y)}else{const D={items:[u,y],collapsed:!0};this.map.set(u,D),this.map.set(y,D)}}getCollapsedMap(){return new h(this.map)}}function d(l){return l.missingFields.length?`Data is missing fields: ${l.missingFields.join(", ")}`:l.wrongTypeFields.length?`Data has fields of wrong type: ${l.wrongTypeFields.map(y=>`${y.name} has type ${y.type} but should be ${y.expectedTypes.join(" or ")}`).join(", ")}`:""}function p(l){const y=[["label",[t.PU.string,t.PU.enum]],["level",[t.PU.number]],["value",[t.PU.number]],["self",[t.PU.number]]],u=[],D=[];for(const E of y){const[x,P]=E,b=l.fields.find(M=>M.name===x);if(!b){u.push(x);continue}P.includes(b.type)||D.push({name:x,expectedTypes:P,type:b.type})}if(u.length>0||D.length>0)return{wrongTypeFields:D,missingFields:u}}class m{constructor(y,u,D=(0,n.a)()){this.data=y,this.options=u;const E=p(y);if(E)throw new Error(d(E));if(this.labelField=y.fields.find(P=>P.name==="label"),this.levelField=y.fields.find(P=>P.name==="level"),this.valueField=y.fields.find(P=>P.name==="value"),this.selfField=y.fields.find(P=>P.name==="self"),this.valueRightField=y.fields.find(P=>P.name==="valueRight"),this.selfRightField=y.fields.find(P=>P.name==="selfRight"),(this.valueField||this.selfField)&&!(this.valueField&&this.selfField))throw new Error("Malformed dataFrame: both valueRight and selfRight has to be present if one of them is present.");const x=this.labelField?.config?.type?.enum;x?(this.labelDisplayProcessor=(0,i.J)({field:this.labelField,theme:D}),this.uniqueLabels=x.text||[]):(this.labelDisplayProcessor=P=>({text:P+"",numeric:0}),this.uniqueLabels=[...new Set(this.labelField.values)]),this.valueDisplayProcessor=(0,i.J)({field:this.valueField,theme:D})}isDiffFlamegraph(){return!!(this.valueRightField&&this.selfRightField)}getLabel(y){return this.labelDisplayProcessor(this.labelField.values[y]).text}getLevel(y){return this.levelField.values[y]}getValue(y){return v(this.valueField,y)}getValueRight(y){return v(this.valueRightField,y)}getSelf(y){return v(this.selfField,y)}getSelfRight(y){return v(this.selfRightField,y)}getSelfDisplay(y){return this.valueDisplayProcessor(this.getSelf(y))}getUniqueLabels(){return this.uniqueLabels}getUnitTitle(){switch(this.valueField.config.unit){case s.Zk.Bytes:return"RAM";case s.Zk.Nanoseconds:return"Time"}return"Count"}getLevels(){return this.initLevels(),this.levels}getSandwichLevels(y){const u=this.getNodesWithLabel(y);if(!u?.length)return[[],[]];const D=g(u,this),E=c(u,this);return[D,E]}getNodesWithLabel(y){return this.initLevels(),this.uniqueLabelsMap[y]}getCollapsedMap(){return this.initLevels(),this.collapsedMap}initLevels(){if(!this.levels){const[y,u,D]=o(this,this.options);this.levels=y,this.uniqueLabelsMap=u,this.collapsedMap=D}}}function v(l,y){return l?(typeof y=="number"?[y]:y).reduce((D,E)=>D+l.values[E],0):0}},85194:(k,R,e)=>{"use strict";e.d(R,{A:()=>Kn});var t=e(74848),n=e(32196),i=e(53076),s=e(96540),r=e(49185),g=e(60578),a=e(14578);const c=22*window.devicePixelRatio,o=10*window.devicePixelRatio,h=.5*window.devicePixelRatio,f=20*window.devicePixelRatio,d=.5*window.devicePixelRatio,p=4*window.devicePixelRatio,m=3*window.devicePixelRatio,v=3*window.devicePixelRatio,l=4*window.devicePixelRatio,y=2*window.devicePixelRatio,u=800,D=120;var E=e(64539),x=e(59093),P=e(28122);const M=({data:Bt,itemData:an,onMenuItemClick:tn,onItemFocus:Cn,onSandwich:xn,collapseConfig:Vn,onExpandGroup:Et,onCollapseGroup:Ft,onExpandAllGroups:Gt,onCollapseAllGroups:ln,getExtraContextMenuButtons:qt,collapsing:cn,allGroupsExpanded:En,allGroupsCollapsed:Sn,selectedView:Tn,search:Wn})=>{function Nn(){const Tt=qt?.(an,Bt.data,{selectedView:Tn,isDiff:Bt.isDiffFlamegraph(),search:Wn,collapseConfig:Vn})||[];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(E.D,{label:"Focus block",icon:"eye",onClick:()=>{Cn(),tn()}}),(0,t.jsx)(E.D,{label:"Copy function name",icon:"copy",onClick:()=>{navigator.clipboard.writeText(an.label).then(()=>{tn()})}}),(0,t.jsx)(E.D,{label:"Sandwich view",icon:"gf-show-context",onClick:()=>{xn(),tn()}}),Tt.map(({label:Wt,icon:jt,onClick:ut})=>(0,t.jsx)(E.D,{label:Wt,icon:jt,onClick:()=>ut()},Wt)),cn&&(0,t.jsxs)(x.r,{label:"Grouping",children:[Vn?Vn.collapsed?(0,t.jsx)(E.D,{label:"Expand group",icon:"angle-double-down",onClick:()=>{Et(),tn()}}):(0,t.jsx)(E.D,{label:"Collapse group",icon:"angle-double-up",onClick:()=>{Ft(),tn()}}):null,!En&&(0,t.jsx)(E.D,{label:"Expand all groups",icon:"angle-double-down",onClick:()=>{Gt(),tn()}}),!Sn&&(0,t.jsx)(E.D,{label:"Collapse all groups",icon:"angle-double-up",onClick:()=>{ln(),tn()}})]})]})}return(0,t.jsx)("div",{"data-testid":"contextMenu",children:(0,t.jsx)(P.t,{renderMenuItems:Nn,x:an.posX+10,y:an.posY,focusOnOpen:!1})})};var O=e(83195),I=e(40845),T=e(48840),C=e(17464),S=e(69503);const A=({data:Bt,item:an,totalTicks:tn,position:Cn,collapseConfig:xn})=>{const Vn=(0,I.of)(w);if(!(an&&Cn))return null;let Et;if(Bt.isDiffFlamegraph()){const Ft=N(Bt,an,tn);Et=(0,t.jsx)(T.j,{className:Vn.tooltipTable,columns:[{id:"label",header:""},{id:"baseline",header:"Baseline"},{id:"comparison",header:"Comparison"},{id:"diff",header:"Diff"}],data:Ft,getRowId:Gt=>Gt.rowId})}else{const Ft=L(Bt,an,tn);Et=(0,t.jsxs)("p",{className:Vn.lastParagraph,children:[Ft.unitTitle,(0,t.jsx)("br",{}),"Total: ",(0,t.jsx)("b",{children:Ft.unitValue})," (",Ft.percentValue,"%)",(0,t.jsx)("br",{}),"Self: ",(0,t.jsx)("b",{children:Ft.unitSelf})," (",Ft.percentSelf,"%)",(0,t.jsx)("br",{}),"Samples: ",(0,t.jsx)("b",{children:Ft.samples})]})}return(0,t.jsx)(C.ZL,{children:(0,t.jsx)(S.o,{className:Vn.tooltipContainer,position:Cn,offset:{x:15,y:0},children:(0,t.jsxs)("div",{className:Vn.tooltipContent,children:[(0,t.jsxs)("p",{className:Vn.tooltipName,children:[Bt.getLabel(an.itemIndexes[0]),xn&&xn.collapsed?(0,t.jsxs)("span",{children:[(0,t.jsx)("br",{}),"and ",xn.items.length," similar items"]}):""]}),Et]})})})},L=(Bt,an,tn)=>{const Cn=Bt.valueDisplayProcessor(an.value),xn=Bt.getSelfDisplay(an.itemIndexes),Vn=Math.round(1e4*(Cn.numeric/tn))/100,Et=Math.round(1e4*(xn.numeric/tn))/100;let Ft=Cn.text+Cn.suffix,Gt=xn.text+xn.suffix;const ln=Bt.getUnitTitle();return ln==="Count"&&(Cn.suffix||(Ft=Cn.text),xn.suffix||(Gt=xn.text)),{percentValue:Vn,percentSelf:Et,unitTitle:ln,unitValue:Ft,unitSelf:Gt,samples:Cn.numeric.toLocaleString()}},N=(Bt,an,tn)=>{const xn=Bt.getLevels()[0][0].valueRight,Vn=tn-xn,Et=an.value-an.valueRight,Ft=Math.round(1e4*Et/Vn)/100,Gt=Math.round(1e4*an.valueRight/xn)/100,ln=(Gt-Ft)/Ft*100,qt=F(Bt,Bt.valueDisplayProcessor(Et)),cn=F(Bt,Bt.valueDisplayProcessor(an.valueRight)),En=(0,O.j_)("short");return[{rowId:"1",label:"% of total",baseline:Ft+"%",comparison:Gt+"%",diff:En(ln).text+"%"},{rowId:"2",label:"Value",baseline:qt,comparison:cn,diff:F(Bt,Bt.valueDisplayProcessor(an.valueRight-Et))},{rowId:"3",label:"Samples",baseline:En(Et).text,comparison:En(an.valueRight).text,diff:En(an.valueRight-Et).text}]};function F(Bt,an){let tn=an.text+an.suffix;return Bt.getUnitTitle()==="Count"&&(an.suffix||(tn=an.text)),tn}const w=Bt=>({tooltipContainer:(0,n.css)({title:"tooltipContainer",overflow:"hidden"}),tooltipContent:(0,n.css)({title:"tooltipContent",fontSize:Bt.typography.bodySmall.fontSize,width:"100%"}),tooltipName:(0,n.css)({title:"tooltipName",marginTop:0,wordBreak:"break-all"}),lastParagraph:(0,n.css)({title:"lastParagraph",marginBottom:0}),name:(0,n.css)({title:"name",marginBottom:"10px"}),tooltipTable:(0,n.css)({title:"tooltipTable",maxWidth:"400px"})}),B=A;var U=e(84140),K=e(5546),V=e(21313);function H(Bt,an=0){let tn,Cn,xn,Vn,Et,Ft,Gt,ln;for(tn=Bt.length&3,Cn=Bt.length-tn,xn=an,Et=3432918353,Ft=461845907,ln=0;ln<Cn;)Gt=Bt.charCodeAt(ln)&255|(Bt.charCodeAt(++ln)&255)<<8|(Bt.charCodeAt(++ln)&255)<<16|(Bt.charCodeAt(++ln)&255)<<24,++ln,Gt=(Gt&65535)*Et+(((Gt>>>16)*Et&65535)<<16)&4294967295,Gt=Gt<<15|Gt>>>17,Gt=(Gt&65535)*Ft+(((Gt>>>16)*Ft&65535)<<16)&4294967295,xn^=Gt,xn=xn<<13|xn>>>19,Vn=(xn&65535)*5+(((xn>>>16)*5&65535)<<16)&4294967295,xn=(Vn&65535)+27492+(((Vn>>>16)+58964&65535)<<16);switch(Gt=0,tn){case 3:Gt^=(Bt.charCodeAt(ln+2)&255)<<16;case 2:Gt^=(Bt.charCodeAt(ln+1)&255)<<8;case 1:Gt^=Bt.charCodeAt(ln)&255;default:Gt=(Gt&65535)*Et+(((Gt>>>16)*Et&65535)<<16)&4294967295,Gt=Gt<<15|Gt>>>17,Gt=(Gt&65535)*Ft+(((Gt>>>16)*Ft&65535)<<16)&4294967295,xn^=Gt}return xn^=Bt.length,xn^=xn>>>16,xn=(xn&65535)*2246822507+(((xn>>>16)*2246822507&65535)<<16)&4294967295,xn^=xn>>>13,xn=(xn&65535)*3266489909+(((xn>>>16)*3266489909&65535)<<16)&4294967295,xn^=xn>>>16,xn>>>0}const Y=[(0,U.A)({h:24,s:69,l:60}),(0,U.A)({h:34,s:65,l:65}),(0,U.A)({h:194,s:52,l:61}),(0,U.A)({h:163,s:45,l:55}),(0,U.A)({h:211,s:48,l:60}),(0,U.A)({h:246,s:40,l:65}),(0,U.A)({h:305,s:63,l:79}),(0,U.A)({h:47,s:100,l:73}),(0,U.A)({r:183,g:219,b:171}),(0,U.A)({r:244,g:213,b:152}),(0,U.A)({r:78,g:146,b:249}),(0,U.A)({r:249,g:186,b:143}),(0,U.A)({r:242,g:145,b:145}),(0,U.A)({r:130,g:181,b:216}),(0,U.A)({r:229,g:168,b:226}),(0,U.A)({r:174,g:162,b:224}),(0,U.A)({r:154,g:196,b:138}),(0,U.A)({r:242,g:201,b:109}),(0,U.A)({r:101,g:197,b:219}),(0,U.A)({r:249,g:147,b:78}),(0,U.A)({r:234,g:100,b:96}),(0,U.A)({r:81,g:149,b:206}),(0,U.A)({r:214,g:131,b:206}),(0,U.A)({r:128,g:110,b:183})],X=j(1,100,0,1),J=j(100,100,0,1),q=`linear-gradient(90deg, ${X} 0%, ${J} 100%)`,ae=`linear-gradient(90deg, ${Y[0]} 0%, ${Y[2]} 30%, ${Y[6]} 50%, ${Y[7]} 70%, ${Y[8]} 100%)`;function j(Bt,an,tn,Cn){const xn=Math.min(1,Bt/an/(Cn-tn)),Vn=50-50*xn,Et=65+7*xn;return(0,U.A)({h:Vn,s:100,l:Et})}function te(Bt,an){const tn=Z(Bt),xn=H(tn||"",0)%Y.length;let Vn=Y[xn].clone();return an.isLight&&(Vn=Vn.brighten(15)),Vn}const ne=["rgb(0, 170, 0)","rgb(148, 142, 142)","rgb(200, 0, 0)"],le=`linear-gradient(90deg, ${ne[0]} 0%, ${ne[1]} 50%, ${ne[2]} 100%)`,z=["rgb(26, 133, 255)","rgb(148, 142, 142)","rgb(220, 50, 32)"],ee=`linear-gradient(90deg, ${z[0]} 0%, ${z[1]} 50%, ${z[2]} 100%)`;function se(Bt,an,tn,Cn,xn){const Vn=xn===K.yU.Default?ne:z,Et=(0,V.scaleLinear)().domain([-100,0,100]).range(Vn),Ft=Bt-an,Gt=tn-Cn;if(Cn===0||Gt===0){const Sn=Et(0);return(0,U.A)(Sn)}const ln=Math.round(1e4*Ft/Gt)/100,cn=(Math.round(1e4*an/Cn)/100-ln)/ln*100,En=Et(cn);return(0,U.A)(En)}const ie=[["phpspy",/^(?<packageName>([^\/]*\/)*)(?<filename>.*\.php+)(?<line_info>.*)$/],["pyspy",/^(?<packageName>([^\/]*\/)*)(?<filename>.*\.py+)(?<line_info>.*)$/],["rbspy",/^(?<packageName>([^\/]*\/)*)(?<filename>.*\.rb+)(?<line_info>.*)$/],["nodespy",/^(\.\/node_modules\/)?(?<packageName>[^/]*)(?<filename>.*\.?(jsx?|tsx?)?):(?<functionName>.*):(?<line_info>.*)$/],["gospy",/^(?<packageName>.*?\/.*?\.|.*?\.|.+)(?<functionName>.*)$/],["javaspy",/^(?<packageName>.+\/)(?<filename>.+\.)(?<functionName>.+)$/],["dotnetspy",/^(?<packageName>.+)\.(.+)\.(.+)\(.*\)$/],["tracing",/^(?<packageName>.+?):.*$/],["pyroscope-rs",/^(?<packageName>[^::]+)/],["ebpfspy",/^(?<packageName>.+)$/],["unknown",/^(?<packageName>.+)$/]];function Z(Bt){for(const[an,tn]of ie){const Cn=Bt.match(tn);if(Cn)return Cn.groups?.packageName||""}}function oe(Bt){const{canvasRef:an,data:tn,root:Cn,depth:xn,direction:Vn,wrapperWidth:Et,rangeMin:Ft,rangeMax:Gt,matchedLabels:ln,textAlign:qt,totalViewTicks:cn,totalColorTicks:En,totalTicksRight:Sn,colorScheme:Tn,focusedItemData:Wn,collapsedMap:Nn}=Bt,Tt=De(an,Et,xn),Wt=(0,I.$j)(),jt=(0,s.useMemo)(()=>{const jn=(0,U.A)(Wt.colors.background.secondary);return Wt.isLight?jn.darken(10).toHexString():jn.lighten(10).toHexString()},[Wt]),ut=ue(En,Sn,Tn,Wt,jt,Ft,Gt,ln,Wn?Wn.item.level:0),Zt=ce(Tt,tn,ut,qt,Nn);(0,s.useEffect)(()=>{if(!Tt)return;Tt.clearRect(0,0,Tt.canvas.width,Tt.canvas.height);const jn=new Path2D;re(Cn,Vn,tn,cn,Ft,Gt,Et,Nn,(Xn,Qn,Fn,qn,js,ys,Ps)=>{Ps?jn.rect(Qn,Fn,qn,js):Zt(Xn,Qn,Fn,qn,js,ys)}),Tt.fillStyle=jt,Tt.fill(jn)},[Tt,tn,Cn,Et,Ft,Gt,cn,Vn,Zt,Nn,jt])}function ce(Bt,an,tn,Cn,xn){return(0,s.useMemo)(()=>Bt?(Et,Ft,Gt,ln,qt,cn)=>{Bt.beginPath(),Bt.rect(Ft+d,Gt,ln,qt),Bt.fillStyle=tn(Et,cn,!1),Bt.stroke(),Bt.fill();const En=xn.get(Et);let Sn=cn;En&&En.collapsed&&(Sn=`(${En.items.length}) `+cn),ln>=f&&(En?(ge(Bt,an,Sn,Et,ln,Cn==="left"?Ft+l+y:Ft,Gt,Cn),ye(Bt,Ft,Gt,qt,Et,En)):ge(Bt,an,Sn,Et,ln,Ft,Gt,Cn))}:()=>{},[Bt,tn,Cn,an,xn])}function ye(Bt,an,tn,Cn,xn,Vn){const Et=an+l;Bt.beginPath(),Bt.rect(an,tn,Et-an+m+v,Cn),Bt.fill(),Bt.beginPath(),Vn.collapsed?Bt.rect(Et,tn+Cn/4,m,Cn/2):Vn.items[0]===xn?Bt.rect(Et,tn+Cn/2,m,Cn/2):Vn.items[Vn.items.length-1]===xn?Bt.rect(Et,tn,m,Cn/2):Bt.rect(Et,tn,m,Cn),Bt.fillStyle="#666",Bt.fill()}function re(Bt,an,tn,Cn,xn,Vn,Et,Ft,Gt){const ln=[];ln.push({item:Bt,levelOffset:0});const qt=Et*window.devicePixelRatio/Cn/(Vn-xn);let cn;for(;ln.length>0;){const{item:En,levelOffset:Sn}=ln.shift();let Tn=En.value;const Wn=Tn*qt<=o,Nn=Tn*qt-(Wn?0:d*2),Tt=c;if(Nn<h)continue;let Wt=0,jt=!1;const ut=Ft.get(En),Zt=ut&&ut.collapsed;if(Zt&&cn===ut.items[0]?(Wt=an==="children"?-1:1,jt=!0):cn=void 0,!jt){const Xn=Te(En.start,Cn,xn,qt),Qn=(En.level+Sn)*c;let Fn=tn.getLabel(En.itemIndexes[0]);Zt&&(cn=En),Gt(En,Xn,Qn,Nn,Tt,Fn,Wn)}const jn=an==="children"?En.children:En.parents;jn&&ln.unshift(...jn.map(Xn=>({item:Xn,levelOffset:Sn+Wt})))}}function ue(Bt,an,tn,Cn,xn,Vn,Et,Ft,Gt){return(0,s.useCallback)(function(qt,cn,En){if(En&&!Ft)return xn;const Sn=qt.valueRight!==void 0&&(tn===K.yU.Default||tn===K.yU.DiffColorBlind)?se(qt.value,qt.valueRight,Bt,an,tn):tn===K.zM.ValueBased?j(qt.value,Bt,Vn,Et):te(cn,Cn);return Ft?Ft.has(cn)?Sn.toHslString():xn:qt.level>Gt-1?Sn.toHslString():Sn.lighten(15).toHslString()},[Bt,an,tn,Cn,Vn,Et,Ft,Gt,xn])}function De(Bt,an,tn){const[Cn,xn]=(0,s.useState)();return(0,s.useEffect)(()=>{if(!(tn&&Bt.current))return;const Vn=Bt.current.getContext("2d"),Et=c*tn;Bt.current.width=Math.round(an*window.devicePixelRatio),Bt.current.height=Math.round(Et),Bt.current.style.width=`${an}px`,Bt.current.style.height=`${Et/window.devicePixelRatio}px`,Vn.textBaseline="middle",Vn.font=12*window.devicePixelRatio+"px monospace",Vn.strokeStyle="white",xn(Vn)},[Bt,xn,an,tn]),Cn}function ge(Bt,an,tn,Cn,xn,Vn,Et,Ft){Bt.save(),Bt.clip(),Bt.fillStyle="#222";const Gt=an.valueDisplayProcessor(Cn.value),ln=Gt.suffix?Gt.text+Gt.suffix:Gt.text,qt=Bt.measureText(tn),cn=xn-p;let En=`${tn} (${ln})`,Sn=Math.max(Vn,0)+p;qt.width>cn&&(Bt.textAlign=Ft,Ft==="right"&&(En=tn,Sn=Vn+xn-p)),Bt.fillText(En,Sn,Et+c/2+2),Bt.restore()}function Te(Bt,an,tn,Cn){return(Bt-an*tn)*Cn}const Le=({data:Bt,rangeMin:an,rangeMax:tn,matchedLabels:Cn,setRangeMin:xn,setRangeMax:Vn,onItemFocused:Et,focusedItemData:Ft,textAlign:Gt,onSandwich:ln,colorScheme:qt,totalProfileTicks:cn,totalProfileTicksRight:En,totalViewTicks:Sn,root:Tn,direction:Wn,depth:Nn,showFlameGraphOnly:Tt,collapsedMap:Wt,setCollapsedMap:jt,collapsing:ut,getExtraContextMenuButtons:Zt,selectedView:jn,search:Xn})=>{const Qn=Ye(),[Fn,{width:qn}]=(0,r.A)(),js=(0,s.useRef)(null),[ys,Ps]=(0,s.useState)(),[es,_s]=(0,s.useState)();oe({canvasRef:js,colorScheme:qt,data:Bt,focusedItemData:Ft,root:Tn,direction:Wn,depth:Nn,rangeMax:tn,rangeMin:an,matchedLabels:Cn,textAlign:Gt,totalViewTicks:Sn,totalColorTicks:Bt.isDiffFlamegraph()?cn:Sn,totalTicksRight:En,wrapperWidth:qn,collapsedMap:Wt});const ca=(0,s.useCallback)(ga=>{Ps(void 0);const $a=js.current.clientWidth/Sn/(tn-an),Za=je({x:ga.nativeEvent.offsetX,y:ga.nativeEvent.offsetY},Tn,Wn,Nn,$a,Sn,an,Wt);_s(Za?{posY:ga.clientY,posX:ga.clientX,item:Za,label:Bt.getLabel(Za.itemIndexes[0])}:void 0)},[Bt,an,tn,Sn,Tn,Wn,Nn,Wt]),[Ks,Zs]=(0,s.useState)(),nr=(0,s.useCallback)(ga=>{if(es===void 0){Ps(void 0),Zs(void 0);const $a=js.current.clientWidth/Sn/(tn-an),Za=je({x:ga.nativeEvent.offsetX,y:ga.nativeEvent.offsetY},Tn,Wn,Nn,$a,Sn,an,Wt);Za&&(Zs({x:ga.clientX,y:ga.clientY}),Ps(Za))}},[an,tn,Sn,es,Zs,Tn,Wn,Nn,Wt]),lr=(0,s.useCallback)(()=>{Ps(void 0)},[]);return(0,s.useEffect)(()=>{const ga=$a=>{$a.target instanceof HTMLElement&&$a.target.parentElement?.id!=="flameGraphCanvasContainer_clickOutsideCheck"&&_s(void 0)};return window.addEventListener("click",ga),()=>window.removeEventListener("click",ga)},[_s]),(0,t.jsxs)("div",{className:Qn.graph,children:[(0,t.jsx)("div",{className:Qn.canvasWrapper,id:"flameGraphCanvasContainer_clickOutsideCheck",ref:Fn,children:(0,t.jsx)("canvas",{ref:js,"data-testid":"flameGraph",onClick:ca,onMouseMove:nr,onMouseLeave:lr})}),(0,t.jsx)(B,{position:Ks,item:ys,data:Bt,totalTicks:Sn,collapseConfig:ys?Wt.get(ys):void 0}),!Tt&&es&&(0,t.jsx)(M,{data:Bt,itemData:es,collapsing:ut,collapseConfig:Wt.get(es.item),onMenuItemClick:()=>{_s(void 0)},onItemFocus:()=>{xn(es.item.start/Sn),Vn((es.item.start+es.item.value)/Sn),Et(es)},onSandwich:()=>{ln(Bt.getLabel(es.item.itemIndexes[0]))},onExpandGroup:()=>{jt(Wt.setCollapsedStatus(es.item,!1))},onCollapseGroup:()=>{jt(Wt.setCollapsedStatus(es.item,!0))},onExpandAllGroups:()=>{jt(Wt.setAllCollapsedStatus(!1))},onCollapseAllGroups:()=>{jt(Wt.setAllCollapsedStatus(!0))},allGroupsCollapsed:Array.from(Wt.values()).every(ga=>ga.collapsed),allGroupsExpanded:Array.from(Wt.values()).every(ga=>!ga.collapsed),getExtraContextMenuButtons:Zt,selectedView:jn,search:Xn})]})},Ye=()=>({graph:(0,n.css)({label:"graph",overflow:"auto",flexGrow:1,flexBasis:"50%"}),canvasContainer:(0,n.css)({label:"canvasContainer",display:"flex"}),canvasWrapper:(0,n.css)({label:"canvasWrapper",cursor:"pointer",flex:1,overflow:"hidden"}),sandwichMarker:(0,n.css)({label:"sandwichMarker",writingMode:"vertical-lr",transform:"rotate(180deg)",overflow:"hidden",whiteSpace:"nowrap"}),sandwichMarkerIcon:(0,n.css)({label:"sandwichMarkerIcon",verticalAlign:"baseline"})}),je=(Bt,an,tn,Cn,xn,Vn,Et,Ft)=>{let Gt=an,ln=tn==="children"?0:Cn-1;const qt=Math.floor(Bt.y/(c/window.devicePixelRatio));let cn;for(;Gt;){const En=Gt;if(Gt=void 0,ln===qt){cn=En;break}const Sn=tn==="children"?En.children:En.parents||[];for(const Tn of Sn){const Wn=Te(Tn.start,Vn,Et,xn),Nn=Te(Tn.start+Tn.value,Vn,Et,xn);if(Wn<=Bt.x&&Bt.x<Nn){Gt=Tn;const Tt=Ft.get(Tn);(!Tt||!Tt.collapsed||Tt.items[0]===Tn)&&(ln=ln+(tn==="children"?1:-1));break}}}return cn},Ze=Le;var Ne=e(29158);const Pe=(0,s.memo)(({data:Bt,focusedItem:an,totalTicks:tn,sandwichedLabel:Cn,onFocusPillClick:xn,onSandwichPillClick:Vn})=>{const Et=(0,I.of)(Ue),Ft=[],Gt=(0,O.j_)("short")(tn),ln=Bt.valueDisplayProcessor(tn);let qt=ln.text+ln.suffix;const cn=Bt.getUnitTitle();if(cn==="Count"&&(ln.suffix||(qt=ln.text)),Ft.push((0,t.jsxs)("div",{className:Et.metadataPill,children:[qt," | ",Gt.text,Gt.suffix," samples (",cn,")"]},"default")),Cn&&Ft.push((0,t.jsxs)("span",{children:[(0,t.jsx)(a.I,{size:"sm",name:"angle-right"}),(0,t.jsxs)("div",{className:Et.metadataPill,children:[(0,t.jsx)(a.I,{size:"sm",name:"gf-show-context"})," ",(0,t.jsx)("span",{className:Et.metadataPillName,children:Cn.substring(Cn.lastIndexOf("/")+1)}),(0,t.jsx)(Ne.K,{className:Et.pillCloseButton,name:"times",size:"sm",onClick:Vn,tooltip:"Remove sandwich view","aria-label":"Remove sandwich view"})]})]},"sandwich")),an){const En=Math.round(1e4*(an.item.value/tn))/100;Ft.push((0,t.jsxs)("span",{children:[(0,t.jsx)(a.I,{size:"sm",name:"angle-right"}),(0,t.jsxs)("div",{className:Et.metadataPill,children:[(0,t.jsx)(a.I,{size:"sm",name:"eye"})," ",En,"% of total",(0,t.jsx)(Ne.K,{className:Et.pillCloseButton,name:"times",size:"sm",onClick:xn,tooltip:"Remove focus","aria-label":"Remove focus"})]})]},"focus"))}return(0,t.jsx)("div",{className:Et.metadata,children:Ft})});Pe.displayName="FlameGraphMetadata";const Ue=Bt=>({metadataPill:(0,n.css)({label:"metadataPill",display:"inline-flex",alignItems:"center",background:Bt.colors.background.secondary,borderRadius:Bt.shape.borderRadius(8),padding:Bt.spacing(.5,1),fontSize:Bt.typography.bodySmall.fontSize,fontWeight:Bt.typography.fontWeightMedium,lineHeight:Bt.typography.bodySmall.lineHeight,color:Bt.colors.text.secondary}),pillCloseButton:(0,n.css)({label:"pillCloseButton",verticalAlign:"text-bottom",margin:Bt.spacing(0,.5)}),metadata:(0,n.css)({margin:"8px 0",textAlign:"center"}),metadataPillName:(0,n.css)({label:"metadataPillName",maxWidth:"200px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",marginLeft:Bt.spacing(.5)})}),$e=Pe,ze=({data:Bt,rangeMin:an,rangeMax:tn,matchedLabels:Cn,setRangeMin:xn,setRangeMax:Vn,onItemFocused:Et,focusedItemData:Ft,textAlign:Gt,onSandwich:ln,sandwichItem:qt,onFocusPillClick:cn,onSandwichPillClick:En,colorScheme:Sn,showFlameGraphOnly:Tn,getExtraContextMenuButtons:Wn,collapsing:Nn,selectedView:Tt,search:Wt,collapsedMap:jt,setCollapsedMap:ut})=>{const Zt=qe(),[jn,Xn]=(0,s.useState)(),[Qn,Fn]=(0,s.useState)(),[qn,js]=(0,s.useState)(0),[ys,Ps]=(0,s.useState)(),[es,_s]=(0,s.useState)(0);if((0,s.useEffect)(()=>{if(Bt){let Zs=Bt.getLevels(),nr=Zs.length?Zs[0][0].value:0,lr=Zs.length?Zs[0][0].valueRight:void 0,ga=nr,$a;if(qt){const[Za,mr]=Bt.getSandwichLevels(qt);Zs=mr,$a=Za,ga=mr[0]?.[0]?.value??0}Xn(Zs),Fn($a),js(nr),Ps(lr),_s(ga)}},[Bt,qt]),!jn)return null;const ca={data:Bt,rangeMin:an,rangeMax:tn,matchedLabels:Cn,setRangeMin:xn,setRangeMax:Vn,onItemFocused:Et,focusedItemData:Ft,textAlign:Gt,onSandwich:ln,colorScheme:Sn,totalProfileTicks:qn,totalProfileTicksRight:ys,totalViewTicks:es,showFlameGraphOnly:Tn,collapsedMap:jt,setCollapsedMap:ut,getExtraContextMenuButtons:Wn,collapsing:Nn,search:Wt,selectedView:Tt},Ks=Qn?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:Zt.sandwichCanvasWrapper,children:[(0,t.jsxs)("div",{className:Zt.sandwichMarker,children:["Callers",(0,t.jsx)(a.I,{className:Zt.sandwichMarkerIcon,name:"arrow-down"})]}),(0,t.jsx)(Ze,{...ca,root:Qn[Qn.length-1][0],depth:Qn.length,direction:"parents",collapsing:!1})]}),(0,t.jsxs)("div",{className:Zt.sandwichCanvasWrapper,children:[(0,t.jsxs)("div",{className:(0,n.cx)(Zt.sandwichMarker,Zt.sandwichMarkerCalees),children:[(0,t.jsx)(a.I,{className:Zt.sandwichMarkerIcon,name:"arrow-up"}),"Callees"]}),(0,t.jsx)(Ze,{...ca,root:jn[0][0],depth:jn.length,direction:"children",collapsing:!1})]})]}):(0,t.jsx)(Ze,{...ca,root:jn[0][0],depth:jn.length,direction:"children"});return(0,t.jsxs)("div",{className:Zt.graph,children:[(0,t.jsx)($e,{data:Bt,focusedItem:Ft,sandwichedLabel:qt,totalTicks:es,onFocusPillClick:cn,onSandwichPillClick:En}),Ks]})},qe=()=>({graph:(0,n.css)({label:"graph",overflow:"auto",flexGrow:1,flexBasis:"50%"}),sandwichCanvasWrapper:(0,n.css)({label:"sandwichCanvasWrapper",display:"flex",marginBottom:`${c/window.devicePixelRatio}px`}),sandwichMarker:(0,n.css)({label:"sandwichMarker",writingMode:"vertical-lr",transform:"rotate(180deg)",overflow:"hidden",whiteSpace:"nowrap"}),sandwichMarkerCalees:(0,n.css)({label:"sandwichMarkerCalees",textAlign:"right"}),sandwichMarkerIcon:(0,n.css)({label:"sandwichMarkerIcon",verticalAlign:"baseline"})}),dt=ze;var vt=e(76365),yt=e(75198),st=e(80292),Ve=e(55852),pe=e(10354),Ee=e(19727),me=e(94354),ve=e(38138),Se=e(83122);const Ie=({search:Bt,setSearch:an,selectedView:tn,setSelectedView:Cn,containerWidth:xn,onReset:Vn,textAlign:Et,onTextAlignChange:Ft,showResetButton:Gt,colorScheme:ln,onColorSchemeChange:qt,stickyHeader:cn,extraHeaderElements:En,vertical:Sn,isDiffMode:Tn,setCollapsedMap:Wn,collapsedMap:Nn})=>{const Tt=(0,I.of)(We),[Wt,jt]=Ce(Bt,an),ut=Wt!==""?(0,t.jsx)(Ve.$n,{icon:"times",fill:"text",size:"sm",onClick:()=>{an(""),jt("")},children:"Clear"}):null;return(0,t.jsxs)("div",{className:(0,n.cx)(Tt.header,{[Tt.stickyHeader]:cn}),children:[(0,t.jsx)("div",{className:Tt.inputContainer,children:(0,t.jsx)(pe.p,{value:Wt||"",onChange:Zt=>{jt(Zt.currentTarget.value)},placeholder:"Search...",suffix:ut})}),(0,t.jsxs)("div",{className:Tt.rightContainer,children:[Gt&&(0,t.jsx)(Ve.$n,{variant:"secondary",fill:"outline",size:"sm",icon:"history-alt",tooltip:"Reset focus and sandwich state",onClick:()=>{Vn()},className:Tt.buttonSpacing,"aria-label":"Reset focus and sandwich state"}),(0,t.jsx)(Oe,{value:ln,onChange:qt,isDiffMode:Tn}),(0,t.jsxs)(Ee.e,{className:Tt.buttonSpacing,children:[(0,t.jsx)(Ve.$n,{variant:"secondary",fill:"outline",size:"sm",tooltip:"Expand all groups",onClick:()=>{Wn(Nn.setAllCollapsedStatus(!1))},"aria-label":"Expand all groups",icon:"angle-double-down",disabled:tn===K.F8.TopTable}),(0,t.jsx)(Ve.$n,{variant:"secondary",fill:"outline",size:"sm",tooltip:"Collapse all groups",onClick:()=>{Wn(Nn.setAllCollapsedStatus(!0))},"aria-label":"Collapse all groups",icon:"angle-double-up",disabled:tn===K.F8.TopTable})]}),(0,t.jsx)(me.z,{size:"sm",disabled:tn===K.F8.TopTable,options:Re,value:Et,onChange:Ft,className:Tt.buttonSpacing}),(0,t.jsx)(me.z,{size:"sm",options:he(xn,Sn),value:tn,onChange:Cn}),En&&(0,t.jsx)("div",{className:Tt.extraElements,children:En})]})]})};function Oe(Bt){const an=(0,I.of)(We);let tn=(0,t.jsxs)(ve.W,{children:[(0,t.jsx)(ve.W.Item,{label:"By package name",onClick:()=>Bt.onChange(K.zM.PackageBased)}),(0,t.jsx)(ve.W.Item,{label:"By value",onClick:()=>Bt.onChange(K.zM.ValueBased)})]});const Cn={[K.zM.ValueBased]:an.colorDotByValue,[K.zM.PackageBased]:an.colorDotByPackage,[K.yU.DiffColorBlind]:an.colorDotDiffColorBlind,[K.yU.Default]:an.colorDotDiffDefault}[Bt.value]||an.colorDotByValue;let xn=(0,t.jsx)("span",{className:(0,n.cx)(an.colorDot,Cn)});return Bt.isDiffMode&&(tn=(0,t.jsxs)(ve.W,{children:[(0,t.jsx)(ve.W.Item,{label:"Default (green to red)",onClick:()=>Bt.onChange(K.yU.Default)}),(0,t.jsx)(ve.W.Item,{label:"Color blind (blue to red)",onClick:()=>Bt.onChange(K.yU.DiffColorBlind)})]}),xn=(0,t.jsxs)("div",{className:(0,n.cx)(an.colorDotDiff,Cn),children:[(0,t.jsx)("div",{children:"-100% (removed)"}),(0,t.jsx)("div",{children:"0%"}),(0,t.jsx)("div",{children:"+100% (added)"})]})),(0,t.jsx)(Se.m,{overlay:tn,children:(0,t.jsx)(Ve.$n,{variant:"secondary",fill:"outline",size:"sm",tooltip:"Change color scheme",onClick:()=>{},className:an.buttonSpacing,"aria-label":"Change color scheme",children:xn})})}const Re=[{value:"left",description:"Align text left",icon:"align-left"},{value:"right",description:"Align text right",icon:"align-right"}];function he(Bt,an){let tn=[{value:K.F8.TopTable,label:"Top Table",description:"Only show top table"},{value:K.F8.FlameGraph,label:"Flame Graph",description:"Only show flame graph"}];return(Bt>=u||an)&&tn.push({value:K.F8.Both,label:"Both",description:"Show both the top table and flame graph"}),tn}function Ce(Bt,an){const[tn,Cn]=(0,s.useState)(Bt),xn=(0,st.A)(Bt);return(0,yt.A)(()=>{an(tn)},250,[tn]),(0,s.useEffect)(()=>{xn!==Bt&&Bt!==tn&&Cn(Bt)},[Bt,xn,tn]),[tn,Cn]}const We=Bt=>({header:(0,n.css)({label:"header",display:"flex",flexWrap:"wrap",justifyContent:"space-between",width:"100%",top:0,gap:Bt.spacing(1),marginTop:Bt.spacing(1)}),stickyHeader:(0,n.css)({zIndex:Bt.zIndex.navbarFixed,position:"sticky",background:Bt.colors.background.primary}),inputContainer:(0,n.css)({label:"inputContainer",flexGrow:1,minWidth:"150px",maxWidth:"350px"}),rightContainer:(0,n.css)({label:"rightContainer",display:"flex",alignItems:"flex-start",flexWrap:"wrap"}),buttonSpacing:(0,n.css)({label:"buttonSpacing",marginRight:Bt.spacing(1)}),resetButton:(0,n.css)({label:"resetButton",display:"flex",marginRight:Bt.spacing(2)}),resetButtonIconWrapper:(0,n.css)({label:"resetButtonIcon",padding:"0 5px",color:Bt.colors.text.disabled}),colorDot:(0,n.css)({label:"colorDot",display:"inline-block",width:"10px",height:"10px",borderRadius:"50%"}),colorDotDiff:(0,n.css)({label:"colorDotDiff",display:"flex",width:"200px",height:"12px",color:"white",fontSize:9,lineHeight:1.3,fontWeight:300,justifyContent:"space-between",padding:"0 2px",borderRadius:"2px"}),colorDotByValue:(0,n.css)({label:"colorDotByValue",background:q}),colorDotByPackage:(0,n.css)({label:"colorDotByPackage",background:ae}),colorDotDiffDefault:(0,n.css)({label:"colorDotDiffDefault",background:le}),colorDotDiffColorBlind:(0,n.css)({label:"colorDotDiffColorBlind",background:ee}),extraElements:(0,n.css)({label:"extraElements",marginLeft:Bt.spacing(1)})}),et=Ie;var rt=e(70713),nt=e(11261),gt=e(25019),xt=e(90708),St=e(77093),zt=e(52622);const Nt=(0,s.memo)(({data:Bt,onSymbolClick:an,search:tn,matchedLabels:Cn,onSearch:xn,sandwichItem:Vn,onSandwich:Et,onTableSort:Ft,colorScheme:Gt})=>{const ln=(0,s.useMemo)(()=>{let Tn={};for(let Wn=0;Wn<Bt.data.length;Wn++){const Nn=Bt.getValue(Wn),Tt=Bt.getValueRight(Wn),Wt=Bt.getSelf(Wn),jt=Bt.getLabel(Wn);(!Cn||Cn.has(jt))&&(Tn[jt]=Tn[jt]||{},Tn[jt].self=Tn[jt].self?Tn[jt].self+Wt:Wt,Tn[jt].total=Tn[jt].total?Tn[jt].total+Nn:Nn,Tn[jt].totalRight=Tn[jt].totalRight?Tn[jt].totalRight+Tt:Tt)}return Tn},[Bt,Cn]),qt=(0,I.of)(Qe),cn=(0,I.$j)(),[En,Sn]=(0,s.useState)([{displayName:"Self",desc:!0}]);return(0,t.jsx)("div",{className:qt.topTableContainer,"data-testid":"topTable",children:(0,t.jsx)(rt.Ay,{style:{width:"100%"},children:({width:Tn,height:Wn})=>{if(Tn<3||Wn<3)return null;const Nn=Vt(Bt,ln,Tn,an,xn,Et,cn,Gt,tn,Vn);return(0,t.jsx)(St.X,{initialSortBy:En,onSortByChange:Tt=>{Tt&&Tt.length&&Ft?.(Tt[0].displayName+"_"+(Tt[0].desc?"desc":"asc")),Sn(Tt)},data:Nn,width:Tn,height:Wn})}})})});Nt.displayName="FlameGraphTopTableContainer";function Vt(Bt,an,tn,Cn,xn,Vn,Et,Ft,Gt,ln){const qt=ct(Vn,xn,Gt,ln),cn={type:nt.PU.string,name:"Symbol",values:[],config:{custom:{width:tn-Je-D*2},links:[{title:"Highlight symbol",url:"",onClick:Tn=>{const Nn=Tn.origin.field.values[Tn.origin.rowIndex];Cn(Nn)}}]}};let En;if(Bt.isDiffFlamegraph()){cn.config.custom.width=tn-Je-D*3;const Tn=en("Baseline","percent"),Wn=en("Comparison","percent"),Nn=en("Diff","percent");Nn.config.custom.cellOptions.type=zt.ob.ColorText;const[Tt,Wt]=Ft===K.yU.DiffColorBlind?[z[0],z[2]]:[ne[0],ne[2]];Nn.config.mappings=[{type:gt.d.ValueToText,options:{[1/0]:{text:"new",color:Wt}}},{type:gt.d.ValueToText,options:{[-100]:{text:"removed",color:Tt}}},{type:gt.d.RangeToText,options:{from:0,to:1/0,result:{color:Wt}}},{type:gt.d.RangeToText,options:{from:-1/0,to:0,result:{color:Tt}}}];const jt=Bt.getLevels(),ut=jt.length?jt[0][0].value:0,Zt=jt.length?jt[0][0].valueRight:void 0;for(let jn in an){qt.values.push(null),cn.values.push(jn);const Xn=an[jn].total,Qn=an[jn].totalRight,Fn=ut-Zt,qn=Math.round(1e4*Xn/Fn)/100,js=Math.round(1e4*Qn/Zt)/100,ys=(js-qn)/qn*100;Nn.values.push(ys),Tn.values.push(qn),Wn.values.push(js)}En={fields:[qt,cn,Tn,Wn,Nn],length:cn.values.length}}else{const Tn=en("Self",Bt.selfField.config.unit),Wn=en("Total",Bt.valueField.config.unit);for(let Nn in an)qt.values.push(null),cn.values.push(Nn),Tn.values.push(an[Nn].self),Wn.values.push(an[Nn].total);En={fields:[qt,cn,Tn,Wn],length:cn.values.length}}return(0,xt.we)({data:[En],fieldConfig:{defaults:{},overrides:[]},replaceVariables:Tn=>Tn,theme:Et})[0]}function en(Bt,an){const tn={width:D,align:"auto",inspect:!1,cellOptions:{type:zt.ob.Auto}};return{type:nt.PU.number,name:Bt,values:[],config:{unit:an,custom:tn}}}const Je=61;function ct(Bt,an,tn,Cn){const xn={type:zt.ob.Custom,cellComponent:Et=>(0,t.jsx)(ot,{frame:Et.frame,onSandwich:Bt,onSearch:an,search:tn,sandwichItem:Cn,rowIndex:Et.rowIndex})},Vn={filterable:!1,width:Je,hideHeader:!0,inspect:!1,align:"auto",cellOptions:xn};return{type:nt.PU.number,name:"actions",values:[],config:{custom:Vn}}}function ot(Bt){const an=pt(),tn=Bt.frame.fields.find(Vn=>Vn.name==="Symbol")?.values[Bt.rowIndex],Cn=Bt.search===tn,xn=Bt.sandwichItem===tn;return(0,t.jsxs)("div",{className:an.actionCellWrapper,children:[(0,t.jsx)(Ne.K,{className:an.actionCellButton,name:"search",variant:Cn?"primary":"secondary",tooltip:Cn?"Clear from search":"Search for symbol","aria-label":Cn?"Clear from search":"Search for symbol",onClick:()=>{Bt.onSearch(Cn?"":tn)}}),(0,t.jsx)(Ne.K,{className:an.actionCellButton,name:"gf-show-context",tooltip:xn?"Remove from sandwich view":"Show in sandwich view",variant:xn?"primary":"secondary","aria-label":xn?"Remove from sandwich view":"Show in sandwich view",onClick:()=>{Bt.onSandwich(xn?void 0:tn)}})]})}const Qe=Bt=>({topTableContainer:(0,n.css)({label:"topTableContainer",padding:Bt.spacing(1),backgroundColor:Bt.colors.background.secondary,height:"100%"})}),pt=()=>({actionCellWrapper:(0,n.css)({label:"actionCellWrapper",display:"flex",height:"24px"}),actionCellButton:(0,n.css)({label:"actionCellButton",marginRight:0,width:"24px"})}),Pt=Nt,At=new i.A,mn=({data:Bt,onTableSymbolClick:an,onViewSelected:tn,onTextAlignSelected:Cn,onTableSort:xn,getTheme:Vn,stickyHeader:Et,extraHeaderElements:Ft,vertical:Gt,showFlameGraphOnly:ln,disableCollapsing:qt,getExtraContextMenuButtons:cn})=>{const[En,Sn]=(0,s.useState)(),[Tn,Wn]=(0,s.useState)(0),[Nn,Tt]=(0,s.useState)(1),[Wt,jt]=(0,s.useState)(""),[ut,Zt]=(0,s.useState)(K.F8.Both),[jn,{width:Xn}]=(0,r.A)(),[Qn,Fn]=(0,s.useState)("left"),[qn,js]=(0,s.useState)(),[ys,Ps]=(0,s.useState)(new vt.S6),es=(0,s.useMemo)(()=>Vn(),[Vn]),_s=(0,s.useMemo)(()=>{if(!Bt)return;const Ea=new vt.Jz(Bt,{collapsing:!qt},es);return Ps(Ea.getCollapsedMap()),Ea},[Bt,es,qt]),[ca,Ks]=Pn(_s),Zs=Rn(es),nr=fn(Wt,_s);(0,s.useEffect)(()=>{Xn>0&&Xn<u&&ut===K.F8.Both&&!Gt&&Zt(K.F8.FlameGraph)},[ut,Zt,Xn,Gt]);const lr=(0,s.useCallback)(()=>{Sn(void 0),Wn(0),Tt(1)},[Sn,Tt,Wn]);function ga(){js(void 0)}(0,s.useEffect)(()=>{lr(),ga()},[Bt,lr]);const $a=(0,s.useCallback)(Ea=>{Wt===Ea?jt(""):(an?.(Ea),jt(Ea),lr())},[jt,lr,an,Wt]);if(!_s)return null;const Za=(0,t.jsx)(dt,{data:_s,rangeMin:Tn,rangeMax:Nn,matchedLabels:nr,setRangeMin:Wn,setRangeMax:Tt,onItemFocused:Ea=>Sn(Ea),focusedItemData:En,textAlign:Qn,sandwichItem:qn,onSandwich:Ea=>{lr(),js(Ea)},onFocusPillClick:lr,onSandwichPillClick:ga,colorScheme:ca,showFlameGraphOnly:ln,collapsing:!qt,getExtraContextMenuButtons:cn,selectedView:ut,search:Wt,collapsedMap:ys,setCollapsedMap:Ps}),mr=(0,t.jsx)(Pt,{data:_s,onSymbolClick:$a,search:Wt,matchedLabels:nr,sandwichItem:qn,onSandwich:js,onSearch:jt,onTableSort:xn,colorScheme:ca});let Va;return ln||ut===K.F8.FlameGraph?Va=Za:ut===K.F8.TopTable?Va=(0,t.jsx)("div",{className:Zs.tableContainer,children:mr}):ut===K.F8.Both&&(Gt?Va=(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:Zs.verticalGraphContainer,children:Za}),(0,t.jsx)("div",{className:Zs.verticalTableContainer,children:mr})]}):Va=(0,t.jsxs)("div",{className:Zs.horizontalContainer,children:[(0,t.jsx)("div",{className:Zs.horizontalTableContainer,children:mr}),(0,t.jsx)("div",{className:Zs.horizontalGraphContainer,children:Za})]})),(0,t.jsx)(g.D.Provider,{value:es,children:(0,t.jsxs)("div",{ref:jn,className:Zs.container,children:[!ln&&(0,t.jsx)(et,{search:Wt,setSearch:jt,selectedView:ut,setSelectedView:Ea=>{Zt(Ea),tn?.(Ea)},containerWidth:Xn,onReset:()=>{lr(),ga()},textAlign:Qn,onTextAlignChange:Ea=>{Fn(Ea),Cn?.(Ea)},showResetButton:!!(En||qn),colorScheme:ca,onColorSchemeChange:Ks,stickyHeader:!!Et,extraHeaderElements:Ft,vertical:Gt,isDiffMode:_s.isDiffFlamegraph(),setCollapsedMap:Ps,collapsedMap:ys}),(0,t.jsx)("div",{className:Zs.body,children:Va})]})})};function Pn(Bt){const an=Bt?.isDiffFlamegraph()?K.yU.Default:K.zM.PackageBased,[tn,Cn]=(0,s.useState)(an);return(0,s.useEffect)(()=>{Cn(an)},[an]),[tn,Cn]}function fn(Bt,an){return(0,s.useMemo)(()=>{if(Bt&&an){const tn=new Set;let Cn=At.filter(an.getUniqueLabels(),Bt);if(Cn)for(let xn of Cn)tn.add(an.getUniqueLabels()[xn]);return tn}},[Bt,an])}function Rn(Bt){return{container:(0,n.css)({label:"container",overflow:"auto",height:"100%",display:"flex",flex:"1 1 0",flexDirection:"column",minHeight:0,gap:Bt.spacing(1)}),body:(0,n.css)({label:"body",flexGrow:1}),tableContainer:(0,n.css)({height:800}),horizontalContainer:(0,n.css)({label:"horizontalContainer",display:"flex",minHeight:0,flexDirection:"row",columnGap:Bt.spacing(1),width:"100%"}),horizontalGraphContainer:(0,n.css)({flexBasis:"50%"}),horizontalTableContainer:(0,n.css)({flexBasis:"50%",maxHeight:800}),verticalGraphContainer:(0,n.css)({marginBottom:Bt.spacing(1)}),verticalTableContainer:(0,n.css)({height:800})}}const Kn=mn},5546:(k,R,e)=>{"use strict";e.d(R,{F8:()=>n,Zk:()=>t,yU:()=>s,zM:()=>i});var t=(r=>(r.Bytes="bytes",r.Short="short",r.Nanoseconds="ns",r))(t||{}),n=(r=>(r.TopTable="topTable",r.FlameGraph="flameGraph",r.Both="both",r))(n||{}),i=(r=>(r.ValueBased="valueBased",r.PackageBased="packageBased",r))(i||{}),s=(r=>(r.Default="default",r.DiffColorBlind="diffColorBlind",r))(s||{})},80822:(k,R,e)=>{"use strict";e.d(R,{Wn:()=>r,_k:()=>s});var t=e(21423),n=e(41260),i=e(11261);function s(p,m){const v=r({data:p.series},{data:m.series}).data;return{...p,series:v}}function r(p,m){if(!p)return h(m);m.data.forEach(u=>{const D=p.data.find(E=>d(E,u));if(!D){p.data.push(f(u));return}g(D,u)});const v=[...p.errors??[],...m.errors??[]];v.length>0&&(p.errors=v);const l=p.error??m.error;l!=null&&(p.error=l);const y=[...p.traceIds??[],...m.traceIds??[]];return y.length>0&&(p.traceIds=y),p}function g(p,m){const v=Math.max(p.fields.length,m.fields.length);for(let l=0;l<v;l++){if(!p.fields[l])continue;const y=a(p.fields[l],m.fields,l);if(y&&(p.fields[l].values=[].concat.apply(y.values,p.fields[l].values),y.nanos)){const u=p.fields[l].nanos?.slice()||[];p.fields[l].nanos=m.fields[l].nanos?.concat(u)}}p.length+=m.length,p.meta={...p.meta,stats:o(p.meta?.stats??[],m.meta?.stats??[])}}function a(p,m,v){const l=m.filter(y=>y.name===p.name);return l.length===1?l[0]:p.labels?l.find(y=>(0,t.ab)(p.labels??{},y.labels??{})):m[v]}const c="Summary: total bytes processed";function o(p,m){const v=p.find(u=>u.displayName===c),l=m.find(u=>u.displayName===c);if(l!=null&&v!=null)return[{value:l.value+v.value,displayName:c,unit:v.unit}];const y=l??v;return y!=null?[y]:[]}function h(p){return{...p,data:p.data.map(f)}}function f(p){return{...p,fields:p.fields.map(m=>({...m,values:m.values}))}}function d(p,m){if(p.refId!==m.refId||p.name!==m.name)return!1;const v=p.meta?.type,l=m.meta?.type;if(v!==l)return!1;if(v===n.m.TimeSeriesMulti){const D=p.fields.find(x=>x.type===i.PU.number),E=m.fields.find(x=>x.type===i.PU.number);return D===void 0||E===void 0?!1:(0,t.ab)(D.labels??{},E.labels??{})}const y=p.meta?.custom?.frameType,u=m.meta?.custom?.frameType;return y==="LabeledTimeValues"&&u==="LabeledTimeValues"?!0:y===u}},80937:(k,R,e)=>{"use strict";e.d(R,{t:()=>s});var t=e(84555),n=e(32370),i=e(76040);function s(o,h,f,d="="){if(!h||!f)throw new Error("Need label to add to query.");const p=r(o);if(!p.length)return o;const m=g(h,f,d);return a(o,p,m)}function r(o){const h=t.K3.parse(o),f=[];return h.iterate({enter:({to:d,from:p,type:m})=>{if(m.id===t.Fb){const v=(0,i.u)(o.substring(p,d));return f.push({query:v.query,from:p,to:d}),!1}}}),f}function g(o,h,f){const d=h===1/0?"+Inf":h.toString();return{label:o,op:f,value:d}}function a(o,h,f){const d=new n.l;let p="",m=0;for(let v=0;v<h.length;v++){const l=h[v],y=v===h.length-1,u=o.substring(m,l.from),D=y?o.substring(l.to):"";c(l.query.labels,f)||l.query.labels.push(f);const E=d.renderQuery(l.query);p+=u+E+D,m=l.to}return p}function c(o,h){return o.find(f=>f.label===h.label&&f.value===h.value)}},7338:(k,R,e)=>{"use strict";e.d(R,{L:()=>en});var t=e(74848),n=e(32196),i=e(96540),s=e(14236),r=e(7144),g=e(13544),a=e(14110),c=e(14578),o=e(55852),h=e(40845),f=e(81996),d=e(91396);function p(Je){return typeof Je=="object"&&Je!==null&&"isCanceled"in Je}const m=Je=>{let ct=!1;return{promise:new Promise((Qe,pt)=>{const Pt={isCanceled:!0};Je.then(At=>ct?pt(Pt):Qe(At)),Je.catch(At=>pt(ct?Pt:At))}),cancel(){ct=!0}}};var v=e(84555),l=e(2543),y=e(75357),u=e(39554),D=e(62938),E=e(85828);function x(){const Je=new Map;return Je.set("expandSuggestionDocs","true"),{onDidChangeValue:ct=>{},onDidChangeTarget:ct=>{},onWillSaveState:ct=>{},get:(ct,ot,Qe)=>Je.get(ct)??Qe,getBoolean:(ct,ot,Qe)=>{const pt=Je.get(ct);return pt!==void 0?pt==="true":Qe},getNumber:(ct,ot,Qe)=>{const pt=Je.get(ct);return pt!==void 0?parseInt(pt,10):Qe},store:(ct,ot,Qe,pt)=>{ot==null?Je.delete(ct):Je.set(ct,ot.toString())},remove:(ct,ot)=>{Je.delete(ct)},keys:(ct,ot)=>Array.from(Je.keys()),logStorage:()=>{console.log("logStorage: not implemented")},migrate:()=>Promise.resolve(void 0),isNew:ct=>!0,flush:ct=>Promise.resolve(void 0)}}let P=null;function b(){return P===null&&(P={storageService:x()}),P}var M=e(53076),O=e(32264),I=e(20719);class T extends Error{constructor(ct){super("should never happen")}}const C=new M.A({intraMode:1});function S(Je){let ct=Je.getAllMetricNames();if(O.$.featureToggles.prometheusCodeModeMetricNamesSearch&&ct.length>Je.metricNamesSuggestionLimit){const{monacoSettings:ot}=Je;ot.enableAutocompleteSuggestionsUpdate(),ot.inputInRange?ct=C.filter(ct,ot.inputInRange)?.slice(0,Je.metricNamesSuggestionLimit).map(Qe=>ct[Qe])??[]:ct=ct.slice(0,Je.metricNamesSuggestionLimit)}return Je.metricNamesToMetrics(ct).map(ot=>({type:"METRIC_NAME",label:ot.name,insertText:ot.name,detail:`${ot.name} : ${ot.type}`,documentation:ot.help}))}const A=I.AW.map(Je=>({type:"FUNCTION",label:Je.label,insertText:Je.insertText??"",detail:Je.detail,documentation:Je.documentation}));async function L(Je){const ct=S(Je);return[...A,...ct]}const N=["$__interval","$__range","$__rate_interval","1m","5m","10m","30m","1h","1d"].map(Je=>({type:"DURATION",label:Je,insertText:Je}));function F(Je){return Je.getHistory().slice(0,10).map(ot=>({type:"HISTORY",label:ot,insertText:ot}))}function w(Je,ct){const ot=[...ct];return Je!==void 0&&ot.push({name:"__name__",value:Je,op:"="}),`{${ot.map(pt=>`${pt.name}${pt.op}"${(0,f.Qn)(pt.value)}"`).join(",")}}`}async function B(Je,ct,ot){if(Je===void 0&&ct.length===0)return Promise.resolve(ot.getAllLabelNames());{const Qe=w(Je,ct);return await ot.getSeriesLabels(Qe,ct)}}async function U(Je,ct,ot,Qe,pt){return(await B(Je,Qe,pt)).map(At=>({type:"LABEL_NAME",label:At,insertText:`${At}${ct}`,triggerOnInsert:ot}))}async function K(Je,ct,ot){return U(Je,"=",!0,ct,ot)}async function V(Je,ct,ot){return U(Je,"",!1,ct,ot)}async function H(Je,ct,ot,Qe){if(Je===void 0&&ot.length===0)return Qe.getLabelValues(ct);{const pt=w(Je,ot);return await Qe.getSeriesValues(ct,pt)}}async function Y(Je,ct,ot,Qe,pt){return(await H(Je,ct,Qe,pt)).map(At=>({type:"LABEL_VALUE",label:At,insertText:ot?At:`"${At}"`}))}function X(Je,ct){switch(Je.type){case"IN_DURATION":return Promise.resolve(N);case"IN_FUNCTION":return L(ct);case"AT_ROOT":return L(ct);case"EMPTY":{const ot=S(ct),Qe=F(ct);return Promise.resolve([...Qe,...A,...ot])}case"IN_LABEL_SELECTOR_NO_LABEL_NAME":return K(Je.metricName,Je.otherLabels,ct);case"IN_GROUPING":return V(Je.metricName,Je.otherLabels,ct);case"IN_LABEL_SELECTOR_WITH_LABEL_NAME":return Y(Je.metricName,Je.labelName,Je.betweenQuotes,Je.otherLabels,ct);default:throw new T(Je)}}function J(Je,ct){switch(ct){case"parent":return Je.parent;case"firstChild":return Je.firstChild;case"lastChild":return Je.lastChild;case"nextSibling":return Je.nextSibling;default:throw new T(ct)}}function q(Je,ct){let ot=Je;for(const[Qe,pt]of ct)if(ot=J(ot,Qe),ot===null||ot.type.id!==pt)return null;return ot}function ae(Je,ct){return ct.slice(Je.from,Je.to)}function j(Je){const ct=Je.slice(1,Je.length-1);if(Je.startsWith('"')&&Je.endsWith('"'))return ct.replace(/\\"/,'"');if(Je.startsWith("'")&&Je.endsWith("'"))return ct.replace(/\\'/,"'");if(Je.startsWith("`")&&Je.endsWith("`"))return ct;throw new Error("FIXME: invalid string literal")}function te(Je,ct){return Je.every((ot,Qe)=>ot===ct[Qe])}const ne=0,le=[{path:[v.ww,v.Fb],fun:ge},{path:[v.ab],fun:re},{path:[v.Dh],fun:ue},{path:[v.LW,v.BG],fun:ye},{path:[ne,v.df,v.ab],fun:re},{path:[ne,v.BG],fun:ye},{path:[ne,v.l4],fun:De},{path:[v.x$],fun:ce}],z=new Map([[v.Hl,"="],[v.Ed,"=~"],[v.l3,"!="],[v.$i,"!~"]]);function ee(Je){const ct=Je.firstChild;return ct===null?null:z.get(ct.type.id)??null}function se(Je,ct){if(Je.type.id!==v.BG)return null;const ot=q(Je,[["firstChild",v.IC]]);if(ot===null)return null;const Qe=q(ot,[["nextSibling",v.Lf]]);if(Qe===null)return null;const pt=ee(Qe);if(pt===null)return null;const Pt=q(Je,[["lastChild",v.LW]]);if(Pt===null)return null;const At=ae(ot,ct),mn=j(ae(Pt,ct));return{name:At,value:mn,op:pt}}function ie(Je,ct){return Je.type.id!==v.ww?[]:Je.getChildren(v.BG).map(Qe=>se(Qe,ct)).filter(Ye)}function Z(Je){let ct=Je.firstChild;const ot=[];for(;ct!==null;)ot.push(ct),ct=ct.nextSibling;return ot}function oe(Je,ct){if(Je.type.id===ct)return Je;const ot=Z(Je);for(const Qe of ot){const pt=oe(Qe,ct);if(pt!==null)return pt}return null}function ce(Je,ct,ot){const Qe=q(Je,[["parent",v.hI],["parent",v.Fn]]);if(Qe===null)return null;const pt=Qe.getChild(v.Dh);if(pt===null)return null;const Pt=oe(pt,v.gw);return Pt===null?null:{type:"IN_GROUPING",metricName:ae(Pt,ct),otherLabels:[]}}function ye(Je,ct,ot){const Qe=!Je.type.isError,pt=q(Je,[["parent",v.BG]]);if(pt===null)return null;const Pt=q(pt,[["firstChild",v.IC]]);if(Pt===null)return null;const At=ae(Pt,ct),mn=q(pt,[["parent",v.ww]]);if(mn===null)return null;const fn=ie(mn,ct).filter(Bt=>Bt.name!==At),Rn=q(mn,[["parent",v.Fb],["firstChild",v.gw]]);return Rn===null?{type:"IN_LABEL_SELECTOR_WITH_LABEL_NAME",labelName:At,betweenQuotes:Qe,otherLabels:fn}:{type:"IN_LABEL_SELECTOR_WITH_LABEL_NAME",metricName:ae(Rn,ct),labelName:At,betweenQuotes:Qe,otherLabels:fn}}function re(Je,ct,ot){return{type:"AT_ROOT"}}function ue(Je,ct,ot){return{type:"IN_FUNCTION"}}function De(Je,ct,ot){return{type:"IN_DURATION"}}function ge(Je,ct,ot){const Qe=q(Je,[["firstChild",v.BG]]);if(Qe!==null&&!ct.slice(Qe.to,ot).includes(","))return null;const pt=q(Je,[["parent",v.Fb],["firstChild",v.gw]]),Pt=ie(Je,ct);return pt===null?{type:"IN_LABEL_SELECTOR_NO_LABEL_NAME",otherLabels:Pt}:{type:"IN_LABEL_SELECTOR_NO_LABEL_NAME",metricName:ae(pt,ct),otherLabels:Pt}}function Te(Je,ct){const ot=Je.cursorAt(ct);for(;;){if(ot.from===ct&&ot.to===ct){const{node:Qe}=ot;if(Qe.type.isError)return Qe}if(!ot.next())break}return null}function Le(Je,ct){if(Je==="")return{type:"EMPTY"};const ot=v.K3.parse(Je),Qe=Te(ot,ct),pt=Qe!=null?Qe.cursor():ot.cursorAt(ct),Pt=pt.node,At=[pt.type.id];for(;pt.parent();)At.push(pt.type.id);for(let mn of le)if(te(mn.path,At))return mn.fun(Pt,Je,ct);return null}function Ye(Je){return Je!=null}function je(){return{showWords:!1}}function Ze(Je,ct){switch(Je){case"DURATION":return ct.languages.CompletionItemKind.Unit;case"FUNCTION":return ct.languages.CompletionItemKind.Variable;case"HISTORY":return ct.languages.CompletionItemKind.Snippet;case"LABEL_NAME":return ct.languages.CompletionItemKind.Enum;case"LABEL_VALUE":return ct.languages.CompletionItemKind.EnumMember;case"METRIC_NAME":return ct.languages.CompletionItemKind.Constructor;default:throw new T(Je)}}function Ne(Je,ct){return{triggerCharacters:["{",",","[","(","=","~"," ",'"'],provideCompletionItems:(Qe,pt)=>{const Pt=Qe.getWordAtPosition(pt),At=Pt!=null?Je.Range.lift({startLineNumber:pt.lineNumber,endLineNumber:pt.lineNumber,startColumn:Pt.startColumn,endColumn:Pt.endColumn}):Je.Range.fromPositions(pt),mn={column:pt.column,lineNumber:pt.lineNumber};if(ct.monacoSettings.setInputInRange(Qe.getValueInRange(At)),window.getSelection){const Kn=window.getSelection()?.toString();Kn&&Kn.length>0&&(mn.column=mn.column-Kn.length)}const Pn=Qe.getOffsetAt(mn),fn=Le(Qe.getValue(),Pn);return(fn!=null?X(fn,ct):Promise.resolve([])).then(Kn=>{const Bt=Kn.length.toString().length;return{suggestions:Kn.map((tn,Cn)=>({kind:Ze(tn.type,Je),label:tn.label,insertText:tn.insertText,detail:tn.detail,documentation:tn.documentation,sortText:Cn.toString().padStart(Bt,"0"),range:At,command:tn.triggerOnInsert?{id:"editor.action.triggerSuggest",title:""}:void 0})),incomplete:ct.monacoSettings.suggestionsIncomplete}})}}}var Pe=e(91306);const Ue=0;function $e(Je,ct,ot,Qe){if(!Je)return!1;const pt=ze(ct,Qe);if(!pt.length)return!1;let Pt=pt;if(Je!==ct){const At=ze(Je,Qe);Pt=pt.flatMap(mn=>At.filter(Pn=>mn.text===Pn.text)||mn)}return Pt.map(At=>qe(Je,ot,At)).filter(dt)}function ze(Je,ct){const ot=[];return ct.parse(Je).iterate({enter:pt=>{if(pt.type.id===Ue){const Pt=pt.node;ot.push({node:Pt,text:Je.substring(Pt.from,Pt.to)})}}}),ot}function qe(Je,ct,ot){if(ct.length===1){const Pt=ot.node.from===ot.node.to,At=Pt&&ot.node.parent?ot.node.parent:ot.node,mn=Pt?Je.substring(At.from,At.to):ot.text;return{startLineNumber:1,startColumn:At.from+1,endLineNumber:1,endColumn:At.to+1,error:mn}}let Qe=0,pt=0;for(let Pt=0;Pt<ct.length;Pt++){if(pt=Qe+ct[Pt].length,ot.node.from>pt){Qe+=ct[Pt].length+1;continue}return{startLineNumber:Pt+1,startColumn:ot.node.from-Qe+1,endLineNumber:Pt+1,endColumn:ot.node.to-Qe+1,error:ot.text}}return null}function dt(Je){return Je!==null}const vt={__interval:{text:"1s",value:"1s"},__rate_interval:{text:"1s",value:"1s"},__auto:{text:"1s",value:"1s"},__interval_ms:{text:"1000",value:1e3},__range_ms:{text:"1000",value:1e3},__range_s:{text:"1",value:1},__range:{text:"1s",value:"1s"}},yt={wordPattern:/(-?\d*\.\d\w*)|([^`~!#%^&*()\-=+\[{\]}\\|;:'",.<>\/?\s]+)/g,comments:{lineComment:"#"},brackets:[["{","}"],["[","]"],["(",")"]],autoClosingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"}],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"},{open:"<",close:">"}],folding:{}},st=["sum","min","max","avg","group","stddev","stdvar","count","count_values","bottomk","topk","quantile"],Ve=["abs","absent","ceil","changes","clamp_max","clamp_min","day_of_month","day_of_week","days_in_month","delta","deriv","exp","floor","histogram_quantile","histogram_avg","histogram_count","histogram_sum","histogram_fraction","histogram_stddev","histogram_stdvar","holt_winters","hour","idelta","increase","irate","label_join","label_replace","ln","log2","log10","minute","month","predict_linear","rate","resets","round","scalar","sort","sort_desc","sqrt","time","timestamp","vector","year"],pe=[];for(let Je=0,ct=st;Je<ct.length;Je++){let ot=ct[Je];pe.push(ot+"_over_time")}const Ee=["on","ignoring","group_right","group_left","by","without"],me="("+Ee.reduce(function(Je,ct){return Je+"|"+ct})+")",ve=["+","-","*","/","%","^","==","!=",">","<",">=","<=","and","or","unless"],Se=["offset"],Oe={ignoreCase:!1,defaultToken:"",tokenPostfix:".promql",keywords:st.concat(Ve).concat(pe).concat(Ee).concat(Se),operators:ve,vectorMatching:me,symbols:/[=><!~?:&|+\-*\/^%]+/,escapes:/\\(?:[abfnrtv\\"']|x[0-9A-Fa-f]{1,4}|u[0-9A-Fa-f]{4}|U[0-9A-Fa-f]{8})/,digits:/\d+(_+\d+)*/,octaldigits:/[0-7]+(_+[0-7]+)*/,binarydigits:/[0-1]+(_+[0-1]+)*/,hexdigits:/[[0-9a-fA-F]+(_+[0-9a-fA-F]+)*/,integersuffix:/(ll|LL|u|U|l|L)?(ll|LL|u|U|l|L)?/,floatsuffix:/[fFlL]?/,tokenizer:{root:[[/@vectorMatching\s*(?=\()/,"type","@clauses"],[/[a-z_]\w*(?=\s*(=|!=|=~|!~))/,"tag"],[/(^#.*$)/,"comment"],[/[a-zA-Z_]\w*/,{cases:{"@keywords":"type","@default":"identifier"}}],[/"([^"\\]|\\.)*$/,"string.invalid"],[/'([^'\\]|\\.)*$/,"string.invalid"],[/"/,"string","@string_double"],[/'/,"string","@string_single"],[/`/,"string","@string_backtick"],{include:"@whitespace"},[/[{}()\[\]]/,"@brackets"],[/[<>](?!@symbols)/,"@brackets"],[/@symbols/,{cases:{"@operators":"delimiter","@default":""}}],[/\d+[smhdwy]/,"number"],[/\d*\d+[eE]([\-+]?\d+)?(@floatsuffix)/,"number.float"],[/\d*\.\d+([eE][\-+]?\d+)?(@floatsuffix)/,"number.float"],[/0[xX][0-9a-fA-F']*[0-9a-fA-F](@integersuffix)/,"number.hex"],[/0[0-7']*[0-7](@integersuffix)/,"number.octal"],[/0[bB][0-1']*[0-1](@integersuffix)/,"number.binary"],[/\d[\d']*\d(@integersuffix)/,"number"],[/\d(@integersuffix)/,"number"]],string_double:[[/[^\\"]+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/"/,"string","@pop"]],string_single:[[/[^\\']+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/'/,"string","@pop"]],string_backtick:[[/[^\\`$]+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/`/,"string","@pop"]],clauses:[[/[^(,)]/,"tag"],[/\)/,"identifier","@pop"]],whitespace:[[/[ \t\r\n]+/,"white"]]}},Re={codeLens:!1,contextmenu:!1,fixedOverflowWidgets:!0,folding:!1,fontSize:14,lineDecorationsWidth:8,lineNumbers:"off",minimap:{enabled:!1},overviewRulerBorder:!1,overviewRulerLanes:0,padding:{top:4,bottom:5},renderLineHighlight:"none",scrollbar:{vertical:"hidden",verticalScrollbarSize:8,horizontal:"hidden",horizontalScrollbarSize:0,alwaysConsumeMouseWheel:!1},scrollBeyondLastLine:!1,suggest:je(),suggestFontSize:12,wordWrap:"on"},he=2,Ce=y.promLanguageDefinition.id;let We=!1;function et(Je){if(We===!1){We=!0;const{aliases:ct,extensions:ot,mimetypes:Qe}=y.promLanguageDefinition;Je.languages.register({id:Ce,aliases:ct,extensions:ot,mimetypes:Qe}),Je.languages.setMonarchTokensProvider(Ce,Oe),Je.languages.setLanguageConfiguration(Ce,yt)}}const rt=(Je,ct)=>({container:(0,n.css)({borderRadius:Je.shape.radius.default,border:`1px solid ${Je.components.input.borderColor}`,display:"flex",flexDirection:"row",justifyContent:"start",alignItems:"center",height:"100%"}),placeholder:(0,n.css)({"::after":{content:`'${ct}'`,fontFamily:Je.typography.fontFamilyMonospace,opacity:.6}})}),gt=Je=>{const ct=(0,D.A)(),ot=(0,i.useRef)(b()),Qe=(0,i.useRef)(null),{languageProvider:pt,history:Pt,onBlur:At,onRunQuery:mn,initialValue:Pn,placeholder:fn,onChange:Rn,datasource:Kn}=Je,Bt=(0,u.A)(pt),an=(0,u.A)(Pt),tn=(0,u.A)(mn),Cn=(0,u.A)(At),xn=(0,u.A)(Rn),Vn=(0,i.useRef)(null),Et=(0,h.$j)(),Ft=rt(Et,fn);return(0,i.useEffect)(()=>()=>{Vn.current?.()},[]),(0,t.jsx)("div",{"data-testid":g.Tp.components.QueryField.container,className:Ft.container,ref:Qe,children:(0,t.jsx)(E.m,{overrideServices:ot.current,options:Re,language:"promql",value:Pn,beforeMount:Gt=>{et(Gt)},onMount:(Gt,ln)=>{const qt=Gt.createContextKey("isEditorFocused"+ct,!1);Gt.onDidBlurEditorWidget(()=>{qt.set(!1),Cn.current(Gt.getValue())}),Gt.onDidFocusEditorText(()=>{qt.set(!0)});const cn=new Pe.M9({historyProvider:an.current,languageProvider:Bt.current}),En=Ne(ln,cn),Sn={...En,provideCompletionItems:(Tt,Wt,jt,ut)=>Gt.getModel()?.id!==Tt.id?{suggestions:[]}:En.provideCompletionItems(Tt,Wt,jt,ut)},{dispose:Tn}=ln.languages.registerCompletionItemProvider(Ce,Sn);Vn.current=Tn;const Wn=()=>{const Tt=Qe.current;if(Tt!==null){const Wt=Gt.getContentHeight();Tt.style.height=`${Wt+he}px`,Tt.style.width="100%";const jt=Tt.clientWidth;Gt.layout({width:jt,height:Wt})}};Gt.onDidContentSizeChange(Wn),Wn();const Nn=(0,l.debounce)(()=>{const Tt=Gt.getValue();xn.current(Tt)},Bt.current.datasource.getDebounceTimeInMilliseconds());if(Gt.getModel()?.onDidChangeContent(()=>{Nn()}),Gt.addCommand(ln.KeyMod.Shift|ln.KeyCode.Enter,()=>{tn.current(Gt.getValue())},"isEditorFocused"+ct),ln.editor.addKeybindingRule({keybinding:ln.KeyMod.CtrlCmd|ln.KeyCode.KeyF,command:null}),Gt.addCommand(ln.KeyMod.CtrlCmd|ln.KeyCode.KeyK,function(){e.g.dispatchEvent(new KeyboardEvent("keydown",{key:"k",metaKey:!0}))}),fn){const Tt=[{range:new ln.Range(1,1,1,1),options:{className:Ft.placeholder,isWholeLine:!0}}];let Wt=[];const jt=()=>{const ut=Gt.getModel();if(!ut)return;const Zt=ut.getValueLength()===0?Tt:[];Wt=ut.deltaDecorations(Wt,Zt)};jt(),Gt.onDidChangeModelContent(jt),Gt.onDidChangeModelContent(ut=>{const Zt=Gt.getModel();if(!Zt)return;const jn=Zt.getValue(),Qn=($e(jn,Kn.interpolateString(jn,vt),Zt.getLinesContent(),v.K3)||[]).map(({error:Fn,...qn})=>({message:`${Fn?`Error parsing "${Fn}"`:"Parse error"}. The query appears to be incorrect and could fail to be executed.`,severity:ln.MarkerSeverity.Error,...qn}));ln.editor.setModelMarkers(Zt,"owner",Qn)})}}})})},xt=Je=>(0,t.jsx)(i.Suspense,{fallback:null,children:(0,t.jsx)(gt,{...Je})}),St=Je=>{const ct=(0,i.useRef)(null),{onRunQuery:ot,onChange:Qe,...pt}=Je,Pt=Pn=>{ct.current=Pn,Qe(Pn),ot()},At=Pn=>{Qe(Pn)},mn=Pn=>{Qe(Pn)};return(0,t.jsx)(xt,{onChange:mn,onRunQuery:Pt,onBlur:At,...pt})},zt="grafana.datasources.prometheus.browser.labels";function Nt(Je,ct,ot){return Je?"(Disabled)":ct?ot?"Metrics browser":"(No metrics found)":"Loading metrics..."}class Vt extends i.PureComponent{constructor(ct){super(ct),this.refreshHint=()=>{const{datasource:ot,query:Qe,data:pt}=this.props,Pt=ot.getInitHints(),At=Pt.length>0?Pt[0]:null;if(!pt||pt.series.length===0){this.setState({hint:At});return}const mn=(0,s.ci)(pt.series[0])?pt.series.map(s.w3):pt.series,Pn=ot.getQueryHints(Qe,mn);let fn=Pn.length>0?Pn[0]:null;this.setState({hint:fn??At})},this.refreshMetrics=async()=>{const{range:ot,datasource:{languageProvider:Qe}}=this.props;this.languageProviderInitializationPromise=m(Qe.start(ot));try{const pt=await this.languageProviderInitializationPromise.promise;await Promise.all(pt),this.onUpdateLanguage()}catch(pt){if(!(p(pt)&&pt.isCanceled))throw pt}},this.onChangeLabelBrowser=ot=>{this.onChangeQuery(ot,!0),this.setState({labelBrowserVisible:!1})},this.onChangeQuery=(ot,Qe)=>{const{query:pt,onChange:Pt,onRunQuery:At}=this.props;if(Pt){const mn={...pt,expr:ot};Pt(mn),Qe&&At&&At()}},this.onClickChooserButton=()=>{this.setState(ot=>({labelBrowserVisible:!ot.labelBrowserVisible})),(0,a.rR)("user_grafana_prometheus_metrics_browser_clicked",{editorMode:this.state.labelBrowserVisible?"metricViewClosed":"metricViewOpen",app:this.props?.app??""})},this.onClickHintFix=()=>{const{datasource:ot,query:Qe,onChange:pt,onRunQuery:Pt}=this.props,{hint:At}=this.state;At?.fix?.action&&pt(ot.modifyQuery(Qe,At.fix.action)),Pt()},this.onUpdateLanguage=()=>{const{datasource:{languageProvider:ot}}=this.props,{metrics:Qe}=ot;Qe&&this.setState({syntaxLoaded:!0})},this.state={labelBrowserVisible:!1,syntaxLoaded:!1,hint:null}}componentDidMount(){this.props.datasource.languageProvider&&this.refreshMetrics(),this.refreshHint()}componentWillUnmount(){this.languageProviderInitializationPromise&&this.languageProviderInitializationPromise.cancel()}componentDidUpdate(ct){const{data:ot,datasource:{languageProvider:Qe},range:pt}=this.props;Qe!==ct.datasource.languageProvider&&this.setState({syntaxLoaded:!1});const Pt=this.rangeChangedToRefresh(pt,ct.range);(Qe!==ct.datasource.languageProvider||Pt)&&this.refreshMetrics(),ot&&ct.data&&ct.data.series!==ot.series&&this.refreshHint()}rangeChangedToRefresh(ct,ot){if(ct&&ot){const Qe=(0,f.eN)(ct.from.valueOf())===(0,f.eN)(ot.from.valueOf()),pt=(0,f.eN)(ct.to.valueOf())===(0,f.eN)(ot.to.valueOf());return!(Qe&&pt)}return!1}render(){const{datasource:ct,datasource:{languageProvider:ot},query:Qe,ExtraFieldElement:pt,history:Pt=[],theme:At}=this.props,{labelBrowserVisible:mn,syntaxLoaded:Pn,hint:fn}=this.state,Rn=ot.metrics.length>0,Kn=Nt(ct.lookupsDisabled,Pn,Rn),Bt=!(Pn&&Rn);return(0,t.jsx)(r.b,{storageKey:zt,defaultValue:[],children:(an,tn,Cn)=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"gf-form-inline gf-form-inline--xs-view-flex-column flex-grow-1","data-testid":this.props["data-testid"],children:[(0,t.jsxs)("button",{className:"gf-form-label query-keyword pointer",onClick:this.onClickChooserButton,disabled:Bt,type:"button","data-testid":g.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.openButton,children:[Kn,(0,t.jsx)(c.I,{name:mn?"angle-down":"angle-right"})]}),(0,t.jsx)("div",{className:"flex-grow-1 min-width-15",children:(0,t.jsx)(St,{languageProvider:ot,history:Pt,onChange:this.onChangeQuery,onRunQuery:this.props.onRunQuery,initialValue:Qe.expr??"",placeholder:"Enter a PromQL query\u2026",datasource:ct})})]}),mn&&(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsx)(d.ur,{languageProvider:ot,onChange:this.onChangeLabelBrowser,lastUsedLabels:an||[],storeLastUsedLabels:tn,deleteLastUsedLabels:Cn,timeRange:this.props.range})}),pt,fn?(0,t.jsx)("div",{className:(0,n.css)({flexBasis:"100%"}),children:(0,t.jsxs)("div",{className:"text-warning",children:[fn.label," ",fn.fix?(0,t.jsx)("button",{type:"button",className:(0,n.cx)((0,o.my)(At),"text-link","muted"),onClick:this.onClickHintFix,children:fn.fix.label}):null]})}):null]})})}}const en=(0,h.cV)(Vt)},91396:(k,R,e)=>{"use strict";e.d(R,{_N:()=>u,bS:()=>D,ur:()=>M});var t=e(74848),n=e(32196),i=e(96540),s=e(91793),r=e(13544),g=e(3911),a=e(39558),c=e(67061),o=e(60029),h=e(10354),f=e(54438),d=e(55852),p=e(40845),m=e(81996);const v="{}",l="__name__",y=25,u="40000",D="none";function E(O){let I="";const T=[];for(const C of O)if((C.name===l||C.selected)&&C.values&&C.values.length>0){const S=C.values.filter(A=>A.selected).map(A=>A.name);S.length>1?T.push(`${C.name}=~"${S.map(m.Cs).join("|")}"`):S.length===1&&(C.name===l?I=S[0]:T.push(`${C.name}="${(0,m.Qn)(S[0])}"`))}return[I,"{",T.join(","),"}"].join("")}function x(O,I,T){return O.map(C=>{const S=I[C.name];if(S){let A;if(C.name===T&&C.values)A=C.values;else{const L=new Set(C.values?.filter(N=>N.selected).map(N=>N.name)||[]);A=S.map(N=>({name:N,selected:L.has(N)}))}return{...C,loading:!1,values:A,hidden:!S,facets:A.length}}return{...C,loading:!1,hidden:!S,values:void 0,facets:0}})}const P=(0,g.N)(O=>({wrapper:(0,n.css)({backgroundColor:O.colors.background.secondary,padding:O.spacing(1),width:"100%"}),list:(0,n.css)({marginTop:O.spacing(1),display:"flex",flexWrap:"wrap",maxHeight:"200px",overflow:"auto",alignContent:"flex-start"}),section:(0,n.css)({"& + &":{margin:`${O.spacing(2)} 0`},position:"relative"}),selector:(0,n.css)({fontFamily:O.typography.fontFamilyMonospace,marginBottom:O.spacing(1)}),status:(0,n.css)({padding:O.spacing(.5),color:O.colors.text.secondary,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",position:"absolute",width:"50%",right:0,textAlign:"right",opacity:0,[O.transitions.handleMotion("no-preference","reduce")]:{transition:"opacity 100ms linear"}}),statusShowing:(0,n.css)({opacity:1}),error:(0,n.css)({color:O.colors.error.main}),valueList:(0,n.css)({marginRight:O.spacing(1),resize:"horizontal"}),valueListWrapper:(0,n.css)({borderLeft:`1px solid ${O.colors.border.medium}`,margin:`${O.spacing(1)} 0`,padding:`${O.spacing(1)} 0 ${O.spacing(1)} ${O.spacing(1)}`}),valueListArea:(0,n.css)({display:"flex",flexWrap:"wrap",marginTop:O.spacing(1)}),valueTitle:(0,n.css)({marginLeft:`-${O.spacing(.5)}`,marginBottom:O.spacing(1)}),validationStatus:(0,n.css)({padding:O.spacing(.5),marginBottom:O.spacing(1),color:O.colors.text.maxContrast,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"})}));class b extends i.Component{constructor(){super(...arguments),this.valueListsRef=i.createRef(),this.state={labels:[],labelSearchTerm:"",metricSearchTerm:"",status:"Ready",error:"",validationStatus:"",valueSearchTerm:""},this.onChangeLabelSearch=I=>{this.setState({labelSearchTerm:I.target.value})},this.onChangeMetricSearch=I=>{this.setState({metricSearchTerm:I.target.value})},this.onChangeSeriesLimit=I=>{this.setState({seriesLimit:I.target.value.trim()})},this.onChangeValueSearch=I=>{this.setState({valueSearchTerm:I.target.value})},this.onClickRunQuery=()=>{const I=E(this.state.labels);this.props.onChange(I)},this.onClickRunRateQuery=()=>{const T=`rate(${E(this.state.labels)}[$__rate_interval])`;this.props.onChange(T)},this.onClickClear=()=>{this.setState(I=>({labels:I.labels.map(C=>({...C,values:void 0,selected:!1,loading:!1,hidden:!1,facets:void 0})),labelSearchTerm:"",metricSearchTerm:"",status:"",error:"",validationStatus:"",valueSearchTerm:""})),this.props.deleteLastUsedLabels(),this.fetchValues(l,v)},this.onClickLabel=(I,T,C)=>{const S=this.state.labels.find(N=>N.name===I);if(!S)return;const A=!S.selected;let L={selected:A};if(S.values&&!A){const N=S.values.map(F=>({...F,selected:!1}));L={...L,facets:0,values:N}}this.setState({labelSearchTerm:""}),this.updateLabelState(I,L,"",()=>this.doFacettingForLabel(I))},this.onClickValue=(I,T,C)=>{const S=this.state.labels.find(L=>L.name===I);if(!S||!S.values)return;this.setState({labelSearchTerm:""});const A=S.values.map(L=>({...L,selected:L.name===T?!L.selected:L.selected}));this.updateLabelState(I,{values:A},"",()=>this.doFacetting(I))},this.onClickMetric=(I,T,C)=>{const S=this.state.labels.find(N=>N.name===I);if(!S||!S.values)return;this.setState({metricSearchTerm:""});const A=S.values.map(N=>({...N,selected:N.name===T||N.selected?!N.selected:N.selected})),L=A.some(N=>N.selected);this.updateLabelState(I,{selected:L,values:A},"",()=>this.doFacetting(I))},this.onClickValidate=()=>{const I=E(this.state.labels);this.validateSelector(I)},this.doFacetting=I=>{const T=E(this.state.labels);if(T===v){const C=this.state.labels.map(S=>({...S,facets:0,values:void 0,hidden:!1}));this.setState({labels:C},()=>{this.state.labels.forEach(S=>(S.selected||S.name===l)&&this.fetchValues(S.name,T))})}else this.fetchSeries(T,I)}}updateLabelState(I,T,C="",S){this.setState(A=>{const L=A.labels.map(F=>F.name===I?{...F,...T}:F),N=C?"":A.error;return{labels:L,status:C,error:N,validationStatus:""}},S)}componentDidMount(){const{languageProvider:I,lastUsedLabels:T}=this.props;if(I){const C=T;I.start(this.props.timeRange).then(()=>{let S=I.getLabelKeys();this.fetchValues(l,v);const A=S.map((L,N,F)=>({name:L,selected:C.includes(L),loading:!1}));this.setState({labels:A},()=>{this.state.labels.forEach(L=>{L.selected&&this.fetchValues(L.name,v)})})})}}doFacettingForLabel(I){const T=this.state.labels.find(S=>S.name===I);if(!T)return;const C=this.state.labels.filter(S=>S.selected).map(S=>S.name);this.props.storeLastUsedLabels(C),T.selected?T.values||this.fetchValues(I,E(this.state.labels)):this.doFacetting()}async fetchValues(I,T){const{languageProvider:C}=this.props;this.updateLabelState(I,{loading:!0},`Fetching values for ${I}`);try{let S=await C.getLabelValues(I);if(T!==E(this.state.labels)){this.updateLabelState(I,{loading:!1});return}const A=[],{metricsMetadata:L}=C;for(const N of S){const F={name:N};if(I===l&&L){const w=L[N];w&&(F.details=`(${w.type}) ${w.help}`)}A.push(F)}this.updateLabelState(I,{values:A,loading:!1})}catch(S){console.error(S)}}async fetchSeries(I,T){const{languageProvider:C}=this.props;T&&this.updateLabelState(T,{loading:!0},`Facetting labels for ${I}`);try{const S=await C.fetchSeriesLabels(I,!0,this.state.seriesLimit);if(I!==E(this.state.labels)){T&&this.updateLabelState(T,{loading:!1});return}if(Object.keys(S).length===0){this.setState({error:`Empty results, no matching label for ${I}`});return}const A=x(this.state.labels,S,T);this.setState({labels:A,error:""}),T&&this.updateLabelState(T,{loading:!1})}catch(S){console.error(S)}}async validateSelector(I){const{languageProvider:T}=this.props;this.setState({validationStatus:`Validating selector ${I}`,error:""});const C=await T.fetchSeries(I);this.setState({validationStatus:`Selector is valid (${C.length} series found)`})}render(){const{theme:I}=this.props,{labels:T,labelSearchTerm:C,metricSearchTerm:S,status:A,error:L,validationStatus:N,valueSearchTerm:F}=this.state,w=P(I);if(T.length===0)return(0,t.jsx)("div",{className:w.wrapper,children:(0,t.jsx)(a._,{text:"Loading labels..."})});let B=T.find(X=>X.name===l);B&&S&&(B={...B,values:B.values?.filter(X=>X.selected||X.name.includes(S))});let U=T.filter(X=>!X.hidden&&X.name!==l);C&&(U=U.filter(X=>X.selected||X.name.includes(C)));let K=U.filter(X=>X.selected&&X.values);F&&(K=K.map(X=>({...X,values:X.values?.filter(J=>J.selected||J.name.includes(F))})));const V=E(this.state.labels),H=V===v,Y=B?.values?.length||0;return(0,t.jsxs)("div",{className:w.wrapper,children:[(0,t.jsxs)(c.B,{gap:3,children:[(0,t.jsx)("div",{children:(0,t.jsxs)("div",{className:w.section,children:[(0,t.jsx)(o.J,{description:"Once a metric is selected only possible labels are shown. Labels are limited by the series limit below.",children:"1. Select a metric"}),(0,t.jsx)("div",{children:(0,t.jsx)(h.p,{onChange:this.onChangeMetricSearch,"aria-label":"Filter expression for metric",value:S,"data-testid":r.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.selectMetric})}),(0,t.jsx)(o.J,{description:"Set to 'none' to remove limit and show all labels for a selected metric. Removing the limit may cause performance issues.",children:"Series limit"}),(0,t.jsx)("div",{children:(0,t.jsx)(h.p,{onChange:this.onChangeSeriesLimit,"aria-label":"Limit results from series endpoint",value:this.state.seriesLimit??u,"data-testid":r.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.seriesLimit})}),(0,t.jsx)("div",{role:"list",className:w.valueListWrapper,"data-testid":r.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.metricList,children:(0,t.jsx)(s.Y1,{height:Math.min(450,Y*y),itemCount:Y,itemSize:y,itemKey:X=>B.values[X].name,width:300,className:w.valueList,children:({index:X,style:J})=>{const q=B?.values?.[X];return q?(0,t.jsx)("div",{style:J,children:(0,t.jsx)(f.J,{name:B.name,value:q?.name,title:q.details,active:q?.selected,onClick:this.onClickMetric,searchTerm:S})}):null}})})]})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:w.section,children:[(0,t.jsx)(o.J,{description:"Once label values are selected, only possible label combinations are shown.",children:"2. Select labels to search in"}),(0,t.jsx)("div",{children:(0,t.jsx)(h.p,{onChange:this.onChangeLabelSearch,"aria-label":"Filter expression for label",value:C,"data-testid":r.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.labelNamesFilter})}),(0,t.jsx)("div",{className:w.list,style:{height:120},children:U.map(X=>(0,t.jsx)(f.J,{name:X.name,loading:X.loading,active:X.selected,hidden:X.hidden,facets:X.facets,onClick:this.onClickLabel,searchTerm:C},X.name))})]}),(0,t.jsxs)("div",{className:w.section,children:[(0,t.jsx)(o.J,{description:"Use the search field to find values across selected labels.",children:"3. Select (multiple) values for your labels"}),(0,t.jsx)("div",{children:(0,t.jsx)(h.p,{onChange:this.onChangeValueSearch,"aria-label":"Filter expression for label values",value:F,"data-testid":r.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.labelValuesFilter})}),(0,t.jsx)("div",{className:w.valueListArea,ref:this.valueListsRef,children:K.map(X=>(0,t.jsxs)("div",{role:"list","aria-label":`Values for ${X.name}`,className:w.valueListWrapper,children:[(0,t.jsx)("div",{className:w.valueTitle,children:(0,t.jsx)(f.J,{name:X.name,loading:X.loading,active:X.selected,hidden:X.hidden,facets:X.facets||X.values?.length,onClick:this.onClickLabel})}),(0,t.jsx)(s.Y1,{height:Math.min(200,y*(X.values?.length||0)),itemCount:X.values?.length||0,itemSize:28,itemKey:J=>X.values[J].name,width:200,className:w.valueList,children:({index:J,style:q})=>{const ae=X.values?.[J];return ae?(0,t.jsx)("div",{style:q,children:(0,t.jsx)(f.J,{name:X.name,value:ae?.name,active:ae?.selected,onClick:this.onClickValue,searchTerm:F})}):null}})]},X.name))})]})]})]}),(0,t.jsxs)("div",{className:w.section,children:[(0,t.jsx)(o.J,{children:"4. Resulting selector"}),(0,t.jsx)("div",{"aria-label":"selector",className:w.selector,children:V}),N&&(0,t.jsx)("div",{className:w.validationStatus,children:N}),(0,t.jsxs)(c.B,{children:[(0,t.jsx)(d.$n,{"data-testid":r.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.useQuery,"aria-label":"Use selector for query button",disabled:H,onClick:this.onClickRunQuery,children:"Use query"}),(0,t.jsx)(d.$n,{"data-testid":r.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.useAsRateQuery,"aria-label":"Use selector as metrics button",variant:"secondary",disabled:H,onClick:this.onClickRunRateQuery,children:"Use as rate query"}),(0,t.jsx)(d.$n,{"data-testid":r.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.validateSelector,"aria-label":"Validate submit button",variant:"secondary",disabled:H,onClick:this.onClickValidate,children:"Validate selector"}),(0,t.jsx)(d.$n,{"data-testid":r.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.clear,"aria-label":"Selector clear button",variant:"secondary",onClick:this.onClickClear,children:"Clear"}),(0,t.jsx)("div",{className:(0,n.cx)(w.status,(A||L)&&w.statusShowing),children:(0,t.jsx)("span",{className:L?w.error:"",children:L||A})})]})]})]})}}const M=(0,p.cV)(b)},91306:(k,R,e)=>{"use strict";e.d(R,{M9:()=>i,Ol:()=>n,w0:()=>t});const t="codeModeSuggestionsIncomplete";function n(s){return s.type===t&&"detail"in s&&typeof s.detail=="object"&&s.detail!==null&&"limit"in s.detail&&"datasourceUid"in s.detail}class i{constructor(r){this.languageProvider=r.languageProvider,this.historyProvider=r.historyProvider,this.inputInRange="",this.metricNamesSuggestionLimit=this.languageProvider.datasource.metricNamesAutocompleteSuggestionLimit,this.suggestionsIncomplete=!1,this.getSeriesLabels=this.languageProvider.getSeriesLabels.bind(this.languageProvider),this.getSeriesValues=this.languageProvider.getSeriesValues.bind(this.languageProvider),this.getAllLabelNames=this.languageProvider.getLabelKeys.bind(this.languageProvider),this.getLabelValues=this.languageProvider.getLabelValues.bind(this.languageProvider)}getHistory(){return this.historyProvider.map(r=>r.query.expr).filter(Boolean)}getAllMetricNames(){return this.languageProvider.metrics}metricNamesToMetrics(r){const{metricsMetadata:g}=this.languageProvider;return r.map(c=>{const o=g?.[c];return{name:c,help:o?.help??"",type:o?.type??""}})}enableAutocompleteSuggestionsUpdate(){this.suggestionsIncomplete=!0,dispatchEvent(new CustomEvent(t,{detail:{limit:this.metricNamesSuggestionLimit,datasourceUid:this.languageProvider.datasource.uid}}))}setInputInRange(r){this.inputInRange=r}get monacoSettings(){return{enableAutocompleteSuggestionsUpdate:this.enableAutocompleteSuggestionsUpdate.bind(this),inputInRange:this.inputInRange,setInputInRange:this.setInputInRange.bind(this),suggestionsIncomplete:this.suggestionsIncomplete}}}},4936:(k,R,e)=>{"use strict";e.d(R,{TT:()=>a,Zh:()=>c,jW:()=>g,k1:()=>s});var t=e(74848),n=e(32196),i=e(72093);const s=30,r=o=>{const{options:h,onOptionsChange:f}=o,d=useTheme2(),p=c(d);return jsxs(Fragment,{children:[h.access==="direct"&&jsx(Alert,{title:"Error",severity:"error",children:"Browser access mode in the Prometheus data source is no longer available. Switch to server access mode."}),jsx(DataSourceDescription,{dataSourceName:"Prometheus",docsLink:"https://grafana.com/docs/grafana/latest/datasources/prometheus/configure-prometheus-data-source/"}),jsx("hr",{className:`${p.hrTopSpace} ${p.hrBottomSpace}`}),jsx(DataSourceHttpSettingsOverhaul,{options:h,onOptionsChange:f,secureSocksDSProxyEnabled:config.secureSocksDSProxyEnabled}),jsx("hr",{}),jsxs(ConfigSection,{className:p.advancedSettings,title:"Advanced settings",description:"Additional settings are optional settings that can be configured for more control over your data source.",children:[jsx(AdvancedHttpSettings,{className:p.advancedHTTPSettingsMargin,config:h,onChange:f}),jsx(AlertingSettingsOverhaul,{options:h,onOptionsChange:f}),jsx(PromSettings,{options:h,onOptionsChange:f})]})]})};function g(o){return(0,t.jsx)("a",{href:o||"https://grafana.com/docs/grafana/latest/datasources/prometheus/#configure-the-data-source",target:"_blank",rel:"noopener noreferrer",children:"Visit docs for more details here."})}const a=(o,h,f)=>{const d="Value is not valid";return o&&!o.match(h)?(0,t.jsx)(i.P,{children:f||d}):!0};function c(o){return{additionalSettings:(0,n.css)({marginBottom:"25px"}),secondaryGrey:(0,n.css)({color:o.colors.secondary.text,opacity:"65%"}),inlineError:(0,n.css)({margin:"0px 0px 4px 245px"}),switchField:(0,n.css)({alignItems:"center"}),sectionHeaderPadding:(0,n.css)({paddingTop:"32px"}),sectionBottomPadding:(0,n.css)({paddingBottom:"28px"}),subsectionText:(0,n.css)({fontSize:"12px"}),hrBottomSpace:(0,n.css)({marginBottom:"56px"}),hrTopSpace:(0,n.css)({marginTop:"50px"}),textUnderline:(0,n.css)({textDecoration:"underline"}),versionMargin:(0,n.css)({marginBottom:"12px"}),advancedHTTPSettingsMargin:(0,n.css)({margin:"24px 0 8px 0"}),advancedSettings:(0,n.css)({paddingTop:"32px"}),alertingTop:(0,n.css)({marginTop:"40px !important"}),overhaulPageHeading:(0,n.css)({fontWeight:400}),container:(0,n.css)({maxwidth:578})}}},75212:(k,R,e)=>{"use strict";e.d(R,{gs:()=>Ee,UD:()=>me});var t=e(2543),n=e(13288),i=e(75505),s=e(81160),r=e(59099),g=e(97716),a=e.n(g),c=e(65879),o=e(43659),h=e(43127),f=e(47232),d=e(37891),p=e(41987),m=e(26657),v=e(72574),l=e(47773),y=e(17172),u=e(32264),D=e(80937),E=e(74848),x=e(13544),P=e(71087),b=e(9e4),M=e(81580),O=e(79458),I=e(51440),T=e(68402),C=e(10354),S=e(80109);function A(Re){const he=Re.annotation,Ce=Re.onAnnotationChange,We={expr:he.expr,refId:he.name,interval:he.step};return(0,E.jsxs)(E.Fragment,{children:[(0,E.jsxs)(P.D,{children:[(0,E.jsx)(S.$,{...Re,query:We,showExplain:!1,onChange:et=>{Ce({...he,expr:et.expr})}}),(0,E.jsx)(b.U,{children:(0,E.jsx)(M.c,{label:"Min step",tooltip:(0,E.jsxs)(E.Fragment,{children:["An additional lower limit for the step parameter of the Prometheus query and for the"," ",(0,E.jsx)("code",{children:"$__interval"})," and ",(0,E.jsx)("code",{children:"$__rate_interval"})," variables."]}),children:(0,E.jsx)(I.D,{type:"text","aria-label":"Set lower limit for the step parameter",placeholder:"auto",minWidth:10,onCommitChange:et=>{Ce({...he,step:et.currentTarget.value})},defaultValue:We.interval,id:x.Tp.components.DataSource.Prometheus.annotations.minStep})})})]}),(0,E.jsx)(T.$,{v:.5}),(0,E.jsxs)(b.U,{children:[(0,E.jsx)(M.c,{label:"Title",tooltip:"Use either the name or a pattern. For example, {{instance}} is replaced with label value for the label instance.",children:(0,E.jsx)(C.p,{type:"text",placeholder:"{{alertname}}",value:he.titleFormat,onChange:et=>{Ce({...he,titleFormat:et.currentTarget.value})},"data-testid":x.Tp.components.DataSource.Prometheus.annotations.title})}),(0,E.jsx)(M.c,{label:"Tags",children:(0,E.jsx)(C.p,{type:"text",placeholder:"label1,label2",value:he.tagKeys,onChange:et=>{Ce({...he,tagKeys:et.currentTarget.value})},"data-testid":x.Tp.components.DataSource.Prometheus.annotations.tags})}),(0,E.jsx)(M.c,{label:"Text",tooltip:"Use either the name or a pattern. For example, {{instance}} is replaced with label value for the label instance.",children:(0,E.jsx)(C.p,{type:"text",placeholder:"{{instance}}",value:he.textFormat,onChange:et=>{Ce({...he,textFormat:et.currentTarget.value})},"data-testid":x.Tp.components.DataSource.Prometheus.annotations.text})}),(0,E.jsx)(M.c,{label:"Series value as timestamp",tooltip:"The unit of timestamp is milliseconds. If the unit of the series value is seconds, multiply its range vector by 1000.",children:(0,E.jsx)(O.C,{value:he.useValueForTime,onChange:et=>{Ce({...he,useValueForTime:et.currentTarget.value})},"data-testid":x.Tp.components.DataSource.Prometheus.annotations.seriesValueAsTimestamp})})]})]})}var L=e(50556),N=e(81996),F=e(32370),w=e(76040),B=e(62183);const U=/^label_names\(\)\s*$/,K=/^label_values\((?:(.+),\s*)?([a-zA-Z_$][a-zA-Z0-9_]*)\)\s*$/,V=/^metrics\((.+)\)\s*$/,H=/^query_result\((.+)\)\s*$/,Y=/^label_names\((.+)\)\s*$/;function X(Re){if(typeof Re!="string")return Re;const he={refId:"PrometheusDatasource-VariableQuery",qryType:B.B4.LabelNames},Ce=Re.match(Y);if(Ce)return{...he,qryType:B.B4.LabelNames,match:Ce[1]};const We=Re.match(U);if(We)return{...he,qryType:B.B4.LabelNames};const et=Re.match(/^label_values\(/);if(et){const gt=Re.match(K),xt=gt?gt[2]:"",St=gt?gt[1]:"";if(St){const zt=(0,w.u)(St);return{...he,qryType:B.B4.LabelValues,label:xt,metric:zt.query.metric,labelFilters:zt.query.labels}}else return{...he,qryType:B.B4.LabelValues,label:xt}}const rt=Re.match(/^metrics\(/);if(rt){const gt=Re.match(V),xt=gt?gt[1]:"";return{...he,qryType:B.B4.MetricNames,metric:xt}}const nt=Re.match(/^query_result\(/);if(nt){const gt=Re.match(H),xt=gt?gt[1]:"";return{...he,qryType:B.B4.VarQueryResult,varQuery:xt}}return!We&&!et&&!rt&&!nt?{...he,qryType:B.B4.SeriesQuery,seriesQuery:Re}:he}function J(Re){switch(Re.qryType){case B.B4.LabelNames:return Re.match?`label_names(${Re.match})`:"label_names()";case B.B4.LabelValues:if(Re.metric||Re.labelFilters&&Re.labelFilters.length!==0){const Ce={metric:Re.metric,labels:Re.labelFilters??[],operations:[]};return`label_values(${F.z.renderQuery(Ce)},${Re.label})`}else return`label_values(${Re.label})`;case B.B4.MetricNames:return`metrics(${Re.metric})`;case B.B4.VarQueryResult:return`query_result(${q(Re.varQuery)})`;case B.B4.SeriesQuery:return Re.seriesQuery??"";case B.B4.ClassicQuery:return Re.classicQuery??""}return""}function q(Re){return Re?Re.replace(/[\r\n]+/gm,""):""}class ae{constructor(he,Ce){this.datasource=he,this.query=Ce,this.datasource=he,this.query=Ce,this.range=(0,h.E2)()}process(he){this.range=he;const Ce=U,We=Y,et=/^label_values\((?:(.+),\s*)?([a-zA-Z_][a-zA-Z0-9_]*)\)\s*$/,rt=V,nt=H,gt=this.query.match(Ce),xt=this.query.match(We);if(xt){const en=`{__name__=~".*${xt[1]}.*"}`;return this.datasource.languageProvider.getSeriesLabels(en,[]).then(Je=>Je.map(ct=>({text:ct})))}if(gt)return this.datasource.getTagKeys({filters:[],timeRange:he});const St=this.query.match(et);if(St){const en=St[1],Je=St[2];return j(en)?this.labelValuesQuery(Je,en):this.labelValuesQuery(Je)}const zt=this.query.match(rt);if(zt)return this.metricNameQuery(zt[1]);const Nt=this.query.match(nt);return Nt?this.queryResultQuery(Nt[1]):["label_values()","metrics()","query_result()"].includes(this.query)?Promise.resolve([]):this.metricNameAndLabelsQuery(this.query)}labelValuesQuery(he,Ce){const We=(0,N.mv)(this.range.from,!1),et=(0,N.mv)(this.range.to,!0),rt={...Ce&&{"match[]":Ce},start:We.toString(),end:et.toString()};if(!Ce||this.datasource.hasLabelsMatchAPISupport()){const nt=`/api/v1/label/${he}/values`;return this.datasource.metadataRequest(nt,rt).then(gt=>(0,t.map)(gt.data.data,xt=>({text:xt})))}else return this.datasource.metadataRequest("/api/v1/series",rt).then(gt=>{const xt=(0,t.map)(gt.data.data,St=>St[he]||"").filter(St=>St!=="");return(0,t.uniq)(xt).map(St=>({text:St,expandable:!0}))})}metricNameQuery(he){const Ce=(0,N.mv)(this.range.from,!1),We=(0,N.mv)(this.range.to,!0),et={start:Ce.toString(),end:We.toString()};return this.datasource.metadataRequest("/api/v1/label/__name__/values",et).then(nt=>(0,t.chain)(nt.data.data).filter(gt=>new RegExp(he).test(gt)).map(gt=>({text:gt,expandable:!0})).value())}queryResultQuery(he){const Ce="/api/v1/query",We={query:he,time:(0,N.mv)(this.range.to,!0).toString()};return this.datasource.metadataRequest(Ce,We).then(et=>{switch(et.data.data.resultType){case"scalar":case"string":return[{text:et.data.data.result[1]||"",expandable:!1}];case"vector":return(0,t.map)(et.data.data.result,rt=>{let nt=rt.metric.__name__||"";return delete rt.metric.__name__,nt+="{"+(0,t.map)(rt.metric,(gt,xt)=>xt+'="'+gt+'"').join(",")+"}",nt+=" "+rt.value[1]+" "+rt.value[0]*1e3,{text:nt,expandable:!0}});default:throw Error(`Unknown/Unhandled result type: [${et.data.data.resultType}]`)}})}metricNameAndLabelsQuery(he){const Ce=(0,N.mv)(this.range.from,!1),We=(0,N.mv)(this.range.to,!0),et={"match[]":he,start:Ce.toString(),end:We.toString()},rt="/api/v1/series",nt=this;return this.datasource.metadataRequest(rt,et).then(gt=>(0,t.map)(gt.data.data,xt=>({text:nt.datasource.getOriginalMetricName(xt),expandable:!0})))}}function j(Re){return Re&&Re.split(" ").join("")!=="{}"}const te=20;function ne(Re,he,Ce){const We=[],et=Ce?.languageProvider?.metricsMetadata;if(Re.trim().match(/^\w+_bucket$|^\w+_bucket{.*}$/))We.push({type:"HISTOGRAM_QUANTILE",label:"Selected metric has buckets.",fix:{label:"Consider calculating aggregated quantile by adding histogram_quantile().",action:{type:"ADD_HISTOGRAM_QUANTILE",query:Re}}});else if(et&&oe(Re)){const nt=ie(Re),{nameMetric:gt}=Z(nt,"histogram",et,!1);if(gt){const St="Selected metric is a native histogram.";We.push({type:"HISTOGRAM_AVG",label:St,fix:{label:"Consider calculating the arithmetic average of observed values by adding histogram_avg().",action:{type:"ADD_HISTOGRAM_AVG",query:Re}}},{type:"HISTOGRAM_COUNT",label:St,fix:{label:"Consider calculating the count of observations by adding histogram_count().",action:{type:"ADD_HISTOGRAM_COUNT",query:Re}}},{type:"HISTOGRAM_SUM",label:St,fix:{label:"Consider calculating the sum of observations by adding histogram_sum().",action:{type:"ADD_HISTOGRAM_SUM",query:Re}}},{type:"HISTOGRAM_FRACTION",label:St,fix:{label:"Consider calculating the estimated fraction of observations between the provided lower and upper values by adding histogram_fraction().",action:{type:"ADD_HISTOGRAM_FRACTION",query:Re}}},{type:"HISTOGRAM_STDDEV",label:St,fix:{label:"Consider calculating the estimated standard deviation of observations by adding histogram_stddev().",action:{type:"ADD_HISTOGRAM_STDDEV",query:Re}}},{type:"HISTOGRAM_STDVAR",label:St,fix:{label:"Consider calculating the estimated standard variance of observations by adding histogram_stdvar().",action:{type:"ADD_HISTOGRAM_STDVAR",query:Re}}})}}if(Re.indexOf("rate(")===-1&&Re.indexOf("increase(")===-1){const nt=Re.match(/\b((?<!:)\w+_(total|sum|count)(?!:))\b/);let gt=nt?nt[1]:"",xt=!1;if(et){const St=ie(Re),zt=Z(St,"counter",et,xt);gt=zt.nameMetric,xt=zt.certain}if(gt){const St=oe(Re);let Nt=`Selected metric ${xt?"is":"looks like"} a counter.`,Vt;St?Vt={label:"Consider calculating rate of counter by adding rate().",action:{type:"ADD_RATE",query:Re}}:Nt=`${Nt} Consider calculating rate of counter by adding rate().`,We.push({type:"APPLY_RATE",label:Nt,fix:Vt})}}if(Ce&&Ce.ruleMappings){const nt=z(Re,Ce.ruleMappings);We.push(...nt)}return he&&he.length>=te&&Re.trim().match(/^\w+$/)&&We.push({type:"ADD_SUM",label:"Many time series results returned.",fix:{label:"Consider aggregating with sum().",action:{type:"ADD_SUM",query:Re,preventSubmit:!0}}}),We}function le(Re){const he=[];return Re.lookupsDisabled&&he.push({label:"Labels and metrics lookup was disabled in data source settings.",type:"INFO"}),he}function z(Re,he){const Ce=[],We=Object.keys(he).reduce((et,rt)=>{if(Re.search(rt)===-1)return et;if(he[rt].length>1){const{idx:nt,expandedQuery:gt,identifier:xt,identifierValue:St}=ee(Re,rt,he[rt]);return nt===-1?(Ce.push({type:"EXPAND_RULES_WARNING",label:"We found multiple recording rules that match in this query. To expand the recording rule, add an identifier label/value."}),et):{...et,[rt]:{expandedQuery:gt,identifier:xt,identifierValue:St}}}else return{...et,[rt]:{expandedQuery:he[rt][0].query}}},{});return(0,t.size)(We)>0&&Ce.push({type:"EXPAND_RULES",label:"Query contains recording rules.",fix:{label:"Expand rules",action:{type:"EXPAND_RULES",query:Re,options:We}}}),Ce}function ee(Re,he,Ce){const{query:We}=(0,w.u)(Re),et=se(he,We);if(et.length===0)return{idx:-1,identifier:"",identifierValue:"",expandedQuery:""};let rt="",nt="",gt=-1;return et.forEach(xt=>{gt===-1&&xt.label.search("uuid")!==-1&&(rt=xt.label,nt=xt.value)}),Ce.forEach((xt,St)=>{xt.labels&&Object.entries(xt.labels).forEach(([zt,Nt])=>{gt===-1&&zt===rt&&Nt===nt&&(gt=St)})}),{idx:gt,identifier:rt,identifierValue:nt,expandedQuery:Ce[gt]?.query??""}}function se(Re,he){if(he.metric===Re)return he.labels;if(he.binaryQueries)for(let Ce=0;Ce<he.binaryQueries.length;Ce++){const We=se(Re,he.binaryQueries[Ce].query);if(We&&We.length>0)return We}return[]}function ie(Re){return Array.from(Re.matchAll(/\$?[a-zA-Z_:][a-zA-Z0-9_:]*/g)).map(([he])=>he).filter(he=>!he.startsWith("$")).flatMap(he=>he.split(":"))}function Z(Re,he,Ce,We){return{nameMetric:Re.find(rt=>{const nt=Ce[rt];return nt&&nt.type.toLowerCase()===he?(We=!0,!0):!1})??"",certain:We}}function oe(Re){return Re.trim().match(/^\w+$|^\w+{.*}$/)}var ce=e(33115),ye=e(59809),re=e(14110);function ue(Re,he,Ce){const{app:We,targets:et}=he;if(We===p.Jk.Explore)for(const rt of et)(0,re.rR)("grafana_prometheus_query_executed",{app:We,grafana_version:u.$.buildInfo.version,has_data:Re.data.some(nt=>nt.length>0),has_error:Re.error!==void 0,expr:rt.expr,format:rt.format,instant:rt.instant,range:rt.range,exemplar:rt.exemplar,hinting:rt.hinting,interval:rt.interval,intervalFactor:rt.intervalFactor,utcOffsetSec:rt.utcOffsetSec,legend:rt.legendFormat,valueWithRefId:rt.valueWithRefId,requestId:he.requestId,showingGraph:rt.showingGraph,showingTable:rt.showingTable,editor_mode:rt.editorMode,simultaneously_sent_query_count:et.length,time_range_from:he?.range?.from?.toISOString(),time_range_to:he?.range?.to?.toISOString(),time_taken:Date.now()-Ce.getTime()})}var De=e(62467),ge=e(65474),Te=e(29505),Le=e(76459),Ye=e.n(Le),je=e(96540),Ze=e(50877),Ne=e(39268),Pe=e(14186),Ue=e(90182),$e=e(21744),ze=e(29993);const qe=[{label:"Label names",value:B.B4.LabelNames},{label:"Label values",value:B.B4.LabelValues},{label:"Metrics",value:B.B4.MetricNames},{label:"Query result",value:B.B4.VarQueryResult},{label:"Series query",value:B.B4.SeriesQuery},{label:"Classic query",value:B.B4.ClassicQuery}],dt="PrometheusVariableQueryEditor-VariableQuery",vt=({onChange:Re,query:he,datasource:Ce,range:We})=>{const[et,rt]=(0,je.useState)(void 0),[nt,gt]=(0,je.useState)(""),[xt,St]=(0,je.useState)(""),[zt,Nt]=(0,je.useState)(""),[Vt,en]=(0,je.useState)(""),[Je,ct]=(0,je.useState)(""),[ot,Qe]=(0,je.useState)(""),[pt,Pt]=(0,je.useState)([]),[At,mn]=(0,je.useState)([]);function Pn(qt,cn){mn([...cn,...qt]);const En=(0,N.ky)(qt);Pt([...cn,...En])}const[fn,Rn]=(0,je.useState)([]);(0,je.useEffect)(()=>{Ce.languageProvider.start(We)},[]),(0,je.useEffect)(()=>{if(he)if(he.qryType===B.B4.ClassicQuery)rt(he.qryType),Qe(he.query??"");else{const qt=yt(he);St(qt.match??""),rt(qt.qryType),gt(qt.label??""),Nt(qt.metric??""),Rn(qt.labelFilters??[]),en(qt.varQuery??""),ct(qt.seriesQuery??""),Qe(qt.classicQuery??"")}},[he]),(0,je.useEffect)(()=>{if(et!==B.B4.LabelValues)return;const qt=Ce.getVariables().map(cn=>({label:cn,value:cn}));if(!zt)Ce.getTagKeys({filters:[]}).then(cn=>{const En=cn.map(({text:Sn})=>({label:Sn,value:Sn}));Pn(En,qt)});else{const cn=[{label:"__name__",op:"=",value:zt}],En=F.z.renderLabels(cn);Ce.languageProvider.fetchLabelsWithMatch(En).then(Sn=>{const Wn=Object.keys(Sn).map(Nn=>({label:Nn,value:Nn}));Pn(Wn,qt)})}},[Ce,et,zt]);const Kn=(qt,cn)=>{const Tn={...{qryType:et,label:nt,metric:zt,match:xt,varQuery:Vt,seriesQuery:Je,classicQuery:ot,refId:"PrometheusVariableQueryEditor-VariableQuery"},...qt,...cn?{labelFilters:cn}:{labelFilters:fn}},Wn=J(Tn);Re({query:Wn,qryType:Tn.qryType,refId:dt})},Bt=qt=>{rt(qt.value),qt.value!==B.B4.SeriesQuery&&Kn({qryType:qt.value??0})},an=qt=>{const cn=qt&&qt.value?qt.value:"";gt(cn),et===B.B4.LabelValues&&cn&&Kn({label:cn})},tn=qt=>{Nt(qt.metric),Rn(qt.labels);const cn=qt.metric,En=qt.labels??[];et===B.B4.LabelValues&&nt&&(cn||En)&&Kn({qryType:et,metric:cn},En)},Cn=qt=>{et===B.B4.LabelNames&&Kn({qryType:et,match:qt})},xn=qt=>{et===B.B4.MetricNames&&qt&&Kn({metric:qt})},Vn=qt=>{en(qt.currentTarget.value)},Et=qt=>{ct(qt.currentTarget.value)},Ft=qt=>{Qe(qt.currentTarget.value)},Gt=(0,je.useCallback)(()=>({metric:zt,labels:fn,operations:[]}),[zt,fn]),ln=Ye()(qt=>{const cn=At.filter(En=>En.value?.includes(qt));return(0,N.ky)(cn)},300);return(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(Ne.C,{children:(0,E.jsx)(Pe.I,{label:"Query type",labelWidth:20,tooltip:(0,E.jsx)("div",{children:"The Prometheus data source plugin provides the following query types for template variables."}),children:(0,E.jsx)(Ue.l6,{placeholder:"Select query type","aria-label":"Query type",onChange:Bt,value:et,options:qe,width:25,"data-testid":x.Tp.components.DataSource.Prometheus.variableQueryEditor.queryType})})}),et===B.B4.LabelValues&&(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(Ne.C,{children:(0,E.jsx)(Pe.I,{label:"Label",labelWidth:20,required:!0,"aria-labelledby":"label-select",tooltip:(0,E.jsx)("div",{children:"Returns a list of label values for the label name in all metrics unless the metric is specified."}),children:(0,E.jsx)(Ue.DW,{"aria-label":"label-select",onChange:an,value:nt?(0,Ze.z)(nt):null,defaultOptions:pt,width:25,allowCustomValue:!0,isClearable:!0,loadOptions:ln,"data-testid":x.Tp.components.DataSource.Prometheus.variableQueryEditor.labelValues.labelSelect})})}),(0,E.jsx)(ze.I,{query:Gt(),datasource:Ce,onChange:tn,variableEditor:!0})]}),et===B.B4.LabelNames&&(0,E.jsx)(Ne.C,{children:(0,E.jsx)(Pe.I,{label:"Metric regex",labelWidth:20,"aria-labelledby":"Metric regex",tooltip:(0,E.jsx)("div",{children:"Returns a list of label names, optionally filtering by specified metric regex."}),children:(0,E.jsx)(C.p,{type:"text","aria-label":"Metric regex",placeholder:"Metric regex",value:xt,onBlur:qt=>{St(qt.currentTarget.value),Cn(qt.currentTarget.value)},onChange:qt=>{St(qt.currentTarget.value)},width:25,"data-testid":x.Tp.components.DataSource.Prometheus.variableQueryEditor.labelnames.metricRegex})})}),et===B.B4.MetricNames&&(0,E.jsx)(Ne.C,{children:(0,E.jsx)(Pe.I,{label:"Metric regex",labelWidth:20,"aria-labelledby":"Metric selector",tooltip:(0,E.jsx)("div",{children:"Returns a list of metrics matching the specified metric regex."}),children:(0,E.jsx)(C.p,{type:"text","aria-label":"Metric selector",placeholder:"Metric regex",value:zt,onChange:qt=>{Nt(qt.currentTarget.value)},onBlur:qt=>{Nt(qt.currentTarget.value),xn(qt.currentTarget.value)},width:25,"data-testid":x.Tp.components.DataSource.Prometheus.variableQueryEditor.metricNames.metricRegex})})}),et===B.B4.VarQueryResult&&(0,E.jsx)(Ne.C,{children:(0,E.jsx)(Pe.I,{label:"Query",labelWidth:20,tooltip:(0,E.jsx)("div",{children:"Returns a list of Prometheus query results for the query. This can include Prometheus functions, i.e. sum(go_goroutines)."}),children:(0,E.jsx)($e.f,{type:"text","aria-label":"Prometheus Query",placeholder:"Prometheus Query",value:Vt,onChange:Vn,onBlur:()=>{et===B.B4.VarQueryResult&&Vt&&Kn({qryType:et})},cols:100,"data-testid":x.Tp.components.DataSource.Prometheus.variableQueryEditor.varQueryResult})})}),et===B.B4.SeriesQuery&&(0,E.jsx)(Ne.C,{children:(0,E.jsx)(Pe.I,{label:"Series Query",labelWidth:20,tooltip:(0,E.jsx)("div",{children:'Enter a metric with labels, only a metric or only labels, i.e. go_goroutines{instance="localhost:9090"}, go_goroutines, or {instance="localhost:9090"}. Returns a list of time series associated with the entered data.'}),children:(0,E.jsx)(C.p,{type:"text","aria-label":"Series Query",placeholder:"Series Query",value:Je,onChange:Et,onBlur:()=>{et===B.B4.SeriesQuery&&Je&&Kn({qryType:et})},width:100,"data-testid":x.Tp.components.DataSource.Prometheus.variableQueryEditor.seriesQuery})})}),et===B.B4.ClassicQuery&&(0,E.jsx)(Ne.C,{children:(0,E.jsx)(Pe.I,{label:"Classic Query",labelWidth:20,tooltip:(0,E.jsx)("div",{children:"The original implemetation of the Prometheus variable query editor. Enter a string with the correct query type and parameters as described in these docs. For example, label_values(label, metric)."}),children:(0,E.jsx)(C.p,{type:"text","aria-label":"Classic Query",placeholder:"Classic Query",value:ot,onChange:Ft,onBlur:()=>{et===B.B4.ClassicQuery&&ot&&Kn({qryType:et})},width:100,"data-testid":x.Tp.components.DataSource.Prometheus.variableQueryEditor.classicQuery})})})]})};function yt(Re){return typeof Re=="string"?X(Re):Re.query?X(Re.query):Re}class st extends Te.f5{constructor(he,Ce=(0,v.w)()){super(),this.datasource=he,this.templateSrv=Ce,this.editor=vt}query(he){let Ce;if(typeof he.targets[0]=="string"?Ce=he.targets[0]:Ce=he.targets[0].query,!Ce)return(0,De.of)({data:[]});const We={...he.scopedVars,__interval:{text:this.datasource.interval,value:this.datasource.interval},__interval_ms:{text:c.intervalToMs(this.datasource.interval),value:c.intervalToMs(this.datasource.interval)},...this.datasource.getRangeScopedVars(he.range)},et=this.templateSrv.replace(Ce,We,this.datasource.interpolateQueryExpr),rt=new ae(this.datasource,et);return(0,ge.H)(rt.process(he.range)).pipe((0,s.T)(gt=>({data:gt})))}}const Ve="60s",pe=["api/v1/query","api/v1/query_range","api/v1/series","api/v1/labels"],Ee="-Instant";class me extends m.iy{constructor(he,Ce=(0,v.w)(),We){super(he),this.templateSrv=Ce,this.init=async()=>{this.disableRecordingRules||this.loadRules(),this.exemplarsAvailable=await this.areExemplarsAvailable()},this.processAnnotationResponse=(et,rt)=>{const nt=(0,l.bE)({data:rt}).data;if(!nt||!nt.length)return[];const gt=et.annotation,{tagKeys:xt="",titleFormat:St="",textFormat:zt=""}=gt,Nt=c.intervalToSeconds(gt.step||Ve)*1e3,Vt=xt.split(","),en=[];for(const Je of nt){if(Je.fields.length===0)continue;const ct=Je.fields[0],ot=Je.fields[1],Qe=ot?.labels||{},pt=Object.keys(Qe).filter(Rn=>Vt.includes(Rn)).map(Rn=>Qe[Rn]),Pt=[];let At=0;ot.values.forEach(Rn=>{let Kn,Bt;const an=ct.values[At];et.annotation.useValueForTime?(Kn=Math.floor(parseFloat(Rn)),Bt=1):(Kn=Math.floor(parseFloat(an)),Bt=parseFloat(Rn)),At++,Pt.push([Kn,Bt])});const Pn=Pt.filter(Rn=>Rn[1]>0).map(Rn=>Rn[0]);let fn=null;for(const Rn of Pn){if(fn&&(fn.timeEnd??0)+Nt>=Rn){fn.timeEnd=Rn;continue}fn&&en.push(fn),fn={time:Rn,timeEnd:Rn,annotation:gt,title:(0,o.j)(St,Qe),tags:pt,text:(0,o.j)(zt,Qe)}}fn&&(fn.timeEnd=Pn[Pn.length-1],en.push(fn))}return en},this.type="prometheus",this.id=he.id,this.url=he.url,this.access=he.access,this.basicAuth=he.basicAuth,this.withCredentials=!!he.withCredentials,this.interval=he.jsonData.timeInterval||"15s",this.queryTimeout=he.jsonData.queryTimeout,this.httpMethod=he.jsonData.httpMethod||"GET",this.exemplarTraceIdDestinations=he.jsonData.exemplarTraceIdDestinations,this.hasIncrementalQuery=he.jsonData.incrementalQuerying??!1,this.ruleMappings={},this.languageProvider=We??new L.Ay(this),this.lookupsDisabled=he.jsonData.disableMetricsLookup??!1,this.customQueryParameters=new URLSearchParams(he.jsonData.customQueryParameters),this.datasourceConfigurationPrometheusFlavor=he.jsonData.prometheusType,this.datasourceConfigurationPrometheusVersion=he.jsonData.prometheusVersion,this.defaultEditor=he.jsonData.defaultEditor,this.disableRecordingRules=he.jsonData.disableRecordingRules??!1,this.variables=new st(this,this.templateSrv),this.exemplarsAvailable=!0,this.cacheLevel=he.jsonData.cacheLevel??B.fD.Low,this.metricNamesAutocompleteSuggestionLimit=he.jsonData.codeModeMetricNamesSuggestionLimit??L.OP,this.cache=new ce.$i({getTargetSignature:this.getPrometheusTargetSignature.bind(this),overlapString:he.jsonData.incrementalQueryOverlapWindow??ce.Dr}),this.annotations={QueryEditor:A}}getQueryDisplayText(he){return he.expr}getPrometheusTargetSignature(he,Ce){return`${this.interpolateString(Ce.expr)}|${Ce.interval??he.interval}|${JSON.stringify(he.rangeRaw??"")}|${Ce.exemplar}`}hasLabelsMatchAPISupport(){return this._isDatasourceVersionGreaterOrEqualTo("2.24.0",B.N1.Prometheus)||this._isDatasourceVersionGreaterOrEqualTo("2.0.0",B.N1.Mimir)||this._isDatasourceVersionGreaterOrEqualTo("1.11.0",B.N1.Cortex)||this._isDatasourceVersionGreaterOrEqualTo("0.18.0",B.N1.Thanos)}_isDatasourceVersionGreaterOrEqualTo(he,Ce){return!this.datasourceConfigurationPrometheusVersion||!this.datasourceConfigurationPrometheusFlavor?!0:Ce!==this.datasourceConfigurationPrometheusFlavor?!1:a().gte(this.datasourceConfigurationPrometheusVersion,he)}_addTracingHeaders(he,Ce){he.headers={},this.access==="proxy"&&(he.headers["X-Dashboard-UID"]=Ce.dashboardUID,he.headers["X-Panel-Id"]=Ce.panelId)}directAccessError(){return(0,n.$)(()=>new Error("Browser access mode in the Prometheus datasource is no longer available. Switch to server access mode."))}_request(he,Ce,We={}){if(this.access==="direct")return this.directAccessError();Ce=Ce||{};for(const[nt,gt]of this.customQueryParameters)Ce[nt]==null&&(Ce[nt]=gt);let et=this.url+he;he.startsWith(`/api/datasources/uid/${this.uid}`)&&(et=he);const rt=(0,t.defaults)(We,{url:et,method:this.httpMethod,headers:{}});return rt.method==="GET"?Ce&&Object.keys(Ce).length&&(rt.url=rt.url+(rt.url.search(/\?/)>=0?"&":"?")+Object.entries(Ce).map(([nt,gt])=>`${encodeURIComponent(nt)}=${encodeURIComponent(gt)}`).join("&")):(rt.headers["Content-Type"]="application/x-www-form-urlencoded",rt.data=Ce),(this.basicAuth||this.withCredentials)&&(rt.withCredentials=!0),this.basicAuth&&(rt.headers.Authorization=this.basicAuth),(0,y.AI)().fetch(rt)}async importFromAbstractQueries(he){return he.map(Ce=>this.languageProvider.importFromAbstractQuery(Ce))}async exportToAbstractQueries(he){return he.map(Ce=>this.languageProvider.exportToAbstractQuery(Ce))}async metadataRequest(he,Ce={},We){if(pe.some(et=>he.includes(et)))try{return await(0,i.s)(this._request(`/api/datasources/uid/${this.uid}/resources${he}`,Ce,{method:this.httpMethod,hideFromInspector:!0,showErrorAlert:!1,...We}))}catch(et){if(this.httpMethod==="POST"&&(0,y.NF)(et)&&(et.status===405||et.status===400))console.warn("Couldn't use configured POST HTTP method for this request. Trying to use GET method instead.");else throw et}return await(0,i.s)(this._request(`/api/datasources/uid/${this.uid}/resources${he}`,Ce,{method:"GET",hideFromInspector:!0,...We}))}interpolateQueryExpr(he=[],Ce){if(!Ce.multi&&!Ce.includeAll)return Ie(he);if(typeof he=="string")return Oe(he);const We=he.map(et=>Oe(et));return We.length===1?We[0]:"("+We.join("|")+")"}targetContainsTemplate(he){return this.templateSrv.containsTemplate(he.expr)}shouldRunExemplarQuery(he,Ce){if(he.exemplar){const We=this.languageProvider.histogramMetrics.find(nt=>he.expr.includes(nt)),et=Ce.targets.findIndex(nt=>nt.refId===he.refId),rt=Ce.targets.slice(0,et).filter(nt=>!nt.hide);return!!(!We||We&&!rt.some(nt=>nt.expr.includes(We)))}return!1}processTargetV2(he,Ce){const We=[],et={...he,exemplar:this.shouldRunExemplarQuery(he,Ce),requestId:Ce.panelId+he.refId,utcOffsetSec:Ce.range.to.utcOffset()*60};return u.$.featureToggles.promQLScope&&(et.scopes=(Ce.scopes??[]).map(rt=>({name:rt.metadata.name,...rt.spec}))),u.$.featureToggles.groupByVariable&&(et.groupByKeys=Ce.groupByKeys),he.instant&&he.range?We.push({...et,refId:et.refId,instant:!1},{...et,refId:et.refId+Ee,range:!1}):We.push(et),We}query(he){if(this.access==="direct")return this.directAccessError();let Ce,We;const et=he.targets.some(gt=>gt.instant);this.hasIncrementalQuery&&!et?(We=this.cache.requestInfo(he),Ce=We.requests[0]):Ce=he;const rt=Ce.targets.map(gt=>this.processTargetV2(gt,Ce)),nt=new Date;return super.query({...Ce,targets:rt.flat()}).pipe((0,s.T)(gt=>{const xt={...gt,data:this.cache.procFrames(he,We,gt.data)};return(0,ye.J3)(xt,he,{exemplarTraceIdDestinations:this.exemplarTraceIdDestinations})}),(0,r.M)(gt=>{ue(gt,he,nt)}))}metricFindQuery(he,Ce){if(!he)return Promise.resolve([]);const We={__interval:{text:this.interval,value:this.interval},__interval_ms:{text:c.intervalToMs(this.interval),value:c.intervalToMs(this.interval)},...this.getRangeScopedVars(Ce?.range??(0,h.E2)())},et=this.templateSrv.replace(he,We,this.interpolateQueryExpr);return new ae(this,et).process(Ce?.range??(0,h.E2)())}getRangeScopedVars(he){const Ce=he.to.diff(he.from),We=Math.round(Ce/1e3);return{__range_ms:{text:Ce,value:Ce},__range_s:{text:We,value:We},__range:{text:We+"s",value:We+"s"}}}async annotationQuery(he){if(this.access==="direct"){const nt=new Error("Browser access mode in the Prometheus datasource is no longer available. Switch to server access mode.");return Promise.reject(nt)}const Ce=he.annotation,{expr:We=""}=Ce;if(!We)return Promise.resolve([]);const et=he.annotation.step||Ve,rt={expr:We,range:!0,instant:!1,exemplar:!1,interval:et,refId:"X",datasource:this.getRef()};return await(0,i.s)((0,y.AI)().fetch({url:"/api/ds/query",method:"POST",headers:this.getRequestHeaders(),data:{from:((0,N.mv)(he.range.from,!1)*1e3).toString(),to:((0,N.mv)(he.range.to,!0)*1e3).toString(),queries:[this.applyTemplateVariables(rt,{})]},requestId:`prom-query-${Ce.name}`}).pipe((0,s.T)(nt=>this.processAnnotationResponse(he,nt.data))))}async getTagKeys(he){if(!he||he.filters.length===0)return await this.languageProvider.fetchLabels(he.timeRange,he.queries),this.languageProvider.getLabelKeys().map(rt=>({value:rt,text:rt}));const Ce=he.filters.map(rt=>({label:rt.key,value:rt.value,op:rt.operator})),We=F.z.renderLabels(Ce);let et=await this.languageProvider.fetchLabelsWithMatch(We);return Object.keys(et).filter(rt=>!he.filters.find(nt=>nt.key===rt)).map(rt=>({value:rt,text:rt}))}async getTagValues(he){const Ce=he.filters.map(nt=>({label:nt.key,value:nt.value,op:nt.operator})),We=F.z.renderLabels(Ce);if(this.hasLabelsMatchAPISupport()){const nt=`[${this.uid}][${he.key}]`;return(await this.languageProvider.fetchSeriesValuesWithMatch(he.key,We,nt,he.timeRange)).map(gt=>({value:gt,text:gt}))}const et=this.getTimeRangeParams(he.timeRange??(0,h.E2)());return(await this.metadataRequest(`/api/v1/label/${he.key}/values`,et))?.data?.data?.map(nt=>({text:nt}))??[]}interpolateVariablesInQueries(he,Ce,We){let et=he;return he&&he.length&&(et=he.map(rt=>{const nt=this.templateSrv.replace(rt.expr,Ce,this.interpolateQueryExpr),gt=u.$.featureToggles.promQLScope?nt:this.templateSrv.replace(this.enhanceExprWithAdHocFilters(We,nt),Ce,this.interpolateQueryExpr);return{...rt,...u.$.featureToggles.promQLScope?{adhocFilters:this.generateScopeFilters(We)}:{},datasource:this.getRef(),expr:gt,interval:this.templateSrv.replace(rt.interval,Ce)}})),et}getQueryHints(he,Ce){return ne(he.expr??"",Ce,this)}getInitHints(){return le(this)}async loadRules(){try{const Ce=(await this.metadataRequest("/api/v1/rules",{},{showErrorAlert:!1})).data?.data?.groups;Ce&&(this.ruleMappings=Se(Ce))}catch(he){console.log("Rules API is experimental. Ignore next error."),console.error(he)}}async areExemplarsAvailable(){try{return(await this.metadataRequest("/api/v1/query_exemplars",{query:"test",start:(0,f.KQ)().subtract(30,"minutes").valueOf().toString(),end:(0,f.KQ)().valueOf().toString()},{showErrorAlert:!1})).data.status==="success"}catch{return!1}}modifyQuery(he,Ce){let We=he.expr??"";switch(Ce.type){case"ADD_FILTER":{const{key:et,value:rt}=Ce.options??{};et&&rt&&(We=(0,D.t)(We,et,rt));break}case"ADD_FILTER_OUT":{const{key:et,value:rt}=Ce.options??{};et&&rt&&(We=(0,D.t)(We,et,rt,"!="));break}case"ADD_HISTOGRAM_QUANTILE":{We=`histogram_quantile(0.95, sum(rate(${We}[$__rate_interval])) by (le))`;break}case"ADD_HISTOGRAM_AVG":{We=`histogram_avg(rate(${We}[$__rate_interval]))`;break}case"ADD_HISTOGRAM_FRACTION":{We=`histogram_fraction(0,0.2,rate(${We}[$__rate_interval]))`;break}case"ADD_HISTOGRAM_COUNT":{We=`histogram_count(rate(${We}[$__rate_interval]))`;break}case"ADD_HISTOGRAM_SUM":{We=`histogram_sum(rate(${We}[$__rate_interval]))`;break}case"ADD_HISTOGRAM_STDDEV":{We=`histogram_stddev(rate(${We}[$__rate_interval]))`;break}case"ADD_HISTOGRAM_STDVAR":{We=`histogram_stdvar(rate(${We}[$__rate_interval]))`;break}case"ADD_RATE":{We=`rate(${We}[$__rate_interval])`;break}case"ADD_SUM":{We=`sum(${We.trim()}) by ($1)`;break}case"EXPAND_RULES":{Ce.options&&(We=(0,N.P_)(We,Ce.options));break}default:break}return{...he,expr:We}}getAdjustedInterval(he){return(0,N.Xd)(this.cacheLevel,he)}getTimeRangeParams(he){return{start:(0,N.mv)(he.from,!1).toString(),end:(0,N.mv)(he.to,!0).toString()}}getOriginalMetricName(he){return(0,ye.hF)(he)}generateScopeFilters(he){return he?he.map(Ce=>({...Ce,value:this.templateSrv.replace(Ce.value,{},this.interpolateQueryExpr),operator:d.n[Ce.operator]})):[]}enhanceExprWithAdHocFilters(he,Ce){return!he||he.length===0?Ce:he.reduce((et,rt)=>{const{key:nt,operator:gt}=rt;let{value:xt}=rt;return(gt==="=~"||gt==="!~")&&(xt=Ie(xt)),(0,D.t)(et,nt,xt,gt)},Ce)}filterQuery(he){return!(he.hide||!he.expr)}applyTemplateVariables(he,Ce,We){const et={...Ce};et.__interval={value:"$__interval"},et.__interval_ms={value:"$__interval_ms"};const rt=this.templateSrv.replace(he.expr,et,this.interpolateQueryExpr),nt=u.$.featureToggles.promQLScope?rt:this.templateSrv.replace(this.enhanceExprWithAdHocFilters(We,rt),et,this.interpolateQueryExpr);return{...he,...u.$.featureToggles.promQLScope?{adhocFilters:this.generateScopeFilters(We)}:{},expr:nt,interval:this.templateSrv.replace(he.interval,et),legendFormat:this.templateSrv.replace(he.legendFormat,et)}}getVariables(){return this.templateSrv.getVariables().map(he=>`$${he.name}`)}interpolateString(he,Ce){return this.templateSrv.replace(he,Ce,this.interpolateQueryExpr)}getDebounceTimeInMilliseconds(){switch(this.cacheLevel){case B.fD.Medium:return 600;case B.fD.High:return 1200;default:return 350}}getDaysToCacheMetadata(){switch(this.cacheLevel){case B.fD.Medium:return 7;case B.fD.High:return 30;default:return 1}}getCacheDurationInMinutes(){return(0,N.u3)(this.cacheLevel)}getDefaultQuery(he){const Ce={refId:"A",expr:"",range:!0,instant:!1};return he===p.Jk.UnifiedAlerting?{...Ce,instant:!0,range:!1}:he===p.Jk.Explore?{...Ce,instant:!0,range:!0}:Ce}}function ve(Re,he,Ce,We){const et=Math.floor((he+We)/Ce)*Ce-We,rt=Math.floor((Re+We)/Ce)*Ce-We;return{end:et,start:rt}}function Se(Re){return Re.reduce((he,Ce)=>Ce.rules.filter(We=>We.type==="recording").reduce((We,et)=>{const rt=We[et.name]??[];return rt.push({query:et.query,labels:et.labels}),We[et.name]=rt,We},he),{})}function Ie(Re){return typeof Re=="string"?Re.replace(/\\/g,"\\\\").replace(/'/g,"\\\\'"):Re}function Oe(Re){return typeof Re=="string"?Re.replace(/\\/g,"\\\\\\\\").replace(/[$^*{}\[\]\'+?.()|]/g,"\\\\$&"):Re}},50556:(k,R,e)=>{"use strict";e.d(R,{AU:()=>D,Ay:()=>P,OP:()=>v,pK:()=>u,xB:()=>y});var t=e(2543),n=e.n(t),i=e(28848),s=e.n(i),r=e(40187),g=e(43127),a=e(73372),c=e(91396),o=e(81996),h=e(20719),f=e(76040),d=e(62183);const p=["job","instance"],m="{}",v=1e4,l=O=>({headers:{"X-Grafana-Cache":`private, max-age=${O}`}});function y(O,I){if(!I[O])return;const{type:T,help:C}=I[O];return`${T.toUpperCase()}: ${C}`}function u(O,I){if(I[O])return I[O].help}function D(O,I){if(I[O])return I[O].type}const E=/(="|!="|=~"|!~"|\{|\[|\(|\+|-|\/|\*|%|\^|\band\b|\bor\b|\bunless\b|==|>=|!=|<=|>|<|=|~|,)/,x=86400;class P extends r.Is{constructor(I,T){super(),this.labelKeys=[],this.request=async(C,S,A={},L)=>{try{return(await this.datasource.metadataRequest(C,A,L)).data.data}catch(N){M(N)||console.error(N)}return S},this.start=async C=>(this.timeRange=C??(0,g.E2)(),this.datasource.lookupsDisabled?[]:(this.metrics=await this.fetchLabelValues("__name__")||[],this.histogramMetrics=(0,o.Rg)(this.metrics).sort(),Promise.all([this.loadMetricsMetadata(),this.fetchLabels()]))),this.fetchLabelValues=async C=>{const S=this.datasource.getAdjustedInterval(this.timeRange),L=`/api/v1/label/${this.datasource.interpolateString(C)}/values`;return await this.request(L,[],S,this.getDefaultCacheHeaders())??[]},this.fetchLabels=async(C,S)=>{C&&(this.timeRange=C);let A="/api/v1/labels";const L=this.datasource.getAdjustedInterval(this.timeRange);this.labelFetchTs=Date.now().valueOf();const N=new URLSearchParams({...L});S?.forEach(w=>{const B=(0,f.u)(w.expr);B.query.metric!==""&&(N.append("match[]",B.query.metric),B.query.binaryQueries&&B.query.binaryQueries.forEach(U=>{N.append("match[]",U.query.metric)}))}),this.datasource.httpMethod==="GET"&&(A+=`?${N.toString()}`);const F=await this.request(A,[],N,this.getDefaultCacheHeaders());return Array.isArray(F)&&(this.labelKeys=F.slice().sort()),[]},this.getSeriesValues=async(C,S)=>this.datasource.hasLabelsMatchAPISupport()?await this.fetchSeriesValuesWithMatch(C,S):(await this.getSeries(S))[C]??[],this.fetchSeriesValuesWithMatch=async(C,S,A,L=this.timeRange)=>{const N=C?this.datasource.interpolateString(C):null,F=S?this.datasource.interpolateString(S):null,B={...this.datasource.getAdjustedInterval(L),...F&&{"match[]":F}};let U={...this.getDefaultCacheHeaders(),...A&&{requestId:A}};return Object.keys(U).length||(U=void 0),await this.request(`/api/v1/label/${N}/values`,[],B,U)??[]},this.getSeriesLabels=async(C,S)=>{let A,L;this.datasource.hasLabelsMatchAPISupport()?(S.push({name:"__name__",value:"",op:"!="}),L=await this.fetchSeriesLabelsMatch(C),A=Object.keys(L)):(L=await this.getSeries(C),A=Object.keys(L));const N=new Set(S.map(F=>F.name));return A.filter(F=>!N.has(F))},this.fetchLabelsWithMatch=async(C,S)=>this.datasource.hasLabelsMatchAPISupport()?this.fetchSeriesLabelsMatch(C,S):this.fetchSeriesLabels(C,S,c.bS),this.fetchSeriesLabels=async(C,S,A)=>{const L=this.datasource.interpolateString(C);let F={...this.datasource.getAdjustedInterval(this.timeRange),"match[]":L};A!=="none"&&(F={...F,limit:A??c._N});const B=await this.request("/api/v1/series",[],F,this.getDefaultCacheHeaders()),{values:U}=(0,o.P7)(B,S);return U},this.fetchSeriesLabelsMatch=async(C,S)=>{const A=this.datasource.interpolateString(C),N={...this.datasource.getAdjustedInterval(this.timeRange),"match[]":A};return(await this.request("/api/v1/labels",[],N,this.getDefaultCacheHeaders())).reduce((B,U)=>({...B,[U]:""}),{})},this.fetchSeries=async C=>{const S="/api/v1/series",L={...this.datasource.getTimeRangeParams(this.timeRange),"match[]":C};return await this.request(S,{},L,this.getDefaultCacheHeaders())},this.fetchDefaultSeries=(0,t.once)(async()=>{const C=await Promise.all(p.map(S=>this.fetchLabelValues(S)));return p.reduce((S,A,L)=>({...S,[A]:C[L]}),{})}),this.datasource=I,this.histogramMetrics=[],this.timeRange=(0,g.E2)(),this.metrics=[],Object.assign(this,T)}getDefaultCacheHeaders(){if(this.datasource.cacheLevel!==d.fD.None)return l(this.datasource.getCacheDurationInMinutes()*60)}cleanText(I){return I.split(E).pop().trimLeft().replace(/"$/,"").replace(/^"/,"")}get syntax(){return h.Ay}async loadMetricsMetadata(){const I=l(this.datasource.getDaysToCacheMetadata()*x);this.metricsMetadata=(0,o.DX)(await this.request("/api/v1/metadata",{},{},{showErrorAlert:!1,...I}))}getLabelKeys(){return this.labelKeys}importFromAbstractQuery(I){return(0,o.pt)(I)}exportToAbstractQuery(I){const T=I.expr;if(!T||T.length===0)return{refId:I.refId,labelMatchers:[]};const C=s().tokenize(T,h.Ay),S=(0,o.VH)(C),A=b(T,C);return A&&A.length>0&&S.push({name:"__name__",operator:a.D_.Equal,value:A}),{refId:I.refId,labelMatchers:S}}async getSeries(I,T){if(this.datasource.lookupsDisabled)return{};try{return I===m?await this.fetchDefaultSeries():await this.fetchSeriesLabels(I,T,c.bS)}catch(C){return console.error(C),{}}}async getLabelValues(I){return await this.fetchLabelValues(I)}}function b(O,I){let T="";for(const C of I)if(typeof C=="string"){T=C;break}return T}function M(O){return typeof O=="object"&&O!==null&&"cancelled"in O&&O.cancelled===!0}},81996:(k,R,e)=>{"use strict";e.d(R,{Cs:()=>C,DX:()=>D,P7:()=>p,P_:()=>y,Qn:()=>T,Rg:()=>d,VH:()=>w,Xd:()=>B,eN:()=>E,ky:()=>V,mv:()=>K,pt:()=>N,u3:()=>U});var t=e(2543),n=e.n(t),i=e(28848),s=e.n(i),r=e(73372),g=e(77678),a=e(85858),c=e(80937),o=e(50556),h=e(9103),f=e(62183);const d=H=>{const Y=new Set,X=new RegExp("_bucket($|:)");for(let J=0;J<H.length;J++){const q=H[J];X.test(q)&&Y.add(q)}return[...Y]};function p(H,Y=!1){const X={};H.forEach(q=>{const{__name__:ae,...j}=q;Y&&(X.__name__=X.__name__||new Set,X.__name__.has(ae)||X.__name__.add(ae)),Object.keys(j).forEach(te=>{X[te]||(X[te]=new Set),X[te].has(j[te])||X[te].add(j[te])})});const J={};return b(Object.keys(X)).forEach(q=>{J[q]=b(Array.from(X[q]))}),{values:J,keys:Object.keys(J)}}const m=/\{[^}]*?(\}|$)/,v=/\b(\w+)(!?=~?)("[^"\n]*?")(,)?(\s*)?/g;function l(H,Y=1){if(!H.match(m)){if(H.match(/^[A-Za-z:][\w:]*$/))return{selector:`{__name__="${H}"}`,labelKeys:["__name__"]};throw new Error("Query must contain a selector: "+H)}const X=H.slice(0,Y),J=X.lastIndexOf("{"),q=X.lastIndexOf("}");if(J===-1)throw new Error("Not inside selector, missing open brace: "+X);if(q>-1&&q>J)throw new Error("Not inside selector, previous selector already closed: "+X);const ae=H.slice(Y),te=ae.indexOf("}")+Y,ne=ae.indexOf("{"),le=ne+Y;if(te===-1)throw new Error("Not inside selector, missing closing brace in suffix: "+ae);if(ne>-1&&le<te)throw new Error("Not inside selector, next selector opens before this one closed: "+ae);const z=H.slice(J,te),ee={};z.replace(v,(ye,re,ue,De)=>{const ge=H.indexOf(ye),Te=ge+re.length+ue.length+1,Le=ge+re.length+ue.length+De.length-1;return(Y<Te||Y>Le)&&(ee[re]={value:De,operator:ue}),""});const ie=H.slice(0,J).match(/[A-Za-z:][\w:]*$/);ie&&(ee.__name__={value:`"${ie[0]}"`,operator:"="});const Z=Object.keys(ee).sort(),ce=["{",Z.map(ye=>`${ye}${ee[ye].operator}${ee[ye].value}`).join(","),"}"].join("");return{labelKeys:Z,selector:ce}}function y(H,Y){const X=j=>new RegExp(`(\\s|\\(|^)(${j})(\\s|$|\\(|\\[|\\{)`,"ig"),J=Object.keys(Y).reduce((j,te)=>{let ne=[],le=[],z=[];return j.filter(Boolean).forEach((ee,se)=>{ee.match(X(te))&&(ne=ee.split(te),ne.length===2?(z.push(se),le.push(...[ne[0],te,ne[1]].filter(Boolean))):ne.length>2&&(z.push(se),ne=ne.map(Z=>Z===""?te:Z),le.push(...ne)))}),z.forEach(ee=>j[ee]=""),j=j.filter(Boolean),j.push(...le),j},[H]);let q=!1;return J.map((j,te)=>{if(q)return q=!1,"";if(Y[j]){const{expandedQuery:ne,identifierValue:le,identifier:z}=Y[j];if(te+1!==J.length&&J[te+1].match(v)){q=!0;const ee=new RegExp(`(,)?(\\s)?(${z}=\\"${le}\\")(,)?(\\s)?`,"g"),se=J[te+1].replace(ee,""),ie=/(\)\{|\}\{|\]\{)/;return u(ne+se,ie)}else return ne}return j}).filter(Boolean).join("")}function u(H,Y){const X=H.match(Y);if(!X)return H;const J=X.index??0,q=H.slice(0,J+1),ae=H.slice(J+1),j=[];ae.replace(v,(z,ee,se,ie,Z,oe)=>(j.push({key:ee,operator:se,value:ie,comma:Z,space:oe}),""));let te=q;j.filter(Boolean).forEach(z=>{const ee=z.value.slice(1,-1);te=(0,c.t)(te,z.key,ee,z.operator)});let ne=j.reduce((z,ee)=>(z+=`${ee.key}${ee.operator}${ee.value}${ee.comma??""}${ee.space??""}`,z),"");ne="{"+ne+"}";const le=ae.replace(ne,"");return te+le}function D(H){if(!H)return H;const Y={},X={};for(const q in H){const ae=H[q][0];Y[q]=ae,ae.type==="histogram"&&(X[`${q}_bucket`]={type:"counter",help:`Cumulative counters for the observation buckets (${ae.help})`},X[`${q}_count`]={type:"counter",help:`Count of events that have been observed for the histogram metric (${ae.help})`},X[`${q}_sum`]={type:"counter",help:`Total sum of all observed values for the histogram metric (${ae.help})`}),ae.type==="summary"&&(X[`${q}_count`]={type:"counter",help:`Count of events that have been observed for the base metric (${ae.help})`},X[`${q}_sum`]={type:"counter",help:`Total sum of all observed values for the base metric (${ae.help})`})}const J={};return J.ALERTS={type:"counter",help:"Time series showing pending and firing alerts. The sample value is set to 1 as long as the alert is in the indicated active (pending or firing) state."},{...Y,...X,...J}}function E(H){return x(H/1e3)}function x(H){return Math.floor(H/60)}function P(H,Y=1){return Math.ceil(H/60)-Math.ceil(H/60)%Y}function b(H){return H.slice(0,o.OP)}function M(H){return H&&H.length>=SUGGESTIONS_LIMIT?`, limited to the first ${SUGGESTIONS_LIMIT} received items`:""}const O=/[*+?()|\\.\[\]{}^$]/g;function I(H){return H.replace(O,"\\$&")}function T(H){return H.replace(/\\/g,"\\\\").replace(/\n/g,"\\n").replace(/"/g,'\\"')}function C(H){return T(I(H))}const S={"=":r.D_.Equal,"!=":r.D_.NotEqual,"=~":r.D_.EqualRegEx,"!~":r.D_.NotEqualRegEx},A=(0,t.invert)(S);function L(H){const Y=H.labelMatchers.map(X=>{const J=A[X.operator];return J?`${X.name}${J}"${X.value}"`:""}).filter(X=>X!=="").join(", ");return Y?`{${Y}}`:""}function N(H){return{refId:H.refId,expr:L(H),range:!0}}function F(H){return typeof H.content=="string"?H.content:""}function w(H){const Y=[];for(const X of H)if(X instanceof i.Token&&X.type==="context-labels"){let J="",q="",ae="";const j=Array.isArray(X.content)?X.content:[X.content];for(let te of j)if(typeof te=="string"){let ne;ne=te,(ne==="="||ne==="!="||ne==="=~"||ne==="!~")&&(ae=ne)}else if(te instanceof i.Token)switch(te.type){case"label-key":J=F(te);break;case"label-value":q=F(te),q=q.substring(1,q.length-1);const ne=S[ae];ne&&Y.push({name:J,operator:ne,value:q});break}}return Y}function B(H,Y){if(H===f.fD.None)return{start:K(Y.from,!1).toString(),end:K(Y.to,!0).toString()};const X=K(Y.from,!1),J=(0,g.rs)(X,U(H)*60),q=K(Y.to,!0),ae=P(q,U(H))*60;if(J===ae){const ne=ae+U(H)*60;return{start:J.toString(),end:ne.toString()}}const j=J.toString(),te=ae.toString();return{start:j,end:te}}function U(H){switch(H){case f.fD.Medium:return 10;case f.fD.High:return 60;default:return 1}}function K(H,Y){return typeof H=="string"&&(H=a.parse(H,Y)),Math.ceil(H.valueOf()/1e3)}function V(H,Y){return Y===void 0&&(Y=h.o6),H.length=Math.min(H.length,Y),H}},20719:(k,R,e)=>{"use strict";e.d(R,{AW:()=>g,Ay:()=>o,n6:()=>c});const t=[{label:"$__interval",sortValue:"$__interval"},{label:"$__rate_interval",sortValue:"$__rate_interval"},{label:"$__range",sortValue:"$__range"},{label:"1m",sortValue:"00:01:00"},{label:"5m",sortValue:"00:05:00"},{label:"10m",sortValue:"00:10:00"},{label:"30m",sortValue:"00:30:00"},{label:"1h",sortValue:"01:00:00"},{label:"1d",sortValue:"24:00:00"}],n=["by","group_left","group_right","ignoring","on","offset","without"],i=null,s=[{label:"acos",insertText:"acos",detail:"acos(v instant-vector)",documentation:"calculates the arccosine of all elements in v"},{label:"acosh",insertText:"acosh",detail:"acosh(v instant-vector)",documentation:"calculates the inverse hyperbolic cosine of all elements in v"},{label:"asin",insertText:"asin",detail:"asin(v instant-vector)",documentation:"calculates the arcsine of all elements in v"},{label:"asinh",insertText:"asinh",detail:"asinh(v instant-vector)",documentation:"calculates the inverse hyperbolic sine of all elements in v"},{label:"atan",insertText:"atan",detail:"atan(v instant-vector)",documentation:"calculates the arctangent of all elements in v"},{label:"atanh",insertText:"atanh",detail:"atanh(v instant-vector)",documentation:"calculates the inverse hyperbolic tangent of all elements in v"},{label:"cos",insertText:"cos",detail:"cos(v instant-vector)",documentation:"calculates the cosine of all elements in v"},{label:"cosh",insertText:"cosh",detail:"cosh(v instant-vector)",documentation:"calculates the hyperbolic cosine of all elements in v"},{label:"sin",insertText:"sin",detail:"sin(v instant-vector)",documentation:"calculates the sine of all elements in v"},{label:"sinh",insertText:"sinh",detail:"sinh(v instant-vector)",documentation:"calculates the hyperbolic sine of all elements in v"},{label:"tan",insertText:"tan",detail:"tan(v instant-vector)",documentation:"calculates the tangent of all elements in v"},{label:"tanh",insertText:"tanh",detail:"tanh(v instant-vector)",documentation:"calculates the hyperbolic tangent of all elements in v"}],g=[...[{label:"sum",insertText:"sum",documentation:"Calculate sum over dimensions"},{label:"min",insertText:"min",documentation:"Select minimum over dimensions"},{label:"max",insertText:"max",documentation:"Select maximum over dimensions"},{label:"avg",insertText:"avg",documentation:"Calculate the average over dimensions"},{label:"group",insertText:"group",documentation:"All values in the resulting vector are 1"},{label:"stddev",insertText:"stddev",documentation:"Calculate population standard deviation over dimensions"},{label:"stdvar",insertText:"stdvar",documentation:"Calculate population standard variance over dimensions"},{label:"count",insertText:"count",documentation:"Count number of elements in the vector"},{label:"count_values",insertText:"count_values",documentation:"Count number of elements with the same value"},{label:"bottomk",insertText:"bottomk",documentation:"Smallest k elements by sample value"},{label:"topk",insertText:"topk",documentation:"Largest k elements by sample value"},{label:"quantile",insertText:"quantile",documentation:"Calculate \u03C6-quantile (0 \u2264 \u03C6 \u2264 1) over dimensions"}],...s,{insertText:"abs",label:"abs",detail:"abs(v instant-vector)",documentation:"Returns the input vector with all sample values converted to their absolute value."},{insertText:"absent",label:"absent",detail:"absent(v instant-vector)",documentation:"Returns an empty vector if the vector passed to it has any elements and a 1-element vector with the value 1 if the vector passed to it has no elements. This is useful for alerting on when no time series exist for a given metric name and label combination."},{insertText:"absent_over_time",label:"absent_over_time",detail:"absent(v range-vector)",documentation:"Returns an empty vector if the range vector passed to it has any elements and a 1-element vector with the value 1 if the range vector passed to it has no elements."},{insertText:"ceil",label:"ceil",detail:"ceil(v instant-vector)",documentation:"Rounds the sample values of all elements in `v` up to the nearest integer."},{insertText:"changes",label:"changes",detail:"changes(v range-vector)",documentation:"For each input time series, `changes(v range-vector)` returns the number of times its value has changed within the provided time range as an instant vector."},{insertText:"clamp",label:"clamp",detail:"clamp(v instant-vector, min scalar, max scalar)",documentation:"Clamps the sample values of all elements in `v` to have a lower limit of `min` and an upper limit of `max`."},{insertText:"clamp_max",label:"clamp_max",detail:"clamp_max(v instant-vector, max scalar)",documentation:"Clamps the sample values of all elements in `v` to have an upper limit of `max`."},{insertText:"clamp_min",label:"clamp_min",detail:"clamp_min(v instant-vector, min scalar)",documentation:"Clamps the sample values of all elements in `v` to have a lower limit of `min`."},{insertText:"count_scalar",label:"count_scalar",detail:"count_scalar(v instant-vector)",documentation:"Returns the number of elements in a time series vector as a scalar. This is in contrast to the `count()` aggregation operator, which always returns a vector (an empty one if the input vector is empty) and allows grouping by labels via a `by` clause."},{insertText:"deg",label:"deg",detail:"deg(v instant-vector)",documentation:"Converts radians to degrees for all elements in v"},{insertText:"day_of_month",label:"day_of_month",detail:"day_of_month(v=vector(time()) instant-vector)",documentation:"Returns the day of the month for each of the given times in UTC. Returned values are from 1 to 31."},{insertText:"day_of_week",label:"day_of_week",detail:"day_of_week(v=vector(time()) instant-vector)",documentation:"Returns the day of the week for each of the given times in UTC. Returned values are from 0 to 6, where 0 means Sunday etc."},{insertText:"day_of_year",label:"day_of_year",detail:"day_of_year(v=vector(time()) instant-vector)",documentation:"Returns the day of the year for each of the given times in UTC. Returned values are from 1 to 365 for non-leap years, and 1 to 366 in leap years."},{insertText:"days_in_month",label:"days_in_month",detail:"days_in_month(v=vector(time()) instant-vector)",documentation:"Returns number of days in the month for each of the given times in UTC. Returned values are from 28 to 31."},{insertText:"delta",label:"delta",detail:"delta(v range-vector)",documentation:"Calculates the difference between the first and last value of each time series element in a range vector `v`, returning an instant vector with the given deltas and equivalent labels. The delta is extrapolated to cover the full time range as specified in the range vector selector, so that it is possible to get a non-integer result even if the sample values are all integers."},{insertText:"deriv",label:"deriv",detail:"deriv(v range-vector)",documentation:"Calculates the per-second derivative of the time series in a range vector `v`, using simple linear regression."},{insertText:"drop_common_labels",label:"drop_common_labels",detail:"drop_common_labels(instant-vector)",documentation:"Drops all labels that have the same name and value across all series in the input vector."},{insertText:"exp",label:"exp",detail:"exp(v instant-vector)",documentation:"Calculates the exponential function for all elements in `v`.\nSpecial cases are:\n* `Exp(+Inf) = +Inf` \n* `Exp(NaN) = NaN`"},{insertText:"floor",label:"floor",detail:"floor(v instant-vector)",documentation:"Rounds the sample values of all elements in `v` down to the nearest integer."},{insertText:"histogram_quantile",label:"histogram_quantile",detail:"histogram_quantile(\u03C6 float, b instant-vector)",documentation:"Calculates the \u03C6-quantile (0 \u2264 \u03C6 \u2264 1) from the buckets `b` of a histogram. The samples in `b` are the counts of observations in each bucket. Each sample must have a label `le` where the label value denotes the inclusive upper bound of the bucket. (Samples without such a label are silently ignored.) The histogram metric type automatically provides time series with the `_bucket` suffix and the appropriate labels."},{insertText:"holt_winters",label:"holt_winters",detail:"holt_winters(v range-vector, sf scalar, tf scalar)",documentation:"Produces a smoothed value for time series based on the range in `v`. The lower the smoothing factor `sf`, the more importance is given to old data. The higher the trend factor `tf`, the more trends in the data is considered. Both `sf` and `tf` must be between 0 and 1."},{insertText:"hour",label:"hour",detail:"hour(v=vector(time()) instant-vector)",documentation:"Returns the hour of the day for each of the given times in UTC. Returned values are from 0 to 23."},{insertText:"idelta",label:"idelta",detail:"idelta(v range-vector)",documentation:"Calculates the difference between the last two samples in the range vector `v`, returning an instant vector with the given deltas and equivalent labels."},{insertText:"increase",label:"increase",detail:"increase(v range-vector)",documentation:"Calculates the increase in the time series in the range vector. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for. The increase is extrapolated to cover the full time range as specified in the range vector selector, so that it is possible to get a non-integer result even if a counter increases only by integer increments."},{insertText:"irate",label:"irate",detail:"irate(v range-vector)",documentation:"Calculates the per-second instant rate of increase of the time series in the range vector. This is based on the last two data points. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for."},{insertText:"label_join",label:"label_join",detail:"label_join(v instant-vector, dst_label string, separator string, src_label_1 string, src_label_2 string, ...)",documentation:"For each timeseries in `v`, joins all the values of all the `src_labels` using `separator` and returns the timeseries with the label `dst_label` containing the joined value. There can be any number of `src_labels` in this function."},{insertText:"label_replace",label:"label_replace",detail:"label_replace(v instant-vector, dst_label string, replacement string, src_label string, regex string)",documentation:"For each timeseries in `v`, `label_replace(v instant-vector, dst_label string, replacement string, src_label string, regex string)`  matches the regular expression `regex` against the label `src_label`.  If it matches, then the timeseries is returned with the label `dst_label` replaced by the expansion of `replacement`. `$1` is replaced with the first matching subgroup, `$2` with the second etc. If the regular expression doesn't match then the timeseries is returned unchanged."},{insertText:"ln",label:"ln",detail:"ln(v instant-vector)",documentation:"Calculates the natural logarithm for all elements in `v`.\nSpecial cases are:\n * `ln(+Inf) = +Inf`\n * `ln(0) = -Inf`\n * `ln(x < 0) = NaN`\n * `ln(NaN) = NaN`"},{insertText:"log2",label:"log2",detail:"log2(v instant-vector)",documentation:"Calculates the binary logarithm for all elements in `v`. The special cases are equivalent to those in `ln`."},{insertText:"log10",label:"log10",detail:"log10(v instant-vector)",documentation:"Calculates the decimal logarithm for all elements in `v`. The special cases are equivalent to those in `ln`."},{insertText:"minute",label:"minute",detail:"minute(v=vector(time()) instant-vector)",documentation:"Returns the minute of the hour for each of the given times in UTC. Returned values are from 0 to 59."},{insertText:"month",label:"month",detail:"month(v=vector(time()) instant-vector)",documentation:"Returns the month of the year for each of the given times in UTC. Returned values are from 1 to 12, where 1 means January etc."},{insertText:"pi",label:"pi",detail:"pi()",documentation:"Returns pi"},{insertText:"predict_linear",label:"predict_linear",detail:"predict_linear(v range-vector, t scalar)",documentation:"Predicts the value of time series `t` seconds from now, based on the range vector `v`, using simple linear regression."},{insertText:"rad",label:"rad",detail:"rad(v instant-vector)",documentation:"Converts degrees to radians for all elements in v"},{insertText:"rate",label:"rate",detail:"rate(v range-vector)",documentation:"Calculates the per-second average rate of increase of the time series in the range vector. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for. Also, the calculation extrapolates to the ends of the time range, allowing for missed scrapes or imperfect alignment of scrape cycles with the range's time period."},{insertText:"resets",label:"resets",detail:"resets(v range-vector)",documentation:"For each input time series, `resets(v range-vector)` returns the number of counter resets within the provided time range as an instant vector. Any decrease in the value between two consecutive samples is interpreted as a counter reset."},{insertText:"round",label:"round",detail:"round(v instant-vector, to_nearest=1 scalar)",documentation:"Rounds the sample values of all elements in `v` to the nearest integer. Ties are resolved by rounding up. The optional `to_nearest` argument allows specifying the nearest multiple to which the sample values should be rounded. This multiple may also be a fraction."},{insertText:"scalar",label:"scalar",detail:"scalar(v instant-vector)",documentation:"Given a single-element input vector, `scalar(v instant-vector)` returns the sample value of that single element as a scalar. If the input vector does not have exactly one element, `scalar` will return `NaN`."},{insertText:"sgn",label:"sgn",detail:"sgn(v instant-vector)",documentation:"Returns a vector with all sample values converted to their sign, defined as this: 1 if v is positive, -1 if v is negative and 0 if v is equal to zero."},{insertText:"sort",label:"sort",detail:"sort(v instant-vector)",documentation:"Returns vector elements sorted by their sample values, in ascending order."},{insertText:"sort_desc",label:"sort_desc",detail:"sort_desc(v instant-vector)",documentation:"Returns vector elements sorted by their sample values, in descending order."},{insertText:"sqrt",label:"sqrt",detail:"sqrt(v instant-vector)",documentation:"Calculates the square root of all elements in `v`."},{insertText:"time",label:"time",detail:"time()",documentation:"Returns the number of seconds since January 1, 1970 UTC. Note that this does not actually return the current time, but the time at which the expression is to be evaluated."},{insertText:"timestamp",label:"timestamp",detail:"timestamp(v instant-vector)",documentation:"Returns the timestamp of each of the samples of the given vector as the number of seconds since January 1, 1970 UTC."},{insertText:"vector",label:"vector",detail:"vector(s scalar)",documentation:"Returns the scalar `s` as a vector with no labels."},{insertText:"year",label:"year",detail:"year(v=vector(time()) instant-vector)",documentation:"Returns the year for each of the given times in UTC."},{insertText:"avg_over_time",label:"avg_over_time",detail:"avg_over_time(range-vector)",documentation:"The average value of all points in the specified interval."},{insertText:"min_over_time",label:"min_over_time",detail:"min_over_time(range-vector)",documentation:"The minimum value of all points in the specified interval."},{insertText:"max_over_time",label:"max_over_time",detail:"max_over_time(range-vector)",documentation:"The maximum value of all points in the specified interval."},{insertText:"sum_over_time",label:"sum_over_time",detail:"sum_over_time(range-vector)",documentation:"The sum of all values in the specified interval."},{insertText:"count_over_time",label:"count_over_time",detail:"count_over_time(range-vector)",documentation:"The count of all values in the specified interval."},{insertText:"quantile_over_time",label:"quantile_over_time",detail:"quantile_over_time(scalar, range-vector)",documentation:"The \u03C6-quantile (0 \u2264 \u03C6 \u2264 1) of the values in the specified interval."},{insertText:"stddev_over_time",label:"stddev_over_time",detail:"stddev_over_time(range-vector)",documentation:"The population standard deviation of the values in the specified interval."},{insertText:"stdvar_over_time",label:"stdvar_over_time",detail:"stdvar_over_time(range-vector)",documentation:"The population standard variance of the values in the specified interval."},{insertText:"last_over_time",label:"last_over_time",detail:"last_over_time(range-vector)",documentation:"The most recent point value in specified interval."},{insertText:"present_over_time",label:"present_over_time",detail:"present_over_time(range-vector)",documentation:"The value 1 for any series in the specified interval."},{insertText:"histogram_avg",label:"histogram_avg",detail:"histogram_avg(v instant-vector)",documentation:"Returns the arithmetic average of observed values stored in a native histogram. Samples that are not native histograms are ignored and do not show up in the returned vector."},{insertText:"histogram_count",label:"histogram_count",detail:"histogram_count(v instant-vector)",documentation:"Returns the count of observations stored in a native histogram."},{insertText:"histogram_sum",label:"histogram_sum",detail:"histogram_sum(v instant-vector)",documentation:"Returns the sum of observations stored in a native histogram."},{insertText:"histogram_fraction",label:"histogram_fraction",detail:"histogram_fraction(lower scalar, upper scalar, v instant-vector)",documentation:"Returns the estimated fraction of observations between the provided lower and upper values."},{insertText:"histogram_stddev",label:"histogram_stddev",detail:"histogram_stddev(v instant-vector)",documentation:"Returns the estimated standard deviation of observations in a native histogram, based on the geometric mean of the buckets where the observations lie."},{insertText:"histogram_stdvar",label:"histogram_stdvar",detail:"histogram_stdvar(v instant-vector)",documentation:"Returns the estimated standard variance of observations in a native histogram."}],a=g.map(h=>h.label),c={comment:{pattern:/#.*/},"context-aggregation":{pattern:/((by|without)\s*)\([^)]*\)/,lookbehind:!0,inside:{"label-key":{pattern:/[^(),\s][^,)]*[^),\s]*/,alias:"attr-name"},punctuation:/[()]/}},"context-labels":{pattern:/\{[^}]*(?=}?)/,greedy:!0,inside:{comment:{pattern:/#.*/},"label-key":{pattern:/[a-z_]\w*(?=\s*(=|!=|=~|!~))/,alias:"attr-name",greedy:!0},"label-value":{pattern:/"(?:\\.|[^\\"])*"/,greedy:!0,alias:"attr-value"},punctuation:/[{]/}},function:new RegExp(`\\b(?:${g.map(h=>h.label).join("|")})(?=\\s*\\()`,"i"),"context-range":[{pattern:/\[[^\]]*(?=])/,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}},{pattern:/(offset\s+)\w+/,lookbehind:!0,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}}],idList:{pattern:/\d+(\|\d+)+/,alias:"number"},number:/\b-?\d+((\.\d*)?([eE][+-]?\d+)?)?\b/,operator:new RegExp(`/[-+*/=%^~]|&&?|\\|?\\||!=?|<(?:=>?|<|>)?|>[>=]?|\\b(?:${n.join("|")})\\b`,"i"),punctuation:/[{};()`,.]/},o=c},32370:(k,R,e)=>{"use strict";e.d(R,{l:()=>x,z:()=>P});var t=e(20719),n=e(1220),i=e(75161),s=e(38961),r=e(15145);function g(){return[{id:r.jN.HistogramQuantile,name:"Histogram quantile",params:[{name:"Quantile",type:"number",options:[.99,.95,.9,.75,.5,.25]}],defaultParams:[.9],category:r.Ag.Functions,renderer:n.jY,addOperationHandler:n.iZ},a({id:r.jN.HistogramAvg}),a({id:r.jN.HistogramCount}),a({id:r.jN.HistogramSum}),{id:r.jN.HistogramFraction,name:"Histogram fraction",params:[{name:"Lower scalar",type:"number"},{name:"Upper scalar",type:"number"}],defaultParams:[0,.2],category:r.Ag.Functions,renderer:n.jY,addOperationHandler:n.iZ},a({id:r.jN.HistogramStddev}),a({id:r.jN.HistogramStdvar}),{id:r.jN.LabelReplace,name:"Label replace",params:[{name:"Destination label",type:"string"},{name:"Replacement",type:"string"},{name:"Source label",type:"string"},{name:"Regex",type:"string"}],category:r.Ag.Functions,defaultParams:["","$1","","(.*)"],renderer:n.kf,addOperationHandler:n.iZ},{id:r.jN.Ln,name:"Ln",params:[],defaultParams:[],category:r.Ag.Functions,renderer:n.jY,addOperationHandler:n.iZ},c(r.jN.Changes),c(r.jN.Rate,!0),c(r.jN.Irate),c(r.jN.Increase,!0),c(r.jN.Idelta),c(r.jN.Delta),a({id:r.jN.HoltWinters,params:[(0,n.z2)(),{name:"Smoothing Factor",type:"number"},{name:"Trend Factor",type:"number"}],defaultParams:["$__interval",.5,.5],alternativesKey:"range function",category:r.Ag.RangeFunctions,renderer:n.nU,addOperationHandler:f,changeTypeHandler:o}),a({id:r.jN.PredictLinear,params:[(0,n.z2)(),{name:"Seconds from now",type:"number"}],defaultParams:["$__interval",60],alternativesKey:"range function",category:r.Ag.RangeFunctions,renderer:n.nU,addOperationHandler:f,changeTypeHandler:o}),a({id:r.jN.QuantileOverTime,params:[(0,n.z2)(),{name:"Quantile",type:"number"}],defaultParams:["$__interval",.5],alternativesKey:"overtime function",category:r.Ag.RangeFunctions,renderer:n.Kl,addOperationHandler:f,changeTypeHandler:o}),...i.Iu,{id:r.jN.NestedQuery,name:"Binary operation with query",params:[],defaultParams:[],category:r.Ag.BinaryOps,renderer:(M,O,I)=>I,addOperationHandler:d},a({id:r.jN.Abs}),a({id:r.jN.Absent}),a({id:r.jN.Acos,category:r.Ag.Trigonometric}),a({id:r.jN.Acosh,category:r.Ag.Trigonometric}),a({id:r.jN.Asin,category:r.Ag.Trigonometric}),a({id:r.jN.Asinh,category:r.Ag.Trigonometric}),a({id:r.jN.Atan,category:r.Ag.Trigonometric}),a({id:r.jN.Atanh,category:r.Ag.Trigonometric}),a({id:r.jN.Ceil}),a({id:r.jN.Clamp,name:"Clamp",params:[{name:"Minimum Scalar",type:"number"},{name:"Maximum Scalar",type:"number"}],defaultParams:[1,1]}),a({id:r.jN.ClampMax,params:[{name:"Maximum Scalar",type:"number"}],defaultParams:[1]}),a({id:r.jN.ClampMin,params:[{name:"Minimum Scalar",type:"number"}],defaultParams:[1]}),a({id:r.jN.Cos,category:r.Ag.Trigonometric}),a({id:r.jN.Cosh,category:r.Ag.Trigonometric}),a({id:r.jN.DayOfMonth,category:r.Ag.Time}),a({id:r.jN.DayOfWeek,category:r.Ag.Time}),a({id:r.jN.DayOfYear,category:r.Ag.Time}),a({id:r.jN.DaysInMonth,category:r.Ag.Time}),a({id:r.jN.Deg}),c(r.jN.Deriv),a({id:r.jN.Exp}),a({id:r.jN.Floor}),a({id:r.jN.Hour}),a({id:r.jN.LabelJoin,params:[{name:"Destination Label",type:"string",editor:s.r},{name:"Separator",type:"string"},{name:"Source Label",type:"string",restParam:!0,optional:!0,editor:s.r}],defaultParams:["",",",""],renderer:p,explainHandler:m,addOperationHandler:v}),a({id:r.jN.Log10}),a({id:r.jN.Log2}),a({id:r.jN.Minute}),a({id:r.jN.Month}),a({id:r.jN.Pi,renderer:M=>`${M.id}()`}),a({id:r.jN.Rad}),c(r.jN.Resets),a({id:r.jN.Round,category:r.Ag.Functions,params:[{name:"To Nearest",type:"number"}],defaultParams:[1]}),a({id:r.jN.Scalar}),a({id:r.jN.Sgn}),a({id:r.jN.Sin,category:r.Ag.Trigonometric}),a({id:r.jN.Sinh,category:r.Ag.Trigonometric}),a({id:r.jN.Sort}),a({id:r.jN.SortDesc}),a({id:r.jN.Sqrt}),a({id:r.jN.Stddev}),a({id:r.jN.Tan,category:r.Ag.Trigonometric}),a({id:r.jN.Tanh,category:r.Ag.Trigonometric}),a({id:r.jN.Time,renderer:M=>`${M.id}()`}),a({id:r.jN.Timestamp}),a({id:r.jN.Vector,params:[{name:"Value",type:"number"}],defaultParams:[1],renderer:M=>`${M.id}(${M.params[0]})`}),a({id:r.jN.Year})]}function a(b){return{...b,id:b.id,name:b.name??(0,n.DQ)(b.id),params:b.params??[],defaultParams:b.defaultParams??[],category:b.category??r.Ag.Functions,renderer:b.renderer??(b.params?n.kf:n.jY),addOperationHandler:b.addOperationHandler??n.iZ}}function c(b,M=!1){return{id:b,name:(0,n.DQ)(b),params:[(0,n.z2)(M)],defaultParams:[M?"$__rate_interval":"$__interval"],alternativesKey:"range function",category:r.Ag.RangeFunctions,renderer:h,addOperationHandler:f,changeTypeHandler:o}}function o(b,M){return(b.params[0]==="$__rate_interval"&&M.defaultParams[0]!=="$__rate_interval"||b.params[0]==="$__interval"&&M.defaultParams[0]!=="$__interval")&&(b.params=M.defaultParams),b}function h(b,M,O){let I=(b.params??[])[0]??"5m";return`${M.id}(${O}[${I}])`}function f(b,M,O){const I={id:b.id,params:b.defaultParams};return M.operations.length>0&&O.getOperationDef(M.operations[0].id).addOperationHandler===f?{...M,operations:[I,...M.operations.slice(1)]}:{...M,operations:[I,...M.operations]}}function d(b,M){return{...M,binaryQueries:[...M.binaryQueries??[],{operator:"/",query:M}]}}function p(b,M,O){const I=b.params[0]??"",C=`"${b.params[1]??""}"`;return`${b.id}(${O}, "${I}", ${C}, "${b.params.slice(2).join(C)}")`}function m(b,M){let O=M?.documentation??"no docs";return typeof b.params[1]!="string"&&(O+=" \u{1F6A8}\u{1F6A8}\u{1F6A8} The `separator` must be a string."),O}function v(b,M){const O={id:b.id,params:b.defaultParams};return{...M,operations:[...M.operations,O]}}function l(){return[...(0,n.G3)(r.jN.Sum),...(0,n.G3)(r.jN.Avg),...(0,n.G3)(r.jN.Min),...(0,n.G3)(r.jN.Max),...(0,n.G3)(r.jN.Count),...(0,n.G3)(r.jN.Group),...(0,n.jC)(r.jN.TopK,{params:[{name:"K-value",type:"number"}],defaultParams:[5]}),...(0,n.jC)(r.jN.BottomK,{params:[{name:"K-value",type:"number"}],defaultParams:[5]}),...(0,n.jC)(r.jN.CountValues,{params:[{name:"Identifier",type:"string"}],defaultParams:["count"]}),...(0,n.jC)(r.jN.Quantile,{params:[{name:"Value",type:"number"}],defaultParams:[1]}),y(r.jN.SumOverTime),y(r.jN.AvgOverTime),y(r.jN.MinOverTime),y(r.jN.MaxOverTime),y(r.jN.CountOverTime),y(r.jN.LastOverTime),y(r.jN.PresentOverTime),y(r.jN.AbsentOverTime),y(r.jN.StddevOverTime)]}function y(b){return{id:b,name:(0,n.DQ)(b),params:[(0,n.z2)()],defaultParams:["$__interval"],alternativesKey:"overtime function",category:r.Ag.RangeFunctions,renderer:u,addOperationHandler:f}}function u(b,M,O){let I=(b.params??[])[0]??"$__interval";return`${M.id}(${O}[${I}])`}var D=e(83077);class E{constructor(M){this.categories=[],this.operationsRegistry=new D.O(M)}setOperationCategories(M){this.categories=M}getOperationsForCategory(M){return this.operationsRegistry.list().filter(O=>O.category===M&&!O.hideFromList)}getAlternativeOperations(M){return this.operationsRegistry.list().filter(O=>O.alternativesKey&&O.alternativesKey===M)}getCategories(){return this.categories}getOperationDef(M){return this.operationsRegistry.getIfExists(M)}renderOperations(M,O){for(const I of O){const T=this.operationsRegistry.getIfExists(I.id);if(!T)throw new Error(`Could not find operation ${I.id} in the registry`);M=T.renderer(I,T,M)}return M}renderBinaryQueries(M,O){if(O)for(const I of O)M=`${this.renderBinaryQuery(M,I)}`;return M}renderBinaryQuery(M,O){let I=M+` ${O.operator} `;return O.vectorMatches&&(I+=`${O.vectorMatchesType}(${O.vectorMatches}) `),I+this.renderQuery(O.query,!0)}renderLabels(M){if(M.length===0)return"";let O="{";for(const I of M)O!=="{"&&(O+=", "),O+=`${I.label}${I.op}"${I.value}"`;return O+"}"}renderQuery(M,O){let I=`${M.metric??""}${this.renderLabels(M.labels)}`;return I=this.renderOperations(I,M.operations),!O&&this.hasBinaryOp(M)&&M.binaryQueries?.length&&(I=`(${I})`),I=this.renderBinaryQueries(I,M.binaryQueries),O&&(this.hasBinaryOp(M)||M.binaryQueries?.length)&&(I=`(${I})`),I}hasBinaryOp(M){return M.operations.find(O=>this.getOperationDef(O.id)?.category===r.Ag.BinaryOps)!==void 0}}class x extends E{constructor(){super(()=>{const M=[...g(),...l()];for(const O of M){const I=t.AW.find(T=>T.insertText===O.id);I&&(O.documentation=I.documentation)}return M}),this.setOperationCategories([r.Ag.Aggregations,r.Ag.RangeFunctions,r.Ag.Functions,r.Ag.BinaryOps,r.Ag.Trigonometric,r.Ag.Time])}getQueryPatterns(){return[{name:"Rate then sum",type:r.n5.Rate,operations:[{id:"rate",params:["$__rate_interval"]},{id:"sum",params:[]}]},{name:"Rate then sum by(label) then avg",type:r.n5.Rate,operations:[{id:"rate",params:["$__rate_interval"]},{id:"__sum_by",params:[""]},{id:"avg",params:[]}]},{name:"Histogram quantile on rate",type:r.n5.Histogram,operations:[{id:"rate",params:["$__rate_interval"]},{id:"__sum_by",params:["le"]},{id:"histogram_quantile",params:[.95]}]},{name:"Histogram quantile on increase",type:r.n5.Histogram,operations:[{id:"increase",params:["$__rate_interval"]},{id:"__max_by",params:["le"]},{id:"histogram_quantile",params:[.95]}]},{name:"Binary Query",type:r.n5.Binary,operations:[{id:"rate",params:["$__rate_interval"]},{id:"sum",params:[]}],binaryQueries:[{operator:"/",query:{metric:"",labels:[],operations:[{id:"rate",params:["$__rate_interval"]},{id:"sum",params:[]}]}}]}]}}const P=new x},75161:(k,R,e)=>{"use strict";e.d(R,{AE:()=>s,C8:()=>i,Iu:()=>r});var t=e(1220),n=e(15145);const i=[{id:n.jN.Addition,name:"Add scalar",sign:"+"},{id:n.jN.Subtraction,name:"Subtract scalar",sign:"-"},{id:n.jN.MultiplyBy,name:"Multiply by scalar",sign:"*"},{id:n.jN.DivideBy,name:"Divide by scalar",sign:"/"},{id:n.jN.Modulo,name:"Modulo by scalar",sign:"%"},{id:n.jN.Exponent,name:"Exponent",sign:"^"},{id:n.jN.EqualTo,name:"Equal to",sign:"==",comparison:!0},{id:n.jN.NotEqualTo,name:"Not equal to",sign:"!=",comparison:!0},{id:n.jN.GreaterThan,name:"Greater than",sign:">",comparison:!0},{id:n.jN.LessThan,name:"Less than",sign:"<",comparison:!0},{id:n.jN.GreaterOrEqual,name:"Greater or equal to",sign:">=",comparison:!0},{id:n.jN.LessOrEqual,name:"Less or equal to",sign:"<=",comparison:!0}],s=i.reduce((a,c)=>(a[c.sign]={id:c.id,comparison:c.comparison},a),{}),r=i.map(a=>{const c=[{name:"Value",type:"number"}];let o=[2];return a.comparison&&(c.push({name:"Bool",type:"boolean",description:"If checked comparison will return 0 or 1 for the value rather than filtering."}),o=[2,!1]),{id:a.id,name:a.name,params:c,defaultParams:o,alternativesKey:"binary scalar operations",category:n.Ag.BinaryOps,renderer:g(a.sign),addOperationHandler:t.iZ}});function g(a){return function(o,h,f){let d=o.params[0],p="";return o.params.length===2&&(p=o.params[1]?" bool":""),`${f} ${a}${p} ${d}`}}},38961:(k,R,e)=>{"use strict";e.d(R,{r:()=>a});var t=e(74848),n=e(96540),i=e(50877),s=e(90182),r=e(32370),g=e(1220);function a({onChange:o,index:h,operationId:f,value:d,query:p,datasource:m}){const[v,l]=(0,n.useState)({});return(0,t.jsx)(s.l6,{inputId:(0,g.OS)(f,h),autoFocus:d===""?!0:void 0,openMenuOnFocus:!0,onOpenMenu:async()=>{l({isLoading:!0});const y=await c(p,m);l({options:y,isLoading:void 0})},isLoading:v.isLoading,allowCustomValue:!0,noOptionsMessage:"No labels found",loadingMessage:"Loading labels",options:v.options,value:(0,i.z)(d),onChange:y=>o(h,y.value)})}async function c(o,h){let f=o.labels;h.type==="prometheus"&&(f=[{label:"__name__",op:"=",value:o.metric},...o.labels]);const d=r.z.renderLabels(f),p=await h.languageProvider.fetchLabelsWithMatch(d);return Object.keys(p).map(m=>({label:m,value:m}))}},9103:(k,R,e)=>{"use strict";e.d(R,{dm:()=>Se,o6:()=>ve});var t=e(74848),n=e(32196),i=e(76459),s=e.n(i),r=e(96540),g=e(23257),a=e.n(g),c=e(50877),o=e(13544),h=e(97801),f=e(81580),d=e(32264),p=e(40845),m=e(55852),v=e(14578),l=e(12681),y=e(88824),u=e(40276),D=e(90182),E=e(39268),x=e(14186),P=e(81996),b=e(26115),M=e(65307),O=e(37390),I=e(10354),T=e(62930),C=e(60782),S=e(19727),A=e(19384),L=e(15292),N=e(56034),F=e(14110),w=e(50556);async function B(he,Ce,We){let et=!0;const rt=he.languageProvider.metricsMetadata;rt&&Object.keys(rt).length===0&&(et=!1);let nt={},gt={},xt;return xt=We?.map(St=>{const zt=U(St,he),Nt=`${St}\xA6${zt.description}`;return nt[St]=zt,gt[Nt]=zt,zt}),{isLoading:!1,hasMetadata:et,metrics:xt??[],metaHaystackDictionary:gt,nameHaystackDictionary:nt,totalMetricCount:xt?.length??0,filteredMetricCount:xt?.length??0}}function U(he,Ce){let We=(0,w.AU)(he,Ce.languageProvider.metricsMetadata);const et=(0,w.pK)(he,Ce.languageProvider.metricsMetadata);["histogram","summary"].forEach(gt=>{et?.toLowerCase().includes(gt)&&We!==gt&&(We+=` (${gt})`)});const rt=he.match(/^\w+_bucket$|^\w+_bucket{.*}$/);return We==="histogram"&&!rt&&(We="native histogram"),{value:he,type:We,description:et}}function K(he,Ce){const We=V(he);return!he.isLoading&&he.filteredMetricCount!==We.length&&Ce(Ee(We.length)),Y(We,he.pageNum,he.resultsPerPage)}function V(he){let Ce=he.metrics;return he.fuzzySearchQuery&&!he.useBackend&&(he.fullMetaSearch?Ce=he.metaHaystackOrder.map(We=>he.metaHaystackDictionary[We]):Ce=he.nameHaystackOrder.map(We=>he.nameHaystackDictionary[We])),he.selectedTypes.length>0&&(Ce=Ce.filter((We,et)=>he.selectedTypes.some(nt=>We.type&&nt.value?We.type.includes(nt.value):!We.type&&nt.value==="no type"))),he.includeNullMetadata||(Ce=Ce.filter(We=>We.type!==void 0&&We.description!==void 0)),Ce}function H(he){if(!he.metrics.length)return[];const Ce=he.resultsPerPage===0?1:he.resultsPerPage,We=Math.floor(V(he).length/Ce)+1;return[...Array(We).keys()].map(et=>et+1)}function Y(he,Ce,We){const et=We===0?1:We,rt=Ce===1?0:(Ce-1)*et,nt=rt+et;return he.slice(rt,nt)}const X=(he,Ce,We)=>he<1?1:he>We?We:he??Ce;async function J(he,Ce,We){const et=(0,b.b4)(he),rt=Ce.map(xt=>`,${xt.label}="${xt.value}"`),nt=`label_values({__name__=~".*${et}"${Ce?rt.join():""}},__name__)`;return await We.metricFindQuery(nt).then(xt=>xt.map(St=>U(St.text,We)))}function q(he,Ce,We,et){switch(he){case"grafana_prom_metric_encycopedia_tracking":(0,F.rR)(he,{metric:We,hasMetadata:Ce?.hasMetadata,totalMetricCount:Ce?.totalMetricCount,fuzzySearchQuery:Ce?.fuzzySearchQuery,fullMetaSearch:Ce?.fullMetaSearch,selectedTypes:Ce?.selectedTypes,useRegexSearch:Ce?.useBackend,includeResultsWithoutMetadata:Ce?.includeNullMetadata});case"grafana_prom_metric_encycopedia_disable_text_wrap_interaction":(0,F.rR)(he,{disableTextWrap:Ce?.disableTextWrap});case"grafana_prometheus_metric_encyclopedia_open":(0,F.rR)(he,{query:et})}}const ae=[{value:"counter",description:"A cumulative metric that represents a single monotonically increasing counter whose value can only increase or be reset to zero on restart."},{value:"gauge",description:"A metric that represents a single numerical value that can arbitrarily go up and down."},{value:"histogram",description:"A histogram samples observations (usually things like request durations or response sizes) and counts them in configurable buckets."},{value:"native histogram",description:"Native histograms are different from classic Prometheus histograms in a number of ways: Native histogram bucket boundaries are calculated by a formula that depends on the scale (resolution) of the native histogram, and are not user defined."},{value:"summary",description:"A summary samples observations (usually things like request durations and response sizes) and can calculate configurable quantiles over a sliding time window."},{value:"unknown",description:"These metrics have been given the type unknown in the metadata."},{value:"no type",description:"These metrics have no defined type in the metadata."}],j={browse:"Search metrics by name",metadataSearchSwitch:"Include description in search",type:"Filter by type",includeNullMetadata:"Include results with no metadata",setUseBackend:"Enable regex search"};function te(he){const{state:Ce,onChangeFullMetaSearch:We,onChangeIncludeNullMetadata:et,onChangeDisableTextWrap:rt,onChangeUseBackend:nt}=he,gt=(0,p.$j)(),xt=ne(gt);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:xt.selectItem,children:[(0,t.jsx)(L.d,{"data-testid":Le.searchWithMetadata,value:Ce.fullMetaSearch,disabled:Ce.useBackend||!Ce.hasMetadata,onChange:()=>We()}),(0,t.jsx)("div",{className:xt.selectItemLabel,children:j.metadataSearchSwitch})]}),(0,t.jsxs)("div",{className:xt.selectItem,children:[(0,t.jsx)(L.d,{value:Ce.includeNullMetadata,disabled:!Ce.hasMetadata,onChange:()=>et()}),(0,t.jsx)("div",{className:xt.selectItemLabel,children:j.includeNullMetadata})]}),(0,t.jsxs)("div",{className:xt.selectItem,children:[(0,t.jsx)(L.d,{value:Ce.disableTextWrap,onChange:()=>rt()}),(0,t.jsx)("div",{className:xt.selectItemLabel,children:"Disable text wrap"})]}),(0,t.jsxs)("div",{className:xt.selectItem,children:[(0,t.jsx)(L.d,{"data-testid":Le.setUseBackend,value:Ce.useBackend,onChange:()=>nt()}),(0,t.jsxs)("div",{className:xt.selectItemLabel,children:[j.setUseBackend,"\xA0"]}),(0,t.jsx)(N.m,{content:"Filter metric names by regex search, using an additional call on the Prometheus API.",placement:"bottom-end",children:(0,t.jsx)(v.I,{name:"info-circle",size:"xs",className:xt.settingsIcon})})]})]})}function ne(he){return{settingsIcon:(0,n.css)({color:he.colors.text.secondary}),selectItem:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"center",padding:"4px 0"}),selectItemLabel:(0,n.css)({margin:`0 0 0 ${he.spacing(1)}`,alignSelf:"center",color:he.colors.text.secondary,fontSize:"12px"})}}var le=e(67061);function z({feedbackUrl:he}){const Ce=(0,p.of)(ee);return(0,t.jsx)(le.B,{children:(0,t.jsxs)("a",{href:he,className:Ce.link,title:"The metrics explorer is new, please let us know how we can improve it",target:"_blank",rel:"noreferrer noopener",children:[(0,t.jsx)(v.I,{name:"comment-alt-message"})," Give feedback"]})})}function ee(he){return{link:(0,n.css)({color:he.colors.text.secondary,fontSize:he.typography.bodySmall.fontSize,":hover":{color:he.colors.text.link},margin:"-25px 0 30px 0"})}}var se=e(4936);function ie(he){const{metrics:Ce,onChange:We,onClose:et,query:rt,state:nt,disableTextWrap:gt}=he,xt=(0,p.$j)(),St=Z(xt,gt);function zt(ot){ot.value&&(We({...rt,metric:ot.value}),q("grafana_prom_metric_encycopedia_tracking",nt,ot.value),et())}function Nt(ot){return nt.fullMetaSearch&&ot?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("td",{children:en(ot.type??"")}),(0,t.jsx)("td",{children:(0,t.jsx)(a(),{textToHighlight:ot.description??"",searchWords:nt.metaHaystackMatches,autoEscape:!0,highlightClassName:St.matchHighLight})})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("td",{children:en(ot.type??"")}),(0,t.jsx)("td",{children:ot.description??""})]})}function Vt(ot,Qe,pt){return(0,t.jsxs)(t.Fragment,{children:[ot,(0,t.jsx)("span",{className:St.tooltipSpace,children:(0,t.jsx)(N.m,{content:(0,t.jsxs)(t.Fragment,{children:["When creating a ",Qe,", Prometheus exposes multiple series with the type counter."," ",(0,se.jW)(pt)]}),placement:"bottom-start",interactive:!0,children:(0,t.jsx)(v.I,{name:"info-circle",size:"xs"})})})]})}function en(ot){return ot?ot.includes("(summary)")?Vt(ot,"summary","https://prometheus.io/docs/concepts/metric_types/#summary"):ot.includes("(histogram)")?Vt(ot,"histogram","https://prometheus.io/docs/concepts/metric_types/#histogram"):ot:""}function Je(){let ot;return nt.fuzzySearchQuery||(ot="There are no metrics found in the data source."),rt.labels.length>0&&(ot="There are no metrics found. Try to expand your label filters."),(nt.fuzzySearchQuery||nt.selectedTypes.length>0)&&(ot="There are no metrics found. Try to expand your search and filters."),(0,t.jsx)("tr",{className:St.noResults,children:(0,t.jsx)("td",{colSpan:3,children:ot})})}function ct(ot){return ot.useBackend?[ot.fuzzySearchQuery]:ot.fullMetaSearch?ot.metaHaystackMatches:ot.nameHaystackMatches}return(0,t.jsxs)("table",{className:St.table,children:[(0,t.jsx)("thead",{className:St.stickyHeader,children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:`${St.nameWidth} ${St.tableHeaderPadding}`,children:"Name"}),nt.hasMetadata&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("th",{className:`${St.typeWidth} ${St.tableHeaderPadding}`,children:"Type"}),(0,t.jsx)("th",{className:`${St.descriptionWidth} ${St.tableHeaderPadding}`,children:"Description"})]}),(0,t.jsx)("th",{className:St.selectButtonWidth,children:" "})]})}),(0,t.jsx)("tbody",{children:(0,t.jsxs)(t.Fragment,{children:[Ce.length>0&&Ce.map((ot,Qe)=>(0,t.jsxs)("tr",{className:St.row,children:[(0,t.jsx)("td",{className:St.nameOverflow,children:(0,t.jsx)(a(),{textToHighlight:ot?.value??"",searchWords:ct(nt),autoEscape:!0,highlightClassName:St.matchHighLight})}),nt.hasMetadata&&Nt(ot),(0,t.jsx)("td",{children:(0,t.jsx)(m.$n,{size:"md",variant:"secondary",onClick:()=>zt(ot),className:St.centerButton,children:"Select"})})]},ot?.value??Qe)),Ce.length===0&&!nt.isLoading&&Je()]})})]})}const Z=(he,Ce)=>({table:(0,n.css)({tableLayout:Ce?void 0:"fixed",borderRadius:he.shape.radius.default,width:"100%",whiteSpace:Ce?"nowrap":"normal",td:{padding:he.spacing(1)},"td,th":{minWidth:he.spacing(3),borderBottom:`1px solid ${he.colors.border.weak}`}}),row:(0,n.css)({label:"row",borderBottom:`1px solid ${he.colors.border.weak}`,"&:last-child":{borderBottom:0}}),tableHeaderPadding:(0,n.css)({padding:"8px"}),matchHighLight:(0,n.css)({background:"inherit",color:he.components.textHighlight.text,backgroundColor:he.components.textHighlight.background}),nameWidth:(0,n.css)({width:Ce?void 0:"37.5%"}),nameOverflow:(0,n.css)({overflowWrap:Ce?void 0:"anywhere"}),typeWidth:(0,n.css)({width:Ce?void 0:"15%"}),descriptionWidth:(0,n.css)({width:Ce?void 0:"35%"}),selectButtonWidth:(0,n.css)({width:Ce?void 0:"12.5%"}),stickyHeader:(0,n.css)({position:"sticky",top:0,backgroundColor:he.colors.background.primary}),noResults:(0,n.css)({textAlign:"center",color:he.colors.text.secondary}),tooltipSpace:(0,n.css)({marginLeft:"4px"}),centerButton:(0,n.css)({display:"block",margin:"auto",border:"none"})});var oe=e(78036);const ce=(he,Ce)=>({modal:(0,n.css)({width:"85vw",[he.breakpoints.down("md")]:{width:"100%"},[he.breakpoints.up("xl")]:{width:"60%"}}),inputWrapper:(0,n.css)({display:"flex",flexDirection:"row",flexWrap:"wrap"}),inputItemFirst:(0,n.css)({flexBasis:"40%",paddingRight:"16px",[he.breakpoints.down("md")]:{paddingRight:"0px",paddingBottom:"16px"}}),inputItem:(0,n.css)({flexGrow:1,flexBasis:"20%",[he.breakpoints.down("md")]:{minWidth:"100%"}}),selectWrapper:(0,n.css)({marginBottom:he.spacing(1)}),resultsAmount:(0,n.css)({color:he.colors.text.secondary,fontSize:"0.85rem",padding:"0 0 4px 0"}),resultsData:(0,n.css)({margin:`4px 0 ${he.spacing(2)} 0`}),resultsDataCount:(0,n.css)({margin:0}),resultsDataFiltered:(0,n.css)({color:he.colors.text.secondary,textAlign:"center",border:"solid 1px rgba(204, 204, 220, 0.25)",padding:"7px"}),resultsDataFilteredText:(0,n.css)({display:"inline",verticalAlign:"text-top"}),results:(0,n.css)({height:"calc(80vh - 310px)",overflowY:"scroll"}),resultsFooter:(0,n.css)({marginTop:"24px",display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between",alignItems:"center",position:"sticky"}),currentlySelected:(0,n.css)({color:"grey",opacity:"75%",fontSize:"0.75rem"}),loadingSpinner:(0,n.css)({visibility:"hidden"}),visible:(0,n.css)({visibility:"visible"}),settingsBtn:(0,n.css)({float:"right"}),noBorder:(0,n.css)({border:"none"}),resultsPerPageLabel:(0,n.css)({color:he.colors.text.secondary,opacity:"75%",paddingTop:"5px",fontSize:"0.85rem",marginRight:"8px"}),resultsPerPageWrapper:(0,n.css)({display:"flex"})});var ye=e(53076),re=e(2543);const ue=new ye.A({intraMode:1,intraIns:1,intraSub:1,intraTrn:1,intraDel:1});function De(he,Ce,We){const[et,rt,nt]=ue.search(he,Ce,0,1e5);let gt=[],xt=new Set;if(et&&nt){const St=(zt,Nt)=>{Nt&&xt.add(zt)};for(let zt=0;zt<nt.length;zt++){let Nt=nt[zt];ye.A.highlight(he[rt.idx[Nt]],rt.ranges[Nt],St),gt.push(he[rt.idx[Nt]])}We([gt,[...xt]])}else Ce||We([[],[]])}const ge=(0,re.debounce)(De,300),Te=he=>{const{datasource:Ce,isOpen:We,onClose:et,onChange:rt,query:nt,initialMetrics:gt}=he,[xt,St]=(0,r.useReducer)(Ye.reducer,(0,oe.ue)(nt)),zt=(0,p.$j)(),Nt=ce(zt,xt.disableTextWrap),Vt=(0,r.useCallback)(async()=>{St(je(!0));const Pt=await B(Ce,nt,gt);St(Ze({isLoading:!1,hasMetadata:Pt.hasMetadata,metrics:Pt.metrics,metaHaystackDictionary:Pt.metaHaystackDictionary,nameHaystackDictionary:Pt.nameHaystackDictionary,totalMetricCount:Pt.metrics.length,filteredMetricCount:Pt.metrics.length}))},[nt,Ce,gt]);(0,r.useEffect)(()=>{Vt()},[Vt]);const en=ae.map(Pt=>({value:Pt.value,label:Pt.value,description:Pt.description})),Je=(0,r.useMemo)(()=>s()(async Pt=>{St(je(!0));const At=await J(Pt,nt.labels,Ce);St(Ne({metrics:At,filteredMetricCount:At.length,isLoading:!1}))},Ce.getDebounceTimeInMilliseconds()),[Ce,nt]);function ct(Pt){St(ze(Pt))}function ot(Pt){St(qe(Pt))}function Qe(Pt,At){xt.useBackend&&Pt===""?Vt():xt.useBackend?Je(Pt):At?ge(Object.keys(xt.metaHaystackDictionary),Pt,ot):ge(Object.keys(xt.nameHaystackDictionary),Pt,ct)}const pt=(0,t.jsx)(te,{state:xt,onChangeFullMetaSearch:()=>{const Pt=!xt.fullMetaSearch;St(dt(Pt)),rt({...nt,fullMetaSearch:Pt}),Qe(xt.fuzzySearchQuery,Pt)},onChangeIncludeNullMetadata:()=>{St(vt(!xt.includeNullMetadata)),rt({...nt,includeNullMetadata:!xt.includeNullMetadata})},onChangeDisableTextWrap:()=>{St(Ve()),rt({...nt,disableTextWrap:!xt.disableTextWrap}),q("grafana_prom_metric_encycopedia_disable_text_wrap_interaction",xt,"")},onChangeUseBackend:()=>{const Pt=!xt.useBackend;St(st(Pt)),rt({...nt,useBackend:Pt}),Pt===!1?Vt():xt.fuzzySearchQuery!==""&&Je(xt.fuzzySearchQuery)}});return(0,t.jsxs)(O.a,{"data-testid":Le.metricModal,isOpen:We,title:"Metrics explorer",onDismiss:et,"aria-label":"Browse metrics",className:Nt.modal,children:[(0,t.jsx)(z,{feedbackUrl:"https://forms.gle/DEMAJHoAMpe3e54CA"}),(0,t.jsxs)("div",{className:Nt.inputWrapper,"data-testid":o.Tp.components.DataSource.Prometheus.queryEditor.builder.metricsExplorer,children:[(0,t.jsx)("div",{className:(0,n.cx)(Nt.inputItem,Nt.inputItemFirst),children:(0,t.jsx)(I.p,{autoFocus:!0,"data-testid":Le.searchMetric,placeholder:j.browse,value:xt.fuzzySearchQuery,onInput:Pt=>{const At=Pt.currentTarget.value??"";St($e(At)),Qe(At,xt.fullMetaSearch)}})}),xt.hasMetadata&&(0,t.jsx)("div",{className:Nt.inputItem,children:(0,t.jsx)(D.KF,{"data-testid":Le.selectType,inputId:"my-select",options:en,value:xt.selectedTypes,placeholder:j.type,onChange:Pt=>St(yt(Pt))})}),(0,t.jsx)("div",{children:(0,t.jsx)(T.y,{className:`${Nt.loadingSpinner} ${xt.isLoading?Nt.visible:""}`})}),(0,t.jsx)("div",{className:Nt.inputItem,children:(0,t.jsx)(C.G,{"aria-label":"Additional settings",content:pt,placement:"bottom-end",closeButton:!1,children:(0,t.jsxs)(S.e,{className:Nt.settingsBtn,children:[(0,t.jsx)(m.$n,{variant:"secondary",size:"md",onClick:()=>St(pe()),"data-testid":Le.showAdditionalSettings,className:Nt.noBorder,children:"Additional Settings"}),(0,t.jsx)(m.$n,{className:Nt.noBorder,variant:"secondary",icon:xt.showAdditionalSettings?"angle-up":"angle-down"})]})})})]}),(0,t.jsxs)("div",{className:Nt.resultsData,children:[nt.metric&&(0,t.jsxs)("i",{className:Nt.currentlySelected,children:["Currently selected: ",nt.metric]}),nt.labels.length>0&&(0,t.jsxs)("div",{className:Nt.resultsDataFiltered,children:[(0,t.jsx)(v.I,{name:"info-circle",size:"sm"}),(0,t.jsx)("div",{className:Nt.resultsDataFilteredText,children:"\xA0These metrics have been pre-filtered by labels chosen in the label filters."})]})]}),(0,t.jsx)("div",{className:Nt.results,children:xt.metrics&&(0,t.jsx)(ie,{metrics:K(xt,St),onChange:rt,onClose:et,query:nt,state:xt,disableTextWrap:xt.disableTextWrap})}),(0,t.jsxs)("div",{className:Nt.resultsFooter,children:[(0,t.jsxs)("div",{className:Nt.resultsAmount,children:["Showing ",xt.filteredMetricCount," of ",xt.totalMetricCount," results"]}),(0,t.jsx)(A.d,{currentPage:xt.pageNum??1,numberOfPages:H(xt).length,onNavigate:Pt=>{St(Ue(Pt??1))}}),(0,t.jsxs)("div",{className:Nt.resultsPerPageWrapper,children:[(0,t.jsx)("p",{className:Nt.resultsPerPageLabel,children:"# Results per page\xA0"}),(0,t.jsx)(I.p,{"data-testid":Le.resultsPerPage,value:X(xt.resultsPerPage,oe.J3,oe.yH),placeholder:"results per page",width:10,title:"The maximum results per page is "+oe.yH,type:"number",onInput:Pt=>{const At=+Pt.currentTarget.value;isNaN(At)||At>=oe.yH||St(Pe(At))}})]})]})]})},Le={metricModal:"metric-modal",searchMetric:"search-metric",searchWithMetadata:"search-with-metadata",selectType:"select-type",metricCard:"metric-card",useMetric:"use-metric",searchPage:"search-page",resultsPerPage:"results-per-page",setUseBackend:"set-use-backend",showAdditionalSettings:"show-additional-settings"},Ye=(0,M.Z0)({name:"metrics-modal-state",initialState:(0,oe.ue)(),reducers:{filterMetricsBackend:(he,Ce)=>{he.metrics=Ce.payload.metrics,he.filteredMetricCount=Ce.payload.filteredMetricCount,he.isLoading=Ce.payload.isLoading},buildMetrics:(he,Ce)=>{he.isLoading=Ce.payload.isLoading,he.metrics=Ce.payload.metrics,he.hasMetadata=Ce.payload.hasMetadata,he.metaHaystackDictionary=Ce.payload.metaHaystackDictionary,he.nameHaystackDictionary=Ce.payload.nameHaystackDictionary,he.totalMetricCount=Ce.payload.totalMetricCount,he.filteredMetricCount=Ce.payload.filteredMetricCount},setIsLoading:(he,Ce)=>{he.isLoading=Ce.payload},setFilteredMetricCount:(he,Ce)=>{he.filteredMetricCount=Ce.payload},setResultsPerPage:(he,Ce)=>{he.resultsPerPage=Ce.payload},setPageNum:(he,Ce)=>{he.pageNum=Ce.payload},setFuzzySearchQuery:(he,Ce)=>{he.fuzzySearchQuery=Ce.payload,he.pageNum=1},setNameHaystack:(he,Ce)=>{he.nameHaystackOrder=Ce.payload[0],he.nameHaystackMatches=Ce.payload[1]},setMetaHaystack:(he,Ce)=>{he.metaHaystackOrder=Ce.payload[0],he.metaHaystackMatches=Ce.payload[1]},setFullMetaSearch:(he,Ce)=>{he.fullMetaSearch=Ce.payload,he.pageNum=1},setIncludeNullMetadata:(he,Ce)=>{he.includeNullMetadata=Ce.payload,he.pageNum=1},setSelectedTypes:(he,Ce)=>{he.selectedTypes=Ce.payload,he.pageNum=1},setUseBackend:(he,Ce)=>{he.useBackend=Ce.payload,he.fullMetaSearch=!1,he.pageNum=1},setDisableTextWrap:he=>{he.disableTextWrap=!he.disableTextWrap},showAdditionalSettings:he=>{he.showAdditionalSettings=!he.showAdditionalSettings}}}),{setIsLoading:je,buildMetrics:Ze,filterMetricsBackend:Ne,setResultsPerPage:Pe,setPageNum:Ue,setFuzzySearchQuery:$e,setNameHaystack:ze,setMetaHaystack:qe,setFullMetaSearch:dt,setIncludeNullMetadata:vt,setSelectedTypes:yt,setUseBackend:st,setDisableTextWrap:Ve,showAdditionalSettings:pe,setFilteredMetricCount:Ee}=Ye.actions,me=" ",ve=1e3;function Se({datasource:he,query:Ce,onChange:We,onGetMetrics:et,labelsFilters:rt,metricLookupDisabled:nt,onBlur:gt,variableEditor:xt}){const St=(0,p.of)(Ie),[zt,Nt]=(0,r.useState)({}),Vt=d.$.featureToggles.prometheusMetricEncyclopedia,en=[{value:"BrowseMetrics",label:"Metrics explorer",description:"Browse and filter all metrics and metadata with a fuzzy search"}],Je=(0,r.useCallback)((fn,Rn)=>{const Kn=fn.label??fn.value;return Kn?Kn.toLowerCase?Rn.split(me).reduce((an,tn)=>{const Cn=Kn.toLowerCase().includes(tn.toLowerCase());let xn=!1;return Vt&&(xn=Kn==="Metrics explorer"),an&&(Cn||xn)},!0):!0:!1},[Vt]),ct=(0,r.useCallback)((fn,Rn)=>fn.__isNew__?fn.label:(0,t.jsx)(a(),{searchWords:Rn.inputValue.split(me),textToHighlight:fn.label??"",highlightClassName:St.highlight}),[St.highlight]),ot=(fn,Rn)=>{const Kn=(0,b.b4)(fn);return Oe(Kn,Rn)},Qe=fn=>he.metricFindQuery(ot(fn,rt)).then(Kn=>{const Bt=Kn.length;(0,P.ky)(Kn),Bt>Kn.length?Nt({...zt,resultsTruncated:!0}):Nt({...zt,resultsTruncated:!1});const an=Kn.map(tn=>({label:tn.text,value:tn.text}));return Vt?[...en,...an]:an}),pt=()=>Promise.resolve([]),Pt=s()(fn=>Qe(fn),he.getDebounceTimeInMilliseconds()),At=fn=>{const Rn=fn.data;if(Rn.value==="BrowseMetrics"){const Kn=fn.isFocused?St.focus:"";return(0,t.jsx)("div",{...fn.innerProps,ref:fn.innerRef,className:`${St.customOptionWidth} metric-encyclopedia-open`,"data-testid":o.Tp.components.Select.option,onKeyDown:Bt=>{Bt.code==="Enter"&&Nt({...zt,metricsModalOpen:!0})},children:(0,t.jsxs)("div",{className:`${St.customOption} ${Kn} metric-encyclopedia-open`,children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"metric-encyclopedia-open",children:Rn.label}),(0,t.jsx)("div",{className:`${St.customOptionDesc} metric-encyclopedia-open`,children:Rn.description})]}),(0,t.jsxs)(m.$n,{fill:"text",size:"sm",variant:"secondary",onClick:()=>Nt({...zt,metricsModalOpen:!0}),className:"metric-encyclopedia-open",children:["Open",(0,t.jsx)(v.I,{name:"arrow-right"})]})]})})}return(0,l.o5)(fn)},mn=({children:fn,maxHeight:Rn,innerRef:Kn,innerProps:Bt})=>{const an=(0,p.$j)(),tn=(0,y.J)(an),Cn=!r.isValidElement(fn)&&zt.resultsTruncated;return(0,t.jsxs)("div",{...Bt,className:`${tn.menu} ${St.customMenuContainer}`,style:{maxHeight:Math.round(Rn*.9)},"aria-label":"Select options menu",children:[(0,t.jsx)(u.E,{scrollRefCallback:Kn,autoHide:!1,autoHeightMax:"inherit",hideHorizontalTrack:!0,showScrollIndicators:!0,children:fn}),Cn&&(0,t.jsx)("div",{className:St.customMenuFooter,children:(0,t.jsx)("div",{children:"Only the top 1000 metrics are displayed in the metric select. Use the metrics explorer to view all metrics."})})]})},Pn=()=>(0,t.jsx)(D.DW,{"data-testid":o.Tp.components.DataSource.Prometheus.queryEditor.builder.metricSelect,isClearable:!!xt,inputId:"prometheus-metric-select",className:St.select,value:Ce.metric?(0,c.z)(Ce.metric):void 0,placeholder:"Select metric",allowCustomValue:!0,formatOptionLabel:ct,filterOption:Je,minMenuHeight:250,onOpenMenu:async()=>{if(nt)return;Nt({isLoading:!0});const fn=await et(),Rn=fn.map(Bt=>Bt.value),Kn=fn.length;fn.length>ve&&(0,P.ky)(fn),Nt(Vt?{metrics:[...en,...fn],isLoading:void 0,initialMetrics:Rn,resultsTruncated:Kn>fn.length}:{metrics:fn,isLoading:void 0,resultsTruncated:Kn>fn.length})},loadOptions:nt?pt:Pt,isLoading:zt.isLoading,defaultOptions:zt.metrics??Array.from(new Array(25),()=>({value:""})),onChange:fn=>{const Rn=fn?.value;Rn?Vt&&Rn==="BrowseMetrics"?(q("grafana_prometheus_metric_encyclopedia_open",null,"",Ce),Nt({...zt,metricsModalOpen:!0})):We({...Ce,metric:Rn}):We({...Ce,metric:""})},components:Vt?{Option:At,MenuList:mn}:{MenuList:mn},onBlur:gt});return(0,t.jsxs)(t.Fragment,{children:[Vt&&!he.lookupsDisabled&&zt.metricsModalOpen&&(0,t.jsx)(Te,{datasource:he,isOpen:zt.metricsModalOpen,onClose:()=>Nt({...zt,metricsModalOpen:!1}),query:Ce,onChange:We,initialMetrics:zt.initialMetrics??[]}),xt?(0,t.jsx)(E.C,{children:(0,t.jsx)(x.I,{label:"Metric",labelWidth:20,tooltip:(0,t.jsx)("div",{children:"Optional: returns a list of label values for the label name in the specified metric."}),children:Pn()})}):(0,t.jsx)(h.B,{children:(0,t.jsx)(f.c,{label:"Metric",children:Pn()})})]})}const Ie=he=>({select:(0,n.css)({minWidth:"125px"}),highlight:(0,n.css)({label:"select__match-highlight",background:"inherit",padding:"inherit",color:he.colors.warning.contrastText,backgroundColor:he.colors.warning.main}),customOption:(0,n.css)({padding:"8px",display:"flex",justifyContent:"space-between",cursor:"pointer",":hover":{backgroundColor:he.colors.emphasize(he.colors.background.primary,.1)}}),customOptionlabel:(0,n.css)({color:he.colors.text.primary}),customOptionDesc:(0,n.css)({color:he.colors.text.secondary,fontSize:he.typography.size.xs,opacity:"50%"}),focus:(0,n.css)({backgroundColor:he.colors.emphasize(he.colors.background.primary,.1)}),customOptionWidth:(0,n.css)({minWidth:"400px"}),customMenuFooter:(0,n.css)({flex:0,display:"flex",justifyContent:"space-between",padding:he.spacing(1.5),borderTop:`1px solid ${he.colors.border.weak}`,color:he.colors.text.secondary}),customMenuContainer:(0,n.css)({display:"flex",flexDirection:"column",background:he.colors.background.primary,boxShadow:he.shadows.z3})}),Oe=(he,Ce)=>{const We=Ce?Re(Ce):[];return`label_values({__name__=~".*${he}"${We?We.join(""):""}},__name__)`},Re=he=>he.map(Ce=>`,${Ce.label}="${Ce.value}"`)},29993:(k,R,e)=>{"use strict";e.d(R,{I:()=>I});var t=e(74848),n=e(96540),i=e(50556),s=e(81996),r=e(32370),g=e(26115),a=e(32196),c=e(2543),o=e(85269),h=e(97801),f=e(81580),d=e(39268),p=e(76892),m=e(76459),v=e.n(m),l=e(50877),y=e(13544),u=e(81392),D=e(3721),E=e(90182);function x({item:C,defaultOp:S,onChange:A,onDelete:L,onGetLabelNames:N,onGetLabelValues:F,invalidLabel:w,invalidValue:B,getLabelValuesAutofillSuggestions:U,debounceDuration:K}){const[V,H]=(0,n.useState)({}),[Y,X]=(0,n.useState)(!1),[J,q]=(0,n.useState)(!1),[ae,j]=(0,n.useState)([]),te=(se=C.op)=>P.find(ie=>ie.label===se)?.isMultiValue,ne=se=>{if(se){const ie=/\(([^)]+)\)/,Z=se?.match(ie);return Z&&Z[0].indexOf("|")>0?[se]:se.indexOf("|")>0?se.split("|"):[se]}return[]},le=v()(se=>U(se,C.label),K),z=v()(se=>{const ie=ae.filter(Z=>Z.value.includes(se));return(0,s.ky)(ie)},K),ee=C?.value??"";return(0,t.jsx)("div",{"data-testid":"prometheus-dimensions-filter-item",children:(0,t.jsxs)(u.M,{children:[(0,t.jsx)(E.DW,{placeholder:"Select label","data-testid":y.Tp.components.QueryBuilder.labelSelect,inputId:"prometheus-dimensions-filter-item-key",width:"auto",value:C.label?(0,l.z)(C.label):null,allowCustomValue:!0,onOpenMenu:async()=>{H({isLoadingLabelNames:!0});const se=await N(C);j(se),X(!0);const ie=(0,s.ky)(se);H({labelNames:ie,isLoadingLabelNames:void 0})},onCloseMenu:()=>{X(!1)},isOpen:Y,isLoading:V.isLoadingLabelNames??!1,loadOptions:z,defaultOptions:V.labelNames,onChange:se=>{se.label&&A({...C,op:C.op??S,label:se.label})},invalid:w}),(0,t.jsx)(E.l6,{"data-testid":y.Tp.components.QueryBuilder.matchOperatorSelect,className:"query-segment-operator",value:(0,l.z)(C.op??S),options:P,width:"auto",onChange:se=>{se.value!=null&&A({...C,op:se.value,value:te(se.value)?C.value:ne(C?.value)[0]})}}),(0,t.jsx)(E.DW,{placeholder:"Select value","data-testid":y.Tp.components.QueryBuilder.valueSelect,inputId:"prometheus-dimensions-filter-item-value",width:"auto",value:te()?ne(ee).map(l.z):ne(ee).map(l.z)[0],allowCustomValue:!0,formatCreateLabel:se=>se,createOptionPosition:C.op?.includes("~")?"first":"last",onOpenMenu:async()=>{H({isLoadingLabelValues:!0});const se=await F(C);(0,s.ky)(se),q(!0),H({...V,labelValues:se,isLoadingLabelValues:void 0})},onCloseMenu:()=>{q(!1)},isOpen:J,defaultOptions:V.labelValues,isMulti:te(),isLoading:V.isLoadingLabelValues,loadOptions:le,onChange:se=>{if(se.value)A({...C,value:se.value,op:C.op??S});else{const ie=se.map(Z=>Z.label).join("|");A({...C,value:ie,op:C.op??S})}},invalid:B}),(0,t.jsx)(D.Z,{"aria-label":`remove-${C.label}`,icon:"times",variant:"secondary",onClick:L})]})},ee)}const P=[{label:"=",value:"=",isMultiValue:!1},{label:"!=",value:"!=",isMultiValue:!1},{label:"=~",value:"=~",isMultiValue:!0},{label:"!~",value:"!~",isMultiValue:!0}],b="Select at least 1 label filter (label and value)";function M({labelsFilters:C,onChange:S,onGetLabelNames:A,onGetLabelValues:L,labelFilterRequired:N,getLabelValuesAutofillSuggestions:F,debounceDuration:w,variableEditor:B}){const U="=",[K,V]=(0,n.useState)([{op:U}]);(0,n.useEffect)(()=>{C.length>0?V(C):V([{op:U}])},[C]);const H=J=>{V(J);const q=J.filter(ae=>ae.label!=null&&ae.value!=null);(0,c.isEqual)(q,C)||S(q)},Y=K.some(J=>J.label&&J.value),X=()=>(0,t.jsx)(o.o,{items:K,onChange:H,renderItem:(J,q,ae)=>(0,t.jsx)(x,{debounceDuration:w,item:J,defaultOp:U,onChange:q,onDelete:ae,onGetLabelNames:A,onGetLabelValues:L,invalidLabel:N&&!J.label,invalidValue:N&&!J.value,getLabelValuesAutofillSuggestions:F})});return(0,t.jsx)(t.Fragment,{children:B?(0,t.jsx)(d.C,{children:(0,t.jsxs)("div",{className:(0,a.cx)((0,a.css)({display:"flex"})),children:[(0,t.jsx)(p.c,{width:20,tooltip:(0,t.jsx)("div",{children:"Optional: used to filter the metric select for this query type."}),children:"Label filters"}),X()]})}):(0,t.jsx)(h.B,{children:(0,t.jsx)(f.c,{label:"Label filters",error:b,invalid:N&&!Y,children:X()})})})}var O=e(9103);function I({datasource:C,query:S,onChange:A,onBlur:L,variableEditor:N}){const F=X=>{A({...S,labels:X})},w=(0,n.useCallback)(async X=>{const J=C.getVariables(),q=await X;return[...J.map(ae=>({label:ae,value:ae})),...q.map(ae=>({label:ae.value,value:ae.value,title:ae.description}))]},[C]),B=async X=>{if(!S.metric)return await C.languageProvider.fetchLabels(),C.languageProvider.getLabelKeys().map(j=>({value:j}));const J=S.labels.filter(j=>j!==X);J.push({label:"__name__",op:"=",value:S.metric});const q=r.z.renderLabels(J);let ae=await C.languageProvider.fetchLabelsWithMatch(q);return Object.keys(ae).filter(j=>!J.find(te=>te.label===j)).map(j=>({value:j}))},U=(X,J)=>{const q={label:J??"__name__",op:"=~",value:(0,g.b4)(`.*${X}`)},ae=S.labels.filter(le=>le.label!==q.label);ae.push(q),S.metric&&ae.push({label:"__name__",op:"=",value:S.metric});const j=ae.map(le=>({...le,label:C.interpolateString(le.label),value:C.interpolateString(le.value)})),te=r.z.renderLabels(j);let ne;return C.hasLabelsMatchAPISupport()?ne=V(q,te):ne=K(q,te),ne.then(le=>((0,s.ky)(le),le))},K=(X,J)=>{if(!X.label)return Promise.resolve([]);const q=C.languageProvider.fetchSeries(J),ae=C.interpolateString(X.label);return q.then(j=>{const te=new Set;return j.forEach(ne=>{const le=ne[ae];te.add(le)}),Array.from(te).map(ne=>({label:ne,value:ne}))})},V=(X,J)=>{if(!X.label)return Promise.resolve([]);const q=`[${C.uid}][${S.metric}][${X.label}][${X.op}]`;return C.languageProvider.fetchSeriesValuesWithMatch(X.label,J,q).then(ae=>ae.map(j=>({value:j,label:j})))},H=async X=>{if(!X.label)return[];if(!S.metric)return(await C.languageProvider.getLabelValues(X.label)).map(j=>({value:j}));const J=S.labels.filter(j=>j!==X);J.push({label:"__name__",op:"=",value:S.metric});const q=J.map(j=>({...j,label:C.interpolateString(j.label),value:C.interpolateString(j.value)})),ae=r.z.renderLabels(q);return C.hasLabelsMatchAPISupport()?V(X,ae):K(X,ae)},Y=(0,n.useCallback)(()=>w(T(C,S)),[C,S,w]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(O.dm,{query:S,onChange:A,onGetMetrics:Y,datasource:C,labelsFilters:S.labels,metricLookupDisabled:C.lookupsDisabled,onBlur:L||(()=>{}),variableEditor:N}),(0,t.jsx)(M,{debounceDuration:C.getDebounceTimeInMilliseconds(),getLabelValuesAutofillSuggestions:U,labelsFilters:S.labels,onChange:F,onGetLabelNames:X=>w(B(X)),onGetLabelValues:X=>w(H(X)),variableEditor:N})]})}async function T(C,S){C.languageProvider.metricsMetadata||await C.languageProvider.loadMetricsMetadata(),C.languageProvider.metricsMetadata||(C.languageProvider.metricsMetadata={});let A;if(S.labels.length>0){const L=r.z.renderLabels(S.labels);A=(await C.languageProvider.getSeries(L,!0)).__name__??[]}else A=await C.languageProvider.getLabelValues("__name__")??[];return A.map(L=>({value:L,description:(0,i.xB)(L,C.languageProvider.metricsMetadata)}))}},26432:(k,R,e)=>{"use strict";e.d(R,{W:()=>h,i:()=>f});var t=e(74848),n=e(96540),i=e(67061),s=e(20719),r=e(32370),g=e(76040),a=e(27994),c=e(96625),o=e(3884);const h="Fetch all series matching metric name and label filters.",f=(0,n.memo)(({query:d})=>{const p=(0,g.u)(d||"").query,m={grammar:s.Ay,name:"promql"};return(0,t.jsxs)(i.B,{gap:.5,direction:"column",children:[(0,t.jsx)(a.r,{stepNumber:1,title:(0,t.jsx)(o.Z,{query:`${p.metric} ${r.z.renderLabels(p.labels)}`,lang:m}),children:h}),(0,t.jsx)(c.k,{stepNumber:2,queryModeller:r.z,query:p,lang:m})]})});f.displayName="PromQueryBuilderExplained"},80109:(k,R,e)=>{"use strict";e.d(R,{$:()=>a});var t=e(74848),n=e(32196),i=e(13544),s=e(40845),r=e(7338),g=e(26432);function a(o){const{query:h,datasource:f,range:d,onRunQuery:p,onChange:m,data:v,app:l,showExplain:y}=o,u=(0,s.of)(c);return(0,t.jsxs)("div",{"data-testid":i.Tp.components.DataSource.Prometheus.queryEditor.code.queryField,className:u.wrapper,children:[(0,t.jsx)(r.L,{datasource:f,query:h,range:d,onRunQuery:p,onChange:m,history:[],data:v,app:l}),y&&(0,t.jsx)(g.i,{query:h.expr})]})}const c=o=>({wrapper:(0,n.css)({".gf-form":{marginBottom:0}})})},78036:(k,R,e)=>{"use strict";e.d(R,{J3:()=>t,mt:()=>s,ue:()=>i,yH:()=>n});const t=100,n=1e3;function i(r){return{isLoading:!0,metrics:[],hasMetadata:!0,metaHaystackDictionary:{},metaHaystackMatches:[],metaHaystackOrder:[],nameHaystackDictionary:{},nameHaystackOrder:[],nameHaystackMatches:[],totalMetricCount:0,filteredMetricCount:null,resultsPerPage:t,pageNum:1,fuzzySearchQuery:"",fullMetaSearch:r?.fullMetaSearch??!1,includeNullMetadata:r?.includeNullMetadata??!0,selectedTypes:[],useBackend:r?.useBackend??!1,disableTextWrap:r?.disableTextWrap??!1,showAdditionalSettings:!1}}function s(r){return{useBackend:r?.useBackend??!1,disableTextWrap:r?.disableTextWrap??!1,fullMetaSearch:r?.fullMetaSearch??!1,includeNullMetadata:r.includeNullMetadata??!1}}},1220:(k,R,e)=>{"use strict";e.d(R,{DQ:()=>m,G3:()=>y,Kl:()=>f,OS:()=>v,iZ:()=>p,jC:()=>u,jY:()=>a,kf:()=>c,nU:()=>h,z2:()=>l});var t=e(2543),n=e.n(t),i=e(55127),s=e.n(i),r=e(38961),g=e(15145);function a(I,T,C){const S=d(I,T,C),A=I.id+"(";return C&&S.push(C),A+S.join(", ")+")"}function c(I,T,C){const S=d(I,T,C),A=I.id+"(";return C&&S.unshift(C),A+S.join(", ")+")"}function o(I,T,C,S){if(T.params.length<2)throw`Cannot render a function with params of length [${T.params.length}]`;let A=(I.params??[])[0]??"5m";const L=d({...I,params:I.params.slice(1)},{...T,params:T.params.slice(1),defaultParams:T.defaultParams.slice(1)},C),N=I.id+"(";return C&&(S?L.push(`${C}[${A}]`):L.unshift(`${C}[${A}]`)),N+L.join(", ")+")"}function h(I,T,C){return o(I,T,C,!1)}function f(I,T,C){return o(I,T,C,!0)}function d(I,T,C){return(I.params??[]).map((S,A)=>T.params[A].type==="string"?'"'+S+'"':S)}function p(I,T){const C={id:I.id,params:I.defaultParams};return{...T,operations:[...T.operations,C]}}function m(I){return(0,t.capitalize)(I.replace(/_/g," "))}function v(I,T){return`operations.${I}.param.${T}`}function l(I=!1){const T=[{label:"$__interval",value:"$__interval"},{label:"1m",value:"1m"},{label:"5m",value:"5m"},{label:"10m",value:"10m"},{label:"1h",value:"1h"},{label:"24h",value:"24h"}];return I&&T.unshift({label:"$__rate_interval",value:"$__rate_interval"}),{name:"Range",type:"string",options:T}}function y(I,T={}){return[{id:I,name:m(I),params:[{name:"By label",type:"string",restParam:!0,optional:!0}],defaultParams:[],alternativesKey:"plain aggregations",category:g.Ag.Aggregations,renderer:a,paramChangedHandler:M(`__${I}_by`),explainHandler:x(I,""),addOperationHandler:p,...T},{id:`__${I}_by`,name:`${m(I)} by`,params:[{name:"Label",type:"string",restParam:!0,optional:!0,editor:r.r}],defaultParams:[""],alternativesKey:"aggregations by",category:g.Ag.Aggregations,renderer:D(I),paramChangedHandler:b(I),explainHandler:x(I,"by"),addOperationHandler:p,hideFromList:!0,...T},{id:`__${I}_without`,name:`${m(I)} without`,params:[{name:"Label",type:"string",restParam:!0,optional:!0,editor:r.r}],defaultParams:[""],alternativesKey:"aggregations by",category:g.Ag.Aggregations,renderer:E(I),paramChangedHandler:b(I),explainHandler:x(I,"without"),addOperationHandler:p,hideFromList:!0,...T}]}function u(I,T,C={}){const S=y(I,C);return S[0].params.unshift(...T.params),S[1].params.unshift(...T.params),S[2].params.unshift(...T.params),S[0].defaultParams=T.defaultParams,S[1].defaultParams=[...T.defaultParams,""],S[2].defaultParams=[...T.defaultParams,""],S[1].renderer=P(I),S[2].renderer=P(I),S}function D(I){return function(C,S,A){return`${I} by(${C.params.join(", ")}) (${A})`}}function E(I){return function(C,S,A){return`${I} without(${C.params.join(", ")}) (${A})`}}function x(I,T){return function(S){const A=S.params.map(N=>`\`${N}\``).join(" and "),L=s()("label",S.params.length);switch(T){case"by":return`Calculates ${I} over dimensions while preserving ${L} ${A}.`;case"without":return`Calculates ${I} over the dimensions ${A}. All other labels are preserved.`;default:return`Calculates ${I} over the dimensions.`}}}function P(I){return function(C,S,A){const L=S.params.findIndex(w=>w.restParam),N=C.params.slice(0,L),F=C.params.slice(L);return`${I} by(${F.join(", ")}) (${N.map((w,B)=>S.params[B].type==="string"?`"${w}"`:w).join(", ")}, ${A})`}}function b(I){return function(C,S,A){return S.params.length<A.params.length?{...S,id:I}:S}}function M(I){return function(C,S,A){return S.params.length===A.params.length?{...S,id:I}:S}}function O(I,T){if(!I.label||!I.op||!I.value||T.length<2)return!1;const C=I.op.toString().startsWith("!");return T.filter(L=>L.label===I.label&&L.value===I.value&&L.op!==I.op).some(L=>!!(C&&L?.op?.toString().startsWith("!")===!1||C===!1&&L?.op?.toString().startsWith("!")))}},76040:(k,R,e)=>{"use strict";e.d(R,{u:()=>s});var t=e(84555),n=e(75161),i=e(26115);function s(l){const y=(0,i.qk)(l),D=t.K3.parse(y).topNode,x={query:{metric:"",labels:[],operations:[]},errors:[]};try{g(y,D,x)}catch(P){console.error(P),P instanceof Error&&x.errors.push({text:P.message})}return v(x.query)&&(x.errors=[]),r(l)&&(x.errors=[]),x}function r(l){const y={query:{metric:"",labels:[],operations:[]},errors:[]};l=l.replace(/\$__interval/g,"1s"),l=l.replace(/\$__interval_ms/g,"1000"),l=l.replace(/\$__rate_interval/g,"1s"),l=l.replace(/\$__range_ms/g,"1000"),l=l.replace(/\$__range_s/g,"1"),l=l.replace(/\$__range/g,"1s");const D=t.K3.parse(l).topNode;try{g(l,D,y)}catch{return!1}return y.errors.length===0}function g(l,y,u){const D=u.query;switch(y.type.id){case t.gw:{D.metric=(0,i.AA)(l,y);break}case t.BG:{D.labels.push(c(l,y));const E=y.getChild(i.Ql);E&&u.errors.push((0,i.xz)(l,E));break}case t.R6:{h(l,y,u);break}case t.Fn:{f(l,y,u);break}case t.df:{p(l,y,u);break}case i.Ql:{if(a(y))break;u.errors.push((0,i.xz)(l,y));break}default:{y.type.id===t.ek&&u.errors.push((0,i.xz)(l,y));let E=y.firstChild;for(;E;)g(l,E,u),E=E.nextSibling}}}function a(l){return l.prevSibling?.firstChild?.type.id===t.Fb}function c(l,y){const u=(0,i.AA)(l,y.getChild(t.IC)),D=(0,i.AA)(l,y.getChild(t.Lf)),E=(0,i.AA)(l,y.getChild(t.LW)).replace(/^["'`]|["'`]$/g,"");return{label:u,op:D,value:E}}const o=["changes","rate","irate","increase","delta"];function h(l,y,u){const D=u.query,E=y.getChild(t.m3),x=(0,i.AA)(l,E),P=y.getChild(t.Dh),b=[];let M="";if(o.includes(x)||x.endsWith("_over_time")){let I=(0,i.AA)(l,y).match(/\[(.+)\]/);I?.[1]&&(M=I[1],b.push(I[1]))}const O={id:x,params:b};if(D.operations.unshift(O),P){if((0,i.AA)(l,P)==="(["+M+"])")return;d(l,P,u,O)}}function f(l,y,u){const D=u.query,E=y.getChild(t.xb);let x=(0,i.AA)(l,E);const P=y.getChild(t.hI),b=[];P&&(P.getChild("By")&&x&&(x=`__${x}_by`),P.getChild(t.xB)&&(x=`__${x}_without`),b.push(...(0,i.R1)(l,P,t.IC)));const M=y.getChild(t.Dh),O={id:x,params:[]};D.operations.unshift(O),d(l,M,u,O),O.params.push(...b)}function d(l,y,u,D){if(y)switch(y.type.id){case t.Dh:{let E=y.firstChild;for(;E;){let x;E.type.id===t.df?x=E:x=E.getChild(t.df),x&&u.errors.push({text:"Query parsing is ambiguous.",from:x.from,to:x.to}),d(l,E,u,D),E=E.nextSibling}break}case t.Po:{D.params.push(parseFloat((0,i.AA)(l,y)));break}case t.LW:{D.params.push((0,i.AA)(l,y).replace(/"/g,""));break}default:g(l,y,u)}}function p(l,y,u){const D=u.query,E=y.firstChild,x=(0,i.AA)(l,E.nextSibling),P=m(l,y.getChild(t.eM)??y.getChild(t.Ue)),b=y.lastChild,M=n.AE[x],O=E.type.id===t.Po,I=b.type.id===t.Po,T=b.type.id===t.df;if(O||g(l,E,u),I)D.operations.push((0,i.rq)(M,l,b,!!P?.isBool));else if(T){const C=(0,i.z9)(b);C?.type.id===t.Po&&D.operations.push((0,i.rq)(M,l,C,!!P?.isBool)),g(l,b,u)}else{D.binaryQueries=D.binaryQueries||[];const C={operator:x,query:{metric:"",labels:[],operations:[]}};P?.isMatcher&&(C.vectorMatchesType=P.matchType,C.vectorMatches=P.matches),D.binaryQueries.push(C),g(l,b,{query:C.query,errors:u.errors})}}function m(l,y){if(y){if(y.getChild("Bool"))return{isBool:!0,isMatcher:!1};{let u="";const D=y.getChild(t.x$);return D&&(u=(0,i.R1)(l,D,t.IC).join(", ")),{isMatcher:!0,isBool:!1,matches:u,matchType:y.getChild(t.On)?"on":"ignoring"}}}}function v(l){return l.labels.length===0&&l.operations.length===0&&!l.metric}},26115:(k,R,e)=>{"use strict";e.d(R,{AA:()=>c,Ql:()=>t,R1:()=>h,b4:()=>f,qk:()=>r,rq:()=>o,xz:()=>i,z9:()=>n});const t=0;function n(d){return d.firstChild?n(d.firstChild):d}function i(d,p){return{text:c(d,p),from:p.from,to:p.to,parentType:p.parent?.name}}const s=/\$(\w+)|\[\[([\s\S]+?)(?::(\w+))?\]\]|\${(\w+)(?:\.([^:^\}]+))?(?::([^\}]+))?}/g;function r(d){return d.replace(s,(p,m,v,l,y,u,D)=>{const E=l||D;let x=m,P="0";return v&&(x=v,P="1"),y&&(x=y,P="2"),`__V_${P}__`+x+"__V__"+(E?"__F__"+E+"__F__":"")})}const g=[(d,p)=>`$${d}`,(d,p)=>`[[${d}${p?`:${p}`:""}]]`,(d,p)=>`\${${d}${p?`:${p}`:""}}`];function a(d){return d.replace(/__V_(\d)__(.+?)__V__(?:__F__(\w+)__F__)?/g,(p,m,v,l)=>g[parseInt(m,10)](v,l))}function c(d,p){return p?a(d.substring(p.from,p.to)):""}function o(d,p,m,v){const l=[parseFloat(c(p,m))];return d.comparison&&l.push(v),{id:d.id,params:l}}function h(d,p,m){if(p.type.id===m)return[c(d,p)];const v=[];let l=0,y=p.childAfter(l);for(;y;)v.push(...h(d,y,m)),l=y.to,y=p.childAfter(l);return v}const f=d=>d.split(" ").map(m=>`${m}.*`).join("")},27994:(k,R,e)=>{"use strict";e.d(R,{r:()=>r});var t=e(74848),n=e(32196),i=e(36663),s=e(40845);function r({title:a,stepNumber:c,markdown:o,children:h}){const f=(0,s.of)(g);return(0,t.jsxs)("div",{className:f.box,children:[c!==void 0&&(0,t.jsx)("div",{className:f.stepNumber,children:c}),(0,t.jsxs)("div",{className:f.boxInner,children:[a&&(0,t.jsx)("div",{className:f.header,children:(0,t.jsx)("span",{children:a})}),(0,t.jsxs)("div",{className:f.body,children:[o&&(0,t.jsx)("div",{dangerouslySetInnerHTML:{__html:(0,i.G)(o)}}),h]})]})]})}const g=a=>({box:(0,n.css)({background:a.colors.background.secondary,padding:a.spacing(1),borderRadius:a.shape.radius.default,position:"relative"}),boxInner:(0,n.css)({marginLeft:a.spacing(4)}),stepNumber:(0,n.css)({fontWeight:a.typography.fontWeightMedium,background:a.colors.secondary.main,width:"20px",height:"20px",borderRadius:a.shape.radius.circle,display:"flex",alignItems:"center",justifyContent:"center",position:"absolute",top:"10px",left:"11px",fontSize:a.typography.bodySmall.fontSize}),header:(0,n.css)({paddingBottom:a.spacing(.5),display:"flex",alignItems:"center",fontFamily:a.typography.fontFamilyMonospace}),body:(0,n.css)({color:a.colors.text.secondary,"p:last-child":{margin:0},a:{color:a.colors.text.link,textDecoration:"underline"}})})},96625:(k,R,e)=>{"use strict";e.d(R,{k:()=>s});var t=e(74848),n=e(27994),i=e(3884);function s({query:r,queryModeller:g,stepNumber:a,lang:c,onMouseEnter:o,onMouseLeave:h}){return(0,t.jsx)(t.Fragment,{children:r.operations.map((f,d)=>{const p=g.getOperationDef(f.id);if(!p)return`Operation ${f.id} not found`;const m=p.renderer(f,p,"<expr>"),v=p.explainHandler?p.explainHandler(f,p):p.documentation??"no docs";return(0,t.jsx)("div",{onMouseEnter:()=>o?.(f,d),onMouseLeave:()=>h?.(f,d),children:(0,t.jsx)(n.r,{stepNumber:d+a,title:(0,t.jsx)(i.Z,{query:m,lang:c}),markdown:v})},d)})})}},3884:(k,R,e)=>{"use strict";e.d(R,{Z:()=>g});var t=e(74848),n=e(32196),i=e(28848),s=e.n(i),r=e(40845);function g({query:c,lang:o,className:h}){const f=(0,r.$j)(),d=a(f),p=s().highlight(c,o.grammar,o.name);return(0,t.jsx)("div",{className:(0,n.cx)(d.editorField,"prism-syntax-highlight",h),"aria-label":"selector",dangerouslySetInnerHTML:{__html:p}})}const a=c=>({editorField:(0,n.css)({fontFamily:c.typography.fontFamilyMonospace,fontSize:c.typography.bodySmall.fontSize})})},15145:(k,R,e)=>{"use strict";e.d(R,{Ag:()=>t,jN:()=>n,n5:()=>i});var t=(s=>(s.Aggregations="Aggregations",s.RangeFunctions="Range functions",s.Functions="Functions",s.BinaryOps="Binary operations",s.Trigonometric="Trigonometric",s.Time="Time Functions",s))(t||{}),n=(s=>(s.Abs="abs",s.Absent="absent",s.AbsentOverTime="absent_over_time",s.Acos="acos",s.Acosh="acosh",s.Asin="asin",s.Asinh="asinh",s.Atan="atan",s.Atanh="atanh",s.Avg="avg",s.AvgOverTime="avg_over_time",s.BottomK="bottomk",s.Ceil="ceil",s.Changes="changes",s.Clamp="clamp",s.ClampMax="clamp_max",s.ClampMin="clamp_min",s.Cos="cos",s.Cosh="cosh",s.Count="count",s.CountOverTime="count_over_time",s.CountScalar="count_scalar",s.CountValues="count_values",s.DayOfMonth="day_of_month",s.DayOfWeek="day_of_week",s.DayOfYear="day_of_year",s.DaysInMonth="days_in_month",s.Deg="deg",s.Delta="delta",s.Deriv="deriv",s.DropCommonLabels="drop_common_labels",s.Exp="exp",s.Floor="floor",s.Group="group",s.HistogramQuantile="histogram_quantile",s.HistogramAvg="histogram_avg",s.HistogramCount="histogram_count",s.HistogramSum="histogram_sum",s.HistogramFraction="histogram_fraction",s.HistogramStddev="histogram_stddev",s.HistogramStdvar="histogram_stdvar",s.HoltWinters="holt_winters",s.Hour="hour",s.Idelta="idelta",s.Increase="increase",s.Irate="irate",s.LabelJoin="label_join",s.LabelReplace="label_replace",s.Last="last",s.LastOverTime="last_over_time",s.Ln="ln",s.Log10="log10",s.Log2="log2",s.Max="max",s.MaxOverTime="max_over_time",s.Min="min",s.MinOverTime="min_over_time",s.Minute="minute",s.Month="month",s.Pi="pi",s.PredictLinear="predict_linear",s.Present="present",s.PresentOverTime="present_over_time",s.Quantile="quantile",s.QuantileOverTime="quantile_over_time",s.Rad="rad",s.Rate="rate",s.Resets="resets",s.Round="round",s.Scalar="scalar",s.Sgn="sgn",s.Sin="sin",s.Sinh="sinh",s.Sort="sort",s.SortDesc="sort_desc",s.Sqrt="sqrt",s.Stddev="stddev",s.StddevOverTime="stddev_over_time",s.Sum="sum",s.SumOverTime="sum_over_time",s.Tan="tan",s.Tanh="tanh",s.Time="time",s.Timestamp="timestamp",s.TopK="topk",s.Vector="vector",s.Year="year",s.Addition="__addition",s.Subtraction="__subtraction",s.MultiplyBy="__multiply_by",s.DivideBy="__divide_by",s.Modulo="__modulo",s.Exponent="__exponent",s.NestedQuery="__nested_query",s.EqualTo="__equal_to",s.NotEqualTo="__not_equal_to",s.GreaterThan="__greater_than",s.LessThan="__less_than",s.GreaterOrEqual="__greater_or_equal",s.LessOrEqual="__less_or_equal",s))(n||{}),i=(s=>(s.Rate="rate",s.Histogram="histogram",s.Binary="binary",s))(i||{})},33115:(k,R,e)=>{"use strict";e.d(R,{$i:()=>a,Dr:()=>r});var t=e(70416),n=e(47232),i=e(77678),s=e(67414);const r="10m",g=c=>`${c.type}|${c.name}|${JSON.stringify(c.labels??"")}`;class a{constructor(o){this.cache=new Map;const h=o.overlapString;if((0,t.di)(h)){const f=(0,t.E9)(h);this.overlapWindowMs=(0,t.WT)(f)}else{const f=(0,t.E9)(r);this.overlapWindowMs=(0,t.WT)(f)}this.getTargetSignature=o.getTargetSignature}requestInfo(o){const h=o.range.from.valueOf(),f=o.range.to.valueOf(),d=o.rangeRaw?.to?.toString()==="now";let p=d,m;const v=new Map;o.targets.forEach(l=>{let y=`${o.dashboardUID}|${o.panelId}|${l.refId}`,u=this.getTargetSignature(o,l);v.set(y,u)});for(const[l,y]of v){let u=this.cache.get(l);if(u?.sig!==y?p=!1:(m=u?.prevTo??1/0,p=f>m&&h<=m),!p)break}if(p&&m){let l=Math.max(m-this.overlapWindowMs,h);const y=(0,n.KQ)(f),u=(0,n.KQ)((0,i.rs)(l,o.intervalMs));o={...o,range:{...o.range,from:u,to:y}}}else v.forEach((l,y)=>{this.cache.delete(y)});return{requests:[o],targSigs:v,shouldCache:d}}procFrames(o,h,f){if(h?.shouldCache){const d=o.range.from.valueOf(),p=o.range.to.valueOf(),m=new Map;f.forEach(l=>{let y=`${o.dashboardUID}|${o.panelId}|${l.refId}`,u=m.get(y);u||(u=[],m.set(y,u)),u.push(l)});let v=[];m.forEach((l,y)=>{let u=(y?this.cache.get(y)?.frames:null)??[];l.forEach(E=>{if(E.length===0||E.fields.length===0)return;let x=g(E.fields[1]),P=u.find(b=>g(b.fields[1])===x);if(!P)u.push(E);else{let b=P.fields.map(I=>I.values),M=E.fields.map(I=>I.values),O=(0,s.c)(b,M);if(O){for(let I=0;I<O.length;I++)P.fields[I].values=O[I];P.length=P.fields[0].values.length}}});let D=[];u.forEach(E=>{let x=E.fields.map(b=>b.values),P=(0,s.F)(x,d,p);if(P[0].length>0){for(let b=0;b<P.length;b++)E.fields[b].values=P[b];D.push(E)}}),this.cache.set(y,{sig:h.targSigs.get(y),frames:D,prevTo:p}),v.push(...D)}),f=v.map(l=>({...l,fields:l.fields.map(y=>({...y,config:{...y.config},values:y.values.slice()}))}))}return f}}},59809:(k,R,e)=>{"use strict";e.d(R,{Bm:()=>O,J3:()=>m,L:()=>I,hF:()=>P});var t=e(2543),n=e.n(t),i=e(41987),s=e(41260),r=e(11261),g=e(28240),a=e(52622),c=e(57875),o=e(32264),h=e(19347);const f=/^[+-]?inf(?:inity)?$/i,d=(T,C)=>C.app===i.Jk.Explore&&(T.meta?.custom?.resultType==="vector"||T.meta?.custom?.resultType==="scalar")?!0:C.targets.find(A=>A.refId===T.refId)?.format==="table",p=(T,C)=>T.meta?.type===s.m.HeatmapCells?!1:C.targets.find(A=>A.refId===T.refId)?.format==="heatmap";function m(T,C,S){o.$.featureToggles.prometheusDataplane&&T.data.forEach(q=>{const ae=C.targets.find(j=>j.refId===q.refId);ae&&ae.legendFormat==="__auto"&&q.fields.forEach(j=>{if(j.labels?.__name__&&j.labels?.__name__===j.name){const te={...j,name:r.Bc};j.config.displayNameFromDS=(0,g.Ct)(te,q,T.data)}})});const[A,L]=(0,t.partition)(T.data,q=>d(q,C)),N=l(A),[F,w]=(0,t.partition)(L,q=>q.meta?.custom?.resultType==="exemplar"),{exemplarTraceIdDestinations:B}=S,U=F.map(q=>{if(B?.length)for(const ae of B){const j=q.fields.find(te=>te.name===ae.name);if(j){const te=u(ae);j.config.links=j.config.links?.length?[...j.config.links,...te]:te}}return{...q,meta:{...q.meta,dataTopic:a.QR.Annotations}}}),[K,V]=(0,t.partition)(w,q=>p(q,C));K.forEach(q=>{if(q.name==null){let ae=q.fields.find(j=>j.type===r.PU.number);if(ae){let j=ae.labels?.le;j&&(q.name=j,ae.config.displayNameFromDS=j)}}});const H=(0,t.groupBy)(K,q=>q.refId);let Y=[];for(const q in H){const ae=H[q],j=(0,t.groupBy)(ae,te=>{const ne=te.fields.find(le=>le.type===r.PU.number);if(ne?.labels&&v in ne.labels){const{le,...z}=ne?.labels;return Object.values(z).join()}return Object.values(ne?.labels??[]).join()});(0,t.forOwn)(j,(te,ne)=>{const le=te.sort(O);Y.push(b(M(le)))})}const X=V.map(q=>({...q,meta:{...q.meta,preferredVisualisationType:"graph"}})),J=(0,t.flatten)(Y);return{...T,data:[...X,...N,...J,...U]}}const v="le";function l(T){if(T.length===0||T.length===1&&T[0].length===0)return T;const C=(0,t.groupBy)(T,"refId"),S=Object.keys(C);return S.map(L=>{const N=y(S.length,L),F=x({data:[],valueName:N}),w=E([]),B=[];C[L].forEach(K=>{const H=K.fields[1]?.labels??{};Object.keys(H).sort().forEach(Y=>{if(!B.some(X=>X.name===Y)){const X=Y===v;B.push({name:Y,config:{filterable:!0},type:X?r.PU.number:r.PU.string,values:[]})}})}),C[L].forEach(K=>{const V=K.fields[0]?.values??[],H=K.fields[1]?.values??[];V.forEach(Y=>w.values.push(Y)),H.forEach(Y=>{F.values.push(I(Y));const X=K.fields[1].labels??{};B.forEach(J=>J.values.push(D(X,J.name)))})});const U=[w,...B,F];return{refId:L,fields:U,meta:{...C[L][0].meta,preferredVisualisationType:"rawPrometheus"},length:w.values.length}})}function y(T,C=""){return T>1?`Value #${C}`:"Value"}function u(T){const C=[];if(T.datasourceUid){const A=(0,h.l)().getInstanceSettings(T.datasourceUid);A&&C.push({title:T.urlDisplayLabel||`Query with ${A?.name}`,url:"",internal:{query:{query:"${__value.raw}",queryType:"traceql"},datasourceUid:T.datasourceUid,datasourceName:A?.name??"Data source not found"}})}return T.url&&C.push({title:T.urlDisplayLabel||`Go to ${T.url}`,url:T.url,targetBlank:!0}),C}function D(T,C){return T.hasOwnProperty(C)?C===v?I(T[C]):T[C]:""}function E(T,C=!1){return{name:r.LE,type:r.PU.time,config:{},values:T.map(S=>C?S[0]:S[0]*1e3)}}function x({data:T,valueName:C=r.Bc,parseValue:S=!0,labels:A,displayNameFromDS:L}){return{name:C,type:r.PU.number,display:(0,c.J)(),config:{displayNameFromDS:L},labels:A,values:T.map(N=>S?I(N[1]):N[1])}}function P(T){const C=T.__name__||"";delete T.__name__;const S=Object.entries(T).map(A=>`${A[0]}="${A[1]}"`).join(",");return`${C}{${S}}`}function b(T){if(T.length===0||T.length===1&&T[0].length===0)return[];const C=T[0].fields.find(A=>A.type===r.PU.time),S=T.map(A=>{let L=A.fields.find(N=>N.type===r.PU.number);return{...L,name:L.config.displayNameFromDS}});return[{...T[0],meta:{...T[0].meta,type:s.m.HeatmapRows},fields:[C,...S]}]}function M(T){for(let C=T.length-1;C>0;C--){const S=T[C].fields.find(L=>L.type===r.PU.number),A=T[C-1].fields.find(L=>L.type===r.PU.number);if(!S||!A)throw new Error("Prometheus heatmap transform error: data should be a time series");for(let L=0;L<S.values.length;L++){const N=A.values[L]||[0];S.values[L]-=N,S.values[L]<1e-9&&(S.values[L]=0)}}return T}function O(T,C){let S,A;try{S=I(T.fields[1].state?.displayName??T.name??T.fields[1].name),A=I(C.fields[1].state?.displayName??C.name??C.fields[1].name)}catch(L){return console.error(L),0}return S>A?1:S<A?-1:0}function I(T){return f.test(T)?T[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY:parseFloat(T)}},62183:(k,R,e)=>{"use strict";e.d(R,{B4:()=>s,N1:()=>n,fD:()=>t,m_:()=>i});var t=(r=>(r.Low="Low",r.Medium="Medium",r.High="High",r.None="None",r))(t||{}),n=(r=>(r.Cortex="Cortex",r.Mimir="Mimir",r.Prometheus="Prometheus",r.Thanos="Thanos",r))(n||{}),i=(r=>(r.Auto="__auto",r.Verbose="__verbose",r.Custom="__custom",r))(i||{}),s=(r=>(r[r.LabelNames=0]="LabelNames",r[r.LabelValues=1]="LabelValues",r[r.MetricNames=2]="MetricNames",r[r.VarQueryResult=3]="VarQueryResult",r[r.SeriesQuery=4]="SeriesQuery",r[r.ClassicQuery=5]="ClassicQuery",r))(s||{})},27642:(k,R,e)=>{"use strict";e.d(R,{L:()=>n,y:()=>i});var t=e(32264);function n(s){return{grafana_version:t.$.buildInfo.version,plugin_type:String(s.type),plugin_version:s.info.version,plugin_id:s.id,plugin_name:s.name}}function i(s){return{...n(s.meta),datasource_uid:s.uid}}},44027:(k,R,e)=>{"use strict";e.d(R,{G:()=>a});var t=e(96540),n=e(92470),i=e(95187),s=e(14110),r=e(27642);const g="grafana_plugin_";function a(){const o=(0,n.Q)();return(0,t.useMemo)(()=>{const h=(0,i.S)(o)?(0,r.y)(o.instanceSettings):(0,r.L)(o.meta);return(f,d)=>{if(!c(f))throw new Error(`Interactions reported in plugins should start with: "${g}".`);return(0,s.rR)(f,{...d,...h})}},[o])}function c(o){return o.startsWith(g)&&o.length>g.length}},61298:(k,R,e)=>{"use strict";e.d(R,{fX:()=>i,nB:()=>n,n_:()=>t,p6:()=>s});var t=(r=>(r.DashboardView="dashboard-view",r.DataRequest="data-request",r))(t||{});const n=r=>!!r.payload.page,i=r=>!!r.payload.interactionName,s=r=>!!r.payload.experimentId},14110:(k,R,e)=>{"use strict";e.d(R,{G$:()=>s,Jy:()=>r,Xp:()=>a,rR:()=>g});var t=e(32264),n=e(39601),i=e(63415);const s=c=>{(0,i.x$)().addEvent({type:i.on.MetaAnalytics,payload:c})},r=()=>{const c=n.Ny.getLocation(),o=`${t.$.appSubUrl??""}${c.pathname}${c.search}${c.hash}`;(0,i.x$)().addEvent({type:i.on.Pageview,payload:{page:o}})},g=(c,o)=>{t.$.reportingStaticContext&&t.$.reportingStaticContext instanceof Object&&(o={...o,...t.$.reportingStaticContext}),(0,i.x$)().addEvent({type:i.on.Interaction,payload:{interactionName:c,properties:o}})},a=(c,o,h)=>{(0,i.x$)().addEvent({type:i.on.ExperimentView,payload:{experimentId:c,experimentGroup:o,experimentVariant:h}})}},55882:(k,R,e)=>{"use strict";e.d(R,{s:()=>f});var t=e(74848),n=e(96540),i=e(22391),s=e(51527),r=e(13544),g=e(90182),a=e(67061),c=e(98624),o=e(19347),h=e(26657);class f extends n.PureComponent{constructor(p){super(p),this.dataSourceSrv=(0,o.l)(),this.state={},this.onChange=(m,v)=>{if(v.action==="clear"&&this.props.onClear){this.props.onClear();return}const l=this.dataSourceSrv.getInstanceSettings(m.value);l&&(this.props.onChange(l),this.setState({error:void 0}))}}static{this.defaultProps={autoFocus:!1,openMenuOnFocus:!1,placeholder:"Select data source"}}componentDidMount(){const{current:p}=this.props;this.dataSourceSrv.getInstanceSettings(p)||this.setState({error:"Could not find data source "+p})}getCurrentValue(){const{current:p,hideTextValue:m,noDefault:v}=this.props;if(!p&&v)return;const l=this.dataSourceSrv.getInstanceSettings(p);if(l)return{label:l.name.slice(0,37),value:l.uid,imgUrl:l.meta.info.logos.small,hideText:m,meta:l.meta};const y=(0,i.Iz)(p);return y===h.dR.uid||y===h.dR.name?{label:y,value:y,hideText:m}:{label:(y??"no name")+" - not found",value:y??void 0,imgUrl:"",hideText:m}}getDataSourceOptions(){const{alerting:p,tracing:m,metrics:v,mixed:l,dashboard:y,variables:u,annotations:D,pluginId:E,type:x,filter:P,logs:b}=this.props;return this.dataSourceSrv.getList({alerting:p,tracing:m,metrics:v,logs:b,dashboard:y,mixed:l,variables:u,annotations:D,pluginId:E,filter:P,type:x}).map(O=>({value:O.name,label:`${O.name}${O.isDefault?" (default)":""}`,imgUrl:O.meta.info.logos.small,meta:O.meta}))}render(){const{autoFocus:p,onBlur:m,onClear:v,openMenuOnFocus:l,placeholder:y,width:u,inputId:D,disabled:E=!1,isLoading:x=!1}=this.props,{error:P}=this.state,b=this.getDataSourceOptions(),M=this.getCurrentValue(),O=typeof v=="function";return(0,t.jsx)("div",{"aria-label":"Data source picker select container","data-testid":r.Tp.components.DataSourcePicker.container,children:(0,t.jsx)(g.l6,{isLoading:x,disabled:E,"aria-label":"Select a data source","data-testid":r.Tp.components.DataSourcePicker.inputV2,inputId:D||"data-source-picker",className:"ds-picker select-container",isMulti:!1,isClearable:O,backspaceRemovesValue:!1,onChange:this.onChange,options:b,autoFocus:p,onBlur:m,width:u,openMenuOnFocus:l,maxMenuHeight:500,placeholder:y,noOptionsMessage:"No datasources found",value:M??null,invalid:!!P||!!this.props.invalid,getOptionLabel:I=>I.meta&&(0,s.x)(I.meta.signature)&&I!==M?(0,t.jsxs)(a.B,{alignItems:"center",justifyContent:"space-between",children:[(0,t.jsx)("span",{children:I.label})," ",(0,t.jsx)(c.B,{status:I.meta.signature})]}):I.label||""})})}}},96937:(k,R,e)=>{"use strict";e.d(R,{f:()=>t,p:()=>n});let t=()=>{throw new Error("EmbeddedDashboard requires runtime initialization")};function n(i){t=i}},97152:(k,R,e)=>{"use strict";e.d(R,{a:()=>n,e:()=>i});var t=e(74848);let n=({message:s})=>(0,t.jsxs)("div",{children:["Unable to render data: ",s,"."]});function i(s){n=s}},24308:(k,R,e)=>{"use strict";e.d(R,{Y:()=>i,m:()=>n});var t=e(74848);let n=()=>(0,t.jsx)("div",{children:"PanelRenderer can only be used after Grafana instance has been started."});function i(s){n=s}},46235:(k,R,e)=>{"use strict";e.d(R,{V:()=>n,l:()=>i});var t=e(74848);let n=({children:s})=>(0,t.jsx)("div",{children:s});function i(s){n=s}},32264:(k,R,e)=>{"use strict";e.d(R,{$:()=>h,p:()=>r});var t=e(2543),n=e.n(t),i=e(42994),s=e(97594);class r{constructor(d){this.publicDashboardsEnabled=!0,this.snapshotEnabled=!0,this.datasources={},this.panels={},this.apps={},this.auth={},this.minRefreshInterval="",this.appUrl="",this.appSubUrl="",this.namespace="default",this.windowTitlePrefix="",this.newPanelTitle="",this.externalUserMngLinkUrl="",this.externalUserMngLinkName="",this.externalUserMngInfo="",this.allowOrgCreate=!1,this.feedbackLinksEnabled=!0,this.disableLoginForm=!1,this.defaultDatasource="",this.angularSupportEnabled=!1,this.authProxyEnabled=!1,this.exploreEnabled=!1,this.queryHistoryEnabled=!1,this.helpEnabled=!1,this.profileEnabled=!1,this.newsFeedEnabled=!0,this.ldapEnabled=!1,this.jwtHeaderName="",this.jwtUrlLogin=!1,this.sigV4AuthEnabled=!1,this.azureAuthEnabled=!1,this.secureSocksDSProxyEnabled=!1,this.samlEnabled=!1,this.samlName="",this.autoAssignOrg=!0,this.verifyEmailEnabled=!1,this.oauth={},this.rbacEnabled=!0,this.disableUserSignUp=!1,this.loginHint="",this.passwordHint="",this.loginError=void 0,this.viewersCanEdit=!1,this.editorsCanAdmin=!1,this.disableSanitizeHtml=!1,this.trustedTypesDefaultPolicyEnabled=!1,this.cspReportOnlyEnabled=!1,this.liveEnabled=!0,this.featureToggles={},this.anonymousEnabled=!1,this.anonymousDeviceLimit=void 0,this.licenseInfo={},this.rendererAvailable=!1,this.rendererVersion="",this.rendererDefaultImageWidth=1e3,this.rendererDefaultImageHeight=500,this.rendererDefaultImageScale=1,this.secretsManagerPluginEnabled=!1,this.supportBundlesEnabled=!1,this.http2Enabled=!1,this.grafanaJavascriptAgent={enabled:!1,customEndpoint:"",apiKey:"",errorInstrumentalizationEnabled:!0,consoleInstrumentalizationEnabled:!1,webVitalsInstrumentalizationEnabled:!1,tracingInstrumentalizationEnabled:!1},this.pluginCatalogURL="https://grafana.com/grafana/plugins/",this.pluginAdminEnabled=!0,this.pluginAdminExternalManageEnabled=!1,this.pluginCatalogHiddenPlugins=[],this.pluginCatalogManagedPlugins=[],this.pluginsCDNBaseURL="",this.expressionsEnabled=!1,this.awsAllowedAuthProviders=[],this.awsAssumeRoleEnabled=!1,this.azure={managedIdentityEnabled:!1,workloadIdentityEnabled:!1,userIdentityEnabled:!1,userIdentityFallbackCredentialsEnabled:!1,azureEntraPasswordCredentialsEnabled:!1},this.caching={enabled:!1},this.unifiedAlertingEnabled=!1,this.unifiedAlerting={minInterval:"",alertStateHistoryBackend:void 0,alertStateHistoryPrimary:void 0},this.recordedQueries={enabled:!0},this.featureHighlights={enabled:!1},this.reporting={enabled:!0},this.analytics={enabled:!0},this.googleAnalytics4SendManualPageViews=!1,this.sqlConnectionLimits={maxOpenConns:100,maxIdleConns:100,connMaxLifetime:14400},this.disableFrontendSandboxForPlugins=[],this.cloudMigrationFeedbackURL="",this.cloudMigrationPollIntervalMs=2e3,this.exploreDefaultTimeOffset="1h",this.bootData=d.bootData;const p={datasources:{},windowTitlePrefix:"Grafana - ",panels:{},newPanelTitle:"Panel Title",playlist_timespan:"1m",unsaved_changes_warning:!0,appUrl:"",appSubUrl:"",buildInfo:{version:"1.0",commit:"1",env:"production"},viewersCanEdit:!1,editorsCanAdmin:!1,disableSanitizeHtml:!1};(0,t.merge)(this,p,d),this.buildInfo=d.buildInfo||p.buildInfo,this.dateFormats&&i.WC.update(this.dateFormats),a(this),g(this),this.featureToggles.disableAngular&&(this.angularSupportEnabled=!1),this.theme2=(0,s.g)(this.bootData.user.theme),this.bootData.user.lightTheme=this.theme2.isLight,this.theme=this.theme2.v1}}function g(f){const d=f.featureToggles,m=window.localStorage.getItem("grafana.featureToggles");if(m){const v=m.split(",");for(const l of v){const[y,u]=l.split("="),D=u==="true"||u==="1";d[y]=D,console.log(`Setting feature toggle ${y} = ${D} via localstorage`)}}}function a(f){if(window.location.href.indexOf("__feature")===-1)return;const d=f.buildInfo.env==="development",p=new Set(["queryServiceFromUI","dashboardSceneSolo"]);new URLSearchParams(window.location.search).forEach((v,l)=>{if(l.startsWith("__feature.")){const y=f.featureToggles,u=l.substring(10),D=v==="true"||v==="";D!==y[l]&&(d||p.has(u)?(y[u]=D,console.log(`Setting feature toggle ${u} = ${D} via url`)):console.log(`Unable to change feature toggle ${u} via url in production.`))}})}const c=window.grafanaBootData||{settings:{},user:{},navTree:[]},o=c.settings;o.bootData=c;const h=new r(o)},7117:(k,R,e)=>{"use strict";e.r(R),e.d(R,{CopyPanelEvent:()=>h.ah,DataSourcePicker:()=>S.s,DataSourceWithBackend:()=>P.iy,EchoEventType:()=>r.on,EmbeddedDashboard:()=>w.f,FakeEchoSrv:()=>r.c_,GrafanaBootConfig:()=>l.p,HealthCheckError:()=>P.b1,HealthStatus:()=>P.VQ,HistoryWrapper:()=>o.K9,LocationServiceProvider:()=>o._K,MetaAnalyticsEventName:()=>y.n_,PanelDataErrorView:()=>O.a,PanelRenderer:()=>M.m,PluginPage:()=>C.V,RefreshEvent:()=>h._,StreamingFrameAction:()=>c.Kh,ThemeChangedEvent:()=>h.E8,TimeRangeUpdatedEvent:()=>h.sR,config:()=>l.$,createDataSourcePluginEventProperties:()=>A.y,createMonitoringLogger:()=>x.DW,createPluginEventProperties:()=>A.L,createQueryRunner:()=>T.d,featureEnabled:()=>E.a,frameToMetricFindValue:()=>b.$h,getAngularLoader:()=>n.E,getAppEvents:()=>h.J7,getBackendSrv:()=>t.AI,getDataSourceSrv:()=>i.l,getEchoSrv:()=>r.x$,getGrafanaLiveSrv:()=>c.oF,getLegacyAngularInjector:()=>a.C,getLocationSrv:()=>s.X,getPluginComponentExtensions:()=>f.Dp,getPluginExtensions:()=>f.O3,getPluginImportUtils:()=>u.o,getPluginLinkExtensions:()=>f.Kf,getRunRequest:()=>T.XJ,getTemplateSrv:()=>g.w,hasAllPermissions:()=>V,hasAnyPermission:()=>H,hasPermission:()=>U,hasPermissionInMetadata:()=>K,isExperimentViewEvent:()=>y.p6,isExpressionReference:()=>P.s9,isFetchError:()=>t.NF,isInteractionEvent:()=>y.fX,isPageviewEvent:()=>y.nB,isPluginExtensionComponent:()=>m.a,isPluginExtensionLink:()=>m.D,loadPluginCss:()=>u.PL,locationSearchToObject:()=>o.SE,locationService:()=>o.Ny,logDebug:()=>x.MD,logError:()=>x.vV,logInfo:()=>x.fH,logWarning:()=>x.FF,navigationLogger:()=>o.Lc,registerEchoBackend:()=>r.pl,reportExperimentView:()=>D.Xp,reportInteraction:()=>D.rR,reportMetaAnalytics:()=>D.G$,reportPageview:()=>D.Jy,setAngularLoader:()=>n.w,setAppEvents:()=>h.H8,setBackendSrv:()=>t.u5,setChromeHeaderHeightHook:()=>F._,setCurrentUser:()=>v.l,setDataSourceSrv:()=>i.h,setEchoSrv:()=>r.H2,setEmbeddedDashboard:()=>w.p,setGrafanaLiveSrv:()=>c.S8,setLegacyAngularInjector:()=>a.j,setLocationService:()=>o.vG,setLocationSrv:()=>s.T,setPluginComponentHook:()=>p.A,setPluginExtensionGetter:()=>f.cE,setPluginExtensionsHook:()=>d.Vu,setPluginImportUtils:()=>u.se,setQueryRunnerFactory:()=>T.HC,setReturnToPreviousHook:()=>N._,setRunRequest:()=>T.pC,setTemplateSrv:()=>g.d,toDataQueryError:()=>I.u,toDataQueryResponse:()=>b.bE,useChromeHeaderHeight:()=>F.k,useLocationService:()=>o.at,usePluginComponent:()=>p.S,usePluginComponentExtensions:()=>d.kr,usePluginComponents:()=>d.f_,usePluginExtensions:()=>d.pc,usePluginInteractionReporter:()=>L.G,usePluginLinkExtensions:()=>d.vl,usePluginLinks:()=>d.Ux,useReturnToPrevious:()=>N.i});var t=e(17172),n=e(7376),i=e(19347),s=e(23509),r=e(63415),g=e(72574),a=e(81634),c=e(78731),o=e(39601),h=e(3591),f=e(4402),d=e(3197),p=e(79396),m=e(80882),v=e(61706),l=e(32264),y=e(61298),u=e(89191),D=e(14110),E=e(33378),x=e(34867),P=e(26657),b=e(47773),M=e(24308),O=e(97152),I=e(12091),T=e(63639),C=e(46235),S=e(55882),A=e(27642),L=e(44027),N=e(14778),F=e(23172),w=e(96937),B=e(29263);const U=Y=>(0,B.ZU)(Y,(0,v.H)()),K=(Y,X)=>(0,B.T6)(Y,X),V=Y=>(0,B.Fj)(Y,(0,v.H)()),H=Y=>(0,B.jW)(Y,(0,v.H)())},7376:(k,R,e)=>{"use strict";e.d(R,{E:()=>i,w:()=>n});let t;function n(s){t=s}function i(){return t}},63415:(k,R,e)=>{"use strict";e.d(R,{H2:()=>i,c_:()=>g,on:()=>t,pl:()=>r,x$:()=>s});var t=(a=>(a.Performance="performance",a.MetaAnalytics="meta-analytics",a.Pageview="pageview",a.Interaction="interaction",a.ExperimentView="experimentview",a.GrafanaJavascriptAgent="grafana-javascript-agent",a))(t||{});let n;function i(a){if(n instanceof g)for(const c of n.buffer)a.addEvent(c.event,c.meta);n=a}function s(){return n||(n=new g),n}const r=a=>{s().addBackend(a)};class g{constructor(){this.buffer=[]}flush(){this.buffer=[]}addBackend(c){}addEvent(c,o){this.buffer.push({event:c,meta:o})}}},39601:(k,R,e)=>{"use strict";e.d(R,{K9:()=>o,Lc:()=>m,Ny:()=>f,SE:()=>h,_K:()=>y,at:()=>l,vG:()=>d});var t=e(74848),n=e(17929),i=e(96540),s=e(76885),r=e(95344),g=e(91040),a=e(40621),c=e(32264);class o{constructor(D){this.history=D||n.zR({basename:c.$.appSubUrl??"/"}),this.partial=this.partial.bind(this),this.push=this.push.bind(this),this.replace=this.replace.bind(this),this.getSearch=this.getSearch.bind(this),this.getHistory=this.getHistory.bind(this),this.getLocation=this.getLocation.bind(this)}getHistory(){return this.history}getSearch(){return new URLSearchParams(this.history.location.search)}partial(D,E){const x=this.history.location,P=this.getSearchObject();for(const M in D)D[M]===null||D[M]===void 0?delete P[M]:P[M]=D[M];const b=s.kM.renderUrl(x.pathname,P);E?this.history.replace(b,this.history.location.state):this.history.push(b,this.history.location.state)}push(D){this.history.push(D)}replace(D){this.history.replace(D)}reload(){const D=this.history.location.state?.routeReloadCounter;this.history.replace({...this.history.location,state:{routeReloadCounter:D?D+1:1}})}getLocation(){return this.history.location}getSearchObject(){return h(this.history.location.search)}update(D){if((0,r.l)("LocationSrv","update","partial, push or replace"),D.partial&&D.query)this.partial(D.query,D.partial);else{const E={pathname:D.path};D.query&&(E.search=s.kM.toUrlParams(D.query)),D.replace?this.replace(E):this.push(E)}}}function h(u){let D=typeof u=="number"?String(u):u;return D.length>0?D.startsWith("?")?s.kM.parseKeyValue(D.substring(1)):s.kM.parseKeyValue(D):{}}let f=new o;const d=u=>{throw new Error("locationService can be only overriden in test environment")},p=(0,g.h)("Router"),m=p.logger;(0,a.h)("location",f,p);const v=i.createContext(void 0);function l(){const u=(0,i.useContext)(v);if(!u)throw new Error("useLocationService must be used within a LocationServiceProvider");return u}const y=({service:u,children:D})=>(0,t.jsx)(v.Provider,{value:u,children:D})},23509:(k,R,e)=>{"use strict";e.d(R,{T:()=>n,X:()=>i});let t;function n(s){t=s}function i(){return t}},63639:(k,R,e)=>{"use strict";e.d(R,{HC:()=>n,XJ:()=>g,d:()=>i,pC:()=>r});let t;const n=a=>{if(t)throw new Error("Runner should only be set when Grafana is starting.");t=a},i=()=>{if(!t)throw new Error("`createQueryRunner` can only be used after Grafana instance has started.");return t()};let s;function r(a){if(s)throw new Error("runRequest function should only be set once, when Grafana is starting.");s=a}function g(){if(!s)throw new Error("getRunRequest can only be used after Grafana instance has started.");return s}},3591:(k,R,e)=>{"use strict";e.d(R,{E8:()=>i,H8:()=>a,J7:()=>c,_:()=>n,ah:()=>r,sR:()=>s});var t=e(65463);class n extends t.a{static{this.type="refresh"}}class i extends t.x{static{this.type="theme-changed"}}class s extends t.x{static{this.type="time-range-updated"}}class r extends t.x{static{this.type="copy-panel"}}let g;function a(o){g=o}function c(){return g}},17172:(k,R,e)=>{"use strict";e.d(R,{AI:()=>s,NF:()=>t,u5:()=>i});function t(r){return typeof r=="object"&&r!==null&&"status"in r&&"data"in r}let n;const i=r=>{n=r},s=()=>n},19347:(k,R,e)=>{"use strict";e.d(R,{h:()=>n,l:()=>i});let t;function n(s){t=s}function i(){return t}},81634:(k,R,e)=>{"use strict";e.d(R,{C:()=>i,j:()=>n});let t;const n=s=>{t=s},i=()=>t},78731:(k,R,e)=>{"use strict";e.d(R,{Kh:()=>t.Kh,S8:()=>i,oF:()=>s});var t=e(9631);let n;const i=r=>{n=r},s=()=>n},4402:(k,R,e)=>{"use strict";e.d(R,{Dp:()=>a,Kf:()=>g,O3:()=>r,cE:()=>i});var t=e(80882);let n;function i(c){if(n)throw new Error("setPluginExtensionGetter() function should only be called once, when Grafana is starting.");n=c}function s(){if(!n)throw new Error("getPluginExtensionGetter() can only be used after the Grafana instance has started.");return n}const r=c=>s()(c),g=c=>{const{extensions:o}=r(c);return{extensions:o.filter(t.D)}},a=c=>{const{extensions:o}=r(c);return{extensions:o.filter(t.a)}}},79396:(k,R,e)=>{"use strict";e.d(R,{A:()=>n,S:()=>i});let t;function n(s){if(t)throw new Error("setPluginComponentHook() function should only be called once, when Grafana is starting.");t=s}function i(s){if(!t)throw new Error("setPluginComponentHook(options) can only be used after the Grafana instance has started.");return t(s)}},3197:(k,R,e)=>{"use strict";e.d(R,{Ux:()=>g,Vu:()=>s,f_:()=>a,kr:()=>o,pc:()=>r,vl:()=>c});var t=e(96540),n=e(80882);let i;function s(h){if(i)throw new Error("setPluginExtensionsHook() function should only be called once, when Grafana is starting.");i=h}function r(h){if(!i)throw new Error("usePluginExtensions(options) can only be used after the Grafana instance has started.");return i(h)}function g(h){const{extensions:f,isLoading:d}=r(h);return(0,t.useMemo)(()=>({links:f.filter(n.D),isLoading:d}),[f,d])}function a(h){const{extensions:f,isLoading:d}=r(h);return(0,t.useMemo)(()=>({components:f.filter(n.a).map(({component:p})=>p),isLoading:d}),[f,d])}function c(h){const{extensions:f,isLoading:d}=r(h);return(0,t.useMemo)(()=>({extensions:f.filter(n.D),isLoading:d}),[f,d])}function o(h){const{extensions:f,isLoading:d}=r(h);return(0,t.useMemo)(()=>({extensions:f.filter(n.a),isLoading:d}),[f,d])}},80882:(k,R,e)=>{"use strict";e.d(R,{D:()=>n,a:()=>i});var t=e(74135);function n(s){return s?s.type===t.u.link&&("path"in s||"onClick"in s):!1}function i(s){return s?s.type===t.u.component&&"component"in s:!1}},72574:(k,R,e)=>{"use strict";e.d(R,{d:()=>n,w:()=>i});let t;const n=s=>{t=s},i=()=>t},61706:(k,R,e)=>{"use strict";e.d(R,{H:()=>i,l:()=>n});let t=null;function n(s){if(t)throw new Error("User should only be set once, when Grafana is starting.");t=s}function i(){if(!t)throw new Error("User can only be used after Grafana instance has started.");return t}},26657:(k,R,e)=>{"use strict";e.d(R,{iy:()=>b,dR:()=>u,b1:()=>E,VQ:()=>x,s9:()=>D,ph:()=>O,x7:()=>M});var t=e(62467),n=e(75505),i=e(44240),s=e(63720),r=e(66847),g=e(40187),a=e(22391),c=e(55004),o=e(89667),h=e(92341),f=e(32264),d=e(19347),p=e(78731),m=e(17172),v=e(9631),l=e(47773);function y(I){const{intervalMs:T,maxDataPoints:C,requestId:S,panelId:A,queryCachingTTL:L,range:{from:N,to:F}}=I;if(!I.targets.length)return(0,t.of)({data:[]});const w={intervalMs:T,maxDataPoints:C,queryCachingTTL:L,timeRange:{from:N.valueOf().toString(),to:F.valueOf().toString(),timezone:I.timezone}};return(0,m.AI)().fetch({url:`/api/public/dashboards/${f.$.publicDashboardAccessToken}/panels/${A}/query`,method:"POST",data:w,requestId:S}).pipe((0,s.n)(B=>(0,t.of)((0,l.bE)(B,I.targets))),(0,r.W)(B=>(0,t.of)((0,l.bE)(B))))}const u=Object.freeze({type:"__expr__",uid:"__expr__",name:"Expression"});function D(I){if(!I)return!1;const T=typeof I=="string"?I:I.type;return T===u.type||T===u.name||T==="-100"}class E extends Error{constructor(T,C){super(T),this.details=C,this.name="HealthCheckError"}}var x=(I=>(I.Unknown="UNKNOWN",I.OK="OK",I.Error="ERROR",I))(x||{}),P=(I=>(I.PluginID="X-Plugin-Id",I.DatasourceUID="X-Datasource-Uid",I.DashboardUID="X-Dashboard-Uid",I.PanelID="X-Panel-Id",I.PanelPluginId="X-Panel-Plugin-Id",I.QueryGroupID="X-Query-Group-Id",I.FromExpression="X-Grafana-From-Expr",I.SkipQueryCache="X-Cache-Skip",I))(P||{});class b extends g.mA{constructor(T){super(T),this.streamOptionsProvider=O}query(T){if(f.$.publicDashboardAccessToken)return y(T);const{intervalMs:C,maxDataPoints:S,queryCachingTTL:A,range:L,requestId:N,hideFromInspector:F=!1}=T;let w=T.targets,B=!1;const U=new Set,K=new Set,V=w.map(J=>{let q=this.getRef(),ae=this.id,j=!0;if(D(J.datasource))return B=!0,{...J,datasource:u};if(J.datasource){const te=(0,d.l)().getInstanceSettings(J.datasource,T.scopedVars);if(!te)throw new Error(`Unknown Datasource: ${JSON.stringify(J.datasource)}`);const ne=te.rawRef??(0,a.p$)(te),le=te.id;(ne.uid!==q.uid||ae!==le)&&(q=ne,ae=le,j=!1)}return q.type?.length&&U.add(q.type),q.uid?.length&&K.add(q.uid),{...j?this.applyTemplateVariables(J,T.scopedVars,T.filters):J,datasource:q,datasourceId:ae,intervalMs:C,maxDataPoints:S,queryCachingTTL:A}});if(!V.length)return(0,t.of)({data:[]});const H={queries:V,from:L?.from.valueOf().toString(),to:L?.to.valueOf().toString()};if(f.$.featureToggles.queryOverLive)return(0,p.oF)().getQueryData({request:T,body:H});const Y={};Y["X-Plugin-Id"]=Array.from(U).join(", "),Y["X-Datasource-Uid"]=Array.from(K).join(", ");let X="/api/ds/query?ds_type="+this.type;return f.$.featureToggles.queryServiceFromUI&&(f.$.featureToggles.queryService||f.$.featureToggles.grafanaAPIServerWithExperimentalAPIs?(!B&&K.size,X=`/apis/query.grafana.app/v0alpha1/namespaces/${f.$.namespace}/query?ds_type=' + this.type`):console.warn("feature toggle queryServiceFromUI also requires the queryService to be running")),B&&(Y["X-Grafana-From-Expr"]="true",X+="&expression=true"),N&&(X+=`&requestId=${N}`),T.dashboardUID&&(Y["X-Dashboard-Uid"]=T.dashboardUID,T.panelId&&(Y["X-Panel-Id"]=`${T.panelId}`)),T.panelPluginId&&(Y["X-Panel-Plugin-Id"]=`${T.panelPluginId}`),T.queryGroupId&&(Y["X-Query-Group-Id"]=`${T.queryGroupId}`),T.skipQueryCache&&(Y["X-Cache-Skip"]="true"),(0,m.AI)().fetch({url:X,method:"POST",data:H,requestId:N,hideFromInspector:F,headers:Y}).pipe((0,s.n)(J=>{const q=(0,l.bE)(J,V);return q.data?.length&&q.data.find(ae=>ae.meta?.channel)?M(q,T,this.streamOptionsProvider):(0,t.of)(q)}),(0,r.W)(J=>(0,t.of)((0,l.bE)(J))))}getRequestHeaders(){const T={};return T["X-Plugin-Id"]=this.type,T["X-Datasource-Uid"]=this.uid,T}interpolateVariablesInQueries(T,C,S){return T.map(A=>this.applyTemplateVariables(A,C,S))}applyTemplateVariables(T,C,S){return T}async getResource(T,C,S){const A=this.getRequestHeaders();return(await(0,n.s)((0,m.AI)().fetch({...S,method:"GET",headers:S?.headers?{...S.headers,...A}:A,params:C??S?.params,url:`/api/datasources/uid/${this.uid}/resources/${T}`}))).data}async postResource(T,C,S){const A=this.getRequestHeaders();return(await(0,n.s)((0,m.AI)().fetch({...S,method:"POST",headers:S?.headers?{...S.headers,...A}:A,data:C??{...C},url:`/api/datasources/uid/${this.uid}/resources/${T}`}))).data}async callHealthCheck(){return(0,n.s)((0,m.AI)().fetch({method:"GET",url:`/api/datasources/uid/${this.uid}/health`,showErrorAlert:!1,headers:this.getRequestHeaders()})).then(T=>T.data).catch(T=>T.data)}async testDatasource(){return this.callHealthCheck().then(T=>T.status==="OK"?{status:"success",message:T.message}:Promise.reject({status:"error",message:T.message,error:new E(T.message,T.details)}))}}function M(I,T,C){const S=(0,p.oF)();if(!S)return(0,t.of)(I);const A=[],L=[];for(const N of I.data){const F=(0,c.DG)(N.meta?.channel);if(F){const w=N;L.push(S.getDataStream({addr:F,buffer:C(T,w),frame:(0,o.Nw)(N)}))}else A.push(N)}return A.length&&L.push((0,t.of)({...I,data:A})),L.length===1?L[0]:(0,i.h)(...L)}const O=(I,T)=>{const C={maxLength:I.maxDataPoints??500,action:v.Kh.Append};return I.rangeRaw?.to==="now"&&(C.maxDelta=I.range.to.valueOf()-I.range.from.valueOf()),C};b=(0,h.Y)(b)},23172:(k,R,e)=>{"use strict";e.d(R,{_:()=>n,k:()=>i});let t;const n=s=>{t=s},i=()=>(t||console.error("useChromeHeaderHeight hook not found"),t?.())},33378:(k,R,e)=>{"use strict";e.d(R,{a:()=>n});var t=e(32264);const n=i=>{const{enabledFeatures:s}=t.$.licenseInfo;return s&&s[i]}},34867:(k,R,e)=>{"use strict";e.d(R,{DW:()=>o,FF:()=>r,MD:()=>g,fH:()=>s,l$:()=>c,vV:()=>a});var t=e(32631),n=e(37930),i=e(32264);function s(h,f){i.$.grafanaJavascriptAgent.enabled&&t.P.api.pushLog([h],{level:n.$b.INFO,context:f})}function r(h,f){i.$.grafanaJavascriptAgent.enabled&&t.P.api.pushLog([h],{level:n.$b.WARN,context:f})}function g(h,f){i.$.grafanaJavascriptAgent.enabled&&t.P.api.pushLog([h],{level:n.$b.DEBUG,context:f})}function a(h,f){i.$.grafanaJavascriptAgent.enabled&&t.P.api.pushError(h,{context:f})}function c(h,f,d){i.$.grafanaJavascriptAgent.enabled&&t.P.api.pushMeasurement({type:h,values:f,context:d})}function o(h,f){const d=p=>({source:h,...f,...p});return{logDebug:(p,m)=>g(p,d(m)),logInfo:(p,m)=>s(p,d(m)),logWarning:(p,m)=>r(p,d(m)),logError:(p,m)=>a(p,d(m)),logMeasurement:(p,m,v)=>c(p,m,d(v))}}},89191:(k,R,e)=>{"use strict";e.d(R,{PL:()=>n,o:()=>r,se:()=>s});var t=e(32264);async function n(g){try{const a=t.$.bootData.user.theme==="light"?g.light:g.dark;return window.System.import(a)}catch(a){console.error(a)}}let i;function s(g){if(i)throw new Error("pluginImportUtils should only be set once, when Grafana is starting.");i=g}function r(){if(!i)throw new Error("pluginImportUtils can only be used after Grafana instance has started.");return i}},47773:(k,R,e)=>{"use strict";e.d(R,{$h:()=>f,bE:()=>a});var t=e(39070),n=e(89667),i=e(14236),s=e(11261),r=e(12091);const g={severity:"info",text:"Cached response"};function a(d,p){const m={data:[],state:t.Gu.Done},v="traceId"in d?d.traceId:void 0;v!=null&&(m.traceIds=[v]);const l=d;if(l.data?.results){const y=l.data.results,u=p?.length?p.map(x=>x.refId):Object.keys(y),D=c(l),E=[];for(const x of u){const P=y[x];P&&(P.refId=x,E.push(P))}for(const x of E){if(x.error){const P={refId:x.refId,message:x.error,status:x.status};v!=null&&(P.traceId=v),m.error||(m.error={...P}),m.errors?m.errors.push({...P}):m.errors=[{...P}],m.state=t.Gu.Error}if(x.frames?.length){for(let P of x.frames){D&&(P=o(P));const b=(0,n.or)(P);b.refId||(b.refId=x.refId),m.data.push(b)}continue}if(x.series?.length)for(const P of x.series)P.refId||(P.refId=x.refId),m.data.push((0,i.Vc)(P));if(x.tables?.length)for(const P of x.tables)P.refId||(P.refId=x.refId),m.data.push((0,i.Vc)(P))}}return l.status&&l.status!==200&&(m.state!==t.Gu.Error&&(m.state=t.Gu.Error),m.error||(m.error=(0,r.u)(d))),m}function c(d){const p=d?.headers;return!p||!p.get?!1:p.get("X-Cache")==="HIT"}function o(d){return{...d,schema:{...d.schema,fields:[...d.schema?.fields??[]],meta:{...d.schema?.meta,notices:[...d.schema?.meta?.notices??[],g],isCachedResponse:!0}}}}function h(d){const p=a(d);if(p.error?.data?.message)return{status:"error",message:p.error.data.message,details:p.error?.data?.error?{message:p.error.data.error}:void 0};if(p.error?.refId&&p.error?.message)return{status:"error",message:p.error.message};throw d}function f(d){if(!d||!d.length)return[];const p=[];let m=d.fields.find(v=>v.type===s.PU.string);if(m||(m=d.fields.find(v=>v.type!==s.PU.time)),m)for(let v=0;v<m.values.length;v++)p.push({text:""+m.values[v]});return p}},14778:(k,R,e)=>{"use strict";e.d(R,{_:()=>n,i:()=>i});let t;const n=s=>{t=s},i=()=>t?t():()=>console.error("ReturnToPrevious hook not found")},52622:(k,R,e)=>{"use strict";e.d(R,{$N:()=>F,$l:()=>K,$m:()=>ae,$p:()=>S,CD:()=>N,D7:()=>c,F8:()=>A,GR:()=>p,J1:()=>a,L4:()=>l,Lt:()=>E,Ly:()=>b,NU:()=>m,Nj:()=>D,ON:()=>x,QH:()=>n,QR:()=>t,RU:()=>s,SV:()=>L,T6:()=>H,TZ:()=>V,WQ:()=>i,Wq:()=>X,Y$:()=>f,aG:()=>g,dx:()=>v,eX:()=>U,fY:()=>j,gs:()=>u,lm:()=>M,ob:()=>Y,on:()=>y,qM:()=>q,q_:()=>r,uH:()=>o,vM:()=>h,vp:()=>le,wV:()=>I,xB:()=>w,yL:()=>d,yp:()=>C,zT:()=>te});var t=(z=>(z.AlertStates="alertStates",z.Annotations="annotations",z.Series="series",z))(t||{}),n=(z=>(z.Linear="linear",z.Quad="quad",z))(n||{}),i=(z=>(z.Clamped="clamped",z.Mod="mod",z))(i||{}),s=(z=>(z.Field="field",z.Fixed="fixed",z.Template="template",z))(s||{}),r=(z=>(z.Field="field",z.Fixed="fixed",z.Mapping="mapping",z))(r||{}),g=(z=>(z.Auto="auto",z.Coords="coords",z.Geohash="geohash",z.Lookup="lookup",z))(g||{}),a=(z=>(z.Count="count",z.Size="size",z))(a||{}),c=(z=>(z.auto="auto",z.ge="ge",z.le="le",z.unknown="unknown",z))(c||{}),o=(z=>(z.Ascending="Ascending",z.Descending="Descending",z))(o||{}),h=(z=>(z.Auto="auto",z.Bottom="bottom",z.Hidden="hidden",z.Left="left",z.Right="right",z.Top="top",z))(h||{}),f=(z=>(z.Series="series",z.Text="text",z))(f||{}),d=(z=>(z.Always="always",z.Auto="auto",z.Never="never",z))(d||{}),p=(z=>(z.Bars="bars",z.Line="line",z.Points="points",z))(p||{}),m=(z=>(z.Constant="constant",z.NegativeY="negative-Y",z))(m||{}),v=(z=>(z.Linear="linear",z.Smooth="smooth",z.StepAfter="stepAfter",z.StepBefore="stepBefore",z))(v||{}),l=(z=>(z.Linear="linear",z.Log="log",z.Ordinal="ordinal",z.Symlog="symlog",z))(l||{}),y=(z=>(z.Hue="hue",z.None="none",z.Opacity="opacity",z.Scheme="scheme",z))(y||{}),u=(z=>(z.None="none",z.Normal="normal",z.Percent="percent",z))(u||{}),D=(z=>(z[z.After=1]="After",z[z.Before=-1]="Before",z[z.Center=0]="Center",z))(D||{}),E=(z=>(z[z.Horizontal=0]="Horizontal",z[z.Vertical=1]="Vertical",z))(E||{}),x=(z=>(z[z.Down=-1]="Down",z[z.Left=-1]="Left",z[z.Right=1]="Right",z[z.Up=1]="Up",z))(x||{});const P={dash:[]};var b=(z=>(z.Area="area",z.Dashed="dashed",z.DashedAndArea="dashed+area",z.Line="line",z.LineAndArea="line+area",z.Off="off",z.Series="series",z))(b||{}),M=(z=>(z.Hidden="hidden",z.List="list",z.Table="table",z))(M||{});const O={calcs:[]};var I=(z=>(z.Auto="auto",z.Horizontal="horizontal",z.Vertical="vertical",z))(I||{});const T={timezone:[]};var C=(z=>(z.Background="background",z.BackgroundSolid="background_solid",z.None="none",z.Value="value",z))(C||{}),S=(z=>(z.Area="area",z.Line="line",z.None="none",z))(S||{}),A=(z=>(z.Auto="auto",z.Center="center",z))(A||{}),L=(z=>(z.Auto="auto",z.Name="name",z.None="none",z.Value="value",z.ValueAndName="value_and_name",z))(L||{}),N=(z=>(z.Inverted="inverted",z.SameAsValue="same_as_value",z.Standard="standard",z))(N||{}),F=(z=>(z.Multi="multi",z.None="none",z.Single="single",z))(F||{}),w=(z=>(z.Ascending="asc",z.Descending="desc",z.None="none",z))(w||{});const B={calcs:[]};var U=(z=>(z.Basic="basic",z.Gradient="gradient",z.Lcd="lcd",z))(U||{}),K=(z=>(z.Color="color",z.Hidden="hidden",z.Text="text",z))(K||{}),V=(z=>(z.Auto="auto",z.Left="left",z.Top="top",z))(V||{}),H=(z=>(z.Auto="auto",z.Manual="manual",z))(H||{}),Y=(z=>(z.Auto="auto",z.BasicGauge="basic",z.ColorBackground="color-background",z.ColorBackgroundSolid="color-background-solid",z.ColorText="color-text",z.Custom="custom",z.DataLinks="data-links",z.Gauge="gauge",z.GradientGauge="gradient-gauge",z.Image="image",z.JSONView="json-view",z.LcdGauge="lcd-gauge",z.Sparkline="sparkline",z))(Y||{}),X=(z=>(z.Basic="basic",z.Gradient="gradient",z))(X||{});const J={fields:[],reducer:[]};var q=(z=>(z.Auto="auto",z.Lg="lg",z.Md="md",z.Sm="sm",z))(q||{}),ae=(z=>(z.CSV="csv",z.Date="date",z.Distributed="distributed",z.DoubleQuote="doublequote",z.Glob="glob",z.HTML="html",z.JSON="json",z.Lucene="lucene",z.PercentEncode="percentencode",z.Pipe="pipe",z.QueryParam="queryparam",z.Raw="raw",z.Regex="regex",z.SQLString="sqlstring",z.SingleQuote="singlequote",z.Text="text",z.UriEncode="uriencode",z))(ae||{}),j=(z=>(z.exact="exact",z.none="none",z.numbers="numbers",z.signature="signature",z))(j||{}),te=(z=>(z.EQ="eq",z.GT="gt",z.GTE="gte",z.LT="lt",z.LTE="lte",z.NEQ="neq",z))(te||{});const ne={align:"auto",inspect:!1},le="browser"},33623:(k,R,e)=>{"use strict";e.d(R,{KQ:()=>i,QB:()=>s});var t=e(52622);const n="11.2.2",i={barRadius:0,barWidth:.97,fullHighlight:!1,groupWidth:.7,orientation:t.wV.Auto,showValue:t.yL.Auto,stacking:t.gs.None,xTickLabelRotation:0,xTickLabelSpacing:0},s={fillOpacity:80,gradientMode:t.on.None,lineWidth:1}},16371:(k,R,e)=>{"use strict";e.d(R,{K:()=>i});var t=e(52622);const n="11.2.2",i={displayMode:t.eX.Gradient,maxVizHeight:300,minVizHeight:16,minVizWidth:8,namePlacement:t.TZ.Auto,showUnfilled:!0,sizing:t.T6.Auto,valueMode:t.$l.Color}},37827:(k,R,e)=>{"use strict";e.d(R,{K:()=>n});const t="11.2.2",n={selectedSeries:0}},44955:(k,R,e)=>{"use strict";e.d(R,{K:()=>i});var t=e(52622);const n="11.2.2",i={minVizHeight:75,minVizWidth:75,showThresholdLabels:!1,showThresholdMarkers:!0,sizing:t.T6.Auto}},87487:(k,R,e)=>{"use strict";e.d(R,{KQ:()=>n});const t="11.2.2",n={layers:[]},i={allLayers:!0,id:"zero",lat:0,lon:0,zoom:1};var s=(g=>(g.Details="details",g.None="none",g))(s||{}),r=(g=>(g.Coords="coords",g.Fit="fit",g.Zero="zero",g))(r||{})},96529:(k,R,e)=>{"use strict";e.d(R,{KQ:()=>g});var t=e(52622);const n="11.2.2";var i=(a=>(a.Opacity="opacity",a.Scheme="scheme",a))(i||{}),s=(a=>(a.Exponential="exponential",a.Linear="linear",a))(s||{}),r=(a=>(a.X="x",a.Xy="xy",a.Y="y",a))(r||{});const g={calculate:!1,cellGap:1,cellValues:{},color:{scheme:"Oranges",fill:"dark-orange",reverse:!1,exponent:.5,steps:64},exemplars:{color:"rgba(255,0,255,0.7)"},filterValues:{le:1e-9},legend:{show:!0},selectionMode:"x",showValue:t.yL.Auto,tooltip:{mode:t.$N.Single,yHistogram:!1,showColorScale:!1}}},42226:(k,R,e)=>{"use strict";e.d(R,{KQ:()=>i,QB:()=>s});var t=e(52622);const n="11.2.2",i={bucketCount:30,bucketOffset:0},s={fillOpacity:80,gradientMode:t.on.None,lineWidth:1}},69383:(k,R,e)=>{"use strict";e.d(R,{K:()=>n});const t="11.2.2",n={showImage:!0}},65391:(k,R,e)=>{"use strict";e.d(R,{KQ:()=>g});const t="11.2.2";var n=(a=>(a.Donut="donut",a.Pie="pie",a))(n||{}),i=(a=>(a.Name="name",a.Percent="percent",a.Value="value",a))(i||{}),s=(a=>(a.Percent="percent",a.Value="value",a))(s||{});const r={values:[]},g={displayLabels:[]}},89607:(k,R,e)=>{"use strict";e.d(R,{K:()=>i});var t=e(52622);const n="11.2.2",i={colorMode:t.yp.Value,graphMode:t.$p.Area,justifyMode:t.F8.Auto,percentChangeColorMode:t.CD.Standard,showPercentChange:!1,textMode:t.SV.Auto,wideLayout:!0}},15821:(k,R,e)=>{"use strict";e.d(R,{KQ:()=>i,QB:()=>s});var t=e(52622);const n="11.2.2",i={alignValue:"left",mergeValues:!0,perPage:20,rowHeight:.9,showValue:t.yL.Auto},s={fillOpacity:70,lineWidth:0}},64337:(k,R,e)=>{"use strict";e.d(R,{KQ:()=>i,QB:()=>s});var t=e(52622);const n="11.2.2",i={colWidth:.9,rowHeight:.9,showValue:t.yL.Auto},s={fillOpacity:70,lineWidth:1}},52037:(k,R,e)=>{"use strict";e.d(R,{K:()=>i});var t=e(52622);const n="11.2.2",i={cellHeight:t.qM.Sm,footer:{show:!1,countRows:!1,reducer:[]},frameIndex:0,showHeader:!0,showTypeIcons:!1,sortBy:[]}},12183:(k,R,e)=>{"use strict";e.d(R,{KQ:()=>g});const t="11.2.2";var n=(a=>(a.Code="code",a.HTML="html",a.Markdown="markdown",a))(n||{}),i=(a=>(a.Go="go",a.Html="html",a.Json="json",a.Markdown="markdown",a.Plaintext="plaintext",a.Sql="sql",a.Typescript="typescript",a.Xml="xml",a.Yaml="yaml",a))(i||{});const s="plaintext",r={language:"plaintext",showLineNumbers:!1,showMiniMap:!1},g={content:`# Title

For markdown syntax help: [commonmark.org/help](https://commonmark.org/help/)`,mode:"markdown"}},10055:(k,R,e)=>{"use strict";e.d(R,{KQ:()=>a,QB:()=>g});var t=e(52622);const n="11.2.2";var i=(c=>(c.Auto="auto",c.Manual="manual",c))(i||{}),s=(c=>(c.Lines="lines",c.Points="points",c.PointsAndLines="points+lines",c))(s||{});const r={exclude:[]},g={label:t.yL.Auto,show:"points"},a={series:[]}},73134:(k,R,e)=>{"use strict";e.d(R,{CO:()=>g,GW:()=>b,OA:()=>D,Ol:()=>d,QB:()=>P,Yb:()=>h,Ye:()=>M,ZG:()=>c,aD:()=>i,bf:()=>s,bt:()=>E,dM:()=>m,lt:()=>l,rw:()=>r,ss:()=>x,yV:()=>y});const t={tags:[]},n={exclude:!1,ids:[]},i={list:[]},s={builtIn:0,enable:!0,hide:!1},r={includeAll:!1,multi:!1,options:[],skipUrlSync:!1};var g=(O=>(O[O.never=0]="never",O[O.onDashboardLoad=1]="onDashboardLoad",O[O.onTimeRangeChanged=2]="onTimeRangeChanged",O))(g||{}),a=(O=>(O[O.dontHide=0]="dontHide",O[O.hideLabel=1]="hideLabel",O[O.hideVariable=2]="hideVariable",O))(a||{}),c=(O=>(O[O.alphabeticalAsc=1]="alphabeticalAsc",O[O.alphabeticalCaseInsensitiveAsc=5]="alphabeticalCaseInsensitiveAsc",O[O.alphabeticalCaseInsensitiveDesc=6]="alphabeticalCaseInsensitiveDesc",O[O.alphabeticalDesc=2]="alphabeticalDesc",O[O.disabled=0]="disabled",O[O.naturalAsc=7]="naturalAsc",O[O.naturalDesc=8]="naturalDesc",O[O.numericalAsc=3]="numericalAsc",O[O.numericalDesc=4]="numericalDesc",O))(c||{});const o={asDropdown:!1,includeVars:!1,keepTime:!1,tags:[],targetBlank:!1};var h=(O=>(O.ContinuousBlPu="continuous-BlPu",O.ContinuousBlYlRd="continuous-BlYlRd",O.ContinuousBlues="continuous-blues",O.ContinuousGrYlRd="continuous-GrYlRd",O.ContinuousGreens="continuous-greens",O.ContinuousPurples="continuous-purples",O.ContinuousRdYlGr="continuous-RdYlGr",O.ContinuousReds="continuous-reds",O.ContinuousYlBl="continuous-YlBl",O.ContinuousYlRd="continuous-YlRd",O.Fixed="fixed",O.PaletteClassic="palette-classic",O.PaletteClassicByName="palette-classic-by-name",O.Shades="shades",O.Thresholds="thresholds",O))(h||{});const f={h:9,w:12,x:0,y:0};var d=(O=>(O.Absolute="absolute",O.Percentage="percentage",O))(d||{});const p={steps:[]};var m=(O=>(O.RangeToText="range",O.RegexToText="regex",O.SpecialValue="special",O.ValueToText="value",O))(m||{}),v=(O=>(O.Empty="empty",O.False="false",O.NaN="nan",O.Null="null",O.NullAndNan="null+nan",O.True="true",O))(v||{});const l={hidden:!1,refresh_intervals:["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],time_options:["5m","15m","1h","6h","12h","24h","2d","7d","30d"]};var y=(O=>(O[O.Crosshair=1]="Crosshair",O[O.Off=0]="Off",O[O.Tooltip=2]="Tooltip",O))(y||{});const u=0,D={links:[],repeatDirection:"h",targets:[],transformations:[],transparent:!1},E={overrides:[]},x={id:""},P={links:[],mappings:[]},b={collapsed:!1,panels:[]},M={editable:!0,fiscalYearStartMonth:0,graphTooltip:0,links:[],panels:[],schemaVersion:39,tags:[],timezone:"browser"}},39651:(k,R,e)=>{"use strict";e.d(R,{Gu:()=>i,gB:()=>n});var t=e(52622);const n={align:"auto",inspect:!1,cellOptions:{type:t.ob.Auto}};var i=(s=>(s.NotStarted="NotStarted",s.Loading="Loading",s.Streaming="Streaming",s.Done="Done",s.Error="Error",s))(i||{})},79422:(k,R,e)=>{"use strict";e.d(R,{Ye:()=>i,lt:()=>r,rw:()=>s,zL:()=>n});var t=e(73134),n=(p=>(p[p.dontHide=0]="dontHide",p[p.hideLabel=1]="hideLabel",p[p.hideVariable=2]="hideVariable",p))(n||{});const i=t.Ye,s={...t.rw},r=t.lt,g=t.OA,a=t.GW,c=t.QB,o=t.bt,h=t.ss,f=t.bf,d=t.aD},11807:(k,R,e)=>{"use strict";e.d(R,{l:()=>h});var t=e(74848),n=e(32196),i=e(73287),s=e(14110),r=e(40845),g=e(29158),a=e(88575),c=e(32372),o=e(94471);function h({rawSql:d,datasourceType:p}){const[m,v]=(0,i.A)(),l=(0,r.of)(f),y=D=>{v(D),(0,s.rR)("grafana_sql_preview_copied",{datasource:p})},u=(0,t.jsxs)("div",{className:l.labelWrapper,children:[(0,t.jsx)("span",{className:l.label,children:"Preview"}),(0,t.jsx)(g.K,{tooltip:"Copy to clipboard",onClick:()=>y(d),name:"copy"})]});return(0,t.jsx)(a.D,{label:u,className:l.grow,children:(0,t.jsx)(c.B,{language:"sql",height:80,value:(0,o.s)(d),monacoOptions:{scrollbar:{vertical:"hidden"},scrollBeyondLastLine:!1},readOnly:!0,showMiniMap:!1})})}function f(d){return{grow:(0,n.css)({flexGrow:1}),label:(0,n.css)({fontSize:12,fontWeight:d.typography.fontWeightMedium}),labelWrapper:(0,n.css)({display:"flex",justifyContent:"space-between",paddingBottom:d.spacing(.5)})}}},94471:(k,R,e)=>{"use strict";e.d(R,{s:()=>n});var t=e(27633);function n(i){return t.Ay.format(i).replace(/(\$ \{ .* \})|(\$ __)|(\$ \w+)/g,s=>s.replace(/\s/g,""))}},42418:(k,R,e)=>{"use strict";e.d(R,{F:()=>h});var t=e(74848),n=e(32196),i=e(96540),s=e(13544),r=e(40845),g=e(55852),a=e(14578),c=e(90613),o=e(94753);const h=i.forwardRef(({title:p,onRemove:m,children:v,buttonContent:l,elevated:y,bottomSpacing:u,topSpacing:D,className:E,severity:x="error",...P},b)=>{const M=(0,r.$j)(),I=d(M,x,!!p,y,u,D),T={error:"alert",warning:"alert",info:"status",success:"status"},C=P.role||T[x],S=P["aria-label"]||p;return(0,t.jsx)("div",{ref:b,className:(0,n.cx)(I.wrapper,E),role:C,"aria-label":S,...P,children:(0,t.jsxs)(c.a,{"data-testid":s.Tp.components.Alert.alertV2(x),display:"flex",backgroundColor:x,borderRadius:"default",paddingY:1,paddingX:2,borderStyle:"solid",borderColor:x,alignItems:"stretch",boxShadow:y?"z3":void 0,children:[(0,t.jsx)(c.a,{paddingTop:1,paddingRight:2,children:(0,t.jsx)("div",{className:I.icon,children:(0,t.jsx)(a.I,{size:"xl",name:f(x)})})}),(0,t.jsxs)(c.a,{paddingY:1,grow:1,children:[(0,t.jsx)(o.E,{color:"primary",weight:"medium",children:p}),v&&(0,t.jsx)("div",{className:I.content,children:v})]}),m&&!l&&(0,t.jsx)("div",{className:I.close,children:(0,t.jsx)(g.$n,{"aria-label":"Close alert",icon:"times",onClick:m,type:"button",fill:"text",variant:"secondary"})}),m&&l&&(0,t.jsx)(c.a,{marginLeft:1,display:"flex",alignItems:"center",children:(0,t.jsx)(g.$n,{"aria-label":"Close alert",variant:"secondary",onClick:m,type:"button",children:l})})]})})});h.displayName="Alert";const f=p=>{switch(p){case"error":return"exclamation-circle";case"warning":return"exclamation-triangle";case"info":return"info-circle";case"success":return"check"}},d=(p,m,v,l,y,u)=>{const D=p.colors[m];return{wrapper:(0,n.css)({flexGrow:1,marginBottom:p.spacing(y??2),marginTop:p.spacing(u??0),position:"relative","&:before":{content:'""',position:"absolute",top:0,left:0,bottom:0,right:0,background:p.colors.background.primary,zIndex:-1}}),icon:(0,n.css)({color:D.text,position:"relative",top:"-1px"}),content:(0,n.css)({color:p.colors.text.primary,paddingTop:v?p.spacing(.5):0,maxHeight:"50vh",overflowY:"auto"}),close:(0,n.css)({position:"relative",color:p.colors.text.secondary,background:"none",display:"flex",top:"-6px",right:"-14px"})}}},28270:(k,R,e)=>{"use strict";e.d(R,{p:()=>m});var t=e(74848),n=e(32196),i=e(2543),s=e(96540),r=e(40845),g=e(88575),a=e(32982);const c=(0,s.memo)(()=>{const l=(0,r.of)(o);return(0,t.jsxs)("div",{className:l.ellipsis,children:[(0,t.jsx)("span",{className:l.firstDot,children:"."}),(0,t.jsx)("span",{className:l.secondDot,children:"."}),(0,t.jsx)("span",{className:l.thirdDot,children:"."})]})});c.displayName="EllipsisAnimated";const o=l=>({ellipsis:(0,n.css)({display:"inline"}),firstDot:(0,n.css)({[l.transitions.handleMotion("no-preference","reduce")]:{animation:`${h} 2s linear infinite`}}),secondDot:(0,n.css)({[l.transitions.handleMotion("no-preference","reduce")]:{animation:`${f} 2s linear infinite`}}),thirdDot:(0,n.css)({[l.transitions.handleMotion("no-preference","reduce")]:{animation:`${d} 2s linear infinite`}})}),h=(0,n.keyframes)`
  0% {
    opacity: 1;
  }
  65% {
    opacity: 1;
  }
  66% {
    opacity: 0.5;
  }
  100% {
    opacity: 0;
  }
  `,f=(0,n.keyframes)`
  0% {
    opacity: 0;
  }
  21% {
    opacity: 0.5;
  }
  22% {
    opacity: 1;
  }
  65% {
    opacity: 1;
  }
  66% {
    opacity: 0.5;
  }
  100% {
    opacity: 0;
  }
  `,d=(0,n.keyframes)`
  0% {
    opacity: 0;
  }
  43% {
    opacity: 0.5;
  }
  44% {
    opacity: 1;
  }
  65% {
    opacity: 1;
  }
  66% {
    opacity: 0.5;
  }
  100% {
    opacity: 0;
  }
  `,p=2*1e3;function m(l){const{invalid:y,loading:u,onFinishChange:D,saveErrorMessage:E="Error saving this value",error:x,children:P,disabled:b,...M}=l,[O,I]=s.useState({isLoading:!1,showSuccess:!1,showError:y}),T=(0,s.useRef)(null);s.useEffect(()=>{let N;if(O.showSuccess){const F=O.showError?0:p;N=setTimeout(()=>{I({...O,showSuccess:!1})},F)}return()=>{window.clearTimeout(N)}},[O]);const C=(0,s.useCallback)(N=>{y||(I({...O,isLoading:!0,showSuccess:!1}),D(N).then(()=>{I({isLoading:!1,showSuccess:!0,showError:!1})}).catch(()=>{I({...O,isLoading:!1,showError:!0})}))},[y,O,D]),S=(0,s.useMemo)(()=>(0,i.debounce)(C,600,{leading:!1}),[C]),A=y||O.showError||void 0,L=(0,r.of)(v);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.D,{...M,loading:u||void 0,invalid:A,disabled:b,error:x||O.showError&&E,ref:T,className:L.widthFitContent,children:s.cloneElement(P(N=>{S(N)}))}),O.isLoading&&(0,t.jsxs)(a.r,{referenceElement:T.current,placement:"right",children:["Saving ",(0,t.jsx)(c,{})]}),O.showSuccess&&(0,t.jsx)(a.r,{suffixIcon:"check",referenceElement:T.current,placement:"right",children:"Saved!"})]})}m.displayName="AutoSaveField";const v=()=>({widthFitContent:(0,n.css)({width:"fit-content"})})},39938:(k,R,e)=>{"use strict";e.d(R,{E:()=>d});var t=e(74848),n=e(32196),i=e(96540),s=e(70255),r=e(84140),g=e(40845),a=e(72129),c=e(14578),o=e(56034);const h=i.memo(({icon:v,color:l,text:y,tooltip:u,className:D,...E})=>{const x=(0,g.of)(m,l),P=(0,t.jsxs)("div",{className:(0,n.cx)(x.wrapper,D),...E,children:[v&&(0,t.jsx)(c.I,{name:v,size:"sm"}),y]});return u?(0,t.jsx)(o.m,{content:u,placement:"auto",children:P}):P});h.displayName="Badge";const f=({rootProps:v})=>{const l=(0,g.of)(p);return(0,t.jsx)(s.A,{width:60,height:22,containerClassName:l.container,...v})},d=(0,a.j)(h,f),p=()=>({container:(0,n.css)({lineHeight:1})}),m=(v,l)=>{let y=v.visualization.getColorByName(l),u="",D="",E="";return v.isDark?(D=(0,r.A)(y).setAlpha(.15).toString(),u=(0,r.A)(y).setAlpha(.25).toString(),E=(0,r.A)(y).lighten(15).toString()):(D=(0,r.A)(y).setAlpha(.15).toString(),u=(0,r.A)(y).setAlpha(.25).toString(),E=(0,r.A)(y).darken(20).toString()),{wrapper:(0,n.css)({display:"inline-flex",padding:"1px 4px",borderRadius:v.shape.radius.default,background:D,border:`1px solid ${u}`,color:E,fontWeight:v.typography.fontWeightRegular,gap:"2px",fontSize:v.typography.bodySmall.fontSize,lineHeight:v.typography.bodySmall.lineHeight,alignItems:"center"})}}},97696:(k,R,e)=>{"use strict";e.d(R,{xE:()=>P});var t=e(74848),n=e(32196),i=e(96540),s=e(84140),r=e(47070),g=e(50082),a=e(58649),c=e(83195),o=e(24293),h=e(8066),f=e(13544),d=e(52622),p=e(29413),m=e(55852),v=e(9286);const l=18,y=50,u=150,D=1.5,E=1,x=10;class P extends i.PureComponent{static{this.defaultProps={lcdCellWidth:12,value:{text:"100",numeric:100},displayMode:d.eX.Gradient,orientation:r.wV.Horizontal,field:{min:0,max:100,thresholds:{mode:g.O.Absolute,steps:[]}},itemSpacing:8,showUnfilled:!0}}render(){const{onClick:w,className:B,theme:U}=this.props,{title:K}=this.props.value,V=O(this.props);return w?(0,t.jsxs)("button",{type:"button",style:V.wrapper,onClick:w,className:(0,n.cx)((0,m.my)(U),B),children:[(0,t.jsx)("div",{style:V.title,children:K}),this.renderBarAndValue()]}):(0,t.jsxs)("div",{style:V.wrapper,className:B,children:[K&&(0,t.jsx)("div",{style:V.title,children:K}),this.renderBarAndValue()]})}renderBarAndValue(){switch(this.props.displayMode){case"lcd":return this.renderRetroBars();case"basic":case"gradient":default:return this.renderBasicAndGradientBars()}}renderBasicAndGradientBars(){const{value:w,showUnfilled:B,valueDisplayMode:U}=this.props,K=S(this.props);return(0,t.jsxs)("div",{style:K.wrapper,children:[U!==d.$l.Hidden&&(0,t.jsx)(v.i,{"data-testid":f.Tp.components.Panels.Visualization.BarGauge.valueV2,value:w,style:K.value}),B&&(0,t.jsx)("div",{style:K.emptyBar}),(0,t.jsx)("div",{style:K.bar})]})}renderRetroBars(){const{display:w,field:B,value:U,itemSpacing:K,alignmentFactors:V,orientation:H,lcdCellWidth:Y,text:X,valueDisplayMode:J,theme:q}=this.props,{valueHeight:ae,valueWidth:j,maxBarHeight:te,maxBarWidth:ne,wrapperWidth:le,wrapperHeight:z}=I(this.props),ee=B.min??a.tw,se=B.max??a.d1,ie=b(H),Z=se-ee,oe=ie?te:ne,ce=K,ye=Math.floor(oe/Y),re=Math.floor((oe-ce*ye)/ye),ue=L(this.props),ge=N(V||U,ue,j,ae,H,X),Te={width:`${le}px`,height:`${z}px`,display:"flex"};ie?(Te.flexDirection="column-reverse",Te.alignItems="center"):(Te.flexDirection="row",Te.alignItems="center",ge.justifyContent="flex-end");const Le=[];for(let Ye=0;Ye<ye;Ye++){const je=ee+Z/ye*Ye,Ze=T(je,U,w),Ne={borderRadius:q.shape.radius.default};Ze.isLit?Ne.backgroundImage=`radial-gradient(${Ze.background} 10%, ${Ze.backgroundShade})`:Ne.backgroundColor=Ze.background,ie?(Ne.height=`${re}px`,Ne.width=`${ne}px`,Ne.marginTop=`${ce}px`):(Ne.width=`${re}px`,Ne.height=`${te}px`,Ne.marginRight=`${ce}px`),Le.push((0,t.jsx)("div",{style:Ne},Ye.toString()))}return(0,t.jsxs)("div",{style:Te,children:[Le,J!==d.$l.Hidden&&(0,t.jsx)(v.i,{"data-testid":f.Tp.components.Panels.Visualization.BarGauge.valueV2,value:U,style:ge})]})}}function b(F){return F===r.wV.Vertical}function M(F){const{height:w,width:B,alignmentFactors:U,orientation:K,text:V,namePlacement:H}=F,Y=U?U.title:F.value.title;if(!Y)return{fontSize:0,width:0,height:0,placement:"above"};if(b(K)){const ne=V?.titleSize??14;return{fontSize:ne,width:B,height:ne*D,placement:"below"}}if(w>40&&H===d.TZ.Auto||H===d.TZ.Top){if(V?.titleSize)return{fontSize:V?.titleSize,width:0,height:V.titleSize*D,placement:"above"};const le=Math.max(Math.min(w*.45,y),17);return{fontSize:le/D,width:0,height:le,placement:"above"}}const ae=Math.max(w*.6,l)/D,j=(0,p.kD)(Y,ae),te=Math.min(j.width+15,B*.4);return{fontSize:V?.titleSize??ae,height:0,width:te,placement:"left"}}function O(F){const w={display:"flex",overflow:"hidden",width:"100%"},B=M(F),U={fontSize:`${B.fontSize}px`,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",width:"100%",alignItems:"center",alignSelf:"center"};return b(F.orientation)?(w.flexDirection="column-reverse",U.textAlign="center"):B.placement==="above"?w.flexDirection="column":(w.flexDirection="row",U.width=`${B.width}px`,U.textAlign="right",U.paddingRight="10px"),{wrapper:w,title:U}}function I(F){const{height:w,width:B,orientation:U,text:K,alignmentFactors:V,valueDisplayMode:H}=F,Y=M(F),X=V??F.value,J=(0,c.cN)(X);let q=0,ae=0,j=0,te=0,ne=0,le=0;const z=K?.valueSize??Math.max(Y.fontSize,12),se=(0,p.kD)(J,z).width+x*2;return b(U)?(K?.valueSize?j=K.valueSize*E:j=Math.min(Math.max(w*.1,l),y),te=B,H===d.$l.Hidden&&(j=0,te=0),q=w-(Y.height+j),ae=B,ne=B,le=w-Y.height):(H===d.$l.Hidden?(j=0,te=0):(j=w-Y.height,te=Math.max(Math.min(B*.2,u),se)),q=w-Y.height,ae=B-te-Y.width,Y.placement==="above"?(ne=B,le=w-Y.height):(ne=B-Y.width,le=w)),{valueWidth:te,valueHeight:j,maxBarWidth:ae,maxBarHeight:q,wrapperHeight:le,wrapperWidth:ne}}function T(F,w,B){if(F===null)return{background:o.F,border:o.F};const U=B?B(F).color:null;return U?w===null||isNaN(w.numeric)||F!==null&&F>w.numeric?{background:(0,s.A)(U).setAlpha(.18).toRgbString(),border:"transparent",isLit:!1}:{background:(0,s.A)(U).setAlpha(.95).toRgbString(),backgroundShade:(0,s.A)(U).setAlpha(.55).toRgbString(),border:(0,s.A)(U).setAlpha(.9).toRgbString(),isLit:!0}:{background:o.F,border:o.F}}function C(F,w,B){const U=Math.min((F-w)/(B-w),1);return isNaN(U)?0:U}function S(F){const{displayMode:w,field:B,value:U,alignmentFactors:K,orientation:V,theme:H,text:Y}=F,{valueWidth:X,valueHeight:J,maxBarHeight:q,maxBarWidth:ae}=I(F),j=B.min??a.tw,te=B.max??a.d1,ne=C(U.numeric,j,te),le=L(F),z=U.color??o.F,se=N(K||U,le,X,J,V,Y),ie=w==="basic",Z={display:"flex",flexGrow:1},oe={borderRadius:H.shape.radius.default,position:"relative",zIndex:1},ce={background:H.colors.background.secondary,flexGrow:1,display:"flex",borderRadius:H.shape.radius.default,position:"relative"};if(b(V)){const ye=Math.max(ne*q,1);Z.flexDirection="column",Z.justifyContent="flex-end",oe.transition="height 1s",oe.height=`${ye}px`,oe.width=`${ae}px`,ce.bottom="-3px",ce.width=`${X}px`,ie?(oe.background=`${(0,s.A)(z).setAlpha(.35).toRgbString()}`,oe.borderTop=`2px solid ${z}`):oe.background=A(F,q)}else{const ye=Math.max(ne*ae,1);Z.flexDirection="row-reverse",Z.justifyContent="flex-end",Z.alignItems="stretch",oe.transition="width 1s",oe.height=`${q}px`,oe.width=`${ye}px`,ce.left="-3px",ce.height=`${J}px`,ie?(oe.background=`${(0,s.A)(z).setAlpha(.35).toRgbString()}`,oe.borderRight=`2px solid ${z}`):oe.background=A(F,ae)}return{wrapper:Z,bar:oe,value:se,emptyBar:ce}}function A(F,w){const{field:B,value:U,orientation:K,theme:V}=F,H=b(K)?"0deg":"90deg",Y=B.min,X=B.max;let J="",q=0,ae=(0,h.Hs)(B.color?.mode);if(ae.id===o.Y.Thresholds){const j=B.thresholds;for(let te=0;te<j.steps.length;te++){const ne=j.steps[te],le=F.theme.visualization.getColorByName(ne.color),z=j.mode===g.O.Percentage?ne.value/100:C(ne.value,Y,X),ee=z*w,se=Math.round(ee-(ee-q)/2),ie=j.mode===g.O.Percentage?Y+(X-Y)*z:ne.value;if(J==="")J=`linear-gradient(${H}, ${le}, ${le}`;else{if(U.numeric<ie)break;q=ee,J+=` ${se}px, ${le}`}}return J+")"}if(ae.isContinuous&&ae.getColors){const j=ae.getColors(V);for(let te=0;te<j.length;te++){const ne=j[te];if(J==="")J=`linear-gradient(${H}, ${ne} 0px`;else{const z=te/(j.length-1)*w;J+=`, ${ne} ${z}px`}}return J+")"}return U.color??o.F}function L(F){if(F.valueDisplayMode==="text")return F.theme.colors.text.primary;const{value:w}=F;return w.color?w.color:o.F}function N(F,w,B,U,K,V){const H={color:w,height:`${U}px`,width:`${B}px`,display:"flex",alignItems:"center",textWrap:"nowrap",lineHeight:E};let Y=B;const X=(0,c.cN)(F);return b(K)?(H.fontSize=V?.valueSize??(0,p.Vr)(X,Y,U,E),H.justifyContent="center"):(H.fontSize=V?.valueSize??(0,p.Vr)(X,Y-x*2,U,E),H.justifyContent="flex-end",H.paddingLeft=`${x}px`,H.paddingRight=`${x}px`,Y-=x),H}},37494:(k,R,e)=>{"use strict";e.d(R,{yV:()=>N,yp:()=>C,$p:()=>S,F8:()=>A,SV:()=>L});var t=e(74848),n=e(32196),i=e(96540),s=e(55852),r=e(9286),g=e(84140),a=e(11261),c=e(83195),o=e(52622),h=e(24284),f=e(29413),d=e(5926),p=e(14578);const m=({percentChange:F,styles:w})=>{let B;return F>0?B="arrow-up":F<0&&(B="arrow-down"),(0,t.jsxs)("div",{style:w.containerStyles,children:[B&&(0,t.jsx)(p.I,{name:B,height:w.iconSize,width:w.iconSize,viewBox:"6 6 12 12"}),v(F)]})},v=F=>(F/100).toLocaleString(void 0,{style:"percent",maximumSignificantDigits:3}),l=1.2,y=30,u=500;class D{constructor(w){this.props=w;const{width:B,height:U,value:K,text:V}=w;this.valueColor=K.color??"gray",this.panelPadding=U>100?12:8,this.textValues=I(w),this.justifyCenter=O(w.justifyMode,this.textValues.title),this.valueToAlignTo=this.textValues.valueToAlignTo,this.titleToAlignTo=this.textValues.titleToAlignTo,this.titleFontSize=0,this.valueFontSize=0,this.chartHeight=0,this.chartWidth=0,this.maxTextWidth=B-this.panelPadding*2,this.maxTextHeight=U-this.panelPadding*2,V&&(V.titleSize&&(this.titleFontSize=V.titleSize,this.titleToAlignTo=void 0),V.valueSize&&(this.valueFontSize=V.valueSize,this.valueToAlignTo=""))}getTitleStyles(){const w={fontSize:`${this.titleFontSize}px`,lineHeight:l};return(this.props.colorMode===C.Background||this.props.colorMode===C.BackgroundSolid)&&(w.color=(0,h.mZ)(this.valueColor,this.props.theme.isDark)),w}getValueStyles(){const w={fontSize:this.valueFontSize,fontWeight:u,lineHeight:l,position:"relative",zIndex:1};switch(this.justifyCenter&&(w.textAlign="center"),this.props.colorMode){case C.Value:w.color=this.valueColor;break;case C.Background:case C.BackgroundSolid:w.color=(0,h.mZ)(this.valueColor,this.props.theme.isDark);break;case C.None:w.color=this.props.theme.colors.text.primary;break}return w}getPercentChangeStyles(w,B,U){const V=this.getValueAndTitleContainerStyles(),H=Math.max(this.valueFontSize/2.5,12);let Y=Math.max(this.valueFontSize/3,10);const X=this.props.theme.visualization,J=T(w,B,U,X),q={fontSize:H,fontWeight:u,lineHeight:l,position:"relative",display:"flex",alignItems:"center",gap:Math.max(H/3,4),zIndex:1,color:J};switch(this.justifyCenter&&(q.textAlign="center"),V.flexDirection==="column"&&H>12&&(q.marginTop=-(H/4)),V.flexDirection==="row"&&(q.alignItems="baseline",q.lineHeight=l*2.5),this.props.colorMode){case C.Background:case C.BackgroundSolid:q.color=(0,h.mZ)(this.valueColor,this.props.theme.isDark);break}return this.props.textMode===L.None&&(q.fontSize=(0,f.Vr)(v(w),this.maxTextWidth*.8,this.maxTextHeight*.8,l,void 0,u),Y=q.fontSize*.8),{containerStyles:q,iconSize:Y}}getValueAndTitleContainerStyles(){const w={display:"flex",flexWrap:"wrap"};return this.justifyCenter&&(w.alignItems="center",w.justifyContent="center",w.flexGrow=1,w.gap="0.75ch"),w}getPanelStyles(){const{width:w,height:B,theme:U,colorMode:K,textMode:V}=this.props,H={width:`${w}px`,height:`${B}px`,padding:`${V===L.None?2:this.panelPadding}px`,borderRadius:U.shape.radius.default,position:"relative",display:"flex"},Y=U.isDark?1:-.7;switch(K){case C.Background:const X=(0,g.A)(this.valueColor).darken(15*Y).spin(8).toRgbString(),J=(0,g.A)(this.valueColor).darken(5*Y).spin(-8).toRgbString();H.background=`linear-gradient(120deg, ${X}, ${J})`;break;case C.BackgroundSolid:H.background=(0,g.A)(this.valueColor).toString();break;case C.Value:H.background="transparent";break}return this.justifyCenter&&(H.alignItems="center",H.flexDirection="row"),H}renderChart(){const{sparkline:w,colorMode:B}=this.props;if(!w||w.y?.type!==a.PU.number)return null;let U,K;switch(B){case C.Background:case C.BackgroundSolid:U="rgba(255,255,255,0.4)",K=(0,g.A)(this.valueColor).brighten(40).toRgbString();break;case C.None:case C.Value:default:K=this.valueColor,U=(0,g.A)(this.valueColor).setAlpha(.2).toRgbString();break}const V={custom:{drawStyle:o.GR.Line,lineWidth:1,fillColor:U,lineColor:K}};return(0,t.jsx)("div",{style:this.getChartStyles(),children:(0,t.jsx)(d.O,{height:this.chartHeight,width:this.chartWidth,sparkline:w,config:V,theme:this.props.theme})})}getChartStyles(){return{position:"absolute",right:0,bottom:0}}}class E extends D{constructor(w){super(w);const B=this.titleToAlignTo?.length?.3:1;this.valueToAlignTo.length&&(this.valueFontSize=(0,f.Vr)(this.valueToAlignTo,this.maxTextWidth*B,this.maxTextHeight,l,void 0,u)),this.titleToAlignTo?.length&&(this.titleFontSize=(0,f.Vr)(this.titleToAlignTo,this.maxTextWidth*.6,this.maxTextHeight,l,y),this.titleFontSize=Math.min(this.valueFontSize*.7,this.titleFontSize))}getValueAndTitleContainerStyles(){const w=super.getValueAndTitleContainerStyles();return w.flexDirection="row",w.alignItems="center",w.flexGrow=1,this.justifyCenter||(w.justifyContent="space-between"),w}renderChart(){return null}getPanelStyles(){const w=super.getPanelStyles();return w.alignItems="center",w}}class x extends D{constructor(w){super(w);const{width:B,height:U}=w,K=.5,V=.6,H=1-V,Y=.4;this.chartWidth=B,this.chartHeight=U*K,this.titleToAlignTo?.length&&(this.titleFontSize=(0,f.Vr)(this.titleToAlignTo,this.maxTextWidth*V,this.maxTextHeight*Y,l,y)),this.valueToAlignTo.length&&(this.valueFontSize=(0,f.Vr)(this.valueToAlignTo,this.maxTextWidth*H,this.maxTextHeight*K,l,void 0,u))}getValueAndTitleContainerStyles(){const w=super.getValueAndTitleContainerStyles();return w.flexDirection="row",w.flexGrow=1,this.justifyCenter||(w.justifyContent="space-between"),w}getPanelStyles(){const w=super.getPanelStyles();return w.flexDirection="row",w.justifyContent="space-between",w}}class P extends D{constructor(w){super(w);const{width:B,height:U}=w,K=.15,V=.25;let H=0;this.chartHeight=U*V,this.chartWidth=B,this.titleToAlignTo?.length&&(this.titleFontSize=(0,f.Vr)(this.titleToAlignTo,this.maxTextWidth,U*K,l,y),H=this.titleFontSize*l),this.valueToAlignTo.length&&(this.valueFontSize=(0,f.Vr)(this.valueToAlignTo,this.maxTextWidth,this.maxTextHeight-this.chartHeight-H,l,void 0,u)),this.titleToAlignTo?.length&&(this.titleFontSize=Math.min(this.valueFontSize*.7,this.titleFontSize)),this.chartHeight=U-this.titleFontSize*l-this.valueFontSize*l}getValueAndTitleContainerStyles(){const w=super.getValueAndTitleContainerStyles();return w.flexDirection="column",w.justifyContent="center",w}getPanelStyles(){const w=super.getPanelStyles();return w.flexDirection="column",w}}class b extends D{constructor(w){super(w);const{height:B}=w,U=.15;let K=0;this.titleToAlignTo?.length&&(this.titleFontSize=(0,f.Vr)(this.titleToAlignTo,this.maxTextWidth,B*U,l,y),K=this.titleFontSize*l),this.valueToAlignTo.length&&(this.valueFontSize=(0,f.Vr)(this.valueToAlignTo,this.maxTextWidth,this.maxTextHeight-K,l,void 0,u)),this.titleToAlignTo?.length&&(this.titleFontSize=Math.min(this.valueFontSize*.7,this.titleFontSize))}getValueAndTitleContainerStyles(){const w=super.getValueAndTitleContainerStyles();return w.flexDirection="column",w.flexGrow=1,w}renderChart(){return null}getPanelStyles(){const w=super.getPanelStyles();return w.alignItems="center",w}}function M(F){const{width:w,height:B,sparkline:U}=F;return w/B>2.5&&!F.disableWideLayout?B>50&&U&&U.y.values.length>1?new x(F):new E(F):B>100&&U&&U.y.values.length>1?new P(F):new b(F)}function O(F,w){return F===A.Center?!0:(w??"").length===0}function I(F){const{value:w,alignmentFactors:B,count:U}=F;let{textMode:K}=F;const V=B?B.title:w.title,H=(0,c.cN)(B||w);switch(K===L.Auto&&(U??1)===1&&(K=L.Value),K){case L.Name:return{...w,title:void 0,prefix:void 0,suffix:void 0,text:w.title||"",titleToAlignTo:void 0,valueToAlignTo:V??"",tooltip:(0,c.cN)(w)};case L.Value:return{...w,title:void 0,titleToAlignTo:void 0,valueToAlignTo:H,tooltip:w.title};case L.None:return{numeric:w.numeric,color:w.color,title:void 0,text:"",titleToAlignTo:void 0,valueToAlignTo:"1",tooltip:`Name: ${w.title}
Value: ${(0,c.cN)(w)}`};case L.ValueAndName:default:return{...w,titleToAlignTo:V,valueToAlignTo:H}}}function T(F,w,B,U){return w===o.CD.SameAsValue?B.color:F*(w===o.CD.Inverted?-1:1)>0?U.getColorByName("green"):U.getColorByName("red")}var C=(F=>(F.Background="background",F.BackgroundSolid="background_solid",F.None="none",F.Value="value",F))(C||{}),S=(F=>(F.None="none",F.Line="line",F.Area="area",F))(S||{}),A=(F=>(F.Auto="auto",F.Center="center",F))(A||{}),L=(F=>(F.Auto="auto",F.Value="value",F.ValueAndName="value_and_name",F.Name="name",F.None="none",F))(L||{});class N extends i.PureComponent{static{this.defaultProps={justifyMode:"auto"}}render(){const{onClick:w,className:B,hasLinks:U,theme:K}=this.props,V=M(this.props),H=V.getPanelStyles(),Y=V.getValueAndTitleContainerStyles(),X=V.getValueStyles(),J=V.getTitleStyles(),q=V.textValues,ae=this.props.value.percentChange,j=this.props.percentChangeColorMode,te=ae!=null&&!Number.isNaN(ae),ne=U?void 0:q.tooltip;return w?(0,t.jsxs)("button",{type:"button",className:(0,n.cx)((0,s.my)(K),B),style:H,onClick:w,title:ne,children:[(0,t.jsxs)("div",{style:Y,children:[q.title&&(0,t.jsx)("div",{style:J,children:q.title}),(0,t.jsx)(r.i,{value:q,style:X})]}),V.renderChart()]}):(0,t.jsxs)("div",{className:B,style:H,title:ne,children:[(0,t.jsxs)("div",{style:Y,children:[q.title&&(0,t.jsx)("div",{style:J,children:q.title}),(0,t.jsx)(r.i,{value:q,style:X}),te&&(0,t.jsx)(m,{percentChange:ae,styles:V.getPercentChangeStyles(ae,j,X)})]}),V.renderChart()]})}}},54438:(k,R,e)=>{"use strict";e.d(R,{J:()=>c});var t=e(74848),n=e(32196),i=e(96540),s=e(23257),r=e.n(s),g=e(40845),a=e(5313);const c=(0,i.forwardRef)(({name:h,value:f,hidden:d,facets:p,onClick:m,className:v,loading:l,searchTerm:y,active:u,style:D,title:E,highlightParts:x,...P},b)=>{const M=(0,g.$j)(),O=o(M),I=y?[y]:[],T=(0,i.useCallback)(S=>{m&&!d&&m(h,f,S)},[m,h,d,f]);let C=f||h;return p&&(C=`${C} (${p})`),(0,t.jsx)("button",{ref:b,onClick:T,style:D,title:E||C,type:"button",role:"option","aria-selected":!!u,className:(0,n.cx)(O.base,u&&O.active,l&&O.loading,d&&O.hidden,v,m&&!d&&O.hover),...P,children:x!==void 0?(0,t.jsx)(a.z,{text:C,highlightClassName:O.matchHighLight,highlightParts:x}):(0,t.jsx)(r(),{textToHighlight:C,searchWords:I,autoEscape:!0,highlightClassName:O.matchHighLight})},C)});c.displayName="Label";const o=h=>({base:(0,n.css)({display:"inline-block",cursor:"pointer",fontSize:h.typography.size.sm,lineHeight:h.typography.bodySmall.lineHeight,backgroundColor:h.colors.background.secondary,color:h.colors.text.primary,whiteSpace:"nowrap",textShadow:"none",padding:h.spacing(.5),borderRadius:h.shape.radius.default,border:"none",marginRight:h.spacing(1),marginBottom:h.spacing(.5)}),loading:(0,n.css)({fontWeight:h.typography.fontWeightMedium,backgroundColor:h.colors.primary.shade,color:h.colors.text.primary,[h.transitions.handleMotion("no-preference","reduce")]:{animation:"pulse 3s ease-out 0s infinite normal forwards"},"@keyframes pulse":{"0%":{color:h.colors.text.primary},"50%":{color:h.colors.text.secondary},"100%":{color:h.colors.text.disabled}}}),active:(0,n.css)({fontWeight:h.typography.fontWeightMedium,backgroundColor:h.colors.primary.main,color:h.colors.primary.contrastText}),matchHighLight:(0,n.css)({background:"inherit",color:h.components.textHighlight.text,backgroundColor:h.components.textHighlight.background}),hidden:(0,n.css)({opacity:.6,cursor:"default",border:"1px solid transparent"}),hover:(0,n.css)({"&:hover":{opacity:.85,cursor:"pointer"}})})},55852:(k,R,e)=>{"use strict";e.d(R,{$n:()=>f,Ez:()=>D,Jt:()=>p,U_:()=>y,hs:()=>m,my:()=>u,z9:()=>d});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(16797),g=e(87266),a=e(14578),c=e(56034);const o=null,h=null,f=i.forwardRef(({variant:E="primary",size:x="md",fill:P="solid",icon:b,fullWidth:M,children:O,className:I,type:T="button",tooltip:C,disabled:S,tooltipPlacement:A,onClick:L,...N},F)=>{const w=(0,s.$j)(),B=m({theme:w,size:x,variant:E,fill:P,fullWidth:M,iconOnly:!O}),U=(0,n.cx)(B.button,{[B.disabled]:S},I),K=!!C,V=(0,t.jsxs)("button",{className:U,type:T,onClick:S?void 0:L,...N,"aria-disabled":K&&S,disabled:!K&&S,ref:C?void 0:F,children:[(0,t.jsx)(p,{icon:b,size:x,className:B.icon}),O&&(0,t.jsx)("span",{className:B.content,children:O})]});return C?(0,t.jsx)(c.m,{ref:F,content:C,placement:A,children:V}):V});f.displayName="Button";const d=i.forwardRef(({variant:E="primary",size:x="md",fill:P="solid",icon:b,fullWidth:M,children:O,className:I,onBlur:T,onFocus:C,disabled:S,tooltip:A,tooltipPlacement:L,...N},F)=>{const w=(0,s.$j)(),B=m({theme:w,fullWidth:M,size:x,variant:E,fill:P,iconOnly:!O}),U=(0,n.cx)(B.button,{[(0,n.css)(B.disabled,{pointerEvents:"none"})]:S},I),K=(0,t.jsxs)("a",{className:U,...N,tabIndex:S?-1:0,"aria-disabled":S,ref:A?void 0:F,children:[(0,t.jsx)(p,{icon:b,size:x,className:B.icon}),O&&(0,t.jsx)("span",{className:B.content,children:O})]});return A?(0,t.jsx)(c.m,{ref:F,content:A,placement:L,children:K}):K});d.displayName="LinkButton";const p=({icon:E,size:x,className:P,iconType:b})=>E?i.isValidElement(E)?i.cloneElement(E,{className:P,size:x}):(0,t.jsx)(a.I,{name:E,size:x,className:P,type:b}):null,m=E=>{const{theme:x,variant:P,fill:b="solid",size:M,iconOnly:O,fullWidth:I}=E,{height:T,padding:C,fontSize:S}=(0,g.SM)(M,x),A=y(x,P,b),L=l(x,P,b),N=(0,r.getFocusStyles)(x),F=x.spacing.gridSize*C-1;return{button:(0,n.css)({label:"button",display:"inline-flex",alignItems:"center",fontSize:S,fontWeight:x.typography.fontWeightMedium,fontFamily:x.typography.fontFamily,padding:`0 ${F}px`,height:x.spacing(T),lineHeight:`${x.spacing.gridSize*T-2}px`,verticalAlign:"middle",cursor:"pointer",borderRadius:x.shape.radius.default,"&:focus":N,"&:focus-visible":N,"&:focus:not(:focus-visible)":(0,r.getMouseFocusStyles)(x),...I&&{flexGrow:1,justifyContent:"center"},...A,":disabled":L,"&[disabled]":L}),disabled:(0,n.css)(L,{"&:hover":(0,n.css)(L)}),img:(0,n.css)({width:"16px",height:"16px",margin:x.spacing(0,1,0,.5)}),icon:O?(0,n.css)({marginRight:x.spacing(-C/2),marginLeft:x.spacing(-C/2)}):(0,n.css)({marginRight:x.spacing(C/2)}),content:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"center",whiteSpace:"nowrap",overflow:"hidden",height:"100%"})}};function v(E,x,P){let b=x.border,M="transparent",O="transparent";return x.name==="secondary"&&(M=x.border,O=E.colors.emphasize(x.border,.25),b=E.colors.border.strong),P==="outline"?{background:"transparent",color:x.text,border:`1px solid ${b}`,transition:E.transitions.create(["background-color","border-color","color"],{duration:E.transitions.duration.short}),"&:hover":{background:x.transparent,borderColor:E.colors.emphasize(b,.25),color:x.text}}:P==="text"?{background:"transparent",color:x.text,border:"1px solid transparent",transition:E.transitions.create(["background-color","color"],{duration:E.transitions.duration.short}),"&:focus":{outline:"none",textDecoration:"none"},"&:hover":{background:x.transparent,textDecoration:"none"}}:{background:x.main,color:x.contrastText,border:`1px solid ${M}`,transition:E.transitions.create(["background-color","box-shadow","border-color","color"],{duration:E.transitions.duration.short}),"&:hover":{background:x.shade,color:x.contrastText,boxShadow:E.shadows.z1,borderColor:O}}}function l(E,x,P){const b={cursor:"not-allowed",boxShadow:"none",color:E.colors.text.disabled,transition:"none"};return P==="text"?{...b,background:"transparent",border:"1px solid transparent"}:P==="outline"?{...b,background:"transparent",border:`1px solid ${E.colors.border.weak}`}:{...b,background:E.colors.action.disabledBackground,border:"1px solid transparent"}}function y(E,x,P){switch(x){case"secondary":return v(E,E.colors.secondary,P);case"destructive":return v(E,E.colors.error,P);case"success":return v(E,E.colors.success,P);case"primary":default:return v(E,E.colors.primary,P)}}const u=E=>(0,n.css)({background:"transparent",color:E.colors.text.primary,border:"none",padding:0}),D=E=>(0,n.css)({background:"transparent",border:"none",padding:0,fontFamily:"inherit",color:"inherit",height:"100%","&:hover":{background:"transparent",color:"inherit"}})},19727:(k,R,e)=>{"use strict";e.d(R,{e:()=>r});var t=e(74848),n=e(32196),i=e(96540),s=e(40845);const r=(0,i.forwardRef)(({className:a,children:c,...o},h)=>{const f=(0,s.of)(g);return(0,t.jsx)("div",{ref:h,className:(0,n.cx)("button-group",f.wrapper,a),...o,children:c})});r.displayName="ButtonGroup";const g=a=>({wrapper:(0,n.css)({display:"flex","> .button-group:not(:first-child) > button, > button:not(:first-child)":{borderTopLeftRadius:0,borderBottomLeftRadius:0},"> .button-group:not(:last-child) > button, > button:not(:last-child)":{borderTopRightRadius:0,borderBottomRightRadius:0,borderRightWidth:0}})})},61458:(k,R,e)=>{"use strict";e.d(R,{V:()=>s});var t=e(74848),n=e(32196),i=e(40845);const s=({className:g,children:a})=>{const c=(0,i.of)(r);return(0,t.jsx)("div",{className:(0,n.cx)(c,g),children:a})},r=()=>(0,n.css)({display:"flex",button:{flexGrow:1,justifyContent:"center"},"> *":{flexGrow:1},label:{flexGrow:1,textAlign:"center"}})},32012:(k,R,e)=>{"use strict";e.d(R,{H:()=>o});var t=e(74848),n=e(32196),i=e(48470),s=e(40845),r=e(55852),g=e(58898),a=e(30958),c=e(14578);const o=f=>{const{onChange:d,className:p,loadData:m,icon:v,buttonProps:l,hideDownIcon:y,variant:u,disabled:D,...E}=f,x=(0,s.of)(h),P=(0,s.of)(a.T);let b=f.children;return y||(b=[f.children,(0,t.jsx)(c.I,{name:"angle-down",className:x.icons.right},"down-icon")]),(0,t.jsx)(i.A,{onChange:(0,g.k)(d),loadData:(0,g.W)(m),dropdownClassName:(0,n.cx)(P.dropdown,x.popup),...E,expandIcon:null,children:(0,t.jsx)(r.$n,{icon:v,disabled:D,variant:u,...l??{},children:b})})};o.displayName="ButtonCascader";const h=f=>({popup:(0,n.css)({label:"popup",zIndex:f.zIndex.dropdown}),icons:{right:(0,n.css)({margin:"1px 0 0 4px"}),left:(0,n.css)({margin:"-1px 4px 0 0"})}})},76442:(k,R,e)=>{"use strict";e.d(R,{c:()=>s});var t=e(74848),n=e(32196),i=e(40845);const s=({message:g,callToActionElement:a,footer:c,className:o})=>{const h=(0,i.of)(r);return(0,t.jsxs)("div",{className:(0,n.cx)([h.wrapper,o]),children:[g&&(0,t.jsx)("div",{className:h.message,children:g}),a,c&&(0,t.jsx)("div",{className:h.footer,children:c})]})},r=g=>({wrapper:(0,n.css)({label:"call-to-action-card",background:g.colors.background.secondary,borderRadius:g.shape.radius.default,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flexGrow:1,padding:g.spacing(3),[g.breakpoints.down("sm")]:{padding:g.spacing(3,1)}}),message:(0,n.css)({marginBottom:g.spacing(3),fontStyle:"italic"}),footer:(0,n.css)({marginTop:g.spacing(3)})})},10860:(k,R,e)=>{"use strict";e.d(R,{H:()=>b,Z:()=>c});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(16797),g=e(81507);const a=i.createContext(null),c=({disabled:M,href:O,onClick:I,children:T,isSelected:C,isCompact:S,className:A,...L})=>{const N=(0,i.useMemo)(()=>i.Children.toArray(T).some(U=>i.isValidElement(U)&&U.type===o),[T]),F=M||!I&&!O,w=I&&!M?I:void 0,B=(0,s.of)(g.i,M,F,C,S);return(0,t.jsx)(g.Q,{disableEvents:M,disableHover:F,isSelected:C,className:(0,n.cx)(B.container,A),...L,children:(0,t.jsxs)(a.Provider,{value:{href:O,onClick:w,disabled:M,isSelected:C},children:[!N&&(0,t.jsx)(o,{}),T]})})},o=({children:M,className:O,"aria-label":I})=>{const T=(0,i.useContext)(a),C=(0,s.of)(h),{href:S,onClick:A,isSelected:L}=T??{href:void 0,onClick:void 0,isSelected:void 0};return(0,t.jsxs)("h2",{className:(0,n.cx)(C.heading,O),children:[S?(0,t.jsx)("a",{href:S,className:C.linkHack,"aria-label":I,onClick:A,children:M}):A?(0,t.jsx)("button",{onClick:A,className:C.linkHack,"aria-label":I,type:"button",children:M}):(0,t.jsx)(t.Fragment,{children:M}),L!==void 0&&(0,t.jsx)("input",{"aria-label":"option",type:"radio",checked:L,readOnly:!0})]})};o.displayName="Heading";const h=M=>({heading:(0,n.css)({gridArea:"Heading",justifySelf:"start",display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",marginBottom:0,fontSize:M.typography.size.md,letterSpacing:"inherit",lineHeight:M.typography.body.lineHeight,color:M.colors.text.primary,fontWeight:M.typography.fontWeightMedium,"& input[readonly]":{cursor:"inherit"}}),linkHack:(0,n.css)({all:"unset","&::after":{position:"absolute",content:'""',top:0,bottom:0,left:0,right:0,borderRadius:M.shape.radius.default},"&:focus-visible":{outline:"none",outlineOffset:0,boxShadow:"none","&::after":{...(0,r.getFocusStyles)(M),zIndex:1}}})}),f=({children:M,className:O})=>{const I=(0,s.of)(d);return(0,t.jsx)("div",{className:(0,n.cx)(I.tagList,O),children:M})};f.displayName="Tags";const d=M=>({tagList:(0,n.css)({position:"relative",gridArea:"Tags",alignSelf:"center"})}),p=({children:M,className:O})=>{const I=(0,s.of)(m);return(0,t.jsx)("p",{className:(0,n.cx)(I.description,O),children:M})};p.displayName="Description";const m=M=>({description:(0,n.css)({width:"100%",gridArea:"Description",margin:M.spacing(1,0,0),color:M.colors.text.secondary,lineHeight:M.typography.body.lineHeight})}),v=({children:M,align:O="start",className:I})=>{const T=(0,s.of)(l);return(0,t.jsx)("div",{className:(0,n.cx)(T.media,I,(0,n.css)({alignSelf:O})),children:M})};v.displayName="Figure";const l=M=>({media:(0,n.css)({position:"relative",gridArea:"Figure",marginRight:M.spacing(2),width:"40px","> img":{width:"100%"},"&:empty":{display:"none"}})}),y=(0,i.memo)(({children:M,className:O,separator:I="|"})=>{const T=(0,s.of)(u);let C=M;const S=i.Children.toArray(M).filter(Boolean);return S.length?(C=S.map((A,L)=>(0,t.jsx)("div",{className:T.metadataItem,children:A},`element_${L}`)),S.length>1&&I&&(C=S.reduce((A,L,N)=>[A,(0,t.jsx)("span",{className:T.separator,children:I},`separator_${N}`),L])),(0,t.jsx)("div",{className:(0,n.cx)(T.metadata,O),children:C})):null});y.displayName="Meta";const u=M=>({metadata:(0,n.css)({gridArea:"Meta",display:"flex",alignItems:"center",width:"100%",fontSize:M.typography.size.sm,color:M.colors.text.secondary,margin:M.spacing(.5,0,0),lineHeight:M.typography.bodySmall.lineHeight,overflowWrap:"anywhere"}),metadataItem:(0,n.css)({zIndex:0}),separator:(0,n.css)({margin:`0 ${M.spacing(1)}`})}),D=({children:M,disabled:O,variant:I,className:T})=>{const C=(0,s.of)(E),A=(0,i.useContext)(a)?.disabled||O,L=I==="primary"?C.actions:C.secondaryActions;return(0,t.jsx)("div",{className:(0,n.cx)(L,T),children:i.Children.map(M,N=>i.isValidElement(N)?(0,i.cloneElement)(N,{disabled:A,...N.props}):null)})},E=M=>({actions:(0,n.css)({display:"flex",flexDirection:"row",flexWrap:"wrap",gap:M.spacing(1),gridArea:"Actions",marginTop:M.spacing(2)}),secondaryActions:(0,n.css)({alignSelf:"center",color:M.colors.text.secondary,display:"flex",flexDirection:"row",flexWrap:"wrap",gap:M.spacing(1),gridArea:"Secondary",marginTop:M.spacing(2)})}),x=({children:M,disabled:O,className:I})=>(0,t.jsx)(D,{variant:"primary",disabled:O,className:I,children:M});x.displayName="Actions";const P=({children:M,disabled:O,className:I})=>(0,t.jsx)(D,{variant:"secondary",disabled:O,className:I,children:M});P.displayName="SecondaryActions";const b=M=>({inner:(0,n.css)({display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",flexWrap:"wrap"}),...h(M),...u(M),...m(M),...l(M),...E(M),...d(M)});c.Heading=o,c.Tags=f,c.Figure=v,c.Meta=y,c.Actions=x,c.SecondaryActions=P,c.Description=p},81507:(k,R,e)=>{"use strict";e.d(R,{Q:()=>a,i:()=>c});var t=e(74848),n=e(32196),i=e(40845),s=e(16797);const r=({children:o,href:h})=>{const{inner:f}=(0,i.of)(g);return h?(0,t.jsx)("a",{className:f,href:h,children:o}):(0,t.jsx)(t.Fragment,{children:o})},g=o=>({inner:(0,n.css)({display:"flex",width:"100%",padding:o.spacing(2)})}),a=({children:o,disableEvents:h,disableHover:f,isSelected:d,className:p,href:m,...v})=>{const{oldContainer:l}=(0,i.of)(c,h,f,d);return(0,t.jsx)("div",{...v,className:(0,n.cx)(l,p),children:(0,t.jsx)(r,{href:m,children:o})})},c=(o,h=!1,f=!1,d,p)=>{const m=d!==void 0;return{container:(0,n.css)({display:"grid",position:"relative",gridTemplateColumns:"auto 1fr auto",gridTemplateRows:"1fr auto auto auto",gridAutoColumns:"1fr",gridAutoFlow:"row",gridTemplateAreas:`
        "Figure Heading Tags"
        "Figure Meta Tags"
        "Figure Description Tags"
        "Figure Actions Secondary"`,width:"100%",padding:o.spacing(p?1:2),background:o.colors.background.secondary,borderRadius:o.shape.radius.default,marginBottom:"8px",pointerEvents:h?"none":"auto",[o.transitions.handleMotion("no-preference","reduce")]:{transition:o.transitions.create(["background-color","box-shadow","border-color","color"],{duration:o.transitions.duration.short})},...!f&&{"&:hover":{background:o.colors.emphasize(o.colors.background.secondary,.03),cursor:"pointer",zIndex:1},"&:focus":s.getFocusStyles(o)},...m&&{cursor:"pointer"},...d&&{outline:`solid 2px ${o.colors.primary.border}`}}),oldContainer:(0,n.css)({display:"flex",width:"100%",background:o.colors.background.secondary,borderRadius:o.shape.radius.default,position:"relative",pointerEvents:h?"none":"auto",marginBottom:o.spacing(1),[o.transitions.handleMotion("no-preference","reduce")]:{transition:o.transitions.create(["background-color","box-shadow","border-color","color"],{duration:o.transitions.duration.short})},...!f&&{"&:hover":{background:o.colors.emphasize(o.colors.background.secondary,.03),cursor:"pointer",zIndex:1},"&:focus":s.getFocusStyles(o)}})}}},3988:(k,R,e)=>{"use strict";e.d(R,{v:()=>u});var t=e(74848),n=e(32196),i=e(47078),s=e.n(i),r=e(48470),g=e(96540),a=e(40845),c=e(14578),o=e(29158),h=e(10354),f=e(67061),d=e(90182),p=e(58898),m=e(30958);const v=(0,n.css)({"&:focus":{outline:"none"}}),l=" / ";class y extends g.PureComponent{constructor(E){super(E),this.flattenOptions=(M,O=[])=>{let I=[];for(const T of M){const C=[...O];C.push(T),!T.items||T.items.length===0?I.push({singleLabel:C[C.length-1].label,label:C.map(S=>S.label).join(this.props.separator||l),value:C.map(S=>S.value)}):I=[...I,...this.flattenOptions(T.items,C)]}return I},this.getSearchableOptions=s()(M=>this.flattenOptions(M)),this.onChange=(M,O)=>{const I=this.props.hideActiveLevelLabel?"":this.props.displayAllSelectedLevels?O.map(C=>C.label).join(this.props.separator||l):O[O.length-1].label,T={rcValue:{value:M,label:I},focusCascade:!0,activeLabel:I,isSearching:!1,inputValue:I};this.setState(T),this.props.onSelect(O[O.length-1].value)},this.onSelect=M=>{const O=M.value||[],I=this.props.displayAllSelectedLevels?M.label:M.singleLabel||"",T={activeLabel:I,inputValue:I,rcValue:{value:O,label:I},isSearching:!1,focusCascade:!1};this.setState(T),this.props.onSelect(O[O.length-1])},this.onCreateOption=M=>{this.setState({activeLabel:M,inputValue:M,rcValue:[],isSearching:!1}),this.props.onSelect(M)},this.onBlur=()=>{this.setState({isSearching:!1,focusCascade:!1}),this.state.activeLabel===""&&this.setState({rcValue:[]}),this.props.onBlur?.()},this.onBlurCascade=()=>{this.setState({focusCascade:!1}),this.props.onBlur?.()},this.onInputKeyDown=M=>{if(["ArrowDown","ArrowUp","Enter","ArrowLeft","ArrowRight"].includes(M.key))return;const{activeLabel:O}=this.state;this.setState({focusCascade:!1,isSearching:!0,inputValue:O})},this.onSelectInputChange=M=>{this.setState({inputValue:M})};const x=this.getSearchableOptions(E.options),{rcValue:P,activeLabel:b}=this.setInitialValue(x,E.initialValue);this.state={isSearching:!1,focusCascade:!1,rcValue:P,activeLabel:b,inputValue:""}}static{this.defaultProps={changeOnSelect:!0}}setInitialValue(E,x){if(!x)return{rcValue:[],activeLabel:""};for(const P of E){const b=P.value||[];if(b[b.length-1]===x)return{rcValue:b,activeLabel:this.props.displayAllSelectedLevels?P.label:P.singleLabel||""}}return this.props.allowCustomValue?{rcValue:[],activeLabel:x}:{rcValue:[],activeLabel:""}}render(){const{allowCustomValue:E,formatCreateLabel:x,placeholder:P,width:b,changeOnSelect:M,options:O,disabled:I,id:T,isClearable:C,theme:S}=this.props,{focusCascade:A,isSearching:L,rcValue:N,activeLabel:F,inputValue:w}=this.state,B=this.getSearchableOptions(O),U=(0,m.T)(S);return(0,t.jsx)("div",{children:L?(0,t.jsx)(d.l6,{allowCustomValue:E,placeholder:P,autoFocus:!A,onChange:this.onSelect,onBlur:this.onBlur,options:B,onCreateOption:this.onCreateOption,formatCreateLabel:x,width:b,onInputChange:this.onSelectInputChange,disabled:I,inputValue:w,inputId:T}):(0,t.jsx)(r.A,{onChange:(0,p.k)(this.onChange),options:O,changeOnSelect:M,value:N.value,fieldNames:{label:"label",value:"value",children:"items"},expandIcon:null,open:this.props.alwaysOpen,disabled:I,dropdownClassName:U.dropdown,children:(0,t.jsx)("div",{className:v,children:(0,t.jsx)(h.p,{autoFocus:this.props.autoFocus,width:b,placeholder:P,onBlur:this.onBlurCascade,value:F,onKeyDown:this.onInputKeyDown,onChange:()=>{},suffix:(0,t.jsxs)(f.B,{gap:.5,children:[C&&F!==""&&(0,t.jsx)(o.K,{name:"times","aria-label":"Clear selection",onClick:K=>{K.preventDefault(),K.stopPropagation(),this.setState({rcValue:[],activeLabel:"",inputValue:""}),this.props.onSelect("")}}),(0,t.jsx)(c.I,{name:A?"angle-up":"angle-down"})]}),disabled:I,id:T})})})})}}const u=(0,a.cV)(y)},58898:(k,R,e)=>{"use strict";e.d(R,{W:()=>n,k:()=>t});const t=r=>(g,a)=>{r&&r(g.map(c=>String(c)),i(a))},n=r=>g=>{r&&r(i(g))},i=r=>r.map(s),s=r=>{const g=r.value?String(r.value):"";return{value:g,label:typeof r.label=="string"?r.label:g}}},30958:(k,R,e)=>{"use strict";e.d(R,{T:()=>g});var t=e(32196);const n=(0,t.keyframes)({"0%":{opacity:0,transformOrigin:"0% 0%",transform:"scaleY(0.8)"},"100%":{opacity:1,transformOrigin:"0% 0%",transform:"scaleY(1)"}}),i=(0,t.keyframes)({"0%":{opacity:1,transformOrigin:"0% 0%",transform:"scaleY(1)"},"100%":{opacity:0,transformOrigin:"0% 0%",transform:"scaleY(0.8)"}}),s=(0,t.keyframes)({"0%":{opacity:0,transformOrigin:"0% 100%",transform:"scaleY(0.8)"},"100%":{opacity:1,transformOrigin:"0% 100%",transform:"scaleY(1)"}}),r=(0,t.keyframes)({"0%":{opacity:1,transformOrigin:"0% 100%",transform:"scaleY(1)"},"100%":{opacity:0,transformOrigin:"0% 100%",transform:"scaleY(0.8)"}}),g=a=>({dropdown:(0,t.css)({"&.rc-cascader-dropdown":{position:"absolute",zIndex:9999,"&-hidden":{display:"none"}},".rc-cascader":{"&-menus":{overflow:"hidden",background:a.colors.background.canvas,border:`1px solid ${a.colors.border.weak}`,borderRadius:a.shape.radius.default,boxShadow:a.shadows.z3,whiteSpace:"nowrap","&.slide-up-enter, &.slide-up-appear":{animationDuration:"0.3s",animationFillMode:"both",transformOrigin:"0 0",opacity:0,animationTimingFunction:"cubic-bezier(0.08, 0.82, 0.17, 1)",animationPlayState:"paused"},"&.slide-up-enter.slide-up-enter-active.rc-cascader-menus-placement, &.slide-up-appear.slide-up-appear-active.rc-cascader-menus-placement":{"&-bottomLeft":{animationName:n,animationPlayState:"running"},"&-topLeft":{animationName:s,animationPlayState:"running"}},"&.slide-up-leave":{animationDuration:"0.3s",animationFillMode:"both",transformOrigin:"0 0",opacity:1,animationTimingFunction:"cubic-bezier(0.6, 0.04, 0.98, 0.34)",animationPlayState:"paused","&.slide-up-leave-active.rc-cascader-menus-placement":{"&-bottomLeft":{animationName:i,animationPlayState:"running"},"&-topLeft":{animationName:r,animationPlayState:"running"}}}},"&-menu":{display:"inline-block",maxWidth:"50vw",height:"192px",listStyle:"none",margin:0,padding:0,borderRight:`1px solid ${a.colors.border.weak}`,overflow:"auto","&:last-child":{borderRight:0},"&-item":{height:a.spacing(4),lineHeight:a.spacing(4),padding:a.spacing(0,4,0,2),cursor:"pointer",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",transition:"all 0.3s ease",position:"relative","&:hover":{background:a.colors.action.hover},"&-disabled":{cursor:"not-allowed",color:a.colors.text.disabled,"&:hover":{background:"transparent"},"&:after":{position:"absolute",right:"12px",content:"'loading'",color:a.colors.text.disabled,fontStyle:"italic"}},"&-active":{color:a.colors.text.maxContrast,background:a.colors.background.secondary,"&:hover":{background:a.colors.action.hover}},"&-expand":{position:"relative","&:after":{background:a.colors.background.secondary,content:"''",height:a.spacing(3),mask:"url(../img/icons/unicons/angle-right.svg)",maskType:"luminance",position:"absolute",right:0,top:a.spacing(.5),width:a.spacing(3)}}}}}})})},8866:(k,R,e)=>{"use strict";e.d(R,{N:()=>i});var t=e(74848),n=e(96540);class i extends n.PureComponent{constructor(){super(...arguments),this.myRef=(0,n.createRef)(),this.state={hasEventListener:!1},this.onOutsideClick=r=>{const g=this.myRef.current;(!g||r.target instanceof Node&&!g.contains(r.target))&&this.props.onClick()}}static{this.defaultProps={includeButtonPress:!0,parent:typeof window<"u"?window:void 0,useCapture:!1}}componentDidMount(){this.props.parent.addEventListener("click",this.onOutsideClick,this.props.useCapture),this.props.includeButtonPress&&this.props.parent.addEventListener("keyup",this.onOutsideClick,this.props.useCapture)}componentWillUnmount(){this.props.parent.removeEventListener("click",this.onOutsideClick,this.props.useCapture),this.props.includeButtonPress&&this.props.parent.removeEventListener("keyup",this.onOutsideClick,this.props.useCapture)}render(){return(0,t.jsx)("div",{ref:this.myRef,children:this.props.children})}}},10534:(k,R,e)=>{"use strict";e.d(R,{b:()=>h});var t=e(74848),n=e(32196),i=e(96540),s=e(76412),r=e(40845),g=e(55852),a=e(14578),c=e(32982);const o=2*1e3;function h({onClipboardCopy:p,onClipboardError:m,children:v,getText:l,icon:y,variant:u,...D}){const E=(0,r.of)(d),[x,P]=(0,i.useState)(!1);(0,i.useEffect)(()=>{let O;return x&&(O=setTimeout(()=>{P(!1)},o)),()=>{window.clearTimeout(O)}},[x]);const b=(0,i.useRef)(null),M=(0,i.useCallback)(async()=>{const O=l();try{await f(O,b),P(!0),p?.(O)}catch(I){m?.(O,I)}},[l,p,m]);return(0,t.jsxs)(t.Fragment,{children:[x&&(0,t.jsx)(c.r,{placement:"top",referenceElement:b.current,children:(0,t.jsx)(s.x,{i18nKey:"clipboard-button.inline-toast.success",children:"Copied"})}),(0,t.jsxs)(g.$n,{onClick:M,icon:y,variant:x?"success":u,"aria-label":x?"Copied":void 0,...D,className:(0,n.cx)(E.button,x&&E.successButton,D.className),ref:b,children:[v,x&&(0,t.jsx)("div",{className:E.successOverlay,children:(0,t.jsx)(a.I,{name:"check"})})]})]})}const f=async(p,m)=>{if(navigator.clipboard&&window.isSecureContext)return navigator.clipboard.writeText(p);{const v=document.createElement("textarea");m.current?.appendChild(v),v.value=p,v.focus(),v.select(),document.execCommand("copy"),v.remove()}},d=p=>({button:(0,n.css)({position:"relative"}),successButton:(0,n.css)({"> *":(0,n.css)({visibility:"hidden"})}),successOverlay:(0,n.css)({position:"absolute",top:0,bottom:0,right:0,left:0,visibility:"visible"})})},57418:(k,R,e)=>{"use strict";e.d(R,{M:()=>h});var t=e(74848),n=e(32196),i=e(2543),s=e.n(i),r=e(96540),g=e(40845),a=e(16797),c=e(14578),o=e(62930);const h=({label:d,isOpen:p,onToggle:m,className:v,contentClassName:l,children:y,labelId:u,loading:D=!1,headerDataTestId:E,contentDataTestId:x})=>{const[P,b]=(0,r.useState)(p),M=(0,g.of)(f),O=C=>{C.target instanceof HTMLElement&&C.target.tagName==="A"||(C.preventDefault(),C.stopPropagation(),m?.(!P),b(!P))},{current:I}=(0,r.useRef)((0,i.uniqueId)()),T=u??`collapse-label-${I}`;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{onClick:O,className:(0,n.cx)(M.header,v),children:[(0,t.jsx)("button",{type:"button",id:`collapse-button-${I}`,className:M.button,onClick:O,"aria-expanded":P&&!D,"aria-controls":`collapse-content-${I}`,"aria-labelledby":T,children:D?(0,t.jsx)(o.y,{className:M.spinner}):(0,t.jsx)(c.I,{name:P?"angle-up":"angle-down",className:M.icon})}),(0,t.jsx)("div",{className:M.label,id:`collapse-label-${I}`,"data-testid":E,children:d})]}),P&&(0,t.jsx)("div",{id:`collapse-content-${I}`,className:(0,n.cx)(M.content,l),"data-testid":x,children:y})]})},f=d=>({header:(0,n.css)({display:"flex",cursor:"pointer",boxSizing:"border-box",flexDirection:"row-reverse",position:"relative",justifyContent:"space-between",fontSize:d.typography.size.lg,padding:`${d.spacing(.5)} 0`,"&:focus-within":(0,a.getFocusStyles)(d)}),button:(0,n.css)({all:"unset","&:focus-visible":{outline:"none",outlineOffset:"unset",transition:"none",boxShadow:"none"}}),icon:(0,n.css)({color:d.colors.text.secondary}),content:(0,n.css)({padding:`${d.spacing(2)} 0`}),spinner:(0,n.css)({display:"flex",alignItems:"center",width:d.spacing(2)}),label:(0,n.css)({display:"flex"})})},82762:(k,R,e)=>{"use strict";e.d(R,{S:()=>o,a:()=>c});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(55852),g=e(14578);const a=h=>({collapse:(0,n.css)({label:"collapse",marginBottom:h.spacing(1),backgroundColor:h.colors.background.primary,border:`1px solid ${h.colors.border.weak}`,position:"relative",borderRadius:h.shape.radius.default,width:"100%",display:"flex",flexDirection:"column",flex:"1 1 0"}),collapseBody:(0,n.css)({label:"collapse__body",padding:h.spacing(h.components.panel.padding),paddingTop:0,flex:1,overflow:"hidden",display:"flex",flexDirection:"column"}),bodyContentWrapper:(0,n.css)({label:"bodyContentWrapper",flex:1,overflow:"hidden"}),loader:(0,n.css)({label:"collapse__loader",height:"2px",position:"relative",overflow:"hidden",background:"none",margin:h.spacing(.5)}),loaderActive:(0,n.css)({label:"collapse__loader_active","&:after":{content:"' '",display:"block",width:"25%",top:0,height:"250%",position:"absolute",animation:"loader 2s cubic-bezier(0.17, 0.67, 0.83, 0.67) 500ms",animationIterationCount:100,left:"-25%",background:h.colors.primary.main},"@keyframes loader":{from:{left:"-25%",opacity:.1},to:{left:"100%",opacity:1}}}),header:(0,n.css)({label:"collapse__header",padding:h.spacing(1,2,1,2),display:"flex"}),headerCollapsed:(0,n.css)({label:"collapse__header--collapsed",padding:h.spacing(1,2,1,2)}),headerLabel:(0,n.css)({label:"collapse__header-label",fontWeight:h.typography.fontWeightMedium,marginRight:h.spacing(1),fontSize:h.typography.size.md,display:"flex",flex:"0 0 100%"}),icon:(0,n.css)({label:"collapse__icon",margin:h.spacing(.25,1,0,-1)})}),c=({isOpen:h,onToggle:f,...d})=>{const[p,m]=(0,i.useState)(h);return(0,t.jsx)(o,{isOpen:p,collapsible:!0,...d,onToggle:()=>{m(!p),f&&f(!p)}})},o=({isOpen:h,label:f,loading:d,collapsible:p,onToggle:m,className:v,children:l})=>{const y=(0,s.of)(r.my),u=(0,s.of)(a),D=()=>{m&&m(!h)},E=(0,n.cx)([u.collapse,v]),x=d?(0,n.cx)([u.loader,u.loaderActive]):(0,n.cx)([u.loader]),P=p?(0,n.cx)([u.header]):(0,n.cx)([u.headerCollapsed]);return(0,t.jsxs)("div",{className:E,children:[(0,t.jsxs)("button",{type:"button",className:(0,n.cx)(y,P),onClick:D,children:[p&&(0,t.jsx)(g.I,{className:u.icon,name:h?"angle-down":"angle-right"}),(0,t.jsx)("div",{className:(0,n.cx)([u.headerLabel]),children:f})]}),h&&(0,t.jsxs)("div",{className:(0,n.cx)([u.collapseBody]),children:[(0,t.jsx)("div",{className:x}),(0,t.jsx)("div",{className:u.bodyContentWrapper,children:l})]})]})};o.displayName="Collapse"},36314:(k,R,e)=>{"use strict";e.d(R,{A:()=>h});var t=e(74848),n=e(32196),i=e(2543),s=e.n(i),r=e(96540),g=e(84140),a=e(40845),c=e(10354);const o=(0,r.forwardRef)(({color:p,onChange:m,isClearable:v=!1,onClick:l,onBlur:y,disabled:u,buttonAriaLabel:D,...E},x)=>{const[P,b]=(0,r.useState)(p),[M,O]=(0,r.useState)(p),I=(0,r.useMemo)(()=>(0,i.debounce)(m,100),[]);(0,r.useEffect)(()=>{const S=(0,g.A)(p);S.isValid()&&p!==M&&(b(S.toString()),O(p))},[p,M]);const T=S=>{const{value:A}=S.currentTarget;if(b(A),A===""&&v){I(A);return}const L=(0,g.A)(A);L.isValid()&&I(L.toString())},C=S=>{(0,g.A)(P).isValid()||b(p),y?.(S)};return(0,t.jsx)(c.p,{...E,value:P,onChange:T,disabled:u,onClick:l,onBlur:C,addonBefore:(0,t.jsx)(f,{onClick:l,ariaLabel:D,disabled:u,color:p}),ref:x})});o.displayName="ColorInput";const h=o,f=({color:p,onClick:m,disabled:v,ariaLabel:l})=>{const y=(0,a.of)(d);return(0,t.jsx)("button",{type:"button",onClick:m,"aria-label":l,disabled:v||!m,className:(0,n.cx)(y,(0,n.css)({backgroundColor:p}))})},d=p=>(0,n.css)({height:"100%",width:`${p.spacing.gridSize*4}px`,borderRadius:`${p.shape.radius.default} 0 0 ${p.shape.radius.default}`,border:`1px solid ${p.colors.border.medium}`})},83598:(k,R,e)=>{"use strict";e.d(R,{Dp:()=>m,sk:()=>p});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(3911),g=e(40321),a=e(13840),c=e(95868),o=e(70045),h=e(83876),f=e(70104);const d=(l,y="ColorPicker")=>class extends i.Component{constructor(){super(...arguments),this.pickerTriggerRef=(0,i.createRef)()}static{this.displayName=y}render(){const{theme:D,children:E,onChange:x,color:P}=this.props,b=v(D),M=i.createElement(l,{...this.props,children:null,onChange:x});return(0,t.jsx)(c.I,{content:M,hideAfter:300,children:(O,I,T)=>(0,t.jsxs)(t.Fragment,{children:[this.pickerTriggerRef.current&&(0,t.jsx)(a.A,{...T,referenceElement:this.pickerTriggerRef.current,wrapperClassName:b.colorPicker,onMouseLeave:I,onMouseEnter:O,onKeyDown:C=>(0,g.Q)(C,I)}),E?E({ref:this.pickerTriggerRef,showColorPicker:O,hideColorPicker:I}):(0,t.jsx)(h.q,{ref:this.pickerTriggerRef,onClick:O,onMouseLeave:I,color:D.visualization.getColorByName(P||"#000000"),"aria-label":P})]})})}},p=(0,s.cV)(d(o.$,"ColorPicker")),m=(0,s.cV)(d(f.o,"SeriesColorPicker")),v=(0,r.N)(l=>({colorPicker:(0,n.css)({position:"absolute",zIndex:l.zIndex.tooltip,color:l.colors.text.primary,maxWidth:"400px",fontSize:l.typography.size.sm})}))},99128:(k,R,e)=>{"use strict";e.d(R,{i:()=>f});var t=e(74848),n=e(32196),i=e(96540),s=e(7612),r=e(65229),g=e(23596),a=e(40845),c=e(8866),o=e(36314),h=e(95151);const f=(0,i.forwardRef)(({value:p="",onChange:m,returnColorAs:v="rgb",...l},y)=>{const[u,D]=(0,i.useState)(p),[E,x]=(0,i.useState)(!1),P=(0,a.$j)(),b=(0,a.of)(d),M=(0,a.of)(h.$);return(0,r.A)(O=>{if(O===p)return;if(!O){m("");return}const I=P.visualization.getColorByName(O);m(v==="rgb"?g.MV.asRgbString(I):g.MV.asHexString(I))},500,[u]),(0,t.jsx)(c.N,{onClick:()=>x(!1),children:(0,t.jsxs)("div",{className:b.wrapper,children:[E&&!l.disabled&&(0,t.jsx)(s.p9,{"data-testid":"color-popover",color:u,onChange:D,className:(0,n.cx)(M.root,b.picker)}),(0,t.jsx)(o.A,{...l,theme:P,color:u,onChange:D,buttonAriaLabel:"Open color picker",onClick:()=>x(!0),onBlur:()=>x(!1),ref:y,isClearable:!0})]})})});f.displayName="ColorPickerInput";const d=p=>({wrapper:(0,n.css)({position:"relative"}),picker:(0,n.css)({"&.react-colorful":{position:"absolute",width:"100%",zIndex:11,bottom:"36px"}}),inner:(0,n.css)({position:"absolute"})})},70045:(k,R,e)=>{"use strict";e.d(R,{$:()=>u});var t=e(74848),n=e(32196),i=e(85690),s=e(96540),r=e(23596),g=e(40845),a=e(3911),c=e(83876),o=e(2543);function h(E,x){const P=new Array(E.length);for(let b=0;b<E.length;b++){const M=E.length-1-b;P[b]=x(E[M],M,E)}return P}const d=({hue:E,selectedColor:x,onColorSelect:P,...b})=>{const M=(0,o.upperFirst)(E.name),O=(0,g.of)(p);return(0,t.jsxs)("div",{className:O.colorRow,children:[(0,t.jsx)("div",{className:O.colorLabel,children:M}),(0,t.jsx)("div",{...b,className:O.swatchRow,children:h(E.shades,I=>(0,t.jsx)(c.q,{"aria-label":I.name,variant:I.primary?c.h.Large:c.h.Small,isSelected:I.name===x,color:I.color,onClick:()=>P(I.name)},I.name))})]})},p=E=>({colorRow:(0,n.css)({display:"grid",gridTemplateColumns:"25% 1fr",gridColumnGap:E.spacing(2),padding:E.spacing(.5,0),"&:hover":{background:E.colors.background.secondary}}),colorLabel:(0,n.css)({paddingLeft:E.spacing(2),display:"flex",alignItems:"center"}),swatchRow:(0,n.css)({display:"flex",gap:E.spacing(1),alignItems:"center",justifyContent:"space-around",flexDirection:"row"})}),m=({color:E,onChange:x})=>{const P=(0,g.$j)(),b=(0,g.of)(v),M=[];for(const O of P.visualization.hues)M.push((0,t.jsx)(d,{selectedColor:E,hue:O,onColorSelect:x},O.name));return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:b.swatches,children:M}),(0,t.jsxs)("div",{className:b.extraColors,children:[(0,t.jsx)(c.q,{isSelected:E==="transparent",color:"rgba(0,0,0,0)",label:"Transparent",onClick:()=>x("transparent")}),(0,t.jsx)(c.q,{isSelected:E==="text",color:P.colors.text.primary,label:"Text color",onClick:()=>x("text")})]})]})},v=E=>({container:(0,n.css)({display:"flex",flexDirection:"column"}),extraColors:(0,n.css)({display:"flex",alignItems:"center",justifyContent:"space-around",gap:E.spacing(1),padding:E.spacing(1,0)}),swatches:(0,n.css)({display:"grid",flexGrow:1})});var l=e(95151);class y extends s.Component{constructor(x){super(x),this.getTabClassName=P=>{const{activePicker:b}=this.state;return`ColorPickerPopover__tab ${b===P&&"ColorPickerPopover__tab--active"}`},this.handleChange=P=>{const{onChange:b,enableNamedColors:M,theme:O}=this.props;if(M)return b(P);b(r.MV.asHexString(O.visualization.getColorByName(P)))},this.onTabChange=P=>()=>this.setState({activePicker:P}),this.renderPicker=()=>{const{activePicker:P}=this.state,{color:b}=this.props;switch(P){case"spectrum":return(0,t.jsx)(l.A,{color:b,onChange:this.handleChange});case"palette":return(0,t.jsx)(m,{color:b,onChange:this.handleChange});default:return this.renderCustomPicker(P)}},this.renderCustomPicker=P=>{const{customPickers:b,color:M,theme:O}=this.props;return b?s.createElement(b[P].tabComponent,{color:M,theme:O,onChange:this.handleChange}):null},this.renderCustomPickerTabs=()=>{const{customPickers:P}=this.props;return P?(0,t.jsx)(t.Fragment,{children:Object.keys(P).map(b=>(0,t.jsx)("button",{className:this.getTabClassName(b),onClick:this.onTabChange(b),type:"button",children:P[b].name},b))}):null},this.state={activePicker:"palette"}}render(){const{theme:x}=this.props,P=D(x);return(0,t.jsx)(i.n1,{contain:!0,restoreFocus:!0,autoFocus:!0,children:(0,t.jsxs)("div",{tabIndex:-1,className:P.colorPickerPopover,children:[(0,t.jsxs)("div",{className:P.colorPickerPopoverTabs,children:[(0,t.jsx)("button",{className:this.getTabClassName("palette"),onClick:this.onTabChange("palette"),type:"button",children:"Colors"}),(0,t.jsx)("button",{className:this.getTabClassName("spectrum"),onClick:this.onTabChange("spectrum"),type:"button",children:"Custom"}),this.renderCustomPickerTabs()]}),(0,t.jsx)("div",{className:P.colorPickerPopoverContent,children:this.renderPicker()})]})})}}const u=(0,g.cV)(y);u.displayName="ColorPickerPopover";const D=(0,a.N)(E=>({colorPickerPopover:(0,n.css)({borderRadius:E.shape.radius.default,boxShadow:E.shadows.z3,background:E.colors.background.primary,border:`1px solid ${E.colors.border.weak}`,".ColorPickerPopover__tab":{width:"50%",textAlign:"center",padding:E.spacing(1,0),background:E.colors.background.secondary,color:E.colors.text.secondary,fontSize:E.typography.bodySmall.fontSize,cursor:"pointer",border:"none","&:focus:not(:focus-visible)":{outline:"none",boxShadow:"none"},":focus-visible":{position:"relative"}},".ColorPickerPopover__tab--active":{color:E.colors.text.primary,fontWeight:E.typography.fontWeightMedium,background:E.colors.background.primary}}),colorPickerPopoverContent:(0,n.css)({width:"246px",fontSize:E.typography.bodySmall.fontSize,minHeight:"184px",padding:E.spacing(1),display:"flex",flexDirection:"column"}),colorPickerPopoverTabs:(0,n.css)({display:"flex",width:"100%",borderRadius:`${E.shape.radius.default} ${E.shape.radius.default} 0 0`})}))},83876:(k,R,e)=>{"use strict";e.d(R,{h:()=>c,q:()=>o});var t=e(74848),n=e(32196),i=e(95382),s=e(96540),r=e(84140),g=e(13544),a=e(40845),c=(f=>(f.Small="small",f.Large="large",f))(c||{});const o=s.forwardRef(({color:f,label:d,variant:p="small",isSelected:m,"aria-label":v,...l},y)=>{const u=(0,a.$j)(),{isFocusVisible:D,focusProps:E}=(0,i.o)(),x=h(u,p,f,D,m),P=!!d,b=v||d;return(0,t.jsxs)("div",{ref:y,className:x.wrapper,"data-testid":g.Tp.components.ColorSwatch.name,...l,children:[P&&(0,t.jsx)("span",{className:x.label,children:d}),(0,t.jsx)("button",{className:x.swatch,...E,"aria-label":b?`${b} color`:"Pick a color",type:"button"})]})}),h=(f,d,p,m,v)=>{const l=(0,r.A)(p),u=d==="small"?"16px":"32px";let D="none";return l.getAlpha()<.1&&(D=`2px solid ${f.colors.border.medium}`),{wrapper:(0,n.css)({display:"flex",alignItems:"center",cursor:"pointer"}),label:(0,n.css)({marginRight:f.spacing(1)}),swatch:(0,n.css)({width:u,height:u,background:`${p}`,border:D,borderRadius:f.shape.radius.circle,outlineOffset:"1px",outline:m?`2px solid  ${f.colors.primary.main}`:"none",boxShadow:v?`inset 0 0 0 2px ${p}, inset 0 0 0 4px ${f.colors.getContrastText(p)}`:"none",[f.transitions.handleMotion("no-preference")]:{transition:f.transitions.create(["transform"],{duration:f.transitions.duration.short})},"&:hover":{transform:"scale(1.1)"},"@media (forced-colors: active)":{forcedColorAdjust:"none"}})}};o.displayName="ColorSwatch"},70104:(k,R,e)=>{"use strict";e.d(R,{o:()=>g,t:()=>a});var t=e(74848),n=e(40845),i=e(14186),s=e(15292),r=e(70045);const g=c=>{const{yaxis:o,onToggleAxis:h,color:f,...d}=c,p=h?{yaxis:{name:"Y-Axis",tabComponent(){return(0,t.jsx)(i.I,{labelWidth:20,label:"Use right y-axis",children:(0,t.jsx)(s.K,{value:o===2,label:"Use right y-axis",onChange:h})})}}}:void 0;return(0,t.jsx)(r.$,{...d,color:f||"#000000",customPickers:p})},a=(0,n.cV)(g)},95151:(k,R,e)=>{"use strict";e.d(R,{$:()=>f,A:()=>d});var t=e(74848),n=e(32196),i=e(96540),s=e(7612),r=e(65229),g=e(84140),a=e(23596),c=e(40845),o=e(36314);const h=({color:p,onChange:m})=>{const[v,l]=(0,i.useState)(p);(0,r.A)(E=>{m(a.MV.asHexString(y.visualization.getColorByName(E)))},500,[v]);const y=(0,c.$j)(),u=(0,c.of)(f),D=(0,i.useMemo)(()=>v.startsWith("rgba")?v:(0,g.A)(y.visualization.getColorByName(p)).toRgbString(),[v,y,p]);return(0,t.jsxs)("div",{className:u.wrapper,children:[(0,t.jsx)(s.p9,{className:u.root,color:D,onChange:l}),(0,t.jsx)(o.A,{theme:y,color:D,onChange:l,className:u.colorInput})]})},f=p=>({wrapper:(0,n.css)({flexGrow:1}),root:(0,n.css)({"&.react-colorful":{width:"auto"},".react-colorful":{"&__saturation":{borderRadius:`${p.shape.radius.default} ${p.shape.radius.default} 0 0`},"&__alpha":{borderRadius:`0 0 ${p.shape.radius.default} ${p.shape.radius.default}`},"&__alpha, &__hue":{height:p.spacing(2),position:"relative"},"&__pointer":{height:p.spacing(2),width:p.spacing(2)}}}),colorInput:(0,n.css)({marginTop:p.spacing(2)})}),d=h},82702:(k,R,e)=>{"use strict";e.d(R,{Z:()=>g});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(55852);const g=({children:c,className:o,closeOnConfirm:h,confirmText:f="Save",confirmVariant:d="primary",disabled:p=!1,onCancel:m,onClick:v,onConfirm:l,size:y="md"})=>{const u=(0,i.useRef)(null),D=(0,i.useRef)(null),[E,x]=(0,i.useState)(!1),[P,b]=(0,i.useState)(!1),M=(0,s.of)(a);(0,i.useEffect)(()=>{E?(D.current?.focus(),b(!0)):P&&(u.current?.focus(),b(!1))},[P,E]);const O=L=>{L&&L.preventDefault(),x(!0),v?.()},I=L=>{L&&L.preventDefault(),x(!1),u.current?.focus(),m?.()},T=L=>{L&&L.preventDefault(),l?.(),h&&x(!1)},C=(0,n.cx)(o,M.mainButton,{[M.mainButtonHide]:E}),S=(0,n.cx)(M.confirmButton,{[M.confirmButtonHide]:!E}),A=(0,n.cx)(M.confirmButtonContainer,{[M.confirmButtonContainerHide]:!E});return(0,t.jsxs)("div",{className:M.container,children:[(0,t.jsx)("span",{className:C,children:typeof c=="string"?(0,t.jsx)(r.$n,{disabled:p,size:y,fill:"text",onClick:O,ref:u,children:c}):i.cloneElement(c,{disabled:p,onClick:O,ref:u})}),(0,t.jsx)("div",{className:A,children:(0,t.jsxs)("span",{className:S,children:[(0,t.jsx)(r.$n,{size:y,variant:d,onClick:T,ref:D,children:f}),(0,t.jsx)(r.$n,{size:y,fill:"text",onClick:I,children:"Cancel"})]})})]})};g.displayName="ConfirmButton";const a=c=>({container:(0,n.css)({alignItems:"center",display:"flex",justifyContent:"flex-end",position:"relative"}),mainButton:(0,n.css)({opacity:1,[c.transitions.handleMotion("no-preference")]:{transition:c.transitions.create(["opacity"],{duration:c.transitions.duration.shortest,easing:c.transitions.easing.easeOut})},zIndex:2}),mainButtonHide:(0,n.css)({opacity:0,[c.transitions.handleMotion("no-preference")]:{transition:c.transitions.create(["opacity","visibility"],{duration:c.transitions.duration.shortest,easing:c.transitions.easing.easeIn})},visibility:"hidden",zIndex:0}),confirmButtonContainer:(0,n.css)({overflow:"visible",position:"absolute",pointerEvents:"all",right:0}),confirmButtonContainerHide:(0,n.css)({overflow:"hidden",pointerEvents:"none"}),confirmButton:(0,n.css)({alignItems:"flex-start",background:c.colors.background.primary,display:"flex",opacity:1,transform:"translateX(0)",[c.transitions.handleMotion("no-preference")]:{transition:c.transitions.create(["opacity","transform"],{duration:c.transitions.duration.shortest,easing:c.transitions.easing.easeOut})},zIndex:1}),confirmButtonHide:(0,n.css)({opacity:0,transform:"translateX(100%)",[c.transitions.handleMotion("no-preference")]:{transition:c.transitions.create(["opacity","transform","visibility"],{duration:c.transitions.duration.shortest,easing:c.transitions.easing.easeIn})},visibility:"hidden"})})},91605:(k,R,e)=>{"use strict";e.d(R,{e:()=>s});var t=e(74848),n=e(55852),i=e(82702);const s=({size:r,disabled:g,onConfirm:a,"aria-label":c,closeOnConfirm:o})=>(0,t.jsx)(i.Z,{confirmText:"Delete",confirmVariant:"destructive",size:r||"md",disabled:g,onConfirm:a,closeOnConfirm:o,children:(0,t.jsx)(n.$n,{"aria-label":c,variant:"destructive",icon:"times",size:r||"sm"})})},45014:(k,R,e)=>{"use strict";e.d(R,{k:()=>f});var t=e(74848),n=e(32196),i=e(96540),s=e(49785),r=e(13544),g=e(40845),a=e(55852),c=e(88575),o=e(10354),h=e(67061);const f=({body:p,confirmPromptText:m,confirmButtonLabel:v,confirmButtonVariant:l,dismissButtonVariant:y,dismissButtonLabel:u,onConfirm:D,onDismiss:E,onAlternative:x,alternativeButtonLabel:P,description:b,justifyButtons:M="flex-end",disabled:O})=>{const[I,T]=(0,i.useState)(O),C=(0,g.of)(d),S=(0,i.useRef)(null),A=F=>{T(m?.toLowerCase().localeCompare(F.currentTarget.value.toLowerCase())!==0)};(0,i.useEffect)(()=>{S.current?.focus()},[]),(0,i.useEffect)(()=>{T(O?!0:!!m)},[m,O]);const L=async()=>{T(!0);try{await D()}finally{T(!1)}},{handleSubmit:N}=(0,s.mN)();return(0,t.jsxs)("form",{onSubmit:N(L),children:[(0,t.jsxs)("div",{className:C.text,children:[p,b?(0,t.jsx)("div",{className:C.description,children:b}):null,m?(0,t.jsx)("div",{className:C.confirmationInput,children:(0,t.jsx)(h.B,{alignItems:"flex-start",children:(0,t.jsx)(c.D,{disabled:O,children:(0,t.jsx)(o.p,{placeholder:`Type "${m}" to confirm`,onChange:A})})})}):null]}),(0,t.jsx)("div",{className:C.buttonsContainer,children:(0,t.jsxs)(h.B,{justifyContent:M,gap:2,wrap:"wrap",children:[(0,t.jsx)(a.$n,{variant:y,onClick:E,fill:"outline",children:u}),(0,t.jsx)(a.$n,{type:"submit",variant:l,disabled:I,ref:S,"data-testid":r.Tp.pages.ConfirmModal.delete,children:v}),x?(0,t.jsx)(a.$n,{variant:"primary",onClick:x,children:P}):null]})})]})},d=p=>({text:(0,n.css)({fontSize:p.typography.h5.fontSize,color:p.colors.text.primary}),description:(0,n.css)({fontSize:p.typography.body.fontSize}),confirmationInput:(0,n.css)({paddingTop:p.spacing(1)}),buttonsContainer:(0,n.css)({paddingTop:p.spacing(3)})})},96374:(k,R,e)=>{"use strict";e.d(R,{u:()=>g});var t=e(74848),n=e(32196),i=e(40845),s=e(37390),r=e(45014);const g=({isOpen:c,title:o,body:h,description:f,confirmText:d,confirmVariant:p="destructive",confirmationText:m,dismissText:v="Cancel",dismissVariant:l="secondary",alternativeText:y,modalClass:u,icon:D="exclamation-triangle",onConfirm:E,onDismiss:x,onAlternative:P,confirmButtonVariant:b="destructive",disabled:M})=>{const O=(0,i.of)(a);return(0,t.jsx)(s.a,{className:(0,n.cx)(O.modal,u),title:o,icon:D,isOpen:c,onDismiss:x,children:(0,t.jsx)(r.k,{body:h,description:f,confirmButtonLabel:d,dismissButtonLabel:v,dismissButtonVariant:l,confirmPromptText:m,alternativeButtonLabel:y,confirmButtonVariant:b,onConfirm:E,onDismiss:x,onAlternative:P,disabled:M})})},a=()=>({modal:(0,n.css)({width:"500px"})})},28122:(k,R,e)=>{"use strict";e.d(R,{t:()=>a});var t=e(74848),n=e(96540),i=e(29647),s=e(13544),r=e(38138),g=e(17464);const a=n.memo(({x:c,y:o,onClose:h,focusOnOpen:f=!0,renderMenuItems:d,renderHeader:p})=>{const m=(0,n.useRef)(null),[v,l]=(0,n.useState)({});(0,n.useLayoutEffect)(()=>{const x=m.current;if(x){const P=x.getBoundingClientRect(),b=5,M={right:window.innerWidth<c+P.width,bottom:window.innerHeight<o+P.height+b};l({position:"fixed",left:M.right?c-P.width-b:c-b,top:Math.max(0,M.bottom?o-P.height-b:o+b)})}},[c,o]),(0,i.A)(m,()=>{h?.()});const y=p?.(),u=d?.(),D=x=>{f&&x(0)},E=x=>{x.key==="Escape"&&(x.preventDefault(),x.stopPropagation(),h?.())};return(0,t.jsx)(g.ZL,{children:(0,t.jsx)(r.W,{header:y,ref:m,style:v,ariaLabel:s.Tp.components.Menu.MenuComponent("Context"),onOpen:D,onClick:h,onKeyDown:E,children:u})})});a.displayName="ContextMenu"},51686:(k,R,e)=>{"use strict";e.d(R,{n:()=>s});var t=e(74848),n=e(96540),i=e(28122);const s=({children:r,renderMenuItems:g,focusOnOpen:a=!0})=>{const[c,o]=(0,n.useState)(!1),[h,f]=(0,n.useState)({x:0,y:0});return(0,t.jsxs)(t.Fragment,{children:[r({openMenu:d=>{o(!0),f({x:d.pageX,y:d.pageY})}}),c&&(0,t.jsx)(i.t,{onClose:()=>o(!1),x:h.x,y:h.y,renderMenuItems:g,focusOnOpen:a})]})}},40276:(k,R,e)=>{"use strict";e.d(R,{E:()=>c,A:()=>o});var t=e(74848),n=e(32196),i=e(96540),s=e(62295),r=e(40845);const g=({children:d})=>{const[p,m]=(0,i.useState)(!1),[v,l]=(0,i.useState)(!1),y=(0,i.useRef)(null),u=(0,i.useRef)(null),D=(0,r.of)(a);return(0,i.useEffect)(()=>{const E=new IntersectionObserver(x=>{x.forEach(P=>{P.target===y.current?m(!P.isIntersecting):P.target===u.current&&l(!P.isIntersecting)})});return[y,u].forEach(x=>{x.current&&E.observe(x.current)}),()=>E.disconnect()},[]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:(0,n.cx)(D.scrollIndicator,D.scrollTopIndicator,{[D.scrollIndicatorVisible]:p})}),(0,t.jsxs)("div",{className:D.scrollContent,children:[(0,t.jsx)("div",{ref:y}),d,(0,t.jsx)("div",{ref:u})]}),(0,t.jsx)("div",{className:(0,n.cx)(D.scrollIndicator,D.scrollBottomIndicator,{[D.scrollIndicatorVisible]:v})})]})},a=d=>({scrollContent:(0,n.css)({flex:1,position:"relative"}),scrollIndicator:(0,n.css)({height:d.spacing(6),left:0,opacity:0,pointerEvents:"none",position:"absolute",right:0,[d.transitions.handleMotion("no-preference","reduce")]:{transition:d.transitions.create("opacity")},zIndex:1}),scrollTopIndicator:(0,n.css)({background:`linear-gradient(0deg, transparent, ${d.colors.background.canvas})`,top:0}),scrollBottomIndicator:(0,n.css)({background:`linear-gradient(180deg, transparent, ${d.colors.background.canvas})`,bottom:0}),scrollIndicatorVisible:(0,n.css)({opacity:1})}),c=({autoHide:d=!1,autoHideTimeout:p=200,setScrollTop:m,className:v,testId:l,autoHeightMin:y="0",autoHeightMax:u="100%",hideTracksWhenNotNeeded:D=!1,hideHorizontalTrack:E,hideVerticalTrack:x,scrollRefCallback:P,showScrollIndicators:b=!1,updateAfterMountMs:M,scrollTop:O,onScroll:I,children:T,divId:C})=>{const S=(0,i.useRef)(null),A=(0,r.of)(h);(0,i.useEffect)(()=>{S.current&&P&&P(S.current.view)},[S,P]),f(S.current,O),(0,i.useEffect)(()=>{M&&setTimeout(()=>{const V=S.current;V?.update&&V.update()},M)},[M]);function L(V,H,Y){return Y.style&&H&&(Y.style.display="none"),(0,t.jsx)("div",{...Y,className:V})}const N=(0,i.useCallback)(V=>L("track-horizontal",E,V),[E]),F=(0,i.useCallback)(V=>L("track-vertical",x,V),[x]),w=(0,i.useCallback)(V=>(0,t.jsx)("div",{...V,className:"thumb-horizontal"}),[]),B=(0,i.useCallback)(V=>(0,t.jsx)("div",{...V,className:"thumb-vertical"}),[]),U=(0,i.useCallback)(V=>(V.style&&V.style.WebkitOverflowScrolling==="touch"&&(V.style.WebkitOverflowScrolling="auto"),(0,t.jsx)("div",{...V,className:"scrollbar-view",id:C})),[C]),K=(0,i.useCallback)(()=>{S.current&&m&&m(S.current.getValues())},[m]);return(0,t.jsx)(s.Ay,{"data-testid":l,ref:S,className:(0,n.cx)(A.customScrollbar,v,{[A.scrollbarWithScrollIndicators]:b}),onScrollStop:K,autoHeight:!0,autoHide:d,autoHideTimeout:p,hideTracksWhenNotNeeded:D,autoHeightMax:u,autoHeightMin:y,renderTrackHorizontal:N,renderTrackVertical:F,renderThumbHorizontal:w,renderThumbVertical:B,renderView:U,onScroll:I,children:b?(0,t.jsx)(g,{children:T}):T})},o=c,h=d=>({customScrollbar:(0,n.css)({display:"flex",flexGrow:1,".scrollbar-view":{display:"flex",flexGrow:1,flexDirection:"column"},".track-vertical":{borderRadius:d.shape.borderRadius(2),width:`${d.spacing(1)} !important`,right:0,bottom:d.spacing(.25),top:d.spacing(.25)},".track-horizontal":{borderRadius:d.shape.borderRadius(2),height:`${d.spacing(1)} !important`,right:d.spacing(.25),bottom:d.spacing(.25),left:d.spacing(.25)},".thumb-vertical":{background:d.colors.action.focus,borderRadius:d.shape.borderRadius(2),opacity:0},".thumb-horizontal":{background:d.colors.action.focus,borderRadius:d.shape.borderRadius(2),opacity:0},"&:hover":{".thumb-vertical, .thumb-horizontal":{opacity:1,transition:"opacity 0.3s ease-in-out"}}}),scrollbarWithScrollIndicators:(0,n.css)({".scrollbar-view":{position:"static !important"}})});function f(d,p){(0,i.useEffect)(()=>{d&&p!=null&&d.scrollTop(p)},[p,d])}},14689:(k,R,e)=>{"use strict";e.d(R,{R:()=>i});var t=e(74848),n=e(55852);function i({link:s,buttonProps:r}){return(0,t.jsx)("a",{href:s.href,target:s.target,rel:"noreferrer",onClick:s.onClick?g=>{!(g.ctrlKey||g.metaKey||g.shiftKey)&&s.onClick&&(g.preventDefault(),s.onClick(g))}:void 0,children:(0,t.jsx)(n.$n,{icon:s.target==="_blank"?"external-link-alt":void 0,variant:"primary",size:"sm",...r,children:s.title})})}},64078:(k,R,e)=>{"use strict";e.d(R,{l:()=>I});var t=e(74848),n=e(32196),i=e(34743),s=e(36376),r=e(7315),g=e(28848),a=e.n(g),c=e(96540),o=e(80292),h=e(75226),f=e(29317),d=e(91890),p=e(6709),m=e(41781),v=e(40845),l=e(72307),y=e(40276),u=e(10354),D=e(17464),E=e(43538);class x{getBoundingClientRect(){const S=window.getSelection(),A=S&&S.anchorNode;return A&&A.parentElement?A.parentElement.getBoundingClientRect():{top:0,left:0,bottom:0,right:0,width:0,height:0,x:0,y:0,toJSON:()=>{}}}get clientWidth(){return this.getBoundingClientRect().width}get clientHeight(){return this.getBoundingClientRect().height}}const P=(C,S)=>C-S*Math.floor(C/S),b={builtInVariable:{pattern:/(\${\S+?})/}},M=[(0,m.D)({onlyIn:C=>"type"in C&&C.type==="code_block",getSyntax:()=>"links"},{...a().languages,links:b})],O=C=>({input:(0,u.n)({theme:C,invalid:!1}).input,editor:(0,n.css)({".token.builtInVariable":{color:C.colors.success.text},".token.variable":{color:C.colors.primary.text}}),suggestionsWrapper:(0,n.css)({boxShadow:C.shadows.z2}),wrapperOverrides:(0,n.css)({width:"100%","> .slate-query-field__wrapper":{padding:0,backgroundColor:"transparent",border:"none"}})}),I=(0,c.memo)(({value:C,onChange:S,suggestions:A,placeholder:L="http://your-grafana.com/d/000000010/annotations"})=>{const N=(0,c.useRef)(null),F=(0,v.of)(O),[w,B]=(0,c.useState)(!1),[U,K]=(0,c.useState)(0),[V,H]=(0,c.useState)((0,l.mO)(C)),Y=(0,o.A)(V),[X,J]=(0,c.useState)(0),q=[(0,i.cY)(({rects:ie})=>({alignmentAxis:ie.reference.width})),(0,i.UU)({fallbackAxisSideDirection:"start",crossAxis:!1,boundary:document.body}),(0,i.BN)()],{refs:ae,floatingStyles:j}=(0,s.we)({open:w,placement:"bottom-start",onOpenChange:B,middleware:q,whileElementsMounted:r.ll,strategy:"fixed"}),te=(0,c.useRef)({showingSuggestions:w,suggestions:A,suggestionsIndex:U,linkUrl:V,onChange:S});te.current={showingSuggestions:w,suggestions:A,suggestionsIndex:U,linkUrl:V,onChange:S};const ne=(0,c.useRef)(null);(0,c.useEffect)(()=>{J(T(ne.current,U))},[U]);const le=c.useCallback((ie,Z)=>{if(!te.current.showingSuggestions){if(ie.key==="="||ie.key==="$"||ie.keyCode===32&&ie.ctrlKey){const oe=new x;return ae.setReference(oe),B(!0)}return Z()}switch(ie.key){case"Backspace":te.current.linkUrl.focusText.getText().length===1&&Z();case"Escape":return B(!1),K(0);case"Enter":return ie.preventDefault(),ee(te.current.suggestions[te.current.suggestionsIndex]);case"ArrowDown":case"ArrowUp":ie.preventDefault();const oe=ie.key==="ArrowDown"?1:-1;return K(ce=>P(ce+oe,te.current.suggestions.length));default:return Z()}},[]);(0,c.useEffect)(()=>{Y&&Y.selection.isFocused&&!V.selection.isFocused&&te.current.onChange(h.A.serialize(V))},[V,Y]);const z=c.useCallback(({value:ie})=>{H(ie)},[]),ee=(ie,Z=N.current)=>{const ce=se()==="$";ie.origin!==d.$0.Template||ie.value===p.c.includeVars?Z.insertText(`${ce?"":"$"}{${ie.value}}`):Z.insertText(`${ce?"":"$"}{${ie.value}:queryparam}`),H(Z.value),B(!1),K(0),te.current.onChange(h.A.serialize(Z.value))},se=()=>{const ie=document.getElementById("data-link-input");let Z="",oe,ce;return window.getSelection&&(oe=window.getSelection(),oe&&oe.rangeCount>0&&(ce=oe.getRangeAt(0).cloneRange(),ce.collapse(!0),ce.setStart(ie,0),Z=ce.toString().slice(-1))),Z};return(0,t.jsx)("div",{className:F.wrapperOverrides,children:(0,t.jsx)("div",{className:"slate-query-field__wrapper",children:(0,t.jsxs)("div",{id:"data-link-input",className:"slate-query-field",children:[w&&(0,t.jsx)(D.ZL,{children:(0,t.jsx)("div",{ref:ae.setFloating,style:j,children:(0,t.jsx)(y.A,{scrollTop:X,autoHeightMax:"300px",setScrollTop:({scrollTop:ie})=>J(ie),children:(0,t.jsx)(E.k,{activeRef:ne,suggestions:te.current.suggestions,onSuggestionSelect:ee,onClose:()=>B(!1),activeIndex:U})})})}),(0,t.jsx)(f.KE,{schema:l.yx,ref:N,placeholder:L,value:te.current.linkUrl,onChange:z,onKeyDown:(ie,Z,oe)=>le(ie,oe),plugins:M,className:(0,n.cx)(F.editor,F.input,(0,n.css)({padding:"3px 8px"}))})]})})})});I.displayName="DataLinkInput";function T(C,S){return(C?.clientHeight??0)*S}},43538:(k,R,e)=>{"use strict";e.d(R,{k:()=>h});var t=e(74848),n=e(96540),i=e(32196),s=e(2543),r=e.n(s),g=e(37151),a=e(40845),c=e(33552);const o=d=>({list:(0,i.css)({borderBottom:`1px solid ${d.colors.border.weak}`,"&:last-child":{border:"none"}}),wrapper:(0,i.css)({background:d.colors.background.primary,width:"250px"}),item:(0,i.css)({background:"none",padding:"2px 8px",userSelect:"none",color:d.colors.text.primary,cursor:"pointer","&:hover":{background:d.colors.action.hover}}),label:(0,i.css)({color:d.colors.text.secondary}),activeItem:(0,i.css)({background:d.colors.background.secondary,"&:hover":{background:d.colors.background.secondary}}),itemValue:(0,i.css)({fontFamily:d.typography.fontFamilyMonospace,fontSize:d.typography.size.sm})}),h=({suggestions:d,...p})=>{const m=(0,n.useRef)(null);(0,g.A)(m,()=>{p.onClose&&p.onClose()});const v=(0,n.useMemo)(()=>(0,s.groupBy)(d,y=>y.origin),[d]),l=(0,a.of)(o);return(0,t.jsx)("div",{role:"menu",ref:m,className:l.wrapper,children:Object.keys(v).map((y,u)=>{const D=u===0?0:Object.keys(v).reduce((E,x,P)=>P>=u?E:E+v[x].length,0);return(0,n.createElement)(f,{...p,suggestions:v[y],label:`${(0,s.capitalize)(y)}`,activeIndex:p.activeIndex,activeIndexOffset:D,key:y})})})};h.displayName="DataLinkSuggestions";const f=n.memo(({activeIndex:d,activeIndexOffset:p,label:m,onClose:v,onSuggestionSelect:l,suggestions:y,activeRef:u})=>{const D=(0,a.of)(o);return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(c.B,{className:D.list,items:y,renderItem:(E,x)=>{const P=x+p===d;return(0,t.jsx)("div",{role:"menuitem",tabIndex:0,className:(0,i.cx)(D.item,P&&D.activeItem),ref:P?u:void 0,onClick:()=>{l(E)},title:E.documentation,children:(0,t.jsxs)("span",{className:D.itemValue,children:[(0,t.jsx)("span",{className:D.label,children:m})," ",E.label]})})}})})});f.displayName="DataLinkSuggestionsList"},59796:(k,R,e)=>{"use strict";e.d(R,{e:()=>c});var t=e(74848),n=e(32196),i=e(13544),s=e(14555),r=e(51686),g=e(59093),a=e(64539);const c=({children:o,links:h,style:f})=>{const d=[{items:(0,s.J)(h),label:"Data links"}],p=d[0].items.length,m=()=>d.map((l,y)=>(0,t.jsx)(g.r,{label:l.label,children:(l.items||[]).map((u,D)=>(0,t.jsx)(a.D,{url:u.url,label:u.label,target:u.target,icon:u.icon,active:u.active,onClick:u.onClick},`${l.label}-${y}-${D}}`))},`${l.label}${y}`)),v=(0,n.css)({cursor:"context-menu"});if(p>1)return(0,t.jsx)(r.n,{renderMenuItems:m,children:({openMenu:l})=>o({openMenu:l,targetClassName:v})});{const l=h()[0];return(0,t.jsx)("a",{href:l.href,onClick:l.onClick,target:l.target,title:l.title,style:{...f,overflow:"hidden",display:"flex"},"data-testid":i.Tp.components.DataLinksContextMenu.singleLink,children:o({})})}}},64919:(k,R,e)=>{"use strict";e.d(R,{e:()=>P});var t=e(74848),n=e(32196),i=e(91076),s=e(2543),r=e(96540),g=e(40845),a=e(55852),c=e(37390),o=e(14555),h=e(88575),f=e(10354),d=e(15292),p=e(64078);const m=M=>({listItem:(0,n.css)({marginBottom:M.spacing()}),infoText:(0,n.css)({paddingBottom:M.spacing(2),marginLeft:"66px",color:M.colors.text.secondary})}),v=(0,r.memo)(({index:M,value:O,onChange:I,suggestions:T,isLast:C})=>{const S=(0,g.of)(m),A=(F,w)=>{I(M,{...O,url:F},w)},L=F=>{I(M,{...O,title:F.target.value})},N=()=>{I(M,{...O,targetBlank:!O.targetBlank})};return(0,t.jsxs)("div",{className:S.listItem,children:[(0,t.jsx)(h.D,{label:"Title",children:(0,t.jsx)(f.p,{value:O.title,onChange:L,placeholder:"Show details"})}),(0,t.jsx)(h.D,{label:"URL",invalid:(0,o.F)(O.url),error:"Data link is an Explore URL in a deprecated format. Please visit the URL to be redirected, and edit this data link to use that URL.",children:(0,t.jsx)(p.l,{value:O.url,onChange:A,suggestions:T})}),(0,t.jsx)(h.D,{label:"Open in new tab",children:(0,t.jsx)(d.d,{value:O.targetBlank||!1,onChange:N})}),C&&(0,t.jsx)("div",{className:S.infoText,children:"With data links you can reference data variables like series name, labels and values. Type CMD+Space, CTRL+Space, or $ to open variable suggestions."})]})});v.displayName="DataLinkEditor";const l=({link:M,index:O,getSuggestions:I,onSave:T,onCancel:C})=>{const[S,A]=(0,r.useState)(M);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(v,{value:S,index:O,isLast:!1,suggestions:I(),onChange:(L,N)=>{A(N)}}),(0,t.jsxs)(c.a.ButtonRow,{children:[(0,t.jsx)(a.$n,{variant:"secondary",onClick:()=>C(O),fill:"outline",children:"Cancel"}),(0,t.jsx)(a.$n,{onClick:()=>{T(O,S)},children:"Save"})]})]})};var y=e(72093),u=e(14578),D=e(29158);const E=({link:M,onEdit:O,onRemove:I,index:T,itemKey:C})=>{const S=(0,g.of)(x),{title:A="",url:L=""}=M,N=A.trim()!=="",F=L.trim()!=="",w=(0,o.F)(L);return(0,t.jsx)(i.sx,{draggableId:C,index:T,children:B=>(0,t.jsx)(t.Fragment,{children:(0,r.createElement)("div",{className:(0,n.cx)(S.wrapper,S.dragRow),ref:B.innerRef,...B.draggableProps,key:T},(0,t.jsxs)("div",{className:S.linkDetails,children:[(0,t.jsx)("div",{className:(0,n.cx)(S.url,!F&&S.notConfigured,w&&S.errored),children:N?A:"Data link title not provided"}),(0,t.jsx)("div",{className:(0,n.cx)(S.url,!F&&S.notConfigured,w&&S.errored),title:L,children:F?L:"Data link url not provided"}),w&&(0,t.jsx)(y.P,{children:"Explore data link may not work in the future. Please edit."})]}),(0,t.jsxs)("div",{className:S.icons,children:[(0,t.jsx)(D.K,{name:"pen",onClick:O,className:S.icon,tooltip:"Edit data link"}),(0,t.jsx)(D.K,{name:"trash-alt",onClick:I,className:S.icon,tooltip:"Remove data link"}),(0,t.jsx)("div",{className:S.dragIcon,...B.dragHandleProps,children:(0,t.jsx)(u.I,{name:"draggabledots",size:"lg"})})]}))})},C)},x=M=>({wrapper:(0,n.css)({display:"flex",flexGrow:1,alignItems:"center",justifyContent:"space-between",width:"100%",padding:"5px 0 5px 10px",borderRadius:M.shape.radius.default,background:M.colors.background.secondary,gap:8}),linkDetails:(0,n.css)({display:"flex",flexDirection:"column",flexGrow:1,maxWidth:"calc(100% - 100px)"}),errored:(0,n.css)({color:M.colors.error.text,fontStyle:"italic"}),notConfigured:(0,n.css)({fontStyle:"italic"}),title:(0,n.css)({color:M.colors.text.primary,fontSize:M.typography.size.sm,fontWeight:M.typography.fontWeightMedium}),url:(0,n.css)({color:M.colors.text.secondary,fontSize:M.typography.size.sm,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}),dragRow:(0,n.css)({position:"relative"}),icons:(0,n.css)({display:"flex",padding:6,alignItems:"center",gap:8}),dragIcon:(0,n.css)({cursor:"grab",color:M.colors.text.secondary,margin:M.spacing(0,.5)}),icon:(0,n.css)({color:M.colors.text.secondary})}),P=({links:M,onChange:O,getSuggestions:I,data:T,showOneClick:C=!1})=>{const[S,A]=(0,r.useState)(null),[L,N]=(0,r.useState)(!1),[F,w]=(0,r.useState)([]);(0,r.useEffect)(()=>{w(M??[])},[M]);const B=(0,g.of)(b),U=S!==null,K=(q,ae)=>{if(L)if(ae.title.trim()===""&&ae.url.trim()===""){N(!1),A(null);return}else A(null),N(!1);const j=(0,s.cloneDeep)(F);j[q]=ae,O(j),A(null)},V=()=>{let q=(0,s.cloneDeep)(F);A(q.length),N(!0)},H=q=>{L&&N(!1),A(null)},Y=q=>{const ae=(0,s.cloneDeep)(F);ae.splice(q,1),O(ae)},X=q=>{if(!M||!q.destination)return;const ae=(0,s.cloneDeep)(F),j=ae[q.source.index];ae.splice(q.source.index,1),ae.splice(q.destination.index,0,j),w(ae),O(ae)},J=(q,ae)=>C?(0,t.jsxs)("div",{className:B.oneClickOverlay,children:[(0,t.jsx)("span",{className:B.oneClickSpan,children:"One-click link"}),q]},ae):q;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.JY,{onDragEnd:X,children:(0,t.jsx)(i.gL,{droppableId:"sortable-links",direction:"vertical",children:q=>(0,t.jsxs)("div",{className:B.wrapper,ref:q.innerRef,...q.droppableProps,children:[F.map((ae,j)=>{const te=`${ae.title}/${j}`,ne=(0,t.jsx)("div",{className:B.itemWrapper,children:(0,t.jsx)(E,{index:j,link:ae,onChange:K,onEdit:()=>A(j),onRemove:()=>Y(j),data:T,itemKey:te},te)},te);return j===0?J(ne,te):ne}),q.placeholder]})})}),U&&S!==null&&(0,t.jsx)(c.a,{title:"Edit link",isOpen:!0,closeOnBackdropClick:!1,onDismiss:()=>{H(S)},children:(0,t.jsx)(l,{index:S,link:L?{title:"",url:""}:F[S],data:T,onSave:K,onCancel:H,getSuggestions:I})}),(0,t.jsx)(a.$n,{size:"sm",icon:"plus",onClick:V,variant:"secondary",className:B.button,children:"Add link"})]})},b=M=>({wrapper:(0,n.css)({marginBottom:M.spacing(2),display:"flex",flexDirection:"column"}),oneClickOverlay:(0,n.css)({height:"auto",border:`2px dashed ${M.colors.text.link}`,fontSize:10,color:M.colors.text.primary,marginBottom:M.spacing(1)}),oneClickSpan:(0,n.css)({padding:10,marginBottom:-10,display:"inline-block"}),itemWrapper:(0,n.css)({padding:"4px 8px 8px 8px"}),button:(0,n.css)({marginLeft:M.spacing(1)})})},79961:(k,R,e)=>{"use strict";e.d(R,{n:()=>g});var t=e(74848),n=e(32196),i=e(40845),s=e(14578),r=e(14689);function g({links:c}){const o=(0,i.of)(a);if(c.length===1)return(0,t.jsx)(r.R,{link:c[0]});const h=c.filter(d=>d.target==="_blank"),f=c.filter(d=>d.target==="_self");return(0,t.jsxs)(t.Fragment,{children:[f.map((d,p)=>(0,t.jsx)(r.R,{link:d},p)),(0,t.jsxs)("div",{className:o.wrapper,children:[(0,t.jsx)("p",{className:o.externalLinksHeading,children:"External links"}),h.map((d,p)=>(0,t.jsxs)("a",{href:d.href,target:d.target,className:o.externalLink,children:[(0,t.jsx)(s.I,{name:"external-link-alt"}),d.title]},p))]})]})}const a=c=>({wrapper:(0,n.css)({flexBasis:"150px",width:"100px",marginTop:c.spacing(1)}),externalLinksHeading:(0,n.css)({color:c.colors.text.secondary,fontWeight:c.typography.fontWeightRegular,fontSize:c.typography.size.sm,margin:0}),externalLink:(0,n.css)({color:c.colors.text.link,fontWeight:c.typography.fontWeightRegular,display:"block",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis","&:hover":{textDecoration:"underline"},div:{marginRight:c.spacing(1)}})})},19849:(k,R,e)=>{"use strict";e.d(R,{i:()=>s});var t=e(74848),n=e(15292),i=e(14186);function s({options:r,onOptionsChange:g}){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h3",{className:"page-heading",children:"Alerting"}),(0,t.jsx)("div",{className:"gf-form-group",children:(0,t.jsx)("div",{className:"gf-form-inline",children:(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsx)(i.I,{labelWidth:29,label:"Manage alert rules in Alerting UI",disabled:r.readOnly,tooltip:"Manage alert rules for this data source. To manage other alerting resources, add an Alertmanager data source.",children:(0,t.jsx)(n.K,{value:r.jsonData.manageAlerts!==!1,onChange:a=>g({...r,jsonData:{...r.jsonData,manageAlerts:a.currentTarget.checked}})})})})})})]})}},28623:(k,R,e)=>{"use strict";e.d(R,{K:()=>a});var t=e(74848),n=e(55852),i=e(14186),s=e(39268),r=e(10354),g=e(21744);const a=({hasCert:c,label:o,onChange:h,onClick:f,placeholder:d})=>(0,t.jsxs)(s.C,{children:[(0,t.jsx)(i.I,{label:o,labelWidth:14,disabled:c,children:c?(0,t.jsx)(r.p,{type:"text",value:"configured",width:24}):(0,t.jsx)(g.f,{rows:7,onChange:h,placeholder:d,required:!0})}),c&&(0,t.jsx)(n.$n,{variant:"secondary",onClick:f,style:{marginLeft:4},children:"Reset"})]})},11184:(k,R,e)=>{"use strict";e.d(R,{P:()=>p});var t=e(74848),n=e(32196),i=e(2543),s=e.n(i),r=e(96540),g=e(40845),a=e(55852),c=e(90090),o=e(14578),h=e(56286);const f=()=>({layout:(0,n.css)({display:"flex",alignItems:"center",marginBottom:"4px","> *":{marginLeft:"4px",marginBottom:0,height:"100%","&:first-child, &:last-child":{marginLeft:0}}})}),d=({header:v,onBlur:l,onChange:y,onRemove:u,onReset:D})=>{const E=(0,g.of)(f);return(0,t.jsxs)("div",{className:E.layout,children:[(0,t.jsx)(c.z,{label:"Header",name:"name",placeholder:"X-Custom-Header",labelWidth:5,value:v.name||"",onChange:x=>y({...v,name:x.target.value}),onBlur:l}),(0,t.jsx)(h.L,{label:"Value","aria-label":"Value",name:"value",isConfigured:v.configured,value:v.value,labelWidth:5,inputWidth:v.configured?11:12,placeholder:"Header Value",onReset:()=>D(v.id),onChange:x=>y({...v,value:x.target.value}),onBlur:l}),(0,t.jsx)(a.$n,{type:"button","aria-label":"Remove header",variant:"secondary",size:"xs",onClick:x=>u(v.id),children:(0,t.jsx)(o.I,{name:"trash-alt"})})]})};d.displayName="CustomHeaderRow";class p extends r.PureComponent{constructor(l){super(l),this.state={headers:[]},this.updateSettings=()=>{const{headers:E}=this.state,x=Object.fromEntries(Object.entries(this.props.dataSourceConfig.jsonData).filter(([b,M])=>!b.startsWith("httpHeaderName"))),P=Object.fromEntries(Object.entries(this.props.dataSourceConfig.secureJsonData||{}).filter(([b,M])=>!b.startsWith("httpHeaderValue")));for(const[b,M]of E.entries())x[`httpHeaderName${b+1}`]=M.name,M.configured||(P[`httpHeaderValue${b+1}`]=M.value);this.props.onChange({...this.props.dataSourceConfig,jsonData:x,secureJsonData:P})},this.onHeaderAdd=()=>{this.setState(E=>({headers:[...E.headers,{id:(0,i.uniqueId)(),name:"",value:"",configured:!1}]}))},this.onHeaderChange=(E,x)=>{this.setState(({headers:P})=>({headers:P.map((b,M)=>E!==M?b:{...x})}))},this.onHeaderReset=E=>{this.setState(({headers:x})=>({headers:x.map((P,b)=>P.id!==E?P:{...P,value:"",configured:!1})}))},this.onHeaderRemove=E=>{this.setState(({headers:x})=>({headers:x.filter(P=>P.id!==E)}),this.updateSettings)};const{jsonData:y,secureJsonData:u,secureJsonFields:D}=this.props.dataSourceConfig;this.state={headers:Object.keys(y).sort().filter(E=>E.startsWith("httpHeaderName")).map((E,x)=>({id:(0,i.uniqueId)(),name:y[E],value:u!==void 0?u[E]:"",configured:D&&D[`httpHeaderValue${x+1}`]||!1}))}}render(){const{headers:l}=this.state,{dataSourceConfig:y}=this.props;return(0,t.jsxs)("div",{className:"gf-form-group",children:[(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsx)("h6",{children:"Custom HTTP Headers"})}),(0,t.jsx)("div",{children:l.map((u,D)=>(0,t.jsx)(d,{header:u,onChange:E=>{this.onHeaderChange(D,E)},onBlur:this.updateSettings,onRemove:this.onHeaderRemove,onReset:this.onHeaderReset},u.id))}),!y.readOnly&&(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsx)(a.$n,{variant:"secondary",icon:"plus",type:"button",onClick:u=>{this.onHeaderAdd()},children:"Add header"})})]})}}var m=null},91409:(k,R,e)=>{"use strict";e.d(R,{t:()=>T});var t=e(74848),n=e(32196),i=e(96540),s=e(13544),r=e(40845),g=e(42418),a=e(90090),c=e(38894),o=e(14186),h=e(91634),f=e(14578),d=e(90182),p=e(15292),m=e(79924),v=e(94753),l=e(56286);const y=({dataSourceConfig:C,onChange:S})=>{const A=C.secureJsonData?C.secureJsonData.basicAuthPassword:"",L=()=>{S({...C,secureJsonData:{...C.secureJsonData,basicAuthPassword:""},secureJsonFields:{...C.secureJsonFields,basicAuthPassword:!1}})},N=F=>{S({...C,secureJsonData:{...C.secureJsonData,basicAuthPassword:F.currentTarget.value}})};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.I,{disabled:C.readOnly,children:(0,t.jsx)(a.z,{label:"User",labelWidth:10,inputWidth:18,placeholder:"user",value:C.basicAuthUser,onChange:F=>S({...C,basicAuthUser:F.currentTarget.value})})}),(0,t.jsx)(o.I,{disabled:C.readOnly,children:(0,t.jsx)(l.L,{isConfigured:!!(C.secureJsonFields&&C.secureJsonFields.basicAuthPassword),value:A||"",inputWidth:18,labelWidth:10,onReset:L,onChange:N})})]})};var u=e(11184);const D=26,E=({dataSourceConfig:C,onChange:S,showForwardOAuthIdentityOption:A=!0})=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"gf-form-inline",children:[(0,t.jsx)(o.I,{label:"TLS Client Auth",labelWidth:D,disabled:C.readOnly,children:(0,t.jsx)(p.K,{id:"http-settings-tls-client-auth",value:C.jsonData.tlsAuth||!1,onChange:L=>S({...C.jsonData,tlsAuth:L.currentTarget.checked})})}),(0,t.jsx)(o.I,{label:"With CA Cert",tooltip:"Needed for verifying self-signed TLS Certs",labelWidth:D,disabled:C.readOnly,children:(0,t.jsx)(p.K,{id:"http-settings-ca-cert",value:C.jsonData.tlsAuthWithCACert||!1,onChange:L=>S({...C.jsonData,tlsAuthWithCACert:L.currentTarget.checked})})})]}),(0,t.jsx)("div",{className:"gf-form-inline",children:(0,t.jsx)(o.I,{label:"Skip TLS Verify",labelWidth:D,disabled:C.readOnly,children:(0,t.jsx)(p.K,{id:"http-settings-skip-tls-verify",value:C.jsonData.tlsSkipVerify||!1,onChange:L=>S({...C.jsonData,tlsSkipVerify:L.currentTarget.checked})})})}),A&&(0,t.jsx)("div",{className:"gf-form-inline",children:(0,t.jsx)(o.I,{label:"Forward OAuth Identity",tooltip:"Forward the user's upstream OAuth identity to the data source (Their access token gets passed along).",labelWidth:D,disabled:C.readOnly,children:(0,t.jsx)(p.K,{id:"http-settings-forward-oauth",value:C.jsonData.oauthPassThru||!1,onChange:L=>S({...C.jsonData,oauthPassThru:L.currentTarget.checked})})})})]});var x=e(17081),P=e(95180);const b=[{label:"Server (default)",value:"proxy"},{label:"Browser",value:"direct"}],M={label:"Server (default)",value:"proxy"},O=()=>(0,t.jsxs)(g.F,{severity:"info",title:"",topSpacing:3,children:[(0,t.jsxs)("p",{children:["Access mode controls how requests to the data source will be handled.",(0,t.jsxs)("strong",{children:["\xA0",(0,t.jsx)("i",{children:"Server"})]})," ","should be the preferred way if nothing else is stated."]}),(0,t.jsx)(v.E,{weight:"medium",children:"Server access mode (Default):"}),(0,t.jsx)("p",{children:"All requests will be made from the browser to Grafana backend/server which in turn will forward the requests to the data source and by that circumvent possible Cross-Origin Resource Sharing (CORS) requirements. The URL needs to be accessible from the grafana backend/server if you select this access mode."}),(0,t.jsx)(v.E,{weight:"medium",children:"Browser access mode:"}),(0,t.jsx)("p",{children:"All requests will be made from the browser directly to the data source and may be subject to Cross-Origin Resource Sharing (CORS) requirements. The URL needs to be accessible from the browser if you select this access mode."})]}),I=26,T=C=>{const{defaultUrl:S,dataSourceConfig:A,onChange:L,showAccessOptions:N,sigV4AuthToggleEnabled:F,showForwardOAuthIdentityOption:w,azureAuthSettings:B,renderSigV4Editor:U,secureSocksDSProxyEnabled:K,urlLabel:V,urlDocs:H}=C,[Y,X]=(0,i.useState)(!1),[J,q]=(0,i.useState)(!1),ae=(0,r.$j)();let j;const te=(0,i.useCallback)(Z=>{const oe=B?.azureAuthSupported&&B.getAzureAuthEnabled(A)||!1;if(q(oe),oe){const ce=A.jsonData.oauthPassThru!==void 0?A.jsonData.oauthPassThru:!1;Z={...Z,jsonData:{...A.jsonData,oauthPassThru:oe?!1:ce}}}L({...A,...Z})},[B,A,L]);switch(A.access){case"direct":j=(0,t.jsxs)(t.Fragment,{children:["Your access method is ",(0,t.jsx)("em",{children:"Browser"}),", this means the URL needs to be accessible from the browser.",H]});break;case"proxy":j=(0,t.jsxs)(t.Fragment,{children:["Your access method is ",(0,t.jsx)("em",{children:"Server"}),", this means the URL needs to be accessible from the grafana backend/server.",H]});break;default:j=(0,t.jsxs)(t.Fragment,{children:["Specify a complete HTTP URL (for example http://your_server:8080) ",H]})}const ne=(0,t.jsx)(d.l6,{"aria-label":"Access",className:"width-20 gf-form-input",options:b,value:b.filter(Z=>Z.value===A.access)[0]||M,onChange:Z=>te({access:Z.value}),disabled:A.readOnly}),le=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/.test(A.url),z=(0,n.css)({boxShadow:`inset 0 0px 5px ${ae.v1.palette.red}`}),ee=(0,n.cx)({"width-20":!0,[z]:!le}),se=(0,i.useId)(),ie=(0,t.jsx)(h.p,{id:se,className:ee,placeholder:S,value:A.url,"data-testid":s.Tp.components.DataSource.DataSourceHttpSettings.urlInput,onChange:Z=>te({url:Z.currentTarget.value}),disabled:A.readOnly});return(0,t.jsxs)("div",{className:"gf-form-group",children:[(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h3",{className:"page-heading",children:"HTTP"}),(0,t.jsxs)("div",{className:"gf-form-group",children:[(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsx)(a.z,{interactive:!!H,label:V??"URL",labelWidth:13,tooltip:j,inputEl:ie})}),N&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"gf-form-inline",children:[(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsx)(a.z,{label:"Access",labelWidth:13,inputWidth:20,inputEl:ne})}),(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsxs)("button",{type:"button",className:"gf-form-label query-keyword pointer",onClick:()=>X(Z=>!Z),children:["Help\xA0",(0,t.jsx)(f.I,{name:Y?"angle-down":"angle-right",style:{marginBottom:0}})]})})]}),Y&&(0,t.jsx)(O,{})]}),A.access==="proxy"&&(0,t.jsxs)("div",{className:"gf-form-group",children:[(0,t.jsxs)("div",{className:"gf-form",children:[(0,t.jsx)(c.I,{width:13,tooltip:"Grafana proxy deletes forwarded cookies by default. Specify cookies by name that should be forwarded to the data source.",children:"Allowed cookies"}),(0,t.jsx)(m.u,{tags:A.jsonData.keepCookies,width:40,onChange:Z=>te({jsonData:{...A.jsonData,keepCookies:Z}}),disabled:A.readOnly})]}),(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsx)(a.z,{label:"Timeout",type:"number",labelWidth:13,inputWidth:20,tooltip:"HTTP request timeout in seconds",placeholder:"Timeout in seconds","aria-label":"Timeout in seconds",value:A.jsonData.timeout,onChange:Z=>{te({jsonData:{...A.jsonData,timeout:parseInt(Z.currentTarget.value,10)}})},disabled:A.readOnly})})]})]})]}),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h3",{className:"page-heading",children:"Auth"}),(0,t.jsxs)("div",{className:"gf-form-group",children:[(0,t.jsxs)("div",{className:"gf-form-inline",children:[(0,t.jsx)(o.I,{label:"Basic auth",labelWidth:I,disabled:A.readOnly,children:(0,t.jsx)(p.K,{id:"http-settings-basic-auth",value:A.basicAuth,onChange:Z=>{te({basicAuth:Z.currentTarget.checked})}})}),(0,t.jsx)(o.I,{label:"With Credentials",tooltip:"Whether credentials such as cookies or auth headers should be sent with cross-site requests.",labelWidth:I,disabled:A.readOnly,children:(0,t.jsx)(p.K,{id:"http-settings-with-credentials",value:A.withCredentials,onChange:Z=>{te({withCredentials:Z.currentTarget.checked})}})})]}),B?.azureAuthSupported&&(0,t.jsx)("div",{className:"gf-form-inline",children:(0,t.jsx)(o.I,{label:"Azure Authentication",tooltip:"Use Azure authentication for Azure endpoint.",labelWidth:I,disabled:A.readOnly,children:(0,t.jsx)(p.K,{id:"http-settings-azure-auth",value:J,onChange:Z=>{te(B.setAzureAuthEnabled(A,Z.currentTarget.checked))}})})}),F&&(0,t.jsx)("div",{className:"gf-form-inline",children:(0,t.jsx)(o.I,{label:"SigV4 auth",labelWidth:I,disabled:A.readOnly,children:(0,t.jsx)(p.K,{id:"http-settings-sigv4-auth",value:A.jsonData.sigV4Auth||!1,onChange:Z=>{te({jsonData:{...A.jsonData,sigV4Auth:Z.currentTarget.checked}})}})})}),A.access==="proxy"&&(0,t.jsx)(E,{dataSourceConfig:A,onChange:Z=>te({jsonData:Z}),showForwardOAuthIdentityOption:J?!1:w})]}),A.basicAuth&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h6",{children:"Basic Auth Details"}),(0,t.jsx)("div",{className:"gf-form-group",children:(0,t.jsx)(y,{...C})})]}),B?.azureAuthSupported&&J&&B.azureSettingsUI&&(0,t.jsx)(B.azureSettingsUI,{dataSourceConfig:A,onChange:L}),A.jsonData.sigV4Auth&&F&&U,(A.jsonData.tlsAuth||A.jsonData.tlsAuthWithCACert)&&(0,t.jsx)(P.j,{dataSourceConfig:A,onChange:L}),A.access==="proxy"&&(0,t.jsx)(u.P,{dataSourceConfig:A,onChange:L})]}),K&&(0,t.jsx)(x.Y,{options:A,onOptionsChange:L})]})}},17081:(k,R,e)=>{"use strict";e.d(R,{Y:()=>s});var t=e(74848),n=e(15292),i=e(14186);function s({options:r,onOptionsChange:g}){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h3",{className:"page-heading",children:"Secure Socks Proxy"}),(0,t.jsx)("div",{className:"gf-form-group",children:(0,t.jsx)("div",{className:"gf-form-inline",children:(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsx)(i.I,{labelWidth:26,label:"Enabled",tooltip:"Connect to this datasource via the secure socks proxy.",children:(0,t.jsx)(n.K,{value:r.jsonData.enableSecureSocksProxy??!1,onChange:a=>g({...r,jsonData:{...r.jsonData,enableSecureSocksProxy:a.currentTarget.checked}})})})})})})]})}},95180:(k,R,e)=>{"use strict";e.d(R,{j:()=>a});var t=e(74848),n=e(32196),i=e(90090),s=e(14578),r=e(56034),g=e(28623);const a=({dataSourceConfig:c,onChange:o})=>{const h=c.secureJsonFields&&c.secureJsonFields.tlsCACert,f=c.secureJsonFields&&c.secureJsonFields.tlsClientCert,d=c.secureJsonFields&&c.secureJsonFields.tlsClientKey,p=c.jsonData&&c.jsonData.serverName,m=y=>u=>{u.preventDefault();const D={...c.secureJsonFields};D[y]=!1,o({...c,secureJsonFields:D})},v=y=>u=>{const D={...c.secureJsonData};D[y]=u.currentTarget.value,o({...c,secureJsonData:D})},l=y=>{const u={...c.jsonData,serverName:y.currentTarget.value};o({...c,jsonData:u})};return(0,t.jsxs)("div",{className:"gf-form-group",children:[(0,t.jsxs)("div",{className:(0,n.cx)("gf-form",(0,n.css)({alignItems:"baseline"})),children:[(0,t.jsx)("h6",{children:"TLS/SSL Auth Details"}),(0,t.jsx)(r.m,{placement:"right-end",content:"TLS/SSL Certs are encrypted and stored in the Grafana database.",theme:"info",children:(0,t.jsx)(s.I,{name:"info-circle",size:"xs",style:{marginLeft:"10px"}})})]}),(0,t.jsxs)("div",{children:[c.jsonData.tlsAuthWithCACert&&(0,t.jsx)(g.K,{hasCert:!!h,onChange:v("tlsCACert"),placeholder:"Begins with -----BEGIN CERTIFICATE-----",label:"CA Cert",onClick:m("tlsCACert")}),c.jsonData.tlsAuth&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsx)(i.z,{label:"ServerName",labelWidth:7,inputWidth:30,placeholder:"domain.example.com",value:p&&c.jsonData.serverName,onChange:l})}),(0,t.jsx)(g.K,{hasCert:!!f,label:"Client Cert",onChange:v("tlsClientCert"),placeholder:"Begins with -----BEGIN CERTIFICATE-----",onClick:m("tlsClientCert")}),(0,t.jsx)(g.K,{hasCert:!!d,label:"Client Key",placeholder:"Begins with -----BEGIN RSA PRIVATE KEY-----",onChange:v("tlsClientKey"),onClick:m("tlsClientKey")})]})]})]})}},56181:(k,R,e)=>{"use strict";e.d(R,{l:()=>o});var t=e(74848),n=e(32196),i=e(96540),s=e(29426),r=e(40845),g=e(8866),a=e(14578),c=e(72265);const o=(0,i.memo)(d=>{const p=(0,r.of)(f),{isOpen:m,onClose:v}=d;return m?(0,t.jsx)(g.N,{useCapture:!0,includeButtonPress:!1,onClick:v,children:(0,t.jsx)("div",{className:p.modal,"data-testid":"date-picker",children:(0,t.jsx)(h,{...d})})}):null});o.displayName="DatePicker";const h=(0,i.memo)(({value:d,minDate:p,maxDate:m,onChange:v})=>{const l=(0,r.of)(c.h2);return(0,t.jsx)(s.Ay,{className:l.body,tileClassName:l.title,value:d||new Date,minDate:p,maxDate:m,nextLabel:(0,t.jsx)(a.I,{name:"angle-right"}),prevLabel:(0,t.jsx)(a.I,{name:"angle-left"}),onChange:y=>{y&&!Array.isArray(y)&&v(y)},locale:"en"})});h.displayName="Body";const f=d=>({modal:(0,n.css)({zIndex:d.zIndex.modal,boxShadow:d.shadows.z3,backgroundColor:d.colors.background.primary,border:`1px solid ${d.colors.border.weak}`,borderTopLeftRadius:d.shape.radius.default,borderBottomLeftRadius:d.shape.radius.default,"button:disabled":{color:d.colors.text.disabled}})})},98239:(k,R,e)=>{"use strict";e.d(R,{l:()=>d});var t=e(74848),n=e(32196),i=e(34743),s=e(36376),r=e(7315),g=e(96540),a=e(47232),c=e(40845),o=e(10354),h=e(56181);const f=m=>(0,a.KQ)(m).format("L"),d=({value:m,minDate:v,maxDate:l,onChange:y,closeOnSelect:u,placeholder:D="Date",...E})=>{const[x,P]=(0,g.useState)(!1),b=(0,c.of)(p),M=[(0,i.UU)({crossAxis:!1,boundary:document.body}),(0,i.BN)()],{context:O,refs:I,floatingStyles:T}=(0,s.we)({open:x,placement:"bottom-start",onOpenChange:P,middleware:M,whileElementsMounted:r.ll,strategy:"fixed"}),C=(0,s.kp)(O),S=(0,s.s9)(O),{getReferenceProps:A,getFloatingProps:L}=(0,s.bv)([S,C]);return(0,t.jsxs)("div",{className:b.container,children:[(0,t.jsx)(o.p,{ref:I.setReference,type:"text",autoComplete:"off",placeholder:D,value:m&&f(m),onChange:N=>{N.target.value===""&&y("")},className:b.input,...E,...A()}),(0,t.jsx)("div",{className:b.popover,ref:I.setFloating,style:T,...L(),children:(0,t.jsx)(h.l,{isOpen:x,value:m&&typeof m!="string"?m:(0,a.KQ)().toDate(),minDate:v,maxDate:l,onChange:N=>{y(N),u&&P(!1)},onClose:()=>P(!1)})})]})},p=m=>({container:(0,n.css)({position:"relative"}),input:(0,n.css)({"input[type='date']::-webkit-inner-spin-button, input[type='date']::-webkit-calendar-picker-indicator":{display:"none",WebkitAppearance:"none"}}),popover:(0,n.css)({zIndex:m.zIndex.tooltip})})},63383:(k,R,e)=>{"use strict";e.d(R,{K:()=>C});var t=e(74848),n=e(32196),i=e(34743),s=e(36376),r=e(7315),g=e(18828),a=e(85690),c=e(93225),o=e(96540),h=e(29426),f=e(49045),d=e(72724),p=e(47232),m=e(1933),v=e(13390),l=e(40845),y=e(55852),u=e(14186),D=e(14578),E=e(10354),x=e(67061),P=e(88448),b=e(17464),M=e(66070),O=e(72265),I=e(47619),T=e(99225);const C=({date:N,maxDate:F,minDate:w,label:B,onChange:U,disabledHours:K,disabledMinutes:V,disabledSeconds:H,timeZone:Y,showSeconds:X=!0,clearable:J=!1})=>{const[q,ae]=(0,o.useState)(!1),j=(0,o.useRef)(null),{overlayProps:te,underlayProps:ne}=(0,c.e)({onClose:()=>ae(!1),isDismissable:!0,isOpen:q,shouldCloseOnInteractOutside:ue=>{const De=document.getElementsByClassName(M.i)[0];return!(De&&De.contains(ue))}},j),{dialogProps:le}=(0,g.s)({},j),z=(0,l.$j)(),{modalBackdrop:ee}=(0,l.of)(P.o),se=(0,f.A)(`(min-width: ${z.breakpoints.values.lg}px)`),ie=(0,l.of)(L),Z=[(0,i.UU)({crossAxis:!1,boundary:document.body}),(0,i.BN)()],{refs:oe,floatingStyles:ce}=(0,s.we)({open:q,placement:"bottom-start",onOpenChange:ae,middleware:Z,whileElementsMounted:r.ll,strategy:"fixed"}),ye=(0,o.useCallback)(ue=>{ae(!1),U(ue)},[U]),re=(0,o.useCallback)(ue=>{ue.preventDefault(),ae(!0)},[ae]);return(0,t.jsxs)("div",{"data-testid":"date-time-picker",style:{position:"relative"},children:[(0,t.jsx)(S,{date:N,onChange:U,isFullscreen:se,onOpen:re,label:B,ref:oe.setReference,showSeconds:X,clearable:J,timeZone:Y}),q?se?(0,t.jsx)(b.ZL,{children:(0,t.jsx)(a.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,t.jsx)("div",{ref:j,...te,...le,children:(0,t.jsx)(A,{date:N,onChange:ye,isFullscreen:!0,onClose:()=>ae(!1),maxDate:F,minDate:w,ref:oe.setFloating,style:ce,showSeconds:X,disabledHours:K,disabledMinutes:V,disabledSeconds:H,timeZone:Y})})})}):(0,t.jsxs)(b.ZL,{children:[(0,t.jsx)("div",{className:ee,...ne}),(0,t.jsx)(a.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,t.jsx)("div",{ref:j,...te,...le,children:(0,t.jsx)("div",{className:ie.modal,children:(0,t.jsx)(A,{date:N,maxDate:F,minDate:w,onChange:ye,isFullscreen:!1,onClose:()=>ae(!1),showSeconds:X,disabledHours:K,disabledMinutes:V,disabledSeconds:H,timeZone:Y})})})})]}):null]})},S=o.forwardRef(({date:N,label:F,onChange:w,onOpen:B,timeZone:U,showSeconds:K=!0,clearable:V=!1},H)=>{const Y=(0,l.of)(L),X=K?"YYYY-MM-DD HH:mm:ss":"YYYY-MM-DD HH:mm",[J,q]=(0,o.useState)(()=>({value:N?(0,d.LE)(N,{timeZone:U}):V?"":(0,d.LE)((0,p.KQ)(),{timeZone:U}),invalid:!1}));(0,o.useEffect)(()=>{if(N){const le=(0,d.LE)(N,{format:X,timeZone:U});q({invalid:!(0,I.f)(le),value:(0,p.Ar)(N)?le:N})}},[N,X,U]);const ae=(0,o.useCallback)(le=>{const z=!(0,I.f)(le.currentTarget.value);q({value:le.currentTarget.value,invalid:z})},[]),j=(0,o.useCallback)(()=>{if(!J.invalid&&J.value){const le=(0,p.oZ)((0,m.O)({timeZone:U}),J.value);w(le)}},[J,w,U]),te=(0,o.useCallback)(()=>{q({value:"",invalid:!1}),w()},[w]),ne=(0,t.jsx)(y.$n,{"aria-label":"Time picker",icon:"calendar-alt",variant:"secondary",onClick:B});return(0,t.jsx)(u.I,{label:F,invalid:!!(J.value&&J.invalid),className:Y.field,children:(0,t.jsx)(E.p,{onChange:ae,addonAfter:ne,value:J.value,onBlur:j,"data-testid":v.X.DateTimePicker.input,placeholder:"Select date/time",ref:H,suffix:V&&J.value&&(0,t.jsx)(D.I,{name:"times",className:Y.clearIcon,onClick:te})})})});S.displayName="DateTimeInput";const A=o.forwardRef(({date:N,onClose:F,onChange:w,isFullscreen:B,maxDate:U,minDate:K,style:V,showSeconds:H=!0,disabledHours:Y,disabledMinutes:X,disabledSeconds:J,timeZone:q},ae)=>{const j=(0,l.of)(O.h2),te=(0,l.of)(L),[ne,le]=(0,o.useState)(()=>N&&N.isValid()?(0,p.oZ)((0,m.O)({timeZone:q}),N):(0,p.oZ)((0,m.O)({timeZone:q}),new Date)),[z,ee]=(0,o.useState)(()=>N&&N.isValid()?(0,T.Q)(N.toDate(),(0,m.O)({timeZone:q})):(0,T.Q)(new Date,(0,m.O)({timeZone:q}))),se=(0,o.useCallback)(oe=>{oe&&!Array.isArray(oe)&&ee(oe)},[]),ie=(0,o.useCallback)(oe=>{le(oe)},[]),Z=()=>{const oe=(0,p.KQ)(ne);oe.set("date",z.getDate()),oe.set("month",z.getMonth()),oe.set("year",z.getFullYear()),w(oe)};return(0,t.jsxs)("div",{className:(0,n.cx)(te.container,{[te.fullScreen]:B}),style:V,ref:ae,children:[(0,t.jsx)(h.Ay,{next2Label:null,prev2Label:null,value:z,nextLabel:(0,t.jsx)(D.I,{name:"angle-right"}),nextAriaLabel:"Next month",prevLabel:(0,t.jsx)(D.I,{name:"angle-left"}),prevAriaLabel:"Previous month",onChange:se,locale:"en",className:j.body,tileClassName:j.title,maxDate:U,minDate:K}),(0,t.jsx)("div",{className:te.time,children:(0,t.jsx)(M.R,{showSeconds:H,onChange:ie,value:ne,disabledHours:Y,disabledMinutes:X,disabledSeconds:J})}),(0,t.jsxs)(x.B,{children:[(0,t.jsx)(y.$n,{type:"button",onClick:Z,children:"Apply"}),(0,t.jsx)(y.$n,{variant:"secondary",type:"button",onClick:F,children:"Cancel"})]})]})});A.displayName="DateTimeCalendar";const L=N=>({container:(0,n.css)({padding:N.spacing(1),border:`1px ${N.colors.border.weak} solid`,borderRadius:N.shape.radius.default,backgroundColor:N.colors.background.primary,zIndex:N.zIndex.modal}),fullScreen:(0,n.css)({position:"absolute"}),time:(0,n.css)({marginBottom:N.spacing(2)}),modal:(0,n.css)({position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:N.zIndex.modal,maxWidth:"280px"}),clearIcon:(0,n.css)({cursor:"pointer"}),field:(0,n.css)({marginBottom:0,width:"100%"})})},5308:(k,R,e)=>{"use strict";e.d(R,{N:()=>L});var t=e(74848),n=e(32196),i=e(34743),s=e(36376),r=e(7315),g=e(18828),a=e(85690),c=e(93225),o=e(96540),h=e(40845),f=e(76412),d=e(55852),p=e(40276),m=e(88575),v=e(14578),l=e(10354),y=e(56034),u=e(42617),D=e(11752),E=e(32432);const x=/^now$|^now(\-|\+)(\d{1,10})([wdhms])$/,P=U=>({from:I(U.from),to:I(U.to)}),b=U=>{const K=C(U.from),V=C(U.to);return{from:K,to:V,display:`${K} to ${V}`}},M=(U,K=Date.now())=>O(U)?I(U)>Math.ceil(K/1e3)?{isValid:!1,errorMessage:"Can not enter value prior to January 1, 1970."}:{isValid:!0}:{isValid:!1,errorMessage:"Value not in relative time format."},O=U=>x.test(U),I=U=>{const K=x.exec(U);if(!K||K.length!==4)return 0;const[,V,H,Y]=K,X=parseInt(H,10);if(isNaN(X))return 0;const J=X*T[Y];return V==="+"?J*-1:J},T={w:604800,d:86400,h:3600,m:60,s:1},C=U=>{if(U===0)return"now";const K=Math.abs(U);return U<0?`now+${S(K)}`:`now-${S(K)}`};function S(U){const K=[{unit:"w",value:604800},{unit:"d",value:86400},{unit:"h",value:3600},{unit:"m",value:60},{unit:"s",value:1}];for(const{unit:H,value:Y}of K)if(U%Y===0)return`${U/Y}${H}`;const V=K[K.length-1];return`${U}${V.unit}`}const A=E.o.filter(U=>O(U.from));function L(U){const{timeRange:K,onChange:V}=U,[H,Y]=(0,o.useState)(!1),X=(0,o.useCallback)(()=>Y(!1),[]),J=b(K),[q,ae]=(0,o.useState)({value:J.from,validation:M(J.from)}),[j,te]=(0,o.useState)({value:J.to,validation:M(J.to)}),ne=(0,o.useRef)(null),{overlayProps:le,underlayProps:z}=(0,c.e)({onClose:()=>Y(!1),isDismissable:!0,isOpen:H},ne),{dialogProps:ee}=(0,g.s)({},ne),se=[(0,i.UU)({crossAxis:!1,boundary:document.body}),(0,i.BN)()],{context:ie,refs:Z,floatingStyles:oe}=(0,s.we)({open:H,placement:"bottom-start",onOpenChange:Y,middleware:se,whileElementsMounted:r.ll,strategy:"fixed"}),ce=(0,s.kp)(ie),ye=(0,s.s9)(ie),{getReferenceProps:re,getFloatingProps:ue}=(0,s.bv)([ye,ce]),De=(0,h.of)(w(q.validation.errorMessage,j.validation.errorMessage)),ge=Ye=>{const je=P(Ye);je&&(X(),ae({...q,value:Ye.from}),te({...j,value:Ye.to}),V(je))},Te=(0,o.useCallback)(Ye=>{Ye.stopPropagation(),Ye.preventDefault(),Y(!H)},[H]),Le=Ye=>{if(Ye.preventDefault(),!j.validation.isValid||!q.validation.isValid)return;const je=P({from:q.value,to:j.value,display:""});je&&(V(je),Y(!1))};return(0,t.jsxs)("div",{className:De.container,children:[(0,t.jsxs)("button",{ref:Z.setReference,className:De.pickerInput,type:"button",onClick:Te,...re(),children:[(0,t.jsx)("span",{className:De.clockIcon,children:(0,t.jsx)(v.I,{name:"clock-nine"})}),(0,t.jsxs)("span",{children:[J.from," to ",J.to]}),(0,t.jsx)("span",{className:De.caretIcon,children:(0,t.jsx)(v.I,{name:H?"angle-up":"angle-down",size:"lg"})})]}),H&&(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{role:"presentation",className:De.backdrop,...z}),(0,t.jsx)(a.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,t.jsx)("div",{ref:ne,...le,...ee,children:(0,t.jsx)("div",{className:De.content,ref:Z.setFloating,style:oe,...ue(),children:(0,t.jsxs)("div",{className:De.body,children:[(0,t.jsx)(p.A,{className:De.leftSide,hideHorizontalTrack:!0,children:(0,t.jsx)(D.l,{title:(0,f.t)("time-picker.time-range.example-title","Example time ranges"),options:A,onChange:ge,value:J})}),(0,t.jsxs)("div",{className:De.rightSide,children:[(0,t.jsx)("div",{className:De.title,children:(0,t.jsx)(u.e,{children:(0,t.jsx)(y.m,{content:(0,t.jsx)(N,{}),placement:"bottom",theme:"info",children:(0,t.jsx)("div",{children:(0,t.jsxs)(f.x,{i18nKey:"time-picker.time-range.specify",children:["Specify time range ",(0,t.jsx)(v.I,{name:"info-circle"})]})})})})}),(0,t.jsx)(m.D,{label:"From",invalid:!q.validation.isValid,error:q.validation.errorMessage,children:(0,t.jsx)(l.p,{onClick:Ye=>Ye.stopPropagation(),onBlur:()=>ae({...q,validation:M(q.value)}),onChange:Ye=>ae({...q,value:Ye.currentTarget.value}),value:q.value})}),(0,t.jsx)(m.D,{label:"To",invalid:!j.validation.isValid,error:j.validation.errorMessage,children:(0,t.jsx)(l.p,{onClick:Ye=>Ye.stopPropagation(),onBlur:()=>te({...j,validation:M(j.value)}),onChange:Ye=>te({...j,value:Ye.currentTarget.value}),value:j.value})}),(0,t.jsx)(d.$n,{"aria-label":"TimePicker submit button",onClick:Le,children:"Apply time range"})]})]})})})})]})]})}const N=()=>{const U=(0,h.of)(F);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:U.supported,children:["Supported formats: ",(0,t.jsx)("code",{className:U.tooltip,children:"now-[digit]s/m/h/d/w"})]}),(0,t.jsx)("div",{children:"Example: to select a time range from 10 minutes ago to now"}),(0,t.jsx)("code",{className:U.tooltip,children:"From: now-10m To: now"}),(0,t.jsxs)("div",{className:U.link,children:["For more information see"," ",(0,t.jsxs)("a",{href:"https://grafana.com/docs/grafana/latest/dashboards/time-range-controls/",children:["docs ",(0,t.jsx)(v.I,{name:"external-link-alt"})]}),"."]})]})},F=U=>({supported:(0,n.css)({marginBottom:U.spacing(1)}),tooltip:(0,n.css)({margin:0}),link:(0,n.css)({marginTop:U.spacing(1)})}),w=(U,K)=>V=>{const H=(0,l.n)({theme:V,invalid:!1}),X=250+B(V,U)+B(V,K);return{backdrop:(0,n.css)({position:"fixed",zIndex:V.zIndex.modalBackdrop,top:0,right:0,bottom:0,left:0}),container:(0,n.css)({display:"flex",position:"relative"}),pickerInput:(0,n.cx)(H.input,H.wrapper,(0,n.css)({display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer",paddingRight:0,paddingLeft:0,lineHeight:`${V.spacing.gridSize*V.components.height.md-2}px`})),caretIcon:(0,n.cx)(H.suffix,(0,n.css)({position:"relative",marginLeft:V.spacing(.5)})),clockIcon:(0,n.cx)(H.prefix,(0,n.css)({position:"relative",marginRight:V.spacing(.5)})),content:(0,n.css)({background:V.colors.background.primary,boxShadow:V.shadows.z3,position:"absolute",zIndex:V.zIndex.modal,width:"500px",top:"100%",borderRadius:V.shape.radius.default,border:`1px solid ${V.colors.border.weak}`,left:0,whiteSpace:"normal"}),body:(0,n.css)({display:"flex",height:`${X}px`}),description:(0,n.css)({color:V.colors.text.secondary,fontSize:V.typography.size.sm}),leftSide:(0,n.css)({width:"50% !important",borderRight:`1px solid ${V.colors.border.medium}`}),rightSide:(0,n.css)({width:"50%",padding:V.spacing(1)}),title:(0,n.css)({marginBottom:V.spacing(1)})}};function B(U,K){return K?K.length>34?U.spacing.gridSize*6.5:U.spacing.gridSize*4:0}},66070:(k,R,e)=>{"use strict";e.d(R,{R:()=>f,i:()=>h});var t=e(74848),n=e(32196),i=e(57389),s=e(47232),r=e(40845),g=e(16797),a=e(87266),c=e(14578),o=e(78537);const h="time-of-day-picker-panel",f=({minuteStep:m=1,showHour:v=!0,showSeconds:l=!1,onChange:y,value:u,size:D="auto",disabled:E,disabledHours:x,disabledMinutes:P,disabledSeconds:b})=>{const M=(0,r.of)(p);return(0,t.jsx)(i.A,{className:(0,n.cx)((0,a.lH)()[D],M.input),popupClassName:(0,n.cx)(M.picker,h),defaultValue:(0,s.AN)(),onChange:O=>{if((0,s.u8)(O))return y((0,s.KQ)(O))},allowEmpty:!1,showSecond:l,value:(0,s.AN)(u),showHour:v,minuteStep:m,inputIcon:(0,t.jsx)(d,{wrapperStyle:M.caretWrapper}),disabled:E,disabledHours:x,disabledMinutes:P,disabledSeconds:b})},d=({wrapperStyle:m=""})=>(0,t.jsx)("div",{className:m,children:(0,t.jsx)(c.I,{name:"angle-down"})}),p=m=>{const v=m.components.input.background,l=m.v1.palette.black,y=m.colors.background.secondary,u=m.shape.radius.default,D=m.components.input.borderColor;return{caretWrapper:(0,n.css)({position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",display:"inline-block",textAlign:"right",color:m.colors.text.secondary}),picker:(0,n.css)({".rc-time-picker-panel-select":{fontSize:"14px",backgroundColor:v,color:m.colors.text.secondary,borderColor:D,li:{outlineWidth:"2px","&.rc-time-picker-panel-select-option-selected":{backgroundColor:"inherit",border:`1px solid ${m.v1.palette.orange}`,borderRadius:u,color:m.colors.text.primary},"&:hover":{background:y,color:m.colors.text.primary},"&.rc-time-picker-panel-select-option-disabled":{color:m.colors.action.disabledText}}},".rc-time-picker-panel-inner":{boxShadow:`0px 4px 4px ${l}`,backgroundColor:v,borderColor:D,borderRadius:u,marginTop:"3px",".rc-time-picker-panel-input-wrap":{marginRight:"2px","&, .rc-time-picker-panel-input":{backgroundColor:v,paddingTop:"2px"}},".rc-time-picker-panel-combobox":{display:"flex"}}}),input:(0,n.css)({".rc-time-picker-input":{backgroundColor:v,borderRadius:u,borderColor:D,color:m.colors.text.primary,height:m.spacing(4),"&:focus":(0,g.getFocusStyles)(m),"&:disabled":{backgroundColor:m.colors.action.disabledBackground,color:m.colors.action.disabledText,border:`1px solid ${m.colors.action.disabledBackground}`,"&:focus":{boxShadow:"none"}}}})}}},54230:(k,R,e)=>{"use strict";e.d(R,{b:()=>l});var t=e(74848),n=e(32196),i=e(96540),s=e(47232),r=e(43127),g=e(13544),a=e(40845),c=e(8866),o=e(14578),h=e(10354),f=e(85068),d=e(3799),p=e(32432),m=e(47619);const v=()=>{},l=({value:u,onChange:D,onChangeTimeZone:E=v,clearable:x,weekStart:P,hideTimeZone:b=!0,timeZone:M="browser",placeholder:O="Select time range",isReversed:I=!0,hideQuickRanges:T=!1,disabled:C=!1,showIcon:S=!1})=>{const[A,L]=(0,i.useState)(!1),N=(0,a.of)(y,C),F=K=>{K.stopPropagation(),K.preventDefault(),!C&&L(!A)},w=()=>{L(!1)},B=K=>{w(),D(K)},U=K=>{K.stopPropagation();const V=(0,s.KQ)(null),H=(0,s.KQ)(null);D({from:V,to:H,raw:{from:V,to:H}})};return(0,t.jsxs)("div",{className:N.container,children:[(0,t.jsxs)("button",{type:"button",className:N.pickerInput,"data-testid":g.Tp.components.TimePicker.openButton,onClick:F,children:[S&&(0,t.jsx)(o.I,{name:"clock-nine",size:"sm",className:N.icon}),(0,t.jsx)(d.f,{value:u,timeZone:M,placeholder:O}),!C&&(0,t.jsxs)("span",{className:N.caretIcon,children:[(0,m.X)(u)&&x&&(0,t.jsx)(o.I,{className:N.clearIcon,name:"times",size:"lg",onClick:U}),(0,t.jsx)(o.I,{name:A?"angle-up":"angle-down",size:"lg"})]})]}),A&&(0,t.jsx)(c.N,{includeButtonPress:!1,onClick:w,children:(0,t.jsx)(f.r,{timeZone:M,value:(0,m.X)(u)?u:(0,r.E2)(),onChange:B,quickOptions:p.o,onChangeTimeZone:E,className:N.content,hideTimeZone:b,isReversed:I,hideQuickRanges:T,weekStart:P})})]})},y=(u,D=!1)=>{const E=(0,h.n)({theme:u,invalid:!1});return{container:(0,n.css)({display:"flex",position:"relative"}),content:(0,n.css)({marginLeft:0,position:"absolute",top:"116%",zIndex:u.zIndex.dropdown}),pickerInput:(0,n.cx)(E.input,D&&E.inputDisabled,E.wrapper,(0,n.css)({display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer",paddingRight:0,lineHeight:`${u.spacing.gridSize*4-2}px`})),caretIcon:(0,n.cx)(E.suffix,(0,n.css)({position:"relative",top:"-1px",marginLeft:u.spacing(.5)})),clearIcon:(0,n.css)({marginRight:u.spacing(.5),"&:hover":{color:u.colors.text.maxContrast}}),placeholder:(0,n.css)({color:u.colors.text.disabled,opacity:1}),icon:(0,n.css)({marginRight:u.spacing(.5)})}}},15666:(k,R,e)=>{"use strict";e.d(R,{$6:()=>E,_8:()=>b,xS:()=>P});var t=e(74848),n=e(32196),i=e(18828),s=e(85690),r=e(93225),g=e(96540),a=e(65879),c=e(72724),o=e(91410),h=e(85858),f=e(13544),d=e(40845),p=e(76412),m=e(19727),v=e(88448),l=e(27746),y=e(56034),u=e(85068),D=e(32432);function E(T){const[C,S]=(0,g.useState)(!1),{value:A,onMoveBackward:L,onMoveForward:N,onZoom:F,onError:w,timeZone:B,fiscalYearStartMonth:U,timeSyncButton:K,isSynced:V,history:H,onChangeTimeZone:Y,onChangeFiscalYearStartMonth:X,hideQuickRanges:J,widthOverride:q,isOnCanvas:ae,onToolbarTimePickerClick:j,weekStart:te}=T,ne=Le=>{T.onChange(Le),S(!1)};(0,g.useEffect)(()=>{C&&j&&j()},[C,j]);const le=()=>{S(Le=>!Le)},z=()=>{S(!1)},ee=(0,g.createRef)(),se=(0,g.createRef)(),{overlayProps:ie,underlayProps:Z}=(0,r.e)({onClose:z,isDismissable:!0,isOpen:C,shouldCloseOnInteractOutside:Le=>!se.current?.contains(Le)},ee),{dialogProps:oe}=(0,i.s)({},ee),ce=(0,d.of)(O),{modalBackdrop:ye}=(0,d.of)(v.o),re=!a.isRelativeTime(A.raw.from)||!a.isRelativeTime(A.raw.to),ue=V?"active":ae?"canvas":"default",ge=A?.to?.isBefore(A.from)?"exclamation-triangle":"clock-nine",Te=M(A,B);return(0,t.jsxs)(m.e,{className:ce.container,children:[re&&(0,t.jsx)(l.I,{"aria-label":(0,p.t)("time-picker.range-picker.backwards-time-aria-label","Move time range backwards"),variant:ue,onClick:L,icon:"angle-left",narrow:!0}),(0,t.jsx)(y.m,{ref:se,content:(0,t.jsx)(P,{timeRange:A,timeZone:B}),placement:"bottom",interactive:!0,children:(0,t.jsx)(l.I,{"data-testid":f.Tp.components.TimePicker.openButton,"aria-label":(0,p.t)("time-picker.range-picker.current-time-selected","Time range selected: {{currentTimeRange}}",{currentTimeRange:Te}),"aria-controls":"TimePickerContent",onClick:le,icon:ge,isOpen:C,variant:ue,children:(0,t.jsx)(b,{...T})})}),C&&(0,t.jsxs)("div",{"data-testid":f.Tp.components.TimePicker.overlayContent,children:[(0,t.jsx)("div",{role:"presentation",className:(0,n.cx)(ye,ce.backdrop),...Z}),(0,t.jsx)(s.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,t.jsx)("section",{className:ce.content,ref:ee,...ie,...oe,children:(0,t.jsx)(u.r,{timeZone:B,fiscalYearStartMonth:U,value:A,onChange:ne,quickOptions:D.o,history:H,showHistory:!0,widthOverride:q,onChangeTimeZone:Y,onChangeFiscalYearStartMonth:X,hideQuickRanges:J,onError:w,weekStart:te})})})]}),K,re&&(0,t.jsx)(l.I,{"aria-label":(0,p.t)("time-picker.range-picker.forwards-time-aria-label","Move time range forwards"),onClick:N,icon:"angle-right",narrow:!0,variant:ue}),(0,t.jsx)(y.m,{content:x,placement:"bottom",children:(0,t.jsx)(l.I,{"aria-label":(0,p.t)("time-picker.range-picker.zoom-out-button","Zoom out time range"),onClick:F,icon:"search-minus",variant:ue})})]})}E.displayName="TimeRangePicker";const x=()=>(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(p.x,{i18nKey:"time-picker.range-picker.zoom-out-tooltip",children:["Time range zoom out ",(0,t.jsx)("br",{})," CTRL+Z"]})}),P=({timeRange:T,timeZone:C})=>{const S=(0,d.of)(I);return(0,t.jsxs)(t.Fragment,{children:[(0,c.LE)(T.from,{timeZone:C}),(0,t.jsx)("div",{className:"text-center",children:(0,t.jsx)(p.x,{i18nKey:"time-picker.range-picker.to",children:"to"})}),(0,c.LE)(T.to,{timeZone:C}),(0,t.jsx)("div",{className:"text-center",children:(0,t.jsx)("span",{className:S.utc,children:(0,o.le)(C)})})]})},b=(0,g.memo)(({hideText:T,value:C,timeZone:S})=>{const A=(0,d.of)(I);return T?null:(0,t.jsxs)("span",{className:A.container,"aria-live":"polite","aria-atomic":"true",children:[(0,t.jsx)("span",{children:M(C,S)}),(0,t.jsx)("span",{className:A.utc,children:a.describeTimeRangeAbbreviation(C,S)})]})});b.displayName="TimePickerButtonLabel";const M=(T,C)=>{const S={to:h.isMathString(T.raw.to)?T.raw.to:T.to,from:h.isMathString(T.raw.from)?T.raw.from:T.from};return a.describeTimeRange(S,C)},O=T=>({container:(0,n.css)({position:"relative",display:"flex",verticalAlign:"middle"}),backdrop:(0,n.css)({display:"none",[T.breakpoints.down("sm")]:{display:"block"}}),content:(0,n.css)({position:"absolute",right:0,top:"116%",zIndex:T.zIndex.dropdown,[T.breakpoints.down("sm")]:{position:"fixed",right:"50%",top:"50%",transform:"translate(50%, -50%)",zIndex:T.zIndex.modal}})}),I=T=>({container:(0,n.css)({display:"flex",alignItems:"center",whiteSpace:"nowrap"}),utc:(0,n.css)({color:T.v1.palette.orange,fontSize:T.typography.size.sm,paddingLeft:"6px",lineHeight:"28px",verticalAlign:"bottom",fontWeight:T.typography.fontWeightMedium})})},72265:(k,R,e)=>{"use strict";e.d(R,{h2:()=>v,nB:()=>f});var t=e(74848),n=e(32196),i=e(96540),s=e(29426),r=e(53531),g=e(40845),a=e(76412),c=e(14578),o=e(99225);const h={saturday:"islamic",sunday:"gregory",monday:"iso8601"};function f({onChange:l,from:y,to:u,timeZone:D,weekStart:E="monday"}){const x=d(y,u,new Date,D),P=p(l,D),b=(0,g.of)(v);return(0,t.jsx)(s.Ay,{selectRange:!0,next2Label:null,prev2Label:null,className:b.body,tileClassName:b.title,value:x,nextLabel:(0,t.jsx)(c.I,{name:"angle-right"}),nextAriaLabel:(0,a.t)("time-picker.calendar.next-month","Next month"),prevLabel:(0,t.jsx)(c.I,{name:"angle-left"}),prevAriaLabel:(0,a.t)("time-picker.calendar.previous-month","Previous month"),onChange:P,locale:"en",calendarType:h[E]})}f.displayName="Body";function d(l,y,u=new Date,D){let E=l.isValid()?l.toDate():u,x=y.isValid()?y.toDate():u;return D&&(E=(0,o.Q)(E,D),x=(0,o.Q)(x,D)),E>x?[x,E]:[E,x]}function p(l,y){return(0,i.useCallback)(u=>{if(!Array.isArray(u))return console.error("onCalendarChange: should be run in selectRange={true}");if(u[0]&&u[1]){const D=(0,r.b)(m(u[0]),{timeZone:y}),E=(0,r.b)(m(u[1]),{timeZone:y});l(D,E)}},[l,y])}function m(l){return[l.getFullYear(),l.getMonth(),l.getDate(),l.getHours(),l.getMinutes(),l.getSeconds()]}const v=l=>{const y=".react-calendar__tile--hasActive:not(.react-calendar__tile--range)";return{title:(0,n.css)({color:l.colors.text.primary,backgroundColor:l.colors.background.primary,fontSize:l.typography.size.md,border:"1px solid transparent","&:hover":{position:"relative"},"&:disabled":{color:l.colors.action.disabledText}}),body:(0,n.css)({zIndex:l.zIndex.modal,backgroundColor:l.colors.background.primary,width:"268px",".react-calendar__navigation":{display:"flex"},".react-calendar__navigation__label, .react-calendar__navigation__arrow, .react-calendar__navigation":{paddingTop:"4px",backgroundColor:"inherit",color:l.colors.text.primary,border:0,fontWeight:l.typography.fontWeightMedium},".react-calendar__month-view__weekdays":{backgroundColor:"inherit",textAlign:"center",color:l.colors.primary.text,abbr:{border:0,textDecoration:"none",cursor:"default",display:"block",padding:"4px 0 4px 0"}},".react-calendar__month-view__days":{backgroundColor:"inherit"},".react-calendar__tile, .react-calendar__tile--now":{marginBottom:"4px",backgroundColor:"inherit",height:"26px"},".react-calendar__navigation__label, .react-calendar__navigation > button:focus, .time-picker-calendar-tile:focus":{outline:0},[`${y}, .react-calendar__tile--active, .react-calendar__tile--active:hover`]:{color:l.colors.primary.contrastText,fontWeight:l.typography.fontWeightMedium,background:l.colors.primary.main,boxShadow:"none",border:"0px"},".react-calendar__tile--rangeEnd, .react-calendar__tile--rangeStart":{padding:0,border:"0px",color:l.colors.primary.contrastText,fontWeight:l.typography.fontWeightMedium,background:l.colors.primary.main,abbr:{backgroundColor:l.colors.primary.main,borderRadius:"100px",display:"block",paddingTop:"2px",height:"26px"}},[`${y}, .react-calendar__tile--rangeStart`]:{borderTopLeftRadius:"20px",borderBottomLeftRadius:"20px"},[`${y}, .react-calendar__tile--rangeEnd`]:{borderTopRightRadius:"20px",borderBottomRightRadius:"20px"}})}}},85068:(k,R,e)=>{"use strict";e.d(R,{r:()=>ye});var t=e(74848),n=e(32196),i=e(96540),s=e(47232),r=e(65879),g=e(13544),a=e(40845),c=e(16797),o=e(76412),h=e(67647),f=e(14578),d=e(2543),p=e(91410),m=e(55852),v=e(88575),l=e(90182),y=e(63021),u=e(40675),D=e(40980),E=e(20333),x=e(79451),P=e(17624),b=e(67459),M=e(32432);const O=Ne=>{const{timeZone:Pe,fiscalYearStartMonth:Ue,timestamp:$e=Date.now(),onChangeTimeZone:ze,onChangeFiscalYearStartMonth:qe}=Ne,[dt,vt]=(0,i.useState)(!1),[yt,st]=(0,i.useState)("tz"),Ve=(0,i.useId)(),pe=(0,i.useId)(),Ee=(0,i.useId)(),me=(0,i.useCallback)(Ie=>{Ie&&Ie.stopPropagation(),vt(!dt)},[dt,vt]),ve=(0,a.of)(I);if(!(0,d.isString)(Pe))return null;const Se=(0,p.QZ)(Pe,$e);return Se?(0,t.jsxs)("div",{children:[(0,t.jsxs)("section",{"aria-label":(0,o.t)("time-picker.footer.time-zone-selection","Time zone selection"),className:ve.container,children:[(0,t.jsxs)("div",{className:ve.timeZoneContainer,children:[(0,t.jsxs)("div",{className:ve.timeZone,children:[(0,t.jsx)(b.U,{title:Se.name}),(0,t.jsx)("div",{className:ve.spacer}),(0,t.jsx)(x.E,{info:Se})]}),(0,t.jsx)(P.X,{timeZone:Pe,timestamp:$e})]}),(0,t.jsx)("div",{className:ve.spacer}),(0,t.jsx)(m.$n,{"data-testid":g.Tp.components.TimeZonePicker.changeTimeSettingsButton,variant:"secondary",onClick:me,size:"sm","aria-expanded":dt,"aria-controls":Ve,icon:dt?"angle-up":"angle-down",children:(0,t.jsx)(o.x,{i18nKey:"time-picker.footer.change-settings-button",children:"Change time settings"})})]}),dt?(0,t.jsxs)("div",{className:ve.editContainer,id:Ve,children:[(0,t.jsxs)(y.U,{children:[(0,t.jsx)(u.o,{label:(0,o.t)("time-picker.footer.time-zone-option","Time zone"),active:yt==="tz",onChangeTab:()=>{st("tz")},"aria-controls":pe}),(0,t.jsx)(u.o,{label:(0,o.t)("time-picker.footer.fiscal-year-option","Fiscal year"),active:yt==="fy",onChangeTab:()=>{st("fy")},"aria-controls":Ee})]}),(0,t.jsx)(D.J,{children:yt==="tz"?(0,t.jsx)("section",{role:"tabpanel","data-testid":g.Tp.components.TimeZonePicker.containerV2,id:pe,className:(0,n.cx)(ve.timeZoneContainer,ve.timeSettingContainer),children:(0,t.jsx)(E.U,{includeInternal:!0,onChange:Ie=>{me(),(0,d.isString)(Ie)&&ze(Ie)},onBlur:me,menuShouldPortal:!1})}):(0,t.jsx)("section",{role:"tabpanel","data-testid":g.Tp.components.TimeZonePicker.containerV2,id:Ee,className:(0,n.cx)(ve.timeZoneContainer,ve.timeSettingContainer),children:(0,t.jsx)(v.D,{className:ve.fiscalYearField,label:(0,o.t)("time-picker.footer.fiscal-year-start","Fiscal year start month"),children:(0,t.jsx)(l.l6,{value:Ue,menuShouldPortal:!1,options:M.Z,onChange:Ie=>{qe&&qe(Ie.value??0)}})})})})]}):null]}):null},I=Ne=>({container:(0,n.css)({borderTop:`1px solid ${Ne.colors.border.weak}`,padding:Ne.spacing(1.5),display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"}),editContainer:(0,n.css)({borderTop:`1px solid ${Ne.colors.border.weak}`,padding:Ne.spacing(1.5),paddingTop:0,justifyContent:"space-between",alignItems:"center"}),spacer:(0,n.css)({marginLeft:"7px"}),timeSettingContainer:(0,n.css)({paddingTop:Ne.spacing(1)}),fiscalYearField:(0,n.css)({marginBottom:0}),timeZoneContainer:(0,n.css)({display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",flexGrow:1}),timeZone:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"baseline",flexGrow:1})});var T=e(42617),C=e(53531),S=e(72724),A=e(10354),L=e(56034),N=e(47619),F=e(18828),w=e(85690),B=e(93225),U=e(59875),K=e(88448),V=e(72265),H=e(67061);function Y({onClose:Ne,onApply:Pe}){return(0,t.jsxs)(H.B,{gap:2,justifyContent:"space-between",children:[(0,t.jsx)(m.$n,{variant:"secondary",onClick:Ne,children:(0,t.jsx)(o.x,{i18nKey:"time-picker.calendar.cancel-button",children:"Cancel"})}),(0,t.jsx)(m.$n,{onClick:Pe,children:(0,t.jsx)(o.x,{i18nKey:"time-picker.calendar.apply-button",children:"Apply time range"})})]})}Y.displayName="Footer";var X=e(29158);function J({onClose:Ne}){return(0,t.jsxs)(H.B,{justifyContent:"space-between",children:[(0,t.jsx)(T.e,{children:(0,t.jsx)(o.x,{i18nKey:"time-picker.calendar.select-time",children:"Select a time range"})}),(0,t.jsx)(X.K,{"data-testid":g.Tp.components.TimePicker.calendar.closeButton,tooltip:(0,o.t)("time-picker.calendar.close","Close calendar"),name:"times",variant:"secondary",onClick:Ne})]})}J.displayName="Header";const q=(Ne,Pe=!1)=>({container:(0,n.css)({top:0,position:"absolute",[`${Pe?"left":"right"}`]:"546px"}),modalContainer:(0,n.css)({label:"modalContainer",margin:"0 auto"}),calendar:(0,n.css)({display:"flex",flexDirection:"column",gap:Ne.spacing(1),padding:Ne.spacing(1),label:"calendar",boxShadow:Ne.shadows.z3,backgroundColor:Ne.colors.background.primary,border:`1px solid ${Ne.colors.border.weak}`,borderRadius:Ne.shape.radius.default}),modal:(0,n.css)({label:"modal",boxShadow:Ne.shadows.z3,left:"50%",position:"fixed",top:"50%",transform:"translate(-50%, -50%)",zIndex:Ne.zIndex.modal})});function ae(Ne){const Pe=(0,a.$j)(),{modalBackdrop:Ue}=(0,a.of)(K.o),$e=q(Pe,Ne.isReversed),{isOpen:ze,isFullscreen:qe,onClose:dt}=Ne,vt=(0,i.createRef)(),{dialogProps:yt}=(0,F.s)({"aria-label":g.Tp.components.TimePicker.calendar.label},vt),{overlayProps:st}=(0,B.e)({isDismissable:!0,isOpen:ze,onClose:dt},vt),Ve=!qe;if(!ze)return null;const pe=(0,t.jsxs)("section",{className:$e.calendar,ref:vt,...st,...yt,"data-testid":g.Tp.components.TimePicker.calendar.label,children:[(0,t.jsx)(J,{...Ne}),(0,t.jsx)(V.nB,{...Ne}),Ve&&(0,t.jsx)(Y,{...Ne})]});return Ve?(0,t.jsxs)(U.Sf,{children:[(0,t.jsx)("div",{className:Ue}),(0,t.jsx)(w.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,t.jsx)("div",{className:$e.modal,children:(0,t.jsx)("div",{className:$e.modalContainer,children:pe})})})]}):(0,t.jsx)(w.n1,{contain:!0,restoreFocus:!0,autoFocus:!0,children:(0,t.jsx)("div",{className:$e.container,children:pe})})}const j=(0,i.memo)(ae);ae.displayName="TimePickerCalendar";const te={default:()=>(0,o.t)("time-picker.range-content.default-error",'Please enter a past date or "now"'),range:()=>(0,o.t)("time-picker.range-content.range-error",`"From" can't be after "To"`)},ne=Ne=>{const{value:Pe,isFullscreen:Ue=!1,timeZone:$e,onApply:ze,isReversed:qe,fiscalYearStartMonth:dt,onError:vt,weekStart:yt}=Ne,[st,Ve]=z(Pe.raw.from,Pe.raw.to,$e),pe=(0,a.of)(se),[Ee,me]=(0,i.useState)(st),[ve,Se]=(0,i.useState)(Ve),[Ie,Oe]=(0,i.useState)(!1),Re=(0,i.useId)(),he=(0,i.useId)();(0,i.useEffect)(()=>{const[Vt,en]=z(Pe.raw.from,Pe.raw.to,$e);me(Vt),Se(en)},[Pe.raw.from,Pe.raw.to,$e]);const Ce=(0,i.useCallback)(Vt=>{Vt.preventDefault(),Oe(!0)},[Oe]),We=(0,i.useCallback)(()=>{if(ve.invalid||Ee.invalid)return;const Vt={from:Ee.value,to:ve.value},en=r.convertRawToRange(Vt,$e,dt);ze(en)},[Ee.invalid,Ee.value,ze,$e,ve.invalid,ve.value,dt]),et=(0,i.useCallback)((Vt,en)=>{const[Je,ct]=z(Vt,en,$e);me(Je),Se(ct)},[$e]),rt=Vt=>{Vt.key==="Enter"&&We()},nt=()=>{const Vt={from:Ee.value,to:ve.value};navigator.clipboard.writeText(JSON.stringify(Vt))},gt=async()=>{const Vt=await navigator.clipboard.readText();let en;try{en=JSON.parse(Vt)}catch{vt&&vt(Vt);return}const[Je,ct]=z(en.from,en.to,$e);me(Je),Se(ct)},xt=r.convertRawToRange({from:"now/fy",to:"now/fy"},$e,dt),St=(0,o.t)("time-picker.range-content.fiscal-year","Fiscal year"),zt=(0,t.jsx)("div",{className:pe.tooltip,children:r.isFiscal(Pe)?(0,t.jsx)(L.m,{content:`${St}: ${xt.from.format("MMM-DD")} - ${xt.to.format("MMM-DD")}`,children:(0,t.jsx)(f.I,{name:"info-circle"})}):null}),Nt=(0,t.jsx)(m.$n,{"aria-label":(0,o.t)("time-picker.range-content.open-input-calendar","Open calendar"),"data-testid":g.Tp.components.TimePicker.calendar.openButton,icon:"calendar-alt",variant:"secondary",type:"button",onClick:Ce});return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:pe.fieldContainer,children:[(0,t.jsx)(v.D,{label:(0,o.t)("time-picker.range-content.from-input","From"),invalid:Ee.invalid,error:Ee.errorMessage,children:(0,t.jsx)(A.p,{id:Re,onClick:Vt=>Vt.stopPropagation(),onChange:Vt=>et(Vt.currentTarget.value,ve.value),addonAfter:Nt,onKeyDown:rt,"data-testid":g.Tp.components.TimePicker.fromField,value:Ee.value})}),zt]}),(0,t.jsxs)("div",{className:pe.fieldContainer,children:[(0,t.jsx)(v.D,{label:(0,o.t)("time-picker.range-content.to-input","To"),invalid:ve.invalid,error:ve.errorMessage,children:(0,t.jsx)(A.p,{id:he,onClick:Vt=>Vt.stopPropagation(),onChange:Vt=>et(Ee.value,Vt.currentTarget.value),addonAfter:Nt,onKeyDown:rt,"data-testid":g.Tp.components.TimePicker.toField,value:ve.value})}),zt]}),(0,t.jsxs)("div",{className:pe.buttonsContainer,children:[(0,t.jsx)(m.$n,{"data-testid":g.Tp.components.TimePicker.copyTimeRange,icon:"copy",variant:"secondary",tooltip:(0,o.t)("time-picker.copy-paste.tooltip-copy","Copy time range to clipboard"),type:"button",onClick:nt}),(0,t.jsx)(m.$n,{"data-testid":g.Tp.components.TimePicker.pasteTimeRange,icon:"clipboard-alt",variant:"secondary",tooltip:(0,o.t)("time-picker.copy-paste.tooltip-paste","Paste time range"),type:"button",onClick:gt}),(0,t.jsx)(m.$n,{"data-testid":g.Tp.components.TimePicker.applyTimeRange,type:"button",onClick:We,children:(0,t.jsx)(o.x,{i18nKey:"time-picker.range-content.apply-button",children:"Apply time range"})})]}),(0,t.jsx)(j,{isFullscreen:Ue,isOpen:Ie,from:(0,C.b)(Ee.value,{timeZone:$e}),to:(0,C.b)(ve.value,{timeZone:$e}),onApply:We,onClose:()=>Oe(!1),onChange:et,timeZone:$e,isReversed:qe,weekStart:yt})]})};function le(Ne,Pe,Ue){const $e={from:Ne,to:Pe},ze=r.convertRawToRange($e,Ue);return!(ze.from.isSame(ze.to)||ze.from.isBefore(ze.to))}function z(Ne,Pe,Ue){const $e=ee(Ne,Ue),ze=ee(Pe,Ue),qe=!(0,N.f)($e,!1,Ue),dt=!(0,N.f)(ze,!0,Ue),vt=le($e,ze,Ue)&&!dt;return[{value:$e,invalid:qe||vt,errorMessage:vt&&!qe?te.range():te.default()},{value:ze,invalid:dt,errorMessage:te.default()}]}function ee(Ne,Pe){return(0,s.Ar)(Ne)?(0,S.LE)(Ne,{timeZone:Pe}):Ne}function se(Ne){return{fieldContainer:(0,n.css)({display:"flex"}),buttonsContainer:(0,n.css)({display:"flex",gap:Ne.spacing(.5),marginTop:Ne.spacing(1)}),tooltip:(0,n.css)({paddingLeft:Ne.spacing(1),paddingTop:Ne.spacing(3)})}}var ie=e(11752);const Z=(Ne,Pe)=>r.convertRawToRange({from:Ne.from,to:Ne.to},Pe),oe=(Ne,Pe)=>{const Ue=(0,S.LE)(Ne.from,{timeZone:Pe}),$e=(0,S.LE)(Ne.to,{timeZone:Pe});return{from:Ue,to:$e,display:`${Ue} to ${$e}`}},ce=Ne=>{const{quickOptions:Pe=[],isReversed:Ue,isFullscreen:$e,hideQuickRanges:ze,timeZone:qe,fiscalYearStartMonth:dt,value:vt,onChange:yt,history:st,showHistory:Ve,className:pe,hideTimeZone:Ee,onChangeTimeZone:me,onChangeFiscalYearStartMonth:ve}=Ne,Se=!st?.length,Ie=$e&&Ve||!$e&&(Ve&&!Se||!ze),Oe=(0,a.of)(Le,Ue,ze,Ie,$e),Re=ge(st,qe),he=Te(vt.raw,Pe),[Ce,We]=(0,i.useState)(""),et=Pe.filter(nt=>nt.display.toLowerCase().includes(Ce.toLowerCase())),rt=nt=>yt(Z(nt));return(0,t.jsxs)("div",{id:"TimePickerContent",className:(0,n.cx)(Oe.container,pe),children:[(0,t.jsxs)("div",{className:Oe.body,children:[(!$e||!ze)&&(0,t.jsxs)("div",{className:Oe.rightSide,children:[(0,t.jsx)("div",{className:Oe.timeRangeFilter,children:(0,t.jsx)(h.Z,{width:0,value:Ce,onChange:We,placeholder:(0,o.t)("time-picker.content.filter-placeholder","Search quick ranges")})}),(0,t.jsxs)("div",{className:Oe.scrollContent,children:[!$e&&(0,t.jsx)(re,{...Ne,historyOptions:Re}),!ze&&(0,t.jsx)(ie.l,{options:et,onChange:rt,value:he})]})]}),$e&&(0,t.jsx)("div",{className:Oe.leftSide,children:(0,t.jsx)(ue,{...Ne,historyOptions:Re})})]}),!Ee&&$e&&(0,t.jsx)(O,{timeZone:qe,fiscalYearStartMonth:dt,onChangeTimeZone:me,onChangeFiscalYearStartMonth:ve})]})},ye=Ne=>{const{widthOverride:Pe}=Ne,Ue=(0,a.$j)(),$e=(Pe||window.innerWidth)>=Ue.breakpoints.values.lg;return(0,t.jsx)(ce,{...Ne,isFullscreen:$e})},re=Ne=>{const{value:Pe,hideQuickRanges:Ue,onChange:$e,timeZone:ze,historyOptions:qe=[],showHistory:dt,onError:vt,weekStart:yt}=Ne,st=(0,a.of)(Ye),Ve=(0,s.Ar)(Pe.raw.from)||(0,s.Ar)(Pe.raw.to),[pe,Ee]=(0,i.useState)(!Ve),me=Ue?!1:pe,ve=Se=>$e(Z(Se,ze));return(0,t.jsxs)("fieldset",{children:[(0,t.jsx)("div",{className:st.header,children:(0,t.jsxs)("button",{type:"button",className:st.expandButton,onClick:()=>{Ue||Ee(!me)},"data-testid":g.Tp.components.TimePicker.absoluteTimeRangeTitle,"aria-expanded":!me,"aria-controls":"expanded-timerange",children:[(0,t.jsx)(T.e,{children:(0,t.jsx)(o.x,{i18nKey:"time-picker.absolute.title",children:"Absolute time range"})}),!Ue&&(0,t.jsx)(f.I,{name:me?"angle-down":"angle-up"})]})}),!me&&(0,t.jsxs)("div",{className:st.body,id:"expanded-timerange",children:[(0,t.jsx)("div",{className:st.form,children:(0,t.jsx)(ne,{value:Pe,onApply:$e,timeZone:ze,isFullscreen:!1,onError:vt,weekStart:yt})}),dt&&(0,t.jsx)(ie.l,{title:(0,o.t)("time-picker.absolute.recent-title","Recently used absolute ranges"),options:qe,onChange:ve,placeholderEmpty:null})]})]})},ue=Ne=>{const{onChange:Pe,value:Ue,timeZone:$e,fiscalYearStartMonth:ze,isReversed:qe,historyOptions:dt,onError:vt,weekStart:yt}=Ne,st=(0,a.of)(je,Ne.hideQuickRanges),Ve=pe=>Pe(Z(pe,$e));return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:st.container,children:[(0,t.jsx)("div",{className:st.title,"data-testid":g.Tp.components.TimePicker.absoluteTimeRangeTitle,children:(0,t.jsx)(T.e,{children:(0,t.jsx)(o.x,{i18nKey:"time-picker.absolute.title",children:"Absolute time range"})})}),(0,t.jsx)(ne,{value:Ue,timeZone:$e,fiscalYearStartMonth:ze,onApply:Pe,isFullscreen:!0,isReversed:qe,onError:vt,weekStart:yt})]}),Ne.showHistory&&(0,t.jsx)("div",{className:st.recent,children:(0,t.jsx)(ie.l,{title:(0,o.t)("time-picker.absolute.recent-title","Recently used absolute ranges"),options:dt||[],onChange:Ve,placeholderEmpty:(0,t.jsx)(De,{})})})]})},De=(0,i.memo)(()=>{const Ne=(0,a.of)(Ze),Pe=(0,o.t)("time-picker.content.empty-recent-list-info","It looks like you haven't used this time picker before. As soon as you enter some time intervals, recently used intervals will appear here.");return(0,t.jsxs)("div",{className:Ne.container,children:[(0,t.jsx)("div",{children:(0,t.jsx)("span",{children:Pe})}),(0,t.jsx)(o.x,{i18nKey:"time-picker.content.empty-recent-list-docs",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("a",{className:Ne.link,href:"https://grafana.com/docs/grafana/latest/dashboards/time-range-controls",target:"_new",children:"Read the documentation"}),(0,t.jsx)("span",{children:" to find out more about how to enter custom time ranges."})]})})]})});function ge(Ne,Pe){return!Array.isArray(Ne)||Ne.length===0?[]:Ne.map(Ue=>oe(Ue,Pe))}De.displayName="EmptyRecentList";const Te=(Ne,Pe)=>(0,i.useMemo)(()=>{if(r.isRelativeTimeRange(Ne))return Pe.find(Ue=>Ue.from===Ne.from&&Ue.to===Ne.to)},[Ne,Pe]),Le=(Ne,Pe,Ue,$e,ze)=>({container:(0,n.css)({background:Ne.colors.background.primary,boxShadow:Ne.shadows.z3,width:`${ze?"546px":"262px"}`,borderRadius:Ne.shape.radius.default,border:`1px solid ${Ne.colors.border.weak}`,[`${Pe?"left":"right"}`]:0,display:"flex",flexDirection:"column"}),body:(0,n.css)({display:"flex",flexDirection:"row-reverse",height:`${$e?"381px":"217px"}`,maxHeight:"100vh"}),leftSide:(0,n.css)({display:"flex",flexDirection:"column",borderRight:`${Pe?"none":`1px solid ${Ne.colors.border.weak}`}`,width:`${Ue?"100%":"60%"}`,overflow:"auto",scrollbarWidth:"thin",order:Pe?1:0}),rightSide:(0,n.css)({width:`${ze?"40%":"100%"}; !important`,borderRight:Pe?`1px solid ${Ne.colors.border.weak}`:"none",display:"flex",flexDirection:"column"}),timeRangeFilter:(0,n.css)({padding:Ne.spacing(1)}),spacing:(0,n.css)({marginTop:"16px"}),scrollContent:(0,n.css)({overflowY:"auto",scrollbarWidth:"thin"})}),Ye=Ne=>({header:(0,n.css)({display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",borderBottom:`1px solid ${Ne.colors.border.weak}`,padding:"7px 9px 7px 9px"}),expandButton:(0,n.css)({backgroundColor:"transparent",border:"none",display:"flex",width:"100%","&:focus-visible":(0,c.getFocusStyles)(Ne)}),body:(0,n.css)({borderBottom:`1px solid ${Ne.colors.border.weak}`}),form:(0,n.css)({padding:"7px 9px 7px 9px"})}),je=(Ne,Pe)=>({container:(0,n.css)({paddingTop:"9px",paddingLeft:"11px",paddingRight:Pe?"11px":"20%"}),title:(0,n.css)({marginBottom:"11px"}),recent:(0,n.css)({flexGrow:1,display:"flex",flexDirection:"column",justifyContent:"flex-end",paddingTop:Ne.spacing(1)})}),Ze=Ne=>({container:(0,n.css)({padding:"12px",margin:"12px","a, span":{fontSize:"13px"}}),link:(0,n.css)({color:Ne.colors.text.link})})},42617:(k,R,e)=>{"use strict";e.d(R,{e:()=>g});var t=e(74848),n=e(32196),i=e(96540),s=e(40845);const r=a=>({text:(0,n.css)({fontSize:a.typography.size.md,fontWeight:a.typography.fontWeightMedium,color:a.colors.text.primary,margin:0,display:"flex"})}),g=(0,i.memo)(({children:a})=>{const c=(0,s.of)(r);return(0,t.jsx)("h3",{className:c.text,children:a})});g.displayName="TimePickerTitle"},3799:(k,R,e)=>{"use strict";e.d(R,{f:()=>a});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(15666),g=e(47619);const a=(0,i.memo)(function({hideText:h,value:f,timeZone:d="browser",placeholder:p="No time range selected",className:m}){const v=(0,s.of)(c);return h?null:(0,t.jsx)("span",{className:m,children:(0,g.X)(f)?(0,t.jsx)(r._8,{value:f,timeZone:d}):(0,t.jsx)("span",{className:v.placeholder,children:p})})}),c=o=>({placeholder:(0,n.css)({color:o.colors.text.disabled,opacity:1})})},11752:(k,R,e)=>{"use strict";e.d(R,{l:()=>m});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(76412),g=e(42617),a=e(62938),c=e(16797);const o=E=>({container:(0,n.css)({display:"flex",alignItems:"center",flexDirection:"row-reverse",justifyContent:"space-between"}),selected:(0,n.css)({background:E.colors.action.selected,fontWeight:E.typography.fontWeightMedium}),radio:(0,n.css)({opacity:0,width:"0 !important","&:focus-visible + label":(0,c.getFocusStyles)(E)}),label:(0,n.css)({cursor:"pointer",flex:1,padding:"7px 9px 7px 9px","&:hover":{background:E.colors.action.hover,cursor:"pointer"}})}),h=(0,i.memo)(({value:E,onSelect:x,selected:P=!1,name:b})=>{const M=(0,s.of)(o),O=(0,a.A)();return(0,t.jsxs)("li",{className:(0,n.cx)(M.container,P&&M.selected),children:[(0,t.jsx)("input",{className:M.radio,checked:P,name:b,type:"checkbox","data-role":"item",tabIndex:-1,id:O,onChange:()=>x(E)}),(0,t.jsx)("label",{className:M.label,htmlFor:O,children:E.display})]})});h.displayName="TimeRangeOption";const f=(E,x)=>(E%x+x)%x,d=["ArrowUp","ArrowDown","Home","End","Enter","Tab"],p=({localRef:E,options:x})=>{const[P,b]=(0,i.useState)(0);return(0,i.useEffect)(()=>{const O=E.current?.querySelectorAll('[data-role="item"]')||[],I=Array.from(O).findIndex(C=>C.checked),T=I>=0?I:0;O.forEach((C,S)=>{C.tabIndex=S===T?0:-1}),b(T)},[E,x]),[O=>{const I=E?.current?.querySelectorAll('[data-role="item"]'),T=I?.length??0;d.indexOf(O.key)>-1&&(O.preventDefault(),O.key!=="Tab"&&O.stopPropagation());let C=null;switch(O.key){case"ArrowUp":C=f(P-1,T);break;case"ArrowDown":C=f(P+1,T);break;case"Home":C=0;break;case"End":C=T-1;break;case"Enter":I?.[P]?.click();break;default:break}C!==null&&(b(C),I?.[C]?.focus(),I?.forEach((S,A)=>{S.tabIndex=A===C?0:-1}))}]},m=E=>{const x=(0,s.of)(u),{title:P,options:b,placeholderEmpty:M}=E;return typeof M<"u"&&b.length<=0?(0,t.jsx)(t.Fragment,{children:M}):P?(0,t.jsx)("section",{"aria-label":P,children:(0,t.jsxs)("fieldset",{children:[(0,t.jsx)("div",{className:x.title,children:(0,t.jsx)(g.e,{children:P})}),(0,t.jsx)(v,{...E})]})}):(0,t.jsx)(v,{...E})},v=({options:E,value:x,onChange:P,title:b})=>{const M=(0,s.of)(D),O=(0,i.useRef)(null),[I]=p({localRef:O,options:E});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("ul",{role:"presentation",onKeyDown:I,ref:O,"aria-roledescription":(0,r.t)("time-picker.time-range.aria-role","Time range selection"),children:E.map((T,C)=>(0,t.jsx)(h,{value:T,selected:y(T,x),onSelect:P,name:b??(0,r.t)("time-picker.time-range.default-title","Time ranges")},l(T,C)))}),(0,t.jsx)("div",{className:M.grow})]})};function l(E,x){return`${E.from}-${E.to}-${x}`}function y(E,x){return!x||!E?!1:x.from===E.from&&x.to===E.to}const u=()=>({title:(0,n.css)({display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 16px 5px 9px"})}),D=()=>({grow:(0,n.css)({flexGrow:1,alignItems:"flex-start"})})},20333:(k,R,e)=>{"use strict";e.d(R,{U:()=>E});var t=e(74848),n=e(2543),i=e(96540),s=e(91410),r=e(76412),g=e(90182),a=e(32196),c=e(40845);const o=I=>{const{children:T,label:C}=I,S=(0,c.of)(h);return C?(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:S.header,children:(0,t.jsx)("span",{className:S.label,children:C})}),T]}):(0,t.jsx)("div",{children:T})},h=I=>({header:(0,a.css)({padding:"7px 10px",width:"100%",borderTop:`1px solid ${I.colors.border.weak}`,textTransform:"capitalize"}),label:(0,a.css)({fontSize:I.typography.size.sm,color:I.colors.text.secondary,fontWeight:I.typography.fontWeightMedium})});var f=e(17624),d=e(13544),p=e(14578),m=e(79451),v=e(67459);const l="tz-utc-offset",y=I=>{const{children:T,innerProps:C,innerRef:S,data:A,isSelected:L,isFocused:N}=I,F=(0,c.of)(D),w=Date.now(),B=(0,a.cx)(F.container,N&&F.containerFocused);if(!(0,n.isString)(A.value))return null;const U=(0,s.QZ)(A.value,w);return(0,t.jsx)("div",{className:B,...C,ref:S,"data-testid":d.Tp.components.Select.option,children:(0,t.jsxs)("div",{className:(0,a.cx)(F.leftColumn,F.row),children:[(0,t.jsxs)("div",{className:(0,a.cx)(F.leftColumn,F.wideRow),children:[(0,t.jsx)(v.U,{title:T}),(0,t.jsx)("div",{className:F.spacer}),(0,t.jsx)(m.E,{info:U})]}),(0,t.jsxs)("div",{className:F.rightColumn,children:[(0,t.jsx)(f.X,{timeZone:U?.ianaName||A.value,timestamp:w,className:l}),L&&(0,t.jsx)("span",{children:(0,t.jsx)(p.I,{name:"check"})})]})]})})},u=I=>{const{children:T,innerProps:C,innerRef:S,data:A,isSelected:L,isFocused:N}=I,F=(0,c.of)(D),w=Date.now(),B=(0,a.cx)(F.container,N&&F.containerFocused);if(!(0,n.isString)(A.value))return null;const U=(0,s.QZ)(A.value,w);return(0,t.jsx)("div",{className:B,...C,ref:S,"data-testid":d.Tp.components.Select.option,children:(0,t.jsxs)("div",{className:F.body,children:[(0,t.jsxs)("div",{className:F.row,children:[(0,t.jsx)("div",{className:F.leftColumn,children:(0,t.jsx)(v.U,{title:T})}),(0,t.jsx)("div",{className:F.rightColumn,children:L&&(0,t.jsx)("span",{children:(0,t.jsx)(p.I,{name:"check"})})})]}),(0,t.jsxs)("div",{className:F.row,children:[(0,t.jsx)("div",{className:F.leftColumn,children:(0,t.jsx)(m.E,{info:U})}),(0,t.jsx)("div",{className:F.rightColumn,children:(0,t.jsx)(f.X,{timestamp:w,timeZone:U?.ianaName||A.value,className:l})})]})]})})},D=I=>({container:(0,a.css)({display:"flex",alignItems:"center",flexDirection:"row",flexShrink:0,whiteSpace:"nowrap",cursor:"pointer",padding:"6px 8px 4px","&:hover":{background:I.colors.action.hover}}),containerFocused:(0,a.css)({background:I.colors.action.hover}),body:(0,a.css)({display:"flex",fontWeight:I.typography.fontWeightMedium,flexDirection:"column",flexGrow:1}),row:(0,a.css)({display:"flex",flexDirection:"row"}),leftColumn:(0,a.css)({flexGrow:1,textOverflow:"ellipsis"}),rightColumn:(0,a.css)({justifyContent:"flex-end",alignItems:"center"}),wideRow:(0,a.css)({display:"flex",flexDirection:"row",alignItems:"baseline"}),spacer:(0,a.css)({marginLeft:"6px"})}),E=I=>{const{onChange:T,width:C,autoFocus:S=!1,onBlur:A,value:L,includeInternal:N=!1,disabled:F=!1,inputId:w,menuShouldPortal:B=!0,openMenuOnFocus:U=!0}=I,K=x(N),V=P(K,L),H=M(),Y=C&&C<=45?u:y,X=(0,i.useCallback)(J=>{if(!J||!(0,n.isString)(J.value))return T(L);T(J.value)},[T,L]);return(0,t.jsx)(g.l6,{inputId:w,value:V,placeholder:(0,r.t)("time-picker.zone.select-search-input","Type to search (country, city, abbreviation)"),autoFocus:S,menuShouldPortal:B,openMenuOnFocus:U,width:C,filterOption:H,options:K,onChange:X,onBlur:A,components:{Option:Y,Group:o},disabled:F,"aria-label":(0,r.t)("time-picker.zone.select-aria-label","Time zone picker")})},x=I=>{const T=Date.now();return(0,s.U3)(I).map(S=>{const A=S.zones.reduce((L,N)=>{const F=(0,s.QZ)(N,T);return F&&L.push({label:F.name,value:F.zone,searchIndex:O(F,T)}),L},[]);return{label:S.name,options:A}})},P=(I,T)=>(0,i.useMemo)(()=>{if(T===void 0)return;const C=(0,n.toLower)(T);return I.find(A=>A.label?C.startsWith((0,n.toLower)(A.label)):b(C))?.options.find(A=>(0,n.isEmpty)(C)?A.value===s.g$.default:(0,n.toLower)(A.value)===C)},[I,T]),b=I=>{switch(I){case s.g$.default:case s.g$.localBrowserTime:case s.g$.utc:return!0;default:return!1}},M=()=>(0,i.useCallback)((I,T)=>!T||!I.data||!I.data.searchIndex?!0:I.data.searchIndex.indexOf((0,n.toLower)(T))>-1,[]),O=(I,T)=>{const C=[(0,n.toLower)(I.name),(0,n.toLower)(I.abbreviation),(0,n.toLower)((0,f.t)(T,I.zone))];for(const S of I.countries)C.push((0,n.toLower)(S.name)),C.push((0,n.toLower)(S.code));return C.join("|")}},79451:(k,R,e)=>{"use strict";e.d(R,{E:()=>r});var t=e(74848),n=e(32196),i=e(96540),s=e(40845);const r=({info:c})=>{const o=(0,s.of)(a),h=g(c);return c?(0,t.jsx)("div",{className:o.description,children:h}):null},g=c=>(0,i.useMemo)(()=>{const o=[];if(!c)return"";if(c.name==="Europe/Simferopol")return"Ukraine, EEST";if(c.countries.length>0){const h=c.countries[0];o.push(h.name)}return c.abbreviation&&o.push(c.abbreviation),o.join(", ")},[c]),a=c=>({description:(0,n.css)({fontWeight:"normal",fontSize:c.typography.size.sm,color:c.colors.text.secondary,whiteSpace:"normal",textOverflow:"ellipsis"})})},17624:(k,R,e)=>{"use strict";e.d(R,{X:()=>a,t:()=>c});var t=e(74848),n=e(32196),i=e(2543),s=e.n(i),r=e(72724),g=e(40845);const a=h=>{const{timestamp:f,timeZone:d,className:p}=h,m=(0,g.of)(o);return(0,i.isString)(d)?(0,t.jsx)(t.Fragment,{children:(0,t.jsx)("span",{className:(0,n.cx)(m.offset,p),children:c(f,d)})}):null},c=(h,f)=>`UTC${(0,r.LE)(h,{timeZone:f,format:"Z"})}`,o=h=>{const f=(0,n.css)({fontWeight:"normal",fontSize:h.typography.size.sm,color:h.colors.text.secondary,whiteSpace:"normal"});return{offset:(0,n.css)(f,{color:h.colors.text.primary,background:h.colors.background.secondary,padding:"2px 5px",borderRadius:h.shape.radius.default,marginLeft:"4px"})}}},67459:(k,R,e)=>{"use strict";e.d(R,{U:()=>s});var t=e(74848),n=e(32196),i=e(40845);const s=({title:g})=>{const a=(0,i.of)(r);return g?(0,t.jsx)("span",{className:a.title,children:g}):null},r=g=>({title:(0,n.css)({fontWeight:g.typography.fontWeightRegular,textOverflow:"ellipsis"})})},15648:(k,R,e)=>{"use strict";e.d(R,{l:()=>c,r:()=>a});var t=e(74848),n=e(96540),i=e(13544),s=e(90182);const r=[{value:"",label:"Default"},{value:"saturday",label:"Saturday"},{value:"sunday",label:"Sunday"},{value:"monday",label:"Monday"}],g=o=>["saturday","sunday","monday"].includes(o),a=o=>g(o)?o:"monday",c=o=>{const{onChange:h,width:f,autoFocus:d=!1,onBlur:p,value:m,disabled:v=!1,inputId:l}=o,y=(0,n.useCallback)(u=>{u.value!==void 0&&h(u.value)},[h]);return(0,t.jsx)(s.l6,{inputId:l,value:r.find(u=>u.value===m)?.value,placeholder:i.Tp.components.WeekStartPicker.placeholder,autoFocus:d,openMenuOnFocus:!0,width:f,options:r,onChange:y,onBlur:p,disabled:v})}},32432:(k,R,e)=>{"use strict";e.d(R,{Z:()=>n,o:()=>t});const t=[{from:"now-5m",to:"now",display:"Last 5 minutes"},{from:"now-15m",to:"now",display:"Last 15 minutes"},{from:"now-30m",to:"now",display:"Last 30 minutes"},{from:"now-1h",to:"now",display:"Last 1 hour"},{from:"now-3h",to:"now",display:"Last 3 hours"},{from:"now-6h",to:"now",display:"Last 6 hours"},{from:"now-12h",to:"now",display:"Last 12 hours"},{from:"now-24h",to:"now",display:"Last 24 hours"},{from:"now-2d",to:"now",display:"Last 2 days"},{from:"now-7d",to:"now",display:"Last 7 days"},{from:"now-30d",to:"now",display:"Last 30 days"},{from:"now-90d",to:"now",display:"Last 90 days"},{from:"now-6M",to:"now",display:"Last 6 months"},{from:"now-1y",to:"now",display:"Last 1 year"},{from:"now-2y",to:"now",display:"Last 2 years"},{from:"now-5y",to:"now",display:"Last 5 years"},{from:"now-1d/d",to:"now-1d/d",display:"Yesterday"},{from:"now-2d/d",to:"now-2d/d",display:"Day before yesterday"},{from:"now-7d/d",to:"now-7d/d",display:"This day last week"},{from:"now-1w/w",to:"now-1w/w",display:"Previous week"},{from:"now-1M/M",to:"now-1M/M",display:"Previous month"},{from:"now-1Q/fQ",to:"now-1Q/fQ",display:"Previous fiscal quarter"},{from:"now-1y/y",to:"now-1y/y",display:"Previous year"},{from:"now-1y/fy",to:"now-1y/fy",display:"Previous fiscal year"},{from:"now/d",to:"now/d",display:"Today"},{from:"now/d",to:"now",display:"Today so far"},{from:"now/w",to:"now/w",display:"This week"},{from:"now/w",to:"now",display:"This week so far"},{from:"now/M",to:"now/M",display:"This month"},{from:"now/M",to:"now",display:"This month so far"},{from:"now/y",to:"now/y",display:"This year"},{from:"now/y",to:"now",display:"This year so far"},{from:"now/fQ",to:"now",display:"This fiscal quarter so far"},{from:"now/fQ",to:"now/fQ",display:"This fiscal quarter"},{from:"now/fy",to:"now",display:"This fiscal year so far"},{from:"now/fy",to:"now/fy",display:"This fiscal year"}],n=[{label:"January",value:0},{label:"February",value:1},{label:"March",value:2},{label:"April",value:3},{label:"May",value:4},{label:"June",value:5},{label:"July",value:6},{label:"August",value:7},{label:"September",value:8},{label:"October",value:9},{label:"November",value:10},{label:"December",value:11}]},47619:(k,R,e)=>{"use strict";e.d(R,{X:()=>r,f:()=>s});var t=e(47232),n=e(85858),i=e(53531);function s(g,a,c){return(0,t.Ar)(g)?g.isValid():n.isMathString(g)?n.isValid(g):(0,i.b)(g,{roundUp:a,timeZone:c}).isValid()}function r(g){return n.isValid(g.from)&&n.isValid(g.to)}},99225:(k,R,e)=>{"use strict";e.d(R,{Q:()=>n});var t=e(91410);function n(i,s){const r=(0,t.HD)(s);if(!r)return i;const g=r.utcOffset(i.getTime()),a=i.getTimezoneOffset(),c=g-a;return new Date(i.getTime()-c*1e3*60)}},25994:(k,R,e)=>{"use strict";e.d(R,{c:()=>s});var t=e(74848),n=e(32196),i=e(40845);const s=({direction:g="horizontal",spacing:a=2})=>{const c=(0,i.of)(r,a);return g==="vertical"?(0,t.jsx)("div",{className:c.verticalDivider}):(0,t.jsx)("hr",{className:c.horizontalDivider})};s.displayName="Divider";const r=(g,a)=>({horizontalDivider:(0,n.css)({borderTop:`1px solid ${g.colors.border.weak}`,margin:g.spacing(a,0),width:"100%"}),verticalDivider:(0,n.css)({borderRight:`1px solid ${g.colors.border.weak}`,margin:g.spacing(0,a),height:"100%"})})},69144:(k,R,e)=>{"use strict";e.d(R,{l:()=>n});var t=e(32196);const n=(i,s)=>{const r=s||"middle",g=i.colors.emphasize(i.colors.background.secondary,.15),a=i.colors.primary.border,c=i.spacing(2),o=4,h=200;let f="50%",d="50%";switch(r){case"start":{f="0%",d="0%";break}case"end":{f="100%",d="100%";break}}const p=(0,t.css)({position:"relative","&:before":{content:'""',position:"absolute",transition:i.transitions.create("border-color"),zIndex:1},"&:after":{background:g,content:'""',position:"absolute",transition:i.transitions.create("background"),transform:"translate(-50%, -50%)",borderRadius:i.shape.radius.pill,zIndex:1},"&:hover":{"&:before":{borderColor:a},"&:after":{background:a}}});return{dragHandleVertical:(0,t.cx)(p,(0,t.css)({cursor:"col-resize",width:c,"&:before":{borderRight:"1px solid transparent",height:"100%",left:f,transform:"translateX(-50%)"},"&:after":{left:f,top:"50%",height:h,width:o}})),dragHandleHorizontal:(0,t.cx)(p,(0,t.css)({height:c,cursor:"row-resize","&:before":{borderTop:"1px solid transparent",top:d,transform:"translateY(-50%)",width:"100%"},"&:after":{left:"50%",top:d,height:o,width:h}}))}}},87978:(k,R,e)=>{"use strict";e.d(R,{_:()=>y});var t=e(74848),n=e(32196),i=e(18828),s=e(85690),r=e(93225),g=e(50848),a=e(96540),c=e(13544),o=e(40845),h=e(76412),f=e(40276),d=e(69144),p=e(29158),m=e(94753),v=e(24932);const l={sm:{width:"25vw",minWidth:384},md:{width:"50vw",minWidth:568},lg:{width:"75vw",minWidth:744}};function y({children:b,onClose:M,closeOnMaskClick:O=!0,scrollableContent:I=!0,title:T,subtitle:C,width:S,size:A="md",tabs:L}){const[N,F,w]=u(),B=(0,o.of)(x),U=(0,o.of)(P,A),K=(0,o.of)(d.l),V=a.useRef(null),{dialogProps:H,titleProps:Y}=(0,i.s)({},V),{overlayProps:X}=(0,r.e)({isDismissable:!1,isOpen:!0,onClose:M},V);E();const J=(0,t.jsx)("div",{className:B.content,children:b}),q=N??S??l[A].width,ae=l[A].minWidth;return(0,t.jsx)(g.A,{open:!0,onClose:M,placement:"right",getContainer:".main-view",className:B.drawerContent,rootClassName:B.drawer,classNames:{wrapper:U},styles:{wrapper:{width:q,minWidth:ae}},width:"",motion:{motionAppear:!0,motionName:B.drawerMotion},maskClassName:B.mask,maskClosable:O,maskMotion:{motionAppear:!0,motionName:B.maskMotion},children:(0,t.jsx)(s.n1,{restoreFocus:!0,contain:!0,autoFocus:!0,children:(0,t.jsxs)("div",{"aria-label":typeof T=="string"?c.Tp.components.Drawer.General.title(T):c.Tp.components.Drawer.General.title("no title"),className:B.container,...X,...H,ref:V,children:[(0,t.jsx)("div",{className:(0,n.cx)(K.dragHandleVertical,B.resizer),onMouseDown:F,onTouchStart:w}),typeof T=="string"&&(0,t.jsxs)("div",{className:(0,n.cx)(B.header,!!L&&B.headerWithTabs),children:[(0,t.jsx)("div",{className:B.actions,children:(0,t.jsx)(p.K,{name:"times",variant:"secondary",onClick:M,"data-testid":c.Tp.components.Drawer.General.close,tooltip:(0,h.t)("grafana-ui.drawer.close","Close")})}),(0,t.jsxs)("div",{className:B.titleWrapper,children:[(0,t.jsx)(m.E,{element:"h3",...Y,children:T}),C&&(0,t.jsx)("div",{className:B.subtitle,"data-testid":c.Tp.components.Drawer.General.subtitle,children:C}),L&&(0,t.jsx)("div",{className:B.tabsWrapper,children:L})]})]}),typeof T!="string"&&T,I?(0,t.jsx)(f.E,{children:J}):J]})})})}function u(){const[b,M]=(0,a.useState)(void 0),O=(0,a.useCallback)(L=>{M(D(L.clientX))},[]),I=(0,a.useCallback)(L=>{const N=L.touches[0];M(D(N.clientX))},[]),T=(0,a.useCallback)(L=>{document.removeEventListener("mousemove",O),document.removeEventListener("mouseup",T)},[O]),C=(0,a.useCallback)(L=>{document.removeEventListener("touchmove",I),document.removeEventListener("touchend",C)},[I]);function S(L){L.stopPropagation(),L.preventDefault(),document.addEventListener("mousemove",O),document.addEventListener("mouseup",T)}function A(L){L.stopPropagation(),L.preventDefault(),document.addEventListener("touchmove",I),document.addEventListener("touchend",C)}return[b,S,A]}function D(b){let M=document.body.offsetWidth-(b-document.body.offsetLeft);return`${Math.min(M/document.body.clientWidth*100,98).toFixed(2)}vw`}function E(){(0,a.useEffect)(()=>{if(document.body)return document.body.classList.add("body-drawer-open"),()=>{document.body.classList.remove("body-drawer-open")}},[])}const x=b=>({container:(0,n.css)({display:"flex",flexDirection:"column",height:"100%",flex:"1 1 0",minHeight:"100%",position:"relative"}),drawer:(0,n.css)({".main-view &":{top:80},".main-view--search-bar-hidden &":{top:40},".main-view--chrome-hidden &":{top:0},".rc-drawer-content-wrapper":{boxShadow:b.shadows.z3}}),drawerContent:(0,n.css)({backgroundColor:`${b.colors.background.primary} !important`,display:"flex",overflow:"unset !important",flexDirection:"column"}),drawerMotion:(0,n.css)({"&-appear":{transform:"translateX(100%)",transition:"none !important","&-active":{transition:`${b.transitions.create("transform")} !important`,transform:"translateX(0)"}}}),mask:(0,n.css)({backgroundColor:"transparent",position:"fixed","&:before":{backgroundColor:`${b.components.overlay.background} !important`,backdropFilter:"blur(1px)",bottom:0,content:'""',left:0,position:"fixed",right:0,".main-view &":{top:80},".main-view--search-bar-hidden &":{top:40},".main-view--chrome-hidden &":{top:0}}}),maskMotion:(0,n.css)({"&-appear":{opacity:0,"&-active":{opacity:1,transition:b.transitions.create("opacity")}}}),header:(0,n.css)({label:"drawer-header",flexGrow:0,padding:b.spacing(2,2,3),borderBottom:`1px solid ${b.colors.border.weak}`}),headerWithTabs:(0,n.css)({borderBottom:"none"}),actions:(0,n.css)({position:"absolute",right:b.spacing(1),top:b.spacing(1)}),titleWrapper:(0,n.css)({label:"drawer-title",overflowWrap:"break-word"}),subtitle:(0,n.css)({label:"drawer-subtitle",color:b.colors.text.secondary,paddingTop:b.spacing(1)}),content:(0,n.css)({padding:b.spacing(2),height:"100%",flexGrow:1}),tabsWrapper:(0,n.css)({label:"drawer-tabs",paddingLeft:b.spacing(2),margin:b.spacing(1,-1,-3,-3)}),resizer:(0,n.css)({top:0,left:b.spacing(-1),bottom:0,position:"absolute",zIndex:b.zIndex.modal})});function P(b,M){return(0,n.css)({label:`drawer-content-wrapper-${M}`,overflow:"unset !important",[b.breakpoints.down("md")]:{width:`calc(100% - ${b.spacing(2)}) !important`,minWidth:"0 !important"}})}},9261:(k,R,e)=>{"use strict";e.d(R,{f:()=>p});var t=e(74848),n=e(32196),i=e(34743),s=e(36376),r=e(7315),g=e(85690),a=e(96540),c=e(40845),o=e(38138),h=e(64539),f=e(27746);const d=v=>{const{className:l,options:y,value:u,onChange:D,narrow:E,variant:x,...P}=v,b=(0,c.of)(m),[M,O]=(0,a.useState)(!1),I=[(0,i.cY)(0),(0,i.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,i.BN)()],{context:T,refs:C,floatingStyles:S}=(0,s.we)({open:M,placement:"bottom-end",onOpenChange:O,middleware:I,whileElementsMounted:r.ll}),A=(0,s.kp)(T),L=(0,s.s9)(T),{getReferenceProps:N,getFloatingProps:F}=(0,s.bv)([L,A]),w=B=>{D(B),O(!1)};return(0,t.jsxs)("div",{className:b.wrapper,children:[(0,t.jsx)(f.I,{className:l,isOpen:M,narrow:E,variant:x,ref:C.setReference,...N(),...P,children:u?.label||(u?.value!=null?String(u?.value):null)}),M&&(0,t.jsx)("div",{className:b.menuWrapper,ref:C.setFloating,...F(),style:S,children:(0,t.jsx)(g.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,t.jsx)(o.W,{tabIndex:-1,onClose:()=>O(!1),children:y.map(B=>(0,t.jsx)(h.D,{label:B.label??String(B.value),onClick:()=>w(B),active:B.value===u?.value,ariaChecked:B.value===u?.value,ariaLabel:B.ariaLabel||B.label,disabled:B.isDisabled,component:B.component,role:"menuitemradio"},`${B.value}`))})})})]})};d.displayName="ButtonSelect";const p=(0,a.memo)(d),m=v=>({wrapper:(0,n.css)({position:"relative",display:"inline-flex"}),menuWrapper:(0,n.css)({zIndex:v.zIndex.dropdown})})},83122:(k,R,e)=>{"use strict";e.d(R,{m:()=>d});var t=e(74848),n=e(32196),i=e(34743),s=e(36376),r=e(7315),g=e(96540),a=e(86634),c=e(40845),o=e(67892),h=e(18976),f=e(17464);const d=g.memo(({children:m,overlay:v,placement:l,offset:y,onVisibleChange:u})=>{const[D,E]=(0,g.useState)(!1),x=(0,g.useRef)(null),P=(0,g.useCallback)(B=>{E(B),u?.(B)},[u]),b=[(0,i.cY)({mainAxis:y?.[0]??8,crossAxis:y?.[1]??0}),(0,i.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,i.BN)()],{context:M,refs:O,floatingStyles:I}=(0,s.we)({open:D,placement:(0,h.O)(l),onOpenChange:P,middleware:b,whileElementsMounted:r.ll}),T=(0,s.kp)(M),C=(0,s.s9)(M),{getReferenceProps:S,getFloatingProps:A}=(0,s.bv)([C,T]),L=150,N=(0,c.of)(p,L),F=()=>{P(!1)},w=B=>{B.key==="Tab"&&P(!1)};return(0,t.jsxs)(t.Fragment,{children:[g.cloneElement(m,{ref:O.setReference,...S()}),D&&(0,t.jsx)(f.ZL,{children:(0,t.jsx)(s.s3,{context:M,children:(0,t.jsx)("div",{ref:O.setFloating,style:I,onClick:F,onKeyDown:w,children:(0,t.jsx)(a.A,{nodeRef:x,appear:!0,in:!0,timeout:{appear:L,exit:0,enter:0},classNames:N,children:(0,t.jsx)("div",{ref:x,children:o.renderOrCallToRender(v,{...A()})})})})})})]})});d.displayName="Dropdown";const p=(m,v)=>({appear:(0,n.css)({opacity:"0",position:"relative",transformOrigin:"top",[m.transitions.handleMotion("no-preference")]:{transform:"scaleY(0.5)"}}),appearActive:(0,n.css)({opacity:"1",[m.transitions.handleMotion("no-preference")]:{transform:"scaleY(1)",transition:`transform ${v}ms cubic-bezier(0.2, 0, 0.2, 1), opacity ${v}ms cubic-bezier(0.2, 0, 0.2, 1)`}})})},41670:(k,R,e)=>{"use strict";e.d(R,{Z:()=>s});var t=e(74848),n=e(32196),i=e(40845);const s=({children:g})=>{const a=(0,i.of)(r);return(0,t.jsx)("div",{className:a.container,children:g})},r=g=>({container:(0,n.css)({borderLeft:`3px solid ${g.colors.info.main}`,backgroundColor:`${g.colors.background.secondary}`,padding:g.spacing(2),minWidth:"350px",borderRadius:g.shape.radius.default,marginBottom:g.spacing(4)})})},69529:(k,R,e)=>{"use strict";e.d(R,{p:()=>x});var t=e(74848),n=e(32196),i=e(8867),s=e(40845),r=e(90613),g=e(67061),a=e(94753),c=e(36348);const o=({width:M="auto",height:O})=>{const I=(0,s.of)(h);return(0,t.jsx)(i.default,{src:c,className:I.svg,height:O,width:M})};o.displayName="GrotCTA";const h=M=>({svg:(0,n.css)({"#grot-cta-cactus-1, #grot-cta-cactus-2":{fill:M.isDark?"#58558c":"#c9c5f4"}})});var f=e(96540),d=e(22687);const p=-20,m=5,v=-5,l=5,y=({width:M="auto",height:O})=>{const I=(0,f.useRef)(null),T=(0,s.of)(u);return(0,f.useEffect)(()=>{const C=S=>{if(window.matchMedia("(prefers-reduced-motion: reduce").matches)return;const A=I.current?.querySelector("#grot-not-found-arm"),L=I.current?.querySelector("#grot-not-found-magnifier"),{clientX:N,clientY:F}=S,{innerWidth:w,innerHeight:B}=window,U=F/B,K=N/w,V=D(U,p,m),H=D(K,v,l);window.requestAnimationFrame(()=>{A?.setAttribute("style",`transform: rotate(${V}deg) translateX(${H}%)`),L?.setAttribute("style",`transform: rotate(${V}deg) translateX(${H}%)`)})};return window.addEventListener("mousemove",C),()=>{window.removeEventListener("mousemove",C)}},[]),(0,t.jsx)(i.default,{innerRef:I,src:d,className:T.svg,height:O,width:M})};y.displayName="GrotNotFound";const u=M=>({svg:(0,n.css)({"#grot-not-found-arm, #grot-not-found-magnifier":{transformOrigin:"center"}})}),D=(M,O,I)=>M*(I-O)+O;var E=e(9886);const x=({button:M,children:O,image:I,message:T,hideImage:C=!1,variant:S,role:A})=>{const L=(0,s.of)(b),N=I??P(S);return(0,t.jsx)(r.a,{paddingY:4,display:"flex",direction:"column",alignItems:"center",role:A,children:(0,t.jsxs)("div",{className:L.container,children:[!C&&N,(0,t.jsxs)(g.B,{direction:"column",alignItems:"center",children:[(0,t.jsx)(a.E,{variant:"h4",textAlignment:"center",children:T}),O&&(0,t.jsx)(a.E,{color:"secondary",textAlignment:"center",children:O})]}),M]})})};function P(M){switch(M){case"call-to-action":return(0,t.jsx)(o,{width:300});case"not-found":return(0,t.jsx)(y,{width:300});case"completed":return(0,t.jsx)(i.default,{src:E,width:300});default:throw new Error(`Unknown variant: ${M}`)}}const b=M=>({container:(0,n.css)({display:"flex",flexDirection:"column",alignItems:"center",gap:M.spacing(4),maxWidth:"600px"})})},66602:(k,R,e)=>{"use strict";e.d(R,{Xc:()=>c,Xw:()=>a,tH:()=>g});var t=e(74848),n=e(96540),i=e(32631),s=e(42418),r=e(52446);class g extends n.PureComponent{constructor(){super(...arguments),this.state={error:null,errorInfo:null}}componentDidCatch(h,f){i.P?.api?.pushError(h),this.setState({error:h,errorInfo:f}),this.props.onError&&this.props.onError(h)}componentDidUpdate(h){const{dependencies:f,onRecover:d}=this.props;if(this.state.error&&f&&h.dependencies){for(let p=0;p<f.length;p++)if(f[p]!==h.dependencies[p]){this.setState({error:null,errorInfo:null}),d&&d();break}}}render(){const{children:h}=this.props,{error:f,errorInfo:d}=this.state;return h({error:f,errorInfo:d})}}class a extends n.PureComponent{static{this.defaultProps={title:"An unexpected error happened",style:"alertbox"}}render(){const{title:h,children:f,style:d,dependencies:p}=this.props;return(0,t.jsx)(g,{dependencies:p,children:({error:m,errorInfo:v})=>v?d==="alertbox"?(0,t.jsx)(s.F,{title:h||"",children:(0,t.jsxs)("details",{style:{whiteSpace:"pre-wrap"},children:[m&&m.toString(),(0,t.jsx)("br",{}),v.componentStack]})}):(0,t.jsx)(r.D,{title:h||"",error:m,errorInfo:v}):f})}}function c(o,h={}){const f=d=>(0,t.jsx)(a,{...h,children:(0,t.jsx)(o,{...d})});return f.displayName="WithErrorBoundary",f}},52446:(k,R,e)=>{"use strict";e.d(R,{D:()=>s});var t=e(74848),n=e(32196),i=e(40845);const s=({error:g,errorInfo:a,title:c})=>{const o=(0,i.of)(r);return(0,t.jsxs)("div",{className:o,children:[(0,t.jsx)("h2",{children:c}),(0,t.jsxs)("details",{style:{whiteSpace:"pre-wrap"},children:[g&&g.toString(),(0,t.jsx)("br",{}),a&&a.componentStack]})]})};s.displayName="ErrorWithStack";const r=()=>(0,n.css)({width:"500px",margin:"64px auto"})},29678:(k,R,e)=>{"use strict";e.d(R,{y:()=>s});var t=e(74848),n=e(41987),i=e(39938);const s=({featureState:g,tooltip:a})=>{const c=r(g);return(0,t.jsx)(i.E,{text:c.text,color:c.color,icon:c.icon,tooltip:a})};function r(g){switch(g){case n.Ay.alpha:return{text:"Alpha",icon:"exclamation-triangle",color:"orange"};case n.Ay.beta:return{text:"Beta",icon:"rocket",color:"blue"};case n.Ay.experimental:return{text:"Experimental",icon:"exclamation-triangle",color:"orange"};case n.Ay.preview:return{text:"Preview",icon:"rocket",color:"blue"};case n.Ay.privatePreview:return{text:"Private preview",icon:"rocket",color:"blue"}}}},37270:(k,R,e)=>{"use strict";e.d(R,{gH:()=>p,wI:()=>l});var t=e(74848),n=e(32196),i=e(2543),s=e.n(i),r=e(96540),g=e(20978),a=e(47172),c=e(83195),o=e(40845),h=e(42418),f=e(14578),d=e(95950);function p({options:x,children:P,readAs:b,onLoad:M,fileListRenderer:O,onFileRemove:I}){const[T,C]=(0,r.useState)([]),[S,A]=(0,r.useState)([]),L=(0,c.j_)("decbytes")(x?.maxSize?x?.maxSize:0),N=(0,r.useCallback)((ae,j)=>{C(te=>te.map(ne=>(ne.id===ae.id&&j(ne),ne)))},[]),F=(0,r.useCallback)((ae,j,te)=>{let ne=ae.map(D);if(x?.multiple===!1?C(ne):C(le=>[...le,...ne]),X(j),x?.onDrop)x.onDrop(ae,j,te);else for(const le of ne){const z=new FileReader,ee=()=>{b?z[b](le.file):z.readAsText(le.file)};N(le,se=>{se.abortUpload=()=>{z.abort()},se.retryUpload=()=>{N(le,ie=>{ie.error=null,ie.progress=void 0}),ee()}}),z.onabort=()=>{N(le,se=>{se.error=new DOMException("Aborted")})},z.onprogress=se=>{N(le,ie=>{ie.progress=se.loaded})},z.onload=()=>{M?.(z.result)},z.onerror=()=>{N(le,se=>{se.error=z.error})},ee()}},[M,x,b,N]),w=ae=>{const j=T.filter(te=>ae.id!==te.id);C(j),I?.(ae)},{getRootProps:B,getInputProps:U,isDragActive:K}=(0,g.VB)({...x,useFsAccessApi:!1,onDrop:F,accept:v(x?.accept)}),V=(0,o.$j)(),H=E(V,K),Y=T.map(ae=>O?O(ae,w):(0,t.jsx)(d.I,{file:ae,removeFile:w},ae.id)),X=ae=>{let j=[];ae.map(te=>{te.errors.map(ne=>{j.findIndex(le=>le.code===ne.code&&le.message===ne.message)===-1&&j.push(ne)})}),A(j)},J=ae=>(0,t.jsx)("div",{className:H.errorAlert,children:(0,t.jsx)(h.F,{title:"Upload failed",severity:"error",onRemove:q,children:ae.map(j=>{switch(j.code){case a.O4.FileTooLarge:return(0,t.jsxs)("div",{children:["File is larger than ",(0,c.cN)(L)]},j.message+j.code);default:return(0,t.jsx)("div",{children:j.message},j.message+j.code)}})})}),q=()=>{A([])};return(0,t.jsxs)("div",{className:H.container,children:[(0,t.jsxs)("div",{"data-testid":"dropzone",...B({className:H.dropzone}),children:[(0,t.jsx)("input",{...U()}),P??(0,t.jsx)(l,{primaryText:y(T,x)})]}),S.length>0&&J(S),(0,t.jsxs)("small",{className:(0,n.cx)(H.small,H.acceptContainer),children:[x?.maxSize&&`Max file size: ${(0,c.cN)(L)}`,x?.maxSize&&x?.accept&&(0,t.jsx)("span",{className:H.acceptSeparator,children:"|"}),x?.accept&&u(x.accept)]}),Y]})}function m(x){return["txt","json","csv","xls","yml"].some(P=>x.match(P))?"text/plain":"application/octet-stream"}function v(x){return(0,i.isString)(x)?{[m(x)]:[x]}:Array.isArray(x)?x.reduce((P,b)=>{const M=m(b);return P[M]=P[M]?[...P[M],b]:[b],P},{}):x}function l({primaryText:x="Drop file here or click to upload",secondaryText:P=""}){const b=(0,o.$j)(),M=E(b);return(0,t.jsxs)("div",{className:(0,n.cx)(M.defaultDropZone),"data-testid":"file-drop-zone-default-children",children:[(0,t.jsx)(f.I,{className:(0,n.cx)(M.icon),name:"upload",size:"xl"}),(0,t.jsx)("h6",{className:(0,n.cx)(M.primaryText),children:x}),(0,t.jsx)("small",{className:M.small,children:P})]})}function y(x,P){return P?.multiple===void 0||P?.multiple?"Upload file":x.length?"Replace file":"Upload file"}function u(x){return(0,i.isString)(x)?`Accepted file type: ${x}`:Array.isArray(x)?`Accepted file types: ${x.join(", ")}`:`Accepted file types: ${Object.values(x).flat().join(", ")}`}function D(x){return{id:(0,i.uniqueId)("file"),file:x,error:null}}function E(x,P){return{container:(0,n.css)({display:"flex",flexDirection:"column",width:"100%",padding:x.spacing(2),borderRadius:x.shape.radius.default,border:`1px dashed ${x.colors.border.strong}`,backgroundColor:P?x.colors.background.secondary:x.colors.background.primary,cursor:"pointer",alignItems:"center",justifyContent:"center"}),dropzone:(0,n.css)({height:"100%",width:"100%",display:"flex",flexDirection:"column"}),defaultDropZone:(0,n.css)({textAlign:"center"}),icon:(0,n.css)({marginBottom:x.spacing(1)}),primaryText:(0,n.css)({marginBottom:x.spacing(1)}),acceptContainer:(0,n.css)({textAlign:"center",margin:0}),acceptSeparator:(0,n.css)({margin:`0 ${x.spacing(1)}`}),small:(0,n.css)({color:x.colors.text.secondary}),errorAlert:(0,n.css)({paddingTop:"10px"})}}},95950:(k,R,e)=>{"use strict";e.d(R,{I:()=>h});var t=e(74848),n=e(32196),i=e(83195),s=e(40845),r=e(53550),g=e(55852),a=e(14578),c=e(29158);const o="Remove file";function h({file:d,removeFile:p}){const m=(0,s.of)(f),{file:v,progress:l,error:y,abortUpload:u,retryUpload:D}=d,E=()=>y?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:m.error,children:y.message}),D&&(0,t.jsx)(c.K,{name:"sync",tooltip:"Retry",tooltipPlacement:"top",onClick:D}),p&&(0,t.jsx)(c.K,{className:D?m.marginLeft:"",name:"trash-alt",onClick:()=>p(d),tooltip:o})]}):l&&v.size>l?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("progress",{className:m.progressBar,max:v.size,value:l}),(0,t.jsxs)("span",{className:m.paddingLeft,children:[Math.round(l/v.size*100),"%"]}),u&&(0,t.jsx)(g.$n,{variant:"secondary",type:"button",fill:"text",onClick:u,children:"Cancel upload"})]}):p&&(0,t.jsx)(c.K,{name:"trash-alt",onClick:()=>p(d),tooltip:o,tooltipPlacement:"top"}),x=(0,i.j_)("decbytes")(v.size);return(0,t.jsxs)("div",{className:m.fileListContainer,children:[(0,t.jsxs)("span",{className:m.fileNameWrapper,children:[(0,t.jsx)(a.I,{name:"file-blank",size:"lg","aria-hidden":!0}),(0,t.jsx)("span",{className:m.padding,children:(0,r.i)(v.name)}),(0,t.jsx)("span",{children:(0,i.cN)(x)})]}),(0,t.jsx)("div",{className:m.fileNameWrapper,children:E()})]})}function f(d){return{fileListContainer:(0,n.css)({width:"100%",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:d.spacing(2),border:`1px dashed ${d.colors.border.medium}`,backgroundColor:`${d.colors.background.secondary}`,marginTop:d.spacing(1)}),fileNameWrapper:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"center"}),padding:(0,n.css)({padding:d.spacing(0,1)}),paddingLeft:(0,n.css)({paddingLeft:d.spacing(2)}),marginLeft:(0,n.css)({marginLeft:d.spacing(1)}),error:(0,n.css)({paddingRight:d.spacing(2),color:d.colors.error.text}),progressBar:(0,n.css)({borderRadius:d.shape.radius.default,height:"4px","::-webkit-progress-bar":{backgroundColor:d.colors.border.weak,borderRadius:d.shape.radius.default},"::-webkit-progress-value":{backgroundColor:d.colors.primary.main,borderRadius:d.shape.radius.default}})}}},92887:(k,R,e)=>{"use strict";e.d(R,{IB:()=>n.I,gH:()=>t.gH,wI:()=>t.wI});var t=e(37270),n=e(95950)},73546:(k,R,e)=>{"use strict";e.d(R,{e:()=>f});var t=e(74848),n=e(32196),i=e(96540),s=e(62938),r=e(13544),g=e(40845),a=e(16797),c=e(53550),o=e(55852),h=e(14578);const f=({onFileUpload:p,className:m,children:v="Upload file",accept:l="*",size:y="md",showFileName:u})=>{const D=(0,g.of)(d(y)),[E,x]=(0,i.useState)(""),P=(0,s.A)(),b=(0,i.useCallback)(M=>{const O=M.currentTarget?.files?.[0];O&&x(O.name??""),p(M)},[p]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("input",{type:"file",id:P,className:D.fileUpload,onChange:b,multiple:!1,accept:l,"data-testid":r.Tp.components.FileUpload.inputField}),(0,t.jsxs)("label",{htmlFor:P,className:(0,n.cx)(D.labelWrapper,m),children:[(0,t.jsx)(h.I,{name:"upload",className:D.icon}),v]}),u&&E&&(0,t.jsx)("span",{"aria-label":"File name",className:D.fileName,"data-testid":r.Tp.components.FileUpload.fileNameSpan,children:(0,c.i)(E)})]})},d=p=>m=>{const v=(0,o.hs)({theme:m,variant:"primary",size:p,iconOnly:!1}),l=(0,a.getFocusStyles)(m);return{fileUpload:(0,n.css)({height:"0.1px",opacity:"0",overflow:"hidden",position:"absolute",width:"0.1px",zIndex:-1,"&:focus + label":l,"&:focus-visible + label":l}),labelWrapper:v.button,icon:v.icon,fileName:(0,n.css)({marginLeft:m.spacing(.5)})}}},67647:(k,R,e)=>{"use strict";e.d(R,{Z:()=>c});var t=e(74848),n=e(96540),i=e(54479);function s(...o){const h=n.useRef(null);return n.useEffect(()=>{o.forEach(f=>{f&&(typeof f=="function"?f(h.current):f.current=h.current)})},[o]),h}var r=e(55852),g=e(14578),a=e(10354);const c=(0,n.forwardRef)(({value:o,width:h,onChange:f,escapeRegex:d=!0,...p},m)=>{const v=(0,n.useRef)(null),l=s(m,v),y=o!==""?(0,t.jsx)(r.$n,{icon:"times",fill:"text",size:"sm",onClick:u=>{v.current?.focus(),f(""),u.stopPropagation()},children:"Clear"}):null;return(0,t.jsx)(a.p,{prefix:(0,t.jsx)(g.I,{name:"search"}),suffix:y,width:h,type:"text",value:d?(0,i.xb)(o??""):o,onChange:u=>f(d?(0,i.jD)(u.currentTarget.value):u.currentTarget.value),...p,ref:l})});c.displayName="FilterInput"},92174:(k,R,e)=>{"use strict";e.d(R,{m:()=>g});var t=e(74848),n=e(32196),i=e(40845),s=e(55852),r=e(14578);const g=({label:c,selected:o,onClick:h,icon:f="check"})=>{const d=(0,i.of)(a),p=(0,i.of)(s.my);return(0,t.jsxs)("button",{type:"button",className:(0,n.cx)(p,d.wrapper,o&&d.selected),onClick:h,children:[(0,t.jsx)("span",{children:c}),o&&(0,t.jsx)(r.I,{name:f,className:d.icon})]})},a=c=>({wrapper:(0,n.css)({background:c.colors.background.secondary,borderRadius:c.shape.radius.pill,padding:c.spacing(0,2),fontSize:c.typography.bodySmall.fontSize,fontWeight:c.typography.fontWeightMedium,lineHeight:c.typography.bodySmall.lineHeight,color:c.colors.text.secondary,display:"flex",alignItems:"center",height:"32px",position:"relative",border:`1px solid ${c.colors.background.secondary}`,whiteSpace:"nowrap","&:hover":{background:c.colors.action.hover,color:c.colors.text.primary}}),selected:(0,n.css)({color:c.colors.text.primary,background:c.colors.action.selected,"&:hover":{background:c.colors.action.focus}}),icon:(0,n.css)({marginLeft:c.spacing(.5)})})},90090:(k,R,e)=>{"use strict";e.d(R,{z:()=>s});var t=e(74848),n=e(32196),i=e(38894);const s=({label:g,tooltip:a,labelWidth:c=6,inputWidth:o=12,inputEl:h,className:f,interactive:d,...p})=>{const m=r();return(0,t.jsxs)("div",{className:(0,n.cx)(m.formField,f),children:[(0,t.jsx)(i.I,{width:c,tooltip:a,interactive:d,children:g}),h||(0,t.jsx)("input",{type:"text",className:`gf-form-input ${o?`width-${o}`:""}`,...p,disabled:p.disabled})]})};s.displayName="FormField";const r=()=>({formField:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"flex-start",textAlign:"left",position:"relative"})})},38894:(k,R,e)=>{"use strict";e.d(R,{I:()=>a});var t=e(74848),n=e(46942),i=e.n(n),s=e(14578),r=e(56034);const a=({children:c,isFocused:o,isInvalid:h,className:f,htmlFor:d,tooltip:p,width:m,interactive:v,...l})=>{const y=i()(f,`gf-form-label width-${m||"10"}`,{"gf-form-label--is-focused":o,"gf-form-label--is-invalid":h});return(0,t.jsxs)("label",{className:y,...l,htmlFor:d,children:[c,p&&(0,t.jsx)(r.m,{placement:"top",content:p,theme:"info",interactive:v,children:(0,t.jsx)(s.I,{name:"info-circle",size:"sm",style:{marginLeft:"10px"}})})]})}},9286:(k,R,e)=>{"use strict";e.d(R,{i:()=>i});var t=e(74848);function n(s){return s<20?.9:s<26?.8:.6}const i=({value:s,className:r,style:g,...a})=>{const c=(s.prefix??"").length>0,o=(s.suffix??"").length>0;let h;if(g&&g.fontSize&&typeof g.fontSize=="number"){const f=g.fontSize,d=n(f);h={fontSize:f*d}}return(0,t.jsx)("div",{className:r,style:g,...a,children:(0,t.jsxs)("div",{children:[c&&(0,t.jsx)("span",{children:s.prefix}),(0,t.jsx)("span",{children:s.text}),o&&(0,t.jsx)("span",{style:h,children:s.suffix})]})})};i.displayName="FormattedDisplayValue"},10880:(k,R,e)=>{"use strict";e.d(R,{S:()=>a});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(16797),g=e(60029);const a=i.forwardRef(({label:o,description:h,value:f,htmlValue:d,onChange:p,disabled:m,className:v,indeterminate:l,invalid:y,...u},D)=>{const E=(0,i.useCallback)(b=>{p&&p(b)},[p]),x=(0,s.of)(c,y),P=l?"mixed":void 0;return(0,t.jsxs)("label",{className:(0,n.cx)(x.wrapper,v),children:[(0,t.jsxs)("div",{className:x.checkboxWrapper,children:[(0,t.jsx)("input",{type:"checkbox",className:(0,n.cx)(x.input,l&&x.inputIndeterminate),checked:f,disabled:m,onChange:E,value:d,"aria-checked":P,...u,ref:D}),(0,t.jsx)("span",{className:x.checkmark})]}),o&&(0,t.jsx)("span",{className:x.label,children:o}),h&&(0,t.jsx)("span",{className:x.description,children:h})]})}),c=(o,h=!1)=>{const f=(0,g.f)(o),d=2,p=1,m=v=>h?o.colors.error.border:v;return{wrapper:(0,n.css)({display:"inline-grid",alignItems:"center",columnGap:o.spacing(p),gridAutoRows:"max-content",position:"relative",verticalAlign:"middle"}),input:(0,n.css)({position:"absolute",zIndex:1,top:0,left:0,width:"100% !important",height:"100%",opacity:0,"&:focus + span, &:focus-visible + span":(0,r.getFocusStyles)(o),"&:focus:not(:focus-visible) + span":(0,r.getMouseFocusStyles)(o),"&:checked + span":{background:o.colors.primary.main,border:`1px solid ${m(o.colors.primary.main)}`,"&:hover":{background:o.colors.primary.shade},"&:after":{content:'""',position:"absolute",zIndex:2,left:"4px",top:0,width:"6px",height:"12px",border:`solid ${o.colors.primary.contrastText}`,borderWidth:"0 3px 3px 0",transform:"rotate(45deg)"}},"&:disabled + span":{backgroundColor:o.colors.action.disabledBackground,cursor:"not-allowed",border:`1px solid ${m(o.colors.action.disabledBackground)}`,"&:hover":{backgroundColor:o.colors.action.disabledBackground},"&:after":{borderColor:o.colors.action.disabledText}}}),inputIndeterminate:(0,n.css)({"&[aria-checked='mixed'] + span":{border:`1px solid ${m(o.colors.primary.main)}`,background:o.colors.primary.main,"&:hover":{background:o.colors.primary.shade},"&:after":{content:'""',position:"absolute",zIndex:2,left:"2px",right:"2px",top:"calc(50% - 1.5px)",height:"3px",border:`1.5px solid ${o.colors.primary.contrastText}`,backgroundColor:o.colors.primary.contrastText,width:"auto",transform:"none"}},"&:disabled[aria-checked='mixed'] + span":{backgroundColor:o.colors.action.disabledBackground,border:`1px solid ${m(o.colors.error.transparent)}`,"&:after":{borderColor:o.colors.action.disabledText}}}),checkboxWrapper:(0,n.css)({display:"flex",alignItems:"center",gridColumnStart:1,gridRowStart:1}),checkmark:(0,n.css)({position:"relative",zIndex:2,display:"inline-block",width:o.spacing(d),height:o.spacing(d),borderRadius:o.shape.radius.default,background:o.components.input.background,border:`1px solid ${m(o.components.input.borderColor)}`,"&:hover":{cursor:"pointer",borderColor:m(o.components.input.borderHover)}}),label:(0,n.cx)(f.label,(0,n.css)({gridColumnStart:2,gridRowStart:1,position:"relative",zIndex:2,cursor:"pointer",maxWidth:"fit-content",lineHeight:o.typography.bodySmall.lineHeight,marginBottom:0})),description:(0,n.cx)(f.description,(0,n.css)({gridColumnStart:2,gridRowStart:2,lineHeight:o.typography.bodySmall.lineHeight,marginTop:0}))}};a.displayName="Checkbox"},88575:(k,R,e)=>{"use strict";e.d(R,{D:()=>c});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(67892),g=e(72093),a=e(60029);const c=i.forwardRef(({label:f,description:d,horizontal:p,invalid:m,loading:v,disabled:l,required:y,error:u,children:D,className:E,validationMessageHorizontalOverflow:x,htmlFor:P,...b},M)=>{const O=(0,s.of)(h),I=P??(0,r.getChildId)(D),T=typeof f=="string"?(0,t.jsx)(a.J,{htmlFor:I,description:d,children:`${f}${y?" *":""}`}):f,C=o({invalid:m,disabled:l,loading:v});return(0,t.jsxs)("div",{className:(0,n.cx)(O.field,p&&O.fieldHorizontal,E),...b,children:[T,(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{ref:M,children:i.cloneElement(D,C)}),m&&u&&!p&&(0,t.jsx)("div",{className:(0,n.cx)(O.fieldValidationWrapper,{[O.validationMessageHorizontalOverflow]:!!x}),children:(0,t.jsx)(g.P,{children:u})})]}),m&&u&&p&&(0,t.jsx)("div",{className:(0,n.cx)(O.fieldValidationWrapper,O.fieldValidationWrapperHorizontal,{[O.validationMessageHorizontalOverflow]:!!x}),children:(0,t.jsx)(g.P,{children:u})})]})});c.displayName="Field";function o(f){for(const d in f)f[d]===void 0&&delete f[d];return f}const h=f=>({field:(0,n.css)({display:"flex",flexDirection:"column",marginBottom:f.spacing(2)}),fieldHorizontal:(0,n.css)({flexDirection:"row",justifyContent:"space-between",flexWrap:"wrap"}),fieldValidationWrapper:(0,n.css)({marginTop:f.spacing(.5)}),fieldValidationWrapperHorizontal:(0,n.css)({flex:"1 1 100%"}),validationMessageHorizontalOverflow:(0,n.css)({width:0,overflowX:"visible","& > *":{whiteSpace:"nowrap"}})})},95984:(k,R,e)=>{"use strict";e.d(R,{E:()=>n});var t=e(49785);const n=({name:i,control:s,children:r,...g})=>{const{fields:a,append:c,prepend:o,remove:h,swap:f,move:d,insert:p}=(0,t.jz)({control:s,name:i,...g});return r({fields:a,append:c,prepend:o,remove:h,swap:f,move:d,insert:p})}},84167:(k,R,e)=>{"use strict";e.d(R,{n:()=>r});var t=e(74848),n=e(32196),i=e(40845),s=e(17408);const r=({label:a,children:c,className:o,...h})=>{const f=(0,i.of)(g);return(0,t.jsxs)("fieldset",{className:(0,n.cx)(f.wrapper,o),...h,children:[a&&(0,t.jsx)(s.s,{children:a}),c]})},g=a=>({wrapper:(0,n.css)({marginBottom:a.spacing(4),"&:last-child":{marginBottom:0}})})},72093:(k,R,e)=>{"use strict";e.d(R,{P:()=>r});var t=e(74848),n=e(32196),i=e(40845),s=e(14578);const r=({children:a,horizontal:c,className:o})=>{const h=(0,i.of)(g),f=(0,n.cx)(c?h.horizontal:h.vertical,o);return(0,t.jsxs)("div",{role:"alert",className:f,children:[(0,t.jsx)(s.I,{className:h.fieldValidationMessageIcon,name:"exclamation-triangle"}),a]})},g=a=>{const c=`
      font-size: ${a.typography.size.sm};
      font-weight: ${a.typography.fontWeightMedium};
      padding: ${a.spacing(.5,1)};
      color: ${a.colors.error.contrastText};
      background: ${a.colors.error.main};
      border-radius: ${a.shape.radius.default};
      position: relative;
      display: inline-block;
      align-self: flex-start;

      a {
        color: ${a.colors.error.contrastText};
        text-decoration: underline;
      }

      a:hover {
        text-decoration: none;
      }
    `;return{vertical:(0,n.css)(c,{margin:a.spacing(.5,0,0,0),"&:before":{content:'""',position:"absolute",left:"9px",top:"-5px",width:0,height:0,borderWidth:"0 4px 5px 4px",borderColor:`transparent transparent ${a.colors.error.main} transparent`,borderStyle:"solid"}}),horizontal:(0,n.css)(c,{marginLeft:"10px","&:before":{content:'""',position:"absolute",left:"-5px",top:"9px",width:0,height:0,borderWidth:"4px 5px 4px 0",borderColor:"transparent #e02f44 transparent transparent",borderStyle:"solid"}}),fieldValidationMessageIcon:(0,n.css)({marginRight:a.spacing()})}}},51253:(k,R,e)=>{"use strict";e.d(R,{l:()=>r});var t=e(74848),n=e(32196),i=e(96540),s=e(49785);function r({defaultValues:g,onSubmit:a,validateOnMount:c=!1,validateFieldsOnMount:o,children:h,validateOn:f="onSubmit",maxWidth:d=600,...p}){const{handleSubmit:m,trigger:v,formState:l,...y}=(0,s.mN)({mode:f,defaultValues:g});return(0,i.useEffect)(()=>{c&&v(o)},[v,o,c]),(0,t.jsx)("form",{className:(0,n.css)({maxWidth:d!=="none"?d+"px":d,width:"100%"}),onSubmit:m(a),...p,children:h({errors:l.errors,formState:l,trigger:v,...y})})}},14186:(k,R,e)=>{"use strict";e.d(R,{I:()=>c});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(67892),g=e(72093),a=e(76892);const c=({children:h,label:f,tooltip:d,labelWidth:p="auto",invalid:m,loading:v,disabled:l,required:y,className:u,htmlFor:D,grow:E,shrink:x,error:P,transparent:b,interactive:M,...O})=>{const I=(0,s.$j)(),T=o(I,E,x),C=D??(0,r.getChildId)(h),S=typeof f=="string"?(0,t.jsx)(a.c,{interactive:M,width:p,tooltip:d,htmlFor:C,transparent:b,children:`${f}${y?" *":""}`}):f;return(0,t.jsxs)("div",{className:(0,n.cx)(T.container,u),...O,children:[S,(0,t.jsxs)("div",{className:T.childContainer,children:[(0,i.cloneElement)(h,{invalid:m,disabled:l,loading:v}),m&&P&&(0,t.jsx)("div",{className:(0,n.cx)(T.fieldValidationWrapper),children:(0,t.jsx)(g.P,{children:P})})]})]})};c.displayName="InlineField";const o=(h,f,d)=>({container:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"flex-start",textAlign:"left",position:"relative",flex:`${f?1:0} ${d?1:0} auto`,margin:`0 ${h.spacing(.5)} ${h.spacing(.5)} 0`}),childContainer:(0,n.css)({flex:`${f?1:0} ${d?1:0} auto`}),fieldValidationWrapper:(0,n.css)({marginTop:h.spacing(.5)})})},39268:(k,R,e)=>{"use strict";e.d(R,{C:()=>s});var t=e(74848),n=e(32196),i=e(40845);const s=({children:g,className:a,...c})=>{const o=(0,i.of)(r);return(0,t.jsx)("div",{className:(0,n.cx)(o.container,a),...c,children:g})},r=g=>({container:(0,n.css)({label:"InlineFieldRow",display:"flex",flexDirection:"row",flexWrap:"wrap",alignContent:"flex-start",rowGap:g.spacing(.5)})})},76892:(k,R,e)=>{"use strict";e.d(R,{c:()=>g});var t=e(74848),n=e(32196),i=e(40845),s=e(14578),r=e(56034);const g=({children:c,className:o,tooltip:h,width:f,transparent:d,interactive:p,as:m="label",...v})=>{const l=(0,i.of)(a,d,f);return(0,t.jsxs)(m,{className:(0,n.cx)(l.label,o),...v,children:[c,h&&(0,t.jsx)(r.m,{interactive:p,placement:"top",content:h,theme:"info",children:(0,t.jsx)(s.I,{tabIndex:0,name:"info-circle",size:"sm",className:l.icon})})]})},a=(c,o=!1,h)=>({label:(0,n.css)({display:"flex",alignItems:"center",justifyContent:"space-between",flexShrink:0,padding:c.spacing(0,1),fontWeight:c.typography.fontWeightMedium,fontSize:c.typography.size.sm,backgroundColor:o?"transparent":c.colors.background.secondary,height:c.spacing(c.components.height.md),lineHeight:c.spacing(c.components.height.md),marginRight:c.spacing(.5),borderRadius:c.shape.radius.default,border:"none",width:h?h!=="auto"?`${8*h}px`:h:"100%",color:c.colors.text.primary}),icon:(0,n.css)({color:c.colors.text.secondary,marginLeft:"10px",":hover":{color:c.colors.text.primary}})})},63056:(k,R,e)=>{"use strict";e.d(R,{e:()=>s});var t=e(74848),n=e(32196),i=e(40845);const s=({children:g,className:a,grow:c,...o})=>{const h=(0,i.of)(r,c);return(0,t.jsx)("div",{className:(0,n.cx)(h.container,a),...o,children:g})};s.displayName="InlineSegmentGroup";const r=(g,a)=>({container:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"flex-start",textAlign:"left",position:"relative",flex:`${a?1:0} 0 auto`,marginBottom:g.spacing(.5)})})},60029:(k,R,e)=>{"use strict";e.d(R,{J:()=>r,f:()=>g});var t=e(74848),n=e(32196),i=e(40845),s=e(14578);const r=({children:a,description:c,className:o,category:h,...f})=>{const d=(0,i.of)(g),p=h?.map((m,v)=>(0,t.jsxs)("span",{className:d.categories,children:[(0,t.jsx)("span",{children:m}),(0,t.jsx)(s.I,{name:"angle-right",className:d.chevron})]},`${m}/${v}`));return(0,t.jsx)("div",{className:(0,n.cx)(d.label,o),children:(0,t.jsxs)("label",{...f,children:[(0,t.jsxs)("div",{className:d.labelContent,children:[p,a]}),c&&(0,t.jsx)("span",{className:d.description,children:c})]})})},g=a=>({label:(0,n.css)({label:"Label",fontSize:a.typography.size.sm,fontWeight:a.typography.fontWeightMedium,lineHeight:1.25,marginBottom:a.spacing(.5),color:a.colors.text.primary,maxWidth:"480px"}),labelContent:(0,n.css)({display:"flex",alignItems:"center"}),description:(0,n.css)({label:"Label-description",color:a.colors.text.secondary,fontSize:a.typography.size.sm,fontWeight:a.typography.fontWeightRegular,marginTop:a.spacing(.25),display:"block"}),categories:(0,n.css)({label:"Label-categories",display:"inline-flex",alignItems:"center"}),chevron:(0,n.css)({margin:a.spacing(0,.25)})})},91634:(k,R,e)=>{"use strict";e.d(R,{O:()=>g,p:()=>a});var t=e(74848),n=e(46942),i=e.n(n),s=e(96540),r=e(29734),g=(c=>(c.Invalid="invalid",c.Valid="valid",c))(g||{});class a extends s.PureComponent{constructor(){super(...arguments),this.state={error:null},this.validatorAsync=o=>h=>{const f=(0,r.tf)(h.target.value,o);this.setState(d=>({...d,error:f?f[0]:null}))},this.populateEventPropsWithStatus=(o,h)=>{const f={...o};return h&&Object.keys(r.Pw).forEach(d=>{((0,r.K)(d,h)||o[d])&&(f[d]=async p=>{p.persist(),(0,r.K)(d,h)&&await this.validatorAsync(h[d]).apply(this,[p]),o[d]&&o[d].apply(null,[p,this.status])})}),f}}static{this.defaultProps={className:""}}get status(){return this.state.error?"invalid":"valid"}get isInvalid(){return this.status==="invalid"}render(){const{validationEvents:o,className:h,hideErrorMessage:f,inputRef:d,...p}=this.props,{error:m}=this.state,v=i()("gf-form-input",{invalid:this.isInvalid},h),l=this.populateEventPropsWithStatus(p,o);return(0,t.jsxs)("div",{style:{flexGrow:1},children:[(0,t.jsx)("input",{...l,ref:d,className:v}),m&&!f&&(0,t.jsx)("span",{children:m})]})}}},24169:(k,R,e)=>{"use strict";e.d(R,{A:()=>r,s:()=>s});var t=e(74848),n=e(28581),i=e(14578);const s=g=>{const a=g.selectProps.menuIsOpen;return(0,t.jsx)(n.c.IndicatorsContainer,{...g,children:(0,t.jsx)(i.I,{name:a?"angle-up":"angle-down",style:{marginTop:"7px"}})})},r=s},11206:(k,R,e)=>{"use strict";e.d(R,{A:()=>s,l:()=>i});var t=e(74848),n=e(28581);const i=r=>{const{children:g}=r;return(0,t.jsx)(n.c.NoOptionsMessage,{...r,children:(0,t.jsx)("div",{className:"gf-form-select-box__desc-option",children:(0,t.jsx)("div",{className:"gf-form-select-box__desc-option__body",children:g})})})},s=i},22209:(k,R,e)=>{"use strict";e.d(R,{DW:()=>T,l6:()=>I});var t=e(74848),n=e(46942),i=e.n(n),s=e(96540),r=e(28581),g=e(46005),a=e(8539),c=e(66963),o=e(60578),h=e(40276),f=e(62235),d=e(23731),p=e(56034),m=e(24169),v=e(11206),l=e(14578);const y=A=>{const{children:L,isSelected:N,data:F}=A;return(0,t.jsx)(r.c.Option,{...A,children:(0,t.jsxs)("div",{className:"gf-form-select-box__desc-option",children:[F.imgUrl&&(0,t.jsx)("img",{className:"gf-form-select-box__desc-option__img",src:F.imgUrl,alt:""}),(0,t.jsxs)("div",{className:"gf-form-select-box__desc-option__body",children:[(0,t.jsx)("div",{children:L}),F.description&&(0,t.jsx)("div",{className:"gf-form-select-box__desc-option__desc",children:F.description})]}),N&&(0,t.jsx)(l.I,{name:"check","aria-hidden":"true"})]})})},u=null;var D=e(32196),E=e(3911),x=e(40845);const P=(0,E.N)(A=>({header:(0,D.css)({display:"flex",alignItems:"center",justifyContent:"flex-start",justifyItems:"center",cursor:"pointer",padding:"7px 10px",width:"100%",borderBottom:`1px solid ${A.colors.background.secondary}`,"&:hover":{color:A.colors.text.maxContrast}}),label:(0,D.css)({flexGrow:1}),icon:(0,D.css)({paddingRight:"2px"})}));class b extends s.PureComponent{constructor(){super(...arguments),this.state={expanded:!1},this.onToggleChildren=()=>{this.setState(L=>({expanded:!L.expanded}))}}componentDidMount(){if(this.props.data.expanded)this.setState({expanded:!0});else if(this.props.selectProps&&this.props.selectProps.value){const{value:L}=this.props.selectProps.value;L&&this.props.options.some(N=>N.value===L)&&this.setState({expanded:!0})}}componentDidUpdate(L){L.selectProps.inputValue!==""&&this.setState({expanded:!0})}render(){const{children:L,label:N,theme:F}=this.props,{expanded:w}=this.state,B=P(F);return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:B.header,onClick:this.onToggleChildren,role:"presentation",children:[(0,t.jsx)("span",{className:B.label,children:N}),(0,t.jsx)(l.I,{className:B.icon,name:w?"angle-up":"angle-down"})]}),w&&L]})}}const M=(0,x.cV)(b),O=A=>(0,t.jsx)(r.c.MenuList,{...A,children:(0,t.jsx)(h.E,{autoHide:!1,autoHeightMax:"inherit",children:A.children})});class I extends s.PureComponent{static{this.contextType=o.D}static{this.defaultProps={className:"",isDisabled:!1,isSearchable:!0,isClearable:!1,isMulti:!1,openMenuOnFocus:!1,autoFocus:!1,isLoading:!1,backspaceRemovesValue:!0,maxMenuHeight:300,tabSelectsValue:!0,allowCustomValue:!1,components:{Option:y,SingleValue:f.K,IndicatorsContainer:m.A,MenuList:O,Group:M}}}render(){const{defaultValue:L,getOptionLabel:N,getOptionValue:F,onChange:w,options:B,placeholder:U,width:K,value:V,className:H,isDisabled:Y,isLoading:X,isSearchable:J,isClearable:q,backspaceRemovesValue:ae,isMulti:j,autoFocus:te,openMenuOnFocus:ne,onBlur:le,maxMenuHeight:z,noOptionsMessage:ee,isOpen:se,components:ie,tooltipContent:Z,tabSelectsValue:oe,onCloseMenu:ce,onOpenMenu:ye,allowCustomValue:re,formatCreateLabel:ue,"aria-label":De}=this.props;let ge="";K&&(ge="width-"+K);let Te=g.Ay;const Le={};re&&(Te=c.A,Le.formatCreateLabel=ue??(Ze=>Ze));const Ye=i()("gf-form-input","gf-form-input--form-dropdown",ge,H),je={...I.defaultProps.components,...ie};return(0,t.jsx)(C,{onCloseMenu:ce,onOpenMenu:ye,tooltipContent:Z,isOpen:se,children:(Ze,Ne)=>(0,t.jsx)(Te,{captureMenuScroll:!1,classNamePrefix:"gf-form-select-box",className:Ye,components:je,defaultValue:L,value:V,getOptionLabel:N,getOptionValue:F,menuShouldScrollIntoView:!1,isSearchable:J,onChange:w,options:B,placeholder:U||"Choose",styles:(0,d.A)(this.context),isDisabled:Y,isLoading:X,isClearable:q,autoFocus:te,onBlur:le,openMenuOnFocus:ne,maxMenuHeight:z,noOptionsMessage:ee,isMulti:j,backspaceRemovesValue:ae,menuIsOpen:se,onMenuOpen:Ze,onMenuClose:Ne,tabSelectsValue:oe,"aria-label":De,...Le})})}}class T extends s.PureComponent{static{this.contextType=o.D}static{this.defaultProps={className:"",components:{},loadingMessage:()=>"Loading...",isDisabled:!1,isClearable:!1,isMulti:!1,isSearchable:!0,backspaceRemovesValue:!0,autoFocus:!1,openMenuOnFocus:!1,maxMenuHeight:300}}render(){const{defaultValue:L,getOptionLabel:N,getOptionValue:F,onChange:w,placeholder:B,width:U,value:K,className:V,loadOptions:H,defaultOptions:Y,isLoading:X,loadingMessage:J,noOptionsMessage:q,isDisabled:ae,isSearchable:j,isClearable:te,backspaceRemovesValue:ne,autoFocus:le,onBlur:z,openMenuOnFocus:ee,maxMenuHeight:se,isMulti:ie,tooltipContent:Z,onCloseMenu:oe,onOpenMenu:ce,isOpen:ye}=this.props;let re="";U&&(re="width-"+U);const ue=i()("gf-form-input","gf-form-input--form-dropdown",re,V);return(0,t.jsx)(C,{onCloseMenu:oe,onOpenMenu:ce,tooltipContent:Z,isOpen:ye,children:(De,ge)=>(0,t.jsx)(a.A,{captureMenuScroll:!1,classNamePrefix:"gf-form-select-box",className:ue,components:{Option:y,SingleValue:f.K,IndicatorsContainer:m.A,NoOptionsMessage:v.A},defaultValue:L,value:K,getOptionLabel:N,getOptionValue:F,menuShouldScrollIntoView:!1,onChange:w,loadOptions:H,isLoading:X,defaultOptions:Y,placeholder:B||"Choose",styles:(0,d.A)(this.context),loadingMessage:J,noOptionsMessage:q,isDisabled:ae,isSearchable:j,isClearable:te,autoFocus:le,onBlur:z,openMenuOnFocus:ee,maxMenuHeight:se,isMulti:ie,backspaceRemovesValue:ne})})}}class C extends s.PureComponent{constructor(){super(...arguments),this.state={isOpenInternal:!1},this.onOpenMenu=()=>{const{onOpenMenu:L}=this.props;L&&L(),this.setState({isOpenInternal:!0})},this.onCloseMenu=()=>{const{onCloseMenu:L}=this.props;L&&L(),this.setState({isOpenInternal:!1})}}render(){const{children:L,isOpen:N,tooltipContent:F}=this.props,{isOpenInternal:w}=this.state;let B;return(w||N)&&(B=!1),F?(0,t.jsx)(p.m,{show:B,content:F,placement:"bottom",children:(0,t.jsx)("div",{children:L(this.onOpenMenu,this.onCloseMenu)})}):(0,t.jsx)("div",{children:L(this.onOpenMenu,this.onCloseMenu)})}}const S=null},74716:(k,R,e)=>{"use strict";e.d(R,{d:()=>h});var t=e(74848),n=e(32196),i=e(2543),s=e.n(i),r=e(96540),g=e(40845),a=e(14578),c=e(56034);class o extends r.PureComponent{constructor(){super(...arguments),this.state={id:(0,i.uniqueId)()},this.internalOnChange=p=>{p.stopPropagation(),this.props.onChange(p)}}render(){const{labelClass:p="",switchClass:m="",label:v,checked:l,disabled:y,transparent:u,className:D,theme:E,tooltip:x,tooltipPlacement:P}=this.props,b=f(E),M=this.state.id,O=`gf-form-label ${p} ${u?"gf-form-label--transparent":""} pointer`,I=(0,n.cx)(b.switch,m,{[b.switchTransparent]:u});return(0,t.jsx)("div",{className:b.container,children:(0,t.jsxs)("label",{htmlFor:M,className:(0,n.cx)("gf-form",b.labelContainer,D),children:[v&&(0,t.jsxs)("div",{className:O,children:[v,x&&(0,t.jsx)(c.m,{placement:P||"auto",content:x,theme:"info",children:(0,t.jsx)(a.I,{name:"info-circle",size:"sm",style:{marginLeft:"10px"}})})]}),(0,t.jsxs)("div",{className:I,children:[(0,t.jsx)("input",{disabled:y,id:M,type:"checkbox",checked:l,onChange:this.internalOnChange}),(0,t.jsx)("span",{className:b.slider})]})]})})}}const h=(0,g.cV)(o),f=d=>{const p=(0,n.css)({background:d.v1.palette.gray1,borderRadius:d.shape.radius.pill,height:"16px",width:"32px",display:"block",position:"relative","&::before":{position:"absolute",content:"''",height:"12px",width:"12px",left:"2px",top:"2px",background:d.components.input.background,transition:"0.4s",borderRadius:d.shape.radius.circle,boxShadow:d.shadows.z1}});return{container:(0,n.css)({display:"flex",flexShrink:0}),labelContainer:(0,n.css)({display:"flex",cursor:"pointer",marginRight:d.spacing(.5)}),switch:(0,n.css)({display:"flex",position:"relative",width:"56px",height:d.spacing(4),background:d.components.input.background,border:`1px solid ${d.components.input.borderColor}`,borderRadius:d.shape.radius.default,alignItems:"center",justifyContent:"center",input:{opacity:0,width:0,height:0},[`input:checked + .${p}`]:{background:d.colors.primary.main},[`input:checked + .${p}::before`]:{transform:"translateX(16px)"}}),switchTransparent:(0,n.css)({background:"transparent",border:0,width:"40px"}),slider:p}}},17408:(k,R,e)=>{"use strict";e.d(R,{s:()=>r});var t=e(74848),n=e(32196),i=e(40845);const s=g=>({legend:(0,n.css)({fontSize:g.typography.h3.fontSize,fontWeight:g.typography.fontWeightRegular,margin:g.spacing(0,0,2,0)})}),r=({children:g,className:a,...c})=>{const o=(0,i.of)(s);return(0,t.jsx)("legend",{className:(0,n.cx)(o.legend,a),...c,children:g})}},94354:(k,R,e)=>{"use strict";e.d(R,{z:()=>m});var t=e(74848),n=e(32196),i=e(2543),s=e(96540),r=e(8887),g=e(40845),a=e(14578),c=e(13544),o=e(16797),h=e(56034),f=e(87266);const d=s.forwardRef(({children:l,active:y=!1,disabled:u=!1,size:D="md",onChange:E,onClick:x,id:P,name:b=void 0,description:M,fullWidth:O,"aria-label":I},T)=>{const C=(0,g.of)(p,D,O),S=(0,t.jsx)("input",{type:"radio",className:C.radio,onChange:E,onClick:x,disabled:u,id:P,checked:y,name:b,"aria-label":I,ref:T});return M?(0,t.jsxs)("div",{className:C.radioOption,"data-testid":c.Tp.components.RadioButton.container,children:[(0,t.jsx)(h.m,{content:M,placement:"bottom",children:S}),(0,t.jsx)("label",{className:C.radioLabel,htmlFor:P,title:M||I,children:l})]}):(0,t.jsxs)("div",{className:C.radioOption,"data-testid":c.Tp.components.RadioButton.container,children:[S,(0,t.jsx)("label",{className:C.radioLabel,htmlFor:P,title:M||I,children:l})]})});d.displayName="RadioButton";const p=(l,y,u)=>{const{fontSize:D,height:E,padding:x}=(0,f.SM)(y,l),P=l.colors.text.secondary,b=l.colors.text.primary,M=E*l.spacing.gridSize-4-2;return{radioOption:(0,n.css)({display:"flex",justifyContent:"space-between",position:"relative",flex:u?"1 0 0":"none",textAlign:"center"}),radio:(0,n.css)({position:"absolute",opacity:0,zIndex:2,width:"100% !important",height:"100%",cursor:"pointer","&:checked + label":{color:l.colors.text.primary,fontWeight:l.typography.fontWeightMedium,background:l.colors.action.selected,zIndex:1},"&:focus + label, &:focus-visible + label":(0,o.getFocusStyles)(l),"&:focus:not(:focus-visible) + label":(0,o.getMouseFocusStyles)(l),"&:disabled + label":{color:l.colors.text.disabled,cursor:"not-allowed"}}),radioLabel:(0,n.css)({display:"flex",alignItems:"center",justifyContent:"center",fontSize:D,height:`${M}px`,lineHeight:`${M}px`,color:P,padding:l.spacing(0,x),borderRadius:l.shape.radius.default,background:l.colors.background.primary,cursor:"pointer",userSelect:"none",whiteSpace:"nowrap",flexGrow:1,"&:hover":{color:b}})}};function m({options:l,value:y,onChange:u,onClick:D,disabled:E,disabledOptions:x,size:P="md",id:b,className:M,fullWidth:O=!1,autoFocus:I=!1,"aria-label":T,invalid:C=!1}){const S=(0,s.useCallback)(B=>()=>{u&&u(B.value)},[u]),A=(0,s.useCallback)(B=>()=>{D&&D(B.value)},[D]),L=b??(0,i.uniqueId)("radiogroup-"),N=(0,s.useRef)(L),F=(0,g.of)(v),w=(0,s.useRef)(null);return(0,s.useEffect)(()=>{I&&w.current&&w.current.focus()},[I]),(0,t.jsx)("div",{role:"radiogroup","aria-label":T,className:(0,n.cx)(F.radioGroup,O&&F.fullWidth,C&&F.invalid,M),children:l.map((B,U)=>{const K=x&&B.value&&x.includes(B.value),V=B.icon?(0,r.Uo)(B.icon):void 0,H=!!(B.imgUrl||B.label||B.component);return(0,t.jsxs)(d,{size:P,disabled:K||E,active:y===B.value,"aria-label":B.ariaLabel,onChange:S(B),onClick:A(B),id:`option-${B.value}-${L}`,name:N.current,description:B.description,fullWidth:O,ref:y===B.value?w:void 0,children:[V&&(0,t.jsx)(a.I,{name:V,className:(0,n.cx)(H&&F.icon)}),B.imgUrl&&(0,t.jsx)("img",{src:B.imgUrl,alt:B.label,className:F.img}),B.label," ",B.component?(0,t.jsx)(B.component,{}):null]},`o.label-${U}`)})})}m.displayName="RadioButtonGroup";const v=l=>({radioGroup:(0,n.css)({display:"inline-flex",flexDirection:"row",flexWrap:"nowrap",border:`1px solid ${l.components.input.borderColor}`,borderRadius:l.shape.radius.default,padding:"2px"}),fullWidth:(0,n.css)({display:"flex"}),icon:(0,n.css)({marginRight:"6px"}),img:(0,n.css)({width:l.spacing(2),height:l.spacing(2),marginRight:l.spacing(1)}),invalid:(0,n.css)({border:`1px solid ${l.colors.error.border}`})})},79569:(k,R,e)=>{"use strict";e.d(R,{J:()=>s});var t=e(74848),n=e(32196),i=e(40845);const s=({id:g,name:a,label:c,checked:o,value:h,disabled:f,description:d,onChange:p,...m})=>{const v=(0,i.of)(r);return(0,t.jsxs)("label",{title:d,className:v.label,children:[(0,t.jsx)("input",{...m,id:g,name:a,type:"radio",checked:o,value:h,disabled:f,className:v.input,onChange:()=>p&&p(g)}),(0,t.jsxs)("div",{children:[c,d&&(0,t.jsx)("div",{className:v.description,children:d})]})]})},r=g=>({input:(0,n.css)({position:"relative",appearance:"none",outline:"none",backgroundColor:g.colors.background.canvas,width:`${g.spacing(2)} !important`,height:g.spacing(2),border:`1px solid ${g.colors.border.medium}`,borderRadius:g.shape.radius.circle,margin:"3px 0",":checked":{backgroundColor:g.v1.palette.white,border:`5px solid ${g.colors.primary.main}`},":disabled":{backgroundColor:`${g.colors.action.disabledBackground} !important`,borderColor:g.colors.border.weak},":disabled:checked":{border:`1px solid ${g.colors.border.weak}`},":disabled:checked::after":{content:'""',width:"6px",height:"6px",backgroundColor:g.colors.text.disabled,borderRadius:g.shape.radius.circle,display:"inline-block",position:"absolute",top:"4px",left:"4px"},":focus":{outline:"none !important",boxShadow:`0 0 0 1px ${g.colors.background.canvas}, 0 0 0 3px ${g.colors.primary.main}`}}),label:(0,n.css)({fontSize:g.typography.fontSize,lineHeight:"22px",display:"grid",gridTemplateColumns:`${g.spacing(2)} auto`,gap:g.spacing(1)}),description:(0,n.css)({fontSize:g.typography.size.sm,color:g.colors.text.secondary})})},83186:(k,R,e)=>{"use strict";e.d(R,{a:()=>a});var t=e(74848),n=e(32196),i=e(2543),s=e.n(i),r=e(40845),g=e(79569);function a({name:o,id:h,options:f,value:d,onChange:p,className:m,disabled:v,disabledOptions:l=[]}){const y=(0,r.of)(c),u=h??(0,i.uniqueId)("radiogroup-list-");return(0,t.jsx)("div",{id:h,className:(0,n.cx)(y.container,m),role:"radiogroup",children:f.map((D,E)=>{const x=`${u}-${E}`,P=d&&d===D.value,b=v||l.some(O=>O===D.value),M=()=>p&&D.value&&p(D.value);return(0,t.jsx)(g.J,{id:x,name:o,label:D.label,description:D.description,checked:P,value:D.value,disabled:b,onChange:M},E)})})}const c=o=>({container:(0,n.css)({display:"grid",gap:o.spacing(1)})})},87266:(k,R,e)=>{"use strict";e.d(R,{SM:()=>c,Xb:()=>s,g$:()=>r,gm:()=>i,lH:()=>g});var t=e(32196),n=e(16797);const i=o=>(0,t.css)({"&:focus":(0,n.getFocusStyles)(o)}),s=(o,h=!1)=>{const f=h?o.colors.error.border:o.components.input.borderColor,d=h?o.colors.error.shade:o.components.input.borderHover,p=o.components.input.background,m=o.components.input.text,v=o.isDark?"#2e2f35":"#bab4ca";return(0,t.cx)(r(o),(0,t.css)({background:p,lineHeight:o.typography.body.lineHeight,fontSize:o.typography.size.md,color:m,border:`1px solid ${f}`,"&:-webkit-autofill, &:-webkit-autofill:hover":{boxShadow:`inset 0 0 0 1px rgba(255, 255, 255, 0), inset 0 0 0 100px ${p}!important`,WebkitTextFillColor:`${m} !important`,borderColor:v},"&:-webkit-autofill:focus":{boxShadow:`0 0 0 2px ${o.colors.background.primary}, 0 0 0px 4px ${o.colors.primary.main}, inset 0 0 0 1px rgba(255, 255, 255, 0), inset 0 0 0 100px ${p}!important`,WebkitTextFillColor:`${m} !important`},"&:hover":{borderColor:d},"&:focus":{outline:"none"},"&:disabled":{backgroundColor:o.colors.action.disabledBackground,color:o.colors.action.disabledText,border:`1px solid ${o.colors.action.disabledBackground}`,"&:hover":{borderColor:f}},"&::placeholder":{color:o.colors.text.disabled,opacity:1}}))},r=o=>(0,t.css)({padding:o.spacing(0,1,0,1)}),g=()=>({sm:(0,t.css)({width:a("sm")}),md:(0,t.css)({width:a("md")}),lg:(0,t.css)({width:a("lg")}),auto:(0,t.css)({width:a("auto")})}),a=o=>{switch(o){case"sm":return"200px";case"md":return"320px";case"lg":return"580px";case"auto":default:return"auto"}};function c(o,h){switch(o){case"sm":return{padding:1,fontSize:h.typography.size.sm,height:h.components.height.sm};case"lg":return{padding:3,fontSize:h.typography.size.lg,height:h.components.height.lg};case"md":default:return{padding:2,fontSize:h.typography.size.md,height:h.components.height.md}}}},95164:(k,R,e)=>{"use strict";e.d(R,{_:()=>l});var t=e(74848),n=e(34796),i=e.n(n),s=e(96540),r=e(83195),g=e(58649),a=e(50082),c=e(52622),o=e(29413),h=e(55852),f=e(24293),d=e(47737);const p={mode:a.O.Absolute,steps:[{value:-1/0,color:"green"},{value:80,color:"red"}]};function m(y,u,D,E){const x=D!=null,P=E===c.wV.Vertical?u:y,b=Math.min(P*.15/1.5,20),M=b*1.5,O=x?u-M:u,I=Math.min(O,y);return{showLabel:x,gaugeHeight:I,titleFontSize:b}}function v(y,u,D,E){if(u.color?.mode!==f.Y.Thresholds)return[{value:u.min??g.tw,color:D.color??f.F}];const x=u.thresholds??p,P=x.mode===a.O.Percentage,b=x.steps;let M=u.min??g.tw,O=u.max??g.d1;P&&(M=0,O=100);const I=(0,d.yQ)(M,b),T=(0,d.yQ)(O,b),C=[{value:+M.toFixed(y),color:E.visualization.getColorByName(I.color)}];let S=!0;for(let A=0;A<b.length;A++){const L=b[A];if(S){I===L&&(S=!1);continue}const N=b[A-1];if(C.push({value:L.value,color:E.visualization.getColorByName(N.color)}),L===T)break}return C.push({value:+O.toFixed(y),color:E.visualization.getColorByName(T.color)}),C}class l extends s.PureComponent{constructor(){super(...arguments),this.canvasElement=null,this.renderVisualization=()=>{const{width:u,value:D,height:E,onClick:x,text:P,theme:b,orientation:M}=this.props,O=m(u,E,D.title,M),I=M===c.wV.Vertical?`${O.gaugeHeight}px`:"100%",T=(0,t.jsx)("div",{style:{height:`${O.gaugeHeight}px`,width:I},ref:C=>this.canvasElement=C});return(0,t.jsxs)(t.Fragment,{children:[x?(0,t.jsx)("button",{className:(0,h.my)(b),type:"button",onClick:x,children:T}):T,O.showLabel&&(0,t.jsx)("div",{style:{textAlign:"center",fontSize:P?.titleSize??O.titleFontSize,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",position:"relative",width:I,top:"-4px",cursor:"default"},children:D.title})]})}}static{this.defaultProps={showThresholdMarkers:!0,showThresholdLabels:!1,field:{min:0,max:100,thresholds:p}}}componentDidMount(){this.draw()}componentDidUpdate(){this.draw()}draw(){const{field:u,showThresholdLabels:D,showThresholdMarkers:E,width:x,height:P,theme:b,value:M,orientation:O}=this.props,I=m(x,P,M.title),T=O===c.wV.Vertical?I.gaugeHeight:x,C=Math.min(T,I.gaugeHeight),S=b.colors.background.secondary,A=D?1.5:1,L=Math.min(C/5.5,40)/A,N=L/5,F=(0,r.cN)(M),B=Math.min(T,C*1.3)*.9-((L+(E?N:0)+(D?10:0))*2+10),U=this.props.text?.valueSize??(0,o.Vr)(F,B,C,1,L*1.7),K=Math.max(U/2.5,12);let V=u.min??g.tw,H=u.max??g.d1,Y=M.numeric;u.thresholds?.mode===a.O.Percentage&&(V=0,H=100,M.percent===void 0?Y=(Y-V)/(H-V)*100:Y=M.percent*100);const X=u.decimals===void 0?2:u.decimals;E&&(V=+V.toFixed(X),H=+H.toFixed(X));const J={series:{gauges:{gauge:{min:V,max:H,neutralValue:u.custom?.neutral,background:{color:S},border:{color:null},shadow:{show:!1},width:L},frame:{show:!1},label:{show:!1},layout:{margin:0,thresholdWidth:0,vMargin:0},cell:{border:{width:0}},threshold:{values:v(X,u,M,b),label:{show:D,margin:N+1,font:{size:K}},show:E,width:N},value:{color:M.color,formatter:()=>F,font:{size:U,family:b.typography.fontFamily}},show:!0}}},q={data:[[0,Y]],label:M.title};try{this.canvasElement&&i().plot(this.canvasElement,[q],J)}catch(ae){console.error("Gauge rendering error",ae,J,M)}}render(){return(0,t.jsx)("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",overflow:"hidden"},className:this.props.className,children:this.renderVisualization()})}}},14578:(k,R,e)=>{"use strict";e.d(R,{I:()=>h});var t=e(74848),n=e(32196),i=e(96540),s=e(8867),r=e(8887),g=e(40845),a=e(87019),c=e(78318);const o=f=>({icon:(0,n.css)({display:"inline-block",fill:"currentColor",flexShrink:0,label:"Icon",lineHeight:0,verticalAlign:"middle"}),orange:(0,n.css)({fill:f.v1.palette.orange}),spin:(0,n.css)({[f.transitions.handleMotion("no-preference","reduce")]:{animation:`${a.t} 2s infinite linear`}})}),h=i.forwardRef(({size:f="md",type:d="default",name:p,className:m,style:v,title:l="",...y},u)=>{const D=(0,g.of)(o);(0,r.n6)(p)||console.warn("Icon component passed an invalid icon name",p);const E=p==="fa fa-spinner"?"spinner":p,x=(0,c.Wj)(),P=(0,c.cs)(f),b=P,M=p.startsWith("gf-bar-align")?16:p.startsWith("gf-interp")?30:P,O=(0,c.Xi)(E,d),I=`${x}${O}/${E}.svg`,T=(0,n.cx)(D.icon,m,d==="mono"?{[D.orange]:p==="favorite"}:"",{[D.spin]:E==="spinner"});return(0,t.jsx)(s.default,{"aria-hidden":y.tabIndex===void 0&&!l&&!y["aria-label"]&&!y["aria-labelledby"]&&!y["aria-describedby"],innerRef:u,src:I,width:M,height:b,title:l,className:T,style:v,...y})});h.displayName="Icon"},78318:(k,R,e)=>{"use strict";e.d(R,{Wj:()=>r,Xi:()=>n,cs:()=>i});const t=["grafana","favorite","heart-break","heart","panel-add","library-panel","circle-mono"];function n(g,a){return g?.startsWith("gf-")?"custom":t.includes(g)?"mono":a==="default"?"unicons":a==="solid"?"solid":"mono"}function i(g){switch(g){case"xs":return 12;case"sm":return 14;case"md":return 16;case"lg":return 18;case"xl":return 24;case"xxl":return 36;case"xxxl":return 48}}let s;function r(){if(s)return s;const g=typeof window<"u"&&window.__grafana_public_path__;return g?s=g+"img/icons/":s="public/img/icons/",s}},29158:(k,R,e)=>{"use strict";e.d(R,{K:()=>f});var t=e(74848),n=e(32196),i=e(96540),s=e(95344),r=e(23596),g=e(40845),a=e(16797),c=e(55852),o=e(78318),h=e(56034);const f=i.forwardRef((p,m)=>{const{size:v="md",variant:l="secondary"}=p;let y;v==="xxl"||v==="xxxl"?((0,s.l)("IconButton",'size="xxl" and size="xxxl"','size="xl"'),y="xl"):y=v;const u=(0,g.of)(d,y,l);let D,E;if("tooltip"in p){const{tooltip:x}=p;D=typeof x=="string"?x:void 0}else if("ariaLabel"in p||"aria-label"in p){const{ariaLabel:x,["aria-label"]:P}=p;D=P||x,E=m}if("tooltip"in p){const{name:x,iconType:P,className:b,tooltip:M,tooltipPlacement:O,...I}=p;return(0,t.jsx)(h.m,{ref:m,content:M,placement:O,children:(0,t.jsx)("button",{...I,ref:E,"aria-label":D,className:(0,n.cx)(u.button,b),type:"button",children:(0,t.jsx)(c.Jt,{icon:x,size:y,className:u.icon,iconType:P})})})}else{const{name:x,iconType:P,className:b,...M}=p;return(0,t.jsx)("button",{...M,ref:E,"aria-label":D,className:(0,n.cx)(u.button,b),type:"button",children:(0,t.jsx)(c.Jt,{icon:x,size:y,className:u.icon,iconType:P})})}});f.displayName="IconButton";const d=(p,m,v)=>{const l=(0,o.cs)(m)+p.spacing.gridSize;let y=p.colors.text.primary;return v==="primary"?y=p.colors.primary.text:v==="destructive"&&(y=p.colors.error.text),{button:(0,n.css)({zIndex:0,position:"relative",margin:`0 ${p.spacing.x0_5} 0 0`,boxShadow:"none",border:"none",display:"inline-flex",background:"transparent",justifyContent:"center",alignItems:"center",padding:0,color:y,"&[disabled], &:disabled":{cursor:"not-allowed",color:p.colors.action.disabledText,opacity:.65},"&:before":{zIndex:-1,position:"absolute",opacity:0,width:`${l}px`,height:`${l}px`,borderRadius:p.shape.radius.default,content:'""',[p.transitions.handleMotion("no-preference","reduce")]:{transitionDuration:"0.2s",transitionTimingFunction:"cubic-bezier(0.4, 0, 0.2, 1)",transitionProperty:"opacity"}},"&:focus, &:focus-visible":(0,a.getFocusStyles)(p),"&:focus:not(:focus-visible)":(0,a.getMouseFocusStyles)(p),"&:hover":{"&:before":{backgroundColor:v==="secondary"?p.colors.action.hover:r.MV.alpha(y,.12),opacity:1}}}),icon:(0,n.css)({verticalAlign:"baseline"})}}},86460:(k,R,e)=>{"use strict";e.d(R,{e:()=>a});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(29678),g=e(37166);const a=(0,i.memo)((0,i.forwardRef)(({title:o,featureState:h,...f},d)=>{const p=(0,s.of)(c),m=h?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:p.badge,children:(0,t.jsx)(r.y,{featureState:h})}),(0,t.jsx)("h3",{children:o})]}):(0,t.jsx)("h3",{children:o});return(0,t.jsx)(g.w,{branded:!0,title:m,urlTitle:"Read documentation",ref:d,...f})}));a.displayName="FeatureInfoBox";const c=o=>({badge:(0,n.css)({marginBottom:o.spacing(1)})})},37166:(k,R,e)=>{"use strict";e.d(R,{w:()=>a});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(42418),g=e(14578);const a=i.memo(i.forwardRef(({title:o,className:h,children:f,branded:d,url:p,urlTitle:m,onDismiss:v,severity:l="info",...y},u)=>{const D=(0,s.of)(c);return(0,t.jsxs)(r.F,{severity:l,className:h,...y,ref:u,title:o,children:[(0,t.jsx)("div",{children:f}),p&&(0,t.jsxs)("a",{href:p,className:(0,n.cx)("external-link",D.docsLink),target:"_blank",rel:"noreferrer",children:[(0,t.jsx)(g.I,{name:"book"})," ",m||"Read more"]})]})}));a.displayName="InfoBox";const c=o=>({docsLink:(0,n.css)({display:"inline-block",marginTop:o.spacing(2)})})},32982:(k,R,e)=>{"use strict";e.d(R,{r:()=>h});var t=e(74848),n=e(32196),i=e(34743),s=e(36376),r=e(7315),g=e(96540),a=e(40845),c=e(14578),o=e(17464);function h({referenceElement:p,children:m,suffixIcon:v,placement:l}){const y=(0,a.of)(f),u=(0,a.$j)(),D=[(0,i.cY)(8),(0,i.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,i.BN)()],{context:E,refs:x,floatingStyles:P}=(0,s.we)({open:!0,placement:l,middleware:D,whileElementsMounted:r.ll,strategy:"fixed"});(0,g.useLayoutEffect)(()=>{x.setReference(p)},[p,x]);const{styles:b}=(0,s.DL)(E,{initial:({side:M})=>({opacity:0,transform:d(M,u)}),duration:u.transitions.duration.shortest});return(0,t.jsx)(o.ZL,{children:(0,t.jsx)("div",{style:{display:"inline-block",...P},ref:x.setFloating,"aria-live":"polite",children:(0,t.jsxs)("span",{className:(0,n.cx)(y.root),style:b,children:[m&&(0,t.jsx)("span",{children:m}),v&&(0,t.jsx)(c.I,{name:v})]})})})}const f=p=>({root:(0,n.css)({...p.typography.bodySmall,willChange:"transform",background:p.components.tooltip.background,color:p.components.tooltip.text,padding:p.spacing(.5,1.5),borderRadius:p.shape.radius.pill,display:"inline-flex",gap:p.spacing(.5),alignItems:"center"})}),d=(p,m)=>{switch(p){case"top":return`translateY(${m.spacing(1)})`;case"bottom":return`translateY(-${m.spacing(1)})`;case"left":return`translateX(${m.spacing(1)})`;case"right":return`translateX(-${m.spacing(1)})`}}},51440:(k,R,e)=>{"use strict";e.d(R,{D:()=>r});var t=e(74848),n=e(96540),i=e(29413),s=e(10354);const r=n.forwardRef((a,c)=>{const{defaultValue:o="",minWidth:h=10,maxWidth:f,onCommitChange:d,onKeyDown:p,onBlur:m,value:v,...l}=a,[y,u]=n.useState(v??o),[D,E]=n.useState(h);return(0,n.useEffect)(()=>{v!==void 0&&u(v)},[v]),(0,n.useEffect)(()=>{E(g(y.toString(),h,f))},[y,h,f]),(0,t.jsx)(s.p,{...l,ref:c,value:y.toString(),onChange:x=>{u(x.currentTarget.value)},width:D,onBlur:x=>{m?m(x):d&&d(x)},onKeyDown:x=>{p?p(x):x.key==="Enter"&&d&&d(x)},"data-testid":"autosize-input"})});function g(a,c,o){if(!a)return c;const f=(0,i.kD)(a.toString(),14).width/8+3;return c&&f<c?c:o&&f>o?o:f}r.displayName="AutoSizeInput"},10354:(k,R,e)=>{"use strict";e.d(R,{n:()=>h,p:()=>o});var t=e(74848),n=e(32196),i=e(96540),s=e(71473),r=e(40845),g=e(3911),a=e(87266),c=e(62930);const o=(0,i.forwardRef)((f,d)=>{const{className:p,addonAfter:m,addonBefore:v,prefix:l,suffix:y,invalid:u,loading:D,width:E=0,...x}=f,[P,b]=(0,s.A)(),[M,O]=(0,s.A)(),I=(0,r.$j)(),T=h({theme:I,invalid:!!u,width:E});return(0,t.jsxs)("div",{className:(0,n.cx)(T.wrapper,p),"data-testid":"input-wrapper",children:[!!v&&(0,t.jsx)("div",{className:T.addon,children:v}),(0,t.jsxs)("div",{className:T.inputWrapper,children:[l&&(0,t.jsx)("div",{className:T.prefix,ref:P,children:l}),(0,t.jsx)("input",{ref:d,className:T.input,...x,style:{paddingLeft:l?b.width+12:void 0,paddingRight:y||D?O.width+12:void 0}}),(y||D)&&(0,t.jsxs)("div",{className:T.suffix,ref:M,children:[D&&(0,t.jsx)(c.y,{className:T.loadingIndicator,inline:!0}),y]})]}),!!m&&(0,t.jsx)("div",{className:T.addon,children:m})]})});o.displayName="Input";const h=(0,g.N)(({theme:f,invalid:d=!1,width:p})=>{const m="28px",v=(0,n.css)({position:"absolute",top:0,zIndex:1,display:"flex",alignItems:"center",justifyContent:"center",flexGrow:0,flexShrink:0,fontSize:f.typography.size.md,height:"100%",minWidth:m,color:f.colors.text.secondary});return{wrapper:(0,n.cx)((0,n.css)({label:"input-wrapper",display:"flex",width:p?f.spacing(p):"100%",height:f.spacing(f.components.height.md),borderRadius:f.shape.radius.default,"&:hover":{"> .prefix, .suffix, .input":{borderColor:d?f.colors.error.border:f.colors.primary.border},"input[type='number']":{appearance:"textfield"},"input[type='number']::-webkit-inner-spin-button, input[type='number']::-webkit-outer-spin-button":{WebkitAppearance:"inner-spin-button !important",opacity:1}}})),inputWrapper:(0,n.css)({label:"input-inputWrapper",position:"relative",flexGrow:1,zIndex:1,"&:not(:first-child):last-child":{"> input":{borderLeft:"none",borderTopLeftRadius:0,borderBottomLeftRadius:0}},"&:first-child:not(:last-child)":{"> input":{borderRight:"none",borderTopRightRadius:0,borderBottomRightRadius:0}},"&:not(:first-child):not(:last-child)":{"> input":{borderRight:"none",borderTopRightRadius:0,borderBottomRightRadius:0,borderTopLeftRadius:0,borderBottomLeftRadius:0}},input:{"&:not(:first-child)":{paddingLeft:m},"&:not(:last-child)":{paddingRight:m},"&[readonly]":{cursor:"default"}}}),input:(0,n.cx)((0,a.gm)(f),(0,a.Xb)(f,d),(0,n.css)({label:"input-input",position:"relative",zIndex:0,flexGrow:1,borderRadius:f.shape.radius.default,height:"100%",width:"100%"})),inputDisabled:(0,n.css)({backgroundColor:f.colors.action.disabledBackground,color:f.colors.action.disabledText,border:`1px solid ${f.colors.action.disabledBackground}`,"&:focus":{boxShadow:"none"}}),addon:(0,n.css)({label:"input-addon",display:"flex",justifyContent:"center",alignItems:"center",flexGrow:0,flexShrink:0,position:"relative","&:first-child":{borderTopRightRadius:0,borderBottomRightRadius:0,"> :last-child":{borderTopRightRadius:0,borderBottomRightRadius:0}},"&:last-child":{borderTopLeftRadius:0,borderBottomLeftRadius:0,"> :first-child":{borderTopLeftRadius:0,borderBottomLeftRadius:0}},"> *:focus":{zIndex:2}}),prefix:(0,n.cx)(v,(0,n.css)({label:"input-prefix",paddingLeft:f.spacing(1),paddingRight:f.spacing(.5),borderRight:"none",borderTopRightRadius:0,borderBottomRightRadius:0})),suffix:(0,n.cx)(v,(0,n.css)({label:"input-suffix",paddingLeft:f.spacing(1),paddingRight:f.spacing(1),marginBottom:"-2px",borderLeft:"none",borderTopLeftRadius:0,borderBottomLeftRadius:0,right:0})),loadingIndicator:(0,n.css)({"& + *":{marginLeft:f.spacing(.5)}})}})},16504:(k,R,e)=>{"use strict";e.d(R,{e:()=>n});var t=e(49785);const n=t.xI},48840:(k,R,e)=>{"use strict";e.d(R,{j:()=>u});var t=e(74848),n=e(32196),i=e(2543),s=e(96540),r=e(32885),g=e(39070),a=e(40845),c=e(14578),o=e(19384),h=e(56034),f=e(29158);const d=(0,n.css)({display:"flex",alignItems:"center",height:"100%"});function p({row:P,__rowID:b}){return(0,t.jsx)("div",{className:d,children:(0,t.jsx)(f.K,{tooltip:"toggle row expanded","aria-controls":b,name:P.isExpanded?"angle-down":"angle-right","aria-expanded":P.isExpanded,...P.getToggleRowExpandedProps(),size:"lg"})})}function m({isAllRowsExpanded:P,toggleAllRowsExpanded:b}){return(0,t.jsx)("div",{className:d,children:(0,t.jsx)(f.K,{"aria-label":P?"Collapse all rows":"Expand all rows",name:P?"table-collapse-all":"table-expand-all",onClick:()=>b(),size:"lg",tooltip:P?"Collapse all rows":"Expand all rows",variant:"secondary"})})}const v="__expander";function l(P,b=!1){return[{id:v,Cell:p,...b&&{Header:m},disableSortBy:!0,width:0},...P.map(M=>({id:M.id,accessor:M.id,Header:M.header||(()=>null),sortType:M.sortType||"alphanumeric",disableSortBy:!M.sortType,width:M.disableGrow?0:void 0,visible:M.visible,...M.cell&&{Cell:M.cell}}))]}const y=P=>{const b=P.colors.emphasize(P.colors.background.primary,.03);return{container:(0,n.css)({display:"flex",gap:P.spacing(2),flexDirection:"column",width:"100%",overflowX:"auto"}),cell:(0,n.css)({padding:P.spacing(1),minWidth:P.spacing(3)}),table:(0,n.css)({borderRadius:P.shape.radius.default,width:"100%"}),disableGrow:(0,n.css)({width:0}),header:(0,n.css)({borderBottom:`1px solid ${P.colors.border.weak}`,minWidth:P.spacing(3),"&, & > button":{position:"relative",whiteSpace:"nowrap",padding:P.spacing(1)},"& > button":{"&:after":{content:'"\\00a0"'},width:"100%",height:"100%",background:"none",border:"none",paddingRight:P.spacing(2.5),textAlign:"left",fontWeight:P.typography.fontWeightMedium}}),row:(0,n.css)({label:"row",borderBottom:`1px solid ${P.colors.border.weak}`,"&:hover":{backgroundColor:b},"&:last-child":{borderBottom:0}}),expandedRow:(0,n.css)({label:"expanded-row-content",borderBottom:"none"}),expandedContentCell:(0,n.css)({borderBottom:`1px solid ${P.colors.border.weak}`,position:"relative",padding:P.spacing(2,2,2,5),"&:before":{content:'""',position:"absolute",width:"1px",top:0,left:"16px",bottom:P.spacing(2),background:P.colors.border.medium}}),expandedContentRow:(0,n.css)({label:"expanded-row-content"}),sortableHeader:(0,n.css)({"&&":{padding:0}})}};function u({className:P,columns:b,data:M,getRowId:O,headerTooltips:I,pageSize:T=0,renderExpandedRow:C,showExpandAll:S=!1,fetchData:A,initialSortBy:L=[]}){const N=(0,a.of)(y),F=(0,s.useMemo)(()=>l(b,S),[b,S]),w=D(),B=(0,s.useCallback)(j=>`${w}-${j.id}`.replace(/\s/g,""),[w]),U=[r.useSortBy,r.useExpanded],K=M.length>T,V=T>0;V&&U.push(r.usePagination);const H=(0,r.useTable)({columns:F,data:M,autoResetExpanded:!1,autoResetSortBy:!1,disableMultiSort:!0,manualSortBy:!!A,getRowId:O,initialState:{hiddenColumns:[!C&&v,...F.filter(j=>!(!j.visible||j.visible(M))).map(j=>j.id).filter(g.zz)].filter(g.zz),sortBy:L}},...U),{getTableProps:Y,getTableBodyProps:X,headerGroups:J,prepareRow:q}=H,{sortBy:ae}=H.state;return(0,s.useEffect)(()=>{A&&A({sortBy:ae})},[ae,A]),(0,s.useEffect)(()=>{V&&H.setPageSize(T)},[V,T,H.setPageSize,H]),(0,t.jsxs)("div",{className:N.container,children:[(0,t.jsxs)("table",{...Y(),className:(0,n.cx)(N.table,P),children:[(0,t.jsx)("thead",{children:J.map(j=>{const{key:te,...ne}=j.getHeaderGroupProps();return(0,t.jsx)("tr",{...ne,children:j.headers.map(le=>{const{key:z,...ee}=le.getHeaderProps(),se=I?.[le.id];return(0,t.jsx)("th",{className:(0,n.cx)(N.header,{[N.disableGrow]:le.width===0,[N.sortableHeader]:le.canSort}),...ee,...le.isSorted&&{"aria-sort":le.isSortedDesc?"descending":"ascending"},children:(0,t.jsx)(x,{column:le,headerTooltip:se})},z)})},te)})}),(0,t.jsx)("tbody",{...X(),children:(V?H.page:H.rows).map(j=>{q(j);const{key:te,...ne}=j.getRowProps(),le=B(j),z=j.isExpanded;return(0,t.jsxs)(s.Fragment,{children:[(0,t.jsx)("tr",{...ne,className:(0,n.cx)(N.row,z&&N.expandedRow),children:j.cells.map(ee=>{const{key:se,...ie}=ee.getCellProps();return(0,t.jsx)("td",{className:N.cell,...ie,children:ee.render("Cell",{__rowID:le})},se)})}),z&&C&&(0,t.jsx)("tr",{...ne,id:le,className:N.expandedContentRow,children:(0,t.jsx)("td",{className:N.expandedContentCell,colSpan:j.cells.length,children:C(j.original)})})]},te)})})]}),V&&K&&(0,t.jsx)("span",{children:(0,t.jsx)(o.d,{currentPage:H.state.pageIndex+1,numberOfPages:H.pageOptions.length,onNavigate:j=>H.gotoPage(j-1)})})]})}const D=()=>(0,s.useMemo)(()=>(0,i.uniqueId)("InteractiveTable"),[]),E=P=>({sortIcon:(0,n.css)({position:"absolute",top:P.spacing(1)}),headerTooltipIcon:(0,n.css)({marginLeft:P.spacing(.5)})});function x({column:{canSort:P,render:b,isSorted:M,isSortedDesc:O,getSortByToggleProps:I},headerTooltip:T}){const C=(0,a.of)(E),{onClick:S}=I(),A=(0,t.jsxs)(t.Fragment,{children:[b("Header"),T&&(0,t.jsx)(h.m,{theme:"info-alt",content:T.content,placement:"top-end",children:(0,t.jsx)(c.I,{className:C.headerTooltipIcon,name:T.iconName||"info-circle","data-testid":"header-tooltip-icon"})}),M&&(0,t.jsx)("span",{"aria-hidden":"true",className:C.sortIcon,children:(0,t.jsx)(c.I,{name:O?"angle-down":"angle-up"})})]});return P?(0,t.jsx)("button",{type:"button",onClick:S,children:A}):A}},24022:(k,R,e)=>{"use strict";e.d(R,{B:()=>s});var t=e(74848),n=e(96540),i=e(44533);class s extends n.PureComponent{constructor(){super(...arguments),this.wrapperRef=(0,n.createRef)(),this.renderJson=()=>{const{json:g,config:a,open:c,onDidRender:o}=this.props,h=this.wrapperRef.current,f=new i.O(g,c,a);h.hasChildNodes()?h.replaceChild(f.render(),h.lastChild):h.appendChild(f.render()),o&&o(f.json)}}static{this.defaultProps={open:3,config:{animateOpen:!0}}}componentDidMount(){this.renderJson()}componentDidUpdate(){this.renderJson()}render(){const{className:g}=this.props;return(0,t.jsx)("div",{className:g,ref:this.wrapperRef})}}},44533:(k,R,e)=>{"use strict";e.d(R,{O:()=>y});var t=e(2543);function n(u){return u.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function i(u){return!!u&&typeof u==="object"}function s(u){if(u===void 0)return"";if(u===null||typeof u=="object"&&!u.constructor)return"Object";const E=/function ([^(]*)/.exec(u.constructor.toString());return E&&E.length>1?E[1]:""}function r(u){return u===null?"null":typeof u}function g(u,D){const E=r(u);return E==="null"||E==="undefined"?E:(E==="string"&&(D='"'+n(D)+'"'),E==="function"?u.toString().replace(/[\r\n]/g,"").replace(/\{.*\}/,"")+"{\u2026}":D)}let a="";function c(u){return i(u)?(a=s(u),Array.isArray(u)&&(a+="["+u.length+"]")):a=g(u,u.toString()),a}function o(u){return`json-formatter-${u}`}function h(u,D,E){const x=document.createElement(u);return D&&x.classList.add(o(D)),E!==void 0&&(E instanceof Node?x.appendChild(E):x.appendChild(document.createTextNode(String(E)))),x}const f=/(^\d{1,4}[\.|\\/|-]\d{1,2}[\.|\\/|-]\d{1,4})(\s*(?:0?[1-9]:[0-5]|1(?=[012])\d:[0-5])\d\s*[ap]m)?$/,d=/\d{2}:\d{2}:\d{2} GMT-\d{4}/,p=/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}Z/,m=10,v=typeof window<"u"&&window.requestAnimationFrame||(u=>(u(),0)),l={animateOpen:!0,animateClose:!0};class y{constructor(D,E=1,x=l,P){this.json=D,this.open=E,this.config=x,this.key=P,this._isOpen=null,this.element=null,this.skipChildren=!1}get isOpen(){return this._isOpen!==null?this._isOpen:this.open>0}set isOpen(D){this._isOpen=D}get isDate(){return this.type==="string"&&(f.test(this.json)||p.test(this.json)||d.test(this.json))}get isUrl(){return this.type==="string"&&this.json.indexOf("http")===0}get isArray(){return Array.isArray(this.json)}get isObject(){return i(this.json)}get isEmptyObject(){return!this.keys.length&&!this.isArray}get isEmpty(){return this.isEmptyObject||this.keys&&!this.keys.length&&this.isArray}get hasKey(){return typeof this.key<"u"}get constructorName(){return s(this.json)}get type(){return r(this.json)}get keys(){return this.isObject?Object.keys(this.json).map(D=>D||'""'):[]}toggleOpen(){this.isOpen=!this.isOpen,this.element&&(this.isOpen?this.appendChildren(this.config.animateOpen):this.removeChildren(this.config.animateClose),this.element.classList.toggle(o("open")))}openAtDepth(D=1){D<0||(this.open=D,this.isOpen=D!==0,this.element&&(this.removeChildren(!1),D===0?this.element.classList.remove(o("open")):(this.appendChildren(this.config.animateOpen),this.element.classList.add(o("open")))))}isNumberArray(){return this.json.length>0&&this.json.length<4&&((0,t.isNumber)(this.json[0])||(0,t.isNumber)(this.json[1]))}renderArray(){const D=h("span");return D.appendChild(h("span","bracket","[")),this.isNumberArray()?(this.json.forEach((E,x)=>{x>0&&D.appendChild(h("span","array-comma",",")),D.appendChild(h("span","number",E))}),this.skipChildren=!0):D.appendChild(h("span","number",this.json.length)),D.appendChild(h("span","bracket","]")),D}render(D=!1){this.element=h("div","row");const E=h("a","toggler-link"),x=h("span","toggler");if(this.isObject&&E.appendChild(x),this.hasKey&&E.appendChild(h("span","key",`${this.key}:`)),this.isObject){const b=h("span","value"),M=h("span"),O=h("span","constructor-name",this.constructorName);if(M.appendChild(O),this.isArray){const I=this.renderArray();M.appendChild(I)}b.appendChild(M),E.appendChild(b)}else{const b=this.isUrl?h("a"):h("span");b.classList.add(o(this.type)),this.isDate&&b.classList.add(o("date")),this.isUrl&&(b.classList.add(o("url")),b.setAttribute("href",this.json));const M=g(this.json,this.json);b.appendChild(document.createTextNode(M)),E.appendChild(b)}const P=h("div","children");return this.isObject&&P.classList.add(o("object")),this.isArray&&P.classList.add(o("array")),this.isEmpty&&P.classList.add(o("empty")),this.config&&this.config.theme&&this.element.classList.add(o(this.config.theme)),this.isOpen&&this.element.classList.add(o("open")),D||this.element.appendChild(E),this.skipChildren?E.removeChild(x):this.element.appendChild(P),this.isObject&&this.isOpen&&this.appendChildren(),this.isObject&&E.addEventListener("click",this.toggleOpen.bind(this)),this.element}appendChildren(D=!1){const E=this.element&&this.element.querySelector(`div.${o("children")}`);if(!(!E||this.isEmpty))if(D){let x=0;const P=()=>{const b=this.keys[x],M=new y(this.json[b],this.open-1,this.config,b);E.appendChild(M.render()),x+=1,x<this.keys.length&&(x>m?P():v(P))};v(P)}else this.keys.forEach(x=>{const P=new y(this.json[x],this.open-1,this.config,x);E.appendChild(P.render())})}removeChildren(D=!1){const E=this.element&&this.element.querySelector(`div.${o("children")}`);if(D){let x=0;const P=()=>{E&&E.children.length&&(E.removeChild(E.children[0]),x+=1,x>m?P():v(P))};v(P)}else E&&(E.innerHTML="")}}},90613:(k,R,e)=>{"use strict";e.d(R,{a:()=>a});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(16795),g=e(55738);const a=(0,i.forwardRef)((f,d)=>{const{children:p,margin:m,marginX:v,marginY:l,marginTop:y,marginBottom:u,marginLeft:D,marginRight:E,padding:x,paddingX:P,paddingY:b,paddingTop:M,paddingBottom:O,paddingLeft:I,paddingRight:T,display:C,backgroundColor:S,grow:A,shrink:L,basis:N,flex:F,borderColor:w,borderStyle:B,borderRadius:U,direction:K,justifyContent:V,alignItems:H,boxShadow:Y,element:X,gap:J,width:q,minWidth:ae,maxWidth:j,height:te,minHeight:ne,maxHeight:le,...z}=f,ee=(0,s.of)(h,m,v,l,y,u,D,E,x,P,b,M,O,I,T,C,S,A,L,N,F,w,B,U,K,V,H,Y,J),se=(0,s.of)(g.E,q,ae,j,te,ne,le),ie=X??"div";return(0,t.jsx)(ie,{ref:d,className:(0,n.cx)(ee.root,se),...z,children:p})});a.displayName="Box";const c=(f,d)=>{switch(f){case"error":case"success":case"info":case"warning":return d.colors[f].borderTransparent;default:return f?d.colors.border[f]:void 0}},o=(f,d)=>{switch(f){case"error":case"success":case"info":case"warning":return d.colors[f].transparent;default:return f?d.colors.background[f]:void 0}},h=(f,d,p,m,v,l,y,u,D,E,x,P,b,M,O,I,T,C,S,A,L,N,F,w,B,U,K,V,H)=>({root:(0,n.css)([(0,r.Y)(f,d,Y=>({margin:f.spacing(Y)})),(0,r.Y)(f,p,Y=>({marginLeft:f.spacing(Y),marginRight:f.spacing(Y)})),(0,r.Y)(f,m,Y=>({marginTop:f.spacing(Y),marginBottom:f.spacing(Y)})),(0,r.Y)(f,v,Y=>({marginTop:f.spacing(Y)})),(0,r.Y)(f,l,Y=>({marginBottom:f.spacing(Y)})),(0,r.Y)(f,y,Y=>({marginLeft:f.spacing(Y)})),(0,r.Y)(f,u,Y=>({marginRight:f.spacing(Y)})),(0,r.Y)(f,D,Y=>({padding:f.spacing(Y)})),(0,r.Y)(f,E,Y=>({paddingLeft:f.spacing(Y),paddingRight:f.spacing(Y)})),(0,r.Y)(f,x,Y=>({paddingTop:f.spacing(Y),paddingBottom:f.spacing(Y)})),(0,r.Y)(f,P,Y=>({paddingTop:f.spacing(Y)})),(0,r.Y)(f,b,Y=>({paddingBottom:f.spacing(Y)})),(0,r.Y)(f,M,Y=>({paddingLeft:f.spacing(Y)})),(0,r.Y)(f,O,Y=>({paddingRight:f.spacing(Y)})),(0,r.Y)(f,I,Y=>({display:Y})),(0,r.Y)(f,T,Y=>({backgroundColor:o(Y,f)})),(0,r.Y)(f,B,Y=>({flexDirection:Y})),(0,r.Y)(f,C,Y=>({flexGrow:Y})),(0,r.Y)(f,S,Y=>({flexShrink:Y})),(0,r.Y)(f,A,Y=>({flexBasis:Y})),(0,r.Y)(f,L,Y=>({flex:Y})),(0,r.Y)(f,F,Y=>({borderStyle:Y})),(0,r.Y)(f,N,Y=>({borderColor:c(Y,f)})),(F||N)&&{borderWidth:"1px"},(0,r.Y)(f,U,Y=>({justifyContent:Y})),(0,r.Y)(f,K,Y=>({alignItems:Y})),(0,r.Y)(f,w,Y=>({borderRadius:f.shape.radius[Y]})),(0,r.Y)(f,V,Y=>({boxShadow:f.shadows[Y]})),(0,r.Y)(f,H,Y=>({gap:f.spacing(Y)}))])})},71259:(k,R,e)=>{"use strict";e.d(R,{x:()=>g});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(16795);const g=(0,i.forwardRef)((c,o)=>{const{alignItems:h,children:f,gap:d,columns:p,minColumnWidth:m,...v}=c,l=(0,s.of)(a,d,p,m,h);return(0,t.jsx)("div",{ref:o,...v,className:l.grid,children:f})});g.displayName="Grid";const a=(c,o,h,f,d)=>({grid:(0,n.css)([{display:"grid"},(0,r.Y)(c,o,p=>({gap:c.spacing(p)})),f&&(0,r.Y)(c,f,p=>({gridTemplateColumns:`repeat(auto-fill, minmax(${c.spacing(p)}, 1fr))`})),h&&(0,r.Y)(c,h,p=>({gridTemplateColumns:`repeat(${p}, 1fr)`})),(0,r.Y)(c,d,p=>({alignItems:p}))])})},66864:(k,R,e)=>{"use strict";e.d(R,{Gy:()=>a,PE:()=>g,gW:()=>c,mc:()=>o});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=(p=>(p[p.Horizontal=0]="Horizontal",p[p.Vertical=1]="Vertical",p))(r||{});const g=({children:p,orientation:m=0,spacing:v="sm",justify:l="flex-start",align:y="normal",wrap:u=!1,width:D="100%",height:E="100%",...x})=>{const P=(0,s.of)(h,m,v,l,y,u);return(0,t.jsx)("div",{className:P.layout,style:{width:D,height:E},...x,children:i.Children.toArray(p).filter(Boolean).map((b,M)=>(0,t.jsx)("div",{className:P.childWrapper,children:b},M))})},a=({children:p,spacing:m,justify:v,align:l="center",wrap:y,width:u,height:D})=>(0,t.jsx)(g,{spacing:m,justify:v,orientation:0,align:l,width:u,height:D,wrap:y,children:p}),c=({children:p,spacing:m,justify:v,align:l,width:y,height:u})=>(0,t.jsx)(g,{spacing:m,justify:v,orientation:1,align:l,width:y,height:u,children:p}),o=({children:p,padding:m,margin:v,grow:l,shrink:y})=>{const u=(0,s.of)(d,m,v);return(0,t.jsx)("div",{className:(0,n.cx)(u.wrapper,l!==void 0&&(0,n.css)({flexGrow:l}),y!==void 0&&(0,n.css)({flexShrink:y})),children:p})},h=(p,m,v,l,y,u)=>{const D=v!=="none"?p.spacing(f[v]):0,E=m===0&&!u||m===1?0:`-${D}`,x=m===1?"vertical-group":"horizontal-group";return{layout:(0,n.css)({label:x,display:"flex",flexDirection:m===1?"column":"row",flexWrap:u?"wrap":"nowrap",justifyContent:l,alignItems:y,height:"100%",maxWidth:"100%",marginBottom:E}),childWrapper:(0,n.css)({label:"layoutChildrenWrapper",marginBottom:m===0&&!u?0:D,marginRight:m===0?D:0,display:"flex",alignItems:y,"&:last-child":{marginBottom:m===1?0:void 0,marginRight:m===0?0:void 0}})}},f={none:0,xs:.5,sm:1,md:2,lg:3},d=(p,m,v)=>{const l=m&&m!=="none"&&p.spacing(f[m])||0,y=v&&v!=="none"&&p.spacing(f[v])||0;return{wrapper:(0,n.css)({label:"container",margin:y,padding:l})}}},68402:(k,R,e)=>{"use strict";e.d(R,{$:()=>i});var t=e(74848),n=e(90613);const i=({v:s=0,h:r=0,layout:g})=>(0,t.jsx)(n.a,{paddingRight:r,paddingBottom:s,display:g==="inline"?"inline-block":"block"})},67061:(k,R,e)=>{"use strict";e.d(R,{B:()=>a});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(16795),g=e(55738);const a=i.forwardRef((o,h)=>{const{gap:f=1,alignItems:d,justifyContent:p,direction:m,wrap:v,children:l,grow:y,shrink:u,basis:D,flex:E,width:x,minWidth:P,maxWidth:b,height:M,minHeight:O,maxHeight:I,...T}=o,C=(0,s.of)(c,f,d,p,m,v,y,u,D,E),S=(0,s.of)(g.E,x,P,b,M,O,I);return(0,t.jsx)("div",{ref:h,className:(0,n.cx)(C.flex,S),...T,children:l})});a.displayName="Stack";const c=(o,h,f,d,p,m,v,l,y,u)=>({flex:(0,n.css)([{display:"flex"},(0,r.Y)(o,p,D=>({flexDirection:D})),(0,r.Y)(o,m,D=>({flexWrap:typeof D=="boolean"?D?"wrap":"nowrap":D})),(0,r.Y)(o,f,D=>({alignItems:D})),(0,r.Y)(o,d,D=>({justifyContent:D})),(0,r.Y)(o,h,D=>({gap:o.spacing(D)})),(0,r.Y)(o,v,D=>({flexGrow:D})),(0,r.Y)(o,l,D=>({flexShrink:D})),(0,r.Y)(o,y,D=>({flexBasis:D})),(0,r.Y)(o,u,D=>({flex:D}))])})},16795:(k,R,e)=>{"use strict";e.d(R,{Y:()=>n});function t(i,s,r,g){const a=s[g];if(a!=null)return{[i.breakpoints.up(g)]:r(a)}}function n(i,s,r){return s==null?null:typeof s!="object"||!("xs"in s)?r(s):[t(i,s,r,"xs"),t(i,s,r,"sm"),t(i,s,r,"md"),t(i,s,r,"lg"),t(i,s,r,"xl"),t(i,s,r,"xxl")]}},55738:(k,R,e)=>{"use strict";e.d(R,{E:()=>i});var t=e(32196),n=e(16795);const i=(s,r,g,a,c,o,h)=>(0,t.css)([(0,n.Y)(s,r,f=>({width:s.spacing(f)})),(0,n.Y)(s,g,f=>({minWidth:s.spacing(f)})),(0,n.Y)(s,a,f=>({maxWidth:s.spacing(f)})),(0,n.Y)(s,c,f=>({height:s.spacing(f)})),(0,n.Y)(s,o,f=>({minHeight:s.spacing(f)})),(0,n.Y)(s,h,f=>({maxHeight:s.spacing(f)}))])},50720:(k,R,e)=>{"use strict";e.d(R,{N:()=>g});var t=e(74848),n=e(96540),i=e(54625),s=e(71733),r=e(80997);const g=(0,n.forwardRef)(({href:a,children:c,...o},h)=>{const f=s.I.stripBaseFromUrl(r.sQ.sanitizeUrl(a??""));return(0,t.jsx)(i.Link,{ref:h,to:f,...o,children:c})});g.displayName="Link"},72109:(k,R,e)=>{"use strict";e.d(R,{Y:()=>f});var t=e(74848),n=e(32196),i=e(96540),s=e(80997),r=e(71733),g=e(40845),a=e(14578),c=e(71356),o=e(50720);const h={h1:"xl",h2:"xl",h3:"lg",h4:"lg",h5:"md",h6:"md",body:"md",bodySmall:"xs"},f=(0,i.forwardRef)(({href:p,color:m="link",external:v=!1,inline:l=!0,variant:y="body",weight:u,icon:D,children:E,...x},P)=>{const b=s.sQ.sanitizeUrl(p??""),M=(0,g.$j)(),O=d(M,l,y,u,m),I=D||"external-link-alt";if(v)return(0,t.jsxs)("a",{href:b,ref:P,...x,target:"_blank",rel:"noreferrer",className:O,children:[E,(0,t.jsx)(a.I,{size:h[y]||"md",name:I})]});const T=r.I.stripBaseFromUrl(b);return(0,t.jsxs)(o.N,{ref:P,href:T,...x,className:O,children:[E,D&&(0,t.jsx)(a.I,{name:D,size:h[y]||"md"})]})});f.displayName="TextLink";const d=(p,m,v,l,y)=>(0,n.css)([v&&{...p.typography[v]},l&&{fontWeight:(0,c.iV)(l,p)},y&&{color:p.colors.text[y]},{alignItems:"center",gap:"0.25em",display:"inline-flex",textDecoration:"none","&:hover":{textDecoration:"underline",color:p.colors.text.link}},m&&{textDecoration:"underline","&:hover":{textDecoration:"none"}}])},85918:(k,R,e)=>{"use strict";e.d(R,{p:()=>g});var t=e(74848),n=e(32196),i=e(96540),s=e(3911);const r=(0,s.N)((a=!1)=>({list:(0,n.css)({listStyleType:"none",margin:0,padding:0}),item:(0,n.css)({display:a&&"inline-block"||"block"})}));class g extends i.PureComponent{constructor(c){super(c)}render(){const{items:c,renderItem:o,getItemKey:h,className:f,inline:d}=this.props,p=r(d);return(0,t.jsx)("ul",{className:(0,n.cx)(p.list,f),children:c.map((m,v)=>(0,t.jsx)("li",{className:p.item,children:o(m,v)},h?h(m):v))})}}},1551:(k,R,e)=>{"use strict";e.d(R,{c:()=>s});var t=e(74848),n=e(96540),i=e(85918);class s extends n.PureComponent{render(){return(0,t.jsx)(i.p,{inline:!0,...this.props})}}},33552:(k,R,e)=>{"use strict";e.d(R,{B:()=>s});var t=e(74848),n=e(96540),i=e(85918);class s extends n.PureComponent{render(){return(0,t.jsx)(i.p,{...this.props})}}},57514:(k,R,e)=>{"use strict";e.d(R,{G:()=>h});var t=e(74848),n=e(32196),i=e(40845);const s=28,r=2.4,g=500,a=4e3,c=300,o=100/s*100;function h({width:d,delay:p=c,ariaLabel:m="Loading bar"}){const v=Math.min(Math.max(Math.round(d*r),g),a),l=(0,i.of)(f,p,v),y={overflow:"hidden"};return(0,t.jsx)("div",{style:y,children:(0,t.jsx)("div",{"aria-label":m,className:l.bar})})}const f=(d,p,m)=>{const v=(0,n.keyframes)({"0%":{transform:"translateX(-100%)"},"85%, 100%":{transform:`translateX(${o}%)`}});return{bar:(0,n.css)({width:s+"%",height:1,background:"linear-gradient(90deg, rgba(110, 159, 255, 0) 0%, #6E9FFF 80.75%, rgba(110, 159, 255, 0) 100%)",transform:"translateX(-100%)",willChange:"transform",[d.transitions.handleMotion("no-preference")]:{animationName:v,animationDelay:`${p}ms`,animationTimingFunction:"linear",animationIterationCount:"infinite",animationDuration:`${m}ms`},[d.transitions.handleMotion("reduce")]:{animationName:v,animationDelay:`${p}ms`,animationTimingFunction:"linear",animationIterationCount:"infinite",animationDuration:`${4*m}ms`}})}}},39558:(k,R,e)=>{"use strict";e.d(R,{_:()=>r});var t=e(74848),n=e(32196),i=e(40845),s=e(62930);const r=({text:a,className:c,...o})=>{const h=(0,i.of)(g);return(0,t.jsxs)("div",{className:(0,n.cx)(h.container,c),...o,children:[a," ",(0,t.jsx)(s.y,{inline:!0})]})},g=a=>({container:(0,n.css)({marginBottom:a.spacing(4)})})},76218:(k,R,e)=>{"use strict";e.d(R,{O:()=>r});var t=e(74848),n=e(96540),i=e(90182),s=e(64278);const r=({value:g,onChange:a,context:c,item:o})=>{const h=o.settings??{},f=(0,s.sE)(c.data,h?.filter),d=(0,s.m3)(f,g,void 0,void 0,h.baseNameMode),p=(0,n.useCallback)(v=>{if(!(v&&!(0,s.v3)(v.value,f)))return a(v?.value)},[f,a]),m=d.find(v=>v.value===g);return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(i.l6,{value:m,placeholder:h.placeholderText??"Select field",options:d,onChange:p,noOptionsMessage:h.noFieldsMessage,width:h.width,isClearable:h.isClearable!==!1})})}},9988:(k,R,e)=>{"use strict";e.d(R,{bx:()=>o,cH:()=>d});var t=e(74848),n=e(96540),i=e(11261),s=e(1173),r=e(85200),g=e(4025),a=e(90182);const c=(0,n.memo)(p=>{const{data:m,options:v,onChange:l,id:y}=p,u=h(m),D=f(u,v),E=(0,n.useCallback)(P=>l(P.value),[l]),x=D.find(P=>P.value===v);return(0,t.jsx)(a.l6,{inputId:y,value:x,options:D,onChange:E})});c.displayName="FieldTypeMatcherEditor";const o=[{value:i.PU.number,label:"Number",icon:(0,g.lV)(i.PU.number)},{value:i.PU.string,label:"String",icon:(0,g.lV)(i.PU.string)},{value:i.PU.time,label:"Time",icon:(0,g.lV)(i.PU.time)},{value:i.PU.boolean,label:"Boolean",icon:(0,g.lV)(i.PU.boolean)},{value:i.PU.trace,label:"Traces",icon:(0,g.lV)(i.PU.trace)},{value:i.PU.enum,label:"Enum",icon:(0,g.lV)(i.PU.enum)},{value:i.PU.other,label:"Other",icon:(0,g.lV)(i.PU.other)}],h=p=>(0,n.useMemo)(()=>{const m=new Map;for(const v of o)m.set(v.value,0);for(const v of p)for(const l of v.fields){const y=l.type||i.PU.other;let u=m.get(y);u||(u=0),m.set(y,u+1)}return m},[p]),f=(p,m)=>(0,n.useMemo)(()=>{let v=!1;const l=[];for(const y of o){const u=p.get(y.value),D=m===y.value;(u||D)&&l.push({...y,label:`${y.label} (${p.get(y.value)})`}),D&&(v=!0)}return m&&!v&&l.push({value:m,label:`${m} (No matches)`}),l},[p,m]),d={id:s.Ct.byType,component:c,matcher:r.sJ.get(s.Ct.byType),name:"Fields with type",description:"Set properties for fields of a specific type (number, string, boolean)",optionsToLabel:p=>p}},19346:(k,R,e)=>{"use strict";e.d(R,{N:()=>f,r1:()=>v});var t=e(74848),n=e(32196),i=e(96540),s=e(75059),r=e(1173),g=e(85200),a=e(52622),c=e(40845),o=e(10354),h=e(90182);const f=[{label:"==",value:a.zT.EQ},{label:"!=",value:a.zT.NEQ},{label:">",value:a.zT.GT},{label:">=",value:a.zT.GTE},{label:"<",value:a.zT.LT},{label:"<=",value:a.zT.LTE}];function d(l){return l===s.gy.allIsNull||l===s.gy.allIsZero}const p=({options:l,onChange:y})=>{const u=(0,c.of)(m),D=(0,i.useMemo)(()=>s.AS.selectOptions([l?.reducer]),[l?.reducer]),E=(0,i.useCallback)(O=>y({...l,reducer:O.value}),[l,y]),x=(0,i.useCallback)(O=>y({...l,op:O.value}),[l,y]),P=(0,i.useCallback)(O=>{const I=O.currentTarget.valueAsNumber;return y({...l,value:I})},[l,y]),b=l??{},M=d(l.reducer);return(0,t.jsxs)("div",{className:u.spot,children:[(0,t.jsx)(h.l6,{value:D.current,options:D.options,onChange:E,placeholder:"Select field reducer"}),b.reducer&&!M&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.l6,{value:f.find(O=>O.value===b.op),options:f,onChange:x,"aria-label":"Comparison operator",width:19}),(0,t.jsx)(o.p,{type:"number",value:b.value,onChange:P})]})]})},m=l=>({spot:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"center",alignContent:"flex-end",gap:"4px"})}),v={id:r.Ct.byValue,component:p,matcher:g.sJ.get(r.Ct.byValue),name:"Fields with values",description:"Set properties for fields with reducer condition",optionsToLabel:l=>`${l?.reducer} ${l?.op} ${l?.value}`}},74668:(k,R,e)=>{"use strict";e.d(R,{R:()=>f,X:()=>c});var t=e(74848),n=e(96540),i=e(28240),s=e(1173),r=e(85200),g=e(90182);const a=(d,p,m)=>{if(!m)return;let v=d.find(l=>!p.some(y=>l===y));if(v)return v};function c({value:d,data:p,onChange:m,placeholder:v}){const l=(0,n.useMemo)(()=>o(p),[p]),[y,u]=(0,n.useState)({refIds:[],value:void 0}),D=(0,n.useMemo)(()=>l.find(x=>x.value===d)??a(l,y.refIds,y.value),[d,l,y]),E=(0,n.useCallback)(x=>{m(x?.value)},[m]);return(l!==y.refIds||D?.value!==y.value)&&u({refIds:l,value:D?.value}),(0,t.jsx)(g.l6,{options:l,onChange:E,isClearable:!0,placeholder:v??"Select query refId",value:D})}function o(d){const p=new Map;for(const v of d){const l=v.refId??"",y=p.get(l)??[];y.length===0&&p.set(l,y),y.push(v)}const m=[];for(const[v,l]of p.entries())m.push({value:v,label:`Query: ${v??"(missing refId)"}`,description:h(l)});return m}function h(d){return`Frames (${d.length}):
    ${d.slice(0,Math.min(3,d.length)).map(p=>(0,i.Ri)(p)).join(", ")} ${d.length>3?"...":""}`}const f={id:s.Ct.byFrameRefID,component:d=>(0,t.jsx)(c,{value:d.options,data:d.data,onChange:d.onChange}),matcher:r.sJ.get(s.Ct.byFrameRefID),name:"Fields returned by query",description:"Set properties for fields from a specific query",optionsToLabel:d=>d}},84349:(k,R,e)=>{"use strict";e.d(R,{g:()=>u});var t=e(83077),n=e(74848),i=e(96540),s=e(1173),r=e(85200),g=e(10354);const a=(0,i.memo)(D=>{const{options:E,onChange:x}=D,P=(0,i.useCallback)(b=>x(b.target.value),[x]);return(0,n.jsx)(g.p,{placeholder:"Enter regular expression",defaultValue:E,onBlur:P})});a.displayName="FieldNameByRegexMatcherEditor";const c={id:s.Ct.byRegexp,component:a,matcher:r.sJ.get(s.Ct.byRegexp),name:"Fields with name matching regex",description:"Set properties for fields with names matching a regex",optionsToLabel:D=>D};var o=e(90182),h=e(64278);const f=(0,i.memo)(D=>{const{data:E,options:x,onChange:P,id:b}=D,M=(0,h.sE)(E),O=(0,h.m3)(M,x),I=(0,i.useCallback)(C=>{if((0,h.v3)(C.value,M))return P(C.value)},[M,P]),T=O.find(C=>C.value===x);return(0,n.jsx)(o.l6,{value:T,options:O,onChange:I,inputId:b})});f.displayName="FieldNameMatcherEditor";const d={id:s.Ct.byName,component:f,matcher:r.sJ.get(s.Ct.byName),name:"Fields with name",description:"Set properties for a specific field",optionsToLabel:D=>D},p=(0,i.memo)(D=>{const{data:E,options:x,onChange:P}=D,{readOnly:b,prefix:M}=x,O=(0,h.sE)(E),I=(0,h.m3)(O,void 0),T=(0,i.useCallback)(C=>{if(Array.isArray(C))return P({...x,names:C.reduce((S,A)=>((0,h.v3)(A.value,O)&&S.push(A.value),S),[])})},[O,P,x]);if(b){const C=(x.names??[]).join(", ");return(0,n.jsx)(g.p,{value:C,readOnly:!0,disabled:!0,prefix:M})}return(0,n.jsx)(o.KF,{value:x.names,options:I,onChange:T})});p.displayName="FieldNameMatcherEditor";const m={id:s.Ct.byNames,component:p,matcher:r.sJ.get(s.Ct.byNames),name:"Fields with name",description:"Set properties for a specific field",optionsToLabel:D=>(D.names??[]).join(", "),excludeFromPicker:!0};var v=e(9988),l=e(19346),y=e(74668);const u=new t.O(()=>[d,c,v.cH,y.R,m,l.r1])},64278:(k,R,e)=>{"use strict";e.d(R,{BP:()=>g,m3:()=>c,sE:()=>a,v3:()=>r});var t=e(96540),n=e(28240),i=e(27310),s=e(4025);function r(o,h){return o?h.display.has(o)||h.raw.has(o):!1}function g(o,h){const f={display:new Set,raw:new Set,fields:new Map};for(const d of o)for(const p of d.fields){if(h&&!h(p))continue;const m=(0,n.Ct)(p,d,o);f.display.add(m),f.fields.set(m,p),p.name&&m!==p.name&&(f.raw.add(p.name),f.fields.set(p.name,p))}return f}function a(o,h){return(0,t.useMemo)(()=>g(o,h),[o,h])}function c(o,h,f,d,p){return(0,t.useMemo)(()=>{let m=!1;const v=[];if(f&&v.push(f),p===i.X4.OnlyBaseNames)for(const l of o.raw)!m&&l===h&&(m=!0),v.push({value:l,label:`${l} (base field name)`});else{for(const l of o.display){!m&&l===h&&(m=!0);const y=o.fields.get(l);(!d||d===y?.type)&&v.push({value:l,label:l,icon:y?(0,s.SS)(y):void 0})}if(p!==i.X4.ExcludeBaseNames)for(const l of o.raw)o.display.has(l)||(!m&&l===h&&(m=!0),v.push({value:l,label:`${l} (base field name)`}))}return h&&!m&&v.push({value:h,label:`${h} (not found)`}),v},[o,h,f,d,p])}},38138:(k,R,e)=>{"use strict";e.d(R,{W:()=>f});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(90613),g=e(27183),a=e(59093),c=e(64539),o=e(32653);const h=i.forwardRef(({header:p,children:m,ariaLabel:v,onOpen:l,onClose:y,onKeyDown:u,...D},E)=>{const x=(0,s.of)(d),P=(0,i.useRef)(null);(0,i.useImperativeHandle)(E,()=>P.current);const[b]=(0,o.t)({isMenuOpen:!0,localRef:P,onOpen:l,onClose:y,onKeyDown:u});return(0,t.jsxs)(r.a,{...D,"aria-label":v,backgroundColor:"primary",borderRadius:"default",boxShadow:"z3",display:"inline-block",onKeyDown:b,paddingX:0,paddingY:.5,ref:P,role:"menu",tabIndex:-1,children:[p&&(0,t.jsx)("div",{className:(0,n.cx)(x.header,!!m&&i.Children.toArray(m).length>0&&x.headerBorder),children:p}),m]})});h.displayName="Menu";const f=Object.assign(h,{Item:c.D,Divider:g.N,Group:a.r}),d=p=>({header:(0,n.css)({padding:p.spacing(.5,1,1,1)}),headerBorder:(0,n.css)({borderBottom:`1px solid ${p.colors.border.weak}`})})},27183:(k,R,e)=>{"use strict";e.d(R,{N:()=>s});var t=e(74848),n=e(32196),i=e(40845);function s(){const g=(0,i.of)(r);return(0,t.jsx)("div",{className:g.divider})}const r=g=>({divider:(0,n.css)({height:1,backgroundColor:g.colors.border.weak,margin:g.spacing(.5,0)})})},59093:(k,R,e)=>{"use strict";e.d(R,{r:()=>g});var t=e(74848),n=e(32196),i=e(2543),s=e.n(i),r=e(40845);const g=({label:c,ariaLabel:o,children:h})=>{const f=(0,r.of)(a),d=`group-label-${(0,i.uniqueId)()}`;return(0,t.jsxs)("div",{role:"group","aria-labelledby":!o&&c?d:void 0,"aria-label":o,children:[c&&(0,t.jsx)("label",{id:d,className:f.groupLabel,"aria-hidden":!0,children:c}),h]})};g.displayName="MenuGroup";const a=c=>({groupLabel:(0,n.css)({color:c.colors.text.secondary,fontSize:c.typography.size.sm,padding:c.spacing(.5,1)})})},64539:(k,R,e)=>{"use strict";e.d(R,{D:()=>p});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(16797),g=e(14578),a=e(67061),c=e(13544),o=e(32653);const h=v=>{if(!v)return!1;const l=v.parentElement.getBoundingClientRect(),y=v.getBoundingClientRect();return y.width!==0&&l.right+y.width+10>window.innerWidth},f=(0,i.memo)(({items:v,isOpen:l,close:y,customStyle:u})=>{const D=(0,s.of)(d),E=(0,i.useRef)(null),[x]=(0,o.t)({localRef:E,isMenuOpen:l,close:y}),[P,b]=(0,i.useState)(!1);return(0,i.useEffect)(()=>{l&&E.current&&b(h(E.current))},[l]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:D.iconWrapper,"aria-hidden":!0,"data-testid":c.Tp.components.Menu.SubMenu.icon,children:(0,t.jsx)(g.I,{name:"angle-right",className:D.icon})}),l&&(0,t.jsx)("div",{ref:E,className:(0,n.cx)(D.subMenu,{[D.pushLeft]:P}),"data-testid":c.Tp.components.Menu.SubMenu.container,style:u,children:(0,t.jsx)("div",{tabIndex:-1,className:D.itemsWrapper,role:"menu",onKeyDown:x,children:v})})]})});f.displayName="SubMenu";const d=v=>({iconWrapper:(0,n.css)({display:"flex",flex:1,justifyContent:"end"}),icon:(0,n.css)({opacity:.7,marginLeft:v.spacing(1),color:v.colors.text.secondary}),itemsWrapper:(0,n.css)({background:v.colors.background.primary,boxShadow:v.shadows.z3,display:"inline-block",borderRadius:v.shape.radius.default}),pushLeft:(0,n.css)({right:"100%",left:"unset"}),subMenu:(0,n.css)({position:"absolute",top:0,left:"100%",zIndex:v.zIndex.dropdown})}),p=i.memo(i.forwardRef((v,l)=>{const{url:y,icon:u,label:D,description:E,ariaLabel:x,ariaChecked:P,target:b,onClick:M,className:O,active:I,disabled:T,destructive:C,childItems:S,role:A,tabIndex:L=-1,customSubMenuContainerStyles:N,shortcut:F,testId:w}=v,B=(0,s.of)(m),[U,K]=(0,i.useState)(I),[V,H]=(0,i.useState)(!1),Y=(0,i.useCallback)(()=>{T||(H(!0),K(!0))},[T]),X=(0,i.useCallback)(()=>{T||(H(!1),K(!1))},[T]),J=S&&S.length>0,q=J?"div":y===void 0?"button":"a",ae=(0,n.cx)({[B.item]:!0,[B.active]:U,[B.disabled]:T,[B.destructive]:C&&!T},O),j={[q==="button"?"disabled":"aria-disabled"]:T,...q==="a"&&T&&{href:void 0,onClick:void 0},...T&&{tabIndex:-1,"data-disabled":T}},te=(0,i.useRef)(null);(0,i.useImperativeHandle)(l,()=>te.current);const ne=ee=>{switch(ee.key){case"ArrowRight":ee.preventDefault(),ee.stopPropagation(),J&&(H(!0),K(!0));break;default:break}},le=()=>{H(!1),K(!1),te?.current?.focus()},z=!!(F&&F.length>0);return(0,t.jsxs)(q,{target:b,className:ae,rel:b==="_blank"?"noopener noreferrer":void 0,href:y,onClick:M,onMouseEnter:Y,onMouseLeave:X,onKeyDown:ne,role:y?A:A||"menuitem","data-role":"menuitem",ref:te,"data-testid":w,"aria-label":x,"aria-checked":P,tabIndex:L,...j,children:[(0,t.jsxs)(a.B,{direction:"row",justifyContent:"flex-start",alignItems:"center",children:[u&&(0,t.jsx)(g.I,{name:u,className:B.icon,"aria-hidden":!0}),(0,t.jsx)("span",{className:B.ellipsis,children:D}),(0,t.jsxs)("div",{className:(0,n.cx)(B.rightWrapper,{[B.withShortcut]:z}),children:[z&&(0,t.jsxs)("div",{className:B.shortcut,children:[(0,t.jsx)(g.I,{name:"keyboard",title:"keyboard shortcut"}),F]}),J&&(0,t.jsx)(f,{items:S,isOpen:V,close:le,customStyle:N})]})]}),E&&(0,t.jsx)("div",{className:(0,n.cx)(B.description,B.ellipsis,{[B.descriptionWithIcon]:u!==void 0}),children:E}),v.component?(0,t.jsx)(v.component,{}):null]})}));p.displayName="MenuItem";const m=v=>({item:(0,n.css)({background:"none",cursor:"pointer",whiteSpace:"nowrap",color:v.colors.text.primary,display:"flex",flexDirection:"column",alignItems:"stretch",padding:v.spacing(.5,2),minHeight:v.spacing(4),margin:0,border:"none",width:"100%",position:"relative","&:hover, &:focus-visible":{background:v.colors.action.hover,color:v.colors.text.primary,textDecoration:"none"},"&:focus-visible":(0,r.getFocusStyles)(v)}),active:(0,n.css)({background:v.colors.action.hover}),destructive:(0,n.css)({color:v.colors.error.text,svg:{color:v.colors.error.text},"&:hover, &:focus, &:focus-visible":{background:v.colors.error.main,color:v.colors.error.contrastText,svg:{color:v.colors.error.contrastText}}}),disabled:(0,n.css)({color:v.colors.action.disabledText,label:"menu-item-disabled","&:hover, &:focus, &:focus-visible":{cursor:"not-allowed",background:"none",color:v.colors.action.disabledText}}),icon:(0,n.css)({opacity:.7,color:v.colors.text.secondary}),rightWrapper:(0,n.css)({display:"flex",alignItems:"center",marginLeft:"auto"}),withShortcut:(0,n.css)({minWidth:v.spacing(10.5)}),shortcut:(0,n.css)({display:"flex",alignItems:"center",gap:v.spacing(1),marginLeft:v.spacing(2),color:v.colors.text.secondary,opacity:.7}),description:(0,n.css)({...v.typography.bodySmall,color:v.colors.text.secondary,textAlign:"start"}),descriptionWithIcon:(0,n.css)({marginLeft:v.spacing(3)}),ellipsis:(0,n.css)({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"})})},32653:(k,R,e)=>{"use strict";e.d(R,{t:()=>r});var t=e(96540),n=e(94701);const i=(g,a)=>(g%a+a)%a,s=-1,r=({localRef:g,isMenuOpen:a,close:c,onOpen:o,onClose:h,onKeyDown:f})=>{const[d,p]=(0,t.useState)(s);return(0,t.useEffect)(()=>{a&&p(0)},[a]),(0,t.useEffect)(()=>{const v=g?.current?.querySelectorAll('[data-role="menuitem"]:not([data-disabled])');v?.[d]?.focus(),v?.forEach((l,y)=>{l.tabIndex=y===d?0:-1})},[g,d]),(0,n.A)(()=>{o?.(p)}),[v=>{const l=g?.current?.querySelectorAll('[data-role="menuitem"]:not([data-disabled])'),y=l?.length??0;switch(v.key){case"ArrowUp":v.preventDefault(),v.stopPropagation(),p(i(d-1,y));break;case"ArrowDown":v.preventDefault(),v.stopPropagation(),p(i(d+1,y));break;case"ArrowLeft":v.preventDefault(),v.stopPropagation(),p(s),c?.();break;case"Home":v.preventDefault(),v.stopPropagation(),p(0);break;case"End":v.preventDefault(),v.stopPropagation(),p(y-1);break;case"Enter":v.preventDefault(),v.stopPropagation(),l?.[d]?.click();break;case"Escape":h?.();break;case"Tab":v.preventDefault(),h?.();break;default:break}f?.(v)}]}},37390:(k,R,e)=>{"use strict";e.d(R,{a:()=>m});var t=e(74848),n=e(32196),i=e(18828),s=e(85690),r=e(93225),g=e(59875),a=e(96540),c=e(40845),o=e(76412),h=e(29158),f=e(67061),d=e(29473),p=e(88448);function m(y){const{title:u,children:D,isOpen:E=!1,closeOnEscape:x=!0,closeOnBackdropClick:P=!0,className:b,contentClassName:M,onDismiss:O,onClickBackdrop:I,trapFocus:T=!0}=y,C=(0,c.of)(p.o),S=(0,a.useRef)(null),{overlayProps:A,underlayProps:L}=(0,r.e)({isKeyboardDismissDisabled:!x,isOpen:E,onClose:O},S),{dialogProps:N,titleProps:F}=(0,i.s)({},S);if(!E)return null;const w=(0,n.cx)(C.modalHeader,typeof u!="string"&&C.modalHeaderWithTabs);return(0,t.jsxs)(g.Sf,{children:[(0,t.jsx)("div",{role:"presentation",className:C.modalBackdrop,onClick:I||(P?O:void 0),...L}),(0,t.jsx)(s.n1,{contain:T,autoFocus:!0,restoreFocus:!0,children:(0,t.jsxs)("div",{className:(0,n.cx)(C.modal,b),ref:S,...A,...N,children:[(0,t.jsxs)("div",{className:w,children:[typeof u=="string"&&(0,t.jsx)(l,{...y,title:u,id:F.id}),typeof u!="string"&&u,(0,t.jsx)("div",{className:C.modalHeaderClose,children:(0,t.jsx)(h.K,{name:"times",size:"xl",onClick:O,"aria-label":(0,o.t)("grafana-ui.modal.close-tooltip","Close")})})]}),(0,t.jsx)("div",{className:(0,n.cx)(C.modalContent,M),children:D})]})})]})}function v({leftItems:y,children:u}){const D=(0,c.of)(p.o);return y?(0,t.jsx)("div",{className:D.modalButtonRow,children:(0,t.jsxs)(f.B,{justifyContent:"space-between",children:[(0,t.jsx)(f.B,{justifyContent:"flex-start",gap:2,children:y}),(0,t.jsx)(f.B,{justifyContent:"flex-end",gap:2,children:u})]})}):(0,t.jsx)("div",{className:D.modalButtonRow,children:(0,t.jsx)(f.B,{justifyContent:"flex-end",gap:2,wrap:"wrap",children:u})})}m.ButtonRow=v;function l({icon:y,iconTooltip:u,title:D,id:E}){return(0,t.jsx)(d.r,{icon:y,iconTooltip:u,title:D,id:E})}},29473:(k,R,e)=>{"use strict";e.d(R,{r:()=>s});var t=e(74848),n=e(40845),i=e(88448);const s=({icon:r,iconTooltip:g,title:a,children:c,id:o})=>{const h=(0,n.of)(i.o);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h2",{className:h.modalHeaderTitle,id:o,children:a}),c]})}},95246:(k,R,e)=>{"use strict";e.d(R,{O:()=>n});var t=e(74848);const n=({children:i})=>(0,t.jsx)("div",{className:"share-modal-body",children:(0,t.jsx)("div",{className:"share-modal-header",children:(0,t.jsx)("div",{className:"share-modal-content",children:i})})})},25897:(k,R,e)=>{"use strict";e.d(R,{J:()=>r});var t=e(74848),n=e(40675),i=e(63021),s=e(29473);const r=({icon:g,title:a,tabs:c,activeTab:o,onChangeTab:h})=>(0,t.jsx)(s.r,{icon:g,title:a,children:(0,t.jsx)(i.U,{hideBorder:!0,children:c.map((f,d)=>(0,t.jsx)(n.o,{label:f.label,icon:f.icon,suffix:f.tabSuffix,active:f.value===o,onChangeTab:()=>h(f)},`${f.value}-${d}`))})})},71678:(k,R,e)=>{"use strict";e.d(R,{$s:()=>g,EO:()=>r,YO:()=>s,wE:()=>i});var t=e(74848),n=e(96540);const i=n.createContext({component:null,props:{},showModal:()=>{},hideModal:()=>{}});class s extends n.Component{constructor(c){super(c),this.showModal=(o,h)=>{this.setState({component:o,props:h})},this.hideModal=()=>{this.setState({component:null,props:{}})},this.state={component:c.component||null,props:c.props||{},showModal:this.showModal,hideModal:this.hideModal}}render(){return(0,t.jsx)(i.Provider,{value:this.state,children:this.props.children})}}const r=()=>(0,t.jsx)(i.Consumer,{children:({component:a,props:c})=>a?(0,t.jsx)(a,{...c}):null}),g=i.Consumer},88448:(k,R,e)=>{"use strict";e.d(R,{o:()=>n});var t=e(32196);const n=i=>{const s=i.shape.radius.default;return{modal:(0,t.css)({position:"fixed",zIndex:i.zIndex.modal,background:i.colors.background.primary,boxShadow:i.shadows.z3,borderRadius:s,border:`1px solid ${i.colors.border.weak}`,backgroundClip:"padding-box",outline:"none",width:"750px",maxWidth:"100%",left:0,right:0,marginLeft:"auto",marginRight:"auto",top:"10%",maxHeight:"80%",display:"flex",flexDirection:"column"}),modalBackdrop:(0,t.css)({position:"fixed",zIndex:i.zIndex.modalBackdrop,top:0,right:0,bottom:0,left:0,backgroundColor:i.components.overlay.background,backdropFilter:"blur(1px)"}),modalHeader:(0,t.css)({label:"modalHeader",display:"flex",alignItems:"center",minHeight:"42px",margin:i.spacing(1,2,0,2)}),modalHeaderWithTabs:(0,t.css)({borderBottom:`1px solid ${i.colors.border.weak}`}),modalHeaderTitle:(0,t.css)({fontSize:i.typography.size.lg,margin:i.spacing(0,4,0,1),display:"flex",alignItems:"center",position:"relative",top:"2px"}),modalHeaderIcon:(0,t.css)({marginRight:i.spacing(2),fontSize:"inherit","&:before":{verticalAlign:"baseline"}}),modalHeaderClose:(0,t.css)({height:"100%",display:"flex",alignItems:"center",color:i.colors.text.secondary,flexGrow:1,justifyContent:"flex-end"}),modalContent:(0,t.css)({overflow:"auto",padding:i.spacing(3),width:"100%"}),modalButtonRow:(0,t.css)({paddingTop:i.spacing(3)})}}},32372:(k,R,e)=>{"use strict";e.d(R,{B:()=>m});var t=e(74848),n=e(32196),i=e(96540),s=e(96915),r=e(13544),g=e(40845),a=e(85828),c=e(19716);function o(l){for(let y=l.length-1;y>0;y--){const u=l.charAt(y);if(u==="$")return{index:y,prefix:l.substring(y)};if(u===" "||u==="	"||u==='"'||u==="'")return{index:y+1,prefix:l.substring(y+1)}}return{index:0,prefix:l}}function h(l,y,u,D){const E=[];for(const x of u)y&&!x.label.startsWith(y)||E.push({...x,kind:f(l,x.kind),range:D,insertText:x.insertText??x.label});return E}function f(l,y){switch(y){case c.q.Method:return l.languages.CompletionItemKind.Method;case c.q.Field:return l.languages.CompletionItemKind.Field;case c.q.Property:return l.languages.CompletionItemKind.Property;case c.q.Constant:return l.languages.CompletionItemKind.Constant;case c.q.Text:return l.languages.CompletionItemKind.Text}return l.languages.CompletionItemKind.Text}function d(l,y,u,D){if(!(!y||!u))return l.languages.registerCompletionItemProvider(y,{triggerCharacters:["$"],provideCompletionItems:(E,x,P)=>{if(E.id!==D)return;const b={startLineNumber:x.lineNumber,endLineNumber:x.lineNumber,startColumn:x.column,endColumn:x.column};if(P.triggerCharacter==="$")return b.startColumn=x.column-1,{suggestions:h(l,"$",u(),b)};const M=E.getValueInRange({startLineNumber:x.lineNumber,startColumn:1,endLineNumber:x.lineNumber,endColumn:x.column}),{index:O,prefix:I}=o(M);b.startColumn=O+1;const T=h(l,I,u(),b);if(T.length)return{suggestions:T}}})}class p extends i.PureComponent{constructor(y){super(y),this.loadCustomLanguage=()=>{const{language:u}=this.props,D=s.l.getIfExists(u);return D?D.init():Promise.resolve()},this.getEditorValue=()=>"",this.onBlur=()=>{const{onBlur:u}=this.props;u&&u(this.getEditorValue())},this.onFocus=()=>{const{onFocus:u}=this.props;u&&u(this.getEditorValue())},this.onSave=()=>{const{onSave:u}=this.props;u&&u(this.getEditorValue())},this.handleBeforeMount=u=>{this.monaco=u;const{onBeforeEditorMount:D}=this.props;D?.(u)},this.handleOnMount=(u,D)=>{const{getSuggestions:E,language:x,onChange:P,onEditorDidMount:b}=this.props;this.modelId=u.getModel()?.id,this.getEditorValue=()=>u.getValue(),E&&this.modelId&&(this.completionCancel=d(D,x,E,this.modelId)),u.onKeyDown(M=>{M.keyCode===D.KeyCode.KeyS&&(M.ctrlKey||M.metaKey)&&(M.preventDefault(),this.onSave())}),P&&u.getModel()?.onDidChangeContent(()=>P(u.getValue())),b&&b(u,D)}}componentWillUnmount(){this.completionCancel&&this.completionCancel.dispose(),this.props.onEditorWillUnmount?.()}componentDidUpdate(y){const{getSuggestions:u,language:D}=this.props,E=y.language!==D;if(y.getSuggestions!==u||E){if(this.completionCancel&&this.completionCancel.dispose(),!this.monaco){console.warn("Monaco instance not loaded yet");return}u&&this.modelId&&(this.completionCancel=d(this.monaco,D,u,this.modelId))}E&&this.loadCustomLanguage()}render(){const{theme:y,language:u,width:D,height:E,showMiniMap:x,showLineNumbers:P,readOnly:b,monacoOptions:M}=this.props,{alwaysConsumeMouseWheel:O,...I}=M??{},T=this.props.value??"",C=T.length>100,S=this.props.containerStyles??v(y).container,A={wordWrap:"off",tabSize:2,codeLens:!1,contextmenu:!1,minimap:{enabled:C&&x,renderCharacters:!1},readOnly:b,lineNumbersMinChars:4,lineDecorationsWidth:1*y.spacing.gridSize,overviewRulerBorder:!1,automaticLayout:!0,padding:{top:.5*y.spacing.gridSize,bottom:.5*y.spacing.gridSize},fixedOverflowWidgets:!0,scrollbar:{alwaysConsumeMouseWheel:O??!1}};return P||(A.glyphMargin=!1,A.folding=!1,A.lineNumbers="off",A.lineNumbersMinChars=0),(0,t.jsx)("div",{className:S,onFocus:this.onFocus,onBlur:this.onBlur,"data-testid":r.Tp.components.CodeEditor.container,children:(0,t.jsx)(a.m,{width:D,height:E,language:u,value:T,options:{...A,...I??{}},beforeMount:this.handleBeforeMount,onMount:this.handleOnMount,keepCurrentModel:!0})})}}const m=(0,g.cV)(p),v=l=>({container:(0,n.css)({borderRadius:l.shape.radius.default,border:`1px solid ${l.components.input.borderColor}`})})},85828:(k,R,e)=>{"use strict";e.d(R,{m:()=>o});var t=e(74848),n=e(32196),i=e(13544),s=e(40845),r=e(16817);const g=f=>{const d=(0,r.A)(async()=>await f);return{...d,dependency:d.value}};var a=e(52446),c=e(39558);const o=f=>{const d=(0,s.of)(h),{loading:p,error:m,dependency:v}=g(Promise.all([e.e(8477),e.e(6556),e.e(8926)]).then(e.bind(e,16556)));if(p)return(0,t.jsx)(c._,{text:"Loading editor",className:d.container});if(m)return(0,t.jsx)(a.D,{title:"React Monaco Editor failed to load",error:m,errorInfo:{componentStack:m?.stack??""}});const l=v.ReactMonacoEditor;return(0,t.jsx)(l,{...f,loading:f.loading??null,wrapperProps:{"data-testid":i.Tp.components.ReactMonacoEditor.editorLazy}})},h=f=>({container:(0,n.css)({marginBottom:"unset",marginLeft:f.spacing(1)})})},19716:(k,R,e)=>{"use strict";e.d(R,{q:()=>t});var t=(n=>(n.Method="method",n.Field="field",n.Property="property",n.Constant="constant",n.Text="text",n))(t||{})},99544:(k,R,e)=>{"use strict";e.d(R,{O:()=>n});var t=e(19716);function n(i){const s="${"+i.value+"}",r=i.value===i.label?i.origin:`${i.label} / ${i.origin}`;return{label:s,kind:t.q.Property,detail:r,documentation:i.documentation}}},95247:(k,R,e)=>{"use strict";e.d(R,{d:()=>f});var t=e(74848),n=e(32196),i=e(96540),s=e(13544),r=e(40845),g=e(16797),a=e(14578),c=e(29158),o=e(50720),h=e(15068);const f=(0,i.memo)(({title:p,section:m,parent:v,pageIcon:l,onGoBack:y,children:u,titleHref:D,parentHref:E,leftItems:x,isFullscreen:P,className:b,"aria-label":M,buttonOverflowAlignment:O="right",forceShowLeftItems:I=!1})=>{const T=(0,r.of)(d),C=(0,n.cx)("page-toolbar",T.toolbar,{"page-toolbar--fullscreen":P,[T.noPageIcon]:!l},b),S=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:T.truncateText,children:p}),m&&(0,t.jsxs)("span",{className:T.pre,children:[" / ",m]})]});return(0,t.jsxs)("nav",{className:C,"aria-label":M,children:[(0,t.jsxs)("div",{className:T.leftWrapper,children:[l&&!y&&(0,t.jsx)("div",{className:T.pageIcon,children:(0,t.jsx)(a.I,{name:l,size:"lg","aria-hidden":!0})}),y&&(0,t.jsx)("div",{className:T.pageIcon,children:(0,t.jsx)(c.K,{name:"arrow-left",tooltip:"Go back (Esc)",tooltipPlacement:"bottom",size:"xxl","data-testid":s.Tp.components.BackButton.backArrow,onClick:y})}),(0,t.jsxs)("nav",{"aria-label":"Search links",className:T.navElement,children:[v&&E&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(o.N,{"aria-label":`Search dashboard in the ${v} folder`,className:(0,n.cx)(T.titleText,T.parentLink,T.titleLink,T.truncateText),href:E,children:[v," ",(0,t.jsx)("span",{className:T.parentIcon})]}),D&&(0,t.jsx)("span",{className:(0,n.cx)(T.titleText,T.titleDivider),"aria-hidden":!0,children:"/"})]}),(p||!!x?.length)&&(0,t.jsxs)("div",{className:T.titleWrapper,children:[p&&(0,t.jsx)("h1",{className:T.h1Styles,children:D?(0,t.jsx)(o.N,{"aria-label":"Search dashboard by name",className:(0,n.cx)(T.titleText,T.titleLink),href:D,children:S}):(0,t.jsx)("div",{className:T.titleText,children:S})}),x?.map((A,L)=>(0,t.jsx)("div",{className:(0,n.cx)(T.leftActionItem,{[T.forceShowLeftActionItems]:I}),children:A},L))]})]})]}),(0,t.jsx)(h.U,{alignment:O,children:i.Children.toArray(u).filter(Boolean)})]})});f.displayName="PageToolbar";const d=p=>{const{spacing:m,typography:v}=p,l=(0,g.getFocusStyles)(p);return{pre:(0,n.css)({whiteSpace:"pre"}),toolbar:(0,n.css)({alignItems:"center",background:p.colors.background.canvas,display:"flex",gap:p.spacing(2),justifyContent:"space-between",padding:p.spacing(1.5,2),[p.breakpoints.down("md")]:{paddingLeft:"53px"}}),noPageIcon:(0,n.css)({[p.breakpoints.down("md")]:{paddingLeft:p.spacing(2)}}),leftWrapper:(0,n.css)({display:"flex",flexWrap:"nowrap",maxWidth:"70%"}),pageIcon:(0,n.css)({display:"none",[p.breakpoints.up("sm")]:{display:"flex",paddingRight:p.spacing(1),alignItems:"center"}}),truncateText:(0,n.css)({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}),titleWrapper:(0,n.css)({display:"flex",margin:0,minWidth:0}),navElement:(0,n.css)({display:"flex",alignItems:"center",minWidth:0}),h1Styles:(0,n.css)({margin:m(0,1,0,0),lineHeight:"inherit",flexGrow:1,minWidth:0}),parentIcon:(0,n.css)({marginLeft:p.spacing(.5)}),titleText:(0,n.css)({display:"flex",fontSize:v.size.lg,margin:0,borderRadius:p.shape.radius.default}),titleLink:(0,n.css)({"&:focus-visible":l}),titleDivider:(0,n.css)({padding:m(0,.5,0,.5),display:"none",[p.breakpoints.up("md")]:{display:"unset"}}),parentLink:(0,n.css)({display:"none",[p.breakpoints.up("md")]:{display:"unset",flex:1}}),leftActionItem:(0,n.css)({display:"none",alignItems:"center",paddingRight:m(.5),[p.breakpoints.up("md")]:{display:"flex"}}),forceShowLeftActionItems:(0,n.css)({display:"flex"})}}},19384:(k,R,e)=>{"use strict";e.d(R,{d:()=>a});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(55852),g=e(14578);const a=({currentPage:o,numberOfPages:h,onNavigate:f,hideWhenSinglePage:d,showSmallVersion:p,className:m})=>{const v=(0,s.of)(c),l=p?1:8,y=(0,i.useMemo)(()=>{const u=[...new Array(h).keys()],D=h>l,E=(x,P)=>(0,t.jsx)("li",{className:v.item,children:(0,t.jsx)(r.$n,{size:"sm",variant:P,onClick:()=>f(x),children:x})},x);return u.reduce((x,P)=>{const b=P+1,M=b===o?"primary":"secondary",O=l,I=h-l+1,T=I-O,C=b===1||b===h,S=T>-1&&o>=O&&o<=I,A=p?1:3,L=p?0:2;return D?C||o<O&&b<O||T>=0&&o>I&&b>I||T<0&&o>=O&&b>I||S&&b>=o-L&&b<=o+L?x.push(E(b,M)):(b===O&&o<O||b===I&&o>I||S&&(b===o-A||b===o+A))&&x.push((0,t.jsx)("li",{className:v.item,children:(0,t.jsx)(g.I,{className:v.ellipsis,name:"ellipsis-v"})},b)):x.push(E(b,M)),x},[])},[o,h,f,l,p,v.ellipsis,v.item]);return d&&h<=1?null:(0,t.jsx)("div",{className:(0,n.cx)(v.container,m),children:(0,t.jsxs)("ol",{children:[(0,t.jsx)("li",{className:v.item,children:(0,t.jsx)(r.$n,{"aria-label":"previous page",size:"sm",variant:"secondary",onClick:()=>f(o-1),disabled:o===1,children:(0,t.jsx)(g.I,{name:"angle-left"})})}),y,(0,t.jsx)("li",{className:v.item,children:(0,t.jsx)(r.$n,{"aria-label":"next page",size:"sm",variant:"secondary",onClick:()=>f(o+1),disabled:o===h,children:(0,t.jsx)(g.I,{name:"angle-right"})})})]})})},c=()=>({container:(0,n.css)({float:"right"}),item:(0,n.css)({display:"inline-block",paddingLeft:"10px",marginBottom:"5px"}),ellipsis:(0,n.css)({transform:"rotate(90deg)"})})},89963:(k,R,e)=>{"use strict";e.d(R,{I:()=>a});var t=e(74848),n=e(32196),i=e(13544),s=e(40845),r=e(14578),g=e(56034);const a=({onCancel:h,loading:f})=>{const d=window.matchMedia("(prefers-reduced-motion: reduce)").matches,p=(0,s.of)(o);return f?(0,t.jsx)(g.m,{content:"Cancel query",children:(0,t.jsx)(r.I,{className:(0,n.cx)(p.spin,{[p.clickable]:!!h}),name:d?"hourglass":"sync",size:"sm",onClick:h,"data-testid":i.Tp.components.LoadingIndicator.icon})}):null},c=(0,n.keyframes)({"0%":{transform:"rotate(0deg) scaleX(-1)"},"100%":{transform:"rotate(359deg) scaleX(-1)"}}),o=h=>({clickable:(0,n.css)({cursor:"pointer"}),spin:(0,n.css)({[h.transitions.handleMotion("no-preference")]:{animation:`${c} 3s linear infinite`}})})},79041:(k,R,e)=>{"use strict";e.d(R,{XF:()=>s,d2:()=>r,e4:()=>i});var t=e(96540),n=e(18226);const i=(0,t.createContext)({eventsScope:"global",eventBus:new n.o}),s=i.Provider,r=()=>(0,t.useContext)(i)},91052:(k,R,e)=>{"use strict";e.d(R,{NR:()=>F});var t=e(89963),n=e(74848),i=e(32196),s=e(96540),r=e(42941),g=e(49185),a=e(39070),c=e(13544),o=e(40845),h=e(16797);function f({children:w,delay:B}){const[U,K]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{window.setTimeout(()=>{K(!0)},B)},[w,B]),(0,n.jsx)(n.Fragment,{children:U?w:null})}var d=e(14578),p=e(57514),m=e(94753),v=e(56034),l=e(83122),y=e(27746);function u({menu:w,title:B,placement:U="bottom",offset:K,dragClassCancel:V,menuButtonClass:H,onOpenMenu:Y}){const X=B?c.Tp.components.Panels.Panel.menu(B):"panel-menu-button",J=(0,s.useCallback)(q=>{q&&Y&&Y()},[Y]);return(0,n.jsx)(l.m,{overlay:w,placement:U,offset:K,onVisibleChange:J,children:(0,n.jsx)(y.I,{"aria-label":`Menu for panel with ${B?`title ${B}`:"no title"}`,title:"Menu",icon:"ellipsis-v",iconSize:"md",narrow:!0,"data-testid":X,className:(0,i.cx)(H,V)})})}function D({menu:w,title:B,dragClass:U,children:K,offset:V=-32,onOpenMenu:H}){const Y=(0,o.of)(E),X=(0,s.useRef)(null),J=c.Tp.components.Panels.Panel.HoverWidget,q=(0,s.useCallback)(j=>{X.current?.setPointerCapture(j.pointerId)},[]),ae=(0,s.useCallback)(j=>{X.current?.releasePointerCapture(j.pointerId)},[]);return K===void 0||s.Children.count(K)===0?null:(0,n.jsxs)("div",{className:(0,i.cx)(Y.container,"show-on-hover"),style:{top:V},"data-testid":J.container,children:[U&&(0,n.jsx)("div",{className:(0,i.cx)(Y.square,Y.draggable,U),onPointerDown:q,onPointerUp:ae,ref:X,"data-testid":J.dragIcon,children:(0,n.jsx)(d.I,{name:"expand-arrows",className:Y.draggableIcon})}),K,w&&(0,n.jsx)(u,{menu:w,title:B,placement:"bottom",menuButtonClass:Y.menuButton,onOpenMenu:H})]})}function E(w){return{container:(0,i.css)({label:"hover-container-widget",[w.transitions.handleMotion("no-preference","reduce")]:{transition:"all .1s linear"},display:"flex",position:"absolute",zIndex:1,right:0,boxSizing:"content-box",alignItems:"center",background:w.colors.background.secondary,color:w.colors.text.primary,border:`1px solid ${w.colors.border.weak}`,borderRadius:w.shape.radius.default,height:w.spacing(4),boxShadow:w.shadows.z1}),square:(0,i.css)({display:"flex",justifyContent:"center",alignItems:"center",width:w.spacing(4),height:"100%"}),draggable:(0,i.css)({cursor:"move",[w.breakpoints.down("md")]:{display:"none"}}),menuButton:(0,i.css)({background:"inherit",border:"none","&:hover":{background:w.colors.secondary.main}}),draggableIcon:(0,i.css)({transform:"rotate(45deg)",color:w.colors.text.secondary,"&:hover":{color:w.colors.text.primary}})}}var x=e(55852);const P=(0,s.forwardRef)(({className:w,children:B,href:U,onClick:K,target:V,title:H,...Y},X)=>{const J=(0,o.of)(b);return U?(0,n.jsx)("a",{ref:X,href:U,onClick:K,target:V,title:H,className:(0,i.cx)(J.linkItem,w),...Y,children:B}):K?(0,n.jsx)(x.$n,{ref:X,className:(0,i.cx)(J.item,w),variant:"secondary",fill:"text",onClick:K,children:B}):(0,n.jsx)("span",{ref:X,className:(0,i.cx)(J.item,w),...Y,children:B})});P.displayName="TitleItem";const b=w=>{const B=(0,i.css)({color:`${w.colors.text.secondary}`,label:"panel-header-item",cursor:"auto",border:"none",borderRadius:`${w.shape.radius.default}`,padding:`${w.spacing(0,1)}`,height:`${w.spacing(w.components.panel.headerHeight)}`,display:"flex",alignItems:"center",justifyContent:"center","&:focus, &:focus-visible":{...(0,h.getFocusStyles)(w),zIndex:1},"&: focus:not(:focus-visible)":(0,h.getMouseFocusStyles)(w),"&:hover ":{boxShadow:`${w.shadows.z1}`,background:`${w.colors.background.secondary}`,color:`${w.colors.text.primary}`}});return{item:B,linkItem:(0,i.cx)(B,(0,i.css)({cursor:"pointer"}))}};function M({description:w,className:B}){const U=(0,o.of)(O),K=()=>{const V=typeof w=="function"?w():w;return(0,n.jsx)("div",{className:"panel-info-content markdown-html",children:(0,n.jsx)("div",{dangerouslySetInnerHTML:{__html:V}})})};return w!==""?(0,n.jsx)(v.m,{interactive:!0,content:K,children:(0,n.jsx)(P,{className:(0,i.cx)(B,U.description),children:(0,n.jsx)(d.I,{name:"info-circle",size:"md"})})}):null}const O=w=>({description:(0,i.css)({code:{whiteSpace:"normal",wordWrap:"break-word"},"pre > code":{display:"block"}})});function I({message:w,onClick:B,ariaLabel:U="status"}){const K=(0,o.of)(T);return(0,n.jsx)(y.I,{className:K.buttonStyles,onClick:B,variant:"destructive",icon:"exclamation-triangle",iconSize:"md",tooltip:w||"","aria-label":U,"data-testid":c.Tp.components.Panels.Panel.status("error")})}const T=w=>{const{headerHeight:B,padding:U}=w.components.panel;return{buttonStyles:(0,i.css)({label:"panel-header-state-button",display:"flex",alignItems:"center",justifyContent:"center",padding:w.spacing(U),width:w.spacing(B),height:w.spacing(B),borderRadius:w.shape.radius.default})}};function C({width:w,height:B,children:U,padding:K="md",title:V="",description:H="",displayMode:Y="default",titleItems:X,menu:J,dragClass:q,dragClassCancel:ae,hoverHeader:j=!1,hoverHeaderOffset:te,loadingState:ne,statusMessage:le,statusMessageOnClick:z,leftItems:ee,actions:se,onCancelQuery:ie,onOpenMenu:Z,collapsible:oe=!1,collapsed:ce,onToggleCollapse:ye,onFocus:re,onMouseMove:ue,onMouseEnter:De}){const ge=(0,o.$j)(),Te=(0,o.of)(N),Le=(0,s.useId)(),Ye=(0,s.useId)().replace(/:/g,"_"),je=!j,[Ze,Ne]=(0,r.A)(!0);ce===void 0&&(ce=!Ze);const Pe="show-on-hover",Ue=Y==="transparent",$e=A(ge,je),{contentStyle:ze,innerWidth:qe,innerHeight:dt}=L(K,ge,$e,ce,B,w),vt={height:$e,cursor:q?"move":"auto"},yt={width:w,height:ce?void 0:B},[st,{width:Ve}]=(0,g.A)();ee&&(se=ee);const pe=typeof V=="string"?c.Tp.components.Panels.Panel.title(V):"Panel",Ee=(0,n.jsxs)(n.Fragment,{children:[!oe&&V&&(0,n.jsx)("div",{className:Te.title,children:(0,n.jsx)(m.E,{element:"h2",variant:"h6",truncate:!0,title:typeof V=="string"?V:void 0,id:Ye,children:V})}),oe&&(0,n.jsx)("div",{className:Te.title,children:(0,n.jsx)(m.E,{element:"h2",variant:"h6",children:(0,n.jsxs)("button",{type:"button",className:Te.clearButtonStyles,onClick:()=>{Ne(),ye&&ye(!ce)},"aria-expanded":!ce,"aria-controls":ce?void 0:Le,children:[(0,n.jsx)(d.I,{name:ce?"angle-right":"angle-down","aria-hidden":!!V,"aria-label":V?void 0:"toggle collapse panel"}),(0,n.jsx)(m.E,{variant:"h6",truncate:!0,id:Ye,children:V})]})})}),(0,n.jsxs)("div",{className:(0,i.cx)(Te.titleItems,ae),"data-testid":"title-items-container",children:[(0,n.jsx)(M,{description:H,className:ae}),X]}),ne===a.Gu.Streaming&&(0,n.jsx)(v.m,{content:ie?"Stop streaming":"Streaming",children:(0,n.jsx)(P,{className:ae,"data-testid":"panel-streaming",onClick:ie,children:(0,n.jsx)(d.I,{name:"circle-mono",size:"md",className:Te.streaming})})}),ne===a.Gu.Loading&&ie&&(0,n.jsx)(f,{delay:2e3,children:(0,n.jsx)(v.m,{content:"Cancel query",children:(0,n.jsx)(P,{className:(0,i.cx)(ae,Te.pointer),"data-testid":"panel-cancel-query",onClick:ie,children:(0,n.jsx)(d.I,{name:"sync-slash",size:"md"})})})}),(0,n.jsx)("div",{className:Te.rightAligned,children:se&&(0,n.jsx)("div",{className:Te.rightActions,children:S(se,me=>me)})})]});return(0,n.jsxs)("section",{className:(0,i.cx)(Te.container,{[Te.transparentContainer]:Ue}),style:yt,"aria-labelledby":V?Ye:void 0,"data-testid":pe,tabIndex:0,onFocus:re,onMouseMove:ue,onMouseEnter:De,ref:st,children:[(0,n.jsx)("div",{className:Te.loadingBarContainer,children:ne===a.Gu.Loading?(0,n.jsx)(p.G,{width:Ve,ariaLabel:"Panel loading bar"}):null}),j&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(D,{menu:J,title:typeof V=="string"?V:void 0,offset:te,dragClass:q,onOpenMenu:Z,children:Ee}),le&&(0,n.jsx)("div",{className:Te.errorContainerFloating,children:(0,n.jsx)(I,{message:le,onClick:z,ariaLabel:"Panel status"})})]}),je&&(0,n.jsxs)("div",{className:(0,i.cx)(Te.headerContainer,q),style:vt,"data-testid":"header-container",children:[le&&(0,n.jsx)("div",{className:ae,children:(0,n.jsx)(I,{message:le,onClick:z,ariaLabel:"Panel status"})}),Ee,J&&(0,n.jsx)(u,{menu:J,title:typeof V=="string"?V:void 0,placement:"bottom-end",menuButtonClass:(0,i.cx)(Te.menuItem,ae,Pe),onOpenMenu:Z})]}),!ce&&(0,n.jsx)("div",{id:Le,"data-testid":c.Tp.components.Panels.Panel.content,className:(0,i.cx)(Te.content,B===void 0&&Te.containNone),style:ze,children:typeof U=="function"?U(qe,dt):U})]})}const S=(w,B)=>{const U=s.Children.toArray(w).filter(Boolean);return U.length>0?B(U):null},A=(w,B)=>B?w.spacing.gridSize*w.components.panel.headerHeight:0,L=(w,B,U,K,V,H)=>{const Y=(w==="md"?B.components.panel.padding:0)*B.spacing.gridSize,X=Y*2,J=1*2;let q=0;H&&(q=H-X-J);let ae=0;return V&&(ae=V-U-X-J),K&&(ae=U),{contentStyle:{padding:Y},innerWidth:q,innerHeight:ae}},N=w=>{const{background:B,borderColor:U,padding:K}=w.components.panel;return{container:(0,i.css)({label:"panel-container",backgroundColor:B,border:`1px solid ${U}`,position:"relative",borderRadius:w.shape.radius.default,height:"100%",display:"flex",flexDirection:"column",".show-on-hover":{opacity:"0",visibility:"hidden"},"&:focus-visible, &:hover":{".show-on-hover":{opacity:"1",visibility:"visible"}},"&:focus-visible":(0,h.getFocusStyles)(w),"&:focus-within:not(:focus)":{".show-on-hover":{visibility:"visible",opacity:"1"}}}),transparentContainer:(0,i.css)({label:"panel-transparent-container",backgroundColor:"transparent",border:"1px solid transparent",boxSizing:"border-box","&:hover":{border:`1px solid ${U}`}}),loadingBarContainer:(0,i.css)({label:"panel-loading-bar-container",position:"absolute",top:0,width:"100%",zIndex:1}),containNone:(0,i.css)({contain:"none"}),content:(0,i.css)({label:"panel-content",flexGrow:1,contain:"size layout"}),headerContainer:(0,i.css)({label:"panel-header",display:"flex",alignItems:"center"}),pointer:(0,i.css)({cursor:"pointer"}),streaming:(0,i.css)({label:"panel-streaming",marginRight:0,color:w.colors.success.text,"&:hover":{color:w.colors.success.text}}),title:(0,i.css)({label:"panel-title",display:"flex",padding:w.spacing(0,K),minWidth:0,"& > h2":{minWidth:0}}),items:(0,i.css)({display:"flex"}),item:(0,i.css)({display:"flex",justifyContent:"center",alignItems:"center"}),hiddenMenu:(0,i.css)({visibility:"hidden"}),menuItem:(0,i.css)({label:"panel-menu",border:"none",background:w.colors.secondary.main,"&:hover":{background:w.colors.secondary.shade}}),errorContainerFloating:(0,i.css)({label:"error-container",position:"absolute",left:0,top:0,zIndex:1}),rightActions:(0,i.css)({display:"flex",padding:w.spacing(0,K),gap:w.spacing(1)}),rightAligned:(0,i.css)({label:"right-aligned-container",marginLeft:"auto",display:"flex",alignItems:"center"}),titleItems:(0,i.css)({display:"flex",height:"100%"}),clearButtonStyles:(0,i.css)({alignItems:"center",display:"flex",gap:w.spacing(.5),background:"transparent",border:"none",padding:0,maxWidth:"100%"})}},F=C;F.LoadingIndicator=t.I,F.TitleItem=P},88895:(k,R,e)=>{"use strict";e.d(R,{B:()=>t});var t=(n=>(n.ToggleSelection="select",n.AppendToSelection="append",n))(t||{})},52494:(k,R,e)=>{"use strict";e.d(R,{_:()=>s});var t=e(74848),n=e(32196),i=e(40845);const s=({children:g,className:a,...c})=>{const o=(0,i.of)(r);return(0,t.jsx)("div",{className:(0,n.cx)(o,a),...c,children:g})},r=g=>(0,n.css)({backgroundColor:g.components.panel.background,border:`1px solid ${g.components.panel.borderColor}`,borderRadius:g.shape.radius.default})},98624:(k,R,e)=>{"use strict";e.d(R,{B:()=>s});var t=e(74848),n=e(43429),i=e(39938);const s=({status:g,color:a,...c})=>{const o=r(g);return(0,t.jsx)(i.E,{text:o.text,color:o.color,icon:o.icon,tooltip:o.tooltip,...c})};s.displayName="PluginSignatureBadge";function r(g){switch(g||(g=n.Ac.invalid),g){case n.Ac.internal:return{text:"Core",color:"blue",tooltip:"Core plugin that is bundled with Grafana"};case n.Ac.valid:return{text:"Signed",icon:"lock",color:"green",tooltip:"Signed and verified plugin"};case n.Ac.invalid:return{text:"Invalid signature",icon:"exclamation-triangle",color:"red",tooltip:"Invalid plugin signature"};case n.Ac.modified:return{text:"Modified signature",icon:"exclamation-triangle",color:"red",tooltip:"Valid signature but content has been modified"};case n.Ac.missing:return{text:"Missing signature",icon:"exclamation-triangle",color:"red",tooltip:"Missing plugin signature"};default:return{text:"Unsigned",icon:"exclamation-triangle",color:"red",tooltip:"Unsigned external plugin"}}}},17464:(k,R,e)=>{"use strict";e.d(R,{ZL:()=>g,gF:()=>a,qB:()=>c});var t=e(74848),n=e(32196),i=e(96540),s=e(40961),r=e(40845);function g(f){const{children:d,className:p,root:m,forwardedRef:v}=f,l=(0,r.$j)(),y=(0,i.useRef)(null),u=m??a();return y.current||(y.current=document.createElement("div"),p&&(y.current.className=p),y.current.style.position="relative",y.current.style.zIndex=`${l.zIndex.portal}`),(0,i.useLayoutEffect)(()=>(y.current&&u.appendChild(y.current),()=>{y.current&&u.removeChild(y.current)}),[u]),s.createPortal((0,t.jsx)("div",{ref:v,children:d}),y.current)}function a(){return window.document.getElementById("grafana-portal-container")??document.body}function c(){const f=(0,r.of)(o),d=window.grafanaBootData?.settings.featureToggles.bodyScrolling;return(0,t.jsx)("div",{id:"grafana-portal-container",className:(0,n.cx)({[f.grafanaPortalContainer]:d})})}const o=f=>({grafanaPortalContainer:(0,n.css)({position:"fixed",top:0,width:"100%",zIndex:f.zIndex.portal})}),h=i.forwardRef((f,d)=>(0,t.jsx)(g,{...f,forwardedRef:d}));h.displayName="RefForwardingPortal"},20084:(k,R,e)=>{"use strict";e.d(R,{X:()=>P});var t=e(74848),n=e(32196),i=e(46942),s=e.n(i),r=e(2543),g=e.n(r),a=e(96540),c=e(75226),o=e(29317),h=e(13544),f=e(80903),d=e(4269),p=e(88295),m=e(74738),v=e(31589),l=e(1020),y=e(99453),u=e(40845),D=e(16797),E=e(72307);class x extends a.PureComponent{constructor(O){super(O),this.lastExecutedValue=null,this.mounted=!1,this.editor=null,this.onChange=(A,L)=>{const N=A.document!==this.state.value.document,F=this.state.value;this.props.onRichValueChange&&this.props.onRichValueChange(A),this.setState({value:A},()=>{if(N){const w=c.A.serialize(F)!==c.A.serialize(A);w&&L&&this.runOnChangeAndRunQuery(),w&&!L&&this.runOnChangeDebounced()}})},this.runOnChange=()=>{const{onChange:A}=this.props,L=c.A.serialize(this.state.value);A&&A(this.cleanText(L))},this.runOnRunQuery=()=>{const{onRunQuery:A}=this.props;A&&(A(),this.lastExecutedValue=this.state.value)},this.runOnChangeAndRunQuery=()=>{this.runOnChange(),this.runOnRunQuery()},this.handleBlur=(A,L,N)=>{const{onBlur:F}=this.props;if(F)F();else{const w=this.lastExecutedValue?c.A.serialize(this.lastExecutedValue):"",B=c.A.serialize(L.value);w!==B&&this.runOnChangeAndRunQuery()}return N()},this.runOnChangeDebounced=(0,r.debounce)(this.runOnChange,500);const{onTypeahead:I,cleanText:T,portalOrigin:C,onWillApplySuggestion:S}=O;this.plugins=[(0,f.Pz)({onTypeahead:I,cleanText:T,portalOrigin:C,onWillApplySuggestion:S}),(0,d.U)({handler:this.runOnChangeAndRunQuery}),(0,p.O)(),(0,m.v)(),(0,v.l)(),(0,l.T)(),(0,y.s)(),...O.additionalPlugins||[]].filter(A=>A),this.state={suggestions:[],typeaheadContext:null,typeaheadPrefix:"",typeaheadText:"",value:(0,E.mO)(O.query||"",O.syntax)}}static{this.defaultProps={onBlur:()=>{}}}componentDidMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}componentDidUpdate(O,I){const{query:T,syntax:C,syntaxLoaded:S}=this.props;if(!O.syntaxLoaded&&S&&this.editor){const L=this.editor.insertText(" ").deleteBackward(1);this.onChange(L.value,!0)}const{value:A}=this.state;T!==O.query&&T!==c.A.serialize(A)&&this.setState({value:(0,E.mO)(T||"",C)})}cleanText(O){return O.replace(/[\r]/g,"")}render(){const{disabled:O,theme:I}=this.props,T=s()("slate-query-field__wrapper",{"slate-query-field__wrapper--disabled":O}),C=b(I);return(0,t.jsx)("div",{className:(0,n.cx)(T,C.wrapper),children:(0,t.jsx)("div",{className:"slate-query-field","data-testid":h.Tp.components.QueryField.container,children:(0,t.jsx)(o.KE,{ref:S=>this.editor=S,schema:E.yx,autoCorrect:!1,readOnly:this.props.disabled,onBlur:this.handleBlur,onClick:this.props.onClick,onChange:S=>{this.onChange(S.value,!1)},placeholder:this.props.placeholder,plugins:this.plugins,spellCheck:!1,value:this.state.value})})})}}const P=(0,u.cV)(x),b=M=>{const O=(0,D.getFocusStyles)(M);return{wrapper:(0,n.css)({"&:focus-within":O})}}},11134:(k,R,e)=>{"use strict";e.d(R,{cC:()=>f,cb:()=>h});var t=e(74848),n=e(91e3),i=e(96540),s=e(70416),r=e(13544),g=e(76412),a=e(19727),c=e(9261),o=e(27746);const h=["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"];class f extends i.PureComponent{constructor(v){super(v),this.onChangeSelect=l=>{const{onIntervalChanged:y}=this.props;y&&l.value!=null&&y(l.value)}}static{this.offOption={label:"Off",value:"",ariaLabel:"Turn off auto refresh"}}static{this.liveOption={label:"Live",value:"LIVE",ariaLabel:"Turn on live streaming"}}static{this.autoOption={label:"Auto",value:"auto",ariaLabel:"Select refresh from the query range"}}static{this.isLive=v=>v===f.liveOption.value}getVariant(){return this.props.isLive||this.props.primary?"primary":this.props.isOnCanvas?"canvas":"default"}render(){const{onRefresh:v,intervals:l,tooltip:y,value:u,text:D,isLoading:E,noIntervalPicker:x,width:P,showAutoInterval:b}=this.props,M=u||"",O=this.getVariant(),I=p({intervals:l,showAutoInterval:b}),T=I.find(({value:K})=>K===M),C=d(f.offOption.value);let S=T||C;S.label===C.label&&(S={value:""});const A=S.ariaLabel,L=(0,g.t)("refresh-picker.aria-label.duration-selected","Choose refresh time interval with current interval {{durationAriaLabel}} selected",{durationAriaLabel:A}),N=(0,g.t)("refresh-picker.aria-label.choose-interval","Auto refresh turned off. Choose refresh time interval"),F=S.value===""?N:L,w=(0,g.t)("refresh-picker.tooltip.interval-selected","Set auto refresh interval"),B=(0,g.t)("refresh-picker.tooltip.turned-off","Auto refresh off"),U=S.value===""?B:w;return(0,t.jsxs)(a.e,{className:"refresh-picker",children:[(0,t.jsx)(o.I,{"aria-label":D,tooltip:y,onClick:v,variant:O,icon:E?"spinner":"sync",style:P?{width:P}:void 0,"data-testid":r.Tp.components.RefreshPicker.runButtonV2,children:D}),!x&&(0,t.jsx)(c.f,{value:S,options:I,onChange:this.onChangeSelect,variant:O,"data-testid":r.Tp.components.RefreshPicker.intervalButtonV2,"aria-label":F,tooltip:U})]})}}function d(m){switch(m){case f.liveOption.value:return{label:(0,g.t)("refresh-picker.live-option.label","Live"),value:m,ariaLabel:(0,g.t)("refresh-picker.live-option.aria-label","Turn on live streaming")};case f.offOption.value:return{label:(0,g.t)("refresh-picker.off-option.label","Off"),value:m,ariaLabel:(0,g.t)("refresh-picker.off-option.aria-label","Turn off auto refresh")};case f.autoOption.value:return{label:(0,g.t)("refresh-picker.auto-option.label",f.autoOption.label),value:m,ariaLabel:(0,g.t)("refresh-picker.auto-option.aria-label",f.autoOption.ariaLabel)}}return{label:m,value:m}}function p({intervals:m=h,showAutoInterval:v=!1}={}){const l=m.map(y=>{const u=(0,s.E9)(y),D=(0,n.a)(u);return{label:y,value:y,ariaLabel:D}});return v&&l.unshift(d(f.autoOption.value)),l.unshift(d(f.offOption.value)),l}},44522:(k,R,e)=>{"use strict";e.d(R,{I:()=>i});var t=e(96540),n=e(80997);function i({component:s,content:r,...g}){return t.createElement(s||"span",{dangerouslySetInnerHTML:{__html:n.sQ.sanitize(r)},...g})}},56286:(k,R,e)=>{"use strict";e.d(R,{L:()=>c});var t=e(74848),n=e(32196),i=e(2543),s=e.n(i),r=e(55852),g=e(90090);const a=()=>({noRadiusInput:(0,n.css)({borderBottomRightRadius:"0 !important",borderTopRightRadius:"0 !important"}),noRadiusButton:(0,n.css)({borderBottomLeftRadius:"0 !important",borderTopLeftRadius:"0 !important"})}),c=({label:o="Password",labelWidth:h,inputWidth:f=12,onReset:d,isConfigured:p,tooltip:m,placeholder:v="Password",interactive:l,...y})=>{const u=a();return(0,t.jsx)(g.z,{label:o,tooltip:m,interactive:l,labelWidth:h,inputEl:p?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("input",{type:"text",className:(0,n.cx)(`gf-form-input width-${f}`,u.noRadiusInput),disabled:!0,value:"configured",...(0,i.omit)(y,"value")}),(0,t.jsx)(r.$n,{onClick:d,variant:"secondary",type:"button",children:"Reset"})]}):(0,t.jsx)("input",{type:"password",className:`gf-form-input width-${f}`,placeholder:v,...y})})};c.displayName="SecretFormField"},9226:(k,R,e)=>{"use strict";e.d(R,{L4:()=>a});var t=e(74848),n=e(55852),i=e(10354),s=e(67061);const r="configured",g="Reset",a=({isConfigured:c,onReset:o,...h})=>(0,t.jsxs)(s.B,{children:[!c&&(0,t.jsx)(i.p,{...h,type:"password"}),c&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.p,{...h,type:"text",disabled:!0,value:r}),(0,t.jsx)(n.$n,{onClick:o,variant:"secondary",children:g})]})]})},49718:(k,R,e)=>{"use strict";e.d(R,{L:()=>t.L4});var t=e(9226)},58724:(k,R,e)=>{"use strict";e.d(R,{lp:()=>f});var t=e(74848),n=e(32196),i=e(40845),s=e(55852),r=e(90613),g=e(67061),a=e(21744);const c="configured",o="Reset",h=d=>({configuredStyle:(0,n.css)({minHeight:d.spacing(d.components.height.md),paddingTop:d.spacing(.5),resize:"none"})}),f=({isConfigured:d,onReset:p,...m})=>{const v=(0,i.of)(h);return(0,t.jsxs)(g.B,{children:[(0,t.jsxs)(r.a,{children:[!d&&(0,t.jsx)(a.f,{...m}),d&&(0,t.jsx)(a.f,{...m,rows:1,disabled:!0,value:c,className:(0,n.cx)(v.configuredStyle)})]}),d&&(0,t.jsx)(s.$n,{onClick:p,variant:"secondary",children:o})]})}},7968:(k,R,e)=>{"use strict";e.d(R,{l:()=>t.lp});var t=e(58724)},38401:(k,R,e)=>{"use strict";e.d(R,{Y:()=>h});var t=e(74848),n=e(32196),i=e(2543),s=e.n(i),r=e(40845),g=e(76892),a=e(13102),c=e(86997),o=e(2336);function h({options:f,value:d,onChange:p,Component:m,className:v,allowCustomValue:l,allowEmptyValue:y,placeholder:u,disabled:D,inputMinWidth:E,inputPlaceholder:x,onExpandedChange:P,autofocus:b=!1,...M}){const[O,I,T,C]=(0,o.Q)(b,P),S=E?Math.max(E,I):I,A=(0,r.of)(c.m);if(!T){const L=(0,i.isObject)(d)?d.label:d,N=L!=null?String(L):void 0;return(0,t.jsx)(O,{disabled:D,Component:m||(0,t.jsx)(g.c,{className:(0,n.cx)(A.segment,{[A.queryPlaceholder]:u!==void 0&&!d,[A.disabled]:D},v),children:N||u})})}return(0,t.jsx)(a.a,{...M,value:d&&!(0,i.isObject)(d)?{value:d}:d,placeholder:x,options:f,width:S,onClickOutside:()=>C(!1),allowCustomValue:l,allowEmptyValue:y,onChange:L=>{C(!1),p(L)}})}},83684:(k,R,e)=>{"use strict";e.d(R,{s:()=>d});var t=e(74848),n=e(32196),i=e(2543),s=e.n(i),r=e(41053),g=e(40845),a=e(76412),c=e(76892),o=e(13102),h=e(86997),f=e(2336);function d({value:m,onChange:v,loadOptions:l,reloadOptionsOnChange:y=!1,Component:u,className:D,allowCustomValue:E,allowEmptyValue:x,disabled:P,placeholder:b,inputMinWidth:M,inputPlaceholder:O,autofocus:I=!1,onExpandedChange:T,noOptionMessageHandler:C=p,...S}){const[A,L]=(0,r.A)(l,[l]),[N,F,w,B]=(0,f.Q)(I,T),U=M?Math.max(M,F):F,K=(0,g.of)(h.m);if(!w){const V=(0,i.isObject)(m)?m.label:m,H=V!=null?String(V):void 0;return(0,t.jsx)(N,{onClick:y?void 0:L,disabled:P,Component:u||(0,t.jsx)(c.c,{className:(0,n.cx)(K.segment,{[K.queryPlaceholder]:b!==void 0&&!m,[K.disabled]:P},D),children:H||b})})}return(0,t.jsx)(o.a,{...S,value:m&&!(0,i.isObject)(m)?{value:m}:m,placeholder:O,options:A.value??[],loadOptions:y?L:void 0,width:U,noOptionsMessage:C(A),allowCustomValue:E,allowEmptyValue:x,onClickOutside:()=>{B(!1)},onChange:V=>{B(!1),v(V)}})}function p(m){return m.loading?(0,a.t)("grafana-ui.segment-async.loading","Loading options..."):m.error?(0,a.t)("grafana-ui.segment-async.error","Failed to load options"):(0,a.t)("grafana-ui.segment-async.no-options","No options found")}},57752:(k,R,e)=>{"use strict";e.d(R,{o:()=>f});var t=e(74848),n=e(32196),i=e(96540),s=e(37151),r=e(40845),g=e(29413),a=e(76892),c=e(86997),o=e(2336);const h=14;function f({value:d,onChange:p,Component:m,className:v,placeholder:l,inputPlaceholder:y,disabled:u,autofocus:D=!1,onExpandedChange:E,...x}){const P=(0,i.useRef)(null),[b,M]=(0,i.useState)(d),[O,I]=(0,i.useState)((0,g.kD)((d||"").toString(),h).width),[T,,C,S]=(0,o.Q)(D,E),A=(0,r.of)(c.m);if((0,s.A)(P,()=>{S(!1),p(b)}),!C)return(0,t.jsx)(T,{disabled:u,Component:m||(0,t.jsx)(a.c,{className:(0,n.cx)(A.segment,{[A.queryPlaceholder]:l!==void 0&&!b,[A.disabled]:u},v),children:d||l})});const L=(0,n.css)({width:`${Math.max(O+20,32)}px`});return(0,t.jsx)("input",{...x,ref:P,autoFocus:!0,className:(0,n.cx)("gf-form gf-form-input",L),value:b,placeholder:y,onChange:N=>{const{width:F}=(0,g.kD)(N.target.value,h);I(F),M(N.target.value)},onBlur:()=>{S(!1),p(b)},onKeyDown:N=>{[13,27].includes(N.keyCode)&&(S(!1),p(b))}})}},64765:(k,R,e)=>{"use strict";e.d(R,{L:()=>g});var t=e(74848),n=e(32196),i=e(40845),s=e(39268),r=e(76892);const g=({label:c,htmlFor:o,children:h,fill:f})=>{const d=(0,i.of)(a);return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(s.C,{children:[(0,t.jsx)(r.c,{htmlFor:o,width:12,className:d.label,children:c}),h,f&&(0,t.jsx)("div",{className:d.fill,children:(0,t.jsx)(r.c,{children:""})})]})})},a=c=>({label:(0,n.css)({color:c.colors.primary.text}),fill:(0,n.css)({flexGrow:1,marginBottom:c.spacing(.5)})})},13102:(k,R,e)=>{"use strict";e.d(R,{a:()=>r});var t=e(74848),n=e(96540),i=e(40845),s=e(90182);function r({value:g,placeholder:a="",options:c=[],onChange:o,onClickOutside:h,loadOptions:f=void 0,width:d,noOptionsMessage:p="",allowCustomValue:m=!1,allowEmptyValue:v=!1,...l}){const y=(0,n.useRef)(null),u=(0,i.$j)();let D=d>0?d/u.spacing.gridSize:void 0,E,x={};return f?(E=s.DW,x={loadOptions:f,defaultOptions:!0}):E=s.l6,(0,t.jsx)("div",{...l,ref:y,children:(0,t.jsx)(E,{width:D,noOptionsMessage:p,placeholder:a,autoFocus:!0,isOpen:!0,onChange:o,options:c,value:g,closeMenuOnSelect:!1,onCloseMenu:()=>{if(y&&y.current){const P=y.current.querySelector('input[id^="react-select-"]');P&&(P.value||v)?o({value:P.value,label:P.value}):h()}},allowCustomValue:m,...x})})}},86997:(k,R,e)=>{"use strict";e.d(R,{m:()=>n});var t=e(32196);const n=i=>{const s="v1"in i?i.v1.palette:i.palette;return{segment:(0,t.css)({cursor:"pointer",width:"auto"}),queryPlaceholder:(0,t.css)({color:s.gray2}),disabled:(0,t.css)({cursor:"not-allowed",opacity:.65,boxShadow:"none"})}}},2336:(k,R,e)=>{"use strict";e.d(R,{Q:()=>r});var t=e(74848),n=e(96540),i=e(40845),s=e(55852);const r=(g,a)=>{const c=(0,n.useRef)(null),o=(0,i.of)(s.my),[h,f]=(0,n.useState)(g),[d,p]=(0,n.useState)(0),m=l=>{f(l),a&&a(l)};return[({Component:l,onClick:y,disabled:u})=>(0,t.jsx)("button",{type:"button",className:o,ref:c,disabled:u,onClick:()=>{m(!0),c&&c.current&&p(c.current.clientWidth*1.25),y?.()},children:l}),d,h,m]}},5342:(k,R,e)=>{"use strict";e.d(R,{O:()=>r,p:()=>g});var t=e(74848),n=e(40845),i=e(29158),s=e(88824);const r=({innerProps:a,children:c})=>{const o=(0,n.$j)(),h=(0,s.J)(o);return(0,t.jsx)("div",{...a,className:h.multiValueContainer,children:c})},g=({children:a,innerProps:c})=>{const o=(0,n.$j)(),h=(0,s.J)(o);return(0,t.jsx)(i.K,{...c,name:"times",size:"sm",className:h.multiValueRemove,tooltip:"Remove"})}},90182:(k,R,e)=>{"use strict";e.d(R,{Iv:()=>j,DW:()=>J,gZ:()=>ae,KF:()=>X,l6:()=>Y,KA:()=>P.K,ip:()=>q});var t=e(74848),n=e(72635),i=e(96540),s=e(46005),r=e(8539),g=e(93943),a=e(66963),c=e(50877),o=e(40845),h=e(14578),f=e(62930),d=e(28581);const p=te=>{let ne;return"data-testid"in te.selectProps&&te.selectProps["data-testid"]&&(ne=te.selectProps["data-testid"]+"-input"),(0,t.jsx)(d.c.Input,{...te,"data-testid":ne})};function m({selectProps:te}){const ne=te.menuIsOpen,le=ne?"search":"angle-down",z=ne?"sm":"md";return(0,t.jsx)(h.I,{name:le,size:z})}var v=e(32196),l=e(10354);const y=(0,i.forwardRef)((te,ne)=>{const{children:le}=te,z=(0,o.$j)(),ee=(0,l.n)({theme:z,invalid:!1});return(0,t.jsx)("div",{className:(0,v.cx)(ee.suffix,(0,v.css)({position:"relative"})),ref:ne,children:le})});y.displayName="IndicatorsContainer";var u=e(87266);const D=(0,i.forwardRef)(function({focused:ne,invalid:le,disabled:z,children:ee,innerProps:se,prefix:ie,...Z},oe){const ce=(0,o.of)(E,le,!!ie);return(0,t.jsxs)("div",{className:ce.input,...se,ref:oe,children:[ie&&(0,t.jsx)("div",{className:(0,v.cx)(ce.prefix),children:ie}),ee]})}),E=(te,ne,le)=>{const z=(0,l.n)({theme:te,invalid:ne});return{input:(0,v.cx)((0,u.g$)(te),(0,v.css)({width:"100%",maxWidth:"100%",display:"flex",flexDirection:"row",alignItems:"center",flexWrap:"wrap",justifyContent:"space-between",paddingRight:0,position:"relative",boxSizing:"border-box"}),le&&(0,v.css)({paddingLeft:0})),prefix:(0,v.cx)(z.prefix,(0,v.css)({position:"relative"}))}};var x=e(5342),P=e(4603),b=e(12681),M=e(88824);const O=({children:te,cx:ne,getClassNames:le,getStyles:z,Heading:ee,headingProps:se,label:ie,selectProps:Z,theme:oe})=>{const ce=(0,o.of)(M.J);return(0,t.jsxs)("div",{className:ce.group,children:[(0,t.jsx)(ee,{cx:ne,getClassNames:le,getStyles:z,selectProps:Z,theme:oe,...se,children:ie}),te]})};var I=e(94753);const T=te=>{const ne=(0,o.of)(M.J);return(0,t.jsx)("div",{className:ne.groupHeader,children:(0,t.jsx)(I.E,{weight:"bold",variant:"bodySmall",color:"secondary",children:te.children??""})})};var C=e(62235);class S extends i.Component{render(){const{children:ne}=this.props,{selectProps:le}=this.props;if(le&&Array.isArray(ne)&&Array.isArray(ne[0])&&le.maxVisibleValues!==void 0&&!(le.showAllSelectedWhenOpen&&le.menuIsOpen)){const[z,...ee]=ne,se=z.slice(0,le.maxVisibleValues);return this.renderContainer([se,...ee])}return this.renderContainer(ne)}renderContainer(ne){const{isMulti:le,theme:z,selectProps:ee}=this.props,se=this.props.selectProps?.noMultiValueWrap&&!this.props.selectProps?.menuIsOpen,ie=(0,M.J)(z),Z=ee["data-testid"],oe=(0,v.cx)(ie.valueContainer,{[ie.valueContainerMulti]:le&&!se,[ie.valueContainerMultiNoWrap]:le&&se});return(0,t.jsx)("div",{"data-testid":Z,className:oe,children:ne})}}const A=(0,o.cV)(S);var L=e(23731);const N=(te,ne)=>{if(Array.isArray(te)){const le=te.filter(Boolean);return le?.length?le:void 0}if(typeof te=="object")return[te];if(typeof te=="string"||typeof te=="number"){const le=F(te,ne);if(le)return[le]}},F=(te,ne)=>{for(const le of ne)if("options"in le){let z=F(te,le.options);if(z)return z}else if("value"in le&&le.value===te)return le;return null},w=te=>te.map(({description:ne,...le})=>le),B=te=>{const{children:ne,innerProps:le,selectProps:{menuIsOpen:z,onMenuClose:ee,onMenuOpen:se},isFocused:ie,isMulti:Z,getValue:oe,innerRef:ce}=te,ye=te.selectProps;return ye.renderControl?i.createElement(ye.renderControl,{isOpen:z,value:Z?oe():oe()[0],ref:ce,onClick:z?ee:se,onBlur:ee,disabled:!!ye.disabled,invalid:!!ye.invalid}):(0,t.jsx)(D,{ref:ce,innerProps:le,prefix:ye.prefix,focused:ie,invalid:!!ye.invalid,disabled:!!ye.disabled,children:ne})};function U({allowCustomValue:te=!1,allowCreateWhileLoading:ne=!1,"aria-label":le,"data-testid":z,autoFocus:ee=!1,backspaceRemovesValue:se=!0,blurInputOnSelect:ie,cacheOptions:Z,className:oe,closeMenuOnSelect:ce=!0,components:ye,createOptionPosition:re="last",defaultOptions:ue,defaultValue:De,disabled:ge=!1,filterOption:Te,formatCreateLabel:Le,getOptionLabel:Ye,getOptionValue:je,inputValue:Ze,invalid:Ne,isClearable:Pe=!1,id:Ue,isLoading:$e=!1,isMulti:ze=!1,inputId:qe,isOpen:dt,isOptionDisabled:vt,isSearchable:yt=!0,loadOptions:st,loadingMessage:Ve="Loading options...",maxMenuHeight:pe=300,minMenuHeight:Ee,maxVisibleValues:me,menuPlacement:ve="auto",menuPosition:Se,menuShouldPortal:Ie=!0,noOptionsMessage:Oe=(0,n.t)("grafana-ui.select.no-options-label","No options found"),onBlur:Re,onChange:he,onCloseMenu:Ce,onCreateOption:We,onInputChange:et,onKeyDown:rt,onMenuScrollToBottom:nt,onMenuScrollToTop:gt,onOpenMenu:xt,onFocus:St,openMenuOnFocus:zt=!1,options:Nt=[],placeholder:Vt=(0,n.t)("grafana-ui.select.placeholder","Choose"),prefix:en,renderControl:Je,showAllSelectedWhenOpen:ct=!0,tabSelectsValue:ot=!0,value:Qe,virtualized:pt=!1,noMultiValueWrap:Pt,width:At,isValidNewOption:mn,formatOptionLabel:Pn,hideSelectedOptions:fn,...Rn}){const Kn=(0,o.$j)(),Bt=(0,M.J)(Kn),an=(0,i.useRef)(null),[tn,Cn]=(0,i.useState)(!1),xn=(0,L.z)(Kn,At),[Vn,Et]=(0,i.useState)(!!Ze);(0,i.useEffect)(()=>{if(st&&dt&&an.current&&an.current.controlRef&&ve==="auto"){const Tn=window.innerHeight-an.current.controlRef.getBoundingClientRect().bottom;Cn(Tn<pe)}},[pe,ve,st,dt]);const Ft=(0,i.useCallback)((Tn,Wn)=>{if(ze&&Tn==null)return he([],Wn);he(Tn,Wn)},[ze,he]);let Gt=s.Ay;const ln={};let qt={},cn;if(ze&&st)cn=Qe;else if(ze&&Qe&&Array.isArray(Qe)&&!st)cn=Qe.map(Tn=>{const Wn=F(Tn.value??Tn,Nt);return Wn||(typeof Tn=="string"?(0,c.z)(Tn):Tn)});else if(st){const Tn=De||Qe;cn=Tn?[Tn]:[]}else cn=N(Qe,Nt);const En={"aria-label":le,"data-testid":z,autoFocus:ee,backspaceRemovesValue:se,blurInputOnSelect:ie,captureMenuScroll:nt||gt,closeMenuOnSelect:ce,defaultValue:De,disabled:ge,filterOption:Vn?Te:null,getOptionLabel:Ye,getOptionValue:je,hideSelectedOptions:fn,inputValue:Ze,invalid:Ne,isClearable:Pe,id:Ue,isDisabled:ge,isLoading:$e,isMulti:ze,inputId:qe,isOptionDisabled:vt,isSearchable:yt,maxMenuHeight:pe,minMenuHeight:Ee,maxVisibleValues:me,menuIsOpen:dt,menuPlacement:ve==="auto"&&tn?"top":ve,menuPosition:Se,menuShouldBlockScroll:!0,menuPortalTarget:Ie&&typeof document<"u"?document.body:void 0,menuShouldScrollIntoView:!1,onBlur:Re,onChange:Ft,onInputChange:(Tn,Wn)=>{const Nn=et?.(Tn,Wn)??Tn,Tt=!!Nn;return Tt!==Vn&&Et(Tt),Nn},onKeyDown:rt,onMenuClose:Ce,onMenuOpen:xt,onMenuScrollToBottom:nt,onMenuScrollToTop:gt,onFocus:St,formatOptionLabel:Pn,openMenuOnFocus:zt,options:pt?w(Nt):Nt,placeholder:Vt,prefix:en,renderControl:Je,showAllSelectedWhenOpen:ct,tabSelectsValue:ot,value:ze?cn:cn?.[0],noMultiValueWrap:Pt};te&&(Gt=a.A,ln.allowCreateWhileLoading=ne,ln.formatCreateLabel=Le??K,ln.onCreateOption=We,ln.createOptionPosition=re,ln.isValidNewOption=mn),st&&(Gt=te?g.A:r.A,qt={loadOptions:st,cacheOptions:Z,defaultOptions:ue});const Sn=pt?b.zd:b.eB;return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(Gt,{ref:an,components:{MenuList:Sn,Group:O,GroupHeading:T,ValueContainer:A,IndicatorsContainer:V,IndicatorSeparator:H,Control:B,Option:b.o5,ClearIndicator(Tn){const{clearValue:Wn}=Tn;return(0,t.jsx)(h.I,{name:"times",role:"button","aria-label":"select-clear-value",className:Bt.singleValueRemove,onMouseDown:Nn=>{Nn.preventDefault(),Nn.stopPropagation(),Wn()}})},LoadingIndicator(){return(0,t.jsx)(f.y,{inline:!0})},LoadingMessage(){return(0,t.jsx)("div",{className:Bt.loadingMessage,children:Ve})},NoOptionsMessage(){return(0,t.jsx)("div",{className:Bt.loadingMessage,"aria-label":"No options provided",children:Oe})},DropdownIndicator:m,SingleValue(Tn){return(0,t.jsx)(C.K,{...Tn,isDisabled:ge})},SelectContainer:P.K,MultiValueContainer:x.O,MultiValueRemove:ge?()=>null:x.p,Input:p,...ye},styles:xn,className:oe,...En,...ln,...qt,...Rn})})}function K(te){return(0,t.jsxs)("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[(0,t.jsx)("div",{children:te}),(0,t.jsx)("div",{style:{flexGrow:1}}),(0,t.jsx)("div",{className:"muted small",style:{display:"flex",gap:"8px",alignItems:"center"},children:"Hit enter to add"})]})}function V(te){const{showAllSelectedWhenOpen:ne,maxVisibleValues:le,menuIsOpen:z}=te.selectProps,ee=te.getValue();if(le!==void 0&&Array.isArray(te.children)){const se=ee.length;if(se>le&&!(ne&&z)){const ie=[...te.children];return ie.splice(-1,0,(0,t.jsxs)("span",{id:"excess-values",children:["(+",se-le,")"]},"excess-values")),(0,t.jsx)(y,{...te,children:ie})}}return(0,t.jsx)(y,{...te})}function H(){return(0,t.jsx)(t.Fragment,{})}function Y(te){return(0,t.jsx)(U,{...te})}function X(te){return(0,t.jsx)(U,{...te,isMulti:!0})}function J(te){return(0,t.jsx)(U,{...te})}function q(te){return(0,t.jsx)(U,{virtualized:!0,...te})}function ae(te){return(0,t.jsx)(U,{virtualized:!0,...te})}function j(te){return(0,t.jsx)(U,{...te,isMulti:!0})}},4603:(k,R,e)=>{"use strict";e.d(R,{K:()=>c});var t=e(74848),n=e(32196),i=e(28581),s=e(40845),r=e(16797),g=e(87266),a=e(10354);const c=h=>{const{isDisabled:f,isFocused:d,children:p,selectProps:{invalid:m=!1}}=h,v=(0,s.of)(o,d,f,m);return(0,t.jsx)(i.c.SelectContainer,{...h,className:(0,n.cx)(v.wrapper,h.className),children:p})},o=(h,f,d,p)=>{const m=(0,a.n)({theme:h,invalid:p});return{wrapper:(0,n.cx)(m.wrapper,(0,g.Xb)(h,p),f&&(0,n.css)((0,r.getFocusStyles)(h)),d&&m.inputDisabled,(0,n.css)({position:"relative",boxSizing:"border-box",flexDirection:"row",flexWrap:"wrap",alignItems:"stretch",justifyContent:"space-between",minHeight:"32px",height:"auto",maxWidth:"100%",padding:0,cursor:d?"not-allowed":"pointer"}))}}},12681:(k,R,e)=>{"use strict";e.d(R,{eB:()=>p,o5:()=>E,zd:()=>u});var t=e(74848),n=e(32196),i=e(2543),s=e.n(i),r=e(96540),g=e(91793),a=e(8887),c=e(13544),o=e(40845),h=e(40276),f=e(14578),d=e(88824);const p=({children:x,maxHeight:P,innerRef:b,innerProps:M})=>{const O=(0,o.$j)(),I=(0,d.J)(O);return(0,t.jsx)("div",{...M,className:I.menu,style:{maxHeight:P},"aria-label":"Select options menu",children:(0,t.jsx)(h.E,{scrollRefCallback:b,autoHide:!1,autoHeightMax:"inherit",hideHorizontalTrack:!0,children:x})})};p.displayName="SelectMenu";const m=37,v=8,l=8,y=36,u=({children:x,maxHeight:P,innerRef:b,options:M,focusedOption:O})=>{const I=(0,o.$j)(),T=(0,d.J)(I),C=(0,r.useRef)(null),S=(0,r.useMemo)(()=>M.flatMap(B=>B.options?[B,...B.options]:[B]),[M]),A=S.findIndex(B=>B.value===O?.value);if((0,r.useLayoutEffect)(()=>{C.current?.scrollToItem(A)},[A]),!Array.isArray(x))return null;const L=x.flatMap((B,U)=>D(B)?[r.cloneElement(B,{children:null}),...B.props.children.slice(0,-1),r.cloneElement(B.props.children.at(-1),{innerProps:{style:{borderBottom:`1px solid ${I.colors.border.weak}`,height:m}}})]:[B]),F=((0,i.max)(S.map(B=>B.label?.length))??0)*v+l*2+y,w=Math.min(L.length*m,P);return(0,t.jsx)(g.Y1,{outerRef:b,ref:C,className:T.menu,height:w,width:F,"aria-label":"Select options menu",itemCount:L.length,itemSize:m,children:({index:B,style:U})=>(0,t.jsx)("div",{style:{...U,overflow:"hidden"},children:L[B]})})},D=x=>r.isValidElement(x)&&Array.isArray(x.props.children);u.displayName="VirtualizedSelectMenu";const E=({children:x,data:P,innerProps:b,innerRef:M,isFocused:O,isSelected:I,renderOptionLabel:T})=>{const C=(0,o.$j)(),S=(0,d.J)(C),A=P.icon?(0,a.Uo)(P.icon):void 0,{onMouseMove:L,onMouseOver:N,...F}=b;return(0,t.jsxs)("div",{ref:M,className:(0,n.cx)(S.option,O&&S.optionFocused,I&&S.optionSelected,P.isDisabled&&S.optionDisabled),...F,"data-testid":c.Tp.components.Select.option,title:P.title,children:[A&&(0,t.jsx)(f.I,{name:A,className:S.optionIcon}),P.imgUrl&&(0,t.jsx)("img",{className:S.optionImage,src:P.imgUrl,alt:P.label||String(P.value)}),(0,t.jsxs)("div",{className:S.optionBody,children:[(0,t.jsx)("span",{children:T?T(P):x}),P.description&&(0,t.jsx)("div",{className:S.optionDescription,children:P.description}),P.component&&(0,t.jsx)(P.component,{})]})]})};E.displayName="SelectMenuOptions"},62235:(k,R,e)=>{"use strict";e.d(R,{K:()=>p});var t=e(74848),n=e(32196),i=e(28581),s=e(8887),r=e(40845),g=e(96540);function a(v,l={}){const{duration:y=250,delay:u=250}=l,[D,E]=(0,g.useState)(v),x=(0,g.useRef)();return(0,g.useEffect)(()=>{let P;if(v)P=setTimeout(()=>{x.current=new Date,E(v)},u);else{const b=x.current?Date.now()-x.current.valueOf():0,M=()=>{x.current=void 0,E(v)};b>=y?M():P=setTimeout(M,y-b)}return()=>{P&&(clearTimeout(P),P=void 0)}},[v,y,u]),D}var c=e(14578),o=e(62930),h=e(31511),f=e(72960);const d=v=>({singleValue:(0,n.css)({label:"singleValue",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",boxSizing:"border-box",maxWidth:"100%",gridArea:"1 / 1 / 2 / 3"}),spinnerWrapper:(0,n.css)({width:"16px",height:"16px",display:"inline-block",marginRight:"10px",position:"relative",verticalAlign:"middle",overflow:"hidden"}),spinnerIcon:(0,n.css)({width:"100%",height:"100%",position:"absolute"}),optionIcon:(0,n.css)({marginRight:v.spacing(1),color:v.colors.text.secondary}),disabled:(0,n.css)({color:v.colors.text.disabled}),isOpen:(0,n.css)({color:v.colors.text.disabled})}),p=v=>{const{children:l,data:y,isDisabled:u}=v,D=(0,r.of)(d),E=a(y.loading||!1,{delay:250,duration:750}),x=y.icon?(0,s.Uo)(y.icon):void 0;return(0,t.jsxs)(i.c.SingleValue,{...v,className:(0,n.cx)(D.singleValue,u&&D.disabled,v.selectProps.menuIsOpen&&D.isOpen),children:[y.imgUrl?(0,t.jsx)(m,{loading:E,imgUrl:y.imgUrl,styles:D,alt:String(y.label??y.value)}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(f.n,{horizontal:!0,size:16,visible:E,duration:150,children:(0,t.jsx)("div",{className:D.spinnerWrapper,children:(0,t.jsx)(o.y,{className:D.spinnerIcon,inline:!0})})}),x&&(0,t.jsx)(c.I,{name:x,role:"img",className:D.optionIcon})]}),!y.hideText&&l]})},m=v=>(0,t.jsxs)("div",{className:v.styles.spinnerWrapper,children:[(0,t.jsx)(h.A,{duration:150,visible:v.loading,children:(0,t.jsx)(o.y,{className:v.styles.spinnerIcon,inline:!0})}),(0,t.jsx)(h.A,{duration:150,visible:!v.loading,children:(0,t.jsx)("img",{className:v.styles.spinnerIcon,src:v.imgUrl,alt:v.alt})})]})},88824:(k,R,e)=>{"use strict";e.d(R,{J:()=>i});var t=e(32196),n=e(3911);const i=(0,n.N)(s=>({menu:(0,t.css)({label:"grafana-select-menu",background:s.components.dropdown.background,boxShadow:s.shadows.z3,position:"relative",minWidth:"100%",zIndex:1}),option:(0,t.css)({label:"grafana-select-option",padding:"8px",position:"relative",display:"flex",alignItems:"center",flexDirection:"row",flexShrink:0,whiteSpace:"nowrap",cursor:"pointer",borderLeft:"2px solid transparent","&:hover":{background:s.colors.action.hover,"@media (forced-colors: active), (prefers-contrast: more)":{border:`1px solid ${s.colors.primary.border}`}}}),optionIcon:(0,t.css)({marginRight:s.spacing(1)}),optionImage:(0,t.css)({label:"grafana-select-option-image",width:"16px",marginRight:"10px"}),optionDescription:(0,t.css)({label:"grafana-select-option-description",fontWeight:"normal",fontSize:s.typography.size.sm,color:s.colors.text.secondary,whiteSpace:"normal",lineHeight:s.typography.body.lineHeight}),optionBody:(0,t.css)({label:"grafana-select-option-body",display:"flex",fontWeight:s.typography.fontWeightMedium,flexDirection:"column",flexGrow:1}),optionFocused:(0,t.css)({label:"grafana-select-option-focused",background:s.colors.action.focus,"@media (forced-colors: active), (prefers-contrast: more)":{border:`1px solid ${s.colors.primary.border}`}}),optionSelected:(0,t.css)({background:s.colors.action.selected,"&::before":{backgroundImage:s.colors.gradients.brandVertical,borderRadius:s.shape.radius.default,content:'" "',display:"block",height:"100%",position:"absolute",transform:"translateX(-50%)",width:s.spacing(.5),left:0}}),optionDisabled:(0,t.css)({label:"grafana-select-option-disabled",backgroundColor:s.colors.action.disabledBackground,color:s.colors.action.disabledText,cursor:"not-allowed"}),singleValue:(0,t.css)({label:"grafana-select-single-value",color:s.components.input.text,gridArea:"1 / 1 / 2 / 3",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",boxSizing:"border-box",maxWidth:"100%"}),valueContainer:(0,t.css)({label:"grafana-select-value-container",alignItems:"center",display:"grid",position:"relative",boxSizing:"border-box",flex:"1 1 0%",outline:"none",overflow:"hidden"}),valueContainerMulti:(0,t.css)({label:"grafana-select-value-container-multi",flexWrap:"wrap",display:"flex"}),valueContainerMultiNoWrap:(0,t.css)({display:"grid",gridAutoFlow:"column"}),loadingMessage:(0,t.css)({label:"grafana-select-loading-message",padding:s.spacing(1),textAlign:"center",width:"100%"}),multiValueContainer:(0,t.css)({label:"grafana-select-multi-value-container",display:"flex",alignItems:"center",lineHeight:1,background:s.colors.background.secondary,borderRadius:s.shape.radius.default,margin:s.spacing(.25,1,.25,0),padding:s.spacing(.25,0,.25,1),color:s.colors.text.primary,fontSize:s.typography.size.sm,overflow:"hidden",whiteSpace:"nowrap","&:hover":{background:s.colors.emphasize(s.colors.background.secondary)}}),multiValueRemove:(0,t.css)({label:"grafana-select-multi-value-remove",margin:s.spacing(0,.5),cursor:"pointer",svg:{marginBottom:0}}),singleValueRemove:(0,t.css)({cursor:"pointer","&:hover":{color:s.colors.text.primary}}),groupHeader:(0,t.css)({padding:s.spacing(1,1,1,.75),borderLeft:"2px solid transparent"}),group:(0,t.css)({"&:not(:first-child)":{borderTop:`1px solid ${s.colors.border.weak}`},':has(+ [role="option"])':{borderBottom:`1px solid ${s.colors.border.weak}`}})}))},23731:(k,R,e)=>{"use strict";e.d(R,{A:()=>n,z:()=>i});var t=e(96540);function n(s){return{clearIndicator:()=>({}),container:()=>({}),control:()=>({}),dropdownIndicator:()=>({}),group:()=>({}),groupHeading:()=>({}),indicatorsContainer:()=>({}),indicatorSeparator:()=>({}),input:function(r){return{...r,color:"inherit",margin:0,padding:0,zIndex:1,overflow:"hidden"}},loadingIndicator:()=>({}),loadingMessage:()=>({}),menu:()=>({}),menuList:({maxHeight:r})=>({maxHeight:r}),multiValue:()=>({}),multiValueLabel:()=>({overflow:"hidden",textOverflow:"ellipsis"}),multiValueRemove:()=>({}),noOptionsMessage:()=>({}),option:()=>({}),placeholder:r=>({...r,color:s.colors.text.secondary}),singleValue:()=>({}),valueContainer:()=>({})}}function i(s,r){return(0,t.useMemo)(()=>({...n(s),menuPortal:g=>({...g,zIndex:s.zIndex.portal}),menu:({top:g,bottom:a,position:c})=>({top:g,bottom:a,position:c,minWidth:"100%",zIndex:s.zIndex.dropdown}),container:()=>({width:r?s.spacing(r):"100%",display:r==="auto"?"inline-flex":"flex"}),option:(g,a)=>({...g,opacity:a.isDisabled?.5:1})}),[s,r])}},62883:()=>{"use strict"},67570:(k,R,e)=>{"use strict";e.d(R,{u:()=>p});var t=e(2543),n=e.n(t),i=e(96540),s=e(13752),r=e(62467),g=e(11150),a=e(96083),c=e(63720),o=e(59099),h=e(54479),f=e(11134);function d(m){return{label:m,value:stringToMs(m)}}class p extends i.PureComponent{constructor(v){super(v),this.propsSubject=new s.B,this.subscription=null}componentDidMount(){this.subscription=this.propsSubject.pipe((0,c.n)(v=>f.cC.isLive(v.interval)?(0,r.of)({}):v.loading?g.t:(0,a.Y)((0,h.dc)(v.interval))),(0,o.M)(()=>this.props.func())).subscribe(),this.propsSubject.next(this.props)}componentDidUpdate(v){f.cC.isLive(v.interval)&&f.cC.isLive(this.props.interval)||(0,t.isEqual)(v,this.props)||this.propsSubject.next(this.props)}componentWillUnmount(){this.subscription&&this.subscription.unsubscribe(),this.propsSubject.unsubscribe()}render(){return null}}},63250:(k,R,e)=>{"use strict";e.d(R,{I1:()=>y,_$:()=>p,gl:()=>f});var t=e(2543),n=e.n(t),i=e(75059),s=e(47070),r=e(50082),g=e(62398),a=e(24293),c=e(90708),o=e(47737);const h=["reduceOptions","orientation"];function f(u,D,E){let x=u.options;if(u.fieldConfig=u.fieldConfig||{defaults:{},overrides:[]},D==="singlestat"&&E.angular)return d(u,E);for(const P of h)E.hasOwnProperty(P)&&(x[P]=(0,t.cloneDeep)(E[P]));return x}function d(u,D){const E=D.angular,x=i.AS.getIfExists(E.valueName),P={reduceOptions:{calcs:[x?x.id:i.gy.mean]},orientation:s.wV.Horizontal},b={};if(E.format&&(b.unit=E.format),E.tableColumn&&(P.reduceOptions.fields=`/^${E.tableColumn}$/`),E.nullPointMode&&(b.nullValueMode=E.nullPointMode),E.nullText&&(b.noValue=E.nullText),(E.decimals||E.decimals===0)&&(b.decimals=E.decimals),E.thresholds&&E.colors){const O=E.thresholds.split(",").map(T=>Number(T.trim())),I=[];for(const T of E.colors){const C=I.length-1;C>=0?I.push({value:O[C],color:T}):I.push({value:-1/0,color:T})}b.thresholds={mode:r.O.Absolute,steps:I}}const M=(0,g.bh)(E,b.thresholds);return M&&M.length&&(b.mappings=M),E.gauge&&E.gauge.show&&(b.min=E.gauge.minValue,b.max=E.gauge.maxValue),u.fieldConfig.defaults=b,P}function p(u){if(!u.options)return{};const D=parseFloat(u.pluginVersion||"6.1");let E=u.options;D<6.2&&(E=v(E)),D<6.3&&(E=m(E));const{fieldOptions:x}=E;if(D<6.6&&x){if(x&&x.override){const{override:M,...O}=E.fieldOptions;E={...E,fieldOptions:{...O,overrides:[]}}}let P=x?.defaults?.thresholds;P?delete x.defaults.thresholds:(P=x?.thresholds,delete x.thresholds),P&&(x.defaults.thresholds={mode:r.O.Absolute,steps:P});const{defaults:b}=x;b.color&&typeof b.color=="string"&&(b.color={mode:a.Y.Fixed,fixedColor:b.color}),(0,c.BF)(b)}if(D<7&&(u.fieldConfig=u.fieldConfig||{defaults:{},overrides:[]},u.fieldConfig={defaults:x&&x.defaults?{...u.fieldConfig.defaults,...x.defaults}:u.fieldConfig.defaults,overrides:x&&x.overrides?[...u.fieldConfig.overrides,...x.overrides]:u.fieldConfig.overrides},x&&(E.reduceOptions={values:x.values,limit:x.limit,calcs:x.calcs}),delete E.fieldOptions),D<7.1){const P=u.fieldConfig.defaults.title;P!=null&&(u.fieldConfig.defaults.displayName=P,delete u.fieldConfig.defaults.title)}if(D<8){const P=u.fieldConfig?.defaults;let b=P?.unit;b==="percent"?((0,t.isNumber)(P.min)||(P.min=0),(0,t.isNumber)(P.max)||(P.max=100)):b==="percentunit"&&((0,t.isNumber)(P.min)||(P.min=0),(0,t.isNumber)(P.max)||(P.max=1))}return E}function m(u){const{fieldOptions:D}=u;if(!D)return u;const{mappings:E,...x}=u.fieldOptions;let P;return u.thresholds&&(P={mode:r.O.Absolute,steps:l(u.thresholds)}),{...u,fieldOptions:{...x,defaults:{...D.defaults,mappings:E,thresholds:P}}}}function v(u){const{valueOptions:D}=u;if(!D)return u;const E={},x={};if(E.mappings=u.valueMappings,E.thresholds=u.thresholds,E.defaults=x,x.unit=D.unit,x.decimals=D.decimals,D.stat){const b=i.AS.get(D.stat);b&&(E.calcs=[b.id])}x.min=u.minValue,x.max=u.maxValue;const P={...u,fieldOptions:E};return(0,t.omit)(P,"valueMappings","thresholds","valueOptions","minValue","maxValue")}function l(u){if(!u||!u.length)return;const D=u.map(E=>({value:E.value===null?-1/0:E.value,color:E.color}));return(0,o.RU)(D),D[0].value=-1/0,D}function y(u){return(0,g.bh)(u)}},37713:(k,R,e)=>{"use strict";e.d(R,{I1:()=>t.I1,_$:()=>t._$,gl:()=>t.gl});var t=e(63250)},47097:(k,R,e)=>{"use strict";e.d(R,{F:()=>d});var t=e(74848),n=e(32196),i=e(94659),s=e(9821),r=e(96540),g=e(40845),a=e(80427);const c=p=>{const{value:m,children:v,visible:l,placement:y,tipFormatter:u,...D}=p,E=(0,r.useRef)(null),x=(0,r.useRef)(null),P=(0,g.of)(o);function b(){x.current!==null&&cancelAnimationFrame(x.current)}function M(){x.current=requestAnimationFrame(()=>{E.current?.forceAlign()})}return(0,r.useEffect)(()=>(l?M():b(),b),[m,l]),(0,t.jsx)(a.A,{overlayClassName:P.tooltip,placement:y,overlay:u??m,overlayInnerStyle:{minHeight:"auto"},ref:E,visible:l,...D,children:v})},o=p=>({tooltip:(0,n.css)({position:"absolute",display:"block",visibility:"visible",fontSize:p.typography.bodySmall.fontSize,opacity:.9,padding:3,zIndex:p.zIndex.tooltip})}),h=c;var f=e(24849);const d=({min:p,max:m,onChange:v,onAfterChange:l,orientation:y="horizontal",reverse:u,step:D,formatTooltipResult:E,value:x,tooltipAlwaysVisible:P=!0})=>{const b=(0,r.useCallback)(C=>{v?.(typeof C=="number"?[C,C]:C)},[v]),M=(0,r.useCallback)(C=>{l?.(typeof C=="number"?[C,C]:C)},[l]),O=y==="horizontal",I=(0,g.of)(f.$,O),T=(C,S)=>(0,t.jsx)(h,{value:S.value,visible:P||S.dragging,tipFormatter:E?()=>E(S.value):void 0,placement:O?"top":"right",children:C});return(0,t.jsxs)("div",{className:(0,n.cx)(I.container,I.slider),children:[(0,t.jsx)(i.Global,{styles:I.tooltip}),(0,t.jsx)(s.A,{min:p,max:m,step:D,defaultValue:x,range:!0,onChange:b,onChangeComplete:M,vertical:!O,reverse:u,handleRender:T})]})};d.displayName="RangeSlider"},77014:(k,R,e)=>{"use strict";e.d(R,{A:()=>o});var t=e(74848),n=e(32196),i=e(94659),s=e(9821),r=e(96540),g=e(40845),a=e(10354),c=e(24849);const o=({min:h,max:f,onChange:d,onAfterChange:p,orientation:m="horizontal",reverse:v,step:l,value:y,ariaLabelForHandle:u,marks:D,included:E})=>{const x=m==="horizontal",P=(0,g.of)(c.$,x,!!D),b=s.A,[M,O]=(0,r.useState)(y??h),I=(0,r.useCallback)(N=>{const F=typeof N=="number"?N:N[0];O(F),d?.(F)},[O,d]),T=(0,r.useCallback)(N=>{let F=+N.target.value;Number.isNaN(F)&&(F=0),O(F),d&&d(F),p&&p(F)},[d,p]),C=(0,r.useCallback)(N=>{const F=+N.target.value;F>f?O(f):F<h&&O(h)},[f,h]),S=(0,r.useCallback)(N=>{const F=typeof N=="number"?N:N[0];p?.(F)},[p]),A=x?[]:[P.sliderInputVertical],L=x?[]:[P.sliderInputFieldVertical];return(0,t.jsxs)("div",{className:(0,n.cx)(P.container,P.slider),children:[(0,t.jsx)(i.Global,{styles:P.tooltip}),(0,t.jsxs)("div",{className:(0,n.cx)(P.sliderInput,...A),children:[(0,t.jsx)(b,{min:h,max:f,step:l,defaultValue:y,value:M,onChange:I,onChangeComplete:S,vertical:!x,reverse:v,ariaLabelForHandle:u,marks:D,included:E}),(0,t.jsx)(a.p,{type:"text",className:(0,n.cx)(P.sliderInputField,...L),value:M,onChange:T,onBlur:C,min:h,max:f})]})]})};o.displayName="Slider"},24849:(k,R,e)=>{"use strict";e.d(R,{$:()=>s});var t=e(32196),n=e(94659),i=e(12415);const s=(r,g,a=!1)=>{const{spacing:c}=r,o=r.colors.border.strong,h=r.colors.primary.main,f=r.colors.primary.main,p=`box-shadow: 0px 0px 0px 6px ${r.colors.primary.transparent}`;return{container:(0,t.css)({width:"100%",margin:g?"inherit":c(1,3,1,1),paddingBottom:g&&a?r.spacing(1):"inherit",height:g?"auto":"100%"}),slider:(0,t.css)`
      .rc-slider {
        display: flex;
        flex-grow: 1;
        margin-left: 7px; // half the size of the handle to align handle to the left on 0 value
      }
      .rc-slider-mark {
        top: ${r.spacing(1.75)};
      }
      .rc-slider-mark-text {
        color: ${r.colors.text.disabled};
        font-size: ${r.typography.bodySmall.fontSize};
      }
      .rc-slider-mark-text-active {
        color: ${r.colors.text.primary};
      }
      .rc-slider-handle {
        border: none;
        background-color: ${f};
        box-shadow: ${r.shadows.z1};
        cursor: pointer;
        opacity: 1;
      }

      .rc-slider-handle:hover,
      .rc-slider-handle:active,
      .rc-slider-handle-click-focused:focus {
        ${p};
      }

      // The triple class names is needed because that's the specificity used in the source css :(
      .rc-slider-handle-dragging.rc-slider-handle-dragging.rc-slider-handle-dragging,
      .rc-slider-handle:focus-visible {
        box-shadow: 0 0 0 5px ${r.colors.text.primary};
      }

      .rc-slider-dot,
      .rc-slider-dot-active {
        background-color: ${r.colors.text.primary};
        border-color: ${r.colors.text.primary};
      }

      .rc-slider-track {
        background-color: ${h};
      }
      .rc-slider-rail {
        background-color: ${o};
        cursor: pointer;
      }
    `,tooltip:(0,n.css)`
      body {
        .rc-slider-tooltip {
          cursor: grab;
          user-select: none;
          z-index: ${r.zIndex.tooltip};
        }

        .rc-slider-tooltip-inner {
          color: ${r.colors.text.primary};
          background-color: transparent !important;
          border-radius: 0;
          box-shadow: none;
        }

        .rc-slider-tooltip-placement-top .rc-slider-tooltip-arrow {
          display: none;
        }

        .rc-slider-tooltip-placement-top {
          padding: 0;
        }
      }
    `,sliderInput:(0,t.css)({display:"flex",flexDirection:"row",alignItems:"center",width:"100%"}),sliderInputVertical:(0,t.css)({flexDirection:"column",height:"100%",".rc-slider":{margin:0,order:2}}),sliderInputField:(0,t.css)({marginLeft:r.spacing(3),width:"60px",input:{textAlign:"center"}}),sliderInputFieldVertical:(0,t.css)({margin:`0 0 ${r.spacing(3)} 0`,order:1})}}},5926:(k,R,e)=>{"use strict";e.d(R,{O:()=>y});var t=e(74848),n=e(2543),i=e(96540),s=e(39624),r=e(21423),g=e(11261),a=e(8066),c=e(52622),o=e(81297),h=e(51336),f=e(16895),d=e(73060),p=e(14236),m=e(46294);function v(u,D){const E=u.y.values.length,x={...u.y.config,...D},P=u.x??{name:"",values:[...Array(E).keys()],type:g.PU.number,config:{}};let b={refId:"sparkline",fields:[P,{...u.y,config:x}],length:E};return(0,d.g2)(P.values)||(b=(0,p.ES)(b,0)),(0,m.M)({frame:b,refFieldPseudoMin:u.timeRange?.from.valueOf(),refFieldPseudoMax:u.timeRange?.to.valueOf()})}const l={drawStyle:c.GR.Line,showPoints:c.yL.Auto,axisPlacement:c.vM.Hidden,pointSize:2};class y extends i.PureComponent{constructor(D){super(D);const E=v(D.sparkline,D.config);this.state={data:(0,f.bq)(E,(0,f.ro)(E)),alignedDataFrame:E,configBuilder:this.prepareConfig(E)}}static getDerivedStateFromProps(D,E){const x=v(D.sparkline,D.config),P=(0,s.C)(x);return P?{...E,data:(0,f.bq)(P,(0,f.ro)(P)),alignedDataFrame:P}:{...E}}componentDidUpdate(D,E){const{alignedDataFrame:x}=this.state;if(!x)return;let P=!1;if(D.sparkline!==this.props.sparkline){const b=!(0,r.bW)(this.state.alignedDataFrame,E.alignedDataFrame),M=!(0,n.isEqual)(x.fields[1].state?.range,E.alignedDataFrame.fields[1].state?.range);P=b||M}else P=!(0,n.isEqual)(D.config,this.props.config);P&&this.setState({configBuilder:this.prepareConfig(x)})}getYRange(D){let{min:E,max:x}=this.state.alignedDataFrame.fields[1].state?.range;const P=+this.state.alignedDataFrame.fields[1].config?.noValue;return Number.isNaN(P)||(E=Math.min(E,+P),x=Math.max(x,+P)),E===x?(E===0?x=100:(E=0,x*=2),[E,x]):[Math.max(E,D.config.min??-1/0),Math.min(x,D.config.max??1/0)]}prepareConfig(D){const{theme:E}=this.props,x=new h.e;x.setCursor({show:!1,x:!1,y:!1});const P=D.fields[0];x.addScale({scaleKey:"x",orientation:c.Lt.Horizontal,direction:c.ON.Right,isTime:!1,range:()=>{const{sparkline:b}=this.props;if(b.x){if(b.timeRange&&b.x.type===g.PU.time)return[b.timeRange.from.valueOf(),b.timeRange.to.valueOf()];const M=b.x.values;return[M[0],M[M.length-1]]}return[0,b.y.values.length-1]}}),x.addAxis({scaleKey:"x",theme:E,placement:c.vM.Hidden});for(let b=0;b<D.fields.length;b++){const M=D.fields[b],O=M.config,I={...l,...O.custom};if(M===P||M.type!==g.PU.number)continue;const T=O.unit||"__fixed";x.addScale({scaleKey:T,orientation:c.Lt.Vertical,direction:c.ON.Up,range:()=>this.getYRange(M)}),x.addAxis({scaleKey:T,theme:E,placement:c.vM.Hidden});const C=(0,a.Qi)(M),S=C.getCalculator(M,E)(0,0),A=I.drawStyle===c.GR.Points?c.yL.Always:I.showPoints;x.addSeries({pxAlign:!1,scaleKey:T,theme:E,colorMode:C,thresholds:O.thresholds,drawStyle:I.drawStyle,lineColor:I.lineColor??S,lineWidth:I.lineWidth,lineInterpolation:I.lineInterpolation,showPoints:A,pointSize:I.pointSize,fillOpacity:I.fillOpacity,fillColor:I.fillColor,lineStyle:I.lineStyle,gradientMode:I.gradientMode})}return x}render(){const{data:D,configBuilder:E}=this.state,{width:x,height:P}=this.props;return(0,t.jsx)(o.Z,{data:D,config:E,width:x,height:P})}}},62930:(k,R,e)=>{"use strict";e.d(R,{y:()=>h});var t=e(74848),n=e(32196),i=e(8867),s=e(40845),r=e(4025),g=e(76412),a=e(87019),c=e(14578),o=e(78318);const h=({className:p,inline:m=!1,iconClassName:v,style:l,size:y="md"})=>{const u=(0,s.of)(f),D=(0,s.of)(d,y),x=window.matchMedia("(prefers-reduced-motion: reduce)").matches?"hourglass":"spinner";if(typeof y!="string"||!(0,r.rJ)(y)){const P=(0,o.Wj)(),b=(0,o.Xi)(x,"default"),M=`${P}${b}/${x}.svg`;return(0,t.jsx)("div",{"data-testid":"Spinner",style:l,className:(0,n.cx)({[u.inline]:m},D.wrapper,p),children:(0,t.jsx)(i.default,{src:M,width:y,height:y,className:(0,n.cx)(u.spin,D.icon,p),style:l})})}return(0,t.jsx)("div",{"data-testid":"Spinner",style:l,className:(0,n.cx)({[u.inline]:m},p),children:(0,t.jsx)(c.I,{className:(0,n.cx)(u.spin,v),name:x,size:y,"aria-label":(0,g.t)("grafana-ui.spinner.aria-label","Loading")})})},f=p=>({inline:(0,n.css)({display:"inline-block"}),spin:(0,n.css)({[p.transitions.handleMotion("no-preference")]:{animation:`${a.t} 2s infinite linear`}})}),d=(p,m)=>({wrapper:(0,n.css)({fontSize:typeof m=="string"?m:`${m}px`}),icon:(0,n.css)({display:"inline-block",fill:"currentColor",flexShrink:0,label:"Icon",lineHeight:0,verticalAlign:"middle"})})},21633:(k,R,e)=>{"use strict";e.d(R,{h:()=>f});var t=e(32196),n=e(2543),i=e.n(n),s=e(96540),r=e(40845),g=e(69144);const a=.3,c=new Set(["ArrowUp","ArrowDown"]),o=new Set(["ArrowLeft","ArrowRight"]),h={row:{dim:"width",axis:"clientX",min:"minWidth",max:"maxWidth"},column:{dim:"height",axis:"clientY",min:"minHeight",max:"maxHeight"}};function f(l){const{direction:y,initialSize:u=.5,dragPosition:D="middle",onResizing:E,onSizeChanged:x}=l,P=16,b=(0,s.useRef)(null),M=(0,s.useRef)(null),O=(0,s.useRef)(null),I=(0,s.useRef)(null),T=(0,s.useRef)(null),C=(0,s.useRef)("1fr"),S=(0,s.useRef)(void 0),A=(0,s.useRef)(void 0),L=h[y].dim,N=h[y].axis,F=h[y].min,w=h[y].max;m(I.current,ee=>{for(const se of ee){if(!se.target.isSameNode(I.current)||!M.current)return;const ie=M.current.getBoundingClientRect()[L],Z=p(M.current);b.current.ariaValueNow=d(ie,Z[F],Z[w])}},500,[w,F,y,L]);const B=(0,s.useRef)(null),U=(0,s.useCallback)(ee=>{M.current&&(C.current=M.current.getBoundingClientRect()[L],T.current=I.current.getBoundingClientRect()[L],B.current=ee[N],b.current.setPointerCapture(ee.pointerId),S.current=p(M.current),A.current=void 0)},[L,N]),K=(0,s.useCallback)(ee=>{if(B.current!==null&&C.current!=="1fr"){const se=ee[N]-B.current,ie=S.current,Z=(0,n.clamp)(C.current+se,ie[F],ie[w]),oe=Z/(T.current-P);M.current.style.flexGrow=`${oe}`,O.current.style.flexGrow=`${1-oe}`,b.current.ariaValueNow=d(Z,ie[F],ie[w]),E?.(oe,Z)}},[P,N,F,w,E]),V=(0,s.useCallback)(ee=>{ee.preventDefault(),ee.stopPropagation(),b.current.releasePointerCapture(ee.pointerId),B.current=null,typeof C.current=="number"&&x?.(parseFloat(M.current.style.flexGrow),C.current)},[x]),H=(0,s.useRef)(new Set),Y=(0,s.useRef)(null),X=(0,s.useCallback)(ee=>{if(H.current.size===0){Y.current=null;return}else if(C.current==="1fr")return;const Z=(ee-(Y.current??ee))*a;let oe=0;y==="row"?(H.current.has("ArrowLeft")&&(oe-=Z),H.current.has("ArrowRight")&&(oe+=Z)):(H.current.has("ArrowUp")&&(oe-=Z),H.current.has("ArrowDown")&&(oe+=Z));const ce=S.current,ye=M.current.getBoundingClientRect()[L],re=(0,n.clamp)(ye+oe,ce[F],ce[w]),ue=re/(T.current-P);M.current.style.flexGrow=`${ue}`,O.current.style.flexGrow=`${1-ue}`,b.current.ariaValueNow=d(re,ce[F],ce[w]),E?.(ue,re),Y.current=ee,window.requestAnimationFrame(X)},[y,P,F,w,L,E]),J=(0,s.useCallback)(ee=>{if(!M.current||!O.current||!b.current||!I.current)return;if(ee.key==="Enter"){A.current===void 0?(A.current=M.current.style.flexGrow,M.current.style.flexGrow="0",O.current.style.flexGrow="1"):(M.current.style.flexGrow=A.current,O.current.style.flexGrow=`${1-parseFloat(A.current)}`,A.current=void 0);return}else if(ee.key==="Home"){S.current=p(M.current),T.current=I.current.getBoundingClientRect()[L];const ie=S.current[F]/(T.current-P);M.current.style.flexGrow=`${ie}`,O.current.style.flexGrow=`${1-ie}`,b.current.ariaValueNow="0";return}else if(ee.key==="End"){S.current=p(M.current),T.current=I.current.getBoundingClientRect()[L];const ie=S.current[w]/(T.current-P);M.current.style.flexGrow=`${ie}`,O.current.style.flexGrow=`${1-ie}`,b.current.ariaValueNow="100";return}if(!(y==="column"&&c.has(ee.key)||y==="row"&&o.has(ee.key))||H.current.has(ee.key))return;if(A.current=void 0,ee.preventDefault(),ee.stopPropagation(),C.current=M.current.getBoundingClientRect()[L],T.current=I.current.getBoundingClientRect()[L],S.current=p(M.current),!H.current.has(ee.key)){const ie=H.current.size===0;H.current.add(ee.key),ie&&window.requestAnimationFrame(X)}},[y,X,P,w,L,F]),q=(0,s.useCallback)(ee=>{y==="row"&&!o.has(ee.key)||y==="column"&&!c.has(ee.key)||(H.current.delete(ee.key),typeof C.current=="number"&&x?.(parseFloat(M.current.style.flexGrow),C.current))},[y,x]),ae=(0,s.useCallback)(()=>{if(!M.current||!O.current)return;M.current.style.flexGrow="0.5",O.current.style.flexGrow="0.5";const ee=p(M.current);S.current=ee,C.current=M.current.getBoundingClientRect()[L],b.current.ariaValueNow=`${d(C.current,ee[F],ee[w])}`},[w,L,F]),j=(0,s.useCallback)(()=>{H.current.size>0&&(H.current.clear(),B.current=null,typeof C.current=="number"&&x?.(parseFloat(M.current.style.flexGrow),C.current))},[x]),te=(0,r.of)(v,y),ne=(0,r.of)(g.l,D),le=y==="column"?ne.dragHandleHorizontal:ne.dragHandleVertical,z=(0,s.useId)();return{containerProps:{ref:I,className:te.container},primaryProps:{ref:M,className:te.panel,style:{[F]:"min-content",flexGrow:(0,n.clamp)(u??.5,0,1)}},secondaryProps:{ref:O,className:te.panel,style:{flexGrow:(0,n.clamp)(1-u,0,1),[F]:"min-content"}},splitterProps:{onPointerUp:V,onPointerDown:U,onPointerMove:K,onKeyDown:J,onKeyUp:q,onDoubleClick:ae,onBlur:j,ref:b,style:{[L]:`${P}px`},role:"separator","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":u*100,"aria-controls":`start-panel-${z}`,"aria-label":"Pane resize widget",tabIndex:0,className:le}}}function d(l,y,u){return`${(0,n.clamp)((l-y)/(u-y)*100,0,100)}`}function p(l){const y=document.body.style.overflow,u=l.style.width,D=l.style.height,E=l.style.flexGrow;document.body.style.overflow="hidden",l.style.flexGrow="0";const{width:x,height:P}=l.getBoundingClientRect();l.style.flexGrow="100";const{width:b,height:M}=l.getBoundingClientRect();return document.body.style.overflow=y,l.style.width=u,l.style.height=D,l.style.flexGrow=E,{minWidth:x,maxWidth:b,minHeight:P,maxHeight:M}}function m(l,y,u=0,D){const E=(0,n.throttle)(y,u);(0,s.useLayoutEffect)(()=>{if(!l)return;const x=new ResizeObserver(E);return x.observe(l,{box:"device-pixel-content-box"}),()=>x.disconnect()},D)}function v(l,y){return{container:(0,t.css)({display:"flex",flexDirection:y==="row"?"row":"column",width:"100%",flexGrow:1,overflow:"hidden"}),panel:(0,t.css)({display:"flex",position:"relative",flexBasis:0})}}},42734:(k,R,e)=>{"use strict";e.d(R,{S:()=>a});var t=e(74848),n=e(2543),i=e.n(n),s=e(96540),r=e(75059),g=e(90182);class a extends s.PureComponent{constructor(){super(...arguments),this.checkInput=()=>{const{stats:o,allowMultiple:h,defaultStat:f,onChange:d}=this.props,p=r.AS.list(o);if(p.length!==o.length){const m=p.map(l=>l.id),v=(0,n.difference)(o,m);console.warn("Unknown stats",v,o),d(p.map(l=>l.id))}!h&&o.length>1&&(console.warn("Removing extra stat",o),d([o[0]])),f&&o.length<1&&d([f])},this.onSelectionChange=o=>{const{onChange:h}=this.props;Array.isArray(o)?h(o.map(f=>f.value)):h(o&&o.value?[o.value]:[])}}static{this.defaultProps={allowMultiple:!1}}componentDidMount(){this.checkInput()}componentDidUpdate(o){this.checkInput()}render(){const{stats:o,allowMultiple:h,defaultStat:f,placeholder:d,className:p,menuPlacement:m,width:v,inputId:l,filterOptions:y}=this.props,u=r.AS.selectOptions(o,y);return(0,t.jsx)(g.l6,{value:u.current,className:p,isClearable:!f,isMulti:h,width:v,isSearchable:!0,options:u.options,placeholder:d,onChange:this.onSelectionChange,menuPlacement:m,inputId:l})}}},15292:(k,R,e)=>{"use strict";e.d(R,{K:()=>f,d:()=>h});var t=e(74848),n=e(32196),i=e(2543),s=e.n(i),r=e(96540),g=e(95344),a=e(40845),c=e(16797),o=e(14578);const h=(0,r.forwardRef)(({value:p,checked:m,onChange:v,id:l,label:y,disabled:u,invalid:D=!1,...E},x)=>{m&&(0,g.l)("Switch","checked prop","value");const P=(0,a.of)(d),b=(0,r.useRef)(l||(0,i.uniqueId)("switch-"));return(0,t.jsxs)("div",{className:(0,n.cx)(P.switch,D&&P.invalid),children:[(0,t.jsx)("input",{type:"checkbox",disabled:u,checked:p,onChange:M=>{!u&&v?.(M)},id:b.current,...E,ref:x}),(0,t.jsx)("label",{htmlFor:b.current,"aria-label":y??"Toggle switch",children:(0,t.jsx)(o.I,{name:"check",size:"xs"})})]})});h.displayName="Switch";const f=(0,r.forwardRef)(({transparent:p,className:m,showLabel:v,label:l,value:y,id:u,invalid:D,...E},x)=>{const P=(0,a.of)(d,p);return(0,t.jsxs)("div",{className:(0,n.cx)(P.inlineContainer,m,E.disabled&&P.disabled,D&&P.invalid),children:[v&&(0,t.jsx)("label",{htmlFor:u,className:(0,n.cx)(P.inlineLabel,y&&P.inlineLabelEnabled,"inline-switch-label"),children:l}),(0,t.jsx)(h,{...E,id:u,label:l,ref:x,value:y})]})});f.displayName="Switch";const d=(p,m)=>({switch:(0,n.css)({width:"32px",height:"16px",position:"relative",lineHeight:1,input:{opacity:0,left:"-100vw",zIndex:-1e3,position:"absolute","&:checked + label":{background:p.colors.primary.main,borderColor:p.colors.primary.main,"&:hover":{background:p.colors.primary.shade},svg:{transform:"translate3d(17px, -50%, 0)",background:p.colors.primary.contrastText,color:p.colors.primary.main}},"&:disabled + label":{background:p.colors.action.disabledBackground,borderColor:p.colors.border.weak,cursor:"not-allowed",svg:{background:p.colors.text.disabled}},"&:disabled:checked + label":{background:p.colors.primary.transparent,svg:{color:p.colors.primary.contrastText}},"&:focus + label, &:focus-visible + label":(0,c.getFocusStyles)(p),"&:focus:not(:focus-visible) + label":(0,c.getMouseFocusStyles)(p)},label:{width:"100%",height:"100%",cursor:"pointer",borderRadius:p.shape.radius.pill,background:p.components.input.background,border:`1px solid ${p.components.input.borderColor}`,transition:"all 0.3s ease","&:hover":{borderColor:p.components.input.borderHover},svg:{position:"absolute",display:"block",color:"transparent",width:"12px",height:"12px",borderRadius:p.shape.radius.circle,background:p.colors.text.secondary,boxShadow:p.shadows.z1,top:"50%",transform:"translate3d(1px, -50%, 0)",transition:"transform 0.2s cubic-bezier(0.19, 1, 0.22, 1)","@media (forced-colors: active)":{border:`1px solid ${p.colors.primary.contrastText}`}}}}),inlineContainer:(0,n.css)({padding:p.spacing(0,1),height:p.spacing(p.components.height.md),display:"inline-flex",alignItems:"center",background:m?"transparent":p.components.input.background,border:`1px solid ${m?"transparent":p.components.input.borderColor}`,borderRadius:p.shape.radius.default,"&:hover":{border:`1px solid ${m?"transparent":p.components.input.borderHover}`,".inline-switch-label":{color:p.colors.text.primary}}}),disabled:(0,n.css)({backgroundColor:"rgba(204, 204, 220, 0.04)",color:"rgba(204, 204, 220, 0.6)",border:"1px solid rgba(204, 204, 220, 0.04)"}),inlineLabel:(0,n.css)({cursor:"pointer",paddingRight:p.spacing(1),color:p.colors.text.secondary,whiteSpace:"nowrap"}),inlineLabelEnabled:(0,n.css)({color:p.colors.text.primary}),invalid:(0,n.css)({"input + label, input:checked + label, input:hover + label":{border:`1px solid ${p.colors.error.border}`}})})},60734:(k,R,e)=>{"use strict";e.d(R,{q:()=>h});var t=e(74848),n=e(32196),i=e(96540),s=e(29158),r=e(63021),g=e(40675),a=e(40980),c=e(40845),o=e(40276);function h({tabs:d,defaultTab:p,closeIconTooltip:m,onClose:v,testId:l}){const[y,u]=(0,i.useState)(d.some(b=>b.value===p)?p:d[0].value),D=(0,c.of)(f),E=(0,c.$j)(),x=b=>{u(b.value)},P=`calc(100% - (${E.components.menuTabs.height}px + ${E.spacing(1)}))`;return(0,t.jsxs)("div",{className:D.container,"data-testid":l,children:[(0,t.jsxs)(r.U,{className:D.tabs,children:[d.map(b=>(0,t.jsx)(g.o,{label:b.label,active:b.value===y,onChangeTab:()=>x(b),icon:b.icon},b.value)),(0,t.jsx)(s.K,{className:D.close,onClick:v,name:"times",tooltip:m??"Close"})]}),(0,t.jsx)(o.E,{autoHeightMin:P,autoHeightMax:P,children:(0,t.jsx)(a.J,{className:D.tabContent,children:d.find(b=>b.value===y)?.content})})]})}const f=d=>({container:(0,n.css)({height:"100%"}),tabContent:(0,n.css)({padding:d.spacing(2),backgroundColor:d.colors.background.primary,height:"100%"}),close:(0,n.css)({position:"absolute",right:"16px",top:"5px",cursor:"pointer",fontSize:d.typography.size.lg}),tabs:(0,n.css)({paddingTop:d.spacing(1),borderColor:d.colors.border.weak,ul:{marginLeft:d.spacing(2)}})})},92015:(k,R,e)=>{"use strict";e.d(R,{u:()=>c,d:()=>h});var t=e(74848),n=e(96540),i=e(75059),s=e(13544),r=e(32196);const g=f=>{const d=(0,r.css)({width:"100%",listStyle:"none"}),p=(0,r.css)({width:"100%",display:"flex",flexDirection:"row",justifyContent:"space-between"});return f.value&&!Array.isArray(f.value)?(0,t.jsx)("span",{children:f.value}):f.value&&Array.isArray(f.value)&&f.value.length>0?(0,t.jsx)("ul",{className:d,children:f.value.map((m,v)=>{const l=Object.keys(m)[0];return(0,t.jsxs)("li",{className:p,children:[(0,t.jsx)("span",{children:l}),(0,t.jsx)("span",{children:m[l]})]},v)})}):a},a=()=>(0,t.jsx)("span",{children:"\xA0"});function c(f){const{totalColumnsWidth:d,footerGroups:p,isPaginationVisible:m,tableStyles:v}=f,l=s.Tp.components.Panels.Visualization.Table;return(0,t.jsx)("div",{style:{position:m?"relative":"absolute",width:d?`${d}px`:"100%",bottom:"0px"},children:p.map(y=>{const{key:u,...D}=y.getFooterGroupProps();return(0,n.createElement)("div",{className:v.tfoot,...D,key:u,"data-testid":l.footer},y.headers.map(E=>o(E,v)))})})}function o(f,d){const{key:p,...m}=f.getHeaderProps();return m?(m.style=m.style??{},m.style.position="absolute",m.style.justifyContent=f.justifyContent,(0,t.jsx)("div",{className:d.headerCell,...m,children:f.render("Footer")},p)):null}function h(f,d,p){if(d===void 0)return a;if(p){if(d[f]===void 0)return a;const m=i.AS.get(i.gy.count).name;return g({value:[{[m]:String(d[f])}]})}return g({value:d[f]})}},30355:(k,R,e)=>{"use strict";e.d(R,{a:()=>d,t:()=>f});var t=e(74848),n=e(58563),i=e(14236),s=e(11261),r=e(52622),g=e(40845),a=e(29413),c=e(9286),o=e(5926),h=e(57021);const f={type:r.ob.Sparkline,drawStyle:r.GR.Line,lineInterpolation:r.dx.Smooth,lineWidth:1,fillOpacity:17,gradientMode:r.on.Hue,pointSize:2,barAlignment:r.Nj.Center,showPoints:r.yL.Never,hideValue:!1},d=v=>{const{field:l,innerWidth:y,tableStyles:u,cell:D,cellProps:E,timeRange:x}=v,P=p(D.value),b=(0,g.$j)();if(!P)return(0,t.jsx)("div",{...E,className:u.cellContainer,children:l.config.noValue||"no data"});P.x&&!P.x.config.interval&&P.x.values.length>1&&(P.x.config.interval=P.x.values[1]-P.x.values[0]),P.y.values=P.y.values.map(A=>Number.isFinite(A)?A:null);const M=(0,n.AP)(P.y);P.y.config.min=M.min,P.y.config.max=M.max,P.y.state={range:M},P.timeRange=x;const O=m(l),I={color:l.config.color,custom:{...f,...O}},T=l.config.custom?.cellOptions?.hideValue;let C=0,S=null;if(!T){const A=(0,i.LI)(D.value)?D.value.value:null,L=l.display(A),N=(0,h.zi)(l,L,D.row.index);C=(0,a.kD)(`${N.prefix??""}${N.text}${N.suffix??""}`,16).width+b.spacing.gridSize,S=(0,t.jsx)(c.i,{style:{width:`${C-b.spacing.gridSize}px`,textAlign:"right",marginRight:b.spacing(1)},value:L})}return(0,t.jsxs)("div",{...E,className:u.cellContainer,children:[S,(0,t.jsx)("div",{children:(0,t.jsx)(o.O,{width:y-C,height:u.cellHeightInner,sparkline:P,config:I,theme:u.theme})})]})};function p(v){if(Array.isArray(v))return{y:{name:"test",type:s.PU.number,values:v,config:{}}};if((0,i.ci)(v)){const l=v.fields.find(u=>u.type===s.PU.time),y=v.fields.find(u=>u.type===s.PU.number);if(l&&y)return{x:l,y}}}function m(v){let l=(0,h.bk)(v);if(l.type===r.ob.Auto&&(l={...l,type:r.ob.Sparkline}),l.type===r.ob.Sparkline)return l;throw new Error(`Expected options type ${r.ob.Sparkline} but got ${l.type}`)}},77093:(k,R,e)=>{"use strict";e.d(R,{X:()=>Ye});var t=e(74848),n=e(96540),i=e(32885),s=e(75059),r=e(11261),g=e(19845),a=e(13544),c=e(52622),o=e(40845),h=e(40276),f=e(19384),d=e(92015),p=e(4025),m=e(14578),v=e(32196),l=e(13840),y=e(91793),u=e(83195),D=e(67061),E=e(67647),x=e(9261),P=e(10880),b=e(60029);const M=28,O=M*5,I={Contains:{label:"Contains",value:"Contains",description:"Contains"},"=":{label:"=",value:"=",description:"Equals"},"!=":{label:"!=",value:"!=",description:"Not equals"},">":{label:">",value:">",description:"Greater"},">=":{label:">=",value:">=",description:"Greater or Equal"},"<":{label:"<",value:"<",description:"Less"},"<=":{label:"<=",value:"<=",description:"Less or Equal"},Expression:{label:"Expression",value:"Expression",description:'Bool Expression (Char $ represents the column value in the expression, e.g. "$ >= 10 && $ <= 12")'}},T=Object.values(I),C=I.Contains,S=I.Expression,A=je=>{if(je=je.trim().replace(/\\/g,""),/^(\d{4}-\d{2}-\d{2}|\d{4}\/\d{2}\/\d{2})/.test(je)){const Pe=new Date(je);if(!isNaN(Pe.getTime())){const Ue=(0,u.j_)("dateTimeAsIso");return(0,u.cN)(Ue(Pe.getTime()))}}const Ze=parseFloat(je);if(!isNaN(Ze))return Ze;const Ne=je.toLowerCase();return Ne==="true"||Ne==="false"?Ne==="true":je},L=({options:je,values:Ze,caseSensitive:Ne,showOperators:Pe,onChange:Ue,searchFilter:$e,setSearchFilter:ze,operator:qe,setOperator:dt})=>{const vt=(0,n.useMemo)(()=>new RegExp($e,Ne?void 0:"i"),[$e,Ne]),yt=(0,n.useMemo)(()=>je.filter(Ce=>{if(!Pe||!$e||qe.value===C.value)return Ce.label===void 0?!1:vt.test(Ce.label);if(qe.value===S.value){if(Ce.value===void 0)return!1;try{const We=$e.replace(/\\/g,""),et=new Function("$",`'use strict'; return ${We};`),rt=A(Ce.value);return et(rt)}catch{}return!1}else{if(Ce.value===void 0)return!1;const We=A(Ce.value),et=A($e);switch(qe.value){case"=":return We===et;case"!=":return We!==et;case">":return We>et;case">=":return We>=et;case"<":return We<et;case"<=":return We<=et}return!1}}),[je,vt,Pe,qe,$e]),st=(0,n.useMemo)(()=>yt.filter(Ce=>Ze.includes(Ce)),[yt,Ze]),Ve=(0,n.useMemo)(()=>yt.length===st.length,[yt,st]),pe=(0,n.useMemo)(()=>st.length>0&&yt.length>st.length,[yt,st]),Ee=(0,n.useMemo)(()=>st.length?`${st.length} selected`:"Select all",[st]),me=(0,n.useMemo)(()=>yt.length!==st.length?"Add all displayed values to the filter":"Remove all displayed values from the filter",[yt,st]),ve=(0,o.of)(F),Ie=(0,o.$j)().spacing.gridSize,Oe=(0,n.useMemo)(()=>Math.min(yt.length*M,O)+Ie,[Ie,yt.length]),Re=(0,n.useCallback)(Ce=>We=>{const et=We.currentTarget.checked?Ze.concat(Ce):Ze.filter(rt=>rt.value!==Ce.value);Ue(et)},[Ue,Ze]),he=(0,n.useCallback)(()=>{if(yt.length===st.length){const Ce=Ze.filter(We=>!yt.includes(We));Ue(Ce)}else{const Ce=[...new Set([...Ze,...yt])];Ue(Ce)}},[Ue,Ze,yt,st]);return(0,t.jsxs)(D.B,{direction:"column",gap:.25,children:[!Pe&&(0,t.jsx)(E.Z,{placeholder:"Filter values",onChange:ze,value:$e}),Pe&&(0,t.jsxs)(D.B,{direction:"row",gap:0,children:[(0,t.jsx)(x.f,{variant:"canvas",options:T,onChange:dt,value:qe,tooltip:qe.description}),(0,t.jsx)(E.Z,{placeholder:"Filter values",onChange:ze,value:$e})]}),yt.length>0?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(y.Y1,{height:Oe,itemCount:yt.length,itemSize:M,itemData:{items:yt,values:st,onCheckedChanged:Re,className:ve.filterListRow},width:"100%",className:ve.filterList,children:N}),(0,t.jsxs)(D.B,{direction:"column",gap:.25,children:[(0,t.jsx)("div",{className:(0,v.cx)(ve.selectDivider)}),(0,t.jsx)("div",{className:(0,v.cx)(ve.filterListRow),children:(0,t.jsx)(P.S,{value:Ve,indeterminate:pe,label:Ee,description:me,onChange:he})})]})]}):(0,t.jsx)(b.J,{className:ve.noValuesLabel,children:"No values"})]})};function N({index:je,style:Ze,data:{onCheckedChanged:Ne,items:Pe,values:Ue,className:$e}}){const ze=Pe[je],{value:qe,label:dt}=ze,vt=Ue.find(yt=>yt.value===qe)!==void 0;return(0,t.jsx)("div",{className:$e,style:Ze,title:dt,children:(0,t.jsx)(P.S,{value:vt,label:dt,onChange:Ne(ze)})})}const F=je=>({filterList:(0,v.css)({label:"filterList"}),filterListRow:(0,v.css)({label:"filterListRow",cursor:"pointer",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",padding:je.spacing(.5),":hover":{backgroundColor:je.colors.action.hover}}),selectDivider:(0,v.css)({label:"selectDivider",width:"100%",borderTop:`1px solid ${je.colors.border.medium}`,padding:je.spacing(.5,2)}),noValuesLabel:(0,v.css)({paddingTop:je.spacing(1)})});var w=e(8866),B=e(29158),U=e(55852),K=e(57021);const V=({column:{preFilteredRows:je,filterValue:Ze,setFilter:Ne},onClose:Pe,field:Ue,searchFilter:$e,setSearchFilter:ze,operator:qe,setOperator:dt})=>{const vt=(0,o.$j)(),yt=(0,n.useMemo)(()=>(0,K.MY)(je,Ue),[je,Ue]),st=(0,n.useMemo)(()=>(0,K.Yz)(yt),[yt]),Ve=(0,n.useMemo)(()=>(0,K.Sj)(st,Ze),[st,Ze]),[pe,Ee]=(0,n.useState)(Ve),[me,ve]=(0,n.useState)(!1),Se=(0,n.useCallback)(Ce=>Pe(),[Pe]),Ie=(0,n.useCallback)(Ce=>{const We=pe.length?pe:void 0;Ne(We),Pe()},[Ne,pe,Pe]),Oe=(0,n.useCallback)(Ce=>{Ne(void 0),Pe()},[Ne,Pe]),Re=(0,n.useMemo)(()=>Ze!==void 0,[Ze]),he=(0,o.of)(H);return(0,t.jsx)(w.N,{onClick:Se,useCapture:!0,children:(0,t.jsx)("div",{className:(0,v.cx)(he.filterContainer),onClick:Y,children:(0,t.jsxs)(D.B,{direction:"column",gap:3,children:[(0,t.jsxs)(D.B,{direction:"column",gap:.5,children:[(0,t.jsxs)(D.B,{justifyContent:"space-between",alignItems:"center",children:[(0,t.jsx)(b.J,{className:he.label,children:"Filter by values:"}),(0,t.jsx)(B.K,{name:"text-fields",tooltip:"Match case",style:{color:me?vt.colors.text.link:vt.colors.text.disabled},onClick:()=>{ve(Ce=>!Ce)}})]}),(0,t.jsx)("div",{className:(0,v.cx)(he.listDivider)}),(0,t.jsx)(L,{onChange:Ee,values:pe,options:st,caseSensitive:me,showOperators:!0,searchFilter:$e,setSearchFilter:ze,operator:qe,setOperator:dt})]}),(0,t.jsxs)(D.B,{gap:3,children:[(0,t.jsxs)(D.B,{children:[(0,t.jsx)(U.$n,{size:"sm",onClick:Ie,children:"Ok"}),(0,t.jsx)(U.$n,{size:"sm",variant:"secondary",onClick:Se,children:"Cancel"})]}),Re&&(0,t.jsx)(D.B,{children:(0,t.jsx)(U.$n,{fill:"text",size:"sm",onClick:Oe,children:"Clear filter"})})]})]})})})},H=je=>({filterContainer:(0,v.css)({label:"filterContainer",width:"100%",minWidth:"250px",height:"100%",maxHeight:"400px",backgroundColor:je.colors.background.primary,border:`1px solid ${je.colors.border.weak}`,padding:je.spacing(2),boxShadow:je.shadows.z3,borderRadius:je.shape.radius.default}),listDivider:(0,v.css)({label:"listDivider",width:"100%",borderTop:`1px solid ${je.colors.border.medium}`,padding:je.spacing(.5,2)}),label:(0,v.css)({marginBottom:0})}),Y=je=>{je.stopPropagation()},X=({column:je,field:Ze,tableStyles:Ne})=>{const Pe=(0,n.useRef)(null),[Ue,$e]=(0,n.useState)(!1),ze=(0,o.of)(J),qe=(0,n.useMemo)(()=>!!je.filterValue,[je.filterValue]),dt=(0,n.useCallback)(()=>$e(!0),[$e]),vt=(0,n.useCallback)(()=>$e(!1),[$e]),[yt,st]=(0,n.useState)(""),[Ve,pe]=(0,n.useState)(C);return!Ze||!Ze.config.custom?.filterable?null:(0,t.jsxs)("button",{className:(0,v.cx)(Ne.headerFilter,qe?ze.filterIconEnabled:ze.filterIconDisabled),ref:Pe,type:"button",onClick:dt,children:[(0,t.jsx)(m.I,{name:"filter"}),Ue&&Pe.current&&(0,t.jsx)(l.A,{content:(0,t.jsx)(V,{column:je,tableStyles:Ne,field:Ze,onClose:vt,searchFilter:yt,setSearchFilter:st,operator:Ve,setOperator:pe}),placement:"bottom-start",referenceElement:Pe.current,show:!0})]})},J=je=>({filterIconEnabled:(0,v.css)({label:"filterIconEnabled",color:je.colors.primary.text}),filterIconDisabled:(0,v.css)({label:"filterIconDisabled",color:je.colors.text.disabled})}),q=je=>{const{headerGroups:Ze,showTypeIcons:Ne,tableStyles:Pe}=je,Ue=a.Tp.components.Panels.Visualization.Table;return(0,t.jsx)("div",{role:"rowgroup",className:Pe.headerRow,children:Ze.map($e=>{const{key:ze,...qe}=$e.getHeaderGroupProps();return(0,n.createElement)("div",{className:Pe.thead,...qe,key:ze,"aria-label":Ue.header,role:"row"},$e.headers.map((dt,vt)=>ae(dt,Pe,Ne)))})})};function ae(je,Ze,Ne){const{key:Pe,...Ue}=je.getHeaderProps(),$e=je.field??null,ze=$e?.config.custom;je.canResize&&(Ue.style.userSelect=je.isResizing?"none":"auto"),Ue.style.position="absolute",Ue.style.justifyContent=je.justifyContent,Ue.style.left=je.totalLeft;let qe=je.render("Header"),dt=je.canSort&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("button",{...je.getSortByToggleProps(),className:Ze.headerCellLabel,children:[Ne&&(0,t.jsx)(m.I,{name:(0,p.SS)($e),title:$e?.type,size:"sm",className:Ze.typeIcon}),(0,t.jsx)("div",{children:qe}),je.isSorted&&(je.isSortedDesc?(0,t.jsx)(m.I,{size:"lg",name:"arrow-down",className:Ze.sortIcon}):(0,t.jsx)(m.I,{name:"arrow-up",size:"lg",className:Ze.sortIcon}))]}),je.canFilter&&(0,t.jsx)(X,{column:je,tableStyles:Ze,field:$e})]});return dt&&ze?.headerComponent?dt=(0,t.jsx)(ze.headerComponent,{field:$e,defaultContent:dt}):ze?.headerComponent&&(qe=(0,t.jsx)(ze.headerComponent,{field:$e,defaultContent:qe})),(0,t.jsxs)("div",{className:Ze.headerCell,...Ue,role:"columnheader",children:[je.canSort&&dt,!je.canSort&&qe,!je.canSort&&je.canFilter&&(0,t.jsx)(X,{column:je,tableStyles:Ze,field:$e}),je.canResize&&(0,t.jsx)("div",{...je.getResizerProps(),className:Ze.resizeHandle})]},Pe)}var j=e(64423),te=e(56978),ne=e(69129),le=e(79041);function z({tableStyles:je,nestedData:Ze,rowIndex:Ne,width:Pe,cellHeight:Ue}){const $e=Ze.values,ze=[],qe=(0,o.$j)(),dt=(0,o.of)(ee);let vt=je.rowHeight+qe.spacing.gridSize;return $e[Ne].forEach((yt,st)=>{const Ve=!!yt.meta?.custom?.noHeader,pe=je.rowHeight*(yt.length+(Ve?0:1)),Ee={height:pe,paddingLeft:K.jV,position:"absolute",top:vt};vt+=pe+qe.spacing.gridSize,ze.push((0,t.jsx)("div",{style:Ee,children:(0,t.jsx)(Ye,{data:yt,width:Pe-K.jV,height:je.rowHeight*(yt.length+1),noHeader:Ve,cellHeight:Ue})},`subTable_${Ne}_${st}`))}),(0,t.jsx)("div",{className:dt.subTables,children:ze})}const ee=je=>({subTables:(0,v.css)({"&:before":{content:'""',position:"absolute",width:"1px",top:je.spacing(5),left:je.spacing(1),bottom:je.spacing(2),background:je.colors.border.medium}})});function se(je,Ze,Ne){return je.values[Ze].reduce(($e,ze)=>{if(ze.length){const qe=!!ze.meta?.custom?.noHeader;return $e+Ne.rowHeight*(ze.length+(qe?0:1))+8}return $e},Ne.rowHeight)??Ne.rowHeight}var ie=e(49618);const Z=je=>{const{data:Ze,rows:Ne,headerHeight:Pe,footerPaginationEnabled:Ue,rowHeight:$e,itemCount:ze,pageIndex:qe,tableState:dt,prepareRow:vt,onCellFilterAdded:yt,width:st,cellHeight:Ve=c.qM.Sm,timeRange:pe,tableStyles:Ee,nestedDataField:me,listHeight:ve,listRef:Se,enableSharedCrosshair:Ie=!1,initialRowIndex:Oe=void 0,headerGroups:Re,longestField:he}=je,[Ce,We]=(0,n.useState)(Oe);Oe===void 0&&Ce!==void 0&&We(void 0);const et=(0,o.$j)(),rt=(0,le.d2)();let nt=null;window.OffscreenCanvas!==void 0&&(nt=new OffscreenCanvas(256,1024).getContext("2d")),nt!=null&&(nt.font=`${et.typography.fontSize}px ${et.typography.body.fontFamily}`);const gt=(0,n.useMemo)(()=>{const pt=Ze.fields.find(Pt=>Pt.type===r.PU.time);return pt?(0,K.HY)(pt):0},[Ze]),xt=(0,n.useCallback)((pt,Pt)=>{if(!rt||!Ie||!(0,g.S1)(Pt))return;const At=Pt.fields.find(mn=>mn.type===r.PU.time);rt.eventBus.publish(new ne.b_({point:{time:At.values[pt]}}))},[Ie,rt]),St=(0,n.useCallback)(()=>{!rt||!Ie||rt.eventBus.publish(new ne.ql)},[Ie,rt]),zt=(0,n.useCallback)(pt=>{if(pt.payload.point?.time&&pt.payload.rowIndex!==void 0){const Pt=Ze.fields.find(fn=>fn.type===r.PU.time),At=Pt.values[pt.payload.rowIndex],mn=pt.payload.point.time;if((0,K.Iy)(mn,At,gt)){We(pt.payload.rowIndex);return}const Pn=Pt.values.findIndex(fn=>(0,K.Iy)(mn,fn,gt));if(Pn!==-1){We(Pn);return}We(void 0)}},[Ze.fields,gt]);(0,n.useEffect)(()=>{if(!rt||!Ie||!(0,g.S1)(Ze)||Ue)return;const pt=new j.yU;return pt.add(rt.eventBus.getStream(ne.b_).pipe((0,te.B)(250)).subscribe({next:Pt=>{rt.eventBus!==Pt.origin&&zt(Pt)}})),pt.add(rt.eventBus.getStream(ne.ql).pipe((0,te.B)(250)).subscribe({next:Pt=>{rt.eventBus!==Pt.origin&&We(void 0)}})),()=>{pt.unsubscribe()}},[Ze,Ie,Ue,zt,rt]);let Nt;if(Ce!==void 0){const pt=Ne.findIndex(Pt=>Pt.index===Ce);pt!==-1&&(Nt=Pe+(pt-1)*$e)}const Vt=(0,n.useCallback)(pt=>dt.pageIndex*dt.pageSize+pt,[dt.pageIndex,dt.pageSize]);let en,Je;for(const pt of Ze.fields){const Pt=pt.config.custom,At=Pt!==void 0&&Pt.cellOptions!==void 0;At&&Pt.cellOptions.type===c.ob.ColorBackground&&Pt.cellOptions.applyToRow&&(en=mn=>{const Pn=pt.display(pt.values.get(mn));return(0,K.HW)(Ee,Pt.cellOptions,Pn)}),At&&(Pt.cellOptions.type===c.ob.Auto||Pt.cellOptions.type===c.ob.ColorBackground||Pt.cellOptions.type===c.ob.ColorText)&&Pt.cellOptions.wrapText?Je=pt:he!==void 0&&(Je=he)}const ct=(0,n.useCallback)(({index:pt,style:Pt,rowHighlightIndex:At})=>{const mn=Vt(pt),Pn=Ne[mn];let fn={};vt(Pn);const Rn=dt.expanded[Pn.id]?(0,v.css)({"&:hover":{background:"inherit"}}):{},Kn=me&&dt.expanded[Pn.id];if(At!==void 0&&Pn.index===At&&(Pt={...Pt,backgroundColor:et.components.table.rowSelected},fn={"aria-selected":"true"}),en){const{bgColor:tn,textColor:Cn}=en(Pn.index);Pt.background=tn,Pt.color=Cn}if(Je){const Cn=Ze.fields.filter(Et=>!Et.config.custom?.hidden).findIndex(Et=>Et.name===Je.name),xn=et.typography.body.lineHeight*et.typography.fontSize,Vn=(0,K.M2)(Je.values[pt],Re[0].headers[Cn],nt,xn,Ee.rowHeight);Pt.height=Vn.height}const{key:Bt,...an}=Pn.getRowProps({style:Pt,...fn});return(0,t.jsxs)("div",{...an,className:(0,v.cx)(Ee.row,Rn),onMouseEnter:()=>xt(pt,Ze),onMouseLeave:St,children:[Kn&&(0,t.jsx)(z,{nestedData:me,tableStyles:Ee,rowIndex:Pn.index,width:st,cellHeight:Ve}),Pn.cells.map((tn,Cn)=>(0,t.jsx)(ie.n,{tableStyles:Ee,cell:tn,onCellFilterAdded:yt,columnIndex:Cn,columnCount:Pn.cells.length,timeRange:pe,frame:Ze,rowStyled:en!==void 0,rowExpanded:Kn,textWrapped:Je!==void 0,height:Number(Pt.height)},Cn))]},Bt)},[Ve,Ze,me,yt,xt,St,vt,Vt,Ne,dt.expanded,Ee,Je,et.components.table.rowSelected,et.typography.fontSize,et.typography.body.lineHeight,pe,st,en,Re,nt]),ot=pt=>{const Pt=Vt(pt),At=Ne[Pt];if(dt.expanded[At.id]&&me)return se(me,At.index,Ee);if(Je){const Pn=Ze.fields.filter(Rn=>!Rn.config.custom?.hidden).findIndex(Rn=>Rn.name===Je.name),fn=et.typography.fontSize*et.typography.body.lineHeight;return(0,K.M2)(Je.values[pt],Re[0].headers[Pn],nt,fn,Ee.rowHeight).height}return Ee.rowHeight},Qe=pt=>{const{scrollTop:Pt}=pt.currentTarget;Se.current!==null&&Se.current.scrollTo(Pt)};return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(h.A,{onScroll:Qe,hideHorizontalTrack:!0,scrollTop:Nt,children:(0,t.jsx)(y._m,{height:ve,itemCount:ze,itemSize:ot,width:"100%",ref:Se,style:{overflow:void 0},children:({index:pt,style:Pt})=>ct({index:pt,style:Pt,rowHighlightIndex:Ce})},$e+qe)})})};function oe(je,Ze){(0,n.useEffect)(()=>{if(je.current&&Ze.current){const Ne=je.current.querySelector(".track-vertical"),Pe=Ze.current.firstChild;Pe&&Ne&&(Ne.remove(),Pe instanceof HTMLElement&&(Pe.querySelector(":scope > .track-vertical")?.remove(),Pe.append(Ne)))}})}function ce(je,Ze,Ne,Pe){const Ue=JSON.stringify(Object.keys(je.expanded));(0,n.useEffect)(()=>{let $e=0;Pe||(Number.isFinite(je.lastExpandedOrCollapsedIndex)&&($e=je.lastExpandedOrCollapsedIndex),$e=je.pageIndex===0?$e-1:$e-je.pageIndex-je.pageIndex*je.pageSize),Ze.current?.resetAfterIndex(Math.max($e,0))},[je.lastExpandedOrCollapsedIndex,je.pageSize,je.pageIndex,Ze,Ne,Ue,Pe])}var ye=e(28240);function re({onColumnResize:je,onSortByChange:Ze,data:Ne}){return(0,n.useCallback)((Pe,Ue)=>{switch(Ue.type){case"columnDoneResizing":if(je){const ze=Pe.columnResizing?.headerIdWidths?.[0]?.[0],qe=parseInt(ze,10),dt=Math.round(Pe.columnResizing.columnWidths?.[ze]),vt=Ne.fields?.[qe];if(!vt)return Pe;const yt=(0,ye.Ct)(vt,Ne);je(yt,dt)}case"toggleSortBy":if(Ze){const $e=[];for(const ze of Pe.sortBy){const qe=Ne.fields[parseInt(ze.id,10)];qe&&$e.push({displayName:(0,ye.Ct)(qe,Ne),desc:ze.desc})}Ze($e)}case"toggleRowExpanded":if(Ue.id)return{...Pe,lastExpandedOrCollapsedIndex:parseInt(Ue.id,10)}}return Pe},[Ne,je,Ze])}function ue(je,Ze){const Ne={};if(je){Ne.sortBy=[];for(const Pe of je)for(const Ue of Ze)Ue.Header===Pe.displayName&&Ne.sortBy.push({id:Ue.id,desc:Pe.desc})}return Ne}var De=e(69770);const ge=150,Te=36,Le="No data",Ye=(0,n.memo)(je=>{const{ariaLabel:Ze,data:Ne,height:Pe,onCellFilterAdded:Ue,width:$e,columnMinWidth:ze=ge,noHeader:qe,resizable:dt=!0,initialSortBy:vt,footerOptions:yt,showTypeIcons:st,footerValues:Ve,enablePagination:pe,cellHeight:Ee=c.qM.Sm,timeRange:me,enableSharedCrosshair:ve=!1,initialRowIndex:Se=void 0,fieldConfig:Ie}=je,Oe=(0,n.useRef)(null),Re=(0,n.useRef)(null),he=(0,n.useRef)(null),Ce=(0,o.$j)(),We=(0,De.k)(Ce,Ee),et=qe?0:We.rowHeight,[rt,nt]=(0,n.useState)(Ve),gt=Ie?.defaults?.noValue??Le,xt=(0,n.useMemo)(()=>{const cn=Te;let En=0;if(!rt)return 0;for(const Sn of rt)Array.isArray(Sn)&&Sn.length>En&&(En=Sn.length);return En>1?cn*En:cn},[rt]),St=(0,n.useMemo)(()=>Ne.fields.length?Array(Ne.length).fill(0):[],[Ne]),zt=!!(yt?.countRows&&yt.reducer&&yt.reducer.length&&yt.reducer[0]===s.gy.count),Nt=Ne.fields.find(cn=>cn.type===r.PU.nestedFrames),Vt=Nt!==void 0,en=(0,n.useMemo)(()=>(0,K.GH)(Ne,$e,ze,Vt,rt,zt),[Ne,$e,ze,rt,Vt,zt]),Je=(0,n.useRef)(),ct=re({...je,onSortByChange:cn=>{Je.current(!1),je.onSortByChange&&je.onSortByChange(cn)}}),ot=!!Ne.meta?.uniqueRowIdFields?.length,Qe=(0,n.useMemo)(()=>{const cn={columns:en,data:St,disableResizing:!dt,stateReducer:ct,autoResetPage:!1,initialState:ue(vt,en),autoResetFilters:!1,sortTypes:{number:K.Ok,"alphanumeric-insensitive":K.IM}};return ot&&(cn.getRowId=(En,Sn)=>(0,g.t9)(Ne,Sn),cn.autoResetExpanded=!1),cn},[vt,en,St,dt,ct,ot,Ne]),{getTableProps:pt,headerGroups:Pt,footerGroups:At,rows:mn,prepareRow:Pn,totalColumnsWidth:fn,page:Rn,state:Kn,gotoPage:Bt,setPageSize:an,pageOptions:tn,toggleAllRowsExpanded:Cn}=(0,i.useTable)(Qe,i.useFilters,i.useSortBy,i.useAbsoluteLayout,i.useResizeColumns,i.useExpanded,i.usePagination),xn=Kn;Je.current=Cn,(0,n.useEffect)(()=>{yt||nt(Ve)},[Ve,yt]),(0,n.useEffect)(()=>{if(!yt)return;if(!yt.show){nt(void 0);return}if(zt){const En=[];En[0]=mn.length.toString()??Ne.length.toString(),nt(En);return}const cn=(0,K.Ux)(Pt[0].headers,(0,K.XX)(mn),yt,Ce);nt(cn)},[yt,Ce,Kn.filters,Ne]);let Vn=Pe-(et+xt);pe&&(Vn-=We.cellHeight);const Et=Math.round(Vn/We.rowHeight)-1;(0,n.useEffect)(()=>{Et<=0||an(Et)},[Et,an]),(0,n.useEffect)(()=>{Ne.length/Et<Kn.pageIndex&&Bt(0)},[Ne]),ce(xn,Oe,Ne,ot),oe(he,Re);const Ft=(0,n.useCallback)(cn=>{Bt(cn-1)},[Bt]),Gt=pe?Rn.length:mn.length;let ln=null;if(pe){const cn=Kn.pageIndex*Kn.pageSize+1;let En=cn+Kn.pageSize-1;const Sn=$e<550;En>Ne.length&&(En=Ne.length),ln=(0,t.jsxs)("div",{className:We.paginationWrapper,children:[(0,t.jsx)(f.d,{currentPage:Kn.pageIndex+1,numberOfPages:tn.length,showSmallVersion:Sn,onNavigate:Ft}),Sn?null:(0,t.jsxs)("div",{className:We.paginationSummary,children:[cn," - ",En<mn.length?En:mn.length," of ",mn.length," rows"]})]})}const qt=(0,K.O4)(Ie,Ne);return(0,t.jsxs)("div",{...pt(),className:We.table,"aria-label":Ze,role:"table",ref:Re,style:{width:$e,height:Pe},children:[(0,t.jsx)(h.E,{hideVerticalTrack:!0,children:(0,t.jsxs)("div",{className:We.tableContentWrapper(fn),children:[!qe&&(0,t.jsx)(q,{headerGroups:Pt,showTypeIcons:st,tableStyles:We}),Gt>0?(0,t.jsx)("div",{"data-testid":a.Tp.components.Panels.Visualization.Table.body,ref:he,children:(0,t.jsx)(Z,{headerGroups:Pt,data:Ne,rows:mn,width:$e,cellHeight:Ee,headerHeight:et,rowHeight:We.rowHeight,itemCount:Gt,pageIndex:Kn.pageIndex,listHeight:Vn,listRef:Oe,tableState:Kn,prepareRow:Pn,timeRange:me,onCellFilterAdded:Ue,nestedDataField:Nt,tableStyles:We,footerPaginationEnabled:!!pe,enableSharedCrosshair:ve,initialRowIndex:Se,longestField:qt})}):(0,t.jsx)("div",{style:{height:Pe-et,width:$e},className:We.noData,children:gt}),rt&&(0,t.jsx)(d.u,{isPaginationVisible:!!pe,footerValues:rt,footerGroups:At,totalColumnsWidth:fn,tableStyles:We})]})}),ln]})});Ye.displayName="Table"},49618:(k,R,e)=>{"use strict";e.d(R,{n:()=>n});var t=e(74848);const n=({cell:i,tableStyles:s,onCellFilterAdded:r,timeRange:g,userProps:a,frame:c,rowStyled:o,rowExpanded:h,textWrapped:f,height:d})=>{const p=i.getCellProps(),m=i.column.field;if(!m?.display)return null;if(p.style){p.style.minWidth=p.style.width;const l=i.column.justifyContent;l==="flex-end"&&!m.config.unit?(p.style.textAlign="right",p.style.direction="rtl",p.style.unicodeBidi="plaintext"):p.style.justifyContent=l}let v=(typeof i.column.width=="number"?i.column.width:24)-s.cellPadding*2;return(0,t.jsx)(t.Fragment,{children:i.render("Cell",{field:m,tableStyles:s,onCellFilterAdded:r,cellProps:p,innerWidth:v,timeRange:g,userProps:a,frame:c,rowStyled:o,rowExpanded:h,textWrapped:f,height:d})})}},69770:(k,R,e)=>{"use strict";e.d(R,{k:()=>n});var t=e(32196);function n(s,r){const g=s.colors.border.weak,a=s.colors.primary.border,c=6,o=i(s,r,c),h=o+2,f=28,d=(p,m,v,l,y,u,D,E,x)=>(0,t.css)({label:l?"cellContainerOverflow":"cellContainerNoOverflow",padding:`${c}px`,width:"100%",height:x?"auto !important":`${h-1}px`,wordBreak:D?"break-all":"inherit",display:"flex",...y?{overflow:"hidden",textOverflow:"ellipsis",userSelect:"text",whiteSpace:"nowrap"}:{},alignItems:"center",borderRight:`1px solid ${g}`,color:E?"inherit":p??void 0,background:E?void 0:m??void 0,backgroundClip:"padding-box","&:last-child:not(:only-child)":{borderRight:"none"},"&:hover":{overflow:l&&!D?"visible":void 0,width:u||!l?"auto":"auto !important",height:(u||l)&&!D?"auto !important":`${h-1}px`,minHeight:`${h-1}px`,wordBreak:u?"break-word":void 0,whiteSpace:u&&l?"normal":"nowrap",boxShadow:l?`0 0 2px ${s.colors.primary.main}`:void 0,background:E?"inherit":v??s.colors.background.primary,zIndex:1,".cellActions":{color:"#FFF",visibility:"visible",opacity:1,width:"auto",background:"rgba(0, 0, 0, 0.6)"}},a:{color:"inherit"},".cellActions":{display:"flex",position:l?void 0:"absolute",top:l?void 0:"1px",right:l?void 0:0,margin:l?s.spacing(0,-.5,0,.5):"auto",visibility:"hidden",opacity:0,width:0,alignItems:"center",height:"100%",padding:s.spacing(1,.5,1,1),background:m?"none":"rgba(0, 0, 0, 0.5)",svg:{color:p}},".cellActionsLeft":{right:"auto !important",left:0},".cellActionsTransparent":{background:"none"}});return{theme:s,cellHeight:o,buildCellContainerStyle:d,cellPadding:c,cellHeightInner:o-c*2,rowHeight:h,table:(0,t.css)({height:"100%",width:"100%",overflow:"auto",display:"flex",flexDirection:"column"}),thead:(0,t.css)({label:"thead",height:`${f}px`,overflowY:"auto",overflowX:"hidden",position:"relative"}),tfoot:(0,t.css)({label:"tfoot",height:`${f}px`,borderTop:`1px solid ${g}`,overflowY:"auto",overflowX:"hidden",position:"relative"}),headerRow:(0,t.css)({label:"row",borderBottom:`1px solid ${g}`}),headerCell:(0,t.css)({height:"100%",padding:`0 ${c}px`,overflow:"hidden",whiteSpace:"nowrap",display:"flex",alignItems:"center",fontWeight:s.typography.fontWeightMedium,"&:last-child":{borderRight:"none"}}),headerCellLabel:(0,t.css)({border:"none",padding:0,background:"inherit",cursor:"pointer",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",fontWeight:s.typography.fontWeightMedium,display:"flex",alignItems:"center",marginRight:s.spacing(.5),"&:hover":{textDecoration:"underline",color:s.colors.text.link}}),cellContainerText:d(void 0,void 0,void 0,!0,!0),cellContainerTextNoOverflow:d(void 0,void 0,void 0,!1,!0),cellContainer:d(void 0,void 0,void 0,!0,!1),cellContainerNoOverflow:d(void 0,void 0,void 0,!1,!1),cellText:(0,t.css)({overflow:"hidden",textOverflow:"ellipsis",userSelect:"text",whiteSpace:"nowrap"}),sortIcon:(0,t.css)({marginLeft:s.spacing(.5)}),cellLink:(0,t.css)({cursor:"pointer",overflow:"hidden",textOverflow:"ellipsis",userSelect:"text",whiteSpace:"nowrap",color:s.colors.text.link,fontWeight:s.typography.fontWeightMedium,paddingRight:s.spacing(1.5),"&:hover":{textDecoration:"underline",color:s.colors.text.link}}),cellLinkForColoredCell:(0,t.css)({cursor:"pointer",overflow:"hidden",textOverflow:"ellipsis",userSelect:"text",whiteSpace:"nowrap",fontWeight:s.typography.fontWeightMedium,textDecoration:"underline"}),imageCellLink:(0,t.css)({cursor:"pointer",overflow:"hidden",height:"100%"}),headerFilter:(0,t.css)({background:"transparent",border:"none",label:"headerFilter",padding:0}),paginationWrapper:(0,t.css)({display:"flex",height:`${o}px`,justifyContent:"center",alignItems:"center",width:"100%",li:{marginBottom:0}}),paginationSummary:(0,t.css)({color:s.colors.text.secondary,fontSize:s.typography.bodySmall.fontSize,display:"flex",justifyContent:"flex-end",padding:s.spacing(0,1,0,2)}),tableContentWrapper:p=>{const m=p!==void 0?`${p}px`:"100%";return(0,t.css)({label:"tableContentWrapper",width:m,display:"flex",flexDirection:"column"})},row:(0,t.css)({label:"row",borderBottom:`1px solid ${g}`,"&:hover":{backgroundColor:s.components.table.rowHoverBackground},"&:last-child":{borderBottom:0}}),imageCell:(0,t.css)({height:"100%"}),resizeHandle:(0,t.css)({label:"resizeHandle",cursor:"col-resize !important",display:"inline-block",background:a,opacity:0,[s.transitions.handleMotion("no-preference","reduce")]:{transition:"opacity 0.2s ease-in-out"},width:"8px",height:"100%",position:"absolute",right:"-4px",borderRadius:s.shape.radius.default,top:0,touchAction:"none","&:hover":{opacity:1}}),typeIcon:(0,t.css)({marginRight:s.spacing(1),color:s.colors.text.secondary}),noData:(0,t.css)({alignItems:"center",display:"flex",height:"100%",justifyContent:"center",width:"100%"}),expanderCell:(0,t.css)({display:"flex",flexDirection:"column",justifyContent:"center",height:`${h}px`,cursor:"pointer"})}}function i(s,r,g){const a=s.typography.fontSize,c=s.typography.body.lineHeight;switch(r){case"md":return 42;case"lg":return 48;case"sm":default:return g*2+a*c}}},88407:(k,R,e)=>{"use strict";e.d(R,{Zi:()=>n,mc:()=>t});const t="=",n="!="},57021:(k,R,e)=>{"use strict";e.d(R,{jV:()=>z,HY:()=>qe,MY:()=>oe,XX:()=>je,zi:()=>$e,HW:()=>dt,bk:()=>Ne,GH:()=>se,Sj:()=>ue,Ux:()=>Le,j1:()=>ee,O4:()=>yt,M2:()=>vt,Iy:()=>ze,o7:()=>Pe,IM:()=>De,Ok:()=>ge,Yz:()=>ye});var t=e(2543),n=e(47078),i=e.n(n),s=e(84140),r=e(11261),g=e(28240),a=e(14236),c=e(19845),o=e(83195),h=e(75059),f=e(57875),d=e(52622),p=e(24284),m=e(74848),v=e(50082),l=e(58563),y=e(47070),u=e(97696),D=e(59796);const E={mode:v.O.Absolute,steps:[{color:"blue",value:-1/0},{color:"green",value:20}]},x=st=>{const{field:Ve,innerWidth:pe,tableStyles:Ee,cell:me,cellProps:ve,row:Se}=st,Ie=Ve.display(me.value),Oe=Ne(Ve);let Re=(0,l.xg)(Ve,!1);Re.thresholds||(Re={...Re,thresholds:E});let he=d.eX.Gradient,Ce;Oe.type===d.ob.Gauge&&(he=Oe.mode??d.eX.Gradient,Ce=Oe.valueDisplayMode!==void 0?Oe.valueDisplayMode:d.$l.Text);const We=()=>(0,t.isFunction)(Ve.getLinks)?Ve.getLinks({valueRowIndex:Se.index}):[],et=!!We().length,rt=$e(Ve,Ie,me.row.index),nt=gt=>{const{openMenu:xt,targetClassName:St}=gt;return(0,m.jsx)(u.xE,{width:pe,height:Ee.cellHeightInner,field:Re,display:Ve.display,text:{valueSize:14},value:Ie,orientation:y.wV.Horizontal,theme:Ee.theme,alignmentFactors:rt,onClick:xt,className:St,itemSpacing:1,lcdCellWidth:8,displayMode:he,valueDisplayMode:Ce})};return(0,m.jsxs)("div",{...ve,className:Ee.cellContainer,children:[et&&(0,m.jsx)(D.e,{links:We,style:{display:"flex",width:"100%"},children:gt=>nt(gt)}),!et&&nt({})]})};var P=e(90914);const b=st=>{const{field:Ve,row:pe,cellProps:Ee,tableStyles:me}=st,ve=(0,P.k)(Ve,pe);return(0,m.jsx)("div",{...Ee,className:me.cellContainerText,children:ve&&ve.map((Se,Ie)=>(0,m.jsx)("span",{className:me.cellLink,onClick:Se.onClick,children:(0,m.jsx)("a",{href:Se.href,target:Se.target,children:Se.title})},Ie))})};var M=e(32196),O=e(96540),I=e(40845),T=e(55852),C=e(29158),S=e(67061),A=e(10534),L=e(87978),N=e(32372);function F({value:st,onDismiss:Ve,mode:pe}){let Ee=st;if((0,t.isString)(st)){const ve=st.trim();if(ve[0]==="{"||ve[0]==="["||pe==="code")try{st=JSON.parse(st),pe="code"}catch{pe="text"}else pe="text"}else Ee=JSON.stringify(st,null," ");let me=Ee;return pe==="code"&&(me=JSON.stringify(st,null," ")),(0,m.jsxs)(L._,{onClose:Ve,title:"Inspect value",children:[pe==="code"?(0,m.jsx)(N.B,{width:"100%",height:500,language:"json",showLineNumbers:!0,showMiniMap:(me&&me.length)>100,value:me,readOnly:!0}):(0,m.jsx)("pre",{children:me}),(0,m.jsx)(A.b,{icon:"copy",getText:()=>me,children:"Copy to Clipboard"})]})}var w=e(88407);function B({field:st,cell:Ve,previewMode:pe,showFilters:Ee,onCellFilterAdded:me}){const[ve,Se]=(0,O.useState)(!1),Ie=ee(st)==="flex-end",Oe=!!st.config.custom?.inspect,Re={size:"sm",tooltipPlacement:"top"},he=(0,O.useCallback)(We=>{me&&me({key:st.name,operator:w.mc,value:Ve.value})},[Ve,st,me]),Ce=(0,O.useCallback)(We=>{me&&me({key:st.name,operator:w.Zi,value:Ve.value})},[Ve,st,me]);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{className:`cellActions${Ie?" cellActionsLeft":""}`,children:(0,m.jsxs)(S.B,{gap:.5,children:[Oe&&(0,m.jsx)(C.K,{name:"eye",tooltip:"Inspect value",onClick:()=>{Se(!0)},...Re}),Ee&&(0,m.jsx)(C.K,{name:"search-plus",onClick:he,tooltip:"Filter for value",...Re}),Ee&&(0,m.jsx)(C.K,{name:"search-minus",onClick:Ce,tooltip:"Filter out value",...Re})]})}),ve&&(0,m.jsx)(F,{mode:pe,value:Ve.value,onDismiss:()=>{Se(!1)}})]})}const U=st=>{const{field:Ve,cell:pe,tableStyles:Ee,row:me,cellProps:ve,frame:Se,rowStyled:Ie,rowExpanded:Oe,textWrapped:Re,height:he}=st,Ce=!!Ve.config.custom?.inspect,We=Ve.display(pe.value),et=st.onCellFilterAdded&&Ve.config.filterable,rt=et&&pe.value!==void 0||Ce,nt=Ne(Ve),gt=!!(0,P.k)(Ve,me)?.length,xt=(0,I.of)(T.Ez),[St,zt]=(0,O.useState)(!1);let Nt;const Vt=140,en=()=>{zt(!1)},Je=()=>{zt(!0)};if(nt.type===d.ob.Custom){const At=nt.cellComponent;Nt=(0,m.jsx)(At,{field:Ve,value:pe.value,rowIndex:me.index,frame:Se})}else O.isValidElement(pe.value)?Nt=pe.value:Nt=(0,o.cN)(We);const ct=typeof Nt=="string",ot=We.text.length<=Vt&&/\s/.test(We.text),Qe=K(Ee,nt,We,Ce,ct,ot,Re,Ie,Oe);if(ct){let At=ve.style?.justifyContent;At==="flex-end"?ve.style={...ve.style,textAlign:"right"}:At==="center"&&(ve.style={...ve.style,textAlign:"center"})}he&&(ve.style={...ve.style,height:he}),Re&&(ve.style={...ve.style,textWrap:"wrap"});const{key:pt,...Pt}=ve;return(0,m.jsxs)("div",{...Pt,onMouseEnter:rt?Je:void 0,onMouseLeave:rt?en:void 0,className:Qe,children:[!gt&&(ct?`${Nt}`:(0,m.jsx)("div",{className:Ee.cellText,children:Nt})),gt&&(0,m.jsx)(D.e,{links:()=>(0,P.k)(Ve,me)||[],children:At=>At.openMenu?(0,m.jsx)("button",{className:(0,M.cx)(xt,V(Ee,nt,At.targetClassName)),onClick:At.openMenu,children:Nt}):(0,m.jsx)("div",{className:V(Ee,nt,At.targetClassName),children:Nt})}),St&&rt&&(0,m.jsx)(B,{...st,previewMode:"text",showFilters:et})]},pt)};function K(st,Ve,pe,Ee=!1,me=!1,ve=!1,Se=!1,Ie=!1,Oe=!1){let Re,he,Ce;const We=dt(st,Ve,pe);return Re=We.textColor,he=We.bgColor,Ce=We.bgHoverColor,st.buildCellContainerStyle(Re,he,Ce,!Ee,me,ve,Se,Ie,Oe)}function V(st,Ve,pe){return Ve.type===d.ob.Auto?(0,M.cx)(st.cellLink,pe):(0,M.cx)(st.cellLinkForColoredCell,pe)}var H=e(92015),Y=e(64136),X=e(27430);function J(st){const{cell:Ve,tableStyles:pe,cellProps:Ee}=st;let me="";return Ve.value instanceof X.A?me=new Y.A().writeGeometry(Ve.value,{featureProjection:"EPSG:3857",dataProjection:"EPSG:4326"}):Ve.value!=null&&(me=`${Ve.value}`),(0,m.jsx)("div",{...Ee,className:pe.cellContainer,children:(0,m.jsx)("div",{className:pe.cellText,style:{fontFamily:"monospace"},children:me})})}const q=10,ae=st=>{const{field:Ve,cell:pe,tableStyles:Ee,row:me,cellProps:ve}=st,Se=Ne(Ve),{title:Ie,alt:Oe}=Se.type===d.ob.Image?Se:{title:void 0,alt:void 0},Re=Ve.display(pe.value),he=!!(0,P.k)(Ve,me)?.length,Ce=(0,m.jsx)("img",{style:{height:Ee.cellHeight-q,width:"auto"},src:Re.text,className:Ee.imageCell,alt:Oe,title:Ie});return(0,m.jsxs)("div",{...ve,className:Ee.cellContainer,children:[!he&&Ce,he&&(0,m.jsx)(D.e,{style:{height:Ee.cellHeight-q,width:"auto"},links:()=>(0,P.k)(Ve,me)||[],children:We=>We.openMenu?(0,m.jsx)("div",{onClick:We.openMenu,role:"button",tabIndex:0,onKeyDown:et=>{et.key==="Enter"&&We.openMenu&&We.openMenu(et)},children:Ce}):Ce})]})};function j(st){const{cell:Ve,tableStyles:pe,cellProps:Ee,field:me,row:ve}=st,Se=!!me.config.custom?.inspect,Ie=(0,M.css)({cursor:"pointer",fontFamily:"monospace"});let Oe=Ve.value,Re=Oe;if((0,t.isString)(Oe))try{Oe=JSON.parse(Oe)}catch{}else Re=JSON.stringify(Oe,null," ");const he=!!(0,P.k)(me,ve)?.length,Ce=(0,I.of)(T.Ez);return(0,m.jsxs)("div",{...Ee,className:Se?pe.cellContainerNoOverflow:pe.cellContainer,children:[(0,m.jsxs)("div",{className:(0,M.cx)(pe.cellText,Ie),children:[!he&&(0,m.jsx)("div",{className:pe.cellText,children:Re}),he&&(0,m.jsx)(D.e,{links:()=>(0,P.k)(me,ve)||[],children:We=>We.openMenu?(0,m.jsx)(T.$n,{className:(0,M.cx)(Ce),onClick:We.openMenu,children:Re}):(0,m.jsx)(m.Fragment,{children:Re})})]}),Se&&(0,m.jsx)(B,{...st,previewMode:"code"})]})}var te=e(14578);function ne({row:st,tableStyles:Ve}){return(0,m.jsx)("div",{className:Ve.expanderCell,...st.getToggleRowExpandedProps(),children:(0,m.jsx)(te.I,{"aria-label":st.isExpanded?"Collapse row":"Expand row",name:st.isExpanded?"angle-down":"angle-right",size:"lg"})})}var le=e(30355);const z=50;function ee(st){if(!st)return"flex-start";if(st.config.custom)switch(st.config.custom.align){case"right":return"flex-end";case"left":return"flex-start";case"center":return"center"}return st.type===r.PU.number?"flex-end":"flex-start"}function se(st,Ve,pe,Ee,me,ve){const Se=[];let Ie=0;Ee&&(Se.push({Header:()=>null,id:"expander",Cell:ne,width:z,minWidth:z,filter:(Re,he,Ce)=>[],justifyContent:"left",field:st.fields[0],sortType:"basic"}),Ve-=z);for(const[Re,he]of st.fields.entries()){const Ce=he.config.custom||{};if(Ce.hidden||he.type===r.PU.nestedFrames)continue;Ce.width?Ve-=Ce.width:Ie++;const We=rt=>{switch(rt){case r.PU.number:case r.PU.frame:return"number";case r.PU.time:return"basic";default:return"alphanumeric-insensitive"}},et=ie(Ce.cellOptions?.type,he);Se.push({Cell:et,id:Re.toString(),field:he,Header:Ce.hideHeader?"":(0,g.Ct)(he,st),accessor:(rt,nt)=>he.values[nt],sortType:We(he.type),width:Ce.width,minWidth:Ce.minWidth??pe,filter:i()(Z(he)),justifyContent:ee(he),Footer:(0,H.d)(Re,me,ve)})}let Oe=Ve/Ie;for(let Re=Ie;Re>0;Re--)for(const he of Se)!he.width&&he.minWidth>Oe&&(he.width=he.minWidth,Ve-=he.width,Ie-=1,Oe=Ve/Ie);for(const Re of Se)Re.width||(Re.width=Oe),Re.minWidth=50;return Se}function ie(st,Ve){switch(st){case d.ob.Custom:case d.ob.ColorText:case d.ob.ColorBackground:return U;case d.ob.Image:return ae;case d.ob.Gauge:return x;case d.ob.Sparkline:return le.a;case d.ob.JSONView:return j;case d.ob.DataLinks:return b}if(Ve.type===r.PU.geo)return J;if(Ve.type===r.PU.frame){const pe=Ve.values[0];return(0,a.ci)(pe)&&(0,c.aH)(pe)?le.a:j}return Ve.type===r.PU.other?j:U}function Z(st){return function(Ve,pe,Ee){return Ve.length===0||!Ee||!st?Ve:Ve.filter(me=>{if(!me.values.hasOwnProperty(pe))return!1;const ve=ce(me,st);return Ee.find(Se=>Se.value===ve)!==void 0})}}function oe(st,Ve){if(!Ve||st.length===0)return{};const pe={};for(let Ee=0;Ee<st.length;Ee++){const me=ce(st[Ee],Ve);pe[me||"(Blanks)"]=me}return pe}function ce(st,Ve){if(!Ve||!st)return"";const pe=Ve.values[st.index],Ee=Ve.display?Ve.display(pe):pe;return Ve.display?(0,o.cN)(Ee):Ee}function ye(st){return Object.keys(st).reduce((Ve,pe)=>Ve.concat({value:st[pe],label:pe}),[]).sort(re)}function re(st,Ve){return st.label===void 0&&Ve.label===void 0?0:st.label===void 0&&Ve.label!==void 0?-1:st.label!==void 0&&Ve.label===void 0?1:st.label<Ve.label?-1:st.label>Ve.label?1:0}function ue(st,Ve){return Ve?st.filter(pe=>Ve.some(Ee=>Ee.value===pe.value)):[]}function De(st,Ve,pe){return String(st.values[pe]).localeCompare(String(Ve.values[pe]),void 0,{sensitivity:"base"})}function ge(st,Ve,pe){const Ee=Te(st.values[pe]),me=Te(Ve.values[pe]);return Ee===me?0:Ee>me?1:-1}function Te(st){return(0,a.LI)(st)?st.value??Number.NEGATIVE_INFINITY:st==null||st===""||isNaN(st)?Number.NEGATIVE_INFINITY:typeof st=="number"?st:Number(st)}function Le(st,Ve,pe,Ee){return Ue(st),st.map((me,ve)=>{if(me?.field?.type!==r.PU.number)return ve===0&&pe.reducer&&pe.reducer.length>0?h.AS.get(pe.reducer[0]).name:void 0;let Se=(0,t.clone)(me.field);return Se.values=Ve[me.id],Se.state=void 0,me.field=Se,pe.fields&&pe.fields.length>0?pe.fields.find(Oe=>Oe===me?.field?.name)?Ye(me.field,pe.reducer,Ee):void 0:Ye(me.field,pe.reducer||[],Ee)})}function Ye(st,Ve,pe){const Ee=Ve[0];if(Ee===void 0)return"";const me=st.display??(0,f.J)({field:st,theme:pe}),ve=(0,h.Nw)({field:st,reducers:Ve})[Ee];return h.AS.get(Ee).preservesUnits?(0,o.cN)(me(ve)):(0,o.cN)({text:ve})}function je(st){const Ve=[];for(const pe in st)for(const[Ee,me]of Object.entries(st[pe].values))Ve[Ee]===void 0&&(Ve[Ee]=[]),Ve[Ee].push(me);return Ve}const Ze={type:d.ob.Auto};function Ne(st){return st.config.custom?.displayMode?Pe(st.config.custom?.displayMode):st.config.custom?.cellOptions?st.config.custom.cellOptions:Ze}function Pe(st){switch(st){case"basic":case"gradient-gauge":case"lcd-gauge":let Ve=d.eX.Basic;return st==="gradient-gauge"?Ve=d.eX.Gradient:st==="lcd-gauge"&&(Ve=d.eX.Lcd),{type:d.ob.Gauge,mode:Ve};case"color-background":case"color-background-solid":let pe=d.Wq.Basic;return st==="color-background"&&(pe=d.Wq.Gradient),{type:d.ob.ColorBackground,mode:pe};default:return{type:st}}}function Ue(st){const Ve=st.findIndex((pe,Ee)=>pe?.id!==String(Ee));Ve===-1||st[Ve]?.id==="expander"||(st.splice(Ve,0,{id:String(Ve)}),Ue(st))}function $e(st,Ve,pe){let Ee=st.state?.alignmentFactors;if(Ee)return Ee.text.length<Ve.text.length&&(Ee.text=Ve.text),Ee;{Ee={...Ve};const me=Math.min(st.values.length,pe+1e3);for(let ve=pe+1;ve<me;ve++)st.display(st.values[ve]).text.length>Ee.text.length&&(Ee.text=Ve.text);return st.state?st.state.alignmentFactors=Ee:st.state={alignmentFactors:Ee},Ee}}function ze(st,Ve,pe){return Math.abs(Math.floor(st)-Ve)<pe}function qe(st){let Ve=-Number.MAX_VALUE,pe=Number.MAX_VALUE;if(st.values.length<2)return 0;for(let Ee=0;Ee<st.values.length;Ee++){const me=st.values[Ee];me>Ve&&(Ve=me),me<pe&&(pe=me)}return(Ve-pe)/st.values.length}function dt(st,Ve,pe){const Ee=st.theme.isDark?1:-.7;let me,ve,Se;if(Ve.type===d.ob.ColorText)me=pe.color;else if(Ve.type===d.ob.ColorBackground){const Ie=Ve.mode??d.Wq.Gradient;if(Ie===d.Wq.Basic)me=(0,p.mZ)(pe.color,st.theme.isDark),ve=(0,s.A)(pe.color).toRgbString(),Se=(0,s.A)(pe.color).setAlpha(1).toRgbString();else if(Ie===d.Wq.Gradient){const Oe=(0,s.A)(pe.color).setAlpha(1).toRgbString(),Re=(0,s.A)(pe.color).darken(10*Ee).spin(5);me=(0,p.mZ)(pe.color,st.theme.isDark),ve=`linear-gradient(120deg, ${Re.toRgbString()}, ${pe.color})`,Se=`linear-gradient(120deg, ${Re.setAlpha(1).toRgbString()}, ${Oe})`}}return{textColor:me,bgColor:ve,bgHoverColor:Se}}function vt(st,Ve,pe,Ee,me){const ve=Number(Ve?.width??300),Se=1.17,Ie=42;if(pe!==null&&typeof st=="string"){const Oe=st.split(/\s/),Re=[];let he="",Ce=0,We=0;for(let nt=0;nt<Oe.length;nt++){const gt=Oe[nt];let xt=pe.measureText(he+" "+gt).width;xt<ve?(he+=" "+gt,Ce++):(Re.push({width:xt,line:he}),he=gt,Ce=0)}for(let nt=0;nt<Re.length;nt++)if(Re[nt].width>ve){let gt=Math.floor(Re[nt].width/ve)-1;We+=gt}let et=Re.length+We,rt=38;return et>5?rt=et*Ee*Se:rt=et*Ee+Ie,{width:ve,height:rt}}return{width:ve,height:me}}function yt(st,Ve){let pe;if(st!==void 0&&st.defaults.custom!==void 0&&st.defaults.custom.cellOptions.wrapText){const me=Ve.fields.filter(ve=>ve.type===r.PU.string);if(me.length>=1&&me[0].values.length>0){const ve=me[0].values.length;let Se=0;if(ve<=30)for(const Ie of me){const Oe=Ie.values[0].length;Oe>Se&&(Se=Oe,pe=Ie)}else for(const Ie of me){const Oe=(0,t.sampleSize)(Ie.values,3),Re=(Oe[0]?.length+Oe[1]?.length+Oe[2]?.length)/3;Re>Se&&(Se=Re,pe=Ie)}}}return pe}},14746:(k,R,e)=>{"use strict";e.d(R,{b:()=>d});var t=e(74848),n=e(32196),i=e(2543),s=e.n(i),r=e(96540),g=e(72436),a=e(40845),c=e(3911),o=e(14578),h=e(21744);class f extends r.PureComponent{constructor(v){super(v),this.readCSV=(0,i.debounce)(()=>{const{config:u}=this.props,{text:D}=this.state;this.setState({data:(0,g.Jh)(D,{config:u})})},150),this.onTextChange=u=>{this.setState({text:u.target.value})};const{text:l,config:y}=v;this.state={text:l,data:(0,g.Jh)(l,{config:y})}}componentDidUpdate(v,l){const{text:y}=this.state;(y!==l.text||this.props.config!==v.config)&&this.readCSV(),this.props.text!==v.text&&this.props.text!==y&&this.setState({text:this.props.text}),this.state.data!==l.data&&this.props.onSeriesParsed(this.state.data,this.state.text)}render(){const{width:v,height:l,theme:y}=this.props,{data:u}=this.state,D=p(y);return(0,t.jsxs)("div",{className:D.tableInputCsv,children:[(0,t.jsx)(h.f,{style:{width:v,height:l},placeholder:"Enter CSV here...",value:this.state.text,onChange:this.onTextChange,className:D.textarea}),u&&(0,t.jsx)("footer",{className:D.footer,children:u.map((E,x)=>(0,t.jsxs)("span",{children:["Rows:",E.length,", Columns:",E.fields.length," \xA0",(0,t.jsx)(o.I,{name:"check-circle"})]},x))})]})}}const d=(0,a.cV)(f);d.displayName="TableInputCSV";const p=(0,c.N)(m=>({tableInputCsv:(0,n.css)({position:"relative"}),textarea:(0,n.css)({height:"100%",width:"100%"}),footer:(0,n.css)({position:"absolute",bottom:"15px",right:"15px",border:"1px solid #222",background:m.colors.success.main,padding:`1px ${m.spacing(.5)}`,fontSize:"80%"})}))},53402:(k,R,e)=>{"use strict";e.d(R,{p:()=>r});var t=e(74848),n=e(32196),i=e(83195),s=e(40845);const r=({value:a})=>{const c=(0,s.of)(g);return(0,t.jsx)("span",{className:c.counter,children:(0,i.Hg)(a,0).text})},g=a=>({counter:(0,n.css)({label:"counter",marginLeft:a.spacing(1),borderRadius:a.spacing(3),backgroundColor:a.colors.action.hover,padding:a.spacing(.25,1),color:a.colors.text.secondary,fontWeight:a.typography.fontWeightMedium,fontSize:a.typography.size.sm})})},40675:(k,R,e)=>{"use strict";e.d(R,{o:()=>h});var t=e(74848),n=e(32196),i=e(96540),s=e(13544),r=e(40845),g=e(16797),a=e(55852),c=e(14578),o=e(53402);const h=i.forwardRef(({label:d,active:p,icon:m,onChangeTab:v,counter:l,suffix:y,className:u,href:D,...E},x)=>{const P=(0,r.of)(f),b=(0,r.of)(a.my),M=()=>(0,t.jsxs)(t.Fragment,{children:[m&&(0,t.jsx)(c.I,{name:m}),d,typeof l=="number"&&(0,t.jsx)(o.p,{value:l}),y&&(0,t.jsx)(y,{className:P.suffix})]}),I={className:(0,n.cx)(b,P.link,p?P.activeStyle:P.notActive),"data-testid":s.Tp.components.Tab.title(d),...E,onClick:v,role:"tab","aria-selected":p};return D?(0,t.jsx)("div",{className:P.item,children:(0,t.jsx)("a",{...I,href:D,ref:x,children:M()})}):(0,t.jsx)("div",{className:P.item,children:(0,t.jsx)("button",{...I,type:"button",ref:x,children:M()})})});h.displayName="Tab";const f=d=>({item:(0,n.css)({listStyle:"none",position:"relative",display:"flex",whiteSpace:"nowrap",padding:d.spacing(.5)}),link:(0,n.css)({color:d.colors.text.secondary,padding:d.spacing(1,1.5,.5),borderRadius:d.shape.radius.default,display:"block",height:"100%",svg:{marginRight:d.spacing(1)},"&:focus-visible":(0,g.getFocusStyles)(d),"&::before":{display:"block",content:'" "',position:"absolute",left:0,right:0,height:"4px",borderRadius:d.shape.radius.default,bottom:0}}),notActive:(0,n.css)({"a:hover, &:hover, &:focus":{color:d.colors.text.primary,"&::before":{backgroundColor:d.colors.action.hover}}}),activeStyle:(0,n.css)({label:"activeTabStyle",color:d.colors.text.primary,overflow:"hidden","&::before":{backgroundImage:d.colors.gradients.brandHorizontal}}),suffix:(0,n.css)({marginLeft:d.spacing(1)})})},40980:(k,R,e)=>{"use strict";e.d(R,{J:()=>s});var t=e(74848),n=e(32196),i=e(40845);const s=({children:g,className:a,...c})=>{const o=(0,i.of)(r);return(0,t.jsx)("div",{...c,className:(0,n.cx)(o.tabContent,a),children:g})},r=g=>({tabContent:(0,n.css)({background:g.colors.background.primary})})},63021:(k,R,e)=>{"use strict";e.d(R,{U:()=>r});var t=e(74848),n=e(32196),i=e(96540),s=e(40845);const r=(0,i.forwardRef)(({children:a,className:c,hideBorder:o=!1},h)=>{const f=(0,s.of)(g);return(0,t.jsx)("div",{className:(0,n.cx)(f.tabsWrapper,o&&f.noBorder,c),ref:h,children:(0,t.jsx)("div",{className:f.tabs,role:"tablist",children:a})})}),g=a=>({tabsWrapper:(0,n.css)({borderBottom:`1px solid ${a.colors.border.weak}`,overflowX:"auto"}),noBorder:(0,n.css)({borderBottom:0}),tabs:(0,n.css)({position:"relative",display:"flex",height:`${a.components.menuTabs.height}px`,alignItems:"center"})});r.displayName="TabsBar"},90685:(k,R,e)=>{"use strict";e.d(R,{s:()=>c});var t=e(74848),n=e(32196),i=e(96540),s=e(13544),r=e(40845),g=e(14578),a=e(53402);const c=(0,i.forwardRef)(({label:h,active:f,icon:d,counter:p,className:m,suffix:v,onChangeTab:l,href:y,...u},D)=>{const E=(0,r.of)(o),x=()=>(0,t.jsxs)(t.Fragment,{children:[d&&(0,t.jsx)(g.I,{name:d}),h,typeof p=="number"&&(0,t.jsx)(a.p,{value:p}),v&&(0,t.jsx)(v,{className:E.suffix})]}),P=(0,n.cx)(E.link,f&&E.activeStyle);return(0,t.jsx)("a",{href:y,className:P,...u,onClick:l,"aria-label":u["aria-label"]||s.Tp.components.Tab.title(h),role:"tab","aria-selected":f,ref:D,children:x()})});c.displayName="Tab";const o=h=>({link:(0,n.css)({padding:"6px 12px",display:"block",height:"100%",cursor:"pointer",position:"relative",color:h.colors.text.primary,svg:{marginRight:h.spacing(1)},"&:hover, &:focus":{textDecoration:"underline"}}),activeStyle:(0,n.css)({label:"activeTabStyle",color:h.colors.text.maxContrast,overflow:"hidden","&::before":{display:"block",content:'" "',position:"absolute",left:0,width:"4px",bottom:"2px",top:"2px",borderRadius:h.shape.radius.default,backgroundImage:"linear-gradient(0deg, #f05a28 30%, #fbca0a 99%)"}}),suffix:(0,n.css)({marginLeft:h.spacing(1)})})},78369:(k,R,e)=>{"use strict";e.d(R,{v:()=>f});var t=e(74848),n=e(32196),i=e(96540),s=e(70255),r=e(40845),g=e(69613),a=e(72129),c=e(14578);const o=(0,i.forwardRef)(({name:m,onClick:v,icon:l,className:y,colorIndex:u,...D},E)=>{const x=(0,r.$j)(),P=p(x,m,u),b=O=>{O.preventDefault(),O.stopPropagation(),v?.(m,O)},M=(0,n.cx)(P.wrapper,y,{[P.hover]:v!==void 0});return v?(0,t.jsxs)("button",{...D,className:M,onClick:b,ref:E,children:[l&&(0,t.jsx)(c.I,{name:l}),m]}):(0,t.jsxs)("span",{...D,className:M,ref:E,children:[l&&(0,t.jsx)(c.I,{name:l}),m]})});o.displayName="Tag";const h=({rootProps:m})=>{const v=(0,r.of)(d);return(0,t.jsx)(s.A,{width:60,height:22,containerClassName:v.container,...m})},f=(0,a.j)(o,h),d=()=>({container:(0,n.css)({lineHeight:1})}),p=(m,v,l)=>{let y;return l===void 0?y=(0,g.MC)(v):y=(0,g.yC)(l),{wrapper:(0,n.css)({appearance:"none",borderStyle:"none",fontWeight:m.typography.fontWeightMedium,fontSize:m.typography.size.sm,lineHeight:m.typography.bodySmall.lineHeight,verticalAlign:"baseline",backgroundColor:y.color,color:m.v1.palette.gray98,whiteSpace:"pre",textShadow:"none",padding:"3px 6px",borderRadius:m.shape.radius.default}),hover:(0,n.css)({"&:hover":{opacity:.85,cursor:"pointer"}})}}},64149:(k,R,e)=>{"use strict";e.d(R,{L:()=>o});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(72129),g=e(78369);const a=(0,i.memo)((0,i.forwardRef)(({displayMax:d,tags:p,icon:m,onClick:v,className:l,getAriaLabel:y,getColorIndex:u},D)=>{const E=(0,s.$j)(),x=f(E,!!(d&&d>0)),P=p.length,b=d?p.slice(0,d):p;return(0,t.jsxs)("ul",{className:(0,n.cx)(x.wrapper,l),"aria-label":"Tags",ref:D,children:[b.map((M,O)=>(0,t.jsx)("li",{className:x.li,children:(0,t.jsx)(g.v,{name:M,icon:m,onClick:v,"aria-label":y?.(M,O),"data-tag-id":O,colorIndex:u?.(M,O)})},M)),d&&d>0&&P-d>0&&(0,t.jsxs)("span",{className:x.moreTagsLabel,children:["+ ",P-d]})]})}));a.displayName="TagList";const c=({rootProps:d})=>{const p=(0,s.of)(h);return(0,t.jsxs)("div",{className:p.container,...d,children:[(0,t.jsx)(g.v.Skeleton,{}),(0,t.jsx)(g.v.Skeleton,{})]})},o=(0,r.j)(a,c),h=d=>({container:(0,n.css)({display:"flex",gap:d.spacing(1)})}),f=(d,p)=>({wrapper:(0,n.css)({position:"relative",alignItems:p?"center":"unset",display:"flex",flex:"1 1 auto",flexWrap:"wrap",flexShrink:p?0:1,justifyContent:"flex-end",gap:"6px"}),moreTagsLabel:(0,n.css)({color:d.colors.text.secondary,fontSize:d.typography.size.sm}),li:(0,n.css)({listStyle:"none"})})},79924:(k,R,e)=>{"use strict";e.d(R,{u:()=>f});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(55852),g=e(10354),a=e(69613),c=e(29158);const o=({name:p,disabled:m,onRemove:v})=>{const{color:l,borderColor:y}=(0,i.useMemo)(()=>(0,a.MC)(p),[p]),u=(0,s.of)(h);return(0,t.jsxs)("li",{className:u.itemStyle,style:{backgroundColor:l,borderColor:y},children:[(0,t.jsx)("span",{className:u.nameStyle,children:p}),(0,t.jsx)(c.K,{name:"times",size:"lg",disabled:m,tooltip:`Remove "${p}" tag`,onClick:()=>v(p),className:u.buttonStyles})]})},h=p=>{const m=p.spacing.gridSize*3;return{itemStyle:(0,n.css)({display:"flex",gap:"3px",alignItems:"center",height:`${m}px`,lineHeight:`${m-2}px`,color:"#fff",borderWidth:"1px",borderStyle:"solid",borderRadius:p.shape.radius.default,padding:`0 ${p.spacing(.5)}`,whiteSpace:"nowrap",textShadow:"none",fontWeight:500,fontSize:p.typography.size.sm}),nameStyle:(0,n.css)({maxWidth:"25ch",textOverflow:"ellipsis",overflow:"hidden"}),buttonStyles:(0,n.css)({margin:0,"&:hover::before":{display:"none"}})}},f=({placeholder:p="New tag (enter key to add)",tags:m=[],onChange:v,width:l,className:y,disabled:u,addOnBlur:D,invalid:E,id:x})=>{const[P,b]=(0,i.useState)(""),M=(0,s.of)(d),O=(0,s.$j)(),I=(0,i.useCallback)(L=>{b(L.target.value)},[]),T=L=>{v(m.filter(N=>N!==L))},C=L=>{L?.preventDefault(),m.includes(P)||v(m.concat(P)),b("")},S=()=>{D&&P&&C()},A=L=>{L.key==="Enter"&&P!==""&&C(L)};return(0,t.jsxs)("div",{className:(0,n.cx)(M.wrapper,y,l?(0,n.css)({width:O.spacing(l)}):""),children:[(0,t.jsx)(g.p,{id:x,disabled:u,placeholder:p,onChange:I,value:P,onKeyDown:A,onBlur:S,invalid:E,suffix:(0,t.jsx)(r.$n,{fill:"text",className:M.addButtonStyle,onClick:C,size:"md",disabled:P.length<=0,children:"Add"})}),m?.length>0&&(0,t.jsx)("ul",{className:M.tags,children:m.map(L=>(0,t.jsx)(o,{name:L,onRemove:T,disabled:u},L))})]})},d=p=>({wrapper:(0,n.css)({minHeight:p.spacing(4),display:"flex",flexDirection:"column",gap:p.spacing(1),flexWrap:"wrap"}),tags:(0,n.css)({display:"flex",justifyContent:"flex-start",flexWrap:"wrap",gap:p.spacing(.5)}),addButtonStyle:(0,n.css)({margin:`0 -${p.spacing(1)}`})})},94753:(k,R,e)=>{"use strict";e.d(R,{E:()=>o});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(65848),g=e(56034);const a=i.forwardRef(({childElement:f,children:d},p)=>{const[m,v]=(0,i.useState)(!1),l=(0,i.useRef)(null);(0,i.useImperativeHandle)(p,()=>l.current);const y=(0,i.useMemo)(()=>new ResizeObserver(D=>{for(const E of D)E.target.clientWidth&&E.target.scrollWidth&&(E.target.scrollWidth>E.target.clientWidth&&v(!0),E.target.scrollWidth<=E.target.clientWidth&&v(!1))}),[]);(0,i.useEffect)(()=>{const{current:D}=l;return D&&y.observe(D),()=>{y.disconnect()}},[v,y]);const u=D=>typeof D=="string"?D:r.renderToStaticMarkup((0,t.jsx)(t.Fragment,{children:D})).replace(/(<([^>]+)>)/gi,"");return m?(0,t.jsx)(g.m,{ref:l,content:u(d),children:f(void 0)}):f(l)});a.displayName="TruncatedText";var c=e(71356);const o=i.forwardRef(({element:f="span",variant:d,weight:p,color:m,truncate:v,italic:l,textAlignment:y,children:u,tabular:D,...E},x)=>{const P=(0,s.of)(h,f,d,m,p,v,l,y,D),b=M=>(0,i.createElement)(f,{...E,style:void 0,className:P,ref:M},u);return!v||f==="span"?b(void 0):(0,t.jsx)(a,{childElement:b,children:u,ref:x})});o.displayName="Text";const h=(f,d,p,m,v,l,y,u,D)=>(0,n.css)([{margin:0,padding:0,...(0,c.d$)(f,d,p)},p&&{...f.typography[p]},m&&{color:(0,c.vT)(m,f)},v&&{fontWeight:(0,c.iV)(v,f)},l&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},y&&{fontStyle:"italic"},u&&{textAlign:u},D&&{fontFeatureSettings:'"tnum"'}])},71356:(k,R,e)=>{"use strict";e.d(R,{d$:()=>i,iV:()=>t,vT:()=>n});const t=(s,r)=>{switch(s){case"bold":return r.typography.fontWeightBold;case"medium":return r.typography.fontWeightMedium;case"light":return r.typography.fontWeightLight;case"regular":case void 0:return r.typography.fontWeightRegular}},n=(s,r)=>{switch(s){case"error":return r.colors.error.text;case"success":return r.colors.success.text;case"info":return r.colors.info.text;case"warning":return r.colors.warning.text;default:return s?r.colors.text[s]:void 0}},i=(s,r,g)=>{if(g)return s.typography[g];switch(r){case"span":return;case"h1":return s.typography.h1;case"h2":return s.typography.h2;case"h3":return s.typography.h3;case"h4":return s.typography.h4;case"h5":return s.typography.h5;case"h6":return s.typography.h6;default:return s.typography.body}}},21744:(k,R,e)=>{"use strict";e.d(R,{f:()=>g});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(87266);const g=(0,i.forwardRef)(({invalid:c,className:o,...h},f)=>{const d=(0,s.of)(a,c);return(0,t.jsx)("textarea",{...h,className:(0,n.cx)(d.textarea,o),ref:f})}),a=(c,o=!1)=>({textarea:(0,n.cx)((0,r.Xb)(c),(0,r.gm)(c),(0,n.css)({display:"block",borderRadius:c.shape.radius.default,padding:`${c.spacing.gridSize/4}px ${c.spacing.gridSize}px`,width:"100%",borderColor:o?c.colors.error.border:c.components.input.borderColor}))});g.displayName="TextArea"},60782:(k,R,e)=>{"use strict";e.d(R,{G:()=>h});var t=e(74848),n=e(32196),i=e(34743),s=e(36376),r=e(7315),g=e(96540),a=e(40845),c=e(18976),o=e(29158);const h=(0,g.memo)(({children:d,theme:p="info",placement:m="auto",content:v,title:l,closeButton:y=!0,onClose:u,footer:D,fitContent:E=!1,onOpen:x,show:P})=>{const b=(0,g.useRef)(null),M=(0,a.$j)(),O=(0,a.of)(f),I=O[p],[T,C]=(0,g.useState)(P),S=P??T,A=[(0,i.cY)(8),(0,i.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,i.BN)(),(0,i.UE)({element:b})],{context:L,refs:N,floatingStyles:F}=(0,s.we)({open:S,placement:(0,c.O)(m),onOpenChange:V=>{P===void 0&&C(V),V?x?.():u?.()},middleware:A,whileElementsMounted:r.ll,strategy:"fixed"}),w=(0,s.kp)(L),B=(0,s.s9)(L),{getReferenceProps:U,getFloatingProps:K}=(0,s.bv)([B,w]);return(0,t.jsxs)(t.Fragment,{children:[(0,g.cloneElement)(d,{ref:N.setReference,tabIndex:0,"aria-expanded":S,...U()}),S&&(0,t.jsx)(s.s3,{context:L,modal:!1,closeOnFocusOut:!1,children:(0,t.jsxs)("div",{"data-testid":"toggletip-content",className:(0,n.cx)(I.container,{[O.fitContent]:E}),ref:N.setFloating,style:F,...K(),children:[(0,t.jsx)(s.ie,{strokeWidth:.3,stroke:M.colors.border.weak,className:I.arrow,ref:b,context:L}),!!l&&(0,t.jsx)("div",{className:I.header,children:l}),y&&(0,t.jsx)("div",{className:I.headerClose,children:(0,t.jsx)(o.K,{"aria-label":"Close",name:"times","data-testid":"toggletip-header-close",onClick:()=>{C(!1),u?.()}})}),(0,t.jsxs)("div",{className:I.body,children:[(typeof v=="string"||(0,g.isValidElement)(v))&&v,typeof v=="function"&&v({})]}),!!D&&(0,t.jsx)("div",{className:I.footer,children:D})]})})]})});h.displayName="Toggletip";const f=d=>{const p=(0,c.f)(d,d.colors.background.primary,d.colors.border.weak,d.components.tooltip.text,{topBottom:2,rightLeft:2}),m=(0,c.f)(d,d.colors.error.main,d.colors.error.main,d.colors.error.contrastText,{topBottom:2,rightLeft:2});return{info:p,error:m,fitContent:(0,n.css)({maxWidth:"fit-content"})}}},27746:(k,R,e)=>{"use strict";e.d(R,{I:()=>f});var t=e(74848),n=e(32196),i=e(96540),s=e(8887),r=e(13544),g=e(40845),a=e(16797),c=e(55852),o=e(14578),h=e(56034);const f=(0,i.forwardRef)(({tooltip:v,icon:l,iconSize:y,className:u,children:D,imgSrc:E,imgAlt:x,fullWidth:P,isOpen:b,narrow:M,variant:O="default",iconOnly:I,"aria-label":T,isHighlighted:C,...S},A)=>{const L=(0,g.of)(m),N=(0,n.cx)({[L.button]:!0,[L.buttonFullWidth]:P,[L.narrow]:M},L[O],u),F=(0,n.cx)({[L.content]:!0,[L.contentWithIcon]:!!l,[L.contentWithRightIcon]:b!==void 0}),w=(0,t.jsxs)("button",{ref:A,className:N,"aria-label":d(T,v),"aria-expanded":b,...S,children:[p(l,y),E&&(0,t.jsx)("img",{className:L.img,src:E,alt:x??""}),D&&!I&&(0,t.jsx)("div",{className:F,children:D}),b===!1&&(0,t.jsx)(o.I,{name:"angle-down"}),b===!0&&(0,t.jsx)(o.I,{name:"angle-up"}),C&&(0,t.jsx)("div",{className:L.highlight})]});return v?(0,t.jsx)(h.m,{ref:A,content:v,placement:"bottom",children:w}):w});f.displayName="ToolbarButton";function d(v,l){return v||(l?r.Tp.components.PageToolbar.item(l):void 0)}function p(v,l){return v?(0,s.n6)(v)?(0,t.jsx)(o.I,{name:v,size:`${l||"lg"}`}):v:null}const m=v=>{const l=(0,c.U_)(v,"primary","solid"),y=(0,c.U_)(v,"destructive","solid"),u=(0,n.css)({color:v.colors.text.primary,background:v.colors.secondary.main,"&:hover":{color:v.colors.text.primary,background:v.colors.secondary.shade,border:`1px solid ${v.colors.border.medium}`}});return{button:(0,n.css)({label:"toolbar-button",position:"relative",display:"flex",alignItems:"center",height:v.spacing(v.components.height.md),padding:v.spacing(0,1),borderRadius:v.shape.radius.default,lineHeight:`${v.components.height.md*v.spacing.gridSize-2}px`,fontWeight:v.typography.fontWeightMedium,border:`1px solid ${v.colors.secondary.border}`,whiteSpace:"nowrap",[v.transitions.handleMotion("no-preference","reduce")]:{transition:v.transitions.create(["background","box-shadow","border-color","color"],{duration:v.transitions.duration.short})},"&:focus, &:focus-visible":{...(0,a.getFocusStyles)(v),zIndex:1},"&:focus:not(:focus-visible)":(0,a.getMouseFocusStyles)(v),"&:hover":{boxShadow:v.shadows.z1},"&[disabled], &:disabled":{cursor:"not-allowed",opacity:v.colors.action.disabledOpacity,background:v.colors.action.disabledBackground,boxShadow:"none","&:hover":{color:v.colors.text.disabled,background:v.colors.action.disabledBackground,boxShadow:"none"}}}),default:(0,n.css)({color:v.colors.text.secondary,background:"transparent",border:"1px solid transparent","&:hover":{color:v.colors.text.primary,background:v.colors.background.secondary}}),canvas:u,active:(0,n.cx)(u,(0,n.css)({"&::before":{display:"block",content:'" "',position:"absolute",left:0,right:0,height:"2px",bottom:0,borderRadius:v.shape.radius.default,backgroundImage:v.colors.gradients.brandHorizontal}})),primary:(0,n.css)(l),destructive:(0,n.css)(y),narrow:(0,n.css)({padding:v.spacing(0,.5)}),img:(0,n.css)({width:"16px",height:"16px",marginRight:v.spacing(1)}),buttonFullWidth:(0,n.css)({flexGrow:1}),content:(0,n.css)({flexGrow:1}),contentWithIcon:(0,n.css)({display:"none",paddingLeft:v.spacing(1),[`@media ${a.mediaUp(v.v1.breakpoints.md)}`]:{display:"block"}}),contentWithRightIcon:(0,n.css)({paddingRight:v.spacing(.5)}),highlight:(0,n.css)({backgroundColor:v.colors.success.main,borderRadius:v.shape.radius.circle,width:"6px",height:"6px",position:"absolute",top:"-3px",right:"-3px",zIndex:1})}}},15068:(k,R,e)=>{"use strict";e.d(R,{U:()=>h});var t=e(74848),n=e(32196),i=e(18828),s=e(85690),r=e(93225),g=e(96540),a=e(40845),c=e(17464),o=e(27746);const h=(0,g.forwardRef)(({alignment:d="left",className:p,children:m,...v},l)=>{const y=g.Children.toArray(m).filter(A=>A!=null),[u,D]=(0,g.useState)(Array(y.length).fill(!1)),E=(0,g.useRef)(null),[x,P]=(0,g.useState)(!1),b=(0,g.useRef)(null),M=(0,g.createRef)(),{overlayProps:O}=(0,r.e)({onClose:()=>P(!1),isDismissable:!0,isOpen:x,shouldCloseOnInteractOutside:A=>{const L=(0,c.gF)();return!b.current?.contains(A)&&!L.contains(A)}},M),{dialogProps:I}=(0,i.s)({},M),T=(0,a.$j)(),C=d==="left"?u.indexOf(!1)-1:u.length,S=f(T,C,d);return(0,g.useLayoutEffect)(()=>{const A=new IntersectionObserver(L=>{L.forEach(N=>{if(N.target instanceof HTMLElement&&N.target.parentNode){const F=Array.prototype.indexOf.call(N.target.parentNode.children,N.target);D(w=>{const B=[...w];return B[F]=N.isIntersecting,B})}})},{threshold:1,root:E.current});return E.current&&Array.from(E.current.children).forEach(L=>{L instanceof HTMLElement&&L!==b.current&&A.observe(L)}),()=>A.disconnect()},[m]),(0,t.jsxs)("div",{ref:E,className:(0,n.cx)(S.container,p),...v,children:[y.map((A,L)=>(0,t.jsx)("div",{style:{order:L,visibility:u[L]?"visible":"hidden"},className:S.childWrapper,children:A},L)),u.includes(!1)&&(0,t.jsxs)("div",{ref:b,className:S.overflowButton,children:[(0,t.jsx)(o.I,{variant:x?"active":"default",tooltip:"Show more items",onClick:()=>P(!x),icon:"ellipsis-v",iconOnly:!0,narrow:!0}),x&&(0,t.jsx)(s.n1,{contain:!0,autoFocus:!0,children:(0,t.jsx)("div",{className:S.overflowItems,ref:M,...O,...I,children:y.map((A,L)=>!u[L]&&A)})})]})]})});h.displayName="ToolbarButtonRow";const f=(d,p,m)=>({overflowButton:(0,n.css)({order:p}),overflowItems:(0,n.css)({alignItems:"center",backgroundColor:d.colors.background.primary,borderRadius:d.shape.radius.default,boxShadow:d.shadows.z2,display:"flex",flexWrap:"wrap",gap:d.spacing(1),marginTop:d.spacing(1),maxWidth:"80vw",padding:d.spacing(.5,1),position:"absolute",right:0,top:"100%",width:"max-content",zIndex:d.zIndex.dropdown}),container:(0,n.css)({alignItems:"center",display:"flex",gap:d.spacing(1),justifyContent:m==="left"?"flex-start":"flex-end",minWidth:0,position:"relative"}),childWrapper:(0,n.css)({alignItems:"center",display:"flex",gap:d.spacing(1)})})},13840:(k,R,e)=>{"use strict";e.d(R,{A:()=>o});var t=e(74848),n=e(34743),i=e(36376),s=e(7315),r=e(96540),g=e(40845),a=e(18976),c=e(17464);function o({content:h,show:f,placement:d,className:p,wrapperClassName:m,referenceElement:v,renderArrow:l,...y}){const u=(0,g.$j)(),D=(0,r.useRef)(null),E=[(0,n.cY)(8),(0,n.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,n.BN)()];l&&E.push((0,n.UE)({element:D}));const{context:x,refs:P,floatingStyles:b}=(0,i.we)({open:f,placement:(0,a.O)(d),middleware:E,whileElementsMounted:s.ll,strategy:"fixed"});(0,r.useLayoutEffect)(()=>{P.setReference(v)},[v,P]);const{styles:M}=(0,i.DL)(x,{initial:()=>({opacity:0}),duration:u.transitions.duration.enteringScreen});return f?(0,t.jsx)(c.ZL,{children:(0,t.jsx)("div",{ref:P.setFloating,style:{...b,...M},className:m,...y,children:(0,t.jsxs)("div",{className:p,children:[l&&(0,t.jsx)(i.ie,{fill:u.colors.border.weak,ref:D,context:x}),typeof h=="string"&&h,r.isValidElement(h)&&r.cloneElement(h),typeof h=="function"&&h({})]})})}):void 0}},95868:(k,R,e)=>{"use strict";e.d(R,{I:()=>n});var t=e(96540);class n extends t.Component{constructor(){super(...arguments),this.hideTimeout=null,this.state={show:!1},this.showPopper=()=>{this.hideTimeout&&clearTimeout(this.hideTimeout),this.setState({show:!0})},this.hidePopper=()=>{this.hideTimeout=setTimeout(()=>{this.setState({show:!1})},this.props.hideAfter)}}render(){const{children:s,content:r,placement:g="auto"}=this.props,{show:a}=this.state;return s(this.showPopper,this.hidePopper,{show:a,placement:g,content:r})}}},56034:(k,R,e)=>{"use strict";e.d(R,{m:()=>h});var t=e(74848),n=e(34743),i=e(36376),s=e(7315),r=e(96540),g=e(13544),a=e(40845),c=e(18976),o=e(17464);const h=(0,r.forwardRef)(({children:d,theme:p,interactive:m,show:v,placement:l,content:y},u)=>{const D=(0,r.useRef)(null),[E,x]=(0,r.useState)(v),P=v??E,b=[(0,n.cY)(8),(0,n.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,n.BN)(),(0,n.UE)({element:D})],{context:M,refs:O,floatingStyles:I}=(0,i.we)({open:P,placement:(0,c.O)(l),onOpenChange:x,middleware:b,whileElementsMounted:s.ll}),T=(0,r.useId)(),C=(0,i.Mk)(M,{delay:{close:m?100:0},move:!1}),S=(0,i.iQ)(M),A=(0,i.s9)(M),{getReferenceProps:L,getFloatingProps:N}=(0,i.bv)([A,C,S]),F=typeof y=="function",B=(0,a.of)(f)[p??"info"],U=(0,r.useCallback)(V=>{O.setReference(V),typeof u=="function"?u(V):u&&(u.current=V)},[u,O]),K="aria-label"in d.props&&d.props["aria-label"]===y;return(0,t.jsxs)(t.Fragment,{children:[(0,r.cloneElement)(d,{ref:U,tabIndex:0,"aria-describedby":!K&&P?T:void 0,...L()}),P&&(0,t.jsx)(o.ZL,{children:(0,t.jsxs)("div",{ref:O.setFloating,style:I,...N(),children:[(0,t.jsx)(i.ie,{className:B.arrow,ref:D,context:M}),(0,t.jsxs)("div",{"data-testid":g.Tp.components.Tooltip.container,id:T,role:"tooltip",className:B.container,children:[typeof y=="string"&&y,(0,r.isValidElement)(y)&&(0,r.cloneElement)(y),F&&y({})]})]})})]})});h.displayName="Tooltip";const f=d=>{const p=(0,c.f)(d,d.components.tooltip.background,d.components.tooltip.background,d.components.tooltip.text,{topBottom:.5,rightLeft:1}),m=(0,c.f)(d,d.colors.error.main,d.colors.error.main,d.colors.error.contrastText,{topBottom:.5,rightLeft:1});return{info:p,"info-alt":p,error:m}}},5313:(k,R,e)=>{"use strict";e.d(R,{z:()=>s});var t=e(74848),n=e(96540);function i(r,g){const a=[];return r.forEach(c=>{a.push(c.start,c.end+1)}),a[0]!==0&&a.unshift(0),a[a.length-1]!==g&&a.push(g),a}const s=r=>{let{highlightParts:g,text:a,highlightClassName:c}=r;if(!g?.length)return null;let o=[],h=i(g,a.length),f=g[0].start===0;for(let d=1;d<h.length;d++){let p=h[d-1],m=h[d];o.push((0,n.createElement)(f?"mark":"span",{key:d-1,className:f?c:void 0},a.substring(p,m))),f=!f}return(0,t.jsx)("div",{children:o})}},2056:(k,R,e)=>{"use strict";e.d(R,{p:()=>g});var t=e(74848),n=e(96540),i=e(83195),s=e(3988);function r(a){return`Custom unit: ${a}`}class g extends n.PureComponent{constructor(){super(...arguments),this.onChange=c=>{this.props.onChange(c.value)}}render(){const{value:c,width:o}=this.props;let h;const d=(0,i.Ke)().map(p=>{const m=p.submenu.map(v=>{const l={label:v.text,value:v.value};return v.value===c&&(h=l),l});return{label:p.text,value:p.text,items:m}});return c&&!h&&(h={value:c,label:c}),(0,t.jsx)(s.v,{width:o,initialValue:h&&h.label,allowCustomValue:!0,changeOnSelect:!1,formatCreateLabel:r,options:d,placeholder:"Choose",isClearable:!0,onSelect:this.props.onChange})}}},12942:(k,R,e)=>{"use strict";e.d(R,{e:()=>r});var t=e(74848),n=e(32196),i=e(40845),s=e(16795);const r=({src:a,alt:c,width:o,height:h})=>{const f=(0,i.of)(g,o,h);return(0,t.jsx)("img",{className:f.image,src:a,alt:c})},g=(a,c=3,o=3)=>({image:(0,n.css)([(0,s.Y)(a,c,h=>({width:a.spacing(h)})),(0,s.Y)(a,o,h=>({height:a.spacing(h)})),{borderRadius:a.shape.radius.circle}])})},99635:(k,R,e)=>{"use strict";e.d(R,{n:()=>o});var t=e(74848),n=e(32196),i=e(96540),s=e(47232),r=e(40845),g=e(56034);const a=d=>{const m=(0,s.KQ)(d).diff((0,s.KQ)(),"hours",!1);return`Active last ${(Math.floor(-m/24)+1)*24}h`},c=d=>{if(!d)return"";const[p,m]=d.split(" ");return`${p?.[0]??""}${m?.[0]??""}`.toUpperCase()},o=({userView:d,className:p,children:m,onClick:v,showTooltip:l=!0})=>{const{user:y,lastActiveAt:u}=d,D=(0,s.KQ)(u).diff((0,s.KQ)(),"minutes",!0)>=-15,E=(0,r.$j)(),x=(0,i.useMemo)(()=>f(E,D),[E,D]),P=(0,t.jsx)("button",{type:"button",onClick:v,className:(0,n.cx)(x.container,v&&x.pointer,p),"aria-label":`${y.name} icon`,children:m?(0,t.jsx)("div",{className:(0,n.cx)(x.content,x.textContent),children:m}):y.avatarUrl?(0,t.jsx)("img",{className:x.content,src:y.avatarUrl,alt:`${y.name} avatar`}):(0,t.jsx)("div",{className:(0,n.cx)(x.content,x.textContent),children:c(y.name)})});if(l){const b=(0,t.jsxs)("div",{className:x.tooltipContainer,children:[(0,t.jsx)("div",{className:x.tooltipName,children:y.name}),(0,t.jsx)("div",{className:x.tooltipDate,children:D?(0,t.jsxs)("div",{className:x.dotContainer,children:[(0,t.jsx)("span",{children:"Active last 15m"}),(0,t.jsx)("span",{className:x.dot})]}):a(u)})]});return(0,t.jsx)(g.m,{content:b,children:P})}else return P},h=d=>`0 0 0 1px ${d}`,f=(d,p)=>{const m=p?d.colors.primary.main:d.colors.border.medium,v=p?d.colors.primary.text:d.colors.border.strong;return{container:(0,n.css)({padding:0,width:"30px",height:"30px",background:"none",border:"none",borderRadius:d.shape.radius.circle,"& > *":{borderRadius:d.shape.radius.circle}}),content:(0,n.css)({lineHeight:"24px",maxWidth:"100%",border:`3px ${d.colors.background.primary} solid`,boxShadow:h(m),backgroundClip:"padding-box","&:hover":{boxShadow:h(v)}}),textContent:(0,n.css)({background:d.colors.background.primary,padding:0,color:d.colors.text.secondary,textAlign:"center",fontSize:d.typography.size.sm,"&:focus":{boxShadow:h(m)}}),tooltipContainer:(0,n.css)({textAlign:"center",padding:d.spacing(0,1)}),tooltipName:(0,n.css)({fontWeight:d.typography.fontWeightBold}),tooltipDate:(0,n.css)({fontWeight:d.typography.fontWeightRegular}),dotContainer:(0,n.css)({display:"flex",alignItems:"center"}),dot:(0,n.css)({height:"6px",width:"6px",backgroundColor:d.colors.primary.main,borderRadius:d.shape.radius.circle,display:"inline-block",marginLeft:d.spacing(1)}),pointer:(0,n.css)({cursor:"pointer"})}}},51986:(k,R,e)=>{"use strict";e.d(R,{i:()=>a});var t=e(74848),n=e(96540),i=e(13544),s=e(40845),r=e(55852),g=e(90182);function a({"aria-label":c,label:o,icon:h,options:f,onChange:d,variant:p,minWidth:m=16,size:v="sm",isFullWidth:l=!0,menuPlacement:y,fill:u,buttonCss:D}){const[E,x]=(0,n.useState)(!1),P=(0,s.$j)();return(0,t.jsxs)(t.Fragment,{children:[!E&&(0,t.jsx)(r.$n,{size:v||"sm",className:D,icon:h||"plus",onClick:()=>x(!0),variant:p,fill:u,fullWidth:l,"data-testid":i.Tp.components.ValuePicker.button(c??o),children:o}),E&&(0,t.jsx)("span",{style:{minWidth:P.spacing(m),flexGrow:l?1:void 0},children:(0,t.jsx)(g.l6,{placeholder:o,options:f,"aria-label":i.Tp.components.ValuePicker.select(c??o),isOpen:!0,onCloseMenu:()=>x(!1),autoFocus:!0,onChange:b=>{x(!1),d(b)},menuPlacement:y})})]})}},67266:(k,R,e)=>{"use strict";e.d(R,{KU:()=>a});var t=e(74848),n=e(32196),i=e(49185),s=e(40845),r=e(16797),g=e(40276);const a=({width:h,height:f,legend:d,children:p})=>{const m=(0,s.$j)(),v=(0,s.of)(c),l={display:"flex",width:`${h}px`,height:`${f}px`},[y,u]=(0,i.A)();if(!d)return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)("div",{style:l,className:v.viz,children:p(h,f)})});let{placement:D,maxHeight:E="35%",maxWidth:x="60%"}=d.props;document.body.clientWidth<m.breakpoints.values.lg&&(D="bottom");let P=null;const b={};switch(D){case"bottom":l.flexDirection="column",b.maxHeight=E,u.height&&(P={width:h,height:f-u.height});break;case"right":l.flexDirection="row",b.maxWidth=x,u.width&&(P={width:h-u.width,height:f}),d.props.width&&(b.width=d.props.width,P={width:h-d.props.width,height:f});break}return P?.width===0&&(P.width=h),P?.height===0&&(P.height=f),(0,t.jsxs)("div",{style:l,children:[(0,t.jsx)("div",{className:v.viz,children:P&&p(P.width,P.height)}),(0,t.jsx)("div",{style:b,ref:y,children:(0,t.jsx)(g.E,{hideHorizontalTrack:!0,children:d})})]})},c=h=>({viz:(0,n.css)({flexGrow:2,borderRadius:h.shape.radius.default,"&:focus-visible":(0,r.getFocusStyles)(h)})}),o=({children:h})=>(0,t.jsx)(t.Fragment,{children:h});a.Legend=o},94536:(k,R,e)=>{"use strict";e.d(R,{p:()=>g});var t=e(74848),n=e(32196),i=e(96540),s=e(8066),r=e(40845);const g=i.memo(i.forwardRef(({color:c,className:o,gradient:h,lineStyle:f,...d},p)=>{const m=(0,r.$j)(),v=(0,r.of)(a);let l;if(h){const u=s.uf.get(h).getColors?.(m);u?.length?l=`linear-gradient(90deg, ${u.join(", ")})`:l=m.visualization.getColorByName("")}else l=c;let y;return f?.fill==="dot"&&!h?y={backgroundImage:`radial-gradient(circle at 2px 2px, ${c} 2px, transparent 0)`,backgroundSize:"4px 4px",backgroundRepeat:"space"}:f?.fill==="dash"&&!h?y={backgroundImage:`linear-gradient(to right, ${c} 100%, transparent 0%)`,backgroundSize:"6px 4px",backgroundRepeat:"space"}:y={background:l,borderRadius:m.shape.radius.pill},(0,t.jsx)("div",{"data-testid":"series-icon",ref:p,className:(0,n.cx)(o,v.forcedColors,v.container),style:y,...d})})),a=c=>({container:(0,n.css)({marginRight:"8px",display:"inline-block",width:"14px",height:"4px"}),forcedColors:(0,n.css)({"@media (forced-colors: active)":{forcedColorAdjust:"none"}})});g.displayName="SeriesIcon"},96516:(k,R,e)=>{"use strict";e.d(R,{t:()=>I});var t=e(74848),n=e(96540),i=e(69129),s=e(52622),r=e(79041),g=e(88895),a=e(32196),c=e(40845),o=e(1551),h=e(33552),f=e(34375);const d=({items:T,itemRenderer:C,onLabelMouseOver:S,onLabelMouseOut:A,onLabelClick:L,placement:N,className:F,readonly:w})=>{const B=(0,c.of)(p);C||(C=K=>(0,t.jsx)(f.M,{item:K,onLabelClick:L,onLabelMouseOver:S,onLabelMouseOut:A,readonly:w}));const U=K=>`${K.getItemKey?K.getItemKey():K.label}`;switch(N){case"right":{const K=(V,H)=>(0,t.jsx)("span",{className:B.itemRight,children:C(V,H)});return(0,t.jsx)("div",{className:(0,a.cx)(B.rightWrapper,F),children:(0,t.jsx)(h.B,{items:T,renderItem:K,getItemKey:U})})}case"bottom":default:{const K=T.filter(Y=>Y.yAxis===1),V=T.filter(Y=>Y.yAxis!==1),H=(Y,X)=>(0,t.jsx)("span",{className:B.itemBottom,children:C(Y,X)});return(0,t.jsxs)("div",{className:(0,a.cx)(B.bottomWrapper,F),children:[K.length>0&&(0,t.jsx)("div",{className:B.section,children:(0,t.jsx)(o.c,{items:K,renderItem:H,getItemKey:U})}),V.length>0&&(0,t.jsx)("div",{className:(0,a.cx)(B.section,B.sectionRight),children:(0,t.jsx)(o.c,{items:V,renderItem:H,getItemKey:U})})]})}}};d.displayName="VizLegendList";const p=T=>{const C=(0,a.css)({paddingRight:"10px",display:"flex",fontSize:T.typography.bodySmall.fontSize,whiteSpace:"nowrap"});return{itemBottom:C,itemRight:(0,a.cx)(C,(0,a.css)({marginBottom:T.spacing(.5)})),rightWrapper:(0,a.css)({paddingLeft:T.spacing(.5)}),bottomWrapper:(0,a.css)({display:"flex",flexWrap:"wrap",justifyContent:"space-between",width:"100%",paddingLeft:T.spacing(.5),gap:"15px 25px"}),section:(0,a.css)({display:"flex"}),sectionRight:(0,a.css)({justifyContent:"flex-end",flexGrow:1,flexBasis:"50%"})}};var m=e(14578),v=e(83195),l=e(16797),y=e(94134);const u=({item:T,onLabelClick:C,onLabelMouseOver:S,onLabelMouseOut:A,className:L,readonly:N})=>{const F=(0,c.of)(D),w=(0,n.useCallback)(K=>{S&&S(T,K)},[T,S]),B=(0,n.useCallback)(K=>{A&&A(T,K)},[T,A]),U=(0,n.useCallback)(K=>{C&&C(T,K)},[T,C]);return(0,t.jsxs)("tr",{className:(0,a.cx)(F.row,L),children:[(0,t.jsx)("td",{children:(0,t.jsxs)("span",{className:F.itemWrapper,children:[(0,t.jsx)(y.R,{color:T.color,seriesName:T.fieldName??T.label,readonly:N,lineStyle:T.lineStyle}),(0,t.jsxs)("button",{disabled:N,type:"button",title:T.label,onBlur:B,onFocus:w,onMouseOver:w,onMouseOut:B,onClick:N?void 0:U,className:(0,a.cx)(F.label,T.disabled&&F.labelDisabled),children:[T.label," ",T.yAxis===2&&(0,t.jsx)("span",{className:F.yAxisLabel,children:"(right y-axis)"})]})]})}),T.getDisplayValues&&T.getDisplayValues().map((K,V)=>(0,t.jsx)("td",{className:F.value,children:(0,v.cN)(K)},`${K.title}-${V}`))]})};u.displayName="LegendTableItem";const D=T=>{const C=l.hoverColor(T.colors.background.primary,T);return{row:(0,a.css)({label:"LegendRow",fontSize:T.v1.typography.size.sm,borderBottom:`1px solid ${T.colors.border.weak}`,td:{padding:T.spacing(.25,1),whiteSpace:"nowrap"},"&:hover":{background:C}}),label:(0,a.css)({label:"LegendLabel",whiteSpace:"nowrap",background:"none",border:"none",fontSize:"inherit",padding:0,maxWidth:"600px",textOverflow:"ellipsis",overflow:"hidden",userSelect:"text"}),labelDisabled:(0,a.css)({label:"LegendLabelDisabled",color:T.colors.text.disabled}),itemWrapper:(0,a.css)({display:"flex",whiteSpace:"nowrap",alignItems:"center"}),value:(0,a.css)({textAlign:"right"}),yAxisLabel:(0,a.css)({color:T.colors.text.secondary})}},E="Name",x=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"}).compare,P=({items:T,sortBy:C,sortDesc:S,itemRenderer:A,className:L,onToggleSort:N,onLabelClick:F,onLabelMouseOver:w,onLabelMouseOut:B,readonly:U,isSortable:K})=>{const V=(0,c.of)(b),H={};K&&(H[E]="");for(const Y of T)if(Y.getDisplayValues)for(const X of Y.getDisplayValues())H[X.title??"?"]=X.description??"";if(C!=null){let Y=new Map;T.forEach(J=>{if(C!==E&&J.getDisplayValues){const q=J.getDisplayValues().find(j=>j.title===C),ae=q==null||Number.isNaN(q.numeric)?-1/0:q.numeric;Y.set(J,ae)}});let X=S?-1:1;C===E?T.sort((J,q)=>X*x(J.label,q.label)):T.sort((J,q)=>{const ae=Y.get(J)??0,j=Y.get(q)??0;return X*(ae-j)})}return A||(A=(Y,X)=>(0,t.jsx)(u,{item:Y,onLabelClick:F,onLabelMouseOver:w,onLabelMouseOut:B,readonly:U},`${Y.label}-${X}`)),(0,t.jsxs)("table",{className:(0,a.cx)(V.table,L),children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[!K&&(0,t.jsx)("th",{}),Object.keys(H).map(Y=>(0,t.jsxs)("th",{title:H[Y],className:(0,a.cx)(V.header,N&&V.headerSortable,K&&V.nameHeader,{[V.withIcon]:C===Y}),onClick:()=>{N&&N(Y)},children:[Y,C===Y&&(0,t.jsx)(m.I,{size:"xs",name:S?"angle-down":"angle-up"})]},Y))]})}),(0,t.jsx)("tbody",{children:T.map(A)})]})},b=T=>({table:(0,a.css)({width:"100%","th:first-child":{width:"100%",borderBottom:`1px solid ${T.colors.border.weak}`}}),header:(0,a.css)({color:T.colors.primary.text,fontWeight:T.typography.fontWeightMedium,borderBottom:`1px solid ${T.colors.border.weak}`,padding:T.spacing(.25,1,.25,1),fontSize:T.typography.bodySmall.fontSize,textAlign:"right",whiteSpace:"nowrap"}),nameHeader:(0,a.css)({textAlign:"left",paddingLeft:"30px"}),withIcon:(0,a.css)({paddingRight:"4px"}),headerSortable:(0,a.css)({cursor:"pointer"})});var M=e(29995),O=e(44895);function I({items:T,displayMode:C,sortBy:S,seriesVisibilityChangeBehavior:A=M.K.Isolate,sortDesc:L,onLabelClick:N,onToggleSort:F,placement:w,className:B,itemRenderer:U,readonly:K,isSortable:V}){const{eventBus:H,onToggleSeriesVisibility:Y,onToggleLegendSort:X}=(0,r.d2)(),J=(0,n.useCallback)((j,te)=>{H?.publish({type:i.b_.type,payload:{raw:te,x:0,y:0,dataId:j.label}})},[H]),q=(0,n.useCallback)((j,te)=>{H?.publish({type:i.ql.type,payload:{raw:te,x:0,y:0,dataId:j.label}})},[H]),ae=(0,n.useCallback)((j,te)=>{N&&N(j,te),Y&&Y(j.fieldName??j.label,A===M.K.Hide?g.B.AppendToSelection:(0,O.W)(te))},[Y,N,A]);switch(C){case s.lm.Table:return(0,t.jsx)(P,{className:B,items:T,placement:w,sortBy:S,sortDesc:L,onLabelClick:ae,onToggleSort:F||X,onLabelMouseOver:J,onLabelMouseOut:q,itemRenderer:U,readonly:K,isSortable:V});case s.lm.List:return(0,t.jsx)(d,{className:B,items:T,placement:w,onLabelMouseOver:J,onLabelMouseOut:q,onLabelClick:ae,itemRenderer:U,readonly:K});default:return null}}I.displayName="VizLegend"},34375:(k,R,e)=>{"use strict";e.d(R,{M:()=>d});var t=e(74848),n=e(32196),i=e(96540),s=e(13544),r=e(40845),g=e(94134),a=e(2543),c=e(83195),o=e(1551);const h=({stats:m})=>{const v=(0,r.of)(f);return m.length===0?null:(0,t.jsx)(o.c,{className:v.list,items:m,renderItem:l=>(0,t.jsxs)("div",{className:v.item,title:l.description,children:[l.title&&`${(0,a.capitalize)(l.title)}:`," ",(0,c.cN)(l)]})})},f=()=>({list:(0,n.css)({flexGrow:1,textAlign:"right"}),item:(0,n.css)({marginLeft:"8px"})});h.displayName="VizLegendStatsList";const d=({item:m,onLabelClick:v,onLabelMouseOver:l,onLabelMouseOut:y,className:u,readonly:D})=>{const E=(0,r.of)(p),x=(0,i.useCallback)(M=>{l&&l(m,M)},[m,l]),P=(0,i.useCallback)(M=>{y&&y(m,M)},[m,y]),b=(0,i.useCallback)(M=>{v&&v(m,M)},[m,v]);return(0,t.jsxs)("div",{className:(0,n.cx)(E.itemWrapper,m.disabled&&E.itemDisabled,u),"data-testid":s.Tp.components.VizLegend.seriesName(m.label),children:[(0,t.jsx)(g.R,{seriesName:m.fieldName??m.label,color:m.color,gradient:m.gradient,readonly:D,lineStyle:m.lineStyle}),(0,t.jsx)("button",{disabled:D,type:"button",onBlur:P,onFocus:x,onMouseOver:x,onMouseOut:P,onClick:b,className:E.label,children:m.label}),m.getDisplayValues&&(0,t.jsx)(h,{stats:m.getDisplayValues()})]})};d.displayName="VizLegendListItem";const p=m=>({label:(0,n.css)({label:"LegendLabel",whiteSpace:"nowrap",background:"none",border:"none",fontSize:"inherit",padding:0,userSelect:"text"}),itemDisabled:(0,n.css)({label:"LegendLabelDisabled",color:m.colors.text.disabled}),itemWrapper:(0,n.css)({label:"LegendItemWrapper",display:"flex",whiteSpace:"nowrap",alignItems:"center",flexGrow:1}),value:(0,n.css)({textAlign:"right"}),yAxisLabel:(0,n.css)({color:m.v1.palette.gray2})})},94134:(k,R,e)=>{"use strict";e.d(R,{R:()=>g});var t=e(74848),n=e(96540),i=e(83598),s=e(79041),r=e(94536);const g=(0,n.memo)(({seriesName:a,color:c,gradient:o,readonly:h,lineStyle:f})=>{const{onSeriesColorChange:d}=(0,s.d2)(),p=(0,n.useCallback)(m=>d(a,m),[a,d]);return a&&d&&c&&!h?(0,t.jsx)(i.Dp,{color:c,onChange:p,enableNamedColors:!0,children:({ref:m,showColorPicker:v,hideColorPicker:l})=>(0,t.jsx)(r.p,{color:c,className:"pointer",ref:m,onClick:v,onMouseLeave:l,lineStyle:f})}):(0,t.jsx)(r.p,{color:c,gradient:o,lineStyle:f})});g.displayName="VizLegendSeriesIcon"},29995:(k,R,e)=>{"use strict";e.d(R,{K:()=>t});var t=(n=>(n[n.Isolate=0]="Isolate",n[n.Hide=1]="Hide",n))(t||{})},44895:(k,R,e)=>{"use strict";e.d(R,{W:()=>n});var t=e(88895);function n(i){return i.ctrlKey||i.metaKey||i.shiftKey?t.B.AppendToSelection:t.B.ToggleSelection}},12509:(k,R,e)=>{"use strict";e.d(R,{S:()=>a});var t=e(74848),n=e(2543),i=e(96540),s=e(47070);const r=(o,h,f,d)=>{const p=g(o,h,d),m=g(h,o,d),v=Math.max(p,m);let l=Math.floor(o/v),y=Math.ceil(d/l);l=Math.ceil(d/y);const u=l-(l*y-d),D=o/u-f+f/u;return{width:o/l-f+f/l,height:h/y-f+f/y,widthOnLastRow:D,xCount:l,yCount:y}};function g(o,h,f){const d=Math.ceil(Math.sqrt(f*o/h));return Math.floor(d*h/o)*d<f?h/Math.ceil(d*h/o):o/d}class a extends i.PureComponent{static{this.defaultProps={itemSpacing:8}}constructor(h){super(h),this.state={values:h.getValues()}}componentDidUpdate(h){const{renderCounter:f,source:d}=this.props;(f!==h.renderCounter||d!==h.source)&&this.setState({values:this.props.getValues()})}getOrientation(){const{orientation:h,width:f,height:d}=this.props;return h===s.wV.Auto?f>d?s.wV.Vertical:s.wV.Horizontal:h}renderGrid(){const{renderValue:h,height:f,width:d,itemSpacing:p,getAlignmentFactors:m,orientation:v}=this.props,{values:l}=this.state,y=r(d,f,p,l.length),u=m?m(l,y.width,y.height):{};let D=0,E=0,x=[];for(let P=0;P<l.length;P++){const b=l[P],O=E===y.yCount-1?y.widthOnLastRow:y.width,I=y.height,T=D*O+p*D,C=E*I+p*E,S={position:"absolute",left:T,top:C,width:`${O}px`,height:`${I}px`};x.push((0,t.jsx)("div",{style:S,children:h({value:b,width:O,height:I,alignmentFactors:u,orientation:v,count:l.length})},P)),D++,D===y.xCount&&(D=0,E++)}return(0,t.jsx)("div",{style:{position:"relative"},children:x})}render(){const{renderValue:h,height:f,width:d,itemSpacing:p,getAlignmentFactors:m,autoGrid:v,orientation:l,maxVizHeight:y,minVizWidth:u,minVizHeight:D}=this.props,{values:E}=this.state;if(v&&l===s.wV.Auto)return this.renderGrid();const x={display:"flex"},P={display:"flex",overflow:`${u?"auto":"hidden"} ${D?"auto":"hidden"}`};let b=f,M=d;const O=this.getOrientation();switch(O){case s.wV.Horizontal:const T=(f+p)/E.length-p;P.flexDirection="column",P.height=`${f}px`,x.marginBottom=`${p}px`,M=d,b=(0,n.clamp)(T,D??0,y??T);break;case s.wV.Vertical:P.flexDirection="row",P.justifyContent="space-between",x.marginRight=`${p}px`,b=f,M=Math.max(d/E.length-p+p/E.length,u??0)}x.width=`${M}px`,x.height=`${b}px`;const I=m?m(E,M,b):{};return(0,t.jsx)("div",{style:P,children:E.map((T,C)=>(0,t.jsx)("div",{style:c(x,C,E.length),children:h({value:T,width:M,height:b,alignmentFactors:I,orientation:O,count:E.length})},C))})}}function c(o,h,f){return h===f-1?{...o,marginRight:0,marginBottom:0}:o}},3139:(k,R,e)=>{"use strict";e.d(R,{g:()=>g,o:()=>a});var t=e(74848),n=e(32196),i=e(40845),s=e(94536);const r=c=>({icon:(0,n.css)({marginRight:c.spacing(1),verticalAlign:"middle"}),seriesTable:(0,n.css)({display:"table"}),seriesTableRow:(0,n.css)({display:"table-row",fontSize:c.typography.bodySmall.fontSize}),seriesTableCell:(0,n.css)({display:"table-cell"}),label:(0,n.css)({wordBreak:"break-all"}),value:(0,n.css)({paddingLeft:c.spacing(2),textAlign:"right"}),activeSeries:(0,n.css)({fontWeight:c.typography.fontWeightBold,color:c.colors.text.maxContrast}),timestamp:(0,n.css)({fontWeight:c.typography.fontWeightBold,fontSize:c.typography.bodySmall.fontSize})}),g=({color:c,label:o,value:h,isActive:f})=>{const d=(0,i.of)(r);return(0,t.jsxs)("div",{"data-testid":"SeriesTableRow",className:(0,n.cx)(d.seriesTableRow,f&&d.activeSeries),children:[c&&(0,t.jsx)("div",{className:d.seriesTableCell,children:(0,t.jsx)(s.p,{color:c,className:d.icon})}),o&&(0,t.jsx)("div",{className:(0,n.cx)(d.seriesTableCell,d.label),children:o}),h&&(0,t.jsx)("div",{className:(0,n.cx)(d.seriesTableCell,d.value),children:h})]})},a=({timestamp:c,series:o})=>{const h=(0,i.of)(r);return(0,t.jsxs)(t.Fragment,{children:[c&&(0,t.jsx)("div",{className:h.timestamp,"aria-label":"Timestamp",children:c}),o.map((f,d)=>(0,t.jsx)(g,{isActive:f.isActive,label:f.label,color:f.color,value:f.value},`${f.label}-${d}`))]})}},75128:(k,R,e)=>{"use strict";e.d(R,{n:()=>g});var t=e(74848),n=e(32196),i=e(40845),s=e(17464),r=e(69503);const g=({content:c,position:o,offset:h})=>{const f=(0,i.of)(a);return o?(0,t.jsx)(s.ZL,{className:f.portal,children:(0,t.jsx)(r.o,{position:o,offset:h||{x:0,y:0},children:c})}):null};g.displayName="VizTooltip";const a=()=>({portal:(0,n.css)({position:"absolute",top:0,left:0,pointerEvents:"none",width:"100%",height:"100%"})})},69503:(k,R,e)=>{"use strict";e.d(R,{o:()=>c});var t=e(74848),n=e(32196),i=e(96540),s=e(52908),r=e(40845),g=e(16797),a=e(10875);const c=({position:{x:h,y:f},offset:{x:d,y:p},children:m,allowPointerEvents:v=!1,className:l,...y})=>{const u=(0,i.useRef)(null),[D,E]=(0,i.useState)({width:0,height:0}),{width:x,height:P}=(0,s.A)(),[b,M]=(0,i.useState)({x:h+d,y:f+p}),O=(0,i.useMemo)(()=>new ResizeObserver(T=>{for(let C of T){const S=Math.floor(C.contentRect.width+16),A=Math.floor(C.contentRect.height+2*8);(D.width!==S||D.height!==A)&&E({width:Math.min(S,x),height:Math.min(A,P)})}}),[D,x,P]);(0,i.useLayoutEffect)(()=>(u.current&&O.observe(u.current),()=>{O.disconnect()}),[O]),(0,i.useLayoutEffect)(()=>{if(u&&u.current){const{x:T,y:C}=(0,a.Ju)(h,f,D.width,D.height,d,p,x,P);M({x:T,y:C})}},[x,P,h,d,f,p,D]);const I=(0,r.of)(o);return(0,t.jsx)("div",{ref:u,style:{position:"fixed",left:0,pointerEvents:v?"auto":"none",top:0,transform:`translate(${b.x}px, ${b.y}px)`,transition:"transform ease-out 0.1s"},"aria-live":"polite","aria-atomic":"true",...y,className:(0,n.cx)(I.wrapper,l),children:m})};c.displayName="VizTooltipContainer";const o=h=>({wrapper:(0,n.css)((0,g.getTooltipContainerStyles)(h))})},11389:(k,R,e)=>{"use strict";e.d(R,{o:()=>r});var t=e(74848),n=e(32196),i=e(40845),s=e(13471);const r=({items:a,children:c,isPinned:o,scrollable:h=!1,maxHeight:f})=>{const d=(0,i.of)(g),p=h?{maxHeight:f,overflowY:"auto"}:{};return(0,t.jsxs)("div",{className:d.wrapper,style:p,children:[a.map(({label:m,value:v,color:l,colorIndicator:y,colorPlacement:u,isActive:D,lineStyle:E},x)=>(0,t.jsx)(s.B,{label:m,value:v,color:l,colorIndicator:y,colorPlacement:u,isActive:D,justify:"space-between",isPinned:o,lineStyle:E,showValueScroll:!h},x)),c]})},g=a=>({wrapper:(0,n.css)({display:"flex",flexDirection:"column",flex:1,gap:4,borderTop:`1px solid ${a.colors.border.medium}`,padding:a.spacing(1)})})},58749:(k,R,e)=>{"use strict";e.d(R,{S:()=>c});var t=e(74848),n=e(32196),i=e(67061),s=e(14689),r=e(55852),g=e(40845);const a="add-annotation-button",c=({dataLinks:h,annotate:f})=>{const d=(0,g.of)(o),p=()=>{const m={variant:"secondary"};return(0,t.jsx)(i.B,{direction:"column",justifyContent:"flex-start",children:h.map((v,l)=>(0,t.jsx)(s.R,{link:v,buttonProps:m},l))})};return(0,t.jsxs)("div",{className:d.wrapper,children:[h.length>0&&(0,t.jsx)("div",{className:d.dataLinks,children:p()}),f!=null&&(0,t.jsx)("div",{className:d.addAnnotations,children:(0,t.jsx)(r.$n,{icon:"comment-alt",variant:"secondary",size:"sm",id:a,onClick:f,children:"Add annotation"})})]})},o=h=>({wrapper:(0,n.css)({display:"flex",flexDirection:"column",flex:1,padding:h.spacing(0)}),dataLinks:(0,n.css)({borderTop:`1px solid ${h.colors.border.medium}`,padding:h.spacing(1)}),addAnnotations:(0,n.css)({borderTop:`1px solid ${h.colors.border.medium}`,padding:h.spacing(1)})})},52415:(k,R,e)=>{"use strict";e.d(R,{A:()=>r});var t=e(74848),n=e(32196),i=e(40845),s=e(13471);const r=({item:a,isPinned:c})=>{const o=(0,i.of)(g),{label:h,value:f,color:d,colorIndicator:p}=a;return(0,t.jsx)("div",{className:o.wrapper,children:(0,t.jsx)(s.B,{label:h,value:f,color:d,colorIndicator:p,marginRight:"22px",isPinned:c})})},g=a=>({wrapper:(0,n.css)({display:"flex",flexDirection:"column",flex:1,padding:a.spacing(1)})})},13471:(k,R,e)=>{"use strict";e.d(R,{B:()=>u});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(32982),g=e(56034),a=e(24293),c=e(94536),o=e(79871),h=e(10875),f=(E=>(E[E.Leading=0]="Leading",E[E.Trailing=1]="Trailing",E))(f||{});const d=({color:E=a.F,colorIndicator:x=o.Ev,position:P=0,lineStyle:b})=>{const M=(0,s.of)(p);return x===o.fX.series?(0,t.jsx)(c.p,{color:E,lineStyle:b,className:P===0?M.leading:M.trailing}):(0,t.jsx)("span",{style:{backgroundColor:E},className:(0,n.cx)(P===0?M.leading:M.trailing,(0,h.L$)(x,M))})},p=E=>({leading:(0,n.css)({marginRight:E.spacing(.5)}),trailing:(0,n.css)({marginLeft:E.spacing(.5)}),value:(0,n.css)({width:"12px",height:"12px",borderRadius:E.shape.radius.default,fontWeight:500,minWidth:"12px"}),hexagon:(0,n.css)({}),pie_1_4:(0,n.css)({}),pie_2_4:(0,n.css)({}),pie_3_4:(0,n.css)({}),marker_sm:(0,n.css)({width:"4px",height:"4px",borderRadius:E.shape.radius.circle,minWidth:"4px"}),marker_md:(0,n.css)({width:"8px",height:"8px",borderRadius:E.shape.radius.circle,minWidth:"8px"}),marker_lg:(0,n.css)({width:"12px",height:"12px",borderRadius:E.shape.radius.circle,minWidth:"12px"})});var m=(E=>(E.label="label",E.value="value",E))(m||{});const v="Copied to clipboard",l=2*1e3,y=7,u=({label:E,value:x,color:P,colorIndicator:b,colorPlacement:M=o.lJ.first,justify:O="flex-start",isActive:I=!1,marginRight:T="0px",isPinned:C,lineStyle:S,showValueScroll:A})=>{const L=(0,s.of)(D,O,T),N=A?{maxHeight:55,whiteSpace:"wrap",wordBreak:"break-word",overflowY:"auto"}:{whiteSpace:"wrap",wordBreak:"break-word"},[F,w]=(0,i.useState)(!1),[B,U]=(0,i.useState)(null),[K,V]=(0,i.useState)(!1),H=(0,i.useRef)(null),Y=(0,i.useRef)(null);(0,i.useEffect)(()=>{let j;return K&&(j=setTimeout(()=>{V(!1)},l)),()=>{window.clearTimeout(j)}},[K]);const X=async(j,te)=>{if(!(navigator?.clipboard&&window.isSecureContext)){J(j,te);return}try{await navigator.clipboard.writeText(j),U({[`${te}`]:j}),V(!0)}catch{U(null)}},J=(j,te)=>{const ne=document.createElement("textarea");H.current?.appendChild(ne),ne.value=j,ne.focus(),ne.select();try{document.execCommand("copy")&&(U({[`${te}`]:j}),V(!0))}catch(le){console.error("Unable to copy to clipboard",le)}ne.remove()},q=j=>{j.currentTarget.offsetWidth<j.currentTarget.scrollWidth&&w(!0)},ae=()=>w(!1);return E.length*y>window.innerWidth/2&&(E=E.replaceAll("{",`{
  `).replaceAll("}",`
}`).replaceAll(", ",`,
  `)),(0,t.jsxs)("div",{className:L.contentWrapper,children:[(P||E)&&(0,t.jsxs)("div",{className:L.valueWrapper,children:[P&&M===o.lJ.first&&(0,t.jsx)(d,{color:P,colorIndicator:b,lineStyle:S}),C?(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(g.m,{content:E,interactive:!1,show:F,children:(0,t.jsxs)(t.Fragment,{children:[K&&B?.label&&(0,t.jsx)(r.r,{placement:"top",referenceElement:H.current,children:v}),(0,t.jsx)("div",{className:(0,n.cx)(L.label,I&&L.activeSeries,navigator?.clipboard&&L.copy),onMouseEnter:q,onMouseLeave:ae,onClick:()=>X(E,"label"),ref:H,children:E})]})})}):(0,t.jsx)("div",{className:(0,n.cx)(L.label,I&&L.activeSeries),children:E})]}),(0,t.jsxs)("div",{className:L.valueWrapper,children:[P&&M===o.lJ.leading&&(0,t.jsx)(d,{color:P,colorIndicator:b,position:f.Leading,lineStyle:S}),C?(0,t.jsxs)(t.Fragment,{children:[K&&B?.value&&(0,t.jsx)(r.r,{placement:"top",referenceElement:Y.current,children:v}),(0,t.jsx)("div",{className:(0,n.cx)(L.value,I,navigator?.clipboard&&L.copy),style:N,onClick:()=>X(x?x.toString():"","value"),ref:Y,children:x})]}):(0,t.jsx)("div",{className:(0,n.cx)(L.value,I),style:N,children:x}),P&&M===o.lJ.trailing&&(0,t.jsx)(d,{color:P,colorIndicator:b,position:f.Trailing,lineStyle:S})]})]})},D=(E,x,P)=>({contentWrapper:(0,n.css)({display:"flex",alignItems:"start",justifyContent:x,marginRight:P}),label:(0,n.css)({color:E.colors.text.secondary,fontWeight:400,textOverflow:"ellipsis",overflow:"hidden",marginRight:E.spacing(2)}),value:(0,n.css)({fontWeight:500,textOverflow:"ellipsis",overflow:"hidden"}),valueWrapper:(0,n.css)({display:"flex",alignItems:"center"}),activeSeries:(0,n.css)({fontWeight:E.typography.fontWeightBold,color:E.colors.text.maxContrast}),copy:(0,n.css)({cursor:"pointer"})})},79871:(k,R,e)=>{"use strict";e.d(R,{Ev:()=>i,fX:()=>t,lJ:()=>n});var t=(s=>(s.series="series",s.value="value",s.hexagon="hexagon",s.pie_1_4="pie_1_4",s.pie_2_4="pie_2_4",s.pie_3_4="pie_3_4",s.marker_sm="marker_sm",s.marker_md="marker_md",s.marker_lg="marker_lg",s))(t||{}),n=(s=>(s.hidden="hidden",s.first="first",s.leading="leading",s.trailing="trailing",s))(n||{});const i="series"},10875:(k,R,e)=>{"use strict";e.d(R,{Ju:()=>a,L$:()=>c,cp:()=>d});var t=e(11261),n=e(8066),i=e(83195),s=e(24293),r=e(52622),g=e(79871);const a=(p=0,m=0,v=0,l=0,y=0,u=0,D=0,E=0)=>{let x=p,P=m;const b=Math.max(p+y+v-(D-y),0),M=Math.abs(Math.min(p-y-v-y,0)),O=b>0,I=M>0,T=Math.max(m+u+l-(E-u),0),C=Math.abs(Math.min(m-u-l-u,0)),S=T>0,A=C>0;return O&&I?x=b>M?y:D-y-v:O?x=p-y-v:x=p+y,S&&A?P=T>C?u:E-u-l:S?P=m-u-l:P=m+u,{x,y:P}},c=(p,m)=>{switch(p){case g.fX.value:return m.value;case g.fX.hexagon:return m.hexagon;case g.fX.pie_1_4:return m.pie_1_4;case g.fX.pie_2_4:return m.pie_2_4;case g.fX.pie_3_4:return m.pie_3_4;case g.fX.marker_sm:return m.marker_sm;case g.fX.marker_md:return m.marker_md;case g.fX.marker_lg:return m.marker_lg;default:return m.value}},o=(p,m)=>p.numeric-m.numeric,h=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"}),f=(p,m)=>h.compare(`${p.value}`,`${m.value}`),d=(p,m,v,l,y,u,D=E=>!0)=>{let E=[],x=!0;for(let P=0;P<p.length;P++){const b=p[P];if(b===m||b.type===t.PU.time||!D(b)||b.config.custom?.hideFrom?.tooltip||b.config.custom?.hideFrom?.viz||y===r.$N.Single&&l!==P)continue;let M=v[P];if(M==null)continue;b.type===t.PU.number||b.type===t.PU.boolean||b.type===t.PU.enum||(x=!1);const O=p[P].values[M];if(O==null&&b.config.noValue==null)continue;const I=b.display(O),T=Number.isNaN(I.numeric)?u===r.xB.Descending?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER:I.numeric,C=(0,n.Qi)(b);let S=g.fX.series,A=g.lJ.first;C.isByValue&&(S=g.fX.value,A=g.lJ.trailing),E.push({label:b.state?.displayName??b.name,value:(0,i.cN)(I),color:I.color??s.F,colorIndicator:S,colorPlacement:A,isActive:y===r.$N.Multi&&l===P,numeric:T,lineStyle:b.config.custom?.lineStyle})}if(u!==r.xB.None&&E.length>1){const P=x?o:f,b=u===r.xB.Descending?-1:1;E.sort((M,O)=>b*P(M,O))}return E}},94333:(k,R,e)=>{"use strict";e.r(R),e.d(R,{Alert:()=>he.F,AlertingSettings:()=>Cn.i,AsyncMultiSelect:()=>Ln.Iv,AsyncSelect:()=>Ln.DW,AsyncVirtualizedSelect:()=>Ln.gZ,AutoSaveField:()=>ae.p,AutoSizeInput:()=>ma.D,Avatar:()=>on.e,Badge:()=>Is.E,BarGauge:()=>vt.xE,BarGaugeDisplayMode:()=>Ss.eX,BigValue:()=>ze.yV,BigValueColorMode:()=>ze.yp,BigValueGraphMode:()=>ze.$p,BigValueJustifyMode:()=>ze.F8,BigValueTextMode:()=>ze.SV,Box:()=>es.a,BrowserLabel:()=>Oo.J,Button:()=>Zt.$n,ButtonCascader:()=>x.H,ButtonGroup:()=>jn.e,ButtonSelect:()=>Qo.f,CallToActionCard:()=>zt.c,Card:()=>vr.Z,CardContainer:()=>Ur.Q,Cascader:()=>E.v,CertificationKey:()=>Et.K,Checkbox:()=>Yr.S,ClickOutsideWrapper:()=>xt.N,ClipboardButton:()=>D.b,CodeEditor:()=>se.B,CodeEditorSuggestionItemKind:()=>Z.q,CollapsableSection:()=>et.M,Collapse:()=>We.S,ColorPicker:()=>O.sk,ColorPickerInput:()=>I.i,ConfirmButton:()=>h.Z,ConfirmModal:()=>z.u,Container:()=>$s.mc,ContextMenu:()=>Nt.t,ControlledCollapse:()=>We.a,Counter:()=>Ue.p,CustomHeadersSettings:()=>tn.P,CustomScrollbar:()=>y.E,DataLinkButton:()=>rt.R,DataLinkInput:()=>Qe.l,DataLinksContextMenu:()=>pt.e,DataLinksInlineEditor:()=>ot.e,DataSourceHttpSettings:()=>an.t,DatePicker:()=>V.l,DatePickerWithInput:()=>H.l,DateTimePicker:()=>Y.K,DeleteButton:()=>f.e,Divider:()=>Un.c,Drawer:()=>Wn._,Dropdown:()=>Eo.m,EmptySearchResult:()=>C.Z,EmptyState:()=>S.p,ErrorBoundary:()=>Kn.tH,ErrorBoundaryAlert:()=>Kn.Xw,ErrorWithStack:()=>Bt.D,EventBusPlugin:()=>Dr.Ku,EventsCanvas:()=>Cr.a,FIXED_UNIT:()=>dr.s,FadeTransition:()=>Gt.A,FeatureBadge:()=>Pn.y,FeatureInfoBox:()=>mn.e,Field:()=>nr.D,FieldArray:()=>cr.E,FieldLinkList:()=>nt.n,FieldSet:()=>ga.n,FieldValidationMessage:()=>$a.P,FileDropzone:()=>lo.gH,FileDropzoneDefaultChildren:()=>lo.wI,FileListItem:()=>lo.IB,FileUpload:()=>Rr.e,FilterInput:()=>ar.Z,FilterPill:()=>le.m,Form:()=>Wt.l,FormattedValueDisplay:()=>Er.i,FullWidthButtonContainer:()=>gt.V,Gauge:()=>dt._,Graph:()=>za.T,GraphContextMenu:()=>Ca.H,GraphContextMenuHeader:()=>Ca.i,GraphNG:()=>hr.o,GraphSeriesToggler:()=>Ce.M,GraphWithLegend:()=>Do.I,Grid:()=>ca.x,HorizontalGroup:()=>$s.Gy,Icon:()=>c.I,IconButton:()=>o.K,InfoBox:()=>At.w,InlineField:()=>Za.I,InlineFieldRow:()=>Ea.C,InlineFormLabel:()=>vn.I,InlineLabel:()=>Va.c,InlineSegmentGroup:()=>mr.e,InlineSwitch:()=>Sr.K,InlineToast:()=>P.r,Input:()=>sr.p,InputControl:()=>ut.e,InteractiveTable:()=>J.j,JSONFormatter:()=>fn.B,JsonExplorer:()=>Rn.O,KeyboardPlugin:()=>Dr.Z7,Label:()=>Zs.J,LegacyForms:()=>ri,LegacyInputStatus:()=>n.O,Legend:()=>lr.s,Link:()=>js.N,LinkButton:()=>Zt.z9,List:()=>X.B,LoadingBar:()=>M.G,LoadingPlaceholder:()=>b._,Marker:()=>Cr.pH,Menu:()=>Vt.W,MenuGroup:()=>en.r,MenuItem:()=>Je.D,Modal:()=>ce.a,ModalHeader:()=>ye.r,ModalRoot:()=>De.EO,ModalTabContent:()=>ue.O,ModalTabsHeader:()=>re.J,ModalsContext:()=>De.wE,ModalsController:()=>De.$s,ModalsProvider:()=>De.YO,MultiSelect:()=>Ln.KF,PageToolbar:()=>ge.d,Pagination:()=>j.d,PanelChrome:()=>Ee.NR,PanelChromeLoadingIndicator:()=>me.I,PanelContainer:()=>Io._,PanelContextProvider:()=>ve.XF,PanelContextRoot:()=>ve.e4,PlotLegend:()=>Ia.$,PluginSignatureBadge:()=>Lt.B,Popover:()=>m.A,PopoverController:()=>p.I,Portal:()=>l.ZL,PortalContainer:()=>l.qB,QueryField:()=>ee.X,RadioButtonDot:()=>Ta.J,RadioButtonGroup:()=>pa.z,RadioButtonList:()=>ua.a,RangeSlider:()=>Tt.F,ReactMonacoEditor:()=>ie.m,RefreshPicker:()=>N.cC,RelativeTimeRangePicker:()=>po.N,RenderUserContentAsHTML:()=>$e.I,ScaleDistribution:()=>Ss.L4,SecretInput:()=>Ya.L,SecretTextArea:()=>xr.l,SecureSocksProxySettings:()=>xn.Y,Segment:()=>qt.Y,SegmentAsync:()=>cn.s,SegmentInput:()=>En.o,SegmentSection:()=>Tn.L,SegmentSelect:()=>Sn.a,Select:()=>Ln.l6,SelectContainer:()=>Ln.KA,SelectMenuOptions:()=>Jn.o5,SeriesColorPicker:()=>O.Dp,SeriesColorPickerPopover:()=>T.o,SeriesColorPickerPopoverWithTheme:()=>T.t,SeriesIcon:()=>Pt.p,SeriesTable:()=>Ve.o,SeriesTableRow:()=>Ve.g,SeriesVisibilityChangeBehavior:()=>Ie.K,SeriesVisibilityChangeMode:()=>ur.B,SetInterval:()=>Te.u,SlideOutTransition:()=>ln.n,Slider:()=>Nn.A,Space:()=>Ks.$,Sparkline:()=>qe.O,Spinner:()=>Ft.y,Stack:()=>_s.B,StatsPicker:()=>L.S,Switch:()=>Sr.d,TLSAuthSettings:()=>Vn.j,Tab:()=>Ze.o,TabContent:()=>Pe.J,TabbedContainer:()=>u.q,Table:()=>Le.X,TableInputCSV:()=>Ye.b,TabsBar:()=>je.U,Tag:()=>te.v,TagList:()=>ne.L,TagsInput:()=>q.u,Text:()=>Ps.E,TextArea:()=>Hr.f,TextLink:()=>ys.Y,TimeOfDayPicker:()=>B.R,TimePickerTooltip:()=>F.xS,TimeRangeInput:()=>Bo.b,TimeRangeLabel:()=>w.f,TimeRangePicker:()=>F.$6,TimeSeries:()=>Ma.Z,TimeZonePicker:()=>U.U,Toggletip:()=>v.G,ToolbarButton:()=>Xn.I,ToolbarButtonRow:()=>Qn.U,Tooltip:()=>d.m,TooltipPlugin:()=>Mi.T,TooltipPlugin2:()=>Dr.xl,UPLOT_AXIS_FONT_SIZE:()=>Oa.pi,UPlotChart:()=>ss.Z,UPlotConfigBuilder:()=>Ra.e,UnitPicker:()=>A.p,UserIcon:()=>Ht.n,ValuePicker:()=>Fn.i,VerticalGroup:()=>$s.gW,VerticalTab:()=>Ne.s,VirtualizedSelect:()=>Ln.ip,VizLayout:()=>Se.KU,VizLegend:()=>Oe.t,VizLegendListItem:()=>Re.M,VizRepeater:()=>pe.S,VizTooltip:()=>yt.n,VizTooltipContainer:()=>st.o,WeekStartPicker:()=>K.l,WithContextMenu:()=>ct.n,XYCanvas:()=>Cr._X,ZoomPlugin:()=>No.j,buildScaleKey:()=>Uo.My,clearButtonStyles:()=>Zt.my,convertOldAngularValueMapping:()=>St.I1,defaultIntervals:()=>N.cb,fieldMatchersUI:()=>qn.g,getCardStyles:()=>vr.H,getDragStyles:()=>cs.l,getInputStyles:()=>sr.n,getPortalContainer:()=>l.gF,getSelectStyles:()=>gs.J,getWeekStart:()=>K.r,graphFieldOptions:()=>Js.t,graphTickFormatter:()=>Aa.Yn,graphTimeFormat:()=>Aa.Jc,preparePlotFrame:()=>Uo.mY,resetSelectStyles:()=>sn.A,sharedInputStyle:()=>jt.Xb,sharedSingleStatMigrationHandler:()=>St._$,sharedSingleStatPanelChangedHandler:()=>St.gl,useGraphNGContext:()=>ho.I,usePanelContext:()=>ve.d2,useSplitter:()=>os.h,variableSuggestionToCodeEditorSuggestion:()=>oe.O,withErrorBoundary:()=>Kn.Xc});var t=e(90090),n=e(91634),i=e(24169),s=e(11206),r=e(22209),g=e(74716),a=e(56286),c=e(14578),o=e(29158),h=e(82702),f=e(91605),d=e(56034),p=e(95868),m=e(13840),v=e(60782),l=e(17464),y=e(40276),u=e(60734),D=e(10534),E=e(3988),x=e(32012),P=e(32982),b=e(39558),M=e(57514),O=e(83598),I=e(99128),T=e(70104),C=e(41670),S=e(69529),A=e(2056),L=e(42734),N=e(11134),F=e(15666),w=e(3799),B=e(66070),U=e(20333),K=e(15648),V=e(56181),H=e(98239),Y=e(63383),X=e(33552),J=e(48840),q=e(79924),ae=e(28270),j=e(19384),te=e(78369),ne=e(64149),le=e(92174),z=e(96374),ee=e(20084),se=e(32372),ie=e(85828),Z=e(19716),oe=e(99544),ce=e(37390),ye=e(29473),re=e(25897),ue=e(95246),De=e(71678),ge=e(95247),Te=e(67570),Le=e(77093),Ye=e(14746),je=e(63021),Ze=e(40675),Ne=e(90685),Pe=e(40980),Ue=e(53402),$e=e(44522),ze=e(37494),qe=e(5926),dt=e(95164),vt=e(97696),yt=e(75128),st=e(69503),Ve=e(3139),pe=e(12509),Ee=e(91052),me=e(89963),ve=e(79041),Se=e(67266),Ie=e(29995),Oe=e(96516),Re=e(34375),he=e(42418),Ce=e(84656),We=e(82762),et=e(57418),rt=e(14689),nt=e(79961),gt=e(61458),xt=e(8866),St=e(37713),zt=e(76442),Nt=e(28122),Vt=e(38138),en=e(59093),Je=e(64539),ct=e(51686),ot=e(64919),Qe=e(64078),pt=e(59796),Pt=e(94536),At=e(37166),mn=e(86460),Pn=e(29678),fn=e(24022),Rn=e(44533),Kn=e(66602),Bt=e(52446),an=e(91409),tn=e(11184),Cn=e(19849),xn=e(17081),Vn=e(95180),Et=e(28623),Ft=e(62930),Gt=e(31511),ln=e(72960),qt=e(38401),cn=e(83684),En=e(57752),Sn=e(13102),Tn=e(64765),Wn=e(87978),Nn=e(77014),Tt=e(47097),Wt=e(51253),jt=e(87266),ut=e(16504),Zt=e(55852),jn=e(19727),Xn=e(27746),Qn=e(15068),Fn=e(51986),qn=e(84349),js=e(50720),ys=e(72109),Ps=e(94753),es=e(90613),_s=e(67061),ca=e(71259),Ks=e(68402),Zs=e(60029),nr=e(88575),lr=e(17408),ga=e(84167),$a=e(72093),Za=e(14186),mr=e(63056),Va=e(76892),Ea=e(39268),cr=e(95984),sn=e(23731),Ln=e(90182),Jn=e(12681),gs=e(88824),kn=e(62883),Gn=e.n(kn),Gs={};for(const wo in kn)["default","Icon","IconButton","ConfirmButton","DeleteButton","Tooltip","PopoverController","Popover","Toggletip","Portal","getPortalContainer","PortalContainer","CustomScrollbar","TabbedContainer","ClipboardButton","Cascader","ButtonCascader","InlineToast","LoadingPlaceholder","LoadingBar","ColorPicker","SeriesColorPicker","ColorPickerInput","SeriesColorPickerPopover","SeriesColorPickerPopoverWithTheme","EmptySearchResult","EmptyState","UnitPicker","StatsPicker","RefreshPicker","defaultIntervals","TimeRangePicker","TimePickerTooltip","TimeRangeLabel","TimeOfDayPicker","TimeZonePicker","WeekStartPicker","getWeekStart","DatePicker","DatePickerWithInput","DateTimePicker","List","InteractiveTable","TagsInput","AutoSaveField","Pagination","Tag","TagList","FilterPill","ConfirmModal","QueryField","CodeEditor","ReactMonacoEditor","CodeEditorSuggestionItemKind","variableSuggestionToCodeEditorSuggestion","Modal","ModalHeader","ModalTabsHeader","ModalTabContent","ModalsProvider","ModalRoot","ModalsController","ModalsContext","PageToolbar","SetInterval","Table","TableInputCSV","TabsBar","Tab","VerticalTab","TabContent","Counter","RenderUserContentAsHTML","BigValue","BigValueColorMode","BigValueGraphMode","BigValueJustifyMode","BigValueTextMode","Sparkline","Gauge","BarGauge","VizTooltip","VizTooltipContainer","SeriesTable","SeriesTableRow","VizRepeater","PanelChrome","PanelChromeLoadingIndicator","PanelContextProvider","PanelContextRoot","usePanelContext","VizLayout","SeriesVisibilityChangeBehavior","VizLegend","VizLegendListItem","Alert","GraphSeriesToggler","Collapse","ControlledCollapse","CollapsableSection","DataLinkButton","FieldLinkList","FullWidthButtonContainer","ClickOutsideWrapper","CallToActionCard","ContextMenu","Menu","MenuGroup","MenuItem","WithContextMenu","DataLinksInlineEditor","DataLinkInput","DataLinksContextMenu","SeriesIcon","InfoBox","FeatureInfoBox","FeatureBadge","JSONFormatter","JsonExplorer","ErrorBoundary","ErrorBoundaryAlert","withErrorBoundary","ErrorWithStack","DataSourceHttpSettings","CustomHeadersSettings","AlertingSettings","SecureSocksProxySettings","TLSAuthSettings","CertificationKey","Spinner","FadeTransition","SlideOutTransition","Segment","SegmentAsync","SegmentInput","SegmentSelect","SegmentSection","Drawer","Slider","RangeSlider","Form","sharedInputStyle","InputControl","Button","LinkButton","ButtonGroup","clearButtonStyles","ToolbarButton","ToolbarButtonRow","ValuePicker","fieldMatchersUI","Link","TextLink","Text","Box","Stack","Grid","Space","Label","Field","Legend","FieldSet","FieldValidationMessage","InlineField","InlineSegmentGroup","InlineLabel","InlineFieldRow","FieldArray","resetSelectStyles","SelectMenuOptions","getSelectStyles","HorizontalGroup","VerticalGroup","Container","Badge","RadioButtonGroup","RadioButtonDot","RadioButtonList","Input","getInputStyles","AutoSizeInput","FilterInput","Switch","InlineSwitch","Checkbox","TextArea","FileUpload","TimeRangeInput","RelativeTimeRangePicker","Card","getCardStyles","CardContainer","FormattedValueDisplay","ButtonSelect","Dropdown","PluginSignatureBadge","UserIcon","Avatar","InlineFormLabel","Divider","getDragStyles","useSplitter","LegacyForms","LegacyInputStatus","ScaleDistribution","BarGaugeDisplayMode","UPlotConfigBuilder","UPLOT_AXIS_FONT_SIZE","UPlotChart","PlotLegend","FIXED_UNIT","BrowserLabel","PanelContainer","Graph","GraphWithLegend","GraphContextMenu","GraphContextMenuHeader","graphTimeFormat","graphTickFormatter","GraphNG","TimeSeries","useGraphNGContext","preparePlotFrame","buildScaleKey","ZoomPlugin","TooltipPlugin","convertOldAngularValueMapping","sharedSingleStatMigrationHandler","sharedSingleStatPanelChangedHandler","AsyncMultiSelect","AsyncSelect","AsyncVirtualizedSelect","MultiSelect","Select","SelectContainer","VirtualizedSelect"].indexOf(wo)<0&&(Gs[wo]=()=>kn[wo]);e.d(R,Gs);var $s=e(66864),Is=e(39938),pa=e(94354),Ta=e(79569),ua=e(83186),sr=e(10354),ma=e(51440),ar=e(67647),Ya=e(49718),xr=e(7968),Sr=e(15292),Yr=e(10880),Hr=e(21744),Rr=e(73546),lo=e(92887),Bo=e(54230),po=e(5308),vr=e(10860),Ur=e(81507),Er=e(9286),Qo=e(9261),Eo=e(83122),Lt=e(98624),Ht=e(99635),on=e(12942),vn=e(38894),Un=e(25994),cs=e(69144),os=e(21633),Js=e(52198),Ss=e(52622),Ra=e(51336),Oa=e(30501),ss=e(81297),Ia=e(24182),Cr=e(96747),Dr=e(66737),dr=e(52811),ur=e(88895),Oo=e(54438),Io=e(52494),za=e(48747),Do=e(5484),Ca=e(33083),Aa=e(65036),hr=e(99755),Ma=e(18262),ho=e(16998),Uo=e(65575),No=e(76284),Mi=e(90606);const ri={SecretFormField:a.L,FormField:t.z,Select:r.l6,AsyncSelect:r.DW,IndicatorsContainer:i.s,NoOptionsMessage:s.l,Input:n.p,Switch:g.d}},31511:(k,R,e)=>{"use strict";e.d(R,{A:()=>g});var t=e(74848),n=e(32196),i=e(96540),s=e(86634),r=e(40845);function g(c){const{visible:o,children:h,duration:f=250}=c,d=(0,r.of)(a,f),p=(0,i.useRef)(null);return(0,t.jsx)(s.A,{in:o,mountOnEnter:!0,unmountOnExit:!0,timeout:f,classNames:d,nodeRef:p,children:i.cloneElement(h,{ref:p})})}const a=(c,o)=>({enter:(0,n.css)({label:"enter",opacity:0}),enterActive:(0,n.css)({label:"enterActive",opacity:1,[c.transitions.handleMotion("no-preference","reduce")]:{transition:`opacity ${o}ms ease-out`}}),exit:(0,n.css)({label:"exit",opacity:1}),exitActive:(0,n.css)({label:"exitActive",opacity:0,[c.transitions.handleMotion("no-preference","reduce")]:{transition:`opacity ${o}ms ease-out`}})})},72960:(k,R,e)=>{"use strict";e.d(R,{n:()=>g});var t=e(74848),n=e(32196),i=e(96540),s=e(86634),r=e(40845);function g(c){const{visible:o,children:h,duration:f=250,horizontal:d,size:p}=c,m=(0,r.of)(a,f,d?"width":"height",p),v=(0,i.useRef)(null);return(0,t.jsx)(s.A,{in:o,mountOnEnter:!0,unmountOnExit:!0,timeout:f,classNames:m,nodeRef:v,children:i.cloneElement(h,{ref:v})})}const a=(c,o,h,f)=>({enter:(0,n.css)({label:"enter",[`${h}`]:0,opacity:0}),enterActive:(0,n.css)({label:"enterActive",[`${h}`]:`${f}px`,opacity:1,[c.transitions.handleMotion("no-preference")]:{transition:`opacity ${o}ms ease-out, ${h} ${o}ms ease-out`},[c.transitions.handleMotion("reduce")]:{transition:`opacity ${o}ms ease-out`}}),exit:(0,n.css)({label:"exit",[`${h}`]:`${f}px`,opacity:1}),exitActive:(0,n.css)({label:"exitActive",opacity:0,[`${h}`]:0,[c.transitions.handleMotion("no-preference")]:{transition:`opacity ${o}ms ease-out, ${h} ${o}ms ease-out`},[c.transitions.handleMotion("reduce")]:{transition:`opacity ${o}ms ease-out`}})})},81297:(k,R,e)=>{"use strict";e.d(R,{Z:()=>o});var t=e(74848),n=e(96540),i=e(36613),s=e(16895),r=e(7650);function g(h,f){return f.width===h.width&&f.height===h.height}function a(h,f){return f.data===h.data}function c(h,f){return f.config===h.config}class o extends n.Component{constructor(f){super(f),this.plotContainer=(0,n.createRef)(),this.plotCanvasBBox=(0,n.createRef)(),this.state={plot:null}}reinitPlot(){let{width:f,height:d,plotRef:p}=this.props;if(this.state.plot?.destroy(),f===0&&d===0)return;this.props.config.addHook("setSize",l=>{l.over});const m={width:Math.floor(this.props.width),height:Math.floor(this.props.height),...this.props.config.getConfig()};(0,s.uY)("UPlot",!1,"Reinitializing plot",m);const v=new i.A(m,this.props.data,this.plotContainer.current);p&&p(v),this.setState({plot:v})}componentDidMount(){this.reinitPlot()}componentWillUnmount(){this.state.plot?.destroy()}componentDidUpdate(f){let{plot:d}=this.state;g(f,this.props)?c(f,this.props)?a(f,this.props)||d?.setData(this.props.data):this.reinitPlot():d?.setSize({width:Math.floor(this.props.width),height:Math.floor(this.props.height)})}render(){return(0,t.jsxs)("div",{style:{position:"relative"},children:[(0,t.jsx)("div",{ref:this.plotContainer,"data-testid":"uplot-main-div"}),this.props.children]})}}},24182:(k,R,e)=>{"use strict";e.d(R,{$:()=>f,t:()=>h});var t=e(74848),n=e(96540),i=e(28240),s=e(8066),r=e(52622),g=e(40845),a=e(67266),c=e(96516),o=e(16895);function h(d,p){return d.getSeries().some(m=>{const v=m.props.dataFrameFieldIndex;if(!v)return!1;const l=p[v.frameIndex]?.fields[v.fieldIndex];return!(!l||l.config.custom?.hideFrom?.legend)})}const f=(0,n.memo)(({data:d,config:p,placement:m,calcs:v,displayMode:l,...y})=>{const u=(0,g.$j)(),D=p.getSeries().map(E=>{const x=E.props,P=x.dataFrameFieldIndex,b=p.getAxisPlacement(E.props.scaleKey);if(!P)return;const M=d[P.frameIndex]?.fields[P.fieldIndex];if(!M||M.config.custom?.hideFrom?.legend)return;const O=(0,i.Ct)(M,d[P.frameIndex],d),T=(0,s.lz)(M,u).color;return{disabled:!(x.show??!0),fieldIndex:P,color:T,label:O,yAxis:b===r.vM.Left||b===r.vM.Bottom?1:2,getDisplayValues:()=>(0,o.UO)(v,M,u),getItemKey:()=>`${O}-${P.frameIndex}-${P.fieldIndex}`,lineStyle:x.lineStyle}}).filter(E=>E!==void 0);return(0,t.jsx)(a.KU.Legend,{placement:m,...y,children:(0,t.jsx)(c.t,{placement:m,items:D,displayMode:l,sortBy:y.sortBy,sortDesc:y.sortDesc,isSortable:!0})})});f.displayName="PlotLegend"},52198:(k,R,e)=>{"use strict";e.d(R,{t:()=>n});var t=e(52622);const n={drawStyle:[{label:"Lines",value:t.GR.Line},{label:"Bars",value:t.GR.Bars},{label:"Points",value:t.GR.Points}],lineInterpolation:[{description:"Linear",value:t.dx.Linear,icon:"gf-interpolation-linear"},{description:"Smooth",value:t.dx.Smooth,icon:"gf-interpolation-smooth"},{description:"Step before",value:t.dx.StepBefore,icon:"gf-interpolation-step-before"},{description:"Step after",value:t.dx.StepAfter,icon:"gf-interpolation-step-after"}],barAlignment:[{description:"Before",value:t.Nj.Before,icon:"gf-bar-alignment-before"},{description:"Center",value:t.Nj.Center,icon:"gf-bar-alignment-center"},{description:"After",value:t.Nj.After,icon:"gf-bar-alignment-after"}],showPoints:[{label:"Auto",value:t.yL.Auto,description:"Show points when the density is low"},{label:"Always",value:t.yL.Always},{label:"Never",value:t.yL.Never}],axisPlacement:[{label:"Auto",value:t.vM.Auto,description:"First field on the left, everything else on the right"},{label:"Left",value:t.vM.Left},{label:"Right",value:t.vM.Right},{label:"Hidden",value:t.vM.Hidden}],fillGradient:[{label:"None",value:t.on.None},{label:"Opacity",value:t.on.Opacity,description:"Enable fill opacity gradient"},{label:"Hue",value:t.on.Hue,description:"Small color hue gradient"},{label:"Scheme",value:t.on.Scheme,description:"Use color scheme to define gradient"}],stacking:[{label:"Off",value:t.gs.None},{label:"Normal",value:t.gs.Normal},{label:"100%",value:t.gs.Percent}],thresholdsDisplayModes:[{label:"Off",value:t.Ly.Off},{label:"As lines",value:t.Ly.Line},{label:"As lines (dashed)",value:t.Ly.Dashed},{label:"As filled regions",value:t.Ly.Area},{label:"As filled regions and lines",value:t.Ly.LineAndArea},{label:"As filled regions and lines (dashed)",value:t.Ly.DashedAndArea}]}},30501:(k,R,e)=>{"use strict";e.d(R,{Zj:()=>l,pi:()=>o,zH:()=>v});var t=e(83195),n=e(97706),i=e(42994),s=e(72724),r=e(52622),g=e(29413),a=e(52811),c=e(93060);const o=12,h=150,f=30,d=15,p=40,m=8;class v extends a.R{merge(E){this.props.size=(0,c.Y)("max",this.props.size,E.size),this.props.label||(this.props.label=E.label),this.props.placement===r.vM.Auto&&(this.props.placement=E.placement)}calculateSpace(E,x,P,b,M){const O=E.axes[x],I=E.scales[O.scale];if(O.side!==2||!I)return M<=h?d:f;if(I.time){const T=M/p,C=(b-P)/T,S=y(E,[P],x,p,C);return(0,g.kD)(S[0],o).width+18}return p}calculateAxisSize(E,x,P){const b=E.axes[P];let M=b.ticks.size;if(b.side===2)M+=b.gap+o;else if(x?.length){let O=x.reduce((T,C)=>Math.max(T,(0,g.kD)(C,o).width),0);const I=Math.min(E.width*.4,O);M+=b.gap+b.labelGap+I}return Math.ceil(M)}getConfig(){let{scaleKey:E,label:x,show:P=!0,placement:b=r.vM.Auto,grid:M={show:!0},ticks:O,space:I,filter:T,gap:C=5,formatValue:S,splits:A,values:L,incrs:N,isTime:F,timeZone:w,theme:B,tickLabelRotation:U,size:K,color:V,border:H,decimals:Y,distr:X=r.L4.Linear}=this.props;const J=`${o}px ${B.typography.fontFamily}`,q=B.isDark?"rgba(240, 250, 255, 0.09)":"rgba(0, 10, 23, 0.09)";(0,t.j9)(E)&&(A=[0,1]),Y===0&&X===r.L4.Linear&&(T=(j,te)=>te.map(ne=>Number.isInteger(ne)?ne:null));let ae={scale:E,show:P,stroke:V??B.colors.text.primary,side:u(b),font:J,size:K??((j,te,ne)=>this.calculateAxisSize(j,te,ne)),rotate:U,gap:C,labelGap:0,grid:{show:M.show,stroke:q,width:1/devicePixelRatio},ticks:Object.assign({show:!0,stroke:H?.show?V??B.colors.text.primary:q,width:1/devicePixelRatio,size:4},O),splits:A,values:L,space:I??((j,te,ne,le,z)=>this.calculateSpace(j,te,ne,le,z)),filter:T,incrs:N};return H?.show&&(ae.border={stroke:V??B.colors.text.primary,width:1/devicePixelRatio,...H}),x!=null&&x.length>0&&(ae.label=x,ae.labelSize=o+m,ae.labelFont=J,ae.labelGap=m),L?ae.values=L:F?ae.values=y:S&&(ae.values=(j,te,ne,le,z)=>{let ee=(0,n.E)((0,n.h)(z,6));return te.map(se=>S(se,ee>0?ee:void 0))}),ae.timeZone=w,ae}}const l={second:1e3,minute:60*1e3,hour:60*60*1e3,day:24*60*60*1e3,month:28*24*60*60*1e3,year:365*24*60*60*1e3};function y(D,E,x,P,b){const M=D.axes[x],O="timeZone"in M&&typeof M.timeZone=="string"?M.timeZone:void 0,I=D.scales.x,T=(I?.max??0)-(I?.min??0),C=Math.round(l.year/l.day)*l.day,S=Math.round(b/l.day)*l.day;let A=i.WC.interval.year;return b<l.second?A=i.WC.interval.millisecond:b<=l.minute?A=i.WC.interval.second:T<=l.day?A=i.WC.interval.minute:b<=l.day?A=i.WC.interval.hour:T<l.year?A=i.WC.interval.day:S===C?A=i.WC.interval.year:b<=l.year&&(A=i.WC.interval.month),E.map(L=>L==null?"":(0,s.LE)(L,{format:A,timeZone:O}))}function u(D){switch(D){case r.vM.Top:return 0;case r.vM.Right:return 1;case r.vM.Bottom:return 2;case r.vM.Left:}return 3}},51336:(k,R,e)=>{"use strict";e.d(R,{e:()=>E});var t=e(2543),n=e(36613),i=e(43127),s=e(91410),r=e(52622),g=e(16895),a=e(30501),c=e(93060),o=e(24293),h=e(23596),f=e(52811),d=e(74863);class p extends f.R{getConfig(){const{facets:P,drawStyle:b,pathBuilder:M,pointsBuilder:O,pointsFilter:I,lineInterpolation:T,lineWidth:C,lineStyle:S,barAlignment:A,barWidthFactor:L,barMaxWidth:N,showPoints:F,pointSize:w,scaleKey:B,pxAlign:U,spanNulls:K,show:V=!0}=this.props;let H={},Y=this.getLineColor();H.stroke=Y,H.width=C,S&&S.fill!=="solid"&&(S.fill==="dot"&&(H.cap="round"),H.dash=S.dash??[10,10]),M!=null?H.paths=M:b===r.GR.Points?H.paths=()=>null:b!=null&&(H.paths=(q,ae,j,te)=>v(b,T,A,L,N)(q,ae,j,te));const X=typeof Y=="string"?Y:(q,ae)=>q.series[ae]._stroke,J={points:{stroke:X,fill:X,size:!w||w<C?void 0:w,filter:I}};return O!=null?J.points.show=O:b===r.GR.Points?J.points.show=!0:F===r.yL.Auto?b===r.GR.Bars&&(J.points.show=!1):F===r.yL.Never?J.points.show=!1:F===r.yL.Always&&(J.points.show=!0),{scale:B,facets:P,spanGaps:typeof K=="number"?!1:K,value:()=>"",pxAlign:U,show:V,fill:this.getFill(),...H,...J}}getLineColor(){const{lineColor:P,gradientMode:b,colorMode:M,thresholds:O,theme:I,hardMin:T,hardMax:C,softMin:S,softMax:A,dynamicSeriesColor:L}=this.props;return b===r.on.None&&L?(N,F)=>L(F)??P??o.F:b===r.on.Scheme&&M?.id!==o.Y.Fixed?(0,d.pl)(1,I,M,O,T,C,S,A):b===r.on.Hue?(0,d.B5)(P??o.F,1,I):P??o.F}getFill(){const{lineColor:P,fillColor:b,gradientMode:M,fillOpacity:O,colorMode:I,thresholds:T,theme:C,hardMin:S,hardMax:A,softMin:L,softMax:N,dynamicSeriesColor:F}=this.props;if(b)return b;const w=M??r.on.None,B=(O??0)/100;if(w===r.on.None&&F&&B>0)return(U,K)=>{let V=U.series[K]._stroke;return h.MV.alpha(V??"",B)};switch(w){case r.on.Opacity:return(0,d.WO)(b??P,B);case r.on.Hue:return(0,d.B5)(b??P,B,C);case r.on.Scheme:if(I?.id!==o.Y.Fixed)return(0,d.pl)(B,C,I,T,S,A,L,N);default:if(B>0)return h.MV.alpha(P??"",B)}}}let m;function v(x,P,b=r.Nj.Center,M=.6,O=200){const I=n.A.paths;if(m||(m={linear:I.linear(),smooth:I.spline(),stepBefore:I.stepped({align:-1}),stepAfter:I.stepped({align:1})}),x===r.GR.Bars){let T=`bars|${b}|${M}|${O}`;return m[T]||(m[T]=I.bars({size:[M,O],align:b})),m[T]}else if(x===r.GR.Line){if(P===r.dx.StepBefore)return m.stepBefore;if(P===r.dx.StepAfter)return m.stepAfter;if(P===r.dx.Smooth)return m.smooth}return m.linear}var l=e(84140),y=e(50082);function u(x){const P=x.config.mode===r.Ly.Dashed||x.config.mode===r.Ly.DashedAndArea?[10,10]:[];function b(F,w,B,U){let K=F.ctx,V=0;for(let H=0;H<B.length;H++)if(B[H].color==="transparent"){V=H;break}K.lineWidth=2,K.setLineDash(P);for(let H=1;H<B.length;H++){const Y=B[H];let X;V>=H&&H>0?X=(0,l.A)(U.visualization.getColorByName(B[H-1].color)):X=(0,l.A)(U.visualization.getColorByName(Y.color)),X.getAlpha()===1&&X.setAlpha(.7);let J=Math.round(F.bbox.left),q=Math.round(F.valToPos(Y.value,w,!0)),ae=Math.round(F.bbox.left+F.bbox.width),j=Math.round(F.valToPos(Y.value,w,!0));K.beginPath(),K.moveTo(J,q),K.lineTo(ae,j),K.strokeStyle=X.toString(),K.stroke()}}function M(F,w,B,U){let K=F.ctx,V=(0,d.Z8)(F,w,B.map(H=>{let Y=(0,l.A)(U.visualization.getColorByName(H.color));return Y.getAlpha()===1&&Y.setAlpha(.15),[H.value,Y.toString()]}),!0);K.fillStyle=V,K.fillRect(F.bbox.left,F.bbox.top,F.bbox.width,F.bbox.height)}const{scaleKey:O,thresholds:I,theme:T,config:C,hardMin:S,hardMax:A,softMin:L,softMax:N}=x;return F=>{const w=F.ctx,{min:B,max:U}=F.scales.x,{min:K,max:V}=F.scales[O];if(B==null||U==null||K==null||V==null)return;let{steps:H,mode:Y}=I;if(Y===y.O.Percentage){let[X,J]=(0,d.EJ)(F,O,S,A,L,N),q=J-X;H=H.map(ae=>({...ae,value:X+q*(ae.value/100)}))}switch(w.save(),C.mode){case r.Ly.Line:case r.Ly.Dashed:b(F,O,H,T);break;case r.Ly.Area:M(F,O,H,T);break;case r.Ly.LineAndArea:case r.Ly.DashedAndArea:M(F,O,H,T),b(F,O,H,T)}w.restore()}}const D={drag:{setScale:!1},points:{size:(x,P)=>x.series[P].points.size*2,width:(x,P,b)=>b/4},focus:{prox:30}};class E{constructor(P=i.lE){this.uid=Math.random().toString(36).slice(2),this.series=[],this.axes={},this.scales=[],this.bands=[],this.stackingGroups=[],this.hasLeftAxis=!1,this.hooks={},this.tz=void 0,this.mode=1,this.frames=void 0,this.thresholds={},this.padding=void 0,this.prepData=void 0,this.scaleKeys=["",""],this.tzDate=b=>{let M=new Date(b);return this.tz?n.A.tzDate(M,this.tz):M},this.tz=(0,s.QZ)(P,Date.now())?.ianaName}addHook(P,b){(0,g.uY)("UPlotConfigBuilder",!1,"addHook",P),this.hooks[P]||(this.hooks[P]=[]),this.hooks[P].push(b)}addThresholds(P){this.thresholds[P.scaleKey]||(this.thresholds[P.scaleKey]=P,this.addHook("drawClear",u(P)))}addAxis(P){P.placement=P.placement??r.vM.Auto,P.grid=P.grid??{};let b=P.scaleKey;if(b==="x"&&(b+=P.timeZone??""),this.axes[b]){this.axes[b].merge(P);return}P.placement===r.vM.Auto&&(P.placement=this.hasLeftAxis?r.vM.Right:r.vM.Left),P.placement===r.vM.Left&&(this.hasLeftAxis=!0),P.placement===r.vM.Hidden&&(P.grid.show=!1,P.size=0),this.axes[b]=new a.zH(P)}getAxisPlacement(P){return this.axes[P]?.props.placement??r.vM.Left}setCursor(P){this.cursor=(0,t.merge)({},this.cursor,P)}setMode(P){this.mode=P}setSelect(P){this.select=P}addSeries(P){this.series.push(new p(P))}getSeries(){return this.series}addScale(P){const b=this.scales.find(M=>M.props.scaleKey===P.scaleKey);if(b){b.merge(P);return}this.scales.push(new c.G(P))}addBand(P){this.bands.push(P)}setStackingGroups(P){this.stackingGroups=P}getStackingGroups(){return this.stackingGroups}setPrepData(P){this.prepData=b=>(this.frames=b,P(b,this.getStackingGroups()))}setPadding(P){this.padding=P}getConfig(){if(this.cachedConfig)return this.cachedConfig;const P={...g.NN,mode:this.mode,series:[this.mode===2?null:{value:()=>""}]};P.axes=this.ensureNonOverlappingAxes(Object.values(this.axes)).map(M=>M.getConfig()),P.series=[...P.series,...this.series.map(M=>M.getConfig())],P.scales=this.scales.reduce((M,O)=>({...M,...O.getConfig()}),{}),P.hooks=this.hooks,P.select=this.select;const b=(M="")=>(O,I)=>{let T=O.series[I].points._stroke;if(typeof T!="string"){let C=this.frames[0].fields[I];T=C.display(C.values[O.cursor.idxs[I]]).color}return T+M};return P.cursor=(0,t.merge)({},D,{points:{stroke:b("80"),fill:b()}},this.cursor),P.tzDate=this.tzDate,Array.isArray(this.padding)&&(P.padding=this.padding),this.stackingGroups.forEach(M=>{(0,g.Tz)(M).forEach(O=>{this.addBand(O)})}),this.bands.length&&(P.bands=this.bands),this.cachedConfig=P,P}ensureNonOverlappingAxes(P){const b=P.find(I=>I.props.scaleKey==="x"),M=P.filter(I=>I.props.grid?.show===void 0),O=M.findIndex(I=>I.props.placement===r.vM.Left||I.props.placement===r.vM.Right||I.props.placement===r.vM.Bottom&&I!==b);for(let I=0;I<M.length;I++)M[I]===b||I===O?M[I].props.grid.show=!0:M[I].props.grid.show=!1;return P}}},93060:(k,R,e)=>{"use strict";e.d(R,{G:()=>g,Y:()=>a});var t=e(36613),n=e(77678),i=e(83195),s=e(52622),r=e(52811);class g extends r.R{merge(o){this.props.min=a("min",this.props.min,o.min),this.props.max=a("max",this.props.max,o.max)}getConfig(){let{isTime:o,scaleKey:h,min:f,max:d,softMin:p,softMax:m,range:v,direction:l,orientation:y,centeredZero:u,decimals:D}=this.props;const E=this.props.distribution,x=o?{}:{distr:E===s.L4.Symlog?4:E===s.L4.Log?3:E===s.L4.Ordinal?2:1,log:E===s.L4.Log||E===s.L4.Symlog?this.props.log??2:void 0,asinh:E===s.L4.Symlog?this.props.linearThreshold??1:void 0};if(E===s.L4.Log){let A=this.props.log,L=A===2?Math.log2:Math.log10;f!=null&&(f<=0?f=null:f=A**Math.floor(L(f))),d!=null&&(d<=0?d=null:d=A**Math.ceil(L(d))),p!=null&&(p<=0?p=null:p=A**Math.floor(L(p))),m!=null&&(m<=0?m=null:m=A**Math.ceil(L(m)))}let P=p==null?3:1,b=m==null?3:1;const M={min:{pad:.1,hard:f??-1/0,soft:p||0,mode:P},max:{pad:.1,hard:d??1/0,soft:m||0,mode:b}};let O=p==null&&f!=null,I=m==null&&d!=null,T=O&&I;const C=(A,L,N,F)=>{const w=A.scales[F];let B=[L,N];if(!T&&L==null&&N==null)return B;let U=w.log??10;if(w.distr===1||w.distr===2||w.distr===4){if(u){let K=Math.abs(L),V=Math.abs(N),H=Math.max(K,V);H===0&&(H=80),L=-H,N=H}w.distr===4?B=t.A.rangeAsinh(L,N,U,!0):B=t.A.rangeNum(O?f:L,I?d:N,M)}else w.distr===3&&(B=t.A.rangeLog(f??L,d??N,U,!0));if(D===0)if(w.distr===1||w.distr===2)B[0]=(0,n.rs)(B[0],1),B[1]=(0,n.Uh)(B[1],1);else if(w.distr===3){let K=w.log===2?Math.log2:Math.log10;if(B[0]<=1)B[0]=1;else{let H=Math.floor(K(B[0]));B[0]=U**H}let V=Math.ceil(K(B[1]));B[1]=U**V,B[0]===B[1]&&(B[1]*=U)}else w.distr===4&&(B[0]=(0,n.rs)(B[0],1),B[1]=(0,n.Uh)(B[1],1));return(w.distr===1||w.distr===4)&&(O&&(B[0]=f),I&&(B[1]=d)),B[0]>=B[1]&&(B[0]=w.distr===3?1:0,B[1]=100),B};let S=!o&&!T;return(0,i.j9)(h)&&(S=!1,v=[0,1]),{[h]:{time:o,auto:S,range:v??C,dir:l,ori:y,...x}}}}function a(c,o,h){const f=o!=null,d=h!=null;return f?d?c==="min"?o<h?o:h:o>h?o:h:o:h}},74863:(k,R,e)=>{"use strict";e.d(R,{B5:()=>o,EJ:()=>p,WO:()=>c,Z8:()=>f,pl:()=>v});var t=e(84140),n=e(23596),i=e(24293),s=e(50082),r=e(52622),g=e(29413);function a(l,y,u){let D=0,E=0,x=0,P=0;return l===3?(E=y.top,P=y.top+y.height):l===2?(D=y.left+y.width,x=y.left):l===1?(E=y.top+y.height,P=y.top):l===0&&(D=y.left,x=y.left+y.width),u.createLinearGradient(D,E,x,P)}function c(l,y){return(u,D)=>{const E=(0,g.Yc)(),x=a(u.scales.x.ori===r.Lt.Horizontal?3:2,u.bbox,E);return x.addColorStop(0,n.MV.alpha(l,y)),x.addColorStop(1,n.MV.alpha(l,0)),x}}function o(l,y,u){return(D,E)=>{const x=(0,g.Yc)(),P=a(D.scales.x.ori===r.Lt.Horizontal?3:2,D.bbox,x),b=(0,t.A)(l).spin(-25).darken(5),M=(0,t.A)(l).saturate(20).spin(20).brighten(10);return u.isDark?(P.addColorStop(0,M.lighten(10).setAlpha(y).toString()),P.addColorStop(1,b.darken(10).setAlpha(y).toString())):(P.addColorStop(0,M.lighten(10).setAlpha(y).toString()),P.addColorStop(1,b.setAlpha(y).toString())),P}}var h=(l=>(l[l.Right=0]="Right",l[l.Up=1]="Up",l[l.Left=2]="Left",l[l.Down=3]="Down",l))(h||{});function f(l,y,u,D=!1){let E=l.scales[y],x=null,P=null;for(let B=0;B<u.length;B++){let U=u[B][0];if((U<=E.min||x==null)&&(x=B),P=B,U>=E.max)break}if(x===P)return u[x][1];let b=u[x][0],M=u[P][0];b===-1/0&&(b=E.min),M===1/0&&(M=E.max);let O=Math.round(l.valToPos(b,y,!0)),I=Math.round(l.valToPos(M,y,!0)),T=O-I;if(T===0)return u[P][1];let C,S,A,L;l.scales.x.ori===r.Lt.Horizontal?(C=A=0,S=O,L=I):(S=L=0,C=O,A=I);let F=(0,g.Yc)().createLinearGradient(C,S,A,L),w;for(let B=x;B<=P;B++){let U=u[B],K=B===x?O:B===P?I:Math.round(l.valToPos(U[0],y,!0)),V=(O-K)/T;D&&B>x&&F.addColorStop(V,w),F.addColorStop(V,w=U[1])}return F}function d(l,y){let u=l.scales[y],D=1/0,E=-1/0;return l.series.forEach((x,P)=>{if(x.show&&x.scale===y)if(x.min==null){let b=l.data[P];for(let M=0;M<b.length;M++)b[M]!=null&&(D=Math.min(D,b[M]),E=Math.max(E,b[M]))}else D=Math.min(D,x.min),E=Math.max(E,x.max)}),E===D&&(D=u.min,E=u.max),[D,E]}function p(l,y,u,D,E,x){let P=u??E??null,b=D??x??null;if(P==null||b==null){let[M,O]=d(l,y);P=P??M??0,b=b??O??100}return[P,b]}function m(l){return l==="transparent"||l[0]==="#"&&l.slice(-2)==="00"}function v(l,y,u,D,E,x,P,b){if(!u)throw Error("Missing colorMode required for color scheme gradients");if(!D)throw Error("Missing thresholds required for color scheme gradients");return(M,O)=>{let I=M.series[O].scale,T="";if(u.id===i.Y.Thresholds)if(D.mode===s.O.Absolute){const C=D.steps.map(S=>[S.value,m(S.color)?"#0000":n.MV.alpha(y.visualization.getColorByName(S.color),l)]);T=f(M,I,C,!0)}else{const[C,S]=p(M,I,E,x,P,b),A=S-C,L=D.steps.map(N=>[C+A*(N.value/100),n.MV.alpha(y.visualization.getColorByName(N.color),l)]);T=f(M,I,L,!0)}else if(u.getColors){const C=u.getColors(y),[S,A]=p(M,I,E,x,P,b),L=A-S,N=C.map((F,w)=>[S+L*(w/(C.length-1)),n.MV.alpha(y.visualization.getColorByName(F),l)]);T=f(M,I,N,!1)}return T}}},78226:(k,R,e)=>{"use strict";e.d(R,{a:()=>g});var t=e(74848),n=e(96540),i=e(1604),s=e(6967),r=e(97620);function g({id:a,events:c,renderEventMarker:o,mapEventToXYCoords:h,config:f}){const d=(0,n.useRef)(),[p,m]=(0,n.useState)(0),v=(0,i.A)();(0,n.useLayoutEffect)(()=>{f.addHook("init",y=>{d.current=y}),f.addHook("draw",()=>{v()&&m(y=>y+1)})},[f,m]);const l=(0,n.useMemo)(()=>{const y=[];if(!d.current||c.length===0)return y;for(let u=0;u<c.length;u++){const D=c[u];for(let E=0;E<D.length;E++){const x=h(D,{fieldIndex:E,frameIndex:u});x&&y.push((0,n.createElement)(s.p,{...x,key:`${a}-marker-${u}-${E}`},o(D,{fieldIndex:E,frameIndex:u})))}}return(0,t.jsx)(t.Fragment,{children:y})},[c,o,p]);return d.current?(0,t.jsx)(r._,{left:d.current.bbox.left/window.devicePixelRatio,top:d.current.bbox.top/window.devicePixelRatio,children:l}):null}},6967:(k,R,e)=>{"use strict";e.d(R,{p:()=>n});var t=e(74848);const n=({x:i,y:s,children:r})=>(0,t.jsx)("div",{style:{position:"absolute",top:`${s}px`,left:`${i}px`},children:r})},97620:(k,R,e)=>{"use strict";e.d(R,{_:()=>s});var t=e(74848),n=e(32196),i=e(96540);const s=({children:r,left:g,top:a})=>{const c=(0,i.useMemo)(()=>(0,n.css)({position:"absolute",overflow:"visible",left:`${g}px`,top:`${a}px`}),[g,a]);return(0,t.jsx)("div",{className:c,children:r})}},96747:(k,R,e)=>{"use strict";e.d(R,{_X:()=>i._,a:()=>t.a,pH:()=>n.p});var t=e(78226),n=e(6967),i=e(97620)},55129:(k,R,e)=>{"use strict";e.d(R,{M:()=>i});var t=e(52622),n=e(52811);function i(r,g){const a="na",c=`${r.min!==void 0?r.min:a}-${r.max!==void 0?r.max:a}`,o=`${r.custom?.axisSoftMin!==void 0?r.custom.axisSoftMin:a}-${r.custom?.axisSoftMax!==void 0?r.custom.axisSoftMax:a}`,h=`${r.custom?.axisPlacement!==void 0?r.custom?.axisPlacement:t.vM.Auto}`,f=r.unit??n.s,d=r.custom?.scaleDistribution?s(r.custom.scaleDistribution):t.L4.Linear,p=r.custom?.axisLabel?r.custom.axisLabel:a;return`${f}/${c}/${o}/${h}/${d}/${p}/${g}`}function s(r){return r.type===t.L4.Log?`${r.type}${r.log}`:r.type}},96287:(k,R,e)=>{"use strict";e.d(R,{J:()=>r});var t=e(74848),n=e(32196),i=e(29158),s=e(40845);const r=({onClick:a,"aria-label":c,style:o})=>{const h=(0,s.of)(g);return(0,t.jsx)(i.K,{"aria-label":c??"Close",className:h,name:"times",onClick:a,style:o})},g=a=>(0,n.css)({position:"absolute",margin:"0px",right:a.spacing(1),top:a.spacing(1.25)})},68268:(k,R,e)=>{"use strict";e.d(R,{K:()=>c});var t=e(2543),n=e.n(t),i=e(96540),s=e(64423),r=e(99165),g=e(69129),a=e(26272);const c=({config:o,eventBus:h,frame:f})=>{const d=(0,i.useRef)(f);return d.current=f,(0,i.useLayoutEffect)(()=>{let p=null;const m={point:{time:null},data:d.current};o.addHook("init",P=>{p=P});let v=null;o.addHook("setSeries",(P,b)=>{v=b}),o.addHook("setLegend",()=>{if(!(p.cursor.event==null)){let b=p.cursor.idxs.find(M=>M!=null);if(b==null)x();else{let M=b,O=v,I=p.data[0]??p.data[1][0];m.point.time=I[M],m.rowIndex=M??void 0,m.columnIndex=O??void 0,m.data=d.current;let T=p.cursor.top;m.point.panelRelY=T===0?.001:T>0?T/p.rect.height:1,E()}}});function l(P){const b=P.payload?.point?.time;if(b){const M=p.valToPos(b,"x");p.setCursor({left:M,top:p.rect.height/2})}}const y=new s.yU,u=new g.b_(m).setTags(["uplot"]),D=new g.ql().setTags(["uplot"]);let E=(0,t.throttle)(()=>{h.publish(u)},100),x=(0,t.throttle)(()=>{h.publish(D)},100);return y.add(h.getStream(g.b_).subscribe({next:P=>{h===P.origin||P.tags?.has("uplot")||l(P)}})),y.add(h.getStream(a.kb).subscribe({next:P=>l(P)})),y.add(h.getStream(g.ql).pipe((0,r.c)(50)).subscribe({next:P=>{h===P.origin||P.tags?.has("uplot")||p.cursor._lock||p.setCursor({left:-10,top:-10})}})),()=>{y.unsubscribe()}},[o]),null}},23117:(k,R,e)=>{"use strict";e.d(R,{Z:()=>c});var t=e(2543),n=e.n(t),i=e(96540);const s=.1,r=2,g=new Set(["ArrowRight","ArrowLeft","ArrowUp","ArrowDown","Shift"," "]),a=o=>{let h=o.root,f=new Set,d=null,p=null;if(!h)return;h.tabIndex=0;const m=(x,P)=>{const{cursor:b}=o;if(b.left===void 0||b.top===void 0)return;const{width:M,height:O}=o.over.style,[I,T]=[Math.floor(parseFloat(M)),Math.floor(parseFloat(O))];o.setCursor({left:(0,t.clamp)(b.left+x,0,I),top:(0,t.clamp)(b.top+P,0,T)})},v=x=>{if(f.size===0||!o){p=null;return}const M=(x-(p??x))*s;let O=0,I=0;f.has("ArrowUp")&&(I-=M),f.has("ArrowDown")&&(I+=M),f.has("ArrowLeft")&&(O-=M),f.has("ArrowRight")&&(O+=M),f.has("Shift")&&(O*=r,I*=r),m(O,I);const{cursor:T}=o;if(f.has(" ")&&T){const C=Number(o.over.style.height.slice(0,-2));o.setSelect({left:T.left<d?T.left:d,top:0,width:Math.abs(T.left-(d??T.left)),height:C},!1)}p=x,window.requestAnimationFrame(v)},l=x=>{if(x.key==="Tab"){o.setCursor({left:-5,top:-5});return}if(!g.has(x.key))return;if(x.preventDefault(),x.stopPropagation(),!f.has(x.key)){const b=f.size===0;f.add(x.key),d=x.key===" "&&d===null?o.cursor.left:d,b&&window.requestAnimationFrame(v)}},y=x=>{g.has(x.key)&&(f.delete(x.key),x.key===" "&&(x.preventDefault(),x.stopPropagation(),o.setSelect(o.select),d=null))},u=()=>{if(!h?.matches(":focus-visible"))return;const x=parseFloat(o.over.style.width),P=parseFloat(o.over.style.height);o.setCursor({left:x/2,top:P/2})},D=()=>{p=null,d=null,f.clear(),o.setSelect({left:0,top:0,width:0,height:0},!1)};h.addEventListener("keydown",l),h.addEventListener("keyup",y),h.addEventListener("focus",u),h.addEventListener("blur",D);const E=()=>{h?.removeEventListener("keydown",l),h?.removeEventListener("keyup",y),h?.removeEventListener("focus",u),h?.removeEventListener("blur",D),h=null};(o.hooks.destroy??=[]).push(E)},c=({config:o})=>((0,i.useLayoutEffect)(()=>o.addHook("init",a),[o]),null)},38761:(k,R,e)=>{"use strict";e.d(R,{b3:()=>f,xl:()=>l});var t=e(74848),n=e(32196),i=e(96540),s=e(40961),r=e(73134),g=e(40845),a=e(17464),c=e(96287);const o=void 0,h=10;var f=(u=>(u[u.xOne=0]="xOne",u[u.xAll=1]="xAll",u[u.xyOne=2]="xyOne",u))(f||{});function d(u,D){return{...u,...D,style:{...u.style,...D.style}}}function p(){return{style:{transform:"",pointerEvents:"none"},isHovering:!1,isPinned:!1,contents:null,plot:null,dismiss:()=>{}}}const m=5,v=u=>u!=null&&!u.ctrlKey&&!u.metaKey,l=({config:u,hoverMode:D,render:E,clientZoom:x=!1,queryZoom:P,onSelectRange:b,maxWidth:M,syncMode:O=r.yV.Off,syncScope:I="global"})=>{const T=(0,i.useRef)(null),C=(0,i.useRef)(null);C.current==null&&(C.current=(0,a.gF)());const[{plot:S,isHovering:A,isPinned:L,contents:N,style:F,dismiss:w},B]=(0,i.useReducer)(d,null,p),U=(0,i.useRef)(),K=(0,g.of)(y,M),V=(0,i.useRef)(E);return V.current=E,(0,i.useLayoutEffect)(()=>{U.current={width:0,height:0,observer:new ResizeObserver(Pe=>{let Ue=U.current;for(const $e of Pe)$e.borderBoxSize?.length>0?(Ue.width=$e.borderBoxSize[0].inlineSize,Ue.height=$e.borderBoxSize[0].blockSize):(Ue.width=$e.contentRect.width,Ue.height=$e.contentRect.height)})};let H=!1,Y=!1,X=S,J=A,q=!1,ae=L,j=F,te=!1;const ne=O===r.yV.Tooltip;O!==r.yV.Off&&u.scales[0].props.isTime&&u.setCursor({sync:{key:I,scales:["x",null]}});const le=()=>{oe?J=te&&q&&ne:J=Z!=null||D===1&&q};let z=0,ee=0,se=null,ie=S?.cursor.idxs.slice(),Z=null,oe=!1,ce=!1,ye=!1;const re=(Pe=!1)=>{ce||(J?queueMicrotask(De):setTimeout(De,100),ce=!0),Pe&&(ye=!0)},ue=Pe=>{T.current.contains(Pe.target)||ge()},De=()=>{ce=!1,ye&&(j={pointerEvents:ae?"all":"none"},X.cursor._lock=ae,ae?(document.addEventListener("mousedown",ue,!0),document.addEventListener("keydown",ue,!0)):(document.removeEventListener("mousedown",ue,!0),document.removeEventListener("keydown",ue,!0)),ye=!1);let Pe={style:j,isPinned:ae,isHovering:J,contents:J||se!=null?V.current(X,ie,Z,ae,ge,se,oe):null,dismiss:ge};B(Pe),se=null},ge=()=>{let Pe=ae;ae=!1,J=!1,X.setCursor({left:-10,top:-10}),re(Pe)};u.addHook("init",Pe=>{B({plot:X=Pe}),x&&Pe.over.addEventListener("mousedown",Ue=>{if(v(Ue)&&Ue.button===0&&Ue.shiftKey){Y=!0,Pe.cursor.drag.x=!1,Pe.cursor.drag.y=!0;let $e=ze=>{Pe.cursor.drag.x=!0,Pe.cursor.drag.y=!1,document.removeEventListener("mouseup",$e,!0)};document.addEventListener("mouseup",$e,!0)}},!0),Pe.over.addEventListener("click",Ue=>{if(Ue.target===Pe.over)if(Ue.ctrlKey||Ue.metaKey){let $e;Pe.scales.x.ori===0?$e=Pe.posToVal(Pe.cursor.left,"x"):$e=Pe.posToVal(Pe.select.top+Pe.select.height,"x"),se={from:$e,to:$e},re(!1)}else J&&Z!=null&&!ae&&setTimeout(()=>{ae=!0,re(!0)},0)})}),u.addHook("setSelect",Pe=>{const Ue=Pe.scales.x.ori===0;if(!oe&&(x||P!=null))if(v(Pe.cursor.event)){if(b!=null){let $e=[];const ze=!!Pe.cursor.drag.y,qe=!!Pe.cursor.drag.x;let dt=null,vt=[];qe&&(dt={from:Ue?Pe.posToVal(Pe.select.left,"x"):Pe.posToVal(Pe.select.top+Pe.select.height,"x"),to:Ue?Pe.posToVal(Pe.select.left+Pe.select.width,"x"):Pe.posToVal(Pe.select.top,"x")}),ze&&u.scales.forEach(yt=>{const st=yt.props.scaleKey;if(st!=="x"){let Ve={from:Ue?Pe.posToVal(Pe.select.top+Pe.select.height,st):Pe.posToVal(Pe.select.left+Pe.select.width,st),to:Ue?Pe.posToVal(Pe.select.top,st):Pe.posToVal(Pe.select.left,st)};vt.push(Ve)}}),qe?ze?$e=vt.map(yt=>({x:dt,y:yt})):$e=[{x:dt}]:ze&&($e=vt.map(yt=>({y:yt}))),b($e)}else if(x&&Y){if(Pe.select.height>=m){for(let $e in Pe.scales)if($e!=="x"){const ze=Ue?Pe.posToVal(Pe.select.top,$e):Pe.posToVal(Pe.select.left+Pe.select.width,$e),qe=Ue?Pe.posToVal(Pe.select.top+Pe.select.height,$e):Pe.posToVal(Pe.select.left,$e);Pe.setScale($e,{min:qe,max:ze})}H=!0}Y=!1}else if(P!=null&&Pe.select.width>=m){const $e=Ue?Pe.posToVal(Pe.select.left,"x"):Pe.posToVal(Pe.select.top+Pe.select.height,"x"),ze=Ue?Pe.posToVal(Pe.select.left+Pe.select.width,"x"):Pe.posToVal(Pe.select.top,"x");P({from:$e,to:ze}),H=!1}}else se={from:Ue?Pe.posToVal(Pe.select.left,"x"):Pe.posToVal(Pe.select.top+Pe.select.height,"x"),to:Ue?Pe.posToVal(Pe.select.left+Pe.select.width,"x"):Pe.posToVal(Pe.select.top,"x")},re(!0);Pe.setSelect({left:0,width:0,top:0,height:0},!1)}),(x||P!=null)&&u.setCursor({bind:{dblclick:Pe=>()=>{if(!v(Pe.cursor.event))return null;if(x&&H){for(let Ue in Pe.scales)Ue!=="x"&&Pe.setScale(Ue,{min:null,max:null});H=!1}else if(P!=null){let Ue=Pe.scales.x;const $e=Ue.min,ze=Ue.max,qe=(ze-$e)/2;P({from:$e-qe,to:ze+qe})}return null}}}),u.addHook("setData",Pe=>{H=!1,Y=!1,ae&&ge()}),u.addHook("setSeries",(Pe,Ue)=>{Z=Ue,oe=Pe.cursor.event==null,le(),re()}),u.addHook("setLegend",Pe=>{ie=X?.cursor.idxs.slice(),q=ie.some(($e,ze)=>ze>0&&$e!=null),oe=Pe.cursor.event==null;let Ue=J;le(),(J||J!==Ue)&&re()});const Te=16;let Le=0,Ye=0;const je=()=>{J&&!ae&&ge(),Le=window.innerWidth-Te,Ye=window.innerHeight-Te},Ze=()=>{te=X.rect.bottom<=Ye&&X.rect.top>=0&&X.rect.left>=0&&X.rect.right<=Le};je(),u.addHook("ready",Ze),u.addHook("setCursor",Pe=>{if(oe=Pe.cursor.event==null,!J)return;let{left:Ue=-10,top:$e=-10}=Pe.cursor;if(Ue>=0||$e>=0){let ze=Pe.rect.left+Ue,qe=Pe.rect.top+$e,dt="",{width:vt,height:yt}=U.current;vt+=h,yt+=h,ee!==0?qe+yt<Ye||qe-yt<0?ee=0:ee!==-yt&&(ee=-yt):qe+yt>Ye&&qe-yt>=0&&(ee=-yt),z!==0?ze+vt<Le||ze-vt<0?z=0:z!==-vt&&(z=-vt):ze+vt>Le&&ze-vt>=0&&(z=-vt);const st=ze+(z===0?h:-h),Ve=qe+(ee===0?h:-h);dt=`translateX(${st}px) ${z===0?"":"translateX(-100%)"} translateY(${Ve}px) ${ee===0?"":"translateY(-100%)"}`,T.current!=null?T.current.style.transform=dt:(j.transform=dt,re())}});const Ne=Pe=>{Ze(),J&&Pe.target instanceof Node&&Pe.target.contains(X.root)&&ge()};return window.addEventListener("resize",je),window.addEventListener("scroll",Ne,!0),()=>{window.removeEventListener("resize",je),window.removeEventListener("scroll",Ne,!0),document.removeEventListener("mousedown",ue,!0),document.removeEventListener("keydown",ue,!0)}},[u]),(0,i.useLayoutEffect)(()=>{const H=U.current;if(T.current!=null){H.observer.observe(T.current);const{width:Y,height:X}=T.current.getBoundingClientRect();H.width=Y,H.height=X;let J=S.cursor.event;if(J!=null){const q=J.type!=="mousemove";q&&(J=new MouseEvent("mousemove",{view:window,bubbles:!0,cancelable:!0,clientX:J.clientX,clientY:J.clientY,screenX:J.screenX,screenY:J.screenY})),!(q?!1:performance.now()-J.timeStamp>16)&&S.over.dispatchEvent(J)}else S.setCursor({left:S.cursor.left,top:S.cursor.top},!0)}else H.width=0,H.height=0},[A]),S&&A?(0,s.createPortal)((0,t.jsxs)("div",{className:(0,n.cx)(K.tooltipWrapper,L&&K.pinned),style:F,"aria-live":"polite","aria-atomic":"true",ref:T,children:[L&&(0,t.jsx)(c.J,{onClick:w}),N]}),C.current):null},y=(u,D)=>({tooltipWrapper:(0,n.css)({top:0,left:0,zIndex:u.zIndex.portal,whiteSpace:"pre",borderRadius:u.shape.radius.default,position:"fixed",background:u.colors.background.primary,border:`1px solid ${u.colors.border.weak}`,boxShadow:u.shadows.z2,userSelect:"text",maxWidth:D??"none"}),pinned:(0,n.css)({boxShadow:u.shadows.z3})})},66737:(k,R,e)=>{"use strict";e.d(R,{Ku:()=>n.K,Z7:()=>i.Z,xl:()=>t.xl});var t=e(38761),n=e(68268),i=e(23117)},52811:(k,R,e)=>{"use strict";e.d(R,{R:()=>n,s:()=>t});const t="__fixed";class n{constructor(s){this.props=s}}},16895:(k,R,e)=>{"use strict";e.d(R,{NN:()=>h,Tz:()=>d,UO:()=>u,bq:()=>m,ro:()=>p,sw:()=>v,uY:()=>E});var t=e(11261),n=e(50311),i=e(75059),s=e(57875),r=e(52622),g=e(40621),a=e(91040),c=e(55129);const o=(x,P,b)=>{let M=P%2?b[0]||b[2]:b[1]||b[3];return b[P]||!M?0:8},h={ms:1,focus:{alpha:1},cursor:{focus:{prox:30}},legend:{show:!1},padding:[o,o,o,o],series:[],hooks:{}};var f=(x=>(x[x.Pos=1]="Pos",x[x.Neg=-1]="Neg",x))(f||{});function d(x){let P=[],{series:b,dir:M}=x,O=b.length-1,I=b.slice().reverse();return I.forEach((T,C)=>{if(C!==O){let S=I[C+1];P.push({series:[T,S],dir:-1*M})}}),P}function p(x){let P=new Map;return x.fields.forEach(({config:b,values:M,type:O},I)=>{if(I===0)return;let{custom:T}=b;if(T==null||T.hideFrom?.viz)return;let{stacking:C}=T;if(C==null)return;let{mode:S,group:A}=C;if(S===r.gs.None)return;let L=T.transform,N=l(L,M),F=T.drawStyle,w=F===r.GR.Bars?T.barAlignment:F===r.GR.Line?T.lineInterpolation:null,B=`${N}|${S}|${A}|${(0,c.M)(b,O)}|${F}|${w}`,U=P.get(B);U==null&&(U={series:[],dir:N},P.set(B,U)),U.series.push(I)}),[...P.values()]}function m(x,P,b){let M=Array(x.fields.length),O=P.length,I=x.length,T=O>0?Array(I).fill(0):[],C=O>0?Array(I).fill(!1):[],S=Array.from({length:O},()=>T.slice()),A=Array.from({length:O},()=>C.slice());if(P.forEach((L,N)=>{let F=A[N];L.series.forEach(w=>{let B=x.fields[w];if(B.config.custom?.hideFrom?.viz)return;let U=B.values;for(let K=0;K<I;K++)U[K]!=null&&(F[K]=!0)})}),x.fields.forEach((L,N)=>{let F=L.values;if(N===0){L.type===t.PU.time?M[0]=(0,n.ks)(L).values:M[0]=F;return}let{custom:w}=L.config;if(!w||w.hideFrom?.viz){M[N]=F;return}if(w.transform===r.NU.Constant){let U=F.findIndex(V=>V!=null),K=F[U];F=Array(F.length).fill(void 0),F[U]=K}else if(F=F.slice(),w.transform===r.NU.NegativeY)for(let U=0;U<F.length;U++)F[U]!=null&&(F[U]*=-1);let B=w.stacking?.mode;if(!B||B===r.gs.None)M[N]=F;else{let U=P.findIndex(Y=>Y.series.indexOf(N)>-1),K=S[U],V=A[U],H=M[N]=Array(I);for(let Y=0;Y<I;Y++){let X=F[Y];X!=null?H[Y]=K[Y]+=X:H[Y]=V[Y]?K[Y]:X}}}),b){let L=M.map((N,F)=>{let w=P.findIndex(B=>B.series.indexOf(F)>-1);return w!==-1?S[w]:N});b({totals:L})}return x.fields.forEach((L,N)=>{if(N===0||L.config.custom?.hideFrom?.viz)return;if(L.config.custom?.stacking?.mode===r.gs.Percent){let w=P.findIndex(V=>V.series.indexOf(N)>-1),B=S[w],U=P[w],K=M[N];for(let V=0;V<I;V++){let H=K[V];H!=null&&(K[V]=B[V]===0?0:U.dir*(H/B[V]))}}}),M}function v(x,P){let b,M=1,O=1,I=x.data[1][P],T=x.data[1][P];for(let C=1;C<x.data.length;C++){const A=x.data[C][P];A!=null&&(I==null?I=A:A>I&&(I=x.data[C][P],M=C),T==null?T=A:A<T&&(T=x.data[C][P],O=C))}return T==null&&I==null?b=void 0:T!=null&&I!=null?b=(x.valToPos(T,x.series[O].scale)+x.valToPos(I,x.series[M].scale))/2:b=x.valToPos(T||I,x.series[M||O].scale),b!==void 0&&b<0&&(b=x.bbox.height/devicePixelRatio),b}function l(x,P){const b=y(P);return x===r.NU.NegativeY?b?1:-1:b?-1:1}function y(x,P=100){const b=x.length;if(b===0)return!1;let M=0,O=b-1;for(;M<=O&&x[M]==null;)M++;for(;O>=M&&x[O]==null;)O--;let I=0,T=0;if(O>=M){const C=Math.max(1,Math.floor((O-M+1)/P));for(let S=M;S<=O;S+=C){const A=x[S];A!=null&&typeof A=="number"&&(A<0||Object.is(A,-0)?I++:A>0&&T++)}if(I>T)return!0}return!1}const u=(x,P,b)=>{if(!x?.length)return[];const M=C=>C==null?"-":C.toFixed(1),O=P.display??M;let I=null;const T=(0,i.Nw)({field:P,reducers:x});return x.map(C=>{const S=i.AS.get(C);let A=O;return S.id===i.gy.diffperc&&(A=(0,s.J)({field:{...P,config:{...P.config,unit:"percent"}},theme:b})),(S.id===i.gy.count||S.id===i.gy.changeCount||S.id===i.gy.distinctCount)&&(I||(I=(0,s.J)({field:{...P,config:{...P.config,unit:"none"}},theme:b})),A=I),{...A(T[C]),title:S.name,description:S.description}})},D=(0,a.h)("uPlot"),E=D.logger;(0,g.h)("graphng",void 0,D)},48747:(k,R,e)=>{"use strict";e.d(R,{T:()=>y});var t=e(74848),n=e(34796),i=e.n(n),s=e(2543),r=e(96540),g=e(61443),a=e(52622),c=e(75128),o=e(33083),h=e(3139),f=e(65036);const d=({dimensions:D,activeDimensions:E,pos:x,timeZone:P})=>{let b=null;if(E.xAxis===null)return null;E.yAxis&&(b=E.yAxis[0]);const M=E.xAxis[1]?(0,g.WK)(D.xAxis,E.xAxis[0],E.xAxis[1]):x.x,O=(0,f.DU)(D.yAxis.columns,D.xAxis.columns,M,P),I=O.time,T=O.results.map((C,S)=>({color:C.color,label:C.label,value:C.value,isActive:b===S}));return(0,t.jsx)(h.o,{series:T,timestamp:I})};d.displayName="MultiModeGraphTooltip";var p=e(83195),m=e(28240);const v=({dimensions:D,activeDimensions:E,timeZone:x})=>{if(E.yAxis===null||E.yAxis[1]===void 0||E.xAxis===null||E.xAxis[1]===void 0)return null;const P=(0,g.WK)(D.xAxis,E.xAxis[0],E.xAxis[1]),b=(0,g.P4)(D.xAxis,E.xAxis[0]),M=b.display?(0,p.cN)(b.display(P)):P,O=(0,g.P4)(D.yAxis,E.yAxis[0]),I=(0,g.WK)(D.yAxis,E.yAxis[0],E.yAxis[1]),T=O.display,C=T(I);return(0,t.jsx)(h.o,{series:[{color:C.color,label:(0,m.Ct)(O),value:(0,p.cN)(C)}],timestamp:M})};v.displayName="SingleModeGraphTooltip";const l=({mode:D=a.$N.Single,dimensions:E,activeDimensions:x,pos:P,timeZone:b})=>!x||!x.xAxis?null:D==="single"?(0,t.jsx)(v,{dimensions:E,activeDimensions:x,timeZone:b}):(0,t.jsx)(d,{dimensions:E,activeDimensions:x,pos:P,timeZone:b});l.displayName="GraphTooltip";class y extends r.PureComponent{constructor(){super(...arguments),this.state={isTooltipVisible:!1,isContextVisible:!1},this.element=null,this.$element=null,this.onPlotSelected=(E,x)=>{const{onHorizontalRegionSelected:P}=this.props;P&&P(x.xaxis.from,x.xaxis.to)},this.onPlotHover=(E,x,P)=>{this.setState({isTooltipVisible:!0,activeItem:P,pos:x})},this.onPlotClick=(E,x,P)=>{this.setState({isContextVisible:!0,isTooltipVisible:!1,contextItem:P,contextPos:x})},this.renderTooltip=()=>{const{children:E,series:x,timeZone:P}=this.props,{pos:b,activeItem:M,isTooltipVisible:O}=this.state;let I;if(!O||!b||x.length===0||(r.Children.forEach(E,B=>{if(I)return;(B&&B.type&&(B.type.displayName||B.type.name))===c.n.displayName&&(I=B)}),!I))return null;const T=I.props,C=T.mode||"single";if(!M&&C==="single")return null;const S=T.tooltipComponent||l,A=M?M.series.seriesIndex:0,L=M?M.dataIndex:void 0,N={xAxis:[A,L],yAxis:M?[M.series.seriesIndex,M.dataIndex]:null},F={dimensions:{xAxis:(0,g.r4)("xAxis",x.map(B=>B.timeField)),yAxis:(0,g.r4)("yAxis",x.map(B=>B.valueField))},activeDimensions:N,pos:b,mode:T.mode||a.$N.Single,timeZone:P},w=r.createElement(S,{...F});return r.cloneElement(I,{content:w,position:{x:b.pageX,y:b.pageY},offset:{x:10,y:10}})},this.renderContextMenu=()=>{const{series:E}=this.props,{contextPos:x,contextItem:P,isContextVisible:b}=this.state;if(!b||!x||!P||E.length===0)return null;const M=P?P.series.seriesIndex:0,O=P?P.dataIndex:void 0,I={xAxis:[M,O],yAxis:P?[P.series.seriesIndex,P.dataIndex]:null},T={xAxis:(0,g.r4)("xAxis",E.map(L=>L.timeField)),yAxis:(0,g.r4)("yAxis",E.map(L=>L.valueField))},C=()=>this.setState({isContextVisible:!1}),S=()=>({datapoint:P.datapoint,dataIndex:P.dataIndex,series:P.series,seriesIndex:P.series.seriesIndex,pageX:x.pageX,pageY:x.pageY}),A={x:x.pageX,y:x.pageY,onClose:C,getContextMenuSource:S,timeZone:this.props.timeZone,dimensions:T,contextDimensions:I};return(0,t.jsx)(o.H,{...A})},this.getBarWidth=()=>{const{series:E}=this.props;return Math.min(...E.map(x=>x.timeStep))}}static{this.defaultProps={showLines:!0,showPoints:!1,showBars:!1,isStacked:!1,lineWidth:1}}componentDidUpdate(E,x){E!==this.props&&this.draw()}componentDidMount(){this.draw(),this.element&&(this.$element=i()(this.element),this.$element.bind("plotselected",this.onPlotSelected),this.$element.bind("plothover",this.onPlotHover),this.$element.bind("plotclick",this.onPlotClick))}componentWillUnmount(){this.$element&&this.$element.unbind("plotselected",this.onPlotSelected)}getYAxes(E){return E.length===0?[{show:!0,min:-1,max:1}]:(0,s.uniqBy)(E.map(x=>{const P=x.yAxis?x.yAxis.index:1,b=x.yAxis&&x.yAxis.min&&!isNaN(x.yAxis.min)?x.yAxis.min:null,M=x.yAxis&&x.yAxis.tickDecimals&&!isNaN(x.yAxis.tickDecimals)?x.yAxis.tickDecimals:null;return{show:!0,index:P,position:P===1?"left":"right",min:b,tickDecimals:M}}),x=>x.index)}draw(){if(this.element===null)return;const{width:E,series:x,timeRange:P,showLines:b,showBars:M,showPoints:O,isStacked:I,lineWidth:T,timeZone:C,onHorizontalRegionSelected:S}=this.props;if(!E)return;const A=E/100,L=P.from.valueOf(),N=P.to.valueOf(),F=this.getYAxes(x),w={legend:{show:!1},series:{stack:I,lines:{show:b,lineWidth:T,zero:!1},points:{show:O,fill:1,fillColor:!1,radius:2},bars:{show:M,fill:1,barWidth:M?this.getBarWidth()/1.5:1,zero:!1,lineWidth:T},shadowSize:0},xaxis:{timezone:C,show:!0,mode:"time",min:L,max:N,label:"Datetime",ticks:A,timeformat:(0,f.Jc)(A,L,N),tickFormatter:f.Yn},yaxes:F,grid:{minBorderMargin:0,markings:[],backgroundColor:null,borderWidth:0,hoverable:!0,clickable:!0,color:"#a1a1a1",margin:{left:0,right:0},labelMarginX:0,mouseActiveRadius:30},selection:{mode:S?"x":null,color:"#666"},crosshair:{mode:"x"}};try{i().plot(this.element,x.filter(B=>B.isVisible),w)}catch(B){throw console.error("Graph rendering error",B,w,x),new Error("Error rendering panel")}}render(){const{ariaLabel:E,height:x,width:P,series:b}=this.props,M=b.length===0,O=this.renderTooltip(),I=this.renderContextMenu();return(0,t.jsxs)("div",{className:"graph-panel","aria-label":E,children:[(0,t.jsx)("div",{className:"graph-panel__chart",ref:T=>this.element=T,style:{height:x,width:P},onMouseLeave:()=>{this.setState({isTooltipVisible:!1})}}),M&&(0,t.jsx)("div",{className:"datapoints-warning",children:"No data"}),O,I]})}}const u=null},33083:(k,R,e)=>{"use strict";e.d(R,{H:()=>d,i:()=>p});var t=e(74848),n=e(32196),i=e(61443),s=e(72724),r=e(28122),g=e(9286),a=e(66864),c=e(59093),o=e(64539),h=e(94536),f=e(40845);const d=({getContextMenuSource:v,timeZone:l,itemsGroup:y,dimensions:u,contextDimensions:D,...E})=>{const x=v(),P=y?y.map(O=>({...O,items:O.items?.filter(I=>I.label)})):[],b=()=>{if(!x)return null;let O;if(u?.yAxis&&D?.yAxis?.[1]){const T=(0,i.WK)(u.yAxis,D.yAxis[0],D.yAxis[1]),C=x.series.valueField.display;O=C(T)}const I=(0,s.LE)(x.datapoint[0],{defaultWithMS:x.series.hasMsResolution,timeZone:l});return(0,t.jsx)(p,{timestamp:I,seriesColor:x.series.color,displayName:x.series.alias||x.series.label,displayValue:O})},M=()=>P?.map((O,I)=>(0,t.jsx)(c.r,{label:O.label,children:(O.items||[]).map(T=>(0,t.jsx)(o.D,{url:T.url,label:T.label,target:T.target,icon:T.icon,active:T.active,onClick:T.onClick},`${T.label}`))},`${O.label}${I}`));return(0,t.jsx)(r.t,{...E,renderMenuItems:M,renderHeader:b})},p=({timestamp:v,seriesColor:l,displayName:y,displayValue:u})=>{const D=(0,f.of)(m);return(0,t.jsxs)("div",{className:D.wrapper,children:[(0,t.jsx)("strong",{children:v}),(0,t.jsxs)(a.Gy,{children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(h.p,{color:l}),(0,t.jsx)("span",{className:D.displayName,children:y})]}),u&&(0,t.jsx)(g.i,{value:u})]})]})};function m(v){return{wrapper:(0,n.css)({padding:v.spacing(.5,1),fontSize:v.typography.size.sm,zIndex:v.zIndex.tooltip}),displayName:(0,n.css)({whiteSpace:"nowrap",paddingLeft:v.spacing(.5)})}}},84656:(k,R,e)=>{"use strict";e.d(R,{M:()=>s});var t=e(2543),n=e.n(t),i=e(96540);class s extends i.Component{constructor(g){super(g),this.onSeriesToggle=this.onSeriesToggle.bind(this),this.state={hiddenSeries:[],toggledSeries:g.series}}componentDidUpdate(g){const{series:a}=this.props;(0,t.isEqual)(g.series,a)||this.setState({hiddenSeries:[],toggledSeries:a})}onSeriesToggle(g,a){const{series:c,onHiddenSeriesChanged:o}=this.props,{hiddenSeries:h}=this.state;if(a.ctrlKey||a.metaKey||a.shiftKey){const m=h.indexOf(g)>-1?h.filter(l=>l!==g):h.concat([g]),v=c.map(l=>({...l,isVisible:m.indexOf(l.label)===-1}));this.setState({hiddenSeries:m,toggledSeries:v},()=>o?o(m):void 0);return}const f=c.map(m=>m.label),d=h.length+1===f.length?[]:(0,t.difference)(f,[g]),p=c.map(m=>({...m,isVisible:d.indexOf(m.label)===-1}));this.setState({hiddenSeries:d,toggledSeries:p},()=>o?o(d):void 0)}render(){const{children:g}=this.props,{toggledSeries:a}=this.state;return g({onSeriesToggle:this.onSeriesToggle,toggledSeries:a})}}},5484:(k,R,e)=>{"use strict";e.d(R,{I:()=>c});var t=e(74848),n=e(32196),i=e(40276),s=e(96516),r=e(40845),g=e(48747);const a=(h,f=!1,d=!1)=>{const p=h.reduce((v,l)=>v+(l[1]||0),0)===0,m=!h.reduce((v,l)=>v&&l[1]!==null,!0);return f&&m||d&&p},c=h=>{const{series:f,timeRange:d,width:p,height:m,showBars:v,showLines:l,showPoints:y,sortLegendBy:u,sortLegendDesc:D,legendDisplayMode:E,legendVisibility:x,placement:P,onSeriesToggle:b,onToggleSort:M,hideEmpty:O,hideZero:I,isStacked:T,lineWidth:C,onHorizontalRegionSelected:S,timeZone:A,children:L,ariaLabel:N}=h,{graphContainer:F,wrapper:w,legendContainer:B}=(0,r.of)(o,h.placement),U=f.reduce((K,V)=>a(V.data,O,I)?K:K.concat([{label:V.label,color:V.color||"",disabled:!V.isVisible,yAxis:V.yAxis.index,getDisplayValues:()=>V.info||[]}]),[]);return(0,t.jsxs)("div",{className:w,"aria-label":N,children:[(0,t.jsx)("div",{className:F,children:(0,t.jsx)(g.T,{series:f,timeRange:d,timeZone:A,showLines:l,showPoints:y,showBars:v,width:p,height:m,isStacked:T,lineWidth:C,onHorizontalRegionSelected:S,children:L})}),x&&(0,t.jsx)("div",{className:B,children:(0,t.jsx)(i.E,{hideHorizontalTrack:!0,children:(0,t.jsx)(s.t,{items:U,displayMode:E,placement:P,sortBy:u,sortDesc:D,onLabelClick:(K,V)=>{b&&b(K.label,V)},onToggleSort:M})})})]})},o=(h,f)=>({wrapper:(0,n.css)({display:"flex",flexDirection:f==="bottom"?"column":"row"}),graphContainer:(0,n.css)({minHeight:"65%",flexGrow:1}),legendContainer:(0,n.css)({padding:"10px 0",maxHeight:f==="bottom"?"35%":"none"})})},65036:(k,R,e)=>{"use strict";e.d(R,{DU:()=>g,Jc:()=>c,Yn:()=>a});var t=e(83195),n=e(28240),i=e(72724),s=e(42994);const r=(o,h)=>{let f=0,d=o.values.length-1,p;for(;;){if(f>d)return Math.max(d,0);p=Math.floor((f+d)/2);const m=o.values[p];if(m===h)return p;m&&m<h?f=p+1:d=p-1}},g=(o,h,f,d)=>{let p,m,v,l,y;const u=[];let D,E;for(p=0;p<o.length;p++){m=o[p];const x=h[p];v=r(x,f),l=f-x.values[v],y=x.values[v],(D===void 0||l>=0&&(l<D||D<0)||l<0&&l>D)&&(D=l,E=x.display?(0,t.cN)(x.display(y)):y);const P=m.display(m.values[v]);u.push({value:(0,t.cN)(P),datapointIndex:v,seriesIndex:p,color:P.color,label:(0,n.Ct)(m),time:x.display?(0,t.cN)(x.display(y)):y})}return{results:u,time:E}},a=(o,h)=>(0,i.LE)(o,{format:h?.options?.timeformat,timeZone:h?.options?.timezone}),c=(o,h,f)=>{if(h&&f&&o){const d=f-h,p=d/o/1e3,m=86400010,v=31536e6;return p<=10?s.WC.interval.millisecond:p<=45?s.WC.interval.second:d<=m?s.WC.interval.minute:p<=8e4?s.WC.interval.hour:d<=v?s.WC.interval.day:p<=31536e3?s.WC.interval.month:s.WC.interval.year}return s.WC.interval.minute}},99755:(k,R,e)=>{"use strict";e.d(R,{o:()=>l});var t=e(74848),n=e(96540),i=e(64423),s=e(99165),r=e(85200),g=e(1173),a=e(11261),c=e(69129),o=e(26272),h=e(79041),f=e(67266),d=e(81297),p=e(16895),m=e(65575);function v(y,u,D=[]){for(const E of D)if(typeof E=="function"){if(!E(y,u))return!1}else if(u[E]!==y[E])return!1;return!0}class l extends n.Component{constructor(u){super(u),this.panelContext={},this.subscription=new i.yU,this.getTimeRange=()=>this.props.timeRange;let D=this.prepState(u);D.alignedData=D.config.prepData([D.alignedFrame]),this.state=D,this.plotInstance=n.createRef()}static{this.contextType=h.e4}prepState(u,D=!0){let E=null;const{frames:x,fields:P,preparePlotFrame:b}=u,O=(b||m.mY)(x,P||{x:r.sJ.get(g.Ct.firstTimeField).get({}),y:r.sJ.get(g.Ct.byTypes).get(new Set([a.PU.number,a.PU.enum]))},u.timeRange);if((0,p.uY)("GraphNG",!1,"data aligned",O),O){let I=this.state?.config;D&&(I=u.prepConfig(O,this.props.frames,this.getTimeRange),(0,p.uY)("GraphNG",!1,"config prepared",I)),E={alignedFrame:O,config:I},(0,p.uY)("GraphNG",!1,"data prepared",E.alignedData)}return E}handleCursorUpdate(u){const D=u.payload?.point?.time,E=this.plotInstance.current;if(E&&D){const x=E.valToPos(D,"x");let P;if(x&&(P=(0,p.sw)(E,E.posToIdx(x))),!P||!x)return;E.setCursor({left:x,top:P})}}componentDidMount(){this.panelContext=this.context;const{eventBus:u}=this.panelContext;this.subscription.add(u.getStream(c.b_).pipe((0,s.c)(50)).subscribe({next:D=>{u!==D.origin&&this.handleCursorUpdate(D)}})),this.subscription.add(u.getStream(o.kb).pipe((0,s.c)(50)).subscribe({next:D=>this.handleCursorUpdate(D)})),this.subscription.add(u.getStream(c.ql).pipe((0,s.c)(50)).subscribe({next:()=>{const D=this.plotInstance?.current;D&&!D.cursor._lock&&D.setCursor({left:-10,top:-10})}}))}componentDidUpdate(u){const{frames:D,structureRev:E,timeZone:x,propsToDiff:P}=this.props,b=!v(u,this.props,P);if(D!==u.frames||b||x!==u.timeZone){let M=this.prepState(this.props,!1);M&&((this.state.config===void 0||x!==u.timeZone||E!==u.structureRev||!E||b)&&(M.config=this.props.prepConfig(M.alignedFrame,this.props.frames,this.getTimeRange),(0,p.uY)("GraphNG",!1,"config recreated",M.config)),M.alignedData=M.config.prepData([M.alignedFrame]),this.setState(M))}}componentWillUnmount(){this.subscription.unsubscribe()}render(){const{width:u,height:D,children:E,renderLegend:x}=this.props,{config:P,alignedFrame:b,alignedData:M}=this.state;return P?(0,t.jsx)(f.KU,{width:u,height:D,legend:x(P),children:(O,I)=>(0,t.jsx)(d.Z,{config:P,data:M,width:O,height:I,plotRef:T=>this.plotInstance.current=T,children:E?E(P,b):null})}):null}}},16998:(k,R,e)=>{"use strict";e.d(R,{I:()=>i});var t=e(96540);const n=(0,t.createContext)({}),i=()=>{const{data:s,dimFields:r,mapSeriesIndexToDataFrameFieldIndex:g}=(0,t.useContext)(n),a=(0,t.useCallback)(()=>{const c=r.x;let o=null;for(let h=0;h<s.fields.length;h++)if(c(s.fields[h],s,[s])){o=s.fields[h];break}return o},[s,r]);return{dimFields:r,mapSeriesIndexToDataFrameFieldIndex:g,getXAxisField:a,alignedData:s}}},65575:(k,R,e)=>{"use strict";e.d(R,{My:()=>p,wX:()=>h,mY:()=>d});var t=e(11261),n=e(73060),i=e(52622),s=e(52811);const r={threshold:(v,l,y)=>v+y,midpoint:(v,l,y)=>(v+l)/2,plusone:(v,l,y)=>v+1};function g(v){if(v.frame.length===0)return v.frame;let l=!0,{frame:y,refFieldName:u,refFieldPseudoMax:D,refFieldPseudoMin:E,insertMode:x}=v;x||(x=r.threshold);const P=h(y,u);if(P==null)return y;P.state={...P.state,nullThresholdApplied:!0};const b=y.fields.map(O=>O.config.custom?.insertNulls||P.config.interval||null),M=new Set(b);if(M.delete(null),M.size===0)return y;if(M.size===1){const O=M.values().next().value;if(O<=0)return y;const I=P.values,T=y.fields.map(S=>S.values),C=a(I,T,O,E,D,x,l);return C===T?y:{...y,length:C[0].length,fields:y.fields.map((S,A)=>({...S,values:C[A]}))}}return y}function a(v,l,y,u=null,D=null,E,x){const P=v.length,b=[];if(u!=null&&u<v[0]){let T=Math.ceil((v[0]-u)/y),C=v[0]-T*y;for(;C<v[0];)b.push(E(C-y,C,y)),C+=y}b.push(v[0]);let M=v[0];for(let T=1;T<P;T++){const C=v[T];for(;C-M>y&&(b.push(E(M,C,y)),M+=y,!!x););b.push(C),M=C}if(D!=null&&D>M)for(;M+y<D;)b.push(E(M,D,y)),M+=y;const O=b.length;if(O===P)return l;const I=[];for(let T of l){let C;if(T!==v){C=Array(O);for(let S=0,A=0;S<O;S++)C[S]=v[A]===b[S]?T[A++]:null}else C=b;I.push(C)}return I}function c(v,l,y){let u,D;for(let E=0;E<l.length;E++)if(l[E]==null)D==null&&u!=null&&(D=E);else{if(D!=null){if(v[E]-u<y)for(;D<E;)l[D++]=void 0;D=null}u=v[E]}return l}function o(v){return v.type===t.PU.number&&v.config.custom?.drawStyle===i.GR.Bars&&!v.config.custom?.hideFrom?.viz}function h(v,l){return v.fields.find(y=>l!=null?y.name===l:y.type===t.PU.time)}function f(v,l){const y=h(v,l);let u=y?.values;for(let D=0;D<v.fields.length;D++){let E=v.fields[D];if(E===y||o(E))continue;let x=E.config.custom?.spanNulls;typeof x=="number"&&x!==-1&&u&&(E.values=c(u,E.values,x))}return v}function d(v,l,y){let u;e:for(let P of v)for(let b of P.fields)if(l.x(b,P,v)){u=b;break e}v=v.map(P=>u?.state?.nullThresholdApplied?P:g({frame:P,refFieldName:u.name,refFieldPseudoMin:y?.from.valueOf(),refFieldPseudoMax:y?.to.valueOf()}));let D=0;v.forEach(P=>{P.fields.forEach(b=>{o(b)&&(b.config.custom={...b.config.custom,spanNulls:-1},D++)})});let E=1/0;D>1&&v.forEach(P=>{if(!P.fields.some(o))return;const b=u.values;for(let M=0;M<b.length;M++)M>0&&(E=Math.min(E,b[M]-b[M-1]))});let x=(0,n.Fd)({frames:v,joinBy:l.x,keep:l.y,keepOriginIndices:!0});return x?(x=f(x,u.name),E!==1/0&&(x.fields.forEach((P,b)=>{let M=P.values;if(b===0){let O=M[M.length-1];M.push(O+E,O+2*E)}else o(P)?M.push(null,null):M.push(void 0,void 0)}),x.length+=2),x):null}function p(v,l){const y="na",u=`${v.min!==void 0?v.min:y}-${v.max!==void 0?v.max:y}`,D=`${v.custom?.axisSoftMin!==void 0?v.custom.axisSoftMin:y}-${v.custom?.axisSoftMax!==void 0?v.custom.axisSoftMax:y}`,E=`${v.custom?.axisPlacement!==void 0?v.custom?.axisPlacement:i.vM.Auto}`,x=v.unit??s.s,P=v.custom?.scaleDistribution?m(v.custom.scaleDistribution):i.L4.Linear,b=v.custom?.axisLabel?v.custom.axisLabel:y;return`${x}/${u}/${D}/${E}/${P}/${b}/${l}`}function m(v){return v.type===i.L4.Log?`${v.type}${v.log}`:v.type}},18262:(k,R,e)=>{"use strict";e.d(R,{Z:()=>S});var t=e(74848),n=e(96540),i=e(79041),s=e(24182),r=e(40845),g=e(99755),a=e(2543),c=e(36613),o=e(11261),h=e(83195),f=e(57875),d=e(8066),p=e(24293),m=e(28240),v=e(94624),l=e(52622),y=e(51336),u=e(74863),D=e(16895),E=e(65575);const x=new Set(["bytes","bits","kbytes","mbytes","gbytes","tbytes","pbytes","binBps","binbps","KiBs","Kibits","MiBs","Mibits","GiBs","Gibits","TiBs","Tibits","PiBs","Pibits"]),P=Array(53);for(let A=0;A<P.length;A++)P[A]=2**A;const b=(A,L=1)=>A==null?"-":A.toFixed(L),M={drawStyle:l.GR.Line,showPoints:l.yL.Auto,axisPlacement:l.vM.Auto},O=({frame:A,theme:L,timeZones:N,getTimeRange:F,sync:w,allFrames:B,renderers:U,tweakScale:K=H=>H,tweakAxis:V=H=>H})=>{const H="__global_",Y=new y.e(N[0]);let X;Y.setPrepData(ie=>(X=ie[0],(0,D.bq)(ie[0],Y.getStackingGroups())));const J=A.fields[0];if(!J)return Y;const q="x";let ae="";const j=J.config.custom?.axisPlacement!==l.vM.Hidden?l.vM.Bottom:l.vM.Hidden,te=J.config.custom?.axisPlacement!==l.vM.Hidden;if(J.type===o.PU.time){Y.addScale({scaleKey:q,orientation:l.Lt.Horizontal,direction:l.ON.Right,isTime:!0,range:()=>{const Z=F();return[Z.from.valueOf(),Z.to.valueOf()]}});const ie=N.length>1?(Z,oe)=>oe.map((ce,ye)=>ye<2?null:ce):void 0;for(let Z=0;Z<N.length;Z++){const oe=N[Z];Y.addAxis({scaleKey:q,isTime:!0,placement:j,show:te,label:J.config.custom?.axisLabel,timeZone:oe,theme:L,grid:{show:Z===0&&J.config.custom?.axisGridShow},filter:ie})}N.length>1&&Y.addHook("drawAxes",Z=>{Z.ctx.save(),Z.ctx.fillStyle=L.colors.text.primary,Z.ctx.textAlign="left",Z.ctx.textBaseline="bottom";let oe=0;Z.axes.forEach(ce=>{if(ce.side===2){let ye=ce._pos+ce._size;Z.ctx.fillText(N[oe],Z.bbox.left,ye*c.A.pxRatio),oe++}}),Z.ctx.restore()})}else Y.addScale({scaleKey:q,orientation:l.Lt.Horizontal,direction:l.ON.Right,range:(ie,Z,oe)=>[J.config.min??Z,J.config.max??oe]}),Y.addAxis({scaleKey:q,placement:j,show:te,label:J.config.custom?.axisLabel,theme:L,grid:{show:J.config.custom?.axisGridShow},formatValue:(ie,Z)=>(0,h.cN)(J.display(ie,Z))});let ne=U?.flatMap(ie=>Object.values(ie.fieldMap).filter(Z=>ie.indicesOnly.indexOf(Z)===-1))??[],le;for(let ie=1;ie<A.fields.length;ie++){const Z=A.fields[ie],oe={...Z.config,custom:{...M,...Z.config.custom}},ce=oe.custom;if(Z===J||Z.type!==o.PU.number&&Z.type!==o.PU.enum)continue;let ye=Z.display??b;Z.config.custom?.stacking?.mode===l.gs.Percent&&(ye=(0,f.J)({field:{...Z,config:{...Z.config,unit:"percentunit"}},theme:L}));const re=(0,E.My)(oe,Z.type),ue=(0,d.Qi)(Z),ge=(0,d.lz)(Z,L).color;if(Y.addScale(K({scaleKey:re,orientation:l.Lt.Vertical,direction:l.ON.Up,distribution:ce.scaleDistribution?.type,log:ce.scaleDistribution?.log,linearThreshold:ce.scaleDistribution?.linearThreshold,min:Z.config.min,max:Z.config.max,softMin:ce.axisSoftMin,softMax:ce.axisSoftMax,centeredZero:ce.axisCenteredZero,range:ce.stacking?.mode===l.gs.Percent?(Pe,Ue,$e)=>(Ue=Ue<0?-1:0,$e=$e>0?1:0,[Ue,$e]):Z.type===o.PU.enum?(Pe,Ue,$e)=>[-1,Z.config.type.enum.text.length]:void 0,decimals:Z.config.decimals},Z)),ae||(ae=re),ce.axisPlacement!==l.vM.Hidden){let Pe;ce.axisColorMode===l.Y$.Series&&(ue.isByValue&&Z.config.custom?.gradientMode===l.on.Scheme&&ue.id===p.Y.Thresholds?Pe=(0,u.pl)(1,L,ue,Z.config.thresholds):Pe=ge);const Ue={border:{show:ce.axisBorderShow||!1,width:1/devicePixelRatio,stroke:Pe||L.colors.text.primary},ticks:{show:ce.axisBorderShow||!1,stroke:Pe||L.colors.text.primary},color:Pe||L.colors.text.primary};let $e,ze,qe;if(x.has(oe.unit))$e=P;else if(Z.type===o.PU.enum){let dt=Z.config.type.enum.text;qe=dt.map((vt,yt)=>yt),ze=dt}Y.addAxis(V({scaleKey:re,label:ce.axisLabel,size:ce.axisWidth,placement:ce.axisPlacement??l.vM.Auto,formatValue:(dt,vt)=>(0,h.cN)(ye(dt,vt)),theme:L,grid:{show:ce.axisGridShow},decimals:Z.config.decimals,distr:ce.scaleDistribution?.type,splits:qe,values:ze,incrs:$e,...Ue},Z))}const Te=ce.drawStyle===l.GR.Points?l.yL.Always:ce.showPoints;let Le=()=>null;ce.spanNulls!==!0&&(Le=(Pe,Ue,$e,ze)=>{let qe=[],dt=Pe.series[Ue];if(!$e&&ze&&ze.length){const[vt,yt]=dt.idxs,st=Pe.data[0],Ve=Pe.data[Ue],pe=Math.round(Pe.valToPos(st[vt],"x",!0)),Ee=Math.round(Pe.valToPos(st[yt],"x",!0));ze[0][0]===pe&&qe.push(vt);for(let me=0;me<ze.length;me++){let ve=ze[me],Se=ze[me+1];if(Se&&ve[1]===Se[0]){let Ie=Pe.posToIdx(ve[1],!0);if(Ve[Ie]==null)for(let Oe=1;Oe<100;Oe++){if(Ve[Ie+Oe]!=null){Ie+=Oe;break}if(Ve[Ie-Oe]!=null){Ie-=Oe;break}}qe.push(Ie)}}ze[ze.length-1][1]===Ee&&qe.push(yt)}return qe.length?qe:null});let{fillOpacity:Ye}=ce,je=null,Ze=null;if(Z.state?.origin){le||(le=I(A,B));const Pe=B[Z.state.origin.frameIndex],Ue=Pe?.fields[Z.state.origin.fieldIndex],$e=(0,m.Ct)(Ue??Z,Pe,B);if(ne.indexOf($e)>=0)je=()=>null,Ze=()=>{};else if(ce.transform===l.NU.Constant){const ze=c.A.paths.linear();je=(qe,dt)=>{const vt=qe._data,yt=F();let st=[yt.from.valueOf(),yt.to.valueOf()],Ve=vt[dt].find(me=>me!=null),pe=[Ve,Ve],Ee=vt.slice();return Ee[0]=st,Ee[dt]=pe,ze({...qe,_data:Ee},dt,0,1)}}if(ce.fillBelowTo){const ze=A.fields.find(yt=>ce.fillBelowTo===yt.name||ce.fillBelowTo===yt.config?.displayNameFromDS||ce.fillBelowTo===(0,m.Ct)(yt,A,B)),qe=ze?(0,m.Ct)(ze,A,B):ce.fillBelowTo,dt=le.get($e),vt=le.get(qe);(0,a.isNumber)(vt)&&(0,a.isNumber)(dt)?(Y.addBand({series:[dt,vt],fill:void 0}),Ye||(Ye=35)):Ye=0}}let Ne;ue.id===p.Y.Thresholds&&(Ne=Pe=>(0,d.lz)(X.fields[Pe],L).color),Y.addSeries({pathBuilder:je,pointsBuilder:Ze,scaleKey:re,showPoints:Te,pointsFilter:Le,colorMode:ue,fillOpacity:Ye,theme:L,dynamicSeriesColor:Ne,drawStyle:ce.drawStyle,lineColor:ce.lineColor??ge,lineWidth:ce.lineWidth,lineInterpolation:ce.lineInterpolation,lineStyle:ce.lineStyle,barAlignment:ce.barAlignment,barWidthFactor:ce.barWidthFactor,barMaxWidth:ce.barMaxWidth,pointSize:ce.pointSize,spanNulls:ce.spanNulls||!1,show:!ce.hideFrom?.viz,gradientMode:ce.gradientMode,thresholds:oe.thresholds,hardMin:Z.config.min,hardMax:Z.config.max,softMin:ce.axisSoftMin,softMax:ce.axisSoftMax,dataFrameFieldIndex:Z.state?.origin}),ce.thresholdsStyle&&oe.thresholds&&(ce.thresholdsStyle.mode??l.Ly.Off)!==l.Ly.Off&&Y.addThresholds({config:ce.thresholdsStyle,thresholds:oe.thresholds,scaleKey:re,theme:L,hardMin:Z.config.min,hardMax:Z.config.max,softMin:ce.axisSoftMin,softMax:ce.axisSoftMax})}let z=(0,D.ro)(A);Y.setStackingGroups(z),U?.forEach(ie=>{le||(le=I(A,B));let Z={};for(let oe in ie.fieldMap){let ce=ie.fieldMap[oe];Z[oe]=le.get(ce)}ie.init(Y,Z)}),Y.scaleKeys=[q,ae];const ee=15;let se={dataIdx:(ie,Z,oe,ce)=>{let ye=ie.data[Z];if(ye[oe]==null){let re=null,ue=null,De;for(De=oe;re==null&&De-- >0;)ye[De]!=null&&(re=De);for(De=oe;ue==null&&De++<ye.length;)ye[De]!=null&&(ue=De);let ge=ie.data[0],Te=ie.valToPos(ce,"x"),Le=ue==null?1/0:ie.valToPos(ge[ue],"x"),Ye=re==null?-1/0:ie.valToPos(ge[re],"x"),je=Te-Ye,Ze=Le-Te;je<=Ze?je<=ee&&(oe=re):Ze<=ee&&(oe=ue)}return oe}};return w&&w()!==v.y.Off&&(se.sync={key:H,scales:[q,null]}),Y.setCursor(se),Y};function I(A,L){const N=new Map;return A.fields.forEach((F,w)=>{const B=F.state?.origin;if(B){const U=L[B.frameIndex]?.fields[B.fieldIndex];U&&N.set((0,m.Ct)(U,L[B.frameIndex],L),w)}}),N}const T=["legend","options","theme"];class C extends n.Component{constructor(){super(...arguments),this.prepConfig=(L,N,F)=>{const{sync:w}=this.context,{theme:B,timeZone:U,renderers:K,tweakAxis:V,tweakScale:H}=this.props;return O({frame:L,theme:B,timeZones:Array.isArray(U)?U:[U],getTimeRange:F,sync:w,allFrames:N,renderers:K,tweakScale:H,tweakAxis:V})},this.renderLegend=L=>{const{legend:N,frames:F}=this.props;return!L||N&&!N.showLegend||!(0,s.t)(L,F)?null:(0,t.jsx)(s.$,{data:F,config:L,...N})}}static{this.contextType=i.e4}render(){return(0,t.jsx)(g.o,{...this.props,prepConfig:this.prepConfig,propsToDiff:T,renderLegend:this.renderLegend})}}const S=(0,r.cV)(C);S.displayName="TimeSeries"},90606:(k,R,e)=>{"use strict";e.d(R,{T:()=>D});var t=e(74848),n=e(32196),i=e(96540),s=e(1604),r=e(94624),g=e(57875),a=e(24293),c=e(28240),o=e(83195),h=e(11261),f=e(14588),d=e(52622),p=e(3139),m=e(17464),v=e(69503),l=e(16895),y=e(40845);const u=10,D=({mode:b=d.$N.Single,sortOrder:M=d.xB.None,sync:O,timeZone:I,config:T,renderTooltip:C,...S})=>{const A=(0,i.useRef)(),L=(0,y.$j)(),[N,F]=(0,i.useState)(null),[w,B]=(0,i.useState)(null),[U,K]=(0,i.useState)([]),[V,H]=(0,i.useState)(null),[Y,X]=(0,i.useState)(!1),J=(0,s.A)();let q=null;const ae=(0,y.of)(P);if((0,i.useLayoutEffect)(()=>{let z;const ee=()=>{J()&&(X(!0),A.current?.root.classList.add("plot-active"))},se=()=>{J()&&(H(null),X(!1),A.current?.root.classList.remove("plot-active"))};return T.addHook("syncRect",(ie,Z)=>z=Z),T.addHook("init",ie=>{A.current=ie,ie.over.addEventListener("mouseenter",ee),ie.over.addEventListener("mouseleave",se),q=ie.root.closest("[tabindex]"),q&&(q.addEventListener("focus",ee),q.addEventListener("blur",se)),O&&O()===r.y.Crosshair&&ie.root.classList.add("shared-crosshair")}),T.addHook("setLegend",ie=>{J()&&(B(ie.legend.idx),K(ie.legend.idxs.slice()))}),T.addHook("setCursor",ie=>{if(!z||!J())return;const{x:Z,y:oe}=x(ie,z);H(Z!==void 0&&oe!==void 0?{x:Z,y:oe}:null)}),T.addHook("setSeries",(ie,Z)=>{J()&&F(Z)}),()=>{H(null),A.current&&(A.current.over.removeEventListener("mouseleave",se),A.current.over.removeEventListener("mouseenter",ee),q&&(q.removeEventListener("focus",ee),q.removeEventListener("blur",se)))}},[T,H,X,B,K]),w===null||!Y&&O&&O()===r.y.Crosshair)return null;let j=S.data.fields[0];if(!j)return null;const te=j.display||(0,g.J)({field:j,timeZone:I,theme:L});let ne=null,le=te(j.values[w]).text;if(C)ne=C(S.data,N,w);else{if(b===d.$N.Single&&N!==null){const z=S.data.fields[N];if(!z)return null;const ee=U?.[N]??w;le=te(j.values[ee]).text;const ie=(z.display||(0,g.J)({field:z,timeZone:I,theme:L}))(z.values[ee]);ne=(0,t.jsx)(p.o,{series:[{color:ie.color||a.F,label:(0,c.Ct)(z,S.data,S.frames),value:ie?(0,o.cN)(ie):null}],timestamp:le})}if(b===d.$N.Multi){let z=[];const ee=S.data,se=ee.fields,ie=[];for(let Z=0;Z<se.length;Z++){const oe=ee.fields[Z];if(!oe||oe===j||oe.type===h.PU.time||oe.type!==h.PU.number||oe.config.custom?.hideFrom?.tooltip||oe.config.custom?.hideFrom?.viz)continue;const ce=S.data.fields[Z].values[U[Z]],ye=oe.display(ce);ie.push(ce),z.push({color:ye.color||a.F,label:(0,c.Ct)(oe,ee,S.frames),value:ye?(0,o.cN)(ye):null,isActive:N===Z})}if(M!==d.xB.None){const Z=[...z],oe=f.sortValues(M);z.sort((ce,ye)=>{const re=Z.indexOf(ce),ue=Z.indexOf(ye);return oe(ie[re],ie[ue])})}ne=(0,t.jsx)(p.o,{series:z,timestamp:le})}}return(0,t.jsx)(m.ZL,{className:Y?ae.tooltipWrapper:void 0,children:ne&&V&&(0,t.jsx)(v.o,{position:{x:V.x,y:V.y},offset:{x:u,y:u},children:ne})})};function E({left:b,top:M},O){return b===void 0||M===void 0?!1:b<0||b>O.width||M<0||M>O.height}function x(b,M){let O,I;const T=b.cursor.left||0,C=b.cursor.top||0;if(E(b.cursor,M)){const S=b.posToIdx(T);if(C<0||C>M.height){let A=(0,l.sw)(b,S);A&&(I=M.top+A,T>=0&&T<=M.width&&(O=M.left+b.valToPos(b.data[0][b.posToIdx(T)],b.series[0].scale)))}}else O=M.left+T,I=M.top+C;return{x:O,y:I}}const P=b=>({tooltipWrapper:(0,n.css)({"z-index":b.zIndex.portal+1+" !important"})})},76284:(k,R,e)=>{"use strict";e.d(R,{j:()=>s});var t=e(96540);const n=5,i=r=>r!=null&&!r.ctrlKey&&!r.metaKey,s=({onZoom:r,config:g,withZoomY:a=!1})=>((0,t.useLayoutEffect)(()=>{let c=!1,o=!1;a&&g.addHook("init",h=>{h.over.addEventListener("mousedown",f=>{if(i(f)&&f.button===0&&f.shiftKey){o=!0,h.cursor.drag.x=!1,h.cursor.drag.y=!0;let d=p=>{h.cursor.drag.x=!0,h.cursor.drag.y=!1,document.removeEventListener("mouseup",d,!0)};document.addEventListener("mouseup",d,!0)}},!0)}),g.addHook("setSelect",h=>{const f=h.scales.x.ori===0;if(i(h.cursor.event)){if(a&&o){if(h.select.height>=n){for(let d in h.scales)if(d!=="x"){const p=f?h.posToVal(h.select.top,d):h.posToVal(h.select.left+h.select.width,d),m=f?h.posToVal(h.select.top+h.select.height,d):h.posToVal(h.select.left,d);h.setScale(d,{min:m,max:p})}c=!0}o=!1}else if(h.select.width>=n){const d=f?h.posToVal(h.select.left,"x"):h.posToVal(h.select.top+h.select.height,"x"),p=f?h.posToVal(h.select.left+h.select.width,"x"):h.posToVal(h.select.top,"x");r({from:d,to:p}),c=!1}}h.setSelect({left:0,width:0,top:0,height:0},!1)}),g.setCursor({bind:{dblclick:h=>()=>{if(!i(h.cursor.event))return null;if(a&&c){for(let f in h.scales)f!=="x"&&h.setScale(f,{min:null,max:null});c=!1}else{let f=h.scales.x;const d=f.min,p=f.max,m=(p-d)/2;r({from:d-m,to:p+m})}return null}}})},[g,r,a]),null)},8984:(k,R,e)=>{"use strict";e.r(R),e.d(R,{ALERTING_COLOR:()=>s.xj,AxisPlacement:()=>c.vM,BarAlignment:()=>c.Nj,BarValueVisibility:()=>c.TC,BracesPlugin:()=>a.e1,ClearPlugin:()=>a.vJ,ClipboardPlugin:()=>a.sW,DEFAULT_ANNOTATION_COLOR:()=>s.Mk,DOMUtil:()=>s.bk,DrawStyle:()=>c.yg,EventsWithValidation:()=>s.Pw,GlobalStyles:()=>r.kH,GraphGradientMode:()=>c.on,GraphThresholdsStyleMode:()=>c.Ly,IndentationPlugin:()=>a.TA,LegendDisplayMode:()=>c.lm,LineInterpolation:()=>c.dx,NO_DATA_COLOR:()=>s.nO,NewlinePlugin:()=>a.Om,NodeGraphDataFrameFieldNames:()=>s.uc,OK_COLOR:()=>s.Xw,PENDING_COLOR:()=>s.ct,PointVisibility:()=>c.nT,REGION_FILL_ALPHA:()=>s.UJ,ReactUtils:()=>s.zt,RunnerPlugin:()=>a.Ul,SCHEMA:()=>s.yx,ScaleDirection:()=>c.ON,ScaleOrientation:()=>c.Lt,SearchFunctionType:()=>s.Tt,SelectionShortcutsPlugin:()=>a.l9,SlatePrism:()=>a.De,StackingMode:()=>c.gs,SuggestionsPlugin:()=>a.Pz,TableCellDisplayMode:()=>c.ob,ThemeContext:()=>r.Dx,TooltipDisplayMode:()=>c.$N,ansicolor:()=>s.DB,attachDebugger:()=>s.hF,calculateFontSize:()=>s.Vr,colors:()=>s.Tj,commonOptionsBuilder:()=>g.j,createLogger:()=>s.h,fuzzyMatch:()=>s.It,getCanvasContext:()=>s.Yc,getCellLinks:()=>s.kl,getScrollbarWidth:()=>s.XJ,getTagColor:()=>s.yC,getTagColorIndexFromName:()=>s.JF,getTagColorsFromName:()=>s.MC,getTextColorForAlphaBackground:()=>s.mZ,getTextColorForBackground:()=>s.sg,getTheme:()=>r.O4,hasValidationEvent:()=>s.K,isCompactUrl:()=>s.Fr,linkModelToContextMenuItems:()=>s.Jl,makeFragment:()=>s.dF,makeValue:()=>s.mO,measureText:()=>s.kD,mockTheme:()=>r.mG,mockThemeContext:()=>r.fq,regexValidation:()=>s.RP,sortedColors:()=>s.Ih,styleMixins:()=>r.YF,stylesFactory:()=>r.N3,useForceUpdate:()=>s.CH,useStyles:()=>r.IS,useStyles2:()=>r.of,useTheme:()=>r.DP,useTheme2:()=>r.$j,validate:()=>s.tf,withTheme:()=>r.SL,withTheme2:()=>r.cV});var t=e(94333),i={};for(const o in t)o!=="default"&&(i[o]=()=>t[o]);e.d(R,i);var n=e(80186),i={};for(const o in n)["default","Icon","IconButton","ConfirmButton","DeleteButton","Tooltip","PopoverController","Popover","Toggletip","Portal","getPortalContainer","PortalContainer","CustomScrollbar","TabbedContainer","ClipboardButton","Cascader","ButtonCascader","InlineToast","LoadingPlaceholder","LoadingBar","ColorPicker","SeriesColorPicker","ColorPickerInput","SeriesColorPickerPopover","SeriesColorPickerPopoverWithTheme","EmptySearchResult","EmptyState","UnitPicker","StatsPicker","RefreshPicker","defaultIntervals","TimeRangePicker","TimePickerTooltip","TimeRangeLabel","TimeOfDayPicker","TimeZonePicker","WeekStartPicker","getWeekStart","DatePicker","DatePickerWithInput","DateTimePicker","List","InteractiveTable","TagsInput","AutoSaveField","Pagination","Tag","TagList","FilterPill","ConfirmModal","QueryField","CodeEditor","ReactMonacoEditor","CodeEditorSuggestionItemKind","variableSuggestionToCodeEditorSuggestion","Modal","ModalHeader","ModalTabsHeader","ModalTabContent","ModalsProvider","ModalRoot","ModalsController","ModalsContext","PageToolbar","SetInterval","Table","TableInputCSV","TabsBar","Tab","VerticalTab","TabContent","Counter","RenderUserContentAsHTML","BigValue","BigValueColorMode","BigValueGraphMode","BigValueJustifyMode","BigValueTextMode","Sparkline","Gauge","BarGauge","VizTooltip","VizTooltipContainer","SeriesTable","SeriesTableRow","VizRepeater","PanelChrome","PanelChromeLoadingIndicator","PanelContextProvider","PanelContextRoot","usePanelContext","VizLayout","SeriesVisibilityChangeBehavior","VizLegend","VizLegendListItem","Alert","GraphSeriesToggler","Collapse","ControlledCollapse","CollapsableSection","DataLinkButton","FieldLinkList","FullWidthButtonContainer","ClickOutsideWrapper","CallToActionCard","ContextMenu","Menu","MenuGroup","MenuItem","WithContextMenu","DataLinksInlineEditor","DataLinkInput","DataLinksContextMenu","SeriesIcon","InfoBox","FeatureInfoBox","FeatureBadge","JSONFormatter","JsonExplorer","ErrorBoundary","ErrorBoundaryAlert","withErrorBoundary","ErrorWithStack","DataSourceHttpSettings","CustomHeadersSettings","AlertingSettings","SecureSocksProxySettings","TLSAuthSettings","CertificationKey","Spinner","FadeTransition","SlideOutTransition","Segment","SegmentAsync","SegmentInput","SegmentSelect","SegmentSection","Drawer","Slider","RangeSlider","Form","sharedInputStyle","InputControl","Button","LinkButton","ButtonGroup","clearButtonStyles","ToolbarButton","ToolbarButtonRow","ValuePicker","fieldMatchersUI","Link","TextLink","Text","Box","Stack","Grid","Space","Label","Field","Legend","FieldSet","FieldValidationMessage","InlineField","InlineSegmentGroup","InlineLabel","InlineFieldRow","FieldArray","resetSelectStyles","SelectMenuOptions","getSelectStyles","HorizontalGroup","VerticalGroup","Container","Badge","RadioButtonGroup","RadioButtonDot","RadioButtonList","Input","getInputStyles","AutoSizeInput","FilterInput","Switch","InlineSwitch","Checkbox","TextArea","FileUpload","TimeRangeInput","RelativeTimeRangePicker","Card","getCardStyles","CardContainer","FormattedValueDisplay","ButtonSelect","Dropdown","PluginSignatureBadge","UserIcon","Avatar","InlineFormLabel","Divider","getDragStyles","useSplitter","LegacyForms","LegacyInputStatus","ScaleDistribution","BarGaugeDisplayMode","UPlotConfigBuilder","UPLOT_AXIS_FONT_SIZE","UPlotChart","PlotLegend","FIXED_UNIT","BrowserLabel","PanelContainer","Graph","GraphWithLegend","GraphContextMenu","GraphContextMenuHeader","graphTimeFormat","graphTickFormatter","GraphNG","TimeSeries","useGraphNGContext","preparePlotFrame","buildScaleKey","ZoomPlugin","TooltipPlugin","convertOldAngularValueMapping","sharedSingleStatMigrationHandler","sharedSingleStatPanelChangedHandler","AsyncMultiSelect","AsyncSelect","AsyncVirtualizedSelect","MultiSelect","Select","SelectContainer","VirtualizedSelect","SecretInput","SecretTextArea","FileDropzone","FileDropzoneDefaultChildren","FileListItem","graphFieldOptions","EventsCanvas","Marker","XYCanvas","EventBusPlugin","KeyboardPlugin","TooltipPlugin2","SeriesVisibilityChangeMode"].indexOf(o)<0&&(i[o]=()=>n[o]);e.d(R,i);var s=e(67985),r=e(7918),g=e(42482),a=e(50955),c=e(49149)},38248:(k,R,e)=>{"use strict";e.d(R,{W:()=>p,r:()=>h});var t=e(74848),n=e(11261),i=e(27310),s=e(52622),r=e(88575),g=e(94354),a=e(10354),c=e(90182),o=e(52198);function h(m,v,l){const y=["Axis"];m.addRadio({path:"axisPlacement",name:"Placement",category:y,defaultValue:o.t.axisPlacement[0].value,settings:{options:o.t.axisPlacement}}).addTextInput({path:"axisLabel",name:"Label",category:y,defaultValue:"",settings:{placeholder:"Optional text",expandTemplateVars:!0},showIf:u=>u.axisPlacement!==s.vM.Hidden,shouldApply:u=>u.type!==n.PU.time&&u.type!==n.PU.string}).addNumberInput({path:"axisWidth",name:"Width",category:y,settings:{placeholder:"Auto"},showIf:u=>u.axisPlacement!==s.vM.Hidden}).addRadio({path:"axisGridShow",name:"Show grid lines",category:y,defaultValue:void 0,settings:{options:[{value:void 0,label:"Auto"},{value:!0,label:"On"},{value:!1,label:"Off"}]},showIf:u=>u.axisPlacement!==s.vM.Hidden}).addRadio({path:"axisColorMode",name:"Color",category:y,defaultValue:s.Y$.Text,settings:{options:[{value:s.Y$.Text,label:"Text"},{value:s.Y$.Series,label:"Series"}]},showIf:u=>u.axisPlacement!==s.vM.Hidden}).addBooleanSwitch({path:"axisBorderShow",name:"Show border",category:y,defaultValue:!1,showIf:u=>u.axisPlacement!==s.vM.Hidden}),m.addCustomEditor({id:"scaleDistribution",path:"scaleDistribution",name:"Scale",category:y,editor:p,override:p,defaultValue:{type:s.L4.Linear},shouldApply:u=>u.type===n.PU.number,process:i.hS}).addBooleanSwitch({path:"axisCenteredZero",name:"Centered zero",category:y,defaultValue:!1,showIf:u=>u.scaleDistribution?.type!==s.L4.Log}).addNumberInput({path:"axisSoftMin",name:"Soft min",defaultValue:v.axisSoftMin,category:y,settings:{placeholder:"See: Standard options > Min"}}).addNumberInput({path:"axisSoftMax",name:"Soft max",defaultValue:v.axisSoftMax,category:y,settings:{placeholder:"See: Standard options > Max"}})}const f=[{label:"Linear",value:s.L4.Linear},{label:"Logarithmic",value:s.L4.Log},{label:"Symlog",value:s.L4.Symlog}],d=[{label:"2",value:2},{label:"10",value:10}],p=({value:m,onChange:v})=>{const l=m?.type??s.L4.Linear,y=m?.log??2;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{style:{marginBottom:16},children:(0,t.jsx)(g.z,{value:l,options:f,onChange:u=>{v({...m,type:u,log:u===s.L4.Linear?void 0:y})}})}),(l===s.L4.Log||l===s.L4.Symlog)&&(0,t.jsx)(r.D,{label:"Log base",children:(0,t.jsx)(c.l6,{options:d,value:y,onChange:u=>{v({...m,log:u.value})}})}),l===s.L4.Symlog&&(0,t.jsx)(r.D,{label:"Linear threshold",children:(0,t.jsx)(a.p,{placeholder:"1",value:m?.linearThreshold,onChange:u=>{v({...m,linearThreshold:Number(u.currentTarget.value)})}})})]})}},11404:(k,R,e)=>{"use strict";e.d(R,{e:()=>c});var t=e(74848),n=e(2543),i=e.n(n),s=e(96540),r=e(92174),g=e(67061);const a=({value:o,onChange:h})=>{const f=(0,s.useCallback)(d=>{h({...o,[d]:!o[d]})},[o,h]);return(0,t.jsx)(g.B,{gap:.5,children:Object.keys(o).map(d=>{const p=d;return(0,t.jsx)(r.m,{icon:o[p]?"eye-slash":"eye",onClick:()=>f(p),label:(0,n.startCase)(p),selected:o[p]},p)})})};function c(o){o.addCustomEditor({id:"hideFrom",name:"Hide in area",category:["Series"],path:"hideFrom",defaultValue:{tooltip:!1,viz:!1,legend:!1},editor:a,override:a,shouldApply:()=>!0,hideFromDefaults:!0,process:h=>h})}},22680:(k,R,e)=>{"use strict";e.d(R,{H:()=>i});var t=e(69550),n=e(52622);function i(s,r=!0){s.addBooleanSwitch({path:"legend.showLegend",name:"Visibility",category:["Legend"],description:"",defaultValue:!0}).addRadio({path:"legend.displayMode",name:"Mode",category:["Legend"],description:"",defaultValue:n.lm.List,settings:{options:[{value:n.lm.List,label:"List"},{value:n.lm.Table,label:"Table"}]},showIf:g=>g.legend.showLegend}).addRadio({path:"legend.placement",name:"Placement",category:["Legend"],description:"",defaultValue:"bottom",settings:{options:[{value:"bottom",label:"Bottom"},{value:"right",label:"Right"}]},showIf:g=>g.legend.showLegend}).addNumberInput({path:"legend.width",name:"Width",category:["Legend"],settings:{placeholder:"Auto"},showIf:g=>g.legend.showLegend&&g.legend.placement==="right"}),r&&s.addCustomEditor({id:"legend.calcs",path:"legend.calcs",name:"Values",category:["Legend"],description:"Select values or calculations to show in legend",editor:t.D.get("stats-picker").editor,defaultValue:[],settings:{allowMultiple:!0},showIf:g=>g.legend.showLegend!==!1})}},56675:(k,R,e)=>{"use strict";e.d(R,{I:()=>f,m:()=>h});var t=e(74848),n=e(27310),i=e(11261),s=e(52622),r=e(94354),g=e(29158),a=e(10354),c=e(67061),o=e(52198);const h=({value:d,context:p,onChange:m,item:v})=>(0,t.jsxs)(c.B,{children:[(0,t.jsx)(r.z,{value:d?.mode||s.gs.None,options:v.settings?.options??[],onChange:l=>{m({...d,mode:l})}}),p.isOverride&&d?.mode&&d?.mode!==s.gs.None&&(0,t.jsx)(a.p,{type:"text",placeholder:"Group",suffix:(0,t.jsx)(g.K,{name:"question-circle",tooltip:"Name of the stacking group",tooltipPlacement:"top"}),defaultValue:d?.group,onChange:l=>{m({...d,group:l.currentTarget.value.trim()})}})]});function f(d,p,m=["Graph styles"]){d.addCustomEditor({id:"stacking",path:"stacking",name:"Stack series",category:m,defaultValue:p,editor:h,override:h,settings:{options:o.t.stacking},process:n.hS,shouldApply:v=>v.type===i.PU.number})}},71242:(k,R,e)=>{"use strict";e.d(R,{I:()=>t});function t(n,i=!0){i&&n.addNumberInput({path:"text.titleSize",category:["Text size"],name:"Title",settings:{placeholder:"Auto",integer:!1,min:1,max:200},defaultValue:void 0}),n.addNumberInput({path:"text.valueSize",category:["Text size"],name:"Value",settings:{placeholder:"Auto",integer:!1,min:1,max:200},defaultValue:void 0})}},89654:(k,R,e)=>{"use strict";e.d(R,{D:()=>n});var t=e(52622);function n(i,s=!1,r=!1,g){const a=["Tooltip"],c=s?[{value:t.$N.Single,label:"Single"},{value:t.$N.None,label:"Hidden"}]:[{value:t.$N.Single,label:"Single"},{value:t.$N.Multi,label:"All"},{value:t.$N.None,label:"Hidden"}],o=[{value:t.xB.None,label:"None"},{value:t.xB.Ascending,label:"Ascending"},{value:t.xB.Descending,label:"Descending"}];i.addRadio({path:"tooltip.mode",name:"Tooltip mode",category:a,defaultValue:g?.tooltip?.mode??t.$N.Single,settings:{options:c}}).addRadio({path:"tooltip.sort",name:"Values sort order",category:a,defaultValue:g?.tooltip?.sort??t.xB.None,showIf:h=>h.tooltip?.mode===t.$N.Multi,settings:{options:o}}),r&&i.addNumberInput({path:"tooltip.hoverProximity",name:"Hover proximity",description:"How close the cursor must be to a point to trigger the tooltip, in pixels",category:a,settings:{integer:!0},showIf:h=>h.tooltip?.mode!==t.$N.None}),i.addNumberInput({path:"tooltip.maxWidth",name:"Max width",category:a,settings:{integer:!0},showIf:h=>h.tooltip?.mode!==t.$N.None}).addNumberInput({path:"tooltip.maxHeight",name:"Max height",category:a,defaultValue:void 0,settings:{integer:!0},showIf:h=>h.tooltip?.mode===t.$N.Multi})}},42482:(k,R,e)=>{"use strict";e.d(R,{j:()=>t});var t={};e.r(t),e.d(t,{ScaleDistributionEditor:()=>n.W,StackingEditor:()=>a.m,addAxisConfig:()=>n.r,addHideFrom:()=>i.e,addLegendOptions:()=>s.H,addStackingConfig:()=>a.I,addTextSizeOptions:()=>g.I,addTooltipOptions:()=>r.D});var n=e(38248),i=e(11404),s=e(22680),r=e(89654),g=e(71242),a=e(56675)},49149:(k,R,e)=>{"use strict";e.d(R,{$N:()=>t.$N,Lt:()=>t.Lt,Ly:()=>t.Ly,Nj:()=>t.Nj,ON:()=>t.ON,TC:()=>t.yL,dx:()=>t.dx,gs:()=>t.gs,lm:()=>t.lm,nT:()=>t.yL,ob:()=>t.ob,on:()=>t.on,vM:()=>t.vM,yg:()=>t.GR});var t=e(52622)},74738:(k,R,e)=>{"use strict";e.d(R,{v:()=>t});function t(){return{onKeyDown(n,i,s){const r=i.value;if(r.selection.isExpanded)return s();if(n.key==="k"&&n.ctrlKey){n.preventDefault();const g=r.anchorText.text,a=r.selection.anchor.offset,o=g.length-a;return i.deleteForward(o),!0}return s()}}}},99453:(k,R,e)=>{"use strict";e.d(R,{s:()=>i});const t=(s,r,g)=>{if(!s.length)return;const a=s.slice(0,-1).join("").length+s.length-1;return s.join(`
`).slice(r,a+g)},n=s=>s?.replace(/[\uFEFF]/g,"");function i(){const s={onCopy(r,g,a){r.preventDefault();const{document:c,selection:o}=g.value,{start:{offset:h},end:{offset:f}}=o,d=c.getLeafBlocksAtRange(o).toArray().map(m=>m.text),p=n(t(d,h,f));return p&&r.clipboardData&&r.clipboardData.setData("Text",p),!0},onPaste(r,g,a){if(r.preventDefault(),r.clipboardData){const o=n(r.clipboardData.getData("Text"))?.split(`
`);if(o&&o.length){g.insertText(o[0]);for(const h of o.slice(1))g.splitBlock().insertText(h)}}return!0}};return{...s,onCut(r,g,a){return s.onCopy(r,g,a),g.deleteAtRange(g.value.selection),!0}}}},1020:(k,R,e)=>{"use strict";e.d(R,{T:()=>h});var t=e(57746),n=e(82611),i=e(75226);const s=(0,t.Sn)("mod+["),r=(0,t.Sn)("shift+tab"),g=(0,t.Sn)("mod+]"),a="  ",c=(f,d,p)=>{const{startBlock:m,endBlock:v,selection:{start:{offset:l,key:y},end:{offset:u,key:D}}}=d.value;if(i.A.serialize(d.value)==="")return;f.preventDefault();const E=m.getFirstText();E&&l===0&&y===E.key&&u===E.text.length&&D===E.key||!m.equals(v)?o(d,"right"):d.insertText(a)},o=(f,d)=>{const p=f.value.selection,m=f.value.document.getLeafBlocksAtRange(p).toArray();if(d==="left")for(const v of m){const l=v.text.length-v.text.trimLeft().length,y=v.getFirstText().key,u={anchor:{key:y,offset:l,path:[]},focus:{key:y,offset:l,path:[]}};f.deleteBackwardAtRange(n.Q6.create(u),Math.min(a.length,l))}else{const{startText:v}=f.value,l=v.text.slice(0,p.start.offset),y=/^\s*$/.test(l);for(const u of m)f.insertTextByKey(u.getFirstText().key,0,a);y&&f.moveStartBackward(a.length)}};function h(){return{onKeyDown(f,d,p){if(s(f)||r(f))f.preventDefault(),o(d,"left");else if(g(f))f.preventDefault(),o(d,"right");else if(f.key==="Tab")c(f,d,p);else return p();return!0}}}},50955:(k,R,e)=>{"use strict";e.d(R,{e1:()=>s,vJ:()=>r.v,sW:()=>g.s,TA:()=>a.T,Om:()=>c.O,Ul:()=>o.U,l9:()=>h.l,De:()=>f.D,Pz:()=>d.Pz});var t=e(62938);const n={"[":"]","{":"}","(":")"},i="brace_match";function s(){return{onKeyDown(p,m,v){const{value:l}=m;switch(p.key){case"(":case"{":case"[":{const{start:{offset:y,key:u},end:{offset:D,key:E},focus:{offset:x}}=l.selection,P=l.focusText.text;if(l.selection.isExpanded)return p.preventDefault(),m.insertTextByKey(u,y,p.key).insertTextByKey(E,D+1,n[p.key]).moveEndBackward(1),!0;if(x===P.length||P[x]===" "||Object.values(n).includes(P[x])){p.preventDefault();const b=n[p.key],M={key:`${i}-${(0,t.A)()}`,type:`${i}-${b}`,anchor:{key:u,offset:y,object:"point"},focus:{key:E,offset:D+1,object:"point"},object:"annotation"};return m.insertText(p.key).insertText(b).addAnnotation(M).moveBackward(1),!0}break}case")":case"}":case"]":{const y=l.anchorText.text,u=l.selection.anchor.offset,D=y[u],E=p.key,x=`${i}-${E}`,P=l.annotations.find(b=>b?.type===x&&b.anchor.key===l.anchorText.key);if(P&&D===E&&!l.selection.isExpanded)return p.preventDefault(),m.moveFocusForward(1).removeAnnotation(P).moveAnchorForward(1),!0;break}case"Backspace":{const y=l.anchorText.text,u=l.selection.anchor.offset,D=y[u-1],E=y[u];if(n[D]&&n[D]===E)return p.preventDefault(),m.deleteBackward(1).deleteForward(1).focus(),!0}default:break}return v()}}}var r=e(74738),g=e(99453),a=e(1020),c=e(88295),o=e(4269),h=e(31589),f=e(41781),d=e(80903)},88295:(k,R,e)=>{"use strict";e.d(R,{O:()=>n});function t(i){let s=i.length-i.trimLeft().length;if(s){let r=i[0];for(;--s;)r+=i[0];return r}return""}function n(){return{onKeyDown(i,s,r){const g=s.value;if(g.selection.isExpanded)return r();if(i.key==="Enter"){i.preventDefault();const{startBlock:a}=g,c=a.text,o=t(c);return s.splitBlock().insertText(o).focus()}return r()}}}},4269:(k,R,e)=>{"use strict";e.d(R,{U:()=>t});function t({handler:n}){return{onKeyDown(i,s,r){return n&&i.key==="Enter"&&(i.shiftKey||i.ctrlKey)?(i.preventDefault(),n(i),s):r()}}}},31589:(k,R,e)=>{"use strict";e.d(R,{l:()=>i});var t=e(57746);const n=(0,t.Sn)("mod+l");function i(){return{onKeyDown(s,r,g){if(n(s)){s.preventDefault();const{focusBlock:a,document:c}=r.value;r.moveAnchorToStartOfBlock(),c.getNextBlock(a.key)?r.moveFocusToStartOfNextBlock():r.moveFocusToEndOfText()}else return g();return!0}}}},84694:(k,R,e)=>{"use strict";e.d(R,{A:()=>n});const n="prism-token"},41781:(k,R,e)=>{"use strict";e.d(R,{D:()=>d,R:()=>l});var t=e(28848),n=e.n(t),i=e(82611),s=e(84694),r=e(74848),g=e(49568);function a(y){return y.object==="block"&&y.type==="code_block"}function c(y){return"javascript"}function o(y,u,D){const{decoration:E}=y;if(E.type!==s.A)return D();const x=E.data.get("className");return(0,r.jsx)("span",{className:x,children:y.children})}class h extends(0,g.Record)({onlyIn:a,getSyntax:c,renderDecoration:o}){constructor(u){super(u)}}const f=h;function d(y={},u=n().languages){const D=new f(y);return{decorateNode:(E,x,P)=>{if(!D.onlyIn(E))return P();const b=i.eB.create(E),M=D.getSyntax(b),O=u[M];if(!O)return[];const T=b.getTexts().map(L=>L&&L.getText()).join(`
`),C=n().tokenize(T,O),S=l(C),A=x.value.data.set("tokens",S);return x.setData(A),p(D,C,b)},renderDecoration:(E,x,P)=>D.renderDecoration({children:E.children,decoration:E.decoration},x,P)}}function p(y,u,D){const E=D.getTexts(),x=[];let P=0,b=0;return E.forEach(M=>{b=P+M.getText().length;let O=0;function I(T,C){if(typeof T=="string"){if(C){const S=m({text:M,textStart:P,textEnd:b,start:O,end:O+T.length,className:`prism-token token ${C}`,block:D});S&&x.push(S)}O+=T.length}else if(C=`${C} ${T.type}`,T.alias&&(C+=" "+T.alias),typeof T.content=="string"){const S=m({text:M,textStart:P,textEnd:b,start:O,end:O+T.content.length,className:`prism-token token ${C}`,block:D});S&&x.push(S),O+=T.content.length}else for(let S=0;S<T.content.length;S+=1)I(T.content[S],C)}u.forEach(I),P=b+1}),x}function m({text:y,textStart:u,textEnd:D,start:E,end:x,className:P,block:b}){return E>=D||x<=u?null:(E=Math.max(E,u),x=Math.min(x,D),E-=u,x-=u,b.createDecoration({object:"decoration",anchor:{key:y.key,offset:E,object:"point"},focus:{key:y.key,offset:x,object:"point"},type:s.A,data:{className:P}}))}function v(y){return typeof y=="string"?[{content:y,types:[],aliases:[]}]:Array.isArray(y)?y.flatMap(u=>v(u)):y instanceof n().Token?v(y.content).flatMap(u=>{let D=[];return typeof y.alias=="string"?D=[y.alias]:D=y.alias??[],{content:u.content,types:[y.type,...u.types],aliases:[...D,...u.aliases]}}):[]}function l(y){const u=v(y);if(!u.length)return[];const D=u[0];D.prev=null,D.next=u.length>=2?u[1]:null,D.offsets={start:0,end:D.content.length};for(let x=1;x<u.length-1;x++)u[x].prev=u[x-1],u[x].next=u[x+1],u[x].offsets={start:u[x-1].offsets.end,end:u[x-1].offsets.end+u[x].content.length};const E=u[u.length-1];return E.prev=u.length>=2?u[u.length-2]:null,E.next=null,E.offsets={start:u.length>=2?u[u.length-2].offsets.end:0,end:u.length>=2?u[u.length-2].offsets.end+E.content.length:E.content.length},u}},80903:(k,R,e)=>{"use strict";e.d(R,{Pz:()=>F});var t=e(74848),n=e(2543),i=e(32196),s=e(96540),r=e(40961),g=e(91793),a=e(60578),c=e(50774),o=e(49579);const h=U=>U.reduce((K,{items:V,label:H})=>(K.push({label:H,kind:c.I.GroupTitle}),V.reduce((Y,X)=>(Y.push(X),Y),K)),[]),f=U=>U.reduce((K,V)=>K.length<V.label.length?V.label:K,""),d=(U,K,V)=>{const H=(0,o.A)(V,{font:U.typography.fontFamilyMonospace,fontSize:U.typography.bodySmall.fontSize,fontWeight:"normal"}),Y=m(H.width,U),X=p(H.height,U),J=v(X,K);return{listWidth:Y,listHeight:J,itemHeight:X}},p=(U,K)=>{const V=K.spacing.gridSize*2;return U+V},m=(U,K)=>{const V=K.spacing.gridSize*3;return Math.min(Math.max(U+V,200),800)},v=(U,K)=>{const V=Math.min(K.length,10),H=100,Y=V*U;return Math.max(Y,H)};var l=e(36663),y=e(40845);const u=(U,K,V)=>({typeaheadItem:(0,i.css)({label:"type-ahead-item",zIndex:11,padding:U.spacing(1,1,1,2),border:U.colors.border.medium,overflowY:"scroll",overflowX:"hidden",outline:"none",background:U.colors.background.secondary,color:U.colors.text.secondary,boxShadow:`0 0 20px ${U.v1.colors.dropdownShadow}`,visibility:V===!0?"visible":"hidden",width:"250px",minHeight:`${K+parseInt(U.spacing(.25),10)}px`,position:"relative",wordBreak:"break-word"})}),D=({item:U,height:K})=>{const V=U&&!!U.documentation,H=U?U.label:"",Y=(0,l.G)(U?.documentation),X=(0,y.$j)(),J=u(X,K,V);return(0,t.jsxs)("div",{className:(0,i.cx)([J.typeaheadItem]),children:[(0,t.jsx)("b",{children:H}),(0,t.jsx)("hr",{}),(0,t.jsx)("div",{dangerouslySetInnerHTML:{__html:Y}})]})};var E=e(23257),x=e.n(E),P=e(5313);const b=U=>({typeaheadItem:(0,i.css)({border:"none",background:"none",textAlign:"left",label:"type-ahead-item",height:"auto",fontFamily:U.typography.fontFamilyMonospace,padding:U.spacing(1,1,1,2),fontSize:U.typography.bodySmall.fontSize,textOverflow:"ellipsis",overflow:"hidden",zIndex:11,display:"block",whiteSpace:"nowrap",cursor:"pointer",[U.transitions.handleMotion("no-preference","reduce")]:{transition:"color 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), border-color 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), background 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), padding 0.15s cubic-bezier(0.645, 0.045, 0.355, 1)"}}),typeaheadItemSelected:(0,i.css)({label:"type-ahead-item-selected",backgroundColor:U.colors.background.secondary}),typeaheadItemMatch:(0,i.css)({label:"type-ahead-item-match",color:U.v1.palette.yellow,borderBottom:`1px solid ${U.v1.palette.yellow}`,padding:"inherit",background:"inherit"}),typeaheadItemGroupTitle:(0,i.css)({label:"type-ahead-item-group-title",color:U.colors.text.secondary,fontSize:U.typography.bodySmall.fontSize,lineHeight:U.typography.body.lineHeight,padding:U.spacing(1)})}),M=U=>{const K=(0,y.of)(b),{isSelected:V,item:H,prefix:Y,style:X,onMouseEnter:J,onMouseLeave:q,onClickItem:ae}=U,j=V?(0,i.cx)([K.typeaheadItem,K.typeaheadItemSelected]):(0,i.cx)([K.typeaheadItem]),te=(0,i.cx)([K.typeaheadItemMatch]),ne=(0,i.cx)([K.typeaheadItemGroupTitle]),le=H.label||"";return H.kind===c.I.GroupTitle?(0,t.jsx)("li",{className:ne,style:X,children:(0,t.jsx)("span",{children:le})}):(0,t.jsx)("li",{role:"none",children:(0,t.jsx)("button",{role:"menuitem",className:j,style:X,onMouseDown:ae,onMouseEnter:J,onMouseLeave:q,type:"button",children:H.highlightParts!==void 0?(0,t.jsx)(P.z,{text:le,highlightClassName:te,highlightParts:H.highlightParts}):(0,t.jsx)(x(),{textToHighlight:le,searchWords:[Y??""],autoEscape:!0,highlightClassName:te})})})},O=(U,K)=>U-K*Math.floor(U/K);class I extends s.PureComponent{constructor(){super(...arguments),this.listRef=(0,s.createRef)(),this.state={hoveredItem:null,typeaheadIndex:null,allItems:[],listWidth:-1,listHeight:-1,itemHeight:-1},this.componentDidMount=()=>{this.props.menuRef&&this.props.menuRef(this),document.addEventListener("selectionchange",this.handleSelectionChange);const K=h(this.props.groupedItems),V=f(K),{listWidth:H,listHeight:Y,itemHeight:X}=d(this.context,K,V);this.setState({listWidth:H,listHeight:Y,itemHeight:X,allItems:K})},this.componentWillUnmount=()=>{document.removeEventListener("selectionchange",this.handleSelectionChange)},this.handleSelectionChange=()=>{this.forceUpdate()},this.componentDidUpdate=(K,V)=>{if(this.state.typeaheadIndex!==null&&V.typeaheadIndex!==this.state.typeaheadIndex&&this.listRef&&this.listRef.current){if(this.state.typeaheadIndex===1){this.listRef.current.scrollToItem(0);return}this.listRef.current.scrollToItem(this.state.typeaheadIndex)}if((0,n.isEqual)(K.groupedItems,this.props.groupedItems)===!1){const H=h(this.props.groupedItems),Y=f(H),{listWidth:X,listHeight:J,itemHeight:q}=d(this.context,H,Y);this.setState({listWidth:X,listHeight:J,itemHeight:q,allItems:H,typeaheadIndex:null})}},this.onMouseEnter=K=>{this.setState({hoveredItem:K})},this.onMouseLeave=()=>{this.setState({hoveredItem:null})},this.moveMenuIndex=K=>{const V=this.state.allItems.length;if(V){const H=this.state.typeaheadIndex||0;let Y=O(H+K,V);this.state.allItems[Y].kind===c.I.GroupTitle&&(Y=O(Y+K,V)),this.setState({typeaheadIndex:Y});return}},this.insertSuggestion=()=>{this.props.onSelectSuggestion&&this.state.typeaheadIndex!==null&&this.props.onSelectSuggestion(this.state.allItems[this.state.typeaheadIndex])}}static{this.contextType=a.D}get menuPosition(){if(!window.getSelection)return"";const K=window.getSelection(),V=K&&K.anchorNode;if(V&&V.parentElement){const H=V.parentElement.getBoundingClientRect(),Y=window.scrollX,X=window.scrollY;return`position: absolute; display: flex; top: ${H.top+X+H.height+6}px; left: ${H.left+Y-2}px`}return""}render(){const{prefix:K,isOpen:V=!1,origin:H}=this.props,{allItems:Y,listWidth:X,listHeight:J,itemHeight:q,hoveredItem:ae,typeaheadIndex:j}=this.state,te=C(this.context),ne=ae||j,le=Y[ae||j||0];return(0,t.jsxs)(T,{origin:H,isOpen:V,style:this.menuPosition,children:[(0,t.jsx)("ul",{role:"menu",className:te.typeahead,"data-testid":"typeahead",children:(0,t.jsx)(g.Y1,{ref:this.listRef,itemCount:Y.length,itemSize:q,itemKey:z=>{const ee=Y&&Y[z];return ee?`${z}-${ee.label}`:`${z}`},width:X,height:J,children:({index:z,style:ee})=>{const se=Y&&Y[z];return se?(0,t.jsx)(M,{onClickItem:()=>this.props.onSelectSuggestion?this.props.onSelectSuggestion(se):{},isSelected:j===null?!1:Y[j]===se,item:se,prefix:K,style:ee,onMouseEnter:()=>this.onMouseEnter(z),onMouseLeave:this.onMouseLeave}):null}})}),ne&&(0,t.jsx)(D,{height:J,item:le})]})}}class T extends s.PureComponent{constructor(K){super(K);const{index:V=0,origin:H="query",style:Y}=K;this.node=document.createElement("div"),this.node.setAttribute("style",Y),this.node.classList.add(`slate-typeahead-${H}-${V}`),document.body.appendChild(this.node)}componentWillUnmount(){document.body.removeChild(this.node)}render(){return this.props.isOpen?(this.node.setAttribute("style",this.props.style),this.node.classList.add("slate-typeahead--open"),r.createPortal(this.props.children,this.node)):(this.node.classList.remove("slate-typeahead--open"),null)}}const C=U=>({typeahead:(0,i.css)({position:"relative",zIndex:U.zIndex.typeahead,borderRadius:U.shape.radius.default,border:`1px solid ${U.components.panel.borderColor}`,maxHeight:"66vh",overflowY:"scroll",overflowX:"hidden",outline:"none",listStyle:"none",background:U.components.panel.background,color:U.colors.text.primary,boxShadow:U.shadows.z2,strong:{color:U.v1.palette.yellow}})});var S=e(72307),A=e(75071),L=e(84694);const N=250;function F({onTypeahead:U,cleanText:K,onWillApplySuggestion:V,portalOrigin:H}){let Y,X={groupedItems:[],typeaheadPrefix:"",typeaheadContext:"",typeaheadText:""};const J=(0,n.debounce)(w,N),q=ae=>{X={...X,...ae}};return{onBlur:(ae,j,te)=>(X={...X,groupedItems:[]},te()),onClick:(ae,j,te)=>(X={...X,groupedItems:[]},te()),onKeyDown:(ae,j,te)=>{const le=X.groupedItems.length;switch(ae.key){case"Escape":{if(le)return ae.preventDefault(),X={...X,groupedItems:[]},j.insertText("");break}case"ArrowDown":case"ArrowUp":if(le){ae.preventDefault(),Y.moveMenuIndex(ae.key==="ArrowDown"?1:-1);return}break;case"Enter":{if(!(ae.shiftKey||ae.ctrlKey)&&le)return ae.preventDefault(),Y.insertSuggestion();break}case"Tab":{if(le)return ae.preventDefault(),Y.insertSuggestion();break}default:{ae.key.length===1&&J(j,q,U,K);break}}return te()},commands:{selectSuggestion:(ae,j)=>{const te=X.groupedItems;if(!te||!te.length)return ae;const ne=ae.applyTypeahead(j);return J(ae,q,U,K),ne},applyTypeahead:(ae,j)=>{let te=j.insertText||j.label;const ne=j.kind==="function",le=j.move||0,z=le>0?le:0,ee=le<0?-le:0,{typeaheadPrefix:se,typeaheadText:ie,typeaheadContext:Z}=X;V&&(te=V(te,{groupedItems:X.groupedItems,typeaheadContext:Z,typeaheadPrefix:se,typeaheadText:ie}));const{forward:oe,backward:ce}=B(te,se,ie,ne,j.deleteBackwards,K);if(te.match(/\n/)){const ye=(0,S.dF)(te);return ae.deleteBackward(ce).deleteForward(oe).insertFragment(ye).focus(),ae}return X={...X,groupedItems:[]},ae.snapshotSelection().deleteBackward(ce).deleteForward(oe).insertText(te).moveForward(z).moveBackward(ee).focus(),ae}},renderEditor(ae,j,te){if(j.value.selection.isExpanded)return te();const ne=te();return(0,t.jsxs)(t.Fragment,{children:[ne,(0,t.jsx)(I,{menuRef:le=>Y=le,origin:H,prefix:X.typeaheadPrefix,isOpen:!!X.groupedItems.length,groupedItems:X.groupedItems,onSelectSuggestion:j.selectSuggestion})]})}}}const w=async(U,K,V,H)=>{if(!V)return;const{value:Y}=U,{selection:X}=Y,J=Y.document.getClosestBlock(Y.focusBlock.key),q=Y.selection.start.offset-1,ae=J&&J.getDecorations(U),j=ae?ae.filter(ce=>ce.start.offset<=q&&ce.end.offset>q&&ce.type===L.A).toArray():[],te=ae&&ae.filter(ce=>ce.end.offset<=q&&ce.type===L.A&&ce.data.get("className").includes("label-key")).last(),ne=te&&Y.focusText.text.slice(te.start.offset,te.end.offset),le=j.map(ce=>ce.data.get("className")).join(" ").split(" ").filter(ce=>ce.length);let z=Y.focusText.text,ee=z.slice(0,X.focus.offset);j.length&&(z=Y.focusText.text.slice(j[0].start.offset,j[0].end.offset),ee=Y.focusText.text.slice(j[0].start.offset,X.focus.offset));const se=ee.match(/(?:!?=~?"?|")(.*)/);se?ee=se[1]:H&&(ee=H(ee));const{suggestions:ie,context:Z}=await V({prefix:ee,text:z,value:Y,wrapperClasses:le,labelKey:ne||void 0,editor:U}),oe=ie.map(ce=>{if(!ce.items)return ce;const ye=ce.searchFunctionType||(ce.prefixMatch?A.T.Prefix:A.T.Word),re=A.H[ye];let ue={...ce};return ee&&(ce.skipFilter||(ue.items=ue.items.filter(De=>(De.filterText||De.label).length>=ee.length),ue.items=re(ue.items,ee)),ue.items=ue.items.filter(De=>!(De.insertText===ee||(De.filterText??De.label)===ee))),ce.skipSort||(ue.items=(0,n.sortBy)(ue.items,De=>De.sortText===void 0?De.sortValue!==void 0?De.sortValue:De.label:De.sortText||De.label)),ue}).filter(ce=>ce.items&&ce.items.length);K({groupedItems:oe,typeaheadPrefix:ee,typeaheadContext:Z,typeaheadText:z}),U.blur().focus()};function B(U,K,V,H,Y,X){const J=Y||K.length,q=X?X(V):V,ae=V.indexOf(K),j=ae>-1?q.length-ae-K.length:q.length-K.length;return{forward:!!(K&&j>0||U===V)&&!H?j+ae:0,backward:J}}},63211:(k,R,e)=>{"use strict";e.d(R,{k:()=>T});var t=e(74848),n=e(94659),i=e(40845);function s(C){return(0,n.css)({".sr-only":{position:"absolute",width:"1px",height:"1px",padding:0,margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",border:0}})}function r(C){return(0,n.css)({".alert-state-paused, .alert-state-pending":{color:C.colors.text.secondary,fontWeight:C.typography.fontWeightMedium},".alert-state-ok":{color:C.colors.success.text,fontWeight:C.typography.fontWeightMedium},".alert-state-warning":{color:C.colors.warning.text,fontWeight:C.typography.fontWeightMedium},".alert-state-critical":{color:C.colors.error.text,fontWeight:C.typography.fontWeightMedium}})}function g(C){return(0,n.css)({".panel-options-group":{borderBottom:`1px solid ${C.colors.border.weak}`},".panel-options-group__header":{padding:C.spacing(1,2,1,1),position:"relative",display:"flex",alignItems:"center",cursor:"pointer",fontWeight:500,color:C.colors.text.primary,"&:hover":{background:C.colors.emphasize(C.colors.background.primary,.03)}},".panel-options-group__icon":{color:C.colors.text.secondary,marginRight:C.spacing(1),padding:C.spacing(0,.9,0,.6)},".panel-options-group__title":{position:"relative"},".panel-options-group__body":{padding:C.spacing(1,2,1,4)}})}function a(C){return(0,n.css)({".card-section":{marginBottom:C.spacing(4)},".card-list":{display:"flex",flexDirection:"row",flexWrap:"wrap",listStyleType:"none"},".card-item":{display:"block",height:"100%",background:C.colors.background.secondary,boxShadow:"none",padding:C.spacing(2),borderRadius:"4px","&:hover":{background:C.colors.emphasize(C.colors.background.secondary,.03)},".label-tag":{marginLeft:C.spacing(1),fontSize:"11px",padding:"2px 6px"}},".card-item-body":{display:"flex",overflow:"hidden"},".card-item-details":{overflow:"hidden"},".card-item-header":{marginBottom:C.spacing(2)},".card-item-type":{color:C.colors.text.secondary,textTransform:"uppercase",fontSize:C.typography.size.sm,fontWeight:C.typography.fontWeightMedium},".card-item-badge":{margin:"6px 0"},".card-item-notice":{fontSize:C.typography.size.sm},".card-item-name":{color:C.colors.text.primary,overflow:"hidden",textOverflow:"ellipsis",width:"100%"},".card-item-label":{marginLeft:C.spacing(1)},".card-item-sub-name":{color:C.colors.text.secondary,overflow:"hidden",textOverflow:"ellipsis",width:"100%"},".card-item-sub-name--header":{color:C.colors.text.secondary,textTransform:"uppercase",marginBottom:C.spacing(2),fontSize:C.typography.size.sm,fontWeight:"bold"},".card-list-layout-grid":{".card-item-type":{display:"inline-block"},".card-item-notice":{fontSize:C.typography.size.sm,display:"inline-block",marginLeft:C.spacing(2)},".card-item-header-action":{float:"right"},".card-item-wrapper":{width:"100%",padding:C.spacing(0,2,2,0)},".card-item-wrapper--clickable":{cursor:"pointer"},".card-item-figure":{margin:C.spacing(0,2,2,0),height:"80px",img:{width:"80px"}},".card-item-name":{fontSize:C.typography.h3.fontSize},[C.breakpoints.up("md")]:{".card-item-wrapper":{width:"50%"}},[C.breakpoints.up("lg")]:{".card-item-wrapper":{width:"33.333333%"}},"&.card-list-layout-grid--max-2-col":{[C.breakpoints.up("lg")]:{".card-item-wrapper":{width:"50%"}}}},".card-list-layout-list":{".card-item-wrapper":{padding:0,width:"100%",marginBottom:C.spacing(1)},".card-item-wrapper--clickable":{cursor:"pointer"},".card-item":{borderRadius:"2px"},".card-item-header":{float:"right",textAlign:"right"},".card-item-figure":{margin:C.spacing(0,2,0,0),img:{width:"48px"}},".card-item-name":{fontSize:C.typography.h4.fontSize},".card-item-sub-name":{fontSize:C.typography.size.sm},".layout-selector":{marginRight:0}}})}function c(C){return(0,n.css)({"code, pre, kbd, samp":{...C.typography.code,fontSize:C.typography.bodySmall.fontSize,backgroundColor:C.colors.background.primary,color:C.colors.text.primary,border:`1px solid ${C.colors.border.medium}`,borderRadius:"4px"},code:{whiteSpace:"nowrap",padding:"2px 5px",margin:"0 2px"},pre:{display:"block",margin:`0 0 ${C.typography.body.lineHeight}`,lineHeight:C.typography.body.lineHeight,wordBreak:"break-all",wordWrap:"break-word",whiteSpace:"pre-wrap",overflow:"auto",padding:"10px",code:{padding:0,color:"inherit",whiteSpace:"pre-wrap",backgroundColor:"transparent",border:0}}})}function o(C){return(0,n.css)({".delta-html":{background:C.colors.background.secondary,paddingTop:"5px",paddingBottom:"5px",userSelect:"none"},".diff-line":{color:C.colors.text.primary,fontFamily:C.typography.fontFamilyMonospace,fontSize:C.typography.size.sm,lineHeight:2,marginBottom:0,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",position:"relative","&:after":{left:"-40px"}},".diff-line-number":{color:C.colors.text.secondary,display:"inline-block",fontSize:C.typography.size.xs,lineHeight:2.3,textAlign:"right",width:"30px"},".diff-line-number-hide":{visibility:"hidden"},".diff-line-icon":{color:C.colors.text.primary,fontSize:C.typography.size.xs,float:"right",position:"relative",top:"2px",right:"10px"},".diff-json-new, .diff-json-old, .diff-json-deleted, .diff-json-added":{color:C.v1.palette.gray5,".diff-line-number":{color:C.colors.text.primary}},".diff-json-new":{backgroundColor:C.isDark?"#457740":"#664e33"},".diff-json-old":{backgroundColor:C.isDark?"#a04338":"#5a372a"},".diff-json-added":{backgroundColor:C.colors.primary.shade},".diff-json-deleted":{backgroundColor:C.colors.error.shade},".diff-value":{userSelect:"all"},".diff-circle":{marginRight:"0.5em","*":{marginBottom:"1px"}},".diff-circle-changed":{color:"#f59433"},".diff-circle-added":{color:"#29d761"},".diff-circle-deleted":{color:"#fd474a"},".diff-item-added, .diff-item-deleted":{listStyle:"none"},".diff-group":{background:C.colors.background.secondary,fontSize:"16px",fontStyle:"normal",padding:"10px 15px",margin:C.spacing(2,0),".diff-group":{padding:"0 5px"}},".diff-group-name":{display:"inline-block",width:"100%",fontSize:"16px",paddingLeft:"1.75em",margin:"0 0 14px 0"},".diff-summary-key":{paddingLeft:"0.25em"},".diff-list":{paddingLeft:"40px",".diff-list":{paddingLeft:0}},".diff-item":{color:C.v1.palette.gray2,lineHeight:2.5,"> div":{display:"inline"}},".diff-item-changeset":{listStyle:"none"},".diff-label":{backgroundColor:C.colors.action.hover,borderRadius:"3px",color:C.colors.text.primary,display:"inline",fontSize:`${C.typography.fontSize}px`,margin:"0 5px",padding:"3px 8px"},".diff-linenum":{float:"right"},".diff-arrow":{color:C.colors.text.primary},".diff-block":{width:"100%",display:"inline-block"},".diff-block-title":{fontSize:"16px",display:"inline-block"},".diff-title":{fontSize:"16px"},".diff-change-container":{margin:"0 0",paddingLeft:"3em",paddingRight:0},".diff-change-group":{width:"100%",color:C.colors.text.primary,marginBottom:"14px"},".diff-change-item":{display:"inline-block"},".diff-change-title":{fontSize:"16px"},".bullet-position-container":{position:"relative",left:"-6px"},".diff-list-circle":{marginBottom:"3px"}})}var h=e(16797);function f(C){const S=window.grafanaBootData?.settings.featureToggles.bodyScrolling;return(0,n.css)({html:{MsOverflowStyle:"scrollbar",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)",height:"100%",fontSize:`${C.typography.htmlFontSize}px`,fontFamily:C.typography.fontFamily,lineHeight:C.typography.body.lineHeight,fontKerning:"normal"},":root":{colorScheme:C.colors.mode},body:{height:"100%",width:"100%",position:S?"unset":"absolute",color:C.colors.text.primary,backgroundColor:C.colors.background.canvas,...C.typography.body,...S&&{overflowY:"scroll !important",paddingRight:"0 !important","@media print":{overflow:"visible"},"@page":{margin:0,size:"auto",padding:0}}},"h1, .h1":d(C.typography.h1),"h2, .h2":d(C.typography.h2),"h3, .h3":d(C.typography.h3),"h4, .h4":d(C.typography.h4),"h5, .h5":d(C.typography.h5),"h6, .h6":d(C.typography.h6),p:{margin:C.spacing(0,0,2)},textarea:{overflow:"auto"},button:{letterSpacing:C.typography.body.letterSpacing,"&:focus-visible":(0,h.getFocusStyles)(C),"&:focus":{outline:"none"}},"small, .small":{fontSize:C.typography.bodySmall.fontSize,fontWeight:"normal"},"b, strong":{fontWeight:C.typography.fontWeightMedium},em:{fontStyle:"italic",color:C.colors.text.primary},cite:{fontStyle:"normal"},blockquote:{padding:C.spacing(0,0,0,2),margin:C.spacing(0,0,2),borderLeft:`5px solid ${C.v1.palette.gray3}`,p:{marginBottom:0,fontSize:C.typography.fontSize*1.25,fontWeight:300,lineHeight:1.25},small:{display:"block",lineHeight:C.typography.body.lineHeight,color:C.v1.palette.gray2,"&:before":{content:"'\\2014 \\00A0'"}}},"q:before, q:after, blockquote:before, blockquote:after":{content:"''"},address:{display:"block",marginBottom:C.spacing(2),fontStyle:"normal",lineHeight:C.typography.body.lineHeight},"a.external-link":{color:C.colors.text.link,textDecoration:"normal","&:hover":{color:C.colors.text.link,textDecoration:"underline"}},".link":{color:C.colors.text.primary,cursor:"pointer"},".link:hover":{color:C.colors.text.maxContrast},".pointer":{cursor:"pointer"},"audio, canvas, progress, video":{display:"inline-block",verticalAlign:"baseline"},"audio:not([controls])":{display:"none",height:0},"abbr[title]":{borderBottom:"1px dotted",cursor:"help"},dfn:{fontStyle:"italic"},"sub, sup":{fontSize:"75%",lineHeight:0,position:"relative",verticalAlign:"baseline"},sup:{top:"-0.5em"},sub:{bottom:"-0.25em"},hr:{marginTop:C.spacing(2),marginBottom:C.spacing(2),border:0,borderTop:`1px solid ${C.colors.border.medium}`},"mark, .mark":{background:C.colors.warning.main},"ul, ol":{padding:0},"ul ul, ul ol, ol ol, ol ul":{marginBottom:0},li:{lineHeight:C.typography.body.lineHeight},dl:{marginBottom:C.spacing(2)},"dt, dd":{lineHeight:C.typography.body.lineHeight},dt:{fontWeight:C.typography.fontWeightMedium},"button, input, optgroup, select, textarea":{color:"inherit",font:"inherit",margin:0},optgroup:{fontWeight:"bold"},'button, html input[type="button"], input[type="submit"]':{WebkitAppearance:"button",cursor:"pointer"},'input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration':{WebkitAppearance:"none"},table:{borderCollapse:"collapse",borderSpacing:0},th:{fontWeight:C.typography.fontWeightMedium},"td, th":{padding:0},".muted":{color:C.colors.text.secondary},"a.muted:hover, a.muted:focus":{color:C.colors.text.primary},".text-warning":{color:C.colors.warning.text,"&:hover, &:focus":{color:C.colors.emphasize(C.colors.warning.text,.15)}},".text-error":{color:C.colors.error.text,"&:hover, &:focus":{color:C.colors.emphasize(C.colors.error.text,.15)}},".text-success":{color:"$success-text-color","&:hover, &:focus":{color:C.colors.emphasize(C.colors.success.text,.15)}},a:{cursor:"pointer",color:C.colors.text.primary,textDecoration:"none","&:focus":{outline:"none"},"&:focus-visible":(0,h.getFocusStyles)(C),"&:[disabled]":{cursor:"default",pointerEvents:"none !important"}},".text-link":{textDecoration:"underline"},".text-left":{textAlign:"left"},".text-right":{textAlign:"right"},".text-center":{textAlign:"center"},".highlight-search-match":{background:C.components.textHighlight.background,color:C.components.textHighlight.text,padding:0},".template-variable":{color:C.colors.primary.text}})}function d(C){return{margin:0,fontSize:C.fontSize,lineHeight:C.lineHeight,fontWeight:C.fontWeight,letterSpacing:C.letterSpacing,fontFamily:C.fontFamily,marginBottom:"0.45em"}}function p(C){return(0,n.css)({"iframe.intercom-borderless-frame":{colorScheme:C.colors.mode}})}function m(C){return(0,n.css)({".filter-table *":{boxSizing:"border-box"},".filter-table":{width:"100%",borderCollapse:"separate",tbody:{"tr:nth-child(odd)":{background:C.colors.emphasize(C.colors.background.primary,.02)}},th:{width:"auto",padding:C.spacing(.5,1),textAlign:"left",lineHeight:"30px",height:"30px",whiteSpace:"nowrap"},td:{padding:C.spacing(.5,1),lineHeight:"30px",height:"30px",whiteSpace:"nowrap"},".link-td":{padding:0,lineHeight:"30px",height:"30px",whiteSpace:"nowrap",a:{display:"block",padding:C.spacing(0,1),height:"30px"}},".ellipsis":{display:"block",width:"100%",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},".expanded":{borderColor:C.components.panel.background},".expanded > td":{paddingBottom:0},".filter-table__avatar":{width:"25px",height:"25px",borderRadius:"50%"},"&--hover":{"tbody tr:hover":{background:C.colors.emphasize(C.colors.background.primary,.05)}}}})}function v(C){const S=typeof window<"u"&&window.__grafana_public_path__,A=S?`${S}fonts/`:"public/fonts/";return(0,n.css)([{"@font-face":{fontFamily:"Roboto Mono",fontStyle:"normal",fontWeight:400,fontDisplay:"swap",src:`url('${A}roboto/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSh0mQ.woff2') format('woff2')`,unicodeRange:"U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD"}},{"@font-face":{fontFamily:"Roboto Mono",fontStyle:"normal",fontWeight:500,fontDisplay:"swap",src:`url('${A}roboto/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSh0mQ.woff2') format('woff2')`,unicodeRange:"U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD"}},{"@font-face":{fontFamily:"Inter",fontStyle:"normal",fontWeight:400,fontDisplay:"swap",src:`url('${A}inter/Inter-Regular.woff2') format('woff2')`}},{"@font-face":{fontFamily:"Inter",fontStyle:"normal",fontWeight:500,fontDisplay:"swap",src:`url('${A}inter/Inter-Medium.woff2') format('woff2')`}}])}function l(C){return(0,n.css)({"input, button, select, textarea":{fontFamily:C.typography.body.fontFamily,fontSize:C.typography.body.fontSize,fontWeight:C.typography.body.fontWeight,lineHeight:C.typography.body.lineHeight},"input, select":{backgroundColor:C.components.input.background,color:C.components.input.text,border:"none",boxShadow:"none"},textarea:{height:"auto"},"input[type='file'], input[type='image'], input[type='submit'], input[type='reset'], input[type='button'], input[type='radio'], input[type='checkbox']":{width:"auto"}})}function y(C){return(0,n.css)({".json-formatter-row":{fontFamily:"monospace","&, a, a:hover":{color:C.colors.text.primary,textDecoration:"none"},".json-formatter-row":{marginLeft:C.spacing(2)},".json-formatter-children":{"&.json-formatter-empty":{opacity:.5,marginLeft:C.spacing(2),"&::after":{display:"none"},"&.json-formatter-object::after":{content:"'No properties'"},"&.json-formatter-array::after":{content:"'[]'"}}},".json-formatter-string":{color:C.isDark?"#23d662":"green",whiteSpace:"pre-wrap",wordWrap:"break-word",wordBreak:"break-all"},".json-formatter-number":{color:C.isDark?C.colors.primary.text:C.colors.primary.main},".json-formatter-boolean":{color:C.isDark?C.colors.primary.text:C.colors.error.main},".json-formatter-null":{color:C.isDark?"#eec97d":"#855a00"},".json-formatter-undefined":{color:C.isDark?"rgb(239, 143, 190)":"rgb(202, 11, 105)"},".json-formatter-function":{color:C.isDark?"#fd48cb":"#ff20ed"},".json-formatter-url":{textDecoration:"underline",color:C.isDark?"#027bff":C.colors.primary.main,cursor:"pointer"},".json-formatter-bracket":{color:C.isDark?"#9494ff":C.colors.primary.main},".json-formatter-key":{color:C.isDark?"#23a0db":"#00008b",cursor:"pointer",paddingRight:C.spacing(.25),marginRight:C.spacing(.5)},".json-formatter-constructor-name":{cursor:"pointer"},".json-formatter-array-comma":{marginRight:C.spacing(.5)},".json-formatter-toggler":{lineHeight:"16px",fontSize:C.typography.size.xs,verticalAlign:"middle",opacity:.6,cursor:"pointer",paddingRight:C.spacing(.25),"&::after":{display:"inline-block",transition:"transform 100ms ease-in",content:"'\u25BA'"}},"> a > .json-formatter-preview-text":{opacity:0,transition:"opacity 0.15s ease-in",fontStyle:"italic"},"&:hover > a > .json-formatter-preview-text":{opacity:.6},"&.json-formatter-open":{"> .json-formatter-toggler-link .json-formatter-toggler::after":{transform:"rotate(90deg)"},"> .json-formatter-children::after":{display:"inline-block"},"> a > .json-formatter-preview-text":{display:"none"},"&.json-formatter-empty::after":{display:"block"}}}})}function u(C){return(0,n.css)({".gf-form-select-box__control":{width:"100%",marginRight:C.spacing(.5),backgroundColor:C.components.input.background,border:`1px solid ${C.components.input.borderColor}`,borderRadius:C.shape.radius.default,color:C.components.input.text,cursor:"default",height:C.spacing(4),outline:"none",overflow:"hidden",position:"relative"},".gf-form-select-box__control--is-focused":{backgroundColor:C.components.input.background,borderColor:C.colors.primary.border,outline:"none",boxShadow:`inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 8px ${C.colors.primary.border}`},".gf-form-select-box__control--is-disabled":{backgroundColor:C.colors.action.disabledBackground},".gf-form-select-box__control--menu-right":{".gf-form-select-box__menu":{right:0,left:"unset"}},".gf-form-select-box__input":{input:{lineHeight:"inherit"}},".gf-form-select-box__menu":{background:C.colors.background.primary,boxShadow:C.shadows.z3,position:"absolute",zIndex:C.zIndex.dropdown,minWidth:"100%","&-notice--no-options":{backgroundColor:C.components.input.background,padding:"10px"}},".gf-form-select-box__menu-list":{overflowY:"auto",maxHeight:"300px",maxWidth:"600px"},".tag-filter .gf-form-select-box__menu":{width:"100%"},".gf-form-select-box__multi-value":{display:"inline",margin:"0 6px 0 0",cursor:"pointer"},".gf-form-select-box__multi-value__remove":{textAlign:"center",display:"inline-block",marginLeft:"2px",position:"relative"},".gf-form-select-box__multi-value__label":{display:"inline",verticalAlign:"middle"},".gf-form-select-box__option":{borderLeft:"2px solid transparent",whiteSpace:"nowrap",backgroundColor:C.components.input.background,"&.gf-form-select-box__option--is-focused":{color:C.colors.text.primary,background:C.colors.action.hover,borderImage:C.colors.gradients.brandVertical,borderImageSlice:1,borderStyle:"solid",borderTop:0,borderRight:0,borderBottom:0,borderLeftWidth:"2px"},"&.gf-form-select-box__option--is-selected":{".fa":{color:C.colors.text.primary}}},".gf-form-select-box__placeholder":{color:C.colors.text.disabled},".gf-form-select-box__control--is-focused .gf-form-select-box__placeholder":{display:"none"},".gf-form-select-box__value-container":{display:"inline-block",padding:"6px 20px 6px 10px",verticalAlign:"middle","> div":{display:"inline-block",verticalAlign:"middle"}},".gf-form-select-box__indicators":{position:"absolute",height:"100%",right:"8px",top:"1px",display:"inline-block",textAlign:"right"},".gf-form-input--form-dropdown":{padding:0,border:0,overflow:"visible",position:"relative"},".gf-form--has-input-icon":{".gf-form-select-box__value-container":{paddingLeft:"30px"}},".gf-form-select-box__desc-option":{display:"flex",alignItems:"center",justifyContent:"flex-start",justifyItems:"center",cursor:"pointer",padding:"7px 10px",width:"100%"},".gf-form-select-box__desc-option__body":{display:"flex",flexDirection:"column",flexGrow:1,paddingRight:"10px",fontWeight:C.typography.fontWeightMedium},".gf-form-select-box__desc-option__desc":{fontWeight:"normal",fontSize:C.typography.bodySmall.fontSize,color:C.colors.text.secondary},".gf-form-select-box__desc-option__img":{width:"16px",marginRight:"10px"},".gf-form-select-box__option-group__header":{display:"flex",alignItems:"center",justifyContent:"flex-start",justifyItems:"center",cursor:"pointer",padding:"7px 10px",width:"100%",borderBottom:`1px solid ${C.v1.palette.dark9}`,textTransform:"capitalize",".fa":{paddingRight:"2px"}},".gf-form-select-box-button-select":{height:"auto"},".select-button":{display:"flex",alignItems:"center"}})}function D(C){return(0,n.css)({".markdown-html":{img:{maxWidth:"100%"},"ul, ol":{paddingLeft:C.spacing(3),marginBottom:C.spacing(2)},table:{marginBottom:C.spacing(2),"td, th":{padding:C.spacing(.5,1)},th:{fontWeight:C.typography.fontWeightMedium,background:C.colors.background.secondary}},"table, th, td":{border:`1px solid ${C.colors.border.medium}`,borderCollapse:"collapse"},a:{color:C.colors.text.link,textDecoration:"none","&:hover":{color:C.colors.text.link,textDecoration:"underline"}},"p:last-child":{marginBottom:0},"table:last-child, ul:last-child, ol:last-child":{marginBottom:0}}})}function E(C){const S=C.breakpoints.values.xxl+C.spacing.gridSize*2+C.components.sidemenu.width,A=window.grafanaBootData?.settings.featureToggles.bodyScrolling;return(0,n.css)({".grafana-app":A?{display:"flex",flexDirection:"column",height:"100vh"}:{display:"flex",alignItems:"stretch",position:"absolute",width:"100%",height:"100%",top:0,left:0},".main-view":A?{display:"flex",flexDirection:"column",flexGrow:1,position:"relative",minWidth:0}:{position:"relative",display:"flex",flexDirection:"column",flexGrow:1,height:"100%",flex:"1 1 0",minWidth:0},".page-scrollbar-content":{display:"flex",minHeight:"100%",flexDirection:"column",width:"100%",height:"100%"},".page-container":{flexGrow:1,flexBasis:"100%",paddingLeft:C.spacing(2),paddingRight:C.spacing(2),[C.breakpoints.up("sm")]:{margin:C.spacing(0,1)},[C.breakpoints.up("md")]:{margin:C.spacing(0,2)},[`@media (min-width: ${S}px)`]:{maxWidth:`${C.breakpoints.values.xxl}px`,marginLeft:"auto",marginRight:"auto",width:"100%"}},".page-full":{marginLeft:C.spacing(2),paddingLeft:C.spacing(2),paddingRight:C.spacing(2)},".page-body":{padding:C.spacing(1),background:C.components.panel.background,border:`1px solid ${C.components.panel.borderColor}`,marginBottom:"32px",[C.breakpoints.up("md")]:{padding:C.spacing(2)},[C.breakpoints.up("lg")]:{padding:C.spacing(3)}},".page-heading":{fontSize:C.typography.h4.fontSize,marginTop:0,marginBottom:C.spacing(2)},".page-action-bar":{marginBottom:C.spacing(2),display:"flex",alignItems:"flex-start",gap:C.spacing(2)},".page-action-bar--narrow":{marginBottom:0},".page-action-bar__spacer":{width:C.spacing(2),flexGrow:1},".page-sub-heading":{marginBottom:C.spacing(2)},".page-sub-heading-icon":{marginLeft:C.spacing(1),marginTop:C.spacing(.5)},".page-hidden":{display:"none"}})}function x(C){return(0,n.css)({".query-editor-row":{marginBottom:"2px","&--disabled":{".query-keyword":{color:C.colors.text.secondary}}},".query-keyword":{fontWeight:C.typography.fontWeightMedium,color:`${C.colors.primary.text} !important`},".query-part":{backgroundColor:C.colors.background.secondary,"&:hover":{background:C.colors.emphasize(C.colors.background.secondary,.03)}},".query-segment-operator":{color:`${C.v1.palette.orange} !important`},".tight-form-func":{background:C.colors.background.secondary},'input[type="text"].tight-form-func-param':{fontSize:C.typography.bodySmall.fontSize,background:"transparent",border:"none",margin:0,padding:0},".tight-form-func-controls":{textAlign:"center",".fa-arrow-left":{float:"left",position:"relative",top:2},".fa-arrow-right":{float:"right",position:"relative",top:2},".fa-remove":{marginLeft:"10px"}}})}function P(C){return(0,n.css)({".rc-time-picker-input,.rc-time-picker-panel-input-wrap,.rc-time-picker-panel-inner":{backgroundColor:C.components.input.background,color:C.colors.text.secondary,borderColor:C.components.input.borderColor,fontSize:C.typography.body.fontSize},".rc-time-picker-input":{padding:C.spacing(0,1),height:C.spacing(4)},".rc-time-picker-panel":{width:"176px"},".rc-time-picker-panel-select":{width:"50%","&:only-child":{width:"100%"},".rc-time-picker-panel-select-option-selected":{backgroundColor:C.colors.background.secondary},"li:hover":{backgroundColor:C.colors.background.secondary}},".rc-time-picker-panel-narrow":{maxWidth:"none"}})}var b=e(72129);const M=C=>(0,n.css)({".react-loading-skeleton":b.Q});function O(C){return(0,n.css)({".slate-query-field":{fontSize:C.typography.fontSize,fontFamily:C.typography.fontFamilyMonospace,height:"auto",wordBreak:"break-word",overflow:"auto"},".slate-query-field__wrapper":{position:"relative",display:"inline-block",padding:"6px 8px",minHeight:"32px",width:"100%",color:C.colors.text.primary,backgroundColor:C.components.input.background,backgroundImage:"none",border:`1px solid ${C.components.input.borderColor}`,borderRadius:C.shape.radius.default,transition:"all 0.3s",lineHeight:"18px"},".slate-query-field__wrapper--disabled":{backgroundColor:"inherit",cursor:"not-allowed"},".slate-typeahead":{".typeahead":{position:"relative",zIndex:C.zIndex.typeahead,borderRadius:C.shape.radius.default,border:`1px solid ${C.components.panel.borderColor}`,maxHeight:"66vh",overflowY:"scroll",overflowX:"hidden",outline:"none",listStyle:"none",background:C.components.panel.background,color:C.colors.text.primary,boxShadow:C.shadows.z2},".typeahead-group__title":{color:C.colors.text.secondary,fontSize:C.typography.size.sm,lineHeight:C.typography.body.lineHeight,padding:C.spacing(1)},".typeahead-item":{height:"auto",fontFamily:C.typography.fontFamilyMonospace,padding:C.spacing(1,1,1,2),fontSize:C.typography.size.sm,textOverflow:"ellipsis",overflow:"hidden",zIndex:1,display:"block",whiteSpace:"nowrap",cursor:"pointer",transition:"color 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), border-color 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), background 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), padding 0.15s cubic-bezier(0.645, 0.045, 0.355, 1)"},".typeahead-item__selected":{backgroundColor:C.isDark?C.v1.palette.dark9:C.v1.palette.gray6,".typeahead-item-hint":{fontSize:C.typography.size.xs,color:C.colors.text.primary,whiteSpace:"normal"}},".typeahead-match":{color:C.v1.palette.yellow,borderBottom:`1px solid ${C.v1.palette.yellow}`,padding:"inherit",background:"inherit"}},".slate-query-field, .prism-syntax-highlight":{".token.comment, .token.block-comment, .token.prolog, .token.doctype, .token.cdata":{color:C.colors.text.secondary},".token.variable, .token.entity":{color:C.colors.text.primary},".token.property, .token.tag, .token.constant, .token.symbol, .token.deleted":{color:C.colors.error.text},".token.attr-value, .token.selector, .token.string, .token.char, .token.builtin, .token.inserted":{color:C.colors.success.text},".token.boolean, .token.number, .token.operator, .token.url":{color:"#fe85fc"},".token.function, .token.attr-name, .token.function-name, .token.atrule, .token.keyword, .token.class-name":{color:C.colors.primary.text},".token.punctuation, .token.regex, .token.important":{color:C.v1.palette.orange},".token.important":{fontWeight:"normal"},".token.bold":{fontWeight:"bold"},".token.italic":{fontStyle:"italic"},".token.entity":{cursor:"help"},".namespace":{opacity:.7}}})}function I(C){return(0,n.css)({".uplot":{fontFamily:"inherit"},".u-select":{background:"rgba(120, 120, 130, 0.2)"},".u-hz .u-cursor-x, .u-vt .u-cursor-y":{borderRight:"1px dashed rgba(120, 120, 130, 0.5)"},".u-hz .u-cursor-y, .u-vt .u-cursor-x":{borderBottom:"1px dashed rgba(120, 120, 130, 0.5)"},".shared-crosshair:not(.plot-active) .u-cursor-pt":{display:"none !important"}})}function T(){const C=(0,i.$j)();return(0,t.jsx)(n.Global,{styles:[s(C),g(C),r(C),c(C),o(C),f(C),p(C),m(C),v(C),l(C),y(C),a(C),D(C),E(C),x(C),P(C),M(C),O(C),I(C),u(C)]})}},40845:(k,R,e)=>{"use strict";e.d(R,{$j:()=>m,DP:()=>p,IS:()=>v,SL:()=>f,cV:()=>d,fq:()=>y,of:()=>l});var t=e(74848),n=e(4146),i=e.n(n),s=e(47078),r=e.n(s),g=e(96540),a=e(60578),c=e(3911);let o=null;const h=new WeakMap,f=u=>{const D=E=>{const x=o||a.D;return(0,t.jsx)(x.Consumer,{children:P=>(0,t.jsx)(u,{...E,theme:P.v1})})};return D.displayName=`WithTheme(${u.displayName})`,i()(D,u),D},d=u=>{const D=E=>{const x=o||a.D;return(0,t.jsx)(x.Consumer,{children:P=>(0,t.jsx)(u,{...E,theme:P})})};return D.displayName=`WithTheme(${u.displayName})`,i()(D,u),D};function p(){return(0,g.useContext)(o||a.D).v1}function m(){return(0,g.useContext)(o||a.D)}function v(u){const D=p();let E=h.get(u);return E||(E=(0,c.N)(u),h.set(u,E)),E(D)}function l(u,...D){const E=m();let x=h.get(u);return x||(x=r()(u,{maxSize:10}),h.set(u,x)),x(E,...D)}const y=u=>(o=g.createContext(u),()=>{o=null})},7918:(k,R,e)=>{"use strict";e.d(R,{kH:()=>c.k,Dx:()=>t.D,O4:()=>r,mG:()=>g,fq:()=>n.fq,YF:()=>o,N3:()=>a.N,IS:()=>n.IS,of:()=>n.of,DP:()=>n.DP,$j:()=>n.$j,SL:()=>n.SL,cV:()=>n.cV});var t=e(60578),n=e(40845),i=e(75972);let s;const r=(h="dark")=>s?s(h):(0,i.a)({colors:{mode:h}}).v1,g=h=>(s=h,()=>{s=null});var a=e(3911),c=e(63211),o=e(16797)},16797:(k,R,e)=>{"use strict";e.r(R),e.d(R,{cardChrome:()=>n,focusCss:()=>c,getFocusStyles:()=>h,getMouseFocusStyles:()=>o,getTooltipContainerStyles:()=>f,hoverColor:()=>i,listItem:()=>s,listItemSelected:()=>r,mediaUp:()=>g});var t=e(84140);function n(d){return`
    background: ${d.colors.background.secondary};
    &:hover {
      background: ${i(d.colors.background.secondary,d)};
    }
    box-shadow: ${d.components.panel.boxShadow};
    border-radius: ${d.shape.radius.default};
`}function i(d,p){return p.isDark?(0,t.A)(d).brighten(2).toString():(0,t.A)(d).darken(2).toString()}function s(d){return`
  background: ${d.colors.background.secondary};
  &:hover {
    background: ${i(d.colors.background.secondary,d)};
  }
  box-shadow: ${d.components.panel.boxShadow};
  border-radius: ${d.shape.radius.default};
`}function r(d){return`
    background: ${i(d.colors.background.secondary,d)};
    color: ${d.colors.text.maxContrast};
`}function g(d){return`only screen and (min-width: ${d})`}const a=d=>d.hasOwnProperty("v1"),c=d=>{const p=a(d),m=p?d.colors.background.canvas:d.colors.bodyBg,v=p?d.colors.primary.main:d.colors.formFocusOutline;return`
  outline: 2px dotted transparent;
  outline-offset: 2px;
  box-shadow: 0 0 0 2px ${m}, 0 0 0px 4px ${v};
  transition-property: outline, outline-offset, box-shadow;
  transition-duration: 0.2s;
  transition-timing-function: cubic-bezier(0.19, 1, 0.22, 1);`};function o(d){return{outline:"none",boxShadow:"none"}}function h(d){return{outline:"2px dotted transparent",outlineOffset:"2px",boxShadow:`0 0 0 2px ${d.colors.background.canvas}, 0 0 0px 4px ${d.colors.primary.main}`,transitionTimingFunction:"cubic-bezier(0.19, 1, 0.22, 1)",transitionDuration:"0.2s",transitionProperty:"outline, outline-offset, box-shadow"}}const f=d=>({overflow:"hidden",background:d.colors.background.secondary,boxShadow:d.shadows.z2,maxWidth:"800px",padding:d.spacing(1),borderRadius:d.shape.radius.default,zIndex:d.zIndex.tooltip})},3911:(k,R,e)=>{"use strict";e.d(R,{N:()=>i});var t=e(47078),n=e.n(t);function i(s){return n()(s)}},50774:(k,R,e)=>{"use strict";e.d(R,{I:()=>t});var t=(n=>(n.GroupTitle="GroupTitle",n))(t||{})},29621:()=>{"use strict"},4025:(k,R,e)=>{"use strict";e.d(R,{GO:()=>s,SS:()=>r,Uo:()=>t.Uo,lV:()=>g,rJ:()=>i});var t=e(8887),n=e(11261);const i=a=>["xs","sm","md","lg","xl","xxl","xxxl"].includes(a),s=()=>Object.keys(t.az);function r(a){return g(a?.type)}function g(a){if(a)switch(a){case n.PU.time:return"clock-nine";case n.PU.string:return"font";case n.PU.number:return"calculator-alt";case n.PU.boolean:return"toggle-on";case n.PU.trace:return"info-circle";case n.PU.enum:return"list-ol";case n.PU.geo:return"map-marker";case n.PU.other:return"brackets-curly"}return"question-circle"}},80186:(k,R,e)=>{"use strict";e.r(R),e.d(R,{CompletionItemKind:()=>r.I,getAvailableIcons:()=>c.GO,getFieldTypeIcon:()=>c.SS,getFieldTypeIconName:()=>c.lV,isIconSize:()=>c.rJ,toIconName:()=>c.Uo});var t=e(64611),n=e.n(t),v={};for(const l in t)l!=="default"&&(v[l]=()=>t[l]);e.d(R,v);var i=e(11866),s=e.n(i),v={};for(const l in i)l!=="default"&&(v[l]=()=>i[l]);e.d(R,v);var r=e(50774),g=e(29621),a=e.n(g),v={};for(const l in g)["default","CompletionItemKind"].indexOf(l)<0&&(v[l]=()=>g[l]);e.d(R,v);var c=e(4025),o=e(19932),h=e.n(o),v={};for(const l in o)["default","CompletionItemKind","getAvailableIcons","getFieldTypeIcon","getFieldTypeIconName","isIconSize","toIconName"].indexOf(l)<0&&(v[l]=()=>o[l]);e.d(R,v);var f=e(72389),d=e.n(f),v={};for(const l in f)["default","CompletionItemKind","getAvailableIcons","getFieldTypeIcon","getFieldTypeIconName","isIconSize","toIconName"].indexOf(l)<0&&(v[l]=()=>f[l]);e.d(R,v);var p=e(65484),m=e.n(p),v={};for(const l in p)["default","CompletionItemKind","getAvailableIcons","getFieldTypeIcon","getFieldTypeIconName","isIconSize","toIconName"].indexOf(l)<0&&(v[l]=()=>p[l]);e.d(R,v)},11866:()=>{"use strict"},65484:()=>{"use strict"},19932:()=>{"use strict"},72389:()=>{"use strict"},64611:()=>{"use strict"},40321:(k,R,e)=>{"use strict";e.d(R,{Q:()=>t});const t=(n,i)=>{n.key==="Tab"||n.altKey||n.ctrlKey||n.metaKey||(n.stopPropagation(),n.key==="Escape"&&i())}},24284:(k,R,e)=>{"use strict";e.d(R,{Ih:()=>y,Mk:()=>r,Tj:()=>f,UJ:()=>h,Xw:()=>g,ct:()=>o,mZ:()=>l,nO:()=>c,sg:()=>v,xj:()=>a});var t=e(2543),n=e.n(t),i=e(84140);const s=4,r="rgba(0, 211, 255, 1)",g="rgba(11, 237, 50, 1)",a="rgba(237, 46, 24, 1)",c="rgba(150, 150, 150, 1)",o="rgba(247, 149, 32, 1)",h=.09,f=["#7EB26D","#EAB839","#6ED0E0","#EF843C","#E24D42","#1F78C1","#BA43A9","#705DA0","#508642","#CCA300","#447EBC","#C15C17","#890F02","#0A437C","#6D1F62","#584477","#B7DBAB","#F4D598","#70DBED","#F9BA8F","#F29191","#82B5D8","#E5A8E2","#AEA2E0","#629E51","#E5AC0E","#64B0C8","#E0752D","#BF1B00","#0A50A1","#962D82","#614D93","#9AC48A","#F2C96D","#65C5DB","#F9934E","#EA6460","#5195CE","#D683CE","#806EB7","#3F6833","#967302","#2F575E","#99440A","#58140C","#052B51","#511749","#3F2B5B","#E0F9D7","#FCEACA","#CFFAFF","#F9E2D2","#FCE2DE","#BADFF4","#F9D9F9","#DEDAF7"];function d(u){const D=(0,t.map)(u,p),E=(0,t.sortBy)(D,["h"]),x=(0,t.chunk)(E,s),P=(0,t.map)(x,M=>(0,t.sortBy)(M,"l")),b=(0,t.flattenDeep)((0,t.zip)(...P));return(0,t.map)(b,m)}function p(u){return(0,i.A)(u).toHsl()}function m(u){return(0,i.A)(u).toHexString()}function v(u){return(0,i.A)(u).getBrightness()>180?"rgb(32, 34, 38)":"rgb(247, 248, 250)"}function l(u,D){const E=(0,i.A)(u),x=E.getBrightness();return E.getAlpha()<.3?D?"rgb(247, 248, 250)":"rgb(32, 34, 38)":x>180?"rgb(32, 34, 38)":"rgb(247, 248, 250)"}let y=d(f)},14555:(k,R,e)=>{"use strict";e.d(R,{F:()=>n,J:()=>t});const t=i=>i().map(s=>({label:s.title,ariaLabel:s.title,url:s.href,target:s.target,icon:`${s.target==="_blank"?"external-link-alt":"link"}`,onClick:s.onClick})),n=i=>/\/explore\?.*&(left|right)=\[(.*\,){2,}(.*){1}\]/.test(i)},40621:(k,R,e)=>{"use strict";e.d(R,{h:()=>t});function t(n,i,s){}},53550:(k,R,e)=>{"use strict";e.d(R,{i:()=>t});function t(n){const s=n.lastIndexOf("."),r=n.substring(s),g=n.substring(0,s);return g.length<16?n:`${g.substring(0,16)}...${r}`}},9830:(k,R,e)=>{"use strict";e.d(R,{I:()=>i});var t=e(2543),n=e.n(t);function i(s,r){let g=0,a=s.indexOf(r);r=r.replace(/\s/g,"");const c=[];if(a!==-1)return{distance:0,found:!0,ranges:[{start:a,end:a+r.length-1}]};for(const o of r){const h=s.indexOf(o,a);if(h===-1)return{distance:1/0,ranges:[],found:!1};if(a!==-1&&(g+=h-a),a=h+1,c.length===0)c.push({start:h,end:h});else{const f=(0,t.last)(c);h===f.end+1?f.end++:c.push({start:h,end:h})}}return{distance:g,ranges:c,found:!0}}},76412:(k,R,e)=>{"use strict";e.d(R,{t:()=>a,x:()=>r});var t=e(74848),n=e(72635),i=e(32389);function s(){typeof n.default.options.resources!="object"&&n.default.use(i.r9).init({resources:{},returnEmptyString:!1,lng:"en-US"})}const r=c=>(s(),(0,t.jsx)(i.x6,{...c})),g=n.default.t,a=(c,o,h)=>(s(),g(c,o,h))},67985:(k,R,e)=>{"use strict";e.d(R,{xj:()=>r.xj,Mk:()=>r.Mk,bk:()=>t,Pw:()=>g.Pw,nO:()=>r.nO,uc:()=>D,Xw:()=>r.Xw,ct:()=>r.ct,UJ:()=>r.UJ,zt:()=>s,yx:()=>a.yx,Tt:()=>v.T,DB:()=>l.DB,hF:()=>u.h,Vr:()=>p.Vr,Tj:()=>r.Tj,h:()=>y.h,It:()=>E.I,Yc:()=>p.Yc,kl:()=>d.k,XJ:()=>f,yC:()=>o.yC,JF:()=>o.JF,MC:()=>o.MC,mZ:()=>r.mZ,sg:()=>r.sg,K:()=>g.K,Fr:()=>c.F,Jl:()=>c.J,dF:()=>a.dF,mO:()=>a.mO,kD:()=>p.kD,RP:()=>g.RP,Ih:()=>r.Ih,CH:()=>m.C,tf:()=>g.tf});var t={};e.r(t),e.d(t,{getNextCharacter:()=>i,getPreviousCousin:()=>n}),typeof window<"u"&&"Element"in window&&!Element.prototype.closest&&(Element.prototype.closest=function(x){const P=(this.document||this.ownerDocument).querySelectorAll(x);let b=this,M;do{for(M=P.length;--M>=0&&P.item(M)!==b;);b=b.parentElement}while(M<0&&b);return b});function n(x,P){let b=x.parentElement.previousSibling,M;for(;b;){if(M=b.querySelector(P),M)return M;b=b.previousSibling}}function i(x){const P=(x||window).getSelection();if(!P||!P.anchorNode)return null;const b=P.getRangeAt(0),M=P.anchorNode.textContent,O=b.startOffset;return M.slice(O,O+1)}var s=e(67892),r=e(24284),g=e(29734),a=e(72307),c=e(14555),o=e(69613);let h=null;function f(){if(h!==null)return h;if(typeof document<"u"){const x=document.createElement("div"),P={width:"100px",height:"100px",position:"absolute",top:"-9999px",overflow:"scroll",MsOverflowStyle:"scrollbar"};Object.keys(P).map(b=>{x.style[b]=P[b]}),document.body.appendChild(x),h=x.offsetWidth-x.clientWidth,document.body.removeChild(x)}else h=0;return h||0}var d=e(90914),p=e(29413),m=e(69731),v=e(75071),l=e(88838),y=e(91040),u=e(40621),D=(x=>(x.id="id",x.title="title",x.subTitle="subTitle",x.mainStat="mainStat",x.secondaryStat="secondaryStat",x.source="source",x.target="target",x.detail="detail__",x.arc="arc__",x.color="color",x))(D||{}),E=e(9830)},87019:(k,R,e)=>{"use strict";e.d(R,{t:()=>n});var t=e(32196);const n=(0,t.keyframes)({"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(359deg)"}})},91040:(k,R,e)=>{"use strict";e.d(R,{h:()=>s});var t=e(2543),n=e.n(t);const i=(0,t.throttle)((...r)=>{console.log(...r)},500),s=r=>{let g=!1;return typeof window<"u"&&(g=window.localStorage.getItem("grafana.debug")==="true"),{logger:(a,c=!1,...o)=>{},enable:()=>g=!0,disable:()=>g=!1,isEnabled:()=>g}}},29413:(k,R,e)=>{"use strict";e.d(R,{Vr:()=>a,Yc:()=>r,kD:()=>g});let t;const n=new Map,i=500;let s="";function r(){return t||(t=document.createElement("canvas").getContext("2d")),t}function g(c,o,h=400){const f=`${h} ${o}px 'Inter'`,d=c+f,p=n.get(d);if(p)return p;const m=r();s!==f&&(m.font=s=f);const v=m.measureText(c);return n.size===i&&n.clear(),n.set(d,v),v}function a(c,o,h,f,d,p){const m=g(c,14,p),v=o/(m.width+2)*14,l=h/f,y=Math.min(l,v);return Math.min(y,d??y)}},67892:(k,R,e)=>{"use strict";e.r(R),e.d(R,{getChildId:()=>n,renderOrCallToRender:()=>i});var t=e(96540);function n(s){let r;const g=t.Children.only(s);return"id"in g?.props?r=g.props.id:"inputId"in g.props&&(r=g?.props.inputId),typeof r=="string"?r:void 0}function i(s,r){if(t.isValidElement(s)||typeof s=="string"||typeof s=="number")return s;if(typeof s=="function"&&r)return s(r);throw new Error(`${s} is not a React element nor a function that returns React element`)}},75071:(k,R,e)=>{"use strict";e.d(R,{H:()=>g,T:()=>n});var t=e(9830),n=(a=>(a.Word="Word",a.Prefix="Prefix",a.Fuzzy="Fuzzy",a))(n||{});const g={Word:(a,c)=>a.filter(o=>(o.filterText||o.label).includes(c)),Prefix:(a,c)=>a.filter(o=>(o.filterText||o.label).startsWith(c)),Fuzzy:(a,c)=>(c=c.toLowerCase(),a.filter(o=>{const{distance:h,ranges:f,found:d}=(0,t.I)(o.label.toLowerCase(),c);return d?(o.sortValue=h,o.highlightParts=f,!0):!1}))}},72129:(k,R,e)=>{"use strict";e.d(R,{Q:()=>s,j:()=>r});var t=e(74848),n=e(32196);const s={animationName:(0,n.keyframes)({"0%":{opacity:0},"100%":{opacity:1}}),animationDelay:"100ms",animationTimingFunction:"ease-in",animationDuration:"100ms",animationFillMode:"backwards"},r=(g,a)=>Object.assign(g,{Skeleton:o=>(0,t.jsx)(a,{...o,rootProps:{style:s}})})},72307:(k,R,e)=>{"use strict";e.d(R,{dF:()=>i,mO:()=>s,yx:()=>n});var t=e(82611);const n={document:{nodes:[{match:[{type:"paragraph"},{type:"code_block"},{type:"code_line"}]}]},inlines:{}},i=(r,g)=>{const a=r.split(`
`).map(o=>t.eB.create({type:"code_line",nodes:[t.EY.create(o)]})),c=t.eB.create({data:{syntax:g},type:"code_block",nodes:a});return t.yo.create({nodes:[c]})},s=(r,g)=>{const a=i(r,g);return t.WT.create({document:a})}},90914:(k,R,e)=>{"use strict";e.d(R,{k:()=>t});const t=(n,i)=>{let s;if(n.getLinks&&(s=n.getLinks({valueRowIndex:i.index})),!!s){for(let r=0;r<s?.length;r++)if(s[r].onClick){const g=s[r].onClick;s[r].onClick=a=>{a.ctrlKey||a.metaKey||a.shiftKey||(a.preventDefault(),g(a,{field:n,rowIndex:i.index}))}}return s}}},69613:(k,R,e)=>{"use strict";e.d(R,{JF:()=>i,MC:()=>s,yC:()=>r});const t=["#D32D20","#1E72B8","#B240A2","#705DA0","#466803","#497A3C","#3D71AA","#B15415","#890F02","#6E6E6E","#0A437C","#6D1F62","#584477","#4C7A3F","#2F4F4F","#BF1B00","#7662B1","#8A2EB8","#517A00","#000000","#3F6833","#2F575E","#99440A","#AE561A","#0E4AB4","#58140C","#052B51","#511749","#3F2B5B"],n=["#FF7368","#459EE7","#E069CF","#9683C6","#6C8E29","#76AC68","#6AA4E2","#E7823D","#AF3528","#9B9B9B","#3069A2","#934588","#7E6A9D","#88C477","#557575","#E54126","#A694DD","#B054DE","#8FC426","#262626","#658E59","#557D84","#BF6A30","#FF9B53","#3470DA","#7E3A32","#2B5177","#773D6F","#655181"];function i(c=""){const o=g(c.toLowerCase());return Math.abs(o%t.length)}function s(c=""){const o=i(c);return r(o)}function r(c){return{color:t[c],borderColor:n[c]}}function g(c){let o=5381;for(let h=0;h<c.length;h++)o=(o<<5)+o+c.charCodeAt(h);return o}var a={getTagColorsFromName:s}},18976:(k,R,e)=>{"use strict";e.d(R,{O:()=>n,f:()=>i});var t=e(32196);function n(s){switch(s){case"auto":return"bottom";case"auto-start":return"bottom-start";case"auto-end":return"bottom-end";default:return s??"bottom"}}function i(s,r,g,a,c){return{arrow:(0,t.css)({fill:r}),container:(0,t.css)({backgroundColor:r,borderRadius:s.shape.radius.default,border:`1px solid ${g}`,boxShadow:s.shadows.z2,color:a,fontSize:s.typography.bodySmall.fontSize,padding:s.spacing(c.topBottom,c.rightLeft),[s.transitions.handleMotion("no-preference","reduce")]:{transition:"opacity 0.3s"},zIndex:s.zIndex.tooltip,maxWidth:"400px",overflowWrap:"break-word","&[data-popper-interactive='false']":{pointerEvents:"none"}}),headerClose:(0,t.css)({color:s.colors.text.secondary,position:"absolute",right:s.spacing(1),top:s.spacing(1.5),backgroundColor:"transparent",border:0}),header:(0,t.css)({paddingTop:s.spacing(1),paddingBottom:s.spacing(2)}),body:(0,t.css)({paddingTop:s.spacing(1),paddingBottom:s.spacing(1)}),footer:(0,t.css)({paddingTop:s.spacing(2),paddingBottom:s.spacing(1)})}}},69731:(k,R,e)=>{"use strict";e.d(R,{C:()=>n});var t=e(96540);function n(){const[i,s]=(0,t.useState)(0);return(0,t.useCallback)(()=>s(r=>r+1),[])}},29734:(k,R,e)=>{"use strict";e.d(R,{K:()=>i,Pw:()=>t,RP:()=>s,tf:()=>n});var t=(r=>(r.onBlur="onBlur",r.onFocus="onFocus",r.onChange="onChange",r))(t||{});const n=(r,g)=>{const a=g.reduce((c,o)=>o.rule(r)?c:c.concat(o.errorMessage),[]);return a.length>0?a:null},i=(r,g)=>g&&g[r],s=(r,g)=>({rule:a=>!!a.match(r),errorMessage:g||"Value is not valid"})},91950:(k,R,e)=>{"use strict";e.d(R,{A:()=>i,f:()=>r});var t=e(2543),n=e.n(t);class i{constructor(a){if(this.columns=[],this.columnMap={},this.rows=[],this.type="table",a){if(a.columns)for(const c of a.columns)this.addColumn(c);if(a.rows)for(const c of a.rows)this.addRow(c)}}sort(a){a.col===null||a.col===void 0||this.columns.length<=a.col||(this.rows.sort((c,o)=>(c=c[a.col],o=o[a.col],+(c==null)-+(o==null)||+(c>o)||-(c<o))),a.desc&&this.rows.reverse(),this.columns[a.col].sort=!0,this.columns[a.col].desc=a.desc)}addColumn(a){this.columnMap[a.text]||(this.columns.push(a),this.columnMap[a.text]=a)}addRow(a){this.rows.push(a)}}function s(g,a,c){let o=!1;for(let h=0;h<g.length;h++)if(a[h]!==void 0&&c[h]!==void 0){if(a[h]!==c[h])return!1}else(a[h]===void 0||c[h]===void 0)&&(o=!0);return o}function r(g,...a){const c=g||new i;if(arguments.length===1)return c;if(arguments.length===2)return c.columns=a[0].hasOwnProperty("columns")?[...a[0].columns]:[],c.rows=a[0].hasOwnProperty("rows")?[...a[0].rows]:[],c;const o=a.filter(l=>!!l.columns),h={},f=o.slice().reduce((l,y)=>(y.columns.forEach(u=>{const{text:D}=u;h[D]===void 0&&(h[D]=l.length,l.push(u))}),l),[]),d=o.map(l=>l.columns.map(y=>h[y.text])),p=o.reduce((l,y,u)=>{const D=d[u];return y.rows.forEach(E=>{const x=[];D.forEach((P,b)=>{x[P]=E[b]}),l.push(x)}),l},[]),m={},v=p.reduce((l,y,u)=>{if(!m[u]){let D=u+1;for(;D<p.length;){const E=(0,t.findIndex)(p,x=>s(f,y,x),D);if(E>-1){const x=p[E];for(let P=0;P<f.length;P++)y[P]===void 0&&x[P]!==void 0&&(y[P]=x[P]);m[E]=x,D=E+1}else break}l.push(y)}return l},[]);return c.columns=f,c.rows=v,c}},97007:(k,R,e)=>{"use strict";e.d(R,{N:()=>n});var t=e(65307);const n=(0,t.VP)("core/cleanUpState")},82467:(k,R,e)=>{"use strict";e.d(R,{Do:()=>t.Do,Vz:()=>n.Vz,YA:()=>n.YA,dx:()=>t.dx});var t=e(16001),n=e(28215)},28138:(k,R,e)=>{"use strict";e.d(R,{A:()=>i,l:()=>n});var t=e(18226);const n=new t.o,i=n},5108:(k,R,e)=>{"use strict";e.d(R,{x:()=>B});var t=e(74848),n=e(32196),i=e(2543),s=e(96540),r=e(40845),g=e(68402),a=e(90613),c=e(94753),o=e(55852),h=e(9025),f=e(8484),d=e(27677),p=e(43907),m=e(67061),v=e(90182),l=e(25469),y=e(17172);class u extends s.Component{constructor(ae){super(ae),this.state={isLoading:!1},this.search=this.search.bind(this),this.debouncedSearch=(0,i.debounce)(this.search,300,{leading:!0,trailing:!0})}search(ae){return this.setState({isLoading:!0}),(0,i.isNil)(ae)&&(ae=""),(0,y.AI)().get("/api/serviceaccounts/search").then(j=>j.serviceAccounts.map(te=>({id:te.id,value:te.id,label:te.login,imgUrl:te.avatarUrl,login:te.login}))).finally(()=>{this.setState({isLoading:!1})})}render(){const{className:ae,onSelected:j,inputId:te}=this.props,{isLoading:ne}=this.state;return(0,t.jsx)("div",{className:"service-account-picker","data-testid":"serviceAccountPicker",children:(0,t.jsx)(v.DW,{isClearable:!0,className:ae,inputId:te,isLoading:ne,defaultOptions:!0,loadOptions:this.debouncedSearch,onChange:j,placeholder:"Start typing to search for service accounts",noOptionsMessage:"No service accounts found","aria-label":"Service Account picker"})})}}class D extends s.Component{constructor(ae){super(ae),this.state={isLoading:!1},this.search=this.search.bind(this),this.debouncedSearch=(0,i.debounce)(this.search,300,{leading:!0,trailing:!0})}componentDidMount(){const{teamId:ae}=this.props;ae&&(0,y.AI)().get(`/api/teams/${ae}`).then(j=>{this.setState({value:{value:j,label:j.name,imgUrl:j.avatarUrl}})})}search(ae){return this.setState({isLoading:!0}),(0,i.isNil)(ae)&&(ae=""),(0,y.AI)().get(`/api/teams/search?perpage=100&page=1&query=${ae}`).then(j=>{const te=j.teams.map(ne=>({value:ne,label:ne.name,imgUrl:ne.avatarUrl}));return this.setState({isLoading:!1}),te})}render(){const{onSelected:ae,className:j}=this.props,{isLoading:te,value:ne}=this.state;return(0,t.jsx)("div",{className:"user-picker","data-testid":"teamPicker",children:(0,t.jsx)(v.DW,{isLoading:te,defaultOptions:!0,loadOptions:this.debouncedSearch,value:ne,onChange:ae,className:j,placeholder:"Select a team",noOptionsMessage:"No teams found","aria-label":"Team picker"})})}}class E extends s.Component{constructor(ae){super(ae),this.state={isLoading:!1},this.search=this.search.bind(this),this.debouncedSearch=(0,i.debounce)(this.search,300,{leading:!0,trailing:!0})}search(ae){return this.setState({isLoading:!0}),(0,i.isNil)(ae)&&(ae=""),(0,y.AI)().get(`/api/org/users/lookup?query=${ae}&limit=100`).then(j=>j.map(te=>({id:te.userId,value:te.userId,label:te.login,imgUrl:te.avatarUrl,login:te.login}))).finally(()=>{this.setState({isLoading:!1})})}render(){const{className:ae,onSelected:j,inputId:te}=this.props,{isLoading:ne}=this.state;return(0,t.jsx)("div",{className:"user-picker","data-testid":"userPicker",children:(0,t.jsx)(v.DW,{isClearable:!0,className:ae,inputId:te,isLoading:ne,defaultOptions:!0,loadOptions:this.debouncedSearch,onChange:j,placeholder:"Start typing to search for user",noOptionsMessage:"No users found","aria-label":"User picker"})})}}var x=e(24897),P=(q=>(q.None="None",q.Team="Team",q.User="User",q.ServiceAccount="ServiceAccount",q.BuiltInRole="builtInRole",q))(P||{});const b=({title:q=(0,f.t)("access-control.add-permission.title","Add permission for"),permissions:ae,assignments:j,onAdd:te,onCancel:ne})=>{const[le,z]=(0,s.useState)(P.None),[ee,se]=(0,s.useState)(0),[ie,Z]=(0,s.useState)(0),[oe,ce]=(0,s.useState)(""),[ye,re]=(0,s.useState)(""),ue=(0,s.useMemo)(()=>{const ge=[];return j.users&&ge.push({value:P.User,label:(0,f.t)("access-control.add-permission.user-label","User")}),j.serviceAccounts&&ge.push({value:P.ServiceAccount,label:(0,f.t)("access-control.add-permission.serviceaccount-label","Service Account")}),j.teams&&ge.push({value:P.Team,label:(0,f.t)("access-control.add-permission.team-label","Team")}),j.builtInRoles&&ge.push({value:P.BuiltInRole,label:(0,f.t)("access-control.add-permission.role-label","Role")}),ge},[j]);(0,s.useEffect)(()=>{ae.length>0&&re(ae[0])},[ae]);const De=()=>le===P.Team&&ee>0||le===P.User&&ie>0||le===P.ServiceAccount&&ie>0||P.BuiltInRole&&x.XT.hasOwnProperty(oe);return(0,t.jsxs)("div",{className:"cta-form","aria-label":"Permissions slider",children:[(0,t.jsx)(l.J,{onClick:ne}),(0,t.jsx)("h5",{children:q}),(0,t.jsx)("form",{name:"addPermission",onSubmit:ge=>{ge.preventDefault(),te({userId:ie,teamId:ee,builtInRole:oe,permission:ye,target:le})},children:(0,t.jsxs)(m.B,{gap:1,direction:"row",children:[(0,t.jsx)(v.l6,{"aria-label":"Role to add new permission to",value:le,options:ue,onChange:ge=>z(ge.value),disabled:ue.length===0,width:"auto"}),le===P.User&&(0,t.jsx)(E,{onSelected:ge=>Z(ge?.value||0)}),le===P.ServiceAccount&&(0,t.jsx)(u,{onSelected:ge=>Z(ge?.value||0)}),le===P.Team&&(0,t.jsx)(D,{onSelected:ge=>se(ge.value?.id||0)}),le===P.BuiltInRole&&(0,t.jsx)(v.l6,{"aria-label":"Built-in role picker",options:Object.values(x.XT).filter(ge=>ge!==x.XT.None).map(ge=>({value:ge,label:ge})),onChange:ge=>ce(ge.value||""),width:"auto"}),(0,t.jsx)(v.l6,{"aria-label":"Permission Level",width:"auto",value:ae.find(ge=>ge===ye),options:ae.map(ge=>({label:ge,value:ge})),onChange:ge=>re(ge.value||"")}),(0,t.jsx)(o.$n,{type:"submit",disabled:!De(),children:(0,t.jsx)(f.x6,{i18nKey:"access-control.add-permissions.save",children:"Save"})})]})})]})};var M=e(56034),O=e(14578);const I=({item:q,permissionLevels:ae,canSet:j,onRemove:te,onChange:ne})=>{const le=(0,r.of)(L);return(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:T(q)}),(0,t.jsx)("td",{children:S(q)}),(0,t.jsx)("td",{children:q.isInherited&&(0,t.jsx)("em",{className:le.inherited,children:"Inherited from folder"})}),(0,t.jsx)("td",{children:(0,t.jsx)(v.l6,{disabled:!j||!q.isManaged,onChange:z=>ne(q,z.value),value:ae.find(z=>z===q.permission),options:ae.map(z=>({value:z,label:z}))})}),(0,t.jsx)("td",{children:q.warning?(0,t.jsx)(M.m,{content:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.a,{marginBottom:1,children:q.warning}),A(q)]}),children:(0,t.jsx)(O.I,{name:"exclamation-triangle",className:le.warning})}):(0,t.jsx)(M.m,{content:A(q),children:(0,t.jsx)(O.I,{name:"info-circle"})})}),(0,t.jsx)("td",{children:q.isManaged?(0,t.jsx)(o.$n,{size:"sm",icon:"times",variant:"destructive",disabled:!j,onClick:()=>te(q),"aria-label":`Remove permission for ${C(q)}`}):(0,t.jsx)(M.m,{content:q.isInherited?"Inherited Permission":"Provisioned Permission",children:(0,t.jsx)(o.$n,{size:"sm",icon:"lock","aria-label":"Locked permission indicator"})})})]})},T=q=>q.teamId?(0,t.jsx)("img",{className:"filter-table__avatar",src:q.teamAvatarUrl,alt:`Avatar for team ${q.teamId}`}):q.userId?(0,t.jsx)("img",{className:"filter-table__avatar",src:q.userAvatarUrl,alt:`Avatar for user ${q.userId}`}):(0,t.jsx)(O.I,{size:"xl",name:"shield"}),C=q=>q.userId?q.userLogin:q.teamId?q.team:q.builtInRole,S=q=>q.userId?(0,t.jsxs)("span",{children:[q.userLogin," "]},"name"):q.teamId?(0,t.jsxs)("span",{children:[q.team," "]},"name"):q.builtInRole?(0,t.jsxs)("span",{children:[q.builtInRole," "]},"name"):(0,t.jsx)("span",{},"name"),A=q=>`Actions: ${[...new Set(q.actions)].sort().join(" ")}`,L=q=>({warning:(0,n.css)({color:q.colors.warning.main}),inherited:(0,n.css)({color:q.colors.text.secondary,flexWrap:"nowrap"})}),N=({title:q,items:ae,compareKey:j,permissionLevels:te,canSet:ne,onRemove:le,onChange:z})=>{const ee=(0,s.useMemo)(()=>{const se={};for(let ie of ae){const Z=ie[j];if(!se[Z]){se[Z]=ie;continue}if(ie.actions.length>se[Z].actions.length){se[Z]=ie;continue}ie.actions.length===se[Z].actions.length&&!ie.isInherited&&(se[Z]=ie)}return Object.keys(se).map(ie=>se[ie])},[ae,j]);return ee.length===0?null:(0,t.jsx)("div",{children:(0,t.jsxs)("table",{className:"filter-table gf-form-group",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{style:{width:"1%"}}),(0,t.jsx)("th",{children:q}),(0,t.jsx)("th",{style:{width:"1%"}}),(0,t.jsx)("th",{style:{width:"40%"},children:(0,t.jsx)(f.x6,{i18nKey:"access-control.permission-list.permission",children:"Permission"})}),(0,t.jsx)("th",{style:{width:"1%"}}),(0,t.jsx)("th",{style:{width:"1%"}})]})}),(0,t.jsx)("tbody",{children:ee.map((se,ie)=>(0,t.jsx)(I,{item:se,onRemove:le,onChange:z,canSet:ne,permissionLevels:te},`${ie}-${se.userId}`))})]})})},F="",w={permissions:[],assignments:{teams:!1,users:!1,serviceAccounts:!1,builtInRoles:!1}},B=({title:q=(0,f.t)("access-control.permissions.title","Permissions"),buttonLabel:ae=(0,f.t)("access-control.permissions.add-label","Add a permission"),emptyLabel:j=(0,f.t)("access-control.permissions.no-permissions","There are no permissions"),resource:te,resourceId:ne,canSetPermissions:le,addPermissionTitle:z,getWarnings:ee,epilogue:se})=>{const ie=(0,r.of)(J),[Z,oe]=(0,s.useState)(!1),[ce,ye]=(0,s.useState)([]),[re,ue]=(0,s.useState)(w),De=(0,s.useCallback)(async()=>{let qe=await K(te,ne);ee&&(qe=ee(qe)),ye(qe)},[te,ne,ee]);(0,s.useEffect)(()=>{U(te).then(qe=>(ue(qe),De()))},[te,ne,De]);const ge=qe=>{let dt=null;qe.target===P.User||qe.target===P.ServiceAccount?dt=V(te,ne,qe.userId,qe.permission):qe.target===P.Team?dt=H(te,ne,qe.teamId,qe.permission):qe.target===P.BuiltInRole&&(dt=Y(te,ne,qe.builtInRole,qe.permission)),dt!==null&&dt.then(De)},Te=qe=>{let dt=null;qe.userId?dt=V(te,ne,qe.userId,F):qe.teamId?dt=H(te,ne,qe.teamId,F):qe.isServiceAccount&&qe.userId?dt=V(te,ne,qe.userId,F):qe.builtInRole&&(dt=Y(te,ne,qe.builtInRole,F)),dt!==null&&dt.then(De)},Le=(qe,dt)=>{qe.permission!==dt&&(qe.userId?ge({permission:dt,userId:qe.userId,target:P.User}):qe.isServiceAccount?ge({permission:dt,userId:qe.userId,target:P.User}):qe.teamId?ge({permission:dt,teamId:qe.teamId,target:P.Team}):qe.builtInRole&&ge({permission:dt,builtInRole:qe.builtInRole,target:P.BuiltInRole}))},Ye=(0,s.useMemo)(()=>(0,i.sortBy)(ce.filter(qe=>qe.teamId),["team","isManaged"]),[ce]),je=(0,s.useMemo)(()=>(0,i.sortBy)(ce.filter(qe=>qe.userId&&!qe.isServiceAccount),["userLogin","isManaged"]),[ce]),Ze=(0,s.useMemo)(()=>(0,i.sortBy)(ce.filter(qe=>qe.userId&&qe.isServiceAccount),["userLogin","isManaged"]),[ce]),Ne=(0,s.useMemo)(()=>(0,i.sortBy)(ce.filter(qe=>qe.builtInRole),["builtInRole","isManaged"]),[ce]),Pe=(0,f.t)("access-control.permissions.role","Role"),Ue=(0,f.t)("access-control.permissions.user","User"),$e=(0,f.t)("access-control.permissions.serviceaccount","Service Account"),ze=(0,f.t)("access-control.permissions.team","Team");return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{children:[le&&te==="folders"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(f.x6,{i18nKey:"access-control.permissions.permissions-change-warning",children:"This will change permissions for this folder and all its descendants. In total, this will affect:"}),(0,t.jsx)(p.x,{selectedItems:{folder:{[ne]:!0},dashboard:{},panel:{},$all:!1}}),(0,t.jsx)(g.$,{v:2})]}),ce.length===0&&(0,t.jsx)(a.a,{children:(0,t.jsx)(c.E,{children:j})}),(0,t.jsx)(N,{title:Pe,items:Ne,compareKey:"builtInRole",permissionLevels:re.permissions,onChange:Le,onRemove:Te,canSet:le}),(0,t.jsx)(N,{title:Ue,items:je,compareKey:"userLogin",permissionLevels:re.permissions,onChange:Le,onRemove:Te,canSet:le}),(0,t.jsx)(N,{title:$e,items:Ze,compareKey:"userLogin",permissionLevels:re.permissions,onChange:Le,onRemove:Te,canSet:le}),(0,t.jsx)(N,{title:ze,items:Ye,compareKey:"team",permissionLevels:re.permissions,onChange:Le,onRemove:Te,canSet:le}),le&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.$n,{className:ie.addPermissionButton,variant:"primary",onClick:()=>oe(!0),icon:"plus",children:ae},"add-permission"),(0,t.jsx)(h.a,{in:Z,children:(0,t.jsx)(b,{title:z,onAdd:ge,permissions:re.permissions,assignments:re.assignments,onCancel:()=>oe(!1)})})]})]}),se&&se(ce)]})},U=async q=>{try{return await(0,d.AI)().get(`/api/access-control/${q}/description`)}catch(ae){return console.error("failed to load resource description: ",ae),w}},K=(q,ae)=>(0,d.AI)().get(`/api/access-control/${q}/${ae}`),V=(q,ae,j,te)=>X(q,ae,"users",j,te),H=(q,ae,j,te)=>X(q,ae,"teams",j,te),Y=(q,ae,j,te)=>X(q,ae,"builtInRoles",j,te),X=(q,ae,j,te,ne)=>(0,d.AI)().post(`/api/access-control/${q}/${ae}/${j}/${te}`,{permission:ne}),J=q=>({breakdown:(0,n.css)({...q.typography.bodySmall,color:q.colors.text.secondary,marginBottom:q.spacing(2)}),addPermissionButton:(0,n.css)({marginBottom:q.spacing(2)})})},9025:(k,R,e)=>{"use strict";e.d(R,{a:()=>a});var t=e(74848),n=e(96540),i=e(22669);const s="200px",r=200,g={transition:`max-height ${r}ms ease-in-out`,overflow:"hidden"},a=({children:c,in:o,maxHeight:h=s,style:f=g})=>{const d=(0,n.useRef)(null),p={exited:{maxHeight:0},entering:{maxHeight:h},entered:{maxHeight:"unset",overflow:"visible"},exiting:{maxHeight:0}};return(0,t.jsx)(i.Ay,{in:o,timeout:r,nodeRef:d,children:m=>(0,t.jsx)("div",{style:{...f,...p[m]},ref:d,children:c})})}},75269:(k,R,e)=>{"use strict";e.d(R,{H:()=>i});var t=e(96540),n=e(76888);const i=t.memo(({actions:s})=>{const{chrome:r}=(0,n.Il)();return(0,t.useLayoutEffect)(()=>{r.update({actions:s})}),null});i.displayName="TopNavUpdate"},10804:(k,R,e)=>{"use strict";e.d(R,{K:()=>s});var t=e(74848),n=e(32196),i=e(40845);function s({className:g,leftActionsSeparator:a}){const c=(0,i.of)(r);return a?(0,t.jsx)("div",{className:(0,n.cx)(g,c.leftActionsSeparator)}):(0,t.jsx)("div",{className:(0,n.cx)(g,c.line)})}const r=g=>({leftActionsSeparator:(0,n.css)({display:"flex",flexGrow:1}),line:(0,n.css)({width:1,backgroundColor:g.colors.border.medium,height:24})})},57571:(k,R,e)=>{"use strict";e.d(R,{l:()=>t});const t=40},19361:(k,R,e)=>{"use strict";e.d(R,{M:()=>o});var t=e(74848),n=e(32196),i=e(23596),s=e(40845);const r=({className:h,logo:f})=>(0,t.jsx)("img",{className:h,src:`${f||"public/img/grafana_icon.svg"}`,alt:"Grafana"}),g=({className:h,children:f})=>{const d=(0,s.$j)(),p=(0,n.css)({"&:before":{content:'""',position:"fixed",left:0,right:0,bottom:0,top:0,background:`url(public/img/g8_login_${d.isDark?"dark":"light"}.svg)`,backgroundPosition:"top center",backgroundSize:"auto",backgroundRepeat:"no-repeat",opacity:0,transition:"opacity 3s ease-in-out",[d.breakpoints.up("md")]:{backgroundPosition:"center",backgroundSize:"cover"}}});return(0,t.jsx)("div",{className:(0,n.cx)(p,h),children:f})},a=({className:h})=>(0,t.jsx)("img",{className:h,src:"public/img/grafana_icon.svg",alt:"Grafana"}),c=()=>{const h=(0,s.$j)();return(0,n.css)({background:i.MV.alpha(h.colors.background.primary,.7),backgroundSize:"cover"})};class o{static{this.LoginLogo=r}static{this.LoginBackground=g}static{this.MenuLogo=a}static{this.LoginBoxBackground=c}static{this.AppTitle="Grafana"}static{this.LoginTitle="Welcome to Grafana"}static{this.HideEdition=!1}static{this.GetLoginSubTitle=()=>null}}},3984:(k,R,e)=>{"use strict";e.d(R,{Z:()=>t});function t(n,i,s){const r=[];let g=!1,a;function c(o,h=!1){if(g)return;const f=o.url?.split("?")??["",""];let d=f[0];const p=new URLSearchParams(f[1]);if(p.has("editview")&&(d+=`?editview=${p.get("editview")}`),s&&d===s.url){r.unshift({text:s.text,href:o.url??""}),g=!0;return}const m=d.length>0&&a===d;if(a=d,!o.hideFromBreadcrumbs&&!(h&&m)){const l=o.children?.findIndex(y=>y.active)??-1;if(l>0){const y=o.children?.[l];y&&r.unshift({text:y.text,href:y.url??""})}r.unshift({text:o.text,href:o.url??""})}o.parentItem&&c(o.parentItem)}return i&&c(i),c(n,!0),r}},25469:(k,R,e)=>{"use strict";e.d(R,{J:()=>r});var t=e(74848),n=e(32196),i=e(40845),s=e(29158);const r=({onClick:a,"aria-label":c,style:o})=>{const h=(0,i.of)(g);return(0,t.jsx)(s.K,{"aria-label":c??"Close",className:h,name:"times",onClick:a,style:o,tooltip:"Close"})},g=a=>(0,n.css)({position:"absolute",right:a.spacing(.5),top:a.spacing(1)})},27921:(k,R,e)=>{"use strict";e.d(R,{A:()=>n});var t=e(96540);const n=i=>(0,t.lazy)(i)},38645:(k,R,e)=>{"use strict";e.d(R,{Dd:()=>c,wi:()=>d});var t=e(74848),n=e(32196),i=e(96540),s=e(32264),r=e(40845),g=e(14578),a=e(8484);let c=()=>[{target:"_blank",id:"documentation",text:(0,a.t)("nav.help/documentation","Documentation"),icon:"document-info",url:"https://grafana.com/docs/grafana/latest/?utm_source=grafana_footer"},{target:"_blank",id:"support",text:(0,a.t)("nav.help/support","Support"),icon:"question-circle",url:"https://grafana.com/products/enterprise/?utm_source=grafana_footer"},{target:"_blank",id:"community",text:(0,a.t)("nav.help/community","Community"),icon:"comments-alt",url:"https://community.grafana.com/?utm_source=grafana_footer"}];function o(v){return{hasReleaseNotes:!0,isBeta:v.includes("-beta")}}function h(v){const{buildInfo:l,licenseInfo:y}=s.$,u=[],D=y.stateInfo?` (${y.stateInfo})`:"";if(v||u.push({target:"_blank",id:"license",text:`${l.edition}${D}`,url:y.licenseUrl}),l.hideVersion)return u;const{hasReleaseNotes:E}=o(l.version);return u.push({target:"_blank",id:"version",text:l.versionString,url:E?"https://github.com/grafana/grafana/blob/main/CHANGELOG.md":void 0}),l.hasUpdate&&u.push({target:"_blank",id:"updateVersion",text:"New version available!",icon:"download-alt",url:"https://grafana.com/grafana/download?utm_source=grafana_footer"}),u}function f(v){c=v}const d=(0,i.memo)(({customLinks:v,hideEdition:l})=>{const y=(v||c()).concat(h(l)),u=(0,r.of)(m);return(0,t.jsx)("footer",{className:u.footer,children:(0,t.jsx)("div",{className:"text-center",children:(0,t.jsx)("ul",{className:u.list,children:y.map((D,E)=>(0,t.jsx)("li",{className:u.listItem,children:(0,t.jsx)(p,{item:D})},E))})})})});d.displayName="Footer";function p({item:v}){const l=v.url?(0,t.jsx)("a",{href:v.url,target:v.target,rel:"noopener noreferrer",id:v.id,children:v.text}):v.text;return(0,t.jsxs)(t.Fragment,{children:[v.icon&&(0,t.jsx)(g.I,{name:v.icon})," ",l]})}const m=v=>({footer:(0,n.css)({...v.typography.bodySmall,color:v.colors.text.primary,display:"block",padding:v.spacing(2,0),position:"relative",width:"98%","a:hover":{color:v.colors.text.maxContrast,textDecoration:"underline"},[v.breakpoints.down("md")]:{display:"none"}}),list:(0,n.css)({listStyle:"none"}),listItem:(0,n.css)({display:"inline-block","&:after":{content:"' | '",padding:v.spacing(0,1)},"&:last-child:after":{content:"''",paddingLeft:0}})})},53153:(k,R,e)=>{"use strict";e.d(R,{S:()=>v});var t=e(74848),n=e(96540),i=e(49785),s=e(13544),r=e(32264),g=e(40845),a=e(42418),c=e(88575),o=e(67061),h=e(55852),f=e(56034),d=e(4691),p=e(78361),m=e(35043);const v=({onSubmit:l,onSkip:y,showDefaultPasswordWarning:u})=>{const D=(0,g.of)(d.$),[E,x]=(0,n.useState)(!1),[P,b]=(0,n.useState)(!0),{handleSubmit:M,register:O,getValues:I,formState:{errors:T},watch:C}=(0,i.mN)({defaultValues:{newPassword:"",confirmNew:""}}),S=C("newPassword"),A=L=>{l(L.newPassword)};return(0,t.jsxs)("form",{onSubmit:M(A),children:[u&&(0,t.jsx)(a.F,{severity:"info",title:"Continuing to use the default password exposes you to security risks."}),(0,t.jsx)(c.D,{label:"New password",invalid:!!T.newPassword,error:T?.newPassword?.message,children:(0,t.jsx)(p.s,{onFocus:()=>x(!0),...O("newPassword",{required:"New Password is required",onBlur:()=>b(!1),validate:{strongPasswordValidationRegister:m.DP}}),id:"new-password",autoFocus:!0,autoComplete:"new-password"})}),E&&(0,t.jsx)(m.zJ,{pristine:P,password:S,strongPasswordValidations:m.NQ}),(0,t.jsx)(c.D,{label:"Confirm new password",invalid:!!T.confirmNew,error:T?.confirmNew?.message,children:(0,t.jsx)(p.s,{...O("confirmNew",{required:"Confirmed Password is required",validate:L=>L===I().newPassword||"Passwords must match!"}),id:"confirm-new-password",autoComplete:"new-password"})}),(0,t.jsxs)(o.B,{direction:"column",children:[(0,t.jsx)(h.$n,{type:"submit",className:D.submitButton,children:"Submit"}),!r.$.auth.basicAuthStrongPasswordPolicy&&y&&(0,t.jsx)(f.m,{content:"If you skip you will be prompted to change password next time you log in.",placement:"bottom",children:(0,t.jsx)(h.$n,{className:D.skipButton,fill:"text",onClick:y,type:"button","data-testid":s.Tp.pages.Login.skip,children:"Skip"})})]})]})}},72235:(k,R,e)=>{"use strict";e.d(R,{l:()=>r});var t=e(74848),n=e(32196),i=e(96540),s=e(49785);function r({defaultValues:g,onSubmit:a,validateOnMount:c=!1,validateFieldsOnMount:o,children:h,validateOn:f="onSubmit",maxWidth:d=600,...p}){const{handleSubmit:m,trigger:v,formState:l,...y}=(0,s.mN)({mode:f,defaultValues:g});return(0,i.useEffect)(()=>{c&&v(o)},[v,o,c]),(0,t.jsx)("form",{className:(0,n.css)({maxWidth:d!=="none"?d+"px":d,width:"100%"}),onSubmit:m(a),...p,children:h({errors:l.errors,formState:l,trigger:v,...y})})}},30249:(k,R,e)=>{"use strict";e.d(R,{o:()=>p});var t=e(74848),n=e(96540),i=e(85200),s=e(1173),r=e(11261),g=e(90708),a=e(67266),c=e(81297),o=e(16895),h=e(40458);function f(m,v,l=[]){for(const y of l)if(typeof y=="function"){if(!y(m,v))return!1}else if(v[y]!==m[y])return!1;return!0}const d={x:i.sJ.get(s.Ct.firstTimeField).get({}),y:i.sJ.get(s.Ct.byTypes).get(new Set([r.PU.number,r.PU.enum]))};class p extends n.Component{constructor(v){super(v),this.getTimeRange=()=>this.props.timeRange;let l=this.prepState(v);l.alignedData=l.config.prepData([l.alignedFrame]),this.state=l,this.plotInstance=n.createRef()}prepState(v,l=!0){let y=null;const{frames:u,fields:D=d,preparePlotFrame:E,replaceVariables:x,dataLinkPostProcessor:P}=v,b=E??h.m,M=u.some(I=>I.fields.some(T=>(T.config.links?.length??0)>0)),O=b(u,{...D,y:M?()=>!0:D.y},v.timeRange);if((0,o.uY)("GraphNG",!1,"data aligned",O),O){let I=O;if(M){const C=Array.isArray(this.props.timeZone)?this.props.timeZone[0]:this.props.timeZone;let S=u.map((A,L)=>({...A,fields:O.fields.filter((N,F)=>F===0||N.state?.origin?.frameIndex===L),length:O.length}));S.forEach((A,L)=>{A.fields.forEach(N=>{N.getLinks=(0,g._M)(A,N,{...N.state?.scopedVars,__dataContext:{value:{data:S,field:N,frame:A,frameIndex:L}}},x,C,P)})}),I={...O,fields:O.fields.filter((A,L)=>L===0||D.y(A,O,[O]))}}let T=this.state?.config;l&&(T=v.prepConfig(I,this.props.frames,this.getTimeRange),(0,o.uY)("GraphNG",!1,"config prepared",T)),y={alignedFrame:I,config:T},(0,o.uY)("GraphNG",!1,"data prepared",y.alignedData)}return y}componentDidUpdate(v){const{frames:l,structureRev:y,timeZone:u,cursorSync:D,propsToDiff:E}=this.props,x=!f(v,this.props,E);if(l!==v.frames||x||u!==v.timeZone||D!==v.cursorSync){let P=this.prepState(this.props,!1);P&&((this.state.config===void 0||u!==v.timeZone||D!==v.cursorSync||y!==v.structureRev||!y||x)&&(P.config=this.props.prepConfig(P.alignedFrame,this.props.frames,this.getTimeRange),(0,o.uY)("GraphNG",!1,"config recreated",P.config)),P.alignedData=P.config.prepData([P.alignedFrame]),this.setState(P))}}render(){const{width:v,height:l,children:y,renderLegend:u}=this.props,{config:D,alignedFrame:E,alignedData:x}=this.state;return D?(0,t.jsx)(a.KU,{width:v,height:l,legend:u(D),children:(P,b)=>(0,t.jsx)(c.Z,{config:D,data:x,width:P,height:b,plotRef:M=>this.plotInstance.current=M,children:y?y(D,E):null})}):null}}},40458:(k,R,e)=>{"use strict";e.d(R,{m:()=>o});var t=e(11261),n=e(73060),i=e(46294);function s(h,f,d){let p,m;for(let v=0;v<f.length;v++)if(f[v]==null)m==null&&p!=null&&(m=v);else{if(m!=null&&p!=null){if(h[v]-p<d)for(;m<v;)f[m++]=void 0;m=null}p=h[v]}return f}var r=e(52622);function g(h){return h.type===t.PU.number&&h.config.custom?.drawStyle===r.GR.Bars&&!h.config.custom?.hideFrom?.viz}function a(h,f){return h.fields.find(d=>f!=null?d.name===f:d.type===t.PU.time)}function c(h,f){const d=a(h,f);let p=d?.values;for(let m=0;m<h.fields.length;m++){let v=h.fields[m];if(v===d||g(v))continue;let l=v.config.custom?.spanNulls;typeof l=="number"&&l!==-1&&p&&(v.values=s(p,v.values,l))}return h}function o(h,f,d){let p;e:for(let y of h)for(let u of y.fields)if(f.x(u,y,h)){p=u;break e}h=h.map(y=>p?.state?.nullThresholdApplied?y:(0,i.M)({frame:y,refFieldName:p.name,refFieldPseudoMin:d?.from.valueOf(),refFieldPseudoMax:d?.to.valueOf()}));let m=h.reduce((y,u)=>y+u.fields.reduce((D,E)=>D+(g(E)?1:0),0),0),v=1/0;m>1&&h.forEach(y=>{if(!y.fields.some(g))return;const u=p.values;for(let D=0;D<u.length;D++)D>0&&(v=Math.min(v,u[D]-u[D-1]))});let l=(0,n.Fd)({frames:h,joinBy:f.x,keep:f.y,keepOriginIndices:!0,keepDisplayNames:!0,nullMode:y=>{if(g(y))return n.WO;let u=y.config.custom?.spanNulls;return u===!0?n.RC:u===-1?n.WO:n.JI}});return l?(l=c(l,p.name),v!==1/0&&(l.fields.forEach((y,u)=>{let D=y.values;if(u===0){let E=D[D.length-1];D.push(E+v,E+2*v)}else g(y)?D.push(null,null):D.push(void 0,void 0)}),l.length+=2),l):null}},18759:(k,R,e)=>{"use strict";e.d(R,{T:()=>r});var t=e(74848),n=e(32196),i=e(40845),s=e(16795);function r({children:a,spacing:c,level:o}){const h=(0,i.of)(g,c,o);return(0,t.jsx)("span",{className:(0,n.css)(h.indentor),children:a})}const g=(a,c,o)=>({indentor:(0,n.css)((0,s.Y)(a,c,h=>({paddingLeft:a.spacing(h*o)})))})},61680:(k,R,e)=>{"use strict";e.d(R,{b:()=>s});var t=e(74848),n=e(96540),i=e(33390);const s=r=>{const{children:g,storageKey:a,defaultValue:c}=r,[o,h]=(0,n.useState)({value:i.A.getObject(r.storageKey,r.defaultValue)});(0,n.useEffect)(()=>{const p=m=>{m.key===a&&h({value:i.A.getObject(r.storageKey,r.defaultValue)})};return window.addEventListener("storage",p),()=>{window.removeEventListener("storage",p)}});const f=p=>{try{i.A.setObject(a,p)}catch(m){console.error(m)}h({value:p})},d=()=>{try{i.A.delete(a)}catch(p){console.log(p)}h({value:c})};return(0,t.jsx)(t.Fragment,{children:g(o.value,f,d)})}},87570:(k,R,e)=>{"use strict";e.d(R,{A:()=>c});var t=e(74848),n=e(96540),i=e(17172),s=e(2913),r=e(8484);const g=()=>!!s.Ay.oauth&&Object.keys(s.Ay.oauth).length>0;class a extends n.PureComponent{constructor(f){super(f),this.changePassword=d=>{const p={newPassword:d,confirmNew:d,oldPassword:"admin"};if(this.props.resetCode){const m={code:this.props.resetCode,newPassword:d,confirmPassword:d};(0,i.AI)().post("/api/user/password/reset",m).then(()=>{this.toGrafana()})}else(0,i.AI)().put("/api/user/password",p).then(()=>{this.toGrafana()}).catch(m=>console.error(m))},this.login=d=>{this.setState({loginErrorMessage:void 0,isLoggingIn:!0}),(0,i.AI)().post("/login",d,{showErrorAlert:!1}).then(p=>{if(this.result=p,d.password!=="admin"||s.Ay.ldapEnabled||s.Ay.authProxyEnabled){this.toGrafana();return}else this.changeView(d.password==="admin")}).catch(p=>{const m=(0,i.NF)(p)?o(p):void 0;this.setState({isLoggingIn:!1,loginErrorMessage:m||(0,r.t)("login.error.unknown","Unknown error occurred")})})},this.changeView=d=>{this.setState({isChangingPassword:!0,showDefaultPasswordWarning:d})},this.toGrafana=()=>{this.result?.redirectUrl?s.Ay.appSubUrl!==""&&!this.result.redirectUrl.startsWith(s.Ay.appSubUrl)?window.location.assign(s.Ay.appSubUrl+this.result.redirectUrl):window.location.assign(this.result.redirectUrl):window.location.assign(s.Ay.appSubUrl+"/")},this.state={isLoggingIn:!1,isChangingPassword:!1,showDefaultPasswordWarning:!1,loginErrorMessage:s.Ay.loginError}}render(){const{children:f}=this.props,{isLoggingIn:d,isChangingPassword:p,showDefaultPasswordWarning:m,loginErrorMessage:v}=this.state,{login:l,toGrafana:y,changePassword:u}=this,{loginHint:D,passwordHint:E,disableLoginForm:x,disableUserSignUp:P}=s.Ay;return(0,t.jsx)(t.Fragment,{children:f({isOauthEnabled:g(),loginHint:D,passwordHint:E,disableLoginForm:x,disableUserSignUp:P,login:l,isLoggingIn:d,changePassword:u,skipPasswordChange:y,isChangingPassword:p,showDefaultPasswordWarning:m,loginErrorMessage:v})})}}const c=a;function o(h){switch(h.data?.messageId){case"password-auth.empty":case"password-auth.failed":case"password-auth.invalid":return(0,r.t)("login.error.invalid-user-or-password","Invalid username or password");case"login-attempt.blocked":return(0,r.t)("login.error.blocked","You have exceeded the number of login attempts for this user. Please try again later.");default:return h.data?.message}}},4691:(k,R,e)=>{"use strict";e.d(R,{$:()=>p,Q:()=>d});var t=e(74848),n=e(32196),i=e(96540),s=e(49785),r=e(13544),g=e(40845),a=e(88575),c=e(10354),o=e(55852),h=e(8484),f=e(78361);const d=({children:m,onSubmit:v,isLoggingIn:l,passwordHint:y,loginHint:u})=>{const D=(0,g.of)(p),E=(0,i.useId)(),x=(0,i.useId)(),{handleSubmit:P,register:b,formState:{errors:M}}=(0,s.mN)({mode:"onChange"});return(0,t.jsx)("div",{className:D.wrapper,children:(0,t.jsxs)("form",{onSubmit:P(v),children:[(0,t.jsx)(a.D,{label:(0,h.t)("login.form.username-label","Email or username"),invalid:!!M.user,error:M.user?.message,children:(0,t.jsx)(c.p,{...b("user",{required:(0,h.t)("login.form.username-required","Email or username is required")}),id:E,autoFocus:!0,autoCapitalize:"none",placeholder:u||(0,h.t)("login.form.username-placeholder","email or username"),"data-testid":r.Tp.pages.Login.username})}),(0,t.jsx)(a.D,{label:(0,h.t)("login.form.password-label","Password"),invalid:!!M.password,error:M.password?.message,children:(0,t.jsx)(f.s,{...b("password",{required:(0,h.t)("login.form.password-required","Password is required")}),id:x,autoComplete:"current-password",placeholder:y||(0,h.t)("login.form.password-placeholder","password")})}),(0,t.jsx)(o.$n,{type:"submit","data-testid":r.Tp.pages.Login.submit,className:D.submitButton,disabled:l,children:l?(0,h.t)("login.form.submit-loading-label","Logging in..."):(0,h.t)("login.form.submit-label","Log in")}),m]})})},p=m=>({wrapper:(0,n.css)({width:"100%",paddingBottom:m.spacing(2)}),submitButton:(0,n.css)({justifyContent:"center",width:"100%"}),skipButton:(0,n.css)({alignSelf:"flex-start"})})},20851:(k,R,e)=>{"use strict";e.d(R,{GU:()=>o,YO:()=>f,qm:()=>c});var t=e(74848),n=e(32196),i=e(96540),s=e(32264),r=e(40845),g=e(19361),a=e(38645);const c=({children:d,enterAnimation:p=!0})=>{const m=(0,r.of)(f);return(0,t.jsx)("div",{className:(0,n.cx)(m.loginInnerBox,p&&m.enterAnimation),children:d})},o=({children:d,branding:p,isChangingPassword:m})=>{const v=(0,r.of)(f),[l,y]=(0,i.useState)(!1),u=p?.loginSubtitle??g.M.GetLoginSubTitle(),D=p?.loginTitle??g.M.LoginTitle,E=p?.loginBoxBackground||g.M.LoginBoxBackground(),x=p?.loginLogo,P=p?.hideEdition??g.M.HideEdition;return(0,i.useEffect)(()=>y(!0),[]),(0,t.jsxs)(g.M.LoginBackground,{className:(0,n.cx)(v.container,l&&v.loginAnim,p?.loginBackground,{[v.containerBodyScrolling]:s.$.featureToggles.bodyScrolling}),children:[(0,t.jsx)("div",{className:v.loginMain,children:(0,t.jsxs)("div",{className:(0,n.cx)(v.loginContent,E,"login-content-box"),children:[(0,t.jsxs)("div",{className:v.loginLogoWrapper,children:[(0,t.jsx)(g.M.LoginLogo,{className:v.loginLogo,logo:x}),(0,t.jsx)("div",{className:v.titleWrapper,children:m?(0,t.jsx)("h1",{className:v.mainTitle,children:"Update your password"}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h1",{className:v.mainTitle,children:D}),u&&(0,t.jsx)("h3",{className:v.subTitle,children:u})]})})]}),(0,t.jsx)("div",{className:v.loginOuterBox,children:d})]})}),p?.hideFooter?(0,t.jsx)(t.Fragment,{}):(0,t.jsx)(a.wi,{hideEdition:P,customLinks:p?.footerLinks})]})},h=(0,n.keyframes)`
from{
  opacity: 0;
  transform: translate(-60px, 0px);
}

to{
  opacity: 1;
  transform: translate(0px, 0px);
}`,f=d=>({loginMain:(0,n.css)({flexGrow:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minWidth:"100%"}),container:(0,n.css)({minHeight:"100%",backgroundPosition:"center",backgroundRepeat:"no-repeat",minWidth:"100%",marginLeft:0,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"}),containerBodyScrolling:(0,n.css)({flex:1}),loginAnim:(0,n.css)({"&:before":{opacity:1},".login-content-box":{opacity:1}}),submitButton:(0,n.css)({justifyContent:"center",width:"100%"}),loginLogo:(0,n.css)({width:"100%",maxWidth:60,marginBottom:d.spacing(2),[d.breakpoints.up("sm")]:{maxWidth:100}}),loginLogoWrapper:(0,n.css)({display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",padding:d.spacing(3)}),titleWrapper:(0,n.css)({textAlign:"center"}),mainTitle:(0,n.css)({fontSize:22,[d.breakpoints.up("sm")]:{fontSize:32}}),subTitle:(0,n.css)({fontSize:d.typography.size.md,color:d.colors.text.secondary}),loginContent:(0,n.css)({maxWidth:478,width:"calc(100% - 2rem)",display:"flex",alignItems:"stretch",flexDirection:"column",position:"relative",justifyContent:"flex-start",zIndex:1,minHeight:320,borderRadius:d.shape.radius.default,padding:d.spacing(2,0),opacity:0,[d.transitions.handleMotion("no-preference","reduce")]:{transition:"opacity 0.5s ease-in-out"},[d.breakpoints.up("sm")]:{minHeight:d.spacing(40),justifyContent:"center"}}),loginOuterBox:(0,n.css)({display:"flex",overflowY:"hidden",alignItems:"center",justifyContent:"center"}),loginInnerBox:(0,n.css)({padding:d.spacing(0,2,2,2),display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flexGrow:1,maxWidth:415,width:"100%",transform:"translate(0px, 0px)",[d.transitions.handleMotion("no-preference")]:{transition:"0.25s ease"}}),enterAnimation:(0,n.css)({[d.transitions.handleMotion("no-preference")]:{animation:`${h} ease-out 0.2s`}})})},60188:(k,R,e)=>{"use strict";e.d(R,{Q:()=>a});var t=e(74848),n=e(2543),i=e.n(n),s=e(96540),r=e(10354),g=e(88575);class a extends s.PureComponent{constructor(){super(...arguments),this.state={text:"",inputCorrected:!1},this.inputRef=s.createRef(),this.updateValue=()=>{const o=this.inputRef.current?.value;let h=!1,f="";const d=this.props.min,p=this.props.max;let m=o!==""?Number(o):void 0;m&&!Number.isNaN(m)&&(d!=null&&m<d?(f=d.toString(),h=!0):p!=null&&m>p?(f=p.toString(),h=!0):f=o??"",this.setState({text:f,inputCorrected:h})),h&&this.updateValueDebounced(),!Number.isNaN(m)&&m!==this.props.value&&this.props.onChange(m)},this.updateValueDebounced=(0,n.debounce)(this.updateValue,500),this.onChange=o=>{this.setState({text:o.currentTarget.value}),this.updateValueDebounced()},this.onKeyPress=o=>{o.key==="Enter"&&this.updateValue()}}componentDidMount(){this.setState({text:isNaN(this.props.value)?"":`${this.props.value}`})}componentDidUpdate(o){if(this.props.value!==o.value){const h=isNaN(this.props.value)?"":`${this.props.value}`;h!==this.state.text&&this.setState({text:h})}}renderInput(){return(0,t.jsx)(r.p,{type:"number",ref:this.inputRef,min:this.props.min,max:this.props.max,step:this.props.step,autoFocus:this.props.autoFocus,value:this.state.text,onChange:this.onChange,onBlur:this.updateValue,onKeyPress:this.onKeyPress,placeholder:this.props.placeholder,disabled:this.props.fieldDisabled,width:this.props.width,suffix:this.props.suffix})}render(){const{inputCorrected:o}=this.state;if(o){let h="",{min:f,max:d}=this.props;return d==null?f!=null&&(h=`< ${f}`):f!=null?h=`${f} < > ${d}`:h=`> ${d}`,(0,t.jsx)(g.D,{invalid:o,error:`Out of range ${h}`,validationMessageHorizontalOverflow:!0,style:{direction:"rtl"},children:this.renderInput()})}return this.renderInput()}}},77268:(k,R,e)=>{"use strict";e.d(R,{a:()=>a});var t=e(74848),n=e(32196),i=e(40845),s=e(83598),r=e(29158),g=e(83876);const a=({value:o,settings:h,onChange:f,details:d})=>{const p=(0,i.$j)(),m=(0,i.of)(c);return(0,t.jsx)(s.sk,{color:o??"",onChange:f,enableNamedColors:h?.enableNamedColors!==!1,children:({ref:v,showColorPicker:l,hideColorPicker:y})=>(0,t.jsxs)("div",{className:m.spot,children:[(0,t.jsx)("div",{className:m.colorPicker,children:(0,t.jsx)(g.q,{ref:v,onClick:l,onMouseLeave:y,color:o?p.visualization.getColorByName(o):p.components.input.borderColor})}),d&&(0,t.jsxs)(t.Fragment,{children:[o?(0,t.jsx)("span",{className:m.colorText,onClick:l,children:o}):(0,t.jsx)("span",{className:m.placeholderText,onClick:l,children:h?.placeholder??"Select color"}),h?.isClearable&&o&&(0,t.jsx)(r.K,{name:"times",onClick:()=>f(void 0),tooltip:"Clear settings"})]})]})})},c=o=>({spot:(0,n.css)({cursor:"pointer",color:o.colors.text.primary,background:o.components.input.background,padding:"3px",height:o.v1.spacing.formInputHeight,border:`1px solid ${o.components.input.borderColor}`,display:"flex",flexDirection:"row",alignItems:"center",alignContent:"flex-end","&:hover":{border:`1px solid ${o.components.input.borderHover}`}}),colorPicker:(0,n.css)({padding:`0 ${o.spacing(1)}`}),colorText:(0,n.css)({flexGrow:2}),placeholderText:(0,n.css)({flexGrow:2,color:o.colors.text.secondary})})},72626:(k,R,e)=>{"use strict";e.d(R,{w:()=>s});var t=e(74848),n=e(96540),i=e(60188);const s=({value:r,onChange:g,item:a})=>{const{settings:c}=a,o=(0,n.useCallback)(h=>{g(c?.integer&&h!==void 0?Math.floor(h):h)},[g,c?.integer]);return(0,t.jsx)(i.Q,{value:r,min:c?.min,max:c?.max,step:c?.step,placeholder:c?.placeholder,onChange:o})}},33919:(k,R,e)=>{"use strict";e.d(R,{H:()=>st,u:()=>Ve});var t=e(74848),n=e(69550),i=e(27310),s=e(11261),r=e(50082),g=e(15292),a=e(94354),c=e(20333),o=e(76218),h=e(96540),f=e(32196),d=e(2543),p=e(47737),m=e(60578),v=e(24284),l=e(10354),y=e(83598),u=e(29158),D=e(55852),E=e(60029),x=e(3911);const P=[{value:r.O.Absolute,label:"Absolute",description:"Pick thresholds based on the absolute values"},{value:r.O.Percentage,label:"Percentage",description:"Pick threshold based on the percent between min/max"}];class b extends h.PureComponent{constructor(Ee){super(Ee),this.onAddThreshold=()=>{const{steps:ve}=this.state;let Se=0;ve.length>1&&(Se=ve[ve.length-1].value+10);let Ie=v.Tj.filter(he=>!ve.some(Ce=>Ce.color===he))[1];Ie||(Ie="#CCCCCC");const Oe={value:Se,color:Ie,key:M++},Re=[...ve,Oe];(0,p.RU)(Re),this.setState({steps:Re},()=>{this.latestThresholdInputRef.current&&this.latestThresholdInputRef.current.focus(),this.onChange()})},this.onRemoveThreshold=ve=>{const{steps:Se}=this.state;Se.length&&ve.key!==Se[0].key&&this.setState({steps:Se.filter(Ie=>Ie.key!==ve.key)},this.onChange)},this.onChangeThresholdValue=(ve,Se)=>{const Ie=ve.target.value.replace(/,/g,"."),Oe=parseFloat(Ie),Re=isNaN(Oe)?"":Oe,he=this.state.steps.map(Ce=>(Ce.key===Se.key&&(Ce={...Ce,value:Re}),Ce));he.length&&(he[0].value=-1/0),(0,p.RU)(he),this.setState({steps:he})},this.onChangeThresholdColor=(ve,Se)=>{const{steps:Ie}=this.state,Oe=Ie.map(Re=>(Re.key===ve.key&&(Re={...Re,color:Se}),Re));this.setState({steps:Oe},this.onChange)},this.onBlur=()=>{const ve=[...this.state.steps];(0,p.RU)(ve),this.setState({steps:ve},this.onChange)},this.onChange=()=>{this.props.onChange(I(this.props.thresholds,this.state.steps))},this.onModeChanged=ve=>{this.props.onChange({...this.props.thresholds,mode:ve})};const me=O(Ee.thresholds.steps);me[0].value=-1/0,this.state={steps:me},this.latestThresholdInputRef=h.createRef()}renderInput(Ee,me,ve){const Se=this.props.thresholds.mode===r.O.Percentage,Ie=`Threshold ${ve+1}`;return isFinite(Ee.value)?(0,t.jsx)(l.p,{type:"number",step:"0.0001",onChange:Oe=>this.onChangeThresholdValue(Oe,Ee),value:Ee.value,"aria-label":Ie,ref:ve===0?this.latestThresholdInputRef:null,onBlur:this.onBlur,prefix:(0,t.jsxs)("div",{className:me.inputPrefix,children:[(0,t.jsx)("div",{className:me.colorPicker,children:(0,t.jsx)(y.sk,{color:Ee.color,onChange:Oe=>this.onChangeThresholdColor(Ee,Oe),enableNamedColors:!0})}),Se&&(0,t.jsx)("div",{className:me.percentIcon,children:"%"})]}),suffix:(0,t.jsx)(u.K,{className:me.trashIcon,name:"trash-alt",onClick:()=>this.onRemoveThreshold(Ee),tooltip:`Remove ${Ie}`})},Se.toString()):(0,t.jsx)(l.p,{type:"text",value:"Base","aria-label":Ie,disabled:!0,prefix:(0,t.jsx)("div",{className:me.colorPicker,children:(0,t.jsx)(y.sk,{color:Ee.color,onChange:Oe=>this.onChangeThresholdColor(Ee,Oe),enableNamedColors:!0})})})}render(){const{thresholds:Ee}=this.props,{steps:me}=this.state;return(0,t.jsx)(m.D.Consumer,{children:ve=>{const Se=T(ve);return(0,t.jsxs)("div",{className:Se.wrapper,children:[(0,t.jsx)(D.$n,{size:"sm",icon:"plus",onClick:()=>this.onAddThreshold(),variant:"secondary",className:Se.addButton,fullWidth:!0,children:"Add threshold"}),(0,t.jsx)("div",{className:Se.thresholds,children:me.slice(0).reverse().map((Ie,Oe)=>(0,t.jsx)("div",{className:Se.item,children:this.renderInput(Ie,Se,Oe)},`${Ie.key}`))}),(0,t.jsxs)("div",{children:[(0,t.jsx)(E.J,{description:"Percentage means thresholds relative to min & max",children:"Thresholds mode"}),(0,t.jsx)(a.z,{options:P,onChange:this.onModeChanged,value:Ee.mode})]})]})}})}}let M=100;function O(pe){return(!pe||pe.length===0)&&(pe=[{value:-1/0,color:"green"}]),pe.filter((Ee,me)=>(0,d.isNumber)(Ee.value)||me===0).map(Ee=>({color:Ee.color,value:Ee.value===null?-1/0:Ee.value,key:M++}))}function I(pe,Ee){return{mode:pe.mode??r.O.Absolute,steps:Ee.map(ve=>{const{key:Se,...Ie}=ve;return Ie})}}const T=(0,x.N)(pe=>({wrapper:(0,f.css)`
      display: flex;
      flex-direction: column;
    `,thresholds:(0,f.css)`
      display: flex;
      flex-direction: column;
      margin-bottom: ${pe.spacing(2)};
    `,item:(0,f.css)`
      margin-bottom: ${pe.spacing(1)};

      &:last-child {
        margin-bottom: 0;
      }
    `,colorPicker:(0,f.css)`
      padding: 0 ${pe.spacing(1)};
    `,addButton:(0,f.css)`
      margin-bottom: ${pe.spacing(1)};
    `,percentIcon:(0,f.css)`
      font-size: ${pe.typography.bodySmall.fontSize};
      color: ${pe.colors.text.secondary};
    `,inputPrefix:(0,f.css)`
      display: flex;
      align-items: center;
    `,trashIcon:(0,f.css)`
      color: ${pe.colors.text.secondary};
      cursor: pointer;
      margin-right: 0;

      &:hover {
        color: ${pe.colors.text};
      }
    `}));class C extends h.PureComponent{constructor(Ee){super(Ee)}render(){const{onChange:Ee}=this.props;let me=this.props.value;return me||(me={mode:r.O.Percentage,steps:[]}),(0,t.jsx)(b,{thresholds:me,onChange:Ee})}}var S=e(25019),A=e(40845),L=e(66864),N=e(14578),F=e(37390),w=e(80744),B=e(25148),U=e(91076),K=e(51986),V=e(90182);function H({mapping:pe,index:Ee,onChange:me,onRemove:ve,onDuplicate:Se,showIconPicker:Ie}){const{key:Oe,result:Re,id:he}=pe,Ce=(0,A.of)(Y),We=(0,h.useRef)(null),et=(0,h.useCallback)(ot=>{const Qe={...pe,result:{...pe.result}};ot(Qe),me(Ee,Qe)},[pe,Ee,me]);(0,h.useEffect)(()=>{We.current&&pe.isNew&&(We.current.focus(),et(ot=>{ot.isNew=!1}))},[pe,We,et]);const rt=ot=>{et(Qe=>{Qe.result.color=ot})},nt=()=>{et(ot=>{ot.result.color=void 0})},gt=ot=>{et(Qe=>{Qe.result.icon=ot})},xt=()=>{et(ot=>{ot.result.icon=void 0})},St=ot=>{et(Qe=>{Qe.key=ot.currentTarget.value})},zt=ot=>{et(Qe=>{Qe.result.text=ot.currentTarget.value})},Nt=ot=>{et(Qe=>{Qe.from=parseFloat(ot.currentTarget.value)})},Vt=ot=>{et(Qe=>{Qe.to=parseFloat(ot.currentTarget.value)})},en=ot=>{et(Qe=>{Qe.pattern=ot.currentTarget.value})},Je=ot=>{et(Qe=>{Qe.specialMatch=ot.value})},ct=[{label:"Null",value:S.W.Null,description:"Matches null and undefined values"},{label:"NaN",value:S.W.NaN,description:"Matches against Number.NaN (not a number)"},{label:"Null + NaN",value:S.W.NullAndNaN,description:"Matches null, undefined and NaN"},{label:"True",value:S.W.True,description:"Boolean true values"},{label:"False",value:S.W.False,description:"Boolean false values"},{label:"Empty",value:S.W.Empty,description:"Empty string"}];return(0,t.jsx)(U.sx,{draggableId:he,index:Ee,children:ot=>(0,t.jsxs)("tr",{className:Ce.dragRow,ref:ot.innerRef,...ot.draggableProps,children:[(0,t.jsx)("td",{children:(0,t.jsx)("div",{className:Ce.dragHandle,...ot.dragHandleProps,children:(0,t.jsx)(N.I,{name:"draggabledots",size:"lg"})})}),(0,t.jsx)("td",{className:Ce.typeColumn,children:pe.type}),(0,t.jsxs)("td",{children:[pe.type===S.d.ValueToText&&(0,t.jsx)(l.p,{ref:We,type:"text",value:Oe??"",onChange:St,placeholder:"Exact value to match"}),pe.type===S.d.RangeToText&&(0,t.jsxs)("div",{className:Ce.rangeInputWrapper,children:[(0,t.jsx)(l.p,{type:"number",value:pe.from??"",placeholder:"Range start",onChange:Nt,prefix:"From"}),(0,t.jsx)(l.p,{type:"number",value:pe.to??"",placeholder:"Range end",onChange:Vt,prefix:"To"})]}),pe.type===S.d.RegexToText&&(0,t.jsx)(l.p,{type:"text",value:pe.pattern??"",placeholder:"Regular expression",onChange:en}),pe.type===S.d.SpecialValue&&(0,t.jsx)(V.l6,{value:ct.find(Qe=>Qe.value===pe.specialMatch),options:ct,onChange:Je})]}),(0,t.jsx)("td",{children:(0,t.jsx)(l.p,{type:"text",value:Re.text??"",onChange:zt,placeholder:"Optional display text"})}),(0,t.jsxs)("td",{className:Ce.textAlignCenter,children:[Re.color&&(0,t.jsxs)(L.Gy,{spacing:"sm",justify:"center",children:[(0,t.jsx)(y.sk,{color:Re.color,onChange:rt,enableNamedColors:!0}),(0,t.jsx)(u.K,{name:"times",onClick:nt,tooltip:"Remove color",tooltipPlacement:"top"})]}),!Re.color&&(0,t.jsx)(y.sk,{color:"gray",onChange:rt,enableNamedColors:!0,children:Qe=>(0,t.jsx)(D.$n,{variant:"primary",fill:"text",onClick:Qe.showColorPicker,ref:Qe.ref,size:"sm",children:"Set color"})})]}),Ie&&(0,t.jsx)("td",{className:Ce.textAlignCenter,children:(0,t.jsxs)(L.Gy,{spacing:"sm",justify:"center",children:[(0,t.jsx)(B.n,{onChange:gt,onClear:xt,value:Re.icon,size:w.Iy.SMALL,folderName:w.Iu.Icon,mediaType:w.zu.Icon,color:Re.color}),Re.icon&&(0,t.jsx)(u.K,{name:"times",onClick:xt,tooltip:"Remove icon",tooltipPlacement:"top"})]})}),(0,t.jsx)("td",{className:Ce.textAlignCenter,children:(0,t.jsxs)(L.Gy,{spacing:"sm",children:[(0,t.jsx)(u.K,{name:"copy",onClick:()=>Se(Ee),"data-testid":"duplicate-value-mapping","aria-label":"Duplicate value mapping",tooltip:"Duplicate"}),(0,t.jsx)(u.K,{name:"trash-alt",onClick:()=>ve(Ee),"data-testid":"remove-value-mapping","aria-label":"Delete value mapping",tooltip:"Delete"})]})})]})},he)}const Y=pe=>({dragRow:(0,f.css)({position:"relative"}),dragHandle:(0,f.css)({cursor:"grab","&:focus-visible&:after":{bottom:0,content:'""',left:0,position:"absolute",right:0,top:0,outline:`2px solid ${pe.colors.primary.main}`,outlineOffset:"-2px"}}),rangeInputWrapper:(0,f.css)({display:"flex","> div:first-child":{marginRight:pe.spacing(2)}}),regexInputWrapper:(0,f.css)({display:"flex","> div:first-child":{marginRight:pe.spacing(2)}}),typeColumn:(0,f.css)({textTransform:"capitalize",textAlign:"center",width:"1%"}),textAlignCenter:(0,f.css)({textAlign:"center"})});function X({value:pe,onChange:Ee,onClose:me,showIconPicker:ve}){const Se=(0,A.of)(J),[Ie,Oe]=(0,h.useState)([]);(0,h.useEffect)(()=>{Oe(ne(pe))},[pe]);const Re=gt=>{if(!pe||!gt.destination)return;const xt=[...Ie],St=xt[gt.source.index];xt.splice(gt.source.index,1),xt.splice(gt.destination.index,0,St),Oe(xt)},he=(gt,xt)=>{const St=[...Ie];St.splice(gt,1,xt),Oe(St)},Ce=gt=>{const xt=[...Ie];xt.splice(gt,1),Oe(xt)},We=[{label:"Value",value:S.d.ValueToText,description:"Match a specific text value"},{label:"Range",value:S.d.RangeToText,description:"Match a numerical range of values"},{label:"Regex",value:S.d.RegexToText,description:"Match a regular expression with replacement"},{label:"Special",value:S.d.SpecialValue,description:"Match on null, NaN, boolean and empty values"}],et=gt=>{Oe([...Ie,ae({type:gt.value,result:{},isNew:!0})])},rt=gt=>{const xt=j(Ie[gt]),St=[...Ie];St.splice(gt,0,{...xt});for(let zt=gt;zt<Ie.length;zt++)St[zt].result.index=zt;Oe(St)},nt=()=>{Ee(te(Ie)),me()};return(0,h.useEffect)(()=>{pe?.length||et({value:S.d.ValueToText})},[]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:Se.tableWrap,children:(0,t.jsxs)("table",{className:Se.editTable,children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{style:{width:"1%"}}),(0,t.jsx)("th",{style:{width:"40%",textAlign:"left"},colSpan:2,children:"Condition"}),(0,t.jsx)("th",{style:{textAlign:"left"},children:"Display text"}),(0,t.jsx)("th",{style:{width:"10%"},children:"Color"}),ve&&(0,t.jsx)("th",{style:{width:"10%"},children:"Icon"}),(0,t.jsx)("th",{style:{width:"1%"}})]})}),(0,t.jsx)(U.JY,{onDragEnd:Re,children:(0,t.jsx)(U.gL,{droppableId:"sortable-field-mappings",direction:"vertical",children:gt=>(0,t.jsxs)("tbody",{ref:gt.innerRef,...gt.droppableProps,children:[Ie.map((xt,St)=>(0,t.jsx)(H,{mapping:xt,index:St,onChange:he,onRemove:Ce,onDuplicate:rt,showIconPicker:ve},xt.id)),gt.placeholder]})})})]})}),(0,t.jsxs)(F.a.ButtonRow,{leftItems:(0,t.jsx)(K.i,{label:"Add a new mapping",variant:"secondary",size:"md",icon:"plus",menuPlacement:"auto",minWidth:40,options:We,onChange:et}),children:[(0,t.jsx)(D.$n,{variant:"secondary",fill:"outline",onClick:me,children:"Cancel"}),(0,t.jsx)(D.$n,{variant:"primary",onClick:nt,children:"Update"})]})]})}const J=pe=>({tableWrap:(0,f.css)`
    max-height: calc(80vh - 170px);
    min-height: 40px;
    overflow: auto;
  `,editTable:(0,f.css)({width:"100%",marginBottom:pe.spacing(2),"thead th":{textAlign:"center"},"tbody tr:hover":{background:pe.colors.action.hover}," th, td":{padding:pe.spacing(1)}})});function q(){return(0,d.uniqueId)("mapping-")}function ae(pe){return{type:S.d.ValueToText,result:{},id:q(),...pe}}function j(pe){return{...ae(pe),id:q()}}function te(pe){const Ee=[],me={type:S.d.ValueToText,options:{}};return pe.forEach((ve,Se)=>{const Ie={...ve.result,index:Se};switch((!Ie.text||Ie.text.trim().length===0)&&(Ie.text=void 0),ve.type){case S.d.ValueToText:ve.key!=null&&(me.options[ve.key]=Ie);break;case S.d.RangeToText:ve.from!=null&&ve.to!=null&&Ee.push({type:ve.type,options:{from:ve.from,to:ve.to,result:Ie}});break;case S.d.RegexToText:ve.pattern!=null&&Ee.push({type:ve.type,options:{pattern:ve.pattern,result:Ie}});break;case S.d.SpecialValue:Ee.push({type:ve.type,options:{match:ve.specialMatch,result:Ie}})}}),Object.keys(me.options).length>0&&Ee.unshift(me),Ee}function ne(pe){const Ee=[];if(pe)for(const me of pe)switch(me.type){case S.d.ValueToText:for(const ve in me.options)Ee.push(ae({type:me.type,result:me.options[ve],key:ve}));break;case S.d.RangeToText:Ee.push(ae({type:me.type,result:me.options.result,from:me.options.from??0,to:me.options.to??0}));break;case S.d.RegexToText:Ee.push(ae({type:me.type,result:me.options.result,pattern:me.options.pattern}));break;case S.d.SpecialValue:Ee.push(ae({type:me.type,result:me.options.result,specialMatch:me.options.match??S.W.Null}))}return Ee.sort((me,ve)=>(me.result.index??0)>(ve.result.index??0)?1:-1),Ee}const le=(0,h.memo)(pe=>{const{value:Ee,onChange:me,item:ve}=pe,Se=(0,A.of)(z),Ie=ve.settings?.icon,[Oe,Re]=(0,h.useState)(!1),he=(0,h.useCallback)(()=>{Re(!1)},[Re]),Ce=(0,h.useMemo)(()=>ne(Ee),[Ee]),We=(0,h.useCallback)((rt,nt)=>{Ce[nt].result.color=rt,me(te(Ce))},[Ce,me]),et=(0,h.useCallback)((rt,nt)=>{Ce[nt].result.icon=rt,me(te(Ce))},[Ce,me]);return(0,t.jsxs)(L.gW,{children:[(0,t.jsx)("table",{className:Se.compactTable,children:(0,t.jsx)("tbody",{children:Ce.map((rt,nt)=>(0,t.jsxs)("tr",{children:[(0,t.jsxs)("td",{children:[rt.type===S.d.ValueToText&&rt.key,rt.type===S.d.RangeToText&&(0,t.jsxs)("span",{children:["[",rt.from," - ",rt.to,"]"]}),rt.type===S.d.RegexToText&&rt.pattern,rt.type===S.d.SpecialValue&&rt.specialMatch]}),(0,t.jsx)("td",{children:(0,t.jsx)(N.I,{name:"arrow-right"})}),(0,t.jsx)("td",{children:rt.result.text}),rt.result.color&&(0,t.jsx)("td",{children:(0,t.jsx)(y.sk,{color:rt.result.color,onChange:gt=>We(gt,nt),enableNamedColors:!0})}),Ie&&rt.result.icon&&(0,t.jsx)("td",{"data-testid":"iconPicker",children:(0,t.jsx)(B.n,{onChange:gt=>et(gt,nt),value:rt.result.icon,size:w.Iy.SMALL,folderName:w.Iu.Icon,mediaType:w.zu.Icon,color:rt.result.color})})]},nt.toString()))})}),(0,t.jsxs)(D.$n,{variant:"secondary",size:"sm",fullWidth:!0,onClick:()=>Re(!0),children:[Ce.length>0&&(0,t.jsx)("span",{children:"Edit value mappings"}),Ce.length===0&&(0,t.jsx)("span",{children:"Add value mappings"})]}),(0,t.jsx)(F.a,{isOpen:Oe,title:"Value mappings",onDismiss:he,className:Se.modal,closeOnBackdropClick:!1,children:(0,t.jsx)(X,{value:Ee,onChange:me,onClose:he,showIconPicker:Ie})})]})});le.displayName="ValueMappingsEditor";const z=pe=>({modal:(0,f.css)({width:"980px"}),compactTable:(0,f.css)({width:"100%","tbody td":{padding:pe.spacing(.5)}})});var ee=e(59429);const se=({value:pe,onChange:Ee,item:me})=>{const{placeholder:ve,isClearable:Se}=me?.settings??{},Ie=(0,h.useCallback)(Oe=>{Ee(Oe?.value?.uid)},[Ee]);return(0,t.jsx)(ee.b,{isClearable:Se,defaultOptions:!0,onChange:Ie,placeholder:ve,value:pe})};var ie=e(77268),Z=e(8066),oe=e(24293),ce=e(88575);const ye=({value:pe,onChange:Ee,item:me,id:ve})=>{const Se=(0,A.$j)(),Ie=(0,A.of)(ue),Oe=(0,Z.Hs)(pe?.mode),he=(me.settings?.byValueSupport?Z.uf.list():Z.uf.list().filter(nt=>!nt.isByValue)).filter(nt=>!nt.excludeFromPicker).map(nt=>{let gt=nt.isByValue?" (by value)":"";return{value:nt.id,label:`${nt.name}${gt}`,description:nt.description,isContinuous:nt.isContinuous,isByValue:nt.isByValue,component(){return(0,t.jsx)(re,{mode:nt,theme:Se})}}}),Ce=nt=>{Ee({...pe,mode:nt.value})},We=nt=>{Ee({...pe,mode:rt,fixedColor:nt})},et=nt=>{Ee({...pe,mode:rt,seriesBy:nt})},rt=pe?.mode??oe.Y.Thresholds;if(rt===oe.Y.Fixed||rt===oe.Y.Shades)return(0,t.jsxs)("div",{className:Ie.group,children:[(0,t.jsx)(V.l6,{minMenuHeight:200,options:he,value:rt,onChange:Ce,className:Ie.select,inputId:ve}),(0,t.jsx)(ie.a,{value:pe?.fixedColor,onChange:We})]});if(me.settings?.bySeriesSupport&&Oe.isByValue){const nt=[{label:"Last",value:"last"},{label:"Min",value:"min"},{label:"Max",value:"max"}];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{style:{marginBottom:Se.spacing(2)},children:(0,t.jsx)(V.l6,{minMenuHeight:200,options:he,value:rt,onChange:Ce,inputId:ve})}),(0,t.jsx)(ce.D,{label:"Color series by",children:(0,t.jsx)(a.z,{value:pe?.seriesBy??"last",options:nt,onChange:et})})]})}return(0,t.jsx)(V.l6,{minMenuHeight:200,options:he,value:rt,onChange:Ce,inputId:ve})},re=({mode:pe,theme:Ee})=>{if(!pe.getColors)return null;const me=pe.getColors(Ee).map(Ee.visualization.getColorByName),ve={height:"8px",width:"100%",margin:"2px 0",borderRadius:"3px",opacity:1};if(pe.isContinuous)ve.background=`linear-gradient(90deg, ${me.join(",")})`;else{let Se="",Ie="";for(let Oe=0;Oe<me.length;Oe++){const Re=me[Oe];if(Se==="")Se=`linear-gradient(90deg, ${Re} 0%`;else{const Ce=Oe/(me.length-1)*100;Se+=`, ${Ie} ${Ce}%, ${Re} ${Ce}%`}Ie=Re}ve.background=Se}return(0,t.jsx)("div",{style:ve})},ue=pe=>({group:(0,f.css)({display:"flex"}),select:(0,f.css)({marginRight:pe.spacing(1),flexGrow:1})});var De=e(91890),ge=e(64919);const Te=({value:pe,onChange:Ee,context:me})=>(0,t.jsx)(ge.e,{links:pe,onChange:Ee,data:me.data,getSuggestions:()=>me.getSuggestions?me.getSuggestions(De.uP.Values):[]});class Le extends h.PureComponent{constructor(){super(...arguments),this.state={isLoading:!0,options:[]},this.updateOptions=async()=>{const{item:Ee}=this.props,{settings:me}=Ee;let ve=Ee.settings?.options||[];me?.getOptions&&(ve=await me.getOptions(this.props.context)),this.state.options!==ve&&this.setState({isLoading:!1,options:ve})}}componentDidMount(){this.updateOptions()}componentDidUpdate(Ee){const me=Ee.item?.settings,ve=this.props.item?.settings;if(me!==ve)this.updateOptions();else if(ve?.getOptions){const Se=Ee.context?.data,Ie=this.props.context?.data;Se!==Ie&&this.updateOptions()}}render(){const{options:Ee,isLoading:me}=this.state,{value:ve,onChange:Se,item:Ie}=this.props,{settings:Oe}=Ie;return(0,t.jsx)(V.KF,{isLoading:me,value:ve,defaultValue:ve,allowCustomValue:Oe?.allowCustomValue,onChange:Re=>{Se(Re.map(he=>he.value).flatMap(he=>he!==void 0?[he]:[]))},options:Ee})}}var Ye=e(72626);class je extends h.PureComponent{constructor(){super(...arguments),this.state={isLoading:!0,options:[]},this.updateOptions=async()=>{const{item:Ee}=this.props,{settings:me}=Ee;let ve=Ee.settings?.options||[];me?.getOptions&&(ve=await me.getOptions(this.props.context)),this.state.options!==ve&&this.setState({isLoading:!1,options:ve})}}componentDidMount(){this.updateOptions()}componentDidUpdate(Ee){const me=Ee.item?.settings,ve=this.props.item?.settings;if(me!==ve)this.updateOptions();else if(ve?.getOptions){const Se=Ee.context?.data,Ie=this.props.context?.data;Se!==Ie&&this.updateOptions()}}render(){const{options:Ee,isLoading:me}=this.state,{value:ve,onChange:Se,item:Ie}=this.props,{settings:Oe}=Ie;let Re=Ee.find(he=>he.value===ve);return!Re&&ve&&(Re={label:`${ve}`,value:ve}),(0,t.jsx)(V.l6,{isLoading:me,value:Re,defaultValue:ve,allowCustomValue:Oe?.allowCustomValue,isClearable:Oe?.isClearable,onChange:he=>Se(he?.value),options:Ee})}}var Ze=e(57602),Ne=e(42734);const Pe=({value:pe,onChange:Ee,item:me,id:ve})=>(0,t.jsx)(Ne.S,{stats:pe,onChange:Ee,allowMultiple:!!me.settings?.allowMultiple,defaultStat:me.settings?.defaultStat,inputId:ve});var Ue=e(29286),$e=e(32264);class ze extends h.PureComponent{constructor(){super(...arguments),this.state={showAdd:!1},this.onRemoveString=Ee=>{const{value:me,onChange:ve}=this.props,Se=[...me];Se.splice(Ee,1),ve(Se)},this.onValueChange=(Ee,me)=>{if("key"in Ee&&Ee.key!=="Enter")return;const{value:ve,onChange:Se}=this.props,Ie=Ee.currentTarget.value.trim();if(me<0){Ie&&(Ee.currentTarget.value="",Se([...ve,Ie])),this.setState({showAdd:!1});return}if(!Ie)return this.onRemoveString(me);const Oe=[...ve];Oe[me]=Ie,Se(Oe)}}render(){const{value:Ee,item:me}=this.props,{showAdd:ve}=this.state,Se=qe($e.$.theme2),Ie=me.settings?.placeholder||"Add text";return(0,t.jsxs)("div",{children:[Ee.map((Oe,Re)=>(0,t.jsx)(l.p,{className:Se.textInput,defaultValue:Oe||"",onBlur:he=>this.onValueChange(he,Re),onKeyDown:he=>this.onValueChange(he,Re),suffix:(0,t.jsx)(N.I,{className:Se.trashIcon,name:"trash-alt",onClick:()=>this.onRemoveString(Re)})},`${Re}/${Oe}`)),ve?(0,t.jsx)(l.p,{autoFocus:!0,className:Se.textInput,placeholder:Ie,defaultValue:"",onBlur:Oe=>this.onValueChange(Oe,-1),onKeyDown:Oe=>this.onValueChange(Oe,-1),suffix:(0,t.jsx)(N.I,{name:"plus-circle"})}):(0,t.jsx)(D.$n,{icon:"plus",size:"sm",variant:"secondary",onClick:()=>this.setState({showAdd:!0}),children:Ie})]})}}const qe=(0,x.N)(pe=>({textInput:(0,f.css)({marginBottom:"5px","&:hover":{border:`1px solid ${pe.components.input.borderHover}`}}),trashIcon:(0,f.css)({color:pe.colors.text.secondary,cursor:"pointer","&:hover":{color:pe.colors.text.primary}})}));var dt=e(2056);function vt({value:pe,onChange:Ee,item:me}){const ve=(0,A.of)(yt);return me?.settings?.isClearable&&pe!=null?(0,t.jsxs)("div",{className:ve.wrapper,children:[(0,t.jsx)("span",{className:ve.first,children:(0,t.jsx)(dt.p,{value:pe,onChange:Ee})}),(0,t.jsx)(u.K,{name:"times",onClick:()=>Ee(void 0),tooltip:"Clear unit selection"})]}):(0,t.jsx)(dt.p,{value:pe,onChange:Ee})}const yt=pe=>({wrapper:(0,f.css)({width:"100%",display:"flex",flexDirection:"row",alignItems:"center"}),first:(0,f.css)({marginRight:pe.spacing(1),flexGrow:2})}),st=()=>{const pe={id:"number",name:"Number",description:"Allows numeric values input",editor:Ye.w},Ee={id:"slider",name:"Slider",description:"Allows numeric values input",editor:Ze.G},me={id:"text",name:"Text",description:"Allows string values input",editor:Ue.g},ve={id:"strings",name:"String array",description:"An array of strings",editor:ze},Se={id:"boolean",name:"Boolean",description:"Allows boolean values input",editor(Nt){const{id:Vt,...en}=Nt;return(0,t.jsx)(g.d,{...en,onChange:Je=>Nt.onChange(Je.currentTarget.checked)})}},Ie={id:"select",name:"Select",description:"Allows option selection",editor:je},Oe={id:"multi-select",name:"Multi select",description:"Allows for multiple option selection",editor:Le},Re={id:"radio",name:"Radio",description:"Allows option selection",editor(Nt){return(0,t.jsx)(a.z,{...Nt,options:Nt.item.settings?.options})}},he={id:"unit",name:"Unit",description:"Allows unit input",editor:vt},Ce={id:"color",name:"Color",description:"Allows color selection",editor(Nt){return(0,t.jsx)(ie.a,{value:Nt.value,onChange:Nt.onChange,settings:Nt.item.settings,details:!0})}},We={id:"fieldColor",name:"Field Color",description:"Field color selection",editor:ye},et={id:"links",name:"Links",description:"Allows defining data links",editor:Te},rt={id:"stats-picker",name:"Stats Picker",editor:Pe,description:""},nt={id:"timezone",name:"Time zone",description:"Time zone selection",editor:c.U},gt={id:"field-name",name:"Field name",description:"Allows selecting a field name from a data frame",editor:o.O};return[me,pe,Ee,Se,Re,Ie,he,et,rt,ve,nt,We,Ce,Oe,gt,{id:"dashboard-uid",name:"Dashboard",description:"Select dashboard",editor:se},{id:"mappings",name:"Mappings",description:"Allows defining value mappings",editor:le},{id:"thresholds",name:"Thresholds",description:"Allows defining thresholds",editor:C}]},Ve=()=>{const pe=["Standard options"],Ee={id:"displayName",path:"displayName",name:"Display name",description:"Change the field or series name",editor:n.D.get("text").editor,override:n.D.get("text").editor,process:i.AM,settings:{placeholder:"none",expandTemplateVars:!0},shouldApply:()=>!0,category:pe},me={id:"unit",path:"unit",name:"Unit",description:"",editor:n.D.get("unit").editor,override:n.D.get("unit").editor,process:i.OU,settings:{placeholder:"none"},shouldApply:()=>!0,category:pe},ve={id:"fieldMinMax",path:"fieldMinMax",name:"Field min/max",description:"Calculate min max per field",editor:n.D.get("boolean").editor,override:n.D.get("boolean").editor,process:i.FM,shouldApply:nt=>nt.type===s.PU.number,showIf:nt=>nt.min===void 0||nt.max===void 0,category:pe},Se={id:"min",path:"min",name:"Min",description:"Leave empty to calculate based on all values",editor:n.D.get("number").editor,override:n.D.get("number").editor,process:i.m0,settings:{placeholder:"auto"},shouldApply:nt=>nt.type===s.PU.number,category:pe},Ie={id:"max",path:"max",name:"Max",description:"Leave empty to calculate based on all values",editor:n.D.get("number").editor,override:n.D.get("number").editor,process:i.m0,settings:{placeholder:"auto"},shouldApply:nt=>nt.type===s.PU.number,category:pe},Oe={id:"decimals",path:"decimals",name:"Decimals",editor:n.D.get("number").editor,override:n.D.get("number").editor,process:i.m0,settings:{placeholder:"auto",min:0,max:15,integer:!0},shouldApply:nt=>nt.type===s.PU.number,category:pe},Re={id:"noValue",path:"noValue",name:"No value",description:"What to show when there is no value",editor:n.D.get("text").editor,override:n.D.get("text").editor,process:i.OU,settings:{placeholder:"-"},shouldApply:()=>!0,category:pe},he={id:"links",path:"links",name:"Data links",editor:n.D.get("links").editor,override:n.D.get("links").editor,process:i.Ch,settings:{placeholder:"-"},shouldApply:()=>!0,category:["Data links"],getItemsCount:nt=>nt?nt.length:0},Ce={id:"color",path:"color",name:"Color scheme",editor:n.D.get("fieldColor").editor,override:n.D.get("fieldColor").editor,process:i.hS,shouldApply:()=>!0,settings:{byValueSupport:!0,preferThresholdsMode:!0},category:pe},We={id:"mappings",path:"mappings",name:"Value mappings",description:"Modify the display text based on input value",editor:n.D.get("mappings").editor,override:n.D.get("mappings").editor,process:i.xT,settings:{},defaultValue:[],shouldApply:nt=>nt.type!==s.PU.time,category:["Value mappings"],getItemsCount:nt=>nt?nt.length:0},et={id:"thresholds",path:"thresholds",name:"Thresholds",editor:n.D.get("thresholds").editor,override:n.D.get("thresholds").editor,process:i.N7,settings:{},defaultValue:{mode:r.O.Absolute,steps:[{value:-1/0,color:"green"},{value:80,color:"red"}]},shouldApply:()=>!0,category:["Thresholds"],getItemsCount:nt=>nt?nt.steps.length:0},rt={id:"filterable",path:"filterable",name:"Ad-hoc filterable",hideFromDefaults:!0,editor:n.D.get("boolean").editor,override:n.D.get("boolean").editor,process:i.FM,shouldApply:()=>!0,settings:{},category:pe};return[me,Se,Ie,ve,Oe,Ee,Ce,Re,he,We,et,rt]}},57602:(k,R,e)=>{"use strict";e.d(R,{G:()=>o});var t=e(74848),n=e(32196),i=e(94659),s=e(9821),r=e(96540),g=e(40845),a=e(24849),c=e(60188);const o=({value:d,onChange:p,item:m})=>{const v=(0,r.useRef)(null),{settings:l}=m,y=l?.min||0,u=l?.max||100,D=l?.step,E=l?.marks||{[y]:y,[u]:u},x=l?.included,P=l?.ariaLabelForHandle,b=75,M=!0,O=(0,g.$j)(),[I,T]=(0,r.useState)(d??y),[C,S]=(0,r.useState)(b);(0,r.useEffect)(()=>{d!=null&&d!==I&&T(d)},[d,I]),(0,r.useEffect)(()=>{const B=getComputedStyle(v.current),U=B.getPropertyValue("font-weight")||"normal",K=B.getPropertyValue("font-size")||"16px",V=B.getPropertyValue("font-family")||"Arial",H="0",Y=4,X=8,J=Math.max((u+(D||0)).toString().length,(u-(D||0)).toString().length)+Y,q=H.repeat(J),ae=h(q,`${U} ${K} ${V}`);ae&&S(ae+X*2)},[u,D]);const A=(0,r.useCallback)(B=>{const U=typeof B=="number"?B:B[0];T(U),p&&p(U)},[T,p]),L=(0,r.useCallback)(B=>{let U=B;(Number.isNaN(U)||!U)&&(U=0),T(U),p&&p(U)},[p]),N=(0,a.$)(O,M,!!E),F=f(O,C),w=M?[]:[N.sliderInputVertical];return(0,t.jsxs)("div",{className:(0,n.cx)(N.container,N.slider),children:[(0,t.jsx)(i.Global,{styles:N.slider}),(0,t.jsxs)("div",{className:(0,n.cx)(N.sliderInput,...w),children:[(0,t.jsx)(s.A,{min:y,max:u,step:D,defaultValue:d,value:I,onChange:A,vertical:!M,reverse:!1,ariaLabelForHandle:P,marks:E,included:x}),(0,t.jsx)("span",{className:F.numberInputWrapper,ref:v,children:(0,t.jsx)(c.Q,{value:I,onChange:L,max:u,min:y,step:D})})]})]})};function h(d,p){const v=document.createElement("canvas").getContext("2d");return v?(v.font=p,v.measureText(d).width):null}const f=(d,p)=>({numberInputWrapper:(0,n.css)({marginLeft:d.spacing(3),maxHeight:"32px",maxWidth:p,minWidth:p,overflow:"visible",width:"100%"})})},29286:(k,R,e)=>{"use strict";e.d(R,{g:()=>r});var t=e(74848),n=e(96540),i=e(21744),s=e(10354);const r=({value:g,onChange:a,item:c,suffix:o})=>{const h=c.settings?.useTextarea?i.f:s.p,f=(0,n.useCallback)(d=>{let p=g??"";"key"in d?d.key==="Enter"&&!c.settings?.useTextarea&&(p=d.currentTarget.value.trim()):p=d.currentTarget.value.trim(),p!==g&&a(p===""?void 0:p)},[g,c.settings?.useTextarea,a]);return(0,t.jsx)(h,{placeholder:c.settings?.placeholder,defaultValue:g||"",rows:c.settings?.useTextarea&&c.settings.rows||5,onBlur:f,onKeyDown:f,suffix:o})}},69444:(k,R,e)=>{"use strict";e.d(R,{Y:()=>K});var t=e(74848),n=e(32196),i=e(96540),s=e(64388),r=e(32264),g=e(40845),a=e(76888);function c({children:H,scrollRefCallback:Y,scrollTop:X,divId:J}){const q=(0,g.of)(o),ae=(0,i.useRef)(null);return(0,i.useEffect)(()=>{!r.$.featureToggles.bodyScrolling&&ae.current&&Y&&Y(ae.current)},[ae,Y]),(0,i.useEffect)(()=>{!r.$.featureToggles.bodyScrolling&&ae.current&&X!=null&&ae.current?.scrollTo(0,X)},[X]),r.$.featureToggles.bodyScrolling?H:(0,t.jsx)("div",{ref:ae,className:(0,n.cx)(q.nativeScrollbars,"scrollbar-view"),id:J,children:H})}function o(){return{nativeScrollbars:(0,n.css)({label:"native-scroll-container",minHeight:"calc(100% + 0px)",maxHeight:"calc(100% + 0px)",display:"flex",flexDirection:"column",flexGrow:1,overflow:"auto"})}}var h=e(39419);const f=({isLoading:H,children:Y,className:X})=>{let J=X?(0,t.jsx)("div",{className:X,children:Y}):Y;return(0,t.jsx)(t.Fragment,{children:H?(0,t.jsx)(h.A,{}):J})};var d=e(13773),p=e(17172),m=e(94753),v=e(29158),l=e(88575),y=e(10354);const u=({value:H,onEdit:Y})=>{const X=(0,g.of)(D),[J,q]=(0,i.useState)(H),[ae,j]=(0,i.useState)(!1),[te,ne]=(0,i.useState)(!1),[le,z]=(0,i.useState)();(0,i.useEffect)(()=>{q(H)},[H]);const ee=(0,i.useCallback)(async se=>{const ie=se.currentTarget.value;if(!ie)z("Please enter a title");else if(ie===H)z(void 0),j(!1);else{ne(!0);try{await Y(ie),z(void 0),j(!1)}catch(Z){(0,p.NF)(Z)?z(Z.data.message):Z instanceof Error&&z(Z.message)}ne(!1)}},[Y,H]);return ae?(0,t.jsx)("div",{className:X.inputContainer,children:(0,t.jsx)(l.D,{className:X.field,loading:te,invalid:!!le,error:le,children:(0,t.jsx)(y.p,{className:X.input,defaultValue:J,onKeyDown:se=>{se.key==="Enter"&&ee(se)},autoFocus:!0,onBlur:ee,onChange:se=>q(se.currentTarget.value),onFocus:()=>j(!0)})})}):(0,t.jsx)("div",{className:X.textContainer,children:(0,t.jsxs)("div",{className:X.textWrapper,children:[(0,t.jsx)(m.E,{element:"h1",truncate:!0,children:J}),(0,t.jsx)(v.K,{name:"pen",size:"lg",tooltip:"Edit title",onClick:()=>j(!0)})]})})};u.displayName="EditableTitle";const D=H=>({textContainer:(0,n.css)({minWidth:0}),field:(0,n.css)({flex:1,left:`calc(-${H.spacing(1)} - 1px)`,position:"relative",marginBottom:0}),input:(0,n.css)({input:{...H.typography.h1}}),inputContainer:(0,n.css)({display:"flex",flex:1}),textWrapper:(0,n.css)({alignItems:"center",display:"flex",gap:H.spacing(1)})});function E({navItem:H,renderTitle:Y,actions:X,info:J,subTitle:q,onEditTitle:ae}){const j=(0,g.of)(x),te=q??H.subTitle,ne=ae?(0,t.jsx)(u,{value:H.text,onEdit:ae}):(0,t.jsxs)("div",{className:j.title,children:[H.img&&(0,t.jsx)("img",{className:j.img,src:H.img,alt:`logo for ${H.text}`}),Y?Y(H.text):(0,t.jsx)("h1",{children:H.text})]});return(0,t.jsxs)("div",{className:j.pageHeader,children:[(0,t.jsxs)("div",{className:j.topRow,children:[(0,t.jsxs)("div",{className:j.titleInfoContainer,children:[ne,J&&(0,t.jsx)(d.Q,{info:J})]}),(0,t.jsx)("div",{className:j.actions,children:X})]}),te&&(0,t.jsx)("div",{className:j.subTitle,children:te})]})}const x=H=>({topRow:(0,n.css)({alignItems:"flex-start",display:"flex",flexDirection:"row",flexWrap:"wrap",gap:H.spacing(1,3)}),title:(0,n.css)({display:"flex",flexDirection:"row",maxWidth:"100%",h1:{display:"flex",marginBottom:0}}),actions:(0,n.css)({display:"flex",flexDirection:"row",gap:H.spacing(1)}),titleInfoContainer:(0,n.css)({display:"flex",label:"title-info-container",flex:1,flexWrap:"wrap",gap:H.spacing(1,4),justifyContent:"space-between",maxWidth:"100%",minWidth:"200px"}),pageHeader:(0,n.css)({label:"page-header",display:"flex",flexDirection:"column",gap:H.spacing(1),marginBottom:H.spacing(2)}),subTitle:(0,n.css)({position:"relative",color:H.colors.text.secondary}),img:(0,n.css)({width:"32px",height:"32px",marginRight:H.spacing(2)})});var P=e(63021),b=e(8984),M=e(40675);function O({navItem:H}){const Y=(0,g.of)(I);return(0,t.jsx)("div",{className:Y.tabsWrapper,children:(0,t.jsx)(P.U,{children:H.children.map((X,J)=>{const q=X.icon?(0,b.toIconName)(X.icon):void 0;return!X.hideFromTabs&&(0,t.jsx)(M.o,{label:X.text,active:X.active,icon:q,counter:X.tabCounter,href:X.url,suffix:X.tabSuffix,onChangeTab:X.onClick},`${X.url}-${J}`)})})})}const I=H=>({tabsWrapper:(0,n.css)({paddingBottom:H.spacing(3)})});var T=e(25508),C=e(17422),S=e(99140),A=e(31678);function L(H,Y){if(Y)return Y;if(H&&S.M_)return(0,A.useSelector)((0,T.Mz)(N,X=>(0,C.tc)(X,H??"home")))}function N(H){return H.navIndex}var F=e(28215),w=e(19361),B=e(3984);function U(H,Y){const X=(0,A.useSelector)(J=>J.navIndex)?.[F.Id];(0,i.useEffect)(()=>{const J=(H?.node!==H?.main?H?.node:H?.main)??{text:"Grafana"},q=(0,B.Z)(J,Y,X).map(ae=>ae.text).reverse();q[q.length-1]=w.M.AppTitle,document.title=q.join(" - ")},[X,H,Y])}const K=({navId:H,navModel:Y,pageNav:X,renderTitle:J,onEditTitle:q,actions:ae,subTitle:j,children:te,className:ne,info:le,layout:z=s.k.Standard,scrollTop:ee,scrollRef:se,...ie})=>{const Z=(0,g.of)(V),oe=L(H,Y),{chrome:ce}=(0,a.Il)();U(oe,X);const ye=X??oe?.node;return(0,i.useLayoutEffect)(()=>{oe&&ce.update({sectionNav:oe,pageNav:X,layout:z})},[oe,X,ce,z]),(0,t.jsxs)("div",{className:(0,n.cx)(Z.wrapper,ne),...ie,children:[z===s.k.Standard&&(0,t.jsx)(c,{divId:"page-scrollbar",autoHeightMin:"100%",scrollTop:ee,scrollRefCallback:se,children:(0,t.jsxs)("div",{className:Z.pageInner,children:[ye&&(0,t.jsx)(E,{actions:ae,onEditTitle:q,navItem:ye,renderTitle:J,info:le,subTitle:j}),X&&X.children&&(0,t.jsx)(O,{navItem:X}),(0,t.jsx)("div",{className:Z.pageContent,children:te})]})}),z===s.k.Canvas&&(0,t.jsx)(c,{divId:"page-scrollbar",autoHeightMin:"100%",scrollTop:ee,scrollRefCallback:se,children:(0,t.jsx)("div",{className:Z.canvasContent,children:te})}),z===s.k.Custom&&te]})};K.Contents=f;const V=H=>({wrapper:(0,n.css)(r.$.featureToggles.bodyScrolling?{label:"page-wrapper",display:"flex",flex:"1 1 0",flexDirection:"column",position:"relative"}:{label:"page-wrapper",height:"100%",display:"flex",flex:"1 1 0",flexDirection:"column",minHeight:0}),pageContent:(0,n.css)({label:"page-content",flexGrow:1}),primaryBg:(0,n.css)({background:H.colors.background.primary}),pageInner:(0,n.css)({label:"page-inner",padding:H.spacing(2),borderBottom:"none",background:H.colors.background.primary,display:"flex",flexDirection:"column",flexGrow:1,margin:H.spacing(0,0,0,0),[H.breakpoints.up("md")]:{padding:H.spacing(4)}}),canvasContent:(0,n.css)({label:"canvas-content",display:"flex",flexDirection:"column",padding:H.spacing(2),flexBasis:"100%",flexGrow:1})})},13773:(k,R,e)=>{"use strict";e.d(R,{Q:()=>r});var t=e(74848),n=e(32196),i=e(96540),s=e(40845);function r({info:a}){const c=(0,s.of)(g);return(0,t.jsx)("div",{className:c.container,children:a.map((o,h)=>(0,t.jsxs)(i.Fragment,{children:[(0,t.jsxs)("div",{className:c.infoItem,children:[(0,t.jsx)("div",{className:c.label,children:o.label}),o.value]}),h+1<a.length&&(0,t.jsx)("div",{"data-testid":"page-info-separator",className:c.separator})]},h))})}const g=a=>({container:(0,n.css)({display:"flex",flexDirection:"row",gap:a.spacing(1.5),overflow:"auto"}),infoItem:(0,n.css)({...a.typography.bodySmall,display:"flex",flexDirection:"column",gap:a.spacing(.5)}),label:(0,n.css)({color:a.colors.text.secondary}),separator:(0,n.css)({borderLeft:`1px solid ${a.colors.border.weak}`})})},39419:(k,R,e)=>{"use strict";e.d(R,{A:()=>r});var t=e(74848),n=e(90613),i=e(39558);const r=({pageName:g=""})=>{const a=`Loading ${g}...`;return(0,t.jsx)(n.a,{display:"flex",alignItems:"center",direction:"column",justifyContent:"center",paddingTop:10,children:(0,t.jsx)(i._,{text:a})})}},7392:(k,R,e)=>{"use strict";e.d(R,{L:()=>a});var t=e(74848),n=e(32196),i=e(13544),s=e(40845),r=e(69529),g=e(72109);function a({entity:o="Page"}){const h=(0,s.of)(c);return(0,t.jsx)("div",{className:h.container,"data-testid":i.Tp.components.EntityNotFound.container,children:(0,t.jsxs)(r.p,{message:`${o} not found`,variant:"not-found",children:["We're looking but can't seem to find this ",o.toLowerCase(),". Try returning"," ",(0,t.jsx)(g.Y,{href:"/",children:"home"})," or seeking help on the"," ",(0,t.jsx)(g.Y,{href:"https://community.grafana.com",external:!0,children:"community site."})]})})}function c(o){return{container:(0,n.css)({padding:o.spacing(8,2,2,2)})}}},68313:(k,R,e)=>{"use strict";e.d(R,{$:()=>h});var t=e(74848),n=e(32196),i=e(96540),s=e(32264),r=e(40845),g=e(55852),a=e(90182),c=e(14578),o=e(17706);const h=({onChange:d,maxMenuHeight:p,isWidget:m=!1})=>{const v=()=>s.$.featureToggles.vizAndWidgetSplit?m?(0,o.nr)():(0,o.if)():(0,o.A4)(),l=(0,i.useMemo)(v,[m]),y=(0,i.useMemo)(()=>l.map(b=>({label:b.name,imgUrl:b.info.logos.small,value:b})).sort((b,M)=>b.label?.localeCompare(M.label)),[l]),[u,D]=(0,i.useState)([]),E=(0,i.useCallback)(b=>{const M=b.filter(O=>O.value).map(O=>O.value);d(M),D(b)},[d]),x=(0,r.of)(f),P={defaultOptions:!0,getOptionLabel:b=>b.label,getOptionValue:b=>b.value,noOptionsMessage:"No Panel types found",placeholder:"Filter by type",maxMenuHeight:p,options:y,value:u,onChange:E};return(0,t.jsxs)("div",{className:x.container,children:[u.length>0&&(0,t.jsx)(g.$n,{size:"xs",icon:"trash-alt",fill:"text",className:x.clear,onClick:()=>E([]),"aria-label":"Clear types",children:"Clear types"}),(0,t.jsx)(a.KF,{...P,prefix:(0,t.jsx)(c.I,{name:"filter"}),"aria-label":"Panel Type filter"})]})};function f(d){return{container:(0,n.css)`
      label: container;
      position: relative;
      min-width: 180px;
      flex-grow: 1;
    `,clear:(0,n.css)`
      label: clear;
      font-size: ${d.spacing(1.5)};
      position: absolute;
      top: -${d.spacing(4.5)};
      right: 0;
    `}}},78361:(k,R,e)=>{"use strict";e.d(R,{s:()=>g});var t=e(74848),n=e(96540),i=e(13544),s=e(10354),r=e(29158);const g=(0,n.forwardRef)((a,c)=>{const[o,h]=(0,n.useState)(!1);return(0,t.jsx)(s.p,{...a,type:o?"text":"password","data-testid":i.Tp.pages.Login.password,ref:c,suffix:(0,t.jsx)(r.K,{name:o?"eye-slash":"eye","aria-controls":a.id,role:"switch","aria-checked":o,onClick:()=>{h(!o)},tooltip:o?"Hide password":"Show password"})})});g.displayName="PasswordField"},22214:(k,R,e)=>{"use strict";e.d(R,{j:()=>g});var t=e(74848),n=e(32196),i=e(96540),s=e(36663),r=e(40845);const g=i.memo(i.forwardRef(({className:o,children:h,markdown:f,styleOverrides:d,onRemove:p,...m},v)=>{const l=(0,r.of)(y=>c(y,d?.borderTop));return(0,t.jsxs)("div",{className:(0,n.cx)(l.wrapper,o),...m,ref:v,children:[f&&a(f),h]})}));function a(o){const h=(0,s.G)(o);return(0,t.jsx)("div",{className:"markdown-html",dangerouslySetInnerHTML:{__html:h}})}g.displayName="OperationRowHelp";const c=(o,h)=>{const f=o.shape.radius.default,d=o.colors.background.secondary;return{wrapper:(0,n.css)`
      padding: ${o.spacing(2)};
      border: 2px solid ${d};
      border-top: ${h?h+d:"none"};
      border-radius: 0 0 ${f} ${f};
      position: relative;
      top: -4px;
    `}}},10343:(k,R,e)=>{"use strict";e.d(R,{A:()=>c,q:()=>a});var t=e(74848),n=e(32196),i=e(13544),s=e(40845),r=e(29158);function g(h){const f=(0,s.of)(o);return(0,t.jsx)("div",{className:(0,n.cx)(f.icon,"active"in h&&h.active&&f.active),children:(0,t.jsx)(r.K,{name:h.icon,tooltip:h.title,className:f.icon,disabled:!!h.disabled,onClick:h.onClick,type:"button","data-testid":h.dataTestId??i.Tp.components.QueryEditorRow.actionButton(h.title),..."active"in h&&{"aria-pressed":h.active}})})}function a(h){return(0,t.jsx)(g,{...h})}const c=h=>(0,t.jsx)(g,{...h}),o=h=>({icon:(0,n.css)({display:"flex",position:"relative",color:h.colors.text.secondary}),active:(0,n.css)({"&:before":{display:"block",content:'" "',position:"absolute",left:-1,right:2,height:3,borderRadius:h.shape.radius.default,bottom:-8,backgroundImage:h.colors.gradients.brandHorizontal}})})},7788:(k,R,e)=>{"use strict";e.d(R,{u:()=>v});var t=e(74848),n=e(32196),i=e(91076),s=e(96540),r=e(22589),g=e(14110),a=e(40845),c=e(67892),o=e(29158),h=e(67061),f=e(14578),d=e(8484);const p=({actionsElement:y,disabled:u,draggable:D,collapsable:E=!0,dragHandleProps:x,headerElement:P,isContentVisible:b,onRowToggle:M,reportDragMousePosition:O,title:I,id:T,expanderMessages:C})=>{const S=(0,a.of)(m);let A=b?(0,d.t)("query-operation.header.collapse-row","Collapse query row"):(0,d.t)("query-operation.header.expand-row","Expand query row");C!==void 0&&b?A=C.close:C!==void 0&&(A=C?.open);const L=(0,d.t)("query-operation.header.drag-and-drop","Drag and drop to reorder");return(0,t.jsxs)("div",{className:S.header,children:[(0,t.jsxs)("div",{className:S.column,children:[E&&(0,t.jsx)(o.K,{name:b?"angle-down":"angle-right",tooltip:A,className:S.collapseIcon,onClick:M,"aria-expanded":b,"aria-controls":T}),I&&(0,t.jsx)("div",{className:S.titleWrapper,onClick:M,"aria-label":"Query operation row title",children:(0,t.jsx)("div",{className:(0,n.cx)(S.title,u&&S.disabled),children:I})}),P]}),(0,t.jsxs)(h.B,{gap:1,alignItems:"center",children:[y,D&&(0,t.jsx)("div",{onMouseMove:O,...x,children:(0,t.jsx)(f.I,{title:L,name:"draggabledots",size:"lg",className:S.dragIcon})})]})]})},m=y=>({header:(0,n.css)`
    label: Header;
    padding: ${y.spacing(.5,.5)};
    border-radius: ${y.shape.radius.default};
    background: ${y.colors.background.secondary};
    min-height: ${y.spacing(4)};
    display: grid;
    grid-template-columns: minmax(100px, max-content) min-content;
    align-items: center;
    justify-content: space-between;
    white-space: nowrap;

    &:focus {
      outline: none;
    }
  `,column:(0,n.css)`
    label: Column;
    display: flex;
    align-items: center;
  `,dragIcon:(0,n.css)`
    cursor: grab;
    color: ${y.colors.text.disabled};
    margin: ${y.spacing(0,.5)};
    &:hover {
      color: ${y.colors.text};
    }
  `,collapseIcon:(0,n.css)`
    margin-left: ${y.spacing(.5)};
    color: ${y.colors.text.disabled};
    }
  `,titleWrapper:(0,n.css)`
    display: flex;
    align-items: center;
    flex-grow: 1;
    cursor: pointer;
    overflow: hidden;
    margin-right: ${y.spacing(.5)};
  `,title:(0,n.css)`
    font-weight: ${y.typography.fontWeightBold};
    color: ${y.colors.text.link};
    margin-left: ${y.spacing(.5)};
    overflow: hidden;
    text-overflow: ellipsis;
  `,disabled:(0,n.css)`
    color: ${y.colors.text.disabled};
  `});p.displayName="QueryOperationRowHeader";function v({children:y,actions:u,title:D,headerElement:E,onClose:x,onOpen:P,isOpen:b,disabled:M,draggable:O,collapsable:I,index:T,id:C,expanderMessages:S}){const[A,L]=(0,s.useState)(b!==void 0?b:!0),N=(0,a.of)(l),F=(0,s.useCallback)(()=>{L(!A)},[A,L]);(0,s.useEffect)(()=>{typeof b=="boolean"&&L(b)},[b]);const w=(0,s.useCallback)(V=>{if(V.defaultPrevented){const H=V.currentTarget.getBoundingClientRect(),Y=V.clientX-H.left,X=V.clientY-H.top;(0,g.rR)("query_row_reorder_drag_position",{x:Y/H.width,y:X/H.height,width:H.width,height:H.height})}},[]);(0,r.A)(()=>{A?P&&P():x&&x()},[A]);const B={isOpen:A,onOpen:()=>{L(!0)},onClose:()=>{L(!1)}},U=u&&c.renderOrCallToRender(u,B),K=E&&c.renderOrCallToRender(E,B);return O?(0,t.jsx)(i.sx,{draggableId:C,index:T,children:V=>(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{ref:V.innerRef,className:N.wrapper,...V.draggableProps,children:[(0,t.jsx)("div",{children:(0,t.jsx)(p,{id:C,actionsElement:U,disabled:M,draggable:!0,collapsable:I,dragHandleProps:V.dragHandleProps,headerElement:K,isContentVisible:A,onRowToggle:F,reportDragMousePosition:w,title:D,expanderMessages:S})}),A&&(0,t.jsx)("div",{className:N.content,children:y})]})})}):(0,t.jsxs)("div",{className:N.wrapper,children:[(0,t.jsx)(p,{id:C,actionsElement:U,disabled:M,draggable:!1,collapsable:I,headerElement:K,isContentVisible:A,onRowToggle:F,reportDragMousePosition:w,title:D,expanderMessages:S}),A&&(0,t.jsx)("div",{className:N.content,children:y})]})}const l=y=>({wrapper:(0,n.css)`
      margin-bottom: ${y.spacing(2)};
    `,content:(0,n.css)`
      margin-top: ${y.spacing(.5)};
      margin-left: ${y.spacing(3)};
    `});v.displayName="QueryOperationRow"},37425:(k,R,e)=>{"use strict";e.d(R,{n:()=>ye});var t=e(74848),n=e(96540),i=e(40845),s=e(8866),r=e(17464),g=e(32196),a=e(62930),c=e(14578),o=e(56034),h=e(10354),f=e(87266),d=e(16797),p=e(88824);const m=(0,n.forwardRef)(({children:re,iconName:ue},De)=>{const ge=(0,i.of)(v);return(0,t.jsxs)("div",{className:ge.container,ref:De,children:[ue&&(0,t.jsx)(c.I,{name:ue,size:"xs"}),re]})});m.displayName="ValueContainer";const v=re=>{const{prefix:ue}=(0,h.n)({theme:re}),{multiValueContainer:De}=(0,p.J)(re);return{container:(0,g.cx)(ue,De,(0,g.css)`
        position: relative;
        padding: ${re.spacing(.5,1,.5,1)};

        svg {
          margin-right: ${re.spacing(.5)};
        }
      `)}},l=360,y=300,u=320,D=360,E=320,x=360,P=D+x,b=re=>re.stopPropagation(),M=({appliedRoles:re,basicRole:ue,disabled:De,isFocused:ge,query:Te,showBasicRole:Le,width:Ye,isLoading:je,onOpen:Ze,onClose:Ne,onQueryChange:Pe,...Ue})=>{const $e=(0,i.of)(I,!1,!!ge,!!De,!1,Ye),ze=(0,n.useRef)(null);(0,n.useEffect)(()=>{ge&&ze.current?.focus()});const qe=vt=>{const yt=vt.target?.value;Pe(yt)},dt=Le&&ue!=="None";return ge?(0,t.jsxs)("div",{className:$e.wrapper,children:[dt&&(0,t.jsx)(m,{children:ue}),re.map(vt=>(0,t.jsx)(m,{children:vt.group+":"+(vt.displayName||vt.name)},vt.uid)),!De&&(0,t.jsx)("input",{...Ue,className:$e.input,ref:ze,onMouseDown:b,onChange:qe,"data-testid":"role-picker-input",placeholder:ge?"Select role":"",value:Te}),(0,t.jsx)("div",{className:$e.suffix,children:(0,t.jsx)(c.I,{name:"angle-up",className:$e.dropdownIndicator,onMouseDown:Ne})})]}):(0,t.jsxs)("div",{className:(0,g.cx)($e.wrapper,$e.selectedRoles),onMouseDown:Ze,children:[dt&&(0,t.jsx)(m,{children:ue}),(0,t.jsx)(O,{appliedRoles:re,numberOfRoles:re.length,showBuiltInRole:dt}),je&&(0,t.jsx)("div",{className:$e.spinner,children:(0,t.jsx)(a.y,{size:16,inline:!0})})]})};M.displayName="RolePickerInput";const O=({showBuiltInRole:re,numberOfRoles:ue,appliedRoles:De})=>{const ge=(0,i.of)(Te=>T(Te));return(0,t.jsx)(t.Fragment,{children:ue?(0,t.jsx)(o.m,{content:(0,t.jsx)("div",{className:ge.tooltip,children:De?.map(Te=>(0,t.jsx)("p",{children:Te.group+":"+(Te.displayName||Te.name)},Te.uid))}),children:(0,t.jsx)(m,{children:`${re?"+":""}${ue} role${ue>1?"s":""}`})}):!re&&(0,t.jsx)(m,{children:"No roles assigned"})})},I=(re,ue,De,ge,Te,Le)=>{const Ye=(0,h.n)({theme:re,invalid:ue});return{wrapper:(0,g.cx)(Ye.wrapper,(0,f.Xb)(re,ue),De&&(0,g.css)`
          ${d.focusCss(re.v1)}
        `,ge&&Ye.inputDisabled,(0,g.css)({minWidth:Le||l+"px",width:Le,minHeight:"32px",maxHeight:"200px",overflow:"scroll",overflowX:"hidden",overflowY:"auto",height:"auto",flexDirection:"row",paddingRight:re.spacing(1),maxWidth:"100%",alignItems:"center",display:"flex",flexWrap:"wrap",justifyContent:"flex-start",position:"relative",boxSizing:"border-box",cursor:"default"}),Te&&(0,g.css)`
          padding-left: 0;
        `),input:(0,g.cx)((0,f.Xb)(re,ue),(0,g.css)`
        max-width: 120px;
        border: none;
        cursor: ${De?"default":"pointer"};
      `),suffix:Ye.suffix,dropdownIndicator:(0,g.css)`
      cursor: pointer;
    `,selectedRoles:(0,g.css)`
      display: flex;
      align-items: center;
      cursor: ${ge?"not-allowed":"pointer"};
    `,tooltip:(0,g.css)`
      p {
        margin-bottom: ${re.spacing(.5)};
      }
    `,spinner:(0,g.css)({display:"flex",flexGrow:1,justifyContent:"flex-end"})}},T=re=>({tooltip:(0,g.css)`
    p {
      margin-bottom: ${re.spacing(.5)};
    }
  `});var C=e(72109),S=e(40276),A=e(67061),L=e(55852),N=e(83186),F=e(31678);const w=re=>({hideScrollBar:(0,g.css)({".scrollbar-view":{"&::-webkit-scrollbar":{display:"none"},scrollbarWidth:"none"}}),menuWrapper:(0,g.css)({display:"flex",maxHeight:"650px",position:"absolute",zIndex:re.zIndex.dropdown,overflow:"hidden",minWidth:"auto"}),menu:(0,g.css)({minWidth:`${u}px`,maxWidth:`${D}px`,"& > div":{paddingTop:re.spacing(1)}}),menuLeft:(0,g.css)({flexDirection:"row-reverse"}),subMenu:(0,g.css)({height:"100%",minWidth:`${E}px`,maxWidth:`${x}px`,display:"flex",flexDirection:"column",borderLeft:`1px solid ${re.components.input.borderColor}`,"& > div":{paddingTop:re.spacing(1)}}),subMenuLeft:(0,g.css)({borderRight:`1px solid ${re.components.input.borderColor}`,borderLeft:"unset"}),groupHeader:(0,g.css)({padding:re.spacing(0,4.5),display:"flex",alignItems:"center",color:re.colors.text.primary,fontWeight:re.typography.fontWeightBold}),container:(0,g.css)({padding:re.spacing(1),border:`1px ${re.colors.border.weak} solid`,borderRadius:re.shape.radius.default,backgroundColor:re.colors.background.primary,zIndex:re.zIndex.modal}),menuSection:(0,g.css)({marginBottom:re.spacing(2)}),menuOptionCheckbox:(0,g.css)({display:"flex",margin:re.spacing(0,1,0,.25)}),menuButtonRow:(0,g.css)({backgroundColor:re.colors.background.primary,padding:re.spacing(1)}),menuOptionBody:(0,g.css)({fontWeight:re.typography.fontWeightRegular,padding:re.spacing(0,1.5,0,0)}),menuOptionDisabled:(0,g.css)({color:re.colors.text.disabled,cursor:"not-allowed"}),menuOptionExpand:(0,g.css)({position:"absolute",right:re.spacing(2.5),color:re.colors.text.disabled,"&:after":{content:'">"'}}),menuOptionInfoSign:(0,g.css)({color:re.colors.text.disabled}),basicRoleSelector:(0,g.css)({margin:re.spacing(1,1.25,1,1.5)}),subMenuPortal:(0,g.css)({height:"100%","> div":{height:"100%"}}),subMenuButtonRow:(0,g.css)({backgroundColor:re.colors.background.primary,padding:re.spacing(1)}),checkboxPartiallyChecked:(0,g.css)({input:{"&:checked + span":{"&:after":{borderWidth:"0 3px 0px 0",transform:"rotate(90deg)"}}}}),loadingSpinner:(0,g.css)({marginLeft:re.spacing(1)})}),B=Object.values(F.OrgRole).map(re=>({label:re===F.OrgRole.None?"No basic role":re,value:re})),U=({value:re,onChange:ue,disabled:De,disabledMesssage:ge,tooltipMessage:Te})=>{const Le=(0,i.of)(w),Ye=(0,i.$j)();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:Le.groupHeader,children:[(0,t.jsx)("span",{style:{marginRight:Ye.spacing(1)},children:"Basic roles"}),De&&ge&&(0,t.jsx)(o.m,{placement:"right-end",interactive:!0,content:(0,t.jsx)("div",{children:ge}),children:(0,t.jsx)(c.I,{name:"question-circle"})}),!De&&Te&&(0,t.jsx)(o.m,{placement:"right-end",interactive:!0,content:Te,children:(0,t.jsx)(c.I,{name:"info-circle",size:"xs"})})]}),(0,t.jsx)(N.a,{name:"Basic Role Selector",className:Le.basicRoleSelector,options:B,value:re,onChange:ue,disabled:De})]})};var K=e(10880);const V=(0,n.memo)(n.forwardRef(({name:re,value:ue,isFocused:De,isSelected:ge,partiallySelected:Te,disabled:Le,onChange:Ye,onClick:je,onOpenSubMenu:Ze,onCloseSubMenu:Ne,children:Pe,root:Ue},$e)=>{const ze=(0,i.$j)(),qe=(0,p.J)(ze),dt=(0,i.of)(w),vt=(0,g.cx)(qe.option,De&&qe.optionFocused,Le&&dt.menuOptionDisabled),yt=Ee=>{Le||ue&&Ye(ue)},st=Ee=>{je&&je(ue)},Ve=()=>{Ze&&Ze(ue)},pe=()=>{Ne&&Ne()};return(0,t.jsx)("div",{onMouseEnter:Ve,onMouseLeave:pe,children:(0,t.jsxs)("div",{ref:$e,className:vt,"aria-label":"Role picker option",onClick:st,children:[(0,t.jsx)(K.S,{value:ge,className:(0,g.cx)(dt.menuOptionCheckbox,{[dt.checkboxPartiallyChecked]:Te}),onChange:yt,disabled:Le}),(0,t.jsxs)("div",{className:(0,g.cx)(qe.optionBody,dt.menuOptionBody),children:[(0,t.jsx)("span",{children:re}),(0,t.jsx)("span",{className:dt.menuOptionExpand})]}),Ue&&Pe&&(0,t.jsx)(r.ZL,{className:dt.subMenuPortal,root:Ue,children:Pe})]})})}));V.displayName="RoleMenuGroupOption";const H=(0,n.forwardRef)(({data:re,isFocused:ue,isSelected:De,disabled:ge,onChange:Te,hideDescription:Le},Ye)=>{const je=(0,i.$j)(),Ze=(0,p.J)(je),Ne=(0,i.of)(w),Pe=(0,g.cx)(Ze.option,ue&&Ze.optionFocused,ge&&Ne.menuOptionDisabled),Ue=$e=>{ge||($e.preventDefault(),$e.stopPropagation(),Te(re))};return(0,t.jsxs)("div",{ref:Ye,className:Pe,"aria-label":"Role picker option",onClick:Ue,children:[(0,t.jsx)(K.S,{value:De,className:Ne.menuOptionCheckbox,onChange:Ue,disabled:ge}),(0,t.jsxs)("div",{className:(0,g.cx)(Ze.optionBody,Ne.menuOptionBody),children:[(0,t.jsx)("span",{children:re.displayName||re.name}),!Le&&re.description&&(0,t.jsx)("div",{className:Ze.optionDescription,children:re.description})]}),re.description&&(0,t.jsx)(o.m,{content:re.description,children:(0,t.jsx)(c.I,{name:"info-circle",className:Ne.menuOptionInfoSign})})]})});H.displayName="RoleMenuOption";var Y=e(3246);const X=({options:re,selectedOptions:ue,disabledOptions:De,onSelect:ge,onClear:Te,showOnLeft:Le})=>{const Ye=(0,i.$j)(),je=(0,p.J)(Ye),Ze=(0,i.of)(w),Ne=async()=>{Te&&Te()};return(0,t.jsxs)("div",{className:(0,g.cx)(Ze.subMenu,{[Ze.subMenuLeft]:Le}),"aria-label":"Role picker submenu",children:[(0,t.jsx)(S.E,{autoHide:!1,autoHeightMax:`${y}px`,hideHorizontalTrack:!0,children:(0,t.jsx)("div",{className:je.optionBody,children:re.map((Pe,Ue)=>(0,t.jsx)(H,{data:Pe,isSelected:!!(Pe.uid&&(ue.find($e=>$e.uid===Pe.uid)||De?.find($e=>$e.uid===Pe.uid))),disabled:!!(Pe.uid&&De?.find($e=>$e.uid===Pe.uid))||(0,Y.W)(Pe),onChange:ge,hideDescription:!0},Ue))})}),(0,t.jsx)("div",{className:Ze.subMenuButtonRow,children:(0,t.jsx)(A.B,{justifyContent:"flex-end",children:(0,t.jsx)(L.$n,{size:"sm",fill:"text",onClick:Ne,children:"Clear"})})})]})},J=(0,n.forwardRef)(({roles:re,renderedName:ue,showGroups:De,optionGroups:ge,onGroupChange:Te,groupSelected:Le,groupPartiallySelected:Ye,subMenuNode:je,selectedOptions:Ze,onRoleChange:Ne,onClearSubMenu:Pe,showOnLeftSubMenu:Ue},$e)=>{const[ze,qe]=(0,n.useState)(!1),[dt,vt]=(0,n.useState)(""),yt=(0,i.$j)(),st=(0,p.J)(yt),Ve=(0,i.of)(w),pe=(0,n.useCallback)(me=>{vt(me),qe(!0)},[]),Ee=(0,n.useCallback)(()=>{qe(!1),vt("")},[]);return(0,t.jsx)("div",{children:re.length>0&&(0,t.jsxs)("div",{className:Ve.menuSection,children:[(0,t.jsx)("div",{className:Ve.groupHeader,children:ue}),(0,t.jsx)("div",{className:st.optionBody}),De&&ge?.length?ge.map(me=>(0,t.jsx)(V,{name:me.name,value:me.value,isSelected:Le(me.value)||Ye(me.value),partiallySelected:Ye(me.value),disabled:me.options?.every(Y.W),onChange:Te,onOpenSubMenu:pe,onCloseSubMenu:Ee,root:je,isFocused:ze&&dt===me.value,children:ze&&dt===me.value&&(0,t.jsx)(X,{options:me.options,selectedOptions:Ze,onSelect:Ne,onClear:()=>Pe(dt),showOnLeft:Ue})},me.value)):re.map(me=>(0,t.jsx)(H,{data:me,isSelected:!!(me.uid&&Ze.find(ve=>ve.uid===me.uid)),disabled:(0,Y.W)(me),onChange:Ne,hideDescription:!0},me.uid))]})})});J.displayName="RoleMenuGroupsSection";var q=(re=>(re.fixed="fixed",re.custom="custom",re.plugin="plugin",re))(q||{});const ae={ldap:"LDAP",current:"Current org"},j=(0,t.jsxs)(t.Fragment,{children:['You can now select the "No basic role" option and add permissions to your custom needs. You can find more information in\xA0',(0,t.jsx)(C.Y,{href:"https://grafana.com/docs/grafana/latest/administration/roles-and-permissions/#organization-roles",variant:"bodySmall",external:!0,children:"our documentation"}),"."]}),te=({basicRole:re,options:ue,appliedRoles:De,showGroups:ge,basicRoleDisabled:Te,disabledMessage:Le,showBasicRole:Ye,onSelect:je,onBasicRoleSelect:Ze,onUpdate:Ne,updateDisabled:Pe,offset:Ue,menuLeft:$e,apply:ze})=>{const[qe,dt]=(0,n.useState)(De),[vt,yt]=(0,n.useState)(re),[st,Ve]=(0,n.useState)({}),pe=(0,n.useRef)(null),Ee=(0,i.$j)(),me=(0,p.J)(Ee),ve=(0,i.of)(w);(0,n.useEffect)(()=>{je(qe)},[qe,je]),(0,n.useEffect)(()=>{Ze&&vt&&Ze(vt)},[vt,Ze]),(0,n.useEffect)(()=>{const nt=ue.filter(ne).sort(oe),gt=ue.filter(le).sort(oe),xt=ue.filter(z).sort(oe),St={fixed:ee(gt).sort((zt,Nt)=>zt.name.localeCompare(Nt.name)),custom:ee(nt).sort((zt,Nt)=>zt.name.localeCompare(Nt.name)),plugin:ee(xt).sort((zt,Nt)=>zt.name.localeCompare(Nt.name))};Ve({fixed:{groupType:"fixed",optionGroup:St.fixed,renderedName:"Fixed roles",roles:gt},custom:{groupType:"custom",optionGroup:St.custom,renderedName:"Custom roles",roles:nt},plugin:{groupType:"plugin",optionGroup:St.plugin,renderedName:"Plugin roles",roles:xt}})},[ue]);const Se=nt=>{const gt=[];for(const xt of qe)se(xt)===nt&&gt.push(xt);return gt},Ie=(nt,gt)=>{const xt=Se(gt),St=st[nt]?.optionGroup.find(zt=>zt.value===gt);return xt.length>0&&xt.length>=St.options.length},Oe=(nt,gt)=>{const xt=Se(gt),St=st[nt]?.optionGroup.find(zt=>zt.value===gt);return xt.length>0&&xt.length<St.options.length},Re=nt=>{qe.find(gt=>gt.uid===nt.uid)?dt(qe.filter(gt=>gt.uid!==nt.uid)):dt([...qe,nt])},he=(nt,gt)=>{const xt=st[nt]?.optionGroup.find(St=>St.value===gt);if(xt)if(Ie(nt,gt)||Oe(nt,gt))dt(qe.filter(St=>!xt.options.find(zt=>St.uid===zt.uid)));else{const St=xt.options.filter(Nt=>Nt.delegatable),zt=qe.filter(Nt=>!xt.options.find(Vt=>Nt.uid===Vt.uid));dt([...zt,...St])}},Ce=nt=>{yt(nt)},We=async()=>{dt([])},et=nt=>{const gt=qe.filter(xt=>se(xt)!==nt);dt(gt)},rt=()=>{Ne(qe,vt)};return(0,t.jsxs)("div",{className:(0,g.cx)(me.menu,ve.menuWrapper,{[ve.menuLeft]:$e},(0,g.css)({top:`${Ue.vertical}px`,left:$e?"unset":`${Ue.horizontal}px`,right:$e?`${Ue.horizontal}px`:"unset"})),children:[(0,t.jsxs)("div",{className:ve.menu,"aria-label":"Role picker menu",children:[(0,t.jsxs)(S.E,{autoHide:!1,autoHeightMax:`${y}px`,hideHorizontalTrack:!0,hideVerticalTrack:!0,className:(0,g.cx)(ve.hideScrollBar),children:[Ye&&(0,t.jsx)("div",{className:ve.menuSection,children:(0,t.jsx)(U,{value:vt,onChange:Ce,disabled:Te,disabledMesssage:Le,tooltipMessage:j})}),Object.entries(st).map(([nt,gt])=>(0,t.jsx)(J,{roles:gt.roles,renderedName:gt.renderedName,showGroups:ge,optionGroups:gt.optionGroup,groupSelected:xt=>Ie(gt.groupType,xt),groupPartiallySelected:xt=>Oe(gt.groupType,xt),onGroupChange:xt=>he(gt.groupType,xt),subMenuNode:pe?.current,selectedOptions:qe,onRoleChange:Re,onClearSubMenu:et,showOnLeftSubMenu:$e},nt))]}),(0,t.jsx)("div",{className:ve.menuButtonRow,children:(0,t.jsxs)(A.B,{justifyContent:"flex-end",children:[(0,t.jsx)(L.$n,{size:"sm",fill:"text",onClick:We,disabled:Pe,children:"Clear all"}),(0,t.jsx)(L.$n,{size:"sm",onClick:rt,disabled:Pe,children:ze?"Apply":"Update"})]})})]}),(0,t.jsx)("div",{ref:pe})]})},ne=re=>!re.name?.startsWith("fixed:")&&!re.name.startsWith("plugins:"),le=re=>re.name?.startsWith("fixed:"),z=re=>re.name?.startsWith("plugins:"),ee=re=>{const ue={};return re.forEach(ge=>{const Te=se(ge),Le=ie(ge);ue[Te]||(ue[Te]={name:Le,roles:[]}),ue[Te].roles.push(ge)}),Object.entries(ue).map(([ge,Te])=>({name:ae[ge]||ce(Te.name),value:ge,options:Te.roles.sort(oe)}))},se=re=>{const ue=Z(re),De=ie(re);return`${ue}:${De}`},ie=re=>re.group||"Other",Z=re=>{const ue=re.name.indexOf(":");return ue<0?"unknown":re.name.substring(0,ue)},oe=(re,ue)=>re.name.localeCompare(ue.name),ce=re=>re.slice(0,1).toUpperCase()+re.slice(1),ye=({basicRole:re,appliedRoles:ue,roleOptions:De,disabled:ge,isLoading:Te,basicRoleDisabled:Le,basicRoleDisabledMessage:Ye,showBasicRole:je,onRolesChange:Ze,onBasicRoleChange:Ne,canUpdateRoles:Pe=!0,apply:Ue=!1,maxWidth:$e=l,width:ze})=>{const[qe,dt]=(0,n.useState)(!1),[vt,yt]=(0,n.useState)(ue),[st,Ve]=(0,n.useState)(re),[pe,Ee]=(0,n.useState)(""),[me,ve]=(0,n.useState)({vertical:0,horizontal:0}),[Se,Ie]=(0,n.useState)(!1),Oe=(0,n.useRef)(null),Re=(0,i.$j)(),he=typeof ze=="number"?Re.spacing(ze):ze;(0,n.useEffect)(()=>{Ve(re),yt(ue)},[ue,re,Ne]);const Ce=(0,n.useCallback)(()=>{const{horizontal:Vt,vertical:en,menuToLeft:Je}=We();Vt&&en&&(ve({horizontal:Vt,vertical:en}),Ie(Je))},[]);(0,n.useEffect)(()=>{qe&&Ce()},[qe,vt,Ce]);const We=()=>{const Vt=Oe?.current?.getBoundingClientRect();if(!Vt)return{};const{bottom:en,top:Je,left:ct,right:ot}=Vt;let Qe=ct,pt=!1;const Pt=window.innerHeight-en;let At=en+5,mn=!1;return Pt<y+20&&(At=Je-y-50),Je<y+50&&(At=Je,Qe=ot+5,mn=!0),Qe+P>window.innerWidth&&(Qe=window.innerWidth-(mn?ct:ot),pt=!0),{horizontal:Qe,vertical:At,menuToLeft:pt}},et=(0,n.useCallback)(Vt=>{ge||(Vt.preventDefault(),Vt.stopPropagation(),Ce(),dt(!0))},[ge,Ce]),rt=(0,n.useCallback)(()=>{dt(!1),Ee(""),yt(ue),Ve(re)},[ue,re]),nt=()=>qe&&rt(),gt=Vt=>{Ee(Vt||"")},xt=Vt=>{yt(Vt)},St=Vt=>{Ve(Vt)},zt=(Vt,en)=>{Ne&&en&&en!==re&&Ne(en),Pe&&Ze(Vt),Ee(""),dt(!1)},Nt=()=>{const Vt=De.map(en=>({...en,delegatable:Pe&&en.delegatable}));return pe&&pe.trim()!==""?Vt.filter(en=>en.name?.toLowerCase().includes(pe.toLowerCase())):Vt};return(0,t.jsx)("div",{"data-testid":"role-picker",style:{position:"relative",maxWidth:he||$e,width:he},ref:Oe,children:(0,t.jsxs)(s.N,{onClick:nt,useCapture:!1,children:[(0,t.jsx)(M,{basicRole:st,appliedRoles:vt,query:pe,onQueryChange:gt,onOpen:et,onClose:rt,isFocused:qe,disabled:ge,showBasicRole:je,width:he,isLoading:Te}),qe&&(0,t.jsx)(r.ZL,{children:(0,t.jsx)("div",{onClick:Vt=>Vt.stopPropagation(),children:(0,t.jsx)(te,{options:Nt(),basicRole:st,appliedRoles:ue,onBasicRoleSelect:St,onSelect:xt,onUpdate:zt,showGroups:pe.length===0||pe.trim()==="",basicRoleDisabled:Le,disabledMessage:Ye,showBasicRole:je,updateDisabled:Le&&!Pe,apply:Ue,offset:me,menuLeft:Se})})})]})})}},89062:(k,R,e)=>{"use strict";e.d(R,{y:()=>c});var t=e(74848),n=e(96540),i=e(41053),s=e(10096),r=e(31678),g=e(37425),a=e(85927);const c=({basicRole:o,roles:h,userId:f,orgId:d,onBasicRoleChange:p,roleOptions:m,disabled:v,basicRoleDisabled:l,basicRoleDisabledMessage:y,apply:u=!1,onApplyRoles:D,pendingRoles:E,maxWidth:x,width:P,isLoading:b})=>{const[{loading:M,value:O=h||[]},I]=(0,i.A)(async()=>{try{if(h)return h;if(u&&E?.length)return E;if(s.TP.hasPermission(r.AccessControlAction.ActionUserRolesList)&&f>0)return await(0,a.Xh)(f,d)}catch{console.error("Error loading options")}return[]},[d,f,E,h]);(0,n.useEffect)(()=>{d&&I()},[I,d]);const T=async S=>{u?D&&D(S,f,d):(await(0,a.eA)(S,f,d),await I())},C=s.TP.hasPermission(r.AccessControlAction.ActionUserRolesAdd)&&s.TP.hasPermission(r.AccessControlAction.ActionUserRolesRemove);return(0,t.jsx)(g.n,{appliedRoles:O,basicRole:o,onRolesChange:T,onBasicRoleChange:p,roleOptions:m,isLoading:M||b,disabled:v,basicRoleDisabled:l,basicRoleDisabledMessage:y,showBasicRole:!0,apply:u,canUpdateRoles:C,maxWidth:x,width:P})}},85927:(k,R,e)=>{"use strict";e.d(R,{G3:()=>a,RL:()=>i,Xh:()=>s,eA:()=>r,xN:()=>g});var t=e(17172),n=e(3246);const i=async c=>{let o="/api/access-control/roles?delegatable=true";c&&(o+=`&targetOrgId=${c}`);const h=await(0,t.AI)().get(o);return!h||!h.length?[]:h.map(n.c)},s=async(c,o)=>{let h=`/api/access-control/users/${c}/roles`;o&&(h+=`?targetOrgId=${o}`);try{const f=await(0,t.AI)().get(h);return!f||!f.length?[]:f.map(n.c)}catch(f){return(0,t.NF)(f)&&(f.isHandled=!0),[]}},r=(c,o,h)=>{let f=`/api/access-control/users/${o}/roles`;h&&(f+=`?targetOrgId=${h}`);const d=c.flatMap(p=>p.uid);return(0,t.AI)().put(f,{orgId:h,roleUids:d})},g=async(c,o)=>{let h=`/api/access-control/teams/${c}/roles`;o&&(h+=`?targetOrgId=${o}`);try{const f=await(0,t.AI)().get(h);return!f||!f.length?[]:f.map(n.c)}catch(f){return(0,t.NF)(f)&&(f.isHandled=!0),[]}},a=(c,o,h)=>{let f=`/api/access-control/teams/${o}/roles`;h&&(f+=`?targetOrgId=${h}`);const d=c.flatMap(p=>p.uid);return(0,t.AI)().put(f,{orgId:h,roleUids:d})}},3246:(k,R,e)=>{"use strict";e.d(R,{W:()=>t,c:()=>n});const t=i=>i.delegatable!==void 0&&!i.delegatable,n=i=>{const s="fixed:";if(!i.displayName&&i.name.startsWith(s)){let r="";r=i.name.replace(s,"").replace(/:/g," "),i.displayName=r}return i}},47694:(k,R,e)=>{"use strict";e.d(R,{y:()=>h});var t=e(74848),n=e(8867),i=e(80997),s=e(62938);const r=2,g=5,a=m=>{const v=m.match(new RegExp('<style type="text/css">([\\s\\S]*?)<\\/style>'));return v?v[0]:null},c=m=>m.match(new RegExp(`<svg.*id\\s*=\\s*(['"])(.*?)\\1`))?.[r],o=m=>{let v=c(m);if(!v){v=`x${(0,s.A)()}`;const y=m.indexOf("<svg")+g;m=m.substring(0,y)+`id="${v}" `+m.substring(y)}let l=a(m);if(l){let y=l.replace(/(#(.*?))?\./g,`#${v} .`);m=m.replace(l,y)}return m},h=m=>{const{cleanStyle:v,...l}=m;return(0,t.jsx)(n.default,{...l,cacheRequests:!0,preProcessor:v?p:d})};let f=new Map;function d(m){let v=f.get(m);return v||(v=i.sQ.sanitizeSVGContent(m),f.set(m,v)),v}function p(m){let v=f.get(m);return v||(v=i.sQ.sanitizeSVGContent(m),v.indexOf('<style type="text/css">')>-1&&(v=o(v)),f.set(m,v)),v}},59429:(k,R,e)=>{"use strict";e.d(R,{b:()=>f});var t=e(74848),n=e(76459),i=e.n(n),s=e(96540),r=e(90182),g=e(27677),a=e(28676);const c=(d="Dashboards",p)=>`${d}/${p}`;async function o(d=""){return g.IB.search({type:"dash-db",query:d,limit:100}).then(p=>p.map(m=>({value:{uid:m.uid,title:m.title,folderTitle:m.folderTitle,folderUid:m.folderUid},label:c(m?.folderTitle,m.title)})))}const h=i()(o,250,{leading:!0}),f=({value:d,onChange:p,placeholder:m="Select dashboard",noOptionsMessage:v="No dashboards found",...l})=>{const[y,u]=(0,s.useState)();(0,s.useEffect)(()=>{!d||d===y?.value?.uid||(async()=>{const E=await(0,a.n)().getDashboardDTO(d);E.dashboard&&u({value:{uid:E.dashboard.uid,title:E.dashboard.title,folderTitle:E.meta.folderTitle,folderUid:E.meta.folderUid},label:c(E.meta?.folderTitle,E.dashboard.title)})})()},[d]);const D=(0,s.useCallback)(E=>{u(E),p?.(E?.value)},[p,u]);return(0,t.jsx)(r.DW,{loadOptions:h,onChange:D,placeholder:m,noOptionsMessage:v,value:y,defaultOptions:!0,...l})}},36607:(k,R,e)=>{"use strict";e.d(R,{d:()=>ie});var t=e(74848),n=e(96540),i=e(32264),s=e(32196),r=e(34743),g=e(36376),a=e(7315),c=e(76459),o=e.n(c),h=e(40845),f=e(10354),d=e(14578),p=e(42418),m=e(57514),v=e(8484),l=e(55314),y=e(24439),u=e(40957),D=e(31678),E=e(70255),x=e(91793),P=e(10022),b=e(29158),M=e(94753),O=e(18759),I=e(37690);const T=40,C="md",S=(oe,ce)=>`${oe}-${ce||"root"}`;function A({items:oe,focusedItemIndex:ce,foldersAreOpenable:ye,idPrefix:re,selectedFolder:ue,onFolderExpand:De,onFolderSelect:ge,isItemLoaded:Te,requestLoadMore:Le}){const Ye=(0,n.useRef)(null),je=(0,h.of)(F),Ze=(0,n.useMemo)(()=>({items:oe,focusedItemIndex:ce,foldersAreOpenable:ye,selectedFolder:ue,onFolderExpand:De,onFolderSelect:ge,idPrefix:re}),[oe,ce,ye,ue,De,ge,re]),Ne=(0,n.useCallback)(Ue=>Te(Ue),[Te]),Pe=(0,n.useCallback)((Ue,$e)=>{const{parentUID:ze}=oe[Ue];Le(ze)},[Le,oe]);return(0,t.jsx)("div",{className:je.table,role:"tree",children:oe.length>0?(0,t.jsx)(P.A,{ref:Ye,itemCount:oe.length,isItemLoaded:Ne,loadMoreItems:Pe,children:({onItemsRendered:Ue,ref:$e})=>(0,t.jsx)(x.Y1,{ref:$e,height:T*Math.min(6.5,oe.length),width:"100%",itemData:Ze,itemSize:T,itemCount:oe.length,onItemsRendered:Ue,children:N})}):(0,t.jsx)("div",{className:je.emptyMessage,children:(0,t.jsx)(v.x6,{i18nKey:"browse-dashboards.folder-picker.empty-message",children:"No folders found"})})})}const L=[100,200,130,160,150];function N({index:oe,style:ce,data:ye}){const{items:re,focusedItemIndex:ue,foldersAreOpenable:De,selectedFolder:ge,onFolderExpand:Te,onFolderSelect:Le,idPrefix:Ye}=ye,{item:je,isOpen:Ze,level:Ne,parentUID:Pe}=re[oe],Ue=(0,n.useRef)(null),$e=(0,n.useId)(),ze=(0,D.useSelector)(I.ku),qe=(0,D.useSelector)(I.Am),dt=(je.uid?qe[je.uid]:ze)?.items??[];let vt=[];je.uid&&(vt=(Pe?qe[Pe]:ze)?.items??[]);const yt=(0,h.of)(F),st=(0,n.useCallback)(pe=>{pe.preventDefault(),pe.stopPropagation(),je.uid&&Te(je.uid,!Ze)},[je.uid,Ze,Te]),Ve=(0,n.useCallback)(()=>{je.kind==="folder"&&Le(je)},[je,Le]);return je.kind==="ui"&&je.uiKind==="pagination-placeholder"?(0,t.jsxs)("span",{style:ce,className:yt.row,children:[(0,t.jsx)(O.T,{level:Ne,spacing:2}),(0,t.jsx)(E.A,{width:L[oe%L.length]})]}):je.kind!=="folder"?null:(0,t.jsx)("div",{ref:Ue,style:ce,className:(0,s.cx)(yt.row,{[yt.rowFocused]:oe===ue,[yt.rowSelected]:je.uid===ge}),tabIndex:-1,onClick:Ve,"aria-expanded":Ze,"aria-selected":je.uid===ge,"aria-labelledby":$e,"aria-level":Ne+1,role:"treeitem","aria-owns":dt.length>0?dt.map(pe=>S(Ye,pe.uid)).join(" "):void 0,"aria-setsize":dt.length,"aria-posinset":vt.findIndex(pe=>pe.uid===je.uid)+1,id:S(Ye,je.uid),children:(0,t.jsxs)("div",{className:yt.rowBody,children:[(0,t.jsx)(O.T,{level:Ne,spacing:2}),De?(0,t.jsx)(b.K,{size:C,onMouseDown:st,tabIndex:-1,"aria-label":Ze?`Collapse folder ${je.title}`:`Expand folder ${je.title}`,name:Ze?"angle-down":"angle-right"}):(0,t.jsx)("span",{className:yt.folderButtonSpacer}),(0,t.jsx)("label",{className:yt.label,id:$e,children:(0,t.jsx)(M.E,{truncate:!0,children:je.title})})]})})}const F=oe=>{const ce=(0,s.css)({height:T,display:"flex",position:"relative",alignItems:"center",flexGrow:1,gap:oe.spacing(.5),overflow:"hidden",padding:oe.spacing(0,1)});return{table:(0,s.css)({background:oe.components.input.background}),emptyMessage:(0,s.css)({padding:oe.spacing(1),textAlign:"center",width:"100%"}),folderButtonSpacer:(0,s.css)({paddingLeft:oe.spacing(.5)}),row:(0,s.css)({display:"flex",position:"relative",alignItems:"center",":not(:first-child)":{borderTop:`solid 1px ${oe.colors.border.weak}`}}),rowFocused:(0,s.css)({backgroundColor:oe.colors.background.secondary}),rowSelected:(0,s.css)({"&::before":{display:"block",content:'""',position:"absolute",left:0,bottom:0,top:0,width:4,borderRadius:oe.shape.radius.default,backgroundImage:oe.colors.gradients.brandVertical}}),rowBody:ce,label:(0,s.css)({lineHeight:T+"px",flexGrow:1,minWidth:0,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap","&:hover":{textDecoration:"underline",cursor:"pointer"}})}};var w=e(16797);function B({handleClearSelection:oe,isLoading:ce,invalid:ye,label:re,...ue},De){const ge=(0,h.$j)(),Te=K(ge,ye),Le=Ye=>{(Ye.key==="Enter"||Ye.key===" ")&&oe?.(Ye)};return(0,t.jsx)("div",{className:Te.wrapper,children:(0,t.jsxs)("div",{className:Te.inputWrapper,children:[re?(0,t.jsx)("div",{className:Te.prefix,children:(0,t.jsx)(d.I,{name:"folder"})}):void 0,(0,t.jsxs)("button",{type:"button",className:(0,s.cx)(Te.fakeInput,re?Te.hasPrefix:void 0),...ue,ref:De,children:[ce?(0,t.jsx)(E.A,{width:100}):re?(0,t.jsx)(M.E,{truncate:!0,children:re}):(0,t.jsx)(M.E,{truncate:!0,color:"secondary",children:(0,t.jsx)(v.x6,{i18nKey:"browse-dashboards.folder-picker.button-label",children:"Select folder"})}),!ce&&oe&&(0,t.jsx)(d.I,{role:"button",tabIndex:0,"aria-label":(0,v.t)("browse-dashboards.folder-picker.clear-selection","Clear selection"),className:Te.clearIcon,name:"times",onClick:oe,onKeyDown:Le})]}),(0,t.jsx)("div",{className:Te.suffix,children:(0,t.jsx)(d.I,{name:"angle-down"})})]})})}const U=(0,n.forwardRef)(B),K=(oe,ce=!1)=>{const ye=(0,f.n)({theme:oe,invalid:ce});return{wrapper:ye.wrapper,inputWrapper:ye.inputWrapper,prefix:(0,s.css)([ye.prefix,{pointerEvents:"none",color:oe.colors.text.primary}]),suffix:(0,s.css)([ye.suffix,{pointerEvents:"none"}]),fakeInput:(0,s.css)([ye.input,{textAlign:"left",letterSpacing:"normal","&:focus":{outline:"unset",boxShadow:"unset"},"&:focus-visible":(0,s.css)`
          ${(0,w.focusCss)(oe)}
        `,alignItems:"center",display:"flex",flexWrap:"nowrap",justifyContent:"space-between",paddingRight:28}]),hasPrefix:(0,s.css)({paddingLeft:28}),clearIcon:(0,s.css)({color:oe.colors.text.secondary,cursor:"pointer","&:hover":{color:oe.colors.text.primary},"&:focus:not(:focus-visible)":(0,w.getMouseFocusStyles)(oe),"&:focus-visible":(0,w.getFocusStyles)(oe)})}};var V=e(25508),H=e(92955),Y=e(93519),X=e(64756);const J=(0,V.Mz)([oe=>oe,(oe,ce)=>ce],(oe,ce)=>{const ye=new Set,re=[],ue={};let De=!1;for(const ge of ce){if(ye.has(ge.requestId))continue;const Te=l.cU.endpoints.listFolders.select({parentUid:ge.arg.parentUid,page:ge.arg.page,limit:ge.arg.limit,permission:ge.arg.permission})(oe);Te.status==="pending"&&(De=!0);const Le=Te.originalArgs?.parentUid;Le?(ue[Le]||(ue[Le]=[]),ue[Le].push(Te)):re.push(Te)}return{isLoading:De,rootPages:re,pagesByParent:ue}});function q(oe){const ce=oe.at(-1),ye=ce?.originalArgs?.page;return ce?.data?[ce.data.length<ce.originalArgs.limit,ye]:[!1,ye]}function ae(oe,ce,ye){const re=(0,X.wA)(),ue=(0,n.useRef)([]),De=(0,X.d4)(Le=>J(Le,ue.current)),ge=(0,n.useCallback)(Le=>{const Ye=Le?De.pagesByParent[Le]:De.rootPages,[je,Ze]=q(Ye??[]);if(je)return;const Ne={parentUid:Le,page:(Ze??0)+1,limit:H.md,permission:ye},Pe=re(l.cU.endpoints.listFolders.initiate(Ne));ue.current=ue.current.concat([Pe])},[De,re,ye]);return(0,n.useEffect)(()=>()=>{for(const Le of ue.current)Le.unsubscribe()},[]),{items:(0,n.useMemo)(()=>{if(!oe)return[];function Le(je,Ze,Ne){const Pe=Ze.flatMap($e=>($e.data??[]).flatMap(qe=>{const dt=ce[qe.uid],vt={isOpen:!!dt,level:Ne,item:{kind:"folder",title:qe.title,uid:qe.uid}},yt=dt&&De.pagesByParent[qe.uid];if(yt){const st=Le(qe.uid,yt,Ne+1);return[vt,...st]}return vt})),[Ue]=q(Ze);return Ue||Pe.push(...(0,Y.T)(H.md,je,Ne)),Pe}const Ye=Le(void 0,De.rootPages,1);return Ye.unshift(j),Ye},[De,oe,ce]),isLoading:De.isLoading,requestNextPage:ge}}const j={isOpen:!0,level:0,item:{kind:"folder",title:"Dashboards",uid:""}};function te({tree:oe,handleCloseOverlay:ce,handleFolderSelect:ye,handleFolderExpand:re,idPrefix:ue,search:De,visible:ge}){const[Te,Le]=(0,n.useState)(-1),Ye=!!i.$.featureToggles.nestedFolders;(0,n.useEffect)(()=>{ge&&Le(-1)},[ge]),(0,n.useEffect)(()=>{Le(0)},[De]),(0,n.useEffect)(()=>{document.getElementById(S(ue,oe[Te]?.item.uid))?.scrollIntoView({block:"nearest",inline:"nearest"})},[Te,ue,oe]);const je=(0,n.useCallback)(Ze=>{const Ne=Ye&&!De;switch(Ze.key){case"ArrowRight":case"ArrowLeft":Ne&&(Ze.preventDefault(),re(oe[Te].item.uid,Ze.key==="ArrowRight"));break;case"ArrowUp":Te>0&&(Ze.preventDefault(),Le(Te-1));break;case"ArrowDown":Te<oe.length-1&&(Ze.preventDefault(),Le(Te+1));break;case"Enter":Ze.preventDefault();const Pe=oe[Te].item;Pe.kind==="folder"&&ye(Pe);break;case"Tab":Ze.stopPropagation(),ce();break;case"Escape":Ze.stopPropagation(),Ze.preventDefault(),ce();break}},[Te,ce,re,ye,Ye,De,oe]);return{focusedItemIndex:Te,handleKeyDown:je}}const ne=o()(le,300);async function le(oe,ce){const ye=await(0,y.getGrafanaSearcher)().search({query:oe,kind:["folder"],limit:100,permission:ce}),re=ye.view.map(ue=>(0,u.hI)(ue,ye.view));return{...ye,items:re}}function z({value:oe,invalid:ce,showRootFolder:ye=!0,clearable:re=!1,excludeUIDs:ue,permission:De=D.PermissionLevelString.Edit,onChange:ge}){const Te=(0,h.of)(ee),Le=(0,l.kH)(oe||l.hT),Ye=!!i.$.featureToggles.nestedFolders,[je,Ze]=(0,n.useState)(""),[Ne,Pe]=(0,n.useState)(null),[Ue,$e]=(0,n.useState)(!1),[ze,qe]=(0,n.useState)(!1),[dt,vt]=(0,n.useState)(!1),[yt,st]=(0,n.useState)({}),Ve=(0,n.useId)(),[pe]=(0,n.useState)(void 0),Ee=(0,n.useRef)(0),me=!!(dt&&!(je&&Ne)),{items:ve,isLoading:Se,requestNextPage:Ie}=ae(me,yt,De);(0,n.useEffect)(()=>{if(!je){Pe(null);return}const Pt=Date.now();$e(!0),ne(je,De).then(At=>{if(Pt>Ee.current){const mn=At.view.map(Pn=>(0,u.hI)(Pn,At.view));Pe({...At,items:mn}),$e(!1),Ee.current=Pt}})},[je,De]);const Oe=[(0,r.UU)({crossAxis:!1,boundary:document.body})],{context:Re,refs:he,floatingStyles:Ce,elements:We}=(0,g.we)({open:dt,placement:"bottom",onOpenChange:Pt=>{Pt&&(Ze(""),qe(!0)),vt(Pt)},middleware:Oe,whileElementsMounted:a.ll}),et=(0,g.kp)(Re),rt=(0,g.s9)(Re),{getReferenceProps:nt,getFloatingProps:gt}=(0,g.bv)([rt,et]),xt=(0,n.useCallback)(async(Pt,At)=>{st(mn=>({...mn,[Pt]:At})),At&&!yt[Pt]&&Ie(Pt)},[Ie,yt]),St=(0,n.useCallback)(Pt=>{ge&&ge(Pt.uid,Pt.title),vt(!1)},[ge]),zt=(0,n.useCallback)(Pt=>{Pt.preventDefault(),Pt.stopPropagation(),ge&&ge(void 0,void 0)},[ge]),Nt=(0,n.useCallback)(()=>vt(!1),[vt]),Vt=(0,n.useCallback)(Pt=>{je||Ie(Pt)},[je,Ie]),en=(0,n.useMemo)(()=>{let Pt=[];return me?Pt=ve:Pt=Ne?.items.map(At=>({isOpen:!1,level:0,item:{kind:"folder",title:At.title,uid:At.uid}}))??[],(!ye||ue?.length)&&(Pt=Pt.filter(At=>!(!ye&&At===j||ue?.includes(At.item.uid)))),Pt},[ve,ue,me,Ne?.items,ye]),Je=(0,n.useCallback)(Pt=>{const At=en[Pt];if(!At)return!1;const mn=At.item;return!(mn.kind==="ui"&&mn.uiKind==="pagination-placeholder")},[en]),ct=Se||Ue,{focusedItemIndex:ot,handleKeyDown:Qe}=te({tree:en,handleCloseOverlay:Nt,handleFolderSelect:St,handleFolderExpand:xt,idPrefix:Ve,search:je,visible:dt});let pt=Le.data?.title;return oe===""&&(pt="Dashboards"),dt?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(f.p,{ref:he.setReference,autoFocus:!0,prefix:pt?(0,t.jsx)(d.I,{name:"folder"}):null,placeholder:pt??(0,v.t)("browse-dashboards.folder-picker.search-placeholder","Search folders"),value:je,invalid:ce,className:Te.search,onChange:Pt=>Ze(Pt.currentTarget.value),"aria-autocomplete":"list","aria-expanded":!0,"aria-haspopup":!0,"aria-controls":Ve,"aria-owns":Ve,"aria-activedescendant":S(Ve,en[ot]?.item.uid),role:"combobox",suffix:(0,t.jsx)(d.I,{name:"search"}),...nt(),onKeyDown:Qe}),(0,t.jsx)("fieldset",{ref:he.setFloating,id:Ve,className:Te.tableWrapper,style:{...Ce,width:We.domReference?.clientWidth},...gt(),children:pe?(0,t.jsx)(p.F,{className:Te.error,severity:"warning",title:(0,v.t)("browse-dashboards.folder-picker.error-title","Error loading folders"),children:pe.message||pe.toString?.()||(0,v.t)("browse-dashboards.folder-picker.unknown-error","Unknown error")}):(0,t.jsxs)("div",{children:[ct&&(0,t.jsx)("div",{className:Te.loader,children:(0,t.jsx)(m.G,{width:600})}),(0,t.jsx)(A,{items:en,selectedFolder:oe,focusedItemIndex:ot,onFolderExpand:xt,onFolderSelect:St,idPrefix:Ve,foldersAreOpenable:Ye&&!(je&&Ne),isItemLoaded:Je,requestLoadMore:Vt})]})})]}):(0,t.jsx)(U,{label:pt,handleClearSelection:re&&oe!==void 0?zt:void 0,invalid:ce,isLoading:Le.isLoading,autoFocus:ze,ref:he.setReference,"aria-label":pt?(0,v.t)("browse-dashboards.folder-picker.accessible-label","Select folder: {{ label }} currently selected",{label:pt}):void 0,...nt()})}const ee=oe=>({button:(0,s.css)({maxWidth:"100%"}),error:(0,s.css)({marginBottom:0}),tableWrapper:(0,s.css)({boxShadow:oe.shadows.z3,position:"relative",zIndex:oe.zIndex.portal}),loader:(0,s.css)({position:"absolute",top:0,left:0,right:0,zIndex:oe.zIndex.portal+1,overflow:"hidden"}),search:(0,s.css)({input:{cursor:"default"}})});var se=e(85242);function ie(oe){const ce=i.$.featureToggles.newFolderPicker||i.$.featureToggles.nestedFolders,{initialTitle:ye,dashboardId:re,enableCreateNew:ue,...De}=oe;return ce?(0,t.jsx)(z,{...De}):(0,t.jsx)(Z,{...oe})}function Z({value:oe,showRootFolder:ce,onChange:ye,initialTitle:re,dashboardId:ue,enableCreateNew:De,inputId:ge,skipInitialLoad:Te}){const Le=(0,n.useCallback)(Ye=>{ye&&ye(Ye.uid,Ye.title)},[ye]);return(0,t.jsx)(se.sR,{onChange:Le,showRoot:ce,initialFolderUid:oe,initialTitle:re,inputId:ge,skipInitialLoad:Te,dashboardId:ue,enableCreateNew:De})}},85242:(k,R,e)=>{"use strict";e.d(R,{sR:()=>E});var t=e(74848),n=e(32196),i=e(76459),s=e.n(i),r=e(96540),g=e(16817),a=e(26272),c=e(13544),o=e(14110),h=e(40845),f=e(10354),d=e(90182),p=e(28138),m=e(8484),v=e(16233),l=e(11230),y=e(31678);const u="+ Add new",D="-10";function E(M){const{dashboardId:O,allowEmpty:I,onChange:T,filter:C,enableCreateNew:S,inputId:A,onClear:L,enableReset:N,initialFolderUid:F,initialTitle:w="",permissionLevel:B=y.PermissionLevelString.Edit,rootName:U,showRoot:K=!0,skipInitialLoad:V,searchQueryType:H,customAdd:Y,folderWarning:X,invalid:J}=M,q=U??"Dashboards",[ae,j]=(0,r.useState)(null),[te,ne]=(0,r.useState)(!1),[le,z]=(0,r.useState)(""),[ee,se]=(0,r.useState)(ae?.title??""),ie=(0,h.of)(b),Z=typeof L=="function",oe=(0,r.useCallback)(async Ze=>{const Ne=await(0,l.c0)(Ze,B,H),Ue=x(Ne,C);return(0,o.rR)("grafana_folder_picker_results_loaded",{results:Ue.length,searchTermLength:Ze.length,enableCreateNew:!!S}),(v.TP.hasPermission(y.AccessControlAction.DashboardsWrite)||v.TP.hasPermission(y.AccessControlAction.DashboardsCreate))&&q?.toLowerCase().startsWith(Ze.toLowerCase())&&K&&Ue.unshift({label:q,value:""}),N&&Ze===""&&w!==""&&!Ue.find(ze=>ze.label===w)&&Ue.unshift({label:w,value:F}),S&&Y?[...Ue,{value:D,label:u,title:Ze}]:Ue},[N,F,w,B,q,K,H,C,S,Y]),ce=(0,r.useMemo)(()=>s()(oe,300,{leading:!0}),[oe]),ye=async()=>{const Ze={label:w,value:void 0},Ne={label:q,value:""},Pe=await oe("");let Ue=null;F!=null?Ue=Pe.find($e=>$e.value===F)||null:N&&w?Ue=Ze:F&&(Ue=Pe.find($e=>$e.id===F)||null),!Ue&&!I&&(v.TP.isEditor?Ue=Ne:!!O?Ue=Ze:Ue=Pe.length>0?Pe[0]:Ze),!te&&j(Ue)};(0,r.useEffect)(()=>{ae&&ae.value!==F&&!te&&ae.value&&ae.label&&T({uid:ae.value,title:ae.label})},[ae,F]),(0,g.A)(async()=>{if(V){const Ze=await P({getFolder:l.Ql,folderUid:F,folderName:w});j(Ze)}await ye()},[V,F,w]),(0,r.useEffect)(()=>{ae&&ae.id===D&&ne(!0)},[ae]);const re=(0,r.useCallback)((Ze,Ne)=>{if(Ze?.value===D)j({id:D,title:le}),se(le);else{if(Ze||(Ze={value:"",label:q}),Ne.action==="clear"&&L){L();return}j(Ze),T({uid:Ze.value,title:Ze.label})}},[T,L,q,le]),ue=(0,r.useCallback)(async Ze=>{if(X?.warningCondition(Ze))return(0,o.rR)("grafana_folder_picker_folder_created",{status:"failed_condition"}),!1;const Ne=await(0,l.vV)({title:Ze});let Pe={value:"",label:"Not created"};return Ne.uid?((0,o.rR)("grafana_folder_picker_folder_created",{status:"success"}),p.A.emit(a.r1.alertSuccess,["Folder Created","OK"]),Pe={value:Ne.uid,label:Ne.title},j(Ne),re(Pe,{action:"create-option",option:Pe})):((0,o.rR)("grafana_folder_picker_folder_created",{status:"failed"}),p.A.emit(a.r1.alertError,["Folder could not be created"])),Pe},[X,re]),De=(0,r.useCallback)(Ze=>{const Ne=!!Y?.disallowValues;if(Ze.key==="Enter"&&Ne&&!Y?.isAllowedValue(ee)){Ze.preventDefault();return}switch(Ze.key){case"Enter":{ue(ae?.title),ne(!1);break}case"Escape":j({value:"",label:q}),ne(!1)}},[Y?.disallowValues,Y?.isAllowedValue,ee,ue,ae?.title,q]),ge=Ze=>{const Ne=Ze.currentTarget.value;se(Ne),j({id:void 0,title:Ne})},Te=()=>{j({value:"",label:q}),ne(!1)},Le=(Ze,{action:Ne})=>{Ne==="input-change"&&z(Pe=>Ze),Ne==="menu-close"&&z(Pe=>Ze)},Ye=()=>X?.warningCondition(ee)?(0,t.jsx)(X.warningComponent,{}):null,je=()=>X?.warningCondition(le)?(0,t.jsx)(X.warningComponent,{}):null;return te?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Ye,{}),(0,t.jsx)("div",{className:ie.newFolder,children:"Press enter to create the new folder."}),(0,t.jsx)(f.p,{width:30,autoFocus:!0,value:ee,onChange:ge,onKeyDown:De,placeholder:"Press enter to confirm new folder.",onBlur:Te})]}):(0,t.jsxs)("div",{"data-testid":c.Tp.components.FolderPicker.containerV2,children:[(0,t.jsx)(je,{}),(0,t.jsx)(d.gZ,{inputId:A,"data-testid":c.Tp.components.FolderPicker.input,loadingMessage:(0,m.t)("folder-picker.loading","Loading folders..."),defaultOptions:!0,defaultValue:ae,inputValue:le,onInputChange:Le,value:ae,allowCustomValue:S&&!Y,loadOptions:ce,onChange:re,onCreateOption:ue,invalid:J,isClearable:Z})]})}function x(M,O){return(O?O(M):M).map(T=>({label:T.title,value:T.uid}))}async function P({folderName:M,folderUid:O,getFolder:I}){if(O==null)throw new Error("folderUid is not found.");return M?{label:M,value:O}:{label:(await I(O)).title,value:O}}const b=M=>({newFolder:(0,n.css)({color:M.colors.warning.main,fontSize:M.typography.bodySmall.fontSize,paddingBottom:M.spacing(1)})})},73725:(k,R,e)=>{"use strict";e.d(R,{r:()=>c});var t=e(74848),n=e(16817),i=e(90182),s=e(14578),r=e(53477),g=e(24439);const a=()=>(0,g.getGrafanaSearcher)().getSortOptions();function c({onChange:o,value:h,placeholder:f,filter:d,getSortOptions:p,isClearable:m}){const v=(0,n.A)(async()=>{const y=await(p??a)();return d?y.filter(u=>d.includes(u.value)):y},[p,d]);if(v.loading)return null;const l=!!(h?.includes("desc")||h?.startsWith("-"));return(0,t.jsx)(i.l6,{width:28,onChange:o,value:v.value?.find(y=>y.value===h)??null,options:v.value,"aria-label":"Sort",placeholder:f??`Sort (Default ${r.r4.label})`,prefix:(0,t.jsx)(s.I,{name:l?"sort-amount-down":"sort-amount-up"}),isClearable:m},h)}},46334:(k,R,e)=>{"use strict";e.d(R,{$:()=>a,E:()=>g});var t=e(74848),n=e(32196),i=e(69613),s=e(40845),r=e(14578);const g=({count:c,label:o,onClick:h,removeIcon:f})=>{const{color:d}=(0,i.MC)(o),p=(0,s.of)(a),m=c!==0&&(0,t.jsx)("span",{style:{marginLeft:"3px"},children:`(${c})`});return(0,t.jsxs)("span",{className:p.badge,style:{backgroundColor:d},children:[f&&(0,t.jsx)(r.I,{onClick:h,name:"times"}),o," ",m]})},a=c=>({badge:(0,n.css)({...c.typography.bodySmall,backgroundColor:c.v1.palette.gray1,borderRadius:c.shape.radius.default,color:c.v1.palette.white,display:"inline-block",height:"20px",lineHeight:"20px",padding:c.spacing(0,.75),verticalAlign:"baseline",whiteSpace:"nowrap","&:hover":{opacity:.85}})})},99818:(k,R,e)=>{"use strict";e.d(R,{$:()=>m});var t=e(74848),n=e(32196),i=e(96540),s=e(28581),r=e(54479),g=e(40845),a=e(90182),c=e(14578),o=e(8484),h=e(46334);const f=({data:l,className:y,label:u,isFocused:D,innerProps:E})=>{const x=(0,g.of)(d);return(0,t.jsx)("div",{className:(0,n.cx)(x.option,D&&x.optionFocused),"aria-label":"Tag option",...E,children:(0,t.jsx)("div",{className:(0,n.cx)(x.optionInner,y),children:typeof u=="string"?(0,t.jsx)(h.E,{label:u,removeIcon:!1,count:l.count??0}):u})})},d=l=>({option:(0,n.css)({padding:l.spacing(1),whiteSpace:"nowrap",cursor:"pointer",borderLeft:"2px solid transparent","&:hover":{background:l.colors.background.secondary}}),optionFocused:(0,n.css)({background:l.colors.background.secondary,borderStyle:"solid",borderTop:0,borderRight:0,borderBottom:0,borderLeftWidth:"2px"}),optionInner:(0,n.css)({position:"relative",textAlign:"left",width:"100%",display:"block",cursor:"pointer",padding:"2px 0"})}),p=(l,y)=>RegExp((0,r.jD)(y),"i").test(l.value),m=({allowCustomValue:l=!1,formatCreateLabel:y,hideValues:u,inputId:D,isClearable:E,onChange:x,placeholder:P,tagOptions:b,tags:M,width:O})=>{const I=(0,g.of)(v),T=M.map(X=>({value:X,label:X,count:0})),[C,S]=(0,i.useState)(T),[A,L]=(0,i.useState)(!1),[N,F]=(0,i.useState)(M),[w,B]=(0,i.useState)(T),U=(0,i.useMemo)(()=>M.join(),[M]),K=(0,i.useCallback)(async()=>(await b()).map(J=>M.includes(J.term)?{value:J.term,label:J.term,count:0}:{value:J.term,label:J.term,count:J.count}),[b,M]),V=(0,i.useCallback)(async()=>{L(!0);const X=await K();l&&w.forEach(J=>X.push(J)),S(X),L(!1)},[l,w,K]);(0,i.useEffect)(()=>{M.length>0&&C.length===0&&V()},[V,C.length,M.length]),(0,i.useEffect)(()=>{M!==N&&(F(M),V())},[V,N,M]);const H=X=>{X.forEach(J=>J.count=0),x((X||[]).map(J=>J.value)),l&&B(X.filter(J=>!M.includes(J)))},Y={onFocus:V,isLoading:A,options:C,allowCreateWhileLoading:!0,allowCustomValue:l,formatCreateLabel:y,defaultOptions:!0,filterOption:p,getOptionLabel:X=>X.label,getOptionValue:X=>X.value,inputId:D,isMulti:!0,onChange:H,loadingMessage:(0,o.t)("tag-filter.loading","Loading..."),noOptionsMessage:(0,o.t)("tag-filter.no-tags","No tags found"),placeholder:P||(0,o.t)("tag-filter.placeholder","Filter by tag"),value:T,width:O,components:{Option:f,MultiValueLabel:()=>null,MultiValueRemove(X){const{data:J}=X;return(0,t.jsx)(s.c.MultiValueRemove,{...X,children:(0,t.jsx)(h.E,{label:J.label,removeIcon:!0,count:J.count},J.label)})},MultiValueContainer:u?()=>null:s.c.MultiValueContainer}};return(0,t.jsxs)("div",{className:I.tagFilter,children:[E&&M.length>0&&(0,t.jsx)("button",{className:I.clear,onClick:()=>H([]),children:"Clear tags"}),(0,t.jsx)(a.KF,{...Y,prefix:(0,t.jsx)(c.I,{name:"tag-alt"}),"aria-label":"Tag filter"},U)]})};m.displayName="TagFilter";const v=l=>{const y=(0,h.$)(l);return{tagFilter:(0,n.css)({position:"relative",minWidth:"180px",flexGrow:1,[`.${y.badge}`]:{marginLeft:"6px",cursor:"pointer"}}),clear:(0,n.css)({background:"none",border:"none",textDecoration:"underline",fontSize:"12px",padding:"none",position:"absolute",top:"-17px",right:0,cursor:"pointer",color:l.colors.text.secondary,"&:hover":{color:l.colors.text.primary}})}}},25573:(k,R,e)=>{"use strict";e.d(R,{m:()=>d});var t=e(74848),n=e(2543),i=e.n(n),s=e(26272),r=e(65879),g=e(47232),a=e(15666),c=e(76412),o=e(28138),h=e(61680);const f="grafana.dashboard.timepicker.history",d=u=>(0,t.jsx)(h.b,{storageKey:f,defaultValue:[],children:(D,E)=>{const x=m(D),P=p(x);return(0,t.jsx)(a.$6,{...u,history:P,onChange:b=>{v(b,x,E),u.onChange(b)},onError:b=>o.A.emit(s.r1.alertError,[(0,c.t)("time-picker.copy-paste.default-error-title","Invalid time range"),(0,c.t)("time-picker.copy-paste.default-error-message","{{error}} is not a valid time range",{error:b})])})}});function p(u){return u.map(D=>r.convertRawToRange(D,"utc",void 0,"YYYY-MM-DD HH:mm:ss"))}function m(u){return u.map(D=>{const E=typeof D.from=="string"?D.from:D.from.toISOString(),x=typeof D.to=="string"?D.to:D.to.toISOString();return{from:E,to:x}})}function v(u,D,E){if(!l(u))return;const x={from:typeof u.raw.from=="string"?u.raw.from:u.raw.from.toISOString(),to:typeof u.raw.to=="string"?u.raw.to:u.raw.to.toISOString()},P=y([x,...D]);E(P)}function l(u){return(0,g.Ar)(u.raw.from)||(0,g.Ar)(u.raw.to)}function y(u){return(0,n.uniqBy)(u,D=>D.from+D.to).slice(0,4)}},82389:(k,R,e)=>{"use strict";e.d(R,{I:()=>f});var t=e(74848),n=e(96540),i=e(24293),s=e(11261),r=e(52622),g=e(67266),a=e(96516),c=e(30249),o=e(28895);const h=["rowHeight","colWidth","showValue","mergeValues","alignValue","tooltip","paginationRev"];class f extends n.Component{constructor(){super(...arguments),this.getValueColor=(p,m,v)=>{const l=this.props.frames[p]?.fields[m];if(l?.display){const y=l.display(v);if(y.color)return y.color}return i.F},this.prepConfig=(p,m,v)=>(0,o.iE)({frame:p,getTimeRange:v,allFrames:this.props.frames,...this.props,timeZones:Array.isArray(this.props.timeZone)?this.props.timeZone:[this.props.timeZone],rowHeight:p.fields.length>2?this.props.rowHeight:1,getValueColor:this.getValueColor,hoverMulti:this.props.tooltip?.mode===r.$N.Multi}),this.renderLegend=p=>{const{legend:m,legendItems:v}=this.props;return!p||!v||!m||m.showLegend===!1?null:(0,t.jsx)(g.KU.Legend,{placement:m.placement,children:(0,t.jsx)(a.t,{placement:m.placement,items:v,displayMode:m.displayMode,readonly:!0})})}}render(){return(0,t.jsx)(c.o,{...this.props,fields:{x:p=>p.type===s.PU.time,y:p=>p.type===s.PU.number||p.type===s.PU.boolean||p.type===s.PU.string||p.type===s.PU.enum},prepConfig:this.prepConfig,propsToDiff:h,renderLegend:this.renderLegend})}}},28895:(k,R,e)=>{"use strict";e.d(R,{pm:()=>S,GY:()=>Y,c5:()=>X,jY:()=>V,EI:()=>U,uB:()=>B,iE:()=>L,Qe:()=>w,Or:()=>K});var t=e(24293),n=e(28240),i=e(83195),s=e(11261),r=e(50082),g=e(58563),a=e(47737),c=e(73060),o=e(46294),h=e(39624),f=e(73134),d=e(52622),p=e(51336),m=e(52811),v=e(16895),l=e(36613),y=e(23596),u=e(39758),D=e(4134);const{round:E,min:x,ceil:P}=Math,b=2;let M=6;const O=u.ur;function I(J,q,ae,j,te){(0,u.mn)(ae,J,O,q,(ne,le,z)=>{let ee=j*le,se=j*z;te(ne,ee,se)})}function T(J){const{mode:q,numSeries:ae,isDiscrete:j,hasMappedNull:te,rowHeight:ne=0,colWidth:le=0,showValue:z,mergeValues:ee=!1,theme:se,label:ie,formatValue:Z,alignValue:oe="left",getTimeRange:ce,getValueColor:ye,getFieldConfig:re,hoverMulti:ue}=J;let De,ge;const Te=ve=>{ge=Array(ae).fill(null).map(Se=>Array(ve).fill(null))},Le=`500 ${Math.round(12*devicePixelRatio)}px ${se.typography.fontFamily}`,Ye=Array(ae).fill(null);let je=null;const Ze=[le,1/0],Ne=1-Ze[0],Pe=(Ze[1]??1/0)*l.A.pxRatio,Ue=new Map,$e=new Map;function ze(ve){Ue.forEach((Se,Ie)=>{ve.fillStyle=Ie,ve.fill(Se)}),$e.forEach((Se,Ie)=>{ve.strokeStyle=Ie,ve.stroke(Se)}),Ue.clear(),$e.clear()}function qe(ve,Se,Ie,Oe,Re,he,Ce,We,et,rt,nt,gt,xt){Ce=Math.max(1,Ce);const St=ye(rt+1,gt),zt=re(rt),Nt=C(zt,St);if(ge[rt][nt]={x:E(Re-Ie),y:E(he-Oe),w:Ce,h:We,sidx:rt+1,didx:nt,fillColor:Nt},xt){let Vt=Nt,en=Ue.get(Vt);if(en==null&&Ue.set(Vt,en=new Path2D),Se(en,Re,he,Ce,We),et){let Je=St,ct=$e.get(Je);ct==null&&$e.set(Je,ct=new Path2D),Se(ct,Re+et/2,he+et/2,Ce-et,We-et)}}else ve.beginPath(),Se(ve,Re,he,Ce,We),ve.fillStyle=Nt,ve.fill(),et&&(ve.beginPath(),Se(ve,Re+et/2,he+et/2,Ce-et,We-et),ve.strokeStyle=St,ve.lineWidth=et,ve.stroke())}const dt=(ve,Se,Ie,Oe)=>(l.A.orient(ve,Se,(Re,he,Ce,We,et,rt,nt,gt,xt,St,zt,Nt,Vt,en)=>{let Je=E((Re.width||0)*l.A.pxRatio),ct=j(Se),ot=ct&&te(Se);ve.ctx.save(),en(ve.ctx,ve.bbox.left,ve.bbox.top,ve.bbox.width,ve.bbox.height),ve.ctx.clip(),I(ne,Se-1,ae,zt,(Qe,pt,Pt)=>{if(q===S.Changes)for(let At=0;At<Ce.length;At++){let mn=Ce[At];if(mn!=null||ot){let Pn=Math.round(rt(he[At],We,St,gt)),fn=At;for(;++fn<Ce.length&&(Ce[fn]===void 0||ee&&Ce[fn]===mn););let Rn=fn===Ce.length?gt+St+Je:Math.round(rt(he[fn],We,St,gt));qe(ve.ctx,en,gt,xt,Pn,E(xt+pt),Rn-Pn,E(Pt),Je,Qe,At,mn,ct),At=fn-1}}else if(q===S.Samples){let At=rt(he[1],We,St,gt)-rt(he[0],We,St,gt),mn=At*Ne,Pn=E(x(Pe,At-mn)-Je),fn=Pn/2;for(let Rn=Ie;Rn<=Oe;Rn++){let Kn=Ce[Rn];if(Kn!=null||ot){let Bt=rt(he[Rn],We,St,gt);qe(ve.ctx,en,gt,xt,E(Bt-fn),E(xt+pt),Pn,E(Pt),Je,Qe,Rn,Kn,ct)}}}}),ct&&(ve.ctx.lineWidth=Je,ze(ve.ctx)),ve.ctx.restore()}),null),vt=Z==null||z===d.yL.Never?!1:(ve,Se,Ie,Oe)=>(ve.ctx.save(),ve.ctx.rect(ve.bbox.left,ve.bbox.top,ve.bbox.width,ve.bbox.height),ve.ctx.clip(),ve.ctx.font=Le,ve.ctx.textAlign=q===S.Changes?oe:"center",ve.ctx.textBaseline="middle",l.A.orient(ve,Se,(Re,he,Ce,We,et,rt,nt,gt,xt,St,zt)=>{let Nt=E((Re.width||0)*l.A.pxRatio),en=j(Se)&&te(Se),Je=E(nt(Ee[Se-1],et,zt,xt));for(let ct=0;ct<Ce.length;ct++)if(Ce[ct]!=null||en){const ot=ge[Se-1][ct];if(!ot||ot.x>=St)continue;let Qe=Math.floor(ot?.w/M);if(z===d.yL.Auto&&Qe<2)continue;let pt=Z(Se,Ce[ct]),Pt=E(ot.x+gt+ot.w/2);q===S.Changes&&(oe==="left"?Pt=E(ot.x+gt+Nt+b):oe==="right"&&(Pt=E(ot.x+gt+ot.w-Nt-b))),ve.ctx.fillStyle=se.colors.getContrastText(ot.fillColor,3),ve.ctx.fillText(pt.slice(0,Qe),Pt,Je)}}),ve.ctx.restore(),!1),yt=ve=>{let Se="";for(let Ie=32;Ie<=126;Ie++)Se+=String.fromCharCode(Ie);M=Math.ceil(ve.ctx.measureText(Se).width/Se.length*l.A.pxRatio),M+=2.5,ve.root.querySelectorAll(".u-cursor-pt").forEach(Ie=>{Ie.style.borderRadius="0"})},st=ve=>{De=De||new D.C$(0,0,ve.bbox.width,ve.bbox.height),De.clear(),Te(ve.data[0].length),ve.series.forEach(Se=>{Se._paths=null})};function Ve(ve,Se,Ie=!1){Ye.fill(null),je=null,!(ve<0)&&De.get(ve,0,l.A.pxRatio,1e4,Oe=>{ve>=Oe.x&&ve<=Oe.x+Oe.w&&(Se>=Oe.y&&Se<=Oe.y+Oe.h?Ye[Oe.sidx]=je=Oe:(ue||Ie)&&(Ye[Oe.sidx]=Oe))})}const pe={x:q===S.Changes,y:!1,dataIdx:(ve,Se)=>{if(Se===1){if(De.o.length===0&&De.q==null)for(const Re of ge)for(const he of Re)he&&De.add(he);let Ie=ve.cursor.left*l.A.pxRatio,Oe=ve.cursor.top*l.A.pxRatio;Ve(Ie,Oe,ve.cursor.event==null)}return Ye[Se]?.didx},focus:{prox:1e3,dist:(ve,Se)=>je?.sidx===Se?0:1/0},points:{fill:"rgba(255,255,255,0.2)",bbox:(ve,Se)=>{let Ie=Ye[Se],Oe=Ie!=null;return{left:Oe?Ie.x/l.A.pxRatio:-10,top:Oe?Ie.y/l.A.pxRatio:-10,width:Oe?Ie.w/l.A.pxRatio:0,height:Oe?Ie.h/l.A.pxRatio:0}}}},Ee=Array(ae).fill(0),me=[0,1];return{cursor:pe,xSplits:q===S.Samples?(ve,Se,Ie,Oe,Re,he)=>{let Ce=[],We=ve.data[0][1]-ve.data[0][0],et=P(Re/We);for(let rt=0;rt<ve.data[0].length;rt+=et){let nt=ve.data[0][rt];nt>=Ie&&nt<=Oe&&Ce.push(nt)}return Ce}:null,xRange:ve=>{const Se=ce();let Ie=Se.from.valueOf(),Oe=Se.to.valueOf();if(q===S.Samples){let Ce=(ve.data[0][1]-ve.data[0][0])/2;Ie<=ve.data[0][0]&&(Ie=ve.data[0][0]-Ce);let We=ve.data[0].length-1;Oe>=ve.data[0][We]&&(Oe=ve.data[0][We]+Ce)}return[Ie,Oe]},ySplits:ve=>(I(ne,null,ae,ve.bbox.height,(Se,Ie,Oe)=>{let Re=E(Ie+Oe/2);Ee[Se]=ve.posToVal(Re/l.A.pxRatio,m.s)}),Ee),yValues:(ve,Se)=>Se.map((Ie,Oe)=>ie(Oe+1)),yRange:me,drawPaths:dt,drawPoints:vt,init:yt,drawClear:st}}function C(J,q){if(q[0]==="#"&&q.length===9)return q;const ae=(J.fillOpacity??100)/100;return(0,y.X4)(q,ae)}var S=(J=>(J.Changes="changes",J.Samples="samples",J))(S||{});const A={lineWidth:0,fillOpacity:80},L=({frame:J,theme:q,timeZones:ae,getTimeRange:j,mode:te,rowHeight:ne,colWidth:le,showValue:z,alignValue:ee,mergeValues:se,getValueColor:ie,hoverMulti:Z})=>{const oe=new p.e(ae[0]),ce="x",ye=Le=>{const Ye=Le.config?.color?.mode;return!(Ye&&Le.display&&Ye.startsWith("continuous-"))},re=Le=>Le.config.mappings?.some(Ye=>Ye.type===f.dM.SpecialValue&&Ye.options.match==="null")||!1,ue=(Le,Ye)=>{const je=J.fields[Le];return je.state?.origin?.fieldIndex!==void 0&&je.state?.origin?.frameIndex!==void 0&&ie?ie(je.state?.origin?.frameIndex,je.state?.origin?.fieldIndex,Ye):t.F},De={mode:te,numSeries:J.fields.length-1,isDiscrete:Le=>ye(J.fields[Le]),hasMappedNull:Le=>re(J.fields[Le]),mergeValues:se,rowHeight:ne,colWidth:le,showValue:z,alignValue:ee,theme:q,label:Le=>(0,n.Ct)(J.fields[Le],J),getFieldConfig:Le=>J.fields[Le].config.custom,getValueColor:ue,getTimeRange:j,formatValue:(Le,Ye)=>(0,i.cN)(J.fields[Le].display(Ye)),hoverMulti:Z},ge=T(De);oe.addHook("init",ge.init),oe.addHook("drawClear",ge.drawClear),oe.setPrepData(Le=>(0,v.bq)(Le[0],(0,v.ro)(Le[0]))),oe.setCursor(ge.cursor),oe.addScale({scaleKey:ce,isTime:!0,orientation:d.Lt.Horizontal,direction:d.ON.Right,range:ge.xRange}),oe.addScale({scaleKey:m.s,isTime:!1,orientation:d.Lt.Vertical,direction:d.ON.Up,range:ge.yRange}),oe.addAxis({scaleKey:ce,isTime:!0,splits:ge.xSplits,placement:d.vM.Bottom,timeZone:ae[0],theme:q,grid:{show:!0}}),oe.addAxis({scaleKey:m.s,isTime:!1,placement:d.vM.Left,splits:ge.ySplits,values:ge.yValues,grid:{show:!1},ticks:{show:!1},gap:16,theme:q});let Te=0;for(let Le=0;Le<J.fields.length;Le++){if(Le===0)continue;const Ye=J.fields[Le],je=Ye.config,Ze={...A,...je.custom};Ye.state.seriesIndex=Te++,oe.addSeries({scaleKey:m.s,pathBuilder:ge.drawPaths,pointsBuilder:ge.drawPoints,lineWidth:Ze.lineWidth,fillOpacity:Ze.fillOpacity,theme:q,show:!Ze.hideFrom?.viz,thresholds:je.thresholds,dataFrameFieldIndex:Ye.state?.origin})}return oe};function N(J){let q=J.config.custom?.spanNulls;return q?q===!0?1/0:q:-1}function F(J,q){const ae=J.config.thresholds;if(J.type!==s.PU.number||!ae||!ae.steps.length)return;const j=U(J.config,q);if(j.length!==ae.steps.length)return;const te=new Map,ne=new Map;for(let ee=0;ee<j.length;ee++)te.set(ae.steps[ee],j[ee].label),ne.set(j[ee].label,j[ee].color);let le=J.values;const z=new Array(J.values.length);if(ae.mode===r.O.Percentage){const{min:ee,max:se}=(0,g.xg)(J),ie=se-ee;le=le.map(Z=>Z==null?Z:(Z-ee)/ie*100)}for(let ee=0;ee<z.length;ee++){const se=le[ee];se==null?z[ee]=se:z[ee]=te.get((0,a.yQ)(se,ae.steps))}return{...J,config:{...J.config,custom:{...J.config.custom,spanNulls:N(J)}},type:s.PU.string,values:z,display:ee=>({text:String(ee),color:ne.get(String(ee)),numeric:NaN})}}function w(J,q,ae,j){if(!J?.length)return{warn:"No data in response"};(0,n.Fm)(J);let te=!1;const ne=[];for(let le of J){let z=-1,ee=-1;for(let ce=0;ce<le.fields.length;ce++)if(le.fields[ce].type===s.PU.time){if(z===-1)z=ce;else if(ee===-1){ee=ce;break}}let se=z!==-1,ie=!1;if(le=(0,c.Yj)(le,z),ee!==-1){let ce={...le,fields:le.fields.filter((re,ue)=>ue!==ee)},ye={length:le.length,fields:[le.fields[ee]]};le=(0,c.Fd)({frames:[ce,ye],keepDisplayNames:!0,nullMode:()=>c.WO}),le.fields.forEach((re,ue)=>{if(ue>0){let De=re.values;for(let ge=0;ge<De.length;ge++)De[ge]==null&&(De[ge]=null)}}),ie=!0}let Z=(0,o.M)({frame:le,refFieldPseudoMin:ae.from.valueOf(),refFieldPseudoMax:ae.to.valueOf()});Z!==le&&(ie=!0),le=(0,h.C)(Z);const oe=[];for(let ce of le.fields)if(!ce.config.custom?.hideFrom?.viz)switch(ce.type){case s.PU.time:se=!0,te=!0,oe.push(ce);break;case s.PU.enum:case s.PU.number:if(q&&ce.config.color?.mode===t.Y.Thresholds){const ye=F(ce,j);if(ye){oe.push(ye),ie=!0;continue}}case s.PU.boolean:case s.PU.string:ce={...ce,config:{...ce.config,custom:{...ce.config.custom,spanNulls:N(ce)}}},ie=!0,oe.push(ce);break;default:ie=!0}se&&oe.length>1&&(te=!0,ie?ne.push({...le,fields:oe}):ne.push(le))}return te?ne.length?{frames:ne}:{warn:"No graphable fields"}:{warn:"Data does not have a time field"}}function B(J){const q=[];for(let ae of J){const j=ae.fields.filter(te=>te.type===s.PU.time);if(j.length>0)for(let te of ae.fields)te.type!==s.PU.time&&q.push({fields:[...j,te],length:ae.length})}return q}function U(J,q){const ae=[],j=J.thresholds;if(!j||!j.steps.length)return ae;const te=j.steps,ne=(0,i.j_)(j.mode===r.O.Percentage?"percent":J.unit??""),le=z=>(0,i.cN)(ne(z,J.decimals??void 0));for(let z=0;z<te.length;z++){let ee=te[z],se=ee.value,ie="",Z="";se===-1/0&&z<te.length-1?(se=te[z+1].value,ie="< "):Z="+",ae.push({label:`${ie}${le(se)}${Z}`,color:q.visualization.getColorByName(ee.color),yAxis:1})}return ae}function K(J,q,ae){if(!(!J||q.showLegend===!1))return V(H(J),ae)}function V(J,q){if(!J.length)return;const ae=[],j=J[0].config,te=j.color?.mode??t.Y.Fixed,ne=j.thresholds;if(te===t.Y.Thresholds&&ne?.steps&&ne.steps.length>1)return U(j,q);if(te.startsWith("continuous"))return;const le=new Map;return J.forEach(z=>{z.config.custom?.hideFrom?.legend||z.values.forEach(ee=>{let se=z.display(ee);se.color&&le.set(se.text,se.color)})}),le.forEach((z,ee)=>{ee.length>0&&ae.push({label:ee,color:q.visualization.getColorByName(z??t.F),yAxis:1})}),ae}function H(J){const q=[];for(const ae of J)for(const j of ae.fields)j.type!==s.PU.time&&q.push(j);return q}function Y(J,q){let ae,j=q+1;if(j>=J.values.length)return null;const te=J.values[q];for(;ae===void 0;){if(j>=J.values.length)return null;const ne=J.values[j];ne===void 0||ne===te?j++:ae=j}return ae}function X(J){if(J<0||Number.isNaN(J))return"";let q,ae,j,te,ne,le,z,ee;return z=Math.floor(J/1e3),le=Math.floor(z/60),z=z%60,ne=Math.floor(le/60),le=le%60,te=Math.floor(ne/24),ne=ne%24,q=Math.floor(te/365),q>0&&(te=te%365),ae=Math.floor(te/30),ae>0&&(te=te%30),j=Math.floor(te/7),j>0&&(te=te%7),ee=Math.round(J%1e3*1e3)/1e3,(q>0?q+"y "+(ae>0?ae+"mo ":"")+(j>0?j+"w ":"")+(te>0?te+"d ":""):ae>0?ae+"mo "+(j>0?j+"w ":"")+(te>0?te+"d ":""):j>0?j+"w "+(te>0?te+"d ":""):te>0?te+"d "+(ne>0?ne+"h ":""):ne>0?ne+"h "+(le>0?le+"m ":""):le>0?le+"m "+(z>0?z+"s ":""):z>0?z+"s "+(ee>0?ee+"ms ":""):ee>0?ee+"ms ":"0").trim()}},35043:(k,R,e)=>{"use strict";e.d(R,{DP:()=>h,NQ:()=>o,zJ:()=>f});var t=e(74848),n=e(32196),i=e(90613),s=e(40845),r=e(14578),g=e(94753),a=e(2913),c=e(8484);const o=[{message:"At least 12 characters",validation:m=>m.length>=12},{message:"One uppercase letter",validation:m=>/[A-Z]+/.test(m)},{message:"One lowercase letter",validation:m=>/[a-z]+/.test(m)},{message:"One number",validation:m=>/[0-9]+/.test(m)},{message:"One symbol",validation:m=>/[\W]/.test(m)}],h=m=>!a.Ay.auth.basicAuthStrongPasswordPolicy||o.every(v=>v.validation(m))||(0,c.t)("profile.change-password.strong-password-validation-register","Password does not comply with the strong password policy"),f=({strongPasswordValidations:m,password:v,pristine:l})=>(0,t.jsx)(i.a,{marginBottom:2,children:m.map(y=>(0,t.jsx)(d,{strongPasswordValidation:y,password:v,pristine:l},y.message))}),d=({strongPasswordValidation:m,password:v,pristine:l})=>{const y=(0,s.of)(p),{basicAuthStrongPasswordPolicy:u}=a.Ay.auth;if(!u)return null;const{message:D,validation:E}=m,x=v.length>0&&E(v),P=x||l?"check":"exclamation-triangle",b=x?"secondary":l?"primary":"error";let M;return x?M=y.icon.valid:l?M=y.icon.pending:M=y.icon.error,(0,t.jsxs)(i.a,{display:"flex",alignItems:"center",marginTop:1,children:[(0,t.jsx)(r.I,{className:(0,n.cx)(y.icon.style,M),name:P}),(0,t.jsx)(g.E,{color:b,children:D})]},D)},p=m=>({icon:{style:(0,n.css)({marginRight:m.spacing(1)}),valid:(0,n.css)({color:m.colors.success.text}),pending:(0,n.css)({color:m.colors.secondary.text}),error:(0,n.css)({color:m.colors.error.text})}})},93522:(k,R,e)=>{"use strict";e.d(R,{N:()=>f});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(37390),g=e(71259),a=e(94753),c=e(8484),o=e(63917);const h=v=>[{category:(0,c.t)("help-modal.shortcuts-category.global","Global"),shortcuts:[{keys:["g","h"],description:(0,c.t)("help-modal.shortcuts-description.go-to-home-dashboard","Go to Home Dashboard")},{keys:["g","d"],description:(0,c.t)("help-modal.shortcuts-description.go-to-dashboards","Go to Dashboards")},{keys:["g","e"],description:(0,c.t)("help-modal.shortcuts-description.go-to-explore","Go to Explore")},{keys:["g","p"],description:(0,c.t)("help-modal.shortcuts-description.go-to-profile","Go to Profile")},{keys:[`${v} + k`],description:(0,c.t)("help-modal.shortcuts-description.open-search","Open search")},{keys:["esc"],description:(0,c.t)("help-modal.shortcuts-description.exit-edit/setting-views","Exit edit/setting views")},{keys:["?"],description:(0,c.t)("help-modal.shortcuts-description.show-all-shortcuts","Show all keyboard shortcuts")},{keys:["c","t"],description:(0,c.t)("help-modal.shortcuts-description.change-theme","Change theme")}]},{category:(0,c.t)("help-modal.shortcuts-category.time-range","Time range"),shortcuts:[{keys:["t","z"],description:(0,c.t)("help-modal.shortcuts-description.zoom-out-time-range","Zoom out time range")},{keys:["t","\u2190"],description:(0,c.t)("help-modal.shortcuts-description.move-time-range-back","Move time range back")},{keys:["t","\u2192"],description:(0,c.t)("help-modal.shortcuts-description.move-time-range-forward","Move time range forward")},{keys:["t","a"],description:(0,c.t)("help-modal.shortcuts-description.make-time-range-permanent","Make time range absolute/permanent")},{keys:["t","c"],description:(0,c.t)("help-modal.shortcuts-description.copy-time-range","Copy time range")},{keys:["t","v"],description:(0,c.t)("help-modal.shortcuts-description.paste-time-range","Paste time range")}]},{category:(0,c.t)("help-modal.shortcuts-category.dashboard","Dashboard"),shortcuts:[{keys:[`${v} + s`],description:(0,c.t)("help-modal.shortcuts-description.save-dashboard","Save dashboard")},{keys:["d","r"],description:(0,c.t)("help-modal.shortcuts-description.refresh-all-panels","Refresh all panels")},{keys:["d","s"],description:(0,c.t)("help-modal.shortcuts-description.dashboard-settings","Dashboard settings")},{keys:["d","v"],description:(0,c.t)("help-modal.shortcuts-description.toggle-active-mode","Toggle in-active / view mode")},{keys:["d","k"],description:(0,c.t)("help-modal.shortcuts-description.toggle-kiosk","Toggle kiosk mode (hides top nav)")},{keys:["d","\u21E7 + e"],description:(0,c.t)("help-modal.shortcuts-description.expand-all-rows","Expand all rows")},{keys:["d","\u21E7 + c"],description:(0,c.t)("help-modal.shortcuts-description.collapse-all-rows","Collapse all rows")},{keys:["d","a"],description:(0,c.t)("help-modal.shortcuts-description.toggle-auto-fit","Toggle auto fit panels (experimental feature)")},{keys:[`${v} + o`],description:(0,c.t)("help-modal.shortcuts-description.toggle-graph-crosshair","Toggle shared graph crosshair")},{keys:["d","l"],description:(0,c.t)("help-modal.shortcuts-description.toggle-all-panel-legends","Toggle all panel legends")},{keys:["d","x"],description:(0,c.t)("help-modal.shortcuts-description.toggle-exemplars","Toggle exemplars in all panel")}]},{category:(0,c.t)("help-modal.shortcuts-category.focused-panel","Focused panel"),shortcuts:[{keys:["e"],description:(0,c.t)("help-modal.shortcuts-description.toggle-panel-edit","Toggle panel edit view")},{keys:["v"],description:(0,c.t)("help-modal.shortcuts-description.toggle-panel-fullscreen","Toggle panel fullscreen view")},{keys:["p","s"],description:(0,c.t)("help-modal.shortcuts-description.open-shared-modal","Open Panel Share Modal")},{keys:["p","d"],description:(0,c.t)("help-modal.shortcuts-description.duplicate-panel","Duplicate Panel")},{keys:["p","r"],description:(0,c.t)("help-modal.shortcuts-description.remove-panel","Remove Panel")},{keys:["p","l"],description:(0,c.t)("help-modal.shortcuts-description.toggle-panel-legend","Toggle panel legend")}]}],f=({onDismiss:v})=>{const l=(0,s.of)(m),y=(0,i.useMemo)(()=>(0,o.gn)(),[]),u=(0,i.useMemo)(()=>h(y),[y]);return(0,t.jsx)(r.a,{title:(0,c.t)("help-modal.title","Shortcuts"),isOpen:!0,onDismiss:v,onClickBackdrop:v,children:(0,t.jsx)(g.x,{columns:{xs:1,sm:2},gap:3,tabIndex:0,children:Object.values(u).map(({category:D,shortcuts:E})=>(0,t.jsx)("section",{children:(0,t.jsxs)("table",{className:l.table,children:[(0,t.jsx)("caption",{children:(0,t.jsx)(a.E,{element:"p",variant:"h5",children:D})}),(0,t.jsx)("thead",{className:"sr-only",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Keys"}),(0,t.jsx)("th",{children:"Description"})]})}),(0,t.jsx)("tbody",{children:E.map(({keys:x,description:P})=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{className:l.keys,children:x.map(b=>(0,t.jsx)(d,{children:b},b))}),(0,t.jsx)("td",{children:(0,t.jsx)(a.E,{variant:"bodySmall",element:"p",children:P})})]},x.join()))})]})},D))})})},d=({children:v})=>{const l=(0,s.of)(m),y=(0,i.useMemo)(()=>p(v),[v]),u=(0,t.jsx)("span",{dangerouslySetInnerHTML:{__html:y}});return(0,t.jsx)("kbd",{className:l.shortcutTableKey,children:(0,t.jsx)(a.E,{variant:"code",children:u})})};function p(v){let l,y;if(v.includes("ctrl"))l="ctrl",y="Control";else if(v.includes("esc"))l="esc",y="Escape";else return v;return v.replace(l,`<span class="sr-only">${y}</span><span aria-hidden="true" role="none">${l}</span>`)}function m(v){return{table:(0,n.css)({borderCollapse:"separate",borderSpacing:v.spacing(2),"& caption":{captionSide:"top"}}),keys:(0,n.css)({textAlign:"end",whiteSpace:"nowrap",minWidth:83}),shortcutTableKey:(0,n.css)({display:"inline-block",textAlign:"center",marginRight:v.spacing(.5),padding:"3px 5px",lineHeight:"10px",verticalAlign:"middle",border:`solid 1px ${v.colors.border.medium}`,borderRadius:v.shape.radius.default,color:v.colors.text.primary,backgroundColor:v.colors.background.secondary})}}},2913:(k,R,e)=>{"use strict";e.d(R,{Ay:()=>s,_R:()=>g,config:()=>n.$,yn:()=>a,zj:()=>r});var t=e(43429),n=e(32264);let i=n.$;const s=i,r=()=>i,g=c=>{i={...i,...c}},a=n.$.panels?.debug?.state===t.pn.alpha},15054:(k,R,e)=>{"use strict";e.d(R,{FG:()=>d,HG:()=>r,IZ:()=>h,MM:()=>m,Pz:()=>s,bJ:()=>a,cV:()=>i,cx:()=>c,dU:()=>n,o9:()=>g,sD:()=>t,tH:()=>o,wV:()=>p});const t=30,n=8,i=24,s="v",r="h",g=4,a=250,c=t*3,o="panel-copy",h=2,f=23763571993,d=40,p="VisualizationSelectPane.ListMode",m="WidgetSelectPane.ListMode"},76888:(k,R,e)=>{"use strict";e.d(R,{Il:()=>r,YE:()=>s,k9:()=>c,ni:()=>g});var t=e(96540),n=e(39601),i=e(32264);const s=(0,t.createContext)(void 0);function r(){const o=(0,t.useContext)(s);if(!o)throw new Error("No GrafanaContext found");return o}function g(){const{chrome:o}=r();return(0,t.useCallback)((h,f)=>{const{pathname:d,search:p}=n.Ny.getLocation();o.setReturnToPrevious({title:h,href:f??d+p})},[o])}const a=40;function c(){const{chrome:o}=r(),{kioskMode:h,searchBarHidden:f,chromeless:d}=o.useState();return h||d||!i.$.featureToggles.bodyScrolling?0:f?a:a*2}},3169:(k,R,e)=>{"use strict";e.d(R,{Cf:()=>d,_2:()=>p,gi:()=>h,q8:()=>f,tZ:()=>o});var t=e(96540),n=e(62938),i=e(94954),s=e(31678),r=e(82467);const g={title:"",text:"",severity:s.AppNotificationSeverity.Success,icon:"check"},a={title:"",text:"",severity:s.AppNotificationSeverity.Warning,icon:"exclamation-triangle"},c={title:"",text:"",severity:s.AppNotificationSeverity.Error,icon:"exclamation-triangle"},o=(m,v="",l)=>({...g,title:m,text:v,id:(0,n.A)(),timestamp:Date.now(),showing:!0}),h=(m,v="",l,y)=>({...c,text:(0,i.q)(v),title:m,id:(0,n.A)(),traceId:l,component:y,timestamp:Date.now(),showing:!0}),f=(m,v="",l)=>({...a,title:m,text:v,traceId:l,id:(0,n.A)(),timestamp:Date.now(),showing:!0}),d=(m,v="",l)=>({severity:s.AppNotificationSeverity.Info,icon:"info-circle",title:m,text:v,id:(0,n.A)(),timestamp:Date.now(),showing:!0});function p(){const m=(0,s.useDispatch)();return(0,t.useMemo)(()=>({success:(v,l="")=>{m((0,r.dx)(o(v,l)))},warning:(v,l="",y)=>{m((0,r.dx)(f(v,l,y)))},error:(v,l="",y)=>{m((0,r.dx)(h(v,l,y)))},info:(v,l="")=>{m((0,r.dx)(d(v,l)))}}),[m])}},10096:(k,R,e)=>{"use strict";e.d(R,{Ef:()=>n.E,TP:()=>i.TP,lE:()=>t.A,rO:()=>s.r});var t=e(28138),n=e(18898),i=e(16233),s=e(31140)},39640:(k,R,e)=>{"use strict";e.d(R,{$H:()=>o,Ay:()=>h});var t=e(2543),n=e(33390),i=e(38877),s=e(19347);const r=D=>{const E=(0,s.l)().getInstanceSettings(D.datasourceName);return{id:D.ts.toString(),createdAt:D.ts,datasourceName:D.datasourceName,datasourceUid:E?.uid||"",starred:D.starred,comment:D.comment,queries:D.queries}},g=D=>{if(!(0,s.l)().getInstanceSettings({uid:D.datasourceUid}))throw new Error("Datasource not found.");return{ts:D.createdAt,datasourceName:D.datasourceName,starred:D.starred,comment:D.comment,queries:D.queries}};var a=e(75533);const c="grafana.explore.richHistory",o=1e4;class h{async getRichHistory(E){const x=m().map(r),P=E.starred?x.filter(O=>O.starred===!0):x,b=E.from&&E.to?[E.from,E.to]:void 0,M=(0,a.a_)(P,E.sortOrder,E.datasourceFilters,E.search,b);return{richHistory:M,total:M.length}}async addToRichHistory(E){const x=Date.now(),P={id:x.toString(),createdAt:x,...E},b=g(P),M=d(m()),O=b.queries.map(A=>(0,t.omit)(A,["key","refId"])),I=M.length>0&&M[0].queries.map(A=>(0,t.omit)(A,["key","refId"]));if((0,t.isEqual)(O,I)){const A=new Error("Entry already exists");throw A.name=i.m.DuplicatedEntry,A}const{queriesToKeep:T,limitExceeded:C}=p(M),S=[b,...T];try{n.A.setObject(c,S)}catch(A){if(A instanceof Error&&A.name==="QuotaExceededError")u(i.m.StorageFull,`Saving rich history failed: ${A.message}`);else throw A}return C?{warning:{type:i.C.LimitExceeded,message:`Query history reached the limit of ${o}. Old, not-starred items have been removed.`},richHistoryQuery:P}:{richHistoryQuery:P}}async deleteAll(){n.A.delete(c)}async deleteRichHistory(E){const x=parseInt(E,10),b=n.A.getObject(c,[]).filter(M=>M.ts!==x);n.A.setObject(c,b)}async updateStarred(E,x){return f(E,P=>P.starred=x)}async updateComment(E,x){return f(E,P=>P.comment=x)}async getSettings(){return{activeDatasourcesOnly:n.A.getObject(a.mE.activeDatasourcesOnly)??n.A.getObject(a.mE.legacyActiveDatasourceOnly,!1),retentionPeriod:n.A.getObject(a.mE.retentionPeriod,7),starredTabAsFirstTab:n.A.getBool(a.mE.starredTabAsFirstTab,!1),lastUsedDatasourceFilters:n.A.getObject(a.mE.datasourceFilters,[]).map(x=>x.value)}}async updateSettings(E){n.A.set(a.mE.activeDatasourcesOnly,E.activeDatasourcesOnly),n.A.set(a.mE.retentionPeriod,E.retentionPeriod),n.A.set(a.mE.starredTabAsFirstTab,E.starredTabAsFirstTab),n.A.setObject(a.mE.datasourceFilters,(E.lastUsedDatasourceFilters||[]).map(x=>({value:x})))}}function f(D,E){const x=parseInt(D,10),P=n.A.getObject(c,[]),b=(0,t.find)(P,{ts:x});if(!b)throw new Error("Rich history item not found.");return E(b),n.A.setObject(c,P),r(b)}function d(D){const E=n.A.getObject(a.mE.retentionPeriod,7),x=(0,a.wQ)(E,{isLastTs:!1});return D.filter(P=>P.ts>x||P.starred===!0)||[]}function p(D){let E=!1,x=D.length-1;for(;x>=0&&D.length>=o;)D[x].starred||(D.splice(x,1),E=!0),x--;return{queriesToKeep:D,limitExceeded:E}}function m(){const D=n.A.getObject(c,[]);return v(D)}function v(D){return D.map(x=>{const P=x.queries.map((b,M)=>l(x,b,M));return{...x,queries:P}})}function l(D,E,x){const P="ABCDEFGHIJKLMNOPQRSTUVXYZ";return typeof E=="object"?E:y(E)?JSON.parse(E):{expr:E,refId:P[x]}}function y(D){try{JSON.parse(D)}catch{return!1}return!0}function u(D,E){const x=new Error(E);throw x.name=D,x}},38877:(k,R,e)=>{"use strict";e.d(R,{C:()=>n,m:()=>t});var t=(i=>(i.StorageFull="StorageFull",i.DuplicatedEntry="DuplicatedEntry",i))(t||{}),n=(i=>(i.LimitExceeded="LimitExceeded",i))(n||{})},75533:(k,R,e)=>{"use strict";e.d(R,{a_:()=>r,mE:()=>f,wQ:()=>g});var t=e(2543),n=e.n(t),i=e(47232),s=e(91650);function r(d,p,m,v,l){const y=c(d,m),u=o(y,v),D=l?a(u,l):u;return h(D,p)}const g=(d,p)=>{let m=p.now;return m||(m=p.tz?(0,i.oZ)(p.tz):(0,i.KQ)()),m.add(-d,"d"),(p.isLastTs?m.endOf("d"):m.startOf("d")).valueOf()};function a(d,p){return d.filter(m=>m.createdAt>p[0]&&m.createdAt<p[1])}function c(d,p){return p.length>0?d.filter(m=>p.includes(m.datasourceName)):d}function o(d,p){return d.filter(m=>m.comment.includes(p)?!0:m.queries.filter(l=>Object.values((0,t.omit)(l,["datasource","key","refId","hide","queryType"])).some(y=>y?.toString().includes(p))).length>0)}const h=(d,p)=>{let m;return p===s.x.Ascending&&(m=(v,l)=>v.createdAt<l.createdAt?-1:v.createdAt>l.createdAt?1:0),p===s.x.Descending&&(m=(v,l)=>v.createdAt<l.createdAt?1:v.createdAt>l.createdAt?-1:0),p===s.x.DatasourceZA&&(m=(v,l)=>v.datasourceName<l.datasourceName?-1:v.datasourceName>l.datasourceName?1:0),p===s.x.DatasourceAZ&&(m=(v,l)=>v.datasourceName<l.datasourceName?1:v.datasourceName>l.datasourceName?-1:0),d.sort(m)},f={retentionPeriod:"grafana.explore.richHistory.retentionPeriod",starredTabAsFirstTab:"grafana.explore.richHistory.starredTabAsFirstTab",legacyActiveDatasourceOnly:"grafana.explore.richHistory.activeDatasourceOnly",activeDatasourcesOnly:"grafana.explore.richHistory.activeDatasourcesOnly",datasourceFilters:"grafana.explore.richHistory.datasourceFilters"}},11401:(k,R,e)=>{"use strict";e.d(R,{tU:()=>l,a:()=>v,gQ:()=>y});var t=e(32264),n=e(10096),i=e(91650),s=e(39640),r=e(75505),g=e(17172),a=e(19347),c=e(65615);const o=u=>{const D=(0,a.l)().getInstanceSettings({uid:u.datasourceUid});return{id:u.uid,createdAt:u.createdAt*1e3,datasourceName:D?.name||"",datasourceUid:u.datasourceUid,starred:u.starred,comment:u.comment,queries:u.queries}},h=u=>({uid:u.id,createdAt:Math.floor(u.createdAt/1e3),datasourceUid:u.datasourceUid,starred:u.starred,comment:u.comment,queries:u.queries});class f{constructor(){this.preferenceService=new c.W("user")}async addToRichHistory(D){const{result:E}=await(0,g.AI)().post("/api/query-history",{dataSourceUid:D.datasourceUid,queries:D.queries});return{richHistoryQuery:o(E)}}async deleteAll(){throw new Error("not supported")}async deleteRichHistory(D){(0,g.AI)().delete(`/api/query-history/${D}`)}async getRichHistory(D){const E=d(D);let x="query-history-get-all";D.starred&&(x="query-history-get-starred");const b=(await(0,r.s)((0,g.AI)().fetch({method:"GET",url:`/api/query-history?${E}`,requestId:x}))).data,M=(b.result.queryHistory||[]).map(o),O=b.result.totalCount||0;return{richHistory:M,total:O}}async getSettings(){return{activeDatasourcesOnly:!1,lastUsedDatasourceFilters:void 0,retentionPeriod:14,starredTabAsFirstTab:(await this.preferenceService.load()).queryHistory?.homeTab==="starred"}}async updateComment(D,E){const x=await(0,g.AI)().patch(`/api/query-history/${D}`,{comment:E});return o(x.result)}updateSettings(D){return this.preferenceService.patch({queryHistory:{homeTab:D.starredTabAsFirstTab?"starred":"query"}})}async updateStarred(D,E){let x;return E?x=await(0,g.AI)().post(`/api/query-history/star/${D}`):x=await(0,g.AI)().delete(`/api/query-history/star/${D}`),o(x.result)}}function d(u){let D=`${u.datasourceFilters.map(E=>{const x=(0,a.l)().getInstanceSettings(E).uid;return`datasourceUid=${encodeURIComponent(x)}`}).join("&")}`;return u.search&&(D=D+`&searchString=${u.search}`),u.sortOrder&&(D=D+`&sort=${u.sortOrder===i.x.Ascending?"time-asc":"time-desc"}`),u.starred||(D=D+`&to=${u.to}`,D=D+`&from=${u.from}`),D=D+"&limit=100",D=D+`&page=${u.page||1}`,u.starred&&(D=D+`&onlyStarred=${u.starred}`),D}const p=new s.Ay,m=new f,v=()=>t.$.queryHistoryEnabled?m:p,l=()=>p,y=()=>t.$.queryHistoryEnabled?{availableFilters:[i.x.Descending,i.x.Ascending],lastUsedDataSourcesAvailable:!1,clearHistory:!1,onlyActiveDataSource:!1,changeRetention:!1,queryHistoryAvailable:n.TP.isSignedIn}:{availableFilters:[i.x.Descending,i.x.Ascending,i.x.DatasourceAZ,i.x.DatasourceZA],lastUsedDataSourcesAvailable:!0,clearHistory:!0,onlyActiveDataSource:!0,changeRetention:!0,queryHistoryAvailable:!0}},16021:(k,R,e)=>{"use strict";e.d(R,{u:()=>n});var t=e(96540);function n(i,s){const[r,g]=(0,t.useState)();return(0,t.useEffect)(()=>{const a=i.subscribe(s,g);return()=>a.unsubscribe()},[i,s]),r}},60619:(k,R,e)=>{"use strict";e.d(R,{Y:()=>n});var t=e(96540);function n({breakpoint:i,onChange:s}){(0,t.useEffect)(()=>{const r=window.matchMedia(`(min-width: ${i}px)`),g=a=>s(a);return r.addEventListener("change",g),()=>r.removeEventListener("change",g)},[i,s])}},25249:(k,R,e)=>{"use strict";e.d(R,{C:()=>i});var t=e(31678),n=e(17422);const i=s=>{const r=(0,t.useSelector)(g=>g.navIndex);return(0,n.tc)(r,s)}},83277:(k,R,e)=>{"use strict";e.d(R,{s:()=>s});var t=e(96540),n=e(24180),i=e(39601);function s(){const{search:r}=(0,n.zy)(),g=(0,t.useMemo)(()=>(0,i.SE)(r||""),[r]),a=(0,t.useCallback)((c,o)=>i.Ny.partial(c,o),[]);return[g,a]}},74513:(k,R,e)=>{"use strict";e.d(R,{Nm:()=>h,Yj:()=>f,dK:()=>p,rd:()=>d,wi:()=>o});var t=e(2543),n=e.n(t);const i="en-US",s="fr-FR",r="es-ES",g="de-DE",a="pt-BR",c="zh-Hans",o="pseudo-LOCALE",h=i,f=[{code:i,name:"English",loader:{grafana:()=>e.e(9521).then(e.t.bind(e,19521,19))}},{code:s,name:"Fran\xE7ais",loader:{grafana:()=>e.e(5648).then(e.t.bind(e,35648,19))}},{code:r,name:"Espa\xF1ol",loader:{grafana:()=>e.e(680).then(e.t.bind(e,70680,19))}},{code:g,name:"Deutsch",loader:{grafana:()=>e.e(3082).then(e.t.bind(e,23082,19))}},{code:c,name:"\u4E2D\u6587\uFF08\u7B80\u4F53\uFF09",loader:{grafana:()=>e.e(9538).then(e.t.bind(e,29538,19))}},{code:a,name:"Portugu\xEAs Brasileiro",loader:{grafana:()=>e.e(2288).then(e.t.bind(e,12288,19))}}];{const m=e(55905);if(m.keys().includes("app/extensions/locales/localeExtensions")){const{LOCALE_EXTENSIONS:v,ENTERPRISE_I18N_NAMESPACE:l}=m("app/extensions/locales/localeExtensions");for(const y of f){const u=v[y.code];u&&(y.loader[l]=u)}}}const d=f.map(m=>m.code),p=(0,t.uniq)(f.flatMap(m=>Object.keys(m.loader)))},84753:(k,R,e)=>{"use strict";e.d(R,{Y:()=>h,a:()=>f});var t=e(5086),n=e(32017),i=e.n(n),s=e(47078),r=e.n(s),g=e(8484);const a=d=>r()(d,{isEqual:i()}),c=a((d,p)=>new Intl.DateTimeFormat(d,p)),o=a((d,p)=>new Intl.DurationFormat(d,p)),h=a((d,p={})=>{if(typeof d=="string")return h(new Date(d),p);const m=(0,g.iL)();return c(m.language,p).format(d)}),f=a((d,p={})=>{const m=(0,g.iL)();return o(m.language,p).format(d)})},8484:(k,R,e)=>{"use strict";e.d(R,{x6:()=>d,iL:()=>m,JL:()=>h,t:()=>p});var t=e(74848),n=e(72635),i=e(94997),s=e(32389),r=e(74513);const g=v=>v.split("-")[0].toLowerCase(),a={type:"backend",init(){},async read(v,l,y){let u=r.Yj.find(x=>x.code===v);if(u||(u=r.Yj.find(x=>g(x.code)===g(v))),!u)return y(new Error(`No message loader available for ${v}`),null);const D=u.loader[l];if(!D)return y(new Error(`No message loader available for ${v} with namespace ${l}`),null);const E=await D();y(null,E)}};let c,o;async function h(v){const l={partialBundledLanguages:!0,resources:{},returnEmptyString:!1,supportedLngs:r.rd,fallbackLng:r.Nm,ns:r.dK};if(o=n.default,v==="detect"){o=o.use(i.A);const u={order:["navigator"],caches:[]};l.detection=u}else l.lng=r.rd.includes(v)?v:void 0;return await o.use(a).use(s.r9).init(l),c=n.default.getFixedT(null,r.dK),{language:o.resolvedLanguage}}function f(v){const l=VALID_LANGUAGES.includes(v)?v:void 0;return i18n.changeLanguage(l)}const d=v=>(0,t.jsx)(s.x6,{shouldUnescape:!0,ns:r.dK,...v}),p=(v,l,y)=>(c||(console.warn("t() was called before i18n was initialized. This is probably caused by calling t() in the root module scope, instead of lazily on render"),c=n.default.t),c(v,l,y));function m(){return c?o||n.default:(console.warn("An attempt to internationalize was made before it was initialized. This was probably caused by calling a locale-aware function in the root module scope, instead of in render"),n.default)}},18898:(k,R,e)=>{"use strict";e.d(R,{E:()=>n});class t{constructor(){this.panelsRendered=0,this.enabled=void 0}renderingCompleted(){this.panelsRendered+=1,window.panelsRendered=this.panelsRendered}}const n=new t},16001:(k,R,e)=>{"use strict";e.d(R,{$K:()=>v,Do:()=>h,XC:()=>d,XR:()=>f,dx:()=>o,fX:()=>D,g5:()=>m,oF:()=>p,qN:()=>u});var t=e(65307),n=e(25508),i=e(31678);const s=25,r="notifications",g=`${r}/lastRead`,a={byId:b(),lastRead:Number.parseInt(window.localStorage.getItem(g)??`${Date.now()}`,10)},c=(0,t.Z0)({name:"appNotifications",initialState:a,reducers:{notifyApp:(O,{payload:I})=>{Object.values(O.byId).some(T=>E(I,T)&&T.showing)||(O.byId[I.id]=I,M(O.byId))},hideAppNotification:(O,{payload:I})=>{I in O.byId&&(O.byId[I].showing=!1,M(O.byId))},clearNotification:(O,{payload:I})=>{delete O.byId[I],M(O.byId)},clearAllNotifications:O=>{O.byId={},M(O.byId)},readAllNotifications:(O,{payload:I})=>{O.lastRead=I}}}),{notifyApp:o,hideAppNotification:h,clearNotification:f,clearAllNotifications:d,readAllNotifications:p}=c.actions,m=c.reducer,v=O=>O.lastRead,l=O=>O.byId,y=(0,n.Mz)(l,O=>Object.values(O).sort((I,T)=>T.timestamp-I.timestamp)),u=(0,n.Mz)(y,O=>O.filter(x)),D=(0,n.Mz)(l,O=>Object.values(O).filter(I=>I.showing));function E(O,I){return O.icon===I.icon&&O.severity===I.severity&&O.text===I.text&&O.title===I.title}function x(O){return O.severity===i.AppNotificationSeverity.Warning||O.severity===i.AppNotificationSeverity.Error}function P(O){return typeof O=="object"&&O!==null&&"id"in O&&"icon"in O&&"title"in O&&"text"in O}function b(){const O=window.localStorage.getItem(r);if(!O)return{};const I=JSON.parse(O);return Object.values(I).every(T=>P(T))?I:{}}function M(O){const I=Object.values(O).filter(x).sort((T,C)=>C.timestamp-T.timestamp).slice(0,s).reduce((T,C)=>(T[C.id]={id:C.id,severity:C.severity,icon:C.icon,title:C.title,text:C.text,traceId:C.traceId,timestamp:C.timestamp,showing:!1},T),{});try{window.localStorage.setItem(r,JSON.stringify(I))}catch(T){console.error("Unable to persist notifications to local storage"),console.error(T)}}},91219:(k,R,e)=>{"use strict";e.d(R,{I_:()=>d,L1:()=>g,TU:()=>h,ci:()=>c,fc:()=>o,ve:()=>f});var t=e(65307),n=e(32264),i=e(36689);const s=n.$.bootData?.navTree??[];function r(p){return p.map(m=>{const v=m.children&&r(m.children);return{...m,children:v,text:(0,i.C)(m.id)??m.text,subTitle:(0,i.o)(m.id)??m.subTitle,emptyMessage:(0,i.C)(m.emptyMessageId)}})}const g="starred/",a=(0,t.Z0)({name:"navBarTree",initialState:()=>r(n.$.bootData?.navTree??[]),reducers:{setStarred:(p,m)=>{const v=p.find(E=>E.id==="starred"),{id:l,title:y,url:u,isStarred:D}=m.payload;if(v)if(D){v.children||(v.children=[]);const E={id:g+l,text:y,url:u};v.children.push(E),v.children.sort((x,P)=>x.text.localeCompare(P.text))}else{const E=v.children?.findIndex(x=>x.id===g+l)??-1;E>-1&&v?.children?.splice(E,1)}},setBookmark:(p,m)=>{if(!n.$.featureToggles.pinNavItems)return;const v=p.find(u=>u.id==="bookmarks"),{item:l,isSaved:y}=m.payload;if(v)if(y){v.children||=[];const u={...l,children:[],sortWeight:0,emptyMessageId:"",emptyMessage:"",parentItem:{id:v.id,text:v.text}};v.children.push(u)}else v.children=v.children?.filter(u=>u.url!==l.url)??[]},updateDashboardName:(p,m)=>{const{id:v,title:l,url:y}=m.payload,u=p.find(D=>D.id==="starred");if(u){const D=u.children?.find(E=>E.id===v);D&&(D.text=l,D.url=y,u.children?.sort((E,x)=>E.text.localeCompare(x.text)))}},removePluginFromNavTree:(p,m)=>{const v="plugin-page-"+m.payload.pluginID,l=p.findIndex(y=>y.id===v);l>-1&&p.splice(l,1)}}}),{setStarred:c,removePluginFromNavTree:o,updateDashboardName:h,setBookmark:f}=a.actions,d=a.reducer},28215:(k,R,e)=>{"use strict";e.d(R,{Id:()=>g,Im:()=>p,Vz:()=>f,YA:()=>d,_h:()=>v,s2:()=>a});var t=e(65307),n=e(2543),i=e.n(n),s=e(2913),r=e(36689);const g="home";function a(){const l={},y=(0,n.cloneDeep)(s.Ay.bootData.navTree),u=y.find(E=>E.id===g),D=y.filter(E=>E.id!==g);return u&&c(l,[u]),c(l,D,l[g]),l}function c(l,y,u){const D=[];for(const E of y){const x={...E,text:(0,r.C)(E.id)??E.text,subTitle:(0,r.o)(E.id)??E.subTitle,emptyMessage:(0,r.C)(E.emptyMessageId),parentItem:u};x.id&&(l[x.id]=x),x.children&&c(l,x.children,x),D.push(x)}u&&(u.children=D),l["not-found"]={...o("Page not found","404 Error").node},l.error={...o("Page error","An unexpected error").node}}function o(l,y){const u={text:l,subTitle:y,icon:"exclamation-triangle"};return{node:u,main:u}}const h={},f=(0,t.VP)("navIndex/updateNavIndex"),d=(0,t.VP)("navIndex/updateConfigurationSubtitle"),p=(0,t.VP)("navIndex/removeNavIndex"),m=(l,y)=>({...l,parentItem:{...l.parentItem,text:l.parentItem?.text??"",subTitle:y}}),v=(l=h,y)=>{if(f.match(y)){let D=function(P){if(P.children)for(const b of P.children)E[b.id]={...b,parentItem:P};P.parentItem&&D(P.parentItem)};var u=D;const E={},x=y.payload;return D(x),{...l,...E}}else if(d.match(y)){const D=`Organization: ${y.payload}`;return{...l,cfg:{...l.cfg,subTitle:D},datasources:m(l.datasources,D),correlations:m(l.correlations,D),users:m(l.users,D),teams:m(l.teams,D),plugins:m(l.plugins,D),"org-settings":m(l["org-settings"],D),apikeys:m(l.apikeys,D)}}else p.match(y)&&delete l[y.payload];return l}},17422:(k,R,e)=>{"use strict";e.d(R,{rH:()=>g,tc:()=>r});var t=e(41811),n=e(71101),i=e(28215);const s=()=>{const o={id:"not-found",text:"Page not found",icon:"exclamation-triangle",subTitle:"404 Error",url:"not-found"};return{node:o,main:o}},r=(0,t.A)((o,h,f,d=!1)=>{if(o[h]){const p=o[h],m=d?p:g(p),v=a(m,h);return{node:p,main:v}}return f||s()});function g(o){return o.id===n.Rj?o:o.parentItem&&o.parentItem.id!==i.Id?g(o.parentItem):o}function a(o,h){return o.id===h?{...o,active:!0}:o.children&&o.children.length>0?{...o,children:o.children.map(f=>a(f,h))}:o}const c=o=>`${o.main.text}${o.node.text?": "+o.node.text:""}`},65615:(k,R,e)=>{"use strict";e.d(R,{W:()=>n});var t=e(27677);class n{constructor(s){this.resourceUri=s}update(s){return t.IB.put(`/api/${this.resourceUri}/preferences`,s)}patch(s){return t.IB.patch(`/api/${this.resourceUri}/preferences`,s)}load(){return t.IB.get(`/api/${this.resourceUri}/preferences`)}}},2619:(k,R,e)=>{"use strict";e.d(R,{Q:()=>s});var t=e(96540),n=e(13752),i=e(69731);class s{constructor(a){this._subject=new n.B,this._state=a}useState(){return r(this)}get state(){return this._state}setState(a){this._state={...this._state,...a},this._subject.next(this._state)}subscribeToState(a){return this._subject.subscribe(a)}}function r(g){const a=(0,i.C)();return(0,t.useEffect)(()=>{const c=g.subscribeToState({next:a});return()=>c.unsubscribe()},[g,a]),g.state}},27677:(k,R,e)=>{"use strict";e.d(R,{Mf:()=>Ye,IB:()=>je,AI:()=>Ze});var t=e(56568),n=e(13752),i=e(75505),s=e(88483),r=e(64423),g=e(13288),a=e(65474),c=e(20039),o=e(81160),h=e(69862),f=e(59099),d=e(37748),p=e(66847),m=e(67791),v=e(16126),l=e(41560),y=e(69850),u=e(1005),D=e(62938),E=e(26272),x=e(40187),P=e(95344),b=e(32264),M=e(28138),O=e(2913),I=e(92315),T=e(67027),C=e(28676),S=e(74848),A=e(32196),L=e(40845),N=e(17464),F=e(37166),w=e(55852),B=e(88448);const U=Ne=>{const Pe=(0,L.of)(K),Ue=(0,L.$j)(),$e=(0,B.o)(Ue),ze=!!Ne.maxConcurrentSessions,qe=()=>{window.location.reload()};return(0,S.jsxs)(N.ZL,{children:[(0,S.jsx)("div",{className:$e.modal,children:(0,S.jsxs)(F.w,{title:"You have been automatically signed out",severity:"warning",className:Pe.infobox,children:[(0,S.jsxs)("div",{className:Pe.text,children:[(0,S.jsxs)("p",{children:["Your session token was automatically revoked because you have reached",(0,S.jsx)("strong",{children:` the maximum number of ${ze?Ne.maxConcurrentSessions:""} concurrent sessions `}),"for your account."]}),(0,S.jsxs)("p",{children:[(0,S.jsx)("strong",{children:"To resume your session, sign in again."}),"Contact your administrator or visit the license page to review your quota if you are repeatedly signed out automatically."]})]}),(0,S.jsx)(w.$n,{size:"md",variant:"primary",onClick:qe,children:"Sign in"})]})}),(0,S.jsx)("div",{className:(0,A.cx)($e.modalBackdrop,Pe.backdrop)})]})},K=Ne=>({infobox:(0,A.css)`
    margin-bottom: 0;
  `,text:(0,A.css)`
    margin: ${Ne.spacing(1,0,2)};
  `,backdrop:(0,A.css)`
    background-color: ${Ne.colors.background.canvas};
    opacity: 0.8;
  `});var V=e(28444),H=e(2543);const Y=Ne=>{const Pe=Ne.method,Ue=ne(Ne),$e=le(Ue),ze=z(Ne,$e),qe=Z(Ne);return{method:Pe,headers:Ue,body:ze,credentials:qe}},X={canParse:()=>!0,parse:Ne=>(Ne.get("accept")||Ne.set("accept","application/json, text/plain, */*"),Ne)},J=Ne=>({canParse:Pe=>(Pe?.method?Pe?.method.toLowerCase():"")===Ne,parse:Pe=>(Pe.get("content-type")||Pe.set("content-type","application/json"),Pe)}),q=J("post"),ae=J("put"),j=J("patch"),te=[q,ae,j,X],ne=Ne=>{const Pe=Ne?.headers?new Headers(Ne.headers):new Headers;return te.filter(ze=>ze.canParse(Ne)).reduce((ze,qe)=>qe.parse(ze),Pe)},le=Ne=>{if(!Ne)return!1;const Pe=Ne.get("content-type");return!!(Pe&&Pe.toLowerCase()==="application/json")},z=(Ne,Pe)=>Ne&&(!Ne.data||typeof Ne.data=="string"||Ne.data instanceof Blob?Ne.data:Pe?JSON.stringify(Ne.data):new URLSearchParams(Ne.data));async function ee(Ne,Pe){if(Pe)switch(Pe){case"arraybuffer":return Ne.arrayBuffer();case"blob":return Ne.blob();case"json":return Ne.headers.get("Content-Length")==="0"?(console.warn(`${Ne.url} returned an invalid JSON`),{}):await Ne.json();case"text":return Ne.text()}const Ue=await Ne.text();try{return JSON.parse(Ue)}catch{}return Ue}function se(Ne){return Object.keys(Ne).map(Pe=>{const Ue=Ne[Pe];return Array.isArray(Ue)?Ue.map($e=>`${encodeURIComponent(Pe)}=${encodeURIComponent($e)}`).join("&"):`${encodeURIComponent(Pe)}=${encodeURIComponent(Ue)}`}).join("&")}const ie=Ne=>{const Pe=(0,H.omitBy)(Ne.params,$e=>$e===void 0||$e&&$e.length===0),Ue=se(Pe);return Ne.params&&Ue.length?`${Ne.url}?${Ue}`:Ne.url},Z=Ne=>Ne&&(Ne.credentials?Ne.credentials:Ne.withCredentials?((0,P.l)("BackendSrvRequest","withCredentials","credentials"),"include"):"same-origin");var oe=e(21969),ce=(Ne=>(Ne[Ne.Pending=0]="Pending",Ne[Ne.InProgress=1]="InProgress",Ne[Ne.Done=2]="Done",Ne))(ce||{});class ye{constructor(Pe=!1){this.state={},this.queue=new n.B,this.updates=new n.B,this.add=(Ue,$e)=>this.queue.next({id:Ue,options:$e,state:0}),this.setInProgress=Ue=>this.queue.next({id:Ue,state:1}),this.setDone=Ue=>this.queue.next({id:Ue,state:2}),this.getUpdates=()=>this.updates.asObservable(),this.getUpdate=Ue=>{const $e=Object.keys(Ue).filter(qe=>Ue[qe].state===1).length;return{noOfPending:Object.keys(Ue).filter(qe=>Ue[qe].state===0).length,noOfInProgress:$e,state:Ue}},this.publishUpdate=(Ue,$e)=>{this.printState(Ue,$e),this.updates.next(Ue)},this.printState=(Ue,$e)=>{if(!$e)return;const ze=Object.keys(Ue.state).reduce((qe,dt)=>{const vt={id:dt,state:Ue.state[dt].state};return qe.push(vt),qe},[]);console.log("FetchQueue noOfStarted",Ue.noOfInProgress),console.log("FetchQueue noOfNotStarted",Ue.noOfPending),console.log("FetchQueue state",ze)},this.queue.subscribe(Ue=>{const{id:$e,state:ze,options:qe}=Ue;if(this.state[$e]||(this.state[$e]={state:0,options:{url:""}}),ze===2){delete this.state[$e];const vt=this.getUpdate(this.state);this.publishUpdate(vt,Pe);return}this.state[$e].state=ze,qe&&(this.state[$e].options=qe);const dt=this.getUpdate(this.state);this.publishUpdate(dt,Pe)})}}var re=e(95864);class ue{constructor(Pe,Ue,$e){const ze=$e?.http2Enabled?1e3:5;Pe.getUpdates().pipe((0,v.p)(({noOfPending:qe})=>qe>0),(0,re.H)(({state:qe,noOfInProgress:dt})=>{const vt=Object.keys(qe).filter(pe=>qe[pe].state===ce.Pending&&!(0,oe.dr)(qe[pe].options.url)).reduce((pe,Ee)=>{const me={id:Ee,options:qe[Ee].options};return pe.push(me),pe},[]),yt=Object.keys(qe).filter(pe=>qe[pe].state===ce.Pending&&(0,oe.dr)(qe[pe].options.url)).reduce((pe,Ee)=>{const me={id:Ee,options:qe[Ee].options};return pe.push(me),pe},[]),st=Math.max(ze-dt-vt.length,0),Ve=yt.slice(0,st);return vt.concat(Ve)})).subscribe(({id:qe,options:dt})=>{Ue.add(qe,dt)})}}class De{constructor(Pe,Ue){this.queue=new n.B,this.responses=new n.B,this.add=($e,ze)=>{this.queue.next({id:$e,options:ze})},this.getResponses=$e=>this.responses.asObservable().pipe((0,v.p)(ze=>ze.id===$e)),this.queue.subscribe($e=>{const{id:ze,options:qe}=$e;Pe.setInProgress(ze),this.responses.next({id:ze,observable:Ue(qe)})})}}var ge=e(16233);const Te="cancel_all_requests_request_id",Le="grafana-trace-id";class Ye{constructor(Pe){this.inFlightRequests=new n.B,this.HTTP_REQUEST_CANCELED=-1,this.inspectorStream=new n.B,this._tokenRotationInProgress=null,this.deviceID=null,this.dependencies={fromFetch:c.$,appEvents:M.A,contextSrv:ge.TP,logout:()=>{ge.TP.setLoggedOut()}},Pe&&(this.dependencies={...this.dependencies,...Pe}),this.noBackendCache=!1,this.internalFetch=this.internalFetch.bind(this),this.fetchQueue=new ye,this.responseQueue=new De(this.fetchQueue,this.internalFetch),this.initGrafanaDeviceID(),new ue(this.fetchQueue,this.responseQueue,(0,O.zj)())}async initGrafanaDeviceID(){try{const Ue=await(await t.Ay.load()).get();this.deviceID=Ue.visitorId}catch(Pe){console.error(Pe)}}async request(Pe){return await(0,i.s)(this.fetch(Pe).pipe((0,o.T)(Ue=>Ue.data)))}fetch(Pe){const Ue=(0,D.A)(),$e=this.fetchQueue;return new s.c(ze=>{const qe=new r.yU;return qe.add(this.responseQueue.getResponses(Ue).subscribe(dt=>{qe.add(dt.observable.subscribe(ze))})),this.fetchQueue.add(Ue,Pe),function(){$e.setDone(Ue),qe.unsubscribe()}})}internalFetch(Pe){Pe.requestId&&this.inFlightRequests.next(Pe.requestId),Pe=this.parseRequestOptions(Pe);const Ue=(0,T.r)();return Ue!==null&&Ue!==""&&b.$.jwtUrlLogin&&b.$.jwtHeaderName&&(Pe.headers=Pe.headers??{},Pe.headers[b.$.jwtHeaderName]=`${Ue}`),this.deviceID&&(Pe.headers=Pe.headers??{},Pe.headers["X-Grafana-Device-Id"]=`${this.deviceID}`),this.getFromFetchStream(Pe).pipe(this.handleStreamResponse(Pe),this.handleStreamError(Pe),this.handleStreamCancellation(Pe))}resolveCancelerIfExists(Pe){this.inFlightRequests.next(Pe)}cancelAllInFlightRequests(){this.inFlightRequests.next(Te)}async datasourceRequest(Pe){return(0,i.s)(this.fetch(Pe))}parseRequestOptions(Pe){const Ue=this.dependencies.contextSrv.user?.orgId;return Pe.retry=Pe.retry??0,(0,oe.Lr)(Pe.url)&&(Ue&&(Pe.headers=Pe.headers??{},Pe.headers["X-Grafana-Org-Id"]=Ue),Pe.url.startsWith("/")&&(Pe.url=Pe.url.substring(1)),Pe.headers?.Authorization&&(Pe.headers["X-DS-Authorization"]=Pe.headers.Authorization,delete Pe.headers.Authorization),this.noBackendCache&&(Pe.headers=Pe.headers??{},Pe.headers["X-Grafana-NoCache"]="true")),Pe.hideFromInspector===void 0&&(Pe.hideFromInspector=(0,oe.Lr)(Pe.url)&&!(0,oe.dr)(Pe.url)),Pe}getFromFetchStream(Pe){const Ue=ie(Pe),$e=Y(Pe);return this.dependencies.fromFetch(Ue,$e).pipe((0,h.Z)(async ze=>{const{status:qe,statusText:dt,ok:vt,headers:yt,url:st,type:Ve,redirected:pe}=ze,Ee=Pe.responseType??(le(yt)?"json":void 0),me=await ee(ze,Ee);return{status:qe,statusText:dt,ok:vt,data:me,headers:yt,url:st,type:Ve,redirected:pe,config:Pe,traceId:ze.headers.get(Le)??void 0}}))}showApplicationErrorAlert(Pe){}showSuccessAlert(Pe){const{config:Ue}=Pe;if(Ue.showSuccessAlert===!1||Ue.showSuccessAlert===void 0&&(Ue.method==="GET"||(0,oe.dr)(Ue.url)||!(0,oe.Lr)(Ue.url)))return;const $e=Pe.data;$e?.message&&this.dependencies.appEvents.emit(E.r1.alertSuccess,[$e.message])}showErrorAlert(Pe,Ue){if(Pe.showErrorAlert===!1||Pe.showErrorAlert===void 0&&((0,oe.dr)(Pe.url)||!(0,oe.Lr)(Pe.url)))return;let $e="",ze=Ue.data.message;ze==="Unexpected error"&&Ue.message&&(ze=Ue.message),ze.length>80&&($e=ze,ze="Error"),Ue.status===422&&($e=Ue.data.message,ze="Validation failed"),this.dependencies.appEvents.emit(Ue.status<500?E.r1.alertWarning:E.r1.alertError,[ze,$e,Ue.data.traceID])}processRequestError(Pe,Ue){return Ue.data=Ue.data??{message:"Unexpected error"},typeof Ue.data=="string"&&(Ue.data={message:Ue.data,error:Ue.statusText,response:Ue.data}),Ue.data&&!Ue.data.message&&typeof Ue.data.error=="string"&&(Ue.data.message=Ue.data.error),Ue.data.message&&setTimeout(()=>{Ue.isHandled||this.showErrorAlert(Pe,Ue)},50),this.inspectorStream.next({response:Ue,requestId:Pe.requestId}),Ue}handleStreamResponse(Pe){return Ue=>Ue.pipe((0,o.T)($e=>{if(!$e.ok){const{status:ze,statusText:qe,data:dt}=$e;throw{status:ze,statusText:qe,data:dt,config:Pe,traceId:$e.headers.get(Le)??void 0}}return $e}),(0,f.M)($e=>{this.showSuccessAlert($e),this.inspectorStream.next({response:$e,requestId:Pe.requestId})}))}handleStreamError(Pe){const{isSignedIn:Ue}=this.dependencies.contextSrv.user;return $e=>$e.pipe((0,d.l)(ze=>ze.pipe((0,h.Z)((qe,dt)=>{const vt=dt===0&&Pe.retry===0;if(qe.status===401&&(0,oe.Lr)(Pe.url)&&vt&&Ue){if(qe.data?.error?.id==="ERR_TOKEN_REVOKED")return this.dependencies.appEvents.publish(new V.S8({component:U,props:{maxConcurrentSessions:qe.data?.error?.maxConcurrentSessions}})),(0,g.$)(()=>qe);let yt=this.loginPing();return(0,I.m)()&&(0,I.W)()*1e3<Date.now()&&(yt=this.rotateToken()),(0,a.H)(yt).pipe((0,p.W)(st=>(st.status===401&&this.dependencies.logout(),(0,g.$)(st))))}return(0,g.$)(qe)}))),(0,p.W)(ze=>(0,g.$)(()=>this.processRequestError(Pe,ze))))}handleStreamCancellation(Pe){return Ue=>Ue.pipe((0,m.Q)(this.inFlightRequests.pipe((0,v.p)($e=>{let ze=!1;return Pe&&Pe.requestId&&Pe.requestId===$e&&(ze=!0),$e===Te&&(ze=!0),ze}))),(0,l.v)(()=>({type:x.v2.Cancelled,cancelled:!0,data:null,status:this.HTTP_REQUEST_CANCELED,statusText:"Request was aborted",config:Pe})))}getInspectorStream(){return this.inspectorStream}async get(Pe,Ue,$e,ze){return this.request({...ze,method:"GET",url:Pe,params:Ue,requestId:$e})}async delete(Pe,Ue,$e){return this.request({...$e,method:"DELETE",url:Pe,data:Ue})}async post(Pe,Ue,$e){return this.request({...$e,method:"POST",url:Pe,data:Ue})}async patch(Pe,Ue,$e){return this.request({...$e,method:"PATCH",url:Pe,data:Ue})}async put(Pe,Ue,$e){return this.request({...$e,method:"PUT",url:Pe,data:Ue})}withNoBackendCache(Pe){return this.noBackendCache=!0,Pe().finally(()=>{this.noBackendCache=!1})}rotateToken(){return this._tokenRotationInProgress?this._tokenRotationInProgress:(this._tokenRotationInProgress=this.fetch({url:"/api/user/auth-tokens/rotate",method:"POST",retry:1}).pipe((0,y.j)(()=>{this._tokenRotationInProgress=null}),(0,u.u)()),this._tokenRotationInProgress)}loginPing(){return this.fetch({url:"/api/login/ping",method:"GET",retry:1})}search(Pe){return this.get("/api/search",Pe)}getDashboardByUid(Pe){return(0,P.l)("backend_srv","getDashboardByUid(uid)","getDashboardAPI().getDashboardDTO(uid)"),(0,C.n)().getDashboardDTO(Pe)}validateDashboard(Pe){return Promise.resolve({isValid:!1,message:"dashboard validation is not supported"})}getPublicDashboardByUid(Pe){return this.get(`/api/public/dashboards/${Pe}`)}getFolderByUid(Pe,Ue={}){const $e=new URLSearchParams;return Ue.withAccessControl&&$e.set("accesscontrol","true"),this.get(`/api/folders/${Pe}?${$e.toString()}`,void 0,void 0,{showErrorAlert:!1})}}const je=new Ye,Ze=()=>je},16233:(k,R,e)=>{"use strict";e.d(R,{SM:()=>h,TP:()=>p});var t=e(2543),n=e.n(t),i=e(29263),s=e(65879),r=e(17172),g=e(33378),a=e(92315),c=e(31678),o=e(2913);const h="auto";class f{constructor(){this.id=0,this.uid="",this.isGrafanaAdmin=!1,this.isSignedIn=!1,this.orgRole="",this.orgId=0,this.orgName="",this.login="",this.externalUserId="",this.orgCount=0,this.timezone="",this.fiscalYearStartMonth=0,this.helpFlags1=0,this.theme="dark",this.hasEditPermissionInFolders=!1,this.email="",this.name="",this.locale="",this.language="",this.weekStart="",this.gravatarUrl="",this.analytics={identifier:""},this.authenticatedBy="",o.Ay.bootData.user&&(0,t.extend)(this,o.Ay.bootData.user)}}class d{constructor(){this.sidemenuSmallBreakpoint=!1,this.tokenRotationJobId=0,o.Ay.bootData||(o.Ay.bootData={user:{},settings:{},navTree:[]}),this.user=new f,this.isSignedIn=this.user.isSignedIn,this.isGrafanaAdmin=this.user.isGrafanaAdmin,this.isEditor=this.hasRole("Editor")||this.hasRole("Admin"),this.hasEditPermissionInFolders=this.user.hasEditPermissionInFolders,this.minRefreshInterval=o.Ay.minRefreshInterval,this.scheduleTokenRotationJob()}async fetchUserPermissions(){try{this.user.permissions=await(0,r.AI)().get("/api/access-control/user/actions",{reloadcache:!0})}catch(l){console.error(l)}}setLoggedOut(){this.cancelTokenRotationJob(),this.user.isSignedIn=!1,this.isSignedIn=!1,window.location.reload()}hasRole(l){return l==="ServerAdmin"?this.isGrafanaAdmin:this.user.orgRole===l}licensedAccessControlEnabled(){return(0,g.a)("accesscontrol")}hasPermissionInMetadata(l,y){return(0,i.T6)(l,y)}hasPermission(l){return(0,i.ZU)(l,this.user)}isGrafanaVisible(){return document.visibilityState===void 0||document.visibilityState==="visible"}isAllowedInterval(l){return!o.Ay.minRefreshInterval||l===h?!0:s.intervalToMs(l)>=s.intervalToMs(o.Ay.minRefreshInterval)}getValidInterval(l){return this.isAllowedInterval(l)?l:o.Ay.minRefreshInterval}getValidIntervals(l){return this.minRefreshInterval?l.filter(y=>y!=="").filter(this.isAllowedInterval):l}hasAccessToExplore(){return this.hasPermission(c.AccessControlAction.DataSourcesExplore)&&o.Ay.exploreEnabled}evaluatePermission(l){return(0,i.jW)(l,this.user)?[]:["Reject"]}scheduleTokenRotationJob(){if(this.canScheduleRotation()){let l=(0,a.W)(),u=(l-Math.floor(Math.random()*19+1))*1e3-Date.now();this.tokenRotationJobId=setTimeout(()=>{if((0,a.W)()>l){this.scheduleTokenRotationJob();return}this.rotateToken().then()},u)}}canScheduleRotation(){return!(!this.isSignedIn||(0,a.W)()===0)}cancelTokenRotationJob(){this.tokenRotationJobId>0&&clearTimeout(this.tokenRotationJobId)}rotateToken(){return fetch(o.Ay.appSubUrl+"/api/user/auth-tokens/rotate",{method:"POST"}).then(l=>{if(l.status===200){this.scheduleTokenRotationJob();return}if(l.status===401){this.setLoggedOut();return}}).catch(l=>{console.error(l)})}}let p=new d;const m=v=>{throw new Error("contextSrv can be only overridden in test environment")}},42614:(k,R,e)=>{"use strict";e.d(R,{n:()=>n});var t=e(63415);const n=(s,r)=>{(0,t.x$)().addEvent({type:t.on.Performance,payload:{name:s,value:r}})},i=s=>faro?.api?.pushError(s)},62301:(k,R,e)=>{"use strict";e.d(R,{A:()=>c});var t=e(2543),n=e.n(t),i=e(17172),s=e(2913),r=e(33390);class g{constructor(){}addDashboardImpression(h){const f=this.impressionKey();let d=[];r.A.exists(f)&&(d=JSON.parse(r.A.get(f)),(0,t.isArray)(d)||(d=[])),d=d.filter(p=>h!==p),d.unshift(h),d.length>50&&d.pop(),r.A.set(f,JSON.stringify(d))}async convertToUIDs(){let h=this.getImpressions();const f=(0,t.filter)(h,p=>(0,t.isNumber)(p));if(!f.length)return;const d=await(0,i.AI)().get(`/api/dashboards/ids/${f.join(",")}`);r.A.set(this.impressionKey(),JSON.stringify([...(0,t.filter)(h,p=>(0,t.isString)(p)),...d]))}getImpressions(){const h=r.A.get(this.impressionKey())||"[]";return JSON.parse(h)}async getDashboardOpened(){try{await this.convertToUIDs()}catch{}return(0,t.filter)(this.getImpressions(),f=>(0,t.isString)(f))}impressionKey(){return"dashboard_impressions-"+s.Ay.bootData.user.orgId}}const c=new g},4898:(k,R,e)=>{"use strict";e.d(R,{R:()=>u});let t={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},n={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},i={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},s={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},r=null;for(let D=1;D<20;++D)t[111+D]="f"+D;for(let D=0;D<=9;++D)t[D+96]=D.toString();function g(D){if(D.type==="keypress"){let E=String.fromCharCode(D.which);return D.shiftKey||(E=E.toLowerCase()),E}return t[D.which]?t[D.which]:n[D.which]?n[D.which]:String.fromCharCode(D.which).toLowerCase()}function a(D,E){return D.sort().join(",")===E.sort().join(",")}function c(D){let E=[];return D.shiftKey&&E.push("shift"),D.altKey&&E.push("alt"),D.ctrlKey&&E.push("ctrl"),D.metaKey&&E.push("meta"),E}function o(D){if(D.preventDefault){D.preventDefault();return}D.returnValue=!1}function h(D){if(D.stopPropagation){D.stopPropagation();return}D.cancelBubble=!0}function f(D){return D==="shift"||D==="ctrl"||D==="alt"||D==="meta"}function d(){if(!r){r={};for(let D in t){const E=parseInt(D,10);E>95&&E<112||t.hasOwnProperty(D)&&(r[t[D]]=D)}}return r}function p(D,E,x){return x||(x=d()[D]?"keydown":"keypress"),x==="keypress"&&E.length&&(x="keydown"),x}function m(D){return D==="+"?["+"]:(D=D.replace(/\+{2}/g,"+plus"),D.split("+"))}function v(D,E){let x,P,b,M=[];for(x=m(D),b=0;b<x.length;++b)P=x[b],s[P]&&(P=s[P]),E&&E!=="keypress"&&i[P]&&(P=i[P],M.push("shift")),f(P)&&M.push(P);if(!P)throw new Error("Unable to get key");return E=p(P,M,E),{key:P,modifiers:M,action:E}}function l(D,E){return D===null||D===document?!1:D===E?!0:l(D.parentNode,E)}class y{constructor(E){this._callbacks={},this._directMap={},this._sequenceLevels={},this._resetTimer=void 0,this._ignoreNextKeyup=!1,this._ignoreNextKeypress=!1,this._nextExpectedAction=!1,this._globalCallbacks={},this._resetSequences=x=>{x=x||{};let P=!1,b;for(b in this._sequenceLevels){if(x[b]){P=!0;continue}this._sequenceLevels[b]=0}P||(this._nextExpectedAction=!1)},this._getMatches=(x,P,b,M,O,I)=>{let T,C,S=[],A=b.type;if(!this._callbacks[x])return[];for(A==="keyup"&&f(x)&&(P=[x]),T=0;T<this._callbacks[x].length;++T)if(C=this._callbacks[x][T],!(!M&&C.seq&&this._sequenceLevels[C.seq]!==C.level)&&A===C.action&&(A==="keypress"&&!b.metaKey&&!b.ctrlKey||a(P,C.modifiers))){let L=!M&&C.combo===O,N=M&&C.seq===M&&C.level===I;(L||N)&&this._callbacks[x].splice(T,1),S.push(C)}return S},this._fireCallback=(x,P,b,M)=>{const O=P.target||P.srcElement;O&&O instanceof HTMLElement&&this.stopCallback(P,O,b,M)||x(P,b)===!1&&(o(P),h(P))},this._handleKey=(x,P,b)=>{let M=this._getMatches(x,P,b),O,I={},T=0,C=!1;for(O=0;O<M.length;++O)M[O].seq&&(T=Math.max(T,M[O].level??0));for(O=0;O<M.length;++O){const A=M[O].seq;if(A){if(M[O].level!==T)continue;C=!0,I[A]=1,this._fireCallback(M[O].callback,b,M[O].combo,A);const L=A.lastIndexOf(x),N=A.slice(0,L);for(const[F,w]of Object.entries(this._sequenceLevels))w>0&&F.startsWith(N)&&(I[F]=1);continue}C||this._fireCallback(M[O].callback,b,M[O].combo)}for(const A of this._callbacks[x]??[])A.action===b.type&&A.seq&&A.level===0&&(I[A.seq]=1);let S=b.type==="keypress"&&this._ignoreNextKeypress;b.type===this._nextExpectedAction&&!f(x)&&!S&&this._resetSequences(I),this._ignoreNextKeypress=C&&b.type==="keydown"},this._handleKeyEvent=x=>{if(!(x instanceof KeyboardEvent))throw new Error("Didn't get a KeyboardEvent");const P=x;if(P.repeat)return;typeof P.which!="number"&&(P.which=P.keyCode);let b=g(P);if(b){if(P.type==="keyup"&&this._ignoreNextKeyup===b){this._ignoreNextKeyup=!1;return}this.handleKey(b,c(P),P)}},this._resetSequenceTimer=()=>{clearTimeout(this._resetTimer),this._resetTimer=setTimeout(this._resetSequences,1e3)},this._bindSequence=(x,P,b,M)=>{this._sequenceLevels[x]=0;const O=T=>()=>{this._nextExpectedAction=T,++this._sequenceLevels[x],this._resetSequenceTimer()},I=T=>{this._fireCallback(b,T,x),M!=="keyup"&&(this._ignoreNextKeyup=g(T)),this._resetSequenceTimer()};for(let T=0;T<P.length;++T){let S=T+1===P.length?I:O(M||v(P[T+1]).action);this._bindSingle(P[T],S,M,x,T)}},this._bindSingle=(x,P,b,M,O)=>{this._directMap[x+":"+b]=P,x=x.replace(/\s+/g," ");let I=x.split(" "),T;if(I.length>1){this._bindSequence(x,I,P,b);return}T=v(x,b),this._callbacks[T.key]=this._callbacks[T.key]||[];const C={type:T.action,metaKey:!1,ctrlKey:!1};this._getMatches(T.key,T.modifiers,C,M,x,O);const S={callback:P,modifiers:T.modifiers,action:T.action,seq:M,level:O,combo:x};this._callbacks[T.key][M?"unshift":"push"](S)},this._bindMultiple=(x,P,b)=>{for(let M=0;M<x.length;++M)this._bindSingle(x[M],P,b)},this.bind=(x,P,b)=>(x=x instanceof Array?x:[x],this._bindMultiple(x,P,b),self),this.unbind=(x,P)=>this.bind(x,function(){},P),this.bindGlobal=(x,P,b)=>{if(this.bind(x,P,b),x instanceof Array){for(let M=0;M<x.length;M++)this._globalCallbacks[x[M]]=!0;return}this._globalCallbacks[x]=!0},this.unbindGlobal=(x,P)=>{if(this.unbind(x,P),x instanceof Array){for(let b=0;b<x.length;b++)this._globalCallbacks[x[b]]=!1;return}this._globalCallbacks[x]=!1},this.trigger=(x,P)=>{let b=this;return b._directMap[x+":"+P]&&b._directMap[x+":"+P]({},x),b},this.reset=()=>(this._callbacks={},this._directMap={},this),this.stopCallback=(x,P,b,M)=>{if(this._globalCallbacks[b]||M&&this._globalCallbacks[M]||(" "+P.className+" ").indexOf(" mousetrap ")>-1||l(P,this.target))return!1;if("composedPath"in x&&typeof x.composedPath=="function"){let O=x.composedPath()[0];O!==x.target&&O instanceof HTMLElement&&(P=O)}return!!(P.tagName==="INPUT"||P.tagName==="SELECT"||P.tagName==="TEXTAREA"||"isContentEditable"in P&&P.isContentEditable)},this.handleKey=(...x)=>this._handleKey(...x),this.addKeycodes=x=>{for(let P in x)x.hasOwnProperty(P)&&(t[P]=x[P]);r=null},this.target=E,this.target.addEventListener("keypress",x=>{x instanceof KeyboardEvent&&this._handleKeyEvent(x)}),this.target.addEventListener("keydown",x=>{x instanceof KeyboardEvent&&this._handleKeyEvent(x)}),this.target.addEventListener("keyup",x=>{x instanceof KeyboardEvent&&this._handleKeyEvent(x)})}}const u=new y(document)},2769:(k,R,e)=>{"use strict";e.d(R,{K:()=>a,O:()=>c});var t=e(97594),n=e(3591),i=e(28138),s=e(2913),r=e(10096),g=e(65615);async function a(o,h){const f=s.config.theme2,d=(0,t.g)(o);if(i.A.publish(new n.E8(d)),f.colors.mode!==d.colors.mode){const v=document.createElement("link");v.rel="stylesheet",v.href=s.config.bootData.assets[d.colors.mode],v.onload=()=>{const l=document.getElementsByTagName("link");for(let y=0;y<l.length;y++){const u=l[y];u.href&&u.href.includes(`build/grafana.${f.colors.mode}`)&&u.remove()}},document.head.insertBefore(v,document.head.firstChild)}if(h||!r.TP.isSignedIn)return;const p=new g.W("user"),m=await p.load();await p.update({...m,theme:d.colors.mode})}async function c(o){const h=s.config.theme2;a(h.isDark?"light":"dark",o)}},33390:(k,R,e)=>{"use strict";e.d(R,{A:()=>i});class t{get(r){return window.localStorage[r]}set(r,g){window.localStorage[r]=g}getBool(r,g){return g!==void 0&&!this.exists(r)?g:window.localStorage[r]==="true"}getObject(r,g){let a=g;if(this.exists(r)){const c=window.localStorage[r];try{a=JSON.parse(c)}catch(o){console.error(`Error parsing store object: ${r}. Returning default: ${g}. [${o}]`)}}return a}setObject(r,g){let a;try{a=JSON.stringify(g)}catch(c){throw new Error(`Could not stringify object: ${r}. [${c}]`)}try{this.set(r,a)}catch(c){const o=new Error(`Could not save item in localStorage: ${r}. [${c}]`);throw c instanceof Error&&(o.name=c.name),o}return!0}exists(r){return window.localStorage[r]!==void 0}delete(r){window.localStorage.removeItem(r)}}const i=new t},31140:(k,R,e)=>{"use strict";e.d(R,{A:()=>o,r:()=>c});var t=e(2543),n=e.n(t),i=e(54479),s=e(83195);function r(h,f){if(!h)return!1;if(h[0]==="/"){const d=(0,i.dO)(h);return f.match(d)!=null}return h===f}function g(h){return h===0?.001:h/10}function a(h){return h?{colors:[{opacity:0},{opacity:h/10}]}:null}function c(h,f,d){for(let p=0;p<h.length;p++){const m=h[p],v=f.yaxes,l=m.yaxis||1,y=v[l-1],u=(0,s.j_)(y.format);(0,t.isNumber)(f.decimals)?m.updateLegendValues(u,f.decimals):(0,t.isNumber)(y.decimals)?m.updateLegendValues(u,y.decimals+1):m.updateLegendValues(u,null)}}class o{constructor(f){this.datapoints=f.datapoints,this.label=f.alias,this.id=f.alias,this.alias=f.alias,this.aliasEscaped=(0,t.escape)(f.alias),this.color=f.color,this.bars={fillColor:f.color},this.valueFormater=(0,s.j_)("none"),this.stats={},this.legend=!0,this.unit=f.unit,this.dataFrameIndex=f.dataFrameIndex,this.fieldIndex=f.fieldIndex,this.hasMsResolution=this.isMsResolutionNeeded()}applySeriesOverrides(f){this.lines={},this.dashes={dashLength:[]},this.points={},this.yaxis=1,this.zindex=0,this.nullPointMode=null,delete this.stack,delete this.bars.show;for(let d=0;d<f.length;d++){const p=f[d];r(p.alias,this.alias)&&(p.lines!==void 0&&(this.lines.show=p.lines),p.dashes!==void 0&&(this.dashes.show=p.dashes,this.lines.lineWidth=0),p.points!==void 0&&(this.points.show=p.points),p.bars!==void 0&&(this.bars.show=p.bars),p.fill!==void 0&&(this.lines.fill=g(p.fill)),p.fillGradient!==void 0&&(this.lines.fillColor=a(p.fillGradient)),p.stack!==void 0&&(this.stack=p.stack),p.linewidth!==void 0&&(this.lines.lineWidth=this.dashes.show?0:p.linewidth,this.dashes.lineWidth=p.linewidth),p.dashLength!==void 0&&(this.dashes.dashLength[0]=p.dashLength),p.spaceLength!==void 0&&(this.dashes.dashLength[1]=p.spaceLength),p.nullPointMode!==void 0&&(this.nullPointMode=p.nullPointMode),p.pointradius!==void 0&&(this.points.radius=p.pointradius),p.steppedLine!==void 0&&(this.lines.steps=p.steppedLine),p.zindex!==void 0&&(this.zindex=p.zindex),p.fillBelowTo!==void 0&&(this.fillBelowTo=p.fillBelowTo),p.color!==void 0&&this.setColor(p.color),p.transform!==void 0&&(this.transform=p.transform),p.legend!==void 0&&(this.legend=p.legend),p.hideTooltip!==void 0&&(this.hideTooltip=p.hideTooltip),p.yaxis!==void 0&&(this.yaxis=p.yaxis),p.hiddenSeries!==void 0&&(this.hiddenSeries=p.hiddenSeries))}}getFlotPairs(f){const d=[];this.stats.total=0,this.stats.max=-Number.MAX_VALUE,this.stats.min=Number.MAX_VALUE,this.stats.logmin=Number.MAX_VALUE,this.stats.avg=null,this.stats.current=null,this.stats.first=null,this.stats.delta=0,this.stats.diff=null,this.stats.diffperc=0,this.stats.range=null,this.stats.timeStep=Number.MAX_VALUE,this.allIsNull=!0,this.allIsZero=!0;const p=f==="connected",m=f==="null as zero";let v,l,y=0,u,D=0,E=!0;for(let x=0;x<this.datapoints.length;x++){if(l=this.datapoints[x][0],v=this.datapoints[x][1],u!==void 0){const P=v-u;P<this.stats.timeStep&&(this.stats.timeStep=P)}if(u=v,l===null){if(p)continue;m&&(l=0)}l!==null&&((0,t.isNumber)(l)&&(this.stats.total+=l,this.allIsNull=!1,y++),l>this.stats.max&&(this.stats.max=l),l<this.stats.min&&(this.stats.min=l),this.stats.first===null?this.stats.first=l:D>l?(E=!1,x===this.datapoints.length-1&&(this.stats.delta+=l)):(E?this.stats.delta+=l-D:this.stats.delta+=l,E=!0),D=l,l<this.stats.logmin&&l>0&&(this.stats.logmin=l),l!==0&&(this.allIsZero=!1)),d.push([v,l])}return this.stats.max===-Number.MAX_VALUE&&(this.stats.max=null),this.stats.min===Number.MAX_VALUE&&(this.stats.min=null),d.length&&!this.allIsNull&&(this.stats.avg=this.stats.total/y,this.stats.current=d[d.length-1][1],this.stats.current===null&&d.length>1&&(this.stats.current=d[d.length-2][1])),this.stats.max!==null&&this.stats.min!==null&&(this.stats.range=this.stats.max-this.stats.min),this.stats.current!==null&&this.stats.first!==null&&(this.stats.diff=this.stats.current-this.stats.first,this.stats.diffperc=this.stats.diff/this.stats.first),this.stats.count=d.length,d}updateLegendValues(f,d){this.valueFormater=f,this.decimals=d}formatValue(f){return(0,t.isFinite)(f)||(f=null),(0,s.cN)(this.valueFormater(f,this.decimals))}isMsResolutionNeeded(){for(let f=0;f<this.datapoints.length;f++)if(this.datapoints[f][1]!==null&&this.datapoints[f][1]!==void 0){const d=this.datapoints[f][1].toString();if(d.length===13&&d%1e3!==0)return!0}return!1}hideFromLegend(f){return!!(f.hideEmpty&&this.allIsNull||!this.legend||f.hideZero&&this.allIsZero)}setColor(f){this.color=f,this.bars.fillColor=f}}},6262:(k,R,e)=>{"use strict";e.d(R,{G:()=>s});var t=e(80997),n=e(32264);const i=n.$.bootData.settings.cspReportOnlyEnabled,s={createHTML:(r,g,a)=>i?(console.error("[HTML not sanitized with Trusted Types]",r,g,a),r):r.replace(/<script/gi,"&lt;script"),createScript:r=>r,createScriptURL:(r,g,a)=>i?(console.error("[ScriptURL not sanitized with Trusted Types]",r,g,a),r):t.sQ.sanitizeUrl(r)};n.$.bootData.settings.trustedTypesDefaultPolicyEnabled&&window.trustedTypes&&window.trustedTypes.createPolicy&&window.trustedTypes.createPolicy("default",s)},96378:(k,R,e)=>{"use strict";e.d(R,{N:()=>o,e:()=>h});var t=e(74848),n=e(96540),i=e(70255),s=e(60578),r=e(3591),g=e(32264),a=e(10096),c=e(34295);const o=({children:f,value:d})=>{const[p,m]=(0,n.useState)(d);return(0,n.useEffect)(()=>{const v=a.lE.subscribe(r.E8,l=>{g.$.theme2=l.payload,m(l.payload)});return()=>v.unsubscribe()},[]),(0,t.jsx)(s.D.Provider,{value:p,children:(0,t.jsx)(i.z,{baseColor:p.colors.emphasize(p.colors.background.secondary),highlightColor:p.colors.emphasize(p.colors.background.secondary,.1),borderRadius:p.shape.radius.default,children:f})})},h=(f,d)=>function(m){return(0,t.jsx)(o,{value:d,children:n.createElement(f,{...m})})}},67278:(k,R,e)=>{"use strict";e.d(R,{c:()=>t});class t extends window.Worker{constructor(i,s){const r=i.toString(),g=r.split("/");g.pop();const a=`${g.join("/")}/`,c=`importScripts('${r}');`,o=URL.createObjectURL(new Blob([`__webpack_worker_public_path__ = '${a}'; ${c}`],{type:"application/javascript"}));super(o,s),URL.revokeObjectURL(o)}}},80714:(k,R,e)=>{"use strict";e.d(R,{F:()=>t});function t(n={}){return{...n,accesscontrol:!0}}},94041:(k,R,e)=>{"use strict";e.d(R,{b:()=>t});const t=(n,i,s)=>(n.splice(s,0,n.splice(i,1)[0]),n)},92315:(k,R,e)=>{"use strict";e.d(R,{W:()=>t,m:()=>n});function t(){const i=document.cookie.split("; ").find(r=>r.startsWith("grafana_session_expiry="));if(!i)return 0;let s=i.split("=").at(1);return s?parseInt(s,10):0}function n(){return document.cookie.split("; ").findIndex(i=>i.startsWith("grafana_session_expiry="))>-1}},63917:(k,R,e)=>{"use strict";e.d(R,{gn:()=>i});function t(){const s=navigator.userAgent.indexOf("MSIE")>-1,r=navigator.userAgent.indexOf("Edge/")>-1||navigator.userAgent.indexOf("Edg/")>-1,g=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,a=/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor),c=/Edge\/([0-9.]+)/.exec(navigator.userAgent);return s&&parseFloat(/Trident\/([0-9.]+)/.exec(navigator.userAgent)[1])<=7||r&&(c&&parseFloat(c[1])<=16||parseFloat(/Edg\/([0-9.]+)/.exec(navigator.userAgent)[1])<=16)||g&&parseFloat(/Firefox\/([0-9.]+)/.exec(navigator.userAgent)[1])<=64?!1:!(a&&parseFloat(/Chrome\/([0-9.]+)/.exec(navigator.userAgent)[1])<=54)}function n(){return/(iPhone|iPad|Mac)/.test(navigator.platform)}function i(){return n()?"\u2318":"ctrl"}},34525:(k,R,e)=>{"use strict";e.d(R,{TS:()=>i});class t{_linkTo(a,c){c<=0&&a.inputEdges.push(this),c>=0&&a.outputEdges.push(this),a.edges.push(this)}link(a,c){if(!a)throw Error("inputNode is required");if(!c)throw Error("outputNode is required");return this.unlink(),this.inputNode=a,this.outputNode=c,this._linkTo(a,1),this._linkTo(c,-1),this}unlink(){let a;const c=this.inputNode,o=this.outputNode;c&&o&&(a=c.edges.indexOf(this),a>-1&&c.edges.splice(a,1),a=o.edges.indexOf(this),a>-1&&o.edges.splice(a,1),a=c.outputEdges.indexOf(this),a>-1&&c.outputEdges.splice(a,1),a=o.inputEdges.indexOf(this),a>-1&&o.inputEdges.splice(a,1))}}class n{constructor(a){this.name=a,this.edges=[],this.inputEdges=[],this.outputEdges=[]}getEdgeFrom(a){return a?typeof a=="object"?this.inputEdges.find(c=>c.inputNode?.name===a.name):this.inputEdges.find(c=>c.inputNode?.name===a):null}getEdgeTo(a){return a?typeof a=="object"?this.outputEdges.find(c=>c.outputNode?.name===a.name):this.outputEdges.find(c=>c.outputNode?.name===a):null}getOptimizedInputEdges(){const a=[];return this.inputEdges.forEach(c=>{c.inputNode?.inputEdges.map(h=>h.inputNode)?.forEach(h=>{const f=h?.getEdgeTo(this.name);f&&a.push(f)})}),this.inputEdges.filter(c=>a.indexOf(c)===-1)}}class i{constructor(){this.nodes={}}createNode(a){const c=new n(a);return this.nodes[a]=c,c}createNodes(a){const c=[];return a.forEach(o=>{c.push(this.createNode(o))}),c}link(a,c){let o=[],h=[];const f=[],d=[];a instanceof Array?o=a:o=[a],c instanceof Array?h=c:h=[c];for(let m=0;m<o.length;m++){const v=o[m];if(typeof v=="string"){const l=this.getNode(v);if(!l)throw Error(`cannot link input node named ${v} since it doesn't exist in graph`);f.push(l)}else f.push(v)}for(let m=0;m<h.length;m++){const v=h[m];if(typeof v=="string"){const l=this.getNode(v);if(!l)throw Error(`cannot link output node named ${v} since it doesn't exist in graph`);d.push(l)}else d.push(v)}const p=[];return f.forEach(m=>{d.forEach(v=>{p.push(this.createEdge().link(m,v))})}),p}descendants(a){if(!a.length)return new Set;const c=new Set(r(a)?a.map(o=>this.nodes[o]).filter(o=>o!==void 0):a);return this.descendantsRecursive(c)}descendantsRecursive(a,c=new Set){for(const o of a){const h=new Set;for(const{inputNode:f}of o.inputEdges)f&&!c.has(f)&&(c.add(f),h.add(f));this.descendantsRecursive(h,c)}return c}createEdge(){return new t}getNode(a){return this.nodes[a]}}const s=g=>{Object.keys(g.nodes).forEach(a=>{const c=g.nodes[a];let o=c.outputEdges.map(f=>f.outputNode?.name).join(", ");o||(o="<none>");let h=c.inputEdges.map(f=>f.inputNode?.name).join(", ");h||(h="<none>"),console.log(`${c.name}:
 - links to:   ${o}
 - links from: ${h}`)})};function r(g){return g.length>0&&typeof g[0]=="string"}},94954:(k,R,e)=>{"use strict";e.d(R,{q:()=>n});var t=e(17172);function n(i){if(typeof i=="string")return i;if(i){if(i instanceof Error)return i.message;if((0,t.NF)(i)){if(i.data&&i.data.message)return i.data.message;if(i.statusText)return i.statusText}}return JSON.stringify(i)}},87490:(k,R,e)=>{"use strict";e.d(R,{HQ:()=>u,Ll:()=>T,MA:()=>O,WP:()=>m,Xe:()=>x,_u:()=>B,bI:()=>b,dY:()=>N,di:()=>S,dr:()=>D,eF:()=>C,o$:()=>E,uE:()=>w,uJ:()=>K,uq:()=>P,w4:()=>M,zT:()=>L,zq:()=>F});var t=e(44329),n=e(62938),i=e(52622),s=e(76885),r=e(41987),g=e(43127),a=e(77789),c=e(65879),o=e(19347),h=e(11134),f=e(33390),d=e(66718);const p={dedupStrategy:i.fY.none},m="0123456789abcdefghijklmnopqrstuvwxyz",v=(0,t.d_)(m,3),l="grafana.explore.datasource",y=V=>`${l}.${V}`,u=V=>f.A.getObject(y(V)),D=(V,H)=>f.A.setObject(y(V),H);function E(){for(;;){const V=v(3);if(!/^\d+$/.test(V))return V}}async function x(V){const{queries:H,dsRef:Y,timeRange:X,scopedVars:J,adhocFilters:q}=V,ae=(await Promise.allSettled(H.filter(te=>te.datasource?.uid!==d.Uj).map(async te=>{const ne=await(0,o.l)().get(te.datasource||Y);return{...ne.interpolateVariablesInQueries?.([te],J??{},q)[0]||te,...!ne.meta.mixed&&{datasource:ne.getRef()}}}))).filter(te=>te.status==="fulfilled").map(te=>te.value),j=JSON.stringify({[E()]:{range:(0,s.sQ)(X.raw),queries:ae,datasource:Y?.uid}});return s.kM.renderUrl("/explore",{panes:j,schemaVersion:1})}function P(V){return`explore_${V}`}function b(V,H,Y,X,J,q,ae){const j=Number.parseInt(V,36),{interval:te,intervalMs:ne}=U(X,Y.minInterval,Y.maxDataPoints),le={app:r.Jk.Explore,timezone:q||g.lE,startTime:Date.now(),interval:te,intervalMs:ne,panelId:j,targets:H,range:X,requestId:P(V),rangeRaw:X.raw,scopedVars:{__interval:{text:te,value:te},__interval_ms:{text:ne,value:ne},...ae},maxDataPoints:Y.maxDataPoints,liveStreaming:Y.liveStreaming,skipQueryCache:!0};return{queries:H,request:le,scanning:J,id:I(),done:!1}}const M=({key:V,...H})=>H,O=(V,H)=>{if(V==null)return"";try{return JSON.stringify(V,null,H)}catch(Y){console.error(Y)}return""};function I(V=0){return`Q-${(0,n.A)()}-${V}`}async function T(V,H=0,Y){let X,J,q;return Y?J=Y:V.length>0&&V[V.length-1].datasource?J=V[V.length-1].datasource:(X=await(0,o.l)().get(),q=X.getDefaultQuery?.(r.Jk.Explore),J=X.getRef()),X||(X=await(0,o.l)().get(J),q=X.getDefaultQuery?.(r.Jk.Explore)),{...q,refId:(0,a.M)(V),key:I(H),datasource:J}}const C=(V,H,Y=0)=>{const X=I(Y),J=V.refId||(0,a.M)(H);return{...V,refId:J,key:X}};async function S(V,H){if(V&&typeof V=="object"&&V.length>0){const Y=[];for(let X=0;X<V.length;X++){const J=V[X],q=I(X);let ae=J.refId;ae||(ae=(0,a.M)(Y));let j=!0;if(J.datasource)try{await(0,o.l)().get(J.datasource.uid)}catch{console.error("One of the queries has a datasource that is no longer available and was removed."),j=!1}j&&Y.push({...J,refId:ae,key:q})}return Y}try{const Y=H??(await(0,o.l)().get()).getRef();return[await T(V??[],void 0,Y)]}catch{return[]}}const A=["refId","key","context","datasource"];function L(V){return V&&V.some(H=>Object.entries(H).filter(([X,J])=>A.indexOf(X)===-1).filter(([X,J])=>J).length>0)}const N=V=>V.reduce((Y,X,J)=>{const q=X.datasource?.uid||X.key;return Y.concat(`${q}-${J}`)},[]),F=(V,H,Y)=>c.convertRawToRange(H,V,Y),w=V=>h.cC.isLive(V)?i.uH.Ascending:i.uH.Descending,B=V=>{V&&V.unsubscribe()};function U(V,H,Y){return Y?c.calculateInterval(V,Y,H):{interval:"1s",intervalMs:1e3}}const K=V=>{if(navigator.clipboard&&window.isSecureContext)navigator.clipboard.writeText(V);else{const H=document.createElement("textarea");H.value=V,document.body.appendChild(H),H.select(),document.execCommand("copy"),document.body.removeChild(H)}}},78827:(k,R,e)=>{"use strict";e.r(R),e.d(R,{default:()=>t});function t(n,i){i=i||{};const s=i.delimiter||".";let r=i.maxDepth||3,g=1;const a={};function c(o,h){Object.entries(o).forEach(([f,d])=>{const p=i?.safe&&Array.isArray(d),v=Object.prototype.toString.call(d)==="[object Object]",l=h?h+s+f:f;if(i?.maxDepth||(r=g+1),!p&&v&&Object.keys(d).length&&g<r)return++g,c(d,l);a[l]=d})}return c(n,null),a}},68576:(k,R,e)=>{"use strict";e.d(R,{A:()=>a});var t=e(95344),n=e(54479),i=e(65879),s=e(83195);const g={valueFormats:{},intervalRegex:/(\d+(?:\.\d+)?)(ms|[Mwdhmsy])/,intervalsInSeconds:{y:31536e3,M:2592e3,w:604800,d:86400,h:3600,m:60,s:1,ms:.001},regexEscape:c=>((0,t.l)("kbn.ts","kbn.regexEscape()","escapeRegex from @grafana/data"),(0,n.$f)(c)),roundInterval:c=>((0,t.l)("kbn.ts","kbn.roundInterval()","@grafana/data"),i.roundInterval(c)),secondsToHms:c=>((0,t.l)("kbn.ts","kbn.secondsToHms()","@grafana/data"),i.secondsToHms(c)),secondsToHhmmss:c=>{const o=[],h=Math.floor(c/3600),f=Math.floor(c%3600/60),d=Math.floor(c%3600%60);return h>9?o.push(""+h):o.push("0"+h),f>9?o.push(""+f):o.push("0"+f),d>9?o.push(""+d):o.push("0"+d),o.join(":")},toPercent:(c,o)=>Math.floor(c/o*1e4)/100+"%",addSlashes:c=>c.replace(/[\'\"\\0]/g,"\\$&"),describeInterval:c=>((0,t.l)("kbn.ts","kbn.describeInterval()","@grafana/data"),i.describeInterval(c)),intervalToSeconds:c=>((0,t.l)("kbn.ts","rangeUtil.intervalToSeconds()","@grafana/data"),i.intervalToSeconds(c)),intervalToMs:c=>((0,t.l)("kbn.ts","rangeUtil.intervalToMs()","@grafana/data"),i.intervalToMs(c)),calculateInterval:(c,o,h)=>((0,t.l)("kbn.ts","kbn.calculateInterval()","@grafana/data"),i.calculateInterval(c,o,h)),queryColorDot:(c,o)=>'<div class="icon-circle" style="'+["display:inline-block","color:"+c,"font-size:"+o+"px"].join(";")+'"></div>',slugifyForUrl:c=>c.toLowerCase().replace(/[^\w ]+/g,"").replace(/ +/g,"-"),stringToJsRegex:c=>((0,t.l)("kbn.ts","kbn.stringToJsRegex()","@grafana/data"),(0,n.dO)(c)),toFixed:(c,o)=>{if(c===null)return"";const h=o?Math.pow(10,Math.max(0,o)):1,f=String(Math.round(c*h)/h);if(f.indexOf("e")!==-1||c===0)return f;if(o!=null){const d=f.indexOf("."),p=d===-1?0:f.length-d-1;if(p<o)return(p?f:f+".")+String(h).slice(1,o-p+1)}return f},toFixedScaled:(c,o,h,f,d)=>h===null?g.toFixed(c,o)+d:g.toFixed(c,h+f)+d,roundValue:(c,o)=>{if(c===null)return null;const h=Math.pow(10,o),f=(h*c).toFixed(o);return Math.round(parseFloat(f))/h},getUnitFormats:s.Ke};typeof Proxy<"u"?g.valueFormats=new Proxy(g.valueFormats,{get(c,o,h){if(typeof o!="string")throw{message:`Value format ${String(o)} is not a string`};const f=(0,s.j_)(o);return f?(d,p,m,v)=>(0,s.cN)(f(d,p,m,v?"utc":"browser")):Reflect.get(c,o,h)}}):g.valueFormats=(0,s.uH)();const a=g},78160:(k,R,e)=>{"use strict";e.d(R,{j:()=>n,z:()=>i});var t=e(42614);function n(s){if(!(!performance||!performance.mark))try{performance.mark(`${s}_started`)}catch(r){console.error(`[Metrics] Failed to startMeasure ${s}`,r)}}function i(s){if(!(!performance||!performance.mark))try{const r=`${s}_started`,g=`${s}_completed`,a=`${s}_measured`;performance.mark(g);const c=performance.measure(a,r,g);return(0,t.n)(`${s}_ms`,c.duration),performance.clearMarks(r),performance.clearMarks(g),performance.clearMeasures(a),c}catch(r){console.error(`[Metrics] Failed to stopMeasure ${s}`,r);return}}},36689:(k,R,e)=>{"use strict";e.d(R,{C:()=>n,o:()=>i});var t=e(8484);function n(s){switch(s){case"home":return(0,t.t)("nav.home.title","Home");case"new":return(0,t.t)("nav.new.title","New");case"create":return(0,t.t)("nav.create.title","Create");case"create-dashboard":return(0,t.t)("nav.create-dashboard.title","Dashboard");case"folder":return(0,t.t)("nav.create-folder.title","Folder");case"import":return(0,t.t)("nav.create-import.title","Import dashboard");case"alert":return(0,t.t)("nav.create-alert.title","New alert rule");case"bookmarks":return(0,t.t)("nav.bookmarks.title","Bookmarks");case"bookmarks-empty":return(0,t.t)("nav.bookmarks-empty.title","Bookmark pages for them to appear here");case"starred":return(0,t.t)("nav.starred.title","Starred");case"starred-empty":return(0,t.t)("nav.starred-empty.title","Your starred dashboards will appear here");case"dashboards":return(0,t.t)("nav.dashboards.title","Dashboards");case"dashboards/browse":return(0,t.t)("nav.dashboards.title","Dashboards");case"dashboards/playlists":return(0,t.t)("nav.playlists.title","Playlists");case"dashboards/snapshots":return(0,t.t)("nav.snapshots.title","Snapshots");case"dashboards/library-panels":return(0,t.t)("nav.library-panels.title","Library panels");case"reports":return(0,t.t)("nav.reporting.title","Reporting");case"dashboards/public":return(0,t.t)("nav.public.title","Public dashboards");case"dashboards/recently-deleted":return(0,t.t)("nav.recently-deleted.title","Recently deleted");case"dashboards/new":return(0,t.t)("nav.new-dashboard.title","New dashboard");case"dashboards/folder/new":return(0,t.t)("nav.new-folder.title","New folder");case"dashboards/import":return(0,t.t)("nav.create-import.title","Import dashboard");case"scenes":return(0,t.t)("nav.scenes.title","Scenes");case"explore":return(0,t.t)("nav.explore.title","Explore");case"alerting":return(0,t.t)("nav.alerting.title","Alerting");case"plugin-page-grafana-oncall-app":return(0,t.t)("nav.oncall.title","OnCall");case"alerting-legacy":return(0,t.t)("nav.alerting-legacy.title","Alerting (legacy)");case"alerting-upgrade":return(0,t.t)("nav.alerting-upgrade.title","Alerting upgrade");case"alert-home":return(0,t.t)("nav.alerting-home.title","Home");case"alert-list":return(0,t.t)("nav.alerting-list.title","Alert rules");case"alert-list-legacy":return(0,t.t)("nav.alert-list-legacy.title","Alert rules");case"receivers":return(0,t.t)("nav.alerting-receivers.title","Contact points");case"am-routes":return(0,t.t)("nav.alerting-am-routes.title","Notification policies");case"channels":return(0,t.t)("nav.alerting-channels.title","Notification channels");case"silences":return(0,t.t)("nav.alerting-silences.title","Silences");case"groups":return(0,t.t)("nav.alerting-groups.title","Active notifications");case"alerting-admin":return(0,t.t)("nav.alerting-admin.title","Settings");case"cfg":return(0,t.t)("nav.config.title","Administration");case"cfg/general":return(0,t.t)("nav.config-general.title","General");case"cfg/plugins":return(0,t.t)("nav.config-plugins.title","Plugins and data");case"cfg/access":return(0,t.t)("nav.config-access.title","Users and access");case"datasources":return(0,t.t)("nav.datasources.title","Data sources");case"authentication":return(0,t.t)("nav.authentication.title","Authentication");case"licensing":return(0,t.t)("nav.statistics-and-licensing.title","Statistics and licensing");case"recordedQueries":return(0,t.t)("nav.recorded-queries.title","Recorded queries");case"correlations":return(0,t.t)("nav.correlations.title","Correlations");case"users":return(0,t.t)("nav.users.title","Users");case"teams":return(0,t.t)("nav.teams.title","Teams");case"plugins":return(0,t.t)("nav.plugins.title","Plugins");case"org-settings":return(0,t.t)("nav.org-settings.title","Default preferences");case"apikeys":return(0,t.t)("nav.api-keys.title","API keys");case"serviceaccounts":return(0,t.t)("nav.service-accounts.title","Service accounts");case"admin":return(0,t.t)("nav.admin.title","Server admin");case"support-bundles":return(0,t.t)("nav.support-bundles.title","Support bundles");case"global-users":return(0,t.t)("nav.global-users.title","Users");case"global-orgs":return(0,t.t)("nav.global-orgs.title","Organizations");case"server-settings":return(0,t.t)("nav.server-settings.title","Settings");case"storage":return(0,t.t)("nav.storage.title","Storage");case"migrate-to-cloud":return(0,t.t)("nav.migrate-to-cloud.title","Migrate to Grafana Cloud");case"upgrading":return(0,t.t)("nav.upgrading.title","Stats and license");case"monitoring":return(0,t.t)("nav.monitoring.title","Observability");case"infrastructure":return(0,t.t)("nav.infrastructure.title","Infrastructure");case"frontend":return(0,t.t)("nav.frontend.title","Frontend");case"apps":return(0,t.t)("nav.apps.title","Apps");case"alerts-and-incidents":return(0,t.t)("nav.alerts-and-incidents.title","Alerts & IRM");case"testing-and-synthetics":return(0,t.t)("nav.testing-and-synthetics.title","Testing & synthetics");case"plugin-page-grafana-incident-app":return(0,t.t)("nav.incidents.title","Incident");case"plugin-page-grafana-ml-app":return(0,t.t)("nav.machine-learning.title","Machine learning");case"plugin-page-grafana-slo-app":return(0,t.t)("nav.slo.title","SLO");case"plugin-page-k6-app":return(0,t.t)("nav.k6.title","Performance");case"monitoring":return(0,t.t)("nav.observability.title","Observability");case"plugin-page-grafana-k8s-app":return(0,t.t)("nav.kubernetes.title","Kubernetes");case"plugin-page-grafana-app-observability-app":return(0,t.t)("nav.application.title","Application");case"plugin-page-grafana-pyroscope-app":return(0,t.t)("nav.profiles.title","Profiles");case"plugin-page-grafana-kowalski-app":return(0,t.t)("nav.frontend-app.title","Frontend");case"plugin-page-grafana-synthetic-monitoring-app":return(0,t.t)("nav.synthetics.title","Synthetics");case"help":return(0,t.t)("nav.help.title","Help");case"profile/settings":return(0,t.t)("nav.profile/settings.title","Profile");case"profile/notifications":return(0,t.t)("nav.profile/notifications.title","Notification history");case"profile/password":return(0,t.t)("nav.profile/password.title","Change password");case"sign-out":return(0,t.t)("nav.sign-out.title","Sign out");case"search":return(0,t.t)("nav.search-dashboards.title","Search dashboards");case"connections":return(0,t.t)("nav.connections.title","Connections");case"connections-add-new-connection":return(0,t.t)("nav.add-new-connections.title","Add new connection");case"standalone-plugin-page-/connections/collector":return(0,t.t)("nav.collector.title","Collector");case"connections-datasources":return(0,t.t)("nav.data-sources.title","Data sources");case"standalone-plugin-page-/connections/infrastructure":return(0,t.t)("nav.integrations.title","Integrations");case"standalone-plugin-page-/connections/connect-data":return(0,t.t)("nav.connect-data.title","Connect data");case"standalone-plugin-page-/connections/private-data-source-connections":return(0,t.t)("nav.private-data-source-connections.title","Private data source connect");case"plugin-page-grafana-detect-app":return(0,t.t)("nav.detect.title","Detect");case"plugin-page-grafana-quaderno-app":return(0,t.t)("nav.grafana-quaderno.title","Grafana Quaderno");default:return}}function i(s){switch(s){case"dashboards":return(0,t.t)("nav.dashboards.subtitle","Create and manage dashboards to visualize your data");case"dashboards/browse":return(0,t.t)("nav.dashboards.subtitle","Create and manage dashboards to visualize your data");case"manage-folder":return(0,t.t)("nav.manage-folder.subtitle","Manage folder dashboards and permissions");case"dashboards/playlists":return(0,t.t)("nav.playlists.subtitle","Groups of dashboards that are displayed in a sequence");case"dashboards/snapshots":return(0,t.t)("nav.snapshots.subtitle","Interactive, publically available, point-in-time representations of dashboards");case"dashboards/library-panels":return(0,t.t)("nav.library-panels.subtitle","Reusable panels that can be added to multiple dashboards");case"dashboards/recently-deleted":return(0,t.t)("nav.recently-deleted.subtitle","Any items listed here for more than 30 days will be automatically deleted.");case"alerting":return(0,t.t)("nav.alerting.subtitle","Learn about problems in your systems moments after they occur");case"alerting-upgrade":return(0,t.t)("nav.alerting-upgrade.subtitle","Upgrade your existing legacy alerts and notification channels to the new Grafana Alerting");case"alerting-admin":return(0,t.t)("nav.alerting-admin.subtitle","Manage Alertmanager configurations");case"alert-list":return(0,t.t)("nav.alerting-list.subtitle","Rules that determine whether an alert will fire");case"receivers":return(0,t.t)("nav.alerting-receivers.subtitle","Choose how to notify your contact points when an alert instance fires");case"am-routes":return(0,t.t)("nav.alerting-am-routes.subtitle","Determine how alerts are routed to contact points");case"silences":return(0,t.t)("nav.alerting-silences.subtitle","Stop notifications from one or more alerting rules");case"groups":return(0,t.t)("nav.alerting-groups.subtitle","See grouped alerts with active notifications");case"datasources":return(0,t.t)("nav.datasources.subtitle","Add and configure data sources");case"correlations":return(0,t.t)("nav.correlations.subtitle","Add and configure correlations");case"users":return(0,t.t)("nav.users.subtitle","Invite and assign roles to users");case"teams":return(0,t.t)("nav.teams.subtitle","Groups of users that have common dashboard and permission needs");case"plugins":return(0,t.t)("nav.plugins.subtitle","Extend the Grafana experience with plugins");case"org-settings":return(0,t.t)("nav.org-settings.subtitle","Manage preferences across an organization");case"apikeys":return(0,t.t)("nav.api-keys.subtitle","Manage and create API keys that are used to interact with Grafana HTTP APIs");case"serviceaccounts":return(0,t.t)("nav.service-accounts.subtitle","Use service accounts to run automated workloads in Grafana");case"global-users":return(0,t.t)("nav.global-users.subtitle","Manage users in Grafana");case"global-orgs":return(0,t.t)("nav.global-orgs.subtitle","Isolated instances of Grafana running on the same server");case"server-settings":return(0,t.t)("nav.server-settings.subtitle","View the settings defined in your Grafana config");case"storage":return(0,t.t)("nav.storage.subtitle","Manage file storage");case"migrate-to-cloud":return(0,t.t)("nav.migrate-to-cloud.subtitle","Copy configuration from your self-managed installation to a cloud stack");case"support-bundles":return(0,t.t)("nav.support-bundles.subtitle","Download support bundles");case"admin":return(0,t.t)("nav.admin.subtitle","Manage server-wide settings and access to resources such as organizations, users, and licenses");case"cfg/general":return(0,t.t)("nav.config-general.subtitle","Manage default preferences and settings across Grafana");case"cfg/plugins":return(0,t.t)("nav.config-plugins.subtitle","Install plugins and define the relationships between data");case"cfg/access":return(0,t.t)("nav.config-access.subtitle","Configure access for individual users, teams, and service accounts");case"apps":return(0,t.t)("nav.apps.subtitle","App plugins that extend the Grafana experience");case"monitoring":return(0,t.t)("nav.monitoring.subtitle","Out-of-the-box observability solutions");case"infrastructure":return(0,t.t)("nav.infrastructure.subtitle","Understand your infrastructure's health");case"frontend":return(0,t.t)("nav.frontend.subtitle","Gain real user monitoring insights");case"alerts-and-incidents":return(0,t.t)("nav.alerts-and-incidents.subtitle","Alerting and incident management apps");case"testing-and-synthetics":return(0,t.t)("nav.testing-and-synthetics.subtitle","Optimize performance with k6 and Synthetic Monitoring insights");case"connections-add-new-connection":return(0,t.t)("nav.connections.subtitle","Browse and create new connections");case"connections-datasources":return(0,t.t)("nav.data-sources.subtitle","View and manage your connected data source connections");case"connections-private-data-source-connections":return(0,t.t)("nav.private-data-source-connections.subtitle","Query data that lives within a secured network without opening the network to inbound traffic from Grafana Cloud. Learn more in our docs.");default:return}}},28874:(k,R,e)=>{"use strict";e.d(R,{v:()=>i});var t=e(2543),n=e.n(t);function i(s){return(0,t.isArray)(s)?s.map(i):(0,t.isPlainObject)(s)?Object.keys(s).sort().reduce((r,g)=>{const a=s[g];return a!=null&&(r[g]=i(a)),r},{}):s}},21969:(k,R,e)=>{"use strict";e.d(R,{Ih:()=>n,Lr:()=>r,U7:()=>i,dr:()=>s,fE:()=>g});var t=e(77789);function n(a){const c=["refId","hide","key","queryType","datasource"];for(const o in a)if(o!=="label"&&!c.includes(o))return!1;return!0}function i(a,c,o){const h={...c,refId:(0,t.M)(a),hide:!1};return!h.datasource&&o&&(h.datasource=o),[...a,h]}function s(a){return a.indexOf("api/datasources/proxy")!==-1||a.indexOf("api/ds/query")!==-1}function r(a){return!a.match(/^http/)}function g(a){return a||void 0}},81523:(k,R,e)=>{"use strict";e.d(R,{Ax:()=>C,DI:()=>l,Gx:()=>u,IA:()=>M,NC:()=>P,TR:()=>A,U3:()=>b,X1:()=>D,cX:()=>x,ev:()=>I,l0:()=>v,oU:()=>E,rs:()=>y,x8:()=>S,xB:()=>m.x});var t=e(2543),n=e.n(t),i=e(76885),s=e(72724),r=e(19347),g=e(82467),a=e(3169),c=e(8484),o=e(99140),h=e(38877),f=e(75533),d=e(11401),p=e(16233),m=e(91650);async function v(N){const{queries:F,localOverride:w,datasource:B,starred:U,comment:K,showNotif:V}=N,H=V?.quotaExceededError??!0,Y=V?.limitExceededWarning??!0,X=V?.otherErrors??!0,J=F&&F.filter(q=>L(q));if(J.length>0){let q=!1,ae=!1,j;try{j=(await(w?(0,d.tU)():(0,d.a)()).addToRichHistory({datasourceUid:B.uid,datasourceName:B.name??"",queries:J,starred:U,comment:K??""})).warning}catch(te){return te instanceof Error&&(te.name===h.m.StorageFull?(q=!0,H&&(0,o.JD)((0,g.dx)((0,a.gi)(te.message)))):X&&te.name!==h.m.DuplicatedEntry&&(0,o.JD)((0,g.dx)((0,a.gi)((0,c.t)("explore.rich-history-utils-notification.update-failed","Rich History update failed"),te.message)))),{richHistoryStorageFull:q,limitExceeded:ae}}return j&&j.type===h.C.LimitExceeded&&(ae=!0,Y&&(0,o.JD)((0,g.dx)((0,a.q8)(j.message)))),{richHistoryStorageFull:q,limitExceeded:ae}}return{}}async function l(N){const F={...N,from:N.to===void 0?N.to:(0,f.wQ)(N.to,{isLastTs:!0,tz:p.TP.user?.timezone}),to:N.from===void 0?N.from:(0,f.wQ)(N.from,{isLastTs:!0,tz:p.TP.user?.timezone})};return await(0,d.a)().getRichHistory(F)}async function y(N){await(0,d.a)().updateSettings(N)}async function u(){return await(0,d.a)().getSettings()}async function D(){return(0,d.a)().deleteAll()}async function E(N,F){try{return await(0,d.a)().updateStarred(N,F)}catch(w){w instanceof Error&&(0,o.JD)((0,g.dx)((0,a.gi)((0,c.t)("explore.rich-history-utils-notification.saving-failed","Saving rich history failed"),w.message)));return}}async function x(N,F){try{return await(0,d.a)().updateComment(N,F)}catch(w){w instanceof Error&&(0,o.JD)((0,g.dx)((0,a.gi)((0,c.t)("explore.rich-history-utils-notification.saving-failed","Saving rich history failed"),w.message)));return}}async function P(N){try{return await(0,d.a)().deleteRichHistory(N),N}catch(F){F instanceof Error&&(0,o.JD)((0,g.dx)((0,a.gi)((0,c.t)("explore.rich-history-utils-notification.saving-failed","Saving rich history failed"),F.message)));return}}const b=N=>{const F={range:{from:(0,c.t)("explore.rich-history-utils.default-from","now-1h"),to:(0,c.t)("explore.rich-history-utils.default-to","now")},datasource:N.datasourceName,queries:N.queries},w=(0,i.Pp)(F),B=/.*(?=\/explore)/.exec(`${window.location.href}`)[0];return i.kM.renderUrl(`${B}/explore`,{left:w})},M=N=>{let F;switch(N){case 0:F=(0,c.t)("explore.rich-history-utils.today","today");break;case 1:F=(0,c.t)("explore.rich-history-utils.yesterday","yesterday");break;case 7:F=(0,c.t)("explore.rich-history-utils.a-week-ago","a week ago");break;case 14:F=(0,c.t)("explore.rich-history-utils.two-weeks-ago","two weeks ago");break;default:F=(0,c.t)("explore.rich-history-utils.days-ago","{{num}} days ago",{num:`${N}`})}return F};function O(N){return(0,s.LE)(N,{format:"MMMM D"})}function I(N){const F=(0,t.omit)(N,["key","refId","datasource"]);return JSON.stringify(F)}function T(N,F){let w="";return F===m.x.DatasourceAZ||F===m.x.DatasourceZA?w=N.datasourceName:w=O(N.createdAt),w}function C(N,F){return F?.getQueryDisplayText?F.getQueryDisplayText(N):I(N)}function S(N,F){let w={};return N.forEach(B=>{let U=T(B,F);U in w?w[U]=[...w[U],B]:w[U]=[B]}),w}function A(){return(0,r.l)().getList({mixed:!0}).map(N=>({name:N.name,uid:N.uid}))}function L(N){const F=(0,t.omit)(N,["key","refId","datasource"]);return Object.keys(F).length>0}},91650:(k,R,e)=>{"use strict";e.d(R,{x:()=>t});var t=(n=>(n.Descending="Descending",n.Ascending="Ascending",n.DatasourceAZ="Datasource A-Z",n.DatasourceZA="Datasource Z-A",n))(t||{})},7030:(k,R,e)=>{"use strict";e.d(R,{$l:()=>u,Sp:()=>l,VN:()=>y,VP:()=>v,fn:()=>m});var t=e(41811),n=e(32264),i=e(17172),s=e(39601),r=e(80943),g=e(82467),a=e(3169),c=e(11982),o=e(99140),h=e(8484),f=e(87490);function d(){return`${window.location.protocol}//${window.location.host}${n.$.appSubUrl}`}function p(D){let E=D.replace(d(),"");return E.startsWith("/")?E.substring(1,E.length):E}const m=(0,t.A)(async function(D){try{return(await(0,i.AI)().post("/api/short-urls",{path:p(D)})).url}catch(E){console.error("Error when creating shortened link: ",E),(0,o.JD)((0,g.dx)((0,a.gi)("Error generating shortened link")))}}),v=async D=>{const E=await m(D);E?((0,f.uJ)(E),(0,o.JD)((0,g.dx)((0,a.tZ)("Shortened link copied to clipboard")))):(0,o.JD)((0,g.dx)((0,a.gi)("Error generating shortened link")))},l=async(D,E,x)=>{const P=y(D,E,x);if(E.useShortUrl)return await v(P);(0,f.uJ)(P),(0,o.JD)((0,g.dx)((0,a.tZ)((0,h.t)("link.share.copy-to-clipboard","Link copied to clipboard"))))},y=(D,E,x)=>{const P=s.Ny.getLocation(),b=r.jh.getTimeRange(x??D),M=u(E,b,x);return(0,c.uZ)({uid:D.state.uid,slug:D.state.meta.slug,currentQueryParams:P.search,updateQuery:M,absolute:!0})},u=(D,E,x)=>{const P={};return x&&(P.viewPanel=x.state.key),D.useAbsoluteTimeRange&&(P.from=E.state.value.from.toISOString(),P.to=E.state.value.to.toISOString()),D.theme!=="current"&&(P.theme=D.theme),P}},92247:(k,R,e)=>{"use strict";e.r(R),e.d(R,{getPrecision:()=>r,getScaledDecimals:()=>n,getStringPrecision:()=>g,grafanaTimeFormat:()=>i,logp:()=>s,tickStep:()=>t});function t(a,c,o){const h=Math.sqrt(50),f=Math.sqrt(10),d=Math.sqrt(2),p=Math.abs(c-a)/Math.max(0,o);let m=Math.pow(10,Math.floor(Math.log(p)/Math.LN10));const v=p/m;return v>=h?m*=10:v>=f?m*=5:v>=d&&(m*=2),c<a?-m:m}function n(a,c){return a-Math.floor(Math.log(c)/Math.LN10)}function i(a,c,o){if(c&&o&&a){const h=o-c,f=h/a/1e3,d=864e5,p=31536e6;return f<=45?"HH:mm:ss":f<=7200||h<=d?"HH:mm":f<=8e4?"MM/DD HH:mm":f<=2419200||h<=p?"MM/DD":"YYYY-MM"}return"HH:mm"}function s(a,c){return Math.log(a)/Math.log(c)}function r(a){const c=a.toString();return g(c)}function g(a){if(isNaN(a))return 0;const c=a.indexOf(".");return c===-1?0:a.length-c-1}},80582:(k,R,e)=>{"use strict";e.d(R,{Wb:()=>n,Zk:()=>i,zG:()=>s});var t=e(47232);const n=(r,g)=>{const a={from:(0,t.yT)(g.from),to:(0,t.yT)(g.to)},c=(a.to.valueOf()-a.from.valueOf())/2;let o,h;return r===-1?(o=a.to.valueOf()-c,h=a.from.valueOf()-c):r===1?(o=a.to.valueOf()+c,h=a.from.valueOf()+c,o>Date.now()&&a.to.valueOf()<Date.now()&&(o=Date.now(),h=a.from.valueOf())):(o=a.to.valueOf(),h=a.from.valueOf()),{from:h,to:o}},i=(r,g)=>{const a=r.to.valueOf()-r.from.valueOf(),c=r.to.valueOf()-a/2,o=a===0?3e4:a*g,h=c+o/2;return{from:c-o/2,to:h}};async function s(){const r=await navigator.clipboard.readText();let g;try{return g=JSON.parse(r),!g.from||!g.to?{range:r,isError:!0}:{range:g,isError:!1}}catch{return{range:r,isError:!0}}}},94515:(k,R,e)=>{"use strict";e.d(R,{iU:()=>n});var t=e(47232);function n(r,g){if(!(r.fromDayOfWeek||r.from)&&!(r.toDayOfWeek||r.to))return[];const a={...r};a.from&&!a.to&&(a.to=a.from),!a.from&&a.to&&(a.from=a.to);const c={from:i(a.from),to:i(a.to)};if(!a.fromDayOfWeek&&a.toDayOfWeek&&(a.fromDayOfWeek=a.toDayOfWeek),!a.toDayOfWeek&&a.fromDayOfWeek&&(a.toDayOfWeek=a.fromDayOfWeek),a.fromDayOfWeek&&(c.from.dayOfWeek=Number(a.fromDayOfWeek)),a.toDayOfWeek&&(c.to.dayOfWeek=Number(a.toDayOfWeek)),c.from.dayOfWeek&&c.from.h==null&&c.from.m==null&&(c.from.h=0,c.from.m=0,c.from.s=0),c.to.dayOfWeek&&c.to.h==null&&c.to.m==null&&(c.to.h=23,c.to.m=59,c.to.s=59),!c.from||!c.to)return[];c.from.h==null&&(c.from.h=0),c.to.h==null&&(c.to.h=23);const o=[],h=(0,t.KQ)(g.from).utc();for(h.set("hour",0),h.set("minute",0),h.set("second",0),h.set("millisecond",0),h.add(c.from.h,"hours"),h.add(c.from.m,"minutes"),h.add(c.from.s,"seconds");h.unix()<=g.to.unix();){for(;c.from.dayOfWeek&&c.from.dayOfWeek!==h.isoWeekday();)h.add(24,"hours");if(h.unix()>g.to.unix())break;const f=(0,t.KQ)(h).utc();if(f.hour)if(c.from.h<=c.to.h)f.add(c.to.h-c.from.h,"hours");else if(c.from.h>c.to.h)for(;f.hour()!==c.to.h;)f.add(1,"hours");else for(f.add(24-c.from.h,"hours");f.hour()!==c.to.h;)f.add(1,"hours");for(f.set("minute",c.to.m??0),f.set("second",c.to.s??0);c.to.dayOfWeek&&c.to.dayOfWeek!==f.isoWeekday();)f.add(24,"hours");h.unix()<g.from.unix()&&f.unix()<g.from.unix()||h.unix()>g.to.unix()&&f.unix()>g.to.unix()||o.push({from:h.valueOf(),to:f.valueOf()}),h.add(24,"hours")}return o}function i(r){const g={};if(!r?.length)return g;const a=r.split(":");return a?.length&&(g.h=Math.min(23,Math.max(0,Number(a[0]))),a.length>1&&(g.m=Math.min(60,Math.max(0,Number(a[1]))),a.length>2&&(g.s=Math.min(60,Math.max(0,Number(a[2])))))),g}function s(r){if(!r||r.h==null&&r.m==null&&r.s==null)return"";let g=String(r.h??0).padStart(2,"0")+":"+String(r.m??0).padStart(2,"0");return r.s!=null&&(g+=String(r.s??0).padStart(2,"0")),g}},67027:(k,R,e)=>{"use strict";e.d(R,{r:()=>n});let t="";const n=()=>{const s=new URLSearchParams(window.location.search).get("auth_token");return s!==null&&s!==""?(t=s,s):t}},5133:(k,R,e)=>{"use strict";e.d(R,{r:()=>g});var t=e(74848),n=e(62625),i=e(90182);const r=Object.values(n.X).filter(a=>a!==n.X.None).map(a=>({label:a,value:a}));function g({value:a,onChange:c,"aria-label":o,inputId:h,autoFocus:f,...d}){return(0,t.jsx)(i.l6,{inputId:h,value:a,options:r,onChange:p=>c(p.value??n.X.None),placeholder:"Choose role...","aria-label":o,autoFocus:f,...d})}},57334:(k,R,e)=>{"use strict";e.d(R,{$u:()=>K,A5:()=>q,Bc:()=>ae,DX:()=>L,JI:()=>S,Jc:()=>N,Kg:()=>A,MV:()=>l,N6:()=>D,P3:()=>P,Pi:()=>b,T$:()=>O,TK:()=>m,VR:()=>I,Vk:()=>H,hG:()=>u,hU:()=>w,is:()=>j,kz:()=>d,ly:()=>v,mI:()=>C,nM:()=>U,nh:()=>x,nr:()=>y,pm:()=>T,xq:()=>X,yd:()=>V});var t=e(2543),n=e.n(t),i=e(72724),s=e(33378),r=e(17172),g=e(39601),a=e(2913),c=e(10096),o=e(80714),h=e(31678),f=e(44672);function d(te){return async ne=>{try{ne((0,f.D1)(!1)),await ne(p(te)),await ne(E(te)),await ne(M(te)),a.Ay.ldapEnabled&&(0,s.a)("ldapsync")&&await ne(T()),ne((0,f.D1)(!0))}catch(le){if(console.error(le),(0,r.NF)(le)){const z={title:le.data.message,body:le.data.error};ne((0,f.PV)(z))}}}}function p(te){return async ne=>{const le=await(0,r.AI)().get(`/api/users/${te}`,(0,o.F)());ne((0,f.G_)(le))}}function m(te){return async ne=>{await(0,r.AI)().put(`/api/users/${te.id}`,te),ne(d(te.id))}}function v(te,ne){return async le=>{const z={password:ne};await(0,r.AI)().put(`/api/admin/users/${te}/password`,z),le(d(te))}}function l(te){return async ne=>{await(0,r.AI)().post(`/api/admin/users/${te}/disable`),g.Ny.push("/admin/users")}}function y(te){return async ne=>{await(0,r.AI)().post(`/api/admin/users/${te}/enable`),ne(d(te))}}function u(te){return async ne=>{await(0,r.AI)().delete(`/api/admin/users/${te}`),g.Ny.push("/admin/users")}}function D(te,ne){return async le=>{const z={isGrafanaAdmin:ne};await(0,r.AI)().put(`/api/admin/users/${te}/permissions`,z),le(d(te))}}function E(te){return async ne=>{const le=await(0,r.AI)().get(`/api/users/${te}/orgs`);ne((0,f.OF)(le))}}function x(te,ne,le){return async z=>{const ee={loginOrEmail:te.login,role:le};await(0,r.AI)().post(`/api/orgs/${ne}/users/`,ee),z(d(te.id))}}function P(te,ne,le){return async z=>{const ee={role:le};await(0,r.AI)().patch(`/api/orgs/${ne}/users/${te}`,ee),z(d(te))}}function b(te,ne){return async le=>{await(0,r.AI)().delete(`/api/orgs/${ne}/users/${te}`),le(d(te))}}function M(te){return async ne=>{if(!c.TP.hasPermission(h.AccessControlAction.UsersAuthTokenList))return;const le=await(0,r.AI)().get(`/api/admin/users/${te}/auth-tokens`);le.reverse();const z=le.map(ee=>({id:ee.id,isActive:ee.isActive,seenAt:(0,i.fq)(ee.seenAt),createdAt:ee.createdAt,clientIp:ee.clientIp,browser:ee.browser,browserVersion:ee.browserVersion,os:ee.os,osVersion:ee.osVersion,device:ee.device}));ne((0,f.ag)(z))}}function O(te,ne){return async le=>{const z={authTokenId:te};await(0,r.AI)().post(`/api/admin/users/${ne}/revoke-auth-token`,z),le(M(ne))}}function I(te){return async ne=>{await(0,r.AI)().post(`/api/admin/users/${te}/logout`),ne(M(te))}}function T(){return async te=>{const ne=c.TP.hasPermission(h.AccessControlAction.LDAPStatusRead);if((0,s.a)("ldapsync")&&ne){const le=await(0,r.AI)().get("/api/admin/ldap-sync-status");te((0,f.OR)(le))}}}function C(te){return async ne=>{await(0,r.AI)().post(`/api/admin/ldap/sync/${te}`),ne(d(te))}}function S(){return async te=>{if(c.TP.hasPermission(h.AccessControlAction.LDAPStatusRead))try{const ne=await(0,r.AI)().get("/api/admin/ldap/status");te((0,f.pH)(ne))}catch(ne){if((0,r.NF)(ne)){ne.isHandled=!0;const le={title:ne.data.message,body:ne.data.error};te((0,f.V$)(le))}}}}function A(te){return async ne=>{try{const le=await(0,r.AI)().get(`/api/admin/ldap/${encodeURIComponent(te)}`),{name:z,surname:ee,email:se,login:ie,isGrafanaAdmin:Z,isDisabled:oe,roles:ce,teams:ye}=le,re={info:{name:z,surname:ee,email:se,login:ie},permissions:{isGrafanaAdmin:Z,isDisabled:oe},roles:ce,teams:ye};ne((0,f.TW)(re))}catch(le){if((0,r.NF)(le)){le.isHandled=!0;const z={title:le.data.message,body:le.data.error};ne((0,f.Vv)()),ne((0,f.Nf)(z))}}}}function L(){return te=>{te((0,f.zi)())}}function N(){return te=>{te((0,f.zi)()),te((0,f.Vv)())}}const F=te=>te.map(ne=>Array.isArray(ne.value)?ne.value.map(le=>`${ne.name}=${le.value}`).join("&"):`${ne.name}=${ne.value}`).join("&");function w(){return async(te,ne)=>{try{const{perPage:le,page:z,query:ee,filters:se,sort:ie}=ne().userListAdmin;let Z=`/api/users/search?perpage=${le}&page=${z}&query=${ee}&${F(se)}`;ie&&(Z+=`&sort=${ie}`);const oe=await(0,r.AI)().get(Z);te((0,f.Mb)(oe))}catch(le){(0,f.g4)(),console.error(le)}}}const B=(0,t.debounce)(te=>te(w()),500);function U(te){return async ne=>{ne((0,f.Cj)()),ne((0,f.L5)(te)),B(ne)}}function K(te){return async ne=>{ne((0,f.Cj)()),ne((0,f.jX)(te)),B(ne)}}function V(te){return async ne=>{ne((0,f.Cj)()),ne((0,f.EC)(te)),ne(w())}}function H({sortBy:te}){const ne=te.length?`${te[0].id}-${te[0].desc?"desc":"asc"}`:void 0;return async(le,z)=>{z().userListAdmin.sort!==ne&&(le((0,f.Cj)()),le((0,f.$u)(ne)),le(w()))}}const Y=te=>te.map(ne=>Array.isArray(ne.value)?ne.value.map(le=>`${ne.name}=${le.value}`).join("&"):`${ne.name}=${ne.value}`).join("&");function X(){return async(te,ne)=>{try{const{perPage:le,page:z,query:ee,filters:se,sort:ie}=ne().userListAnonymousDevices;let Z=`/api/anonymous/search?perpage=${le}&page=${z}&query=${ee}&${Y(se)}`;ie&&(Z+=`&sort=${ie}`);const oe=await(0,r.AI)().get(Z);te((0,f.o3)(oe))}catch(le){console.error(le)}}}const J=(0,t.debounce)(te=>te(X()),500);function q({sortBy:te}){const ne=te.length?`${te[0].id}-${te[0].desc?"desc":"asc"}`:void 0;return async(le,z)=>{z().userListAnonymousDevices.sort!==ne&&(le((0,f.kh)(ne)),le(X()))}}function ae(te){return async ne=>{ne((0,f.xx)(te)),J(ne)}}function j(te){return async ne=>{ne((0,f.iK)(te)),ne(X())}}},44672:(k,R,e)=>{"use strict";e.d(R,{$u:()=>C,Ay:()=>K,Cj:()=>b,D1:()=>y,EC:()=>I,G_:()=>m,L5:()=>O,Mb:()=>P,Nf:()=>o,OF:()=>v,OR:()=>c,PV:()=>u,TW:()=>h,V$:()=>a,Vv:()=>r,ag:()=>l,g4:()=>M,iK:()=>w,jX:()=>T,kh:()=>F,o3:()=>N,pH:()=>g,xx:()=>B,zi:()=>s});var t=e(65307);const n={connectionInfo:[],syncInfo:void 0,user:void 0,connectionError:void 0,userError:void 0},i=(0,t.Z0)({name:"ldap",initialState:n,reducers:{ldapConnectionInfoLoadedAction:(V,H)=>({...V,ldapError:void 0,connectionInfo:H.payload}),ldapFailedAction:(V,H)=>({...V,ldapError:H.payload}),ldapSyncStatusLoadedAction:(V,H)=>({...V,syncInfo:H.payload}),userMappingInfoLoadedAction:(V,H)=>({...V,user:H.payload,userError:void 0}),userMappingInfoFailedAction:(V,H)=>({...V,user:void 0,userError:H.payload}),clearUserMappingInfoAction:(V,H)=>({...V,user:void 0}),clearUserErrorAction:(V,H)=>({...V,userError:void 0})}}),{clearUserErrorAction:s,clearUserMappingInfoAction:r,ldapConnectionInfoLoadedAction:g,ldapFailedAction:a,ldapSyncStatusLoadedAction:c,userMappingInfoFailedAction:o,userMappingInfoLoadedAction:h}=i.actions,f=i.reducer,d={user:void 0,sessions:[],orgs:[],isLoading:!0,error:void 0},p=(0,t.Z0)({name:"userAdmin",initialState:d,reducers:{userProfileLoadedAction:(V,H)=>({...V,user:H.payload}),userOrgsLoadedAction:(V,H)=>({...V,orgs:H.payload}),userSessionsLoadedAction:(V,H)=>({...V,sessions:H.payload}),userAdminPageLoadedAction:(V,H)=>({...V,isLoading:!H.payload}),userAdminPageFailedAction:(V,H)=>({...V,error:H.payload,isLoading:!1})}}),{userProfileLoadedAction:m,userOrgsLoadedAction:v,userSessionsLoadedAction:l,userAdminPageLoadedAction:y,userAdminPageFailedAction:u}=p.actions,D=p.reducer,E={users:[],query:"",page:0,perPage:50,totalPages:1,showPaging:!1,filters:[{name:"activeLast30Days",value:!1}],isLoading:!0},x=(0,t.Z0)({name:"userListAdmin",initialState:E,reducers:{usersFetched:(V,H)=>{const{totalCount:Y,perPage:X,...J}=H.payload,q=Math.ceil(Y/X);return{...V,...J,totalPages:q,perPage:X,showPaging:q>1,isLoading:!1}},usersFetchBegin:V=>({...V,isLoading:!0}),usersFetchEnd:V=>({...V,isLoading:!1}),queryChanged:(V,H)=>({...V,query:H.payload,page:0}),pageChanged:(V,H)=>({...V,page:H.payload}),sortChanged:(V,H)=>({...V,page:0,sort:H.payload}),filterChanged:(V,H)=>{const{name:Y,value:X}=H.payload;return V.filters.some(J=>J.name===Y)?{...V,page:0,filters:V.filters.map(J=>J.name===Y?{...J,value:X}:J)}:{...V,page:0,filters:[...V.filters,H.payload]}}}}),{usersFetched:P,usersFetchBegin:b,usersFetchEnd:M,queryChanged:O,pageChanged:I,filterChanged:T,sortChanged:C}=x.actions,S=x.reducer,A={devices:[],query:"",page:0,perPage:50,totalPages:1,showPaging:!1,filters:[{name:"activeLast30Days",value:!0}]},L=(0,t.Z0)({name:"userListAnonymousDevices",initialState:A,reducers:{usersAnonymousDevicesFetched:(V,H)=>{const{totalCount:Y,perPage:X,...J}=H.payload,q=Math.ceil(Y/X);return{...V,...J,totalPages:q,perPage:X,showPaging:q>1}},anonQueryChanged:(V,H)=>({...V,query:H.payload,page:0}),anonPageChanged:(V,H)=>({...V,page:H.payload}),anonUserSortChanged:(V,H)=>({...V,page:0,sort:H.payload}),filterChanged:(V,H)=>{const{name:Y,value:X}=H.payload;return V.filters.some(J=>J.name===Y)?{...V,page:0,filters:V.filters.map(J=>J.name===Y?{...J,value:X}:J)}:{...V,page:0,filters:[...V.filters,H.payload]}}}}),{usersAnonymousDevicesFetched:N,anonUserSortChanged:F,anonPageChanged:w,anonQueryChanged:B}=L.actions,U=L.reducer,K={ldap:f,userAdmin:D,userListAdmin:S,userListAnonymousDevices:U}},55907:(k,R,e)=>{"use strict";e.d(R,{A:()=>D,p:()=>a});var t=e(2543),n=e.n(t),i=e(1062);const s=new i.tI({type:"query",params:[{name:"queryRefId",type:"string",dynamicLookup:!0},{name:"from",type:"string",options:["10s","1m","5m","10m","15m","1h","2h","6h","12h","24h","48h"]},{name:"to",type:"string",options:["now","now-1m","now-5m","now-10m","now-1h"]}],defaultParams:["#A","15m","now","avg"]}),r=[{text:"Query",value:"query"}],g={alerting:1,firing:1,no_data:2,pending:3,ok:4,paused:5,inactive:5};var a=(E=>(E.IsAbove="gt",E.IsBelow="lt",E.IsOutsideRange="outside_range",E.IsWithinRange="within_range",E.HasNoValue="no_value",E))(a||{});const c=[{value:"gt",text:"IS ABOVE"},{value:"lt",text:"IS BELOW"},{value:"outside_range",text:"IS OUTSIDE RANGE"},{value:"within_range",text:"IS WITHIN RANGE"},{value:"no_value",text:"HAS NO VALUE"}],o=[{text:"OR",value:"or"},{text:"AND",value:"and"}],h=[{text:"avg()",value:"avg"},{text:"min()",value:"min"},{text:"max()",value:"max"},{text:"sum()",value:"sum"},{text:"count()",value:"count"},{text:"last()",value:"last"},{text:"median()",value:"median"},{text:"diff()",value:"diff"},{text:"diff_abs()",value:"diff_abs"},{text:"percent_diff()",value:"percent_diff"},{text:"percent_diff_abs()",value:"percent_diff_abs"},{text:"count_non_null()",value:"count_non_null"}],f=[{text:"Alerting",value:"alerting"},{text:"No Data",value:"no_data"},{text:"Keep Last State",value:"keep_state"},{text:"Ok",value:"ok"}],d=[{text:"Alerting",value:"alerting"},{text:"Keep Last State",value:"keep_state"}];function p(E){const x=new i.tI({type:E.type,defaultParams:[]});return new i.kW(E,x)}function m(E){return E.toLowerCase().replace(/_/g,"").split(" ")[0]}function v(E){switch(m(E)){case"normal":case"ok":return{text:"OK",iconClass:"heart",stateClass:"alert-state-ok"};case"alerting":return{text:"ALERTING",iconClass:"heart-break",stateClass:"alert-state-critical"};case"nodata":return{text:"NO DATA",iconClass:"question-circle",stateClass:"alert-state-warning"};case"paused":return{text:"PAUSED",iconClass:"pause",stateClass:"alert-state-paused"};case"pending":return{text:"PENDING",iconClass:"hourglass",stateClass:"alert-state-warning"};case"firing":return{text:"FIRING",iconClass:"fire",stateClass:""};case"inactive":return{text:"INACTIVE",iconClass:"check",stateClass:""};case"error":return{text:"ERROR",iconClass:"heart-break",stateClass:"alert-state-critical"};case"unknown":default:return{text:"UNKNOWN",iconClass:"question-circle",stateClass:".alert-state-paused"}}}function l(E,x){return(0,t.reduce)(E,(P,b)=>(b.metric!==void 0&&b.value!==void 0&&P.push(b.metric+"="+b.value),b.Metric!==void 0&&b.Value!==void 0&&P.push(b.Metric+"="+b.Value),P),[]).join(x)}function y(E){return(0,t.isArray)(E.data)?l(E.data,", "):(0,t.isArray)(E.data.evalMatches)?l(E.data.evalMatches,", "):E.data.error?"Error: "+E.data.error:""}function u(E){return(0,t.isArray)(E)?l(E,", "):(0,t.isArray)(E.evalMatches)?l(E.evalMatches,", "):E.error?"Error: "+E.error:""}const D={alertQueryDef:s,getStateDisplayModel:v,conditionTypes:r,evalFunctions:c,evalOperators:o,noDataModes:f,executionErrorModes:d,reducerTypes:h,createReducerPart:p,getAlertAnnotationInfo:y,getAlertAnnotationText:u,alertStateSortScore:g}},1062:(k,R,e)=>{"use strict";e.d(R,{Dw:()=>g,Wn:()=>r,kW:()=>s,tI:()=>i});var t=e(2543),n=e.n(t);class i{constructor(h){this.type=h.type,this.params=h.params,this.defaultParams=h.defaultParams,this.renderer=h.renderer,this.category=h.category,this.addStrategy=h.addStrategy}}class s{constructor(h,f){if(this.part=h,this.def=f,!this.def)throw{message:"Could not find query part "+h.type};h.params=h.params||(0,t.clone)(this.def.defaultParams),this.params=h.params,this.text="",this.updateText()}render(h){return this.def.renderer(this,h)}hasMultipleParamsInString(h,f){return h.indexOf(",")===-1?!1:this.def.params[f+1]&&this.def.params[f+1].optional}updateParam(h,f){if(this.hasMultipleParamsInString(h,f)){(0,t.each)(h.split(","),(d,p)=>{this.updateParam(d.trim(),p)});return}h===""&&this.def.params[f].optional?this.params.splice(f,1):this.params[f]=h,this.part.params=this.params,this.updateText()}updateText(){if(this.params.length===0){this.text=this.def.type+"()";return}let h=this.def.type+"(";h+=this.params.join(", "),h+=")",this.text=h}}function r(o,h){const f=o.def.type+"(",d=(0,t.map)(o.params,(p,m)=>{const v=o.def.params[m];return v.type==="time"&&p==="auto"&&(p="$__interval"),v.quote==="single"?"'"+p+"'":v.quote==="double"?'"'+p+'"':p});return h&&d.unshift(h),f+d.join(", ")+")"}function g(o,h){return h+" "+o.params[0]}function a(o,h){return o.params[0]}function c(o,h){return'"'+o.params[0]+'"'}},25027:(k,R,e)=>{"use strict";e.d(R,{AK:()=>I,Cl:()=>U,Fb:()=>N,Hs:()=>H,IR:()=>O,KF:()=>y,Ke:()=>D,P6:()=>K,QA:()=>v,Rk:()=>M,Sn:()=>A,Sq:()=>P,U6:()=>w,U7:()=>l,aL:()=>L,fH:()=>d,hJ:()=>F,iW:()=>V,l$:()=>m,le:()=>f,nf:()=>b,t6:()=>B,vV:()=>p,zs:()=>C});var t=e(2543),n=e.n(t),i=e(47232),s=e(34867),r=e(17172),g=e(32264),a=e(14110),c=e(10096),o=e(28475);const h=7,f={filterByLabel:"filtering alert instances by label",loadedList:"loaded Alert Rules list",leavingRuleGroupEdit:"leaving rule group edit without saving",alertRuleFromPanel:"creating alert rule from panel",alertRuleFromScratch:"creating alert rule from scratch",recordingRuleFromScratch:"creating recording rule from scratch",clickingAlertStateFilters:"clicking alert state filters",cancelSavingAlertRule:"user canceled alert rule creation",successSavingAlertRule:"alert rule saved successfully",unknownMessageFromError:"unknown messageFromError",grafanaRecording:"creating Grafana recording rule from scratch",loadedCentralAlertStateHistory:"loaded central alert state history"},{logInfo:d,logError:p,logMeasurement:m}=(0,s.DW)("features.alerting",{module:"Alerting"});function v(Y,X,J){return async function(...q){const ae=performance.now(),j=await X(...q),te=performance.now()-ae;return m(Y,{loadTimesMs:te},J),j}}function l(Y,X,J){return async(...q)=>{const ae=performance.now(),j=await X(...q),{namespacesCount:te,groupsCount:ne,rulesCount:le}=u(j);return m(Y,{loadTimeMs:performance.now()-ae,namespacesCount:te,groupsCount:ne,rulesCount:le},J),j}}function y(Y){Object.entries(Y).forEach(([X,J])=>{const q=J.message??"unknown error",ae=String(J.type)??"unknown",j=new Error(q);p(j,{field:X,type:ae})})}function u(Y){const X=Y.length,J=Y.flatMap(j=>j.groups).length,q=Y.flatMap(j=>j.groups).flatMap(j=>j.rules).length;return{namespacesCount:X,groupsCount:J,rulesCount:q}}function D(Y,X,J){return async(...q)=>{const ae=performance.now(),j=await X(...q),{namespacesCount:te,groupsCount:ne,rulesCount:le}=E(j);return m(Y,{namespacesCount:te,groupsCount:ne,rulesCount:le,loadTimeMs:performance.now()-ae},J),j}}function E(Y){const X=Object.keys(Y),J=Object.values(Y).flatMap(ae=>ae),q=J.flatMap(ae=>ae.rules);return{namespacesCount:X.length,groupsCount:J.length,rulesCount:q.length}}async function x(){try{const{createdAt:Y}=await(0,r.AI)().get("/api/user"),X=(0,i.KQ)().subtract(h,"days"),J=(0,i.KQ)(Y);return X.isBefore(J)}catch{return!0}}const P=async(Y={grafana_version:g.$.buildInfo.version,org_id:c.TP.user.orgId,user_id:c.TP.user.id})=>{await x()||(0,a.rR)("grafana_alerting_navigation",Y)},b=Y=>{(0,a.rR)("grafana_alerting_rule_creation",Y)},M=Y=>{(0,a.rR)("grafana_alerting_rule_aborted",Y)},O=Y=>{(0,a.rR)("grafana_alerting_rule_form_error",Y)},I=async Y=>{const X={grafana_version:g.$.buildInfo.version,org_id:c.TP.user.orgId,user_id:c.TP.user.id};(0,a.rR)("grafana_alerting_insights",{...X,...Y})};function T(Y){(0,a.rR)("grafana_alerting_rules_search",{...Y})}function C({oldQuery:Y,newQuery:X}){try{const J=(0,o.XY)(Y),q=(0,o.XY)(X),ae=S(J);S(q).filter(ne=>!ae.includes(ne)).forEach(ne=>{T({filter:ne,triggeredBy:"typing"})})}catch(J){J instanceof Error&&p(J)}}function S(Y){return Object.entries(Y).filter(([X,J])=>!(0,t.isEmpty)(J)).map(([X])=>X)}function A(Y){T({filter:Y,triggeredBy:"component"})}function L(Y){(0,a.rR)("grafana_alerting_rules_list_mode",{...Y})}function N(){(0,a.rR)("grafana_alerting_switch_to_simplified_routing")}function F(){(0,a.rR)("grafana_alerting_switch_to_policies_routing")}function w(){(0,a.rR)("grafana_alerting_contact_point_form_edit_input_with_template")}function B(){(0,a.rR)("grafana_alerting_contact_point_form_use_custom_input_in_template")}function U(){(0,a.rR)("grafana_alerting_contact_point_form_use_single_template_in_input")}function K(Y){(0,a.rR)("grafana_alerting_central_alert_state_history_filter_by_clicking",Y)}function V(){(0,a.rR)("grafana_alerting_central_alert_state_history_expand_row")}function H(Y){(0,a.rR)("grafana_alerting_central_alert_state_history_max_events_reached",Y)}},79741:(k,R,e)=>{"use strict";e.r(R),e.d(R,{default:()=>l,defaultPageNav:()=>m});var t=e(74848),n=e(96540),i=e(17172),s=e(42418),r=e(66602),g=e(7392),a=e(37959),c=e(5179),o=e(39890),h=e(730),f=e(56361),d=e(18461);const p=y=>{const u=(0,d.uE)(y.match.params),[D]=(0,o.P5)(),x=D===o.gQ.Instances?void 0:0,P=(0,n.useMemo)(()=>{if(!u)throw new Error("Rule ID is required");return(0,d.qg)(u,!0)},[u]),{loading:b,error:M,result:O}=(0,h.ZU)({ruleIdentifier:P,limitAlerts:x});return M?(0,t.jsx)(a.d,{pageNav:m,navId:"alert-list",children:(0,t.jsx)(v,{error:M})}):b?(0,t.jsx)(a.d,{pageNav:m,navId:"alert-list",isLoading:!0,children:(0,t.jsx)(t.Fragment,{})}):O?(0,t.jsx)(c.K,{identifier:P,rule:O,children:(0,t.jsx)(o.Ay,{})}):(0,t.jsx)(a.d,{pageNav:m,navId:"alert-list",children:(0,t.jsx)(g.L,{entity:"Rule"})})},m={id:"alert-rule-view",text:""};function v({error:y}){return(0,i.NF)(y)&&y.status===404?(0,t.jsx)(g.L,{entity:"Rule"}):(0,t.jsx)(s.F,{title:"Something went wrong loading the rule",children:(0,f.JZ)(y)})}const l=(0,r.Xc)(p,{style:"page"})},79938:(k,R,e)=>{"use strict";e.d(R,{hK:()=>p});var t=e(2543),n=e.n(t),i=e(8484),s=e(57220),r=e(75214),g=e(23662),a=e(49962),c=e(49498),o=e(28220);const h="/api/v1/rule/test/grafana",f="api/prometheus/grafana/api/v1/rules";var d=(m=>(m.RuleGroup="rule_group",m.Namespace="file",m.FolderUID="folder_uid",m.LimitAlerts="limit_alerts",m))(d||{});const p=a.Hr.injectEndpoints({endpoints:m=>({preview:m.mutation({query:({alertQueries:v,condition:l,customLabels:y,folder:u,alertName:D,alertUid:E})=>({url:h,data:{rule:{grafana_alert:{data:v,condition:l,no_data_state:"Alerting",title:D,uid:E??"N/A"},for:"0s",labels:(0,r.x4)(y),annotations:{}},folderUid:u.uid,folderTitle:u.title},method:"POST"})}),prometheusRulesByNamespace:m.query({query:({limitAlerts:v,identifier:l,filter:y,state:u,matcher:D})=>{const E=new URLSearchParams;v&&E.set("limit_alerts",String(v)),l&&((0,g.Mj)(l)||(0,g.X4)(l))&&(E.set("file",l.namespace),E.set("rule_group",l.groupName));const x=(0,c.bZ)(E,y);return{url:f,params:(0,c.Dj)(x,u,D)}},transformResponse:v=>(0,c.lH)(v.data.groups,s.hY)}),prometheusRuleNamespaces:m.query({query:({ruleSourceName:v,namespace:l,groupName:y,ruleName:u,dashboardUid:D,panelId:E,limitAlerts:x})=>{const P={rule_group:y,rule_name:u,dashboard_uid:D,panel_id:E?.toString()};return l&&((0,s.z2)(v)?(0,t.set)(P,"folder_uid",l):(0,t.set)(P,"file",l)),x!==void 0&&(0,t.set)(P,"limit_alerts",String(x)),{url:`api/prometheus/${(0,s.w5)(v)}/api/v1/rules`,params:P}},transformResponse:(v,l,y)=>(0,c.lH)(v.data.groups,y.ruleSourceName),providesTags:["CombinedAlertRule"]}),rulerRules:m.query({query:({rulerConfig:v,filter:l})=>{const{path:y,params:u}=(0,o.$o)(v).rules(l);return{url:y,params:u}},providesTags:["CombinedAlertRule"]}),rulerNamespace:m.query({query:({rulerConfig:v,namespace:l})=>{const{path:y,params:u}=(0,o.$o)(v).namespace(l);return{url:y,params:u}}}),getRuleGroupForNamespace:m.query({query:({rulerConfig:v,namespace:l,group:y,requestOptions:u})=>{const{path:D,params:E}=(0,o.$o)(v).namespaceGroup(l,y);return(0,a.EB)({url:D,params:E},u)},providesTags:(v,l,{namespace:y,group:u})=>[{type:"RuleGroup",id:`${y}/${u}`},{type:"RuleNamespace",id:y}]}),deleteRuleGroupFromNamespace:m.mutation({query:({rulerConfig:v,namespace:l,group:y,requestOptions:u})=>{const D=(0,i.t)("alerting.rule-groups.delete.success","Successfully deleted rule group"),{path:E,params:x}=(0,o.$o)(v).namespaceGroup(l,y);return(0,a.EB)({url:E,params:x,method:"DELETE"},u,{successMessage:D})},invalidatesTags:(v,l,{namespace:y,group:u})=>[{type:"RuleGroup",id:`${y}/${u}`},{type:"RuleNamespace",id:y}]}),upsertRuleGroupForNamespace:m.mutation({query:({payload:v,namespace:l,rulerConfig:y,requestOptions:u})=>{const{path:D,params:E}=(0,o.$o)(y).namespace(l),x=(0,i.t)("alerting.rule-groups.update.success","Successfully updated rule group");return(0,a.EB)({url:D,params:E,data:v,method:"POST"},u,{successMessage:x})},invalidatesTags:(v,l,{namespace:y})=>[{type:"RuleNamespace",id:y}]}),getAlertRule:m.query({query:({uid:v})=>({url:`/api/ruler/${s.hY}/api/v1/rule/${v}`}),providesTags:(v,l,{uid:y})=>[{type:"GrafanaRulerRule",id:y}]}),exportRules:m.query({query:({format:v,folderUid:l,group:y,ruleUid:u})=>({url:"/api/ruler/grafana/api/v1/export/rules",params:{format:v,folderUid:l,group:y,ruleUid:u},responseType:"text"}),keepUnusedDataFor:0}),exportReceiver:m.query({query:({receiverName:v,decrypt:l,format:y})=>({url:"/api/v1/provisioning/contact-points/export/",params:{format:y,decrypt:l,name:v},responseType:"text"}),keepUnusedDataFor:0}),exportReceivers:m.query({query:({decrypt:v,format:l})=>({url:"/api/v1/provisioning/contact-points/export/",params:{format:l,decrypt:v},responseType:"text"}),keepUnusedDataFor:0}),exportPolicies:m.query({query:({format:v})=>({url:"/api/v1/provisioning/policies/export/",params:{format:v},responseType:"text"}),keepUnusedDataFor:0}),exportModifiedRuleGroup:m.mutation({query:({payload:v,format:l,nameSpaceUID:y})=>({url:`/api/ruler/grafana/api/v1/rules/${y}/export/`,params:{format:l},responseType:"text",data:v,method:"POST"})}),exportMuteTimings:m.query({query:({format:v})=>({url:"/api/v1/provisioning/mute-timings/export/",params:{format:v},responseType:"text"}),keepUnusedDataFor:0}),exportMuteTiming:m.query({query:({format:v,muteTiming:l})=>({url:`/api/v1/provisioning/mute-timings/${l}/export/`,params:{format:v},responseType:"text"}),keepUnusedDataFor:0})})})},91540:(k,R,e)=>{"use strict";e.d(R,{F:()=>s});var t=e(26272),n=e(28138),i=e(49962);const s=i.Hr.injectEndpoints({endpoints:r=>({getSilences:r.query({query:({datasourceUid:g,ruleMetadata:a,accessControl:c})=>({url:`/api/alertmanager/${g}/api/v2/silences`,params:{ruleMetadata:a,accesscontrol:c}}),providesTags:g=>g?g.map(({id:a})=>({type:"AlertmanagerSilences",id:a})):["AlertmanagerSilences"]}),getSilence:r.query({query:({datasourceUid:g,id:a,ruleMetadata:c,accessControl:o})=>({url:`/api/alertmanager/${g}/api/v2/silence/${a}`,showErrorAlert:!1,params:{ruleMetadata:c,accesscontrol:o}}),providesTags:(g,a,{id:c})=>g?[{type:"AlertmanagerSilences",id:c}]:["AlertmanagerSilences"]}),createSilence:r.mutation({query:({datasourceUid:g,payload:a})=>({url:`/api/alertmanager/${g}/api/v2/silences`,method:"POST",data:a}),invalidatesTags:["AlertmanagerSilences","AlertmanagerAlerts"],onQueryStarted:async(g,{queryFulfilled:a})=>{try{await a,n.A.emit(t.r1.alertSuccess,["Silence created"])}catch{n.A.emit(t.r1.alertError,["Could not create silence"])}}}),expireSilence:r.mutation({query:({datasourceUid:g,silenceId:a})=>({url:`/api/alertmanager/${g}/api/v2/silence/${a}`,method:"DELETE"}),invalidatesTags:["AlertmanagerSilences"]})})})},49962:(k,R,e)=>{"use strict";e.d(R,{EB:()=>o,Hr:()=>f});var t=e(75816),n=e(2543),i=e.n(n),s=e(75505),r=e(26272),g=e(17172),a=e(28138),c=e(25027);function o(d,p={},m={}){return{...d,...(0,n.defaultsDeep)(p,m)}}const h=()=>async({successMessage:d,errorMessage:p,body:m,...v})=>{try{const l={...v,...m&&{data:m},...d&&{showSuccessAlert:!1},...p&&{showErrorAlert:!1}},y=performance.now(),{data:u,...D}=await(0,s.s)((0,g.AI)().fetch(l));return(0,c.l$)("backendSrvBaseQuery",{loadTimeMs:performance.now()-y},{url:v.url,method:v.method??"GET",responseStatus:D.statusText}),d&&v.showSuccessAlert!==!1&&a.A.emit(r.r1.alertSuccess,[d]),{data:u,meta:D}}catch(l){return p&&v.showErrorAlert!==!1&&a.A.emit(r.r1.alertError,[p]),{error:l}}},f=(0,t.xP)({reducerPath:"alertingApi",baseQuery:h(),tagTypes:["AlertingConfiguration","AlertmanagerConfiguration","AlertmanagerConnectionStatus","AlertmanagerAlerts","AlertmanagerSilences","OnCallIntegrations","DataSourceSettings","GrafanaLabels","CombinedAlertRule","GrafanaRulerRule","GrafanaSlo","RuleGroup","RuleNamespace"],endpoints:()=>({})})},32415:(k,R,e)=>{"use strict";e.d(R,{By:()=>h,VO:()=>o,WS:()=>r,f4:()=>c,nd:()=>a,vk:()=>g});var t=e(75505),n=e(39070),i=e(17172),s=e(57220);async function r(v){try{const l=await(0,t.s)((0,i.AI)().fetch({url:`/api/alertmanager/${(0,s.w5)(v)}/config/api/v1/alerts`,showErrorAlert:!1,showSuccessAlert:!1}));return{template_files:l.data.template_files??{},template_file_provenances:l.data.template_file_provenances??{},alertmanager_config:l.data.alertmanager_config??{},last_applied:l.data.last_applied,id:l.data.id}}catch(l){if(v===s.hY&&(0,i.NF)(l)&&l.data?.message?.includes("could not find an Alertmanager configuration"))return{template_files:{},alertmanager_config:{}};throw l}}async function g(v,l){await(0,t.s)((0,i.AI)().fetch({method:"POST",url:`/api/alertmanager/${(0,s.w5)(v)}/config/api/v1/alerts`,data:l,showErrorAlert:!1,showSuccessAlert:!1}))}async function a(v){await(0,t.s)((0,i.AI)().fetch({method:"DELETE",url:`/api/alertmanager/${(0,s.w5)(v)}/config/api/v1/alerts`,showErrorAlert:!1,showSuccessAlert:!1}))}async function c(v){return(await(0,t.s)((0,i.AI)().fetch({url:`/api/alertmanager/${(0,s.w5)(v)}/api/v2/alerts/groups`,showErrorAlert:!1,showSuccessAlert:!1}))).data}async function o(v){return(await(0,t.s)((0,i.AI)().fetch({url:`/api/alertmanager/${(0,s.w5)(v)}/api/v2/status`,showErrorAlert:!1,showSuccessAlert:!1}))).data}async function h(v,l,y){const u={receivers:l,alert:y};try{const D=await(0,t.s)((0,i.AI)().fetch({method:"POST",data:u,url:`/api/alertmanager/${(0,s.w5)(v)}/config/api/v1/receivers/test`,showErrorAlert:!1,showSuccessAlert:!1}));if(f(D.data))throw new Error(m(D.data))}catch(D){throw(0,i.NF)(D)&&d(D.data)&&f(D.data)?new Error(m(D.data)):D}}function f(v){return v.receivers.some(l=>l.grafana_managed_receiver_configs.some(y=>y.status==="failed"))}function d(v){return(0,n.Gv)(v)&&"receivers"in v&&Array.isArray(v.receivers)?v.receivers.every(p):!1}function p(v){return(0,n.Gv)(v)&&"name"in v&&typeof v.name=="string"&&"grafana_managed_receiver_configs"in v&&Array.isArray(v.grafana_managed_receiver_configs)}function m(v){return v.receivers.flatMap(l=>l.grafana_managed_receiver_configs.filter(y=>y.status==="failed").map(y=>y.error??"Unknown error.")).join("; ")}},82843:(k,R,e)=>{"use strict";e.d(R,{m:()=>m});var t=e(2543),n=e.n(t),i=e(99140),s=e(25027),r=e(98164),g=e(57220),a=e(56361),c=e(88467),o=e(49962),h=e(32415),f=e(77583);const d=30,p=30*1e3,m=o.Hr.injectEndpoints({endpoints:v=>({getAlertmanagerAlerts:v.query({query:({amSourceName:l,filter:y,showErrorAlert:u=!0})=>{const D=y?.matchers?.filter(I=>I.name&&I.value).map(I=>`${(0,a.Y9)(I.name)}${(0,r.MN)(I)}${(0,a.Y9)(I.value)}`),{silenced:E,inhibited:x,unprocessed:P,active:b}=y||{},M=Object.fromEntries(Object.entries({silenced:E,active:b,inhibited:x,unprocessed:P}).filter(([I,T])=>T!==void 0)),O={filter:D};return M&&Object.keys(M).forEach(I=>{O[I]=M[I]}),{url:`/api/alertmanager/${(0,g.w5)(l)}/api/v2/alerts`,params:O,showErrorAlert:u}},providesTags:["AlertmanagerAlerts"]}),getAlertmanagerAlertGroups:v.query({query:({amSourceName:l})=>({url:`/api/alertmanager/${(0,g.w5)(l)}/api/v2/alerts/groups`})}),grafanaNotifiers:v.query({query:()=>({url:"/api/alert-notifiers"})}),getGrafanaAlertingConfiguration:v.query({query:()=>({url:"/api/v1/ngalert/admin_config",showErrorAlert:!1}),providesTags:["AlertingConfiguration"]}),getGrafanaAlertingConfigurationStatus:v.query({query:()=>({url:"/api/v1/ngalert"}),providesTags:["AlertingConfiguration"]}),getExternalAlertmanagers:v.query({query:()=>({url:"/api/v1/ngalert/alertmanagers"}),transformResponse:l=>l.data,providesTags:["AlertmanagerConnectionStatus"]}),updateGrafanaAlertingConfiguration:v.mutation({query:l=>({url:"/api/v1/ngalert/admin_config",method:"POST",data:l,showSuccessAlert:!1}),invalidatesTags:["AlertingConfiguration","AlertmanagerConfiguration","AlertmanagerConnectionStatus"]}),getAlertmanagerConfigurationHistory:v.query({query:()=>({url:`/api/alertmanager/${(0,g.w5)(g.hY)}/config/history`,params:{limit:d}}),providesTags:["AlertmanagerConfiguration"]}),resetAlertmanagerConfigurationToOldVersion:v.mutation({query:l=>({url:`/api/alertmanager/${(0,g.w5)(g.hY)}/config/history/${l.id}/_activate`,method:"POST"}),invalidatesTags:["AlertmanagerConfiguration"]}),getAlertmanagerConfiguration:v.query({queryFn:async l=>{const y=l===g.hY;if((0,g.AL)(l))return(0,c.$I)((0,h.VO)(l).then(M=>({data:{alertmanager_config:M.config,template_files:{}}})));const{data:D}=await(0,i.JD)(f.L.endpoints.discoverAmFeatures.initiate({amSourceName:l})),E={alertmanager_config:{},template_files:{},template_file_provenances:{}},x=D?.lazyConfigInit??!1,P=(0,s.QA)("unifiedalerting/fetchAmConfig",h.WS,{dataSourceName:l,thunk:"unifiedalerting/fetchAmConfig"}),b=(0,a.i9)(()=>P(l),M=>!!(0,c.CZ)(M)?.includes("alertmanager storage object not found")&&!x,p).then(M=>y?M:(0,t.isEmpty)(M.alertmanager_config)&&(0,t.isEmpty)(M.template_files)?(0,h.VO)(l).then(I=>({alertmanager_config:I.config,template_files:{},template_file_provenances:M.template_file_provenances,last_applied:M.last_applied,id:M.id})):M).then(M=>M??E).then(M=>({data:M})).catch(M=>{if(x&&(0,c.CZ)(M)?.includes("alertmanager storage object not found"))return{data:E};throw M});return(0,c.$I)(b).catch(M=>({error:M,data:void 0}))},providesTags:["AlertmanagerConfiguration"]}),updateAlertmanagerConfiguration:v.mutation({query:({selectedAlertmanager:l,config:y})=>({url:`/api/alertmanager/${(0,g.w5)(l)}/config/api/v1/alerts`,method:"POST",data:y,showSuccessAlert:!1}),invalidatesTags:["AlertmanagerConfiguration"]}),getContactPointsStatus:v.query({query:()=>({url:`/api/alertmanager/${(0,g.w5)(g.hY)}/config/api/v1/receivers`}),transformResponse:l=>{const y=u=>u.startsWith("0001-01-01");return l.map(u=>({...u,integrations:u.integrations.map(D=>{const E=y(D.lastNotifyAttempt);return{...D,lastNotifyAttempt:E?"":D.lastNotifyAttempt,lastNotifyAttemptDuration:E?"":D.lastNotifyAttemptDuration}})}))}}),getContactPointsList:v.query({query:()=>({url:"/api/v1/notifications/receivers"}),providesTags:["AlertmanagerConfiguration"]}),getMuteTimingList:v.query({query:()=>({url:"/api/v1/notifications/time-intervals"}),providesTags:["AlertmanagerConfiguration"]})})})},92240:(k,R,e)=>{"use strict";e.d(R,{O5:()=>f,_y:()=>h,nD:()=>c});var t=e(75505),n=e(17172),i=e(94822),s=e(55740),r=e(57220),g=e(49498),a=e(28220);async function c(y){if(y===r.hY)return{features:{rulerApiEnabled:!0}};const u=(0,r.oh)(y);if(!u)throw new Error(`Cannot find data source configuration for ${y}`);const{url:D,name:E,type:x}=u;if(!D)throw new Error("The data source url cannot be empty.");if(x!=="prometheus"&&x!=="loki")throw new Error(`The build info request is not available for ${x}. Only 'prometheus' and 'loki' are supported`);return o({name:E,url:D,type:x})}async function o(y){const{url:u,name:D,type:E}=y,x=E==="loki"?void 0:await p(u);if(!(x!==void 0)){if(!await m(D))throw new Error(`Unable to fetch alert rules. Is the ${D} data source properly configured?`);const O=await v(D);return{application:i.N1.Cortex,features:{rulerApiEnabled:O}}}const{features:b}=x.data;return b?{application:i.N1.Mimir,features:{rulerApiEnabled:b?.ruler_config_api==="true"}}:{application:i.N1.Prometheus,features:{rulerApiEnabled:!1}}}async function h(y){if(y===r.hY)return{lazyConfigInit:!1};const u=d(y),{url:D,type:E}=u;if(!D)throw new Error("The data source url cannot be empty.");if(E!=="alertmanager")throw new Error(`Alertmanager feature discovery is not available for ${E}. Only 'alertmanager' type is supported`);return await f(D)}async function f(y){try{return{lazyConfigInit:(await p(y))?.data?.application==="Grafana Mimir"}}catch{return{lazyConfigInit:!1}}}function d(y){const u=(0,r.oh)(y);if(!u)throw new Error(`Cannot find data source configuration for ${y}`);return u}async function p(y){return(await(0,t.s)((0,n.AI)().fetch({url:`${y}/api/v1/status/buildinfo`,showErrorAlert:!1,showSuccessAlert:!1})).catch(D=>{if(!("status"in D&&D.status===404))throw D}))?.data}async function m(y){try{return await(0,g.sA)(y),!0}catch{return!1}}async function v(y){try{return await(0,a.Zp)(y),!0}catch(u){if(l(u))return!1;throw u}}function l(y){return(0,n.NF)(y)?y.data.message?.includes("GetRuleGroup unsupported in rule local store")||y.data.message?.includes("page not found")||y.data.message?.includes(s.UU):y instanceof Error&&y.message?.includes("404 from rules config endpoint")}},77583:(k,R,e)=>{"use strict";e.d(R,{L:()=>g});var t=e(94822),n=e(25027),i=e(57220),s=e(49962),r=e(92240);const g=s.Hr.injectEndpoints({endpoints:a=>({discoverAmFeatures:a.query({queryFn:async({amSourceName:c})=>{try{return{data:await(0,r._y)(c)}}catch(o){return{error:o}}}}),discoverDsFeatures:a.query({queryFn:async({rulesSourceName:c})=>{const o=(0,i.Jz)(c);if(!o)return{error:new Error(`Missing data source configuration for ${c}`)};const f=await(0,n.QA)("unifiedalerting/featureDiscoveryApi/discoverDsFeatures",r.nD,{dataSourceName:c,endpoint:"unifiedalerting/featureDiscoveryApi/discoverDsFeatures"})(o.name);return{data:{rulerConfig:f.features.rulerApiEnabled?{dataSourceName:o.name,apiVersion:f.application===t.N1.Cortex?"legacy":"config"}:void 0}}}})})})},26423:(k,R,e)=>{"use strict";e.d(R,{Pc:()=>r,WG:()=>a,uz:()=>h});var t=e(17172),n=e(37534),i=e(99494),s=e(49962);const r="grafana_alerting_v2",g=f=>`/api/plugin-proxy/${i.W.OnCall}${f}`,a=s.Hr.injectEndpoints({endpoints:f=>({grafanaOnCallIntegrations:f.query({query:()=>({url:g("/api/internal/v1/alert_receive_channels/"),params:{filters:!0,integration:[n.FI,"legacy_grafana_alerting"],skip_pagination:!0},showErrorAlert:!1}),transformResponse:d=>c(d)?d.results:d,providesTags:["OnCallIntegrations"]}),validateIntegrationName:f.query({query:d=>({url:g("/api/internal/v1/alert_receive_channels/validate_name/"),params:{verbal_name:d},showErrorAlert:!1})}),createIntegration:f.mutation({query:d=>({url:g("/api/internal/v1/alert_receive_channels/"),data:d,method:"POST",showErrorAlert:!0}),invalidatesTags:["OnCallIntegrations"]}),features:f.query({query:()=>({url:g("/api/internal/v1/features/"),showErrorAlert:!1})}),onCallConfigChecks:f.query({query:()=>({url:g("/api/internal/v1/organization/config-checks/"),showErrorAlert:!1})})})});function c(f){return"results"in f&&Array.isArray(f.results)}const{useGrafanaOnCallIntegrationsQuery:o}=a;function h(f){return(0,t.NF)(f)&&"detail"in f.data}},49498:(k,R,e)=>{"use strict";e.d(R,{Dj:()=>a,Kw:()=>o,bZ:()=>g,lH:()=>c,sA:()=>f});var t=e(75505),n=e(17172),i=e(57220),s=e(23662);function r(d){const{dataSourceName:p,limitAlerts:m,identifier:v}=d;return{rules:(l,y,u)=>{const D=new URLSearchParams;p===i.hY&&m&&D.set("limit_alerts",String(m)),v&&((0,s.Mj)(v)||(0,s.X4)(v))&&(D.set("file",v.namespace),D.set("rule_group",v.groupName));const E=g(D,l);return{url:`/api/prometheus/${(0,i.w5)(p)}/api/v1/rules`,params:a(E,y,u)}}}}function g(d,p){return p?.dashboardUID&&(d.set("dashboard_uid",p.dashboardUID),p?.panelId&&d.set("panel_id",String(p.panelId))),Object.fromEntries(d)}function a(d,p,m){let v={...d};if(p?.length&&(v={...v,state:p}),m?.length){const l=m.map(y=>JSON.stringify(y));v={...v,matcher:l}}return v}const c=(d,p)=>{const m={};return d.forEach(v=>{v.rules.forEach(l=>{l.query=l.query||""}),m[v.file]?m[v.file].groups.push(v):m[v.file]={dataSourceName:p,name:v.file,groups:[v]}}),Object.values(m)},o=(d=[])=>d?.flatMap(p=>p.groups.flatMap(m=>h(m,p.name)));function h(d,p){return{name:d.name,file:p,rules:d.rules,interval:d.interval}}async function f(d,p,m,v,l,y){if(p?.dashboardUID&&d!==i.hY)throw new Error("Filtering by dashboard UID is only supported for Grafana Managed rules.");const{url:u,params:D}=r({dataSourceName:d,limitAlerts:m,identifier:y}).rules(p,l,v),E=await(0,t.s)((0,n.AI)().fetch({url:u,params:D,showErrorAlert:!1,showSuccessAlert:!1})).catch(x=>{throw"status"in x&&x.status===404?new Error("404 from rule state endpoint. Perhaps ruler API is not enabled?"):x});return c(E.data.data.groups,d)}},28220:(k,R,e)=>{"use strict";e.d(R,{$o:()=>a,AJ:()=>p,E8:()=>c,HO:()=>d,Zp:()=>f,iy:()=>o});var t=e(75505),n=e(39070),i=e(17172),s=e(55740),r=e(57220),g=e(49498);function a(D){const x=`${`/api/ruler/${(0,r.w5)(D.dataSourceName)}`}/api/v1/rules`,P=new URLSearchParams;return P.set("subtype",D.apiVersion==="legacy"?"cortex":"mimir"),{rules:b=>{const M=(0,g.bZ)(P,b);return{path:`${x}`,params:M}},namespace:b=>({path:`${x}/${encodeURIComponent(b)}`,params:Object.fromEntries(P)}),namespaceGroup:(b,M)=>({path:`${x}/${encodeURIComponent(b)}/${encodeURIComponent(M)}`,params:Object.fromEntries(P)})}}async function c(D,E,x){const{path:P,params:b}=a(D).namespace(E);await(0,t.s)((0,i.AI)().fetch({method:"POST",url:P,data:x,showErrorAlert:!1,showSuccessAlert:!1,params:b}))}async function o(D,E){if(E?.dashboardUID&&D.dataSourceName!==r.hY)throw new Error("Filtering by dashboard UID is only supported by Grafana.");const{path:x,params:P}=a(D).rules(E);return m(x,{},P)}async function h(D,E){const{path:x,params:P}=a(D).namespace(E);return(await m(x,{},P))[E]||[]}async function f(D){return m(`/api/ruler/${(0,r.w5)(D)}/api/v1/rules/test/test`,null)}async function d(D,E,x){const{path:P,params:b}=a(D).namespaceGroup(E,x);return m(P,null,b)}async function p(D,E,x){const{path:P,params:b}=a(D).namespaceGroup(E,x);await(0,t.s)((0,i.AI)().fetch({url:P,method:"DELETE",showSuccessAlert:!1,showErrorAlert:!1,params:b}))}async function m(D,E,x){try{return(await(0,t.s)((0,i.AI)().fetch({url:D,showErrorAlert:!1,showSuccessAlert:!1,params:x}))).data}catch(P){if(!v(P))throw P;if(y(P))return E;throw l(P)?{...P,data:{...P.data,message:s.UU}}:P}}function v(D){if(!(0,n.Gv)(D))return!1;const E="data"in D&&D.data!==null&&D.data!==void 0;return"status"in D&&Number.isFinite(D.status)&&E}function l(D){return D.status===404||D.status===500&&D.data.message?.includes("unexpected content type from upstream. expected YAML, got text/html")}function y(D){return D.status===404&&(D.data.message?.includes("group does not exist")||D.data.message?.includes("no rule groups found"))}async function u(D,E){const{path:x,params:P}=a(D).namespace(E);await lastValueFrom(getBackendSrv().fetch({method:"DELETE",url:x,showErrorAlert:!1,showSuccessAlert:!1,params:P}))}},15458:(k,R,e)=>{"use strict";e.d(R,{R:()=>r});var t=e(74848),n=e(32196),i=e(40845),s=e(29158);const r=({labelKey:a,value:c,operator:o="=",onRemoveLabel:h})=>{const f=(0,i.of)(g);return(0,t.jsxs)("div",{className:f.wrapper,children:[a,o,c,!!h&&(0,t.jsx)(s.K,{name:"times",size:"xs",onClick:h,tooltip:"Remove label"})]})},g=a=>({wrapper:(0,n.css)({padding:a.spacing(.5,1),borderRadius:a.shape.radius.default,border:`solid 1px ${a.colors.border.medium}`,fontSize:a.typography.bodySmall.fontSize,backgroundColor:a.colors.background.secondary,fontWeight:a.typography.fontWeightBold,color:a.colors.text.primary,display:"inline-block",lineHeight:"1.2"})})},69087:(k,R,e)=>{"use strict";e.d(R,{m:()=>m});var t=e(74848),n=e(32196),i=e(2543),s=e.n(i),r=e(55127),g=e.n(r),a=e(96540),c=e(40845),o=e(55852),h=e(69613),f=e(8484),d=e(75214),p=e(8406);const m=({labels:y,commonLabels:u={},size:D,onClick:E})=>{const x=(0,c.of)(l,D),[P,b]=(0,a.useState)(!1),M=(0,i.chain)(y).toPairs().reject(d.w0).reject(([C])=>P?!1:C in u).value(),O=Object.keys(u).length,I=O>0,T=(0,f.t)("alert-labels.button.show.tooltip","Show common labels");return(0,t.jsxs)("div",{className:x.wrapper,role:"list","aria-label":"Labels",children:[M.map(([C,S])=>(0,t.jsx)(p.J,{size:D,label:C,value:S,color:v(C),onClick:E},C+S)),!P&&I&&(0,t.jsxs)(o.$n,{variant:"secondary",fill:"text",onClick:()=>b(!0),tooltip:T,tooltipPlacement:"top",size:"sm",children:["+",O," common ",g()("label",O)]}),P&&I&&(0,t.jsx)(o.$n,{variant:"secondary",fill:"text",onClick:()=>b(!1),tooltipPlacement:"top",size:"sm",children:(0,t.jsx)(f.x6,{i18nKey:"alert-labels.button.hide",children:"Hide common labels"})})]})};function v(y){return(0,h.MC)(y).color}const l=(y,u)=>({wrapper:(0,n.css)({display:"flex",flexWrap:"wrap",alignItems:"center",gap:u==="md"?y.spacing():y.spacing(.5)})})},37959:(k,R,e)=>{"use strict";e.d(R,{d:()=>E,y:()=>x});var t=e(74848),n=e(87586),i=e(69444),s=e(70383),r=e(32196),g=e(96540),a=e(40845),c=e(14186),o=e(90182),h=e(12681),f=e(57220);function d(M){return M.name===f.hY?"Grafana":M.name}const p=({disabled:M=!1})=>{const O=(0,a.of)(m),{selectedAlertmanager:I,availableAlertManagers:T,setSelectedAlertmanager:C}=(0,s.VI)(),S=(0,g.useMemo)(()=>T.map(N=>({label:d(N),value:N.name,imgUrl:N.imgUrl,meta:N.meta})),[T]),A=M||S.length===1,L=A?"Alertmanager":"Choose Alertmanager";return(0,t.jsx)(c.I,{className:O.field,label:L,disabled:A,"data-testid":"alertmanager-picker",children:(0,t.jsx)(o.l6,{"aria-label":L,width:29,className:"ds-picker select-container",backspaceRemovesValue:!1,onChange:N=>{N?.value&&C(N.value)},options:S,noOptionsMessage:"No datasources found",value:I,getOptionLabel:N=>N.label,components:{Option:v}})})},m=M=>({field:(0,r.css)({margin:0})}),v=M=>(0,t.jsx)(h.o5,{...M,renderOptionLabel:({label:O})=>(0,t.jsx)("div",{style:{whiteSpace:"pre-line"},children:O})});var l=e(42418);const y=()=>(0,t.jsx)(l.F,{title:"No Alertmanager found",severity:"warning",children:"We could not find any external Alertmanagers and you may not have access to the built-in Grafana Alertmanager."}),u=()=>(0,t.jsx)(l.F,{title:"Selected Alertmanager not found.",severity:"warning",children:"The selected Alertmanager no longer exists or you may not have permission to access it. You can select a different Alertmanager from the dropdown."}),D=({availableAlertManagers:M})=>{const O=M.length>0;return(0,t.jsx)("div",{children:O?(0,t.jsx)(u,{}):(0,t.jsx)(y,{})})},E=({children:M,isLoading:O,...I})=>(0,t.jsx)(i.Y,{...I,children:(0,t.jsx)(i.Y.Contents,{isLoading:O,children:M})}),x=({children:M,accessType:O,...I})=>{const T=P();return(0,t.jsx)(s.b9,{accessType:O,children:(0,t.jsx)(E,{...I,actions:(0,t.jsx)(p,{disabled:T}),children:(0,t.jsx)(b,{children:M})})})};function P(){const M=(0,n.A)();return["/edit","/new"].some(I=>M?.pathname?.includes(I))}const b=({children:M})=>{const{availableAlertManagers:O,selectedAlertmanager:I}=(0,s.VI)();return I?(0,t.jsx)(t.Fragment,{children:M}):(0,t.jsx)(D,{availableAlertManagers:O})}},71223:(k,R,e)=>{"use strict";e.d(R,{s:()=>f});var t=e(74848),n=e(32196),i=e(56034),s=e(40845),r=e(72109),g=e(55740),a=e(84396),c=e(16577),o=e(73750);const h=["message","description"],f=({annotationKey:m,value:v,valueLink:l})=>{const y=m,u=g.J3[y]?(0,t.jsx)(i.m,{content:m,placement:"top",theme:"info",children:(0,t.jsx)("span",{children:g.J3[y]})}):m;return(0,t.jsx)(a.X,{label:u,horizontal:!0,children:(0,t.jsx)(d,{annotationKey:m,value:v,valueLink:l})})},d=({annotationKey:m,value:v,valueLink:l})=>{const y=(0,s.of)(p),u=h.includes(m),D=v&&v.startsWith("http"),E=(0,t.jsx)(c.Y,{input:v,delimiter:["{{","}}"]});return l?(0,t.jsx)(r.Y,{href:l,external:!0,children:v}):u?(0,t.jsx)(o.L,{className:y.well,children:E}):D?(0,t.jsx)(r.Y,{href:v,external:!0,children:v}):(0,t.jsx)(t.Fragment,{children:E})},p=m=>({well:(0,n.css)({wordBreak:"break-word"})})},84396:(k,R,e)=>{"use strict";e.d(R,{X:()=>s});var t=e(74848),n=e(32196),i=e(40845);const s=({className:g,label:a,horizontal:c,children:o,childrenWrapperClassName:h})=>{const f=(0,i.of)(r);return(0,t.jsxs)("div",{className:(0,n.cx)(f.field,c?f.fieldHorizontal:f.fieldVertical,g),children:[(0,t.jsx)("div",{children:a}),(0,t.jsx)("div",{className:h,children:o})]})},r=g=>({fieldHorizontal:(0,n.css)({flexDirection:"row",[g.breakpoints.down("md")]:{flexDirection:"column"}}),fieldVertical:(0,n.css)({flexDirection:"column"}),field:(0,n.css)({display:"flex",margin:`${g.spacing(2)} 0`,"& > div:first-child":{width:"110px",paddingRight:g.spacing(1),fontSize:g.typography.size.sm,fontWeight:g.typography.fontWeightBold,lineHeight:1.8},"& > div:nth-child(2)":{flex:1,color:g.colors.text.secondary}})})},75591:(k,R,e)=>{"use strict";e.d(R,{E:()=>h});var t=e(74848),n=e(32196),i=e(96540),s=e(13544),r=e(40845),g=e(29158),a=e(19384),c=e(98439),o=e(22620);const h=({cols:d,items:p,isExpandable:m=!1,onCollapse:v,onExpand:l,isExpanded:y,renderExpandedContent:u,testIdGenerator:D,pagination:E,paginationStyles:x,renderPrefixCell:P,renderPrefixHeader:b,footerRow:M,dataTestId:O})=>{const I=(0,r.of)(o.H);if((v||l||y)&&!(v&&l&&y))throw new Error("either all of onCollapse, onExpand, isExpanded must be provided, or none");if((m||u)&&!(m&&u))throw new Error("either both isExpanded and renderExpandedContent must be provided, or neither");const T=(0,r.of)(f(d,m,!!b)),[C,S]=(0,i.useState)([]),A=U=>{y&&v&&l?y(U)?v(U):l(U):S(C.includes(U.id)?C.filter(K=>K!==U.id):[...C,U.id])},L=E?.itemsPerPage??p.length,{page:N,numberOfPages:F,onPageChange:w,pageItems:B}=(0,c.W)(p,1,L);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:T.container,"data-testid":O??"dynamic-table",children:[(0,t.jsxs)("div",{className:T.row,"data-testid":"header",children:[b&&b(),m&&(0,t.jsx)("div",{className:T.cell()}),d.map(U=>(0,t.jsx)("div",{className:T.cell(U.alignColumn),children:U.label},U.id))]}),B.map((U,K)=>{const V=y?y(U):C.includes(U.id);return(0,t.jsxs)("div",{className:T.row,"data-testid":D?.(U,K)??"row",children:[P&&P(U,K,p),m&&(0,t.jsx)("div",{className:(0,n.cx)(T.cell(),T.expandCell),children:(0,t.jsx)(g.K,{tooltip:`${V?"Collapse":"Expand"} row`,"data-testid":s.Tp.components.AlertRules.toggle,name:V?"angle-down":"angle-right",onClick:()=>A(U)})}),d.map(H=>(0,t.jsx)("div",{className:(0,n.cx)(T.cell(H.alignColumn),T.bodyCell,H.className),"data-column":H.label,children:H.renderCell(U,K)},`${U.id}-${H.id}`)),V&&u&&(0,t.jsx)("div",{className:T.expandedContentRow,"data-testid":s.Tp.components.AlertRules.expandedContent,children:u(U,K,p)})]},`${U.id}-${K}`)}),M&&(0,t.jsx)("div",{className:(0,n.cx)(T.row,T.footerRow),children:M})]}),E&&(0,t.jsx)(a.d,{className:(0,n.cx)(I,x),currentPage:N,numberOfPages:F,onNavigate:w,hideWhenSinglePage:!0})]})},f=(d,p,m)=>{const v=d.map(l=>l.size?typeof l.size=="number"?`${l.size}fr`:l.size:"auto");return p&&v.unshift("calc(1em + 16px)"),m&&v.unshift("0"),l=>({container:(0,n.css)({border:`1px solid ${l.colors.border.weak}`,borderRadius:l.shape.radius.default,color:l.colors.text.secondary}),row:(0,n.css)({display:"grid",gridTemplateColumns:v.join(" "),gridTemplateRows:"1fr auto","&:nth-child(2n + 1)":{backgroundColor:l.colors.background.secondary},"&:nth-child(2n)":{backgroundColor:l.colors.background.primary},[l.breakpoints.down("sm")]:{gridTemplateColumns:"auto 1fr",gridTemplateAreas:"left right",padding:`0 ${l.spacing(.5)}`,"&:first-child":{display:"none"},"& > *:first-child":{display:m?"none":void 0}}}),footerRow:(0,n.css)({display:"flex",padding:l.spacing(1)}),cell:y=>(0,n.css)({display:"flex",alignItems:"center",padding:l.spacing(1),justifyContent:y||"initial",[l.breakpoints.down("sm")]:{padding:`${l.spacing(1)} 0`,gridTemplateColumns:"1fr"}}),bodyCell:(0,n.css)({overflow:"hidden",[l.breakpoints.down("sm")]:{gridColumnEnd:"right",gridColumnStart:"right","&::before":{content:"attr(data-column)",display:"block",color:l.colors.text.primary}}}),expandCell:(0,n.css)({justifyContent:"center",[l.breakpoints.down("sm")]:{alignItems:"start",gridArea:"left"}}),expandedContentRow:(0,n.css)({gridColumnEnd:v.length+1,gridColumnStart:m?3:2,gridRow:2,padding:`0 ${l.spacing(3)} 0 ${l.spacing(1)}`,position:"relative",[l.breakpoints.down("sm")]:{gridColumnStart:2,borderTop:`1px solid ${l.colors.border.strong}`,gridRow:"auto",padding:`${l.spacing(1)} 0 0 0`}})})}},10562:(k,R,e)=>{"use strict";e.d(R,{B:()=>r});var t=e(74848),n=e(32196),i=e(40845),s=e(75591);const r=({renderExpandedContent:a,...c})=>{const o=(0,i.of)(g);return(0,t.jsx)(s.E,{renderExpandedContent:a?(h,f,d)=>(0,t.jsxs)(t.Fragment,{children:[f!==d.length-1&&(0,t.jsx)("div",{className:(0,n.cx)(o.contentGuideline,o.guideline)}),a(h,f,d)]}):void 0,renderPrefixHeader:()=>(0,t.jsx)("div",{className:o.relative,children:(0,t.jsx)("div",{className:(0,n.cx)(o.headerGuideline,o.guideline)})}),renderPrefixCell:(h,f,d)=>(0,t.jsxs)("div",{className:o.relative,children:[(0,t.jsx)("div",{className:(0,n.cx)(o.topGuideline,o.guideline)}),f!==d.length-1&&(0,t.jsx)("div",{className:(0,n.cx)(o.bottomGuideline,o.guideline)})]}),...c})},g=a=>({relative:(0,n.css)({position:"relative",height:"100%"}),guideline:(0,n.css)({left:"-19px",borderLeft:`1px solid ${a.colors.border.weak}`,position:"absolute",[a.breakpoints.down("md")]:{display:"none"}}),topGuideline:(0,n.css)({width:"18px",borderBottom:`1px solid ${a.colors.border.medium}`,top:0,bottom:"50%"}),bottomGuideline:(0,n.css)({top:"50%",bottom:0}),contentGuideline:(0,n.css)({top:0,bottom:0,left:"-49px !important"}),headerGuideline:(0,n.css)({top:"-17px",bottom:0})})},35108:(k,R,e)=>{"use strict";e.d(R,{j:()=>h});var t=e(74848),n=e(32196),i=e(46942),s=e.n(i),r=e(96540),g=e(40845),a=e(67061),c=e(95868),o=e(13840);const h=({children:d,header:p,content:m,footer:v,arrow:l,showAfter:y=300,wrapperClassName:u,disabled:D=!1,...E})=>{const x=(0,r.useRef)(null),P=(0,g.of)(f);if(D)return d;const b=(0,t.jsxs)(a.B,{direction:"column",gap:0,role:"tooltip",children:[p&&(0,t.jsx)("div",{className:P.card.header,children:p}),(0,t.jsx)("div",{className:P.card.body,children:m}),v&&(0,t.jsx)("div",{className:P.card.footer,children:v})]});return(0,t.jsx)(c.I,{content:b,hideAfter:100,children:(M,O,I)=>(0,t.jsxs)(t.Fragment,{children:[x.current&&(0,t.jsx)(o.A,{...I,...E,wrapperClassName:s()(P.popover,u),onMouseLeave:O,onMouseEnter:M,onFocus:M,onBlur:O,referenceElement:x.current,renderArrow:l}),(0,r.cloneElement)(d,{ref:x,onMouseEnter:M,onMouseLeave:O,onFocus:M,onBlur:O,tabIndex:0})]})})},f=d=>({popover:(0,n.css)({borderRadius:d.shape.radius.default,boxShadow:d.shadows.z3,background:d.colors.background.primary,border:`1px solid ${d.colors.border.medium}`}),card:{body:(0,n.css)({padding:d.spacing(1)}),header:(0,n.css)({padding:d.spacing(1),background:d.colors.background.secondary,borderBottom:`solid 1px ${d.colors.border.medium}`}),footer:(0,n.css)({padding:d.spacing(.5,1),background:d.colors.background.secondary,borderTop:`solid 1px ${d.colors.border.medium}`})}})},93810:(k,R,e)=>{"use strict";e.d(R,{A:()=>s});var t=e(74848),n=e(42418);const s=()=>(0,t.jsx)(n.F,{severity:"info",title:"Alert evaluation currently paused",children:"Notifications for this rule will not fire and no alert instances will be created until the rule is un-paused."})},8406:(k,R,e)=>{"use strict";e.d(R,{J:()=>c});var t=e(74848),n=e(32196),i=e(96540),s=e(84140),r=e(40845),g=e(67061),a=e(14578);const c=({label:h,value:f,icon:d,color:p,size:m="md",onClick:v})=>{const l=(0,r.of)(o,p,m),y=`${h}: ${f}`,u=h?.toString()??"",D=f?.toString()??"",E=(0,i.useMemo)(()=>(0,t.jsxs)(g.B,{direction:"row",gap:0,alignItems:"stretch",children:[(0,t.jsx)("div",{className:l.label,children:(0,t.jsxs)(g.B,{direction:"row",gap:.5,alignItems:"center",children:[d&&(0,t.jsx)(a.I,{name:d}),h&&(0,t.jsx)("span",{className:l.labelText,title:h.toString(),children:h??""})]})}),(0,t.jsx)("div",{className:l.value,title:f?.toString(),children:f??"-"})]}),[d,h,f,l]);return(0,t.jsx)("div",{className:l.wrapper,role:"listitem","aria-label":y,"data-testid":"label-value",children:v?(0,t.jsx)("div",{className:l.clickable,role:"button",tabIndex:0,onClick:()=>v(u,D),onKeyDown:x=>{x.key==="Enter"&&(v(u,D),x.preventDefault())},children:E},u+D):E})},o=(h,f,d)=>{const p=f??h.colors.secondary.main,m=h.isDark?(0,s.A)(p).lighten(5).toString():(0,s.A)(p).darken(5).toString(),v=h.isDark?(0,s.A)(p).darken(5).toString():(0,s.A)(p).lighten(5).toString(),l=f?s.A.mostReadable(p,["#000","#fff"]).toString():h.colors.text.primary;let y=h.spacing(.33,1);switch(d){case"sm":y=h.spacing(.2,.6);break;case"xs":y=h.spacing(0,.5);break;default:break}return{wrapper:(0,n.css)({color:l,fontSize:h.typography.bodySmall.fontSize,borderRadius:h.shape.borderRadius(2)}),labelText:(0,n.css)({whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"300px"}),label:(0,n.css)({display:"flex",alignItems:"center",color:"inherit",padding:y,background:p,border:`solid 1px ${m}`,borderTopLeftRadius:h.shape.borderRadius(2),borderBottomLeftRadius:h.shape.borderRadius(2)}),clickable:(0,n.css)({"&:hover":{opacity:.8,cursor:"pointer"}}),value:(0,n.css)({color:"inherit",padding:y,background:v,border:`solid 1px ${m}`,borderLeft:"none",borderTopRightRadius:h.shape.borderRadius(2),borderBottomRightRadius:h.shape.borderRadius(2),whiteSpace:"pre",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"300px"})}}},55196:(k,R,e)=>{"use strict";e.d(R,{P:()=>a});var t=e(74848),n=e(32196),i=e(40845),s=e(94753),r=e(67061),g=e(14578);const a=({children:o,icon:h,color:f="secondary",direction:d="row",...p})=>{const m=(0,i.of)(c),v=typeof p.onClick=="function",l=d==="row",y=l?"center":"flex-start",u=l?.5:0;return(0,t.jsx)("div",{className:(0,n.cx)({[m.interactive]:v}),...p,children:(0,t.jsx)(s.E,{variant:"bodySmall",color:f,children:(0,t.jsxs)(r.B,{direction:d,alignItems:y,gap:u,wrap:"wrap",children:[h&&(0,t.jsx)(g.I,{size:"xs",name:h}),o]})})})},c=()=>({interactive:(0,n.css)({cursor:"pointer"})})},90141:(k,R,e)=>{"use strict";e.d(R,{A:()=>a});var t=e(74848),n=e(96540),i=e(55852),s=e(67061),r=e(14578);const a=(0,n.forwardRef)(function(o,h){return(0,t.jsx)(i.$n,{variant:"secondary",size:"sm",type:"button","aria-label":"More",ref:h,...o,children:(0,t.jsxs)(s.B,{direction:"row",alignItems:"center",gap:0,children:["More ",(0,t.jsx)(r.I,{name:"angle-down"})]})})})},76156:(k,R,e)=>{"use strict";e.d(R,{h:()=>s});var t=e(74848),n=e(12210);const i=({children:r,plugin:g,loadingComponent:a,notInstalledFallback:c})=>{const{loading:o,installed:h}=usePluginBridge(g);return o?a??null:h?jsx(Fragment,{children:r}):c??null};function s(r,g,a){const c=new URLSearchParams(a).toString();return`/a/${r}${g}`+(c?"?"+c:"")}},48205:(k,R,e)=>{"use strict";e.d(R,{Yi:()=>a,hk:()=>g,rS:()=>c});var t=e(74848),n=e(42418),i=e(39938),s=e(56034),r=e(8484),g=(o=>(o.ContactPoint="contact point",o.Template="template",o.MuteTiming="mute timing",o.AlertRule="alert rule",o.RootNotificationPolicy="root notification policy",o))(g||{});const a=({resource:o,...h})=>(0,t.jsxs)(n.F,{title:`This ${o} cannot be edited through the UI`,severity:"info",...h,children:["This ",o," has been provisioned, that means it was created by config. Please contact your server admin to update this ",o,"."]}),c=({tooltip:o,provenance:h})=>{const f=(0,t.jsx)(i.E,{text:"Provisioned",color:"purple"});if(o){const d=(0,t.jsxs)(r.x6,{i18nKey:"alerting.provisioning.badge-tooltip-provenance",values:{provenance:h},children:["This resource has been provisioned via ",{provenance:h}," and cannot be edited through the UI"]}),p=(0,t.jsx)(r.x6,{i18nKey:"alerting.provisioning.badge-tooltip-standard",children:"This resource has been provisioned and cannot be edited through the UI"}),m=h?d:p;return(0,t.jsx)(s.m,{content:m,children:(0,t.jsx)("span",{children:f})})}return f}},82437:(k,R,e)=>{"use strict";e.d(R,{c:()=>s});var t=e(74848),n=e(94753),i=e(14578);const s=({namespace:r,group:g})=>g?(0,t.jsxs)(n.E,{element:"h3",variant:"body",children:[r," ",(0,t.jsx)(i.I,{name:"angle-right","aria-label":">"})," ",g]}):(0,t.jsx)(n.E,{element:"h3",variant:"body",children:r})},26058:(k,R,e)=>{"use strict";e.d(R,{h:()=>i});var t=e(74848),n=e(32196);const i=()=>(0,t.jsx)("span",{className:(0,n.css)({flex:1})})},65415:(k,R,e)=>{"use strict";e.d(R,{O:()=>r});var t=e(74848),n=e(32196),i=e(96540),s=e(40845);const r=(0,i.forwardRef)(({children:a,state:c,size:o="md",muted:h=!1},f)=>{const d=(0,s.of)(g);return(0,t.jsx)("span",{className:(0,n.cx)(d.common,d[c],d[o],{[d.muted]:h}),ref:f,children:a||c})});r.displayName="StateTag";const g=a=>({common:(0,n.css)({display:"inline-block",color:"white",borderRadius:a.shape.radius.default,fontSize:a.typography.size.sm,textTransform:"capitalize",lineHeight:"1.2",textAlign:"center",fontWeight:a.typography.fontWeightBold}),good:(0,n.css)({backgroundColor:a.colors.success.main,border:`solid 1px ${a.colors.success.main}`,color:a.colors.success.contrastText}),warning:(0,n.css)({backgroundColor:a.colors.warning.main,border:`solid 1px ${a.colors.warning.main}`,color:a.colors.warning.contrastText}),bad:(0,n.css)({backgroundColor:a.colors.error.main,border:`solid 1px ${a.colors.error.main}`,color:a.colors.error.contrastText}),neutral:(0,n.css)({backgroundColor:a.colors.secondary.main,border:`solid 1px ${a.colors.secondary.main}`,color:a.colors.secondary.contrastText}),info:(0,n.css)({backgroundColor:a.colors.primary.main,border:`solid 1px ${a.colors.primary.main}`,color:a.colors.primary.contrastText}),md:(0,n.css)({padding:a.spacing(.5,1),minWidth:a.spacing(8)}),sm:(0,n.css)({padding:a.spacing(.3,.5),minWidth:"52px"}),muted:(0,n.css)({opacity:"0.5"})})},16577:(k,R,e)=>{"use strict";e.d(R,{Y:()=>c});var t=e(74848),n=e(32196),i=e(40845),s=e(39938),r=e(35108),g=e(83225);const a=["$",".",'"'];function c({input:l,delimiter:y=["{{","}}"]}){const u=(0,i.of)(v),[D,E]=y,x=new RegExp(`(?<before>.*?)(${D}(?<token>.*?)${E}|$)`,"gm"),P=l.split(`
`),b=[];return P.forEach((M,O)=>{Array.from(M.matchAll(x)).forEach((T,C)=>{const S=T.groups?.before,A=T.groups?.token?.trim();if(S&&b.push((0,t.jsx)("span",{children:S},`${O}-${C}-before`)),A){const L=m(A),N=L==="variable"?A:"",F=`${D} ${A} ${E}`;b.push((0,t.jsx)(h,{content:F,type:L,description:N},`${O}-${C}-token`))}}),b.push((0,t.jsx)("br",{},`${O}-newline`))}),(0,t.jsx)("span",{className:u.wrapper,children:b})}var o=(l=>(l.Variable="variable",l.Function="function",l.Keyword="keyword",l.Unknown="unknown",l))(o||{});function h({content:l,description:y,type:u}){const D=(0,i.of)(v),E=!u;return(0,t.jsx)(r.j,{placement:"top-start",disabled:E,content:(0,t.jsxs)("div",{className:D.hoverTokenItem,children:[(0,t.jsx)(s.E,{tabIndex:0,text:(0,t.jsx)(t.Fragment,{children:u}),color:"blue"})," ",y&&(0,t.jsx)("code",{children:y})]}),children:(0,t.jsx)("span",{children:(0,t.jsx)(s.E,{tabIndex:0,className:D.token,text:l,color:"blue"})})})}function f(l){return a.some(y=>l.startsWith(y))}function d(l){return g.keywords.some(y=>l.startsWith(y))}function p(l){return g.builtinFunctions.some(y=>l.startsWith(y))}function m(l){let y;return f(l)?y="variable":d(l)?y="keyword":p(l)?y="function":y="unknown",y}const v=l=>({wrapper:(0,n.css)({whiteSpace:"pre-wrap"}),token:(0,n.css)({cursor:"default",fontFamily:l.typography.fontFamilyMonospace}),popover:(0,n.css)({borderRadius:l.shape.radius.default,boxShadow:l.shadows.z3,background:l.colors.background.primary,border:`1px solid ${l.colors.border.medium}`,padding:l.spacing(1)}),hoverTokenItem:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"center",gap:l.spacing(1)})})},73750:(k,R,e)=>{"use strict";e.d(R,{L:()=>s});var t=e(74848),n=e(32196),i=e(40845);const s=({children:g,className:a})=>{const c=(0,i.of)(r);return(0,t.jsx)("div",{className:(0,n.cx)(c.wrapper,a),children:g})},r=g=>({wrapper:(0,n.css)({backgroundColor:g.components.panel.background,border:`solid 1px ${g.components.input.borderColor}`,borderRadius:g.shape.radius.default,padding:g.spacing(.5,1),fontFamily:g.typography.fontFamilyMonospace})})},96636:(k,R,e)=>{"use strict";e.d(R,{d:()=>i});var t=e(96540),n=e(14778);const i=({component:s,title:r="previous page"})=>{const g=(0,n.i)(),a=(0,t.useCallback)(()=>{g(r)},[g,r]);return(0,t.cloneElement)(s,{onClick:a})}},53876:(k,R,e)=>{"use strict";e.d(R,{X:()=>m});var t=e(74848),n=e(32196),i=e(96540),s=e(40996),r=e(40845),g=e(14578),a=e(88575),c=e(60029),o=e(67061),h=e(56034),f=e(10354),d=e(25027),p=e(32642);const m=({onFilterChange:l,defaultQueryString:y})=>{const u=(0,r.of)(v),[D,E]=(0,i.useState)(y??"");(0,s.A)(()=>{(0,d.fH)(d.le.filterByLabel),l(D)},600,[D]);const x=(0,t.jsx)(g.I,{name:"search"});let P=!!(y&&y.length>=3);try{y?(0,p.S6)(y):P=!0}catch{P=!1}return(0,t.jsx)(a.D,{className:u.fixMargin,invalid:!P,error:P?null:"Query must use valid matcher syntax. See the examples in the help tooltip.",label:(0,t.jsx)(c.J,{children:(0,t.jsxs)(o.B,{gap:.5,alignItems:"center",children:[(0,t.jsx)("span",{children:"Search by label"}),(0,t.jsx)(h.m,{content:(0,t.jsxs)("div",{children:["Filter alerts using label querying without spaces, ex:",(0,t.jsx)("pre",{children:'{severity="critical", instance=~"cluster-us-.+"}'}),"Invalid use of spaces:",(0,t.jsx)("pre",{children:'{severity= "critical"}'}),(0,t.jsx)("pre",{children:'{severity ="critical"}'}),"Valid use of spaces:",(0,t.jsx)("pre",{children:'{severity=" critical"}'}),"Filter alerts using label querying without braces, ex:",(0,t.jsx)("pre",{children:'severity="critical", instance=~"cluster-us-.+"'})]}),children:(0,t.jsx)(g.I,{name:"info-circle",size:"sm"})})]})}),children:(0,t.jsx)(f.p,{placeholder:"Search",value:D,onChange:b=>E(b.currentTarget.value),"data-testid":"search-query-input",prefix:x,className:u.inputWidth})})},v=l=>({fixMargin:(0,n.css)({marginBottom:0}),inputWidth:(0,n.css)({width:340,flexGrow:0})})},56528:(k,R,e)=>{"use strict";e.d(R,{GX:()=>N,r4:()=>A});var t=e(74848),n=e(32196),i=e(2543),s=e.n(i),r=e(96540),g=e(49785),a=e(39070),c=e(19845),o=e(72724),h=e(40845),f=e(42418),d=e(67061),p=e(55852),m=e(51440),v=e(29158),l=e(98808),y=e(71680),u=e(1712),D=e(34263),E=e(18225),x=e(76658),P=e(66718),b=e(94822),M=e(98439),O=e(35108),I=e(26058),T=e(30423),C=e(81875),S=e(99106);const A=({queries:H=[],query:Y,data:X,error:J,warning:q,isAlertCondition:ae,onSetCondition:j,onUpdateRefId:te,onRemoveExpression:ne,onUpdateExpressionType:le,onChangeQuery:z})=>{const ee=(0,h.of)(V),se=Y?.type,{setError:ie,clearErrors:Z}=(0,g.xW)(),oe=(0,r.useCallback)(je=>{je?ie("queries",{type:"custom",message:je}):Z("queries")},[ie,Z]),ce=X&&Object.values(X).some(je=>!!je&&je.state===a.Gu.Loading),ye=Array.isArray(X?.series)&&!ce,re=X?.series??[],ue=ae??!1,{seriesCount:De,groupedByState:ge}=w(re),Te=(0,r.useCallback)(je=>{const Ze=H.filter(Ne=>je.refId!==Ne.refId).map(Ne=>({value:Ne.refId,label:Ne.refId}));switch(je.type){case P.Tz.math:return(0,t.jsx)(y.z,{onChange:z,query:je,labelWidth:"auto",onRunQuery:()=>{}});case P.Tz.reduce:return(0,t.jsx)(u.Z,{onChange:z,refIds:Ze,labelWidth:"auto",query:je});case P.Tz.resample:return(0,t.jsx)(D.C,{onChange:z,query:je,labelWidth:"auto",refIds:Ze});case P.Tz.classic:return(0,t.jsx)(l.z,{onChange:z,query:je,refIds:Ze});case P.Tz.threshold:return(0,t.jsx)(x.O,{onChange:z,query:je,labelWidth:"auto",refIds:Ze,onError:oe,useHysteresis:!0});case P.Tz.sql:return(0,t.jsx)(E.k,{onChange:z,query:je,refIds:Ze});default:return(0,t.jsxs)(t.Fragment,{children:["Expression not supported: ",je.type]})}},[z,H,oe]),Ye=P.uQ.find(je=>je.value===se)?.description??"";return(0,t.jsx)("div",{className:(0,n.cx)(ee.expression.wrapper,ue&&ee.expression.alertCondition,se===P.Tz.classic&&ee.expression.classic,se!==P.Tz.classic&&ee.expression.nonClassic),children:(0,t.jsxs)("div",{className:ee.expression.stack,children:[(0,t.jsx)(B,{refId:Y.refId,queryType:se,onRemoveExpression:()=>ne(Y.refId),onUpdateRefId:je=>te(Y.refId,je),onSetCondition:j,query:Y,alertCondition:ue}),(0,t.jsxs)("div",{className:ee.expression.body,children:[J&&(0,t.jsx)(f.F,{title:"Expression failed",severity:"error",children:J.message}),q&&(0,t.jsx)(f.F,{title:"Expression warning",severity:"warning",children:q.message}),(0,t.jsx)("div",{className:ee.expression.description,children:Ye}),Te(Y)]}),ye&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(N,{series:re,isAlertCondition:ae}),(0,t.jsx)("div",{className:ee.footer,children:(0,t.jsxs)(d.B,{direction:"row",alignItems:"center",children:[(0,t.jsx)(I.h,{}),(0,t.jsx)(F,{isCondition:!!ae,firing:ge[b.cF.Firing].length,normal:ge[b.cF.Inactive].length,seriesCount:De})]})})]})]})})},L=20,N=({series:H,isAlertCondition:Y})=>{const{pageItems:X,previousPage:J,nextPage:q,numberOfPages:ae,pageStart:j,pageEnd:te}=(0,M.W)(H,1,L),ne=(0,h.of)(V),le=(0,S.PI)(H),z=!le&&(0,c.jq)(H),ee=ae>1;return(0,t.jsxs)("div",{className:ne.expression.results,children:[!le&&z&&(0,t.jsx)("div",{children:X.map((se,ie)=>(0,t.jsx)(K,{frame:se,index:j+ie,isAlertCondition:Y},(0,i.uniqueId)()))}),!le&&!z&&X.map((se,ie)=>(0,t.jsx)(U,{frame:se,index:j+ie,isAlertCondition:Y},(0,i.uniqueId)())),le&&(0,t.jsx)("div",{className:(0,n.cx)(ne.expression.noData,ne.mutedText),children:"No data"}),ee&&(0,t.jsx)("div",{className:ne.pagination.wrapper,"data-testid":"paginate-expression",children:(0,t.jsxs)(d.B,{children:[(0,t.jsx)(p.$n,{variant:"secondary",fill:"outline",onClick:J,icon:"angle-left",size:"sm","aria-label":"previous-page"}),(0,t.jsx)(I.h,{}),(0,t.jsxs)("span",{className:ne.mutedText,children:[j," - ",te," of ",H.length]}),(0,t.jsx)(I.h,{}),(0,t.jsx)(p.$n,{variant:"secondary",fill:"outline",onClick:q,icon:"angle-right",size:"sm","aria-label":"next-page"})]})})]})},F=({firing:H,normal:Y,isCondition:X,seriesCount:J})=>{const{mutedText:q}=(0,h.of)(V);return J===0?(0,t.jsx)("span",{className:q,children:"No series"}):X?(0,t.jsx)("span",{className:q,children:`${J} series: ${H} firing, ${Y} normal`}):(0,t.jsx)("span",{className:q,children:`${J} series`})};function w(H){const Y=H.filter(q=>(0,S.Lm)(q)===void 0).length,X={[b.cF.Firing]:H.filter(q=>(0,S.Lm)(q)!==void 0&&(0,S.Lm)(q)!==0),[b.cF.Inactive]:H.filter(q=>(0,S.Lm)(q)===0)},J=H.length-Y;return{groupedByState:X,seriesCount:J}}const B=({refId:H,queryType:Y,onUpdateRefId:X,onRemoveExpression:J,onSetCondition:q,alertCondition:ae,query:j})=>{const te=(0,h.of)(V),ne=(0,h.of)(p.my),[le,z]=(0,r.useState)(!1),se=le!==!1&&le==="refId";return(0,t.jsx)("header",{className:te.header.wrapper,children:(0,t.jsxs)(d.B,{direction:"row",gap:.5,alignItems:"center",children:[(0,t.jsxs)(d.B,{direction:"row",gap:1,alignItems:"center",children:[!se&&(0,t.jsx)("button",{type:"button",className:(0,n.cx)(ne,te.editable),onClick:()=>z("refId"),children:(0,t.jsx)("div",{className:te.expression.refId,children:H})}),se&&(0,t.jsx)(m.D,{autoFocus:!0,defaultValue:H,minWidth:5,onChange:ie=>{X(ie.currentTarget.value),z(!1)},onFocus:ie=>ie.target.select(),onBlur:ie=>{X(ie.currentTarget.value),z(!1)}}),(0,t.jsx)("div",{children:(0,P.NI)(Y)})]}),(0,t.jsx)(I.h,{}),(0,t.jsx)(C.a,{onSetCondition:()=>q(j.refId),isCondition:ae}),(0,t.jsx)(v.K,{name:"trash-alt",variant:"secondary",className:te.mutedIcon,onClick:J,tooltip:"Remove expression"})]})})},U=({frame:H,index:Y,isAlertCondition:X})=>{const J=(0,h.of)(V),q=(0,S.Jw)(H)||"Series "+Y,ae=(0,S.Lm)(H),j=(0,S.JQ)(H),te=Object.entries(j),ne=te.length>0,le=X&&ae!==0,z=X&&ae===0,ee=`${ne?"":q}${ne?`{${(0,S.h6)(j)}}`:""}`;return(0,t.jsx)("div",{className:J.expression.resultsRow,children:(0,t.jsxs)(d.B,{direction:"row",gap:1,alignItems:"center",children:[(0,t.jsxs)("div",{className:J.expression.resultLabel,title:ee,children:[(0,t.jsx)("span",{children:ne?"":q}),ne&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{children:"{"}),te.map(([se,ie],Z)=>(0,t.jsxs)("span",{children:[(0,t.jsx)("span",{className:J.expression.labelKey,children:se}),(0,t.jsx)("span",{children:"="}),(0,t.jsx)("span",{children:'"'}),(0,t.jsx)("span",{className:J.expression.labelValue,children:ie}),(0,t.jsx)("span",{children:'"'}),Z<te.length-1&&(0,t.jsx)("span",{children:", "})]},(0,i.uniqueId)())),(0,t.jsx)("span",{children:"}"})]})]}),(0,t.jsx)("div",{className:J.expression.resultValue,children:ae}),le&&(0,t.jsx)(T.C,{state:b.cF.Firing,size:"sm"}),z&&(0,t.jsx)(T.C,{state:b.cF.Inactive,size:"sm"})]})})},K=({frame:H,index:Y})=>{const X=(0,h.of)(V),J=H.fields[1],q=J.labels,j=J.config?.displayNameFromDS??(q?(0,S.h6)(J.labels??{}):"Series "+Y),te=H.fields[0].values,ne=z=>H.fields[0].values[z],le=z=>H.fields[1].values[z];return(0,t.jsx)("div",{className:X.expression.resultsRow,children:(0,t.jsxs)(d.B,{direction:"row",alignItems:"center",children:[(0,t.jsx)("span",{className:(0,n.cx)(X.mutedText,X.expression.resultLabel),title:j,children:j}),(0,t.jsx)("div",{className:X.expression.resultValue,children:(0,t.jsx)(O.j,{placement:"right",wrapperClassName:X.timeseriesTableWrapper,content:(0,t.jsxs)("table",{className:X.timeseriesTable,children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Timestamp"}),(0,t.jsx)("th",{children:"Value"})]})}),(0,t.jsx)("tbody",{children:te.map((z,ee)=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{className:X.mutedText,children:(0,o.LE)(ne(ee))}),(0,t.jsx)("td",{className:X.expression.resultValue,children:le(ee)})]},ee))})]}),children:(0,t.jsx)("span",{children:"Time series data"})})})]})})},V=H=>({expression:{wrapper:(0,n.css)({display:"flex",border:`solid 1px ${H.colors.border.medium}`,flex:1,flexBasis:"400px",borderRadius:H.shape.radius.default}),stack:(0,n.css)({display:"flex",flexDirection:"column",flexWrap:"nowrap",gap:0,width:"100%",minWidth:"0"}),classic:(0,n.css)({maxWidth:"100%"}),nonClassic:(0,n.css)({maxWidth:"640px"}),alertCondition:(0,n.css)({}),body:(0,n.css)({padding:H.spacing(1),flex:1}),description:(0,n.css)({marginBottom:H.spacing(1),fontSize:H.typography.size.xs,color:H.colors.text.secondary}),refId:(0,n.css)({fontWeight:H.typography.fontWeightBold,color:H.colors.primary.text}),results:(0,n.css)({display:"flex",flexDirection:"column",flexWrap:"nowrap",borderTop:`solid 1px ${H.colors.border.medium}`}),noResults:(0,n.css)({display:"flex",alignItems:"center",justifyContent:"center"}),resultsRow:(0,n.css)({padding:`${H.spacing(.75)} ${H.spacing(1)}`,"&:nth-child(odd)":{backgroundColor:H.colors.background.secondary},"&:hover":{backgroundColor:H.colors.background.canvas}}),labelKey:(0,n.css)({color:H.isDark?"#73bf69":"#56a64b"}),labelValue:(0,n.css)({color:H.isDark?"#ce9178":"#a31515"}),resultValue:(0,n.css)({textAlign:"right"}),resultLabel:(0,n.css)({flex:1,overflowX:"auto",display:"inline-block",whiteSpace:"nowrap"}),noData:(0,n.css)({display:"flex",alignItems:"center",justifyContent:"center",padding:H.spacing()})},mutedText:(0,n.css)({color:H.colors.text.secondary,fontSize:"0.9em",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}),header:{wrapper:(0,n.css)({background:H.colors.background.secondary,padding:`${H.spacing(.5)} ${H.spacing(1)}`,borderBottom:`solid 1px ${H.colors.border.weak}`})},footer:(0,n.css)({background:H.colors.background.secondary,padding:H.spacing(1),borderTop:`solid 1px ${H.colors.border.weak}`}),draggableIcon:(0,n.css)({cursor:"grab"}),mutedIcon:(0,n.css)({color:H.colors.text.secondary}),editable:(0,n.css)({padding:`${H.spacing(.5)} ${H.spacing(1)}`,border:`solid 1px ${H.colors.border.weak}`,borderRadius:H.shape.radius.default,display:"flex",flexDirection:"row",alignItems:"center",gap:H.spacing(1),cursor:"pointer"}),timeseriesTableWrapper:(0,n.css)({maxHeight:"500px",overflowY:"scroll"}),timeseriesTable:(0,n.css)({tableLayout:"auto",width:"100%",height:"100%","td, th":{padding:H.spacing(1)},td:{background:H.colors.background.primary},th:{background:H.colors.background.secondary},tr:{borderBottom:`1px solid ${H.colors.border.medium}`,"&:last-of-type":{borderBottom:"none"}}}),pagination:{wrapper:(0,n.css)({borderTop:`1px solid ${H.colors.border.medium}`,padding:H.spacing()})}})},81875:(k,R,e)=>{"use strict";e.d(R,{a:()=>g});var t=e(74848),n=e(32196),i=e(40845),s=e(39938),r=e(55852);const g=({isCondition:c,onSetCondition:o})=>{const h=(0,i.of)(a);return c?(0,t.jsx)(s.E,{color:"green",icon:"check",text:"Alert condition"},"condition"):(0,t.jsx)("button",{type:"button",className:h.actionLink,onClick:()=>o&&o(),children:"Set as alert condition"},"make-condition")},a=c=>{const o=(0,r.my)(c);return{actionLink:(0,n.css)(o,{color:c.colors.text.link,cursor:"pointer","&:hover":{textDecoration:"underline"}})}}},99106:(k,R,e)=>{"use strict";e.d(R,{EL:()=>o,JQ:()=>a,Jw:()=>r,Lm:()=>g,PI:()=>f,h6:()=>c,wf:()=>h});var t=e(2543),n=e.n(t),i=e(97706),s=e(57220);const r=d=>{const p=d.fields[0];return p?.config?.displayNameFromDS??d.name??p?.labels?.__name__},g=d=>{const p=d.fields[0]?.values[0];return Number.isFinite(p)?(0,i.h)(p,5):p},a=d=>d.fields[0]?.labels??{},c=d=>Object.entries(d).map(([p,m])=>p+"="+m).join(", "),o=d=>{const p=d.name;if((0,s.Eb)(d.rulesSource))return{name:p,parents:[]};try{const m=JSON.parse(p);if(!Array.isArray(m))throw new Error("not a nested Grafana folder");const v=(0,t.last)(m)??p,l=(0,t.dropRight)(m,1);return{name:v,parents:l}}catch{return{name:d.name,parents:[]}}},h=(d,p=[])=>JSON.stringify(p.concat(d)),f=d=>d.every(m=>m.fields.every(v=>v.values.every(l=>l==null)))},83225:(k,R,e)=>{"use strict";e.r(R),e.d(R,{AlertmanagerTemplateFunction:()=>n,availableAlertManagerFunctions:()=>i,builtinFunctions:()=>r,conf:()=>c,keywords:()=>g,language:()=>a});var t=(o=>(o.Delimiter="delimiter",o.Keyword="keyword",o.Function="type.identifier",o.String="string",o.Variable="variable.name",o.Number="number",o.Comment="comment",o.Operator="operator",o.Identifier="idenfifier",o))(t||{}),n=(o=>(o.toUpper="toUpper",o.toLower="toLower",o.title="title",o.join="join",o.match="match",o.safeHtml="safeHtml",o.reReplaceAll="reReplaceAll",o.stringSlice="stringSlice",o))(n||{});const i=Object.values(n),r=["and","call","html","index","slice","js","len","not","or","print","printf","println","urlquery",...["eq","ne","lt","le","gt","ge"]],g=["define","if","else","end","range","break","continue","template","block","with"],a={defaultToken:"",keywords:g,functions:[...r,...i],operators:["|"],tokenizer:{root:[[/"/,"string","@string"],[/`/,"string","@rawstring"],[/\d*\d+[eE]([\-+]?\d+)?/,"number.float"],[/\d*\.\d+([eE][\-+]?\d+)?/,"number.float"],[/0[xX][0-9a-fA-F']*[0-9a-fA-F]/,"number.hex"],[/0[0-7']*[0-7]/,"number.octal"],[/0[bB][0-1']*[0-1]/,"number.binary"],[/\d[\d']*/,"number"],[/\d/,"number"],[/[;,.]/,"delimiter"],[/{{-?/,"delimiter"],[/-?}}/,"delimiter"],[/\.([A-Za-z]+)?/,"variable.name"],[/[a-zA-Z_]\w*/,{cases:{"@keywords":{token:"keyword"},"@functions":{token:"type.identifier"},"@default":"idenfifier"}}],[/\/\*.*\*\//,"comment"]],string:[[/[^\\"]+/,"string"],[/\\./,"string.escape.invalid"],[/"/,"string","@pop"]],rawstring:[[/[^\`]/,"string"],[/`/,"string","@pop"]]}},c={comments:{blockComment:["/*","*/"]},brackets:[["{{","}}"],["(",")"]],autoClosingPairs:[{open:"{{",close:"}}"},{open:"(",close:")"},{open:"`",close:"`"},{open:'"',close:'"'},{open:"'",close:"'"}],surroundingPairs:[{open:"{{",close:"}}"},{open:"(",close:")"},{open:"`",close:"`"},{open:'"',close:'"'},{open:"'",close:"'"}]}},37534:(k,R,e)=>{"use strict";e.d(R,{FI:()=>t,J4:()=>n,p8:()=>s});const t="grafana_alerting";var n=(r=>(r.OnCall="oncall",r))(n||{});const i=(r,g)=>g.includes(r),s=(r,g)=>{if(!r.grafana_managed_receiver_configs)return!1;const a=r.grafana_managed_receiver_configs.length===1,c=i(r.grafana_managed_receiver_configs[0]?.settings?.url??"",g.map(o=>o.integration_url));return a&&c}},74685:(k,R,e)=>{"use strict";e.d(R,{j:()=>h});var t=e(74848),n=e(32196),i=e(70713),s=e(19845),r=e(40845),g=e(28138),a=e(72519),c=e(56528),o=e(7921);const h=({data:d,thresholds:p,thresholdsType:m})=>{const v=(0,r.of)(f),l=(0,s.jq)(d.series),y=(0,o.yW)(d),u=m?{mode:m}:void 0;return(0,t.jsx)("div",{className:v.wrapper,children:(0,t.jsx)(i.Ay,{disableHeight:!0,children:({width:D})=>(0,t.jsx)("div",{style:{width:D},children:l?(0,t.jsx)(a.y,{statusMessage:y,data:d.series,eventBus:g.A,height:300,width:D,timeRange:d.timeRange,timeZone:"browser",onChangeTime:()=>{},splitOpenFn:()=>{},loadingState:d.state,thresholdsConfig:p,thresholdsStyle:u}):(0,t.jsxs)("div",{className:v.instantVectorResultWrapper,children:[(0,t.jsx)("header",{className:v.title,children:"Table"}),(0,t.jsx)(c.GX,{series:d.series})]})})})})},f=d=>({wrapper:(0,n.css)({width:"100%",position:"relative"}),instantVectorResultWrapper:(0,n.css)({border:`solid 1px ${d.colors.border.medium}`,borderRadius:d.shape.radius.default,padding:0,display:"flex",flexDirection:"column",flexWrap:"nowrap"}),title:(0,n.css)({label:"panel-title",padding:d.spacing(),textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",fontSize:d.typography.h6.fontSize,fontWeight:d.typography.h6.fontWeight})})},7921:(k,R,e)=>{"use strict";e.d(R,{G0:()=>b,zy:()=>M,lb:()=>O,YG:()=>L,yW:()=>S,an:()=>T,I3:()=>E,xb:()=>P,_u:()=>A,yr:()=>I});var t=e(2543),n=e(19845),i=e(50082),s=e(39070),r=e(52622),g=e(2913),a=e(55907),c=e(69437),o=e(66718),h=e(86590),f=e(41811),d=e(34525);const p=(0,f.A)(m,(N,F)=>D(N[0])===D(F[0]));function m(N){const F=new d.TS,w=N.map(B=>B.refId);return F.createNodes(w),N.forEach(B=>{const U=B.refId;((0,c.f)(B.model)&&B.model.type==="math"?v(B.model.expression??""):[B.model.expression]).forEach(H=>{U&&H&&!(U===H)&&F.link(H,U)})}),F}function v(N){const F=new RegExp(/\$\{(?<var>[a-zA-Z0-9_ ]+?)\}/gm),w=new RegExp(/\$(?<var>[a-zA-Z0-9_]+)/gm),B=Array.from(N.matchAll(F)).map(K=>K.groups?.var),U=Array.from(N.matchAll(w)).map(K=>K.groups?.var);return(0,t.compact)((0,t.uniq)([...B,...U]))}const l=(0,t.memoize)(y,(N,F)=>N+u(F));function y(N,F){const w=F.getNode(N),B=[];function U(K){const V=K.inputEdges;V.length>0?V.forEach(H=>{H.inputNode&&U(H.inputNode)}):B?.push(K)}return U(w),B.map(K=>K.name)}function u(N){return Object.keys(N.nodes).map(F=>{const w=N.nodes[F],B=w.outputEdges.map(K=>K.outputNode?.name).join(", "),U=w.inputEdges.map(K=>K.inputNode?.name).join(", ");return`${w.name}:${B}:${U}`}).join(" ")}function D(N){return N.map(F=>{const w=(0,c.f)(F.model)?F.model.type:F.queryType;return F.refId+(F.model.expression??"")+w}).join()}function E(N,F,w){return N.map(B=>{if(F===w||!(0,c.f)(B.model))return B;const U=B.model.type==="math",K=B.model.type==="reduce",V=B.model.type==="resample",H=B.model.type==="classic_conditions",Y=B.model.type==="threshold";if(U)return{...B,model:{...B.model,expression:x(B.model.expression??"",F,w)}};if(V||K||Y){const X=B.model.expression===F;return{...B,model:{...B.model,expression:X?w:B.model.expression}}}if(H){const X=B.model.conditions?.map(J=>({...J,query:{...J.query,params:J.query.params.map(q=>q===F?w:q)}}));return{...B,model:{...B.model,conditions:X}}}return B})}function x(N,F,w){const B=new RegExp("(\\$"+F+"\\b)|(\\${"+F+"})","gm"),U="${"+w+"}";return N.replace(B,U)}function P(N,F){return N.find(w=>w.refId===F)!==void 0}function b(N){return N.includes("/")||N.includes("\\")?'Cannot contain "/" or "\\" characters':!0}function M(N){if(N.series.length===0)return;const F=(0,n.jq)(N.series);let w;return F&&(w=new Error("You cannot use time series data as an alert condition, consider adding a reduce expression.")),w}function O(N){if(N.errors?.length)return new Error(N.errors[0].message)}function I(N){const w=(N[0]?.meta?.notices??[]).find(B=>B.severity==="warning")?.text;return w?new Error(w):void 0}function T(N,F){const w={},B=[o.Tz.threshold,o.Tz.classic];if(!F)return w;for(const V of N){if(!(0,c.f)(V.model)||!B.includes(V.model.type)||!Array.isArray(V.model.conditions)||V.model.refId!==F)continue;const H=V.model.conditions.some(C);V.model.conditions.forEach(Y=>{const X=Y.evaluator.params,J=Y.query?.params[0]??V.model.expression;if(!J)return;const q=C(Y);try{const ae=p(N),j=l(J,ae);N.filter(ne=>j.includes(ne.refId)).forEach(ne=>{const le=ne.refId,ee=!!(!(0,c.f)(ne?.model)&&le);le&&!w[le]&&(w[le]={config:{mode:i.O.Absolute,steps:[]},mode:r.Ly.Line}),le&&ee&&!q&&!H?U(le,X[0]):le&&ee&&q&&(K(le,X,Y.evaluator.type),w[le].mode=r.Ly.LineAndArea)})}catch(ae){console.error("Failed to parse thresholds",ae);return}})}function U(V,H){w[V].config.steps.push({value:-1/0,color:"transparent"},{value:H,color:g.config.theme2.colors.error.main})}function K(V,H,Y){Y===a.p.IsWithinRange&&w[V].config.steps.push({value:-1/0,color:"transparent"},{value:H[0],color:g.config.theme2.colors.error.main},{value:H[1],color:g.config.theme2.colors.error.main},{value:H[1],color:"transparent"}),Y===a.p.IsOutsideRange&&w[V].config.steps.push({value:-1/0,color:g.config.theme2.colors.error.main},{value:H[0],color:g.config.theme2.colors.error.main},{value:H[0],color:"transparent"},{value:H[1],color:g.config.theme2.colors.error.main}),w[V].config.steps.sort((X,J)=>X.value-J.value),w[V].config.steps=w[V].config.steps.filter(X=>X.value!==void 0)}return w}function C(N){return N.evaluator.type===a.p.IsWithinRange||N.evaluator.type===a.p.IsOutsideRange}function S(N){const F="Failed to fetch data";if(N.state!==s.Gu.Error)return;const w=N.errors;return w?.length?w.map(B=>B.message??F).join(", "):N.error?.message??F}function A(N=""){return N==="recording"?h.Z.cloudRecording:N==="grafana-recording"?h.Z.grafanaRecording:h.Z.grafana}function L(N,F){const w=F.filter(V=>!(0,c.f)(V.model)).map(V=>V.refId),B=N.filter(V=>!(0,c.f)(V.model)).map(V=>V.refId),[U,K]=(0,t.xor)(B,w);return[U,K]}},13064:(k,R,e)=>{"use strict";e.d(R,{C:()=>a});var t=e(87836),n=e(72880),i=e(70416),s=e(47232),r=e(72724),g=e(25968);function a(o,h){if(!o||!h||!(0,i.vd)(o))return;let f;try{f=(0,g.M9)(h)}catch{return}if((0,g.mo)(o))return;const d=Date.parse(o||""),p=(0,t.A)(d,f);return(0,n.Y)(p,new Date)?{humanized:`within ${h}`,fullDate:`within ${h}`}:{humanized:`in ${(0,s.KQ)(p).locale("en").fromNow(!0)}`,fullDate:(0,r.LE)(p,{format:"YYYY-MM-DD HH:mm:ss"})}}function c(o){if(!o)return null;if(!isNullDate(o))return formatDistanceToNowStrict(new Date(o))}},5179:(k,R,e)=>{"use strict";e.d(R,{K:()=>s,k:()=>r});var t=e(74848),n=e(96540);const i=n.createContext(void 0),s=({children:g,rule:a,identifier:c})=>{const o={rule:a,identifier:c};return(0,t.jsx)(i.Provider,{value:o,children:g})},r=()=>{const g=n.useContext(i);if(g===void 0)throw new Error("useAlertRule must be used within a AlertRuleContext");return g}},39890:(k,R,e)=>{"use strict";e.d(R,{gQ:()=>Pt,Ay:()=>Vn,lf:()=>Rn,P5:()=>Kn});var t=e(74848),n=e(32196),i=e(2543),s=e(96540),r=e(67061),g=e(42418),a=e(40980),c=e(72109),o=e(94753),h=e(40845),f=e(55852),d=e(83277),p=e(93810),m=e(35896),v=e(54317),l=e(94822),y=e(79741),u=e(85244),D=e(55740),E=e(56361),x=e(23662),P=e(3704),b=e(69087),M=e(37959),O=e(48205),I=e(96636),T=e(99106),C=e(51921);function S(){return(0,t.jsx)(g.F,{severity:"info",title:"This rule is part of a federated rule group.",bottomSpacing:0,topSpacing:2,children:(0,t.jsxs)(r.B,{direction:"column",children:["Federated rule groups are currently an experimental feature.",(0,t.jsx)(f.$n,{fill:"text",icon:"book",children:(0,t.jsx)("a",{href:"https://grafana.com/docs/metrics-enterprise/latest/tenant-management/tenant-federation/#cross-tenant-alerting-and-recording-rule-federation",children:"Read documentation"})})]})})}var A=e(14578);function L(){return(0,t.jsx)(o.E,{variant:"bodySmall",color:"warning",children:(0,t.jsxs)(r.B,{direction:"row",alignItems:"center",gap:.25,wrap:"nowrap",flex:"0 0 auto",children:[(0,t.jsx)(A.I,{name:"pause",size:"xs"})," Paused"]})})}var N=e(5179);const F=({color:Et,includeState:Ft})=>{const Gt=(0,h.of)(w,{color:Et,includeState:Ft});return(0,t.jsx)(r.B,{direction:"row",gap:.5,children:(0,t.jsx)("div",{className:Gt.dot})})},w=(Et,Ft)=>{const Gt=Et.spacing(1.25),ln=`calc(${Gt} / 2.5)`,qt=Ft.color==="error",cn=Ft.color==="success",En=Ft.color==="warning";return{dot:(0,n.css)({width:Gt,height:Gt,borderRadius:"100%",backgroundColor:Et.colors.secondary.main,outline:`solid ${ln} ${Et.colors.secondary.transparent}`,margin:ln},cn&&(0,n.css)({backgroundColor:Et.colors.success.main,outlineColor:Et.colors.success.transparent}),En&&(0,n.css)({backgroundColor:Et.colors.warning.main,outlineColor:Et.colors.warning.transparent}),qt&&(0,n.css)({backgroundColor:Et.colors.error.main,outlineColor:Et.colors.error.transparent}))}},B=({health:Et})=>{const Ft=Rn(Et),Gt=Ft?"error":"success",ln=Ft?"Recording error":"Recording";return(0,t.jsx)(K,{color:Gt,text:ln})},U=({state:Et,health:Ft})=>{let Gt,ln;switch(Et){case l.cF.Inactive:ln="success",Gt="Normal";break;case l.cF.Firing:ln="error",Gt="Firing";break;case l.cF.Pending:ln="warning",Gt="Pending";break}return Rn(Ft)&&(ln="error",Gt="Error"),Ft==="nodata"&&(ln="warning",Gt="No data"),(0,t.jsx)(K,{color:ln,text:Gt})};function K({color:Et,text:Ft}){return(0,t.jsxs)(r.B,{direction:"row",gap:.5,wrap:"nowrap",flex:"0 0 auto",children:[(0,t.jsx)(F,{color:Et}),(0,t.jsx)(o.E,{variant:"bodySmall",color:Et,children:Ft})]})}var V=e(50509),H=e(32264),Y=e(46013);const X=(0,s.lazy)(()=>e.e(7409).then(e.bind(e,87409))),J=(0,s.lazy)(()=>e.e(285).then(e.bind(e,285))),q=({rule:Et})=>{const Ft=H.$.unifiedAlerting.alertStateHistoryBackend,Gt=H.$.unifiedAlerting.alertStateHistoryPrimary,qt=[Ft,Gt].some(Sn=>Sn===Y.Q.Loki)?Y.Q.Loki:Y.Q.Annotations,cn=Et.grafana_alert.id??"",En=Et.grafana_alert.uid;return(0,t.jsxs)(s.Suspense,{fallback:"Loading...",children:[qt===Y.Q.Loki&&(0,t.jsx)(J,{ruleUID:En}),qt===Y.Q.Annotations&&(0,t.jsx)(X,{alertId:cn})]})};var ae=e(15054),j=e(99938);const te=({rule:Et})=>(0,t.jsx)(j.s,{rule:Et,pagination:{itemsPerPage:ae.FG},enableFiltering:!0});var ne=e(24120),le=e(39070),z=e(76885),ee=e(65879),se=e(11807),ie=e(66602),Z=e(39938),oe=e(69437),ce=e(66718),ye=e(55907),re=e(26058),ue=e(56528),De=e(7921),ge=e(74685);function Te({data:Et,thresholds:Ft}){return Et?(0,t.jsx)(ge.j,{data:Et,thresholds:Ft?.config,thresholdsType:Ft?.mode}):null}var Le=e(20382),Ye=e(57220),je=e(63066),Ze=e(85828);const Ne=({expression:Et})=>(0,t.jsx)(Ze.m,{options:{readOnly:!0,minimap:{enabled:!1},scrollBeyondLastColumn:0,scrollBeyondLastLine:!1,lineNumbers:"off",cursorWidth:0,overviewRulerLanes:0},defaultLanguage:"sql",height:80,defaultValue:Et,width:"100%"});function Pe(Et){return"rawSql"in Et}const Ue=null,$e=s.lazy(()=>e.e(8468).then(e.bind(e,58468))),ze=s.lazy(()=>e.e(7011).then(e.bind(e,67011)));function qe({model:Et,dataSource:Ft}){return Ft.type===Ye.ol.Prometheus&&(0,je.Bu)(Et)?(0,t.jsx)($e,{query:Et.expr}):Ft.type===Ye.ol.Loki&&(0,je.Bu)(Et)?(0,t.jsx)(ze,{query:Et.expr??""}):Pe(Et)?(0,t.jsx)(Ne,{expression:Et.rawSql}):(0,t.jsx)("pre",{children:(0,t.jsx)("code",{children:(0,Le.Bh)(Et)})})}var dt=e(19073);function vt({rule:Et,queries:Ft,condition:Gt,evalDataByQuery:ln={}}){const qt=(0,i.keyBy)(Object.values(H.$.datasources),Wn=>Wn.uid),cn=Ft.filter(Wn=>!(0,oe.f)(Wn.model)),En=Ft.filter(Wn=>(0,oe.f)(Wn.model)),Sn=(0,h.of)(et),Tn=(0,De.an)(Ft,Gt);return(0,t.jsxs)(r.B,{gap:1,direction:"column",flex:"1 1 320px",children:[(0,t.jsx)("div",{className:Sn.maxWidthContainer,children:(0,t.jsx)(r.B,{gap:1,wrap:"wrap","data-testid":"queries-container",children:cn.map(({model:Wn,relativeTimeRange:Nn,refId:Tt,datasourceUid:Wt},jt)=>{const ut=qt[Wt];return(0,t.jsx)(yt,{rule:Et,refId:Tt,model:Wn,relativeTimeRange:Nn,dataSource:ut,thresholds:Tn[Tt],queryData:ln[Tt]},jt)})})}),(0,t.jsx)("div",{className:Sn.maxWidthContainer,children:(0,t.jsx)(r.B,{gap:1,wrap:"wrap","data-testid":"expressions-container",children:En.map(({model:Wn,refId:Nn,datasourceUid:Tt},Wt)=>(0,oe.f)(Wn)&&(0,t.jsx)(Ee,{refId:Nn,isAlertCondition:Gt===Nn,model:Wn,evalData:ln[Nn]},Wt))})})]})}function yt({refId:Et,rule:Ft,thresholds:Gt,model:ln,dataSource:qt,queryData:cn,relativeTimeRange:En}){const Sn=(0,h.of)(pe),Tn=(0,oe.f)(ln),[Wn,Nn]=(0,dt.mh)(Ft,dt.j5.Explore),Tt=Wn&&Nn,Wt=[];if(qt){const ut=qt.name??"[[Data source not found]]",Zt=qt.meta.info.logos.small;Wt.push((0,t.jsx)(Ve,{name:ut,imgUrl:Zt},"datasource"))}En&&Wt.push((0,t.jsxs)(o.E,{color:"secondary",children:[(0,ee.secondsToHms)(En.from)," to now"]},"timerange"));let jt;return!Tn&&Tt&&(jt=qt&&st(qt,ln)),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(me,{refId:Et,headerItems:Wt,exploreLink:jt,children:(0,t.jsx)("div",{className:Sn.queryPreviewWrapper,children:(0,t.jsx)(ie.Xw,{children:ln&&qt&&(0,t.jsx)(qe,{model:ln,dataSource:qt})})})}),qt&&(0,t.jsx)(Te,{data:cn,thresholds:Gt})]})}function st(Et,Ft){const{uid:Gt,type:ln}=Et,{refId:qt,...cn}=Ft;return z.kM.renderUrl(`${H.$.appSubUrl}/explore`,{left:JSON.stringify({datasource:Et.uid,queries:[{refId:"A",...cn,datasource:{type:ln,uid:Gt}}],range:{from:"now-1h",to:"now"}})})}function Ve({name:Et,imgUrl:Ft}){const Gt=(0,h.of)(pe);return(0,t.jsxs)("div",{className:Gt.dataSource,children:[(0,t.jsx)("img",{src:Ft,width:16,alt:Et}),Et]},"datasource")}const pe=Et=>({queryPreviewWrapper:(0,n.css)({margin:Et.spacing(1)}),contentBox:(0,n.css)({flex:"1 0 100%"}),visualization:(0,n.css)({padding:Et.spacing(1)}),dataSource:(0,n.css)({border:`1px solid ${Et.colors.border.weak}`,borderRadius:Et.shape.radius.default,padding:Et.spacing(.5,1),display:"flex",alignItems:"center",gap:Et.spacing(1)})});function Ee({refId:Et,model:Ft,evalData:Gt,isAlertCondition:ln}){function qt(){switch(Ft.type){case ce.Tz.math:return(0,t.jsx)(rt,{model:Ft});case ce.Tz.reduce:return(0,t.jsx)(Oe,{model:Ft});case ce.Tz.resample:return(0,t.jsx)(he,{model:Ft});case ce.Tz.classic:return(0,t.jsx)(Se,{model:Ft});case ce.Tz.threshold:return(0,t.jsx)(We,{model:Ft});case ce.Tz.sql:return(0,t.jsx)(se.l,{rawSql:Ft.expression||"",datasourceType:Ft.datasource?.type});default:return(0,t.jsxs)(t.Fragment,{children:["Expression not supported: ",Ft.type]})}}return(0,t.jsxs)(me,{refId:Et,headerItems:[(0,t.jsx)(o.E,{color:"secondary",children:(0,i.startCase)(Ft.type)},"expression-type")],isAlertCondition:ln,children:[qt(),(0,t.jsx)(re.h,{}),Gt&&(0,t.jsx)(ue.GX,{series:Gt.series,isAlertCondition:ln})]})}function me({refId:Et,headerItems:Ft=[],children:Gt,isAlertCondition:ln,exploreLink:qt}){const cn=(0,h.of)(ve);return(0,t.jsxs)("div",{className:(0,n.cx)(cn.container),children:[(0,t.jsxs)("header",{className:cn.header,children:[(0,t.jsx)("span",{className:cn.refId,children:Et}),Ft,(0,t.jsx)(re.h,{}),ln&&(0,t.jsx)(Z.E,{color:"green",icon:"check",text:"Alert condition"}),qt&&(0,t.jsx)(I.d,{component:(0,t.jsx)(f.z9,{size:"md",variant:"secondary",icon:"compass",href:qt,children:"View in Explore"})})]}),Gt]})}const ve=Et=>({container:(0,n.css)({flex:"1 0 25%",border:`1px solid ${Et.colors.border.weak}`,maxWidth:"100%",borderRadius:Et.shape.radius.default,display:"flex",flexDirection:"column"}),header:(0,n.css)({display:"flex",alignItems:"center",gap:Et.spacing(1),padding:Et.spacing(1),backgroundColor:Et.colors.background.secondary}),textBlock:(0,n.css)({border:`1px solid ${Et.colors.border.weak}`,padding:Et.spacing(.5,1),backgroundColor:Et.colors.background.primary,borderRadius:Et.shape.radius.default}),refId:(0,n.css)({color:Et.colors.text.link,padding:Et.spacing(.5,1),border:`1px solid ${Et.colors.border.weak}`,borderRadius:Et.shape.radius.default})});function Se({model:Et}){const Ft=(0,h.of)(Ie),Gt=(0,i.keyBy)(ye.A.reducerTypes,cn=>cn.value),ln=(0,i.keyBy)(ye.A.evalOperators,cn=>cn.value),qt=(0,i.keyBy)(ye.A.evalFunctions,cn=>cn.value);return(0,t.jsx)("div",{className:Ft.container,children:Et.conditions?.map(({query:cn,operator:En,reducer:Sn,evaluator:Tn},Wn)=>{const Nn=gt(Tn);return(0,t.jsxs)(s.Fragment,{children:[(0,t.jsx)("div",{className:Ft.blue,children:Wn===0?"WHEN":!!En?.type&&ln[En?.type]?.text}),(0,t.jsx)("div",{className:Ft.bold,children:Sn?.type&&Gt[Sn.type]?.text}),(0,t.jsx)("div",{className:Ft.blue,children:"OF"}),(0,t.jsx)("div",{className:Ft.bold,children:cn.params[0]}),(0,t.jsx)("div",{className:Ft.blue,children:qt[Tn.type].text}),(0,t.jsx)("div",{className:Ft.bold,children:Nn?`(${Tn.params[0]}; ${Tn.params[1]})`:Tn.params[0]})]},Wn)})})}const Ie=Et=>({container:(0,n.css)({padding:Et.spacing(1),display:"grid",gridTemplateColumns:"repeat(6, max-content)",gap:Et.spacing(0,1)}),...nt(Et)});function Oe({model:Et}){const Ft=(0,h.of)(Re),{reducer:Gt,expression:ln,settings:qt}=Et,cn=ce.Cu.find(Tn=>Tn.value===Gt),En=qt?.mode??ce.Mt.Strict,Sn=ce.HZ.find(Tn=>Tn.value===En);return(0,t.jsxs)("div",{className:Ft.container,children:[(0,t.jsx)("div",{className:Ft.label,children:"Function"}),(0,t.jsx)("div",{className:Ft.value,children:cn?.label}),(0,t.jsx)("div",{className:Ft.label,children:"Input"}),(0,t.jsx)("div",{className:Ft.value,children:ln}),(0,t.jsx)("div",{className:Ft.label,children:"Mode"}),(0,t.jsx)("div",{className:Ft.value,children:Sn?.label})]})}const Re=Et=>({container:(0,n.css)({padding:Et.spacing(1),display:"grid",gap:Et.spacing(.5),gridTemplateRows:"1fr 1fr",gridTemplateColumns:"repeat(4, 1fr)","> :nth-child(6)":{gridColumn:"span 3"}}),...nt(Et)});function he({model:Et}){const Ft=(0,h.of)(Ce),{expression:Gt,window:ln,downsampler:qt,upsampler:cn}=Et,En=ce.PN.find(Tn=>Tn.value===qt),Sn=ce.iX.find(Tn=>Tn.value===cn);return(0,t.jsxs)("div",{className:Ft.container,children:[(0,t.jsx)("div",{className:Ft.label,children:"Input"}),(0,t.jsx)("div",{className:Ft.value,children:Gt}),(0,t.jsx)("div",{className:Ft.label,children:"Resample to"}),(0,t.jsx)("div",{className:Ft.value,children:ln}),(0,t.jsx)("div",{className:Ft.label,children:"Downsample"}),(0,t.jsx)("div",{className:Ft.value,children:En?.label}),(0,t.jsx)("div",{className:Ft.label,children:"Upsample"}),(0,t.jsx)("div",{className:Ft.value,children:Sn?.label})]})}const Ce=Et=>({container:(0,n.css)({padding:Et.spacing(1),display:"grid",gap:Et.spacing(.5),gridTemplateColumns:"repeat(4, 1fr)",gridTemplateRows:"1fr 1fr"}),...nt(Et)});function We({model:Et}){const Ft=(0,h.of)(et),{expression:Gt,conditions:ln}=Et,qt=ln&&ln[0]?.evaluator,cn=ce.zd.find(Nn=>Nn.value===qt?.type),En=qt?gt(qt):!1,Sn=ln&&ln[0]?.unloadEvaluator,Tn=ce.zd.find(Nn=>Nn.value===Sn?.type),Wn=Sn?gt(Sn):!1;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:Ft.container,children:[(0,t.jsx)("div",{className:Ft.label,children:"Input"}),(0,t.jsx)("div",{className:Ft.value,children:Gt}),qt&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:Ft.blue,children:cn?.label}),(0,t.jsx)("div",{className:Ft.bold,children:En?`(${qt.params[0]}; ${qt.params[1]})`:qt.params[0]})]})]}),(0,t.jsx)("div",{className:Ft.container,children:Sn&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:Ft.label,children:"Stop alerting when "}),(0,t.jsx)("div",{className:Ft.value,children:Gt}),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:Ft.blue,children:Tn?.label}),(0,t.jsx)("div",{className:Ft.bold,children:Wn?`(${Sn.params[0]}; ${Sn.params[1]})`:Sn.params[0]})]})]})})]})}const et=Et=>{const{blue:Ft,bold:Gt,...ln}=nt(Et);return{...ln,maxWidthContainer:(0,n.css)({maxWidth:"100%"}),container:(0,n.css)({padding:Et.spacing(1),display:"flex",gap:Et.spacing(.5)}),blue:(0,n.css)(Ft,{margin:"auto 0"}),bold:(0,n.css)(Gt,{margin:"auto 0"})}};function rt({model:Et}){const Ft=(0,h.of)(et),{expression:Gt}=Et;return(0,t.jsxs)("div",{className:Ft.container,children:[(0,t.jsx)("div",{className:Ft.label,children:"Input"}),(0,t.jsx)("div",{className:Ft.value,children:Gt})]})}const nt=Et=>({blue:(0,n.css)({color:Et.colors.text.link}),bold:(0,n.css)({fontWeight:Et.typography.fontWeightBold}),label:(0,n.css)({display:"flex",alignItems:"center",padding:Et.spacing(.5,1),backgroundColor:Et.colors.background.secondary,fontSize:Et.typography.bodySmall.fontSize,lineHeight:Et.typography.bodySmall.lineHeight,fontWeight:Et.typography.fontWeightBold,borderRadius:Et.shape.radius.default}),value:(0,n.css)({padding:Et.spacing(.5,1),border:`1px solid ${Et.colors.border.weak}`,borderRadius:Et.shape.radius.default})});function gt(Et){return Et.type===ye.p.IsWithinRange||Et.type===ye.p.IsOutsideRange}var xt=e(36135),St=e(28318),zt=e(1932),Nt=e(25968);function Vt(Et){if(!Et)return[];const{namespace:Ft,rulerRule:Gt}=Et,{rulesSource:ln}=Ft;if((0,x.lT)(Gt)){const qt=Gt.grafana_alert.data;return en(qt,Gt.for??"",Et.group.interval)}if((0,Ye.Eb)(ln)){const qt=ct(ln,Et);return[Je(qt,ln.uid)]}return[]}function en(Et,Ft,Gt){const ln=(0,Nt.P8)(Ft)??(0,Nt.P8)(Gt??"1m"),qt=Math.floor(ln/1e3);return Et.map(cn=>(0,zt.jM)(cn,En=>{const Sn=En.relativeTimeRange?.from??0,Tn=Math.max(qt*3,Sn+qt*2);En.relativeTimeRange={from:Tn,to:0}}))}function Je(Et,Ft){return{refId:Et.refId,datasourceUid:Ft,queryType:"",model:Et,relativeTimeRange:{from:360,to:0}}}function ct(Et,Ft){const Gt="A";switch(Et.type){case"prometheus":return{refId:Gt,expr:Ft.query};case"loki":return{refId:Gt,expr:Ft.query};default:throw new Error(`Query for datasource type ${Et.type} is currently not supported by cloud alert rules.`)}}const ot=({rule:Et})=>{const Ft=(0,s.useMemo)(()=>new St.t,[]),Gt=(0,ne.A)(Ft.get()),ln=Qe(Gt),qt=(0,s.useMemo)(()=>Vt(Et),[Et]),{allDataSourcesAvailable:cn}=(0,xt.g)(qt),En=(0,s.useCallback)(()=>{if(qt.length>0&&cn){let Tn;Et&&(0,x.lT)(Et.rulerRule)&&(Tn=Et.rulerRule.grafana_alert.condition),Ft.run(qt,Tn??"A")}},[qt,cn,Et,Ft]);(0,s.useEffect)(()=>{cn&&En()},[cn,En]),(0,s.useEffect)(()=>()=>Ft.destroy(),[Ft]);const Sn=(0,x.YN)(Et.group);return(0,t.jsx)(t.Fragment,{children:ln?"Loading...":(0,t.jsxs)(t.Fragment,{children:[(0,x.lT)(Et.rulerRule)&&!Sn&&(0,t.jsx)(vt,{rule:Et,condition:Et.rulerRule.grafana_alert.condition,queries:qt,evalDataByQuery:Gt}),!(0,x.lT)(Et.rulerRule)&&!Sn&&Gt&&Object.keys(Gt).length>0&&(0,t.jsx)(r.B,{direction:"column",gap:1,children:qt.map(Tn=>(0,t.jsx)(yt,{rule:Et,refId:Tn.refId,model:Tn.model,dataSource:Object.values(H.$.datasources).find(Wn=>Wn.uid===Tn.datasourceUid),queryData:Gt[Tn.refId],relativeTimeRange:Tn.relativeTimeRange},Tn.refId))}),!Sn&&!cn&&(0,t.jsx)(g.F,{title:"Query not available",severity:"warning",children:"Cannot display the query preview. Some of the data sources used in the queries are not available."})]})})};function Qe(Et){return Et?!!Object.values(Et).find(Ft=>Ft.state===le.Gu.Loading):!0}const pt=()=>(0,t.jsx)(t.Fragment,{children:"Routing"});var Pt=(Et=>(Et.Query="query",Et.Instances="instances",Et.History="history",Et.Routing="routing",Et.Details="details",Et))(Pt||{});const At=()=>{const{rule:Et}=(0,N.k)(),{pageNav:Ft,activeTab:Gt}=an(Et),[ln,qt]=(0,s.useState)(),{annotations:cn,promRule:En}=Et,Sn=Rn(Et.promRule?.health),Tn=(0,x.Z8)(En),Wn=(0,x.YN)(Et.group),Nn=(0,x.lT)(Et.rulerRule)&&!!Et.rulerRule.grafana_alert.provenance,Tt=(0,x.lT)(Et.rulerRule)&&(0,x.HH)(Et.rulerRule),Wt=Sn&&!Tt,jt=(0,x.uo)(Et),ut=cn[D.YH.summary];return(0,t.jsxs)(M.d,{pageNav:Ft,navId:"alert-list",isLoading:!1,renderTitle:Zt=>(0,t.jsx)(fn,{name:Zt,paused:Tt,state:Tn?En.state:void 0,health:Et.promRule?.health,ruleType:Et.promRule?.type,ruleOrigin:jt}),actions:(0,t.jsx)(m.l,{rule:Et,showCopyLinkButton:!0,rulesSource:Et.namespace.rulesSource}),info:mn(Et),subTitle:(0,t.jsxs)(r.B,{direction:"column",children:[Tt&&(0,t.jsx)(p.A,{}),ut,Wn&&(0,t.jsx)(S,{}),Nn&&(0,t.jsx)(O.Yi,{resource:O.hk.AlertRule,bottomSpacing:0,topSpacing:2}),Wt&&(0,t.jsx)(g.F,{title:"Something went wrong when evaluating this alert rule",bottomSpacing:0,topSpacing:2,children:(0,t.jsx)("pre",{style:{marginBottom:0},children:(0,t.jsx)("code",{children:Et.promRule?.lastError??"No error message"})})})]}),children:[(0,t.jsx)(r.B,{direction:"column",gap:2,children:(0,t.jsxs)(a.J,{children:[Gt==="query"&&(0,t.jsx)(ot,{rule:Et}),Gt==="instances"&&(0,t.jsx)(te,{rule:Et}),Gt==="history"&&(0,x.lT)(Et.rulerRule)&&(0,t.jsx)(q,{rule:Et.rulerRule}),Gt==="routing"&&(0,t.jsx)(pt,{}),Gt==="details"&&(0,t.jsx)(V.B,{rule:Et})]})}),ln&&(0,t.jsx)(C.Z,{redirectTo:!0,identifier:ln,isProvisioned:Nn,onDismiss:()=>qt(void 0)})]})},mn=Et=>{const{labels:Ft,annotations:Gt,group:ln}=Et,qt=[],cn=Gt[D.YH.runbookURL],En=Gt[D.YH.dashboardUID],Sn=Gt[D.YH.panelID],Tn=En&&Sn,Wn=En,Nn=!(0,i.isEmpty)(Ft),Tt=ln.interval;if(cn){const Wt=(0,i.truncate)(cn,{length:42}),jt=xn(cn)?(0,t.jsx)(c.Y,{variant:"bodySmall",href:cn,external:!0,children:Wt}):(0,t.jsx)(o.E,{variant:"bodySmall",children:Wt});qt.push({label:"Runbook URL",value:jt})}if(Tn?qt.push({label:"Dashboard and panel",value:(0,t.jsx)(I.d,{title:Et.name,component:(0,t.jsx)(c.Y,{variant:"bodySmall",href:(0,E.D2)(En,Sn),children:"View panel"})})}):Wn&&qt.push({label:"Dashboard",value:(0,t.jsx)(I.d,{title:Et.name,component:(0,t.jsx)(c.Y,{title:Et.name,variant:"bodySmall",href:(0,E.JM)(En),children:"View dashboard"})})}),(0,x.Gy)(Et.rulerRule)){const Wt=Et.rulerRule?.grafana_alert.record?.metric??"";qt.push({label:"Metric name",value:(0,t.jsx)(o.E,{color:"primary",children:Wt})})}return Tt&&qt.push({label:"Evaluation interval",value:(0,t.jsxs)(o.E,{color:"primary",children:["Every ",Tt]})}),Nn&&qt.push({label:"Labels",value:(0,t.jsx)(b.m,{labels:Ft,size:"sm"})}),qt},Pn=Et=>{const Ft=new URLSearchParams([["search",Et.map(([Gt,ln])=>`${Gt}:"${ln}"`).join(" ")]]);return(0,P.G)("/alerting/list",Ft)},fn=({name:Et,paused:Ft=!1,state:Gt,health:ln,ruleType:qt,ruleOrigin:cn})=>{const En=(0,h.of)(Cn),[Sn]=(0,d.s)(),Tn=qt===l.JS.Recording,Wn=Sn.returnTo?String(Sn.returnTo):"/alerting/list";return(0,t.jsxs)("div",{className:En.title,children:[(0,t.jsx)(f.z9,{variant:"secondary",icon:"angle-left",href:Wn}),cn&&(0,t.jsx)(u.T,{pluginId:cn.pluginId}),(0,t.jsx)(o.E,{variant:"h1",truncate:!0,children:Et}),Ft?(0,t.jsx)(L,{}):(0,t.jsxs)(t.Fragment,{children:[Gt&&(0,t.jsx)(U,{state:Gt,health:ln}),Tn&&(0,t.jsx)(B,{health:ln})]})]})},Rn=Et=>Et==="error"||Et==="err";function Kn(){const[Et,Ft]=(0,d.s)(),Gt=Et.tab;return[Bt(Gt)?Gt:"query",cn=>{Ft({tab:cn})}]}function Bt(Et){return typeof Et=="string"&&Object.values(Pt).includes(Et)}function an(Et){const[Ft,Gt]=Kn(),{annotations:ln,promRule:qt}=Et,cn=ln[D.YH.summary],En=(0,x.Z8)(qt),Sn=En?tn(Et.instanceTotals):void 0,Tn=(0,T.EL)(Et.namespace).name,Wn=Et.group.name,Nn=(0,x.lT)(Et.rulerRule)&&En,Tt=(0,x.KB)(Et.promRule);return{pageNav:{...y.defaultPageNav,text:Et.name,subTitle:cn,children:[{text:"Query and conditions",active:Ft==="query",onClick:()=>{Gt("query")}},{text:"Instances",active:Ft==="instances",onClick:()=>{Gt("instances")},tabCounter:Sn,hideFromTabs:Tt},{text:"History",active:Ft==="history",onClick:()=>{Gt("history")},hideFromTabs:!Nn},{text:"Details",active:Ft==="details",onClick:()=>{Gt("details")}}],parentItem:{text:Wn,url:Pn([["namespace",Tn],["group",Wn]]),parentItem:{text:Tn,url:Pn([["namespace",Tn]])}}},activeTab:Ft}}const tn=Et=>(0,i.chain)(Et).pick([v.$.Alerting,v.$.Pending,v.$.Normal]).values().sum().value(),Cn=()=>({title:(0,n.css)({display:"flex",alignItems:"center",gap:8,minWidth:0})});function xn(Et){const Ft=Et.startsWith("/");let Gt=!1;try{new URL(Et),Gt=!0}catch{return!1}return Ft||Gt}const Vn=At},50509:(k,R,e)=>{"use strict";e.d(R,{$:()=>v,B:()=>m});var t=e(74848),n=e(32196),i=e(72095),s=e(96540),r=e(40845),g=e(67061),a=e(94753),c=e(10534),o=e(72109),h=e(23662),f=e(55196),d=e(16577),p=(y=>(y.GrafanaManagedAlertRule="Grafana-managed alert rule",y.CloudAlertRule="Cloud alert rule",y.CloudRecordingRule="Cloud recording rule",y))(p||{});const m=({rule:y})=>{const u=(0,r.of)(l);let D;(0,h.lT)(y.rulerRule)?D="Grafana-managed alert rule":(0,h.i7)(y.rulerRule)?D="Cloud recording rule":D="Cloud alert rule";const E=y.promRule?.evaluationTime,x=y.promRule?.lastEvaluation,P=(0,s.useCallback)(()=>(0,h.lT)(y.rulerRule)?y.rulerRule.grafana_alert.uid:"",[y.rulerRule]),b=(0,h.i7)(y.rulerRule)?void 0:y.annotations??[],M=Number.isFinite(E);return(0,t.jsxs)(g.B,{direction:"column",gap:3,children:[(0,t.jsxs)("div",{className:u.metadataWrapper,children:[(0,t.jsxs)(f.P,{direction:"column",children:["Rule type",(0,t.jsx)(a.E,{color:"primary",children:D})]}),(0,t.jsx)(f.P,{direction:"column",children:(0,h.lT)(y.rulerRule)&&(0,t.jsxs)(t.Fragment,{children:["Rule Identifier",(0,t.jsx)(g.B,{direction:"row",alignItems:"center",gap:.5,children:(0,t.jsxs)(a.E,{color:"primary",children:[y.rulerRule.grafana_alert.uid,(0,t.jsx)(c.b,{fill:"text",variant:"secondary",icon:"copy",size:"sm",getText:P})]})})]})}),(0,t.jsx)(f.P,{direction:"column",children:M&&(0,t.jsxs)(t.Fragment,{children:["Last evaluation",x&&E?(0,t.jsxs)("span",{children:[(0,t.jsxs)(a.E,{color:"primary",children:[(0,i.B)(new Date(x))," ago"]}),", took"," ",(0,t.jsxs)(a.E,{color:"primary",children:[E,"ms"]})]}):null]})}),(0,t.jsx)(f.P,{direction:"column",children:!(0,h.i7)(y.rulerRule)&&(0,t.jsxs)(t.Fragment,{children:["Pending period",(0,t.jsx)(a.E,{color:"primary",children:y.rulerRule?.for??"0s"})]})}),(0,h.lT)(y.rulerRule)&&y.rulerRule.grafana_alert.no_data_state&&y.rulerRule.grafana_alert.exec_err_state&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(f.P,{direction:"column",children:["Alert state if no data or all values are null",(0,t.jsx)(a.E,{color:"primary",children:y.rulerRule.grafana_alert.no_data_state})]}),(0,t.jsxs)(f.P,{direction:"column",children:["Alert state if execution error or timeout",(0,t.jsx)(a.E,{color:"primary",children:y.rulerRule.grafana_alert.exec_err_state})]})]})]}),b&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.E,{variant:"h4",children:"Annotations"}),Object.keys(b).length===0?(0,t.jsx)(a.E,{variant:"bodySmall",color:"secondary",italic:!0,children:"No annotations"}):(0,t.jsx)("div",{className:u.metadataWrapper,children:Object.entries(b).map(([O,I])=>(0,t.jsxs)(f.P,{direction:"column",children:[O,(0,t.jsx)(v,{value:I})]},O))})]})]})};function v({value:y}){const u=y&&y.startsWith("http"),D=(0,t.jsx)(d.Y,{input:y,delimiter:["{{","}}"]});return u?(0,t.jsx)(o.Y,{variant:"bodySmall",href:y,external:!0,children:y}):(0,t.jsx)(a.E,{color:"primary",children:D})}const l=y=>({metadataWrapper:(0,n.css)({display:"grid",gridTemplateColumns:"auto auto",rowGap:y.spacing(3),columnGap:y.spacing(12)})})},2426:(k,R,e)=>{"use strict";e.d(R,{D:()=>E});var t=e(74848),n=e(96540),i=e(8249),s=e(47232),r=e(74135),g=e(23662),a=e(69087),c=e(75591),o=e(3197),h=e(83122),f=e(29158),d=e(24401),p=e(30973);const m=({rule:P,instance:b,extensionPointId:M})=>{const[O,I]=(0,n.useState)(),T=(0,n.useMemo)(()=>({instance:b,rule:P}),[b,P]),{extensions:C}=(0,o.vl)({context:T,extensionPointId:M,limitPerPlugin:3});if(C.length===0)return null;const S=(0,t.jsx)(p.w,{extensions:C,onSelect:I});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.m,{placement:"bottom-start",overlay:S,children:(0,t.jsx)(f.K,{name:"ellipsis-v","aria-label":"Actions",variant:"secondary"})}),!!O&&!!O.path&&(0,t.jsx)(d.s,{path:O.path,title:O.title,onDismiss:()=>I(void 0)})]})};var v=e(33225),l=e(71223),y=e(84396);const u=({instance:P})=>{const b=(0,v.Hx)(P.annotations),M=(0,v.gO)(b);return(0,t.jsxs)("div",{children:[P.value&&(0,t.jsx)(y.X,{label:"Value",horizontal:!0,children:P.value}),b.map(([O,I])=>(0,t.jsx)(l.s,{annotationKey:O,value:I,valueLink:M.get(O)},O))]})};var D=e(30423);const E=({rule:P,instances:b,pagination:M,footerRow:O})=>{const I=(0,n.useMemo)(()=>b.length>1?(0,i.yO)(b.map(C=>C.labels)):{},[b]),T=(0,n.useMemo)(()=>b.map(C=>({data:{rule:P,alert:{...C,commonLabels:I}},id:(0,g.RI)(C)})),[I,b,P]);return(0,t.jsx)(c.E,{cols:x,isExpandable:!0,items:T,renderExpandedContent:({data:C})=>(0,t.jsx)(u,{instance:C.alert}),pagination:M,footerRow:O})},x=[{id:"state",label:"State",renderCell:({data:{alert:{state:P}}})=>(0,t.jsx)(D.C,{state:P}),size:"80px"},{id:"labels",label:"Labels",renderCell:({data:{alert:{labels:P,commonLabels:b}}})=>(0,t.jsx)(a.m,{labels:P,commonLabels:b,size:"sm"})},{id:"created",label:"Created",renderCell:({data:{alert:{activeAt:P}}})=>(0,t.jsx)(t.Fragment,{children:P.startsWith("0001")?"-":(0,s.KQ)(P).format("YYYY-MM-DD HH:mm:ss")}),size:"150px"},{id:"actions",label:"",renderCell:({data:{alert:P,rule:b}})=>(0,t.jsx)(m,{rule:b,instance:P,extensionPointId:r.S.AlertInstanceAction},"alert-instance-extension-point"),size:"40px"}]},30423:(k,R,e)=>{"use strict";e.d(R,{C:()=>a});var t=e(74848),n=e(96540),i=e(56034),s=e(14578),r=e(23662),g=e(65415);const a=(0,n.memo)(({state:c,isPaused:o=!1,size:h="md",muted:f=!1})=>o?(0,t.jsx)(i.m,{content:"Alert evaluation is currently paused",placement:"top",children:(0,t.jsxs)(g.O,{state:"warning",size:h,muted:f,children:[(0,t.jsx)(s.I,{name:"pause",size:"xs"})," Paused"]})}):(0,t.jsx)(g.O,{state:(0,r.Wy)(c),size:h,muted:f,children:(0,r.XI)(c)}));a.displayName="AlertStateTag"},51921:(k,R,e)=>{"use strict";e.d(R,{Z:()=>a});var t=e(74848),n=e(96540),i=e(24180),s=e(96374),r=e(55852),g=e(18461);function a({identifier:o,isProvisioned:h,redirectTo:f=!1,onDismiss:d}){const p=(0,i.zy)(),[m,v]=(0,n.useState)(h?"confirm":"redirect");if(m==="redirect"){const l=g.$9(o),y=p.pathname+p.search,u=new URLSearchParams({copyFrom:l,returnTo:f?y:""});return(0,t.jsx)(i.rd,{to:"/alerting/new?"+u.toString(),push:!0})}return(0,t.jsx)(s.u,{isOpen:m==="confirm",title:"Copy provisioned alert rule",body:(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{children:["The new rule will ",(0,t.jsx)("strong",{children:"not"})," be marked as a provisioned rule."]}),(0,t.jsx)("p",{children:"You will need to set a new evaluation group for the copied rule because the original one has been provisioned and cannot be used for rules created in the UI."})]}),confirmText:"Copy",onConfirm:()=>v("redirect"),onDismiss:d})}const c=(0,n.forwardRef)(({text:o,ruleIdentifier:h,isProvisioned:f,className:d},p)=>{const[m,v]=(0,n.useState)(!1);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.$n,{title:"Copy",className:d,size:"sm",variant:"secondary",icon:"copy",onClick:()=>v(!0),ref:p,children:o},"clone"),m&&(0,t.jsx)(a,{identifier:h,isProvisioned:f,onDismiss:()=>v(!1)})]})});c.displayName="CloneRuleButton"},35896:(k,R,e)=>{"use strict";e.d(R,{l:()=>ge});var t=e(74848),n=e(32196),i=e(96540),s=e(24180),r=e(40845),g=e(55852),a=e(67061),c=e(26272),o=e(38138),h=e(83122),f=e(28138),d=e(3169),p=e(23662),m=e(72635),v=e(79938),l=e(48070),y=e(6833),u=e(43482);function D(){const[Le]=(0,u.D)(),[Ye]=v.hK.endpoints.upsertRuleGroupForNamespace.useMutation();return(0,y.Yb)(async(je,Ze,Ne)=>{const{namespaceName:Pe}=je,Ue=(0,l.LH)({uid:Ze,pause:Ne}),{newRuleGroupDefinition:$e,rulerConfig:ze}=await Le(je,Ue),qe=(0,m.t)("alerting.rules.pause-rule.success","Rule evaluation paused"),dt=(0,m.t)("alerting.rules.resume-rule.success","Rule evaluation resumed");return Ye({rulerConfig:ze,namespace:Pe,payload:$e,requestOptions:{successMessage:Ne?qe:dt}}).unwrap()})}var E=e(56361);const P=({rule:Le,onPauseChange:Ye})=>{const je=(0,d._2)(),[Ze,Ne]=D(),Pe=(0,p.lT)(Le.rulerRule)&&(0,p.HH)(Le.rulerRule),Ue=Pe?"play":"pause",$e=Pe?"Resume evaluation":"Pause evaluation",ze=async qe=>{if((0,p.lT)(Le.rulerRule)){try{const dt=(0,p.Uw)(Le),vt=Le.rulerRule.grafana_alert.uid;await Ze.execute(dt,vt,qe)}catch(dt){je.error(`Failed to ${qe?"pause":"resume"} the rule: ${(0,E.JZ)(dt)}`);return}Ye?.()}};return(0,t.jsx)(o.W.Item,{label:$e,icon:Ue,disabled:(0,y.VP)(Ne),onClick:()=>{ze(!Pe)}})};var b=e(90141),M=e(74135),O=e(3197),I=e(94822);function T(Le){const Ye=C(Le),{extensions:je}=(0,O.vl)(Ye),Ze=(0,p.uo)(Le),Ne=Le.promRule?.type;if(!Ze||!Ne)return[];const{pluginId:Pe}=Ze;return je.filter(Ue=>Ue.pluginId===Pe)}function C(Le){return(0,i.useMemo)(()=>{switch(Le.promRule?.type){case I.JS.Alerting:return{extensionPointId:M.S.AlertingAlertingRuleAction,context:{name:Le.name,namespace:Le.namespace.name,group:Le.group.name,expression:Le.query,labels:Le.labels,annotations:Le.annotations}};case I.JS.Recording:return{extensionPointId:M.S.AlertingRecordingRuleAction,context:{name:Le.name,namespace:Le.namespace.name,group:Le.group.name,expression:Le.query,labels:Le.labels}};default:return{extensionPointId:""}}},[Le])}var S=e(19073),A=e(18461),L=e(3704),N=e(56034),F=e(12210),w=e(99494),B=e(76156);const U=({title:Le="",severity:Ye="",url:je=""})=>{const Ze=createBridgeURL(SupportedPlugin.Incident,"/incidents/declare",{title:Le,severity:Ye,url:je}),{loading:Ne,installed:Pe,settings:Ue}=usePluginBridge(SupportedPlugin.Incident);return jsxs(Fragment,{children:[Ne===!0&&jsx(Button,{icon:"fire",size:"sm",type:"button",disabled:!0,children:"Declare Incident"}),Pe===!1&&jsx(Tooltip,{content:"Grafana Incident is not installed or is not configured correctly",children:jsx(Button,{icon:"fire",size:"sm",type:"button",disabled:!0,children:"Declare Incident"})}),Ue&&jsx(LinkButton,{icon:"fire",size:"sm",type:"button",href:Ze,children:"Declare Incident"})]})},K=({title:Le="",severity:Ye="",url:je=""})=>{const Ze=(0,B.h)(w.W.Incident,"/incidents/declare",{title:Le,severity:Ye,url:je}),{loading:Ne,installed:Pe,settings:Ue}=(0,F._)(w.W.Incident);return(0,t.jsxs)(t.Fragment,{children:[Ne===!0&&(0,t.jsx)(o.W.Item,{label:"Declare incident",icon:"fire",disabled:!0}),Pe===!1&&(0,t.jsx)(N.m,{content:"Grafana Incident is not installed or is not configured correctly",children:(0,t.jsx)(o.W.Item,{label:"Declare incident",icon:"fire",disabled:!0})}),Ue&&(0,t.jsx)(o.W.Item,{label:"Declare incident",url:Ze,icon:"fire"})]})},V=({rule:Le,identifier:Ye,showCopyLinkButton:je,handleSilence:Ze,handleDelete:Ne,handleDuplicateRule:Pe,onPauseChange:Ue,buttonSize:$e})=>{const[ze,qe]=(0,S.mh)(Le,S.j5.Pause),dt=ze&&qe,[vt,yt]=(0,S.mh)(Le,S.j5.Delete),st=vt&&yt,[Ve,pe]=(0,S.mh)(Le,S.j5.Duplicate),Ee=Ve&&pe,[me,ve]=(0,S.mh)(Le,S.j5.Silence),Se=me&&ve,[Ie,Oe]=(0,S.mh)(Le,S.j5.ModifyExport),Re=Ie&&Oe,he=T(Le),Ce=he.length>0,We=(!(0,E.y$)()||(0,E.ES)())&&(0,p.Z8)(Le.promRule)&&Le.promRule.state===I.cF.Firing,et=(0,E.S2)(Le.namespace.rulesSource,Le),rt=[dt,Se,We,Ee].some(Boolean)&&[je,Re].some(Boolean),nt=(0,t.jsxs)(t.Fragment,{children:[dt&&(0,t.jsx)(P,{rule:Le,onPauseChange:Ue}),Se&&(0,t.jsx)(o.W.Item,{label:"Silence notifications",icon:"bell-slash",onClick:Ze}),We&&(0,t.jsx)(K,{title:Le.name,url:""}),Ee&&(0,t.jsx)(o.W.Item,{label:"Duplicate",icon:"copy",onClick:()=>Pe(Ye)}),rt&&(0,t.jsx)(o.W.Divider,{}),et&&(0,t.jsx)(o.W.Item,{label:"Copy link",icon:"share-alt",onClick:()=>H(et)}),Re&&(0,t.jsx)(o.W.Item,{label:"Export",icon:"download-alt",childItems:[(0,t.jsx)(Y,{identifier:Ye},"export-with-modifications")]}),Ce&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.W.Divider,{}),he.map(gt=>(0,t.jsx)(o.W.Item,{label:gt.title,icon:gt.icon,onClick:gt.onClick},gt.id))]}),st&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.W.Divider,{}),(0,t.jsx)(o.W.Item,{label:"Delete",icon:"trash-alt",destructive:!0,onClick:()=>Ne(Le)})]})]});return(0,t.jsx)(h.m,{overlay:(0,t.jsx)(o.W,{children:nt}),children:(0,t.jsx)(b.A,{size:$e})})};function H(Le){navigator.clipboard?.writeText(Le).then(()=>{f.A.emit(c.r1.alertSuccess,["URL copied to clipboard"])})}const Y=({identifier:Le})=>{const Ye=location.pathname+location.search,je=(0,L.G)(`/alerting/${encodeURIComponent(A.$9(Le))}/modify-export`,{returnTo:Ye});return(0,t.jsx)(o.W.Item,{label:"With modifications",icon:"file-edit-alt",url:je},"with-modifications")},X=V;var J=e(39601),q=e(96374),ae=e(99140),j=e(96065),te=e(23770);const ne=(Le=!1)=>{const[Ye,je]=(0,i.useState)(),[Ze]=(0,j.Y)(),Ne=(0,i.useCallback)(()=>{je(void 0)},[]),Pe=(0,i.useCallback)(ze=>{je(ze)},[]),Ue=(0,i.useCallback)(async ze=>{if(!ze?.rulerRule)return;const qe=(0,p.Uw)(ze);await Ze.execute(qe,ze.rulerRule),(0,ae.JD)((0,te.Lc)({rulesSourceName:qe.dataSourceName})),Ne(),Le&&J.Ny.replace("/alerting/list")},[Ze,Ne,Le]);return[(0,i.useMemo)(()=>(0,t.jsx)(q.u,{isOpen:!!Ye,title:"Delete rule",body:"Deleting this rule will permanently remove it from your alert rule list. Are you sure you want to delete this rule?",confirmText:"Yes, delete",icon:"exclamation-triangle",onConfirm:()=>Ue(Ye),onDismiss:Ne}),[Ue,Ne,Ye]),Pe,Ne]};var le=e(75648),z=e(87978),ee=e(98569),se=e(17272),ie=e(57220);const oe=({rulerRule:Le,onClose:Ye})=>{const{uid:je}=Le.grafana_alert,Ze=(0,se.Di)();return(0,t.jsx)(z._,{title:"Silence alert rule",subtitle:"Configure silences to stop notifications from a particular alert rule.",onClose:Ye,size:"md",children:(0,t.jsx)(a.B,{direction:"column",children:(0,t.jsx)(ee.G,{ruleUid:je,formValues:Ze,alertManagerSourceName:ie.hY,onSilenceCreated:Ye,onCancel:Ye})})})};var ce=e(14285),ye=e(70383),re=e(31678),ue=e(51921);const De=Le=>window.matchMedia(`(max-width: ${Le}px)`).matches,ge=({compact:Le,showViewButton:Ye,showCopyLinkButton:je,rule:Ze,rulesSource:Ne})=>{const Pe=(0,re.useDispatch)(),Ue=(0,s.zy)(),$e=(0,r.of)(Te),ze=!Le,[qe,dt]=ne(ze),[vt,yt]=(0,i.useState)(!1),[st,Ve]=(0,i.useState)(void 0),{namespace:pe,group:Ee,rulerRule:me}=Ze,{hasActiveFilters:ve}=(0,ce.dI)(),Se=Ue.pathname+Ue.search,Ie=(0,p.lT)(Ze.rulerRule)&&!!Ze.rulerRule.grafana_alert.provenance,[Oe,Re]=(0,S.mh)(Ze,S.j5.Update),he=Oe&&Re,Ce=[],We=(0,n.cx)({[$e.compactButton]:Le}),et=Le?"sm":"md",rt=(0,ie.EV)(Ne),nt=A.UP(rt,Ze);if(Ye&&Ce.push((0,t.jsx)(g.z9,{tooltip:Le?"View":void 0,tooltipPlacement:"top",className:We,title:"View",size:et,variant:"secondary",icon:"eye",href:(0,E.w$)(Ne,Ze,Se),children:!Le&&"View"},"view")),me&&he){const gt=A.P1(rt,pe.name,Ee.name,me),xt=(0,L.G)(`/alerting/${encodeURIComponent(A.$9(gt))}/edit`,{returnTo:Se});Ce.push((0,t.jsx)(g.z9,{tooltip:Le?"Edit":void 0,tooltipPlacement:"top",title:"Edit",className:We,size:et,variant:"secondary",icon:"pen",href:xt,children:!Le&&"Edit"},"edit"))}return(0,t.jsxs)(a.B,{gap:1,children:[Ce,(0,t.jsx)(X,{buttonSize:et,rule:Ze,identifier:nt,showCopyLinkButton:je,handleDelete:()=>dt(Ze),handleSilence:()=>yt(!0),handleDuplicateRule:()=>Ve({identifier:nt,isProvisioned:Ie}),onPauseChange:()=>{const gt=ve?void 0:le.Ys+1;Pe((0,te.Lc)({rulesSourceName:ie.hY,limitAlerts:gt}))}}),qe,(0,p.pv)(Ze.rulerRule)&&vt&&(0,t.jsx)(ye.b9,{accessType:"instance",children:(0,t.jsx)(oe,{rulerRule:Ze.rulerRule,onClose:()=>yt(!1)})}),st?.identifier&&(0,t.jsx)(ue.Z,{identifier:st.identifier,isProvisioned:st.isProvisioned,onDismiss:()=>Ve(void 0)})]})},Te=Le=>({compactButton:(0,n.css)({padding:`0 ${Le.spacing(2)}`})})},75648:(k,R,e)=>{"use strict";e.d(R,{Ys:()=>j,DI:()=>te});var t=e(74848),n=e(32196),i=e(72724),s=e(47232),r=e(40845),g=e(56034),a=e(97814),c=e(33225),o=e(23662),h=e(25968),f=e(69087),d=e(84396),p=e(71223);function m(z){const ee=(0,r.of)(v),{annotations:se}=z,ie=(0,c.gO)(se);return se.length===0?null:(0,t.jsx)("div",{className:ee.annotations,children:se.map(([Z,oe])=>(0,t.jsx)(p.s,{annotationKey:Z,value:oe,valueLink:ie.get(Z)},Z))})}const v=()=>({annotations:(0,n.css)({marginTop:"46px"})});var l=e(96540),y=e(80997),u=e(14778),D=e(55852),E=e(67061),x=e(19073),P=e(46013),b=e(55740),M=e(57220),O=e(56361);const T=({rule:z,rulesSource:ee})=>{const{group:se}=z,{StateHistoryModal:ie,showStateHistoryModal:Z}=(0,P.G)(),oe=(0,u.i)(),[ce,ye]=(0,x.mh)(z,x.j5.Explore),re=[],ue=(0,o.YN)(se);if((0,M.Eb)(ee)&&ce&&ye&&!ue&&re.push((0,t.jsx)(D.z9,{size:"sm",variant:"primary",icon:"chart-line",target:"_blank",href:(0,O.Yp)(ee,z.query),children:"See graph"},"explore")),z.annotations[b.YH.runbookURL]&&re.push((0,t.jsx)(D.z9,{size:"sm",variant:"primary",icon:"book",target:"_blank",href:y.sQ.sanitizeUrl(z.annotations[b.YH.runbookURL]),children:"View runbook"},"runbook")),z.annotations[b.YH.dashboardUID]){const De=z.annotations[b.YH.dashboardUID];if(De){re.push((0,t.jsx)(D.z9,{size:"sm",variant:"primary",icon:"apps",href:`d/${encodeURIComponent(De)}`,onClick:()=>{oe(z.name)},children:"Go to dashboard"},"dashboard"));const ge=z.annotations[b.YH.panelID];ge&&re.push((0,t.jsx)(D.z9,{size:"sm",variant:"primary",icon:"apps",href:`d/${encodeURIComponent(De)}?viewPanel=${encodeURIComponent(ge)}`,onClick:()=>{oe(z.name)},children:"Go to panel"},"panel"))}}return(0,o.pv)(z.rulerRule)&&re.push((0,t.jsxs)(l.Fragment,{children:[(0,t.jsx)(D.$n,{size:"sm",icon:"history",onClick:()=>(0,o.lT)(z.rulerRule)&&Z(z.rulerRule),children:"Show state history"}),ie]},"history")),re.length?(0,t.jsx)(E.B,{children:re}):null};var C=e(19347),S=e(66718);function A(z){const{rulesSource:ee,rule:se}=z,ie=(0,r.of)(L),Z=(0,l.useMemo)(()=>{if((0,M.Eb)(ee))return[{name:ee.name,icon:ee.meta.info.logos.small}];if((0,o.lT)(se.rulerRule)){const{data:oe}=se.rulerRule.grafana_alert,ce=oe.reduce((ye,re)=>{const ue=(0,C.l)().getInstanceSettings(re.datasourceUid);return!ue||ue.uid===S.Uj||(ye[ue.name]={name:ue.name,icon:ue.meta.info.logos.small}),ye},{});return Object.values(ce)}return[]},[se,ee]);return Z.length===0?null:(0,t.jsx)(d.X,{label:"Data source",children:Z.map(({name:oe,icon:ce},ye)=>(0,t.jsxs)("div",{children:[ce&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("img",{alt:`${oe} datasource logo`,className:ie.dataSourceIcon,src:ce})," "]}),oe]},oe))})}function L(z){const ee=z.spacing(2);return{dataSourceIcon:(0,n.css)({width:ee,height:ee})}}var N=e(28848),F=e(29317),w=e(20719),B=e(41781),U=e(72307),K=e(71713),V=e(73750);const H=({language:z,expr:ee})=>{const se=(0,l.useMemo)(()=>[(0,B.D)({onlyIn:Z=>"type"in Z&&Z.type==="code_block",getSyntax:()=>z},{...N.languages,[z]:z==="logql"?K.Ay:w.n6})],[z]),ie=(0,l.useMemo)(()=>(0,U.mO)(ee),[ee]);return(0,t.jsx)(F.KE,{"data-testid":"expression-editor",plugins:se,value:ie})},Y=({expression:z,rulesSource:ee})=>{const se=(0,r.of)(X);return(0,t.jsx)(V.L,{className:(0,n.cx)(se.well,"slate-query-field"),children:(0,M.Eb)(ee)?(0,t.jsx)(H,{expr:z,language:ee.type===M.ol.Loki?"logql":"promql"}):z})},X=z=>({well:(0,n.css)({fontFamily:z.typography.fontFamilyMonospace})});function J(z){const{annotations:ee,rulesSource:se,rule:ie}=z,Z=q();return(0,M.Eb)(se)?(0,t.jsx)(d.X,{label:"Expression",horizontal:!0,className:(0,n.cx)({[Z.exprRow]:!!ee.length}),children:(0,t.jsx)(Y,{expression:ie.query,rulesSource:se})}):null}const q=()=>({exprRow:(0,n.css)({marginBottom:"46px"})});var ae=e(99938);const j=15,te=({rule:z})=>{const ee=(0,r.of)(le),{namespace:{rulesSource:se}}=z,ie=(0,c.Hx)(z.annotations);return(0,t.jsxs)("div",{children:[(0,t.jsx)(T,{rule:z,rulesSource:se}),(0,t.jsxs)("div",{className:ee.wrapper,children:[(0,t.jsxs)("div",{className:ee.leftSide,children:[(0,t.jsx)(ne,{rule:z}),!!z.labels&&!!Object.keys(z.labels).length&&(0,t.jsx)(d.X,{label:"Labels",horizontal:!0,children:(0,t.jsx)(f.m,{labels:z.labels})}),(0,t.jsx)(J,{rulesSource:se,rule:z,annotations:ie}),(0,t.jsx)(m,{annotations:ie})]}),(0,t.jsx)("div",{className:ee.rightSide,children:(0,t.jsx)(A,{rulesSource:se,rule:z})})]}),(0,t.jsx)(d.X,{label:"Instances",horizontal:!0,children:(0,t.jsx)(ae.s,{rule:z,itemsDisplayLimit:j})})]})},ne=({rule:z})=>{let ee;const se=z.group.interval,ie=z.promRule?.lastEvaluation,Z=z.promRule?.evaluationTime,oe=(0,o.Gy)(z.rulerRule)?z.rulerRule?.grafana_alert.record?.metric:void 0;return(0,o.i7)(z.rulerRule)||(ee=z.rulerRule?.for??"0s"),(0,t.jsxs)(t.Fragment,{children:[oe&&(0,t.jsx)(d.X,{label:"Metric",horizontal:!0,children:oe}),se&&(0,t.jsxs)(d.X,{label:"Evaluate",horizontal:!0,children:["Every ",se]}),(0,t.jsx)(d.X,{label:"Pending period",horizontal:!0,children:ee}),ie&&!(0,h.mo)(ie)&&(0,t.jsx)(d.X,{label:"Last evaluation",horizontal:!0,children:(0,t.jsx)(g.m,{placement:"top",content:`${(0,i.LE)(ie,{format:"YYYY-MM-DD HH:mm:ss"})}`,theme:"info",children:(0,t.jsx)("span",{children:`${(0,s.KQ)(ie).locale("en").fromNow(!0)} ago`})})}),ie&&!(0,h.mo)(ie)&&Z!==void 0&&(0,t.jsx)(d.X,{label:"Evaluation time",horizontal:!0,children:(0,t.jsx)(g.m,{placement:"top",content:`${Z}s`,theme:"info",children:(0,t.jsx)("span",{children:(0,a.g)({timeInMs:Z*1e3,humanize:!0})})})})]})},le=z=>({wrapper:(0,n.css)({display:"flex",flexDirection:"row",[z.breakpoints.down("md")]:{flexDirection:"column"}}),leftSide:(0,n.css)({flex:1}),rightSide:(0,n.css)({[z.breakpoints.up("md")]:{paddingLeft:"90px",width:"300px"}})})},99938:(k,R,e)=>{"use strict";e.d(R,{s:()=>b});var t=e(74848),n=e(32196),i=e(2543),s=e(96540),r=e(40845),g=e(55852),a=e(53876),c=e(78369),o=e(60029),h=e(94354),f=e(94822);const d=({className:I,onStateFilterChange:T,stateFilter:C,filterType:S,itemPerStateStats:A})=>{const L=(0,r.of)(p),N=K=>function(){return A&&A[K]?(0,t.jsx)(c.v,{name:A[K].toFixed(0),colorIndex:9,className:L.tag}):null},F=Object.values(f.Gi).map(K=>({label:K,value:K,component:N(K)})),B=[f.cF.Firing,f.cF.Pending].map(K=>({label:(0,i.capitalize)(K),value:K,component:N(K)})),U=S==="grafana"?F:B;return(0,t.jsxs)("div",{className:I,"data-testid":"alert-instance-state-filter",children:[(0,t.jsx)(o.J,{children:"State"}),(0,t.jsx)(h.z,{options:U,value:C,onChange:T,onClick:K=>{K===C&&T(void 0)}})]})};function p(I){return{tag:(0,n.css)({fontSize:"11px",fontWeight:"normal",padding:I.spacing(.25,.5),verticalAlign:"middle",marginLeft:I.spacing(.5)})}}var m=e(98164),v=e(56361),l=e(64861),y=e(57220),u=e(32642),D=e(23662),E=e(2426),x=e(92467);function P({stats:I,onClick:T,href:C}){const S=(0,r.of)(O);return(0,t.jsxs)("div",{className:S.footerRow,children:[(0,t.jsxs)("div",{children:["Showing ",I.visibleItemsCount," out of ",I.totalItemsCount," instances"]}),(0,t.jsxs)(g.z9,{size:"sm",variant:"secondary","data-testid":"show-all",onClick:T,href:C,children:["Show all ",I.totalItemsCount," alert instances"]})]})}function b(I){const{rule:T,itemsDisplayLimit:C=Number.POSITIVE_INFINITY,pagination:S,enableFiltering:A=!1}=I,{promRule:L,namespace:N,instanceTotals:F}=T,[w,B]=(0,s.useState)(),[U,K]=(0,s.useState)(),[V]=(0,s.useState)(Math.floor(Math.random()*100)),H=`queryString-${V}`,Y=(0,r.of)(O),X=(0,y.z2)(N.rulesSource)?y.hY:"prometheus",J=(0,s.useMemo)(()=>(0,D.Z8)(L)&&L.alerts?.length?M(w,U,(0,v.Cp)(l.xB.Importance,L.alerts)):[],[L,U,w]);if(!(0,D.Z8)(L))return null;const q=J.slice(0,C),ae=(0,i.countBy)(L.alerts,ie=>(0,f.lh)(ie.state)),j=(0,i.sum)([F.alerting,F.inactive,F.pending,F.nodata]),te=j-q.length,ne={totalItemsCount:j,visibleItemsCount:q.length},le=(0,v.w$)(N.rulesSource,I.rule,location.pathname+location.search),z=(0,x.kc)(F),ee=()=>K(void 0),se=te?(0,t.jsx)(P,{stats:ne,onClick:A?ee:void 0,href:A?void 0:le}):void 0;return(0,t.jsxs)(t.Fragment,{children:[A&&(0,t.jsx)("div",{className:(0,n.cx)(Y.flexRow,Y.spaceBetween),children:(0,t.jsxs)("div",{className:Y.flexRow,children:[(0,t.jsx)(a.X,{defaultQueryString:w,onFilterChange:ie=>B(ie)},H),(0,t.jsx)(d,{filterType:X,stateFilter:U,onStateFilterChange:K,itemPerStateStats:ae})]})}),!A&&(0,t.jsx)("div",{className:Y.stats,children:z}),(0,t.jsx)(E.D,{rule:T,instances:q,pagination:S,footerRow:se})]})}function M(I,T,C){let S=[...C];if(I){const A=I?(0,u.Zc)(I):[];S=S.filter(({labels:L})=>(0,m.Av)(L,A))}return T&&(S=S.filter(A=>(0,f.lh)(A.state)===T)),S}const O=I=>({flexRow:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"flex-end",width:"100%",flexWrap:"wrap",marginBottom:I.spacing(1),gap:I.spacing(1)}),spaceBetween:(0,n.css)({justifyContent:"space-between"}),footerRow:(0,n.css)({display:"flex",flexDirection:"column",gap:I.spacing(1),justifyContent:"space-between",alignItems:"center",width:"100%"}),instancesContainer:(0,n.css)({marginBottom:I.spacing(2)}),stats:(0,n.css)({display:"flex",gap:I.spacing(1),padding:I.spacing(1,0)})})},92467:(k,R,e)=>{"use strict";e.d(R,{M_:()=>d,j7:()=>v,kc:()=>l});var t=e(74848),n=e(2543),i=e.n(n),s=e(55127),r=e.n(s),g=e(96540),a=e(67061),c=e(39938),o=e(54317),h=e(94822);const f={recording:0,alerting:0,[h.cF.Pending]:0,[h.cF.Inactive]:0,paused:0,error:0,nodata:0},d=({namespaces:y})=>{const u=p(y),D=m(u),E=l(u),x=!!E.length;return E.unshift((0,t.jsxs)(g.Fragment,{children:[D," ",r()("rule",D)]},"total")),(0,t.jsx)(a.B,{direction:"row",children:x&&(0,t.jsx)("div",{children:(0,t.jsx)(a.B,{gap:.5,children:E})})})};function p(y){const u={...f};return y.forEach(({groups:D})=>{D.forEach(E=>{const x=(0,n.omitBy)(E.totals,n.isUndefined);for(const P in x)u[P]+=x[P]})}),u}function m(y){const u=(0,n.pick)(y,["alerting","pending","inactive","recording"]);return(0,n.sum)(Object.values(u))}const v=({group:y})=>{const u=y.totals,D=y?.interval,E=l(u),x=!!E.length;return(0,t.jsxs)(a.B,{direction:"row",children:[x&&(0,t.jsx)("div",{children:(0,t.jsx)(a.B,{gap:.5,children:E})}),D&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{children:"|"}),(0,t.jsx)(c.E,{text:D,icon:"clock-nine",color:"blue"})]})]})};function l(y){const u=[];return y[o.$.Alerting]&&u.push((0,t.jsx)(c.E,{color:"red",text:`${y[o.$.Alerting]} firing`},"firing")),y.error&&u.push((0,t.jsx)(c.E,{color:"red",text:`${y.error} errors`},"errors")),y.nodata&&u.push((0,t.jsx)(c.E,{color:"blue",text:`${y.nodata} no data`},"nodata")),y[o.$.Pending]&&u.push((0,t.jsx)(c.E,{color:"orange",text:`${y[o.$.Pending]} pending`},"pending")),y[o.$.Normal]&&y.paused&&u.push((0,t.jsx)(c.E,{color:"green",text:`${y[o.$.Normal]} normal (${y.paused} paused)`},"paused")),y[o.$.Normal]&&!y.paused&&u.push((0,t.jsx)(c.E,{color:"green",text:`${y[o.$.Normal]} normal`},"inactive")),y.recording&&u.push((0,t.jsx)(c.E,{color:"purple",text:`${y.recording} recording`},"recording")),u}},80215:(k,R,e)=>{"use strict";e.d(R,{s:()=>U});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(56034),g=e(15054),a=e(83903),c=e(85244),o=e(55740),h=e(23662),f=e(75591),d=e(10562),p=e(48205),m=e(82437),v=e(16577),l=e(13064),y=e(35896),u=e(32264),D=e(14578),E=e(82775);function x({rule:H}){const Y=(0,s.of)(P),X=(0,h.lT)(H.rulerRule);return(0,i.useMemo)(()=>X?(0,E.q)(H.group.interval).exceedsLimit:!1,[H.group.interval,X])?(0,t.jsx)(r.m,{theme:"error",content:(0,t.jsxs)("div",{children:["A minimum evaluation interval of"," ",(0,t.jsx)("span",{className:Y.globalLimitValue,children:u.$.unifiedAlerting.minInterval})," has been configured in Grafana and will be used instead of the ",H.group.interval," interval configured for the Rule Group."]}),children:(0,t.jsx)(D.I,{name:"stopwatch-slash",className:Y.icon})}):null}function P(H){return{globalLimitValue:(0,n.css)({fontWeight:H.typography.fontWeightBold}),icon:(0,n.css)({fill:H.colors.warning.text})}}var b=e(75648),M=e(39890);const O=({rule:H})=>{const Y=(0,s.of)(I);return(0,M.lf)(H.health)?(0,t.jsx)(r.m,{theme:"error",content:H.lastError||"No error message provided.",children:(0,t.jsxs)("div",{className:Y.warn,children:[(0,t.jsx)(D.I,{name:"exclamation-triangle"}),(0,t.jsx)("span",{children:"error"})]})}):(0,t.jsx)(t.Fragment,{children:H.health})},I=H=>({warn:(0,n.css)({display:"inline-flex",flexDirection:"row",alignItems:"center",gap:H.spacing(1),color:H.colors.warning.text})});var T=e(70416),C=e(67061),S=e(62930),A=e(8484),L=e(94822),N=e(65415),F=e(30423);const w=({rule:H,isDeleting:Y,isCreating:X,isPaused:J})=>{const q=(0,s.of)(B),{promRule:ae,rulerRule:j}=H,te=()=>J&&(0,h.Gy)(j)?(0,t.jsx)(r.m,{content:"Recording rule evaluation is currently paused",placement:"top",children:(0,t.jsxs)(N.O,{state:"warning",children:[(0,t.jsx)(D.I,{name:"pause",size:"xs"}),(0,t.jsx)(A.x6,{i18nKey:"alerting.rule-state.paused",children:"Paused"})]})}):(0,t.jsx)(A.x6,{i18nKey:"alerting.rule-state.recording-rule",children:"Recording rule"}),ne=(0,i.useMemo)(()=>{if(ae&&(0,h.Z8)(ae)&&ae.alerts?.length&&ae.state!==L.cF.Inactive){const le=ae.activeAt?new Date(ae.activeAt):(0,h.Om)(ae);if(le)return(0,t.jsxs)("span",{title:String(le),className:q.for,children:["for"," ",(0,T.dU)({start:le,end:new Date},!1)]})}return null},[ae,q]);return Y?(0,t.jsxs)(C.B,{gap:1,children:[(0,t.jsx)(S.y,{}),(0,t.jsx)(A.x6,{i18nKey:"alerting.rule-state.deleting",children:"Deleting"})]}):X?(0,t.jsxs)(C.B,{gap:1,children:[(0,t.jsx)(S.y,{}),(0,t.jsx)(A.x6,{i18nKey:"alerting.rule-state.creating",children:"Creating"})]}):ae&&(0,h.Z8)(ae)?(0,t.jsxs)(C.B,{gap:1,children:[(0,t.jsx)(F.C,{state:ae.state,isPaused:J}),!J&&ne]}):ae&&(0,h.KB)(ae)?(0,t.jsx)(te,{}):(0,t.jsx)(t.Fragment,{children:"n/a"})},B=H=>({for:(0,n.css)({fontSize:H.typography.bodySmall.fontSize,color:H.colors.text.secondary,whiteSpace:"nowrap",paddingTop:"2px"})}),U=({rules:H,className:Y,showGuidelines:X=!1,emptyMessage:J="No rules found.",showGroupColumn:q=!1,showSummaryColumn:ae=!1,showNextEvaluationColumn:j=!1})=>{const te=(0,s.of)(K),ne=(0,n.cx)(te.wrapper,Y,{[te.wrapperMargin]:X}),le=(0,i.useMemo)(()=>H.map((se,ie)=>({id:`${se.namespace.name}-${se.group.name}-${se.name}-${ie}`,data:se})),[H]),z=V(ae,q,j);if(!H.length)return(0,t.jsx)("div",{className:(0,n.cx)(ne,te.emptyMessage),children:J});const ee=X?d.B:f.E;return(0,t.jsx)("div",{className:ne,"data-testid":"rules-table",children:(0,t.jsx)(ee,{cols:z,isExpandable:!0,items:le,renderExpandedContent:({data:se})=>(0,t.jsx)(b.DI,{rule:se}),pagination:{itemsPerPage:g.FG},paginationStyles:te.pagination})})},K=H=>({wrapperMargin:(0,n.css)({[H.breakpoints.up("md")]:{marginLeft:"36px"}}),emptyMessage:(0,n.css)({padding:H.spacing(1)}),wrapper:(0,n.css)({width:"auto",borderRadius:H.shape.radius.default}),pagination:(0,n.css)({display:"flex",margin:0,paddingTop:H.spacing(1),paddingBottom:H.spacing(.25),justifyContent:"center",borderLeft:`1px solid ${H.colors.border.medium}`,borderRight:`1px solid ${H.colors.border.medium}`,borderBottom:`1px solid ${H.colors.border.medium}`})});function V(H,Y,X){const{hasRuler:J,rulerRulesLoaded:q}=(0,a.y)();return(0,i.useMemo)(()=>{const ae=ne=>{const{namespace:le,promRule:z,rulerRule:ee}=ne,{rulesSource:se}=le;return!!(J(se)&&q(se)&&z&&!ee)},j=ne=>{const{namespace:le,promRule:z,rulerRule:ee}=ne,{rulesSource:se}=le;return!!(J(se)&&q(se)&&ee&&!z)},te=[{id:"state",label:"State",renderCell:({data:ne})=>{const le=ae(ne),z=j(ne),ee=(0,h.lT)(ne.rulerRule)&&(0,h.HH)(ne.rulerRule);return(0,t.jsx)(w,{rule:ne,isDeleting:le,isCreating:z,isPaused:ee})},size:"165px"},{id:"name",label:"Name",renderCell:({data:ne})=>ne.name,size:X?4:5},{id:"metadata",label:"",renderCell:({data:ne})=>{const le=ne.rulerRule,z=(0,h.uo)(ne);return z?(0,t.jsx)(c.T,{pluginId:z.pluginId}):(0,h.lT)(le)&&le.grafana_alert.provenance?(0,t.jsx)(p.rS,{}):null},size:"100px"},{id:"warnings",label:"",renderCell:({data:ne})=>(0,t.jsx)(x,{rule:ne}),size:"45px"},{id:"health",label:"Health",renderCell:({data:{promRule:ne,group:le}})=>ne?(0,t.jsx)(O,{rule:ne}):null,size:"75px"}];return H&&te.push({id:"summary",label:"Summary",renderCell:({data:ne})=>(0,t.jsx)(v.Y,{input:ne.annotations[o.YH.summary]??""}),size:X?4:5}),X&&te.push({id:"nextEvaluation",label:"Next evaluation",renderCell:({data:ne})=>{const le=(0,l.C)(ne.promRule?.lastEvaluation,ne.group.interval);return le&&(0,t.jsx)(r.m,{placement:"top",content:`${le?.fullDate}`,theme:"info",children:(0,t.jsx)("span",{children:le?.humanized})})},size:2}),Y&&te.push({id:"group",label:"Group",renderCell:({data:ne})=>{const{namespace:le,group:z}=ne;return z.name==="default"?(0,t.jsx)(m.c,{namespace:le.name}):(0,t.jsx)(m.c,{namespace:le.name,group:z.name})},size:5}),te.push({id:"actions",label:"Actions",renderCell:({data:ne})=>{const le=ae(ne),z=j(ne);return(0,t.jsx)(y.l,{compact:!0,showViewButton:!le&&!z,rule:ne,rulesSource:ne.namespace.rulesSource})},size:"200px"}),te},[H,Y,X,J,q])}},97754:(k,R,e)=>{"use strict";e.d(R,{y:()=>r});var t=e(74848),n=e(60021),i=e(65415);const s={[n.Or.Active]:"bad",[n.Or.Unprocessed]:"neutral",[n.Or.Suppressed]:"info"},r=({state:g})=>(0,t.jsx)(i.O,{state:s[g],children:g})},98569:(k,R,e)=>{"use strict";e.d(R,{G:()=>se,A:()=>Z});var t=e(74848),n=e(32196),i=e(2543),s=e(96540),r=e(49785),g=e(40996),a=e(70416),c=e(47232),o=e(17172),h=e(39601),f=e(32264),d=e(39558),p=e(42418),m=e(40845),v=e(84167),l=e(88575),y=e(10354),u=e(21744),D=e(67061),E=e(55852),x=e(91540),P=e(55740),b=e(57220),M=e(60021),O=e(19073),I=e(98164),T=e(56361),C=e(25994),S=e(90182),A=e(29158),L=e(79938);const N=({className:oe,required:ce,ruleUid:ye})=>{const re=(0,m.of)(F),ue=(0,r.xW)(),{control:De,register:ge,formState:{errors:Te}}=ue,{fields:Le=[],append:Ye,remove:je}=(0,r.jz)({name:"matchers"}),[Ze,{data:Ne}]=L.hK.endpoints.getAlertRule.useLazyQuery();return(0,s.useEffect)(()=>{ye&&Ze({uid:ye})},[Ze,ye]),(0,t.jsx)("div",{className:oe,children:(0,t.jsx)(l.D,{label:"Refine affected alerts",required:ce,children:(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:(0,n.cx)(re.matchers,re.indent),children:[Ne&&(0,t.jsxs)("div",{children:[(0,t.jsx)(l.D,{label:"Alert rule",disabled:!0,children:(0,t.jsx)(y.p,{id:"alert-rule-name",defaultValue:Ne.grafana_alert.title,disabled:!0})}),(0,t.jsx)(C.c,{})]}),Le.map((Pe,Ue)=>(0,t.jsxs)("div",{className:re.row,"data-testid":"matcher",children:[(0,t.jsx)(l.D,{label:"Label",invalid:!!Te?.matchers?.[Ue]?.name,error:Te?.matchers?.[Ue]?.name?.message,children:(0,t.jsx)(y.p,{...ge(`matchers.${Ue}.name`,{required:{value:ce,message:"Required."}}),defaultValue:Pe.name,placeholder:"label",id:`matcher-${Ue}-label`})}),(0,t.jsx)(l.D,{label:"Operator",children:(0,t.jsx)(r.xI,{control:De,render:({field:{onChange:$e,ref:ze,...qe}})=>(0,t.jsx)(S.l6,{...qe,onChange:dt=>$e(dt.value),className:re.matcherOptions,options:I.xH,"aria-label":"operator",id:`matcher-${Ue}-operator`}),defaultValue:Pe.operator||I.xH[0].value,name:`matchers.${Ue}.operator`,rules:{required:{value:ce,message:"Required."}}})}),(0,t.jsx)(l.D,{label:"Value",invalid:!!Te?.matchers?.[Ue]?.value,error:Te?.matchers?.[Ue]?.value?.message,children:(0,t.jsx)(y.p,{...ge(`matchers.${Ue}.value`,{required:{value:ce,message:"Required."}}),defaultValue:Pe.value,placeholder:"value",id:`matcher-${Ue}-value`})}),(Le.length>1||!ce)&&(0,t.jsx)(A.K,{"aria-label":"Remove matcher",className:re.removeButton,name:"trash-alt",onClick:()=>je(Ue),children:"Remove"})]},`${Pe.id}`))]}),(0,t.jsx)(E.$n,{className:re.indent,tooltip:"Refine which alert instances are silenced by selecting label matchers",type:"button",icon:"plus",variant:"secondary",onClick:()=>{const Pe={name:"",value:"",operator:M.ho.equal};Ye(Pe)},children:"Add matcher"})]})})})},F=oe=>({wrapper:(0,n.css)({marginTop:oe.spacing(2)}),row:(0,n.css)({marginTop:oe.spacing(1),display:"flex",alignItems:"flex-start",flexDirection:"row",backgroundColor:oe.colors.background.secondary,padding:`${oe.spacing(1)} ${oe.spacing(1)} 0 ${oe.spacing(1)}`,"& > * + *":{marginLeft:oe.spacing(2)}}),removeButton:(0,n.css)({marginLeft:oe.spacing(1),marginTop:oe.spacing(2.5)}),matcherOptions:(0,n.css)({minWidth:"140px"}),matchers:(0,n.css)({maxWidth:`${oe.breakpoints.values.sm}px`,margin:`${oe.spacing(1)} 0`,paddingTop:oe.spacing(.5)}),indent:(0,n.css)({marginLeft:oe.spacing(2)})}),w=N;var B=e(54230);const U=()=>{const{control:oe,getValues:ce}=(0,r.xW)(),{field:{onChange:ye,value:re},fieldState:{invalid:ue}}=(0,r.as)({name:"startsAt",control:oe,rules:{validate:Pe=>ce().endsAt>Pe}}),{field:{onChange:De,value:ge},fieldState:{invalid:Te}}=(0,r.as)({name:"endsAt",control:oe,rules:{validate:Pe=>ce().startsAt<Pe}}),{field:{onChange:Le,value:Ye}}=(0,r.as)({name:"timeZone",control:oe}),je=ue||Te,Ze=(0,c.KQ)(re),Ne=(0,c.KQ)(ge);return(0,t.jsx)(l.D,{className:K.timeRange,label:"Silence start and end",error:je?"To is before or the same as from":"",invalid:je,children:(0,t.jsx)(B.b,{value:{from:Ze,to:Ne,raw:{from:Ze,to:Ne}},timeZone:Ye,onChange:Pe=>{ye((0,c.KQ)(Pe.from)),De((0,c.KQ)(Pe.to))},onChangeTimeZone:Pe=>Le(Pe),hideTimeZone:!1,hideQuickRanges:!0,placeholder:"Select time range"})})},K={timeRange:(0,n.css)({width:"400px"})};var V=e(45214),H=e(39938),Y=e(82843),X=e(25968),J=e(69087),q=e(75591),ae=e(97754);const j=(oe,ce,ye)=>{const[re,ue]=(0,s.useState)();(0,g.A)(oe,ce,[re]),(0,V.A)(()=>{ue(ye)},[ye])},te=({amSourceName:oe,matchers:ce,ruleUid:ye})=>{const re=[...ye?[{name:P.kW,value:ye,operator:M.ho.equal}]:[],...ce].map(I.Wc),ue=Y.m.endpoints.getAlertmanagerAlerts.useLazyQuery,De=(0,m.of)(le),ge=ne(),Te=ye||ce.some(Pe=>Pe.value&&Pe.name),[Le,{currentData:Ye=[],isFetching:je,isError:Ze}]=ue();if(j(()=>{Te&&Le({amSourceName:oe,filter:{matchers:re}})},500,[oe,re]),Ze)return(0,t.jsx)(p.F,{title:"Preview not available",severity:"error",children:"Error occurred when generating preview of affected alerts. Are your matchers valid?"});const Ne=Ye.map(Pe=>({id:Pe.fingerprint,data:Pe}));return(0,t.jsxs)("div",{children:[(0,t.jsxs)("h4",{className:De.title,children:["Affected alert rule instances",Ne.length>0?(0,t.jsx)(H.E,{className:De.badge,color:"blue",text:Ne.length}):null]}),!Te&&(0,t.jsx)("span",{children:"Add a valid matcher to see affected alerts"}),je&&(0,t.jsx)(d._,{text:"Loading affected alert rule instances..."}),!je&&!Ze&&Te&&(0,t.jsx)("div",{className:De.table,children:Ne.length>0?(0,t.jsx)(q.E,{items:Ne,isExpandable:!1,cols:ge,pagination:{itemsPerPage:10}}):(0,t.jsx)("span",{children:"No firing alert instances found"})})]})};function ne(){const oe=(0,m.of)(le);return[{id:"state",label:"State",renderCell:function({data:ye}){return(0,t.jsx)(ae.y,{state:ye.status.state})},size:"120px",className:oe.stateColumn},{id:"labels",label:"Labels",renderCell:function({data:ye}){return(0,t.jsx)(J.m,{labels:ye.labels,size:"sm"})},size:"auto"},{id:"created",label:"Created",renderCell:function({data:ye}){return(0,t.jsx)(t.Fragment,{children:(0,X.mo)(ye.startsAt)?"-":(0,c.KQ)(ye.startsAt).format("YYYY-MM-DD HH:mm:ss")})},size:"180px"}]}const le=oe=>({table:(0,n.css)({maxWidth:`${oe.breakpoints.values.lg}px`}),moreMatches:(0,n.css)({marginTop:oe.spacing(1)}),title:(0,n.css)({display:"flex",alignItems:"center"}),badge:(0,n.css)({marginLeft:oe.spacing(1)}),stateColumn:(0,n.css)({display:"flex",alignItems:"center"})});var z=e(17272);const ee=({silenceId:oe,alertManagerSourceName:ce})=>{const{data:ye,isLoading:re,error:ue}=x.F.endpoints.getSilence.useQuery({id:oe,datasourceUid:(0,b.w5)(ce),ruleMetadata:!0,accessControl:!0}),De=ye?.matchers?.find(je=>je.name===P.kW)?.value,ge=ce===b.hY,Te=(0,s.useMemo)(()=>{if(!ye)return;const je=ye.matchers?.filter(Ze=>Ze.name!==P.kW);return(0,z.Ee)({...ye,matchers:je})},[ye]);return oe&&re?(0,t.jsx)(d._,{text:"Loading existing silence information..."}):(0,o.NF)(ue)&&ue.status===404?(0,t.jsx)(p.F,{title:`Existing silence "${oe}" not found`,severity:"warning"}):(ge?ye?.accessControl?.write:!0)?(0,t.jsx)(se,{ruleUid:De,formValues:Te,alertManagerSourceName:ce}):(0,t.jsx)(p.F,{title:"You do not have permission to edit/recreate this silence",severity:"error"})},se=({formValues:oe=(0,z.Di)(),alertManagerSourceName:ce,onSilenceCreated:ye,onCancel:re,ruleUid:ue})=>{const[De,ge]=(0,O.L7)(O.QI.PreviewSilencedInstances),Te=De&&ge,[Le,{isLoading:Ye}]=x.F.endpoints.createSilence.useMutation(),je=(0,r.mN)({defaultValues:oe}),Ze=(0,m.of)(ie),{register:Ne,handleSubmit:Pe,formState:Ue,watch:$e,setValue:ze,clearErrors:qe}=je,[dt,vt,yt,st]=$e(["duration","startsAt","endsAt","matchers"]),Ve=()=>{h.Ny.push((0,T.nL)("/alerting/silences",ce))},pe=ye||Ve,Ee=re||Ve,me=async Oe=>{const{id:Re,startsAt:he,endsAt:Ce,comment:We,createdBy:et,matchers:rt}=Oe;ue&&rt.push({name:P.kW,value:ue,operator:M.ho.equal});const nt=rt.map(I.Wc).filter(xt=>xt.name&&xt.value),gt=(0,i.pickBy)({id:Re,startsAt:he,endsAt:Ce,comment:We,createdBy:et,matchers:nt},xt=>!!xt);await Le({datasourceUid:(0,b.w5)(ce),payload:gt}).unwrap().then(xt=>{pe?.(xt)})},[ve,Se]=(0,s.useState)(dt);(0,g.A)(()=>{if((0,a.vd)(vt)&&(0,a.vd)(yt))if(dt!==ve)ze("endsAt",(0,c.KQ)((0,a.Ri)(new Date(vt),(0,a.E9)(dt))).toISOString()),Se(dt);else{const Oe=new Date(vt).valueOf();if(new Date(yt).valueOf()>Oe){const he=(0,a.dU)({start:new Date(vt),end:new Date(yt)});ze("duration",he),Se(he)}}},700,[qe,dt,yt,ve,ze,vt]);const Ie=!!(f.$.bootData.user.isSignedIn&&f.$.bootData.user.name);return(0,t.jsx)(r.Op,{...je,children:(0,t.jsxs)("form",{onSubmit:Pe(me),children:[(0,t.jsxs)(v.n,{className:Ze.formContainer,children:[(0,t.jsxs)("div",{className:Ze.silencePeriod,children:[(0,t.jsx)(U,{}),(0,t.jsx)(l.D,{label:"Duration",invalid:!!Ue.errors.duration,error:Ue.errors.duration&&(Ue.errors.duration.type==="required"?"Required field":Ue.errors.duration.message),children:(0,t.jsx)(y.p,{...Ne("duration",{validate:Oe=>Object.keys((0,a.E9)(Oe)).length===0?"Invalid duration. Valid example: 1d 4h (Available units: y, M, w, d, h, m, s)":void 0}),id:"duration"})})]}),(0,t.jsx)(w,{required:!ue,ruleUid:ue}),(0,t.jsx)(l.D,{label:"Comment",required:!0,error:Ue.errors.comment?.message,invalid:!!Ue.errors.comment,children:(0,t.jsx)(u.f,{...Ne("comment",{required:{value:!0,message:"Required."}}),rows:5,placeholder:"Details about the silence",id:"comment"})}),!Ie&&(0,t.jsx)(l.D,{label:"Created By",required:!0,error:Ue.errors.createdBy?.message,invalid:!!Ue.errors.createdBy,children:(0,t.jsx)(y.p,{...Ne("createdBy",{required:{value:!0,message:"Required."}}),placeholder:"Who's creating the silence"})}),Te&&(0,t.jsx)(te,{amSourceName:ce,matchers:st,ruleUid:ue})]}),(0,t.jsxs)(D.B,{gap:1,children:[Ye&&(0,t.jsx)(E.$n,{disabled:!0,icon:"spinner",variant:"primary",children:"Saving..."}),!Ye&&(0,t.jsx)(E.$n,{type:"submit",children:"Save silence"}),(0,t.jsx)(E.z9,{onClick:Ee,variant:"secondary",children:"Cancel"})]})]})})},ie=oe=>({formContainer:(0,n.css)({maxWidth:oe.breakpoints.values.md}),alertRule:(0,n.css)({paddingBottom:oe.spacing(2)}),silencePeriod:(0,n.css)({display:"flex",flexDirection:"row",justifyContent:"flex-start",gap:oe.spacing(1),maxWidth:oe.breakpoints.values.sm,paddingTop:oe.spacing(2)})}),Z=ee},17272:(k,R,e)=>{"use strict";e.d(R,{Di:()=>h,Ee:()=>o,LP:()=>c});var t=e(70416),n=e(43127),i=e(47232),s=e(32264),r=e(98164),g=e(32642),a=e(60021);const c=f=>{const d={},p=f.get("comment"),m=f.getAll("matcher"),v=(0,g.ou)(m);return v.length&&(d.matchers=v.map(r.MU)),p&&(d.comment=p),d},o=f=>{const d=new Date,m=Date.parse(f.endsAt)<Date.now()?{start:d,end:(0,t.Ri)(d,{hours:2})}:{start:new Date(f.startsAt),end:new Date(f.endsAt)};return{id:f.id,startsAt:m.start.toISOString(),endsAt:m.end.toISOString(),comment:f.comment,createdBy:f.createdBy,duration:(0,t.dU)(m),isRegex:!1,matchers:f.matchers?.map(r.MU)||[],matcherName:"",matcherValue:"",timeZone:n.lE}},h=f=>{const d=new Date,p=(0,t.Ri)(d,{hours:2});return{id:"",startsAt:d.toISOString(),endsAt:p.toISOString(),comment:`created ${(0,i.KQ)().format("YYYY-MM-DD HH:mm")}`,createdBy:s.$.bootData.user.name,duration:"2h",isRegex:!1,matcherName:"",matcherValue:"",timeZone:n.lE,matchers:[{name:"",value:"",operator:a.ho.equal}],...f}}},96065:(k,R,e)=>{"use strict";e.d(R,{Y:()=>g});var t=e(72635),n=e(79938),i=e(48070),s=e(6833),r=e(43482);function g(){const[a]=(0,r.D)(),[c]=n.hK.endpoints.upsertRuleGroupForNamespace.useMutation(),[o]=n.hK.endpoints.deleteRuleGroupFromNamespace.useMutation();return(0,s.Yb)(async(h,f)=>{const{groupName:d,namespaceName:p}=h,m=(0,i.KH)({rule:f}),{newRuleGroupDefinition:v,rulerConfig:l}=await a(h,m),y=(0,t.t)("alerting.rules.delete-rule.success","Rule successfully deleted");return v.rules.length===0?o({rulerConfig:l,namespace:p,group:d,requestOptions:{successMessage:y}}).unwrap():c({rulerConfig:l,namespace:p,payload:v,requestOptions:{successMessage:y}}).unwrap()})}},43482:(k,R,e)=>{"use strict";e.d(R,{D:()=>r});var t=e(99140),n=e(79938),i=e(48070),s=e(23770);function r(){const[g,a]=n.hK.endpoints.getRuleGroupForNamespace.useLazyQuery();return[async(o,h)=>{const{dataSourceName:f,groupName:d,namespaceName:p}=o;await(0,t.JD)((0,s.DC)({rulesSourceName:f}));const m=(0,s.Qt)(t.Gu,f),v=await g({rulerConfig:m,namespace:p,group:d}).unwrap();return{newRuleGroupDefinition:(0,i.i3)(v,h),rulerConfig:m}},a]}},19073:(k,R,e)=>{"use strict";e.d(R,{Ej:()=>D,Hl:()=>O,L7:()=>M,QI:()=>p,RY:()=>v,e2:()=>u,iI:()=>b,j5:()=>m,mh:()=>E});var t=e(96540),n=e(16233),i=e(11167),s=e(60021),r=e(31678),g=e(82843),a=e(70383),c=e(75471),o=e(57220),h=e(56361),f=e(23662),d=e(97009),p=(C=>(C.ViewExternalConfiguration="view-external-configuration",C.UpdateExternalConfiguration="update-external-configuration",C.CreateContactPoint="create-contact-point",C.ViewContactPoint="view-contact-point",C.UpdateContactPoint="edit-contact-points",C.DeleteContactPoint="delete-contact-point",C.ExportContactPoint="export-contact-point",C.CreateNotificationTemplate="create-notification-template",C.ViewNotificationTemplate="view-notification-template",C.UpdateNotificationTemplate="edit-notification-template",C.DeleteNotificationTemplate="delete-notification-template",C.DecryptSecrets="decrypt-secrets",C.CreateNotificationPolicy="create-notification-policy",C.ViewNotificationPolicyTree="view-notification-policy-tree",C.UpdateNotificationPolicyTree="update-notification-policy-tree",C.DeleteNotificationPolicy="delete-notification-policy",C.ExportNotificationPolicies="export-notification-policies",C.ViewAutogeneratedPolicyTree="view-autogenerated-policy-tree",C.CreateSilence="create-silence",C.ViewSilence="view-silence",C.UpdateSilence="update-silence",C.PreviewSilencedInstances="preview-silenced-alerts",C.ViewMuteTiming="view-mute-timing",C.CreateMuteTiming="create-mute-timing",C.UpdateMuteTiming="update-mute-timing",C.DeleteMuteTiming="delete-mute-timing",C.ExportMuteTimings="export-mute-timings",C))(p||{}),m=(C=>(C.Duplicate="duplicate-alert-rule",C.View="view-alert-rule",C.Update="update-alert-rule",C.Delete="delete-alert-rule",C.Explore="explore-alert-rule",C.Silence="silence-alert-rule",C.ModifyExport="modify-export-rule",C.Pause="pause-alert-rule",C))(m||{}),v=(C=>(C.CreateAlertRule="create-alert-rule",C.ViewAlertRule="view-alert-rule",C.UpdateAlertRule="update-alert-rule",C.DeleteAlertRule="delete-alert-rule",C.ExportGrafanaManagedRules="export-grafana-managed-rules",C.ReadConfigurationStatus="read-configuration-status",C.CreateExternalAlertRule="create-external-alert-rule",C.ViewExternalAlertRule="view-external-alert-rule",C.UpdateExternalAlertRule="update-external-alert-rule",C.DeleteExternalAlertRule="delete-external-alert-rule",C))(v||{});const l=!0,y=!1,u=()=>({"create-alert-rule":T(l,r.AccessControlAction.AlertingRuleCreate),"view-alert-rule":T(l,r.AccessControlAction.AlertingRuleRead),"update-alert-rule":T(l,r.AccessControlAction.AlertingRuleUpdate),"delete-alert-rule":T(l,r.AccessControlAction.AlertingRuleDelete),"export-grafana-managed-rules":T(l,r.AccessControlAction.AlertingRuleRead),"read-configuration-status":[l,n.TP.hasPermission(r.AccessControlAction.AlertingInstanceRead)||n.TP.hasPermission(r.AccessControlAction.AlertingNotificationsRead)],"create-external-alert-rule":T(l,r.AccessControlAction.AlertingRuleExternalWrite),"view-external-alert-rule":T(l,r.AccessControlAction.AlertingRuleExternalRead),"update-external-alert-rule":T(l,r.AccessControlAction.AlertingRuleExternalWrite),"delete-external-alert-rule":T(l,r.AccessControlAction.AlertingRuleExternalWrite)}),D=C=>u()[C];function E(C,S){const A=P(C);return(0,t.useMemo)(()=>A[S],[A,S])}function x(C,S){const A=P(C);return useMemo(()=>S.map(L=>A[L]),[A,S])}function P(C){const S=C.namespace.rulesSource,A=typeof S=="string"?S:S.name,L=(0,f.lT)(C.rulerRule)&&!!C.rulerRule.grafana_alert.provenance,N=(0,f.YN)(C.group),F=(0,f.lT)(C.rulerRule),w=(0,f.Tm)(C),B=L||N||w,{isEditable:U,isRemovable:K,isRulerAvailable:V=!1,loading:H}=(0,d.g)(A,C.rulerRule),[Y,X]=D("export-grafana-managed-rules"),J=H?y:V,q=B?y:J,ae=w?y:J,j=(0,c.Wd)(A),te=I(C);return{"duplicate-alert-rule":T(ae,j.create),"view-alert-rule":T(l,j.read),"update-alert-rule":[q,U??!1],"delete-alert-rule":[q,K??!1],"explore-alert-rule":T(l,r.AccessControlAction.DataSourcesExplore),"silence-alert-rule":te,"modify-export-rule":[F,X],"pause-alert-rule":[q&&F,U??!1]}}function b(){const{selectedAlertmanager:C,hasConfigurationAPI:S,isGrafanaAlertmanager:A}=(0,a.VI)(),L=(0,c.lV)(C),N=(0,c.jy)(C);return{"view-external-configuration":T(l,r.AccessControlAction.AlertingNotificationsExternalRead),"update-external-configuration":T(S,r.AccessControlAction.AlertingNotificationsExternalWrite),"create-contact-point":T(S,L.create),"view-contact-point":T(l,L.read),"edit-contact-points":T(S,L.update),"delete-contact-point":T(S,L.delete),"export-contact-point":T(A,L.read),"create-notification-template":T(S,L.create),"view-notification-template":T(l,L.read),"edit-notification-template":T(S,L.update),"delete-notification-template":T(S,L.delete),"create-notification-policy":T(S,L.create),"view-notification-policy-tree":T(l,L.read),"update-notification-policy-tree":T(S,L.update),"delete-notification-policy":T(S,L.delete),"export-notification-policies":T(A,L.read),"decrypt-secrets":T(A,L.provisioning.readSecrets),"view-autogenerated-policy-tree":[A,(0,h.qc)()],"create-silence":T(l,N.create),"view-silence":T(l,N.read),"update-silence":T(l,N.update),"preview-silenced-alerts":T(l,N.read),"create-mute-timing":T(S,L.create),"view-mute-timing":T(l,L.read),"update-mute-timing":T(S,L.update),"delete-mute-timing":T(S,L.delete),"export-mute-timings":T(A,L.read)}}function M(C){const S=b();return(0,t.useMemo)(()=>S[C],[S,C])}function O(C){const S=b();return(0,t.useMemo)(()=>C.map(A=>S[A]),[S,C])}function I(C){const A=C.namespace.rulesSource===o.hY,L=(0,f.Gy)(C.rulerRule),{currentData:N,isLoading:F}=g.m.endpoints.getGrafanaAlertingConfigurationStatus.useQuery(void 0,{skip:!A}),w=(0,f.lT)(C.rulerRule)?C.rulerRule.grafana_alert.namespace_uid:void 0,{loading:B,folder:U}=(0,i.a)(w);if(!A||L||F||B||!U)return[!1,!1];const K=N?.alertmanagersChoice===s.nA.External,V=N?.alertmanagersChoice===s.nA.All,H=!K||V,{accessControl:Y={}}=U,X=!!(n.TP.hasPermission(r.AccessControlAction.AlertingInstanceCreate)||Y[r.AccessControlAction.AlertingSilenceCreate]);return[H,X]}const T=(C,S)=>[C,n.TP.hasPermission(S)]},62190:(k,R,e)=>{"use strict";e.d(R,{W:()=>i});var t=e(96540),n=e(57220);function i(s){return(0,t.useMemo)(()=>(0,n.sq)(s),[s])}},36135:(k,R,e)=>{"use strict";e.d(R,{g:()=>s});var t=e(96540),n=e(19347),i=e(26657);function s(r){return{allDataSourcesAvailable:(0,t.useMemo)(()=>r.filter(a=>!(0,i.s9)(a.datasourceUid)).every(a=>!!(0,n.l)().getInstanceSettings(a.datasourceUid)),[r])}}},6833:(k,R,e)=>{"use strict";e.d(R,{Gz:()=>h,VP:()=>o,Yb:()=>s});var t=e(74848),n=e(96540),i=e(56361);function s(d,p){const[m,v]=(0,n.useState)({status:"not-executed",error:void 0,result:p}),l=(0,n.useRef)(),y=(0,n.useRef)(),u=r({execute(...D){y.current=D;const E=d(...D);return l.current=E,v(x=>({...x,status:"loading"})),E.then(x=>{E===l.current&&v(P=>({...P,status:"success",error:void 0,result:x}))},x=>{E===l.current&&v(P=>({...P,status:"error",error:x}))}),E},reset(){v({status:"not-executed",error:void 0,result:p}),l.current=void 0,y.current=void 0}});return[(0,n.useMemo)(()=>({reset(){u.current.reset()},execute:(...D)=>u.current.execute(...D)}),[]),m,{promise:l.current,lastArgs:y.current}]}function r(d){const p=(0,n.useRef)(d);return p.current=d,(0,n.useMemo)(()=>Object.freeze({get current(){return p.current}}),[])}function g(d){return d.status==="error"}function a(d){return d.status==="success"}function c(d){return d.status==="not-executed"}function o(d){return d.status==="loading"}function h(...d){return{uninitialized:d.every(c),loading:d.some(o),error:d.find(g)?.error,success:d.some(a)}}function f({state:d}){return jsxs(Fragment,{children:[c(d)&&"uninitialized",o(d)&&"loading",a(d)&&"success",a(d)&&`result: ${JSON.stringify(d.result,null,2)}`,g(d)&&`error: ${stringifyErrorLike(d.error)}`]})}},730:(k,R,e)=>{"use strict";e.d(R,{$q:()=>x,Ll:()=>E,O3:()=>b,ZU:()=>y,we:()=>m});var t=e(96540),n=e(16817),i=e(31678),s=e(79938),r=e(77583),g=e(23770),a=e(57220),c=e(88467),o=e(18461),h=e(23662),f=e(9518),d=e(61410);function p(M,O){const I=v(O),T=useCombinedRuleNamespaces(O),C=useMemo(()=>{if(!M||!O||T.length===0)return[];const S=[];for(const A of T)for(const L of A.groups)for(const N of L.rules)N.name===M&&S.push(N);return S},[M,O,T]);return{...I,result:C}}function m(M,O,I){const T=(0,a.oh)(O),{dsFeatures:C,isLoadingDsFeatures:S}=b(O),{currentData:A,isLoading:L,error:N}=s.hK.endpoints.prometheusRuleNamespaces.useQuery({ruleSourceName:O,ruleName:M,namespace:I?.namespace,groupName:I?.groupName}),[F]=s.hK.endpoints.getRuleGroupForNamespace.useLazyQuery(),{loading:w,error:B,value:U}=(0,n.A)(async()=>{if(!T)throw new Error("Unable to obtain data source settings");if(N)throw new Error("Unable to obtain Prometheus rules");const K=A||[],V=[];if(C?.rulerConfig){const X=C.rulerConfig,J=K.map(q=>q.groups.map(ae=>({namespace:q,group:ae}))).flat();await Promise.allSettled(J.map(async q=>{const ae=await F({rulerConfig:X,namespace:q.namespace.name,group:q.group.name}).unwrap();V.push(ae)}))}return K.map(X=>(0,f.O6)(T,X,V)).flatMap(X=>X.groups.flatMap(J=>J.rules))},[T,C,L,N,A,F]);return{loading:S||w,error:B,rules:U}}function v(M,O){const I=useDispatch(),T=useUnifiedAlertingSelector(N=>N.promRules),C=l(M,T),S=useUnifiedAlertingSelector(N=>N.rulerRules),A=l(M,S),{loading:L}=useAsync(async()=>{M&&await I(fetchPromAndRulerRulesAction({rulesSourceName:M,identifier:O}))},[I,M]);return{loading:L,error:C.error??isRulerNotSupportedResponse(A)?void 0:A.error,dispatched:C.dispatched&&A.dispatched}}function l(M,O){if(!M)return initialAsyncRequestState;const I=O[M];return I||initialAsyncRequestState}function y({ruleIdentifier:M,limitAlerts:O}){const{ruleSourceName:I}=M,T=D(M),{dsFeatures:C,isLoadingDsFeatures:S}=b(I),{loading:A,error:L,result:N}=u(M),{currentData:F,isLoading:w,error:B}=s.hK.endpoints.prometheusRuleNamespaces.useQuery({ruleSourceName:M.ruleSourceName,namespace:N?.namespace,groupName:N?.group,ruleName:N?.ruleName,limitAlerts:O},{skip:!N||A,refetchOnMountOrArgChange:!0}),[U,{currentData:K,isLoading:V,error:H}]=s.hK.endpoints.getRuleGroupForNamespace.useLazyQuery();(0,t.useEffect)(()=>{!C?.rulerConfig||!N||U({rulerConfig:C.rulerConfig,namespace:N.namespace,group:N.group})},[C,U,N]);const Y=(0,t.useMemo)(()=>{if(!(!F||!T)&&F.length>0){const X=F.map(J=>(0,f.O6)(T,J,K?[K]:[]));for(const J of X)for(const q of J.groups)for(const ae of q.rules){const j=o.UP(I,ae);if(o.LC(j,M))return ae}}},[M,I,F,K,T]);return{loading:S||w||V,error:L??B??H,result:Y}}function u(M){const{isLoading:O,currentData:I,error:T,isUninitialized:C}=s.hK.endpoints.getAlertRule.useQuery({uid:(0,h.A4)(M)?M.uid:""},{skip:!(0,h.A4)(M),refetchOnMountOrArgChange:!0});return(0,t.useMemo)(()=>(0,h.Mj)(M)||(0,h.X4)(M)?{result:{namespace:M.namespace,group:M.groupName,ruleName:M.ruleName},loading:!1}:(0,h.A4)(M)?O||C?{loading:!0}:T?{loading:!1,error:T}:I?{result:{namespace:I.grafana_alert.namespace_uid,group:I.grafana_alert.rule_group,ruleName:I.grafana_alert.title},loading:!1}:{loading:!1,error:new Error(`Unable to obtain rule location for rule ${M.uid}`)}:{loading:!1,error:new Error("Unsupported rule identifier")},[M,O,C,T,I])}function D(M){return(0,h.A4)(M)?"grafana":(0,a.oh)(M.ruleSourceName)}function E({ruleIdentifier:M}){const O=D(M),{dsFeatures:I,isLoadingDsFeatures:T}=b(M.ruleSourceName),{loading:C,error:S,result:A}=u(M),[L,{currentData:N,isLoading:F,isUninitialized:w,error:B}]=s.hK.endpoints.getRuleGroupForNamespace.useLazyQuery();(0,t.useEffect)(()=>{!I?.rulerConfig||!A||L({rulerConfig:I.rulerConfig,namespace:A.namespace,group:A.group})},[I,L,A]);const U=(0,t.useMemo)(()=>{const{ruleSourceName:K}=M;if(!N||!O||!A)return;const V=N.rules.find(H=>{const Y=o.P1(K,A.namespace,A.group,H);return o.LC(Y,M)});if(V)return{ruleSourceName:K,group:N,namespace:A.namespace,rule:V}},[M,N,O,A]);return{loading:C||T||F||w,error:S??B,result:U}}const x={dataSourceName:a.hY,apiVersion:"legacy"},P={rulerConfig:x};function b(M){const O=(0,a.z2)(M),{currentData:I,isLoading:T}=r.L.endpoints.discoverDsFeatures.useQuery({rulesSourceName:M},{skip:O});return O?{isLoadingDsFeatures:!1,dsFeatures:P}:{isLoadingDsFeatures:T,dsFeatures:I}}},9518:(k,R,e)=>{"use strict";e.d(R,{Jr:()=>l,NW:()=>x,O6:()=>m,Tj:()=>P,Ug:()=>E,dy:()=>d,kU:()=>S});var t=e(2543),n=e.n(t),i=e(96540),s=e(54317),r=e(94822),g=e(79938),a=e(55740),c=e(57220),o=e(23662),h=e(730),f=e(61410);function d(A,L){const N=(0,f.$)(U=>U.promRules),F=(0,f.$)(U=>U.rulerRules),w=(0,i.useRef)({}),B=(0,i.useMemo)(()=>{if(A){const U=(0,c.Zw)(A);if(!U)throw new Error(`Unknown rules source: ${A}`);return[U]}return(0,c.lS)()},[A]);return(0,i.useMemo)(()=>B.map(U=>{const K=(0,c.Eb)(U)?U.name:U,V=F[K]?.result;let H=N[K]?.result;K===c.hY&&L&&(H=L);const Y=w.current[K];if(Y&&Y.promRules===H&&Y.rulerRules===V)return Y.result;const X={};Object.entries(V||{}).forEach(([q,ae])=>{const j={rulesSource:U,name:q,groups:[]};(0,o.lT)(ae[0].rules[0])&&(j.uid=ae[0].rules[0].grafana_alert.namespace_uid),X[q]=j,u(j,ae)}),H?.forEach(({name:q,groups:ae})=>{const j=X[q]=X[q]||{rulesSource:U,name:q,groups:[]};D(j,ae)});const J=Object.values(X);return w.current[K]={promRules:H,rulerRules:V,result:J},J}).flat(),[N,F,B,L])}function p(A,L,N){const F={};return Object.entries(N||{}).forEach(([w,B])=>{const U={rulesSource:A,name:w,groups:[]};F[w]=U,u(U,B)}),L?.forEach(({name:w,groups:B})=>{const U=F[w]=F[w]||{rulesSource:A,name:w,groups:[]};D(U,B)}),Object.values(F)}function m(A,L,N){const F={rulesSource:A,name:L.name,groups:[]};return u(F,N),D(F,L.groups),F.groups.forEach(w=>{w.rules=w.rules.filter(B=>B.promRule)}),F}function v(A,L,N){return u(A,N),D(A,L),A}function l(A){return A.map(L=>{const N={...L,groups:[]};return N.groups.push({name:"default",rules:y(L.groups.flatMap(F=>F.rules)),totals:b(L.groups)}),N})}function y(A){return A.sort((L,N)=>L.name.localeCompare(N.name))}function u(A,L=[]){A.groups=L.map(N=>{const F=N.rules.filter(U=>(0,o.i7)(U)).length,w=N.rules.filter(U=>(0,o.lT)(U)&&U.grafana_alert.is_paused).length,B={name:N.name,interval:N.interval,source_tenants:N.source_tenants,rules:[],totals:{paused:w,recording:F}};return B.rules=N.rules.map(U=>O(U,A,B)),B})}function D(A,L){const N=new Map;A.groups.forEach(F=>N.set(F.name,F)),L.forEach(F=>{let w=N.get(F.name);w||(w={name:F.name,rules:[],totals:P(F)},A.groups.push(w),N.set(F.name,w)),w.totals={...w.totals,...P(F)};const B=new Map;w.rules.forEach(U=>{const K=B.get(U.name);K?K.push(U):B.set(U.name,[U])}),(F.rules??[]).forEach(U=>{const K=I(U,B,A.rulesSource);K?(K.promRule=U,K.instanceTotals=(0,o.Z8)(U)?E(U):{},K.filteredInstanceTotals=(0,o.Z8)(U)?x(U):{}):w.rules.push(M(U,A,w))})})}function E(A){const L=(0,t.countBy)(A.alerts,"state");if(A.totals){const{normal:N,...F}=A.totals;return{...F,inactive:N}}return{alerting:L[s.$.Alerting]||L.firing,pending:L[s.$.Pending],inactive:L[s.$.Normal],nodata:L[s.$.NoData],error:L[s.$.Error]||L.err||void 0}}function x(A){if(A.totalsFiltered){const{normal:L,...N}=A.totalsFiltered;return{...N,inactive:L}}return{}}function P(A){if(A.totals){const{firing:w,...B}=A.totals;return{...B,alerting:w}}const L=(0,t.countBy)(A.rules,w=>(0,o.Z8)(w)&&w.state),N=(0,t.countBy)(A.rules,w=>w.health),F=A.rules.filter(w=>(0,o.KB)(w)).length;return{alerting:L[r.cF.Firing],error:N.error,nodata:N.nodata,inactive:L[r.cF.Inactive],pending:L[r.cF.Pending],recording:F}}function b(A){const L={};return A.forEach(N=>{const F=N.totals;Object.entries(F).forEach(([w,B])=>{L[w]||(L[w]=0),L[w]+=B})}),L}function M(A,L,N){return{name:A.name,query:A.query,labels:A.labels||{},annotations:(0,o.Z8)(A)?A.annotations||{}:{},promRule:A,namespace:L,group:N,instanceTotals:(0,o.Z8)(A)?E(A):{},filteredInstanceTotals:(0,o.Z8)(A)?x(A):{}}}function O(A,L,N){return(0,o.$y)(A)?{name:A.alert,query:A.expr,labels:A.labels||{},annotations:A.annotations||{},rulerRule:A,namespace:L,group:N,instanceTotals:{},filteredInstanceTotals:{}}:(0,o.i7)(A)?{name:A.record,query:A.expr,labels:A.labels||{},annotations:{},rulerRule:A,namespace:L,group:N,instanceTotals:{},filteredInstanceTotals:{}}:{name:A.grafana_alert.title,query:"",labels:A.labels||{},annotations:A.annotations||{},rulerRule:A,namespace:L,group:N,instanceTotals:{},filteredInstanceTotals:{}}}function I(A,L,N){const F=L.get(A.name);if(!F)return;if((0,c.z2)(N))return F[0];const w=F.find(U=>!U.promRule&&T(U,A,!0));if(w)return w;const B=F.find(U=>!U.promRule&&T(U,A,!1));if(B)return B}function T(A,L,N=!0){return A.name===L.name?(0,t.isEqual)([N?C(A.query):"",A.labels,A.annotations],[N?C(L.query):"",L.labels||{},(0,o.Z8)(L)?L.annotations||{}:{}]):!1}function C(A){return A.length>1&&A[0]==="("&&A[A.length-1]===")"&&(A=A.slice(1,-1)),A=A.replace(/\s|\n/g,""),A.split("").sort().join("")}function S(A,L,N){const{currentData:F,isLoading:w,error:B}=g.hK.endpoints.prometheusRuleNamespaces.useQuery({ruleSourceName:c.hY,dashboardUid:A??void 0,panelId:L},{skip:A===null,pollingInterval:N?a.HH:void 0}),{currentData:U,isLoading:K,error:V}=g.hK.endpoints.rulerRules.useQuery({rulerConfig:h.$q,filter:{dashboardUID:A??void 0,panelId:L}},{pollingInterval:N?a.HH:void 0,skip:A===null}),H=(0,i.useRef)({}),Y=(0,c.Zw)(c.hY),X=(0,i.useMemo)(()=>{if(!Y)return[];const J=H.current[c.hY];if(J&&J.promRules===F&&J.rulerRules===U)return J.result;const q={};Object.entries(U||{}).forEach(([j,te])=>{const ne={rulesSource:Y,name:j,groups:[]};(0,o.lT)(te[0].rules[0])&&(ne.uid=te[0].rules[0].grafana_alert.namespace_uid),q[j]=ne,u(ne,te)}),F?.forEach(({name:j,groups:te})=>{const ne=q[j]=q[j]||{rulesSource:Y,name:j,groups:[]};D(ne,te)});const ae=Object.values(q);return H.current[c.hY]={promRules:F,rulerRules:U,result:ae},ae},[F,U,Y]);return{loading:w||K,error:B??V,result:X}}},14285:(k,R,e)=>{"use strict";e.d(R,{dI:()=>x,i7:()=>P});var t=e(53076),n=e(1932),i=e(2543),s=e.n(i),r=e(96540),g=e(19347),a=e(94822),c=e(25027),o=e(28475),h=e(98164),f=e(55740),d=e(57220),p=e(32642),m=e(23662),v=e(9518),l=e(39964);const y=25,u=1/0,D=new Error("Failed to search rules"),E=A=>A.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");function x(){const[A,L]=(0,l.l)(),N=A.get("search")??"",F=(0,r.useMemo)(()=>(0,o.XY)(N),[N]),w=(0,r.useMemo)(()=>Object.values(F).some(K=>!(0,i.isEmpty)(K)),[F]),B=(0,r.useCallback)(K=>{const V=(0,o.kL)(N,K);L({search:V})},[N,L]),U=(0,r.useCallback)(K=>{L({search:K})},[L]);return(0,r.useEffect)(()=>{const K={dataSource:A.get("dataSource")??void 0,alertState:A.get("alertState")??void 0,ruleType:A.get("ruleType")??void 0,labels:(0,p.S6)(A.get("queryString")??"").map(h.MU)};Object.values(K).some(H=>!(0,i.isEmpty)(H))&&(L({dataSource:void 0,alertState:void 0,ruleType:void 0,queryString:void 0}),B((0,n.jM)(F,H=>{if(H.dataSourceNames??=K.dataSource?[K.dataSource]:[],K.alertState&&(0,a.Si)(K.alertState)&&(H.ruleState??=K.alertState),K.ruleType&&(0,m.nf)(K.ruleType)&&(H.ruleType??=K.ruleType),H.labels.length===0&&K.labels.length>0){const Y=K.labels.map(({name:X,operator:J,value:q})=>`${X}${J}${q}`);H.labels.push(...Y)}})))},[A,B,F,L]),{filterState:F,hasActiveFilters:w,searchQuery:N,setSearchQuery:U,updateFilters:B}}const P=(A,L)=>(0,r.useMemo)(()=>{const N=b(A,L);return N.forEach(F=>{F.groups.forEach(w=>{w.rules.forEach(B=>{(0,m.Z8)(B.promRule)&&(B.instanceTotals=(0,v.Ug)(B.promRule),B.filteredInstanceTotals=(0,v.NW)(B.promRule))}),w.totals=(0,v.Tj)({rules:w.rules.map(B=>B.promRule).filter(B=>!!B)})})}),N},[A,L]),b=(A,L={dataSourceNames:[],labels:[],freeFormWords:[]})=>{let N=A;const F=L.dataSourceNames;F.length&&(N=N.filter(({rulesSource:U})=>(0,d.Eb)(U)?F.includes(U.name):!0));const w=L.namespace;if(w){const U=N.map(J=>J.name),K=E(w),V=C(w),[H,Y,X]=V.search(U,K,I(w),u);Y&&X?N=X.map(J=>N[Y.idx[J]]):H&&(N=H.map(J=>N[J]))}const B=[];try{N.reduce(M(L),[]).forEach(K=>{B.push(K)})}catch{(0,c.vV)(D,{search:JSON.stringify(L)})}return B},M=A=>(L,N)=>{const F=A.groupName;let w=N.groups;if(F){const B=w.map(X=>X.name),U=C(F),K=E(F),[V,H,Y]=U.search(B,K,I(F),u);H&&Y?w=Y.map(X=>w[H.idx[X]]):V&&(w=V.map(X=>w[X]))}return w=w.reduce(O(A),[]),w.length&&L.push({...N,groups:w}),L},O=A=>{const L=A.ruleName??A.freeFormWords.join(" ");return(N,F)=>{let w=F.rules;if(L){const B=w.map(X=>X.name),U=C(L),K=E(L),[V,H,Y]=U.search(B,K,I(L),u);H&&Y?w=Y.map(X=>w[H.idx[X]]):V&&(w=V.map(X=>w[X]))}return w=w.filter(B=>{const U=B.promRule,K=(0,i.chain)(A).pick(["ruleType","dataSourceNames","ruleHealth","labels","ruleState","dashboardUid","plugins"]).omitBy(i.isEmpty).mapValues(()=>!1).value();if("ruleType"in K&&A.ruleType===U?.type&&(K.ruleType=!0),"plugins"in K&&A.plugins==="hide"&&(K.plugins=!(0,m.Tm)(B)),"dataSourceNames"in K&&((0,m.lT)(B.rulerRule)?S(B.rulerRule,A)&&(K.dataSourceNames=!0):K.dataSourceNames=!0),"ruleHealth"in A&&U){const V=(0,m.f6)(U.health);A.ruleHealth===V&&(K.ruleHealth=!0)}if("labels"in K){const V=(0,i.compact)(A.labels.map(T)),H=V.length>0&&(0,h.Av)(B.labels,V),Y=V.length>0&&U&&U.type===a.JS.Alerting&&U.alerts&&U.alerts.some(X=>(0,h.Av)(X.labels,V));(H||Y)&&(K.labels=!0)}if("ruleState"in K){const V=B.promRule;V&&(0,m.Z8)(V)&&V.state===A.ruleState&&(K.ruleState=!0)}return"dashboardUid"in K&&B.annotations[f.YH.dashboardUID]===A.dashboardUid&&(K.dashboardUid=!0),Object.values(K).every(V=>V===!0)}),w.length&&N.push({...F,rules:w}),N}};function I(A){return C(A).split(A).length<5?4:0}function T(A){try{return(0,p.qR)(A)}catch{return{name:A,value:"",isRegex:!0,isEqual:!0}}}function C(A){const L=A.length>y;return new t.A({intraMode:L?0:1,interSplit:"\\s+"})}const S=(A,L)=>L.dataSourceNames?.length?!!A.grafana_alert.data.find(N=>{if(!N.datasourceUid)return!1;const F=(0,g.l)().getInstanceSettings(N.datasourceUid);return F?.name&&L?.dataSourceNames?.includes(F.name)}):!0},11167:(k,R,e)=>{"use strict";e.d(R,{a:()=>g});var t=e(96540),n=e(31678),i=e(23770),s=e(88467),r=e(61410);function g(a){const c=(0,n.useDispatch)(),o=(0,r.$)(h=>h.folders);if((0,t.useEffect)(()=>{a&&c((0,i.Om)(a))},[c,a]),a){const h=o[a]||s.jA;return{folder:h.result,loading:h.loading}}return{loading:!1}}},83903:(k,R,e)=>{"use strict";e.d(R,{y:()=>s});var t=e(96540),n=e(57220),i=e(61410);function s(){const r=(0,i.$)(c=>c.rulerRules),g=(0,t.useCallback)(c=>{const o=typeof c=="string"?c:c.name;return o===n.hY||!!r[o]?.result},[r]),a=(0,t.useCallback)(c=>{const o=(0,n.EV)(c);return!!r[o]?.result},[r]);return{hasRuler:g,rulerRulesLoaded:a}}},97009:(k,R,e)=>{"use strict";e.d(R,{g:()=>a});var t=e(16233),n=e(77583),i=e(75471),s=e(23662),r=e(11167),g=e(61410);function a(c,o){const h=(0,g.$)(E=>E.dataSources),{currentData:f,isLoading:d}=n.L.endpoints.discoverDsFeatures.useQuery({rulesSourceName:c}),p=o&&(0,s.lT)(o)?o.grafana_alert.namespace_uid:void 0,m=(0,i.Wd)(c),{folder:v,loading:l}=(0,r.a)(p);if(!o)return{isEditable:!1,isRemovable:!1,loading:!1};if((0,s.lT)(o)){if(!p)throw new Error(`Rule ${o.grafana_alert.title} does not have a folder uid, cannot determine if it is editable.`);if(!v)return{isRulerAvailable:!0,isEditable:!1,isRemovable:!1,loading:l};const E=t.TP.hasPermissionInMetadata(m.update,v),x=t.TP.hasPermissionInMetadata(m.delete,v);return{isRulerAvailable:!0,isEditable:E,isRemovable:x,loading:l||d}}const y=!!h[c]?.result?.rulerConfig||!!f?.rulerConfig,u=t.TP.hasPermission(m.update),D=t.TP.hasPermission(m.delete);return{isRulerAvailable:y,isEditable:u&&y,isRemovable:D&&y,loading:d||h[c]?.loading}}},98439:(k,R,e)=>{"use strict";e.d(R,{W:()=>s});var t=e(2543),n=e.n(t),i=e(96540);function s(r,g=1,a){const[c,o]=(0,i.useState)(g),h=(0,i.useMemo)(()=>(0,t.chunk)(r,a),[r,a]),f=h.length,d=h[c-1]??[],p=(c-1)*a+1,m=(0,t.clamp)(c*a,r.length),v=(0,i.useCallback)(u=>{o((0,t.clamp)(u,1,h.length))},[o,h]),l=(0,i.useCallback)(()=>v(c+1),[c,v]),y=(0,i.useCallback)(()=>v(c-1),[c,v]);return(0,i.useEffect)(()=>o(1),[f]),{page:c,onPageChange:v,numberOfPages:f,pageItems:d,pageStart:p,pageEnd:m,nextPage:l,previousPage:y}}},27747:(k,R,e)=>{"use strict";e.d(R,{S:()=>n});var t=e(9518);function n({dashboardUID:i,panelId:s,poll:r=!1}){const{result:g,loading:a,error:c}=(0,t.kU)(i,s,r);return{rules:g?g.flatMap(h=>h.groups).flatMap(h=>h.rules):[],errors:c?[c]:[],loading:a}}},12210:(k,R,e)=>{"use strict";e.d(R,{_:()=>i});var t=e(16817),n=e(27716);function i(s){const{loading:r,error:g,value:a}=(0,t.A)(()=>(0,n.x)(s,{showErrorAlert:!1})),c=a&&!g&&!r,o=a?.enabled;return r&&!a?{loading:!0}:!c||!o?{loading:!1,installed:!1}:{loading:r,installed:!0,settings:a}}},46013:(k,R,e)=>{"use strict";e.d(R,{G:()=>h,Q:()=>o});var t=e(74848),n=e(32196),i=e(96540),s=e(32264),r=e(40845),g=e(37390);const a=(0,i.lazy)(()=>e.e(7409).then(e.bind(e,87409))),c=(0,i.lazy)(()=>e.e(285).then(e.bind(e,285)));var o=(d=>(d.Loki="loki",d.Annotations="annotations",d))(o||{});function h(){const[d,p]=(0,i.useState)(!1),[m,v]=(0,i.useState)(),l=(0,r.of)(f),y=s.$.unifiedAlerting.alertStateHistoryBackend,u=s.$.unifiedAlerting.alertStateHistoryPrimary,E=[y,u].some(M=>M==="loki")?"loki":"annotations",x=(0,i.useCallback)(()=>{v(void 0),p(!1)},[]),P=(0,i.useCallback)(M=>{v(M),p(!0)},[]);return{StateHistoryModal:(0,i.useMemo)(()=>m?(0,t.jsx)(g.a,{isOpen:d,onDismiss:x,closeOnBackdropClick:!0,closeOnEscape:!0,title:"State history",className:l.modal,contentClassName:l.modalContent,children:(0,t.jsxs)(i.Suspense,{fallback:"Loading...",children:[E==="loki"&&(0,t.jsx)(c,{ruleUID:m.grafana_alert.uid}),E==="annotations"&&(0,t.jsx)(a,{alertId:m.grafana_alert.id??""})]})}):null,[m,d,x,E,l]),showStateHistoryModal:P,hideStateHistoryModal:x}}const f=d=>({modal:(0,n.css)({width:"80%",height:"80%",minWidth:"800px"}),modalContent:(0,n.css)({height:"100%",width:"100%",padding:d.spacing(2)})})},39964:(k,R,e)=>{"use strict";e.d(R,{l:()=>s});var t=e(96540),n=e(24180),i=e(39601);function s(){const{search:r}=(0,n.zy)(),g=(0,t.useMemo)(()=>new URLSearchParams(r),[r]),a=(0,t.useCallback)((c,o)=>{i.Ny.partial(c,o)},[]);return[g,a]}},61410:(k,R,e)=>{"use strict";e.d(R,{$:()=>i});var t=e(25508),n=e(31678);function i(s,r){return(0,n.useSelector)((0,t.Mz)(g=>g.unifiedAlerting,g=>s(g)),r)}},85244:(k,R,e)=>{"use strict";e.d(R,{T:()=>g});var t=e(74848),n=e(16817),i=e(39938),s=e(56034),r=e(27716);function g({pluginId:a}){const{value:c}=(0,n.A)(()=>(0,r.x)(a)),o=c?.info.logos?.small,h=o?(0,t.jsx)("img",{src:o,alt:c?.name,style:{width:"20px",height:"20px"}}):(0,t.jsx)(i.E,{text:a,color:"orange"}),f=c?`This rule is managed by the ${c?.name} plugin`:"This rule is managed by a plugin";return(0,t.jsx)(s.m,{content:f,children:(0,t.jsx)("div",{children:h})})}},48070:(k,R,e)=>{"use strict";e.d(R,{KH:()=>o,KL:()=>d,LH:()=>c,fO:()=>f,i3:()=>v,lF:()=>h});var t=e(65307),n=e(2543),i=e.n(n),s=e(18461),r=e(23662);const g=(0,t.VP)("ruleGroup/rules/add"),a=(0,t.VP)("ruleGroup/rules/update"),c=(0,t.VP)("ruleGroup/rules/pause"),o=(0,t.VP)("ruleGroup/rules/delete"),h=(0,t.VP)("ruleGroup/update"),f=(0,t.VP)("ruleGroup/move"),d=(0,t.VP)("ruleGroup/rename"),p=(0,t.VP)("ruleGroup/rules/reorder"),m={name:"initial",rules:[]},v=(0,t.vy)(m,l=>{l.addCase(g,()=>{throw new Error("not yet implemented")}).addCase(a,()=>{throw new Error("not yet implemented")}).addCase(o,(y,{payload:u})=>{const{rule:D}=u;if((0,r.lT)(D)){const E=D.grafana_alert.uid;(0,n.remove)(y.rules,x=>(0,r.lT)(x)&&x.grafana_alert.uid===E)}if((0,r.Mt)(D)){const E=(0,s.Ns)(D);(0,n.remove)(y.rules,x=>(0,r.Mt)(x)&&(0,s.Ns)(x)===E)}}).addCase(c,(y,{payload:u})=>{const{uid:D,pause:E}=u;let x=!1;for(const P of y.rules)if((0,r.lT)(P)&&P.grafana_alert.uid===D){x=!0,P.grafana_alert.is_paused=E;break}if(!x)throw new Error(`No rule with UID ${D} found in group ${y.name}`)}).addCase(p,()=>{throw new Error("not yet implemented")}).addMatcher((0,t.i0)(d,f),(y,{payload:u})=>{const{groupName:D}=u;D&&(y.name=D)}).addMatcher((0,t.i0)(h,d,f),(y,{payload:u})=>{const{interval:D}=u;D&&(y.interval=D)}).addDefaultCase((y,u)=>{throw new Error(`Unknown action for rule group reducer: ${u.type}`)})})},28475:(k,R,e)=>{"use strict";e.d(R,{Jc:()=>H,kL:()=>X,XY:()=>Y});var t=e(94822),n=e(23662);const i=1,s=2,r=3,g=4,a=5,c=6,o=7,h=8,f=9,d=10,p=11,m=12,v=13,l=14,y=0,u=1,D=2,E=3,x=4,P=5,b=6,M=7,O=8,I=9;var T=e(2543),C=e(48820);const S=C.U1.deserialize({version:14,states:"!vOQOPOOOxOPO'#CjOOOO'#Cj'#CjOQOPO'#CnOOOO'#Ck'#CkQQOPOOO!sOQO'#C^O!xOPO'#ClO!}OPO,59UOOOO,59Y,59YOOOO-E6i-E6iOOOO,58x,58xOOOO,59W,59WOOOO-E6j-E6j",stateData:"$h~ORUOTUOUUOVUOWUOXUOYUOZUO[UO]UOcPOeQO~OdVOR^XT^XU^XV^XW^XX^XY^XZ^X[^X]^Xc^Xe^X~OSZO~Oc[O~OdVOR^aT^aU^aV^aW^aX^aY^aZ^a[^a]^ac^ae^a~OR~T~U~V~W~Y~Z~[~]~R][ZYXWVUTc~",goto:"|cPPdPPPPPPPPPPPdioPuVRORTQTORYTQWPR]WSSOTRXR",nodeNames:"\u26A0 AlertRuleSearch FilterExpression DataSourceToken FilterValue NameSpaceToken LabelToken GroupToken RuleToken StateToken TypeToken HealthToken DashboardToken PluginsToken FreeFormExpression",maxTerm:21,skippedNodes:[0],repeatNodeCount:2,tokenData:"#<RRRsqr#`rs&lst#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]+n!]#W#`#W#X-Q#X#Z#`#Z#[Ig#[#]!$a#]#`#`#`#a!.s#a#b#`#b#c!7m#c#d#`#d#e!Fk#e#f#`#f#g#$g#g#h#+w#h#i#4q#i$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#gcSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`Q$wcSQqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rQ&VP;=`<%l$rQ&]P;=`;NQ$rR&cP;=`<%l#`R&iP;=`;NQ#`R&orX^(ypq(yqr(yst(ytu(yuv(yvw(ywx(yxy(yyz(yz{(y{|(y|!P(y!P!Q(y!Q![(y![!](y!]#y(y#y#z(y#z$f(y$f$g(y$g#BY(y#BY#BZ(y#BZ$Ch(y$IS$I_(y$I|$JO(y$JT$JU(y$JU$KV(y$KV$KW(y$KW&FU(y&FU&FV(y&FV;'S(y;'S;(d+b;(d;(e+h<%lO(yR(|sX^(ypq(yqr(yrs+Zst(ytu(yuv(yvw(ywx(yxy(yyz(yz{(y{|(y|!P(y!P!Q(y!Q![(y![!](y!]#y(y#y#z(y#z$f(y$f$g(y$g#BY(y#BY#BZ(y#BZ$Ch(y$IS$I_(y$I|$JO(y$JT$JU(y$JU$KV(y$KV$KW(y$KW&FU(y&FU&FV(y&FV;'S(y;'S;(d+b;(d;(e+h<%lO(yR+bOSQePR+eP;=`<%l(yR+kP;=`;NQ(yR+ucSQdPqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rR-XeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#T#`#T#U.j#U$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R.qfSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#g#`#g#h0V#h#i<R#i$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R0^eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#[#`#[#]1o#]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R1veSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#U#`#U#V3X#V$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R3`eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#c#`#c#d4q#d$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R4xeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#T#`#T#U6Z#U$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R6beSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#f#`#f#g7s#g$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R7zeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#W#`#W#X9]#X$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R9dcSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]:o!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R:vcSQ[Pqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rR<YeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#T#`#T#U=k#U$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R=reSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#g#`#g#h?T#h$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R?[eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#c#`#c#d@m#d$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R@teSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#i#`#i#jBV#j$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`RB^eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#f#`#f#gCo#g$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`RCveSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#V#`#V#WEX#W$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`RE`eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#X#`#X#YFq#Y$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`RFxcSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]HT!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`RH[cSQRPqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rRIneSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#f#`#f#gKP#g$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`RKWeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#c#`#c#dLi#d$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`RLpeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#i#`#i#jNR#j$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`RNYeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#d#`#d#e! k#e$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R! rcSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]!!}!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!#UcSQVPqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rR!$heSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#X#`#X#Y!%y#Y$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!&QeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#T#`#T#U!'c#U$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!'jeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#`#`#`#a!({#a$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!)SeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#h#`#h#i!*e#i$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!*leSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#[#`#[#]!+}#]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!,UcSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]!-a!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!-hcSQZPqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rR!.zeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#T#`#T#U!0]#U$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!0deSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#U#`#U#V!1u#V$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!1|eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#X#`#X#Y!3_#Y$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!3feSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#`#`#`#a!4w#a$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!5OcSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]!6Z!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!6bcSQUPqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rR!7teSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#T#`#T#U!9V#U$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!9^eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#a#`#a#b!:o#b$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!:veSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#X#`#X#Y!<X#Y$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!<`eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#g#`#g#h!=q#h$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!=xeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#d#`#d#e!?Z#e$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!?beSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#T#`#T#U!@s#U$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!@zeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#V#`#V#W!B]#W$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!BdeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#X#`#X#Y!Cu#Y$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!C|cSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]!EX!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!E`cSQTPqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rR!FreSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#`#`#`#a!HT#a$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!H[eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#i#`#i#j!Im#j$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!IteSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#Z#`#Z#[!KV#[$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!K^eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#]#`#]#^!Lo#^$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!LveSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#b#`#b#c!NX#c$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!N`eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#g#`#g#h# q#h$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R# xcSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]##T!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R##[cSQ]Pqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rR#$neSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#i#`#i#j#&P#j$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#&WeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#`#`#`#a#'i#a$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#'peSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#X#`#X#Y#)R#Y$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#)YcSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]#*e!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#*lcSQWPqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rR#,OeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#h#`#h#i#-a#i$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#-heSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#T#`#T#U#.y#U$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#/QeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#h#`#h#i#0c#i$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#0jeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#X#`#X#Y#1{#Y$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#2ScSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]#3_!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#3fcSQXPqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rR#4xeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#m#`#m#n#6Z#n$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#6beSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#d#`#d#e#7s#e$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#7zeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#X#`#X#Y#9]#Y$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#9dcSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]#:o!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#:vcSQYPqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$r",tokenizers:[0,1],topRules:{AlertRuleSearch:[0,1]},dialects:{dataSourceFilter:132,nameSpaceFilter:134,labelFilter:136,groupFilter:138,ruleFilter:140,stateFilter:78,typeFilter:142,healthFilter:144,dashboardFilter:146,pluginsFilter:148},tokenPrec:150}),A={[r]:"datasource",[a]:"namespace",[c]:"label",[h]:"rule",[o]:"group",[f]:"state",[d]:"type",[p]:"health",[m]:"dashboard",[v]:"plugins"};var L=(q=>(q.dataSource="dataSourceFilter",q.nameSpace="nameSpaceFilter",q.label="labelFilter",q.group="groupFilter",q.rule="ruleFilter",q.state="stateFilter",q.type="typeFilter",q.health="healthFilter",q.dashboard="dashboardFilter",q.plugins="pluginsFilter",q))(L||{});function N(q,ae,j){U(q,ae,te=>{if(te.type.id===s){const ne=F(q,te);if(ne.type&&ne.value){const le=j[ne.type];le&&le(ne.value)}}else if(te.type.id===l){const ne=j[l];ne&&ne(w(q,te))}})}function F(q,ae){if(ae.type.id!==s)throw new Error("Invalid node provided. Only FilterExpression nodes are supported");const j=ae.firstChild;if(!j)return{type:void 0,value:void 0};const te=ae.getChild(g),ne=te?(0,T.trim)(w(q,te),'"'):void 0;return{type:j.type.id,value:ne}}function w(q,ae){return q.slice(ae.from,ae.to).trim().replace(/\"/g,"")}function B(q,ae,j){const te=[];U(q,ae,le=>{le.type.id===s&&le.firstChild&&te.push(le.firstChild),le.type.id===l&&te.push(le)});const ne=[];return te.forEach(le=>{const z=j.findIndex(ee=>ee.type===le.type.id);if(z!==-1){if(le.parent?.type.is(s)){const ee=A[le.type.id],se=j.splice(z,1)[0];ne.push(`${ee}:${K(se.value)}`)}if(le.type.is(l)){const ee=j.splice(z,1)[0];ne.push(ee.value)}}}),j.forEach(le=>{le.type===l?ne.push(le.value):ne.push(`${A[le.type]}:${K(le.value)}`)}),ne.join(" ")}function U(q,ae,j){const te=ae.join(" "),le=S.configure({dialect:te}).parse(q).cursor();do j(le.node);while(le.next())}function K(q){return/\s/.test(q)?`"${q}"`:q}const V=[L.dataSource,L.nameSpace,L.label,L.group,L.rule,L.state,L.type,L.health,L.dashboard,L.plugins];var H=(q=>(q.Ok="ok",q.Error="error",q.NoData="nodata",q.Unknown="unknown",q))(H||{});function Y(q){const ae={labels:[],freeFormWords:[],dataSourceNames:[]},j={[r]:te=>ae.dataSourceNames.push(te),[a]:te=>ae.namespace=te,[o]:te=>ae.groupName=te,[h]:te=>ae.ruleName=te,[c]:te=>ae.labels.push(te),[f]:te=>ae.ruleState=J(te),[d]:te=>(0,n.nf)(te)?ae.ruleType=te:void 0,[p]:te=>ae.ruleHealth=(0,n.f6)(te),[m]:te=>ae.dashboardUid=te,[v]:te=>ae.plugins=te==="hide"?te:void 0,[l]:te=>ae.freeFormWords.push(te)};return N(q,V,j),ae}function X(q,ae){const j=[];return ae.dataSourceNames&&j.push(...ae.dataSourceNames.map(te=>({type:r,value:te}))),ae.namespace&&j.push({type:a,value:ae.namespace}),ae.groupName&&j.push({type:o,value:ae.groupName}),ae.ruleName&&j.push({type:h,value:ae.ruleName}),ae.ruleState&&j.push({type:f,value:ae.ruleState}),ae.ruleType&&j.push({type:d,value:ae.ruleType}),ae.ruleHealth&&j.push({type:p,value:ae.ruleHealth}),ae.labels&&j.push(...ae.labels.map(te=>({type:c,value:te}))),ae.dashboardUid&&j.push({type:m,value:ae.dashboardUid}),ae.plugins&&j.push({type:v,value:ae.plugins}),ae.freeFormWords&&j.push(...ae.freeFormWords.map(te=>({type:l,value:te}))),B(q,V,j)}function J(q){if(q==="normal")return t.cF.Inactive;if((0,t.Si)(q))return q}},28318:(k,R,e)=>{"use strict";e.d(R,{t:()=>S});var t=e(2543),n=e(39741),i=e(62467),s=e(66847),r=e(1005),g=e(81160),a=e(62938),c=e(39070),o=e(14236),h=e(72495),f=e(65879),d=e(43127),p=e(89667),m=e(19347),v=e(26657),l=e(12091),y=e(27677),u=e(69437),D=e(81583),E=e(72955),x=e(66718);const P={from:21600,to:0},b=(U,K)=>{const V=M(U,K);if(!V)return P;const{from:H,to:Y}=I(V,K);return!H.length&&!Y.length?P:{from:Math.max(...H),to:Math.min(...Y)}},M=(U,K)=>{switch(U.type){case x.Tz.classic:return O(U);case x.Tz.math:case x.Tz.sql:return T(U,K);case x.Tz.resample:case x.Tz.reduce:case x.Tz.threshold:return C(U)}},O=U=>U.conditions?.map(K=>K.query.params[0]),I=(U,K)=>{const V=[],H=[P.to];for(const Y of U){const X=K.find(J=>J.refId===Y);!X||!X.relativeTimeRange||(V.push(X.relativeTimeRange.from),H.push(X.relativeTimeRange.to))}return{from:V,to:H}},T=(U,K)=>K.filter(V=>V.queryType==="query"&&U.expression?.includes(V.refId)).map(V=>V.refId),C=U=>U.expression?[U.expression]:void 0;class S{constructor(K=(0,y.AI)(),V=(0,m.l)()){this.backendSrv=K,this.dataSourceSrv=V,this.subject=new n.m(1),this.lastResult={}}get(){return this.subject.asObservable()}async run(K,V){const H=L(K,c.Gu.Done),Y=[];for(const J of K){const q=J.model.refId;if((0,u.f)(J.model))continue;const ae=await this.dataSourceSrv.get(J.datasourceUid);ae instanceof v.iy&&ae.filterQuery&&!ae.filterQuery(J.model)&&Y.push(q)}const X=(0,t.reject)(K,J=>Y.includes(J.model.refId));if(X.length===0)return this.subject.next(H);this.subscription=A(this.backendSrv,X,V).subscribe({next:J=>{const q=B(J,(ae,j)=>{const te=this.lastResult[ae],ne=(0,o.N$)(j,te);return(0,E.B)(ne,te)});this.lastResult=q,this.subject.next(this.lastResult)},error:J=>{this.lastResult=w(this.lastResult,J),this.subject.next(this.lastResult)}})}cancel(){if(!this.subscription)return;this.subscription.unsubscribe();let K=!1;const V=B(this.lastResult,(H,Y)=>(Y.state===c.Gu.Loading&&(K=!0),{...Y,state:c.Gu.Done}));K&&this.subject.next(V)}destroy(){this.subject&&this.subject.complete(),this.cancel()}}const A=(U,K,V)=>{const H=L(K,c.Gu.Loading),Y={data:{data:K,condition:V},url:"/api/v1/eval",method:"POST",requestId:(0,a.A)()};return(0,h.k)({whileLoading:H,source:U.fetch(Y).pipe(F(H),(0,s.W)(X=>(0,i.of)(w(H,X))),(0,D.N)(U,Y.requestId),(0,r.u)())})},L=(U,K)=>U.reduce((V,H)=>(V[H.refId]={state:K,series:[],timeRange:N(H,U)},V),{}),N=(U,K)=>{if((0,u.f)(U.model)){const V=b(U.model,K);return f.relativeToTimeRange(V)}return U.relativeTimeRange?f.relativeToTimeRange(U.relativeTimeRange):(console.warn(`Query with refId: ${U.refId} did not have any relative time range, using default.`),(0,d.E2)())},F=U=>(0,g.T)(K=>{const{data:V}=K,H={};for(const[Y,X]of Object.entries(V.results)){const{error:J,status:q,frames:ae=[]}=X,j=J?[{message:J,refId:Y,status:q}]:[];H[Y]={errors:j,timeRange:U[Y].timeRange,state:c.Gu.Done,series:ae.map(p.or)}}return H}),w=(U,K)=>{const V=(0,l.u)(K);return B(U,(H,Y)=>({...Y,state:c.Gu.Error,error:V}))},B=(U,K)=>{const V={};for(const[H,Y]of Object.entries(U))V[H]=K(H,Y);return V}},70383:(k,R,e)=>{"use strict";e.d(R,{Kh:()=>m,VI:()=>f,b9:()=>h});var t=e(74848),n=e(96540),i=e(33390),s=e(60021),r=e(62190),g=e(39964),a=e(55740),c=e(57220);const o=n.createContext(void 0),h=({children:v,accessType:l,alertmanagerSourceName:y})=>{const[u,D]=(0,g.l)(),E=(0,r.W)(l),x=E.availableInternalDataSources.concat(E.availableExternalDataSources),P=n.useCallback(F=>{d(x,F)&&(F===c.hY?(i.A.delete(a.Oq),D({[a.DD]:void 0})):(i.A.set(a.Oq,F),D({[a.DD]:F})))},[x,D]),b=u.get(a.DD),M=i.A.get(a.Oq),O=c.hY;n.useEffect(()=>{b&&b!==M&&i.A.set(a.Oq,b)},[b,M]);const I=y??b??M??O,T=d(x,I)?I:void 0,C=(0,c.r3)(T)?.jsonData,S=T===c.hY,A=C?m(C):!1,N={selectedAlertmanager:T,hasConfigurationAPI:S||A,isGrafanaAlertmanager:S,selectedAlertmanagerConfig:C,availableAlertManagers:x,setSelectedAlertmanager:P};return(0,t.jsx)(o.Provider,{value:N,children:v})};function f(){const v=n.useContext(o);if(v===void 0)throw new Error("useAlertmanager must be used within a AlertmanagerContext");return v}function d(v,l){return v.map(u=>u.name).includes(l)}const p=[s.Oz.mimir,s.Oz.cortex,void 0];function m(v){return p.includes(v.implementation)}},23770:(k,R,e)=>{"use strict";e.d(R,{nO:()=>te,$8:()=>ne,g6:()=>K,D3:()=>j,yo:()=>B,wE:()=>F,nV:()=>U,Tp:()=>q,Om:()=>ae,JH:()=>Y,Lc:()=>L,mB:()=>S,eB:()=>A,HB:()=>N,DC:()=>w,Qt:()=>C,uQ:()=>z,_$:()=>V,bO:()=>le,RW:()=>X,DN:()=>ee});var t=e(65307),n=e(2543),i=e(39601),s=e(34867),r=e(94822),g=e(27677),a=e(25027),c=e(79938),o=e(32415),h=e(82843),f=e(17172);function d(se){return(0,f.AI)().get("/api/annotations",{alertId:se}).then(ie=>ie?.sort(p))}function p(se,ie){const Z=(ye,re)=>ye>re?-1:re>ye?1:0,oe=Z(se.timeEnd,ie.timeEnd);if(oe)return oe;const ce=Z(se.time,ie.time);return ce||Z(se.id,ie.id)}var m=e(92240),v=e(49498),l=e(28220),y=e(98164),u=e(57220),D=e(56361),E=e(88467),x=e(18461),P=e(63066),b=e(23662);function M(se){const ie=async De=>{if((0,b.A4)(De)){const ge=await(0,l.iy)(se);for(const[Te,Le]of Object.entries(ge))for(const Ye of Le){const je=Ye.rules.find(Ze=>(0,b.lT)(Ze)&&Ze.grafana_alert?.uid===De.uid);if(je)return{group:Ye,ruleSourceName:u.hY,namespace:Te,namespace_uid:(0,b.lT)(je)&&je.grafana_alert.namespace_uid||void 0,rule:je}}}if((0,b.X4)(De)){const{ruleSourceName:ge,namespace:Te,groupName:Le}=De,Ye=await(0,l.HO)(se,Te,Le);if(!Ye)return null;const je=Ye.rules.find(Ze=>{const Ne=x.P1(ge,Te,Ye.name,Ze);return x.LC(Ne,De)});return je?{group:Ye,ruleSourceName:ge,namespace:Te,rule:je}:null}if((0,b.Mj)(De))throw new Error("Native prometheus rules can not be edited in grafana.");return null},Z=async De=>{const{namespace:ge,group:Te,rule:Le,namespace_uid:Ye}=De;if(Te.rules.length===1){await(0,l.AJ)(se,Ye||ge,Te.name);return}await(0,l.E8)(se,Ye||ge,{...Te,rules:Te.rules.filter(je=>je!==Le)})},oe=async(De,ge,Te)=>{const{dataSourceName:Le,group:Ye,namespace:je}=De,Ze=(0,P.l1)(De);if(Le&&Ye&&je){if(Te){const Ue=await ie(x.Yd(Te));if(!Ue)throw new Error("Rule not found.");if(Ue.namespace!==je||Ue.group.name!==Ye)await Z(Ue);else{const $e={...Ue.group,rules:Ue.group.rules.map(ze=>ze===Ue.rule?Ze:ze),evaluateEvery:ge};return await(0,l.E8)(se,je,$e),x.P1(Le,je,Ye,Ze)}}const Ne=await(0,l.HO)(se,je,Ye),Pe=Ne?{...Ne,rules:[...Ne.rules,Ze]}:{name:Ye,rules:[Ze]};return await(0,l.E8)(se,je,Pe),x.P1(Le,je,Ye,Ze)}else throw new Error("Data source and location must be specified")},ce=async(De,ge,Te)=>{const{folder:Le,group:Ye}=De;if(!Le)throw new Error("Folder must be specified");const je=(0,P.Z9)(De),Ze=Le.uid,Ne={name:Ye,interval:ge};if(!Te)return ye(Ze,Ne,je);const Pe=await ie(x.Yd(Te));if(!Pe)throw new Error("Rule not found.");const Ue=Pe.namespace_uid===Ze,$e=Pe.group.name===De.group;return Ue&&$e?ue(Pe,je,ge):re(Ze,Ne,Pe,je)},ye=async(De,ge,Te)=>{const Le=await(0,l.HO)(se,De,ge.name);if(!Le)throw new Error(`No group found with name "${ge.name}"`);const Ye={name:ge.name,interval:ge.interval,rules:(Le.rules??[]).concat(Te)};return await(0,l.E8)(se,De,Ye),{uid:Te.grafana_alert.uid??"",ruleSourceName:u.hY}},re=async(De,ge,Te,Le)=>(O(Te,Le),await ye(De,ge,Le)),ue=async(De,ge,Te)=>{O(De,ge);const Le=De.group.rules.map(Ye=>(0,b.lT)(Ye)&&Ye.grafana_alert.uid===De.rule.grafana_alert.uid?ge:Ye);return await(0,l.E8)(se,De.namespace_uid??"",{name:De.group.name,interval:Te,rules:Le}),{uid:De.rule.grafana_alert.uid,ruleSourceName:u.hY}};return{findEditableRule:ie,deleteRule:Z,saveLotexRule:oe,saveGrafanaRule:ce}}function O(se,ie){if(!(0,b.lT)(se.rule))throw new Error("The rule is not a Grafana managed rule");const Z=se.rule.grafana_alert.uid;ie.grafana_alert.uid=Z}var I=e(25968);function T(se,ie){const Z=se().unifiedAlerting.dataSources,oe=Z[ie]?.result,ce=Z[ie]?.error;if(!oe){const ye=new Error(`Data source configuration is not available for "${ie}" data source`);throw ce&&(ye.cause=ce),ye}return oe}function C(se,ie){const Z=T(se,ie);if(!Z.rulerConfig)throw new Error(`Ruler API is not available for ${ie}`);return Z.rulerConfig}const S=(0,t.zD)("unifiedalerting/fetchPromRules",async({rulesSourceName:se,filter:ie,limitAlerts:Z,matcher:oe,state:ce,identifier:ye},re)=>{await re.dispatch(w({rulesSourceName:se}));const ue=(0,a.U7)("unifiedalerting/fetchPromRules",v.sA,{dataSourceName:se,thunk:"unifiedalerting/fetchPromRules"});return await(0,E.$I)(ue(se,ie,Z,oe,ce,ye))}),A=(0,t.zD)("unifiedalerting/fetchRulerRules",async({rulesSourceName:se,filter:ie},{dispatch:Z,getState:oe})=>{await Z(w({rulesSourceName:se}));const ce=C(oe,se),ye=(0,a.Ke)("unifiedalerting/fetchRulerRules",l.iy,{dataSourceName:se,thunk:"unifiedalerting/fetchRulerRules"});return await(0,E.$I)(ye(ce,ie))});function L({rulesSourceName:se,identifier:ie,filter:Z,limitAlerts:oe,matcher:ce,state:ye}){return async(re,ue)=>{await re(w({rulesSourceName:se}));const De=T(ue,se);await re(S({rulesSourceName:se,identifier:ie,filter:Z,limitAlerts:oe,matcher:ce,state:ye})),De.rulerConfig&&await re(A({rulesSourceName:se}))}}function N(se){return(ie,Z)=>{const{rulerRules:oe}=Z().unifiedAlerting,ce=oe[se];(0,n.isEmpty)(ce?.result)&&!(ce&&(0,b.$7)(ce))&&!ce?.loading&&ie(A({rulesSourceName:se}))}}function F(){return async se=>{const ie=(0,u.gR)().map(Z=>se(w({rulesSourceName:Z})));await Promise.allSettled(ie)}}const w=(0,t.zD)("unifiedalerting/fetchPromBuildinfo",async({rulesSourceName:se})=>(0,E.$I)((async()=>{if(se===u.hY)return{name:u.hY,id:u.hY,rulerConfig:{dataSourceName:u.hY,apiVersion:"legacy"}};const ie=(0,u.Jz)(se);if(!ie)throw new Error(`Missing data source configuration for ${se}`);const{id:Z,name:oe}=ie,ye=await(0,a.QA)("unifiedalerting/fetchPromBuildinfo",m.nD,{dataSourceName:se,thunk:"unifiedalerting/fetchPromBuildinfo"})(oe),re=ye.features.rulerApiEnabled?{dataSourceName:oe,apiVersion:ye.application===r.N1.Cortex?"legacy":"config"}:void 0;return{name:oe,id:Z,rulerConfig:re}})()),{condition:({rulesSourceName:se},{getState:ie})=>{const Z=ie().unifiedAlerting.dataSources,oe=!!Z[se]?.result,ce=!!Z[se]?.error;return!(oe||ce)}});function B(se=!1,ie={}){return async(Z,oe)=>{const ce=performance.now();await Promise.allSettled((0,u.gR)().map(async ye=>{await Z(w({rulesSourceName:ye}));const{promRules:re,rulerRules:ue,dataSources:De}=oe().unifiedAlerting,ge=De[ye].result;if(!ge)return;const Te=se||!re[ye]?.loading,Le=(se||!ue[ye]?.loading)&&!!ge.rulerConfig;await Promise.allSettled([Te&&Z(S({rulesSourceName:ye,...ie})),Le&&Z(A({rulesSourceName:ye}))])})),(0,s.l$)("unifiedalerting/fetchAllPromAndRulerRulesAction",{loadTimeMs:performance.now()-ce})}}function U(se=!1){return async(ie,Z)=>{const{promRules:oe}=Z().unifiedAlerting;(0,u.gR)().map(ce=>{(se||!oe[ce]?.loading)&&ie(S({rulesSourceName:ce}))})}}function K(se,ie){return async(Z,oe)=>{(0,E.v5)((async()=>{const ce=(0,u.EV)(se.rulesSource),ye=C(oe,ce);await(0,l.AJ)(ye,se.name,ie.name),await Z(L({rulesSourceName:ce}))})(),{successMessage:"Group deleted"})}}const V=(0,t.zD)("unifiedalerting/saveRuleForm",({values:se,existing:ie,redirectOnSave:Z,evaluateEvery:oe},ce)=>(0,E.v5)((0,E.$I)((async()=>{const{type:ye}=se;if(!ye)return;let re;if((0,b.s_)(ye)){if(!se.dataSourceName)throw new Error("The Data source has not been defined.");const ue=C(ce.getState,se.dataSourceName);re=await M(ue).saveLotexRule(se,oe,ie),await ce.dispatch(A({rulesSourceName:se.dataSourceName}))}else if((0,b.H2)(ye)){const ue=C(ce.getState,u.hY);re=await M(ue).saveGrafanaRule(se,oe,ie),H(se,ie),ce.dispatch(c.hK.util.invalidateTags([{type:"GrafanaRulerRule",id:re.uid}]))}else throw new Error("Unexpected rule form type");if((0,a.fH)(a.le.successSavingAlertRule,{type:ye,isNew:(!ie).toString()}),Z)i.Ny.push(Z);else{const ue=x.$9(re);if(!ue){i.Ny.push("/alerting/list");return}const De=`/alerting/${encodeURIComponent(ue)}/edit`;i.Ny.getLocation().pathname!==De&&i.Ny.replace(De)}})()),{successMessage:ie?`Rule "${se.name}" updated.`:`Rule "${se.name}" saved.`,errorMessage:"Failed to save rule"}));function H(se,ie){if((0,b.lT)(ie?.rule)){const oe=!!ie?.rule.grafana_alert?.notification_settings?.receiver,ce=se.manualRouting,ye=!oe&&ce,re=oe&&!ce;ye&&(0,a.Fb)(),re&&(0,a.hJ)()}}const Y=(0,t.zD)("unifiedalerting/fetchGrafanaAnnotations",se=>(0,E.$I)(d(se))),X=(0,t.zD)("unifiedalerting/updateAMConfig",({alertManagerSourceName:se,oldConfig:ie,newConfig:Z,successMessage:oe,redirectPath:ce,redirectSearch:ye},re)=>(0,E.v5)((0,E.$I)((async()=>{const ue=await re.dispatch(h.m.endpoints.getAlertmanagerConfiguration.initiate(se,{forceRefetch:!0})).unwrap(),De=(0,n.isEmpty)(ue.alertmanager_config)&&(0,n.isEmpty)(ue.template_files),ge=JSON.stringify(ue)!==JSON.stringify(ie);if(!De&&ge)throw new Error("A newer Alertmanager configuration is available. Please reload the page and try again to not overwrite recent changes.");if(await(0,o.vk)(se,(0,y.MZ)(Z)),re.dispatch(h.m.util.invalidateTags(["AlertmanagerConfiguration"])),ce){const Te=new URLSearchParams(ye??"");i.Ny.push((0,D.nL)(ce,se,Te))}})()),{successMessage:oe})),J=(se,ie)=>async Z=>{const oe=await Z(alertmanagerApi.endpoints.getAlertmanagerConfiguration.initiate(ie)).unwrap();if(!oe)throw new Error(`Config for ${ie} not found`);if(!oe.alertmanager_config.receivers?.find(ye=>ye.name===se))throw new Error(`Cannot delete receiver ${se}: not found in config.`);const ce={...oe,alertmanager_config:{...oe.alertmanager_config,receivers:oe.alertmanager_config.receivers.filter(ye=>ye.name!==se)}};return Z(X({newConfig:ce,oldConfig:oe,alertManagerSourceName:ie,successMessage:"Contact point deleted."}))},q=(0,t.zD)("unifiedalerting/fetchFolder",se=>(0,E.$I)(g.IB.getFolderByUid(se,{withAccessControl:!0}))),ae=se=>(ie,Z)=>{Z().unifiedAlerting.folders[se]?.dispatched||ie(q(se))},j=(0,t.zD)("unifiedalerting/fetchAlertGroups",se=>(0,E.$I)((0,o.f4)(se))),te=(0,t.zD)("unifiedalerting/deleteAlertManagerConfig",async(se,ie)=>(0,E.v5)((0,E.$I)((async()=>{await(0,o.nd)(se),await ie.dispatch(h.m.util.invalidateTags(["AlertmanagerConfiguration"]))})()),{errorMessage:"Failed to reset Alertmanager configuration",successMessage:"Alertmanager configuration reset."})),ne=(se,ie)=>async Z=>{const oe=await Z(h.m.endpoints.getAlertmanagerConfiguration.initiate(se)).unwrap(),ce=se===u.hY,ye=(oe?.alertmanager_config?.mute_time_intervals??[])?.filter(({name:Te})=>Te!==ie)??[],re=(oe?.alertmanager_config?.time_intervals??[])?.filter(({name:Te})=>Te!==ie)??[],ue=ce?{mute_time_intervals:[...ye,...re]}:{time_intervals:re,mute_time_intervals:ye},{mute_time_intervals:De,...ge}=oe?.alertmanager_config??{};return(0,E.v5)(Z(X({alertManagerSourceName:se,oldConfig:oe,newConfig:{...oe,alertmanager_config:{...ge,route:oe.alertmanager_config.route?(0,y.Dk)(ie,oe.alertmanager_config?.route):void 0,...ue}}})),{successMessage:`Deleted "${ie}" from Alertmanager configuration`,errorMessage:"Failed to delete mute timing"})},le=(0,t.zD)("unifiedalerting/testReceivers",({alertManagerSourceName:se,receivers:ie,alert:Z})=>(0,E.v5)((0,E.$I)((0,o.By)(se,ie,Z)),{errorMessage:"Failed to send test alert.",successMessage:"Test alert sent."})),z=(se,ie)=>se.filter(Z=>{const{forDuration:oe}=(0,b.jg)(Z,ie),ce=oe?(0,I.P8)(oe):null,ye=(0,I.P8)(ie);return ce?ce!==0&&ce<ye:!1}),ee=(0,t.zD)("unifiedalerting/updateRulesOrderForGroup",async(se,ie)=>(0,E.v5)((0,E.$I)((async()=>{const{rulesSourceName:Z,namespaceName:oe,groupName:ce,newRules:ye,folderUid:re}=se,ue=C(ie.getState,Z),ge=(await(0,l.iy)(ue))[oe].find(Le=>Le.name===ce);if(!ge)throw new Error(`Group "${ce}" not found.`);if(ge.rules.length!==ye.length){const Le=new Error("Rules count mismatch. Please refresh the page and try again.");throw(0,a.vV)(Le,{namespaceName:oe,groupName:ce}),Le}const Te={name:ge.name,interval:ge.interval,rules:ye};await(0,l.E8)(ue,re??oe,Te),await ie.dispatch(A({rulesSourceName:Z}))})()),{errorMessage:"Failed to update namespace / group",successMessage:"Update successful"}))},22620:(k,R,e)=>{"use strict";e.d(R,{H:()=>n});var t=e(32196);const n=i=>(0,t.css)({float:"none",display:"flex",justifyContent:"flex-start",margin:i.spacing(2,0)})},99494:(k,R,e)=>{"use strict";e.d(R,{W:()=>t});var t=(n=>(n.Incident="grafana-incident-app",n.OnCall="grafana-oncall-app",n.MachineLearning="grafana-ml-app",n.Labels="grafana-labels-app",n.Slo="grafana-slo-app",n))(t||{})},86590:(k,R,e)=>{"use strict";e.d(R,{Z:()=>t});var t=(n=>(n.grafana="grafana-alerting",n.grafanaRecording="grafana-recording",n.cloudAlerting="cloud-alerting",n.cloudRecording="cloud-recording",n))(t||{})},41068:(k,R,e)=>{"use strict";e.d(R,{y:()=>t});var t=(n=>(n.seconds="s",n.minutes="m",n.hours="h",n.days="d",n.weeks="w",n))(t||{})},75471:(k,R,e)=>{"use strict";e.d(R,{C0:()=>m,HL:()=>g,Q9:()=>v,VQ:()=>a,Wd:()=>p,jy:()=>f,lV:()=>d,nU:()=>c,q0:()=>l});var t=e(2913),n=e(16233),i=e(31678),s=e(57220);function r(y){return(0,s.z2)(y)?"grafana":"external"}const g={read:{grafana:i.AccessControlAction.AlertingInstanceRead,external:i.AccessControlAction.AlertingInstancesExternalRead},create:{grafana:i.AccessControlAction.AlertingInstanceCreate,external:i.AccessControlAction.AlertingInstancesExternalWrite},update:{grafana:i.AccessControlAction.AlertingInstanceUpdate,external:i.AccessControlAction.AlertingInstancesExternalWrite},delete:{grafana:i.AccessControlAction.AlertingInstanceUpdate,external:i.AccessControlAction.AlertingInstancesExternalWrite}},a={read:{grafana:i.AccessControlAction.AlertingNotificationsRead,external:i.AccessControlAction.AlertingNotificationsExternalRead},create:{grafana:i.AccessControlAction.AlertingNotificationsWrite,external:i.AccessControlAction.AlertingNotificationsExternalWrite},update:{grafana:i.AccessControlAction.AlertingNotificationsWrite,external:i.AccessControlAction.AlertingNotificationsExternalWrite},delete:{grafana:i.AccessControlAction.AlertingNotificationsWrite,external:i.AccessControlAction.AlertingNotificationsExternalWrite}},c={read:{grafana:i.AccessControlAction.AlertingSilenceRead,external:i.AccessControlAction.AlertingInstanceRead},create:{grafana:i.AccessControlAction.AlertingSilenceCreate,external:i.AccessControlAction.AlertingInstancesExternalWrite},update:{grafana:i.AccessControlAction.AlertingSilenceUpdate,external:i.AccessControlAction.AlertingInstancesExternalWrite}},o={read:i.AccessControlAction.AlertingProvisioningRead,readSecrets:i.AccessControlAction.AlertingProvisioningReadSecrets,write:i.AccessControlAction.AlertingProvisioningWrite},h={read:{grafana:i.AccessControlAction.AlertingRuleRead,external:i.AccessControlAction.AlertingRuleExternalRead},create:{grafana:i.AccessControlAction.AlertingRuleCreate,external:i.AccessControlAction.AlertingRuleExternalWrite},update:{grafana:i.AccessControlAction.AlertingRuleUpdate,external:i.AccessControlAction.AlertingRuleExternalWrite},delete:{grafana:i.AccessControlAction.AlertingRuleDelete,external:i.AccessControlAction.AlertingRuleExternalWrite}};function f(y){const u=r(y);return{read:g.read[u],create:g.create[u],update:g.update[u],delete:g.delete[u]}}function d(y){const u=r(y);return{read:a.read[u],create:a.create[u],update:a.update[u],delete:a.delete[u],provisioning:o}}function p(y){const u=r(y);return{read:h.read[u],create:h.create[u],update:h.update[u],delete:h.delete[u]}}function m(y){return()=>n.TP.evaluatePermission(y)}function v(){return{canCreateGrafanaRules:n.TP.hasPermission(i.AccessControlAction.FoldersRead)&&n.TP.hasPermission(h.create.grafana),canCreateCloudRules:n.TP.hasPermission(i.AccessControlAction.DataSourcesRead)&&n.TP.hasPermission(h.create.external),canEditRules:y=>n.TP.hasPermission(p(y).update)}}function l(){const{unifiedAlertingEnabled:y}=(0,t.zj)(),u=n.TP.hasPermission(p(s.hY).read),D=n.TP.hasPermission(p(s.hY).update);return y&&u&&D}},98164:(k,R,e)=>{"use strict";e.d(R,{$P:()=>T,Av:()=>u,Dk:()=>c,Dm:()=>M,EU:()=>D,LF:()=>b,Lt:()=>o,MN:()=>f,MU:()=>p,MZ:()=>a,NL:()=>y,UL:()=>I,VE:()=>E,Wc:()=>m,mP:()=>C,uH:()=>O,xH:()=>l});var t=e(2543),n=e.n(t),i=e(60021),s=e(82775),r=e(57220),g=e(32642);function a(S){return S.alertmanager_config.receivers||(S.alertmanager_config.receivers=[{name:"default "}]),S.alertmanager_config.route||(S.alertmanager_config.route={receiver:S.alertmanager_config.receivers[0].name}),S.template_files||(S.template_files={}),S}function c(S,A){return{...A,mute_time_intervals:A.mute_time_intervals?.filter(N=>N!==S)??[],routes:A.routes?.map(N=>c(S,N))}}function o(S,A,L){return{...L,mute_time_intervals:L.mute_time_intervals?.map(N=>N===A?S:N),routes:L.routes?.map(N=>o(S,A,N))}}function h(S){return S.map(([A,L,N])=>[A,L,unquoteWithUnescape(N)])}function f(S){return S.isEqual?S.isRegex?i.ho.regex:i.ho.equal:S.isRegex?i.ho.notRegex:i.ho.notEqual}function d(S){switch(S){case i.ho.equal:return{isEqual:!0,isRegex:!1};case i.ho.notEqual:return{isEqual:!1,isRegex:!1};case i.ho.regex:return{isEqual:!0,isRegex:!0};case i.ho.notRegex:return{isEqual:!1,isRegex:!0}}}function p(S){return{name:S.name,value:S.value,operator:f(S)}}function m(S){return{name:S.name,value:S.value,...d(S.operator)}}function v(S){return`{ ${S.map(p).reduce((N,F)=>{const w=`${F.name}${F.operator}"${F.value}"`;return N?`${N}, ${w}`:w},"")} }`}const l=[{label:i.ho.equal,description:"Equals",value:i.ho.equal},{label:i.ho.notEqual,description:"Does not equal",value:i.ho.notEqual},{label:i.ho.regex,description:"Matches regex",value:i.ho.regex},{label:i.ho.notRegex,description:"Does not match regex",value:i.ho.notRegex}];function y(S){const A=f(S);return[S.name,A,S.value]}function u(S,A){return A.every(({name:L,value:N,isRegex:F,isEqual:w})=>Object.entries(S).some(([B,U])=>{const K=L===B;let V;return w&&!F&&(V=N===U),!w&&!F&&(V=N!==U),w&&F&&(V=new RegExp(N).test(U)),!w&&F&&(V=!new RegExp(N).test(U)),K&&V}))}function D(...S){const A=S.map(g.Zc).flat(),L=(0,t.uniqWith)(A,t.isEqual);return v(L)}function E(S){return S===r.hY?"default":"unquote"}function x(){return getAllDataSources().filter(S=>S.type===DataSourceType.Alertmanager)}function P(S){return x().find(A=>S===A.uid)}function b(S){const{times:A,weekdays:L,days_of_month:N,months:F,years:w,location:B}=S,U=M(A,B),K=O(L),V=I(N),H=T(F),Y=C(w);return[U,K,V,H,Y].join(", ")}function M(S,A){return"Times: "+(S?S?.map(({start_time:L,end_time:N})=>`${L} - ${N} [${A??"UTC"}]`).join(" and "):"All")}function O(S){return"Weekdays: "+(S?.map(A=>{if(A.includes(":"))return A.split(":").map(L=>{const N=L.slice(0,3);return N[0].toLocaleUpperCase()+N.slice(1)}).join("-");{const L=A.slice(0,3);return L[0].toLocaleUpperCase()+L.slice(1)}}).join(", ")??"All")}function I(S){return"Days of the month: "+(S?.join(", ")??"All")}function T(S){return"Months: "+(S?.join(", ")??"All")}function C(S){return"Years: "+(S?.join(", ")??"All")}},33225:(k,R,e)=>{"use strict";e.d(R,{Hx:()=>r,gO:()=>g});var t=e(96540),n=e(55740),i=e(56361);function s(a){return{dashboardUID:a.find(([c])=>c===n.YH.dashboardUID)?.[1],panelId:a.find(([c])=>c===n.YH.panelID)?.[1]}}function r(a){return(0,t.useMemo)(()=>Object.entries(a||{}).filter(([c,o])=>!!o.trim()),[a])}function g(a){const c=new Map,{panelId:o,dashboardUID:h}=s(a);return h&&c.set(n.YH.dashboardUID,(0,i.JM)(h)),h&&o&&c.set(n.YH.panelID,(0,i.D2)(h,o)),c}},82775:(k,R,e)=>{"use strict";e.d(R,{k:()=>i,q:()=>s});var t=e(32264),n=e(25968);function i(){return Object.values(t.$.datasources)}function s(r){if(!(0,n.TN)(t.$.unifiedAlerting.minInterval))return{globalLimit:0,exceedsLimit:!1};const g=(0,n.P8)(t.$.unifiedAlerting.minInterval);if(!r||!(0,n.TN)(r))return{globalLimit:g,exceedsLimit:!1};const a=(0,n.P8)(r),c=g>a&&a>0;return{globalLimit:g,exceedsLimit:c}}},55740:(k,R,e)=>{"use strict";e.d(R,{DD:()=>i,H8:()=>p,HH:()=>n,J3:()=>d,Oq:()=>s,U3:()=>g,UU:()=>t,YH:()=>f,cB:()=>a,kW:()=>v,kl:()=>m,wG:()=>r});const t="ruler not supported",n=2e4,i="alertmanager",s="alerting-alertmanager",r=2e4,g=2e4,a=2e4,c="timeseries",o="table",h="stat";var f=(l=>(l.description="description",l.summary="summary",l.runbookURL="runbook_url",l.alertId="__alertId__",l.dashboardUID="__dashboardUid__",l.panelID="__panelId__",l))(f||{});const d={description:"Description",summary:"Summary",runbook_url:"Runbook URL",__dashboardUid__:"Dashboard UID",__panelId__:"Panel ID",__alertId__:"Alert ID"},p={description:"Description of what the alert rule does.",summary:"Short summary of what happened and why.",runbook_url:"Webpage where you keep your runbook for the alert.",__dashboardUid__:"",__panelId__:"",__alertId__:""},m=[{key:"summary",value:""},{key:"description",value:""},{key:"runbook_url",value:""}],v="__alert_rule_uid__"},57220:(k,R,e)=>{"use strict";e.d(R,{AL:()=>F,EV:()=>A,Eb:()=>N,Jz:()=>y,Vr:()=>ae,Zw:()=>V,bD:()=>E,cy:()=>O,gR:()=>C,hP:()=>q,hY:()=>f,iV:()=>P,k5:()=>X,lS:()=>S,oh:()=>U,ol:()=>p,qi:()=>v,r3:()=>K,sq:()=>I,v0:()=>L,v8:()=>l,vv:()=>d,w5:()=>Y,y9:()=>J,yc:()=>w,z2:()=>B});var t=e(19347),n=e(16233),i=e(60021),s=e(31678),r=e(94822),g=e(82843),a=e(62190),c=e(70383),o=e(75471),h=e(82775);const f="grafana",d="-- Grafana --";var p=(j=>(j.Alertmanager="alertmanager",j.Loki="loki",j.Prometheus="prometheus",j))(p||{});const m=["loki","prometheus"];function v(){return n.TP.hasPermission(s.AccessControlAction.AlertingRuleExternalRead)?(0,h.k)().filter(j=>m.includes(j.type)&&j.jsonData.manageAlerts!==!1).sort((j,te)=>j.name.localeCompare(te.name)):[]}function l(j){return B(j)?"grafana":j.uid??j.id}function y(j){return v().find(te=>te.name===j)}function u(){return(0,h.k)().filter(D).sort((j,te)=>j.name.localeCompare(te.name))}function D(j){return j.type==="alertmanager"}function E(j){return j.type==="alertmanager"}function x(){return u().filter(j=>j.jsonData.handleGrafanaManagedAlerts)}function P(j){return j.jsonData.handleGrafanaManagedAlerts===!0}const b={name:f,imgUrl:"public/img/grafana_icon.svg",hasConfigurationAPI:!0};function M(){return[b,...u().map(j=>({name:j.name,displayName:j.name,imgUrl:j.meta.info.logos.small,meta:j.meta}))]}function O(j){const te=(0,a.W)(j),ne=te.availableExternalDataSources.filter(se=>se.handleGrafanaManagedAlerts),le=te.availableInternalDataSources,{currentData:z}=g.m.endpoints.getGrafanaAlertingConfigurationStatus.useQuery();switch(z?.alertmanagersChoice){case i.nA.Internal:return le;case i.nA.External:return ne;default:return[...le,...ne]}}function I(j){const te=[],ne=[],le={instance:o.HL.read,notification:o.VQ.read,silence:o.nU.read};if(Object.values(le).flatMap(se=>se.grafana).some(se=>n.TP.hasPermission(se))&&te.push(b),n.TP.hasPermission(le[j].external)){const se=u().map(ie=>({name:ie.name,displayName:ie.name,imgUrl:ie.meta.info.logos.small,meta:ie.meta,hasConfigurationAPI:(0,c.Kh)(ie.jsonData),handleGrafanaManagedAlerts:ie.jsonData.handleGrafanaManagedAlerts}));ne.push(...se)}return{availableInternalDataSources:te,availableExternalDataSources:ne}}function T(j){const te=U(j);if(!te)throw new Error(`Data source ${j} not found`);if(te.type!=="loki"&&te.type!=="prometheus")throw new Error(`Unexpected data source type ${te.type}`);return te}function C(){const j=v().map(te=>te.name);return n.TP.hasPermission(s.AccessControlAction.AlertingRuleRead)&&j.push(f),j}function S(){const j=v();return n.TP.hasPermission(s.AccessControlAction.AlertingRuleRead)&&j.push(f),j}function A(j){return N(j)?j.name:j}function L(j){return N(j)?j.uid:f}function N(j){return j!==f}function F(j){return j!==f&&K(j)?.jsonData?.implementation===i.Oz.prometheus}function w(j){return j.readOnly===!0}function B(j){return j===f}function U(j){return(0,h.k)().find(te=>te.name===j)}function K(j){return(0,h.k)().filter(D).find(te=>te.name===j)}function V(j){return j===f?f:U(j)}function H(j){if(j===f)return f;const te=U(j);if(!te)throw new Error(`Datasource "${j}" not found`);return String(te.id)}function Y(j){if(j===f)return f;const te=U(j);if(!te)throw new Error(`Datasource "${j}" not found`);return te.uid}function X(){return(0,t.l)().getList({alerting:!0})[0]}function J(){const j=(0,t.l)().getInstanceSettings("default");return j?.meta.alerting??!1?j:X()}function q(j){return j.jsonData.manageAlerts!==!1}function ae(j){return B(j)?"grafana":"prometheusType"in j.jsonData?j.jsonData?.prometheusType??r.N1.Prometheus:j.type==="loki"?"loki":r.N1.Prometheus}},75214:(k,R,e)=>{"use strict";e.d(R,{Dd:()=>n,F2:()=>a,M4:()=>t,lL:()=>r,rm:()=>g,w0:()=>c,x4:()=>s,zm:()=>i});function t(o){return Object.entries(o).map(([h,f])=>`${h}=${f}`).sort()}function n(o){return Object.entries(o).map(([h,f])=>[h,f])}function i(o){const h={};return o.forEach(f=>{h[f[0]]=f[1]}),h}function s(o){const h={};return o.forEach(f=>{f.key&&(h[f.key]=f.value)}),h}const r="__grafana_origin";function g(o){return Object.keys(o).filter(h=>!a(h)).length}function a(o){return o.startsWith("__")&&o.endsWith("__")||o===r}const c=([o,h])=>a(o)},32642:(k,R,e)=>{"use strict";e.d(R,{Ig:()=>u,J$:()=>p,J9:()=>d,S6:()=>o,So:()=>a,Zc:()=>h,b2:()=>y,ou:()=>f,qR:()=>g,t8:()=>D});var t=e(2543),n=e.n(t),i=e(60021),s=e(75214);const r=[i.ho.regex,i.ho.notRegex,i.ho.notEqual,i.ho.equal];function g(b){if(b.startsWith("{")&&b.endsWith("}"))throw new Error("this function does not support PromQL-style matcher syntax, call parsePromQLStyleMatcher() instead");const M=r.map(S=>[S,b.indexOf(S)]).filter(([S,A])=>A>-1).sort((S,A)=>S[1]-A[1]);if(!M.length)throw new Error(`Invalid matcher: ${b}`);const[O,I]=M[0],T=b.slice(0,I).trim(),C=b.slice(I+O.length);if(!T)throw new Error(`Invalid matcher: ${b}`);return{name:T,value:C,isRegex:O===i.ho.regex||O===i.ho.notRegex,isEqual:O===i.ho.equal||O===i.ho.regex}}function a(b){return E(b)?c(b):[g(b)]}function c(b){if(!E(b))throw new Error("not a PromQL style matcher");return o(b)}function o(b){const M=/,(?=(?:[^"]*"[^"]*")*[^"]*$)/,O=b.replace(/^\{/,"").replace(/\}$/,"").trim().split(M);return(0,t.compact)(O).flatMap(g).map(I=>({...I,name:u(I.name),value:u(I.value)}))}function h(b){try{return o(b)}catch{return[]}}function f(b){const M=b.filter(O=>!!O.trim()).map(O=>g(O));return(0,t.uniqBy)(M,O=>O.name)}const d=b=>{const M=Object.entries(b).filter(([I])=>!(0,s.F2)(I)),O=new URLSearchParams;return M.forEach(([I,T])=>O.append("matcher",`${I}=${T}`)),O},p=b=>{let M=[];return b.matchers&&b.matchers.forEach(O=>{const I=a(O).map(x);M=M.concat(I)}),b.object_matchers&&M.push(...b.object_matchers),b.match_re&&Object.entries(b.match_re).forEach(([O,I])=>{M.push([O,i.ho.regex,I])}),b.match&&Object.entries(b.match).forEach(([O,I])=>{M.push([O,i.ho.equal,I])}),M};function m(b){return`"${b.replace(/[\\"]/g,O=>`\\${O}`)}"`}const v=/[\{\}\!\=\~\,\\\"\'\`\s]+/;function l(b){return v.test(b)?m(b):b}const y=({name:b,operator:M,value:O})=>{const I=l(b),T=m(O);return`${I}${M}${T}`};function u(b){return/^"(.*)"$/.test(b)?b.replace(/^"(.*)"$/,"$1").replace(/\\"/g,'"').replace(/\\\\/g,"\\"):b}const D={default:([b,M,O])=>`${b} ${M} ${O||""}`,unquote:([b,M,O])=>{const I=u(b),T=u(O)||'""';return`${I} ${M} ${T}`}};function E(b){return b.startsWith("{")&&b.endsWith("}")}function x(b){const M=P(b);return[b.name,M,b.value]}function P(b){return b.isEqual?b.isRegex?i.ho.regex:i.ho.equal:b.isRegex?i.ho.notRegex:i.ho.notEqual}},56361:(k,R,e)=>{"use strict";e.d(R,{BK:()=>C,Cp:()=>K,D2:()=>w,ES:()=>Y,GD:()=>S,Ht:()=>x,JM:()=>F,JZ:()=>J,KT:()=>M,NH:()=>A,S2:()=>D,Sl:()=>E,Y9:()=>T,Yp:()=>l,bg:()=>y,c$:()=>L,i7:()=>u,i9:()=>B,nL:()=>O,qN:()=>N,qc:()=>H,qy:()=>b,u7:()=>X,w$:()=>v,y$:()=>V});var t=e(2543),n=e.n(t),i=e(61268),s=e(32264),r=e(17172),g=e(16233),a=e(18461),c=e(23662),o=e(64861),h=e(94822),f=e(55740),d=e(57220),p=e(32642),m=e(3704);function v(q,ae,j){const te=(0,d.EV)(q),ne=a.UP(te,ae),le=encodeURIComponent(a.$9(ne)),z=encodeURIComponent(te);return(0,m.G)(`/alerting/${z}/${le}/view`,j?{returnTo:j}:{})}function l(q,ae){const{uid:j,type:te}=q;return(0,m.G)("/explore",{left:JSON.stringify({datasource:q.uid,queries:[{refId:"A",datasource:{uid:j,type:te},expr:ae}],range:{from:"now-1h",to:"now"}})})}function y(q,ae=""){return(0,m.G)(`/alerting/notifications/receivers/${encodeURIComponent(q)}/edit`,{alertmanager:ae})}function u(q,ae=""){return(0,m.G)("/alerting/routes/mute-timing/edit",{muteName:q,alertmanager:ae})}function D(q,ae){if((0,d.Eb)(q))return(0,m.z)(`/alerting/${encodeURIComponent(q.name)}/${encodeURIComponent((0,a.PH)(ae.name))}/find`);if((0,c.lT)(ae.rulerRule))return(0,m.z)(`/alerting/grafana/${ae.rulerRule.grafana_alert.uid}/view`)}function E(q){return q.reduce((ae,{key:j,value:te})=>(ae[j]=te,ae),{})}const x=q=>{const ae=q.queryString===void 0?void 0:String(q.queryString),j=q.alertState===void 0?void 0:String(q.alertState),te=q.dataSource===void 0?void 0:String(q.dataSource),ne=q.ruleType===void 0?void 0:String(q.ruleType),le=q.groupBy===void 0?void 0:String(q.groupBy).split(",");return{queryString:ae,alertState:j,dataSource:te,groupBy:le,ruleType:ne}},P=q=>({queryString:q.get("queryString")??void 0,contactPoint:q.get("contactPoint")??void 0}),b=q=>{const ae=q.queryString===void 0?void 0:String(q.queryString),j=q.silenceState===void 0?void 0:String(q.silenceState);return{queryString:ae,silenceState:j}};function M(q){return Object.entries(q).map(([ae,j])=>({key:ae,value:j}))}function O(q,ae,j){const te=new URLSearchParams(j);return ae&&te.set(f.DD,ae),`${q}?${te.toString()}`}const I=q=>q.replace(/\"/g,'\\"');function T(q){return q.startsWith('"')&&q.endsWith('"')?I(q):`"${I(q)}"`}function C(q,ae){const j=new URLSearchParams;return j.append("alertmanager",q),(0,p.J9)(ae).forEach((ne,le)=>j.append(le,ne)),(0,m.G)("/alerting/silence/new",j)}function S(q){return(0,m.G)(`/datasources/edit/${q}`)}function A(q){return(0,m.G)(`/dashboards/f/${q}`)}function L(q,ae){return(0,m.G)(`/dashboards/f/${q}/${ae}/alerting`)}function N(q){return(0,m.G)(`/dashboards/f/${q}/settings`)}function F(q){return(0,m.G)(`/d/${encodeURIComponent(q)}`)}function w(q,ae){const j=new URLSearchParams({viewPanel:ae});return(0,m.G)(`/d/${encodeURIComponent(q)}`,j)}function B(q,ae,j,te=1e3){const ne=new Date().getTime(),le=()=>q().catch(z=>{if(ae(z)&&new Date().getTime()-ne<j)return new Promise(ee=>setTimeout(ee,te)).then(le);throw z});return le()}const U={[h.Gi.Alerting]:1,[h.cF.Firing]:1,[h.Gi.Error]:1,[h.Gi.Pending]:2,[h.cF.Pending]:2,[h.cF.Inactive]:2,[h.Gi.NoData]:3,[h.Gi.Normal]:4};function K(q,ae){if(q===o.xB.Importance)return(0,t.sortBy)(ae,te=>[U[(0,h.lh)(te.state)],(0,c.RI)(te).toLocaleLowerCase()]);if(q===o.xB.TimeAsc)return(0,t.sortBy)(ae,te=>[new Date(te.activeAt)||new Date,(0,c.RI)(te).toLocaleLowerCase()]);if(q===o.xB.TimeDesc)return(0,t.sortBy)(ae,te=>[new Date(te.activeAt)||new Date,(0,c.RI)(te).toLocaleLowerCase()]).reverse();const j=(0,t.sortBy)(ae,te=>(0,c.RI)(te).toLocaleLowerCase());return q===o.xB.AlphaDesc&&j.reverse(),j}function V(){return s.$.buildInfo.edition===i.r.OpenSource}function H(){return g.TP.hasRole("Admin")||g.TP.isGrafanaAdmin}function Y(){return s.$.buildInfo.env==="development"}function X(q){return!!(q&&typeof q=="object"&&"message"in q)}function J(q){return(0,r.NF)(q)?q.message?q.message:"message"in q.data&&typeof q.data.message=="string"?q.data.message:q.statusText?q.statusText:String(q.status)||"Unknown error":X(q)?q.cause?`${q.message}, cause: ${J(q.cause)}`:q.message:String(q)}},88467:(k,R,e)=>{"use strict";e.d(R,{$I:()=>f,BU:()=>x,CZ:()=>m,J7:()=>o,ML:()=>P,Vf:()=>D,Xw:()=>h,jA:()=>a,p0:()=>v,t4:()=>E,v5:()=>d});var t=e(65307),n=e(26272),i=e(17172),s=e(10096),r=e(25027),g=e(56361);const a=Object.freeze({loading:!1,result:void 0,error:void 0,dispatched:!1});function c(b,M=a,O){if(b.pending.match(O))return{result:M.result,loading:!0,error:M.error,dispatched:!0,requestId:O.meta.requestId};if(b.fulfilled.match(O)){if(M.requestId===void 0||M.requestId===O.meta.requestId)return{...M,result:O.payload,loading:!1,error:void 0}}else if(b.rejected.match(O)&&M.requestId===O.meta.requestId)return{...M,loading:!1,error:O.error};return M}function o(b,M){return(0,t.Z0)({name:b,initialState:a,reducers:{},extraReducers:O=>O.addDefaultCase((I,T)=>c(M,I,T))})}function h(b,M,O){return(0,t.Z0)({name:b,initialState:{},reducers:{},extraReducers:I=>I.addDefaultCase((T,C)=>{if((0,t.$S)(M)(C)){const S=C,A=O(S.meta.arg);return{...T,[A]:c(M,T[A],S)}}return T})})}function f(b){return b.catch(M=>{throw{message:m(M),code:M.statusCode}})}function d(b,M){return b.then(O=>(M.successMessage&&s.lE.emit(n.r1.alertSuccess,[M.successMessage]),O)).catch(O=>{const I=m(O);throw s.lE.emit(n.r1.alertError,[`${M.errorMessage??"Error"}: ${I}`]),O})}const p="Unknown Error";function m(b){if((0,i.NF)(b))if(b.data?.message){let M=b.data?.message;return typeof b.data?.error=="string"&&(M+=`; ${b.data.error}`),M}else{if(Array.isArray(b.data)&&b.data.length&&b.data[0]?.message)return b.data.map(M=>M?.message).filter(M=>!!M).join(" ");if(b.statusText)return b.statusText}return(0,g.u7)(b)?b.message:((0,r.fH)(r.le.unknownMessageFromError,{error:JSON.stringify(b)}),p)}function v(b){return Object.values(b).every(l)}function l(b){return b.dispatched&&!b.loading}function y(b){return Object.values(b).every(u)}function u(b){return b.dispatched&&!b.loading&&!b.error}function D(b){return Object.values(b).some(P)}function E(b){return Object.values(b).some(M=>M.dispatched)}function x(b){return Object.values(b).some(u)}function P(b){return b?b.dispatched&&b.loading:!1}},63066:(k,R,e)=>{"use strict";e.d(R,{Bu:()=>te,IJ:()=>I,J6:()=>J,JE:()=>A,Q8:()=>x,QX:()=>w,Qk:()=>B,Rk:()=>ne,T6:()=>O,XI:()=>U,Z9:()=>N,ir:()=>le,l1:()=>C,mp:()=>X,qO:()=>K});var t=e(2543),n=e.n(t),i=e(43127),s=e(65879),r=e(77789),g=e(32264),a=e(19347),c=e(26657),o=e(80943),h=e(74730),f=e(66718),d=e(94822),p=e(55907),m=e(86590),v=e(75471),l=e(55740),y=e(57220),u=e(56361),D=e(23662),E=e(25968);const x="grafana.alerting.manualRouting",P=(0,E.P8)(g.$.unifiedAlerting?.minInterval??"10s"),b=(0,E.P8)("1m"),O=(0,E.an)((0,t.clamp)(P,b,1/0)),I=()=>{const{canCreateGrafanaRules:z,canCreateCloudRules:ee}=(0,v.Q9)();return Object.freeze({name:"",uid:"",labels:[{key:"",value:""}],annotations:l.kl,dataSourceName:null,type:z?m.Z.grafana:ee?m.Z.cloudAlerting:void 0,group:"",folder:null,queries:[],recordingRulesQueries:[],condition:"",noDataState:d.Q8.NoData,execErrState:d.Q8.Error,evaluateFor:O,evaluateEvery:O,manualRouting:T(),contactPoints:{},overrideGrouping:!1,overrideTimings:!1,muteTimeIntervals:[],namespace:"",expression:"",forTime:1,forTimeUnit:"m"})},T=()=>g.$.featureToggles.alertingSimplifiedRouting??!1?localStorage.getItem(x)!=="false":!1;function C(z){const{name:ee,expression:se,forTime:ie,forTimeUnit:Z,keepFiringForTime:oe,keepFiringForTimeUnit:ce,type:ye}=z;if(ye===m.Z.cloudAlerting){let re;return oe&&ce&&(re=`${oe}${ce}`),{alert:ee,for:`${ie}${Z}`,keep_firing_for:re,annotations:(0,u.Sl)(z.annotations||[]),labels:(0,u.Sl)(z.labels||[]),expr:se}}else if(ye===m.Z.cloudRecording)return{record:ee,labels:(0,u.Sl)(z.labels||[]),expr:se};throw new Error(`unexpected rule type: ${ye}`)}function S(z,ee){const se=[...(0,u.KT)(z||{})];return ee&&se.push({key:"",value:""}),se}function A(z){const ee=[...z];return l.kl.map(ie=>ie.key).forEach((ie,Z)=>{const oe=ee.findIndex(ce=>ce.key===ie);if(oe===-1){const ce={key:ie,value:""};ee.splice(Z,0,ce)}else oe!==Z&&ee.splice(Z,0,ee.splice(oe,1)[0])}),ee}function L(z,ee){if(ee?.grafana?.selectedContactPoint&&z)return{receiver:ee?.grafana?.selectedContactPoint,mute_time_intervals:ee?.grafana?.muteTimeIntervals,group_by:ee?.grafana?.overrideGrouping?ee?.grafana?.groupBy:void 0,group_wait:ee?.grafana?.overrideTimings&&ee?.grafana?.groupWaitValue?ee?.grafana?.groupWaitValue:void 0,group_interval:ee?.grafana?.overrideTimings&&ee?.grafana?.groupIntervalValue?ee?.grafana?.groupIntervalValue:void 0,repeat_interval:ee?.grafana?.overrideTimings&&ee?.grafana?.repeatIntervalValue?ee?.grafana?.repeatIntervalValue:void 0}}function N(z){const{name:ee,condition:se,noDataState:ie,execErrState:Z,evaluateFor:oe,queries:ce,isPaused:ye,contactPoints:re,manualRouting:ue,type:De,metric:ge}=z;if(se){const Te=L(ue,re);return(0,D.Mu)(De)?{grafana_alert:{title:ee,condition:se,data:ce.map(ae),is_paused:!!ye,no_data_state:ie,exec_err_state:Z,notification_settings:Te},annotations:(0,u.Sl)(z.annotations||[]),labels:(0,u.Sl)(z.labels||[]),for:oe}:{grafana_alert:{title:ee,condition:se,data:ce.map(ae),is_paused:!!ye,record:{metric:ge??ee,from:se}},annotations:(0,u.Sl)(z.annotations||[]),labels:(0,u.Sl)(z.labels||[])}}throw new Error("Cannot create rule without specifying alert condition")}function F(z){const ee=z.notification_settings?{selectedContactPoint:z.notification_settings.receiver,muteTimeIntervals:z.notification_settings.mute_time_intervals??[],overrideGrouping:Array.isArray(z.notification_settings.group_by)&&z.notification_settings.group_by.length>0,overrideTimings:[z.notification_settings.group_wait,z.notification_settings.group_interval,z.notification_settings.repeat_interval].some(Boolean),groupBy:z.notification_settings.group_by||[],groupWaitValue:z.notification_settings.group_wait||"",groupIntervalValue:z.notification_settings.group_interval||"",repeatIntervalValue:z.notification_settings.repeat_interval||""}:void 0;return ee?{[y.hY]:ee}:void 0}function w(z){const{ruleSourceName:ee,namespace:se,group:ie,rule:Z}=z,oe=I();if((0,y.z2)(ee))if((0,D.Gy)(Z)){const ce=Z.grafana_alert;return{...oe,name:ce.title,type:m.Z.grafanaRecording,group:ie.name,evaluateEvery:ie.interval||oe.evaluateEvery,queries:ce.data,condition:ce.condition,annotations:A(S(Z.annotations,!1)),labels:S(Z.labels,!0),folder:{title:se,uid:ce.namespace_uid},isPaused:ce.is_paused,metric:ce.record?.metric}}else if((0,D.lT)(Z)){const ce=Z.grafana_alert,ye=F(ce);if(ce.no_data_state!==void 0&&ce.exec_err_state!==void 0)return{...oe,name:ce.title,type:m.Z.grafana,group:ie.name,evaluateEvery:ie.interval||oe.evaluateEvery,evaluateFor:Z.for||"0",noDataState:ce.no_data_state,execErrState:ce.exec_err_state,queries:ce.data,condition:ce.condition,annotations:A(S(Z.annotations,!1)),labels:S(Z.labels,!0),folder:{title:se,uid:ce.namespace_uid},isPaused:ce.is_paused,contactPoints:ye,manualRouting:!!ye};throw new Error("Unexpected type of rule for grafana rules source")}else throw new Error("Unexpected type of rule for grafana rules source");else if((0,D.$y)(Z)){const ye={refId:"A",datasourceUid:(0,a.l)().getInstanceSettings(ee)?.uid??"",queryType:"",relativeTimeRange:(0,i.Cn)(),expr:Z.expr,model:{refId:"A",hide:!1,expr:Z.expr}},re=B(Z);return{...oe,...re,queries:[ye],annotations:A(S(Z.annotations,!1)),type:m.Z.cloudAlerting,dataSourceName:ee,namespace:se,group:ie.name}}else if((0,D.i7)(Z)){const ce=U(Z);return{...oe,...ce,type:m.Z.cloudRecording,dataSourceName:ee,namespace:se,group:ie.name}}else throw new Error("Unexpected type of rule for cloud rules source")}function B(z){const ee=I(),[se,ie]=z.for?(0,E.P1)(z.for):[0,"s"],[Z,oe]=z.keep_firing_for?(0,E.P1)(z.keep_firing_for):[ee.keepFiringForTime,ee.keepFiringForTimeUnit];return{name:z.alert,expression:z.expr,forTime:se,forTimeUnit:ie,keepFiringForTime:Z,keepFiringForTimeUnit:oe,annotations:S(z.annotations,!1),labels:S(z.labels,!0)}}function U(z){return{name:z.record,expression:z.expr,labels:S(z.labels,!0)}}const K=()=>{const z=(0,y.y9)();if(!z)return[...H("A","B")];const ee=(0,i.Cn)();return[{refId:"A",datasourceUid:z.uid,queryType:"",relativeTimeRange:ee,model:{refId:"A"}},...H("B","C")]},V=z=>{const ee=getDefaultRelativeTimeRange();return[{refId:"A",datasourceUid:z[0]?.uid||"",queryType:"",relativeTimeRange:ee,model:{refId:"A"}}]},H=(...z)=>{const ee=z[0],se=z[1],ie={refId:z[0],type:f.Tz.reduce,datasource:{uid:f.Uj,type:c.dR.type},conditions:[{type:"query",evaluator:{params:[],type:p.p.IsAbove},operator:{type:"and"},query:{params:[ee]},reducer:{params:[],type:"last"}}],reducer:"last",expression:"A"},Z={refId:se,type:f.Tz.threshold,datasource:{uid:f.Uj,type:c.dR.type},conditions:[{type:"query",evaluator:{params:[0],type:p.p.IsAbove},operator:{type:"and"},query:{params:[se]},reducer:{params:[],type:"last"}}],expression:ee};return[{refId:ee,datasourceUid:f.Uj,queryType:"",model:ie},{refId:se,datasourceUid:f.Uj,queryType:"",model:Z}]},Y=async(z,ee,se,ie,Z,oe)=>{const ce=[];for(const ye of z){const re=await(0,a.l)().get(ye.datasource?.uid?ye.datasource:ie),ue={uid:re.uid,type:re.type},De=s.relativeToTimeRange(ee),{interval:ge,intervalMs:Te}=q(De,oe??re.interval,Z),Le={__interval:{text:ge,value:ge},__interval_ms:{text:Te,value:Te},...se},Ye=re.interpolateVariablesInQueries?re.interpolateVariablesInQueries([ye],Le)[0]:ye;if(ue.uid===f.Uj){const je={refId:Ye.refId,queryType:"",relativeTimeRange:ee,datasourceUid:f.Uj,model:Ye};ce.push(je)}else{const je=(0,a.l)().getInstanceSettings(ue);if(je&&je.meta.alerting){const Ze={refId:Ye.refId,queryType:Ye.queryType??"",relativeTimeRange:ee,datasourceUid:je.uid,model:{...Ye,maxDataPoints:Z,intervalMs:Te}};ce.push(Ze)}}}return ce},X=async(z,ee)=>{const{targets:se}=z;if(!z.id||!ee.uid)return;const ie=s.timeRangeToRelative(s.convertRawToRange(ee.time)),Z=await Y(se,ie,z.scopedVars||{},z.datasource??void 0,z.maxDataPoints??void 0,z.interval??void 0);if(!Z.length||!Z.find(re=>re.datasourceUid!==f.Uj))return;if(!Z.find(re=>re.datasourceUid===f.Uj)){const[re,ue]=H((0,r.M)(Z),"-");Z.push(re);const[De,ge]=H(re.refId,(0,r.M)(Z));Z.push(ge)}const{folderTitle:oe,folderUid:ce}=ee.meta;return{type:m.Z.grafana,folder:ce&&oe?{uid:ce,title:oe}:void 0,queries:Z,name:z.title,condition:Z[Z.length-1].refId,annotations:[{key:l.YH.dashboardUID,value:ee.uid},{key:l.YH.panelID,value:String(z.id)}]}},J=async z=>{if(!z.state.key)return;const ee=o.jh.getTimeRange(z),se=(0,h.un)(z);if(!se)return;const{queries:ie,datasource:Z,maxDataPoints:oe,minInterval:ce}=se.state,ye=(0,h.YQ)(z);if(!ye||!ye.state.uid)return;const re=await Y(ie,s.timeRangeToRelative(s.convertRawToRange(ee.state.value.raw)),{__sceneObject:{value:z}},Z,oe,ce);if(!re.length||!re.find(Te=>Te.datasourceUid!==f.Uj))return;if(!re.find(Te=>Te.datasourceUid===f.Uj)){const[Te,Le]=H((0,r.M)(re),"-");re.push(Te);const[Ye,je]=H(Te.refId,(0,r.M)(re));re.push(je)}const{folderTitle:ue,folderUid:De}=ye.state.meta;return{type:m.Z.grafana,folder:De&&ue?{uid:De,title:ue}:void 0,queries:re,name:z.state.title,condition:re[re.length-1].refId,annotations:[{key:l.YH.dashboardUID,value:ye.state.uid},{key:l.YH.panelID,value:String((0,h.Cs)(z))}]}};function q(z,ee,se){return se?s.calculateInterval(z,se,ee):ee&&s.intervalToMs(ee)>1e3?{interval:ee,intervalMs:s.intervalToMs(ee)}:{interval:"1s",intervalMs:1e3}}function ae(z){const ee=z.model;return j(ee)&&ee.instant&&ee.range?{...z,model:{...ee,range:!0,instant:!1}}:z}function j(z){return"expr"in z&&"instant"in z&&"range"in z}function te(z){return"expr"in z}const ne=z=>({...z,queries:z.queries?.map(ee=>(0,t.omit)(ee,"model.hide"))});function le(z){return ne(w(z))}},18461:(k,R,e)=>{"use strict";e.d(R,{$9:()=>D,LC:()=>h,Ns:()=>x,P1:()=>g,PH:()=>v,UP:()=>c,VY:()=>M,Yd:()=>o,c:()=>l,qg:()=>y,uE:()=>O,x6:()=>u});var t=e(2543),n=e.n(t),i=e(39601),s=e(57220),r=e(23662);function g(I,T,C,S){return(0,r.lT)(S)?{uid:S.grafana_alert.uid,ruleSourceName:"grafana"}:{ruleSourceName:I,namespace:T,groupName:C,ruleName:(0,r.$y)(S)?S.alert:S.record,rulerRuleHash:x(S)}}function a(I,T,C,S){return{ruleSourceName:I,namespace:T,groupName:C,ruleName:S.name,ruleHash:P(S)}}function c(I,T){const C=T.namespace.name,S=T.group.name;if(T.rulerRule)return g(I,C,S,T.rulerRule);if(T.promRule)return a(I,C,S,T.promRule);throw new Error("Could not create an id for a rule that is missing both `rulerRule` and `promRule`.")}function o(I){return g(I.ruleSourceName,I.namespace,I.group.name,I.rule)}function h(I,T){return(0,r.A4)(I)&&(0,r.A4)(T)?I.uid===T.uid:(0,r.X4)(I)&&(0,r.X4)(T)?I.groupName===T.groupName&&I.namespace===T.namespace&&I.ruleName===T.ruleName&&I.rulerRuleHash===T.rulerRuleHash&&I.ruleSourceName===T.ruleSourceName:(0,r.Mj)(I)&&(0,r.Mj)(T)?I.groupName===T.groupName&&I.namespace===T.namespace&&I.ruleName===T.ruleName&&I.ruleHash===T.ruleHash&&I.ruleSourceName===T.ruleSourceName:!1}const f="cri",d="pri";function p(I){return I.replace(/\$/g,"_DOLLAR_")}function m(I){return I.replace(/\_DOLLAR\_/g,"$")}function v(I){return I.replace(/\//g,"").replace(/\\/g,"")}function l(I){return I.replace(/\x1f/g,"/").replace(/\x1e/g,"\\")}function y(I,T=!1){const S=(T?decodeURIComponent(I):I).split("$");if(S.length===1)return{uid:I,ruleSourceName:"grafana"};if(S.length===6){const[A,L,N,F,w,B]=S.map(m).map(l);if(A===f)return{ruleSourceName:L,namespace:N,groupName:F,ruleName:w,rulerRuleHash:B};if(A===d)return{ruleSourceName:L,namespace:N,groupName:F,ruleName:w,ruleHash:B}}throw new Error(`Failed to parse rule location: ${I}`)}function u(I,T=!1){if(I)try{return y(I,T)}catch{return}}function D(I){return(0,r.A4)(I)?I.uid:(0,r.X4)(I)?[f,I.ruleSourceName,I.namespace,I.groupName,I.ruleName,I.rulerRuleHash].map(String).map(p).map(v).join("$"):[d,I.ruleSourceName,I.namespace,I.groupName,I.ruleName,I.ruleHash].map(String).map(p).map(v).join("$")}function E(I){let T=0;if(I.length===0)return T;for(let C=0;C<I.length;C++){const S=I.charCodeAt(C);T=(T<<5)-T+S,T=T&T}return T}function x(I){if((0,r.i7)(I))return E(JSON.stringify([I.record,I.expr,b(I.labels)])).toString();if((0,r.$y)(I))return E(JSON.stringify([I.alert,I.expr,b(I.annotations),b(I.labels)])).toString();if((0,r.lT)(I))return I.grafana_alert.uid;throw new Error("only recording and alerting ruler rules can be hashed")}function P(I){if((0,r.KB)(I))return E(JSON.stringify([I.type,I.query,b(I.labels)])).toString();if((0,r.Z8)(I))return E(JSON.stringify([I.type,I.query,b(I.annotations),b(I.labels)])).toString();throw new Error("only recording and alerting rules can be hashed")}function b(I){return JSON.stringify(Object.entries(I||{}).sort((T,C)=>T[0].localeCompare(C[0])))}function M(I){return(0,r.A4)(I)?s.hY:I.ruleSourceName}function O(I){const{pathname:T=""}=i.Ny.getLocation(),{id:C}=I;return C?(0,t.nth)(T.split("/"),-2):void 0}},23662:(k,R,e)=>{"use strict";e.d(R,{$7:()=>M,$y:()=>m,A4:()=>O,BL:()=>le,Gy:()=>y,H2:()=>ee,HH:()=>P,I2:()=>j,KB:()=>p,Mj:()=>C,Mt:()=>x,Mu:()=>te,OF:()=>z,Om:()=>H,RI:()=>b,TU:()=>B,Tm:()=>N,UL:()=>l,Uw:()=>ae,Wy:()=>K,X4:()=>I,XI:()=>F,YN:()=>Y,Z8:()=>d,dS:()=>U,f6:()=>S,i7:()=>v,jg:()=>J,lT:()=>D,nf:()=>T,pq:()=>ne,pv:()=>u,qz:()=>X,s_:()=>ie,uo:()=>A,vE:()=>se});var t=e(2543),n=e.n(t),i=e(43585),s=e(32264),r=e(94822),g=e(28475),a=e(86590),c=e(55740),o=e(57220),h=e(75214),f=e(25968);function d(Z){return typeof Z=="object"&&Z.type===r.JS.Alerting}function p(Z){return typeof Z=="object"&&Z.type===r.JS.Recording}function m(Z){return typeof Z=="object"&&"alert"in Z}function v(Z){return typeof Z=="object"&&"record"in Z}function l(Z){return typeof Z=="object"&&v(Z)||D(Z)&&"record"in Z.grafana_alert}function y(Z){return typeof Z=="object"&&l(Z)&&D(Z)}function u(Z){return typeof Z=="object"&&D(Z)&&!l(Z)}function D(Z){return typeof Z=="object"&&"grafana_alert"in Z}function E(Z){return typeof Z=="object"&&"grafana_alert"in Z&&"record"in Z.grafana_alert}function x(Z){return typeof Z=="object"&&!D(Z)}function P(Z){return Z&&D(Z)&&!!Z.grafana_alert.is_paused}function b(Z){return JSON.stringify(Z.labels)}function M(Z){return Z.error&&Z.error?.message?.includes(c.UU)}function O(Z){return"uid"in Z}function I(Z){return"rulerRuleHash"in Z}function T(Z){return Object.values(r.JS).includes(Z)}function C(Z){return"ruleHash"in Z}function S(Z){switch(Z){case"ok":return g.Jc.Ok;case"nodata":return g.Jc.NoData;case"error":case"err":return g.Jc.Error;case"unknown":return g.Jc.Unknown;default:return}}function A(Z){const oe=Z.labels[h.lL];if(!oe)return;const ce=oe.match(/^plugin\/(?<pluginId>.+)$/);if(!ce?.groups)return;const ye=ce.groups.pluginId;if(L(ye))return{pluginId:ye}}function L(Z){return!!s.$.apps[Z]}function N(Z){return!!A(Z)}function F(Z){return Z===r.cF.Inactive?"Normal":(0,t.capitalize)(Z)}const w=Z=>Z.reduce((oe,{dataSourceName:ce,name:ye,groups:re})=>(re.forEach(({name:ue,rules:De})=>{De.forEach(ge=>{d(ge)&&oe.push({dataSourceName:ce,namespaceName:ye,groupName:ue,rule:ge})})}),oe),[]),B=Z=>d(Z.promRule)?Z.promRule:null,U=Z=>Z.reduce((oe,{rulesSource:ce,name:ye,groups:re})=>(re.forEach(({name:ue,rules:De})=>{De.forEach(ge=>{ge.promRule&&d(ge.promRule)&&oe.push({dataSourceName:(0,o.EV)(ce),namespaceName:ye,groupName:ue,...ge})})}),oe),[]);function K(Z){let oe;return Object.values(i.O).includes(Z)?oe=Z:oe=(0,r.lh)(Z),V[oe]}const V={[r.cF.Inactive]:"good",[r.cF.Firing]:"bad",[r.cF.Pending]:"warning",[r.Gi.Alerting]:"bad",[r.Gi.Error]:"bad",[r.Gi.NoData]:"info",[r.Gi.Normal]:"good",[r.Gi.Pending]:"warning",[i.O.NoData]:"info",[i.O.Paused]:"warning",[i.O.Alerting]:"bad",[i.O.OK]:"good",[i.O.Unknown]:"info"};function H(Z){return Z?.alerts?Z.alerts.reduce((oe,ce)=>{const ye=(0,r.lh)(ce.state)!==r.Gi.Normal;if(ce.activeAt&&ye){const re=new Date(ce.activeAt);if(oe===null||oe.getTime()>re.getTime())return re}return oe},null):null}function Y(Z){return Array.isArray(Z.source_tenants)}function X(Z){return D(Z)?Z.grafana_alert.title:m(Z)?Z.alert:v(Z)?Z.record:""}const J=(Z,oe)=>{const ce={alertName:"",forDuration:"0s",evaluationsToFire:0};return D(Z)?{alertName:Z.grafana_alert.title,forDuration:Z.for,evaluationsToFire:Z.for?q(Z.for,oe):null}:m(Z)?{alertName:Z.alert,forDuration:Z.for??"0s",evaluationsToFire:q(Z.for??"0s",oe)}:ce},q=(Z,oe)=>{const ce=(0,f.P8)(oe),ye=(0,f.P8)(Z);return ye===0&&ce!==0?1:ce===0||ye/ce<1?0:Math.ceil(ye/ce)+1};function ae(Z){const oe=(0,o.z2)(Z.namespace.rulesSource)?Z.namespace.rulesSource:Z.namespace.rulesSource.name,ce=D(Z.rulerRule)?Z.rulerRule.grafana_alert.namespace_uid:Z.namespace.name;return{dataSourceName:oe,namespaceName:ce,groupName:Z.group.name}}function j(Z){const oe=Z.ruleSourceName,ce=D(Z.rule)?Z.rule.grafana_alert.namespace_uid:Z.namespace,ye=Z.group.name;return{dataSourceName:oe,namespaceName:ce,groupName:ye}}function te(Z){return Z===a.Z.grafana}function ne(Z){return Z===a.Z.grafanaRecording}function le(Z){return Z===a.Z.cloudAlerting}function z(Z){return Z===a.Z.cloudRecording}function ee(Z){return te(Z)||ne(Z)}function se(Z){return ne(Z)||z(Z)}function ie(Z){return le(Z)||z(Z)}},25968:(k,R,e)=>{"use strict";e.d(R,{M9:()=>o,P1:()=>n,P8:()=>f,TN:()=>r,an:()=>h,mo:()=>d,sc:()=>s,yl:()=>p});var t=e(41068);function n(m){const v=m.match(/(\d+)(\w+)/);if(v)return[Number(v[1]),v[2]];throw new Error(`Invalid interval description: ${m}`)}function i(m){const{sec:v,count:l}=describeInterval(m);return v*l}const s=Object.entries(t.y).map(([m,v])=>({label:m[0].toUpperCase()+m.slice(1),value:v}));function r(m){try{return o(m),!0}catch{return!1}}const g={ms:1,s:1e3,m:60*1e3,h:60*60*1e3,d:24*60*60*1e3,w:7*24*60*60*1e3,y:365*24*60*60*1e3},a=new RegExp(/^(?:(?<value>\d+)(?<type>ms|s|m|h|d|w|y))|0$/),c=new Error(`Must be of format "(number)(unit)", for example "1m", or just "0". Available units: ${Object.values(t.y).join(", ")}`);function o(m){let v=m;const l=[];function y(D){const E=a.exec(D),x=E?.groups?.value&&E?.groups?.type;if(!E||!x)throw c;E&&E.groups?.value&&E.groups?.type&&(v=v.replace(E[0],""),l.push([Number(E.groups.value),E.groups.type])),v&&y(v)}if(y(m),!l.length)throw c;return l.reduce((D,[E,x])=>{const P=E*g[x];return D+P},0)}function h(m){const v=Math.floor(m/1e3),l=Math.floor(v/60),y=Math.floor(l/60),u=Math.floor(y/24),D=Math.floor(u/7),E=Math.floor(u/365);return m===0?"0s":[[E,"y"],[D%52,"w"],[u%365-7*(D%52),"d"],[y%24,"h"],[l%60,"m"],[v%60,"s"],[m%1e3,"ms"]].filter(([P])=>P>0).map(([P,b])=>P+b).join("")}const f=m=>{try{return o(m)}catch{return 0}},d=m=>m.includes("0001-01-01T00");function p(m){return m%(1e3*60*60)===0?m/(1e3*60*60)+"h":m%(1e3*60)===0?m/(1e3*60)+"m":m%1e3===0?m/1e3+"s":m.toFixed()+"ms"}},3704:(k,R,e)=>{"use strict";e.d(R,{G:()=>n,z:()=>i});var t=e(32264);function n(s,r){const a=new URLSearchParams(r).toString();return`${t.$.appSubUrl}${s}${a?`?${a}`:""}`}function i(s,r){const a=new URLSearchParams(r).toString();try{return`${new URL(t.$.appSubUrl+s,t.$.appUrl).href}${a?`?${a}`:""}`}catch{return n(s,r)}}},10154:(k,R,e)=>{"use strict";e.d(R,{Xm:()=>s,rJ:()=>i,vJ:()=>n,vy:()=>r});var t=e(17172);function n(g){return(0,t.AI)().post("/api/annotations",g)}function i(g){return(0,t.AI)().put(`/api/annotations/${g.id}`,g)}function s(g){return(0,t.AI)().delete(`/api/annotations/${g.id}`)}async function r(){return(await(0,t.AI)().get("/api/annotations/tags")).result.tags.map(({tag:a,count:c})=>({term:a,count:c}))}},82241:(k,R,e)=>{"use strict";e.d(R,{A:()=>b});var t=e(74848),n=e(96540),i=e(75505),s=e(39070),r=e(76287),g=e(13544),a=e(68402),c=e(62930),o=e(55852),h=e(42418),f=e(14792),d=e(74856),p=e(34214),m=e(27302),v=e(42493),l=e(28240),y=e(8790),u=e(83195),D=e(56034),E=e(14578),x=e(90182);class P extends n.PureComponent{constructor(O){super(O),this.updateFields=()=>{const I=this.props.response?.panelData,T=I?.series?.[0]??I?.annotations?.[0];if(T&&T.fields){const C=T.fields.map(S=>{const A=(0,l.Ct)(S,T);let L="";for(let N=0;N<T.length;N++){if(N>0&&(L+=", "),N>2){L+="...";break}L+=S.values[N]}return L.length>50&&(L=L.substring(0,50)+"..."),{label:`${A} (${S.type})`,value:A,description:L}});this.setState({fieldNames:C})}},this.onFieldSourceChange=(I,T)=>{const C=this.props.mappings||{},S=C[I]||{};this.props.change({...C,[I]:{...S,source:T.value||y.V.Field}})},this.onFieldNameChange=(I,T)=>{const C=this.props.mappings||{};if(!T){const A={...this.props.mappings};delete A[I],this.props.change(A);return}const S=C[I]||{};this.props.change({...C,[I]:{...S,value:T.value,source:y.V.Field}})},this.state={fieldNames:[]}}componentDidMount(){this.updateFields()}componentDidUpdate(O){O.response!==this.props.response&&this.updateFields()}renderRow(O,I,T){const{fieldNames:C}=this.state;let S=[...C];const A=I.value;let L=C.find(F=>A===F.value);A&&!L&&S.push({label:A,value:A});let N=T?T[O.key]:"";if(N&&O.key.startsWith("time")){const F=(0,u.j_)("dateTimeAsIso");N=(0,u.cN)(F(N))}return N==null&&(N=""),(0,t.jsxs)("tr",{children:[(0,t.jsxs)("td",{children:[O.label||O.key," ",O.help&&(0,t.jsx)(D.m,{content:O.help,children:(0,t.jsx)(E.I,{name:"info-circle"})})]}),(0,t.jsx)("td",{children:(0,t.jsx)(x.l6,{value:L,options:S,placeholder:O.placeholder||O.key,onChange:F=>{this.onFieldNameChange(O.key,F)},noOptionsMessage:"Unknown field names",allowCustomValue:!0,isClearable:!0})}),(0,t.jsx)("td",{children:`${N}`})]},O.key)}render(){const O=this.props.response?.events?.[0],I=this.props.mappings||{};return(0,t.jsxs)("table",{className:"filter-table",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Annotation"}),(0,t.jsx)("th",{children:"From"}),(0,t.jsx)("th",{children:"First Value"})]})}),(0,t.jsx)("tbody",{children:v.kj.map(T=>this.renderRow(T,I[T.key]||{},O))})]})}}class b extends n.PureComponent{constructor(){super(...arguments),this.state={},this.onRunQuery=async()=>{const{datasource:O,annotation:I}=this.props;if((0,v.E7)(O))return;const T=(0,f.UA)().getCurrent();if(!T)return;this.setState({running:!0});const C=await(0,i.s)((0,m.b)({range:(0,d.jG)().timeRange(),panel:new p.a({}),dashboard:T},O,I));this.setState({running:!1,response:C})},this.onQueryChange=O=>{this.props.onChange({...this.props.annotation,target:O})},this.onMappingChange=O=>{this.props.onChange({...this.props.annotation,mappings:O})},this.onAnnotationChange=O=>{this.props.onChange(O)}}componentDidMount(){this.verifyDataSource()}componentDidUpdate(O){this.props.annotation!==O.annotation&&!(0,v.E7)(this.props.datasource)&&this.verifyDataSource()}verifyDataSource(){const{datasource:O,annotation:I}=this.props,C={...v.CU,...O.annotations}.prepareAnnotation(I);C!==I?this.props.onChange(C):this.onRunQuery()}getStatusSeverity(O){const{events:I,panelData:T}=O;return T?.errors||T?.error?"error":I?.length?"success":"warning"}renderStatusText(O,I){const{events:T,panelData:C}=O;if(I||O?.panelData?.state===s.Gu.Loading||!O)return(0,t.jsx)("p",{children:"loading..."});if(C?.errors)return(0,t.jsx)(t.Fragment,{children:C.errors.map((A,L)=>(0,t.jsx)("p",{children:A.message},L))});if(C?.error)return(0,t.jsx)("p",{children:C.error.message??"There was an error fetching data"});if(!T?.length)return(0,t.jsx)("p",{children:"No events found"});const S=C?.series?.[0]??C?.annotations?.[0];return(0,t.jsxs)("p",{children:[T.length," events (from ",S?.fields.length," fields)"]})}renderStatus(){const{response:O,running:I}=this.state;return O?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.$,{v:2}),(0,t.jsx)("div",{children:I?(0,t.jsx)(c.y,{}):(0,t.jsx)(o.$n,{"data-testid":g.Tp.components.Annotations.editor.testButton,variant:"secondary",size:"xs",onClick:this.onRunQuery,children:"Test annotation query"})}),(0,t.jsx)(a.$,{v:2,layout:"block"}),(0,t.jsx)(h.F,{"data-testid":g.Tp.components.Annotations.editor.resultContainer,severity:this.getStatusSeverity(O),title:"Query result",children:this.renderStatusText(O,I)})]}):null}render(){const{datasource:O,annotation:I,datasourceInstanceSettings:T}=this.props,{response:C}=this.state;let S=O.annotations?.QueryEditor||O.components?.QueryEditor;if(!S)return(0,t.jsx)("div",{children:"Annotations are not supported. This datasource needs to export a QueryEditor"});const A={...O.annotations?.getDefaultQuery?.(),...I.target??{refId:"Anno"}};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.p,{instanceSettings:T,children:(0,t.jsx)(S,{query:A,datasource:O,onChange:this.onQueryChange,onRunQuery:this.onRunQuery,data:C?.panelData,range:(0,d.jG)().timeRange(),annotation:I,onAnnotationChange:this.onAnnotationChange},O?.name)}),(0,v.JX)(O)&&(0,t.jsxs)(t.Fragment,{children:[this.renderStatus(),(0,t.jsx)(P,{response:C,mappings:I.mappings,change:this.onMappingChange})]})]})}}},27302:(k,R,e)=>{"use strict";e.d(R,{b:()=>h});var t=e(62467),n=e(69862),i=e(81160),s=e(65879),r=e(41987),g=e(39374),a=e(42493);let c=100;function o(){return"AQ"+c++}function h(f,d,p){const m={...a.CU,...d.annotations},v={...m.getDefaultQuery?.(),...p},l=m.prepareAnnotation(v);if(!l)return(0,t.of)({});const y=m.prepareQuery(l);if(!y)return(0,t.of)({});const u=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,D=s.calculateInterval(f.range,u,d.interval),E={__interval:{text:D.interval,value:D.interval},__interval_ms:{text:D.intervalMs.toString(),value:D.intervalMs},__annotation:{text:l.name,value:l}},x={startTime:Date.now(),requestId:o(),range:f.range,maxDataPoints:u,scopedVars:E,...D,app:r.Jk.Dashboard,timezone:f.dashboard.timezone,targets:[{...y,refId:"Anno"}]};return(0,g.BN)(d,x).pipe((0,n.Z)(P=>{const b=P?.series.length?P.series:P.annotations;return b?.length?m.processEvents(l,b).pipe((0,i.T)(M=>({panelData:P,events:M}))):(0,t.of)({panelData:P,events:[]})}))}},42493:(k,R,e)=>{"use strict";e.d(R,{CU:()=>f,E7:()=>D,JX:()=>u,kj:()=>p});var t=e(2543),n=e.n(t),i=e(62467),s=e(69862),r=e(81160),g=e(57934),a=e(11261),c=e(28240),o=e(8790),h=e(2913);const f={prepareAnnotation:E=>{if((0,t.isString)(E?.query)){const{query:x,...P}=E;return{...P,target:{refId:"annotation_query",query:x},mappings:{}}}return E},prepareQuery:E=>E.target,processEvents:(E,x)=>l(x,E.mappings)};function d(){return E=>E.pipe((0,s.Z)(x=>{if(!x?.length)return(0,i.of)(void 0);if(x.length===1)return(0,i.of)(x[0]);const P={interpolate:b=>b};return(0,i.of)(x).pipe(g.c.mergeTransformer.operator({},P),(0,r.T)(b=>b[0]))}))}const p=[{key:"time",field:E=>E.fields.find(x=>x.type===a.PU.time),placeholder:"time, or the first time field"},{key:"timeEnd",label:"end time",help:"When this field is defined, the annotation will be treated as a range"},{key:"title"},{key:"text",field:E=>E.fields.find(x=>x.type===a.PU.string),placeholder:"text, or the first text field"},{key:"tags",split:",",help:"The results will be split on comma (,)"},{key:"id"}],m=[{key:"color"},{key:"isRegion"},{key:"source"}],v=[...h.config.publicDashboardAccessToken?m:[],...p,{key:"userId"},{key:"login"},{key:"email"},{key:"prevState"},{key:"newState"},{key:"data"},{key:"panelId"},{key:"alertId"},{key:"dashboardId"},{key:"dashboardUID"}];function l(E,x){return(0,i.of)(E).pipe(d(),(0,r.T)(P=>{if(!P?.length)return[];let b=!1,M=!1;const O={};for(const C of P.fields){const S=(0,c.Ct)(C,P);O[S.toLowerCase()]=C}x||(x={});const I=[];for(const C of v){const S=x[C.key]||{};if(S.source===o.V.Skip)continue;const A={key:C.key,split:C.split};if(S.source===o.V.Text)A.text=S.value;else{const L=(S.value||C.key).toLowerCase();A.field=O[L],!A.field&&C.field&&(A.field=C.field(P))}(A.field||A.text)&&(I.push(A),A.key==="time"?b=!0:A.key==="text"&&(M=!0))}if(!b||!M)return console.error("Cannot process annotation fields. No time or text present."),[];const T=[];for(let C=0;C<P.length;C++){const S={type:"default",color:"red"};for(const A of I){let L;if(A.text)L=A.text;else if(A.field&&(L=A.field.values[C],L!==void 0&&A.regex)){const N=A.regex.exec(L);N&&(L=N[1]?N[1]:N[0])}L!=null&&(A.split&&typeof L=="string"&&(L=L.split(",")),S[A.key]=L)}T.push(S)}return T}))}const y=["prometheus","loki","elasticsearch","grafana-opensearch-datasource"];function u(E){const{type:x}=E;return!(x==="datasource"||y.includes(x))}function D(E){const{type:x}=E;return y.includes(x)}},93584:(k,R,e)=>{"use strict";e.d(R,{Ay:()=>h,QB:()=>c,Ri:()=>a,Sf:()=>s,cV:()=>r,h8:()=>g});var t=e(65307);const n={hasFetched:!1,includeExpired:!1,keys:[],keysIncludingExpired:[],searchQuery:"",migrationResult:{total:0,migrated:0,failed:0,failedApikeyIDs:[0],failedDetails:[]}},i=(0,t.Z0)({name:"apiKeys",initialState:n,reducers:{apiKeysLoaded:(f,d)=>{const{keys:p,keysIncludingExpired:m}=d.payload,v=d.payload.keys.length===0&&d.payload.keysIncludingExpired.length>0?!0:f.includeExpired;return{...f,hasFetched:!0,keys:p,keysIncludingExpired:m,includeExpired:v}},setSearchQuery:(f,d)=>({...f,searchQuery:d.payload}),includeExpiredToggled:f=>({...f,includeExpired:!f.includeExpired}),isFetching:f=>({...f,hasFetched:!1}),setMigrationResult:(f,d)=>({...f,migrationResult:d.payload})}}),{apiKeysLoaded:s,includeExpiredToggled:r,isFetching:g,setSearchQuery:a,setMigrationResult:c}=i.actions,h={apiKeys:i.reducer}},2468:(k,R,e)=>{"use strict";e.d(R,{H:()=>a,w:()=>r});var t=e(32264),n=e(17172),i=e(10096),s=e(48814);class r{constructor(o,h=!0){const f=h?`namespaces/${t.$.namespace}/`:"";this.url=`/apis/${o.group}/${o.version}/${f}${o.resource}`}async get(o){return(0,n.AI)().get(`${this.url}/${o}`)}async subresource(o,h){return(0,n.AI)().get(`${this.url}/${o}/${h}`)}async list(o){const h=o||{};return h.labelSelector=this.parseListOptionsSelector(h?.labelSelector),h.fieldSelector=this.parseListOptionsSelector(h?.fieldSelector),(0,n.AI)().get(this.url,o)}async create(o){if(!o.metadata.name&&!o.metadata.generateName){const h=i.TP.user.login;o.metadata.generateName=h?h.slice(0,2):"g"}return g(o.metadata),(0,n.AI)().post(this.url,o)}async update(o){return g(o.metadata),(0,n.AI)().put(`${this.url}/${o.metadata.name}`,o)}async delete(o){return(0,n.AI)().delete(`${this.url}/${o}`)}parseListOptionsSelector(o){return Array.isArray(o)?o.map(h=>{const f=String(h.key),d=h.operator;switch(d){case"=":case"!=":return`${f}${d}${h.value}`;case"in":case"notin":return`${f} ${d} (${h.value.join(",")})`;case"":case"!":return`${d}${f}`;default:return null}}).filter(Boolean).join(","):o}}function g(c){c.annotations||(c.annotations={}),c.annotations[s.dc]="UI",c.annotations[s.zv]=window.location.pathname,c.annotations[s.M8]=t.$.buildInfo.versionString}class a{async get(o){if(this.apiVersions)return this.apiVersions[o];const h=await(0,n.AI)().get("/apis"),f={};return h.groups.forEach(d=>{if(d.name.includes("datasource.grafana.app")){const p=d.name.split(".")[0];f[p]=d.preferredVersion.version,p.endsWith("-datasource")||(p.includes("-")?f[`${p}-datasource`]=d.preferredVersion.version:f[`grafana-${p}-datasource`]=d.preferredVersion.version)}}),this.apiVersions=f,f[o]}}},48814:(k,R,e)=>{"use strict";e.d(R,{M8:()=>o,dc:()=>a,ew:()=>s,fY:()=>r,zv:()=>c});const t="grafana.app/createdBy",n="grafana.app/updatedTimestamp",i="grafana.app/updatedBy",s="grafana.app/folder",r="grafana.app/message",g="grafana.app/slug",a="grafana.app/originName",c="grafana.app/originPath",o="grafana.app/originHash",h="grafana.app/originTimestamp"},73399:(k,R,e)=>{"use strict";e.d(R,{getAuthProviderStatus:()=>h,getRegisteredAuthProviders:()=>a,initAuthConfig:()=>f});var t=e(10096),n=e(27677),i=e(31678);const s=[],r={};function g(p,m){s.find(v=>v.id===p.id)||(s.push(p),m&&(r[p.id]=m))}function a(){return s}function c(p){return s.find(m=>m.id===p)}function o(p){const m=[];for(const[v,l]of Object.entries(p)){const y=s.find(u=>`auth.${u.id}`===v);if(y){const u={...l,providerId:y.id,displayName:l.name||y.displayName};m.push(u)}}return m}async function h(p){if(r[p]){const m=r[p];return m()}return{configured:!1,enabled:!1}}function f(){g({id:"ldap",type:"LDAP",protocol:"LDAP",displayName:"LDAP",configPath:"ldap"},d)}async function d(){if(t.TP.hasPermission(i.AccessControlAction.SettingsRead)){const m=(await(0,n.AI)().get("/api/admin/settings"))["auth.ldap"]||{};return{configured:m.enabled==="true",enabled:m.enabled==="true",hide:m.enabled!=="true"}}return{configured:!1,enabled:!1}}},20604:(k,R,e)=>{"use strict";e.d(R,{Ay:()=>m,MH:()=>a,Nh:()=>c,Oy:()=>d,SH:()=>o,TO:()=>r,jA:()=>s,sr:()=>g});var t=e(65307);const n={settings:{},providerStatuses:{},isLoading:!1,providers:[]},i=(0,t.Z0)({name:"authConfig",initialState:n,reducers:{settingsUpdated:(v,l)=>({...v,settings:l.payload}),providerStatusesLoaded:(v,l)=>({...v,providerStatuses:l.payload}),loadingBegin:v=>({...v,isLoading:!0}),loadingEnd:v=>({...v,isLoading:!1}),setError:(v,l)=>({...v,updateError:l.payload}),resetError:v=>({...v,updateError:void 0}),setWarning:(v,l)=>({...v,warning:l.payload}),resetWarning:v=>({...v,warning:void 0}),providersLoaded:(v,l)=>({...v,providers:l.payload})}}),{settingsUpdated:s,providerStatusesLoaded:r,loadingBegin:g,loadingEnd:a,setError:c,resetError:o,setWarning:h,resetWarning:f,providersLoaded:d}=i.actions,m={authConfig:i.reducer}},55314:(k,R,e)=>{"use strict";e.d(R,{D$:()=>L,G2:()=>b,Ko:()=>x,Vc:()=>T,aF:()=>O,cU:()=>D,e8:()=>C,hT:()=>y.hT,iB:()=>S,kH:()=>M,uz:()=>P,vR:()=>A,vZ:()=>E,wt:()=>I});var t=e(75816),n=e(75505),i=e(71733),s=e(39070),r=e(26272),g=e(17172),a=e(39601),c=e(82467),o=e(28138),h=e(3169),f=e(10096),d=e(28676),p=e(6473),m=e(8484),v=e(37690),l=e(92955),y=e(10378);function u({baseURL:N}){async function F(w){try{const{data:B,...U}=await(0,n.s)((0,g.AI)().fetch({...w,url:N+w.url,showErrorAlert:w.showErrorAlert}));return{data:B,meta:U}}catch(B){return w.manageError?w.manageError(B):{error:B}}}return F}const D=(0,t.xP)({tagTypes:["getFolder"],reducerPath:"browseDashboardsAPI",baseQuery:u({baseURL:"/api"}),endpoints:N=>({listFolders:N.query({providesTags:F=>F?.map(w=>({type:"getFolder",id:w.uid}))??[],query:({parentUid:F,limit:w,page:B,permission:U})=>({url:"/folders",params:{parentUid:F,limit:w,page:B,permission:U}})}),getFolder:N.query({providesTags:(F,w,B)=>[{type:"getFolder",id:B}],query:F=>({url:`/folders/${F}`,params:{accesscontrol:!0}})}),newFolder:N.mutation({query:({title:F,parentUid:w})=>({method:"POST",url:"/folders",data:{title:F,parentUid:w}}),onQueryStarted:({parentUid:F},{queryFulfilled:w,dispatch:B})=>{w.then(async({data:U})=>{await f.TP.fetchUserPermissions(),B((0,c.dx)((0,h.tZ)("Folder created"))),B((0,v.bw)({parentUID:F,pageSize:l.md})),a.Ny.push(i.I.stripBaseFromUrl(U.url))})}}),saveFolder:N.mutation({invalidatesTags:["getFolder"],query:({uid:F,title:w,version:B})=>({method:"PUT",url:`/folders/${F}`,data:{title:w,version:B}}),onQueryStarted:({parentUid:F},{queryFulfilled:w,dispatch:B})=>{w.then(()=>{B((0,v.bw)({parentUID:F,pageSize:l.md}))})}}),moveFolder:N.mutation({invalidatesTags:["getFolder"],query:({folder:F,destinationUID:w})=>({url:`/folders/${F.uid}/move`,method:"POST",data:{parentUID:w}}),onQueryStarted:({folder:F,destinationUID:w},{queryFulfilled:B,dispatch:U})=>{const{parentUid:K}=F;B.then(()=>{U((0,v.bw)({parentUID:K,pageSize:l.md})),U((0,v.bw)({parentUID:w,pageSize:l.md}))})}}),deleteFolder:N.mutation({query:({uid:F})=>({url:`/folders/${F}`,method:"DELETE",params:{forceDeleteRules:!1}}),onQueryStarted:({parentUid:F},{queryFulfilled:w,dispatch:B})=>{w.then(()=>{B((0,v.bw)({parentUID:F,pageSize:l.md}))})}}),getAffectedItems:N.query({keepUnusedDataFor:0,queryFn:async F=>{const B=Object.keys(F.folder).filter(V=>F.folder[V]).map(V=>(0,g.AI)().get(`/api/folders/${V}/counts`)),U=await Promise.all(B),K={folder:Object.values(F.folder).filter(s.zz).length,dashboard:Object.values(F.dashboard).filter(s.zz).length,libraryPanel:0,alertRule:0};for(const V of U)K.folder+=V.folder??0,K.dashboard+=V.dashboard,K.alertRule+=V.alertrule,K.libraryPanel+=V.librarypanel;return{data:K}}}),moveItems:N.mutation({invalidatesTags:["getFolder"],queryFn:async({selectedItems:F,destinationUID:w},B,U,K)=>{const V=Object.keys(F.dashboard).filter(Y=>F.dashboard[Y]),H=Object.keys(F.folder).filter(Y=>F.folder[Y]);for(const Y of H)await K({url:`/folders/${Y}/move`,method:"POST",data:{parentUID:w}});for(const Y of V){const J={dashboard:(await(0,d.n)().getDashboardDTO(Y)).dashboard,folderUid:w,overwrite:!1,message:""};await K({url:"/dashboards/db",method:"POST",data:J})}return{data:void 0}},onQueryStarted:({destinationUID:F,selectedItems:w},{queryFulfilled:B,dispatch:U})=>{const K=Object.keys(w.dashboard).filter(H=>w.dashboard[H]),V=Object.keys(w.folder).filter(H=>w.folder[H]);B.then(()=>{U((0,v.bw)({parentUID:F,pageSize:l.md})),U((0,v.Zw)([...V,...K]))})}}),deleteItems:N.mutation({queryFn:async({selectedItems:F},w,B,U)=>{const K=Object.keys(F.dashboard).filter(H=>F.dashboard[H]),V=Object.keys(F.folder).filter(H=>F.folder[H]);for(const H of V)await U({url:`/folders/${H}`,method:"DELETE",params:{forceDeleteRules:!1}});for(const H of K){const X=(await U({url:`/dashboards/uid/${H}`,method:"DELETE",showSuccessAlert:!1}))?.data?.title;X&&o.A.publish({type:r.r1.alertSuccess.name,payload:[(0,m.t)("browse-dashboards.soft-delete.success","Dashboard {{name}} moved to Recently deleted",{name:X})]})}return{data:void 0}},onQueryStarted:({selectedItems:F},{queryFulfilled:w,dispatch:B})=>{const U=Object.keys(F.dashboard).filter(V=>F.dashboard[V]),K=Object.keys(F.folder).filter(V=>F.folder[V]);w.then(()=>{B((0,v.Zw)([...K,...U]))})}}),saveDashboard:N.mutation({queryFn:async F=>{try{return{data:await(0,d.n)().saveDashboard(F)}}catch(w){return{error:w}}},onQueryStarted:({folderUid:F},{queryFulfilled:w,dispatch:B})=>{p.t.ignoreNextSave(),w.then(async()=>{await f.TP.fetchUserPermissions(),B((0,v.bw)({parentUID:F,pageSize:l.md}))})}}),importDashboard:N.mutation({query:({dashboard:F,overwrite:w,inputs:B,folderUid:U})=>({method:"POST",url:"/dashboards/import",data:{dashboard:F,overwrite:w,inputs:B,folderUid:U}}),onQueryStarted:({folderUid:F},{queryFulfilled:w,dispatch:B})=>{w.then(async U=>{B((0,v.bw)({parentUID:F,pageSize:l.md}));const K=i.I.stripBaseFromUrl(U.data.importedUrl);a.Ny.push(K)})}}),restoreDashboard:N.mutation({query:({dashboardUID:F})=>({url:`/dashboards/uid/${F}/trash`,method:"PATCH"})}),hardDeleteDashboard:N.mutation({queryFn:async({dashboardUID:F},w,B,U)=>{const V=(await U({url:`/dashboards/uid/${F}/trash`,method:"DELETE",showSuccessAlert:!1}))?.data?.title;return V&&o.A.publish({type:r.r1.alertSuccess.name,payload:[(0,m.t)("browse-dashboards.hard-delete.success","Dashboard {{name}} deleted",{name:V})]}),{data:void 0}},onQueryStarted:({dashboardUID:F},{queryFulfilled:w,dispatch:B})=>{w.then(()=>{B((0,v.Zw)([F]))})}})})}),{endpoints:E,useDeleteFolderMutation:x,useDeleteItemsMutation:P,useGetAffectedItemsQuery:b,useGetFolderQuery:M,useMoveFolderMutation:O,useMoveItemsMutation:I,useNewFolderMutation:T,useSaveDashboardMutation:C,useSaveFolderMutation:S,useRestoreDashboardMutation:A,useHardDeleteDashboardMutation:L}=D},92955:(k,R,e)=>{"use strict";e.d(R,{aw:()=>f,md:()=>o,uT:()=>h});var t=e(32264),n=e(17172),i=e(53477),s=e(24439),r=e(40957),g=e(10096),a=e(31678),c=e(49952);const o=50;async function h(d,p,m=1,v=o){if(d&&!t.$.featureToggles.nestedFolders)return[];const l=(0,n.AI)();let y=[];g.TP.hasPermission(a.AccessControlAction.FoldersRead)&&(y=await l.get("/api/folders",{parentUid:d,page:m,limit:v}));const u=t.$.appSubUrl??"";return y.map(D=>({kind:"folder",uid:D.uid,title:D.title,parentTitle:p,parentUID:d,url:(0,c.I)(D.uid)?void 0:`${u}/dashboards/f/${D.uid}/`}))}async function f(d,p=1,m=o){const l=await(0,s.getGrafanaSearcher)().search({kind:["dashboard"],query:"*",location:d||"general",from:(p-1)*m,limit:m});return l.view.map(y=>{const u=(0,r.hI)(y,l.view);return u.parentUID===i.TF&&(u.parentUID=void 0),u})}},43907:(k,R,e)=>{"use strict";e.d(R,{x:()=>c});var t=e(74848),n=e(70255),i=e(94753),s=e(42418),r=e(55314),g=e(8484);function a(o,h,f,d){const p=o+h+f+d,m=[];o&&m.push((0,g.t)("browse-dashboards.counts.folder","{{count}} folder",{count:o})),h&&m.push((0,g.t)("browse-dashboards.counts.dashboard","{{count}} dashboard",{count:h})),f&&m.push((0,g.t)("browse-dashboards.counts.libraryPanel","{{count}} library panel",{count:f})),d&&m.push((0,g.t)("browse-dashboards.counts.alertRule","{{count}} alert rule",{count:d}));let v=(0,g.t)("browse-dashboards.counts.total","{{count}} item",{count:p});return m.length>0&&(v+=`: ${m.join(", ")}`),v}const c=({selectedItems:o})=>{const{data:h,isFetching:f,isLoading:d,error:p}=(0,r.G2)(o);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(i.E,{element:"p",color:"secondary",children:[h&&a(h.folder,h.dashboard,h.libraryPanel,h.alertRule),(f||d)&&(0,t.jsx)(n.A,{width:200})]}),p&&(0,t.jsx)(s.F,{severity:"error",title:"Unable to retrieve descendant information"})]})}},49952:(k,R,e)=>{"use strict";e.d(R,{I:()=>i,e:()=>n});var t=e(32264);function n(s,r){return s+r.uid}function i(s){return s===t.$.sharedWithMeFolderUID}},36141:(k,R,e)=>{"use strict";e.d(R,{Ii:()=>a,Zw:()=>r,bw:()=>g});var t=e(53477),n=e(31678),i=e(92955),s=e(93519);const r=(0,n.createAsyncThunk)("browseDashboards/refreshParents",async(c,{getState:o,dispatch:h})=>{const{browseDashboards:f}=o(),{rootItems:d,childrenByParentUID:p}=f,m=new Set;for(const v of c){const l=(0,s.R)(d?.items??[],p,v);m.add(l?.parentUID)}for(const v of m)h(g({parentUID:v,pageSize:i.md}))}),g=(0,n.createAsyncThunk)("browseDashboards/refetchChildren",async({parentUID:c,pageSize:o})=>{const h=c===t.TF?void 0:c;let f=1,d="folder",p=await(0,i.uT)(h,void 0,f,o),m=p.length<o;if(d==="folder"&&m){d="dashboard",f=1;const v=await(0,i.aw)(h,f,o);m=v.length<o,p=p.concat(v)}return{children:p,lastPageOfKind:m,page:f,kind:d}}),a=(0,n.createAsyncThunk)("browseDashboards/fetchNextChildrenPage",async({parentUID:c,excludeKinds:o=[],pageSize:h},f)=>{const d=!o.includes("dashboard"),p=c===t.TF?void 0:c,m=f.getState().browseDashboards,v=p?m.childrenByParentUID[p]:m.rootItems;let l=1,y;if(v?v.lastFetchedKind==="dashboard"&&!v.lastKindHasMoreItems?console.warn(`fetchNextChildrenPage called for ${p} but that collection is fully loaded`):v.lastFetchedKind==="folder"&&v.lastKindHasMoreItems?(l=v.lastFetchedPage+1,y="folder"):d&&(l=v.lastFetchedKind==="folder"?1:v.lastFetchedPage+1,y="dashboard"):(l=1,y="folder"),!y)return;let u=y==="folder"?await(0,i.uT)(p,void 0,l,h):await(0,i.aw)(p,l,h),D=u.length<h;if(y==="folder"&&D&&d){y="dashboard",l=1;const E=await(0,i.aw)(p,l,h);D=E.length<h,u=u.concat(E)}return{children:u,lastPageOfKind:D,page:l,kind:y}})},37690:(k,R,e)=>{"use strict";e.d(R,{Am:()=>h,xN:()=>t.xN,Ii:()=>n.Ii,bw:()=>n.bw,Zw:()=>n.Zw,ku:()=>o,cT:()=>t.cT,wn:()=>t.wn,t$:()=>t.t$,xK:()=>x,eC:()=>l,Ms:()=>D,V6:()=>E,q0:()=>y,QE:()=>u,Zg:()=>P});var t=e(79763),n=e(36141),i=e(96540),s=e(25508),r=e(31678),g=e(92955),a=e(49952),c=e(93519);const o=M=>M.browseDashboards.rootItems,h=M=>M.browseDashboards.childrenByParentUID,f=M=>M.browseDashboards.openFolders,d=M=>M.browseDashboards.selectedItems,p=(0,s.Mz)(o,h,f,(M,O)=>O,(M,O,I,T)=>b(T,M,O,I)),m=(0,s.Mz)(d,M=>Object.values(M).some(O=>Object.values(O).some(I=>I))),v=(0,s.Mz)(d,h,(M,O)=>{const I={dashboard:{...M.dashboard},folder:{...M.folder}};for(const T of Object.keys(M.folder))if(M.folder[T]){const S=O[T];if(S)for(const A of S.items)A.kind==="dashboard"&&(I.dashboard[A.uid]=!1),A.kind==="folder"&&(I.folder[A.uid]=!1)}return I});function l(M){return(0,r.useSelector)(O=>(M?O.browseDashboards.childrenByParentUID[M]:O.browseDashboards.rootItems)?"fulfilled":"pending")}function y(M){return(0,r.useSelector)(O=>p(O,M))}function u(){return(0,r.useSelector)(M=>m(M))}function D(){return(0,r.useSelector)(d)}function E(){return(0,r.useSelector)(M=>M.browseDashboards.childrenByParentUID)}function x(){return(0,r.useSelector)(M=>v(M))}function P(M=[]){const O=(0,r.useDispatch)(),I=(0,i.useRef)(!1);return(0,i.useCallback)(C=>{if(I.current)return Promise.resolve();I.current=!0;const S=O((0,n.Ii)({parentUID:C,excludeKinds:M,pageSize:g.md}));return S.finally(()=>I.current=!1),S},[O,M])}function b(M,O,I,T,C=0,S=[],A=[]){function L(V,H,Y){if(S.includes(V.kind)||A.includes(V.uid))return[];const X=b(V.uid,O,I,T,Y+1,S,A),J=!!T[V.uid],q=I[V.uid]?.items.length===0;J&&q&&!S.includes("empty-folder")&&X.push({isOpen:!1,level:Y+1,item:{kind:"ui",uiKind:"empty-folder",uid:V.uid+"empty-folder"},parentUID:H});const ae={item:V,parentUID:H,level:Y,isOpen:J},j=[ae,...X];return(0,a.I)(ae.item.uid)&&j.push({item:{kind:"ui",uiKind:"divider",uid:"shared-with-me-divider"},parentUID:H,level:Y+1,isOpen:!1}),j}const N=M&&T[M]||C===0,F=M?I[M]:O;let B=((M?N&&F?.items:F?.items)||[]).flatMap(V=>L(V,M,C));const U=S.includes("dashboard")&&F?.lastFetchedKind==="dashboard";return(C===0&&!F||N&&F&&!(F.isFullyLoaded||U))&&(B=B.concat((0,c.T)(g.md,M,C))),B}},79763:(k,R,e)=>{"use strict";e.d(R,{xN:()=>x,Ay:()=>P,cT:()=>E,wn:()=>u,t$:()=>D});var t={};e.r(t),e.d(t,{clearFolders:()=>f,fetchNextChildrenPageFulfilled:()=>a,refetchChildrenFulfilled:()=>g,setAllSelection:()=>h,setFolderOpenState:()=>c,setItemSelectionState:()=>o});var n=e(65307),i=e(36141),s=e(49952),r=e(93519);function g(b,M){const{children:O,page:I,kind:T,lastPageOfKind:C}=M.payload,{parentUID:S}=M.meta.arg,A={items:O,lastFetchedKind:T,lastFetchedPage:I,lastKindHasMoreItems:!C,isFullyLoaded:T==="dashboard"&&C};S?b.childrenByParentUID[S]=A:b.rootItems=A}function a(b,M){const O=M.payload;if(!O)return;const{children:I,page:T,kind:C,lastPageOfKind:S}=O,{parentUID:A,excludeKinds:L=[]}=M.meta.arg,w={items:((A?b.childrenByParentUID[A]:b.rootItems)?.items??[]).concat(I),lastFetchedKind:C,lastFetchedPage:T,lastKindHasMoreItems:!S,isFullyLoaded:(L.includes("dashboard")||C==="dashboard")&&S};if(!A){b.rootItems=w;return}if(b.childrenByParentUID[A]=w,b.selectedItems.folder[A])for(const U of I)b.selectedItems[U.kind][U.uid]=!0}function c(b,M){const{folderUID:O,isOpen:I}=M.payload;b.openFolders[O]=I}function o(b,M){const{item:O,isSelected:I}=M.payload;if((0,s.I)(O.uid))return;function T(C,S){if(b.selectedItems[C][S]=I,C!=="folder")return;let A=b.childrenByParentUID[S];for(const L of A?.items??[])T(L.kind,L.uid)}if(T(O.kind,O.uid),!I){let C=O.parentUID;for(;C;){const S=(0,r.R)(b.rootItems?.items??[],b.childrenByParentUID,C);if(!S)break;b.selectedItems[S.kind][S.uid]=!1,C=S.parentUID}}b.selectedItems.$all=b.rootItems?.items?.every(C=>b.selectedItems[C.kind][C.uid])??!1}function h(b,M){const{isSelected:O,folderUID:I}=M.payload;if(!(I&&(0,s.I)(I)))if(b.selectedItems.$all=O,O){let C=function(S){if(S&&(0,s.I)(S))return;const A=S?b.childrenByParentUID[S]:b.rootItems;if(A)for(const L of A.items)(0,s.I)(L.uid)||(b.selectedItems[L.kind][L.uid]=O,L.kind==="folder"&&C(L.uid))};var T=C;C(I)}else for(const C in b.selectedItems){if(!(C==="dashboard"||C==="panel"||C==="folder"))continue;const S=b.selectedItems[C];for(const A in S)S[A]=O}}function f(b,M){const O=Array.isArray(M.payload)?M.payload:[M.payload];for(const I of O)I?(b.childrenByParentUID[I]=void 0,b.openFolders[I]=!1):b.rootItems=void 0}const{fetchNextChildrenPageFulfilled:d,refetchChildrenFulfilled:p,...m}=t,v={rootItems:void 0,childrenByParentUID:{},openFolders:{},selectedItems:{dashboard:{},folder:{},panel:{},$all:!1}},l=(0,n.Z0)({name:"browseDashboards",initialState:v,reducers:m,extraReducers:b=>{b.addCase(i.Ii.fulfilled,d),b.addCase(i.bw.fulfilled,p)}}),y=l.reducer,{setFolderOpenState:u,setItemSelectionState:D,setAllSelection:E,clearFolders:x}=l.actions,P={browseDashboards:y}},93519:(k,R,e)=>{"use strict";e.d(R,{R:()=>t,T:()=>n});function t(i,s,r){for(const g of i)if(g.uid===r)return g;for(const g in s){const a=s[g];if(a){for(const c of a.items)if(c.uid===r)return c}}}function n(i,s,r){return new Array(i).fill(null).map((g,a)=>({parentUID:s,level:r,isOpen:!1,item:{kind:"ui",uiKind:"pagination-placeholder",uid:`${s}-pagination-${a}`}}))}},6320:(k,R,e)=>{"use strict";e.d(R,{b:()=>n,q:()=>t});const t="connections",n={Base:`/${t}`,DataSources:`/${t}/datasources`,DataSourcesNew:`/${t}/datasources/new`,DataSourcesEdit:`/${t}/datasources/edit/:uid`,DataSourcesDashboards:`/${t}/datasources/edit/:uid/dashboards`,AddNewConnection:`/${t}/add-new-connection`,DataSourcesDetails:`/${t}/datasources/:id`,ConnectDataOutdated:`/${t}/connect-data`,YourConnectionsOutdated:`/${t}/your-connections`}},67023:(k,R,e)=>{"use strict";e.d(R,{k:()=>r});var t=e(60455),n=e.n(t),i=e(91890),s=e(87490);const r=(g,a,c)=>{let o={},h={};if(g.type===i.CC.Regex&&g.expression){const f=new RegExp(g.expression,"gi"),p=(typeof a=="string"?a:(0,s.MA)(a)).matchAll(f);for(const m of p)m.groups?h=m.groups:h[g.mapValue||c]=m[1]||m[0]}else g.type===i.CC.Logfmt&&(h=n().parse(a));return Object.keys(h).forEach(f=>{const d=typeof h[f]=="string"?h[f]:(0,s.MA)(h[f]);o[f]={value:d}}),o}},40511:(k,R,e)=>{"use strict";e.d(R,{F0:()=>c,bQ:()=>o,lW:()=>h});var t=e(41053),n=e(75505),i=e(19347),s=e(76888),r=e(18380);const g=({sourceUID:f,targetUID:d,...p})=>{const m=(0,i.l)().getInstanceSettings(f),v=(0,i.l)().getInstanceSettings(d);if((p?.orgId===void 0||p?.orgId===null||p?.orgId===0)&&r.kb.logWarning("Invalid correlation config: Missing org id."),m&&m?.uid!==void 0&&v&&v.uid!==void 0)return{...p,source:m,target:v};r.kb.logWarning("Invalid correlation config: Missing source or target.",{source:JSON.stringify(m),target:JSON.stringify(v)})},a=f=>!!f,c=f=>({...f,correlations:f.correlations.map(g).filter(a)});function o(f){return f.data}const h=()=>{const{backend:f}=(0,s.Il)(),[d,p]=(0,t.A)(E=>(0,n.s)(f.fetch({url:"/api/datasources/correlations",params:{page:E.page},method:"GET",showErrorAlert:!1})).then(o).then(c),[f]),[m,v]=(0,t.A)(({sourceUID:E,...x})=>f.post(`/api/datasources/uid/${E}/correlations`,x).then(P=>{const b=g(P.result);if(b!==void 0)return b;throw new Error("invalid sourceUID")}),[f]),[l,y]=(0,t.A)(({sourceUID:E,uid:x})=>f.delete(`/api/datasources/uid/${E}/correlations/${x}`),[f]),[u,D]=(0,t.A)(({sourceUID:E,uid:x,...P})=>f.patch(`/api/datasources/uid/${E}/correlations/${x}`,P).then(b=>{const M=g(b.result);if(M!==void 0)return M;throw new Error("invalid sourceUID")}),[f]);return{create:{execute:v,...m},update:{execute:D,...u},get:{execute:p,...d},remove:{execute:y,...l}}}},18380:(k,R,e)=>{"use strict";e.d(R,{$q:()=>f,J6:()=>h,cA:()=>c,kb:()=>m,tZ:()=>p});var t=e(75505),n=e(91890),i=e(17172),s=e(19347),r=e(34867),g=e(9651),a=e(40511);const c=(v,l,y)=>(v.forEach(u=>{const D=u.refId;if(!D)return;let E=y[D];if(E===void 0&&u.meta?.preferredVisualisationType==="rawPrometheus"){const P=(0,g.a)(D);E=y[P]}const x=l.filter(P=>P.source.uid===E);o(u,x)}),v),o=(v,l)=>{v.fields.forEach(y=>{y.config.links=y.config.links?.filter(u=>u.origin!==n.x0.Correlations)||[],l.map(u=>{if(u.config?.field===y.name){const D=u.config?.target||{};y.config.links.push({internal:{query:{...D,datasource:{uid:u.target.uid}},datasourceUid:u.target.uid,datasourceName:u.target.name,transformations:u.config?.transformations},url:"",title:u.label||u.target.name,origin:n.x0.Correlations})}})})},h=async v=>(0,t.s)((0,i.AI)().fetch({url:"/api/datasources/correlations",method:"GET",showErrorAlert:!1,params:{sourceUID:v}})).then(a.bQ).then(a.F0),f=async(v,l)=>(0,i.AI)().post(`/api/datasources/uid/${v}/correlations`,l),d=async v=>v.datasourceInstance?.meta.mixed?await(0,s.l)().get(v.queries[0].datasource):v.datasourceInstance,p=async(v,l)=>Promise.all([d(v),d(l)]).then(y=>y[0]?.name!==void 0&&y[1]?.name!==void 0?`${y[0]?.name} to ${y[1]?.name}`:""),m=(0,r.DW)("features.correlations")},41524:(k,R,e)=>{"use strict";e.d(R,{W:()=>i});var t=e(11261);function n(){const s="ABCDEFGHIJKLMNOPQRSTUVWXYZ",r="abcdefghijklmnopqrstuvwxyz",g=s.length,a=new Map;return c=>{const o=a.get(c);if(o!=null)return o;const h=[...c].map(f=>f.toLowerCase()&&f!==f.toUpperCase()?r.charAt(Math.floor(Math.random()*g)):f.toUpperCase()&&f!==f.toUpperCase()?s.charAt(Math.floor(Math.random()*g)):f).join("");return a.set(c,h),h}}function i(s,r){if(!(r.labels||r.names||r.values))return s;const g=new Set(["time","value","exemplar","traceid","id","uid","uuid","__name__","le","name"]),a=n();return s.map(c=>{let{schema:o,data:h}=c;if(o&&h){if(r.labels){for(const f of o.fields)if(f.labels){const d={};for(const[p,m]of Object.entries(f.labels))d[p]=a(m);f.labels=d}}if(r.names)for(const f of o.fields)f.name?.length&&!g.has(f.name.toLowerCase())&&(f.name=a(f.name));r.values&&o.fields.forEach((f,d)=>{if(f.type===t.PU.string&&h){const p=h.values[d].map(m=>a(String(m)));h.values[d]=p}})}return{schema:o,data:h}})}},72255:(k,R,e)=>{"use strict";e.d(R,{m6:()=>P,sP:()=>O});var t=e(71733),n=e(17172),i=e(39601),s=e(32264),r=e(2619),g=e(33390),a=e(94954),c=e(78160),o=e(17493),h=e(14792),f=e(41176),d=e(20470),p=e(16833),m=e(31678),v=e(61642),l=e(71176),y=e(85445),u=e(27734),D=e(77431);const E=500,x="loadDashboardScene",P="__grafana_home_uid__";class b extends r.Q{constructor(){super(...arguments),this.cache={}}async fetchDashboard({uid:C,route:S,urlFolderUid:A,keepDashboardFromExploreInLocalStorage:L}){const N=g.A.getObject(d.us);if(N)return L||(0,d.yZ)(),N;const F=S===m.DashboardRoutes.Home?P:C,w=this.getDashboardFromCache(F);if(w)return w;let B;try{switch(S){case m.DashboardRoutes.New:B=await(0,l.X)(A);break;case m.DashboardRoutes.Home:if(B=await(0,n.AI)().get("/api/dashboards/home"),B.redirectUri)return B;B?.meta&&(B.meta.canSave=!1,B.meta.canShare=!1,B.meta.canStar=!1);break;case m.DashboardRoutes.Public:return await o.np.loadDashboard("public","",C);default:B=await o.np.loadDashboard("db","",C),S===m.DashboardRoutes.Embedded&&(B.meta.isEmbedded=!0)}if(B.meta.url&&S===m.DashboardRoutes.Normal){const U=t.I.stripBaseFromUrl(B.meta.url),K=i.Ny.getLocation().pathname;U!==K&&(i.Ny.replace({...i.Ny.getLocation(),pathname:U}),console.log("not correct url correcting",U,K))}B.meta.folderUid&&await(0,D.Q)(B.meta.folderUid),this.setDashboardCache(F,B)}catch(U){if((0,n.NF)(U)&&U.cancelled)return null;throw U}return B}async loadSnapshot(C){try{const S=await this.loadSnapshotScene(C);this.setState({dashboard:S,isLoading:!1})}catch(S){this.setState({isLoading:!1,loadError:String(S)})}}async loadSnapshotScene(C){const S=await o.np.loadDashboard("snapshot",C,"");if(S?.dashboard)return(0,y.wM)(S);throw new Error("Snapshot not found")}async loadDashboard(C){try{(0,c.j)(x);const S=await this.loadScene(C);if(!S)return;s.$.featureToggles.preserveDashboardStateWhenNavigating&&C.uid&&(0,u.Gq)(S),this.setState({dashboard:S,isLoading:!1});const A=(0,c.z)(x);(0,p.D)(S,A?.duration),C.route!==m.DashboardRoutes.New&&(0,f.B)({meta:S.state.meta,uid:S.state.uid,title:S.state.title,id:S.state.id})}catch(S){const A=(0,a.q)(S);this.setState({isLoading:!1,loadError:A})}}async loadScene(C){const S=!!(g.A.getObject(d.us)&&C.keepDashboardFromExploreInLocalStorage===!1);this.setState({isLoading:!0});const A=await this.fetchDashboard(C),L=this.getSceneFromCache(C.uid);if(!S&&L&&L.state.version===A?.dashboard.version)return L;if(A?.dashboard){const N=(0,y.wM)(A);return C.uid&&!S&&this.setSceneCache(C.uid,N),N}if(A?.redirectUri){const N=t.I.stripBaseFromUrl(A.redirectUri);return i.Ny.replace(N),null}throw new Error("Dashboard not found")}getDashboardFromCache(C){const S=this.dashboardCache;return C=this.getCacheKey(C),S&&S.cacheKey===C&&Date.now()-S?.ts<E?S.dashboard:null}clearState(){(0,h.UA)().setCurrent(void 0),this.setState({dashboard:void 0,loadError:void 0,isLoading:!1,panelEditor:void 0})}setDashboardCache(C,S){C=this.getCacheKey(C),this.dashboardCache={dashboard:S,ts:Date.now(),cacheKey:C}}clearDashboardCache(){this.dashboardCache=void 0}getSceneFromCache(C){return C=this.getCacheKey(C),this.cache[C]}setSceneCache(C,S){C=this.getCacheKey(C),this.cache[C]=S}getCacheKey(C){const S=(0,v.X)();return S?.has("scopes")?(S.sort(),`${C}__scp__${S.toString()}`):C}}let M=null;function O(){return M||(M=new b({})),M}function I(T){return createDashboardSceneFromDashboardModel(new DashboardModel({...defaultDashboard,title:T,panels:[{fieldConfig:{defaults:{},overrides:[]},gridPos:{h:6,w:12,x:7,y:0},id:1,options:{code:{language:"plaintext",showLineNumbers:!1,showMiniMap:!1},content:`<br/><br/><center><h1>${T}</h1></center>`,mode:"html"},title:"",transparent:!0,type:"text"}]},{canSave:!1,canEdit:!1}))}},77431:(k,R,e)=>{"use strict";e.d(R,{Q:()=>r});var t=e(82467),n=e(27677),i=e(71101),s=e(99140);async function r(g){try{const a=await n.IB.getFolderByUid(g);s.M_.dispatch((0,t.Vz)((0,i.R4)(a)))}catch(a){console.warn("Error fetching parent folder",g,"for dashboard",a)}}},79280:(k,R,e)=>{"use strict";e.d(R,{p:()=>c});var t=e(74848),n=e(13544),i=e(90613),s=e(67061),r=e(94753),g=e(55852),a=e(8484);function c(o){return(0,t.jsx)(i.a,{alignItems:"center",padding:4,children:(0,t.jsxs)(s.B,{direction:"column",alignItems:"center",gap:2,children:[(0,t.jsx)(r.E,{element:"h3",textAlignment:"center",children:(0,t.jsx)(a.x6,{i18nKey:"transformations.empty.add-transformation-header",children:"Start transforming data"})}),(0,t.jsx)(r.E,{element:"p",textAlignment:"center","data-testid":n.Tp.components.Transforms.noTransformationsMessage,children:(0,t.jsxs)(a.x6,{i18nKey:"transformations.empty.add-transformation-body",children:["Transformations allow data to be changed in various ways before your visualization is shown.",(0,t.jsx)("br",{}),"This includes joining data together, renaming fields, making calculations, formatting data for display, and more."]})}),(0,t.jsx)(g.$n,{icon:"plus",variant:"primary",size:"md",onClick:o.onShowPicker,"data-testid":n.Tp.components.Transforms.addTransformationButton,children:"Add transformation"})]})})}},19293:(k,R,e)=>{"use strict";e.d(R,{i:()=>Wn,L:()=>Nn});var t=e(39601),n=e(32264),i=e(80943),s=e(41507),r=e(60656),g=e(74730),a=e(74848),c=e(32196),o=e(13544),h=e(40845),f=e(63021),d=e(40276),p=e(40980),m=e(66864),v=e(2913),l=e(10096),y=e(75471),u=e(57220),D=e(42418),E=e(39558),x=e(40675),P=e(80215),b=e(27747),M=e(56361),O=e(24180),I=e(16817),T=e(76885),C=e(34867),S=e(55852),A=e(25027),L=e(63066);const N=({panel:Tt,className:Wt})=>{const jt=(0,O.zy)(),{loading:ut,value:Zt}=(0,I.A)(()=>(0,L.J6)(Tt),[Tt]);if(ut)return(0,a.jsx)(S.$n,{disabled:!0,children:"New alert rule"});if(!Zt)return(0,a.jsx)(D.F,{severity:"info",title:"No alerting capable query found",children:"Cannot create alerts from this panel because no query to an alerting capable datasource is found."});const jn=async()=>{(0,C.fH)(A.le.alertRuleFromPanel);const Xn=await(0,L.J6)(Tt),Qn=T.kM.renderUrl("/alerting/new",{defaults:JSON.stringify(Xn),returnTo:jt.pathname+jt.search});t.Ny.push(Qn)};return(0,a.jsx)(S.$n,{icon:"bell",onClick:jn,className:Wt,"data-testid":"create-alert-rule-button",children:"New alert rule"})};var F=(Tt=>(Tt.Queries="queries",Tt.Transformations="transformations",Tt.Alert="alert",Tt))(F||{});class w extends i.Bs{constructor(Wt){super({}),this.tabId=F.Alert,this.TabComponent=jt=>K({...jt,model:this}),this._panelManager=Wt}static{this.Component=B}getTabLabel(){return"Alert"}getDashboardUID(){return this.getDashboard().state.uid}getDashboard(){return(0,g.YQ)(this._panelManager)}getLegacyPanelId(){return(0,g.Cs)(this._panelManager.state.panel)}getCanCreateRules(){const Wt=(0,y.Wd)("grafana");return this.getDashboard().state.meta.canSave&&l.TP.hasPermission(Wt.create)}get panelManager(){return this._panelManager}get panel(){return this._panelManager.state.panel}}function B(Tt){const{model:Wt}=Tt,jt=(0,h.of)(U),{errors:ut,loading:Zt,rules:jn}=(0,b.S)({dashboardUID:Wt.getDashboardUID(),panelId:Wt.getLegacyPanelId()}),Xn=ut.length?(0,a.jsx)(D.F,{title:"Errors loading rules",severity:"error",children:ut.map((qn,js)=>(0,a.jsxs)("div",{children:["Failed to load Grafana rules state: ",(0,M.JZ)(qn)]},js))}):null;if(Zt&&!jn.length)return(0,a.jsxs)(a.Fragment,{children:[Xn,(0,a.jsx)(E._,{text:"Loading rules..."})]});const{panel:Qn}=Wt,Fn=Wt.getCanCreateRules();return jn.length?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(P.s,{rules:jn}),Fn&&(0,a.jsx)(N,{className:jt.newButton,panel:Qn})]}):(0,a.jsxs)("div",{className:jt.noRulesWrapper,children:[(0,a.jsx)("p",{children:"There are no alert rules linked to this panel."}),Fn&&(0,a.jsx)(N,{panel:Qn})]})}const U=Tt=>({newButton:(0,c.css)({marginTop:Tt.spacing(3)}),noRulesWrapper:(0,c.css)({margin:Tt.spacing(2),backgroundColor:Tt.colors.background.secondary,padding:Tt.spacing(3)})});function K(Tt){const{model:Wt}=Tt,{rules:jt}=(0,b.S)({dashboardUID:Wt.getDashboardUID(),panelId:Wt.getLegacyPanelId(),poll:!1});return(0,a.jsx)(x.o,{label:Wt.getTabLabel(),icon:"bell",counter:jt.length,active:Tt.active,onChangeTab:Tt.onChangeTab},Tt.key)}var V=e(22391),H=e(41987),Y=e(19347),X=e(67061),J=e(21969),q=e(53478),ae=e(64152),j=e(44932),te=e(37464),ne=e(14348),le=e(7928);class z extends i.Bs{constructor(Wt){super({}),this.tabId=F.Queries,this.icon="database",this.onOpenInspector=()=>{this._panelManager.inspectPanel()},this.onChangeDataSource=async(jt,ut)=>{this._panelManager.changePanelDataSource(jt,ut)},this.onQueryOptionsChange=jt=>{this._panelManager.changeQueryOptions(jt)},this.onQueriesChange=jt=>{this._panelManager.changeQueries(jt)},this.onRunQueries=()=>{this._panelManager.queryRunner.runQueries()},this.addQueryClick=()=>{const jt=this.getQueries();this.onQueriesChange((0,J.U7)(jt,this.newQuery()))},this.onAddQuery=jt=>{const ut=this.getQueries(),Zt=this._panelManager.state.dsSettings;this.onQueriesChange((0,J.U7)(ut,jt,Zt?(0,V.p$)(Zt):{type:void 0,uid:void 0}))},this.onAddExpressionClick=()=>{const jt=this.getQueries();this.onQueriesChange((0,J.U7)(jt,q.Ex.newQuery()))},this.TabComponent=jt=>se({...jt,model:this}),this._panelManager=Wt}static{this.Component=ee}getTabLabel(){return"Queries"}getItemsCount(){return this.getQueries().length}buildQueryOptions(){const Wt=this._panelManager,jt=this._panelManager.state.panel,ut=this._panelManager.queryRunner,Zt=i.jh.getTimeRange(jt);let jn={from:void 0,shift:void 0,hide:void 0};Zt instanceof le.v&&(jn={from:Zt.state.timeFrom,shift:Zt.state.timeShift,hide:Zt.state.hideTimeOverride});let Xn=ut.state.queries;return{cacheTimeout:Wt.state.dsSettings?.meta.queryOptions?.cacheTimeout?ut.state.cacheTimeout:void 0,queryCachingTTL:Wt.state.dsSettings?.cachingConfig?.enabled?ut.state.queryCachingTTL:void 0,dataSource:{default:Wt.state.dsSettings?.isDefault,...Wt.state.dsSettings?(0,V.p$)(Wt.state.dsSettings):{type:void 0,uid:void 0}},queries:Xn,maxDataPoints:ut.state.maxDataPoints,minInterval:ut.state.minInterval,timeRange:jn}}getQueries(){return this._panelManager.queryRunner.state.queries}newQuery(){const{dsSettings:Wt,datasource:jt}=this._panelManager.state;let ut;return Wt?.meta.mixed?jt?.meta.mixed?ut=(0,Y.l)().getInstanceSettings(n.$.defaultDatasource):ut=jt:ut=Wt,{...jt?.getDefaultQuery?.(H.Jk.PanelEditor),datasource:{uid:ut?.uid,type:ut?.type}}}isExpressionsSupported(Wt){return(Wt.meta.alerting||Wt.meta.mixed)===!0}renderExtraActions(){return ae.m.getAllExtraRenderAction().map((Wt,jt)=>Wt({onAddQuery:this.onAddQuery,onChangeDataSource:this.onChangeDataSource,key:jt})).filter(Boolean)}get queryRunner(){return this._panelManager.queryRunner}get panelManager(){return this._panelManager}}function ee({model:Tt}){const{datasource:Wt,dsSettings:jt}=Tt.panelManager.useState(),{data:ut,queries:Zt}=Tt.panelManager.queryRunner.useState();if(!Wt||!jt||!ut)return null;const jn=!(0,ne.kN)(jt.name);return(0,a.jsxs)("div",{"data-testid":o.Tp.components.QueryTab.content,children:[(0,a.jsx)(te.K,{data:ut,dsSettings:jt,dataSource:Wt,options:Tt.buildQueryOptions(),onDataSourceChange:Tt.onChangeDataSource,onOptionsChange:Tt.onQueryOptionsChange,onOpenQueryInspector:Tt.onOpenInspector}),(0,a.jsx)(j.L,{data:ut,queries:Zt,dsSettings:jt,onAddQuery:Tt.onAddQuery,onQueriesChange:Tt.onQueriesChange,onRunQueries:Tt.onRunQueries}),(0,a.jsxs)(X.B,{gap:2,children:[jn&&(0,a.jsx)(S.$n,{icon:"plus",onClick:Tt.addQueryClick,variant:"secondary","data-testid":o.Tp.components.QueryTab.addQuery,children:"Add query"}),n.$.expressionsEnabled&&Tt.isExpressionsSupported(jt)&&(0,a.jsx)(S.$n,{icon:"plus",onClick:Tt.onAddExpressionClick,variant:"secondary","data-testid":o.Tp.components.QueryTab.addExpression,children:(0,a.jsx)("span",{children:"Expression\xA0"})}),Tt.renderExtraActions()]})]})}function se(Tt){const{model:Wt}=Tt,jt=Wt.queryRunner.useState();return(0,a.jsx)(x.o,{label:Wt.getTabLabel(),icon:"database",counter:jt.queries.length,active:Tt.active,onChangeTab:Tt.onChangeTab},Tt.key)}var ie=e(91076),Z=e(96540),oe=e(19727),ce=e(96374),ye=e(57650),re=e(79280),ue=e(97497),De=e(29158),ge=e(21427),Te=e(66879);function Le(Tt){const{isOpen:Wt,series:jt,onClose:ut,onTransformationAdd:Zt}=Tt,[jn,Xn]=(0,Z.useState)({search:"",showIllustrations:!0}),Qn=es=>Xn({...jn,search:es.currentTarget.value}),Fn=es=>Xn({...jn,showIllustrations:es}),qn=es=>Xn({...jn,selectedFilter:es}),js=(0,Z.useMemo)(()=>ue.h.list().sort((es,_s)=>es.name>_s.name?1:_s.name>es.name?-1:0),[]),ys=js.filter(es=>jn.selectedFilter&&jn.selectedFilter!==Te.e&&!es.categories?.has(jn.selectedFilter)?!1:es.name.toLocaleLowerCase().includes(jn.search.toLocaleLowerCase())),Ps=(0,a.jsxs)(a.Fragment,{children:[ys.length," / ",js.length," \xA0\xA0",(0,a.jsx)(De.K,{name:"times",onClick:()=>{Xn({...jn,search:""})},tooltip:"Clear search"})]});if(Wt)return(0,a.jsx)(ge.R,{data:jt,onTransformationAdd:Zt,xforms:ys,search:jn.search,noTransforms:!1,suffix:jn.search!==""?Ps:(0,a.jsx)(a.Fragment,{}),selectedFilter:jn.selectedFilter,onSearchChange:Qn,onSearchKeyDown:()=>{},showIllustrations:jn.showIllustrations,onShowIllustrationsChange:Fn,onSelectedFilterChange:qn,onClose:ut})}class Ye extends i.Bs{constructor(Wt){super({}),this.tabId=F.Transformations,this.icon="process",this.TabComponent=jt=>Pe({...jt,model:this}),this._panelManager=Wt}static{this.Component=je}getTabLabel(){return"Transformations"}getQueryRunner(){return this._panelManager.queryRunner}getDataTransformer(){return this._panelManager.dataTransformer}onChangeTransformations(Wt){this._panelManager.changeTransformations(Wt)}get panelManager(){return this._panelManager}}function je({model:Tt}){const Wt=(0,h.of)(Ne),jt=Tt.getQueryRunner().useState(),{data:ut,transformations:Zt}=Tt.getDataTransformer().useState(),jn=Zt,[Xn,Qn]=(0,Z.useState)(!1),[Fn,qn]=(0,Z.useState)(!1),js=()=>Qn(!0),ys=()=>Qn(!1);if(!ut||!jt.data)return;const Ps=(0,a.jsx)(Le,{onClose:ys,onTransformationAdd:es=>{es.value!==void 0&&(Tt.onChangeTransformations([...jn,{id:es.value,options:{}}]),ys())},isOpen:Xn,series:ut.series});return jn.length<1?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(re.p,{onShowPicker:js}),Ps]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Ze,{data:jt.data,transformations:jn,model:Tt}),(0,a.jsxs)(oe.e,{children:[(0,a.jsx)(S.$n,{icon:"plus",variant:"secondary",onClick:js,"data-testid":o.Tp.components.Transforms.addTransformationButton,children:"Add another transformation"}),(0,a.jsx)(S.$n,{"data-testid":o.Tp.components.Transforms.removeAllTransformationsButton,className:Wt.removeAll,icon:"times",variant:"secondary",onClick:()=>qn(!0),children:"Delete all transformations"})]}),(0,a.jsx)(ce.u,{isOpen:Fn,title:"Delete all transformations?",body:"By deleting all transformations, you will go back to the main selection screen.",confirmText:"Delete all",onConfirm:()=>{Tt.onChangeTransformations([]),qn(!1)},onDismiss:()=>qn(!1)}),Ps]})}function Ze({transformations:Tt,model:Wt,data:jt}){const ut=Tt.map((jn,Xn)=>({id:`${Xn} - ${jn.id}`,transformation:jn})),Zt=jn=>{if(!jn||!jn.destination)return;const Xn=jn.source.index,Qn=jn.destination.index;if(Xn===Qn)return;const Fn=Array.from(ut),[qn]=Fn.splice(Xn,1);Fn.splice(Qn,0,qn),Wt.onChangeTransformations(Fn.map(js=>js.transformation))};return(0,a.jsx)(ie.JY,{onDragEnd:Zt,children:(0,a.jsx)(ie.gL,{droppableId:"transformations-list",direction:"vertical",children:jn=>(0,a.jsxs)("div",{ref:jn.innerRef,...jn.droppableProps,children:[(0,a.jsx)(ye.A,{onChange:(Xn,Qn)=>{const Fn=Tt.slice();Fn[Xn]=Qn,Wt.onChangeTransformations(Fn)},onRemove:Xn=>{const Qn=Tt.slice();Qn.splice(Xn,1),Wt.onChangeTransformations(Qn)},configs:ut,data:jt}),jn.placeholder]})})})}const Ne=Tt=>({removeAll:(0,c.css)({marginLeft:Tt.spacing(2)})});function Pe(Tt){const{model:Wt}=Tt,jt=Wt.getDataTransformer().useState();return(0,a.jsx)(x.o,{label:Wt.getTabLabel(),icon:"process",counter:jt.transformations.length,active:Tt.active,onChangeTab:Tt.onChangeTab},Tt.key)}class Ue extends i.Bs{constructor(Wt){super({tab:F.Queries,tabs:[]}),this._urlSync=new i.So(this,{keys:["tab"]}),this.onChangeTab=jt=>{this.setState({tab:jt.tabId})},this.panelManager=Wt,this.addActivationHandler(()=>this.onActivate())}static{this.Component=$e}getUrlState(){return{tab:this.state.tab}}updateFromUrl(Wt){Wt.tab&&typeof Wt.tab=="string"&&this.setState({tab:Wt.tab})}onActivate(){return this.buildTabs(),this._subs.add(this.panelManager.subscribeToState((Wt,jt)=>{Wt.pluginId!==jt.pluginId&&this.buildTabs()})),()=>{this.panelSubscription&&(this.panelSubscription.unsubscribe(),this.panelSubscription=void 0)}}buildTabs(){const Wt=this.panelManager,jt=Wt.state.panel,ut=Wt.state.pluginId,Zt=this.panelManager.queryRunner,jn=[];if(jt)if(v.config.panels[ut]?.skipDataQuery){this.setState({tabs:jn});return}else Zt&&jn.push(new z(this.panelManager)),jn.push(new Ye(this.panelManager)),ze(Wt.state.pluginId)&&jn.push(new w(this.panelManager));this.setState({tabs:jn})}}function $e({model:Tt}){const{tab:Wt,tabs:jt}=Tt.useState(),ut=(0,h.of)(qe);if(!jt||!jt.length)return;const Zt=jt.find(jn=>jn.tabId===Wt);return(0,a.jsxs)("div",{className:ut.dataPane,"data-testid":o.Tp.components.PanelEditor.DataPane.content,children:[(0,a.jsx)(f.U,{hideBorder:!0,className:ut.tabsBar,children:jt.map((jn,Xn)=>(0,a.jsx)(jn.TabComponent,{active:jn.tabId===Wt,onChangeTab:()=>Tt.onChangeTab(jn)},`${jn.getTabLabel()}-${Xn}`))}),(0,a.jsx)(d.E,{className:ut.scroll,children:(0,a.jsx)(p.J,{className:ut.tabContent,children:(0,a.jsx)(m.mc,{children:Zt&&(0,a.jsx)(Zt.Component,{model:Zt})})})})]})}function ze(Tt){const{unifiedAlertingEnabled:Wt=!1}=(0,v.zj)(),jt=l.TP.hasPermission((0,y.Wd)(u.hY).read);return Wt&&jt?Tt==="graph"||Tt==="timeseries":!1}function qe(Tt){return{dataPane:(0,c.css)({display:"flex",flexDirection:"column",flexGrow:1,minHeight:0,height:"100%",width:"100%"}),tabContent:(0,c.css)({padding:Tt.spacing(2),border:`1px solid ${Tt.colors.border.weak}`,borderLeft:"none",borderBottom:"none",borderTopRightRadius:Tt.shape.radius.default,flexGrow:1}),tabsBar:(0,c.css)({flexShrink:0,paddingLeft:Tt.spacing(2)}),scroll:(0,c.css)({background:Tt.colors.background.primary})}}var dt=e(27746),vt=e(94358),yt=e(54174),st=e(40996),Ve=e(37390),pe=e(10354),Ee=e(14578),me=e(57767),ve=e(43535);const Se=({libraryPanel:Tt,isUnsavedPrompt:Wt,onDismiss:jt,onConfirm:ut,onDiscard:Zt})=>{const[jn,Xn]=(0,Z.useState)(""),Qn=(0,I.A)(async()=>{const es=await(0,me.xV)(Tt.state.uid);return es.length>0?es.map(_s=>_s.title):[]},[Tt.state.uid]),[Fn,qn]=(0,Z.useState)([]);(0,st.A)(()=>Qn.value?qn(Qn.value.filter(es=>es.toLowerCase().includes(jn.toLowerCase()))):qn([]),300,[Qn.value,jn]);const js=(0,h.of)(ve.o),ys=(0,Z.useCallback)(()=>{Zt()},[Zt]),Ps=Wt?"Unsaved library panel changes":"Save library panel";return(0,a.jsx)(Ve.a,{title:Ps,icon:"save",onDismiss:jt,isOpen:!0,children:(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:js.textInfo,children:["This update will affect ",(0,a.jsxs)("strong",{children:[Tt.state._loadedPanel?.meta?.connectedDashboards," ",Tt.state._loadedPanel?.meta?.connectedDashboards===1?"dashboard":"dashboards","."]}),"The following dashboards using the panel will be affected:"]}),(0,a.jsx)(pe.p,{className:js.dashboardSearch,prefix:(0,a.jsx)(Ee.I,{name:"search"}),placeholder:"Search affected dashboards",value:jn,onChange:es=>Xn(es.currentTarget.value)}),Qn.loading?(0,a.jsx)("p",{children:"Loading connected dashboards..."}):(0,a.jsxs)("table",{className:js.myTable,children:[(0,a.jsx)("thead",{children:(0,a.jsx)("tr",{children:(0,a.jsx)("th",{children:"Dashboard name"})})}),(0,a.jsx)("tbody",{children:Fn.map((es,_s)=>(0,a.jsx)("tr",{children:(0,a.jsx)("td",{children:es})},`dashrow-${_s}`))})]}),(0,a.jsxs)(Ve.a.ButtonRow,{children:[(0,a.jsx)(S.$n,{variant:"secondary",onClick:jt,fill:"outline",children:"Cancel"}),Wt&&(0,a.jsx)(S.$n,{variant:"destructive",onClick:ys,children:"Discard"}),(0,a.jsx)(S.$n,{onClick:()=>{ut()},children:"Update all"})]})]})})};var Ie=e(21633);function Oe(Tt){const{paneOptions:Wt}=Tt,[jt,ut]=(0,Z.useState)({collapsed:!1}),Zt=(0,Z.useCallback)((ys,Ps)=>{if(ys<=0&&Ps<=0)return;const es=Ps/ys*(1-ys);jt.collapsed&&es>Wt.collapseBelowPixels&&ut({collapsed:!1}),!jt.collapsed&&es<Wt.collapseBelowPixels&&ut({collapsed:!0})},[jt,Wt.collapseBelowPixels]),jn=(0,Z.useCallback)((ys,Ps)=>{if(ys<=0&&Ps<=0)return;const es=1-ys,_s=jt.snapSize===0,ca=Ps/ys,Zs=(Wt.snapOpenToPixels??ca/2)/ca;jt.collapsed?ut(_s?{snapSize:Math.max(es,Zs),collapsed:!1}:{snapSize:0,collapsed:!0}):_s&&ut({snapSize:es,collapsed:!1})},[jt,Wt.snapOpenToPixels]),Xn=(0,Z.useCallback)(()=>{ut({collapsed:!jt.collapsed})},[jt.collapsed]),{containerProps:Qn,primaryProps:Fn,secondaryProps:qn,splitterProps:js}=(0,Ie.h)({...Tt,onResizing:Zt,onSizeChanged:jn});return qn.style.overflow="hidden",qn.style.minWidth="unset",qn.style.minHeight="unset",jt.snapSize?(Fn.style={...Fn.style,flexGrow:1-jt.snapSize},qn.style.flexGrow=jt.snapSize):jt.snapSize===0&&(Fn.style.flexGrow=1,qn.style.flexGrow=0,qn.style.minWidth="unset",qn.style.minHeight="unset",qn.style.overflow="unset"),{containerProps:Qn,primaryProps:Fn,secondaryProps:qn,splitterProps:js,splitterState:jt,onToggleCollapse:Xn}}function Re({model:Tt}){const Wt=(0,g.YQ)(Tt),{optionsPane:jt}=Tt.useState(),ut=(0,h.of)(Ce),{containerProps:Zt,primaryProps:jn,secondaryProps:Xn,splitterProps:Qn,splitterState:Fn,onToggleCollapse:qn}=Oe({direction:"row",dragPosition:"end",initialSize:.75,paneOptions:{collapseBelowPixels:250,snapOpenToPixels:400}});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(vt.c,{dashboard:Wt}),(0,a.jsxs)("div",{...Zt,className:(0,c.cx)(Zt.className,{[ut.content]:n.$.featureToggles.bodyScrolling}),"data-testid":o.Tp.components.PanelEditor.General.content,children:[(0,a.jsx)("div",{...jn,className:(0,c.cx)(jn.className,ut.body),children:(0,a.jsx)(he,{model:Tt})}),(0,a.jsx)("div",{...Qn}),(0,a.jsxs)("div",{...Xn,className:(0,c.cx)(Xn.className,ut.optionsPane),children:[Fn.collapsed&&(0,a.jsx)("div",{className:ut.expandOptionsWrapper,children:(0,a.jsx)(dt.I,{tooltip:"Open options pane",icon:"arrow-to-right",onClick:qn,variant:"canvas",className:ut.rotate180,"aria-label":"Open options pane"})}),!Fn.collapsed&&(0,a.jsx)(jt.Component,{model:jt})]})]})]})}function he({model:Tt}){const Wt=(0,g.YQ)(Tt),{vizManager:jt,dataPane:ut,showLibraryPanelSaveModal:Zt,showLibraryPanelUnlinkModal:jn}=Tt.useState(),{sourcePanel:Xn}=jt.useState(),Qn=(0,g.Yr)(Xn.resolve()),{controls:Fn,scopes:qn}=Wt.useState(),js=(0,h.of)(Ce),{containerProps:ys,primaryProps:Ps,secondaryProps:es,splitterProps:_s,splitterState:ca,onToggleCollapse:Ks}=Oe({direction:"column",dragPosition:"start",initialSize:.5,paneOptions:{collapseBelowPixels:150}});return ys.className=(0,c.cx)(ys.className,js.container),ut||(Ps.style.flexGrow=1),(0,a.jsxs)("div",{className:(0,c.cx)(js.pageContainer,Fn&&!qn&&js.pageContainerWithControls,qn&&js.pageContainerWithScopes),children:[qn&&(0,a.jsx)(qn.Component,{model:qn}),Fn&&(0,a.jsx)("div",{className:(0,c.cx)(js.controlsWrapper,qn&&js.controlsWrapperWithScopes),children:(0,a.jsx)(Fn.Component,{model:Fn})}),(0,a.jsxs)("div",{...ys,children:[(0,a.jsx)("div",{...Ps,children:(0,a.jsx)(jt.Component,{model:jt})}),Zt&&Qn&&(0,a.jsx)(Se,{libraryPanel:Qn,onDismiss:Tt.onDismissLibraryPanelSaveModal,onConfirm:Tt.onConfirmSaveLibraryPanel,onDiscard:Tt.onDiscard}),jn&&Qn&&(0,a.jsx)(yt.l,{onDismiss:Tt.onDismissUnlinkLibraryPanelModal,onConfirm:Tt.onConfirmUnlinkLibraryPanel,isOpen:!0}),ut&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{..._s}),(0,a.jsxs)("div",{...es,children:[ca.collapsed&&(0,a.jsx)("div",{className:js.expandDataPane,children:(0,a.jsx)(S.$n,{tooltip:"Open query pane",icon:"arrow-to-right",onClick:Ks,variant:"secondary",size:"sm",className:js.openDataPaneButton,"aria-label":"Open query pane"})}),!ca.collapsed&&(0,a.jsx)(ut.Component,{model:ut})]})]})]})]})}function Ce(Tt){return{pageContainer:(0,c.css)({display:"grid",gridTemplateAreas:`
        "panels"`,gridTemplateColumns:"1fr",gridTemplateRows:"1fr",height:"100%"}),pageContainerWithControls:(0,c.css)({gridTemplateAreas:`
        "controls"
        "panels"`,gridTemplateRows:"auto 1fr"}),pageContainerWithScopes:(0,c.css)({gridTemplateAreas:`
        "scopes controls"
        "panels panels"`,gridTemplateColumns:`${Tt.spacing(32)} 1fr`,gridTemplateRows:"auto 1fr"}),container:(0,c.css)({gridArea:"panels",height:"100%"}),canvasContent:(0,c.css)({label:"canvas-content",display:"flex",flexDirection:"column",flexBasis:"100%",flexGrow:1,minHeight:0,width:"100%"}),content:(0,c.css)({position:"absolute",width:"100%",height:"100%"}),body:(0,c.css)({label:"body",flexGrow:1,display:"flex",flexDirection:"column",minHeight:0}),optionsPane:(0,c.css)({flexDirection:"column",borderLeft:`1px solid ${Tt.colors.border.weak}`,background:Tt.colors.background.primary}),expandOptionsWrapper:(0,c.css)({display:"flex",flexDirection:"column",padding:Tt.spacing(2,1)}),expandDataPane:(0,c.css)({display:"flex",flexDirection:"row",padding:Tt.spacing(1),borderTop:`1px solid ${Tt.colors.border.weak}`,borderRight:`1px solid ${Tt.colors.border.weak}`,background:Tt.colors.background.primary,flexGrow:1,justifyContent:"space-around"}),rotate180:(0,c.css)({rotate:"180deg"}),controlsWrapper:(0,c.css)({display:"flex",flexDirection:"column",flexGrow:0,gridArea:"controls",padding:Tt.spacing(2,0,2,2)}),controlsWrapperWithScopes:(0,c.css)({padding:Tt.spacing(2,0)}),openDataPaneButton:(0,c.css)({width:Tt.spacing(8),justifyContent:"center",svg:{rotate:"-90deg"}})}}var We=e(67647),et=e(26443),rt=e(41394),nt=e(17706),gt=e(22290),xt=e(66211),St=e(15292),zt=e(94354),Nt=e(90182),Vt=e(64919),en=e(21744),Je=e(20214),ct=e(74410),ot=e(48192),Qe=e(74097),pt=e(92378),Pt=e(6923),At=e(20455),mn=e(32023);function Pn(Tt,Wt,jt){const ut=new ot.C({title:"Panel options",id:"Panel options",isOpenDefault:!0}),Zt=mn.b4.getPanelLinks(Wt),jn=Zt?.state.rawLinks??[],Xn=(0,g.YQ)(Wt);return ut.addItem(new Qe.v({title:"Title",value:Wt.state.title,popularRank:1,render:function(){return(0,a.jsx)(Rn,{vizManager:Tt})},addon:n.$.featureToggles.dashgpt&&(0,a.jsx)(ct.h,{onGenerate:Qn=>Tt.setPanelTitle(Qn),panel:(0,At.Z6)(Wt),dashboard:(0,At.Uy)(Xn)})})).addItem(new Qe.v({title:"Description",value:Wt.state.description,render:function(){return(0,a.jsx)(Kn,{panel:Wt})},addon:n.$.featureToggles.dashgpt&&(0,a.jsx)(Je.t,{onGenerate:Qn=>Wt.setState({description:Qn}),panel:(0,At.Z6)(Wt)})})).addItem(new Qe.v({title:"Transparent background",render:function(){return(0,a.jsx)(St.d,{value:Wt.state.displayMode==="transparent",id:"transparent-background",onChange:()=>{Wt.setState({displayMode:Wt.state.displayMode==="transparent"?"default":"transparent"})}})}})).addCategory(new ot.C({title:"Panel links",id:"Panel links",isOpenDefault:!1,itemsCount:jn?.length}).addItem(new Qe.v({title:"Panel links",render:()=>(0,a.jsx)(fn,{panelLinks:Zt??void 0})}))).addCategory(new ot.C({title:"Repeat options",id:"Repeat options",isOpenDefault:!1}).addItem(new Qe.v({title:"Repeat by variable",description:"Repeat this panel for each value in the selected variable. This is not visible while in edit mode. You need to go back to dashboard and then update the variable or reload the dashboard.",render:function(){return(0,a.jsx)(pt.U,{id:"repeat-by-variable-select",parent:Wt,repeat:jt,onChange:Fn=>{const qn={repeat:Fn};Fn&&!Tt.state.repeatDirection&&(qn.repeatDirection="h"),Tt.setState(qn)}})}})).addItem(new Qe.v({title:"Repeat direction",showIf:()=>!!Tt.state.repeat,render:function(){const Fn=[{label:"Horizontal",value:"h"},{label:"Vertical",value:"v"}];return(0,a.jsx)(zt.z,{options:Fn,value:Tt.state.repeatDirection??"h",onChange:qn=>Tt.setState({repeatDirection:qn})})}})).addItem(new Qe.v({title:"Max per row",showIf:()=>!!(Tt.state.repeat&&Tt.state.repeatDirection==="h"),render:function(){const Fn=[2,3,4,6,8,12].map(qn=>({label:qn.toString(),value:qn}));return(0,a.jsx)(Nt.l6,{options:Fn,value:Tt.state.maxPerRow,onChange:qn=>Tt.setState({maxPerRow:qn.value})})}})))}function fn({panelLinks:Tt}){const{rawLinks:Wt}=Tt?Tt.useState():{rawLinks:[]};return(0,a.jsx)(Vt.e,{links:Wt,onChange:jt=>Tt?.setState({rawLinks:jt}),getSuggestions:Pt.Fq,data:[]})}function Rn({vizManager:Tt}){const{title:Wt}=Tt.state.panel.useState();return(0,a.jsx)(pe.p,{"data-testid":o.Tp.components.PanelEditor.OptionsPane.fieldInput("Title"),value:Wt,onChange:jt=>Tt.setPanelTitle(jt.currentTarget.value)})}function Kn({panel:Tt}){const{description:Wt}=Tt.useState();return(0,a.jsx)(en.f,{id:"description-text-area",value:Wt,onChange:jt=>Tt.setState({description:jt.currentTarget.value})})}const Bt=Z.memo(({vizManager:Tt,searchQuery:Wt,listMode:jt,data:ut})=>{const{panel:Zt,sourcePanel:jn,repeat:Xn}=Tt.useState(),Qn=jn.resolve().parent,{options:Fn,fieldConfig:qn,_pluginInstanceState:js}=Zt.useState(),ys=(0,Z.useMemo)(()=>Pn(Tt,Zt,Xn),[Tt,Zt,Xn]),Ps=(0,Z.useMemo)(()=>{const Zs=Zt.getPlugin();if(Zs)return(0,xt.Z4)({panel:Zt,data:ut,plugin:Zs,eventBus:Zt.getPanelContext().eventBus,instanceState:js})},[ut,Zt,Fn,qn,js]),es=(0,Z.useMemo)(()=>{if(Qn instanceof r.F)return(0,xt.tN)(Qn)},[Qn]),_s=(0,Z.useMemo)(()=>(0,gt.v)(qn,Zt.getPlugin()?.fieldConfigRegistry,ut?.series??[],Wt,Zs=>{Zt.onFieldConfigChange(Zs,!0)}),[Wt,Zt,qn]),ca=Wt.length>0,Ks=[];if(ca)Ks.push((0,et.Po)([ys,...es?[es]:[],...Ps??[]],_s,Wt));else switch(jt){case et.gs.All:es&&Ks.push(es.render()),Ks.push(ys.render());for(const Zs of Ps??[])Ks.push(Zs.render());for(const Zs of _s)Ks.push(Zs.render());break;case et.gs.Overrides:for(const Zs of _s)Ks.push(Zs.render());default:break}return Ks});Bt.displayName="PanelOptions";var an=e(78685),tn=e(88575),Cn=e(15054),xn=e(32696),Vn=e(56707),Et=e(86292),Ft=e(53543);function Gt({vizManager:Tt,data:Wt,onChange:jt}){const{panel:ut}=Tt.useState(),Zt=(0,h.of)(ln),[jn,Xn]=(0,Z.useState)(""),Qn=!1,Fn=Qn?Cn.MM:Cn.wV,qn=Qn?xn.__.Widgets:xn.__.Visualizations,js=(0,Z.useMemo)(()=>new Ft.R(ut),[ut]),ys=(0,Z.useMemo)(()=>new Set([xn.__.Widgets,xn.__.Visualizations,xn.__.Suggestions]),[]),[Ps,es]=(0,an.A)(Fn,qn);(0,Z.useEffect)(()=>{Ps&&!ys.has(Ps)&&es(qn)},[qn,Ps,es,ys]);const _s=[{label:"Visualizations",value:xn.__.Visualizations},{label:"Suggestions",value:xn.__.Suggestions}],ca=Zs=>{Tt.changePluginType(Zs.pluginId),jt()},Ks=()=>{jt()};return(0,a.jsxs)("div",{className:Zt.wrapper,children:[(0,a.jsxs)("div",{className:Zt.searchRow,children:[(0,a.jsx)(We.Z,{className:Zt.filter,value:jn,onChange:Xn,autoFocus:!0,placeholder:"Search for..."}),(0,a.jsx)(S.$n,{title:"Close",variant:"secondary",icon:"angle-up",className:Zt.closeButton,"data-testid":o.Tp.components.PanelEditor.toggleVizPicker,onClick:Ks})]}),(0,a.jsx)(tn.D,{className:Zt.customFieldMargin,children:(0,a.jsx)(zt.z,{options:_s,value:Ps,onChange:es,fullWidth:!0})}),(0,a.jsxs)(d.E,{children:[Ps===xn.__.Visualizations&&(0,a.jsx)(Et.G,{pluginId:ut.state.pluginId,searchQuery:jn,onChange:ca}),Ps===xn.__.Suggestions&&(0,a.jsx)(Vn.a,{onChange:ca,searchQuery:jn,panel:js,data:Wt})]})]})}const ln=Tt=>({wrapper:(0,c.css)({display:"flex",flexDirection:"column",flexGrow:1,padding:Tt.spacing(2,1),height:"100%",gap:Tt.spacing(2),border:`1px solid ${Tt.colors.border.weak}`,borderRight:"none",borderBottom:"none",borderTopLeftRadius:Tt.shape.radius.default}),searchRow:(0,c.css)({display:"flex",marginBottom:Tt.spacing(1)}),closeButton:(0,c.css)({marginLeft:Tt.spacing(1)}),customFieldMargin:(0,c.css)({marginBottom:Tt.spacing(1)}),filter:(0,c.css)({minHeight:Tt.spacing(4)})});class qt extends i.Bs{constructor(Wt){super({searchQuery:"",listMode:et.gs.All,...Wt}),this.onToggleVizPicker=()=>{this.setState({isVizPickerOpen:!this.state.isVizPickerOpen})},this.onSetSearchQuery=jt=>{this.setState({searchQuery:jt})},this.onSetListMode=jt=>{this.setState({listMode:jt})}}static{this.Component=({model:Wt})=>{const{isVizPickerOpen:jt,searchQuery:ut,listMode:Zt}=Wt.useState(),jn=i.jh.getAncestor(Wt,Wn).state.vizManager,{pluginId:Xn}=jn.useState(),{data:Qn}=i.jh.getData(jn.state.panel).useState(),Fn=(0,h.of)(cn);return(0,a.jsxs)(a.Fragment,{children:[!jt&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:Fn.top,children:[(0,a.jsx)(En,{pluginId:Xn,onOpen:Wt.onToggleVizPicker}),(0,a.jsx)(We.Z,{className:Fn.searchOptions,value:ut,placeholder:"Search options",onChange:Wt.onSetSearchQuery})]}),(0,a.jsx)("div",{className:Fn.listOfOptions,children:(0,a.jsx)(Bt,{vizManager:jn,searchQuery:ut,listMode:Zt,data:Qn})})]}),jt&&(0,a.jsx)(Gt,{vizManager:jn,onChange:Wt.onToggleVizPicker,data:Qn})]})}}}function cn(Tt){return{top:(0,c.css)({display:"flex",flexDirection:"column",padding:Tt.spacing(2,1),gap:Tt.spacing(2)}),listOfOptions:(0,c.css)({display:"flex",flexDirection:"column",flexGrow:"1",overflow:"auto"}),searchOptions:(0,c.css)({minHeight:Tt.spacing(4)}),searchWrapper:(0,c.css)({padding:Tt.spacing(2,2,2,0)}),vizField:(0,c.css)({marginBottom:Tt.spacing(1)}),rotateIcon:(0,c.css)({rotate:"180deg"})}}function En({pluginId:Tt,onOpen:Wt}){const jt=(0,h.of)(Sn);let ut=(0,Z.useMemo)(()=>(0,nt.A4)().filter(Zt=>Zt.id===Tt)[0],[Tt]);return ut||(ut=(0,rt.$)(`Panel plugin not found (${Tt})`,!0).meta),(0,a.jsx)(X.B,{gap:1,children:(0,a.jsx)(dt.I,{className:jt.vizButton,tooltip:"Click to change visualization",imgSrc:ut.info.logos.small,onClick:Wt,"data-testid":o.Tp.components.PanelEditor.toggleVizPicker,"aria-label":"Change Visualization",variant:"canvas",isOpen:!1,fullWidth:!0,children:ut.name})})}function Sn(Tt){return{vizButton:(0,c.css)({textAlign:"left"})}}var Tn=e(89681);class Wn extends i.Bs{constructor(Wt){super(Wt),this._initialRepeatOptions={},this._discardChanges=!1,this.onDiscard=()=>{this._discardChanges=!0,t.Ny.partial({editPanel:null})},this.onSaveLibraryPanel=()=>{this.setState({showLibraryPanelSaveModal:!0})},this.onConfirmSaveLibraryPanel=()=>{this.state.vizManager.commitChanges(),t.Ny.partial({editPanel:null})},this.onDismissLibraryPanelSaveModal=()=>{this.setState({showLibraryPanelSaveModal:!1})},this.onUnlinkLibraryPanel=()=>{this.setState({showLibraryPanelUnlinkModal:!0})},this.onDismissUnlinkLibraryPanelModal=()=>{this.setState({showLibraryPanelUnlinkModal:!1})},this.onConfirmUnlinkLibraryPanel=()=>{this.state.vizManager.unlinkLibraryPanel(),this.setState({showLibraryPanelUnlinkModal:!1})};const{repeat:jt,repeatDirection:ut,maxPerRow:Zt}=Wt.vizManager.state;this._initialRepeatOptions={repeat:jt,repeatDirection:ut,maxPerRow:Zt},this.addActivationHandler(this._activationHandler.bind(this))}static{this.Component=Re}_activationHandler(){const Wt=this.state.vizManager,jt=Wt.state.panel;return this._subs.add(Wt.subscribeToState((ut,Zt)=>{ut.pluginId!==Zt.pluginId&&this._initDataPane(ut.pluginId)})),this._initDataPane(jt.state.pluginId),()=>{this._discardChanges?this.state.isNewPanel&&(0,g.YQ)(this).removePanel(Wt.state.sourcePanel.resolve()):this.commitChanges()}}_initDataPane(Wt){const jt=n.$.panels[Wt]?.skipDataQuery;jt&&this.state.dataPane&&(t.Ny.partial({tab:null},!0),this.setState({dataPane:void 0})),!jt&&!this.state.dataPane&&this.setState({dataPane:new Ue(this.state.vizManager)})}getUrlKey(){return this.state.panelId.toString()}getPageNav(Wt,jt){return{text:"Edit panel",parentItem:(0,g.YQ)(this).getPageNav(Wt,jt)}}commitChanges(){const Wt=(0,g.YQ)(this);Wt.state.isEditing||Wt.onEnterEditMode();const Zt=this.state.vizManager.state.sourcePanel.resolve().parent,jn=Zt instanceof r.F,Xn=jn?Zt.parent:Zt;if(!jn){if(!(Xn instanceof s.U)){console.error("Unsupported scene object type");return}this.commitChangesToSource(Xn)}}commitChangesToSource(Wt){let jt=Wt.state.width??1,ut=Wt.state.height;const Zt=this.state.vizManager,jn=this._initialRepeatOptions.repeatDirection==="h"&&Zt.state.repeatDirection==="v",Xn=this._initialRepeatOptions.repeatDirection==="v"&&Zt.state.repeatDirection==="h";jn?jt=Math.floor(jt/(Wt.state.maxPerRow??1)):Xn&&(jt=24),Wt.setState({body:Zt.state.panel.clone(),repeatDirection:Zt.state.repeatDirection,variableName:Zt.state.repeat,maxPerRow:Zt.state.maxPerRow,width:jt,height:ut})}}function Nn(Tt,Wt=!1){return new Wn({panelId:(0,g.Cs)(Tt),optionsPane:new qt({}),vizManager:Tn.j.createFor(Tt),isNewPanel:Wt})}},89681:(k,R,e)=>{"use strict";e.d(R,{j:()=>O});var t=e(74848),n=e(32196),i=e(2543),s=e.n(i),r=e(96540),g=e(22391),a=e(581),c=e(19347),o=e(32264),h=e(39601),f=e(80943),d=e(40845),p=e(36974),m=e(47311),v=e(57767),l=e(93117),y=e(13530),u=e(45429),D=e(41507),E=e(60656),x=e(7928),P=e(20455),b=e(74730),M=(T=>(T[T.Fill=0]="Fill",T[T.Fit=1]="Fit",T[T.Exact=2]="Exact",T))(M||{});class O extends f.Bs{constructor(C){super(C),this._cachedPluginOptions={},this._detectPanelModelChanges=(0,i.debounce)(()=>{const{hasChanges:S}=(0,u.yO)((0,P.Z6)(this.state.sourcePanel.resolve()),(0,P.Z6)(this.state.panel));this.setState({isDirty:S})},250),this._handleStateChange=S=>{y.l.isUpdatingPersistedState(S)&&this._detectPanelModelChanges()},this.addActivationHandler(()=>this._onActivate())}static createFor(C){let S={};const A=C.parent instanceof E.F?C.parent.parent:C.parent;if(!(A instanceof D.U))throw console.error("VizPanel is not a child of a dashboard grid item"),new Error("VizPanel is not a child of a dashboard grid item");const{variableName:L,repeatDirection:N,maxPerRow:F}=A.state;S={repeat:L,repeatDirection:N,maxPerRow:F};let w;if(A.parent?.state.$variables&&(w=A.parent.state.$variables.clone()),S.repeat){const B=f.jh.lookupVariable(S.repeat,A);if(B instanceof f.n8&&B.state.value.length){const{values:U,texts:K}=(0,b.a7)(B),V=new f.xc({name:B.state.name,value:U[0],text:String(K[0])});w?w.setState({variables:[V]}):w=new f.Pj({variables:[V]})}}return new O({$variables:w,panel:C.clone(),sourcePanel:C.getRef(),pluginId:C.state.pluginId,...S})}_onActivate(){this.loadDataSource();const C=this.subscribeToEvent(f.bZ,this._handleStateChange);return()=>{C.unsubscribe()}}async loadDataSource(){if(!this.state.panel.state.$data)return;let S=this.queryRunner.state.datasource;try{let A,L;if(S)A=await(0,c.l)().get(S),L=(0,c.l)().getInstanceSettings(S);else{const F=(0,b.YQ)(this).state.uid??"",w=(0,p.CW)(F);w?.datasourceUid!==null&&(L=(0,c.l)().getInstanceSettings({uid:w?.datasourceUid}),L&&(A=await(0,c.l)().get({uid:w?.datasourceUid,type:L.type}),this.queryRunner.setState({datasource:{...(0,g.p$)(L),uid:w?.datasourceUid}})))}A&&L&&(this.setState({datasource:A,dsSettings:L}),(0,m.tw)((0,g.p$)(L)||{default:!0}))}catch(A){const L=await(0,c.l)().get(o.$.defaultDatasource),N=(0,c.l)().getInstanceSettings(o.$.defaultDatasource);L&&N&&(this.setState({datasource:L,dsSettings:N}),this.queryRunner.setState({datasource:(0,g.p$)(N)})),console.error(A)}}changePluginType(C){const{options:S,fieldConfig:A,pluginId:L}=this.state.panel.state;let N={defaults:{...A.defaults,custom:{}},overrides:(0,a.aW)(A.overrides,a.nx)};this._cachedPluginOptions[L]={options:S,fieldConfig:A};const F=this._cachedPluginOptions[C]?.options,w=this._cachedPluginOptions[C]?.fieldConfig;if(w&&(N=(0,a.H9)(N,w)),!this.state.panel.state.$data&&!o.$.panels[C].skipDataQuery){let B=(0,p.CW)((0,b.YQ)(this).state.uid)?.datasourceUid;B||(B=o.$.defaultDatasource),this.state.panel.setState({$data:new f.Es({$data:new f.dt({datasource:{uid:B},queries:[{refId:"A"}]}),transformations:[]})})}this.setState({pluginId:C}),this.state.panel.changePluginType(C,F,N),this.loadDataSource()}async changePanelDataSource(C,S){const{dsSettings:A}=this.state,L=this.queryRunner,N=A?await(0,c.l)().get({uid:A.uid}):void 0,F=await(0,c.l)().get({uid:C.uid}),w=L.state.queries,B=S||await(0,l.y)(F,C.uid,w,N);L.setState({datasource:(0,g.p$)(C),queries:B}),S&&L.runQueries(),this.loadDataSource()}changeQueryOptions(C){const S=this.state.panel,A=this.queryRunner,L=S.state.$timeRange,N={},F={};C.maxDataPoints!==A.state.maxDataPoints&&(N.maxDataPoints=C.maxDataPoints??void 0),C.minInterval!==A.state.minInterval&&C.minInterval!==null&&(N.minInterval=C.minInterval),C.timeRange&&(F.timeFrom=C.timeRange.from??void 0,F.timeShift=C.timeRange.shift??void 0,F.hideTimeOverride=C.timeRange.hide),L instanceof x.v?F.timeFrom!==void 0||F.timeShift!==void 0?L.setState(F):S.setState({$timeRange:void 0}):S.setState({$timeRange:new x.v(F)}),C.cacheTimeout!==A?.state.cacheTimeout&&(N.cacheTimeout=C.cacheTimeout),C.queryCachingTTL!==A?.state.queryCachingTTL&&(N.queryCachingTTL=C.queryCachingTTL),A.setState(N),A.runQueries()}changeQueries(C){this.queryRunner.setState({queries:C})}changeTransformations(C){const S=this.dataTransformer;S.setState({transformations:C}),S.reprocessTransformations()}inspectPanel(){const C=this.state.panel,S=(0,b.Cs)(C);h.Ny.partial({inspect:S,inspectTab:"query"})}get queryRunner(){const C=(0,b.un)(this.state.panel);if(!C)throw new Error("Query runner not found");return C}get dataTransformer(){const C=this.state.panel.state.$data;if(!C||!(C instanceof f.Es))throw new Error("Could not find SceneDataTransformer for panel");return C}toggleTableView(){if(this.state.tableView){this.setState({tableView:void 0});return}this.setState({tableView:f.d0.table().setTitle("").setOption("showTypeIcons",!0).setOption("showHeader",!0).setData(this.dataTransformer).build()})}unlinkLibraryPanel(){const C=this.state.sourcePanel.resolve();if(!(C.parent instanceof E.F))throw new Error("VizPanel is not a child of a library panel");const S=C.parent.parent;if(!(S instanceof D.U))throw new Error("Library panel not a child of a grid item");const A=this.state.panel.clone({$data:this.state.$data?.clone()});S.setState({body:A}),this.setState({sourcePanel:A.getRef()})}commitChanges(){const C=this.state.sourcePanel.resolve();this.commitChangesTo(C)}commitChangesTo(C){const S={variableName:this.state.repeat,repeatDirection:this.state.repeatDirection,maxPerRow:this.state.maxPerRow};if(C.parent instanceof D.U&&C.parent.setState({...S,body:this.state.panel.clone()}),C.parent instanceof E.F&&C.parent.parent instanceof D.U){const A=C.parent.clone({panel:this.state.panel.clone()});C.parent.parent.setState({body:A,...S}),(0,v.GX)(A).then(L=>{C.parent instanceof E.F&&A.setPanelFromLibPanel(L)})}}getPanelSaveModel(){const C=this.state.sourcePanel.resolve(),A=C.parent instanceof E.F?C.parent.parent:C.parent;if(!(A instanceof D.U))return{error:"Unsupported panel parent"};const L=A.clone({body:this.state.panel.clone()});return(0,P.ZB)(L)}setPanelTitle(C){this.state.panel.setState({title:C,hoverHeader:C===""})}static{this.Component=({model:C})=>{const{panel:S,tableView:A}=C.useState(),L=(0,d.of)(I),N=A??S,F=N.state.$data;return(0,r.useEffect)(()=>F?.activate(),[F]),(0,t.jsx)(t.Fragment,{children:(0,t.jsx)("div",{className:L.wrapper,children:(0,t.jsx)(N.Component,{model:N})})})}}}function I(T){return{wrapper:(0,n.css)({height:"100%",width:"100%",paddingLeft:T.spacing(2)})}}},13530:(k,R,e)=>{"use strict";e.d(R,{l:()=>m});var t=e(80943),n=e(67278);const i=()=>new n.c(new URL(e.p+e.u(9666),e.b));var s=e(89681),r=e(38477),g=e(33278),a=e(41507),c=e(34842),o=e(60656),h=e(42397),f=e(7928),d=e(20455),p=e(17663);class m{constructor(l){this._dashboard=l}static isUpdatingPersistedState({payload:l}){return Object.keys(l.partialUpdate).length===0?!1:!!(l.changedObject instanceof t.Eb||l.changedObject instanceof a.U||l.changedObject instanceof f.v||l.changedObject instanceof s.j&&(Object.prototype.hasOwnProperty.call(l.partialUpdate,"repeat")||Object.prototype.hasOwnProperty.call(l.partialUpdate,"repeatDirection")||Object.prototype.hasOwnProperty.call(l.partialUpdate,"maxPerRow"))||l.changedObject instanceof t.dt&&!Object.prototype.hasOwnProperty.call(l.partialUpdate,"data")||l.changedObject instanceof t.Es&&!Object.prototype.hasOwnProperty.call(l.partialUpdate,"data")||l.changedObject instanceof h.$||l.changedObject instanceof o.F&&Object.prototype.hasOwnProperty.call(l.partialUpdate,"name")||l.changedObject instanceof t.WM&&(Object.prototype.hasOwnProperty.call(l.partialUpdate,"intervals")||Object.prototype.hasOwnProperty.call(l.partialUpdate,"refresh"))||l.changedObject instanceof t.Gg.K2||l.changedObject instanceof t.kh||l.changedObject instanceof a.U||l.changedObject instanceof t.hy||l.changedObject instanceof c.H$&&Object.keys(l.partialUpdate).some(y=>c.vk.includes(y))||l.changedObject instanceof t.JZ||l.changedObject instanceof g.x&&Object.prototype.hasOwnProperty.call(l.partialUpdate,"hideTimeControls")||l.changedObject instanceof t.Pj||l.changedObject instanceof r.g&&!Object.prototype.hasOwnProperty.call(l.partialUpdate,"data")||l.changedObject instanceof t.Gg.en||(0,p.c7)(l.changedObject))}onStateChanged(l){m.isUpdatingPersistedState(l)&&this.detectSaveModelChanges()}detectSaveModelChanges(){const l=(0,d.Uy)(this._dashboard),y=this._dashboard.getInitialSaveModel(),u=typeof l=="object"?JSON.parse(JSON.stringify(l)):l,D=typeof y=="object"?JSON.parse(JSON.stringify(y)):y;this._changesWorker?.postMessage({initial:D,changed:u})}hasMetadataChanges(){return this._dashboard.state.meta.folderUid!==this._dashboard.getInitialState()?.meta.folderUid}updateIsDirty(l){const{hasChanges:y}=l;y||this.hasMetadataChanges()?this._dashboard.state.isDirty||this._dashboard.setState({isDirty:!0}):this._dashboard.state.isDirty&&this._dashboard.setState({isDirty:!1})}init(){this._changesWorker=i()}startTrackingChanges(){this._changesWorker||this.init(),this._changesWorker.onmessage=l=>{this.updateIsDirty(l.data)},this._changeTrackerSub=this._dashboard.subscribeToEvent(t.bZ,this.onStateChanged.bind(this))}stopTrackingChanges(){this._changeTrackerSub?.unsubscribe()}terminate(){this.stopTrackingChanges(),this._changesWorker?.terminate(),this._changesWorker=void 0}}},45429:(k,R,e)=>{"use strict";e.d(R,{Yy:()=>r,yO:()=>o});var t=e(56596);function n(h,f){try{let d=h;for(const p of f)d=d[p];return d}catch{return}}function i(h,f){return typeof h==typeof f&&(typeof h=="string"&&h===f||Array.isArray(h)&&h.length===f.length&&h.every((d,p)=>d===f[p]))}function s(h,f){return h===f||h&&f&&h.selected===f.selected&&i(h.text,f.text)&&i(h.value,f.value)}function r(h,f,d,p,m){const v=h,l=f,y=g(l,v),u=c(l,v,p),D=l.refresh!==v.refresh;d||(l.time=v.time),m||(l.refresh=v.refresh);const E=(0,t.G4)(v,l),x=Object.values(E).reduce((P,b)=>P+b.length,0);return{changedSaveModel:l,initialSaveModel:v,diffs:E,diffCount:x,hasChanges:x>0,hasTimeChanges:y,isNew:l.version===0,hasVariableValueChanges:u,hasRefreshChange:D}}function g(h,f){return h.time?.from!==f.time?.from||h.time?.to!==f.time?.to}function a(h,f){if(h.filters===void 0&&f.filters===void 0)return console.warn("Adhoc variable filter property is undefined"),!0;if(h.filters===void 0&&f.filters!==void 0||f.filters===void 0&&h.filters!==void 0)return console.warn("Adhoc variable filter property is undefined"),!1;if(h.filters.length!==f.filters.length)return!1;for(let d=0;d<h.filters.length;d++){const p=h.filters[d],m=f.filters[d];if(p.key!==m.key||p.operator!==m.operator||p.value!==m.value)return!1}return!0}function c(h,f,d){const p=f.templating?.list??[],m=h.templating?.list??[];let v=!1;for(const l of m){const y=p.find(({name:u,type:D})=>u===l.name&&D===l.type);if(y&&(y.current&&delete y.current.selected,s(l.current,y.current)?l.type==="adhoc"&&!a(l,y)&&(v=!0):v=!0,!d)){const u=l;u.type==="adhoc"?u.filters=y.filters:(l.current=y.current,l.options=y.options)}}return v}function o(h,f){const d=(0,t.G4)(f,h),p=Object.values(d).reduce((m,v)=>m+v.length,0);return{changedSaveModel:h,initialSaveModel:f,diffs:d,diffCount:p,hasChanges:p>0}}},57109:(k,R,e)=>{"use strict";e.d(R,{o:()=>h});var t=e(74848),n=e(80943),i=e(87978),s=e(8484),r=e(16678),g=e(32023),a=e(74730),c=e(41507),o=e(60656);class h extends n.Bs{constructor(){super(...arguments),this.onClose=()=>{(0,a.YQ)(this).closeModal()},this.onAddLibraryPanel=d=>{const p=(0,a.YQ)(this),m=p.state.body;if(!(m instanceof n.hy))throw new Error("Trying to add a library panel in a layout that is not SceneGridLayout");const v=g.b4.getNextPanelId(p),l=new o.F({title:"Panel Title",uid:d.uid,name:d.name,panelKey:(0,a.XA)(v)}),y=this.state.panelToReplaceRef?.resolve();if(y){const u=y.parent;if(!(u instanceof c.U))throw new Error("Trying to replace a panel that does not have a DashboardGridItem");u.setState({body:l})}else{const u=new c.U({height:a.sw,width:a.vm,x:0,y:0,body:l,key:`grid-item-${v}`});m.setState({children:[u,...m.state.children]})}this.onClose()}}static{this.Component=({model:d})=>{const p=(0,s.t)("library-panel.add-widget.title","Add panel from panel library");return(0,t.jsx)(i._,{title:p,onClose:d.onClose,children:(0,t.jsx)(r.j,{onClick:d.onAddLibraryPanel,variant:r.s.Tight,showPanelFilter:!0})})}}}},91309:(k,R,e)=>{"use strict";e.d(R,{C:()=>P,S:()=>b});var t=e(65474),n=e(81160),i=e(52622),s=e(43585),r=e(14236),g=e(39070),a=e(32264),c=e(80943),o=e(82467),h=e(3169),f=e(10096),d=e(94954),p=e(79938),m=e(49498),v=e(55740),l=e(57220),y=e(23662),u=e(99140),D=e(31678),E=e(94822),x=e(74730);class P extends c.VE{constructor(O){super({isEnabled:!0,...O,isHidden:!0}),this.hasAlertRules=!0,this.topic=i.QR.AlertStates,this.handleError=I=>{const T=(0,h.gi)("AlertStatesDataLayer",(0,d.q)(I));(0,u.JD)((0,o.dx)(T))}}onEnable(){const O=c.jh.getTimeRange(this);this._timeRangeSub=O.subscribeToState(()=>{this.runWithTimeRange(O)})}onDisable(){this._timeRangeSub?.unsubscribe()}runLayer(){const O=c.jh.getTimeRange(this);this.runWithTimeRange(O)}async runWithTimeRange(O){const I=(0,x.YQ)(this),{uid:T,id:C}=I.state;if(this.querySub&&this.querySub.unsubscribe(),!this.canWork(O))return;const S=async()=>{const N=await(0,u.JD)(p.hK.endpoints.prometheusRuleNamespaces.initiate({ruleSourceName:l.hY,dashboardUid:T}));if(N.error)throw new Error("Unexpected alert rules response.");return N.data},L=(0,t.H)(S()).pipe((0,n.T)(N=>(0,m.Kw)(N))).pipe((0,n.T)(N=>{this.hasAlertRules=!1;const F={};return N.forEach(w=>w.rules.forEach(B=>{if((0,y.Z8)(B)&&B.annotations&&B.annotations[v.YH.panelID]){this.hasAlertRules=!0;const U=Number(B.annotations[v.YH.panelID]),K=b(B.state);F[U]?K===s.O.Alerting&&F[U].state!==s.O.Alerting?F[U].state=s.O.Alerting:K===s.O.Pending&&F[U].state!==s.O.Alerting&&F[U].state!==s.O.Pending&&(F[U].state=s.O.Pending):F[U]={state:K,id:Object.keys(F).length,panelId:U,dashboardId:C}}})),Object.values(F)}));this.querySub=L.subscribe({next:N=>{const F=(0,r.Vc)(N);this.publishResults({state:g.Gu.Done,series:[{...F,meta:{...F.meta,dataTopic:i.QR.AlertStates}}],timeRange:O.state.value})},error:N=>{this.handleError(N),this.publishResults({state:g.Gu.Error,series:[],errors:[{message:(0,d.q)(N)}],timeRange:O.state.value})}})}canWork(O){const I=(0,x.YQ)(this),{uid:T}=I.state;return!(!T||a.$.publicDashboardAccessToken||O.state.value.raw.to!=="now"||this.hasAlertRules===!1||!(f.TP.hasPermission(D.AccessControlAction.AlertingRuleRead)&&f.TP.hasPermission(D.AccessControlAction.AlertingRuleExternalRead)))}}function b(M){return M===E.cF.Firing?s.O.Alerting:M===E.cF.Pending?s.O.Pending:s.O.OK}},38477:(k,R,e)=>{"use strict";e.d(R,{g:()=>a});var t=e(43127),n=e(33948),i=e(52622),s=e(32264),r=e(80943),g=e(90569);class a extends r.tV.g{async resolveDataSource(o){return s.$.publicDashboardAccessToken?new g.X:super.resolveDataSource(o)}processEvents(o,h){if(s.$.publicDashboardAccessToken){const f={series:[],timeRange:(0,t.E2)(),state:h.state},d=(0,n.I)(h.events);return d.meta={...d.meta,dataTopic:i.QR.Annotations},f.annotations=[d],f}else return super.processEvents(o,h)}}},33278:(k,R,e)=>{"use strict";e.d(R,{x:()=>D});var t=e(74848),n=e(32196),i=e(12470),s=e(13544),r=e(80943),g=e(40845),a=e(67061),c=e(90613),o=e(32264),h=e(15292);function f({panelEditor:P}){const b=P.state.vizManager,{panel:M,tableView:O}=b.useState(),I=o.$.panels[M.state.pluginId]?.skipDataQuery;return(0,t.jsx)(t.Fragment,{children:!I&&(0,t.jsx)(h.K,{label:"Table view",showLabel:!0,id:"table-view",value:!!O,onClick:()=>b.toggleTableView(),"aria-label":"toggle-table-view","data-testid":s.Tp.components.PanelEditor.toggleTableView})})}var d=e(74730),p=e(80997),m=e(56034),v=e(52424),l=e(6923),y=e(4588);function u({links:P,uid:b}){return!P||!b?null:(0,t.jsx)(t.Fragment,{children:P.map((M,O)=>{const I=(0,l.mQ)().getAnchorInfo(M),T=`${M.title}-$${O}`;if(M.type==="dashboards")return(0,t.jsx)(v.aK,{link:M,linkInfo:I,dashboardUID:b},T);const C=y.G[M.icon],S=(0,t.jsx)(v.Zx,{icon:C,href:(0,p.Jf)(I.href),target:M.targetBlank?"_blank":void 0,rel:"noreferrer","data-testid":s.Tp.components.DashboardLinks.link,children:I.title});return(0,t.jsx)("div",{"data-testid":s.Tp.components.DashboardLinks.container,children:M.tooltip?(0,t.jsx)(m.m,{content:I.tooltip,children:S}):S},T)})})}class D extends r.Bs{constructor(b){super({variableControls:[],timePicker:b.timePicker??new r.KE({}),refreshPicker:b.refreshPicker??new r.WM({}),...b}),this._variableDependency=new r.Sh(this,{onAnyVariableChanged:this._onAnyVariableChanged.bind(this)}),this._urlSync=new r.So(this,{keys:["_dash.hideTimePicker","_dash.hideVariables","_dash.hideLinks"]}),this.addActivationHandler(()=>{let M;return this.state.hideTimeControls&&(M=this.state.refreshPicker.activate()),()=>{M&&M()}})}static{this.Component=E}getUrlState(){return{"_dash.hideTimePicker":this.state.hideTimeControls?"true":void 0,"_dash.hideVariables":this.state.hideVariableControls?"true":void 0,"_dash.hideLinks":this.state.hideLinksControls?"true":void 0}}updateFromUrl(b){const M={};M.hideTimeControls=b["_dash.hideTimePicker"]==="true"||b["_dash.hideTimePicker"]===""||this.state.hideTimeControls,M.hideVariableControls=b["_dash.hideVariables"]==="true"||b["_dash.hideVariables"]===""||this.state.hideVariableControls,M.hideLinksControls=b["_dash.hideLinks"]==="true"||b["_dash.hideLinks"]===""||this.state.hideLinksControls,Object.entries(M).some(([O,I])=>I!==this.state[O])&&this.setState(M)}_onAnyVariableChanged(){(0,d.YQ)(this).state.links?.length>0&&this.forceRender()}hasControls(){const b=r.jh.getVariables(this)?.state.variables.some(S=>S.state.hide!==i.zL.hideVariable),M=r.jh.getDataLayers(this).some(S=>S.state.isEnabled&&!S.state.isHidden),O=(0,d.YQ)(this).state.links?.length>0,I=this.state.hideLinksControls||!O,T=this.state.hideVariableControls||!M&&!b,C=this.state.hideTimeControls;return!(T&&I&&C)}}function E({model:P}){const{variableControls:b,refreshPicker:M,timePicker:O,hideTimeControls:I,hideVariableControls:T,hideLinksControls:C}=P.useState(),S=(0,d.YQ)(P),{links:A,meta:L,editPanel:N}=S.useState(),F=(0,g.of)(x),w=location.search.includes("scene-debugger");return P.hasControls()?(0,t.jsxs)("div",{"data-testid":s.Tp.pages.Dashboard.Controls,className:(0,n.cx)(F.controls,L.isEmbedded&&F.embedded),children:[(0,t.jsxs)(a.B,{grow:1,wrap:"wrap",children:[!T&&b.map(B=>(0,t.jsx)(B.Component,{model:B},B.state.key)),(0,t.jsx)(c.a,{grow:1}),!C&&!N&&(0,t.jsx)(u,{links:A,uid:S.state.uid}),N&&(0,t.jsx)(f,{panelEditor:N})]}),!I&&(0,t.jsxs)(a.B,{justifyContent:"flex-end",children:[(0,t.jsx)(O.Component,{model:O}),(0,t.jsx)(M.Component,{model:M})]}),w&&(0,t.jsx)(r.or,{scene:P},"scene-debugger")]}):null}function x(P){return{controls:(0,n.css)({display:"flex",alignItems:"flex-start",flex:"100%",gap:P.spacing(1),flexDirection:"row",flexWrap:"nowrap",position:"relative",background:P.colors.background.canvas,zIndex:P.zIndex.activePanel,width:"100%",marginLeft:"auto",[P.breakpoints.down("sm")]:{flexDirection:"column-reverse",alignItems:"stretch"},[P.breakpoints.up("sm")]:{position:"sticky",top:0}}),embedded:(0,n.css)({background:"unset",position:"unset"})}}},16279:(k,R,e)=>{"use strict";e.d(R,{s:()=>i});var t=e(74848),n=e(80943);class i extends n.ps{constructor(r){super({...r,name:r.name??"Data layers",annotationLayers:r.annotationLayers??[]}),this.addActivationHandler(()=>this._onActivate())}_onActivate(){return this._subs.add(this.subscribeToState((r,g)=>{r.annotationLayers!==g.annotationLayers&&(this.querySub?.unsubscribe(),this.subscribeToAllLayers(this.getAllLayers()))})),this.subscribeToAllLayers(this.getAllLayers()),()=>{this.querySub?.unsubscribe()}}addAnnotationLayer(r){this.setState({annotationLayers:[...this.state.annotationLayers,r]})}getAllLayers(){const r=[...this.state.annotationLayers];return this.state.alertStatesLayer&&r.push(this.state.alertStatesLayer),r}static{this.Component=({model:r})=>{const{annotationLayers:g}=r.useState();return(0,t.jsx)(t.Fragment,{children:g.map(a=>(0,t.jsx)(a.Component,{model:a},a.state.key))})}}}},39820:(k,R,e)=>{"use strict";e.d(R,{L:()=>r});var t=e(80943),n=e(14348),i=e(74730),s=e(60656);class r extends t.Bs{constructor(a){super(a),this.addActivationHandler(()=>this._activationHandler())}_activationHandler(){const a=this.parent;let c,o;if(!(a instanceof t.dt))throw new Error("DashboardDatasourceBehaviour must be attached to a SceneQueryRunner");if(a.state.datasource?.uid!==n.K)return;try{c=(0,i.YQ)(a)}catch{return}const h=a.state.queries.find(l=>l.panelId!==void 0);if(!h)return;const f=h.panelId,d=(0,i.XA)(f),p=(0,i.vL)(c,d);if(!(p instanceof t.Eb))return;const m=(0,i.un)(p);let v;if(m)this.prevRequestId&&this.prevRequestId!==m.state.data?.request?.requestId&&a.runQueries();else if(p.parent instanceof s.F)p.parent.isActive||(v=p.parent.activate()),o=p.parent.subscribeToState((l,y)=>{this.handleLibPanelStateUpdates(l,y,a)});else throw new Error("Could not find SceneQueryRunner for panel");return()=>{this.prevRequestId=m?.state.data?.request?.requestId,o&&o.unsubscribe(),v&&v()}}handleLibPanelStateUpdates(a,c,o){if(a.panel&&a.panel!==c.panel){if(!((0,i.un)(a.panel)instanceof t.dt))throw new Error("Could not find SceneQueryRunner for panel");o.runQueries()}}}},41507:(k,R,e)=>{"use strict";e.d(R,{U:()=>m});var t=e(74848),n=e(32196),i=e(2543),s=e.n(i),r=e(96540),g=e(32264),a=e(80943),c=e(15054),o=e(74730),h=e(57109),f=e(60656),d=e(7196),p=e(30195);class m extends a.Bs{constructor(u){super(u),this._variableDependency=new a.Sh(this,{variableNames:this.state.variableName?[this.state.variableName]:[],onVariableUpdateCompleted:this._onVariableUpdateCompleted.bind(this)}),this.addActivationHandler(()=>this._activationHandler())}_activationHandler(){return this.state.variableName&&(this._subs.add(this.subscribeToState((u,D)=>this._handleGridResize(u,D))),this._performRepeat()),this._subs.add(this.subscribeToState((u,D)=>{u.body!==D.body&&u.body instanceof f.F&&this.setupLibraryPanelChangeSubscription(u.body)})),this.state.body instanceof f.F&&this.setupLibraryPanelChangeSubscription(this.state.body),()=>{this._libPanelSubscription?.unsubscribe(),this._libPanelSubscription=void 0}}setupLibraryPanelChangeSubscription(u){this._libPanelSubscription&&(this._libPanelSubscription.unsubscribe(),this._libPanelSubscription=void 0),this._libPanelSubscription=u.subscribeToState(D=>{D._loadedPanel?.model.repeat&&(this._variableDependency.setVariableNames([D._loadedPanel.model.repeat]),this.setState({variableName:D._loadedPanel.model.repeat,repeatDirection:D._loadedPanel.model.repeatDirection,maxPerRow:D._loadedPanel.model.maxPerRow}),this._performRepeat())})}_onVariableUpdateCompleted(){this.state.variableName&&this._performRepeat()}_handleGridResize(u,D){const E=this.state.repeatedPanels?.length??1,x={};if(u.height!==D.height){if(this.getRepeatDirection()==="v"){const P=Math.ceil(u.height/E);x.itemHeight=P}else{const P=Math.ceil(E/this.getMaxPerRow());x.itemHeight=Math.ceil(u.height/P)}x.itemHeight!==this.state.itemHeight&&this.setState(x)}}_performRepeat(){if(this.state.body instanceof h.o||!this.state.variableName||this._variableDependency.hasDependencyInLoadingState())return;const u=a.jh.lookupVariable(this.state.variableName,this)??new a.yP({name:"_____default_sys_repeat_var_____",options:[],value:"",text:"",query:"A"});if(!(u instanceof a.n8)){console.error("DashboardGridItem: Variable is not a MultiValueVariable");return}const{values:D,texts:E}=(0,o.a7)(u);if((0,i.isEqual)(this._prevRepeatValues,D))return;this._prevRepeatValues=D;const x=this.state.body instanceof f.F?this.state.body.state.panel:this.state.body,P=[],b={values:[""],texts:u.hasAllValue()?["All"]:["None"]},M=D.length?D:b.values,O=E.length?E:b.texts;for(let L=0;L<M.length;L++){const N={$variables:new a.Pj({variables:[new a.xc({name:u.state.name,value:M[L],text:String(O[L])})]}),key:`${x.state.key}-clone-${L}`};L>0&&(N.menu=new a.Lw({$behaviors:[d.t0]}));const F=x.clone(N);P.push(F)}const I=this.getRepeatDirection(),T={repeatedPanels:P},C=this.state.itemHeight??10,S=this.state.height,A=this.getMaxPerRow();if(I==="h"){const L=Math.ceil(P.length/A);T.height=L*C}else T.height=P.length*C;if(this.setState(T),S!==this.state.height){const L=a.jh.getLayout(this);L instanceof a.hy&&L.forceRender()}this.publishEvent(new p.d({source:this}),!0)}getMaxPerRow(){return this.state.maxPerRow??4}getRepeatDirection(){return this.state.repeatDirection==="v"?"v":"h"}getClassName(){return this.state.variableName?"panel-repeater-grid-item":""}isRepeated(){return this.state.variableName!==void 0}static{this.Component=({model:u})=>{const{repeatedPanels:D,itemHeight:E,variableName:x,body:P}=u.useState(),b=D?.length??0,M=v(u.getRepeatDirection(),b,u.getMaxPerRow(),E??10);if(!x){if(P instanceof a.Eb)return(0,t.jsx)(P.Component,{model:P},P.state.key);if(P instanceof f.F)return(0,t.jsx)(P.Component,{model:P},P.state.key);if(P instanceof h.o)return(0,t.jsx)(P.Component,{model:P},P.state.key)}return D?(0,t.jsx)("div",{className:M,children:D.map(O=>(0,t.jsx)("div",{className:l,children:(0,t.jsx)(O.Component,{model:O},O.state.key)},O.state.key))}):null}}}function v(y,u,D,E){return(0,r.useMemo)(()=>{const x=g.$.theme2,P=E*c.sD*u+(u-1)*c.dU;if(y==="h"){const b=Math.ceil(u/D),M=Math.min(u,D);return(0,n.css)({display:"grid",height:"100%",width:"100%",gridTemplateColumns:`repeat(${M}, 1fr)`,gridTemplateRows:`repeat(${b}, 1fr)`,gridColumnGap:x.spacing(1),gridRowGap:x.spacing(1),[x.breakpoints.down("md")]:{display:"flex",flexDirection:"column",height:P}})}return(0,n.css)({display:"flex",height:"100%",width:"100%",flexDirection:"column",gap:x.spacing(1),[x.breakpoints.down("md")]:{height:P}})},[y,u,D,E])}const l=(0,n.css)({display:"flex",flexGrow:1,position:"relative"})},34842:(k,R,e)=>{"use strict";e.d(R,{H$:()=>zs,vk:()=>Cs});var t=e(71733),n=e(26272),i=e(41987),s=e(32264),r=e(39601),g=e(80943),a=e(28138),c=e(15054),o=e(17422),h=e(33390),f=e(14792),d=e(34214),p=e(6473),m=e(11230),v=e(80484),l=e(28444),y=e(13530),u=e(74848),D=e(63021),E=e(40675),x=e(87978),P=e(54943),b=e(76459),M=e.n(b),O=e(49785),I=e(13544),T=e(55852),C=e(42418),S=e(67061),A=e(88575),L=e(10354),N=e(21744),F=e(15292),w=e(90613),B=e(60029),U=e(36607),K=e(71500),V=e(17172);function H(Ge){return(0,V.NF)(Ge)&&Ge.data&&Ge.data.status==="version-mismatch"}function Y(Ge){return(0,V.NF)(Ge)&&Ge.data&&Ge.data.status==="name-exists"}function X(Ge){return(0,V.NF)(Ge)&&Ge.data&&Ge.data.status==="plugin-dashboard"}function J({cancelButton:Ge,saveButton:Ae}){return(0,u.jsxs)(C.F,{title:"Name already exists",severity:"error",children:[(0,u.jsx)("p",{children:"A dashboard with the same name in selected folder already exists. Would you still like to save this dashboard?"}),(0,u.jsx)(w.a,{paddingTop:2,children:(0,u.jsxs)(S.B,{alignItems:"center",children:[Ge,Ae(!0)]})})]})}function q({overwrite:Ge,isLoading:Ae,isValid:Ke,onSave:lt}){return(0,u.jsx)(T.$n,{disabled:!Ke||Ae,icon:Ae?"spinner":void 0,onClick:()=>lt(Ge),variant:Ge?"destructive":"primary","data-testid":I.Tp.components.Drawer.DashboardSaveDrawer.saveButton,children:Ae?"Saving...":Ge?"Save and overwrite":"Save"})}var ae=e(41053),j=e(14110),te=e(3169),ne=e(91219),le=e(55314),z=e(31678),ee=e(36974);function se(Ge=!1){const Ae=(0,z.useDispatch)(),Ke=(0,te._2)(),[lt]=(0,le.e8)(),[It,Xt]=(0,ae.A)(async(Yt,gn,yn)=>{{const Mn=await lt({dashboard:gn,folderUid:yn.folderUid,message:yn.message,overwrite:yn.overwrite,showErrorAlert:!1,k8s:void 0});if("error"in Mn)throw Mn.error;const is=Mn.data;Yt.saveCompleted(gn,is,yn.folderUid),a.A.publish(new l.Eu),Ke.success("Dashboard saved"),(0,ee.ko)(is.uid),Ge?(0,j.rR)("grafana_dashboard_copied",{name:gn.title,url:is.url}):(0,j.rR)(`grafana_dashboard_${is.uid?"saved":"created"}`,{name:gn.title,url:is.url});const rs=r.Ny.getLocation(),ws=t.I.stripBaseFromUrl(is.url);return ws!==rs.pathname&&setTimeout(()=>{r.Ny.push({pathname:ws,search:rs.search})}),Yt.state.meta.isStarred&&Ae((0,ne.TU)({id:is.uid,title:Yt.state.title,url:ws})),Mn.data}},[Ae,Ke]);return{state:It,onSaveDashboard:Xt}}function ie({dashboard:Ge,changeInfo:Ae}){const{changedSaveModel:Ke}=Ae,{register:lt,handleSubmit:It,setValue:Xt,formState:Yt,getValues:gn,watch:yn}=(0,O.mN)({mode:"onBlur",defaultValues:{title:Ae.isNew?Ke.title:`${Ke.title} Copy`,description:Ke.description??"",folder:{uid:Ge.state.meta.folderUid,title:Ge.state.meta.folderTitle},copyTags:!1}}),{errors:Mn,isValid:is,defaultValues:rs}=Yt,ws=yn(),{state:Es,onSaveDashboard:Sa}=se(!1),Na=async or=>{const Vs=gn(),ka=ye(Ke,Vs,Ae.isNew);(await Sa(Ge,ka,{overwrite:or,folderUid:Vs.folder.uid})).status==="success"&&Ge.closeModal()},sa=(0,u.jsx)(T.$n,{variant:"secondary",onClick:()=>Ge.closeModal(),fill:"outline",children:"Cancel"}),ea=or=>(0,u.jsx)(q,{isValid:is,isLoading:Es.loading,onSave:Na,overwrite:or});function Da(or){return Y(or)?(0,u.jsx)(J,{cancelButton:sa,saveButton:ea}):(0,u.jsxs)(u.Fragment,{children:[or&&(0,u.jsx)(C.F,{title:"Failed to save dashboard",severity:"error",children:(0,u.jsx)("p",{children:or.message})}),(0,u.jsxs)(S.B,{alignItems:"center",children:[sa,ea(!1)]})]})}return(0,u.jsxs)("form",{onSubmit:It(()=>Na(!1)),children:[(0,u.jsx)(A.D,{label:(0,u.jsx)(Z,{dashboard:Ke,onChange:Xt}),invalid:!!Mn.title,error:Mn.title?.message,children:(0,u.jsx)(L.p,{...lt("title",{required:"Required",validate:ce}),"aria-label":"Save dashboard title field","data-testid":I.Tp.components.Drawer.DashboardSaveDrawer.saveAsTitleInput,onChange:M()(async or=>{Xt("title",or.target.value,{shouldValidate:!0})},400)})}),(0,u.jsx)(A.D,{label:(0,u.jsx)(oe,{dashboard:Ke,onChange:Xt}),invalid:!!Mn.description,error:Mn.description?.message,children:(0,u.jsx)(N.f,{...lt("description",{required:!1}),"aria-label":"Save dashboard description field",autoFocus:!0})}),(0,u.jsx)(A.D,{label:"Folder",children:(0,u.jsx)(U.d,{onChange:(or,Vs)=>Xt("folder",{uid:or,title:Vs}),value:ws.folder?.uid,initialTitle:rs.folder.title,dashboardId:Ke.id??void 0,enableCreateNew:!0})}),!Ae.isNew&&(0,u.jsx)(A.D,{label:"Copy tags",children:(0,u.jsx)(F.d,{...lt("copyTags")})}),(0,u.jsx)(w.a,{paddingTop:2,children:Da(Es.error)})]})}function Z(Ge){return(0,u.jsx)(S.B,{justifyContent:"space-between",children:(0,u.jsx)(B.J,{htmlFor:"description",children:"Title"})})}function oe(Ge){return(0,u.jsx)(S.B,{justifyContent:"space-between",children:(0,u.jsx)(B.J,{htmlFor:"description",children:"Description"})})}async function ce(Ge,Ae){if(Ge===Ae.folder.title?.trim())return"Dashboard name cannot be the same as folder name";try{return await K.P.validateNewDashboardName(Ae.folder.uid??"general",Ge),!0}catch(Ke){return Ke instanceof Error?Ke.message:"Dashboard name is invalid"}}function ye(Ge,Ae,Ke){return{...Ge,id:null,uid:"",title:Ae.title,description:Ae.description,tags:Ke||Ae.copyTags?Ge.tags:[]}}var re=e(96540),ue=e(10880);function De({dashboard:Ge,drawer:Ae,changeInfo:Ke}){const{changedSaveModel:lt,hasChanges:It}=Ke,{state:Xt,onSaveDashboard:Yt}=se(!1),[gn,yn]=(0,re.useState)({folderUid:Ge.state.meta.folderUid}),Mn=async Es=>{(await Yt(Ge,lt,{...gn,overwrite:Es})).status==="success"&&(Ge.closeModal(),Ae.state.onSaveSuccess?.())},is=(0,u.jsx)(T.$n,{variant:"secondary",onClick:()=>Ge.closeModal(),fill:"outline",children:"Cancel"}),rs=Es=>(0,u.jsx)(q,{isValid:It,isLoading:Xt.loading,onSave:Mn,overwrite:Es});function ws(Es){return H(Es)?(0,u.jsxs)(C.F,{title:"Someone else has updated this dashboard",severity:"error",children:[(0,u.jsx)("p",{children:"Would you still like to save this dashboard?"}),(0,u.jsx)(w.a,{paddingTop:2,children:(0,u.jsxs)(S.B,{alignItems:"center",children:[is,rs(!0)]})})]}):Y(Es)?(0,u.jsx)(J,{cancelButton:is,saveButton:rs}):X(Es)?(0,u.jsxs)(C.F,{title:"Plugin dashboard",severity:"error",children:[(0,u.jsxs)("p",{children:["Your changes will be lost when you update the plugin. Use ",(0,u.jsx)("strong",{children:"Save As"})," to create custom version."]}),(0,u.jsx)(w.a,{paddingTop:2,children:(0,u.jsxs)(S.B,{alignItems:"center",children:[is,rs(!0)]})})]}):(0,u.jsxs)(u.Fragment,{children:[Es&&(0,u.jsx)(C.F,{title:"Failed to save dashboard",severity:"error",children:(0,u.jsx)("p",{children:Es.message})}),(0,u.jsxs)(S.B,{alignItems:"center",children:[is,rs(!1),!It&&(0,u.jsx)("div",{children:"No changes to save"})]})]})}return(0,u.jsxs)(S.B,{gap:2,direction:"column",children:[(0,u.jsx)(ge,{drawer:Ae,changeInfo:Ke}),(0,u.jsx)(A.D,{label:"Message",children:(0,u.jsx)(N.f,{"aria-label":"message",value:gn.message??"",onChange:Es=>{yn({...gn,message:Es.currentTarget.value})},placeholder:"Add a note to describe your changes (optional).",autoFocus:!0,rows:5})}),ws(Xt.error)]})}function ge({drawer:Ge,changeInfo:Ae}){const{saveVariables:Ke=!1,saveTimeRange:lt=!1,saveRefresh:It=!1}=Ge.useState(),{hasTimeChanges:Xt,hasVariableValueChanges:Yt,hasRefreshChange:gn}=Ae;return(0,u.jsxs)(S.B,{direction:"column",alignItems:"flex-start",children:[Xt&&(0,u.jsx)(ue.S,{id:"save-timerange",checked:lt,onChange:Ge.onToggleSaveTimeRange,label:"Update default time range",description:"Will make current time range the new default","data-testid":I.Tp.pages.SaveDashboardModal.saveTimerange}),gn&&(0,u.jsx)(ue.S,{id:"save-refresh",label:"Update default refresh value",description:"Will make the current refresh the new default",checked:It,onChange:Ge.onToggleSaveRefresh,"data-testid":I.Tp.pages.SaveDashboardModal.saveRefresh}),Yt&&(0,u.jsx)(ue.S,{id:"save-variables",label:"Update default variable values",description:"Will make the current values the new default",checked:Ke,onChange:Ge.onToggleSaveVariables,"data-testid":I.Tp.pages.SaveDashboardModal.saveVariables})]})}var Te=e(32196),Le=e(4213),Ye=e.n(Le),je=e(70713),Ze=e(32372),Ne=e(10534);function Pe({dashboard:Ge,drawer:Ae,changeInfo:Ke}){const lt=(0,re.useMemo)(()=>JSON.stringify(Ke.changedSaveModel,null,2),[Ke]),It=(0,re.useCallback)(()=>{const Xt=new Blob([lt],{type:"application/json;charset=utf-8"});(0,Le.saveAs)(Xt,Ke.changedSaveModel.title+"-"+new Date().getTime()+".json")},[Ke.changedSaveModel,lt]);return(0,u.jsx)("div",{className:Ue.container,children:(0,u.jsxs)(S.B,{direction:"column",gap:2,grow:1,children:[(0,u.jsxs)("div",{children:["This dashboard cannot be saved from the Grafana UI because it has been provisioned from another source. Copy the JSON or save it to a file below, then you can update your dashboard in the provisioning source.",(0,u.jsx)("br",{}),(0,u.jsxs)("i",{children:["See"," ",(0,u.jsx)("a",{className:"external-link",href:"https://grafana.com/docs/grafana/latest/administration/provisioning/#dashboards",target:"_blank",rel:"noreferrer",children:"documentation"})," ","for more information about provisioning."]}),(0,u.jsx)("br",{})," ",(0,u.jsx)("br",{}),(0,u.jsx)("strong",{children:"File path: "})," ",Ge.state.meta.provisionedExternalId]}),(0,u.jsx)(ge,{drawer:Ae,changeInfo:Ke}),(0,u.jsx)("div",{className:Ue.json,children:(0,u.jsx)(je.Ay,{disableWidth:!0,children:({height:Xt})=>(0,u.jsx)(Ze.B,{width:"100%",height:Xt,language:"json",showLineNumbers:!0,showMiniMap:lt.length>100,value:lt,readOnly:!0})})}),(0,u.jsx)(w.a,{paddingTop:2,children:(0,u.jsxs)(S.B,{gap:2,children:[(0,u.jsx)(T.$n,{variant:"secondary",onClick:Ae.onClose,fill:"outline",children:"Cancel"}),(0,u.jsx)(Ne.b,{icon:"copy",getText:()=>lt,children:"Copy JSON to clipboard"}),(0,u.jsx)(T.$n,{type:"submit",onClick:It,children:"Save JSON to file"})]})})]})})}const Ue={container:(0,Te.css)({height:"100%",display:"flex"}),json:(0,Te.css)({flexGrow:1,maxHeight:"800px"})};var $e=e(20455),ze=e(45429);function qe(Ge,Ae,Ke,lt){const It=(0,ze.Yy)(Ge.getInitialSaveModel(),(0,$e.Uy)(Ge),Ae,Ke,lt),Xt=Ge.getInitialState()?.meta.folderUid!==Ge.state.meta.folderUid;return{...It,hasFolderChanges:Xt,hasChanges:It.hasChanges||Xt}}class dt extends g.Bs{constructor(){super(...arguments),this.onClose=()=>{this.state.dashboardRef.resolve().setState({overlay:void 0})},this.onToggleSaveTimeRange=()=>{this.setState({saveTimeRange:!this.state.saveTimeRange})},this.onToggleSaveVariables=()=>{this.setState({saveVariables:!this.state.saveVariables})},this.onToggleSaveRefresh=()=>{this.setState({saveRefresh:!this.state.saveRefresh})}}static{this.Component=({model:Ae})=>{const{showDiff:Ke,saveAsCopy:lt,saveTimeRange:It,saveVariables:Xt,saveRefresh:Yt}=Ae.useState(),gn=qe(Ae.state.dashboardRef.resolve(),It,Xt,Yt),{changedSaveModel:yn,initialSaveModel:Mn,diffs:is,diffCount:rs,hasFolderChanges:ws}=gn,Es=rs+(ws?1:0),Sa=Ae.state.dashboardRef.resolve(),{meta:Na}=Sa.useState(),{provisioned:sa,folderTitle:ea}=Na,Da=(0,u.jsxs)(D.U,{children:[(0,u.jsx)(E.o,{label:"Details",active:!Ke,onChangeTab:()=>Ae.setState({showDiff:!1})}),Es>0&&(0,u.jsx)(E.o,{label:"Changes",active:Ke,onChangeTab:()=>Ae.setState({showDiff:!0}),counter:Es})]});let or="Save dashboard";lt?or="Save dashboard copy":sa&&(or="Provisioned dashboard");const Vs=()=>Ke?(0,u.jsx)(P.l,{diff:is,oldValue:Mn,newValue:yn,hasFolderChanges:ws,oldFolder:Sa.getInitialState()?.meta.folderTitle,newFolder:ea}):lt||gn.isNew?(0,u.jsx)(ie,{dashboard:Sa,changeInfo:gn}):sa?(0,u.jsx)(Pe,{dashboard:Sa,changeInfo:gn,drawer:Ae}):(0,u.jsx)(De,{dashboard:Sa,changeInfo:gn,drawer:Ae});return(0,u.jsx)(x._,{title:or,subtitle:Sa.state.title,onClose:Ae.onClose,tabs:Da,children:Vs()})}}}var vt=e(85445),yt=e(57714),st=e(64423),Ve=e(18226),pe=e(94624),Ee=e(72724),me=e(3591),ve=e(41507),Se=e(13989),Ie=e(53543),Oe=e(74730);class Re{constructor(Ae){this._scene=Ae,this.events=new Ve.o,this._subs=new st.yU;const Ke=g.jh.getTimeRange(Ae);this.formatDate=this.formatDate.bind(this),this._subs.add(Ke.subscribeToState((lt,It)=>{lt.value!==It.value&&this.events.publish(new me.sR(lt.value))}))}get id(){return this._scene.state.id??null}get uid(){return this._scene.state.uid??null}get title(){return this._scene.state.title}get description(){return this._scene.state.description}get editable(){return this._scene.state.editable}get graphTooltip(){return this._getSyncMode()}get timepicker(){return{refresh_intervals:this._scene.state.controls.state.refreshPicker.state.intervals,hidden:this._scene.state.controls.state.hideTimeControls??!1}}get timezone(){return this.getTimezone()}get weekStart(){return g.jh.getTimeRange(this._scene).state.weekStart}get tags(){return this._scene.state.tags}get links(){return this._scene.state.links}get meta(){return this._scene.state.meta}get time(){const Ae=g.jh.getTimeRange(this._scene);return{from:Ae.state.from,to:Ae.state.to}}get panels(){return he(this._scene,Ke=>Ke instanceof g.Eb).map(Ke=>new Ie.R(Ke))}get annotations(){const Ae={list:[]};return this._scene.state.$data instanceof g.kh&&(Ae.list=(0,Se.O)(this._scene.state.$data.state.layers)),Ae}getTimezone(){return g.jh.getTimeRange(this._scene).getTimeZone()}sharedTooltipModeEnabled(){return this._getSyncMode()>0}sharedCrosshairModeOnly(){return this._getSyncMode()===1}_getSyncMode(){if(this._scene.state.$behaviors){for(const Ae of this._scene.state.$behaviors)if(Ae instanceof g.Gg.K2)return Ae.state.sync}return pe.y.Off}otherPanelInFullscreen(Ae){return!1}formatDate(Ae,Ke){return(0,Ee.LE)(Ae,{format:Ke,timeZone:this.getTimezone()})}getPanelById(Ae){const Ke=(0,Oe.vL)(this._scene,(0,Oe.XA)(Ae));return Ke?new Ie.R(Ke):null}removePanel(Ae){const Ke=(0,Oe.vL)(this._scene,(0,Oe.XA)(Ae.id));if(!Ke){console.error("Trying to remove a panel that was not found in scene",Ae);return}const lt=Ke.parent;if(!(lt instanceof ve.U)){console.error("Trying to remove a panel that is not wrapped in DashboardGridItem");return}const It=g.jh.getLayout(Ke);if(!(It instanceof g.hy)){console.error("Trying to remove a panel in a layout that is not SceneGridLayout ");return}if(It===lt.parent&&It.setState({children:It.state.children.filter(Xt=>Xt!==lt)}),lt.parent instanceof g.tI){const Xt=It.clone({children:It.state.children.filter(Yt=>Yt!==lt)});It.parent instanceof g.hy&&It.parent.setState({children:It.parent.state.children.map(Yt=>Yt===It?Xt:Yt)})}}canEditAnnotations(Ae){return this._scene.canEditDashboard()?Ae?!!this._scene.state.meta.annotationsPermissions?.dashboard.canEdit:!!this._scene.state.meta.annotationsPermissions?.organization.canEdit:!1}panelInitialized(){}destroy(){this.events.removeAllListeners(),this._subs.unsubscribe()}hasUnsavedChanges(){return this._scene.state.isDirty}}function he(Ge,Ae){let Ke=[];return Ge.forEachChild(lt=>{Ae(lt)?Ke.push(lt):Ke=Ke.concat(he(lt,Ae))}),Ke}var Ce=e(32023);function We(Ge){let Ae=5381;for(let Ke=0;Ke<Ge.length;Ke++)Ae=Ae*33^Ge.charCodeAt(Ke);return Ae>>>0}var et=e(11982),rt=e(57109),nt=e(24180),gt=e(49045),xt=e(64388),St=e(40845),zt=e(40276),Nt=e(69444),Vt=e(7392),en=e(68064),Je=e(94358);function ct({model:Ge}){const{controls:Ae,overlay:Ke,editview:lt,editPanel:It,isEmpty:Xt,scopes:Yt}=Ge.useState(),{isExpanded:gn}=Yt?.useState()??{},yn=(0,St.of)(ot),Mn=(0,nt.zy)(),is=(0,z.useSelector)(or=>or.navIndex),rs=Ge.getPageNav(Mn,is),ws=Ge.getBodyToRender(),Es=(0,o.tc)(is,"dashboards/browse"),Sa=Ae?.hasControls();if(lt)return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(lt.Component,{model:lt}),Ke&&(0,u.jsx)(Ke.Component,{model:Ke})]});const Na=(0,u.jsx)(en.A,{dashboard:Ge,canCreate:!!Ge.state.meta.canEdit},"dashboard-empty-state"),sa=(0,u.jsx)("div",{className:(0,Te.cx)(yn.body,!Sa&&yn.bodyWithoutControls),children:(0,u.jsx)(ws.Component,{model:ws})},"dashboard-panels"),ea=meta.dashboardNotFound&&(0,u.jsx)(Vt.L,{entity:"Dashboard"},"dashboard-not-found");let Da=[sa];return ea?Da=[ea]:Xt&&(Da=[Na,sa]),(0,u.jsxs)(Nt.Y,{navModel:Es,pageNav:rs,layout:xt.k.Custom,children:[It&&(0,u.jsx)(It.Component,{model:It}),!It&&(0,u.jsxs)("div",{className:(0,Te.cx)(yn.pageContainer,Sa&&!Yt&&yn.pageContainerWithControls,Yt&&yn.pageContainerWithScopes,Yt&&gn&&yn.pageContainerWithScopesExpanded),children:[Yt&&!meta.dashboardNotFound&&(0,u.jsx)(Yt.Component,{model:Yt}),(0,u.jsx)(Je.c,{dashboard:Ge}),Ae&&(0,u.jsx)("div",{className:(0,Te.cx)(yn.controlsWrapper,Yt&&!gn&&yn.controlsWrapperWithScopes),children:(0,u.jsx)(Ae.Component,{model:Ae})}),(0,u.jsx)(Qe,{id:"page-scrollbar",className:yn.panelsContainer,testId:I.Tp.pages.Dashboard.DashNav.scrollContainer,children:(0,u.jsx)("div",{className:(0,Te.cx)(yn.canvasContent),children:Da})})]}),Ke&&(0,u.jsx)(Ke.Component,{model:Ke})]})}function ot(Ge){return{pageContainer:(0,Te.css)({display:"grid",gridTemplateAreas:`
  "panels"`,gridTemplateColumns:"1fr",gridTemplateRows:"1fr",height:"100%",[Ge.breakpoints.down("sm")]:{display:"flex",flexDirection:"column"}},s.$.featureToggles.bodyScrolling&&{position:"absolute",width:"100%"}),pageContainerWithControls:(0,Te.css)({gridTemplateAreas:`
        "controls"
        "panels"`,gridTemplateRows:"auto 1fr"}),pageContainerWithScopes:(0,Te.css)({gridTemplateAreas:`
        "scopes controls"
        "panels panels"`,gridTemplateColumns:`${Ge.spacing(32)} 1fr`,gridTemplateRows:"auto 1fr"}),pageContainerWithScopesExpanded:(0,Te.css)({gridTemplateAreas:`
        "scopes controls"
        "scopes panels"`}),panelsContainer:(0,Te.css)({gridArea:"panels"}),controlsWrapper:(0,Te.css)({display:"flex",flexDirection:"column",flexGrow:0,gridArea:"controls",padding:Ge.spacing(2),":empty":{display:"none"}}),controlsWrapperWithScopes:(0,Te.css)({padding:Ge.spacing(2,2,2,0)}),canvasContent:(0,Te.css)({label:"canvas-content",display:"flex",flexDirection:"column",padding:Ge.spacing(0,2),flexBasis:"100%",flexGrow:1}),body:(0,Te.css)({label:"body",flexGrow:1,display:"flex",gap:"8px",paddingBottom:Ge.spacing(2),boxSizing:"border-box"}),bodyWithoutControls:(0,Te.css)({paddingTop:Ge.spacing(2)})}}const Qe=({id:Ge,children:Ae,className:Ke,testId:lt})=>{const It=(0,St.$j)(),Xt=(0,gt.A)(`(max-width: ${It.breakpoints.values.sm}px)`),Yt=(0,St.of)(()=>({nonScrollable:(0,Te.css)({height:"100%",display:"flex",flexDirection:"column"})}));return Xt?(0,u.jsx)("div",{id:Ge,className:(0,Te.cx)(Ke,Yt.nonScrollable),"data-testid":lt,children:Ae}):(0,u.jsx)(zt.E,{divId:Ge,autoHeightMin:"100%",className:Ke,testId:lt,children:Ae})};var pt=e(65123),Pt=e(54612),At=e(16560),mn=e(29678),Pn=e(14578),fn=e(62930),Rn=e(90182),Kn=e(16233),Bt=e(83195),an=e(2619),tn=e(2543),Cn=e(89667),xn=e(52622),Vn=e(39070),Et=e(68706),Ft=e(60656),Gt=e(41524);function ln(Ge){const Ae=[];if(Ge?.series)for(const Ke of Ge.series)Ae.push((0,Cn.Nw)(Ke));if(Ge?.annotations)for(const Ke of Ge.annotations){const lt=(0,Cn.Nw)(Ke);lt.schema?.meta||(lt.schema.meta={}),lt.schema.meta.dataTopic=xn.QR.Annotations,Ae.push(lt)}return Ae}function qt(Ge,Ae){const Ke={panelType:Ge.state.pluginId,datasource:"??"},lt=s.$.buildInfo.versionString;let It=`| Key | Value |
|--|--|
| Panel | ${Ke.panelType} @ ${Ge.state.pluginVersion??lt} |
| Grafana | ${lt} // ${s.$.buildInfo.edition} |
`;return Ae&&(It+="<details><summary>Panel debug snapshot dashboard</summary>\n\n```json\n"+Ae+"\n```\n</details>"),It}async function cn(Ge,Ae,Ke){let lt={type:""};const It=Ge.parent instanceof Ft.F,Xt=It?Ge.parent.parent:Ge.parent,Yt=Ge.getRoot();if(It)lt={...(0,$e.ZB)(Xt),...(0,$e.Z6)(Ge)};else if(Yt.state.editPanel){const ea=Yt.state.editPanel.state.vizManager.state.sourcePanel.resolve(),Da=ea.parent instanceof Ft.F?ea.parent.parent:ea.parent;Da instanceof ve.U&&(lt={...(0,$e.ZB)(Da),...(0,$e.Z6)(Yt.state.editPanel.state.vizManager.state.panel.clone())})}else lt=(0,$e.ZB)(Xt);const gn=(0,tn.cloneDeep)(Wn),yn={panelType:Ge.state.pluginId,datasource:"??"},Mn=(0,Oe.un)(Ge);if(!Mn.state.data)return;const is=Mn.state.data,rs=Mn?.state.datasource,ws=(0,Gt.W)(ln(is),Ae),Es=s.$.buildInfo.versionString,Sa=Mn.state.queries??[],Na=is.annotations?is.annotations.reduce((ea,Da)=>Da.length+ea,0):0,sa=`<table width="100%">
    <tr>
      <th width="2%">Panel</th>
      <td >${yn.panelType} @ ${lt.pluginVersion??Es}</td>
    </tr>
    <tr>
      <th>Queries</th>
      <td>${Sa.map(ea=>{const Da=ea.datasource??rs;return`${ea.refId}[${Da?.type}]`}).join(", ")}</td>
    </tr>
    ${En(lt)}
    ${Sn(is,ws)}
    ${Tn(is)}
    <tr>
      <th>Grafana</th>
      <td>${Es} // ${s.$.buildInfo.edition}</td>
    </tr>
  </table>`.trim();if(gn.panels[0]={...lt,...gn.panels[0],targets:[{refId:"A",datasource:{type:"grafana",uid:"grafana"},queryType:Et.nj.Snapshot,snapshot:ws}]},delete gn.panels[0].libraryPanel,lt.transformations?.length){const ea=gn.panels[gn.panels.length-1];ea.title=ea.title+" (after transformations)";const Da=(0,tn.cloneDeep)(ea);Da.id=100,Da.title="Data (before transformations)",Da.gridPos.w=24,Da.targets[0].withTransforms=!1,gn.panels.push(Da)}return Na>0&&gn.panels.push({id:7,gridPos:{h:6,w:24,x:0,y:20},type:"table",title:"Annotations",datasource:{type:"datasource",uid:"-- Dashboard --"},options:{showTypeIcons:!0},targets:[{datasource:{type:"datasource",uid:"-- Dashboard --"},panelId:2,withTransforms:!0,topic:xn.QR.Annotations,refId:"A"}]}),gn.panels[1].options.content=sa,gn.panels[2].options.content=JSON.stringify(lt,null,2),gn.title=`Debug: ${lt.title} // ${(0,Ee.LE)(new Date)}`,gn.tags=["debug",`debug-${yn.panelType}`],gn.time={from:Ke.from.toISOString(),to:Ke.to.toISOString()},gn}function En(Ge){return Ge.transformations?`<tr>
      <th>Transform</th>
      <td>${Ge.transformations.map(Ae=>Ae.id).join(", ")}</td>
  </tr>`:""}function Sn(Ge,Ae){let Ke=Ge.series.length??0,lt=0,It=0;for(const Xt of Ge.series)lt+=Xt.fields.length,It+=Xt.length;return`<tr><th>Data</th><td>${Ge.state!==Vn.Gu.Done?Ge.state:""} ${Ke} frames, ${lt} fields, ${It} rows </td></tr>`}function Tn(Ge){return Ge.annotations?.length?`<tr>
  <th>Annotations</th>
  <td>${Ge.annotations.reduce((Ae,Ke)=>Ke.length+Ae,0)}</td>
</tr>`:""}const Wn={panels:[{id:2,title:"Reproduced with embedded data",datasource:{type:"grafana",uid:"grafana"},gridPos:{h:13,w:15,x:0,y:0}},{gridPos:{h:7,w:9,x:15,y:0},id:5,options:{content:"...",mode:"html"},title:"Debug info",type:"text"},{id:6,title:"Original Panel JSON",type:"text",gridPos:{h:13,w:9,x:15,y:7},options:{content:"...",mode:"code",code:{language:"json",showLineNumbers:!0,showMiniMap:!0}}},{id:3,title:"Data from panel above",type:"table",datasource:{type:"datasource",uid:"-- Dashboard --"},gridPos:{h:7,w:15,x:0,y:13},options:{showTypeIcons:!0},targets:[{datasource:{type:"datasource",uid:"-- Dashboard --"},panelId:2,withTransforms:!0,refId:"A"}]}],schemaVersion:37};var Nn=(Ge=>(Ge[Ge.Support=0]="Support",Ge[Ge.Data=1]="Data",Ge))(Nn||{}),Tt=(Ge=>(Ge[Ge.PanelSnapshot=0]="PanelSnapshot",Ge[Ge.GithubComment=1]="GithubComment",Ge))(Tt||{});class Wt extends an.Q{constructor(Ae){super({panel:Ae,panelTitle:g.jh.interpolate(Ae,Ae.state.title,{},"text"),currentTab:0,showMessage:1,snapshotText:"",markdownText:"",randomize:{},snapshotUpdate:0,options:[{label:"GitHub comment",description:"Copy and paste this message into a GitHub issue or comment",value:1},{label:"Panel support snapshot",description:"Dashboard JSON used to help troubleshoot visualization issues",value:0}]}),this.onCurrentTabChange=Ke=>{this.setState({currentTab:Ke})},this.onShowMessageChange=Ke=>{this.setState({showMessage:Ke.value})},this.onGetMarkdownForClipboard=()=>{const{markdownText:Ke}=this.state,lt=Math.pow(1024,2)*1.5;return Ke.length>lt?(this.setState({error:{title:"Copy to clipboard failed",message:"Snapshot is too large, consider download and attaching a file instead"}}),""):Ke},this.onDownloadDashboard=()=>{const{snapshotText:Ke,panelTitle:lt}=this.state,It=new Blob([Ke],{type:"text/plain"}),Xt=`debug-${lt}-${(0,Ee.LE)(new Date)}.json.txt`;Ye()(It,Xt)},this.onSetSnapshotText=Ke=>{this.setState({snapshotText:Ke})},this.onToggleRandomize=Ke=>{const{randomize:lt}=this.state;this.setState({randomize:{...lt,[Ke]:!lt[Ke]}})}}async buildDebugDashboard(){const{panel:Ae,randomize:Ke,snapshotUpdate:lt}=this.state,It=await cn(Ae,Ke,g.jh.getTimeRange(Ae).state.value),Xt=JSON.stringify(It,null,2),Yt=qt(Ae,Xt),gn=(0,Bt.cN)((0,Bt.j_)("bytes")(Xt?.length??0));let yn;if(It)try{yn=(0,vt.wM)({dashboard:It,meta:{isEmbedded:!0}}).state.body}catch(Mn){console.log("Error creating scene:",Mn)}this.setState({snapshot:It,snapshotText:Xt,markdownText:Yt,snapshotSize:gn,snapshotUpdate:lt+1,scene:yn})}}function jt({panel:Ge,onClose:Ae}){const Ke=(0,St.of)(ut),lt=(0,re.useMemo)(()=>new Wt(Ge),[Ge]),It=Ge.getPlugin(),{currentTab:Xt,loading:Yt,error:gn,options:yn,showMessage:Mn,snapshotSize:is,markdownText:rs,snapshotText:ws,randomize:Es,panelTitle:Sa,scene:Na}=lt.useState();if((0,re.useEffect)(()=>{lt.buildDebugDashboard()},[lt,It,Es]),!It)return null;const sa=[{label:"Snapshot",value:Nn.Support},{label:"Data",value:Nn.Data}],ea=s.$.supportBundlesEnabled&&Kn.TP.hasPermission(z.AccessControlAction.ActionSupportBundlesCreate);return(0,u.jsxs)(x._,{title:"Get help with this panel",size:"lg",onClose:Ae,subtitle:(0,u.jsxs)(S.B,{direction:"column",gap:1,children:[(0,u.jsxs)(S.B,{direction:"row",gap:1,children:[(0,u.jsx)(mn.y,{featureState:i.Ay.beta}),(0,u.jsxs)("a",{href:"https://grafana.com/docs/grafana/latest/troubleshooting/",target:"blank",className:"external-link",rel:"noopener noreferrer",children:["Troubleshooting docs ",(0,u.jsx)(Pn.I,{name:"external-link-alt"})]})]}),(0,u.jsx)("span",{className:"muted",children:"To request troubleshooting help, send a snapshot of this panel to Grafana Labs Technical Support. The snapshot contains query response data and panel settings."}),ea&&(0,u.jsxs)("span",{className:"muted",children:["You can also retrieve a support bundle containing information concerning your Grafana instance and configured datasources in the ",(0,u.jsx)("a",{href:"/support-bundles",children:"support bundles section"}),"."]})]}),tabs:(0,u.jsx)(D.U,{children:sa.map((Da,or)=>(0,u.jsx)(E.o,{label:Da.label,active:Da.value===Xt,onChangeTab:()=>lt.onCurrentTabChange(Da.value)},`${Da.value}-${or}`))}),children:[Yt&&(0,u.jsx)(fn.y,{}),gn&&(0,u.jsx)(C.F,{title:gn.title,children:gn.message}),Xt===Nn.Data&&(0,u.jsxs)("div",{className:Ke.code,children:[(0,u.jsxs)("div",{className:Ke.opts,children:[(0,u.jsx)(A.D,{label:"Template",className:Ke.field,children:(0,u.jsx)(Rn.l6,{options:yn,value:Mn,onChange:lt.onShowMessageChange})}),Mn===Tt.GithubComment?(0,u.jsx)(Ne.b,{icon:"copy",getText:lt.onGetMarkdownForClipboard,children:"Copy to clipboard"}):(0,u.jsxs)(T.$n,{icon:"download-alt",onClick:lt.onDownloadDashboard,children:["Download (",is,")"]})]}),(0,u.jsx)(je.Ay,{disableWidth:!0,children:({height:Da})=>(0,u.jsx)(Ze.B,{width:"100%",height:Da,language:Mn===Tt.GithubComment?"markdown":"json",showLineNumbers:!0,showMiniMap:!0,value:Mn===Tt.GithubComment?rs:ws,readOnly:!1,onBlur:lt.onSetSnapshotText})})]}),Xt===Nn.Support&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(A.D,{label:"Randomize data",description:"Modify the original data to hide sensitve information.  Note the lengths will stay the same, and duplicate values will be equal.",children:(0,u.jsxs)(S.B,{children:[(0,u.jsx)(F.K,{label:"Labels",id:"randomize-labels",showLabel:!0,value:!!Es.labels,onChange:()=>lt.onToggleRandomize("labels")}),(0,u.jsx)(F.K,{label:"Field names",id:"randomize-field-names",showLabel:!0,value:!!Es.names,onChange:()=>lt.onToggleRandomize("names")}),(0,u.jsx)(F.K,{label:"String values",id:"randomize-string-values",showLabel:!0,value:!!Es.values,onChange:()=>lt.onToggleRandomize("values")})]})}),(0,u.jsx)(A.D,{label:"Support snapshot",description:`Panel: ${Sa}`,children:(0,u.jsxs)(S.B,{children:[(0,u.jsxs)(T.$n,{icon:"download-alt",onClick:lt.onDownloadDashboard,children:["Dashboard (",is,")"]}),(0,u.jsx)(Ne.b,{icon:"github",getText:lt.onGetMarkdownForClipboard,title:"Copy a complete GitHub comment to the clipboard",children:"Copy to clipboard"})]})}),(0,u.jsx)(je.Ay,{disableWidth:!0,children:({height:Da})=>(0,u.jsx)("div",{style:{height:Da,overflow:"auto"},children:Na&&(0,u.jsx)(Na.Component,{model:Na})})})]})]})}const ut=Ge=>({code:(0,Te.css)({flexGrow:1,height:"100%",overflow:"scroll"}),field:(0,Te.css)({width:"100%"}),opts:(0,Te.css)({display:"flex",width:"100%",flexGrow:0,alignItems:"center",justifyContent:"flex-end","& button":{marginLeft:Ge.spacing(1)}})});var Zt=e(8484),jn=e(61453);class Xn extends g.Bs{constructor(Ae){super({...Ae,options:{withTransforms:!1,withFieldConfig:!0}}),this.onOptionsChange=Ke=>{this.setState({options:Ke})}}getTabLabel(){return(0,Zt.t)("dashboard.inspect.data-tab","Data")}getTabValue(){return At.q.Data}static{this.Component=({model:Ae})=>{const{options:Ke}=Ae.useState(),lt=Ae.state.panelRef.resolve(),It=g.jh.getData(lt),{data:Xt}=Fn(It,Ke.withTransforms).useState(),Yt=g.jh.getTimeRange(lt);return(0,u.jsx)(jn.q,{isLoading:Xt?.state===Vn.Gu.Loading,data:Xt?.series,options:Ke,hasTransformations:Qn(It),timeZone:Yt.getTimeZone(),panelPluginId:lt.state.pluginId,dataName:lt.state.title,fieldConfig:lt.state.fieldConfig,onOptionsChange:Ae.onOptionsChange})}}}function Qn(Ge){return Ge instanceof g.Es?Ge.state.transformations.length>0:!1}function Fn(Ge,Ae){return!Ae&&Ge instanceof g.Es&&Ge.state.$data?Ge.state.$data:Ge}var qn=e(18803),js=e(26323),ys=e(77938),Ps=e(6204),es=e(89681);class _s extends g.Bs{constructor(Ae){super({...Ae,source:"panel-json",jsonText:ca("panel-json",Ae.panelRef.resolve())}),this.onChangeSource=Ke=>{this.setState({source:Ke.value,jsonText:ca(Ke.value,this.state.panelRef.resolve())})},this.onApplyChange=()=>{const Ke=this.state.panelRef.resolve(),lt=(0,Oe.YQ)(Ke),It=JSON.parse(this.state.jsonText),Xt=new d.a(It),Yt=(0,vt.tt)(Xt),gn=g.Go.cloneSceneObjectState(Yt.state);if(!(Ke.parent instanceof ve.U)){console.error("Cannot update state of panel",Ke,Yt);return}this.state.onClose(),lt.state.isEditing||lt.onEnterEditMode(),Ke.parent.setState(gn),(0,Ps.B9)(At.q.JSON,"apply",{panel_type_changed:Ke.state.pluginId!==Xt.type,panel_id_changed:(0,Oe.Cs)(Ke)!==Xt.id,panel_grid_pos_changed:nr(Ke.parent.state,gn),panel_targets_changed:lr((0,Oe.un)(Ke),(0,Oe.un)(gn.$data))})},this.onCodeEditorBlur=Ke=>{this.setState({jsonText:Ke})}}getTabLabel(){return(0,Zt.t)("dashboard.inspect.json-tab","JSON")}getTabValue(){return At.q.JSON}getOptions(){const Ae=this.state.panelRef.resolve(),Ke=Ae.state.$data??Ae.parent?.state.$data,lt=[{label:(0,Zt.t)("dashboard.inspect-json.panel-json-label","Panel JSON"),description:(0,Zt.t)("dashboard.inspect-json.panel-json-description","The model saved in the dashboard JSON that configures how everything works."),value:"panel-json"}];return Ke&&(lt.push({label:(0,Zt.t)("dashboard.inspect-json.panel-data-label","Panel data"),description:(0,Zt.t)("dashboard.inspect-json.panel-data-description","The raw model passed to the panel visualization"),value:"panel-data"}),lt.push({label:(0,Zt.t)("dashboard.inspect-json.dataframe-label","DataFrame JSON (from Query)"),description:(0,Zt.t)("dashboard.inspect-json.dataframe-description","Raw data without transformations and field config applied. "),value:"data-frames"})),lt}isEditable(){if(this.state.source!=="panel-json")return!1;const Ae=this.state.panelRef.resolve();return Ae.parent instanceof Ft.F||Ae.parent instanceof ve.U&&Ae.parent.isRepeated()?!1:(0,Oe.YQ)(Ae).state.meta.canEdit}static{this.Component=({model:Ae})=>{const{source:Ke,jsonText:lt}=Ae.useState(),It=(0,St.of)(js.A),Xt=Ae.getOptions();return(0,u.jsxs)("div",{className:It.wrap,children:[(0,u.jsxs)("div",{className:It.toolbar,"data-testid":I.Tp.components.PanelInspector.Json.content,children:[(0,u.jsx)(A.D,{label:(0,Zt.t)("dashboard.inspect-json.select-source","Select source"),className:"flex-grow-1",children:(0,u.jsx)(Rn.l6,{inputId:"select-source-dropdown",options:Xt,value:Xt.find(Yt=>Yt.value===Ke)??Xt[0].value,onChange:Ae.onChangeSource})}),Ae.isEditable()&&(0,u.jsx)(T.$n,{className:It.toolbarItem,onClick:Ae.onApplyChange,children:"Apply"})]}),(0,u.jsx)("div",{className:It.content,children:(0,u.jsx)(je.Ay,{disableWidth:!0,children:({height:Yt})=>(0,u.jsx)(Ze.B,{width:"100%",height:Yt,language:"json",showLineNumbers:!0,showMiniMap:lt.length>100,value:lt,readOnly:!Ae.isEditable(),onBlur:Ae.onCodeEditorBlur})})})]})}}}function ca(Ge,Ae){let Ke={};switch(Ge){case"panel-json":{(0,Ps.B9)(At.q.JSON,"panelData");const lt=Ae.parent instanceof Ft.F,It=lt?Ae.parent.parent:Ae.parent;if(lt){Ke=Ks(Ae);break}if(Ae.parent instanceof es.j){Ke=Ae.parent.getPanelSaveModel();break}It instanceof ve.U&&(Ke=(0,$e.ZB)(It));break}case"panel-data":{(0,Ps.B9)(At.q.JSON,"panelJSON");const lt=g.jh.getData(Ae);lt.state.data&&(Ke=Ae.applyFieldConfig(lt.state.data));break}case"data-frames":{(0,Ps.B9)(At.q.JSON,"dataFrame");const lt=g.jh.getData(Ae);lt.state.data&&(lt instanceof g.Es&&lt.state.$data?.state.data?Ke=(0,qn.B6)(lt.state.$data.state.data):Ke=(0,qn.B6)(lt.state.data))}}return(0,ys.p)(Ke)}function Ks(Ge){if(!(Ge.parent instanceof Ft.F))throw"Panel not child of LibraryVizPanel";if(!(Ge.parent.parent instanceof ve.U))throw"LibraryPanel not child of DashboardGridItem";const Ae=Ge.parent.parent,Ke={x:Ae.state.x||0,y:Ae.state.y||0,h:Ae.state.height||0,w:Ae.state.width||0},lt=Zs(Ge),It=(0,$e.Z6)(Ge,Ke,!1,Ae);return{libraryPanel:{...lt},...It}}function Zs(Ge){if(!(Ge.parent instanceof Ft.F))throw new Error("Panel not a child of LibraryVizPanel");if(!Ge.parent.state._loadedPanel)throw new Error("Library panel not loaded");return Ge.parent.state._loadedPanel}function nr(Ge,Ae){return Ge.x!==Ae.x||Ge.y!==Ae.y||Ge.width!==Ae.width||Ge.height!==Ae.height}function lr(Ge,Ae){return Ge===void 0||Ae===void 0?!1:!(0,tn.isEqual)(Ge.state.queries,Ae.state.queries)}class ga extends g.Bs{getTabLabel(){return(0,Zt.t)("dashboard.inspect.meta-tab","Meta data")}getTabValue(){return At.q.Meta}static{this.Component=({model:Ae})=>{const{panelRef:Ke,dataSource:lt}=Ae.state,It=g.jh.getData(Ke.resolve()),Xt=lt.components?.MetadataInspector;return!It.state.data||!Xt?null:(0,u.jsx)(Xt,{datasource:lt,data:It.state.data.series})}}}var $a=e(90820);class Za extends g.Bs{constructor(){super(...arguments),this.onRefreshQuery=()=>{const Ae=(0,Oe.un)(this.state.panelRef.resolve());Ae&&Ae.runQueries()}}getTabLabel(){return(0,Zt.t)("dashboard.inspect.query-tab","Query")}getTabValue(){return At.q.Query}static{this.Component=({model:Ae})=>{const Ke=g.jh.getData(Ae.state.panelRef.resolve()).useState();return Ke.data?(0,u.jsx)($a.e,{data:Ke.data,onRefreshQuery:Ae.onRefreshQuery}):null}}}var mr=e(32067);class Va extends g.Bs{getTabLabel(){return(0,Zt.t)("dashboard.inspect.stats-tab","Stats")}getTabValue(){return At.q.Stats}static{this.Component=({model:Ae})=>{const Ke=g.jh.getData(Ae.state.panelRef.resolve()).useState(),lt=g.jh.getTimeRange(Ae.state.panelRef.resolve());return Ke.data?(0,u.jsx)(mr.N,{data:Ke.data,timeZone:lt.getTimeZone()}):null}}}class Ea extends g.Bs{constructor(Ae){super(Ae),this.onClose=()=>{const Ke=(0,Oe.YQ)(this);r.Ny.push((0,et.uZ)({uid:Ke.state.uid,slug:Ke.state.meta.slug,currentQueryParams:r.Ny.getLocation().search,updateQuery:{inspect:null,inspectTab:null}}))},this.addActivationHandler(()=>this._activationHandler())}static{this.Component=cr}_activationHandler(){this.buildTabs(0)}async buildTabs(Ae){const Ke=this.state.panelRef,lt=Ke?.resolve()?.getPlugin(),It=[];if(lt||(Ae<2e3?setTimeout(()=>this.buildTabs(Ae+100),100):this.setState({pluginNotLoaded:!0})),Ke){if((0,Pt.$)(lt)){const Xt=g.jh.getData(Ke.resolve());It.push(new Xn({panelRef:Ke})),It.push(new Va({panelRef:Ke})),It.push(new Za({panelRef:Ke}));const Yt=await(0,pt.BN)(Xt.state.data);Yt&&It.push(new ga({panelRef:Ke,dataSource:Yt}))}It.push(new _s({panelRef:Ke,onClose:this.onClose}))}this.setState({tabs:It})}getDrawerTitle(){const Ae=this.state.panelRef?.resolve();return Ae?g.jh.interpolate(Ae,`Inspect: ${Ae.state.title}`):"Inspect panel"}}function cr({model:Ge}){const{tabs:Ae,pluginNotLoaded:Ke,panelRef:lt}=Ge.useState(),It=(0,nt.zy)(),Xt=new URLSearchParams(It.search);if(!Ae)return null;const Yt=Xt.get("inspectTab"),gn=Ae.find(Mn=>Mn.getTabValue()===Yt)??Ae[0],yn=lt.resolve();return Yt===At.q.Help?(0,u.jsx)(jt,{panel:yn,onClose:Ge.onClose}):(0,u.jsxs)(x._,{title:Ge.getDrawerTitle(),onClose:Ge.onClose,size:"md",tabs:(0,u.jsx)(D.U,{children:Ae.map(Mn=>(0,u.jsx)(E.o,{label:Mn.getTabLabel(),active:Mn===gn,href:t.I.getUrlForPartial(It,{inspectTab:Mn.getTabValue()})},Mn.state.key))}),children:[Ke&&(0,u.jsx)(C.F,{title:"Panel plugin not loaded",children:"Make sure the panel you want to inspect is visible and has been displayed before opening inspect."}),gn&&gn.Component&&(0,u.jsx)(gn.Component,{model:gn})]})}var sn=e(19293),Ln=e(10096),Jn=e(22391),gs=e(19347),kn=e(38477);class Gn{constructor(Ae){this._scene=Ae}getKeys(){return["editIndex"]}getUrlState(){const Ae=this._scene.state;return{editIndex:Ae.editIndex!==void 0?String(Ae.editIndex):void 0}}updateFromUrl(Ae){let Ke={};typeof Ae.editIndex=="string"?Ke={editIndex:Number(Ae.editIndex)}:Ke={editIndex:void 0},Object.keys(Ke).length>0&&this._scene.setState(Ke)}}var Gs=e(16817),$s=e(84167),Is=e(77268),pa=e(82241),Ta=e(51612),ua=e(46502);const sr="New annotation",ma=({annotation:Ge,editIndex:Ae,panels:Ke,onUpdate:lt,onBackToList:It,onDelete:Xt})=>{const Yt=(0,St.of)(ar),gn=(0,re.useMemo)(()=>Ge.filter?Ge.filter.exclude?2:1:0,[Ge.filter]),{value:yn}=(0,Gs.A)(()=>(0,gs.l)().get(Ge.datasource),[Ge.datasource]),Mn=(0,gs.l)().getInstanceSettings(Ge.datasource),is=Vs=>{lt({...Ge,name:Vs.currentTarget.value},Ae)},rs=Vs=>{const ka=(0,Jn.p$)(Vs);Ge.datasource?.type!==ka.type?lt({datasource:ka,builtIn:Ge.builtIn,enable:Ge.enable,iconColor:Ge.iconColor,name:Ge.name,hide:Ge.hide,filter:Ge.filter,mappings:Ge.mappings,type:Ge.type},Ae):lt({...Ge,datasource:ka},Ae)},ws=Vs=>{const ka=Vs.currentTarget;lt({...Ge,[ka.name]:ka.type==="checkbox"?ka.checked:ka.value},Ae)},Es=Vs=>{lt({...Ge,iconColor:Vs},Ae)},Sa=Vs=>{let ka=Vs.value===0?void 0:{exclude:Vs.value===2,ids:Ge.filter?.ids??[]};lt({...Ge,filter:ka},Ae)},Na=Vs=>{if(!Array.isArray(Vs))return;const ka={exclude:gn===2,ids:[]};Vs.forEach(qa=>qa.value&&ka.ids.push(qa.value)),lt({...Ge,filter:ka},Ae)},sa=()=>{Xt(Ae),It()},ea=Ge.name===sr,Da=(Vs,ka)=>Vs.label&&ka.label?Vs.label.toLowerCase().localeCompare(ka.label.toLowerCase()):-1,or=(0,re.useMemo)(()=>Ke.filter(Vs=>s.$.panels[Vs.state.pluginId]).map(Vs=>({value:(0,Oe.Cs)(Vs),label:Vs.state.title??`Panel ${(0,Oe.Cs)(Vs)}`,description:Vs.state.description,imgUrl:s.$.panels[Vs.state.pluginId].info.logos.small})).sort(Da)??[],[Ke]);return(0,u.jsxs)("div",{children:[(0,u.jsxs)($s.n,{className:Yt.settingsForm,children:[(0,u.jsx)(A.D,{label:"Name",children:(0,u.jsx)(L.p,{"data-testid":I.Tp.pages.Dashboard.Settings.Annotations.Settings.name,name:"name",id:"name",autoFocus:ea,value:Ge.name,onChange:is})}),(0,u.jsx)(A.D,{label:"Data source",htmlFor:"data-source-picker",children:(0,u.jsx)(Ta.s,{annotations:!0,variables:!0,current:Ge.datasource,onChange:rs})}),!yn?.meta.annotations&&(0,u.jsx)(C.F,{title:"No annotation support for this data source",severity:"error",children:(0,u.jsx)(Zt.x6,{i18nKey:"errors.dashboard-settings.annotations.datasource",children:"The selected data source does not support annotations. Please select a different data source."})}),(0,u.jsx)(A.D,{label:"Enabled",description:"When enabled the annotation query is issued every dashboard refresh",children:(0,u.jsx)(ue.S,{name:"enable",id:"enable",value:Ge.enable,onChange:ws,"data-testid":I.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.enable})}),(0,u.jsx)(A.D,{label:"Hidden",description:"Annotation queries can be toggled on or off at the top of the dashboard. With this option checked this toggle will be hidden.",children:(0,u.jsx)(ue.S,{name:"hide",id:"hide",value:Ge.hide,onChange:ws,"data-testid":I.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.hide})}),(0,u.jsx)(A.D,{label:"Color",description:"Color to use for the annotation event markers",children:(0,u.jsx)(S.B,{children:(0,u.jsx)(Is.a,{value:Ge?.iconColor,onChange:Es})})}),(0,u.jsx)(A.D,{label:"Show in","data-testid":I.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.showInLabel,children:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(Rn.l6,{options:xr,value:gn,onChange:Sa,"data-testid":I.Tp.components.Annotations.annotationsTypeInput}),gn!==0&&(0,u.jsx)(Rn.KF,{options:or,value:or.filter(Vs=>Ge.filter?.ids.includes(Vs.value)),onChange:Na,isClearable:!0,placeholder:"Choose panels",width:100,closeMenuOnSelect:!1,className:Yt.select,"data-testid":I.Tp.components.Annotations.annotationsChoosePanelInput})]})})]}),(0,u.jsxs)($s.n,{children:[(0,u.jsx)("h3",{className:"page-heading",children:"Query"}),yn?.annotations&&Mn&&(0,u.jsx)(pa.A,{datasource:yn,datasourceInstanceSettings:Mn,annotation:Ge,onChange:Vs=>lt(Vs,Ae)}),yn&&!yn.annotations&&(0,u.jsx)(ua.F,{datasource:yn,annotation:Ge,onChange:Vs=>lt(Vs,Ae)})]}),(0,u.jsxs)(S.B,{children:[!Ge.builtIn&&(0,u.jsx)(T.$n,{variant:"destructive",onClick:sa,"data-testid":I.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.delete,children:"Delete"}),(0,u.jsx)(T.$n,{variant:"secondary",onClick:It,"data-testid":I.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.apply,children:"Back to list"})]})]})},ar=Ge=>({settingsForm:(0,Te.css)({maxWidth:Ge.spacing(60),marginBottom:Ge.spacing(2)}),select:(0,Te.css)({marginTop:"8px"})});var Ya=(Ge=>(Ge[Ge.AllPanels=0]="AllPanels",Ge[Ge.IncludePanels=1]="IncludePanels",Ge[Ge.ExcludePanels=2]="ExcludePanels",Ge))(Ya||{});const xr=[{label:"All panels",value:0,description:"Send the annotation data to all panels that support annotations"},{label:"Selected panels",value:1,description:"Send the annotations to the explicitly listed panels"},{label:"All panels except",value:2,description:"Do not send annotation data to the following panels"}];var Sr=e(29158),Yr=e(91605),Hr=e(69529),Rr=e(72109),lo=e(46991);const Bo="Add annotation query",po=({annotations:Ge,onNew:Ae,onEdit:Ke,onMove:lt,onDelete:It})=>{const Xt=(0,St.of)(vr),Yt=Ge.length===0||Ge.length===1&&Ge[0].builtIn,gn=Mn=>Mn.enable===!1?(0,u.jsxs)("em",{className:"muted",children:["(Disabled) \xA0 ",Mn.name]}):Mn.builtIn?(0,u.jsxs)("em",{className:"muted",children:[Mn.name," \xA0 (Built-in)"]}):(0,u.jsx)(u.Fragment,{children:Mn.name}),yn=(0,gs.l)();return(0,u.jsxs)(S.B,{direction:"column",children:[Ge.length>0&&(0,u.jsx)("div",{className:Xt.table,children:(0,u.jsxs)("table",{role:"grid",className:"filter-table filter-table--hover",children:[(0,u.jsx)("thead",{children:(0,u.jsxs)("tr",{children:[(0,u.jsx)("th",{children:"Query name"}),(0,u.jsx)("th",{children:"Data source"}),(0,u.jsx)("th",{colSpan:3})]})}),(0,u.jsx)("tbody",{"data-testid":I.Tp.pages.Dashboard.Settings.Annotations.List.annotations,children:Ge.map((Mn,is)=>(0,u.jsxs)("tr",{children:[Mn.builtIn?(0,u.jsx)("td",{role:"gridcell",style:{width:"90%"},className:"pointer",onClick:()=>Ke(is),children:(0,u.jsx)(T.$n,{size:"sm",fill:"text",variant:"secondary",children:gn(Mn)})}):(0,u.jsx)("td",{role:"gridcell",className:"pointer",onClick:()=>Ke(is),children:(0,u.jsx)(T.$n,{size:"sm",fill:"text",variant:"secondary",children:gn(Mn)})}),(0,u.jsx)("td",{role:"gridcell",className:"pointer",onClick:()=>Ke(is),children:yn.getInstanceSettings(Mn.datasource)?.name||Mn.datasource?.uid}),(0,u.jsx)("td",{role:"gridcell",style:{width:"1%"},children:is!==0&&(0,u.jsx)(Sr.K,{name:"arrow-up",onClick:()=>lt(is,Ur.UP),tooltip:"Move up"})}),(0,u.jsx)("td",{role:"gridcell",style:{width:"1%"},children:Ge.length>1&&is!==Ge.length-1?(0,u.jsx)(Sr.K,{name:"arrow-down",onClick:()=>lt(is,Ur.DOWN),tooltip:"Move down"}):null}),(0,u.jsx)("td",{role:"gridcell",style:{width:"1%"},children:!Mn.builtIn&&(0,u.jsx)(Yr.e,{size:"sm",onConfirm:()=>It(is),"aria-label":`Delete query with title "${Mn.name}"`})})]},`${Mn.name}-${is}`))})]})}),Yt&&(0,u.jsx)(S.B,{direction:"column",children:(0,u.jsxs)(Hr.p,{variant:"call-to-action",button:(0,u.jsx)(T.$n,{"data-testid":I.Tp.components.CallToActionCard.buttonV2("Add annotation query"),icon:"comment-alt",onClick:Ae,size:"lg",children:(0,u.jsx)(Zt.x6,{i18nKey:"annotations.empty-state.button-title",children:"Add annotation query"})}),message:(0,Zt.t)("annotations.empty-state.title","There are no custom annotation queries added yet"),children:[(0,u.jsx)(Zt.x6,{i18nKey:"annotations.empty-state.info-box-content",children:(0,u.jsx)("p",{children:"Annotations provide a way to integrate event data into your graphs. They are visualized as vertical lines and icons on all graph panels. When you hover over an annotation icon you can get event text & tags for the event. You can add annotation events directly from grafana by holding CTRL or CMD + click on graph (or drag region). These will be stored in Grafana's annotation database."})}),(0,u.jsxs)(Zt.x6,{i18nKey:"annotations.empty-state.info-box-content-2",children:["Checkout the"," ",(0,u.jsx)(Rr.Y,{external:!0,href:"http://docs.grafana.org/reference/annotations/",children:"Annotations documentation"})," ","for more information."]})]})}),!Yt&&(0,u.jsx)(lo.d,{"data-testid":I.Tp.pages.Dashboard.Settings.Annotations.List.addAnnotationCTAV2,onClick:Ae,children:"New query"})]})},vr=()=>({table:(0,Te.css)({width:"100%",overflowX:"auto"})});var Ur=(Ge=>(Ge[Ge.UP=-1]="UP",Ge[Ge.DOWN=1]="DOWN",Ge))(Ur||{});class Er extends g.Bs{constructor(){super(...arguments),this._urlSync=new Gn(this),this.getDataSourceRefForAnnotation=()=>{const Ae=(0,gs.l)().getInstanceSettings(null);if(!Ae||!Ae.meta.annotations){console.error("Default datasource does not support annotations");return}return(0,Jn.p$)(Ae)},this.onNew=async()=>{const Ae={name:sr,enable:!0,datasource:this.getDataSourceRefForAnnotation(),iconColor:"red"},Ke=new kn.g({query:Ae,name:Ae.name,isEnabled:!!Ae.enable,isHidden:!!Ae.hide}),lt=Ce.b4.getDataLayers(this._dashboard);lt.addAnnotationLayer(Ke),this.setState({editIndex:lt.state.annotationLayers.length-1})},this.onEdit=Ae=>{this.setState({editIndex:Ae})},this.onBackToList=()=>{this.setState({editIndex:void 0})},this.onMove=(Ae,Ke)=>{const lt=Ce.b4.getDataLayers(this._dashboard),It=[...lt.state.annotationLayers],[Xt]=It.splice(Ae,1);It.splice(Ae+Ke,0,Xt),lt.setState({annotationLayers:It})},this.onDelete=Ae=>{const Ke=Ce.b4.getDataLayers(this._dashboard),lt=[...Ke.state.annotationLayers];lt.splice(Ae,1),Ke.setState({annotationLayers:lt})},this.onUpdate=(Ae,Ke)=>{const lt=this.getDataLayer(Ke);lt.setState({name:Ae.name,isEnabled:!!Ae.enable,isHidden:!!Ae.hide,query:Ae}),lt.runLayer()}}static{this.Component=Qo}getUrlKey(){return"annotations"}get _dashboard(){return(0,Oe.YQ)(this)}getDataLayer(Ae){const lt=Ce.b4.getDataLayers(this._dashboard).state.annotationLayers[Ae];if(!(lt instanceof g.tV.g))throw new Error("AnnotationsDataLayer not found at index "+Ae);return lt}getDashboard(){return this._dashboard}}function Qo({model:Ge}){const Ae=Ge.getDashboard(),{annotationLayers:Ke}=Ce.b4.getDataLayers(Ae).useState(),{navModel:lt,pageNav:It}=mo(Ae,Ge.getUrlKey()),{editIndex:Xt}=Ge.useState(),Yt=Ce.b4.getVizPanels(Ae),gn=(0,Se.O)(Ke);return Xt!=null&&Xt<Ke.length?(0,u.jsx)(Eo,{annotationLayer:Ge.getDataLayer(Xt),pageNav:It,panels:Yt,editIndex:Xt,navModel:lt,dashboard:Ae,onUpdate:Ge.onUpdate,onBackToList:Ge.onBackToList,onDelete:Ge.onDelete}):(0,u.jsxs)(Nt.Y,{navModel:lt,pageNav:It,layout:xt.k.Standard,children:[(0,u.jsx)(Je.c,{dashboard:Ae}),(0,u.jsx)(po,{annotations:gn,onNew:Ge.onNew,onEdit:Ge.onEdit,onDelete:Ge.onDelete,onMove:Ge.onMove})]})}function Eo({annotationLayer:Ge,pageNav:Ae,navModel:Ke,panels:lt,editIndex:It,dashboard:Xt,onUpdate:Yt,onBackToList:gn,onDelete:yn}){const{name:Mn,query:is}=Ge.useState(),rs={text:Mn,parentItem:Ae};return(0,u.jsxs)(Nt.Y,{navModel:Ke,pageNav:rs,layout:xt.k.Standard,children:[(0,u.jsx)(Je.c,{dashboard:Xt}),(0,u.jsx)(ma,{annotation:is,editIndex:It,panels:lt,onUpdate:Yt,onBackToList:gn,onDelete:yn})]})}var Lt=e(14588),Ht=e(65857),on=e(6199),vn=e(4588);class Un extends g.Bs{constructor(){super(...arguments),this._urlSync=new Gn(this),this.onNewLink=()=>{this.links=[...this.links,vn.q],this.setState({editIndex:this.links.length-1})},this.onDelete=Ae=>{this.links=[...this.links.slice(0,Ae),...this.links.slice(Ae+1)],this.setState({editIndex:void 0})},this.onDuplicate=Ae=>{this.links=[...this.links,{...Ae}]},this.onOrderChange=(Ae,Ke)=>{this.links=Lt.moveItemImmutably(this.links,Ae,Ae+Ke)},this.onEdit=Ae=>{this.setState({editIndex:Ae})},this.onUpdateLink=Ae=>{const Ke=this.state.editIndex;Ke!==void 0&&(this.links=[...this.links.slice(0,Ke),Ae,...this.links.slice(Ke+1)])},this.onGoBack=()=>{this.setState({editIndex:void 0})}}static{this.Component=cs}getUrlKey(){return"links"}get dashboard(){return(0,Oe.YQ)(this)}get links(){return this.dashboard.state.links}set links(Ae){this.dashboard.setState({links:Ae})}}function cs({model:Ge}){const{editIndex:Ae}=Ge.useState(),Ke=(0,Oe.YQ)(Ge),{links:lt}=Ke.useState(),{navModel:It,pageNav:Xt}=mo(Ke,Ge.getUrlKey()),Yt=Ae!==void 0?lt[Ae]:void 0;return Yt?(0,u.jsx)(os,{pageNav:Xt,navModel:It,link:Yt,dashboard:Ke,onChange:Ge.onUpdateLink,onGoBack:Ge.onGoBack}):(0,u.jsxs)(Nt.Y,{navModel:It,pageNav:Xt,layout:xt.k.Standard,children:[(0,u.jsx)(Je.c,{dashboard:Ke}),(0,u.jsx)(on.X,{links:lt,onNew:Ge.onNewLink,onEdit:Ge.onEdit,onDelete:Ge.onDelete,onDuplicate:Ge.onDuplicate,onOrderChange:Ge.onOrderChange})]})}function os({pageNav:Ge,link:Ae,navModel:Ke,dashboard:lt,onChange:It,onGoBack:Xt}){const Yt={text:"Edit link",parentItem:Ge};return(0,u.jsxs)(Nt.Y,{navModel:Ke,pageNav:Yt,layout:xt.k.Standard,children:[(0,u.jsx)(Je.c,{dashboard:lt}),(0,u.jsx)(Ht.d,{link:Ae,onUpdate:It,onGoBack:Xt})]})}var Js=e(79924),Ss=e(94354),Ra=e(57418),Oa=e(75590),ss=e(81394),Ia=e(27966),Cr=e(77431),Dr=e(42941),dr=e(96374),ur=e(37390);function Oo({dashboard:Ge}){const[Ae,Ke]=(0,Dr.A)(!1);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(T.$n,{variant:"destructive",onClick:Ke,"data-testid":I.Tp.pages.Dashboard.Settings.General.deleteDashBoard,children:(0,u.jsx)(Zt.x6,{i18nKey:"dashboard-settings.dashboard-delete-button",children:"Delete dashboard"})}),Ae&&(0,u.jsx)(Io,{dashboard:Ge,onClose:Ke})]})}function Io({dashboard:Ge,onClose:Ae}){const[,Ke]=(0,ae.A)(async()=>{(0,j.rR)("grafana_manage_dashboards_delete_clicked",{item_counts:{dashboard:1},source:"dashboard_scene_settings",restore_enabled:s.$.featureToggles.dashboardRestoreUI}),Ae(),await Ge.deleteDashboard()},[Ge,Ae]);return Ge.state.meta.provisioned?(0,u.jsx)(za,{dashboard:Ge,onClose:Ae}):(0,u.jsx)(dr.u,{isOpen:!0,body:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("p",{children:"Do you want to delete this dashboard?"}),(0,u.jsx)("p",{children:Ge.state.title})]}),onConfirm:Ke,onDismiss:Ae,title:"Delete",icon:"trash-alt",confirmText:"Delete"})}function za({dashboard:Ge,onClose:Ae}){return(0,u.jsxs)(ur.a,{isOpen:!0,title:"Cannot delete provisioned dashboard",icon:"trash-alt",onDismiss:Ae,children:[(0,u.jsx)("p",{children:"This dashboard is managed by Grafana provisioning and cannot be deleted. Remove the dashboard from the config file to delete it."}),(0,u.jsxs)("p",{children:[(0,u.jsxs)("i",{children:["See"," ",(0,u.jsx)("a",{className:"external-link",href:"https://grafana.com/docs/grafana/latest/administration/provisioning/#dashboards",target:"_blank",rel:"noreferrer",children:"documentation"})," ","for more information about provisioning."]}),(0,u.jsx)("br",{}),"File path: ",Ge.state.meta.provisionedExternalId]}),(0,u.jsx)(ur.a.ButtonRow,{children:(0,u.jsx)(T.$n,{variant:"primary",onClick:Ae,children:"OK"})})]})}const Do=[{label:"Editable",value:!0},{label:"Read-only",value:!1}],Ca=[{value:0,label:"Default"},{value:1,label:"Shared crosshair"},{value:2,label:"Shared Tooltip"}];class Aa extends g.Bs{constructor(){super(...arguments),this.onTitleChange=Ae=>{this._dashboard.setState({title:Ae})},this.onDescriptionChange=Ae=>{this._dashboard.setState({description:Ae})},this.onTagsChange=Ae=>{this._dashboard.setState({tags:Ae})},this.onFolderChange=async(Ae,Ke)=>{const lt={...this._dashboard.state.meta,folderUid:Ae||this._dashboard.state.meta.folderUid,folderTitle:Ke||this._dashboard.state.meta.folderTitle};lt.folderUid&&await(0,Cr.Q)(lt.folderUid),this._dashboard.setState({meta:lt})},this.onEditableChange=Ae=>{this._dashboard.setState({editable:Ae})},this.onTimeZoneChange=Ae=>{this.getTimeRange().setState({timeZone:Ae})},this.onWeekStartChange=Ae=>{this.getTimeRange().setState({weekStart:Ae})},this.onRefreshIntervalChange=Ae=>{this.getRefreshPicker()?.setState({intervals:Ae})},this.onNowDelayChange=Ae=>{this.getTimeRange()?.setState({UNSAFE_nowDelay:Ae})},this.onHideTimePickerChange=Ae=>{this.getDashboardControls()?.setState({hideTimeControls:Ae})},this.onLiveNowChange=Ae=>{try{const Ke=this.getLiveNowTimer();Ae?Ke.enable():Ke.disable()}catch(Ke){console.error(Ke)}},this.onTooltipChange=Ae=>{this.getCursorSync()?.setState({sync:Ae})},this.onPreloadChange=Ae=>{this._dashboard.setState({preload:Ae})},this.onDeleteDashboard=()=>{}}get _dashboard(){return(0,Oe.YQ)(this)}getUrlKey(){return"settings"}getDashboard(){return this._dashboard}getTimeRange(){return g.jh.getTimeRange(this._dashboard)}getRefreshPicker(){return this.getDashboardControls().state.refreshPicker}getCursorSync(){return Ce.b4.getCursorSync(this._dashboard)}getLiveNowTimer(){const Ae=g.jh.findObject(this._dashboard,Ke=>Ke instanceof g.Gg.en);if(Ae instanceof g.Gg.en)return Ae;throw new Error("LiveNowTimer could not be found")}getDashboardControls(){return this._dashboard.state.controls}static{this.Component=({model:Ae})=>{const Ke=Ae.getDashboard(),{navModel:lt,pageNav:It}=mo(Ke,Ae.getUrlKey()),{title:Xt,description:Yt,tags:gn,meta:yn,editable:Mn}=Ke.useState(),{sync:is}=Ae.getCursorSync()?.useState()||{},{timeZone:rs,weekStart:ws,UNSAFE_nowDelay:Es}=Ae.getTimeRange().useState(),{intervals:Sa}=Ae.getRefreshPicker().useState(),{hideTimeControls:Na}=Ae.getDashboardControls().useState(),{enabled:sa}=Ae.getLiveNowTimer().useState();return(0,u.jsxs)(Nt.Y,{navModel:lt,pageNav:It,layout:xt.k.Standard,children:[(0,u.jsx)(Je.c,{dashboard:Ke}),(0,u.jsxs)("div",{style:{maxWidth:"600px"},children:[(0,u.jsxs)(w.a,{marginBottom:5,children:[(0,u.jsx)(A.D,{label:(0,u.jsxs)(S.B,{justifyContent:"space-between",children:[(0,u.jsx)(B.J,{htmlFor:"title-input",children:(0,u.jsx)(Zt.x6,{i18nKey:"dashboard-settings.general.title-label",children:"Title"})}),s.$.featureToggles.dashgpt&&(0,u.jsx)(Ia.Z,{onGenerate:ea=>Ae.onTitleChange(ea)})]}),children:(0,u.jsx)(L.p,{id:"title-input",name:"title",value:Xt,onChange:ea=>Ae.onTitleChange(ea.target.value)})}),(0,u.jsx)(A.D,{label:(0,u.jsxs)(S.B,{justifyContent:"space-between",children:[(0,u.jsx)(B.J,{htmlFor:"description-input",children:(0,Zt.t)("dashboard-settings.general.description-label","Description")}),s.$.featureToggles.dashgpt&&(0,u.jsx)(ss.V,{onGenerate:ea=>Ae.onDescriptionChange(ea)})]}),children:(0,u.jsx)(N.f,{id:"description-input",name:"description",value:Yt,onChange:ea=>Ae.onDescriptionChange(ea.target.value)})}),(0,u.jsx)(A.D,{label:(0,Zt.t)("dashboard-settings.general.tags-label","Tags"),children:(0,u.jsx)(Js.u,{id:"tags-input",tags:gn,onChange:Ae.onTagsChange,width:40})}),(0,u.jsx)(A.D,{label:(0,Zt.t)("dashboard-settings.general.folder-label","Folder"),children:(0,u.jsx)(U.d,{value:yn.folderUid,onChange:Ae.onFolderChange,initialTitle:yn.folderTitle,inputId:"dashboard-folder-input",enableCreateNew:!0,skipInitialLoad:!0})}),(0,u.jsx)(A.D,{label:(0,Zt.t)("dashboard-settings.general.editable-label","Editable"),description:(0,Zt.t)("dashboard-settings.general.editable-description","Set to read-only to disable all editing. Reload the dashboard for changes to take effect"),children:(0,u.jsx)(Ss.z,{value:Mn,options:Do,onChange:Ae.onEditableChange})})]}),(0,u.jsx)(Oa.p,{onTimeZoneChange:Ae.onTimeZoneChange,onWeekStartChange:Ae.onWeekStartChange,onRefreshIntervalChange:Ae.onRefreshIntervalChange,onNowDelayChange:Ae.onNowDelayChange,onHideTimePickerChange:Ae.onHideTimePickerChange,onLiveNowChange:Ae.onLiveNowChange,refreshIntervals:Sa,timePickerHidden:Na,nowDelay:Es||"",liveNow:sa,timezone:rs||"",weekStart:ws||""}),(0,u.jsxs)(Ra.M,{label:(0,Zt.t)("dashboard-settings.general.panel-options-label","Panel options"),isOpen:!0,children:[(0,u.jsx)(A.D,{label:(0,Zt.t)("dashboard-settings.general.panel-options-graph-tooltip-label","Graph tooltip"),description:(0,Zt.t)("dashboard-settings.general.panel-options-graph-tooltip-description","Controls tooltip and hover highlight behavior across different panels. Reload the dashboard for changes to take effect"),children:(0,u.jsx)(Ss.z,{onChange:Ae.onTooltipChange,options:Ca,value:is})}),(0,u.jsx)(A.D,{label:(0,Zt.t)("dashboard-settings.general.panels-preload-label","Preload panels"),description:(0,Zt.t)("dashboard-settings.general.panels-preload-description","When enabled all panels will start loading as soon as the dashboard has been loaded."),children:(0,u.jsx)(F.d,{id:"preload-panels-dashboards-toggle",value:Ke.state.preload,onChange:ea=>Ae.onPreloadChange(ea.currentTarget.checked)})})]}),(0,u.jsx)(w.a,{marginTop:3,children:yn.canDelete&&(0,u.jsx)(Oo,{dashboard:Ke})})]})]})}}}class hr extends g.Bs{constructor(Ae){super({...Ae,jsonText:""}),this.onCodeEditorBlur=Ke=>{this.setState({jsonText:Ke})},this.onSaveSuccess=Ke=>{const lt=JSON.parse(this.state.jsonText),It=this.getDashboard();lt.version=Ke.version;const Xt={dashboard:lt,meta:It.state.meta},Yt=(0,vt.wM)(Xt),gn=g.Go.cloneSceneObjectState(Yt.state);It.pauseTrackingChanges(),It.setInitialSaveModel(Xt.dashboard),It.setState(gn),this.setState({jsonText:this.getJsonText()})},this.addActivationHandler(()=>this.setState({jsonText:this.getJsonText()}))}getUrlKey(){return"json-model"}getDashboard(){return(0,Oe.YQ)(this)}getSaveModel(){const Ae=this.getDashboard();return(0,$e.Uy)(Ae)}getJsonText(){const Ae=this.getSaveModel();return(0,ys.p)(Ae)}static{this.Component=({model:Ae})=>{const{state:Ke,onSaveDashboard:lt}=se(!1),[It,Xt]=(0,re.useState)(!1),Yt=Ae.getDashboard(),{navModel:gn,pageNav:yn}=mo(Yt,Ae.getUrlKey()),Mn=Yt.useState().meta.canSave,{jsonText:is}=Ae.useState(),rs=async sa=>{const ea=await lt(Yt,JSON.parse(Ae.state.jsonText),{folderUid:Yt.state.meta.folderUid,overwrite:sa});Xt(!0),ea.status==="success"?(Ae.onSaveSuccess(ea),Xt(!1)):Xt(!0)},ws=sa=>(0,u.jsx)(T.$n,{type:"submit",onClick:()=>{rs(sa)},variant:sa?"destructive":"primary",children:sa?"Save and overwrite":(0,u.jsx)(Zt.x6,{i18nKey:"dashboard-settings.json-editor.save-button",children:"Save changes"})}),Es=(0,u.jsx)(T.$n,{variant:"secondary",onClick:()=>Xt(!1),fill:"outline",children:"Cancel"}),Sa=(0,St.of)(Ma);function Na(sa){if(sa&&It){if(H(sa))return(0,u.jsxs)(C.F,{title:"Someone else has updated this dashboard",severity:"error",children:[(0,u.jsx)("p",{children:"Would you still like to save this dashboard?"}),(0,u.jsx)(w.a,{paddingTop:2,children:(0,u.jsxs)(S.B,{alignItems:"center",children:[Es,ws(!0)]})})]});if(Y(sa))return(0,u.jsx)(J,{saveButton:ws,cancelButton:Es});if(X(sa))return(0,u.jsxs)(C.F,{title:"Plugin dashboard",severity:"error",children:[(0,u.jsxs)("p",{children:["Your changes will be lost when you update the plugin. Use ",(0,u.jsx)("strong",{children:"Save As"})," to create custom version."]}),(0,u.jsx)(w.a,{paddingTop:2,children:(0,u.jsx)(S.B,{alignItems:"center",children:ws(!0)})})]})}return(0,u.jsxs)(u.Fragment,{children:[sa&&It&&(0,u.jsx)(C.F,{title:"Failed to save dashboard",severity:"error",children:(0,u.jsx)("p",{children:sa.message})}),(0,u.jsx)(S.B,{alignItems:"center",children:ws(!1)})]})}return(0,u.jsxs)(Nt.Y,{navModel:gn,pageNav:yn,layout:xt.k.Standard,children:[(0,u.jsx)(Je.c,{dashboard:Yt}),(0,u.jsxs)("div",{className:Sa.wrapper,children:[(0,u.jsx)(Zt.x6,{i18nKey:"dashboard-settings.json-editor.subtitle",children:"The JSON model below is the data structure that defines the dashboard. This includes dashboard settings, panel settings, layout, queries, and so on."}),(0,u.jsx)(Ze.B,{width:"100%",value:is,language:"json",showLineNumbers:!0,showMiniMap:!0,containerStyles:Sa.codeEditor,onBlur:Ae.onCodeEditorBlur}),Mn&&(0,u.jsx)(w.a,{paddingTop:2,children:Na(Ke.error)})]})]})}}}const Ma=Ge=>({wrapper:(0,Te.css)({display:"flex",height:"100%",flexDirection:"column",gap:Ge.spacing(2)}),codeEditor:(0,Te.css)({flexGrow:1})});var ho=e(5108);class Uo extends g.Bs{static{this.Component=No}get _dashboard(){return(0,Oe.YQ)(this)}getUrlKey(){return"permissions"}getDashboard(){return this._dashboard}}function No({model:Ge}){const Ae=Ge.getDashboard(),{uid:Ke}=Ae.useState(),{navModel:lt,pageNav:It}=mo(Ae,Ge.getUrlKey()),Xt=Ln.TP.hasPermission(z.AccessControlAction.DashboardsPermissionsWrite);return(0,u.jsxs)(Nt.Y,{navModel:lt,pageNav:It,layout:xt.k.Standard,children:[(0,u.jsx)(Je.c,{dashboard:Ae}),(0,u.jsx)(ho.x,{resource:"dashboards",resourceId:Ke??"",canSetPermissions:Xt})]})}var Mi=e(75505),ri=e(79422),wo=e(71678),oi=e(39558),cl=e(8964),Lr=e(58975),Vi=e(85140),Si=e(14329),Tr=e(41820),ii=e(85830),Yo=e(89458),kr=e(17663);function _i({onChange:Ge,type:Ae}){const Ke=(0,re.useMemo)(()=>(0,kr.B$)(),[]),lt=(0,re.useMemo)(()=>Ke.find(It=>It.value===Ae)??Ke[0],[Ke,Ae]);return(0,u.jsx)(Yo.v,{name:"Select variable type",value:lt,options:Ke,onChange:Ge,testId:I.Tp.pages.Dashboard.Settings.Variables.Edit.General.generalTypeSelectV2})}function zi({variable:Ge,onTypeChange:Ae,onGoBack:Ke,onDelete:lt,onValidateVariableName:It}){const Xt=(0,St.of)(Po),[Yt,gn]=(0,re.useState)(null),{name:yn,type:Mn,label:is,description:rs,hide:ws,key:Es}=Ge.useState(),Sa=(0,kr.bZ)(Mn)?(0,kr.CD)(Mn):void 0,[Na,sa]=(0,ae.A)(async()=>{await(0,Mi.s)(Ge.validateAndUpdate())},[Ge]),ea=Or=>{Or.value&&Ae(Or.value)},Da=(0,re.useCallback)(Or=>{const[,Ui]=It(Or.currentTarget.value,Es);Yt!==Ui&&gn(Ui)},[Es,Yt,It]),or=Or=>{Yt||Ge.setState({name:Or.currentTarget.value})},Vs=Or=>Ge.setState({label:Or.currentTarget.value}),ka=Or=>Ge.setState({description:Or.currentTarget.value}),qa=Or=>Ge.setState({hide:Or}),Bi=(0,kr.n_)(Ge),Vr=Or=>()=>{(0,j.rR)("Delete variable"),lt(yn),Or()};return(0,u.jsxs)("form",{"aria-label":"Variable editor Form",children:[(0,u.jsx)(_i,{onChange:ea,type:Mn}),(0,u.jsx)(Lr.Y,{children:"General"}),(0,u.jsx)(Si._,{name:"Name",description:"The name of the template variable. (Max. 50 characters)",placeholder:"Variable name",defaultValue:yn??"",onChange:Da,onBlur:or,testId:I.Tp.pages.Dashboard.Settings.Variables.Edit.General.generalNameInputV2,maxLength:ii.M.MaxSize,required:!0,invalid:!!Yt,error:Yt}),(0,u.jsx)(Si._,{name:"Label",description:"Optional display name",placeholder:"Label name",defaultValue:is??"",onBlur:Vs,testId:I.Tp.pages.Dashboard.Settings.Variables.Edit.General.generalLabelInputV2}),(0,u.jsx)(Vi.Z,{name:"Description",defaultValue:rs??"",placeholder:"Descriptive text",onBlur:ka,width:52}),(0,u.jsx)(cl.D,{onChange:qa,hide:ws||ri.rw.hide,type:Mn}),Sa&&(0,u.jsx)(Sa,{variable:Ge,onRunQuery:sa}),Bi&&(0,u.jsx)(Tr.j,{options:Ge.getOptionsForSelect()}),(0,u.jsx)("div",{className:Xt.buttonContainer,children:(0,u.jsxs)(S.B,{gap:2,children:[(0,u.jsx)(wo.$s,{children:({showModal:Or,hideModal:Ui})=>(0,u.jsx)(T.$n,{variant:"destructive",fill:"outline",onClick:()=>{Or(dr.u,{title:"Delete variable",body:`Are you sure you want to delete: ${yn}?`,confirmText:"Delete variable",onConfirm:Vr(Ui),onDismiss:Ui,isOpen:!0})},children:"Delete"})}),(0,u.jsx)(T.$n,{variant:"secondary","data-testid":I.Tp.pages.Dashboard.Settings.Variables.Edit.General.applyButton,onClick:Ke,children:"Back to list"}),Bi&&(0,u.jsx)(T.$n,{disabled:Na.loading,variant:"secondary","data-testid":I.Tp.pages.Dashboard.Settings.Variables.Edit.General.submitButton,onClick:sa,children:Na.loading?(0,u.jsx)(oi._,{className:Xt.loadingPlaceHolder,text:"Running query..."}):"Run query"})]})})]})}const Po=Ge=>({buttonContainer:(0,Te.css)({marginTop:Ge.spacing(2)}),loadingPlaceHolder:(0,Te.css)({marginBottom:0})});var fo=e(91076),rr=e(2223);function li(Ge){return Ge.map(Ae=>({id:Ae.state.name,label:`${Ae.state.name}`}))}function dl(Ge,Ae){return Ge.filter(Ke=>Ae.some(lt=>lt.from===Ke.id||lt.to===Ke.id))}const Hi=Ge=>{const Ae=[];for(const Ke of Ge)for(const lt of Ge){if(Ke===lt)continue;Ke.variableDependency?.hasDependencyOn(lt.state.name)&&Ae.push({from:Ke.state.name,to:lt.state.name})}return Ae},ul=({variables:Ge})=>{const Ae=(0,re.useMemo)(()=>li(Ge),[Ge]),Ke=(0,re.useMemo)(()=>Hi(Ge),[Ge]);return Ke.length?(0,u.jsx)(rr.i,{show:!1,title:(0,Zt.t)("dashboards.settings.variables.dependencies.title","Dependencies"),nodes:dl(Ae,Ke),edges:Ke,children:({showModal:lt})=>(0,u.jsx)(T.$n,{onClick:()=>{(0,j.rR)("Show variable dependencies"),lt()},icon:"channel-add",variant:"secondary",children:(0,u.jsx)(Zt.x6,{i18nKey:"dashboards.settings.variables.dependencies.button",children:"Show dependencies"})})}):null};function ki({index:Ge,variable:Ae,onEdit:Ke,onDuplicate:lt,onDelete:It}){const Xt=(0,St.$j)(),Yt=(0,St.of)(hl),gn=(0,kr.Ao)(Ae),yn=Ae.state,Mn=yn.name,[is,rs]=(0,re.useState)(!1),ws=Sa=>()=>{rs(Sa)},Es=()=>{(0,j.rR)("Delete variable"),It(Mn)};return(0,u.jsx)(fo.sx,{draggableId:JSON.stringify(Mn),index:Ge,children:(Sa,Na)=>(0,u.jsxs)("tr",{ref:Sa.innerRef,...Sa.draggableProps,style:{userSelect:Na.isDragging?"none":"auto",background:Na.isDragging?Xt.colors.background.secondary:void 0,...Sa.draggableProps.style},children:[(0,u.jsx)("td",{role:"gridcell",className:Yt.column,children:(0,u.jsx)(T.$n,{size:"xs",fill:"text",onClick:sa=>{sa.preventDefault(),Ke(Mn)},className:Yt.nameLink,"data-testid":I.Tp.pages.Dashboard.Settings.Variables.List.tableRowNameFields(yn.name),children:yn.name})}),(0,u.jsx)("td",{role:"gridcell",className:Yt.definitionColumn,onClick:sa=>{sa.preventDefault(),Ke(Mn)},"data-testid":I.Tp.pages.Dashboard.Settings.Variables.List.tableRowDefinitionFields(yn.name),children:gn}),(0,u.jsx)("td",{role:"gridcell",className:Yt.column,children:(0,u.jsxs)("div",{className:Yt.icons,children:[(0,u.jsx)(Sr.K,{onClick:sa=>{sa.preventDefault(),(0,j.rR)("Duplicate variable"),lt(Mn)},name:"copy",tooltip:"Duplicate variable","data-testid":I.Tp.pages.Dashboard.Settings.Variables.List.tableRowDuplicateButtons(yn.name)}),(0,u.jsx)(Sr.K,{onClick:sa=>{sa.preventDefault(),rs(!0)},name:"trash-alt",tooltip:"Remove variable","data-testid":I.Tp.pages.Dashboard.Settings.Variables.List.tableRowRemoveButtons(yn.name)}),(0,u.jsx)(dr.u,{isOpen:is,title:"Delete variable",body:`Are you sure you want to delete: ${yn.name}?`,confirmText:"Delete variable",onConfirm:Es,onDismiss:ws(!1)}),(0,u.jsx)("div",{...Sa.dragHandleProps,className:Yt.dragHandle,children:(0,u.jsx)(Pn.I,{name:"draggabledots",size:"lg"})})]})})]})})}function hl(Ge){return{dragHandle:(0,Te.css)({cursor:"grab",marginLeft:Ge.spacing(1)}),column:(0,Te.css)({width:"1%"}),nameLink:(0,Te.css)({cursor:"pointer",color:Ge.colors.primary.text}),definitionColumn:(0,Te.css)({width:"100%",maxWidth:"200px",cursor:"pointer",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}),iconPassed:(0,Te.css)({color:Ge.v1.palette.greenBase,marginRight:Ge.spacing(2)}),iconFailed:(0,Te.css)({color:Ge.v1.palette.orange,marginRight:Ge.spacing(2)}),icons:(0,Te.css)({display:"flex",gap:Ge.spacing(2),alignItems:"center"})}}function Gi({variables:Ge,onChangeOrder:Ae,onDelete:Ke,onDuplicate:lt,onAdd:It,onEdit:Xt}){const Yt=(0,St.of)(Qi),gn=yn=>{!yn.destination||!yn.source||((0,j.rR)("Variable drag and drop"),Ae(yn.source.index,yn.destination.index))};return(0,u.jsx)("div",{children:(0,u.jsxs)("div",{children:[Ge.length===0&&(0,u.jsx)(fl,{onAdd:It}),Ge.length>0&&(0,u.jsxs)(S.B,{direction:"column",gap:3,children:[(0,u.jsx)("div",{className:Yt.tableContainer,children:(0,u.jsxs)("table",{className:"filter-table filter-table--hover","data-testid":I.Tp.pages.Dashboard.Settings.Variables.List.table,role:"grid",children:[(0,u.jsx)("thead",{children:(0,u.jsxs)("tr",{children:[(0,u.jsx)("th",{children:"Variable"}),(0,u.jsx)("th",{children:"Definition"}),(0,u.jsx)("th",{colSpan:5})]})}),(0,u.jsx)(fo.JY,{onDragEnd:gn,children:(0,u.jsx)(fo.gL,{droppableId:"variables-list",direction:"vertical",children:yn=>(0,u.jsxs)("tbody",{ref:yn.innerRef,...yn.droppableProps,children:[Ge.map((Mn,is)=>{const rs=Mn.state;return(0,u.jsx)(ki,{index:is,variable:Mn,onDelete:Ke,onDuplicate:lt,onEdit:Xt},`${rs.name}-${is}`)}),yn.placeholder]})})})]})}),(0,u.jsxs)(S.B,{children:[(0,u.jsx)(ul,{variables:Ge}),(0,u.jsx)(T.$n,{"data-testid":I.Tp.pages.Dashboard.Settings.Variables.List.newButton,onClick:It,icon:"plus",children:"New variable"})]})]})]})})}function fl({onAdd:Ge}){return(0,u.jsx)(S.B,{direction:"column",children:(0,u.jsxs)(Hr.p,{variant:"call-to-action",button:(0,u.jsx)(T.$n,{"data-testid":I.Tp.components.CallToActionCard.buttonV2("Add variable"),icon:"calculator-alt",onClick:Ge,size:"lg",children:(0,u.jsx)(Zt.x6,{i18nKey:"variables.empty-state.button-title",children:"Add variable"})}),message:(0,Zt.t)("variables.empty-state.title","There are no variables added yet"),children:[(0,u.jsx)("p",{children:(0,u.jsx)(Zt.x6,{i18nKey:"variables.empty-state.info-box-content",children:"Variables enable more interactive and dynamic dashboards. Instead of hard-coding things like server or sensor names in your metric queries you can use variables in their place. Variables are shown as list boxes at the top of the dashboard. These drop-down lists make it easy to change the data being displayed in your dashboard."})}),(0,u.jsxs)(Zt.x6,{i18nKey:"variables.empty-state.info-box-content-2",children:["Check out the"," ",(0,u.jsx)(Rr.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/variables/",children:"Templates and variables documentation"})," ","for more information."]})]})})}const Qi=()=>({tableContainer:(0,Te.css)({overflow:"scroll",width:"100%"})});class Yi extends g.Bs{constructor(){super(...arguments),this._urlSync=new Gn(this),this.getVariableIndex=Ae=>this.getVariables().findIndex(lt=>lt.state.name===Ae),this.replaceEditVariable=Ae=>{const Ke=this.state.editIndex??-1,{variables:lt}=this.getVariableSet().state;if(!lt[Ke]){console.error("Variable not found");return}const Xt=[...lt.slice(0,Ke),Ae,...lt.slice(Ke+1)];this.getVariableSet().setState({variables:Xt})},this.onDelete=Ae=>{const Ke=this.getVariableIndex(Ae),{variables:lt}=this.getVariableSet().state;if(Ke===-1){console.error("Variable not found");return}const It=[...lt.slice(0,Ke),...lt.slice(Ke+1)];this.getVariableSet().setState({variables:It}),this.setState({editIndex:void 0})},this.onDuplicated=Ae=>{const Ke=this.getVariableIndex(Ae),lt=this.getVariableSet().state.variables;if(Ke===-1){console.error("Variable not found");return}const It=lt[Ke];let Xt=0,Yt=`copy_of_${It.state.name}`;for(;lt.some(Mn=>Mn.state.name===Yt);)Xt++,Yt=`copy_of_${It.state.name}_${Xt}`;const gn=It.clone(It.state);gn.setState({name:Yt});const yn=[...lt.slice(0,Ke+1),gn,...lt.slice(Ke+1)];this.getVariableSet().setState({variables:yn})},this.onOrderChanged=(Ae,Ke)=>{const lt=this.getVariableSet().state.variables;if(!this.getVariableSet())return;if(Ae<0||Ae>=lt.length||Ke<0||Ke>=lt.length){console.error("Invalid index");return}const It=[...lt],Xt=It.splice(Ae,1);It.splice(Ke,0,Xt[0]),this.getVariableSet().setState({variables:It})},this.onEdit=Ae=>{const Ke=this.getVariableIndex(Ae);if(Ke===-1){console.error("Variable not found");return}this.setState({editIndex:Ke})},this.onAdd=()=>{const Ae=this.getVariables(),Ke=Ae.length,lt=(0,kr.kh)(Ae);this.getVariableSet().setState({variables:[...this.getVariables(),lt]}),this.setState({editIndex:Ke})},this.onTypeChange=Ae=>{const Ke=this.state.editIndex??-1,{variables:lt}=this.getVariableSet().state,It=lt[Ke];if(!It){console.error("Variable not found");return}const{name:Xt,label:Yt}=It.state,gn=(0,kr.No)(Ae,{name:Xt,label:Yt});this.replaceEditVariable(gn)},this.onGoBack=()=>{this.setState({editIndex:void 0})},this.onValidateVariableName=(Ae,Ke)=>{let lt=null;kr.cH.test(Ae)||(lt="Template names cannot begin with '__', that's reserved for Grafana's global variables"),kr.mJ.test(Ae)||(lt="Only word characters are allowed in variable names");const It=this.getVariableSet().getByName(Ae)?.state;return It&&It.key!==Ke&&(lt="Variable with the same name already exists"),lt?[!0,lt]:[!1,null]}}static{this.Component=Wo}getUrlKey(){return"variables"}getDashboard(){return(0,Oe.YQ)(this)}getVariableSet(){return g.jh.getVariables(this.getDashboard())}getVariables(){return this.getVariableSet().state.variables}}function Wo({model:Ge}){const Ae=Ge.getDashboard(),{navModel:Ke,pageNav:lt}=mo(Ae,Ge.getUrlKey()),{onDelete:It,onDuplicated:Xt,onOrderChanged:Yt,onEdit:gn,onTypeChange:yn,onGoBack:Mn,onAdd:is}=Ge,{variables:rs}=Ge.getVariableSet().useState(),{editIndex:ws}=Ge.useState();if(ws!==void 0&&rs[ws]){const Es=rs[ws];if(Es)return(0,u.jsx)(Fo,{variable:Es,onTypeChange:yn,onGoBack:Mn,pageNav:lt,navModel:Ke,dashboard:Ae,onDelete:It,onValidateVariableName:Ge.onValidateVariableName})}return(0,u.jsxs)(Nt.Y,{navModel:Ke,pageNav:lt,layout:xt.k.Standard,children:[(0,u.jsx)(Je.c,{dashboard:Ae}),(0,u.jsx)(Gi,{variables:rs,onDelete:It,onDuplicate:Xt,onChangeOrder:Yt,onAdd:is,onEdit:gn})]})}function Fo({variable:Ge,pageNav:Ae,navModel:Ke,dashboard:lt,onTypeChange:It,onGoBack:Xt,onDelete:Yt,onValidateVariableName:gn}){const{name:yn}=Ge.useState(),Mn={text:yn,parentItem:Ae};return(0,u.jsxs)(Nt.Y,{navModel:Ke,pageNav:Mn,layout:xt.k.Standard,children:[(0,u.jsx)(Je.c,{dashboard:lt}),(0,u.jsx)(zi,{variable:Ge,onTypeChange:It,onGoBack:Xt,onDelete:Yt,onValidateVariableName:gn},Ge.state.key)]})}const bo=10;class ci extends g.Bs{constructor(Ae){super({...Ae,versions:[],isLoading:!0,isAppending:!0,viewMode:"list",isNewLatest:!1,diffData:{lhs:"",rhs:""}}),this._limit=bo,this._start=0,this.fetchVersions=(Ke=!1)=>{const lt=this._dashboard.state.uid;lt&&(this.setState({isAppending:Ke}),yt.wL.getHistoryList(lt,{limit:this._limit,start:this._start}).then(It=>{this.setState({isLoading:!1,versions:[...this.state.versions??[],...this.decorateVersions(It)]}),this._start+=this._limit}).catch(It=>console.log(It)).finally(()=>this.setState({isAppending:!1})))},this.getDiff=async()=>{const Ke=this.versions.filter(yn=>yn.checked),[lt,It]=Ke,Xt=lt.version===this._dashboard.state.version;if(this.setState({isLoading:!0}),!this._dashboard.state.uid)return;const Yt=await yt.wL.getDashboardVersion(this._dashboard.state.uid,It.version),gn=await yt.wL.getDashboardVersion(this._dashboard.state.uid,lt.version);this.setState({baseInfo:It,isLoading:!1,isNewLatest:Xt,newInfo:lt,viewMode:"compare",diffData:{lhs:Yt.data,rhs:gn.data}})},this.reset=()=>{this.setState({baseInfo:void 0,diffData:{lhs:"",rhs:""},isNewLatest:!1,newInfo:void 0,versions:this.versions.map(Ke=>({...Ke,checked:!1})),viewMode:"list"})},this.onCheck=(Ke,lt)=>{this.setState({versions:this.versions.map(It=>It.id===lt?{...It,checked:Ke.currentTarget.checked}:It)})},this.addActivationHandler(()=>{this.fetchVersions()})}static{this.Component=Ko}get _dashboard(){return(0,Oe.YQ)(this)}get diffData(){return this.state.diffData??{lhs:"",rhs:""}}get versions(){return this.state.versions??[]}get limit(){return this._limit}get start(){return this._start}getUrlKey(){return"versions"}getDashboard(){return this._dashboard}getTimeRange(){return g.jh.getTimeRange(this._dashboard)}decorateVersions(Ae){const Ke=this.getTimeRange().getTimeZone();return Ae.map(lt=>({...lt,createdDateString:(0,Ee.LE)(lt.created,{timeZone:Ke}),ageString:(0,Ee.fq)(lt.created,{timeZone:Ke}),checked:!1}))}}function Ko({model:Ge}){const Ae=Ge.getDashboard(),{isLoading:Ke,isAppending:lt,viewMode:It,baseInfo:Xt,newInfo:Yt,isNewLatest:gn}=Ge.useState(),{navModel:yn,pageNav:Mn}=mo(Ae,Ge.getUrlKey()),is=Ge.versions.filter(sa=>sa.checked).length===2,rs=Ge.versions.length>1,ws=Ge.versions.length>=Ge.limit,Es=Ge.versions.find(sa=>sa.version===1),Sa=(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(yt.me,{onClick:Ge.reset,baseVersion:Xt?.version,newVersion:Yt?.version,isNewLatest:gn}),Ke?(0,u.jsx)(Oi,{msg:"Fetching changes\u2026"}):(0,u.jsx)(yt.Cc,{newInfo:Yt,baseInfo:Xt,isNewLatest:gn,diffData:Ge.diffData,onRestore:Ae.onRestore})]}),Na=(0,u.jsxs)(u.Fragment,{children:[Ke?(0,u.jsx)(Oi,{msg:"Fetching history list\u2026"}):(0,u.jsx)(yt.bS,{versions:Ge.versions,onCheck:Ge.onCheck,canCompare:is,onRestore:Ae.onRestore}),lt&&(0,u.jsx)(Oi,{msg:"Fetching more entries\u2026"}),rs&&(0,u.jsx)(yt.rJ,{hasMore:ws,canCompare:is,getVersions:Ge.fetchVersions,getDiff:Ge.getDiff,isLastPage:!!Es})]});return(0,u.jsxs)(Nt.Y,{navModel:yn,pageNav:Mn,layout:xt.k.Standard,children:[(0,u.jsx)(Je.c,{dashboard:Ae}),It==="compare"?Sa:Na]})}const Oi=({msg:Ge})=>(0,u.jsxs)(S.B,{children:[(0,u.jsx)(fn.y,{}),(0,u.jsx)("em",{children:Ge})]});function mo(Ge,Ae){const Ke=(0,nt.zy)(),lt=(0,z.useSelector)(gn=>gn.navIndex),It=(0,o.tc)(lt,"dashboards/browse"),Xt=Ge.getPageNav(Ke,lt),Yt={text:"Settings",url:t.I.getUrlForPartial(Ke,{editview:"settings",editIndex:null}),children:[],parentItem:Xt};return Ge.state.meta.canEdit&&(Yt.children.push({text:(0,Zt.t)("dashboard-settings.general.title","General"),url:t.I.getUrlForPartial(Ke,{editview:"settings",editIndex:null}),active:Ae==="settings"}),Yt.children.push({text:(0,Zt.t)("dashboard-settings.annotations.title","Annotations"),url:t.I.getUrlForPartial(Ke,{editview:"annotations",editIndex:null}),active:Ae==="annotations"}),Yt.children.push({text:(0,Zt.t)("dashboard-settings.variables.title","Variables"),url:t.I.getUrlForPartial(Ke,{editview:"variables",editIndex:null}),active:Ae==="variables"}),Yt.children.push({text:(0,Zt.t)("dashboard-settings.links.title","Links"),url:t.I.getUrlForPartial(Ke,{editview:"links",editIndex:null}),active:Ae==="links"})),Ge.state.id&&Ge.state.meta.canSave&&Yt.children.push({text:(0,Zt.t)("dashboard-settings.versions.title","Versions"),url:t.I.getUrlForPartial(Ke,{editview:"versions",editIndex:null}),active:Ae==="versions"}),Ge.state.id&&Ge.state.meta.canAdmin&&Ln.TP.hasPermission(z.AccessControlAction.DashboardsPermissionsRead)&&Yt.children.push({text:(0,Zt.t)("dashboard-settings.permissions.title","Permissions"),url:t.I.getUrlForPartial(Ke,{editview:"permissions",editIndex:null}),active:Ae==="permissions"}),Yt.children.push({text:(0,Zt.t)("dashboard-settings.json-editor.title","JSON Model"),url:t.I.getUrlForPartial(Ke,{editview:"json-model",editIndex:null}),active:Ae==="json-model"}),{navModel:It,pageNav:Yt}}function Ii(Ge){switch(Ge){case"annotations":return new Er({});case"variables":return new Yi({});case"links":return new Un({});case"versions":return new ci({});case"json-model":return new hr({});case"permissions":return new Uo({});case"settings":default:return new Aa({})}}class Co extends g.Bs{constructor(Ae){super(Ae),this.addActivationHandler(this._activationHandler.bind(this))}_activationHandler(){const Ae=this.state.panelRef.resolve(),Ke=g.Go.cloneSceneObjectState(Ae.state,{key:Ae.state.key+"-view",$variables:this.getScopedVariables(Ae)}),lt=new g.Eb(Ke);return this.setState({body:lt}),()=>{lt.state.$data&&Ae.setState({$data:lt.state.$data.clone()})}}getScopedVariables(Ae){const Ke=jr(Ae),lt=[];if(Ke&&Ke.state.$variables)for(const It of Ke.state.$variables.state.variables)lt.push(It.clone());if(Ae.state.$variables)for(const It of Ae.state.$variables.state.variables)lt.push(It.clone());if(lt.length>0)return new g.Pj({variables:lt})}getUrlKey(){return this.state.panelRef.resolve().state.key}static{this.Component=({model:Ae})=>{const{body:Ke}=Ae.useState();return Ke?(0,u.jsx)(Ke.Component,{model:Ke}):null}}}function jr(Ge){try{return g.jh.getAncestor(Ge,g.tI)}catch{return}}var di=e(30195);class vo{constructor(Ae){this._scene=Ae}getKeys(){return["inspect","viewPanel","editPanel","editview","autofitpanels","kiosk"]}getUrlState(){const Ae=this._scene.state;return{inspect:Ae.inspectPanelKey,autofitpanels:Ae.body instanceof g.hy&&Ae.body.state.UNSAFE_fitPanels?"true":void 0,viewPanel:Ae.viewPanelScene?.getUrlKey(),editview:Ae.editview?.getUrlKey(),editPanel:Ae.editPanel?.getUrlKey()||void 0,kiosk:Ae.kioskMode===z.KioskMode.Full?"":Ae.kioskMode===z.KioskMode.TV?"tv":void 0}}updateFromUrl(Ae){const{inspectPanelKey:Ke,viewPanelScene:lt,isEditing:It,editPanel:Xt}=this._scene.state,Yt={};if(typeof Ae.editview=="string"&&this._scene.canEditDashboard()?(Yt.editview=Ii(Ae.editview),It||(this._scene.state.editable?setTimeout(()=>this._scene.onEnterEditMode()):Yt.editview=void 0)):Ae.hasOwnProperty("editview")&&(Yt.editview=void 0),typeof Ae.inspect=="string"){let gn=(0,Oe.vL)(this._scene,Ae.inspect);if(!gn){a.A.emit(n.r1.alertError,["Panel not found"]),r.Ny.partial({inspect:null});return}if((0,Oe.Yr)(gn)){this._handleLibraryPanel(gn,yn=>{if(yn.state.key===void 0)throw new Error("library panel key is undefined");const Mn=new Ea({$behaviors:[new ui({panelKey:yn.state.key})]});this._scene.setState({overlay:Mn,inspectPanelKey:yn.state.key})});return}Yt.inspectPanelKey=Ae.inspect,Yt.overlay=new Ea({$behaviors:[new ui({panelKey:Ae.inspect})]})}else Ke&&(Yt.inspectPanelKey=void 0,Yt.overlay=void 0);if(typeof Ae.viewPanel=="string"){const gn=(0,Oe.vL)(this._scene,Ae.viewPanel);if(!gn){if((0,Oe.SN)(Ae.viewPanel)){this._handleViewRepeatClone(Ae.viewPanel);return}a.A.emit(n.r1.alertError,["Panel not found"]),r.Ny.partial({viewPanel:null});return}if((0,Oe.Yr)(gn)){this._handleLibraryPanel(gn,yn=>this._buildLibraryPanelViewScene(yn));return}Yt.viewPanelScene=new Co({panelRef:gn.getRef()})}else lt&&Ae.viewPanel===null&&(Yt.viewPanelScene=void 0);if(typeof Ae.editPanel=="string"){const gn=(0,Oe.vL)(this._scene,Ae.editPanel);if(!gn){console.warn(`Panel ${Ae.editPanel} not found`);return}if(this._scene.state.viewPanelScene&&this._scene.setState({viewPanelScene:void 0}),It||this._scene.onEnterEditMode(),(0,Oe.Yr)(gn)){this._handleLibraryPanel(gn,yn=>{this._scene.setState({editPanel:(0,sn.L)(yn)})});return}Yt.editPanel=(0,sn.L)(gn)}else Xt&&Ae.editPanel===null&&(Yt.editPanel=void 0);if(this._scene.state.body instanceof g.hy){const gn=typeof Ae.autofitpanels=="string";!!this._scene.state.body.state.UNSAFE_fitPanels!==gn&&this._scene.state.body.setState({UNSAFE_fitPanels:gn})}typeof Ae.kiosk=="string"&&(Ae.kiosk==="true"||Ae.kiosk===""?Yt.kioskMode=z.KioskMode.Full:Ae.kiosk==="tv"&&(Yt.kioskMode=z.KioskMode.TV)),Object.keys(Yt).length>0&&this._scene.setState(Yt)}_buildLibraryPanelViewScene(Ae){this._scene.setState({viewPanelScene:new Co({panelRef:Ae.getRef()})})}_handleLibraryPanel(Ae,Ke){if(!(Ae.parent instanceof Ft.F))throw new Error("Panel is not a child of a LibraryVizPanel");const lt=Ae.parent;lt.state.isLoaded?Ke(Ae):(lt.subscribeToState(It=>{Ke(It.panel)}),lt.activate())}_handleViewRepeatClone(Ae){this._eventSub||(this._eventSub=this._scene.subscribeToEvent(di.d,()=>{const Ke=(0,Oe.vL)(this._scene,Ae);Ke&&(this._eventSub?.unsubscribe(),this._scene.setState({viewPanelScene:new Co({panelRef:Ke.getRef()})}))}))}}class ui extends g.Bs{constructor(Ae){super(Ae),this._onActivate=()=>{const Ke=this.parent;if(!Ke||!(Ke instanceof Ea))throw new Error("ResolveInspectPanelByKey must be attached to a PanelInspectDrawer");const lt=(0,Oe.YQ)(Ke);if(!lt)return;const It=this.state.panelKey;let Xt=(0,Oe.vL)(lt,It);lt.state.editPanel&&(Xt=lt.state.editPanel.state.vizManager.state.panel),lt.state.viewPanelScene&&lt.state.viewPanelScene.state.body&&(Xt=lt.state.viewPanelScene.state.body),Xt&&Ke.setState({panelRef:Xt.getRef()})},this.addActivationHandler(this._onActivate)}}var gl=e(79284),yo=e(54625),Jr=e(76885),Ji=e(67647),$o=e(83277),Ai=e(2468),Vo=(Ge=>(Ge[Ge.Persisted=0]="Persisted",Ge[Ge.Result=1]="Result",Ge))(Vo||{});function Xi(Ge){return{metadata:{name:Ge},spec:{filters:[],title:Ge,type:"",category:"",description:""}}}function Fr(Ge,Ae){return{...Ge,metadata:{...Ge.metadata,...Ae.metadata},spec:{...Ge.spec,...Ae.spec}}}const Xr="scope.grafana.app",Gr="v0alpha1",Ri=s.$.namespace??"default",pl=`/apis/${Xr}/${Gr}/namespaces/${Ri}/find/scope_node_children`,Jo=`/apis/${Xr}/${Gr}/namespaces/${Ri}/find/scope_dashboard_bindings`,Ul=new Ai.w({group:Xr,version:Gr,resource:"scopes"}),hi=new Map;async function Zi(Ge,Ae){try{return(await(0,V.AI)().get(pl,{parent:Ge,query:Ae}))?.items??[]}catch{return[]}}async function qi(Ge,Ae){return(await Zi(Ge,Ae)).reduce((Ke,{metadata:{name:lt},spec:It})=>(Ke[lt]={name:lt,...It,isExpandable:It.nodeType==="container",isSelectable:It.linkType==="scope",isExpanded:!1,query:"",reason:Vo.Result,nodes:{}},Ke),{})}async function Li(Ge){if(hi.has(Ge))return hi.get(Ge);const Ae=new Promise(async Ke=>{const lt=Xi(Ge);try{const It=await Ul.get(Ge),Xt=Fr(lt,It);Ke(Xt)}catch{hi.delete(Ge),Ke(lt)}});return hi.set(Ge,Ae),Ae}async function fi(Ge){return await Promise.all(Ge.map(Li))}async function ji(Ge){return(await fi(Ge.map(({scopeName:Ke})=>Ke))).reduce((Ke,lt,It)=>(Ke.push({scope:lt,path:Ge[It].path}),Ke),[])}async function Xo(Ge){try{return(await(0,V.AI)().get(Jo,{scope:Ge.map(({metadata:{name:Ke}})=>Ke)}))?.items??[]}catch{return[]}}async function Fe(Ge){const Ae=await Xo(Ge);return Object.values(Ae.reduce((Ke,lt)=>(Ke[lt.spec.dashboard]||(Ke[lt.spec.dashboard]={dashboard:lt.spec.dashboard,dashboardTitle:lt.spec.dashboardTitle,items:[]}),Ke[lt.spec.dashboard].items.push(lt),Ke),{}))}class _e extends g.Bs{static{this.Component=tt}constructor(){super({dashboards:[],filteredDashboards:[],isLoading:!1,scopesSelected:!1,searchQuery:""})}async fetchDashboards(Ae){if(Ae.length===0)return this.setState({dashboards:[],filteredDashboards:[],isLoading:!1,scopesSelected:!1});this.setState({isLoading:!0});const Ke=await Fe(Ae);this.setState({dashboards:Ke,filteredDashboards:this.filterDashboards(Ke,this.state.searchQuery),isLoading:!1,scopesSelected:Ae.length>0})}changeSearchQuery(Ae){this.setState({filteredDashboards:Ae?this.filterDashboards(this.state.dashboards,Ae):this.state.dashboards,searchQuery:Ae??""})}filterDashboards(Ae,Ke){const lt=Ke.toLowerCase();return Ae.filter(({dashboardTitle:It})=>It.toLowerCase().includes(lt))}}function tt({model:Ge}){const{dashboards:Ae,filteredDashboards:Ke,isLoading:lt,searchQuery:It,scopesSelected:Xt}=Ge.useState(),Yt=(0,St.of)(ft),[gn]=(0,$o.s)();if(!lt)if(Xt){if(Ae.length===0)return(0,u.jsx)("p",{className:Yt.noResultsContainer,"data-testid":"scopes-dashboards-notFoundForScope",children:(0,u.jsx)(Zt.x6,{i18nKey:"scopes.suggestedDashboards.noResultsForScopes",children:"No dashboards found for the selected scopes"})})}else return(0,u.jsx)("p",{className:Yt.noResultsContainer,"data-testid":"scopes-dashboards-notFoundNoScopes",children:(0,u.jsx)(Zt.x6,{i18nKey:"scopes.suggestedDashboards.noResultsNoScopes",children:"No scopes selected"})});return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{className:Yt.searchInputContainer,children:(0,u.jsx)(Ji.Z,{disabled:lt,placeholder:(0,Zt.t)("scopes.suggestedDashboards.search","Search"),value:It,"data-testid":"scopes-dashboards-search",onChange:yn=>Ge.changeSearchQuery(yn)})}),lt?(0,u.jsx)(oi._,{className:Yt.loadingIndicator,text:(0,Zt.t)("scopes.suggestedDashboards.loading","Loading dashboards"),"data-testid":"scopes-dashboards-loading"}):Ke.length>0?(0,u.jsx)(zt.E,{children:Ke.map(({dashboard:yn,dashboardTitle:Mn})=>(0,u.jsx)(yo.Link,{to:Jr.kM.renderUrl(`/d/${yn}/`,gn),className:Yt.dashboardItem,"data-testid":`scopes-dashboards-${yn}`,children:Mn},yn))}):(0,u.jsxs)("p",{className:Yt.noResultsContainer,"data-testid":"scopes-dashboards-notFoundForFilter",children:[(0,u.jsx)(Zt.x6,{i18nKey:"scopes.suggestedDashboards.noResultsForFilter",children:"No results found for your query"}),(0,u.jsx)(T.$n,{variant:"secondary",onClick:()=>Ge.changeSearchQuery(""),"data-testid":"scopes-dashboards-notFoundForFilter-clear",children:(0,u.jsx)(Zt.x6,{i18nKey:"scopes.suggestedDashboards.noResultsForFilterClear",children:"Clear search"})})]})]})}const ft=Ge=>({noResultsContainer:(0,Te.css)({alignItems:"center",display:"flex",flexDirection:"column",gap:Ge.spacing(1),justifyContent:"center",textAlign:"center"}),searchInputContainer:(0,Te.css)({flex:"0 1 auto"}),loadingIndicator:(0,Te.css)({alignSelf:"center"}),dashboardItem:(0,Te.css)({padding:Ge.spacing(1,0),borderBottom:`1px solid ${Ge.colors.border.weak}`,"& :is(:first-child)":{paddingTop:0}})});var Mt=e(65474),$t=e(69850),Jt=e(56034);function nn({nodes:Ge,scopes:Ae,isDisabled:Ke,isLoading:lt,onInputClick:It,onRemoveAllClick:Xt}){const Yt=(0,St.of)(Dn),[gn,yn]=(0,re.useState)(!1);(0,re.useEffect)(()=>{yn(!1)},[Ae]);const Mn=(0,re.useMemo)(()=>{const ws=Ae.map(({scope:Na,path:sa})=>{let ea=Ge,Da;sa.length>0?(Da=sa.map(Vs=>{const ka=ea[Vs];if(!ka)return null;const{title:qa,nodes:Bi}=ka;return ea=Bi,qa}).filter(Vs=>Vs!==null),Da[0]===""&&Da.splice(0,1)):Da=[Na.spec.title];const or=Da.pop();return[Da.join(" > "),or]}),Es=(0,tn.groupBy)(ws,([Na])=>Na),Sa=Object.entries(Es).map(([Na,sa])=>{const ea=sa.map(([,Da])=>Da).join(", ");return(Na?[Na,ea]:[ea]).join(" > ")}).map(Na=>(0,u.jsx)("p",{className:Yt.scopePath,children:Na},Na));return(0,u.jsx)(u.Fragment,{children:Sa})},[Ge,Ae,Yt]),is=(0,re.useMemo)(()=>Ae.map(({scope:ws})=>ws.spec.title).join(", "),[Ae]),rs=(0,re.useMemo)(()=>(0,u.jsx)(L.p,{readOnly:!0,placeholder:(0,Zt.t)("scopes.filters.input.placeholder","Select scopes..."),loading:lt,value:is,"aria-label":(0,Zt.t)("scopes.filters.input.placeholder","Select scopes..."),"data-testid":"scopes-filters-input",suffix:Ae.length>0&&!Ke?(0,u.jsx)(Sr.K,{"aria-label":(0,Zt.t)("scopes.filters.input.removeAll","Remove all scopes"),name:"times",onClick:()=>Xt()}):void 0,onMouseOver:()=>yn(!0),onMouseOut:()=>yn(!1),onClick:()=>{Ke||It()}}),[Ke,lt,It,Xt,Ae,is]);return(0,u.jsx)(Jt.m,{content:Mn,show:Ae.length===0?!1:gn,children:rs})}const Dn=Ge=>({scopePath:(0,Te.css)({color:Ge.colors.text.primary,fontSize:Ge.typography.pxToRem(14),margin:Ge.spacing(1,0)})});function In({anyChildExpanded:Ge,query:Ae,resultsNodes:Ke}){const lt=(0,St.of)(ts);return Ge?null:(0,u.jsx)("h6",{className:lt.container,"data-testid":"scopes-tree-headline",children:Ae?Ke.length===0?(0,u.jsx)(Zt.x6,{i18nKey:"scopes.tree.headline.noResults",children:"No results found for your query"}):(0,u.jsx)(Zt.x6,{i18nKey:"scopes.tree.headline.results",children:"Results"}):(0,u.jsx)(Zt.x6,{i18nKey:"scopes.tree.headline.recommended",children:"Recommended"})})}const ts=Ge=>({container:(0,Te.css)({color:Ge.colors.text.secondary,margin:Ge.spacing(1,0)})});var hs=e(79569);function Yn({anyChildExpanded:Ge,loadingNodeName:Ae,node:Ke,nodePath:lt,nodes:It,scopeNames:Xt,scopes:Yt,type:gn,onNodeSelectToggle:yn,onNodeUpdate:Mn}){const is=(0,St.of)(bs);return(0,u.jsx)("div",{role:"tree",children:It.map(rs=>{const ws=rs.isSelectable&&Xt.includes(rs.linkId);if(Ge&&!rs.isExpanded)return null;const Es=[...lt,rs.name],Sa=Es.join(".");return(0,u.jsxs)("div",{role:"treeitem","aria-selected":rs.isExpanded,children:[(0,u.jsxs)("div",{className:is.title,children:[rs.isSelectable&&!rs.isExpanded?Ke.disableMultiSelect?(0,u.jsx)(hs.J,{id:Sa,name:Sa,checked:ws,label:"","data-testid":`scopes-tree-${gn}-${rs.name}-radio`,onClick:()=>{yn(Es)}}):(0,u.jsx)(ue.S,{checked:ws,"data-testid":`scopes-tree-${gn}-${rs.name}-checkbox`,onChange:()=>{yn(Es)}}):null,rs.isExpandable?(0,u.jsxs)("button",{className:is.expand,"data-testid":`scopes-tree-${gn}-${rs.name}-expand`,"aria-label":rs.isExpanded?(0,Zt.t)("scopes.tree.collapse","Collapse"):(0,Zt.t)("scopes.tree.expand","Expand"),onClick:()=>{Mn(Es,!rs.isExpanded,rs.query)},children:[(0,u.jsx)(Pn.I,{name:rs.isExpanded?"angle-down":"angle-right"}),rs.title]}):(0,u.jsx)("span",{"data-testid":`scopes-tree-${gn}-${rs.name}-title`,children:rs.title})]}),(0,u.jsx)("div",{className:is.children,children:rs.isExpanded&&(0,u.jsx)(ms,{nodes:Ke.nodes,nodePath:Es,loadingNodeName:Ae,scopes:Yt,onNodeUpdate:Mn,onNodeSelectToggle:yn})})]},rs.name)})})}const bs=Ge=>({title:(0,Te.css)({alignItems:"center",display:"flex",gap:Ge.spacing(1),fontSize:Ge.typography.pxToRem(14),lineHeight:Ge.typography.pxToRem(22),padding:Ge.spacing(.5,0),"& > label":(0,Te.css)({gap:0})}),expand:(0,Te.css)({alignItems:"center",background:"none",border:0,display:"flex",gap:Ge.spacing(1),margin:0,padding:0}),children:(0,Te.css)({paddingLeft:Ge.spacing(4)})});var Ns=e(70255);function ns({children:Ge,isNodeLoading:Ae}){const Ke=(0,St.of)(ta);return Ae?(0,u.jsx)(Ns.A,{count:5,className:Ke.loader}):Ge}const ta=Ge=>({loader:(0,Te.css)({margin:Ge.spacing(.5,0)})});var Ms=e(40996);function Qs({anyChildExpanded:Ge,nodePath:Ae,query:Ke,onNodeUpdate:lt}){const It=(0,St.of)(oa),[Xt,Yt]=(0,re.useState)({value:Ke,isDirty:!1});return(0,re.useEffect)(()=>{!Xt.isDirty&&Xt.value!==Ke&&Yt({value:Ke,isDirty:!1})},[Xt,Ke]),(0,Ms.A)(()=>{Xt.isDirty&&lt(Ae,!0,Xt.value)},500,[Xt.isDirty,Xt.value]),Ge?null:(0,u.jsx)(Ji.Z,{placeholder:(0,Zt.t)("scopes.tree.search","Search"),value:Xt.value,className:It.input,"data-testid":"scopes-tree-search",onChange:gn=>{Yt({value:gn,isDirty:!0})}})}const oa=Ge=>({input:(0,Te.css)({margin:Ge.spacing(1,0)})});function ms({nodes:Ge,nodePath:Ae,loadingNodeName:Ke,scopes:lt,onNodeUpdate:It,onNodeSelectToggle:Xt}){const Yt=Ae[Ae.length-1],gn=Ge[Yt],yn=Object.values(gn.nodes),Mn=Ke===Yt,is=lt.map(({scopeName:Es})=>Es),rs=yn.some(({isExpanded:Es})=>Es),ws=(0,re.useMemo)(()=>(0,tn.groupBy)(yn,"reason"),[yn]);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(Qs,{anyChildExpanded:rs,nodePath:Ae,query:gn.query,onNodeUpdate:It}),(0,u.jsxs)(ns,{isNodeLoading:Mn,children:[(0,u.jsx)(Yn,{anyChildExpanded:rs,isNodeLoading:Mn,loadingNodeName:Ke,node:gn,nodePath:Ae,nodes:ws[Vo.Persisted]??[],scopes:lt,scopeNames:is,type:"persisted",onNodeSelectToggle:Xt,onNodeUpdate:It}),(0,u.jsx)(In,{anyChildExpanded:rs,query:gn.query,resultsNodes:ws[Vo.Result]??[]}),(0,u.jsx)(Yn,{anyChildExpanded:rs,isNodeLoading:Mn,loadingNodeName:Ke,node:gn,nodePath:Ae,nodes:ws[Vo.Result]??[],scopes:lt,scopeNames:is,type:"result",onNodeSelectToggle:Xt,onNodeUpdate:It})]})]})}class xa extends g.Bs{constructor(){super({nodes:{"":{name:"",reason:Vo.Result,nodeType:"container",title:"",isExpandable:!0,isSelectable:!1,isExpanded:!0,query:"",nodes:{}}},loadingNodeName:void 0,scopes:[],treeScopes:[],isLoadingScopes:!1,isOpened:!1}),this._urlSync=new g.So(this,{keys:["scopes"]}),this.addActivationHandler(()=>(this.fetchBaseNodes(),()=>{this.nodesFetchingSub?.unsubscribe()}))}static{this.Component=Ua}get scopesParent(){return g.jh.getAncestor(this,La)}getUrlState(){return{scopes:this.state.scopes.map(({scope:Ae})=>Ae.metadata.name)}}updateFromUrl(Ae){let Ke=Ae.scopes??[];Ke=Array.isArray(Ke)?Ke:[Ke],this.updateScopes(Ke.map(lt=>({scopeName:lt,path:[]})))}fetchBaseNodes(){return this.updateNode([""],!0,"")}async updateNode(Ae,Ke,lt){this.nodesFetchingSub?.unsubscribe();let It={...this.state.nodes},Xt=It;for(let Mn=0;Mn<Ae.length-1;Mn++)Xt=Xt[Ae[Mn]].nodes;const Yt=Ae[Ae.length-1],gn=Xt[Yt],yn=gn.query!==lt;gn.isExpanded=Ke,gn.query=lt,Ke||yn?(this.setState({nodes:It,loadingNodeName:Yt}),this.nodesFetchingSub=(0,Mt.H)(qi(Yt,lt)).pipe((0,$t.j)(()=>{this.setState({loadingNodeName:void 0})})).subscribe(Mn=>{const is=this.state.treeScopes.map(({path:rs})=>rs[rs.length-1]).filter(rs=>rs in gn.nodes&&!(rs in Mn)).reduce((rs,ws)=>(rs[ws]={...gn.nodes[ws],reason:Vo.Persisted},rs),{});gn.nodes={...is,...Mn},this.setState({nodes:It}),this.nodesFetchingSub?.unsubscribe()})):this.setState({nodes:It,loadingNodeName:void 0})}toggleNodeSelect(Ae){let Ke=[...this.state.treeScopes],lt=this.state.nodes[""];for(let gn=1;gn<Ae.length-1;gn++)lt=lt.nodes[Ae[gn]];const It=Ae[Ae.length-1],{linkId:Xt}=lt.nodes[It],Yt=Ke.findIndex(({scopeName:gn})=>gn===Xt);if(Yt===-1){Li(Xt);const gn=Ke.length===0||Object.values(lt.nodes).some(({linkId:Mn})=>Mn===Ke[0].scopeName),yn={scopeName:Xt,path:Ae};this.setState({treeScopes:lt?.disableMultiSelect||!gn?[yn]:[...Ke,yn]})}else Ke.splice(Yt,1),this.setState({treeScopes:Ke})}open(){if(!this.scopesParent.state.isViewing){let Ae={...this.state.nodes};Ae=this.closeNodes(Ae);let Ke=[...this.state.scopes[0]?.path??["",""]];Ke.splice(Ke.length-1,1),Ae=this.expandNodes(Ae,Ke),this.setState({isOpened:!0,nodes:Ae})}}close(){this.setState({isOpened:!1})}getSelectedScopes(){return this.state.scopes.map(({scope:Ae})=>Ae)}async updateScopes(Ae=this.state.treeScopes){if((0,tn.isEqual)(Ae,this.getTreeScopes()))return;this.setState({scopes:Ae.map(({scopeName:lt,path:It})=>({scope:Xi(lt),path:It})),treeScopes:Ae,isLoadingScopes:!0});const Ke=await ji(Ae);this.setState({scopes:Ke,isLoadingScopes:!1})}resetDirtyScopeNames(){this.setState({treeScopes:this.getTreeScopes()})}removeAllScopes(){this.setState({scopes:[],treeScopes:[],isLoadingScopes:!1})}enterViewMode(){this.setState({isOpened:!1})}closeNodes(Ae){return Object.entries(Ae).reduce((Ke,[lt,It])=>(Ke[lt]={...It,isExpanded:!1,nodes:this.closeNodes(It.nodes)},Ke),{})}expandNodes(Ae,Ke){Ae={...Ae};let lt=Ae;for(let It=0;It<Ke.length;It++){const Xt=Ke[It];lt[Xt]={...lt[Xt],isExpanded:!0},lt=lt[Xt].nodes}return Ae}getTreeScopes(){return this.state.scopes.map(({scope:Ae,path:Ke})=>({scopeName:Ae.metadata.name,path:Ke}))}}function Ua({model:Ge}){const Ae=(0,St.of)(_a),{nodes:Ke,loadingNodeName:lt,treeScopes:It,isLoadingScopes:Xt,isOpened:Yt,scopes:gn}=Ge.useState(),{isViewing:yn}=Ge.scopesParent.useState();return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(nn,{nodes:Ke,scopes:gn,isDisabled:yn,isLoading:Xt,onInputClick:()=>Ge.open(),onRemoveAllClick:()=>Ge.removeAllScopes()}),Yt&&(0,u.jsxs)(x._,{title:(0,Zt.t)("scopes.filters.title","Select scopes"),size:"sm",onClose:()=>{Ge.close(),Ge.resetDirtyScopeNames()},children:[Xt?(0,u.jsx)(fn.y,{"data-testid":"scopes-filters-loading"}):(0,u.jsx)(ms,{nodes:Ke,nodePath:[""],loadingNodeName:lt,scopes:It,onNodeUpdate:(Mn,is,rs)=>Ge.updateNode(Mn,is,rs),onNodeSelectToggle:Mn=>Ge.toggleNodeSelect(Mn)}),(0,u.jsxs)("div",{className:Ae.buttonGroup,children:[(0,u.jsx)(T.$n,{variant:"primary","data-testid":"scopes-filters-apply",onClick:()=>{Ge.close(),Ge.updateScopes()},children:(0,u.jsx)(Zt.x6,{i18nKey:"scopes.filters.apply",children:"Apply"})}),(0,u.jsx)(T.$n,{variant:"secondary","data-testid":"scopes-filters-cancel",onClick:()=>{Ge.close(),Ge.resetDirtyScopeNames()},children:(0,u.jsx)(Zt.x6,{i18nKey:"scopes.filters.cancel",children:"Cancel"})})]})]})]})}const _a=Ge=>({buttonGroup:(0,Te.css)({display:"flex",gap:Ge.spacing(1),marginTop:Ge.spacing(8)})});class La extends g.Bs{static{this.Component=va}constructor(){super({dashboards:new _e,filters:new xa,isExpanded:!1,isViewing:!1}),this.addActivationHandler(()=>{this._subs.add(this.state.filters.subscribeToState((Ae,Ke)=>{!Ae.isLoadingScopes&&Ae.scopes!==Ke.scopes&&(this.state.isExpanded&&this.state.dashboards.fetchDashboards(this.state.filters.getSelectedScopes()),g.jh.getTimeRange(this.parent).onRefresh())})),this._subs.add(this.parent?.subscribeToState(Ae=>{const Ke="isEditing"in Ae?!!Ae.isEditing:!1;Ke!==this.state.isViewing&&(Ke?this.enterViewMode():this.exitViewMode())}))})}getSelectedScopes(){return this.state.filters.getSelectedScopes()}toggleIsExpanded(){const Ae=!this.state.isExpanded;Ae&&this.state.dashboards.fetchDashboards(this.getSelectedScopes()),this.setState({isExpanded:Ae})}enterViewMode(){this.setState({isExpanded:!1,isViewing:!0}),this.state.filters.enterViewMode()}exitViewMode(){this.setState({isViewing:!1})}}function va({model:Ge}){const{filters:Ae,dashboards:Ke,isExpanded:lt,isViewing:It}=Ge.useState(),Xt=(0,St.of)(wa);return(0,u.jsxs)("div",{className:(0,Te.cx)(Xt.container,lt&&Xt.containerExpanded),children:[(0,u.jsxs)("div",{className:(0,Te.cx)(Xt.filtersContainer,lt&&Xt.filtersContainerExpanded),children:[!It&&(0,u.jsx)(Sr.K,{name:"arrow-to-right",className:(0,Te.cx)(!lt&&Xt.iconNotExpanded),"aria-label":lt?(0,Zt.t)("scopes.suggestedDashboards.toggle.collapse","Collapse scope filters"):(0,Zt.t)("scopes.suggestedDashboards.toggle..expand","Expand scope filters"),"data-testid":"scopes-dashboards-expand",onClick:()=>Ge.toggleIsExpanded()}),(0,u.jsx)(Ae.Component,{model:Ae})]}),lt&&!It&&(0,u.jsx)("div",{className:Xt.dashboardsContainer,"data-testid":"scopes-dashboards-container",children:(0,u.jsx)(Ke.Component,{model:Ke})})]})}const wa=Ge=>({container:(0,Te.css)({display:"flex",flexDirection:"column",gridArea:"scopes"}),containerExpanded:(0,Te.css)({backgroundColor:Ge.colors.background.primary,height:"100%"}),filtersContainer:(0,Te.css)({display:"flex",flex:"0 1 auto",flexDirection:"row",padding:Ge.spacing(2,2,2,2)}),filtersContainerExpanded:(0,Te.css)({borderBottom:`1px solid ${Ge.colors.border.weak}`,padding:Ge.spacing(2)}),iconNotExpanded:(0,Te.css)({transform:"scaleX(-1)"}),dashboardsContainer:(0,Te.css)({display:"flex",flex:"1 1 auto",flexDirection:"column",gap:Ge.spacing(3),overflow:"hidden",padding:Ge.spacing(2)})});var Kr=e(69129),Pr=e(4898);class fr{constructor(){this._binds=[]}addBinding(Ae){Pr.R.bind(Ae.key,Ke=>{Ke.preventDefault(),Ke.stopPropagation(),Ke.returnValue=!1,Ae.onTrigger()},"keydown"),this._binds.push(Ae)}removeAll(){this._binds.forEach(Ae=>{Pr.R.unbind(Ae.key,Ae.type)}),this._binds=[]}}var Qr=e(91119),$r=e(85174),Zr=e(30160),co=e(7196);function gr(Ge){const Ae=new fr;let Ke=null;const lt=Ge.canEditDashboard(),It=a.A.subscribe(Kr.Tp,Yt=>{typeof Yt.payload.panelId=="string"&&(Ke=Yt.payload.panelId)});function Xt(Yt,gn){return()=>{const yn=g.jh.findObject(Yt,Mn=>Mn.state.key===Ke);if(yn&&yn instanceof g.Eb){gn(yn);return}}}return Ae.addBinding({key:"v",onTrigger:Xt(Ge,Yt=>{Ge.state.viewPanelScene||r.Ny.push((0,et.r7)(Yt))})}),s.$.featureToggles.newDashboardSharingComponent?Ae.addBinding({key:"p u",onTrigger:Xt(Ge,async Yt=>{const gn=new Qr.j({title:(0,Zt.t)("share-panel.drawer.share-link-title","Link settings"),body:new Zr.S({panelRef:Yt.getRef()})});Ge.showModal(gn)})}):Ae.addBinding({key:"p s",onTrigger:Xt(Ge,async Yt=>{Ge.showModal(new $r.Z({panelRef:Yt.getRef()}))})}),Ae.addBinding({key:"i",onTrigger:Xt(Ge,async Yt=>{r.Ny.push((0,et.Uu)(Yt))})}),Ae.addBinding({key:"p x",onTrigger:Xt(Ge,async Yt=>{const gn=await(0,et.Lp)(Yt);gn&&r.Ny.push(gn)})}),Ae.addBinding({key:"p l",onTrigger:Xt(Ge,co.vR)}),Ae.addBinding({key:"d r",onTrigger:()=>g.jh.getTimeRange(Ge).onRefresh()}),Ae.addBinding({key:"t z",onTrigger:()=>{as(Ge)}}),Ae.addBinding({key:"ctrl+z",onTrigger:()=>{as(Ge)}}),Ae.addBinding({key:"t a",onTrigger:()=>{Ce.b4.getTimePicker(Ge)?.toAbsolute()}}),Ae.addBinding({key:"t left",onTrigger:()=>{ls(Ge,"left")}}),Ae.addBinding({key:"t right",onTrigger:()=>{ls(Ge,"right")}}),lt&&(Ae.addBinding({key:"e",onTrigger:Xt(Ge,async Yt=>{if(Yt.getRoot()instanceof zs){const yn=(0,Oe.Cs)(Yt);Ge.state.editPanel||r.Ny.push((0,et.e0)(yn))}})}),Ae.addBinding({key:"d s",onTrigger:Ge.onOpenSettings}),Ae.addBinding({key:"mod+s",onTrigger:()=>Ge.openSaveDrawer({})}),Ae.addBinding({key:"p r",onTrigger:Xt(Ge,Yt=>{Ge.state.isEditing&&(0,co.MI)(Ge,Yt)})}),Ae.addBinding({key:"p d",onTrigger:Xt(Ge,Yt=>{Ge.state.isEditing&&Ge.duplicatePanel(Yt)})}),Ae.addBinding({key:"d shift+c",onTrigger:()=>{Ge.collapseAllRows()}}),Ae.addBinding({key:"d shift+e",onTrigger:()=>{Ge.expandAllRows()}})),()=>{Ae.removeAll(),It.unsubscribe()}}function as(Ge){Ce.b4.getTimePicker(Ge)?.onZoom()}function ls(Ge,Ae){const Ke=Ce.b4.getTimePicker(Ge);Ke&&(Ae==="left"&&Ke.onMoveBackward(),Ae==="right"&&Ke.onMoveForward())}const Cs=["title","description","tags","editable","graphTooltip","links","meta","preload"];class zs extends g.Bs{constructor(Ae){super({title:"Dashboard",meta:{},editable:!0,body:Ae.body??new g.G1({children:[]}),links:Ae.links??[],scopes:Ae.uid&&s.$.featureToggles.scopeFilters?new La:void 0,...Ae}),this._urlSync=new vo(this),this._variableDependency=new Nr(this),this._fromExplore=!1,this.onEnterEditMode=(Ke=!1)=>{this._fromExplore=Ke,this._initialState=g.Go.cloneSceneObjectState(this.state),this._initialUrlState=r.Ny.getLocation(),this.setState({isEditing:!0}),this.propagateEditModeChange(),this._changeTracker.startTrackingChanges()},this.onRestore=async Ke=>{const lt=await yt.wL.restoreDashboard(Ke.uid,Ke.version);if(!Number.isInteger(lt.version))return!1;const It={dashboard:new d.G(Ke.data),meta:this.state.meta},Xt=(0,vt.wM)(It),Yt=g.Go.cloneSceneObjectState(Xt.state);return Yt.version=lt.version,this.setState(Yt),this.exitEditMode({skipConfirm:!0,restoreInitialState:!1}),!0},this.onOpenSettings=()=>{r.Ny.partial({editview:"settings"})},this._changeTracker=new y.l(this),this.addActivationHandler(()=>this._activationHandler())}static{this.Component=ct}_activationHandler(){let Ae=window.__grafanaSceneContext;window.__grafanaSceneContext=this,this.state.isEditing&&(this._initialUrlState=r.Ny.getLocation(),this._changeTracker.startTrackingChanges()),this.state.meta.isNew&&(this.onEnterEditMode(),this.setState({isDirty:!0})),!this.state.meta.isEmbedded&&this.state.uid&&p.t.watch(this.state.uid);let Ke=()=>{};s.$.publicDashboardAccessToken||(Ke=gr(this));const lt=new Re(this);return(0,f.UA)().setCurrent(lt),()=>{window.__grafanaSceneContext=Ae,Ke(),this._changeTracker.terminate(),lt.destroy(),p.t.leave()}}saveCompleted(Ae,Ke,lt){this._initialSaveModel={...Ae,id:Ke.id,uid:Ke.uid,version:Ke.version},this._changeTracker.stopTrackingChanges(),this.setState({version:Ke.version,isDirty:!1,uid:Ke.uid,id:Ke.id,meta:{...this.state.meta,uid:Ke.uid,url:Ke.url,slug:Ke.slug,folderUid:lt,isNew:!1}}),this._changeTracker.startTrackingChanges()}propagateEditModeChange(){this.state.body instanceof g.hy&&(this.state.body.setState({isDraggable:this.state.isEditing,isResizable:this.state.isEditing}),(0,Oe.X0)(this.state.body,!0))}exitEditMode({skipConfirm:Ae,restoreInitialState:Ke}){if(!this.canDiscard()){console.error("Trying to discard back to a state that does not exist, initialState undefined");return}if(!this.state.isDirty||Ae){this.exitEditModeConfirmed(Ke||this.state.isDirty);return}a.A.publish(new l.bY({title:"Discard changes to dashboard?",text:"You have unsaved changes to this dashboard. Are you sure you want to discard them?",icon:"trash-alt",yesText:"Discard",onConfirm:this.exitEditModeConfirmed.bind(this)}))}exitEditModeConfirmed(Ae=!0){this._changeTracker.stopTrackingChanges(),r.Ny.replace(t.I.getUrlForPartial(this._initialUrlState,{editPanel:null,editview:null,inspect:null,inspectTab:null})),this._fromExplore&&this.cleanupStateFromExplore(),Ae?this.setState({...this._initialState,isEditing:!1}):this.setState({isEditing:!1}),this.state.editPanel&&this.state.editPanel.onDiscard(),this.propagateEditModeChange()}cleanupStateFromExplore(){this._fromExplore=!1,this._initialSaveModel?.panels&&(this._initialSaveModel.panels=this._initialSaveModel.panels.slice(1)),this._initialState&&this._initialState.body instanceof g.hy&&this._initialState.body.setState({children:this._initialState.body.state.children.slice(1)})}canDiscard(){return this._initialState!==void 0}pauseTrackingChanges(){this._changeTracker.stopTrackingChanges()}resumeTrackingChanges(){this._changeTracker.startTrackingChanges()}openSaveDrawer({saveAsCopy:Ae,onSaveSuccess:Ke}){this.state.isEditing&&this.setState({overlay:new dt({dashboardRef:this.getRef(),saveAsCopy:Ae,onSaveSuccess:Ke})})}getPageNav(Ae,Ke){const{meta:lt,viewPanelScene:It,editPanel:Xt}=this.state;if(lt.dashboardNotFound)return{text:"Not found"};let Yt={text:this.state.title,url:(0,et.uZ)({uid:this.state.uid,slug:lt.slug,currentQueryParams:Ae.search,updateQuery:{viewPanel:null,inspect:null,editview:null,editPanel:null,tab:null},isHomeDashboard:!lt.url&&!lt.slug&&!lt.isNew})};const{folderUid:gn}=lt;if(gn){const yn=(0,o.tc)(Ke,`folder-dashboards-${gn}`).main;yn.id!=="not-found"&&(Yt={...Yt,parentItem:yn})}return It&&(Yt={text:"View panel",parentItem:Yt,url:(0,et.r7)(It.state.panelRef.resolve())}),Xt&&(Yt={text:"Edit panel",parentItem:Yt}),Yt}getBodyToRender(){return this.state.viewPanelScene??this.state.body}getInitialState(){return this._initialState}addRow(Ae){if(!(this.state.body instanceof g.hy))throw new Error("Trying to add a panel in a layout that is not SceneGridLayout");const Ke=this.state.body,lt=Ke.state.children.findIndex(Xt=>Xt instanceof g.tI),It=Ke.state.children.splice(0,lt===-1?Ke.state.children.length:lt).map(Xt=>Xt.clone());It&&Ae.setState({children:It}),Ke.setState({children:[Ae,...Ke.state.children]})}removeRow(Ae,Ke=!1){if(!(this.state.body instanceof g.hy))throw new Error("Trying to add a panel in a layout that is not SceneGridLayout");const lt=this.state.body,It=lt.state.children.filter(Xt=>Xt.state.key!==Ae.state.key);if(!Ke){const Xt=Ae.state.children.map(gn=>gn.clone()),Yt=lt.state.children.findIndex(gn=>gn.state.key===Ae.state.key);It.splice(Yt,0,...Xt)}lt.setState({children:It})}addPanel(Ae){if(!(this.state.body instanceof g.hy))throw new Error("Trying to add a panel in a layout that is not SceneGridLayout");const Ke=this.state.body,lt=(0,Oe.Cs)(Ae),It=new ve.U({height:Oe.sw,width:Oe.vm,x:0,y:0,body:Ae,key:`grid-item-${lt}`});Ke.setState({children:[It,...Ke.state.children]})}createLibraryPanel(Ae,Ke){if(!(this.state.body instanceof g.hy))throw new Error("Trying to add a panel in a layout that is not SceneGridLayout");const It=Ae.state.key,Xt=new Ft.F({title:Ke.model?.title??"Panel",uid:Ke.uid,name:Ke.name,panelKey:It??(0,Oe.XA)(Ce.b4.getNextPanelId(this))}),Yt=Ae.parent;if(!(Yt instanceof ve.U))throw new Error("Trying to replace a panel that doesn't have a parent grid item");Yt.setState({body:Xt})}duplicatePanel(Ae){if(!Ae.parent)return;const Ke=(0,Ce.WZ)(Ae),lt=Ke?Ke.parent:Ae.parent;if(!(lt instanceof ve.U)){console.error("Trying to duplicate a panel in a layout that is not DashboardGridItem");return}let It,Xt,Yt;const gn=Ce.b4.getNextPanelId(this);if(Ke){const Mn=g.Go.cloneSceneObjectState(lt.state);Yt=new ve.U({x:Mn.x,y:Mn.y,width:Mn.width,height:Mn.height,body:new Ft.F({title:Ke.state.title,uid:Ke.state.uid,name:Ke.state.name,panelKey:(0,Oe.XA)(gn)})})}else{if(lt instanceof ve.U){It=g.Go.cloneSceneObjectState(lt.state.body.state);let Mn=(0,Oe.un)(lt.state.body);const is=Mn?.state.queries.map(rs=>({...rs}));Mn=Mn?.clone({queries:is}),Xt=g.jh.getData(lt.state.body).clone({$data:Mn})}else{It=g.Go.cloneSceneObjectState(Ae.state);let Mn=(0,Oe.un)(Ae);const is=Mn?.state.queries.map(rs=>({...rs}));Mn=Mn?.clone({queries:is}),Xt=g.jh.getData(Ae).clone({$data:Mn})}delete Xt.state.data?.alertState,Yt=new ve.U({x:lt.state.x,y:lt.state.y,height:lt.state.height,width:lt.state.width,body:new g.Eb({...It,$data:Xt,key:(0,Oe.XA)(gn)})})}if(!(this.state.body instanceof g.hy)){console.error("Trying to duplicate a panel in a layout that is not SceneGridLayout ");return}const yn=this.state.body;if(lt.parent instanceof g.tI){const Mn=lt.parent;Mn.setState({children:[...Mn.state.children,Yt]}),yn.forceRender();return}yn.setState({children:[...yn.state.children,Yt]})}copyPanel(Ae){if(!Ae.parent)return;let Ke=Ae.parent;if(Ae.parent instanceof Ft.F){const It=Ae.parent;if(!It.parent)return;Ke=It.parent}if(!(Ke instanceof ve.U))throw console.error("Trying to copy a panel that is not DashboardGridItem child"),new Error("Trying to copy a panel that is not DashboardGridItem child");const lt=(0,$e.ZB)(Ke);h.A.set(c.tH,JSON.stringify(lt)),a.A.emit(n.r1.alertSuccess,["Panel copied. Use **Paste panel** toolbar action to paste."])}pastePanel(){if(!(this.state.body instanceof g.hy))throw new Error("Trying to add a panel in a layout that is not SceneGridLayout");const Ae=h.A.get(c.tH),Ke=JSON.parse(Ae),lt=new d.a(Ke),It=lt.libraryPanel?(0,vt.Al)(lt):(0,vt.tt)(lt),Xt=this.state.body;if(!(It instanceof ve.U))throw new Error("Cannot paste invalid grid item");const Yt=Ce.b4.getNextPanelId(this);if(It instanceof ve.U&&It.state.body instanceof Ft.F){const gn=(0,Oe.XA)(Yt);It.state.body.setState({panelKey:gn});const yn=It.state.body.state.panel;yn instanceof g.Eb&&yn.setState({key:gn})}else It instanceof ve.U&&It.state.body?It.state.body.setState({key:(0,Oe.XA)(Yt)}):It instanceof ve.U&&It.state.body.setState({key:(0,Oe.XA)(Yt)});It.setState({height:Oe.sw,width:Oe.vm,x:0,y:0,key:`grid-item-${Yt}`}),Xt.setState({children:[It,...Xt.state.children]}),h.A.delete(c.tH)}removePanel(Ae){const Ke=[],lt=Ae.parent instanceof Ft.F?Ae.parent.parent?.state.key:Ae.parent?.state.key;if(!lt)return;let It;try{It=g.jh.getAncestor(Ae,g.tI)}catch{It=void 0}if(It){It.state.children.forEach(Yt=>{Yt.state.key!==lt&&Ke.push(Yt)}),It.setState({children:Ke}),this.state.body.forceRender();return}this.state.body.forEachChild(Yt=>{Yt.state.key!==lt&&Ke.push(Yt)});const Xt=this.state.body;(Xt instanceof g.hy||Xt instanceof g.G1)&&Xt.setState({children:Ke})}unlinkLibraryPanel(Ae){if(!Ae.parent)return;const Ke=Ae.parent;if(!(Ke instanceof ve.U)){console.error("Trying to unlinka a lib panel in a layout that is not DashboardGridItem");return}Ke?.setState({body:Ae.state.panel?.clone()})}showModal(Ae){this.setState({overlay:Ae})}closeModal(){this.setState({overlay:void 0})}async onStarDashboard(){const{meta:Ae,uid:Ke}=this.state;if(Ke)try{const lt=await(0,f.UA)().starDashboard(Ke,!!Ae.isStarred);this.setState({meta:{...Ae,isStarred:lt}})}catch(lt){console.error("Failed to star dashboard",lt)}}onShowAddLibraryPanelDrawer(Ae){this.setState({overlay:new rt.o({panelToReplaceRef:Ae})})}onCreateNewRow(){const Ae=(0,Oe.Ws)(this);return this.addRow(Ae),(0,Oe.Cs)(Ae)}onCreateNewPanel(){this.state.isEditing||this.onEnterEditMode();const Ae=(0,Oe.O8)(this);return this.addPanel(Ae),Ae}enrichDataRequest(Ae){const Ke=(0,Oe.YQ)(Ae);let lt=(0,Oe.xz)(Ae);Ke.state.isEditing&&Ke.state.editPanel&&(lt=Ke.state.editPanel.state.vizManager.state.panel);let It=0;return lt&&lt.state.key&&((0,Oe.SN)(lt.state.key)?It=We(lt?.state.key):It=(0,Oe.Cs)(lt)),{app:i.Jk.Dashboard,dashboardUID:this.state.uid,panelId:It,panelPluginId:lt?.state.pluginId,scopes:this.state.scopes?.getSelectedScopes()}}enrichFiltersRequest(){return{scopes:this.state.scopes?.getSelectedScopes()}}canEditDashboard(){const{meta:Ae}=this.state;return!!(Ae.canEdit||Ae.canMakeEditable)}getInitialSaveModel(){return this._initialSaveModel}setInitialSaveModel(Ae){this._initialSaveModel=Ae}async deleteDashboard(){await(0,m.A_)(this.state.uid,!0),this.setState({isDirty:!1}),r.Ny.replace("/")}collapseAllRows(){if(!(this.state.body instanceof g.hy))throw new Error("Dashboard scene layout is not SceneGridLayout");const Ae=this.state.body;Ae.state.children.forEach(Ke=>{Ke instanceof g.tI&&(Ke.state.isCollapsed||Ae.toggleRow(Ke))})}expandAllRows(){if(!(this.state.body instanceof g.hy))throw new Error("Dashboard scene layout is not SceneGridLayout");const Ae=this.state.body;Ae.state.children.forEach(Ke=>{Ke instanceof g.tI&&Ke.state.isCollapsed&&Ae.toggleRow(Ke)})}}class Nr{constructor(Ae){this._dashboard=Ae,this._emptySet=new Set}getNames(){return this._emptySet}hasDependencyOn(){return!1}variableUpdateCompleted(Ae,Ke){Ke&&a.A.publish(new v.og({refreshAll:!0,panelIds:[]}));const lt=this._dashboard.state.body;if(lt instanceof g.hy){for(const It of lt.state.children)if(!(!(It instanceof g.tI)||!It.state.$behaviors))for(const Xt of It.state.$behaviors)Xt instanceof gl.L&&(Xt.isWaitingForVariables||Xt.state.variableName===Ae.state.name&&Ke)&&Xt.performRepeat()}}}},60656:(k,R,e)=>{"use strict";e.d(R,{F:()=>h});var t=e(74848),n=e(80943),i=e(34214),s=e(57767),r=e(96556),g=e(41507),a=e(42397),c=e(7196),o=e(99589);class h extends n.Bs{constructor(m){super({panel:m.panel??f(m.title,m.panelKey),isLoaded:m.isLoaded??!1,...m}),this._onActivate=()=>{this.state.isLoaded||this.loadLibraryPanelFromPanelModel()},this.addActivationHandler(this._onActivate)}static{this.Component=d}setPanelFromLibPanel(m){if(this.state._loadedPanel?.version===m.version)return;const v=new i.a(m.model),l={title:v.title,key:this.state.panelKey,options:v.options??{},fieldConfig:v.fieldConfig,pluginId:v.type,pluginVersion:v.pluginVersion,displayMode:v.transparent?"transparent":void 0,description:v.description,hoverHeader:!v.title&&!v.timeFrom&&!v.timeShift,hoverHeaderOffset:0,$data:(0,r.w)(v),menu:new n.Lw({$behaviors:[c._i]}),titleItems:[new a.$({rawLinks:v.links,menu:new a.m({$behaviors:[c.oV]})}),new o.W]},y=new n.Eb(l);this.setState({panel:y,_loadedPanel:m,isLoaded:!0,name:m.name})}async loadLibraryPanelFromPanelModel(){let m=this.state.panel;try{const v=await(0,s.Yr)(this.state.uid,!0);this.setPanelFromLibPanel(v),this.parent instanceof g.U&&this.parent.setState({variableName:v.model.repeat,repeatDirection:v.model.repeatDirection==="h"?"h":"v",maxPerRow:v.model.maxPerRow})}catch{m.setState({_pluginLoadError:`Unable to load library panel: ${this.state.uid}`})}}}function f(p,m){return new n.Eb({key:m,title:p,menu:new n.Lw({$behaviors:[c._i]})})}function d({model:p}){const{panel:m}=p.useState();return m?(0,t.jsx)(m.Component,{model:m}):null}},94358:(k,R,e)=>{"use strict";e.d(R,{c:()=>$a});var t=e(74848),n=e(96540),i=e(32196),s=e(13544),r=e(32264),g=e(39601),a=e(40845),c=e(27746),o=e(14578),h=e(39938),f=e(83122),d=e(38138),p=e(55852),m=e(19727),v=e(15068),l=e(75269),y=e(10804),u=e(15054),D=e(10096),E=e(8484),x=e(33390),P=e(14792),b=e(2609),M=e(19293),O=e(22699),I=e(7758),T=e(91119),C=e(16817),S=e(70713),A=e(67061),L=e(15292),N=e(60029),F=e(32372),w=e(62930),B=e(10534),U=e(82467),K=e(3169),V=e(99140),H=e(74730),Y=e(50056);const X=s.Tp.pages.ExportDashboardDrawer.ExportAsJson;class J extends Y.N{static{this.Component=q}}function q({model:sn}){const Ln=(0,H.YQ)(sn),Jn=(0,a.of)(ae),{isSharingExternally:gs}=sn.useState(),kn=(0,C.A)(async()=>{const $s=await sn.getExportableDashboardJson();return JSON.stringify($s,null,2)},[gs]),Gn=async()=>{await sn.onSaveAsFile();const $s=(0,E.t)("export.json.download-successful_toast_message","Your JSON has been downloaded");(0,V.JD)((0,U.dx)((0,K.tZ)($s)))},Gs=(0,E.t)("export.json.export-externally-label","Export the dashboard to use in another instance");return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{children:(0,t.jsx)(E.x6,{i18nKey:"export.json.info-text",children:"Copy or download a JSON file containing the JSON of your dashboard"})}),(0,t.jsxs)(A.B,{gap:1,alignItems:"center",children:[(0,t.jsx)(L.d,{label:Gs,"data-testid":X.exportExternallyToggle,id:"export-externally-toggle",value:gs,onChange:sn.onShareExternallyChange}),(0,t.jsx)(N.J,{children:Gs})]}),(0,t.jsx)(S.Ay,{disableHeight:!0,className:Jn.codeEditorBox,"data-testid":X.codeEditor,children:({width:$s})=>kn.value?(0,t.jsx)(F.B,{value:kn.value,language:"json",showMiniMap:!1,height:"500px",width:$s,readOnly:!0}):kn.loading&&(0,t.jsx)(w.y,{})}),(0,t.jsx)("div",{className:Jn.container,children:(0,t.jsxs)(A.B,{gap:1,flex:1,direction:{xs:"column",sm:"row"},children:[(0,t.jsx)(p.$n,{"data-testid":X.saveToFileButton,variant:"primary",icon:"download-alt",onClick:Gn,children:(0,t.jsx)(E.x6,{i18nKey:"export.json.download-button",children:"Download file"})}),(0,t.jsx)(B.b,{"data-testid":X.copyToClipboardButton,variant:"secondary",icon:"copy",disabled:kn.loading,getText:()=>kn.value??"",children:(0,t.jsx)(E.x6,{i18nKey:"export.json.copy-button",children:"Copy to clipboard"})}),(0,t.jsx)(p.$n,{"data-testid":X.cancelButton,variant:"secondary",onClick:()=>Ln.closeModal(),fill:"outline",children:(0,t.jsx)(E.x6,{i18nKey:"export.json.cancel-button",children:"Cancel"})})]})})]})}function ae(sn){return{codeEditorBox:(0,i.css)({margin:`${sn.spacing(2)} 0`}),container:(0,i.css)({paddingBottom:sn.spacing(2)})}}const j=s.Tp.pages.Dashboard.DashNav.NewExportButton.Menu,te=[];function ne(sn){te.push(sn)}function le({dashboard:sn}){const Ln=(0,n.useCallback)((kn,Gn)=>{const Gs=new T.j({title:kn,body:new Gn});sn.showModal(Gs)},[sn]),Jn=(0,n.useCallback)(()=>{const kn=[];return te.forEach(Gn=>kn.push(Gn)),kn.push({shareId:O.wr.export,testId:j.exportAsJson,icon:"arrow",label:(0,E.t)("share-dashboard.menu.export-json-title","Export as JSON"),renderCondition:!0,onClick:()=>Ln((0,E.t)("export.json.title","Save dashboard JSON"),J)}),kn.filter(Gn=>Gn.renderCondition)},[Ln]),gs=kn=>{I.c.sharingCategoryClicked({item:kn.shareId,shareResource:(0,O.hD)()}),kn.onClick(sn)};return(0,t.jsx)(d.W,{"data-testid":j.container,children:Jn().map(kn=>(0,t.jsx)(d.W.Item,{testId:kn.testId,label:kn.label,icon:kn.icon,description:kn.description,onClick:()=>gs(kn)},kn.label))})}const z=s.Tp.pages.Dashboard.DashNav.NewExportButton;function ee({dashboard:sn}){const[Ln,Jn]=(0,n.useState)(!1),gs=(0,n.useCallback)(Gn=>{Jn(Gn)},[]),kn=()=>(0,t.jsx)(le,{dashboard:sn});return(0,t.jsx)(m.e,{"data-testid":z.container,children:(0,t.jsx)(f.m,{overlay:kn,placement:"bottom-end",onVisibleChange:gs,children:(0,t.jsxs)(p.$n,{"data-testid":z.arrowMenu,size:"sm",variant:"secondary",fill:"solid",tooltip:(0,E.t)("export.menu.export-as-json-tooltip","Export"),children:[(0,t.jsx)(E.x6,{i18nKey:"export.menu.export-as-json-label",children:"Export"}),"\xA0",(0,t.jsx)(o.I,{name:Ln?"angle-up":"angle-down",size:"lg"})]})})})}var se=e(41053),ie=e(72254),Z=e(80943),oe=e(25994),ce=e(72686),ye=e(4785),re=e(31678),ue=e(94753),De=e(29158),ge=e(45014);function Te({onConfirm:sn,onDismiss:Ln,description:Jn,confirmButtonLabel:gs,title:kn,isActionLoading:Gn}){const Gs=(0,a.of)(Le),$s=()=>(0,t.jsx)("div",{className:Gs.bodyContainer,children:(0,t.jsxs)(A.B,{justifyContent:"space-between",children:[(0,t.jsxs)(A.B,{gap:1,alignItems:"center",children:[(0,t.jsx)(De.K,{size:"xl",name:"angle-left","aria-label":(0,E.t)("share-drawer.confirm-action.back-arrow-button","Back button"),onClick:Ln}),(0,t.jsx)(ue.E,{variant:"h4",children:kn})]}),Gn&&(0,t.jsx)(w.y,{})]})});return(0,t.jsx)(ge.k,{body:(0,t.jsx)($s,{}),description:Jn,confirmButtonLabel:gs,confirmButtonVariant:"destructive",dismissButtonLabel:(0,E.t)("share-drawer.confirm-action.cancel-button","Cancel"),dismissButtonVariant:"secondary",justifyButtons:"flex-start",onConfirm:sn,onDismiss:Ln})}const Le=sn=>({bodyContainer:(0,i.css)({marginBottom:sn.spacing(2)})});var Ye=e(62522),je=e(49785),Ze=e(84167),Ne=e(88575),Pe=e(56034),Ue=e(10354),$e=e(54230);const ze=s.Tp.pages.ShareDashboardModal.PublicDashboard;function qe(){const{dashboard:sn}=(0,Ye.X)(),[Ln,{isLoading:Jn}]=(0,ce.T2)(),{data:gs}=ce.Sm.endpoints?.getPublicDashboard.useQueryState(sn.state.uid),kn=D.TP.hasPermission(re.AccessControlAction.DashboardsPublicWrite),Gn=Jn||!kn,$s=Z.jh.getTimeRange(sn).useState(),{handleSubmit:Is,setValue:pa,control:Ta}=(0,je.mN)({defaultValues:{isAnnotationsEnabled:gs?.annotationsEnabled,isTimeSelectionEnabled:gs?.timeSelectionEnabled}}),ua=async(ma,ar)=>{pa(ma,ar),await Is(Ya=>sr({...Ya,[ma]:ar}))()},sr=ma=>{const{isAnnotationsEnabled:ar,isTimeSelectionEnabled:Ya}=ma;Ln({dashboard:sn,payload:{...gs,annotationsEnabled:ar,timeSelectionEnabled:Ya}})};return(0,t.jsxs)(A.B,{direction:"column",gap:2,children:[(0,t.jsx)(ue.E,{element:"p",children:(0,t.jsx)(E.x6,{i18nKey:"public-dashboard.configuration.settings-label",children:"Settings"})}),(0,t.jsxs)(A.B,{justifyContent:"space-between",children:[(0,t.jsx)("form",{onSubmit:Is(sr),children:(0,t.jsx)(Ze.n,{disabled:Gn,children:(0,t.jsxs)(A.B,{direction:"column",gap:2,children:[(0,t.jsxs)(A.B,{gap:1,children:[(0,t.jsx)(je.xI,{render:({field:{ref:ma,...ar}})=>(0,t.jsx)(L.d,{...ar,"data-testid":ze.EnableTimeRangeSwitch,onChange:Ya=>{I.c.publicDashboardTimeSelectionChanged({enabled:Ya.currentTarget.checked}),ua("isTimeSelectionEnabled",Ya.currentTarget.checked)},label:(0,E.t)("public-dashboard.configuration.enable-time-range-label","Enable time range")}),control:Ta,name:"isTimeSelectionEnabled"}),(0,t.jsx)(N.J,{description:(0,E.t)("public-dashboard.configuration.enable-time-range-description","Allow people to change time range"),children:(0,t.jsx)(E.x6,{i18nKey:"public-dashboard.configuration.enable-time-range-label",children:"Enable time range"})})]}),(0,t.jsxs)(A.B,{gap:1,children:[(0,t.jsx)(je.xI,{render:({field:{ref:ma,...ar}})=>(0,t.jsx)(L.d,{...ar,"data-testid":ze.EnableAnnotationsSwitch,onChange:Ya=>{I.c.publicDashboardAnnotationsSelectionChanged({enabled:Ya.currentTarget.checked}),ua("isAnnotationsEnabled",Ya.currentTarget.checked)},label:(0,E.t)("public-dashboard.configuration.display-annotations-label","Display annotations")}),control:Ta,name:"isAnnotationsEnabled"}),(0,t.jsx)(N.J,{style:{flex:1},description:(0,E.t)("public-dashboard.configuration.display-annotations-description","Present annotations on this Dashboard"),children:(0,t.jsx)(E.x6,{i18nKey:"public-dashboard.configuration.display-annotations-label",children:"Display annotations"})})]}),(0,t.jsxs)(A.B,{gap:1,alignItems:"center",children:[(0,t.jsx)($e.b,{value:$s.value,showIcon:!0,disabled:!0,onChange:()=>{}}),(0,t.jsx)(Pe.m,{placement:"right",content:(0,E.t)("public-dashboard.configuration.time-range-tooltip","The shared dashboard uses the default time range settings of the dashboard"),children:(0,t.jsx)(o.I,{name:"info-circle",size:"sm"})})]})]})})}),Jn&&(0,t.jsx)(w.y,{})]})]})}const dt=s.Tp.pages.ShareDashboardModal.PublicDashboard.EmailSharingConfiguration,vt=({onDelete:sn,onReshare:Ln})=>(0,t.jsxs)(d.W,{children:[(0,t.jsx)(d.W.Item,{label:(0,E.t)("public-dashboard.email-sharing.resend-invite-label","Resend invite"),onClick:Ln}),(0,t.jsx)(d.W.Item,{label:(0,E.t)("public-dashboard.email-sharing.revoke-access-label","Revoke access"),destructive:!0,onClick:sn})]}),yt=({recipients:sn,dashboardUid:Ln,publicDashboard:Jn})=>{const gs=(0,a.of)(Ve),[kn,{isLoading:Gn}]=(0,ce.$L)(),[Gs,{isLoading:$s}]=(0,ce.NA)(),Is=Gn||$s,pa=(ua,sr)=>{I.c.revokePublicDashboardEmailClicked(),kn({recipientUid:ua,recipientEmail:sr,dashboardUid:Ln,uid:Jn.uid})},Ta=ua=>{I.c.resendPublicDashboardEmailClicked(),Gs({recipientUid:ua,uid:Jn.uid})};return(0,t.jsx)("table",{"data-testid":dt.EmailSharingList,className:gs.table,children:(0,t.jsx)("tbody",{children:sn.map((ua,sr)=>(0,t.jsxs)("tr",{className:gs.listItem,children:[(0,t.jsx)("td",{className:gs.user,children:(0,t.jsxs)(A.B,{direction:"row",gap:1,alignItems:"center",children:[(0,t.jsx)("div",{className:gs.icon,children:(0,t.jsx)(o.I,{name:"user"})}),(0,t.jsx)(ue.E,{children:ua.recipient})]})}),(0,t.jsx)("td",{children:Is&&(0,t.jsx)(w.y,{})}),(0,t.jsx)("td",{children:(0,t.jsx)(f.m,{overlay:(0,t.jsx)(vt,{onDelete:()=>pa(ua.uid,ua.recipient),onReshare:()=>Ta(ua.uid)}),children:(0,t.jsx)(De.K,{name:"ellipsis-v","aria-label":"email-menu",variant:"secondary",size:"lg"})})})]},ua.uid))})})},st=({dashboard:sn})=>{const Ln=(0,a.of)(Ve),{data:Jn}=ce.Sm.endpoints?.getPublicDashboard.useQueryState(sn.state.uid);return(0,t.jsx)(Ne.D,{label:(0,E.t)("public-dashboard.email-sharing.recipient-list-title","People with access"),description:(0,E.t)("public-dashboard.email-sharing.recipient-list-description","Only people you've directly invited can access this dashboard"),className:Ln.listField,children:Jn?.recipients?.length?(0,t.jsx)("div",{className:Ln.listContainer,children:(0,t.jsx)(yt,{recipients:Jn.recipients,dashboardUid:sn.state.uid,publicDashboard:Jn})}):(0,t.jsx)(t.Fragment,{})})},Ve=sn=>({listField:(0,i.css)({marginBottom:0}),listContainer:(0,i.css)({maxHeight:"140px",overflowY:"auto"}),table:(0,i.css)({width:"100%"}),listItem:(0,i.css)({display:"flex",alignItems:"center",gap:sn.spacing(.5),padding:sn.spacing(.75,1),color:sn.colors.text.secondary}),user:(0,i.css)({flex:1}),icon:(0,i.css)({border:`${sn.spacing(.25)} solid ${sn.colors.text.secondary}`,padding:sn.spacing(.125,.5),borderRadius:sn.shape.radius.circle,color:sn.colors.text.secondary})}),pe=s.Tp.pages.ShareDashboardModal.PublicDashboard.EmailSharingConfiguration,Ee=()=>{const{dashboard:sn}=(0,Ye.X)(),{data:Ln,isError:Jn}=ce.Sm.endpoints?.getPublicDashboard.useQueryState(sn.state.uid),[gs,{isLoading:kn}]=(0,ce.NY)(),Gn=D.TP.hasPermission(re.AccessControlAction.DashboardsPublicWrite),{register:Gs,handleSubmit:$s,formState:{errors:Is,isValid:pa},reset:Ta}=(0,je.mN)({defaultValues:{email:""},mode:"onSubmit"}),ua=async sr=>{I.c.publicDashboardEmailInviteClicked(),await gs({recipient:sr.email,uid:Ln.uid,dashboardUid:sn.state.uid}).unwrap(),Ta({email:""})};return(0,t.jsxs)("div",{children:[(0,t.jsx)("form",{onSubmit:$s(ua),children:(0,t.jsx)(Ze.n,{disabled:!Gn||Jn,children:(0,t.jsx)(Ne.D,{label:(0,t.jsxs)(A.B,{gap:1,alignItems:"center",children:[(0,t.jsx)(E.x6,{i18nKey:"public-dashboard.email-sharing.recipient-invitation-button",children:"Invite"}),(0,t.jsx)(Pe.m,{placement:"right",content:(0,E.t)("public-dashboard.email-sharing.recipient-invitation-tooltip","This dashboard contains sensitive data. By using this feature you will be sharing with external people."),children:(0,t.jsx)(o.I,{name:"info-circle",size:"sm"})})]}),description:(0,E.t)("public-dashboard.email-sharing.recipient-invitation-description","Invite someone by email"),error:Is.email?.message,invalid:!!Is.email?.message,children:(0,t.jsxs)(A.B,{direction:"row",children:[(0,t.jsx)(Ue.p,{placeholder:(0,E.t)("public-dashboard.email-sharing.recipient-email-placeholder","Email"),autoCapitalize:"none",loading:kn,...Gs("email",{required:(0,E.t)("public-dashboard.email-sharing.recipient-required-email-text","Email is required"),pattern:{value:ie._l,message:(0,E.t)("public-dashboard.email-sharing.recipient-invalid-email-text","Invalid email")}}),"data-testid":pe.EmailSharingInput}),(0,t.jsx)(p.$n,{type:"submit",variant:"primary",disabled:kn||!pa,"data-testid":pe.EmailSharingInviteButton,children:(0,t.jsx)(E.x6,{i18nKey:"public-dashboard.email-sharing.recipient-invitation-button",children:"Invite"})})]})})})}),(0,t.jsx)(st,{dashboard:sn}),(0,t.jsx)(oe.c,{}),(0,t.jsx)(qe,{})]})};var me=e(10880),ve=e(42418);const Se="https://grafana.com/docs/grafana/latest/dashboards/dashboard-public/#email-sharing";function Ie(){return(0,t.jsx)(ve.F,{title:"",severity:"info",bottomSpacing:0,children:(0,t.jsxs)(A.B,{justifyContent:"space-between",gap:2,alignItems:"center",children:[(0,t.jsx)(E.x6,{i18nKey:"public-dashboard.email-sharing.alert-text",children:"Sharing dashboards by email is billed per user for the duration of the 30-day token, regardless of how many dashboards are shared. Billing stops after 30 days unless you renew the token."}),(0,t.jsx)(p.$n,{variant:"secondary",onClick:()=>window.open(Se,"_blank"),type:"button",children:(0,t.jsx)(E.x6,{i18nKey:"public-dashboard.email-sharing.learn-more-button",children:"Learn more"})})]})})}const Oe=({hasError:sn})=>{const{dashboard:Ln}=(0,Ye.X)(),Jn=(0,a.of)(Re),[gs,{isLoading:kn,isError:Gn}]=(0,ce.U9)(),Gs=D.TP.hasPermission(re.AccessControlAction.DashboardsPublicWrite),$s=!Gs||kn||Gn||sn,{handleSubmit:Is,register:pa,formState:{isValid:Ta}}=(0,je.mN)({mode:"onChange"}),ua=()=>{I.c.generatePublicDashboardUrlClicked({share:ie.Xo.EMAIL}),gs({dashboard:Ln,payload:{share:ie.Xo.EMAIL,isEnabled:!0}})};return(0,t.jsxs)(t.Fragment,{children:[Gs&&(0,t.jsx)(Ie,{}),(0,t.jsx)("form",{onSubmit:Is(ua),children:(0,t.jsxs)(Ze.n,{disabled:$s,children:[(0,t.jsx)("div",{className:Jn.checkbox,children:(0,t.jsx)(me.S,{...pa("billAcknowledgment",{required:!0}),label:(0,E.t)("public-dashboard.email-sharing.bill-ack","I understand that adding users requires payment.*")})}),(0,t.jsxs)(A.B,{direction:"row",gap:1,alignItems:"center",children:[(0,t.jsx)(p.$n,{type:"submit",disabled:!Ta,children:(0,t.jsx)(E.x6,{i18nKey:"public-dashboard.email-sharing.accept-button",children:"Accept"})}),(0,t.jsx)(p.$n,{variant:"secondary",onClick:()=>Ln.closeModal(),children:(0,t.jsx)(E.x6,{i18nKey:"public-dashboard.email-sharing.cancel-button",children:"Cancel"})}),kn&&(0,t.jsx)(w.y,{})]})]})})]})},Re=sn=>({checkbox:(0,i.css)({marginBottom:sn.spacing(2)})}),he=()=>{const{dashboard:sn}=(0,Ye.X)(),{data:Ln,isError:Jn}=ce.Sm.endpoints?.getPublicDashboard.useQueryState(sn.state.uid);return(0,t.jsx)(t.Fragment,{children:Ln?(0,t.jsx)(Ee,{}):(0,t.jsx)(Oe,{hasError:Jn})})},Ce="https://grafana.com/docs/grafana/latest/dashboards/dashboard-public/",We=()=>(0,t.jsx)(ve.F,{title:"",severity:"info",bottomSpacing:0,children:(0,t.jsxs)(A.B,{justifyContent:"space-between",gap:2,alignItems:"center",children:[(0,t.jsx)(E.x6,{i18nKey:"public-dashboard.public-sharing.alert-text",children:"Sharing this dashboard externally makes it entirely accessible to anyone with the link."}),(0,t.jsx)(p.$n,{variant:"secondary",onClick:()=>window.open(Ce,"_blank"),type:"button",children:(0,t.jsx)(E.x6,{i18nKey:"public-dashboard.public-sharing.learn-more-button",children:"Learn more"})})]})});function et({hasError:sn}){const{dashboard:Ln}=(0,Ye.X)(),Jn=(0,a.of)(rt),gs=D.TP.hasPermission(re.AccessControlAction.DashboardsPublicWrite),{handleSubmit:kn,register:Gn,formState:{isValid:Gs}}=(0,je.mN)({mode:"onChange"}),[$s,{isLoading:Is,isError:pa}]=(0,ce.U9)(),Ta=()=>{I.c.generatePublicDashboardUrlClicked({share:ie.Xo.PUBLIC}),$s({dashboard:Ln,payload:{share:ie.Xo.PUBLIC,isEnabled:!0}})},ua=!gs||Is||pa||sn;return(0,t.jsxs)(t.Fragment,{children:[gs&&(0,t.jsx)(We,{}),(0,t.jsx)("form",{onSubmit:kn(Ta),children:(0,t.jsxs)(Ze.n,{disabled:ua,children:[(0,t.jsx)("div",{className:Jn.checkbox,children:(0,t.jsx)(me.S,{...Gn("publicAcknowledgment",{required:!0}),label:(0,E.t)("public-dashboard.public-sharing.public-ack","I understand that this entire dashboard will be public.*")})}),(0,t.jsxs)(A.B,{direction:"row",gap:1,alignItems:"center",children:[(0,t.jsx)(p.$n,{type:"submit",disabled:!Gs,children:(0,t.jsx)(E.x6,{i18nKey:"public-dashboard.public-sharing.accept-button",children:"Accept"})}),(0,t.jsx)(p.$n,{variant:"secondary",onClick:()=>Ln.closeModal(),children:(0,t.jsx)(E.x6,{i18nKey:"public-dashboard.public-sharing.cancel-button",children:"Cancel"})}),Is&&(0,t.jsx)(w.y,{})]})]})})]})}const rt=sn=>({checkbox:(0,i.css)({marginBottom:sn.spacing(2)})});function nt(){const{dashboard:sn}=(0,Ye.X)(),{data:Ln,isError:Jn}=ce.Sm.endpoints?.getPublicDashboard.useQueryState(sn.state.uid);return(0,t.jsx)(t.Fragment,{children:Ln?(0,t.jsx)(qe,{}):(0,t.jsx)(et,{hasError:Jn})})}var gt=e(12257),xt=e(10872),St=e(29304),zt=e(59995);function Nt({publicDashboard:sn}){const{dashboard:Ln}=(0,Ye.X)(),Jn=D.TP.hasPermission(re.AccessControlAction.DashboardsPublicWrite),gs=(0,zt.b)(Ln),kn=(Ln.state.$variables?.state.variables.length??0)>0;return(0,t.jsxs)(t.Fragment,{children:[Jn&&kn&&(0,t.jsx)(xt.D,{showDescription:!1}),!Jn&&(0,t.jsx)(St.t,{mode:sn?"edit":"create"}),Jn&&!!gs?.length&&(0,t.jsx)(gt.s,{unsupportedDataSources:gs.join(", ")}),sn?.share===ie.Xo.EMAIL&&(0,ie.AY)()&&(0,t.jsx)(Ie,{})]})}var Vt=e(8887),en=e(90182);const Je=s.Tp.pages.ShareDashboardDrawer.ShareExternally;function ct({setShareType:sn,options:Ln,value:Jn}){const{dashboard:gs}=(0,Ye.X)(),kn=(0,a.of)(ot),{data:Gn}=ce.Sm.endpoints?.getPublicDashboard.useQueryState(gs.state.uid),[Gs,{isLoading:$s}]=(0,ce.ft)(),Is=D.TP.hasPermission(re.AccessControlAction.DashboardsPublicWrite),pa=pt(),Ta=ua=>{if(!Gn)return;I.c.publicDashboardShareTypeChange({shareType:ua===ie.Xo.EMAIL?"email":"public"});const sr={dashboard:gs,payload:{...Gn,share:ua}};Gs(sr)};return(0,t.jsxs)("div",{children:[(0,t.jsxs)(A.B,{justifyContent:"space-between",children:[(0,t.jsx)(N.J,{description:Jn.description,children:(0,t.jsx)(E.x6,{i18nKey:"public-dashboard.share-configuration.share-type-label",children:"Link access"})}),$s&&(0,t.jsx)(w.y,{})]}),(0,ie.AY)()?(0,t.jsx)(en.l6,{"data-testid":Je.shareTypeSelect,options:Ln,value:Jn,disabled:!Is,onChange:ua=>{sn(ua),Ta(ua.value)},className:kn.select}):(0,t.jsxs)(t.Fragment,{children:[(0,Vt.Uo)(pa.icon)&&(0,t.jsx)(o.I,{name:(0,Vt.Uo)(pa.icon)}),(0,t.jsx)(ue.E,{children:pa.label})]})]})}const ot=()=>({select:(0,i.css)({flex:1})}),Qe=s.Tp.pages.ShareDashboardDrawer.ShareExternally,pt=()=>({label:(0,E.t)("public-dashboard.share-externally.public-share-type-option-label","Anyone with the link"),description:(0,E.t)("public-dashboard.share-externally.public-share-type-option-description","Anyone with the link can access dashboard"),value:ie.Xo.PUBLIC,icon:"globe"}),Pt=()=>({label:(0,E.t)("public-dashboard.share-externally.email-share-type-option-label","Only specific people"),description:(0,E.t)("public-dashboard.share-externally.email-share-type-option-description","Only people with the link can access dashboard"),value:ie.Xo.EMAIL,icon:"users-alt"}),At=()=>(0,ie.AY)()?[Pt(),pt()]:[pt()];class mn extends Z.Bs{static{this.Component=Pn}}function Pn({model:sn}){const[Ln,Jn]=(0,n.useState)(!1),gs=(0,a.of)(Kn),kn=(0,H.YQ)(sn),{data:Gn,isLoading:Gs}=(0,ce.Bs)(kn.state.uid),[$s,{isLoading:Is}]=(0,ce.bN)(),pa=()=>{Jn(!0)},Ta=async()=>{I.c.revokePublicDashboardClicked(),await $s({dashboard:kn,uid:Gn.uid,dashboardUid:kn.state.uid}).unwrap(),Jn(!1)};return Gs?(0,t.jsx)(ye.a,{}):Ln?(0,t.jsx)(Te,{title:(0,E.t)("public-dashboard.share-externally.revoke-access-button","Revoke access"),confirmButtonLabel:(0,E.t)("public-dashboard.share-externally.revoke-access-button","Revoke access"),onConfirm:Ta,onDismiss:()=>Jn(!1),description:(0,E.t)("public-dashboard.share-externally.revoke-access-description","Are you sure you want to revoke this access? The dashboard can no longer be shared."),isActionLoading:Is}):(0,t.jsx)("div",{className:gs.container,children:(0,t.jsx)(fn,{publicDashboard:Gn,onRevokeClick:pa})})}function fn({publicDashboard:sn,onRevokeClick:Ln}){const Jn=At(),gs=(0,n.useMemo)(()=>sn&&(0,ie.AY)()?Jn.find(Is=>Is.value===sn?.share)??Jn[0]:Jn[0],[sn,Jn]),[kn,Gn]=(0,n.useState)(gs),Gs=(0,n.useMemo)(()=>kn.value===ie.Xo.EMAIL&&(0,ie.AY)()?(0,t.jsx)(he,{}):(0,t.jsx)(nt,{}),[kn]);return(0,t.jsxs)(A.B,{direction:"column",gap:2,"data-testid":Qe.container,children:[(0,t.jsx)(Nt,{publicDashboard:sn}),(0,t.jsx)(ct,{setShareType:Gn,value:kn,options:Jn}),Gs,sn&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(oe.c,{spacing:0}),(0,t.jsx)(Rn,{publicDashboard:sn,onRevokeClick:Ln})]})]})}function Rn({publicDashboard:sn,onRevokeClick:Ln}){const{dashboard:Jn}=(0,Ye.X)(),[gs,{isLoading:kn}]=(0,ce.eq)(),Gn=(0,a.of)(Kn),Gs=D.TP.hasPermission(re.AccessControlAction.DashboardsPublicWrite);function $s(){I.c.publicDashboardUrlCopied()}const Is=async()=>{I.c.publicDashboardPauseSharingClicked({paused:!sn.isEnabled}),gs({dashboard:Jn,payload:{...sn,isEnabled:!sn.isEnabled}})};return(0,t.jsxs)(A.B,{alignItems:"center",direction:{xs:"column",sm:"row"},children:[(0,t.jsx)("div",{className:Gn.actionsContainer,children:(0,t.jsxs)(A.B,{gap:1,flex:1,direction:{xs:"column",sm:"row"},children:[(0,t.jsx)(B.b,{"data-testid":Qe.copyUrlButton,variant:"primary",fill:"outline",icon:"link",getText:()=>(0,ie.mL)(sn.accessToken),onClipboardCopy:$s,children:(0,t.jsx)(E.x6,{i18nKey:"public-dashboard.share-externally.copy-link-button",children:"Copy external link"})}),(0,t.jsx)(p.$n,{icon:"trash-alt",variant:"destructive",fill:"outline",disabled:kn||!Gs,onClick:Ln,children:(0,t.jsx)(E.x6,{i18nKey:"public-dashboard.share-externally.revoke-access-button",children:"Revoke access"})}),(0,t.jsx)(p.$n,{icon:sn.isEnabled?"pause":"play",variant:"secondary",fill:"outline",tooltip:sn.isEnabled?(0,E.t)("public-dashboard.share-externally.pause-access-tooltip","Pausing will temporarily disable access to this dashboard for all users"):"",onClick:Is,disabled:kn||!Gs,children:sn.isEnabled?(0,t.jsx)(E.x6,{i18nKey:"public-dashboard.share-externally.pause-access-button",children:"Pause access"}):(0,t.jsx)(E.x6,{i18nKey:"public-dashboard.share-externally.resume-access-button",children:"Resume access"})})]})}),kn&&(0,t.jsx)(w.y,{})]})}const Kn=sn=>({container:(0,i.css)({paddingBottom:sn.spacing(2)}),actionsContainer:(0,i.css)({width:"100%"})});var Bt=e(95007),an=e(58398),tn=e(7030);const Cn={useAbsoluteTimeRange:!0,useShortUrl:!0,theme:"current"},xn=async(sn,Ln)=>{const{useAbsoluteTimeRange:Jn,useShortUrl:gs,theme:kn}=Et();return I.c.shareLinkCopied({currentTimeRange:Jn,theme:kn,shortenURL:gs,shareResource:(0,O.hD)(Ln?.getRef())}),await(0,tn.Sp)(sn,{useAbsoluteTimeRange:Jn,theme:kn,useShortUrl:gs})},Vn="grafana.dashboard.link.shareConfiguration";function Et(){return x.A.exists(Vn)&&x.A.getObject(Vn)||Cn}function Ft(sn){x.A.setObject(Vn,sn)}class Gt extends an.R{static{this.Component=ln}constructor(Ln){const{useAbsoluteTimeRange:Jn,useShortUrl:gs,theme:kn}=Et();super({...Ln,useLockedTime:Jn,useShortUrl:gs,selectedTheme:kn}),this.onToggleLockedTime=this.onToggleLockedTime.bind(this),this.onUrlShorten=this.onUrlShorten.bind(this),this.onThemeChange=this.onThemeChange.bind(this)}async onToggleLockedTime(){const Ln=!this.state.useLockedTime;Ft({useAbsoluteTimeRange:Ln,useShortUrl:this.state.useShortUrl,theme:this.state.selectedTheme}),await super.onToggleLockedTime()}async onUrlShorten(){const Ln=!this.state.useShortUrl;Ft({useShortUrl:Ln,useAbsoluteTimeRange:this.state.useLockedTime,theme:this.state.selectedTheme}),await super.onUrlShorten()}async onThemeChange(Ln){Ft({theme:Ln,useShortUrl:this.state.useShortUrl,useAbsoluteTimeRange:this.state.useLockedTime}),await super.onThemeChange(Ln)}}function ln({model:sn}){const Ln=(0,a.of)(qt),{useLockedTime:Jn,useShortUrl:gs,selectedTheme:kn,isBuildUrlLoading:Gn}=sn.useState();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(ve.F,{severity:"info",title:(0,E.t)("link.share.config-alert-title","Link configuration"),children:(0,t.jsx)(E.x6,{i18nKey:"link.share.config-alert-description",children:"Updating your settings will modify the default copy link to include these changes."})}),(0,t.jsx)("div",{className:Ln.configDescription,children:(0,t.jsx)(ue.E,{variant:"body",children:(0,t.jsx)(E.x6,{i18nKey:"link.share.config-description",children:"Create a personalized, direct link to share your dashboard within your organization, with the following customization settings:"})})}),(0,t.jsx)(Bt.A,{useLockedTime:Jn,onToggleLockedTime:sn.onToggleLockedTime,useShortUrl:gs,onUrlShorten:sn.onUrlShorten,selectedTheme:kn,onChangeTheme:sn.onThemeChange,isLoading:Gn}),(0,t.jsx)(oe.c,{spacing:1}),(0,t.jsx)(B.b,{icon:"link",variant:"primary",fill:"outline",disabled:Gn,getText:sn.getShareUrl,onClipboardCopy:sn.onCopy,className:Ln.copyButtonContainer,children:(0,t.jsx)(E.x6,{i18nKey:"link.share.copy-link-button",children:"Copy link"})})]})}const qt=sn=>({configDescription:(0,i.css)({marginBottom:sn.spacing(2)}),copyButtonContainer:(0,i.css)({marginTop:sn.spacing(2)})});var cn=e(5805),En=e(12962),Sn=e(94354),Tn=e(72109),Wn=e(76412);const Nn="https://grafana.com/docs/grafana/latest/dashboards/share-dashboards-panels/#publish-a-snapshot";function Tt({name:sn,onNameChange:Ln,onExpireChange:Jn,selectedExpireOption:gs,sharingOptions:kn,onCancelClick:Gn,onCreateClick:Gs,isLoading:$s}){const Is=(0,a.of)(Wt);return(0,t.jsxs)("div",{className:Is.container,children:[(0,t.jsx)(ve.F,{severity:"info",title:"",children:(0,t.jsxs)(A.B,{justifyContent:"space-between",gap:2,alignItems:"center",children:[(0,t.jsx)(ue.E,{children:(0,t.jsx)(E.x6,{i18nKey:"snapshot.share.info-alert",children:"A Grafana dashboard snapshot publicly shares a dashboard while removing sensitive data such as queries and panel links, leaving only visible metrics and series names. Anyone with the link can access the snapshot."})}),(0,t.jsx)(p.$n,{variant:"secondary",onClick:()=>window.open(Nn,"_blank"),type:"button",children:(0,t.jsx)(E.x6,{i18nKey:"snapshot.share.learn-more-button",children:"Learn more"})})]})}),(0,t.jsx)(Ne.D,{label:(0,Wn.t)("snapshot.share.name-label","Snapshot name*"),children:(0,t.jsx)(Ue.p,{id:"snapshot-name-input",defaultValue:sn,onBlur:pa=>Ln(pa.target.value)})}),(0,t.jsx)(Ne.D,{label:(0,Wn.t)("snapshot.share.expiration-label","Expires in"),children:(0,t.jsx)(Sn.z,{id:"expire-select-input",options:(0,En.u)(),value:gs?.value,onChange:Jn})}),(0,t.jsx)(oe.c,{}),(0,t.jsxs)(A.B,{justifyContent:"space-between",direction:{xs:"column",xl:"row"},children:[(0,t.jsxs)(A.B,{gap:1,flex:1,direction:{xs:"column",sm:"row"},children:[(0,t.jsx)(p.$n,{variant:"primary",disabled:$s,onClick:()=>Gs(),children:(0,t.jsx)(E.x6,{i18nKey:"snapshot.share.local-button",children:"Publish snapshot"})}),kn?.externalEnabled&&(0,t.jsx)(p.$n,{variant:"secondary",disabled:$s,onClick:()=>Gs(!0),children:kn?.externalSnapshotName}),(0,t.jsx)(p.$n,{variant:"secondary",fill:"outline",onClick:Gn,children:(0,t.jsx)(E.x6,{i18nKey:"snapshot.share.cancel-button",children:"Cancel"})}),$s&&(0,t.jsx)(w.y,{})]}),(0,t.jsx)(Tn.Y,{icon:"external-link-alt",href:"/dashboard/snapshots",children:(0,Wn.t)("snapshot.share.view-all-button","View all snapshots")})]})]})}const Wt=sn=>({container:(0,i.css)({paddingBottom:sn.spacing(2)})}),jt=({url:sn,onDeleteClick:Ln,onNewSnapshotClick:Jn})=>(0,t.jsxs)(A.B,{justifyContent:"flex-start",gap:1,direction:{xs:"column",sm:"row"},children:[(0,t.jsx)(B.b,{icon:"link",variant:"primary",fill:"outline",getText:()=>sn,children:(0,t.jsx)(E.x6,{i18nKey:"snapshot.share.copy-link-button",children:"Copy link"})}),(0,t.jsx)(p.$n,{icon:"trash-alt",variant:"destructive",fill:"outline",onClick:Ln,children:(0,t.jsx)(E.x6,{i18nKey:"snapshot.share.delete-button",children:"Delete snapshot"})}),(0,t.jsx)(p.$n,{variant:"secondary",fill:"solid",onClick:Jn,children:(0,t.jsx)(E.x6,{i18nKey:"snapshot.share.new-snapshot-button",children:"New snapshot"})})]}),ut=s.Tp.pages.ShareDashboardDrawer.ShareSnapshot;class Zt extends En.l{static{this.Component=jn}}function jn({model:sn}){const[Ln,Jn]=(0,n.useState)(!1),[gs,kn]=(0,n.useState)(!1),[Gn,Gs]=(0,n.useState)(1),{snapshotName:$s,snapshotSharingOptions:Is,selectedExpireOption:pa,dashboardRef:Ta}=sn.useState(),[ua,sr]=(0,cn.default)(async(xr=!1)=>{const Sr=await sn.onSnapshotCreate(xr);return Gs(2),Sr}),[ma,ar]=(0,cn.default)(async xr=>{const Sr=await sn.onSnapshotDelete(xr);return Gs(1),Jn(!1),kn(!0),Sr}),Ya=()=>{Ta.resolve().closeModal()};return Ln?(0,t.jsx)(Te,{title:(0,E.t)("snapshot.share.delete-title","Delete snapshot"),confirmButtonLabel:(0,E.t)("snapshot.share.delete-button","Delete snapshot"),onConfirm:()=>ar(ua.value?.deleteUrl),onDismiss:()=>Jn(!1),description:(0,E.t)("snapshot.share.delete-description","Are you sure you want to delete this snapshot?"),isActionLoading:ma.loading}):(0,t.jsxs)("div",{"data-testid":ut.container,children:[Gn===1&&(0,t.jsxs)(t.Fragment,{children:[gs&&(0,t.jsx)(ve.F,{severity:"info",title:"",onRemove:()=>kn(!1),children:(0,t.jsx)(E.x6,{i18nKey:"snapshot.share.deleted-alert",children:"Your snapshot has been deleted. It might take up to an hour before the snapshot is cleared from any CDN caches."})}),(0,t.jsx)(Tt,{name:$s??"",selectedExpireOption:pa,sharingOptions:Is,onNameChange:sn.onSnasphotNameChange,onCancelClick:Ya,onExpireChange:sn.onExpireChange,onCreateClick:sr,isLoading:ua.loading})]}),Gn===2&&(0,t.jsx)(jt,{url:ua.value.url,onDeleteClick:()=>Jn(!0),onNewSnapshotClick:()=>Gs(1)})]})}const Xn=s.Tp.pages.Dashboard.DashNav.newShareButton.menu,Qn=[];function Fn(sn){Qn.push(sn)}function qn({dashboard:sn,panel:Ln}){const Jn=(0,n.useCallback)((Gn,Gs)=>{const $s=new T.j({title:Gn,body:new Gs({dashboardRef:sn.getRef(),panelRef:Ln?.getRef()})});sn.showModal($s)},[sn,Ln]),gs=(0,n.useCallback)(()=>{const Gn=[];return Gn.push({shareId:O.wr.link,testId:Xn.shareInternally,icon:"building",label:(0,E.t)("share-dashboard.menu.share-internally-title","Share internally"),description:(0,E.t)("share-dashboard.menu.share-internally-description","Advanced settings"),renderCondition:!0,onClick:()=>Jn((0,E.t)("share-dashboard.menu.share-internally-title","Share internally"),Gt)}),Gn.push({shareId:O.wr.publicDashboard,testId:Xn.shareExternally,icon:"share-alt",label:(0,E.t)("share-dashboard.menu.share-externally-title","Share externally"),renderCondition:!Ln&&(0,ie.iR)(),onClick:()=>{Jn((0,E.t)("share-dashboard.menu.share-externally-title","Share externally"),mn)}}),Qn.forEach(Gs=>Gn.push(Gs)),Gn.push({shareId:O.wr.snapshot,testId:Xn.shareSnapshot,icon:"camera",label:(0,E.t)("share-dashboard.menu.share-snapshot-title","Share snapshot"),renderCondition:D.TP.isSignedIn&&r.$.snapshotEnabled&&sn.canEditDashboard(),onClick:()=>{Jn((0,E.t)("share-dashboard.menu.share-snapshot-title","Share snapshot"),Zt)}}),Gn.filter(Gs=>Gs.renderCondition)},[Jn,sn,Ln]),kn=Gn=>{I.c.sharingCategoryClicked({item:Gn.shareId,shareResource:(0,O.hD)(Ln?.getRef())}),Gn.onClick(sn)};return(0,t.jsx)(d.W,{"data-testid":Xn.container,children:gs().map(Gn=>(0,t.jsx)(d.W.Item,{testId:Gn.testId,label:Gn.label,icon:Gn.icon,description:Gn.description,onClick:()=>kn(Gn)},Gn.label))})}const js=s.Tp.pages.Dashboard.DashNav.newShareButton;function ys({dashboard:sn,panel:Ln}){const[Jn,gs]=(0,n.useState)(!1),[kn,Gn]=(0,se.A)(async()=>await xn(sn,Ln),[sn]),Gs=(0,n.useCallback)(Is=>{Is&&I.c.toolbarShareClick(),gs(Is)},[]),$s=()=>(0,t.jsx)(qn,{dashboard:sn});return(0,t.jsxs)(m.e,{"data-testid":js.container,children:[(0,t.jsx)(p.$n,{"data-testid":js.shareLink,size:"sm",tooltip:(0,E.t)("share-dashboard.share-button-tooltip","Copy shortened link"),onClick:Gn,children:(0,t.jsx)(E.x6,{i18nKey:"share-dashboard.share-button",children:"Share"})}),(0,t.jsx)(f.m,{overlay:$s,placement:"bottom-end",onVisibleChange:Gs,children:(0,t.jsx)(p.$n,{"data-testid":js.arrowMenu,size:"sm",icon:Jn?"angle-up":"angle-down"})})]})}var Ps=e(85174),es=e(99246),_s=e(80997),ca=e(96374),Ks=e(28138),Zs=e(28444);function nr(sn){return(0,t.jsx)(c.I,{"data-testid":"button-snapshot",tooltip:(0,E.t)("dashboard.toolbar.open-original","Open original dashboard"),icon:"link",onClick:()=>lr(sn.originalURL)},"button-snapshot")}const lr=sn=>{const Ln=sn??"",Jn=_s.sQ.sanitizeUrl(Ln);try{const gs=new URL(Jn,r.$.appUrl),kn=new URL(r.$.appUrl);gs.host!==kn.host?Ks.A.publish(new Zs.S8({component:ca.u,props:{title:"Proceed to external site?",modalClass:(0,i.css)({width:"max-content",maxWidth:"80vw"}),body:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("p",{children:["This link connects to an external website at"," ",(0,t.jsx)("code",{children:Ln})]}),(0,t.jsx)("p",{children:"Are you sure you'd like to proceed?"})]}),confirmVariant:"primary",confirmText:"Proceed",onConfirm:()=>{window.location.href=gs.href}}})):g.Ny.push(Jn)}catch(gs){console.error("Failed to open original dashboard",gs)}};var ga=e(60656);const $a=n.memo(({dashboard:sn})=>{const Ln=(0,n.useId)(),Jn=(0,t.jsx)(Za,{dashboard:sn},Ln);return(0,t.jsx)(l.H,{actions:Jn})});$a.displayName="NavToolbarActions";function Za({dashboard:sn}){const{isEditing:Ln,viewPanelScene:Jn,isDirty:gs,uid:kn,meta:Gn,editview:Gs,editPanel:$s,editable:Is}=sn.useState(),{isPlaying:pa}=b._o.useState(),[Ta,ua]=(0,n.useState)(!1),sr=D.TP.hasEditPermissionInFolders,ma=[],ar=(0,a.of)(cr),Ya=!!$s,xr=!!Jn,Sr=Ea($s),Yr=Va($s),Hr=x.A.exists(u.tH),Rr=!Gs&&!xr&&!Ya,lo=Ln&&Rr;Ya||mr(ma,es.C.left,"left-actions"),ma.push({group:"icon-actions",condition:kn&&!!Gn.canStar&&Rr&&!Ln,render:()=>{let Er=Gn.isStarred?(0,E.t)("dashboard.toolbar.unmark-favorite","Unmark as favorite"):(0,E.t)("dashboard.toolbar.mark-favorite","Mark as favorite");return(0,t.jsx)(c.I,{tooltip:Er,icon:(0,t.jsx)(o.I,{name:Gn.isStarred?"favorite":"star",size:"lg",type:Gn.isStarred?"mono":"default"}),"data-testid":s.Tp.components.NavToolbar.markAsFavorite,onClick:()=>{I.c.toolbarFavoritesClick(),sn.onStarDashboard()}},"star-dashboard-button")}}),Gn.publicDashboardEnabled&&ma.push({group:"icon-actions",condition:kn&&!!Gn.canStar&&Rr&&!Ln,render:()=>(0,t.jsx)(h.E,{color:"blue",text:"Public",className:ar.publicBadge,"data-testid":s.Tp.pages.Dashboard.DashNav.publicDashboardTag},"public-dashboard-button-badge")});const Bo=r.$.buildInfo.env==="development";ma.push({group:"icon-actions",condition:Bo&&kn&&Rr&&!Ln,render:()=>(0,t.jsx)(c.I,{tooltip:"Switch to old dashboard page",icon:"apps",onClick:()=>{g.Ny.partial({scenes:!1})}},"view-in-old-dashboard-button")}),ma.push({group:"icon-actions",condition:Gn.isSnapshot&&!Gn.dashboardNotFound&&!Ln,render:()=>(0,t.jsx)(nr,{originalURL:sn.getInitialSaveModel()?.snapshot?.originalUrl??""},"go-to-snapshot-origin")}),!Ya&&!Ln&&mr(ma,es.C.right,"icon-actions"),ma.push({group:"add-panel",condition:lo,render:()=>(0,t.jsx)(f.m,{onVisibleChange:Er=>{ua(Er),I.c.toolbarAddClick()},overlay:()=>(0,t.jsxs)(d.W,{children:[(0,t.jsx)(d.W.Item,{testId:s.Tp.pages.AddDashboard.itemButton("Add new visualization menu item"),label:(0,E.t)("dashboard.add-menu.visualization","Visualization"),onClick:()=>{const Er=sn.onCreateNewPanel();I.c.toolbarAddButtonClicked({item:"add_visualization"}),sn.setState({editPanel:(0,M.L)(Er,!0)})}},"add-visualization"),(0,t.jsx)(d.W.Item,{testId:s.Tp.pages.AddDashboard.itemButton("Add new panel from panel library menu item"),label:(0,E.t)("dashboard.add-menu.import","Import from library"),onClick:()=>{sn.onShowAddLibraryPanelDrawer(),I.c.toolbarAddButtonClicked({item:"add_library_panel"})}},"add-panel-lib"),(0,t.jsx)(d.W.Item,{testId:s.Tp.pages.AddDashboard.itemButton("Add new row menu item"),label:(0,E.t)("dashboard.add-menu.row","Row"),onClick:()=>{sn.onCreateNewRow(),I.c.toolbarAddButtonClicked({item:"add_row"})}},"add-row"),(0,t.jsx)(d.W.Item,{disabled:!Hr,testId:s.Tp.pages.AddDashboard.itemButton("Add new panel from clipboard menu item"),label:(0,E.t)("dashboard.add-menu.paste-panel","Paste panel"),onClick:()=>{sn.pastePanel(),I.c.toolbarAddButtonClicked({item:"paste_panel"})}},"paste-panel")]}),placement:"bottom",offset:[0,6],children:(0,t.jsxs)(p.$n,{variant:"primary",size:"sm",fill:"outline","data-testid":s.Tp.components.PageToolbar.itemButton("Add button"),children:[(0,t.jsx)(E.x6,{i18nKey:"dashboard.toolbar.add",children:"Add"}),(0,t.jsx)(o.I,{name:Ta?"angle-up":"angle-down",size:"lg"})]},"add-panel-button")},"add-panel-dropdown")}),ma.push({group:"playlist-actions",condition:pa&&Rr&&!Ln,render:()=>(0,t.jsx)(c.I,{"data-testid":s.Tp.pages.Dashboard.DashNav.playlistControls.prev,tooltip:(0,E.t)("dashboard.toolbar.playlist-previous","Go to previous dashboard"),icon:"backward",onClick:()=>b._o.prev()},"play-list-prev")}),ma.push({group:"playlist-actions",condition:pa&&Rr&&!Ln,render:()=>(0,t.jsx)(c.I,{onClick:()=>b._o.stop(),"data-testid":s.Tp.pages.Dashboard.DashNav.playlistControls.stop,children:(0,t.jsx)(E.x6,{i18nKey:"dashboard.toolbar.playlist-stop",children:"Stop playlist"})},"play-list-stop")}),ma.push({group:"playlist-actions",condition:pa&&Rr&&!Ln,render:()=>(0,t.jsx)(c.I,{"data-testid":s.Tp.pages.Dashboard.DashNav.playlistControls.next,tooltip:(0,E.t)("dashboard.toolbar.playlist-next","Go to next dashboard"),icon:"forward",onClick:()=>b._o.next(),narrow:!0},"play-list-next")}),ma.push({group:"back-button",condition:(xr||Ya)&&!Yr,render:()=>(0,t.jsx)(p.$n,{onClick:()=>{g.Ny.partial({viewPanel:null,editPanel:null})},tooltip:"",variant:"secondary",size:"sm",icon:"arrow-left","data-testid":s.Tp.components.NavToolbar.editDashboard.backToDashboardButton,children:"Back to dashboard"},"back")}),ma.push({group:"back-button",condition:!!Gs,render:()=>(0,t.jsx)(p.$n,{onClick:()=>{g.Ny.partial({editview:null})},tooltip:"",fill:"text",variant:"secondary",size:"sm",icon:"arrow-left","data-testid":s.Tp.components.NavToolbar.editDashboard.backToDashboardButton,children:"Back to dashboard"},"back")});const po=kn&&!Ln&&!Gn.isSnapshot&&!pa;ma.push({group:"main-buttons",condition:!r.$.featureToggles.newDashboardSharingComponent&&po,render:()=>(0,t.jsx)(p.$n,{tooltip:(0,E.t)("dashboard.toolbar.share","Share dashboard"),size:"sm",className:ar.buttonWithExtraMargin,fill:"outline",onClick:()=>{I.c.toolbarShareClick(),sn.showModal(new Ps.Z({}))},"data-testid":s.Tp.components.NavToolbar.shareDashboard,children:"Share"},"share-dashboard-button")}),ma.push({group:"main-buttons",condition:!Ln&&sn.canEditDashboard()&&!xr&&!pa&&Is,render:()=>(0,t.jsx)(p.$n,{onClick:()=>{sn.onEnterEditMode()},tooltip:"Enter edit mode",className:ar.buttonWithExtraMargin,variant:r.$.featureToggles.newDashboardSharingComponent?"secondary":"primary",size:"sm","data-testid":s.Tp.components.NavToolbar.editDashboard.editButton,children:"Edit"},"edit")}),ma.push({group:"main-buttons",condition:!Ln&&sn.canEditDashboard()&&!xr&&!pa&&!Is,render:()=>(0,t.jsx)(p.$n,{onClick:()=>{sn.onEnterEditMode(),sn.setState({editable:!0,meta:{...Gn,canEdit:!0}})},tooltip:"This dashboard was marked as read only",className:ar.buttonWithExtraMargin,variant:"secondary",size:"sm","data-testid":s.Tp.components.NavToolbar.editDashboard.editButton,children:"Make editable"},"edit")}),ma.push({group:"new-share-dashboard-buttons",condition:r.$.featureToggles.newDashboardSharingComponent&&po,render:()=>(0,t.jsx)(ee,{dashboard:sn},"new-export-dashboard-button")}),ma.push({group:"new-share-dashboard-buttons",condition:r.$.featureToggles.newDashboardSharingComponent&&po,render:()=>(0,t.jsx)(ys,{dashboard:sn},"new-share-dashboard-button")}),ma.push({group:"settings",condition:Ln&&sn.canEditDashboard()&&Rr,render:()=>(0,t.jsx)(p.$n,{onClick:()=>{sn.onOpenSettings()},tooltip:"Dashboard settings",fill:"text",size:"sm",variant:"secondary","data-testid":s.Tp.components.NavToolbar.editDashboard.settingsButton,children:"Settings"},"settings")}),ma.push({group:"main-buttons",condition:Ln&&!Gn.isNew&&Rr,render:()=>(0,t.jsx)(p.$n,{onClick:()=>sn.exitEditMode({skipConfirm:!1}),tooltip:"Exits edit mode and discards unsaved changes",size:"sm",fill:"text",variant:"primary","data-testid":s.Tp.components.NavToolbar.editDashboard.exitButton,children:"Exit edit"},"discard")}),ma.push({group:"main-buttons",condition:Ya&&!Yr&&!Gs&&!xr,render:()=>(0,t.jsx)(p.$n,{onClick:$s?.onDiscard,tooltip:$s?.state.isNewPanel?"Discard panel":"Discard panel changes",size:"sm",disabled:!Sr||!gs,fill:"outline",variant:"destructive","data-testid":s.Tp.components.NavToolbar.editDashboard.discardChangesButton,children:$s?.state.isNewPanel?"Discard panel":"Discard panel changes"},"discard")}),ma.push({group:"main-buttons",condition:Ya&&Yr&&!Gs&&!xr,render:()=>(0,t.jsx)(p.$n,{onClick:$s?.onDiscard,tooltip:"Discard library panel changes",size:"sm",fill:"outline",variant:"destructive","data-testid":s.Tp.components.NavToolbar.editDashboard.discardChangesButton,children:"Discard library panel changes"},"discardLibraryPanel")}),ma.push({group:"main-buttons",condition:Ya&&Yr&&!Gs&&!xr,render:()=>(0,t.jsx)(p.$n,{onClick:$s?.onUnlinkLibraryPanel,tooltip:"Unlink library panel",size:"sm",fill:"outline",variant:"secondary","data-testid":s.Tp.components.NavToolbar.editDashboard.unlinkLibraryPanelButton,children:"Unlink library panel"},"unlinkLibraryPanel")}),ma.push({group:"main-buttons",condition:Ya&&Yr&&!Gs&&!xr,render:()=>(0,t.jsx)(p.$n,{onClick:$s?.onSaveLibraryPanel,tooltip:"Save library panel",size:"sm",fill:"outline",variant:"primary","data-testid":s.Tp.components.NavToolbar.editDashboard.saveLibraryPanelButton,children:"Save library panel"},"saveLibraryPanel")}),ma.push({group:"main-buttons",condition:Ln&&!Yr&&(Gn.canSave||sr),render:()=>{if(Gn.isNew)return(0,t.jsx)(p.$n,{onClick:()=>{sn.openSaveDrawer({})},className:ar.buttonWithExtraMargin,tooltip:"Save changes",size:"sm",variant:"primary","data-testid":s.Tp.components.NavToolbar.editDashboard.saveButton,children:"Save dashboard"},"save");if(sr&&!Gn.canSave&&!Gn.canMakeEditable)return(0,t.jsx)(p.$n,{onClick:()=>{sn.openSaveDrawer({saveAsCopy:!0})},className:ar.buttonWithExtraMargin,tooltip:"Save as copy",size:"sm",variant:gs?"primary":"secondary",children:"Save as copy"},"save");const Er=(0,t.jsxs)(d.W,{children:[(0,t.jsx)(d.W.Item,{label:"Save",icon:"save",onClick:()=>{sn.openSaveDrawer({})}}),(0,t.jsx)(d.W.Item,{label:"Save as copy",icon:"copy",onClick:()=>{sn.openSaveDrawer({saveAsCopy:!0})}})]});return(0,t.jsxs)(m.e,{className:ar.buttonWithExtraMargin,children:[(0,t.jsx)(p.$n,{onClick:()=>{sn.openSaveDrawer({})},tooltip:"Save changes",size:"sm","data-testid":s.Tp.components.NavToolbar.editDashboard.saveButton,variant:gs?"primary":"secondary",children:"Save dashboard"}),(0,t.jsx)(f.m,{overlay:Er,children:(0,t.jsx)(p.$n,{"aria-label":"More save options",icon:"angle-down",variant:gs?"primary":"secondary",size:"sm"})})]},"save")}});const vr=[];let Ur="";for(const Er of ma)Er.condition&&(Ur&&Ur!==Er.group&&Ur&&vr.push((0,t.jsx)(y.K,{},`${Er.group}-separator`)),vr.push(Er.render()),Ur=Er.group);return(0,t.jsx)(v.U,{alignment:"right",children:vr})}function mr(sn,Ln,Jn){if(Ln.length>0)for(const gs of Ln){const kn={dashboard:(0,P.UA)().getCurrent()};if(gs.show(kn)){const Gn=gs.component;sn.push({group:Jn,condition:!0,render:()=>(0,n.createElement)(Gn,{...kn,key:sn.length})})}}}function Va(sn){const[Ln,Jn]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{if(sn){const gs=sn.state.vizManager.subscribeToState(kn=>Jn(kn.sourcePanel.resolve().parent instanceof ga.F));return()=>{gs.unsubscribe()}}Jn(!1)},[sn]),Ln}function Ea(sn){const[Ln,Jn]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{if(sn){const gs=sn.state.vizManager.subscribeToState(kn=>Jn(kn.isDirty||!1));return()=>{gs.unsubscribe()}}Jn(!1)},[sn]),Ln}function cr(sn){return{buttonWithExtraMargin:(0,i.css)({margin:sn.spacing(0,.5)}),publicBadge:(0,i.css)({color:"grey",backgroundColor:"transparent",border:"1px solid"})}}},42397:(k,R,e)=>{"use strict";e.d(R,{$:()=>o,m:()=>f});var t=e(74848),n=e(80943),i=e(91052),s=e(14578),r=e(83122),g=e(27746),a=e(38138),c=e(7196);class o extends n.Bs{static{this.Component=h}}function h({model:p}){const{menu:m,rawLinks:v}=p.useState();if(!(p.parent instanceof n.Eb))throw new Error("VizPanelLinks must be a child of VizPanel");if(!v||v.length===0)return null;if(v.length===1){const l=(0,c.eQ)(p.parent)[0];return(0,t.jsx)(i.NR.TitleItem,{href:l.href,onClick:l.onClick,target:l.target,title:l.title,children:(0,t.jsx)(s.I,{name:"external-link-alt",size:"md"})})}return(0,t.jsx)(r.m,{overlay:()=>(0,t.jsx)(m.Component,{model:m},m.state.key),children:(0,t.jsx)(g.I,{icon:"external-link-alt",iconSize:"md","aria-label":"panel links"})})}class f extends n.Bs{static{this.Component=d}}function d({model:p}){const{links:m}=p.useState();return m?(0,t.jsx)(a.W,{children:m?.map((v,l)=>(0,t.jsx)(a.W.Item,{label:v.title,url:v.href,target:v.target,onClick:v.onClick},l))}):null}},7196:(k,R,e)=>{"use strict";e.d(R,{eQ:()=>ge,MI:()=>Le,oV:()=>De,_i:()=>ce,t0:()=>ye,vR:()=>je});var t=e(74135),n=e(1933),i=e(76885),s=e(32264),r=e(4402),g=e(39601),a=e(80943),c=e(28138),o=e(8484),h=e(63066),f=e(22699),d=e(16560),p=e(32349),m=e(75462),v=e(19347),l=e(74730),y=e(94383),u=e(40588),D=e(74848),E=e(56833);class x extends a.Bs{static{this.Component=P}constructor(Ue){super(Ue),this.trail=b(Ue)}}function P({model:Pe}){return(0,D.jsx)(Pe.trail.Component,{model:Pe.trail})}function b({metric:Pe,filters:Ue,dataSourceUid:$e,timeRangeState:ze}){return new E.b({$timeRange:new a.JZ(ze),metric:Pe,initialDS:$e,initialFilters:Ue,embedded:!0})}var M=e(32196),O=e(40845),I=e(87978),T=e(28444);function C(Pe){const{scene:Ue,title:$e,onDismiss:ze}=Pe,qe=(0,O.of)(L);return(0,D.jsx)(I._,{title:$e,onClose:ze,size:"lg",children:(0,D.jsx)("div",{className:qe.drawerInnerWrapper,children:(0,D.jsx)(Ue.Component,{model:Ue})})})}class S extends a.Bs{constructor(Ue){super(Ue)}static Component({model:Ue}){const $e=Ue.useState();return(0,D.jsx)(C,{...$e})}}function A(Pe){const Ue={component:C,props:Pe};appEvents.publish(new ShowModalReactEvent(Ue))}function L(Pe){return{drawerInnerWrapper:(0,M.css)({display:"flex",padding:Pe.spacing(2),background:Pe.isDark?Pe.colors.background.canvas:Pe.colors.background.primary,position:"absolute",left:0,right:0,top:0})}}var N=e(76040);function F(Pe){return Pe.op==="="}function w(Pe){return Pe.state.$timeRange.state}function B({metric:Pe,labelFilters:Ue}){if(Ue.length===0)return Pe;const $e=`{${Ue.map(({label:ze,op:qe,value:dt})=>`${ze}${qe}"${dt}"`)}}`;return`${Pe}${$e}`}function U(Pe){return Pe?.map(Ue=>({key:Ue.label,value:Ue.value,operator:Ue.op}))}function K(Pe){const Ue=[];return Pe.forEach($e=>{const ze=(0,N.u)($e);if(ze.errors.length>0)return;const{metric:qe,labels:dt}=ze.query;Ue.push({metric:qe,labelFilters:dt.filter(F),query:$e}),ze.query.binaryQueries?.forEach(({query:{metric:vt,labels:yt}})=>{Ue.push({metric:vt,labelFilters:yt.filter(F),query:$e})})}),Ue}async function V(Pe,Ue,$e){if(Ue.state.pluginId!=="timeseries")return;const ze=(0,l.un)(Ue);if(ze==null)return;const{queries:qe,datasource:dt,data:vt}=ze.state;if(dt==null||dt.type!=="prometheus")return;const yt=await(0,v.l)().get(dt);if(yt.interpolateVariablesInQueries==null)return;const st=yt.interpolateVariablesInQueries(qe,{__sceneObject:{value:Ue}},vt?.request?.filters).filter(q),pe=K(st.map(Ee=>Ee.expr)).map(Ee=>({text:B(Ee),onClick:J(Ee,Pe,yt)}));pe.length>0&&$e.push({text:"Explore metrics",iconClassName:"code-branch",subMenu:H(pe)})}function H(Pe){const Ue=new Set;function $e({text:ze}){const qe=Ue.size;return Ue.add(ze),Ue.size>qe}return Pe.filter($e)}function Y({metric:Pe,labelFilters:Ue,query:$e},ze,qe){return{metric:Pe,filters:U(Ue),dataSourceUid:qe,timeRangeState:ze}}function X(Pe,Ue,$e){const ze=w(Ue),qe=Y(Pe,ze,$e.uid),dt=new x(qe);return dt.trail.addActivationHandler(()=>{dt.trail.state.topScene instanceof y.R&&dt.trail.state.topScene.setActionView("breakdown")}),{scene:dt,title:"Explore metrics"}}function J(Pe,Ue,$e){return()=>{const ze=X(Pe,Ue,$e),qe=new S({...ze,onDismiss:()=>Ue.closeModal()});(0,u.z)("exploration_started",{cause:"dashboard_panel"}),Ue.showModal(qe)}}function q(Pe){return"expr"in Pe}var ae=e(91119),j=e(85174),te=e(30160),ne=e(7758),le=e(11982),z=e(34842),ee=e(60656),se=e(42397),ie=e(54174);class Z extends a.Bs{constructor(){super(...arguments),this.onDismiss=()=>{(0,l.YQ)(this).closeModal()},this.onConfirm=()=>{const Ue=(0,l.YQ)(this);Ue.unlinkLibraryPanel(this.state.panelRef.resolve()),Ue.closeModal()}}static{this.Component=oe}}function oe({model:Pe}){return(0,D.jsx)(ie.l,{isOpen:!0,onConfirm:()=>{Pe.onConfirm(),Pe.onDismiss()},onDismiss:Pe.onDismiss})}function ce(Pe,Ue=!1){(async()=>{const ze=Pe.parent,qe=ze.parent,dt=ze.getPlugin(),vt=[],yt=[],st=(0,l.YQ)(ze),{isEmbedded:Ve}=st.state.meta,pe=await re(ze);if(Ve){pe&&Pe.setState({items:[pe]});return}const Ee=!!st.state.editPanel;if(Ee||vt.push({text:(0,o.t)("panel.header-menu.view","View"),iconClassName:"eye",shortcut:"v",href:(0,le.r7)(ze)}),st.canEditDashboard()&&st.state.editable&&!Ue&&!Ee&&vt.push({text:(0,o.t)("panel.header-menu.edit","Edit"),iconClassName:"edit",shortcut:"e",href:(0,le.e0)((0,l.Cs)(ze))}),s.$.featureToggles.newDashboardSharingComponent){const ve=[];ve.push({text:(0,o.t)("share-panel.menu.share-link-title","Share link"),iconClassName:"link",shortcut:"p u",onClick:()=>{const Se=new ae.j({title:(0,o.t)("share-panel.drawer.share-link-title","Link settings"),body:new te.S({panelRef:ze.getRef()})});st.showModal(Se)}}),vt.push({type:"submenu",text:(0,o.t)("panel.header-menu.share","Share"),iconClassName:"share-alt",subMenu:ve,onClick:Se=>{Se.preventDefault()}})}else vt.push({text:(0,o.t)("panel.header-menu.share","Share"),iconClassName:"share-alt",onClick:()=>{st.showModal(new j.Z({panelRef:ze.getRef()}))},shortcut:"p s"});st.state.isEditing&&!Ue&&!Ee&&yt.push({text:(0,o.t)("panel.header-menu.duplicate","Duplicate"),onClick:()=>{st.duplicatePanel(ze)},shortcut:"p d"}),Ee||yt.push({text:(0,o.t)("panel.header-menu.copy","Copy"),onClick:()=>{st.copyPanel(ze)}}),st.state.isEditing&&!Ue&&!Ee&&(qe instanceof ee.F?(yt.push({text:(0,o.t)("panel.header-menu.unlink-library-panel","Unlink library panel"),onClick:()=>{st.showModal(new Z({panelRef:qe.getRef()}))}}),yt.push({text:(0,o.t)("panel.header-menu.replace-library-panel","Replace library panel"),onClick:()=>{st.onShowAddLibraryPanelDrawer(qe.getRef())}})):yt.push({text:(0,o.t)("panel.header-menu.create-library-panel","Create library panel"),onClick:()=>{st.showModal(new j.Z({panelRef:ze.getRef(),activeTab:f.wr.libraryPanel}))}})),yt.push({text:(0,o.t)("panel.header-menu.new-alert-rule","New alert rule"),onClick:ve=>Ye(ze)}),Ze(ze.state.options)&&!Ee&&yt.push({text:ze.state.options.legend.showLegend?(0,o.t)("panel.header-menu.hide-legend","Hide legend"):(0,o.t)("panel.header-menu.show-legend","Show legend"),onClick:ve=>{ve.preventDefault(),je(ze)},shortcut:"p l"}),st.canEditDashboard()&&dt&&!dt.meta.skipDataQuery&&!Ue&&yt.push({text:(0,o.t)("panel.header-menu.get-help","Get help"),onClick:ve=>{ve.preventDefault(),Ne(ze,d.q.Help)}}),s.$.featureToggles.exploreMetrics&&await V(st,ze,vt),pe&&vt.push(pe),vt.push(ue(dt,ze,st));const{extensions:me}=(0,r.Kf)({extensionPointId:t.S.DashboardPanelMenu,context:Te(ze,st),limitPerPlugin:3});me.length>0&&!st.state.isEditing&&vt.push({text:"Extensions",iconClassName:"plug",type:"submenu",subMenu:(0,m.N9)(me)}),yt.length&&vt.push({type:"submenu",text:(0,o.t)("panel.header-menu.more","More..."),iconClassName:"cube",subMenu:yt,onClick:ve=>{ve.preventDefault()}}),st.state.isEditing&&!Ue&&!Ee&&(vt.push({text:"",type:"divider"}),vt.push({text:(0,o.t)("panel.header-menu.remove","Remove"),iconClassName:"trash-alt",onClick:()=>{Le(st,ze)},shortcut:"p r"})),Pe.setState({items:vt})})()}const ye=Pe=>ce(Pe,!0);async function re(Pe){const Ue=await(0,le.Lp)(Pe);if(Ue)return{text:(0,o.t)("panel.header-menu.explore","Explore"),iconClassName:"compass",shortcut:"p x",href:Ue}}function ue(Pe,Ue,$e){const ze=[];return Pe&&!Pe.meta.skipDataQuery&&(ze.push({text:(0,o.t)("panel.header-menu.inspect-data","Data"),href:(0,le.Uu)(Ue,d.q.Data),onClick:qe=>{qe.preventDefault(),g.Ny.partial({inspect:Ue.state.key,inspectTab:d.q.Data})}}),$e instanceof z.H$&&$e.state.meta.canEdit&&ze.push({text:(0,o.t)("panel.header-menu.query","Query"),href:(0,le.Uu)(Ue,d.q.Query),onClick:qe=>{qe.preventDefault(),g.Ny.partial({inspect:Ue.state.key,inspectTab:d.q.Query})}})),ze.push({text:(0,o.t)("panel.header-menu.inspect-json","Panel JSON"),href:(0,le.Uu)(Ue,d.q.JSON),onClick:qe=>{qe.preventDefault(),g.Ny.partial({inspect:Ue.state.key,inspectTab:d.q.JSON})}}),{text:(0,o.t)("panel.header-menu.inspect","Inspect"),iconClassName:"info-circle",shortcut:"i",href:(0,le.Uu)(Ue),onClick:qe=>{qe.isDefaultPrevented()||g.Ny.partial({inspect:Ue.state.key,inspectTab:d.q.Data})},subMenu:ze.length>0?ze:void 0}}function De(Pe){if(!(Pe.parent instanceof se.$))throw new Error("parent of VizPanelLinksMenu must be VizPanelLinks");const Ue=Pe.parent.parent;if(!(Ue instanceof a.Eb))throw new Error("parent of VizPanelLinks must be VizPanel");Pe.setState({links:ge(Ue)})}function ge(Pe){const Ue=(qe,dt)=>a.jh.interpolate(Pe,qe,dt),$e=(0,p.CH)(Pe,Ue);if(!$e)return[];const ze=$e.getLinks(Ue);return ze.map(qe=>({...qe,onClick:(vt,yt)=>{ne.c.panelLinkClicked({has_multiple_links:ze.length>1}),qe.onClick?.(vt,yt)}}))}function Te(Pe,Ue){const $e=a.jh.getTimeRange(Pe);let ze=(0,l.un)(Pe);const qe=ze?.state.queries,dt=(0,l.Cs)(Pe);let vt={};if(Pe.state.$variables&&Pe.state.$variables.state.variables.forEach(yt=>{yt instanceof a.xc&&(vt={...vt,[yt.state.name]:{value:yt.getValue(),text:yt.getValueText()}})}),Pe.parent?.parent instanceof a.tI){const yt=Pe.parent.parent;yt.state.$variables&&yt.state.$variables.state.variables.forEach(st=>{st instanceof a.xc&&(vt={...vt,[st.state.name]:{value:st.getValue(),text:st.getValueText()}})})}return{id:dt,pluginId:Pe.state.pluginId,title:Pe.state.title,timeRange:$e.state.value.raw,timeZone:(0,n.O)({timeZone:$e.getTimeZone()}),dashboard:{uid:Ue.state.uid,title:Ue.state.title,tags:Ue.state.tags||[]},targets:qe,scopedVars:vt,data:ze?.state.data}}function Le(Pe,Ue){c.A.publish(new T.bY({title:"Remove panel",text:"Are you sure you want to remove this panel?",icon:"trash-alt",yesText:"Remove",onConfirm:()=>Pe.removePanel(Ue)}))}const Ye=async Pe=>{const Ue=await(0,h.J6)(Pe),$e=i.kM.renderUrl("/alerting/new",{defaults:JSON.stringify(Ue),returnTo:location.pathname+location.search});g.Ny.push($e)};function je(Pe){const Ue=Pe.state.options;Ze(Ue)&&typeof Ue.legend.showLegend=="boolean"&&Pe.onOptionsChange({legend:{showLegend:!Ue.legend.showLegend}})}function Ze(Pe){return Pe!=null&&typeof Pe=="object"&&"legend"in Pe}const Ne=(Pe,Ue)=>{g.Ny.partial({inspect:Pe.state.key,inspectTab:Ue})}},99589:(k,R,e)=>{"use strict";e.d(R,{W:()=>r});var t=e(74848),n=e(80943),i=e(2038),s=e(74730);class r extends n.Bs{constructor(){super({}),this.onActivate=()=>{const c=this.parent;if(!c||!(c instanceof n.Eb))throw new Error("PanelNotices can be used only as title items for VizPanel")},this.addActivationHandler(this.onActivate)}static{this.Component=g}getPanel(){const c=this.parent;return c&&c instanceof n.Eb?c:null}}function g({model:a}){const c=a.getPanel(),h=n.jh.getData(a).useState();if(!c)return null;const f=(0,s.Cs)(c);return h.data?.series?(0,t.jsx)(i.Z,{frames:h.data?.series,panelId:f}):null}},7928:(k,R,e)=>{"use strict";e.d(R,{v:()=>d});var t=e(74848),n=e(32196),i=e(43127),s=e(65879),r=e(85858),g=e(80943),a=e(40845),c=e(56034),o=e(15666),h=e(91052),f=e(14578);class d extends g.XQ{static{this.Component=p}constructor(l={}){super({...l,from:"now-6h",to:"now",value:(0,i.E2)()}),this.addActivationHandler(()=>this._onActivate())}_onActivate(){this._subs.add(this.subscribeToState((l,y)=>{if(l.timeFrom!==y.timeFrom||l.timeShift!==y.timeShift){const{timeInfo:u,timeRange:D}=this.getTimeOverride(this.getAncestorTimeRange().state.value);this.setState({timeInfo:u,value:D})}}))}ancestorTimeRangeChanged(l){const y=this.getTimeOverride(l.value);this.setState({value:y.timeRange,timeInfo:y.timeInfo})}getTimeOverride(l){const{timeFrom:y,timeShift:u}=this.state,D={timeInfo:"",timeRange:l};if(y){const E=g.jh.interpolate(this,this.state.timeFrom),x=s.describeTextRange(E);if(x.invalid)return D.timeInfo="invalid time override",D;s.isRelativeTimeRange(l.raw)&&(D.timeInfo=x.display,D.timeRange={from:r.parse(x.from),to:r.parse(x.to),raw:{from:x.from,to:x.to}})}if(u){const E=g.jh.interpolate(this,this.state.timeShift);if(s.describeTextRange(E).invalid)return D.timeInfo="invalid timeshift",D;const P="-"+E;D.timeInfo+=" timeshift "+P;const b=r.parseDateMath(P,D.timeRange.from,!1),M=r.parseDateMath(P,D.timeRange.to,!0);D.timeRange={from:b,to:M,raw:{from:b,to:M}}}return D}}function p({model:v}){const{timeInfo:l,hideTimeOverride:y}=v.useState(),u=(0,a.of)(m);return!l||y?null:(0,t.jsx)(c.m,{content:(0,t.jsx)(o.xS,{timeRange:v.state.value,timeZone:v.getTimeZone()}),children:(0,t.jsxs)(h.NR.TitleItem,{className:u.timeshift,children:[(0,t.jsx)(f.I,{name:"clock-nine",size:"sm"})," ",l]})})}const m=v=>({timeshift:(0,n.css)({color:v.colors.text.link,gap:v.spacing(.5),whiteSpace:"nowrap"})})},79284:(k,R,e)=>{"use strict";e.d(R,{L:()=>c});var t=e(2543),n=e.n(t),i=e(80943),s=e(74730),r=e(41507),g=e(7196),a=e(30195);class c extends i.Bs{constructor(m){super(m),this._variableDependency=new i.Sh(this,{variableNames:[this.state.variableName],onVariableUpdateCompleted:()=>{}}),this.isWaitingForVariables=!1,this.addActivationHandler(()=>this._activationHandler())}_activationHandler(){this.performRepeat()}_getRow(){if(!(this.parent instanceof i.tI))throw new Error("RepeatedRowBehavior: Parent is not a SceneGridRow");return this.parent}_getLayout(){const m=i.jh.getLayout(this);if(!(m instanceof i.hy))throw new Error("RepeatedRowBehavior: Layout is not a SceneGridLayout");return m}performRepeat(){if(this.isWaitingForVariables=this._variableDependency.hasDependencyInLoadingState(),this.isWaitingForVariables)return;const m=i.jh.lookupVariable(this.state.variableName,this.parent?.parent);if(!m){console.error("RepeatedRowBehavior: Variable not found");return}if(m instanceof i.n8){if(!m.state.isMulti)return}else{console.error("RepeatedRowBehavior: Variable is not a MultiValueVariable");return}const v=this._getRow(),l=this._getLayout(),{values:y,texts:u}=(0,s.a7)(m);if((0,t.isEqual)(this._prevRepeatValues,y))return;this._prevRepeatValues=y;const D=[],E=v.state.children,x=o(E);let P=0;const b={values:[""],texts:m.hasAllValue()?["All"]:["None"]},M=y.length?y:b.values,O=u.length?u:b.texts;for(let I=0;I<M.length;I++){const T=[],C=M[I];for(const A of E){const N=(A.state.y??0)+(x+1)*I,F=I>0?`${A.state.key}-clone-${C}`:A.state.key,w=A.clone({key:F,y:N});I>0&&(d(w,C),w instanceof r.U&&w.state.body.setState({menu:new i.Lw({$behaviors:[g.t0]})})),T.push(w),P<N+w.state.height&&(P=N+w.state.height)}const S=this.getRowClone(v,I,C,O[I],x,T);D.push(S)}h(l,D,P,v),this.publishEvent(new a.d({source:this}),!0)}getRowClone(m,v,l,y,u,D){if(v===0)return m.setState({$variables:new i.Pj({variables:[new i.xc({name:this.state.variableName,value:l,text:String(y)})]}),children:D}),m;const E=m.state.y??0;return m.clone({key:`${m.state.key}-clone-${l}`,$variables:new i.Pj({variables:[new i.xc({name:this.state.variableName,value:l,text:String(y)})]}),$behaviors:[],children:D,y:E+u*v+v,actions:void 0})}removeBehavior(){const m=this._getRow(),v=this._getLayout(),l=f(this._getLayout(),this._getRow());v.setState({children:l}),m.setState({$behaviors:m.state.$behaviors.filter(y=>y!==this),$variables:void 0})}}function o(p){let m=0,v=Number.MAX_VALUE;if(p.length===0)return 0;for(const l of p)l.state.y+l.state.height>m&&(m=l.state.y+l.state.height),l.state.y<v&&(v=l.state.y);return m-v}function h(p,m,v,l){const y=f(p,l),u=y.indexOf(l);if(u===-1)throw new Error("RowRepeaterBehavior: Parent row not found in layout children");const D=[...y.slice(0,u),...m,...y.slice(u+1)];if(y.length>u+1){const E=y.slice(u+1),x=E[0].state.y,P=v-x;for(const b of E)if(b.setState({y:b.state.y+P}),b instanceof i.tI)for(const M of b.state.children)M.setState({y:M.state.y+P})}p.setState({children:D})}function f(p,m){return p.state.children.filter(v=>!v.state.key?.startsWith(`${m.state.key}-clone-`))}function d(p,m){p.forEachChild(v=>{v.setState({key:`${v.state.key}-clone-${m}`}),d(v,m)})}},54174:(k,R,e)=>{"use strict";e.d(R,{l:()=>i});var t=e(74848),n=e(96374);const i=({isOpen:s,onConfirm:r,onDismiss:g})=>(0,t.jsx)(n.u,{title:"Do you really want to unlink this panel?",icon:"question-circle",body:`If you unlink this panel, you will be able to edit it without affecting any other dashboards.
            However, once you make a change you will not be able to revert to its original reusable panel.`,confirmText:"Yes, unlink",onConfirm:()=>{r(),g()},onDismiss:g,isOpen:s})},58029:(k,R,e)=>{"use strict";e.d(R,{u:()=>T});var t=e(74848),n=e(32196),i=e(80943),s=e(72109),r=e(40845),g=e(14578),a=e(28138),c=e(14348),o=e(28444),h=e(74730),f=e(41507),d=e(79284),p=e(71678),m=e(37390),v=e(96540),l=e(49785),y=e(13544),u=e(88575),D=e(10354),E=e(42418),x=e(55852),P=e(92378);const b=({repeat:S,title:A,parent:L,warning:N,onUpdate:F,onCancel:w})=>{const[B,U]=(0,v.useState)(S),K=(0,v.useCallback)(X=>U(X),[U]),{handleSubmit:V,register:H}=(0,l.mN)({defaultValues:{title:A}}),Y=X=>{F(X.title,B)};return(0,t.jsxs)("form",{onSubmit:V(Y),children:[(0,t.jsx)(u.D,{label:"Title",children:(0,t.jsx)(D.p,{...H("title"),type:"text"})}),(0,t.jsx)(u.D,{label:"Repeat for",children:(0,t.jsx)(P.U,{parent:L,repeat:B,onChange:K})}),N&&(0,t.jsx)(E.F,{"data-testid":y.Tp.pages.Dashboard.Rows.Repeated.ConfigSection.warningMessage,severity:"warning",title:"",topSpacing:3,bottomSpacing:0,children:N}),(0,t.jsxs)(m.a.ButtonRow,{children:[(0,t.jsx)(x.$n,{type:"button",variant:"secondary",onClick:w,fill:"outline",children:"Cancel"}),(0,t.jsx)(x.$n,{type:"submit",children:"Update"})]})]})},M=({repeat:S,title:A,parent:L,onDismiss:N,onUpdate:F,warning:w})=>{const B=(0,r.of)(O);return(0,t.jsx)(m.a,{isOpen:!0,title:"Row options",onDismiss:N,className:B.modal,children:(0,t.jsx)(b,{parent:L,repeat:S,title:A,onCancel:N,onUpdate:F,warning:w})})},O=()=>({modal:(0,n.css)({label:"RowOptionsModal",width:"500px"})}),I=({repeat:S,title:A,parent:L,onUpdate:N,warning:F})=>{const w=B=>(U,K)=>{N(U,K),B()};return(0,t.jsx)(p.$s,{children:({showModal:B,hideModal:U})=>(0,t.jsx)("button",{type:"button",className:"pointer","aria-label":"Row options",onClick:()=>{B(M,{title:A,repeat:S,parent:L,onDismiss:U,onUpdate:w(U),warning:F})},children:(0,t.jsx)(g.I,{name:"cog"})})})};I.displayName="RowOptionsButton";class T extends i.Bs{constructor(){super(...arguments),this.onUpdate=(A,L)=>{const N=this.getParent();let F;if(N.state.$behaviors)for(let w of N.state.$behaviors)w instanceof d.L&&(F=w);if(L&&!F){const w=new d.L({variableName:L});N.setState({$behaviors:[...N.state.$behaviors??[],w]})}else F&&F.removeBehavior();A!==N.state.title&&N.setState({title:A})},this.onDelete=()=>{a.A.publish(new o.bY({title:"Delete row",text:"Are you sure you want to remove this row and all its panels?",altActionText:"Delete row only",icon:"trash-alt",onConfirm:()=>{this.getDashboard().removeRow(this.getParent(),!0)},onAltAction:()=>{this.getDashboard().removeRow(this.getParent())}}))},this.getWarning=()=>{if(this.getParent().state.children.some(F=>{if(!(F instanceof f.U))return!1;const w=F.state.body;return w instanceof i.Eb?(0,h.un)(w)?.state.datasource?.uid===c.K:!1}))return(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{children:["Panels in this row use the ",c.K," data source. These panels will reference the panel in the original row, not the ones in the repeated rows."]}),(0,t.jsx)(s.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/dashboards/build-dashboards/create-dashboard/#configure-repeating-rows",children:"Learn more"})]})}}getParent(){if(!(this.parent instanceof i.tI))throw new Error("RowActions must have a SceneGridRow parent");return this.parent}getDashboard(){return(0,h.YQ)(this)}static{this.Component=({model:A})=>{const L=A.getDashboard(),N=A.getParent(),{title:F}=N.useState(),{meta:w,isEditing:B}=L.useState(),U=(0,r.of)(C),K=N.state.$behaviors?.find(V=>V instanceof d.L);return(0,t.jsx)(t.Fragment,{children:w.canEdit&&B&&(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{className:U.rowActions,children:[(0,t.jsx)(I,{title:F,repeat:K instanceof d.L?K.state.variableName:void 0,parent:L,onUpdate:A.onUpdate,warning:A.getWarning()}),(0,t.jsx)("button",{type:"button",onClick:A.onDelete,"aria-label":"Delete row",children:(0,t.jsx)(g.I,{name:"trash-alt"})})]})})})}}}const C=S=>({rowActions:(0,n.css)({color:S.colors.text.secondary,lineHeight:"27px",button:{color:S.colors.text.secondary,paddingLeft:S.spacing(2),background:"transparent",border:"none","&:hover":{color:S.colors.text.maxContrast}}})})},30195:(k,R,e)=>{"use strict";e.d(R,{d:()=>n});var t=e(65463);class n extends t.x{static{this.type="dashboard-repeats-processed"}}},71176:(k,R,e)=>{"use strict";e.d(R,{X:()=>s});var t=e(32264),n=e(79422),i=e(31193);async function s(r){let g=n.Ye.templating?.list;if(t.$.featureToggles.newDashboardWithFiltersAndGroupBy){const c=await(0,i.tR)().get();if(c.getTagKeys){const o={type:c.meta.id,uid:c.uid},h={datasource:o,filters:[],name:"Filter",type:"adhoc"},f={datasource:o,name:"Group by",type:"groupby"};g=(g||[]).concat([h,f])}}const a={meta:{canStar:!1,canShare:!1,canDelete:!1,isNew:!0,folderUid:""},dashboard:{...n.Ye,uid:"",title:"New dashboard",panels:[],timezone:t.$.bootData.user?.timezone||n.Ye.timezone}};return g&&(a.dashboard.templating={list:g}),r&&(a.meta.folderUid=r),a}},70665:(k,R,e)=>{"use strict";e.d(R,{x:()=>t});const t={name:"grafana",uid:"grafana"}},13989:(k,R,e)=>{"use strict";e.d(R,{O:()=>n});var t=e(80943);function n(i){const s=[];for(const r of i){if(!(r instanceof t.tV.g))continue;const g={...r.state.query,enable:!!r.state.isEnabled,hide:!!r.state.isHidden};s.push(g)}return s}},53287:(k,R,e)=>{"use strict";e.d(R,{C:()=>g});var t=e(32264),n=e(80943),i=e(79422),s=e(73134),r=e(74730);function g(c){const o=[];for(const h of c.state.variables){const f={name:h.state.name,label:h.state.label,description:h.state.description??void 0,skipUrlSync:!!h.state.skipUrlSync,hide:h.state.hide||i.zL.dontHide,type:h.state.type};if(n.Go.isQueryVariable(h)){let d=[];h.state.refresh===s.CO.never&&(d=a(h.state)),o.push({...f,current:{value:h.state.value,text:h.state.text},options:d,query:h.state.query,definition:h.state.definition,datasource:h.state.datasource,sort:h.state.sort,refresh:h.state.refresh,regex:h.state.regex,allValue:h.state.allValue,includeAll:h.state.includeAll,multi:h.state.isMulti,skipUrlSync:h.state.skipUrlSync})}else if(n.Go.isCustomVariable(h))o.push({...f,current:{text:h.state.value,value:h.state.value},options:a(h.state),query:h.state.query,multi:h.state.isMulti,allValue:h.state.allValue,includeAll:h.state.includeAll});else if(n.Go.isDataSourceVariable(h))o.push({...f,current:{value:h.state.value,text:h.state.text},options:[],regex:h.state.regex,refresh:s.CO.onDashboardLoad,query:h.state.pluginId,multi:h.state.isMulti,allValue:h.state.allValue,includeAll:h.state.includeAll});else if(n.Go.isConstantVariable(h))o.push({...f,current:{value:h.state.value,text:h.state.value},query:h.state.value,hide:i.zL.hideVariable});else if(n.Go.isIntervalVariable(h)){const d=(0,r.bx)(h.state.intervals);o.push({...f,current:{text:h.state.value,value:h.state.value},query:d,refresh:h.state.refresh,options:h.state.intervals.map(p=>({value:p,text:p,selected:p===h.state.value})),auto:h.state.autoEnabled,auto_min:h.state.autoMinInterval,auto_count:h.state.autoStepCount})}else if(n.Go.isTextBoxVariable(h)){const d={text:h.state.value,value:h.state.value};o.push({...f,current:d,options:[{...d,selected:!0}],query:h.state.value})}else if(n.Go.isGroupByVariable(h)&&t.$.featureToggles.groupByVariable)o.push({...f,datasource:h.state.datasource,options:h.state.defaultOptions?.map(d=>({text:d.text,value:String(d.value)})),current:{text:h.state.text,value:h.state.value}});else if(n.Go.isAdHocVariable(h))o.push({...f,name:h.state.name,type:"adhoc",datasource:h.state.datasource,baseFilters:h.state.baseFilters,filters:h.state.filters,defaultKeys:h.state.defaultKeys});else throw new Error("Unsupported variable type")}for(const h of o)h.hide===i.zL.dontHide&&delete h.hide,h.skipUrlSync||delete h.skipUrlSync,h.label===""&&delete h.label,h.multi||delete h.multi,h.sort===s.ZG.disabled&&delete h.sort;return o}function a(c){return c.options.map(o=>({value:String(o.value),text:o.label,selected:Array.isArray(c.value)?c.value.includes(o.value):c.value===o.value}))}},85445:(k,R,e)=>{"use strict";e.d(R,{Al:()=>X,tt:()=>J,EH:()=>H,wM:()=>U});var t=e(2543),n=e(32264),i=e(80943),s=e(34214),r=e(91309),g=e(38477),a=e(33278),c=e(16279),o=e(41507),h=e(74730);class f{constructor(le,z){this._sceneObject=z,this.state={name:le,type:"dashboard_macro"}}getValue(le){const z=(0,h.YQ)(this._sceneObject);switch(le){case"uid":return z.state.uid||"";case"title":case"name":case"id":default:return z.state.title}}getValueText(){return""}}function d(){const ne=i.Go.registerVariableMacro("__dashboard",f);return()=>ne()}var p=e(34842),m=e(60656),v=e(42397),l=e(7196),y=e(99589),u=e(7928),D=e(79284),E=e(58029),x=e(41987),P=e(69129),b=e(10154),M=e(32023);function O(ne,le){le.app=x.Jk.Dashboard,le.canAddAnnotations=()=>{const z=(0,h.YQ)(ne);return!I(z)||!z.canEditDashboard()?!1:!!z.state.meta.annotationsPermissions?.dashboard.canAdd},le.canEditAnnotations=z=>{const ee=(0,h.YQ)(ne);return ee.canEditDashboard()?z?!!ee.state.meta.annotationsPermissions?.dashboard.canEdit:!!ee.state.meta.annotationsPermissions?.organization.canEdit:!1},le.canDeleteAnnotations=z=>{const ee=(0,h.YQ)(ne);return ee.canEditDashboard()?z?!!ee.state.meta.annotationsPermissions?.dashboard.canDelete:!!ee.state.meta.annotationsPermissions?.organization.canDelete:!1},le.onAnnotationCreate=async z=>{const ee=(0,h.YQ)(ne),se=z.from!==z.to,ie={dashboardUID:ee.state.uid,panelId:(0,h.Cs)(ne),isRegion:se,time:z.from,timeEnd:se?z.to:0,tags:z.tags,text:z.description};await(0,b.vJ)(ie),T(ee),le.eventBus.publish(new P.We(ie))},le.onAnnotationUpdate=async z=>{const ee=(0,h.YQ)(ne),se=z.from!==z.to,ie={id:z.id,dashboardUID:ee.state.uid,panelId:(0,h.Cs)(ne),isRegion:se,time:z.from,timeEnd:se?z.to:0,tags:z.tags,text:z.description};await(0,b.rJ)(ie),T(ee),le.eventBus.publish(new P.We(ie))},le.onAnnotationDelete=async z=>{await(0,b.Xm)({id:z}),T((0,h.YQ)(ne)),le.eventBus.publish(new P.We({id:z}))},le.onAddAdHocFilter=z=>{const ee=(0,h.YQ)(ne),se=(0,h.un)(ne);if(!se)return;const ie=C(ee,se.state.datasource);S(ie,z)},le.onUpdateData=z=>Promise.resolve(!0)}function I(ne){const le=M.b4.getDataLayers(ne);for(const z of le.state.annotationLayers)if(z instanceof i.tV.g&&z.state.isEnabled&&z.state.query.builtIn)return z}function T(ne){const le=I(ne);le&&le.runLayer()}function C(ne,le){const z=i.jh.getVariables(ne);for(const se of z.state.variables)if(i.Go.isAdHocVariable(se)){const ie=se.state.datasource;if(ie===le||ie?.uid===le?.uid)return se}const ee=new i.H9({name:"Filters",datasource:le,useQueriesAsFilterForOptions:!0});return z.setState({variables:[...z.state.variables,ee]}),ee}function S(ne,le){for(const z of ne.state.filters)if(z.key===le.key){ne.setState({filters:ne.state.filters.map(ee=>ee.key===le.key?le:ee)});return}ne.setState({filters:[...ne.state.filters,le]})}var A=e(96556),L=e(27734),N=e(7758),F=e(84423);function w(ne){return function(z,ee){if(ee.angularPanelCtrl){z.options={angularOptions:ne.getOptionsToRemember()};return}if((!ne.options||Object.keys(ne.options).length===0)&&(0,t.defaults)(z,ne.getOptionsToRemember()),ne.autoMigrateFrom){const se=F.NB[ne.autoMigrateFrom]!=null,ie=ne.getOptionsToRemember(),Z=ne.autoMigrateFrom;if(ee.onPanelTypeChanged){const oe=se?{angular:ie}:ie.options;Object.assign(z.options,ee.onPanelTypeChanged(z,Z,oe,z.fieldConfig))}}}}var B=e(70665);function U(ne){const le=new s.G(ne.dashboard,ne.meta),z=H(le,ne.dashboard);return z.setInitialSaveModel(ne.dashboard),z}function K(ne){const le=[];let z=null,ee=[];for(const se of ne)if(se.type==="row")z?z.id!==se.id&&(le.push(V(z,ee)),z=se,ee=[]):se.collapsed?le.push(V(se,[])):z=se;else if(se.libraryPanel?.uid&&!("model"in se.libraryPanel)){const ie=X(se);if(!ie)continue;z?ee.push(ie):le.push(ie)}else{se.snapshotData&&j(se);const ie=J(se);z?ee.push(ie):le.push(ie)}return z&&le.push(V(z,ee)),le}function V(ne,le){ne.collapsed&&ne.panels&&(le=ne.panels.map(se=>{if(se instanceof s.a||(se=new s.a(se)),se.libraryPanel?.uid&&!("model"in se.libraryPanel)){const ie=X(se);if(!ie)throw new Error("Failed to build grid item for library panel");return ie}return J(se)}));let z,ee=le;return ne.repeat&&(z=[new D.L({variableName:ne.repeat})]),new i.tI({key:(0,h.XA)(ne.id),title:ne.title,y:ne.gridPos.y,isCollapsed:ne.collapsed,children:ee,$behaviors:z,actions:new E.u({})})}function H(ne,le){let z,ee=[],se;if(ne.templating?.list?.length){const oe=ne.templating.list.map(ce=>{try{return Y(ce)}catch(ye){return console.error(ye),null}}).filter(ce=>!!ce);z=new i.Pj({variables:oe})}else z=new i.Pj({variables:[]});ne.annotations?.list?.length&&!ne.isSnapshot()&&(ee=ne.annotations?.list.map(oe=>new g.g({key:(0,t.uniqueId)("annotations-"),query:oe,name:oe.name,isEnabled:!!oe.enable,isHidden:!!oe.hide})));let ie=n.$.unifiedAlertingEnabled;return ie||ne.panels.find(oe=>!!oe.alert)&&(ie=!0),ie&&(se=new r.C({key:"alert-states",name:"Alert States"})),new p.H$({description:ne.description,editable:ne.editable,preload:le.preload??!1,id:ne.id,isDirty:!1,links:ne.links||[],meta:ne.meta,tags:ne.tags||[],title:ne.title,uid:ne.uid,version:ne.version,body:new i.hy({isLazy:!le.preload,children:K(ne.panels),$behaviors:[te]}),$timeRange:new i.JZ({from:ne.time.from,to:ne.time.to,fiscalYearStartMonth:ne.fiscalYearStartMonth,timeZone:ne.timezone,weekStart:ne.weekStart,UNSAFE_nowDelay:ne.timepicker?.nowDelay}),$variables:z,$behaviors:[new i.Gg.K2({sync:ne.graphTooltip}),new i.Gg.Hf,d,q,new i.Gg.en({enabled:ne.liveNow}),L.zf],$data:new c.s({annotationLayers:ee,alertStatesLayer:se}),controls:new a.x({variableControls:[new i.K8({}),new i.i7],timePicker:new i.KE({}),refreshPicker:new i.WM({refresh:ne.refresh,intervals:ne.timepicker.refresh_intervals,withText:!0}),hideTimeControls:ne.timepicker.hidden})})}function Y(ne){const le={name:ne.name,label:ne.label,description:ne.description};if(ne.type==="adhoc")return new i.H9({...le,description:ne.description,skipUrlSync:ne.skipUrlSync,hide:ne.hide,datasource:ne.datasource,applyMode:"auto",filters:ne.filters??[],baseFilters:ne.baseFilters??[],defaultKeys:ne.defaultKeys,useQueriesAsFilterForOptions:!0});if(ne.type==="custom")return new i.yP({...le,value:ne.current?.value??"",text:ne.current?.text??"",query:ne.query,isMulti:ne.multi,allValue:ne.allValue||void 0,includeAll:ne.includeAll,defaultToAll:!!ne.includeAll,skipUrlSync:ne.skipUrlSync,hide:ne.hide});if(ne.type==="query")return new i.fS({...le,value:ne.current?.value??"",text:ne.current?.text??"",query:ne.query,datasource:ne.datasource,sort:ne.sort,refresh:ne.refresh,regex:ne.regex,allValue:ne.allValue||void 0,includeAll:ne.includeAll,defaultToAll:!!ne.includeAll,isMulti:ne.multi,skipUrlSync:ne.skipUrlSync,hide:ne.hide,definition:ne.definition});if(ne.type==="datasource")return new i.mI({...le,value:ne.current?.value??"",text:ne.current?.text??"",regex:ne.regex,pluginId:ne.query,allValue:ne.allValue||void 0,includeAll:ne.includeAll,defaultToAll:!!ne.includeAll,skipUrlSync:ne.skipUrlSync,isMulti:ne.multi,hide:ne.hide});if(ne.type==="interval"){const z=(0,h.Sm)(ne.query),ee=(0,h.pk)(ne,z);return new i.Yj({...le,value:ee,intervals:z,autoEnabled:ne.auto,autoStepCount:ne.auto_count,autoMinInterval:ne.auto_min,refresh:ne.refresh,skipUrlSync:ne.skipUrlSync,hide:ne.hide})}else{if(ne.type==="constant")return new i.x0({...le,value:ne.query,skipUrlSync:ne.skipUrlSync,hide:ne.hide});if(ne.type==="textbox"){let z;return ne?.current?.value?typeof ne.current.value=="string"?z=ne.current.value:z=ne.current.value[0]:z=ne.query,new i.TS({...le,value:z,skipUrlSync:ne.skipUrlSync,hide:ne.hide})}else{if(n.$.featureToggles.groupByVariable&&ne.type==="groupby")return new i.ZG({...le,datasource:ne.datasource,value:ne.current?.value||[],text:ne.current?.text||[],skipUrlSync:ne.skipUrlSync,hide:ne.hide,defaultOptions:ne.options});throw new Error(`Scenes: Unsupported variable type ${ne.type}`)}}}function X(ne){if(!ne.libraryPanel)return null;const le=new m.F({title:ne.title,uid:ne.libraryPanel.uid,name:ne.libraryPanel.name,panelKey:(0,h.XA)(ne.id)});return new o.U({key:`grid-item-${ne.id}`,y:ne.gridPos.y,x:ne.gridPos.x,width:ne.gridPos.w,height:ne.gridPos.h,itemHeight:ne.gridPos.h,body:le})}function J(ne){const le=ne.repeat?{variableName:ne.repeat,repeatDirection:ne.repeatDirection==="h"?"h":"v"}:{},z=[];z.push(new v.$({rawLinks:ne.links,menu:new v.m({$behaviors:[l.oV]})})),z.push(new y.W);const ee={key:(0,h.XA)(ne.id),title:ne.title,description:ne.description,pluginId:ne.type,options:ne.options??{},fieldConfig:ne.fieldConfig,pluginVersion:ne.pluginVersion,displayMode:ne.transparent?"transparent":void 0,hoverHeader:!ne.title&&!ne.timeFrom&&!ne.timeShift,hoverHeaderOffset:0,$data:(0,A.w)(ne),titleItems:z,extendPanelContext:O,_UNSAFE_customMigrationHandler:w(ne)};n.$.publicDashboardAccessToken||(ee.menu=new i.Lw({$behaviors:[l._i]})),(ne.timeFrom||ne.timeShift)&&(ee.$timeRange=new u.v({timeFrom:ne.timeFrom,timeShift:ne.timeShift,hideTimeOverride:ne.hideTimeOverride}));const se=new i.Eb(ee);return new o.U({key:`grid-item-${ne.id}`,x:ne.gridPos.x,y:ne.gridPos.y,width:le.repeatDirection==="h"?24:ne.gridPos.w,height:ne.gridPos.h,itemHeight:ne.gridPos.h,body:se,maxPerRow:ne.maxPerRow,...le})}function q(ne){ne.subscribeToEvent(i.Kw,le=>{const{interaction:z}=le.payload;switch(z){case"panel-status-message-clicked":N.c.panelStatusMessageClicked();break;case"panel-cancel-query-clicked":N.c.panelCancelQueryClicked();break}})}const ae=ne=>ne.map(le=>({data:{values:le.fields.map(z=>z.values).filter(z=>z!==void 0)},schema:{fields:le.fields.map(z=>({name:z.name,type:z.type,config:z.config}))}})),j=ne=>{ne.snapshotData&&(ne.datasource=B.x,ne.targets=[{refId:ne.snapshotData[0]?.refId??"",datasource:ne.datasource,queryType:"snapshot",snapshot:ae(ne.snapshotData)}],ne.snapshotData=[])};function te(ne){(0,h.YQ)(ne).setState({isEmpty:ne.state.children.length===0});const le=ne.subscribeToState((z,ee)=>{(z.children.length!==ee.children.length||z.children!==ee.children)&&(0,h.YQ)(ne).setState({isEmpty:z.children.length===0})});return()=>{le.unsubscribe()}}},20455:(k,R,e)=>{"use strict";e.d(R,{Uy:()=>x,Z6:()=>M,ZB:()=>b,c:()=>C});var t=e(2543),n=e.n(t),i=e(92041),s=e(80943),r=e(79422),g=e(73134),a=e(28874),c=e(18803),o=e(79056),h=e(68706),f=e(16279),d=e(41507),p=e(60656),m=e(7928),v=e(79284),l=e(32023),y=e(74730),u=e(70665),D=e(13989),E=e(53287);function x(A,L=!1){const N=A.state,F=N.$timeRange.state,w=N.$data,B=N.$variables,U=N.body;let K=[],V=[];if(U instanceof s.hy){for(const te of U.state.children)if(te instanceof d.U&&(te.state.variableName?K=K.concat(I(te,N,L)):K.push(b(te,N,L))),te instanceof s.tI){if(te.state.key.indexOf("-clone-")>0&&!L)continue;T(te,K,N,L)}}let H=[];w instanceof f.s&&(H=(0,D.O)(w.state.annotationLayers)),B instanceof s.Pj&&(V=(0,E.C)(B));const Y=N.controls?.state,X=Y?.refreshPicker,J=S({refresh_intervals:X?.state.intervals,hidden:Y?.hideTimeControls,nowDelay:F.UNSAFE_nowDelay},r.lt),q=N.$behaviors?.find(te=>te instanceof s.Gg.K2)?.state.sync??r.Ye.graphTooltip,ae=N.$behaviors?.find(te=>te instanceof s.Gg.en)?.isEnabled||void 0,j={...r.Ye,title:N.title,description:N.description||void 0,uid:N.uid,id:N.id,editable:N.editable,preload:N.preload,time:{from:F.from,to:F.to},timepicker:J,panels:K,annotations:{list:H},templating:{list:V},version:N.version,timezone:F.timeZone,fiscalYearStartMonth:F.fiscalYearStartMonth,weekStart:F.weekStart,tags:N.tags,links:N.links,graphTooltip:q,liveNow:ae,schemaVersion:o.O2,refresh:X?.state.refresh};return(0,a.v)(j)}function P(A,L){if(!A.state.panel)throw new Error("Library panel has no panel");return{id:(0,y.Cs)(A.state.panel),title:A.state.title,gridPos:L,libraryPanel:{name:A.state.name,uid:A.state.uid}}}function b(A,L,N=!1){let F,w=0,B=0,U=0,K=0;if(A.state.body instanceof p.F)return w=A.state.x??0,B=A.state.y??0,U=A.state.width??0,K=A.state.itemHeight??A.state.height??0,P(A.state.body,{x:w,y:B,w:U,h:K});let V=A;if(L&&L.editPanel?.state.vizManager&&L.editPanel.state.vizManager.state.sourcePanel.resolve()===A.state.body){const Y=A.clone();Y.state.body instanceof s.Eb&&(L.editPanel.state.vizManager.commitChangesTo(Y.state.body),V=Y)}if(!(V.state.body instanceof s.Eb))throw new Error("DashboardGridItem body expected to be VizPanel");if(F=V.state.body,w=V.state.x??0,B=V.state.y??0,U=V.state.width??0,K=(V.state.variableName?V.state.itemHeight:V.state.height)??0,!F)throw new Error("Unsupported grid item type");return M(F,{x:w,y:B,h:K,w:U},N,V)}function M(A,L,N=!1,F){const w={id:(0,y.Cs)(A),type:A.state.pluginId,title:A.state.title,description:A.state.description??void 0,gridPos:L,fieldConfig:A.state.fieldConfig??{defaults:{},overrides:[]},transformations:[],transparent:A.state.displayMode==="transparent",pluginVersion:A.state.pluginVersion,...O(A,N)};if(A.state.options){const{angularOptions:K,...V}=A.state.options;w.options=V,K&&(0,t.defaults)(w,K)}const B=A.state.$timeRange;B instanceof m.v&&(w.timeFrom=B.state.timeFrom,w.timeShift=B.state.timeShift,w.hideTimeOverride=B.state.hideTimeOverride),F instanceof d.U&&(F.state.variableName&&(w.repeat=F.state.variableName),F.state.maxPerRow&&(w.maxPerRow=F.state.maxPerRow),F.state.repeatDirection&&(w.repeatDirection=F.getRepeatDirection()));const U=l.b4.getPanelLinks(A);return w.links=U?.state.rawLinks??[],w.links.length===0&&delete w.links,w.transformations?.length===0&&delete w.transformations,w.transparent||delete w.transparent,w}function O(A,L=!1){const N=A.state.$data,F={},w=(0,y.un)(A);if(w&&(F.targets=w.state.queries,F.maxDataPoints=w.state.maxDataPoints,F.datasource=w.state.datasource,w.state.cacheTimeout&&(F.cacheTimeout=w.state.cacheTimeout),w.state.queryCachingTTL&&(F.queryCachingTTL=w.state.queryCachingTTL),w.state.minInterval&&(F.interval=w.state.minInterval)),N instanceof s.Es&&(F.transformations=N.state.transformations),N&&L){F.datasource=u.x;let B=(0,c.B6)(N.state.data);N instanceof s.Es&&(B=(0,c.B6)(N.state.$data.state.data)),F.targets=[{refId:"A",datasource:F.datasource,queryType:h.nj.Snapshot,snapshot:B}]}return F}function I(A,L,N=!1){if(N){if(A.state.body instanceof p.F){const{x:F=0,y:w=0,width:B=0,height:U=0}=A.state;return[P(A.state.body,{x:F,y:w,w:B,h:U})]}if(A.state.repeatedPanels){const F=A.state.itemHeight??10,w=Math.ceil(A.state.repeatedPanels.length/A.getMaxPerRow()),B=Math.ceil(A.state.repeatedPanels.length/w),U=24/B,K=F;return A.state.repeatedPanels.map((H,Y)=>{let X=0,J=0;A.state.repeatDirection==="v"?(X=A.state.x,J=Y*K):(X=Y%B*U,J=A.state.y+Math.floor(Y/B)*K);const q={x:X,y:J,w:U,h:K},ae=H.state.$variables.getByName(A.state.variableName);return{id:(0,y.Cs)(H),type:H.state.pluginId,title:H.state.title,gridPos:q,options:H.state.options,fieldConfig:H.state.fieldConfig??{defaults:{},overrides:[]},transformations:[],transparent:H.state.displayMode==="transparent",scopedVars:{[A.state.variableName]:{text:ae?.state.text,value:ae?.state.value}},...O(H,N)}})}return[]}else return[b(A,L)]}function T(A,L,N,F=!1){const w=!!A.state.isCollapsed,B={type:"row",id:(0,y.Cs)(A),title:A.state.title,gridPos:{x:A.state.x??0,y:A.state.y??0,w:A.state.width??24,h:A.state.height??1},collapsed:w,panels:[]};if(A.state.$behaviors?.length){const K=A.state.$behaviors[0];K instanceof v.L&&(B.repeat=K.state.variableName)}if(F&&A.state.$variables){const V=A.state.$variables.state.variables.reduce((H,Y)=>({...H,[Y.state.name]:{text:Y.state.text,value:Y.state.value}}),{});B.scopedVars=V}L.push(B);let U=[];F?A.state.children.forEach(K=>{K instanceof d.U&&(K.state.variableName?U=U.concat(I(K,N,!w)):U.push(b(K,N,!w)))}):U=A.state.children.map(K=>{if(!(K instanceof d.U))throw new Error("Row child expected to be DashboardGridItem");return b(K,N)}),A.state.isCollapsed?B.panels=U:L.push(...U)}function C(A,L,N,F){let w={...N,title:A,time:{from:L.from.toISOString(),to:L.to.toISOString()},links:[]};if(F){const B=N.panels?.find(U=>U.id===(0,y.Cs)(F));B&&(B.gridPos={w:24,x:0,y:0,h:20},w={...w,panels:[B]})}if(w.panels?.forEach(B=>{"links"in B&&(B.links=[])}),w.annotations){const U=(w.annotations.list?.filter(K=>K.enable)||[]).map(K=>({name:K.name,enable:K.enable,iconColor:K.iconColor,type:K.type,builtIn:K.builtIn,hide:K.hide,snapshotData:[]}));w.annotations.list=U}return w.templating&&w.templating.list?.forEach(B=>{"query"in B&&(B.query=""),"options"in B&&(B.options=B.current&&!(0,i.R)(B.current)?[B.current]:[]),"refresh"in B&&(B.refresh=g.CO.never)}),w}function S(A,L){const N={...A};for(const F in L)(0,t.isEqual)(N[F],L[F])&&delete N[F];return N}},46502:(k,R,e)=>{"use strict";e.d(R,{F:()=>r});var t=e(74848),n=e(96540),i=e(32264),s=e(7376);class r extends n.PureComponent{constructor(){super(...arguments),this.ref=null}componentWillUnmount(){this.angularComponent&&this.angularComponent.destroy()}componentDidMount(){const a=i.$.angularSupportEnabled;this.ref&&a&&this.loadAngular()}componentDidUpdate(a){a.datasource!==this.props.datasource&&this.loadAngular(),this.scopeProps&&this.scopeProps.ctrl.currentAnnotation!==this.props.annotation&&(this.scopeProps.ctrl.ignoreNextWatcherFiring=!0,this.scopeProps.ctrl.currentAnnotation=this.props.annotation,this.angularComponent?.digest())}loadAngular(){this.angularComponent&&(this.angularComponent.destroy(),this.scopeProps=void 0);const a=(0,s.E)(),c='<plugin-component type="annotations-query-ctrl"> </plugin-component>',o={ctrl:{currentDatasource:this.props.datasource,currentAnnotation:this.props.annotation,ignoreNextWatcherFiring:!1}};this.angularComponent=a.load(this.ref,o,c),this.angularComponent.digest(),this.angularComponent.getScope().$watch(()=>{if(o.ctrl.ignoreNextWatcherFiring){o.ctrl.ignoreNextWatcherFiring=!1;return}this.props.onChange(o.ctrl.currentAnnotation)}),this.scopeProps=o}render(){return(0,t.jsx)("div",{ref:a=>this.ref=a})}}},65857:(k,R,e)=>{"use strict";e.d(R,{d:()=>d});var t=e(74848),n=e(88575),i=e(10354),s=e(90182),r=e(79924),g=e(57418),a=e(10880),c=e(55852),o=e(4588);const h=[{value:"dashboards",label:"Dashboards"},{value:"link",label:"Link"}],f=Object.keys(o.G).map(p=>({label:p,value:p}));function d({link:p,onUpdate:m,onGoBack:v}){const l=x=>{m({...p,tags:x})},y=x=>{const P={...p,type:x.value};P.type==="dashboards"?(P.url="",P.tooltip=""):P.tags=[],m(P)},u=x=>{m({...p,icon:x.value})},D=x=>{const P=x.currentTarget;m({...p,[P.name]:P.type==="checkbox"?P.checked:P.value})},E=p.title===o.q.title;return(0,t.jsxs)("div",{style:{maxWidth:"600px"},children:[(0,t.jsx)(n.D,{label:"Title",children:(0,t.jsx)(i.p,{name:"title",id:"title",value:p.title,onChange:D,autoFocus:E})}),(0,t.jsx)(n.D,{label:"Type",children:(0,t.jsx)(s.l6,{inputId:"link-type-input",value:p.type,options:h,onChange:y})}),p.type==="dashboards"&&(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(n.D,{label:"With tags",children:(0,t.jsx)(r.u,{tags:p.tags,onChange:l})})}),p.type==="link"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.D,{label:"URL",children:(0,t.jsx)(i.p,{name:"url",value:p.url,onChange:D})}),(0,t.jsx)(n.D,{label:"Tooltip",children:(0,t.jsx)(i.p,{name:"tooltip",value:p.tooltip,onChange:D,placeholder:"Open dashboard"})}),(0,t.jsx)(n.D,{label:"Icon",children:(0,t.jsx)(s.l6,{value:p.icon,options:f,onChange:u})})]}),(0,t.jsxs)(g.M,{label:"Options",isOpen:!0,children:[p.type==="dashboards"&&(0,t.jsx)(n.D,{children:(0,t.jsx)(a.S,{label:"Show as dropdown",name:"asDropdown",value:p.asDropdown,onChange:D})}),(0,t.jsx)(n.D,{children:(0,t.jsx)(a.S,{label:"Include current time range",name:"keepTime",value:p.keepTime,onChange:D})}),(0,t.jsx)(n.D,{children:(0,t.jsx)(a.S,{label:"Include current template variable values",name:"includeVars",value:p.includeVars,onChange:D})}),(0,t.jsx)(n.D,{children:(0,t.jsx)(a.S,{label:"Open link in new tab",name:"targetBlank",value:p.targetBlank,onChange:D})})]}),(0,t.jsx)(c.$n,{variant:"secondary",onClick:v,children:"Back to list"})]})}},6199:(k,R,e)=>{"use strict";e.d(R,{X:()=>p});var t=e(74848),n=e(32196),i=e(40845),s=e(67061),r=e(69529),g=e(55852),a=e(72109),c=e(14578),o=e(64149),h=e(29158),f=e(91605),d=e(8484);function p({links:v,onNew:l,onOrderChange:y,onEdit:u,onDuplicate:D,onDelete:E}){const x=(0,i.of)(m);return v.length===0?(0,t.jsx)(s.B,{direction:"column",children:(0,t.jsx)(r.p,{variant:"call-to-action",button:(0,t.jsx)(g.$n,{onClick:l,size:"lg",children:(0,t.jsx)(d.x6,{i18nKey:"dashboard-links.empty-state.button-title",children:"Add dashboard link"})}),message:(0,d.t)("dashboard-links.empty-state.title","There are no dashboard links added yet"),children:(0,t.jsxs)(d.x6,{i18nKey:"dashboard-links.empty-state.info-box-content",children:["Dashboard links allow you to place links to other dashboards and web sites directly below the dashboard header."," ",(0,t.jsx)(a.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/dashboards/build-dashboards/manage-dashboard-links/",children:"Learn more"})]})})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("table",{role:"grid",className:"filter-table filter-table--hover",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Type"}),(0,t.jsx)("th",{children:"Info"}),(0,t.jsx)("th",{colSpan:3})]})}),(0,t.jsx)("tbody",{children:v.map((b,M)=>(0,t.jsxs)("tr",{children:[(0,t.jsxs)("td",{role:"gridcell",className:"pointer",onClick:()=>u(M),children:[(0,t.jsx)(c.I,{name:"external-link-alt"})," \xA0 ",b.type]}),(0,t.jsx)("td",{role:"gridcell",className:"pointer",onClick:()=>u(M),children:(0,t.jsxs)(s.B,{children:[b.title&&(0,t.jsx)("span",{className:x.titleWrapper,children:b.title}),b.type==="link"&&(0,t.jsx)("span",{className:x.urlWrapper,children:b.url}),b.type==="dashboards"&&(0,t.jsx)(o.L,{tags:b.tags??[]})]})}),(0,t.jsx)("td",{style:{width:"1%"},role:"gridcell",children:M!==0&&(0,t.jsx)(h.K,{name:"arrow-up",onClick:()=>y(M,-1),tooltip:"Move link up"})}),(0,t.jsx)("td",{style:{width:"1%"},role:"gridcell",children:v.length>1&&M!==v.length-1?(0,t.jsx)(h.K,{name:"arrow-down",onClick:()=>y(M,1),tooltip:"Move link down"}):null}),(0,t.jsx)("td",{style:{width:"1%"},role:"gridcell",children:(0,t.jsx)(h.K,{name:"copy",onClick:()=>D(b),tooltip:"Copy link"})}),(0,t.jsx)("td",{style:{width:"1%"},role:"gridcell",children:(0,t.jsx)(f.e,{"aria-label":`Delete link with title "${b.title}"`,size:"sm",onConfirm:()=>E(M)})})]},`${b.title}-${M}`))})]}),(0,t.jsx)(g.$n,{className:x.newLinkButton,icon:"plus",onClick:l,children:"New link"})]})}const m=v=>({titleWrapper:(0,n.css)({width:"20vw",textOverflow:"ellipsis",overflow:"hidden"}),urlWrapper:(0,n.css)({width:"40vw",textOverflow:"ellipsis",overflow:"hidden"}),newLinkButton:(0,n.css)({marginTop:v.spacing(3)})})},4588:(k,R,e)=>{"use strict";e.d(R,{G:()=>n,q:()=>t});const t={icon:"external link",title:"New link",tooltip:"",type:"dashboards",url:"",asDropdown:!1,tags:[],targetBlank:!1,keepTime:!1,includeVars:!1},n={"external link":"external-link-alt",dashboard:"apps",question:"question-circle",info:"info-circle",bolt:"bolt",doc:"file-alt",cloud:"cloud"}},27803:(k,R,e)=>{"use strict";e.d(R,{Q:()=>f});var t=e(74848),n=e(96540),i=e(72436),s=e(13544),r=e(88575),g=e(42418),a=e(15292),c=e(32372),o=e(51612),h=e(58975);function f({datasource:d,infoText:p,onDataSourceChange:m,onDefaultKeysChange:v,defaultKeys:l}){const y=(0,n.useCallback)(u=>{const D=(0,i.Jh)(`key,value
`+u)[0],E=[];for(let x=0;x<D.length;x++)E.push({text:D.fields[0].values[x],value:D.fields[1].values[x]});v?.(E)},[v]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.Y,{children:"Ad-hoc options"}),(0,t.jsx)(r.D,{label:"Data source",htmlFor:"data-source-picker",children:(0,t.jsx)(o.s,{current:d,onChange:m,width:30,variables:!0,noDefault:!0})}),p?(0,t.jsx)(g.F,{title:p,severity:"info","data-testid":s.Tp.pages.Dashboard.Settings.Variables.Edit.AdHocFiltersVariable.infoText}):null,v&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.D,{label:"Use static key dimensions",description:"Provide dimensions as CSV: dimensionName, dimensionId",children:(0,t.jsx)(a.d,{"data-testid":s.Tp.pages.Dashboard.Settings.Variables.Edit.AdHocFiltersVariable.modeToggle,value:l!==void 0,onChange:u=>{v(l===void 0?[]:void 0)}})}),l!==void 0&&(0,t.jsx)(c.B,{height:300,language:"csv",value:l.map(u=>`${u.text},${u.value}`).join(`
`),onBlur:y,onSave:y,showMiniMap:!1,showLineNumbers:!0})]})]})}},95802:(k,R,e)=>{"use strict";e.d(R,{d:()=>r});var t=e(74848),n=e(13544),i=e(58975),s=e(14329);function r({onChange:g,constantValue:a}){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.Y,{children:"Constant options"}),(0,t.jsx)(s._,{defaultValue:a,name:"Value",placeholder:"your metric prefix",onBlur:g,testId:n.Tp.pages.Dashboard.Settings.Variables.Edit.ConstantVariable.constantOptionsQueryInputV2,width:30})]})}},58711:(k,R,e)=>{"use strict";e.d(R,{w:()=>g});var t=e(74848),n=e(13544),i=e(58975),s=e(85140),r=e(94618);function g({query:a,multi:c,allValue:o,includeAll:h,onQueryChange:f,onMultiChange:d,onIncludeAllChange:p,onAllValueChange:m}){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.Y,{children:"Custom options"}),(0,t.jsx)(s.Z,{name:"Values separated by comma",defaultValue:a,placeholder:"1, 10, mykey : myvalue, myvalue, escaped\\,value",onBlur:f,required:!0,width:52,testId:n.Tp.pages.Dashboard.Settings.Variables.Edit.CustomVariable.customValueInput}),(0,t.jsx)(i.Y,{children:"Selection options"}),(0,t.jsx)(r.B,{multi:c,includeAll:h,allValue:o,onMultiChange:d,onIncludeAllChange:p,onAllValueChange:m})]})}},98917:(k,R,e)=>{"use strict";e.d(R,{y:()=>a});var t=e(74848),n=e(13544),i=e(94618),s=e(58975),r=e(89458),g=e(14329);function a({query:c,regex:o,optionTypes:h,onChange:f,onRegExBlur:d,multi:p,includeAll:m,allValue:v,onMultiChange:l,onIncludeAllChange:y,onAllValueChange:u}){const D=h.find(E=>E.value===c)??h[0];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.Y,{children:"Data source options"}),(0,t.jsx)(r.v,{name:"Type",value:D,options:h,onChange:f,testId:n.Tp.pages.Dashboard.Settings.Variables.Edit.DatasourceVariable.datasourceSelect}),(0,t.jsx)(g._,{defaultValue:o,name:"Instance name filter",placeholder:"/.*-(.*)-.*/",onBlur:d,description:(0,t.jsxs)("div",{children:["Regex filter for which data source instances to choose from in the variable value list. Leave empty for all.",(0,t.jsx)("br",{}),(0,t.jsx)("br",{}),"Example: ",(0,t.jsx)("code",{children:"/^prod/"})]})}),(0,t.jsx)(s.Y,{children:"Selection options"}),(0,t.jsx)(i.B,{multi:p,includeAll:m,allValue:v,onMultiChange:l,onIncludeAllChange:y,onAllValueChange:u})]})}},49317:(k,R,e)=>{"use strict";e.d(R,{s:()=>o});var t=e(74848),n=e(32196),i=e(13544),s=e(40845),r=e(99615),g=e(58975),a=e(89458),c=e(14329);function o({intervals:f,onIntervalsChange:d,onAutoEnabledChange:p,onAutoMinIntervalChanged:m,onAutoCountChanged:v,autoEnabled:l,autoMinInterval:y,autoStepCount:u}){const D=[1,2,3,4,5,10,20,30,40,50,100,200,300,400,500].map(P=>({label:`${P}`,value:P})),E=(0,s.of)(h),x=D.find(P=>P.value===u)??D[0];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.Y,{children:"Interval options"}),(0,t.jsx)(c._,{defaultValue:f,name:"Values",placeholder:"1m,10m,1h,6h,1d,7d",onBlur:d,testId:i.Tp.pages.Dashboard.Settings.Variables.Edit.IntervalVariable.intervalsValueInput,width:32,required:!0}),(0,t.jsx)(r.c,{value:l,name:"Auto option",description:"Dynamically calculates interval by dividing time range by the count specified",onChange:p,testId:i.Tp.pages.Dashboard.Settings.Variables.Edit.IntervalVariable.autoEnabledCheckbox}),l&&(0,t.jsxs)("div",{className:E.autoFields,children:[(0,t.jsx)(a.v,{name:"Step count",description:"How many times the current time range should be divided to calculate the value",value:x,options:D,onChange:v,width:9,testId:i.Tp.pages.Dashboard.Settings.Variables.Edit.IntervalVariable.stepCountIntervalSelect}),(0,t.jsx)(c._,{value:y,name:"Min interval",description:"The calculated value will not go below this threshold",placeholder:"10s",onChange:m,width:11,testId:i.Tp.pages.Dashboard.Settings.Variables.Edit.IntervalVariable.minIntervalInput})]})]})}const h=f=>({autoFields:(0,n.css)({marginTop:f.spacing(2),display:"flex",flexDirection:"column"})})},44890:(k,R,e)=>{"use strict";e.d(R,{u:()=>T});var t=e(74848),n=e(16817),i=e(13544),s=e(19347),r=e(88575),g=e(39070),a=e(72574),c=e(90613),o=e(94753),h=e(24240);function f({query:C,datasource:S,VariableQueryEditor:A,onLegacyQueryChange:L,onQueryChange:N,timeRange:F}){let w;return typeof C=="string"?w=C||(S.variables?.getDefaultQuery?.()??""):w={...S.variables?.getDefaultQuery?.(),...C},A&&(0,h.VN)(A,S)?(0,t.jsxs)(c.a,{marginBottom:2,children:[(0,t.jsx)(o.E,{element:"h4",children:"Query"}),(0,t.jsx)(c.a,{marginTop:1,children:(0,t.jsx)(A,{datasource:S,query:w,templateSrv:(0,a.w)(),onChange:L},S.uid)})]}):A&&(0,h.CH)(A,S)?(0,t.jsxs)(c.a,{marginBottom:2,children:[(0,t.jsx)(o.E,{element:"h4",children:"Query"}),(0,t.jsx)(c.a,{marginTop:1,children:(0,t.jsx)(A,{datasource:S,query:w,onChange:N,onRunQuery:()=>{},data:{series:[],state:g.Gu.Done,timeRange:F},range:F,onBlur:()=>{},history:[]},S.uid)})]}):null}var d=e(94618),p=e(51612),m=e(70766),v=e(96540),l=e(12470),y=e(40845),u=e(94354),D=e(60619);const E=[{label:"On dashboard load",value:l.CO.onDashboardLoad},{label:"On time range change",value:l.CO.onTimeRangeChanged}];function x({onChange:C,refresh:S,testId:A}){const L=(0,y.$j)(),[N,F]=(0,v.useState)(!1);(0,D.Y)({breakpoint:L.breakpoints.values.sm,onChange:B=>{F(!B.matches)}});const w=(0,v.useMemo)(()=>E.find(B=>B.value===S)?.value??E[0].value,[S]);return(0,t.jsx)(r.D,{label:"Refresh",description:"When to update the values of this variable","data-testid":A,children:(0,t.jsx)(u.z,{options:E,onChange:C,value:w,size:N?"sm":"md"})})}var P=e(89458);const b=[{label:"Disabled",value:l.ZG.disabled},{label:"Alphabetical (asc)",value:l.ZG.alphabeticalAsc},{label:"Alphabetical (desc)",value:l.ZG.alphabeticalDesc},{label:"Numerical (asc)",value:l.ZG.numericalAsc},{label:"Numerical (desc)",value:l.ZG.numericalDesc},{label:"Alphabetical (case-insensitive, asc)",value:l.ZG.alphabeticalCaseInsensitiveAsc},{label:"Alphabetical (case-insensitive, desc)",value:l.ZG.alphabeticalCaseInsensitiveDesc},{label:"Natural (asc)",value:l.ZG.naturalAsc},{label:"Natural (desc)",value:l.ZG.naturalDesc}];function M({onChange:C,sort:S,testId:A}){const L=(0,v.useMemo)(()=>b.find(N=>N.value===S)??b[0],[S]);return(0,t.jsx)(P.v,{name:"Sort",description:"How to sort the values of this variable",value:L,options:b,onChange:C,testId:A,width:25})}var O=e(58975),I=e(85140);function T({datasource:C,onDataSourceChange:S,query:A,onQueryChange:L,onLegacyQueryChange:N,timeRange:F,regex:w,onRegExChange:B,sort:U,onSortChange:K,refresh:V,onRefreshChange:H,isMulti:Y,onMultiChange:X,includeAll:J,onIncludeAllChange:q,allValue:ae,onAllValueChange:j}){const{value:te}=(0,n.A)(async()=>{const z=await(0,s.l)().get(C??""),ee=await(0,m.y)(z);return{datasource:z,VariableQueryEditor:ee}},[C]),{datasource:ne,VariableQueryEditor:le}=te??{};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(O.Y,{children:"Query options"}),(0,t.jsx)(r.D,{label:"Data source",htmlFor:"data-source-picker",children:(0,t.jsx)(p.s,{current:C,onChange:S,variables:!0,width:30})}),ne&&le&&(0,t.jsx)(f,{onQueryChange:L,onLegacyQueryChange:N,datasource:ne,query:A,VariableQueryEditor:le,timeRange:F}),(0,t.jsx)(I.Z,{defaultValue:w??"",name:"Regex",description:(0,t.jsxs)("div",{children:["Optional, if you want to extract part of a series name or metric node segment.",(0,t.jsx)("br",{}),"Named capture groups can be used to separate the display text and value (",(0,t.jsx)("a",{className:"external-link",href:"https://grafana.com/docs/grafana/latest/variables/filter-variables-with-regex#filter-and-modify-using-named-text-and-value-capture-groups",target:"__blank",children:"see examples"}),")."]}),placeholder:"/.*-(?<text>.*)-(?<value>.*)-.*/",onBlur:B,testId:i.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsRegExInputV2,width:52}),(0,t.jsx)(M,{testId:i.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsSortSelectV2,onChange:K,sort:U}),(0,t.jsx)(x,{testId:i.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsRefreshSelectV2,onChange:H,refresh:V}),(0,t.jsx)(O.Y,{children:"Selection options"}),(0,t.jsx)(d.B,{multi:!!Y,includeAll:!!J,allValue:ae,onMultiChange:X,onIncludeAllChange:q,onAllValueChange:j})]})}},94618:(k,R,e)=>{"use strict";e.d(R,{B:()=>g});var t=e(74848),n=e(13544),i=e(67061),s=e(99615),r=e(14329);function g({multi:a,includeAll:c,allValue:o,onMultiChange:h,onIncludeAllChange:f,onAllValueChange:d}){return(0,t.jsxs)(i.B,{direction:"column",gap:2,height:"inherit",alignItems:"start",children:[(0,t.jsx)(s.c,{value:a,name:"Multi-value",description:"Enables multiple values to be selected at the same time",onChange:h,testId:n.Tp.pages.Dashboard.Settings.Variables.Edit.General.selectionOptionsMultiSwitch}),(0,t.jsx)(s.c,{value:c,name:"Include All option",description:"Enables an option to include all variables",onChange:f,testId:n.Tp.pages.Dashboard.Settings.Variables.Edit.General.selectionOptionsIncludeAllSwitch}),c&&(0,t.jsx)(r._,{defaultValue:o??"",onBlur:d,name:"Custom all value",placeholder:"blank = auto",testId:n.Tp.pages.Dashboard.Settings.Variables.Edit.General.selectionOptionsCustomAllInput})]})}},99615:(k,R,e)=>{"use strict";e.d(R,{c:()=>s});var t=e(74848),n=e(92145),i=e(10880);function s({value:r,name:g,description:a,onChange:c,ariaLabel:o,testId:h}){const f=(0,n.Bi)();return(0,t.jsx)(i.S,{id:f,label:g,description:a,value:r,onChange:c,"aria-label":o,"data-testid":h})}},8964:(k,R,e)=>{"use strict";e.d(R,{D:()=>a});var t=e(74848),n=e(96540),i=e(12470),s=e(88575),r=e(94354);const g=[{label:"Label and value",value:i.zL.dontHide},{label:"Value",value:i.zL.hideLabel},{label:"Nothing",value:i.zL.hideVariable}];function a({onChange:c,hide:o,type:h}){const f=(0,n.useMemo)(()=>g.find(d=>d.value===o)?.value??g[0].value,[o]);return h==="constant"?null:(0,t.jsx)(s.D,{label:"Show on dashboard",children:(0,t.jsx)(r.z,{options:g,onChange:c,value:f})})}},58975:(k,R,e)=>{"use strict";e.d(R,{Y:()=>r});var t=e(74848),n=e(32196),i=e(40845),s=e(17408);function r({className:a,...c}){const o=(0,i.of)(g);return(0,t.jsx)(s.s,{...c,className:(0,n.cx)(o.legend,a)})}function g(a){return{legend:(0,n.css)({marginTop:a.spacing(3),marginBottom:a.spacing(1)})}}},89458:(k,R,e)=>{"use strict";e.d(R,{v:()=>a});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(88575),g=e(90182);function a({name:o,description:h,value:f,options:d,onChange:p,testId:m,width:v}){const l=(0,s.of)(c),y=(0,i.useId)(),u=`variable-select-input-${o}-${y}`;return(0,t.jsx)(r.D,{label:o,description:h,htmlFor:u,children:(0,t.jsx)(g.l6,{"data-testid":m,inputId:u,onChange:p,value:f,width:v??30,options:d,className:l.selectContainer})})}function c(o){return{selectContainer:(0,n.css)({marginRight:o.spacing(.5)})}}},85140:(k,R,e)=>{"use strict";e.d(R,{$:()=>c,Z:()=>a});var t=e(74848),n=e(32196),i=e(92145),s=e(40845),r=e(88575),g=e(21744);function a({value:o,defaultValue:h,name:f,description:d,placeholder:p,onChange:m,onBlur:v,ariaLabel:l,required:y,width:u,testId:D}){const E=(0,s.of)(c),x=(0,i.Bi)();return(0,t.jsx)(r.D,{label:f,description:d,htmlFor:x,children:(0,t.jsx)(g.f,{id:x,rows:2,value:o,defaultValue:h,onChange:m,onBlur:v,placeholder:p,required:y,"aria-label":l,cols:u,className:E.textarea,"data-testid":D})})}function c(o){return{textarea:(0,n.css)({whiteSpace:"pre-wrap",minHeight:o.spacing(4),height:"auto",overflow:"auto",padding:`${o.spacing(.75)} ${o.spacing(1)}`,width:"inherit",[o.breakpoints.down("sm")]:{width:"100%"}})}}},14329:(k,R,e)=>{"use strict";e.d(R,{_:()=>r});var t=e(74848),n=e(92145),i=e(88575),s=e(10354);function r({value:g,defaultValue:a,name:c,placeholder:o="",onChange:h,testId:f,width:d,required:p,onBlur:m,grow:v,description:l,invalid:y,error:u,maxLength:D}){const E=(0,n.Bi)(c);return(0,t.jsx)(i.D,{label:c,description:l,invalid:y,error:u,htmlFor:E,children:(0,t.jsx)(s.p,{type:"text",id:E,placeholder:o,value:g,defaultValue:a,onChange:h,onBlur:m,width:v?void 0:d??30,"data-testid":f,maxLength:D,required:p})})}},41820:(k,R,e)=>{"use strict";e.d(R,{j:()=>o});var t=e(74848),n=e(32196),i=e(96540),s=e(13544),r=e(40845),g=e(39268),a=e(76892),c=e(55852);const o=({options:f})=>{const[d,p]=(0,i.useState)(20),[m,v]=(0,i.useState)([]),l=(0,i.useCallback)(u=>{u.preventDefault(),p(d+20)},[d,p]),y=(0,r.of)(h);return(0,i.useEffect)(()=>v(f.slice(0,d)),[d,f]),m.length?(0,t.jsxs)("div",{style:{display:"flex",flexDirection:"column",marginTop:"16px"},children:[(0,t.jsx)("h5",{children:"Preview of values"}),(0,t.jsx)(g.C,{children:m.map((u,D)=>(0,t.jsx)(g.C,{className:y.optionContainer,children:(0,t.jsx)(a.c,{"data-testid":s.Tp.pages.Dashboard.Settings.Variables.Edit.General.previewOfValuesOption,children:(0,t.jsx)("div",{className:y.label,children:u.label})})},`${u.value}-${D}`))}),f.length>d&&(0,t.jsx)(g.C,{className:y.optionContainer,children:(0,t.jsx)(c.$n,{onClick:l,variant:"secondary",size:"sm","aria-label":"Variable editor Preview of Values Show More link",children:"Show more"})})]}):null};o.displayName="VariableValuesPreview";function h(f){return{wrapper:(0,n.css)({display:"flex",flexDirection:"column",marginTop:f.spacing(2)}),optionContainer:(0,n.css)({marginLeft:f.spacing(.5),marginBottom:f.spacing(.5)}),label:(0,n.css)({whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"50vw"})}}},17663:(k,R,e)=>{"use strict";e.d(R,{cH:()=>z,mJ:()=>ee,Ao:()=>j,e4:()=>te,kh:()=>J,CD:()=>Y,No:()=>X,B$:()=>H,n_:()=>ae,bZ:()=>U,c7:()=>le});var t=e(2543),n=e(32264),i=e(19347),s=e(80943),r=e(79422),g=e(74730),a=e(74848),c=e(16817),o=e(22391),h=e(27803);function f(se){const{variable:ie}=se,{datasource:Z,defaultKeys:oe}=ie.useState(),{value:ce}=(0,c.A)(async()=>await(0,i.l)().get(Z),[Z]),ye=ce?.getTagKeys?"Ad hoc filters are applied automatically to all queries that target this data source":"This data source does not support ad hoc filters yet.",re=De=>{const ge=(0,o.p$)(De);ie.setState({datasource:ge})},ue=De=>{ie.setState({defaultKeys:De})};return(0,a.jsx)(h.Q,{datasource:Z??void 0,infoText:ye,onDataSourceChange:re,defaultKeys:oe,onDefaultKeysChange:ue})}var d=e(95802);function p({variable:se}){const{value:ie}=se.useState(),Z=oe=>{se.setState({value:oe.currentTarget.value})};return(0,a.jsx)(d.d,{constantValue:String(ie),onChange:Z})}var m=e(58711);function v({variable:se,onRunQuery:ie}){const{query:Z,isMulti:oe,allValue:ce,includeAll:ye}=se.useState(),re=Te=>{se.setState({isMulti:Te.currentTarget.checked})},ue=Te=>{se.setState({includeAll:Te.currentTarget.checked})},De=Te=>{se.setState({query:Te.currentTarget.value}),ie()},ge=Te=>{se.setState({allValue:Te.currentTarget.value})};return(0,a.jsx)(m.w,{query:Z??"",multi:!!oe,allValue:ce??"",includeAll:!!ye,onMultiChange:re,onIncludeAllChange:ue,onQueryChange:De,onAllValueChange:ge})}var l=e(98917);function y({variable:se,onRunQuery:ie}){const{pluginId:Z,regex:oe,isMulti:ce,allValue:ye,includeAll:re}=se.useState(),ue=te(),De=je=>{se.setState({pluginId:je.value}),ie()},ge=je=>{se.setState({regex:je.currentTarget.value}),ie()},Te=je=>{se.setState({isMulti:je.currentTarget.checked})},Le=je=>{se.setState({includeAll:je.currentTarget.checked})},Ye=je=>{se.setState({allValue:je.currentTarget.value})};return(0,a.jsx)(l.y,{query:Z,regex:oe,multi:ce||!1,allValue:ye,includeAll:re||!1,optionTypes:ue,onChange:De,onRegExBlur:ge,onMultiChange:Te,onIncludeAllChange:Le,onAllValueChange:Ye})}var u=e(96540),D=e(72436),E=e(13544),x=e(88575),P=e(42418),b=e(15292),M=e(32372),O=e(51612),I=e(58975);function T({datasource:se,defaultOptions:ie,infoText:Z,onDataSourceChange:oe,onDefaultOptionsChange:ce}){const ye=(0,u.useCallback)(re=>{const ue=(0,D.Jh)(`key,value
`+re)[0],De=[];for(let ge=0;ge<ue.length;ge++)De.push({text:ue.fields[0].values[ge],value:ue.fields[1].values[ge]});ce(De)},[ce]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(I.Y,{children:"Group by options"}),(0,a.jsx)(x.D,{label:"Data source",htmlFor:"data-source-picker",children:(0,a.jsx)(O.s,{current:se,onChange:oe,width:30,variables:!0,noDefault:!0})}),Z?(0,a.jsx)(P.F,{title:Z,severity:"info","data-testid":E.Tp.pages.Dashboard.Settings.Variables.Edit.GroupByVariable.infoText}):null,(0,a.jsx)(x.D,{label:"Use static Group By dimensions",description:"Provide dimensions as CSV: dimensionName, dimensionId",children:(0,a.jsx)(b.d,{"data-testid":E.Tp.pages.Dashboard.Settings.Variables.Edit.GroupByVariable.modeToggle,value:ie!==void 0,onChange:re=>{ce(ie===void 0?[]:void 0)}})}),ie!==void 0&&(0,a.jsx)(M.B,{height:300,language:"csv",value:ie.map(re=>`${re.text},${re.value}`).join(`
`),onBlur:ye,onSave:ye,showMiniMap:!1,showLineNumbers:!0})]})}function C(se){const{variable:ie,onRunQuery:Z}=se,{datasource:oe,defaultOptions:ce}=ie.useState(),{value:ye}=(0,c.A)(async()=>await(0,i.l)().get(oe),[ie.state]),re=ye?.getTagKeys?"Group by dimensions are applied automatically to all queries that target this data source":"This data source does not support group by variable yet.",ue=async ge=>{const Te=(0,o.p$)(ge);ie.setState({datasource:Te}),Z()},De=async ge=>{ie.setState({defaultOptions:ge}),Z()};return(0,a.jsx)(T,{defaultOptions:ce,datasource:oe??void 0,infoText:oe?re:void 0,onDataSourceChange:ue,onDefaultOptionsChange:De})}var S=e(49317);function A({variable:se,onRunQuery:ie}){const{intervals:Z,autoStepCount:oe,autoEnabled:ce,autoMinInterval:ye,value:re}=se.useState(),ue=(0,g.bx)(Z),De=Ye=>{const je=(0,g.Sm)(Ye.currentTarget.value),Ze=je.includes(re)?re:je[0];se.setState({intervals:je,value:Ze}),ie()},ge=Ye=>{se.setState({autoStepCount:Ye.value})},Te=Ye=>{se.setState({autoEnabled:Ye.target.checked})},Le=Ye=>{se.setState({autoMinInterval:Ye.currentTarget.value})};return(0,a.jsx)(S.s,{intervals:ue,autoStepCount:oe,autoEnabled:ce,onAutoCountChanged:ge,onIntervalsChange:De,onAutoEnabledChange:Te,onAutoMinIntervalChanged:Le,autoMinInterval:ye})}var L=e(44890);function N({variable:se,onRunQuery:ie}){const{datasource:Z,regex:oe,sort:ce,refresh:ye,isMulti:re,includeAll:ue,allValue:De,query:ge}=se.useState(),{value:Te}=s.jh.getTimeRange(se).useState(),Le=ze=>{se.setState({regex:ze.currentTarget.value})},Ye=ze=>{se.setState({sort:ze.value})},je=ze=>{se.setState({refresh:ze})},Ze=ze=>{se.setState({isMulti:ze.currentTarget.checked})},Ne=ze=>{se.setState({includeAll:ze.currentTarget.checked})},Pe=ze=>{se.setState({allValue:ze.currentTarget.value})},Ue=ze=>{const qe=(0,o.p$)(ze);if(se.state.datasource&&se.state.datasource.type!==qe.type){se.setState({datasource:qe,query:"",definition:""});return}se.setState({datasource:qe})},$e=ze=>{let qe;typeof ze=="string"?qe=ze:ze.hasOwnProperty("query")&&typeof ze.query=="string"?qe=ze.query:qe="",se.setState({query:ze,definition:qe}),ie()};return(0,a.jsx)(L.u,{datasource:Z??void 0,onDataSourceChange:Ue,query:ge,onQueryChange:$e,onLegacyQueryChange:$e,timeRange:Te,regex:oe,onRegExChange:Le,sort:ce,onSortChange:Ye,refresh:ye,onRefreshChange:je,isMulti:!!re,onMultiChange:Ze,includeAll:!!ue,onIncludeAllChange:Ne,allValue:De??"",onAllValueChange:Pe})}var F=e(14329);function w({defaultValue:se,value:ie,onChange:Z,onBlur:oe}){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(I.Y,{children:"Text options"}),(0,a.jsx)(F._,{value:ie,defaultValue:se,name:"Default value",placeholder:"default value, if any",onChange:Z,onBlur:oe,width:30,testId:E.Tp.pages.Dashboard.Settings.Variables.Edit.TextBoxVariable.textBoxOptionsQueryInputV2})]})}function B({variable:se}){const{value:ie}=se.useState(),Z=oe=>{se.setState({value:oe.currentTarget.value})};return(0,a.jsx)(w,{defaultValue:ie,onBlur:Z})}function U(se){return se!=="system"}const K={custom:{name:"Custom",description:"Define variable values manually",editor:v},query:{name:"Query",description:"Variable values are fetched from a datasource query",editor:N},constant:{name:"Constant",description:"Define a hidden constant variable, useful for metric prefixes in dashboards you want to share",editor:p},interval:{name:"Interval",description:"Define a timespan interval (ex 1m, 1h, 1d)",editor:A},datasource:{name:"Data source",description:"Enables you to dynamically switch the data source for multiple panels",editor:y},adhoc:{name:"Ad hoc filters",description:"Add key/value filters on the fly",editor:f},groupby:{name:"Group by",description:"Add keys to group by on the fly",editor:C},textbox:{name:"Textbox",description:"Define a textbox variable, where users can enter any arbitrary string",editor:B}},V=["query","custom","textbox","constant","datasource","interval","adhoc","groupby"];function H(){const se=V.map(ie=>({label:K[ie].name,value:ie,description:K[ie].description}));return n.$.featureToggles.groupByVariable?se:se.filter(ie=>ie.value!=="groupby")}function Y(se){return K[se].editor}function X(se,ie){switch(se){case"custom":return new s.yP(ie);case"query":return new s.fS(ie);case"constant":return new s.x0({...ie,hide:r.zL.hideVariable});case"interval":return new s.Yj(ie);case"datasource":return new s.mI(ie);case"adhoc":return new s.H9(ie);case"groupby":return new s.ZG(ie);case"textbox":return new s.TS(ie)}}function J(se){const Z=q("query",se);return new s.fS({name:Z})}function q(se,ie){let Z=0,oe=`${se}${Z}`;for(;ie.find(ce=>ce.state.name===oe);)oe=`${se}${++Z}`;return oe}function ae(se){return"options"in se.state||"intervals"in se.state}function j(se){let ie="";return se instanceof s.fS?ie=se.state.definition||(typeof se.state.query=="string"?se.state.query:""):se instanceof s.mI?ie=String(se.state.pluginId):se instanceof s.yP?ie=se.state.query:se instanceof s.Yj?ie=(0,g.bx)(se.state.intervals):(se instanceof s.TS||se instanceof s.x0)&&(ie=String(se.state.value)),ie}function te(){const se=(0,i.l)().getList({metrics:!0,variables:!0}),ie=(0,t.chain)(se).uniqBy("meta.id").map(Z=>({label:Z.meta.name,value:Z.meta.id})).value();return ie.unshift({label:"",value:""}),ie}function ne(se){return"type"in se.state&&"getValue"in se}function le(se){return ne(se)?s.Go.isAdHocVariable(se)||s.Go.isConstantVariable(se)||s.Go.isCustomVariable(se)||s.Go.isDataSourceVariable(se)||s.Go.isIntervalVariable(se)||s.Go.isQueryVariable(se)||s.Go.isTextBoxVariable(se)||s.Go.isGroupByVariable(se):!1}const z=/^(?!__).*$/,ee=/^\w+$/},19626:(k,R,e)=>{"use strict";e.d(R,{D:()=>d});var t=e(74848),n=e(32196),i=e(2543),s=e(40845),r=e(14578);const g=({diff:m})=>{const v=(0,s.of)(a),l=!(0,i.isUndefined)(m.originalValue)&&!(0,i.isArray)(m.originalValue)&&!(0,i.isObject)(m.originalValue),y=!(0,i.isUndefined)(m.value)&&!(0,i.isArray)(m.value)&&!(0,i.isObject)(m.value);return(0,t.jsxs)(t.Fragment,{children:[l&&(0,t.jsx)("span",{className:v,children:String(m.originalValue)}),l&&y?(0,t.jsx)(r.I,{name:"arrow-right"}):null,y&&(0,t.jsx)("span",{className:v,children:String(m.value)})]})},a=m=>(0,n.css)({backgroundColor:m.colors.action.hover,borderRadius:m.shape.radius.default,color:m.colors.text.primary,fontSize:m.typography.body.fontSize,margin:m.spacing(0,.5),padding:m.spacing(.25,.5)});var c=e(56596);const o={op:"replace",originalValue:void 0,path:[""],value:void 0,startLineNumber:0,endLineNumber:0},h=({diff:m,title:v})=>{const l=(0,s.of)(f);return m?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.I,{type:"mono",name:"circle",className:l[m.op],size:"xs"})," ",(0,t.jsx)("span",{className:l.embolden,children:v})," ",(0,t.jsx)("span",{children:(0,c.Fl)(m,m.path.length>1)})," ",(0,t.jsx)(g,{diff:m})]}):(0,t.jsxs)("div",{className:l.withoutDiff,children:[(0,t.jsx)(r.I,{type:"mono",name:"circle",className:l.replace,size:"xs"})," ",(0,t.jsx)("span",{className:l.embolden,children:v})," ",(0,t.jsx)("span",{children:(0,c.Fl)(o,!1)})]})},f=m=>({embolden:(0,n.css)({fontWeight:m.typography.fontWeightBold}),add:(0,n.css)({color:m.colors.success.main}),replace:(0,n.css)({color:m.colors.success.main}),move:(0,n.css)({color:m.colors.success.main}),copy:(0,n.css)({color:m.colors.success.main}),_get:(0,n.css)({color:m.colors.success.main}),test:(0,n.css)({color:m.colors.success.main}),remove:(0,n.css)({color:m.colors.success.main}),withoutDiff:(0,n.css)({marginBottom:m.spacing(1)})}),d=({diffs:m,title:v})=>{const l=(0,s.of)(p);return m.length===1?(0,t.jsx)("div",{className:l.container,"data-testid":"diffGroup",children:(0,t.jsx)(h,{title:v,diff:m[0]})}):(0,t.jsxs)("div",{className:l.container,"data-testid":"diffGroup",children:[(0,t.jsx)(h,{title:v}),(0,t.jsx)("ul",{className:l.list,children:m.map((y,u)=>(0,t.jsxs)("li",{className:l.listItem,children:[(0,t.jsx)("span",{children:(0,c.Fl)(y)})," ",(0,t.jsx)(g,{diff:y})]},`${(0,i.last)(y.path)}__${u}`))})]})},p=m=>({container:(0,n.css)({}),list:(0,n.css)({marginLeft:m.spacing(4)}),listItem:(0,n.css)({marginBottom:m.spacing(1),"&:last-child":{marginBottom:0}})})},22764:(k,R,e)=>{"use strict";e.d(R,{M:()=>a});var t=e(74848),n=e(32196),i=e(24773),s=e.n(i),r=e(84140),g=e(40845);const a=({oldValue:c,newValue:o,...h})=>{const f=(0,g.$j)(),d={variables:{dark:{diffViewerBackground:f.colors.background.canvas,diffViewerColor:f.colors.text.primary,addedBackground:(0,r.A)(f.v1.palette.greenShade).setAlpha(.3).toString(),addedColor:"white",removedBackground:(0,r.A)(f.v1.palette.redShade).setAlpha(.3).toString(),removedColor:"white",wordAddedBackground:(0,r.A)(f.v1.palette.greenBase).setAlpha(.4).toString(),wordRemovedBackground:(0,r.A)(f.v1.palette.redBase).setAlpha(.4).toString(),addedGutterBackground:(0,r.A)(f.v1.palette.greenShade).setAlpha(.2).toString(),removedGutterBackground:(0,r.A)(f.v1.palette.redShade).setAlpha(.2).toString(),gutterBackground:f.colors.background.primary,gutterBackgroundDark:f.colors.background.primary,highlightBackground:(0,r.A)(f.colors.primary.main).setAlpha(.4).toString(),highlightGutterBackground:(0,r.A)(f.colors.primary.shade).setAlpha(.2).toString(),codeFoldGutterBackground:f.colors.background.secondary,codeFoldBackground:f.colors.background.secondary,emptyLineBackground:f.colors.background.secondary,gutterColor:f.colors.text.disabled,addedGutterColor:f.colors.text.primary,removedGutterColor:f.colors.text.primary,codeFoldContentColor:f.colors.text.disabled,diffViewerTitleBackground:f.colors.background.secondary,diffViewerTitleColor:f.colors.text.disabled,diffViewerTitleBorderColor:f.colors.border.strong}},codeFold:{fontSize:f.typography.bodySmall.fontSize},gutter:{pre:{color:(0,r.A)(f.colors.text.disabled).setAlpha(1).toString(),opacity:.61}}};return(0,t.jsx)("div",{className:(0,n.css)({fontSize:f.typography.bodySmall.fontSize,pre:{all:"revert"}}),children:(0,t.jsx)(s(),{styles:d,oldValue:c,newValue:o,splitView:!1,compareMethod:i.DiffMethod.CSS,useDarkTheme:f.isDark,...h})})}},57714:(k,R,e)=>{"use strict";e.d(R,{Cc:()=>S,me:()=>D,bS:()=>m,rJ:()=>b,wL:()=>i});var t=e(17172);class n{getHistoryList(N,F){return typeof N!="string"?Promise.resolve([]):(0,t.AI)().get(`api/dashboards/uid/${N}/versions`,F)}getDashboardVersion(N,F){return typeof N!="string"?Promise.resolve({}):(0,t.AI)().get(`api/dashboards/uid/${N}/versions/${F}`)}restoreDashboard(N,F){if(typeof N!="string")return Promise.resolve({});const w=`api/dashboards/uid/${N}/restore`;return(0,t.AI)().post(w,{version:F})}}const i=new n;var s=e(74848),r=e(32196),g=e(40845),a=e(10880),c=e(78369),o=e(71678),h=e(55852),f=e(96374),d=e(3169);const p=({hideModal:L,onRestore:N,version:F})=>{const w=(0,d._2)(),B=async()=>{await N(F)?w.success("Dashboard restored",`Restored from version ${F.version}`):w.error("Dashboard restore failed",`Failed to restore from version ${F.version}`),L()};return(0,s.jsx)(f.u,{isOpen:!0,title:"Restore Version",icon:"history",onDismiss:L,onConfirm:B,body:(0,s.jsxs)("p",{children:["Are you sure you want to restore the dashboard to version ",F.version,"? All unsaved changes will be lost."]}),confirmText:`Yes, restore to version ${F.version}`})},m=({versions:L,canCompare:N,onCheck:F,onRestore:w})=>{const B=(0,g.of)(v);return(0,s.jsx)("div",{className:B.margin,children:(0,s.jsxs)("table",{className:"filter-table",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"width-4"}),(0,s.jsx)("th",{className:"width-4",children:"Version"}),(0,s.jsx)("th",{className:"width-14",children:"Date"}),(0,s.jsx)("th",{className:"width-10",children:"Updated by"}),(0,s.jsx)("th",{children:"Notes"}),(0,s.jsx)("th",{})]})}),(0,s.jsx)("tbody",{children:L.map((U,K)=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:(0,s.jsx)(a.S,{"aria-label":`Toggle selection of version ${U.version}`,className:(0,r.css)({display:"inline"}),checked:U.checked,onChange:V=>F(V,U.id),disabled:!U.checked&&N})}),(0,s.jsx)("td",{children:U.version}),(0,s.jsx)("td",{children:U.createdDateString}),(0,s.jsx)("td",{children:U.createdBy}),(0,s.jsx)("td",{children:U.message}),(0,s.jsx)("td",{className:"text-right",children:K===0?(0,s.jsx)(c.v,{name:"Latest",colorIndex:17}):(0,s.jsx)(o.$s,{children:({showModal:V,hideModal:H})=>(0,s.jsx)(h.$n,{variant:"secondary",size:"sm",icon:"history",onClick:()=>{V(p,{version:U,hideModal:H,onRestore:w})},children:"Restore"})})})]},U.id))})]})})};function v(L){return{margin:(0,r.css)({marginBottom:L.spacing(4)})}}var l=e(2543),y=e(29158),u=e(14578);const D=({onClick:L=l.noop,baseVersion:N=0,newVersion:F=0,isNewLatest:w=!1})=>{const B=(0,g.of)(E);return(0,s.jsxs)("h3",{className:B.header,children:[(0,s.jsx)(y.K,{name:"arrow-left",size:"xl",onClick:L,tooltip:"Reset version"}),(0,s.jsxs)("span",{children:["Comparing ",N," ",(0,s.jsx)(u.I,{name:"arrows-h"})," ",F," ",w&&(0,s.jsx)("cite",{className:"muted",children:"(Latest)"})]})]})},E=L=>({header:(0,r.css)({fontSize:L.typography.h3.fontSize,display:"flex",gap:L.spacing(2),marginBottom:L.spacing(2)})});var x=e(67061),P=e(56034);const b=({hasMore:L,canCompare:N,getVersions:F,getDiff:w,isLastPage:B})=>(0,s.jsxs)(x.B,{children:[L&&(0,s.jsx)(h.$n,{type:"button",onClick:()=>F(!0),variant:"secondary",disabled:B,children:"Show more versions"}),(0,s.jsx)(P.m,{content:"Select two versions to start comparing",placement:"bottom",children:(0,s.jsx)(h.$n,{type:"button",disabled:!N,onClick:w,icon:"code-branch",children:"Compare versions"})})]});var M=e(90613),O=e(57418),I=e(19626),T=e(22764),C=e(56596);const S=({baseInfo:L,newInfo:N,diffData:F,isNewLatest:w,onRestore:B})=>{const U=(0,C.G4)(F.lhs,F.rhs),K=(0,g.of)(A);return(0,s.jsxs)(x.B,{direction:"column",gap:1,children:[(0,s.jsxs)(x.B,{justifyContent:"space-between",alignItems:"center",children:[(0,s.jsxs)(x.B,{alignItems:"center",children:[(0,s.jsxs)("span",{className:(0,r.cx)(K.versionInfo,K.noMarginBottom),children:[(0,s.jsxs)("strong",{children:["Version ",L.version]})," updated by ",L.createdBy," ",L.ageString,L.message]}),(0,s.jsx)(u.I,{name:"arrow-right",size:"sm"}),(0,s.jsxs)("span",{className:K.versionInfo,children:[(0,s.jsxs)("strong",{children:["Version ",N.version]})," updated by ",N.createdBy," ",N.ageString,N.message]})]}),w&&(0,s.jsx)(o.$s,{children:({showModal:V,hideModal:H})=>(0,s.jsxs)(h.$n,{variant:"destructive",icon:"history",onClick:()=>{V(p,{version:L,onRestore:B,hideModal:H})},children:["Restore to version ",L.version]})})]}),Object.entries(U).map(([V,H])=>(0,s.jsx)(I.D,{diffs:H,title:V},V)),(0,s.jsx)(M.a,{paddingTop:2,children:(0,s.jsx)(O.M,{isOpen:!1,label:"View JSON Diff",children:(0,s.jsx)(T.M,{oldValue:JSON.stringify(F.lhs,null,2),newValue:JSON.stringify(F.rhs,null,2)})})})]})},A=L=>({versionInfo:(0,r.css)({color:L.colors.text.secondary,fontSize:L.typography.bodySmall.fontSize}),noMarginBottom:(0,r.css)({marginBottom:0})})},56596:(k,R,e)=>{"use strict";e.d(R,{Fl:()=>g,G4:()=>r});var t=e(16111),n=e(25504),i=e(2543),s=e.n(i);const r=(o,h)=>{const f=(0,t.UD)(o,h),d=n.stringify(o,null,2),p=n.stringify(h,null,2),m=y=>y.map(u=>{let D,E,x=0,P=0;const b=(0,i.tail)(u.path.split("/"));return u.op==="replace"&&p.pointers[u.path]&&(D=(0,i.get)(o,b),E=u.value,x=p.pointers[u.path].value.line,P=p.pointers[u.path].valueEnd.line),u.op==="add"&&p.pointers[u.path]&&(E=u.value,x=p.pointers[u.path].value.line,P=p.pointers[u.path].valueEnd.line),u.op==="remove"&&d.pointers[u.path]&&(D=(0,i.get)(o,b),x=d.pointers[u.path].value.line,P=d.pointers[u.path].valueEnd.line),{op:u.op,value:E,path:b,originalValue:D,startLineNumber:x,endLineNumber:P}}),v=y=>(0,i.sortBy)(y,"startLineNumber"),l=y=>y.reduce((u,D)=>{const E=D.path[0];return u[E]||(u[E]=[]),u[E].push(D),u},{});return(0,i.flow)([m,v,l])(f)},g=(o,h=!0)=>{const f=(0,i.last)(o.path),d=a(f),p=o.op==="remove"?o.originalValue:o.value;let m=c(o.op);return h&&(d?m+=` item ${f}`:(0,i.isArray)(p)&&!(0,i.isEmpty)(p)?m+=` ${p.length} ${f}`:m+=` ${f}`),m},a=o=>!(0,i.isNaN)((0,i.toNumber)(o)),c=o=>o==="add"?"added":o==="remove"?"deleted":"changed"},91119:(k,R,e)=>{"use strict";e.d(R,{j:()=>g});var t=e(74848),n=e(80943),i=e(87978),s=e(74730),r=e(62522);class g extends n.Bs{constructor(){super(...arguments),this.onDismiss=()=>{(0,s.YQ)(this).closeModal()}}static{this.Component=a}}function a({model:c}){const{title:o,body:h}=c.useState(),f=(0,s.YQ)(c);return(0,t.jsx)(i._,{title:o,onClose:c.onDismiss,size:"md",children:(0,t.jsx)(r.A.Provider,{value:{dashboard:f},children:(0,t.jsx)(h.Component,{model:h})})})}},62522:(k,R,e)=>{"use strict";e.d(R,{A:()=>n,X:()=>i});var t=e(96540);const n=(0,t.createContext)(void 0),i=()=>{const s=(0,t.useContext)(n);if(s===void 0)throw new Error("useShareDrawerContext must be used within a DrawerContext");return s}},50056:(k,R,e)=>{"use strict";e.d(R,{N:()=>P});var t=e(74848),n=e(4213),i=e.n(n),s=e(16817),r=e(70713),g=e(80943),a=e(67061),c=e(88575),o=e(15292),h=e(37390),f=e(55852),d=e(32372),p=e(10534),m=e(8484),v=e(15858),l=e(22699),y=e(34214),u=e(20455),D=e(73788),E=e(7758),x=e(74730);class P extends g.Bs{constructor(O){super({isSharingExternally:!1,isViewingJSON:!1,...O}),this.tabId=l.wr.export,this._exporter=new v.M,this.onShareExternallyChange=()=>{this.setState({isSharingExternally:!this.state.isSharingExternally})},this.onViewJSON=()=>{this.setState({isViewingJSON:!this.state.isViewingJSON})},this.getExportableDashboardJson=async()=>{const{isSharingExternally:I}=this.state,T=(0,u.Uy)((0,x.YQ)(this));return I?await this._exporter.makeExportable(new y.G(T,void 0,{getVariablesFromState:()=>(0,D.E)(window.__grafanaSceneContext)})):T},this.onSaveAsFile=async()=>{const I=await this.getExportableDashboardJson(),T=JSON.stringify(I,null,2),{isSharingExternally:C}=this.state,S=new Blob([T],{type:"application/json;charset=utf-8"}),A=new Date().getTime();let L="dashboard";"title"in I&&I.title&&(L=I.title),i()(S,`${L}-${A}.json`),E.c.exportDownloadJsonClicked({externally:C})}}static{this.Component=b}getTabLabel(){return(0,m.t)("share-modal.tab-title.export","Export")}getClipboardText(){}}function b({model:M}){const{isSharingExternally:O,isViewingJSON:I,modalRef:T}=M.useState(),C=(0,s.A)(async()=>{if(I){const A=await M.getExportableDashboardJson();return JSON.stringify(A,null,2)}return""},[I]),S=(0,m.t)("share-modal.export.share-externally-label","Export for sharing externally");return(0,t.jsxs)(t.Fragment,{children:[!I&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:"share-modal-info-text",children:(0,t.jsx)(m.x6,{i18nKey:"share-modal.export.info-text",children:"Export this dashboard."})}),(0,t.jsx)(a.B,{gap:2,direction:"column",children:(0,t.jsx)(c.D,{label:S,children:(0,t.jsx)(o.d,{id:"share-externally-toggle",value:O,onChange:M.onShareExternallyChange})})}),(0,t.jsxs)(h.a.ButtonRow,{children:[(0,t.jsx)(f.$n,{variant:"secondary",onClick:()=>{T?.resolve().onDismiss()},fill:"outline",children:(0,t.jsx)(m.x6,{i18nKey:"share-modal.export.cancel-button",children:"Cancel"})}),(0,t.jsx)(f.$n,{variant:"secondary",icon:"brackets-curly",onClick:M.onViewJSON,children:(0,t.jsx)(m.x6,{i18nKey:"share-modal.export.view-button",children:"View JSON"})}),(0,t.jsx)(f.$n,{variant:"primary",icon:"save",onClick:()=>M.onSaveAsFile(),children:(0,t.jsx)(m.x6,{i18nKey:"share-modal.export.save-button",children:"Save to file"})})]})]}),I&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.Ay,{disableHeight:!0,children:({width:A})=>C.value?(0,t.jsx)(d.B,{value:C.value??"",language:"json",showMiniMap:!1,height:"500px",width:A}):C.loading?(0,t.jsx)("div",{children:"Loading..."}):null}),(0,t.jsxs)(h.a.ButtonRow,{children:[(0,t.jsx)(f.$n,{variant:"secondary",fill:"outline",onClick:M.onViewJSON,icon:"arrow-left",children:(0,t.jsx)(m.x6,{i18nKey:"share-modal.export.back-button",children:"Back to export config"})}),(0,t.jsx)(p.b,{variant:"secondary",icon:"copy",disabled:C.loading,getText:()=>C.value??"",children:(0,t.jsx)(m.x6,{i18nKey:"share-modal.view-json.copy-button",children:"Copy to Clipboard"})}),(0,t.jsx)(f.$n,{variant:"primary",icon:"save",disabled:C.loading,onClick:()=>M.onSaveAsFile(),children:(0,t.jsx)(m.x6,{i18nKey:"share-modal.export.save-button",children:"Save to file"})})]})]})]})}},95007:(k,R,e)=>{"use strict";e.d(R,{A:()=>c});var t=e(74848),n=e(67061),i=e(15292),s=e(60029),r=e(62930),g=e(8484),a=e(87895);function c({useLockedTime:o,onToggleLockedTime:h,useShortUrl:f,onUrlShorten:d,onChangeTheme:p,selectedTheme:m,isLoading:v}){return(0,t.jsxs)(n.B,{justifyContent:"space-between",children:[(0,t.jsxs)(n.B,{gap:2,direction:"column",children:[(0,t.jsxs)(n.B,{gap:1,direction:"column",children:[(0,t.jsxs)(n.B,{gap:1,alignItems:"start",children:[(0,t.jsx)(i.d,{label:(0,g.t)("link.share.time-range-label","Lock time range"),id:"share-current-time-range",value:o,onChange:h}),(0,t.jsx)(s.J,{description:(0,g.t)("link.share.time-range-description","Change the current relative time range to an absolute time range"),children:(0,t.jsx)(g.x6,{i18nKey:"link.share.time-range-label",children:"Lock time range"})})]}),(0,t.jsxs)(n.B,{gap:1,alignItems:"start",children:[(0,t.jsx)(i.d,{id:"share-short-url",value:f,label:(0,g.t)("link.share.short-url-label","Shorten link"),onChange:d}),(0,t.jsx)(s.J,{children:(0,t.jsx)(g.x6,{i18nKey:"link.share.short-url-label",children:"Shorten link"})})]})]}),(0,t.jsx)(a.w,{selectedTheme:m,onChange:p})]}),v&&(0,t.jsx)(r.y,{})]})}},58398:(k,R,e)=>{"use strict";e.d(R,{R:()=>E});var t=e(74848),n=e(47232),i=e(13544),s=e(32264),r=e(80943),g=e(84167),a=e(88575),c=e(15292),o=e(10354),h=e(10534),f=e(14578),d=e(42418),p=e(8484),m=e(7030),v=e(87895),l=e(22699),y=e(7758),u=e(11982),D=e(74730);class E extends r.Bs{constructor(M){super({...M,useLockedTime:M.useLockedTime??!0,useShortUrl:M.useShortUrl??!1,selectedTheme:M.selectedTheme??"current",shareUrl:"",imageUrl:"",isBuildUrlLoading:!1}),this.tabId=l.wr.link,this.getShareUrl=()=>this.state.shareUrl,this.onCopy=()=>{y.c.shareLinkCopied({currentTimeRange:this.state.useLockedTime,theme:this.state.selectedTheme,shortenURL:this.state.useShortUrl,shareResource:(0,l.hD)(this.state.panelRef)})},this.addActivationHandler(()=>{this.buildUrl()}),this.onToggleLockedTime=this.onToggleLockedTime.bind(this),this.onUrlShorten=this.onUrlShorten.bind(this),this.onThemeChange=this.onThemeChange.bind(this)}static{this.Component=x}async buildUrl(){this.setState({isBuildUrlLoading:!0});const{panelRef:M,useLockedTime:O,useShortUrl:I,selectedTheme:T}=this.state,C=(0,D.YQ)(this),S=M?.resolve(),A={useAbsoluteTimeRange:O,theme:T,useShortUrl:I};let L=(0,m.VN)(C,A,S);I&&(L=await(0,m.fn)(L));const N=r.jh.getTimeRange(S??C),F=(0,m.$l)(A,N,S);let w=F;S&&(delete w.viewPanel,w.panelId=S.state.key,w["__feature.dashboardSceneSolo"]=!0);const B=(0,u.uZ)({uid:C.state.uid,currentQueryParams:location.search,updateQuery:{...F,panelId:S?.state.key},absolute:!0,soloRoute:!0,render:!0,timeZone:P(N.getTimeZone())});this.setState({shareUrl:L,imageUrl:B,isBuildUrlLoading:!1})}getTabLabel(){return(0,p.t)("share-modal.tab-title.link","Link")}async onToggleLockedTime(){const M=!this.state.useLockedTime;this.setState({useLockedTime:M}),await this.buildUrl()}async onUrlShorten(){const M=!this.state.useShortUrl;this.setState({useShortUrl:M}),await this.buildUrl()}async onThemeChange(M){this.setState({selectedTheme:M}),await this.buildUrl()}}function x({model:b}){const M=b.useState(),{panelRef:O}=M,I=(0,D.YQ)(b),T=O?.resolve(),S=r.jh.getTimeRange(T??I).state.to==="now",{useLockedTime:A,useShortUrl:L,selectedTheme:N,shareUrl:F,imageUrl:w}=M,B=i.Tp.pages.SharePanelModal,U=!!I.state.uid,K=(0,p.t)("share-modal.link.time-range-label","Lock time range"),V=(0,p.t)("share-modal.link.time-range-description","Transforms the current relative time range to an absolute time range"),H=(0,p.t)("share-modal.link.shorten-url","Shorten URL"),Y=(0,p.t)("share-modal.link.link-url","Link URL");return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:"share-modal-info-text",children:(0,t.jsx)(p.x6,{i18nKey:"share-modal.link.info-text",children:"Create a direct link to this dashboard or panel, customized with the options below."})}),(0,t.jsxs)(g.n,{children:[(0,t.jsx)(a.D,{label:K,description:S?V:"",children:(0,t.jsx)(c.d,{id:"share-current-time-range",value:A,onChange:b.onToggleLockedTime})}),(0,t.jsx)(v.w,{selectedTheme:N,onChange:b.onThemeChange}),(0,t.jsx)(a.D,{label:H,children:(0,t.jsx)(c.d,{id:"share-shorten-url",value:L,onChange:b.onUrlShorten})}),(0,t.jsx)(a.D,{label:Y,children:(0,t.jsx)(o.p,{id:"link-url-input",value:F,readOnly:!0,addonAfter:(0,t.jsx)(h.b,{icon:"copy",variant:"primary",getText:b.getShareUrl,onClipboardCopy:b.onCopy,children:(0,t.jsx)(p.x6,{i18nKey:"share-modal.link.copy-link-button",children:"Copy"})})})})]}),T&&s.$.rendererAvailable&&(0,t.jsxs)(t.Fragment,{children:[U&&(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsxs)("a",{href:w,target:"_blank",rel:"noreferrer","aria-label":B.linkToRenderedImage,children:[(0,t.jsx)(f.I,{name:"camera"}),"\xA0",(0,t.jsx)(p.x6,{i18nKey:"share-modal.link.rendered-image",children:"Direct link rendered image"})]})}),!U&&(0,t.jsx)(d.F,{severity:"info",title:(0,p.t)("share-modal.link.save-alert","Dashboard is not saved"),bottomSpacing:0,children:(0,t.jsx)(p.x6,{i18nKey:"share-modal.link.save-dashboard",children:"To render a panel image, you must save the dashboard first."})})]}),T&&!s.$.rendererAvailable&&(0,t.jsx)(d.F,{severity:"info",title:(0,p.t)("share-modal.link.render-alert","Image renderer plugin not installed"),bottomSpacing:0,children:(0,t.jsxs)(p.x6,{i18nKey:"share-modal.link.render-instructions",children:["To render a panel image, you must install the"," ",(0,t.jsx)("a",{href:"https://grafana.com/grafana/plugins/grafana-image-renderer",target:"_blank",rel:"noopener noreferrer",className:"external-link",children:"Grafana image renderer plugin"}),". Please contact your Grafana administrator to install the plugin."]})})]})}function P(b){const M="UTC"+encodeURIComponent((0,n.KQ)().format("Z"));if(b==="utc")return"UTC";if(b==="browser"){if(!window.Intl)return M;const I=window.Intl.DateTimeFormat().resolvedOptions();return I.timeZone?I.timeZone:M}return b}},85174:(k,R,e)=>{"use strict";e.d(R,{Z:()=>ne});var t=e(74848),n=e(32264),i=e(80943),s=e(25897),r=e(37390),g=e(40980),a=e(10096),c=e(8484),o=e(72254),h=e(22699),f=e(60656),d=e(7758),p=e(74730),m=e(50056),v=e(86394),l=e(34214),y=e(41507),u=e(20455);class D extends i.Bs{constructor(){super(...arguments),this.tabId=h.wr.libraryPanel}static{this.Component=E}getTabLabel(){return(0,c.t)("share-modal.tab-title.library-panel","Library panel")}}function E({model:z}){const{panelRef:ee,modalRef:se}=z.useState();if(!ee)return null;const ie=ee.resolve(),Z=ie.parent;if(Z instanceof y.U){const oe=(0,p.YQ)(z),ce=(0,u.ZB)(Z),ye=new l.a(ce),re=(0,u.Uy)(oe),ue=new l.G(re);return(0,t.jsx)(v.j,{initialFolderUid:oe.state.meta.folderUid,dashboard:ue,panel:ye,onDismiss:()=>{se?.resolve().onDismiss()},onCreateLibraryPanel:De=>oe.createLibraryPanel(ie,De)})}return null}var x=e(58398),P=e(35280),b=e(7928),M=e(11982);class O extends i.Bs{constructor(ee){super(ee),this.tabId=h.wr.embed}static{this.Component=I}getTabLabel(){return(0,c.t)("share-modal.tab-title.panel-embed","Embed")}}function I({model:z}){const{panelRef:ee}=z.useState(),se=ee.resolve(),ie=(0,p.YQ)(z),{uid:Z}=ie.useState(),oe=(0,p.Cs)(se),ce=i.jh.getTimeRange(se),ye=ce instanceof b.v?ce.state.timeFrom:void 0;return(0,t.jsx)(P.D,{panel:{id:oe,timeFrom:ye},range:ce.state.value,dashboard:{uid:Z??"",time:ce.state.value},buildIframe:T(ie)})}const T=z=>(ee,se,ie,Z,oe)=>{const ce=(0,h.XV)({useCurrentTimeRange:ee,selectedTheme:ie,panel:Z,range:oe}),ye=ce.get("editPanel")??ce.get("viewPanel")??"";return ce.set("panelId",ye),ce.delete("editPanel"),ce.delete("viewPanel"),ce.set("__feature.dashboardSceneSolo","true"),`<iframe src="${(0,M.uZ)({absolute:!0,soloRoute:!0,uid:z.state.uid,slug:z.state.meta.slug,currentQueryParams:ce.toString()})}" width="450" height="200" frameborder="0"></iframe>`};var C=e(12962),S=e(72686),A=e(4785),L=e(32196),N=e(40845),F=e(59037),w=e(31678),B=e(96374);class U extends i.Bs{static{this.Component=K}constructor(ee){super({confirmVariant:"destructive",dismissText:"Cancel",dismissVariant:"secondary",icon:"exclamation-triangle",confirmButtonVariant:"destructive",...ee})}onDismiss(){}}function K({model:z}){const ee=z.useState();return(0,t.jsx)(B.u,{...ee})}var V=e(59995);function H({model:z,publicDashboard:ee,isGetLoading:se}){const ie=(0,N.of)(Y),Z=a.TP.hasPermission(w.AccessControlAction.DashboardsPublicWrite),oe=(0,p.YQ)(z),{isDirty:ce}=oe.useState(),[ye]=(0,S.bN)(),re=(oe.state.$variables?.state.variables.length??0)>0,ue=(0,V.b)(oe),ge=i.jh.getTimeRange(z).useState();return(0,t.jsx)(F.b,{dashboard:oe,publicDashboard:ee,unsupportedDatasources:ue,onRevoke:()=>{oe.showModal(new U({isOpen:!0,title:"Revoke public URL",icon:"trash-alt",confirmText:"Revoke public URL",body:(0,t.jsx)("p",{className:ie.description,children:"Are you sure you want to revoke this URL? The dashboard will no longer be public."}),onDismiss:()=>{oe.showModal(new ne({activeTab:h.wr.publicDashboard}))},onConfirm:()=>{ye({dashboard:oe,dashboardUid:oe.state.uid,uid:ee.uid}),oe.closeModal()}}))},timeRange:ge.value,showSaveChangesAlert:Z&&ce,hasTemplateVariables:re})}const Y=z=>({description:(0,L.css)({fontSize:z.typography.body.fontSize})});var X=e(22234);function J({model:z}){const ee=(0,p.YQ)(z),se=(0,V.b)(ee),ie=(ee.state.$variables?.state.variables.length??0)>0;return(0,t.jsx)(X.D,{dashboard:ee,unsupportedDatasources:se,unsupportedTemplateVariables:ie})}class q extends i.Bs{constructor(){super(...arguments),this.tabId=h.wr.publicDashboard}static{this.Component=ae}getTabLabel(){return(0,c.t)("share-modal.tab-title.public-dashboard","Public Dashboard")}}function ae({model:z}){const{data:ee,isLoading:se}=(0,S.Bs)((0,p.YQ)(z).state.uid);return(0,t.jsx)(t.Fragment,{children:se?(0,t.jsx)(A.a,{}):(0,o.lI)(ee)?(0,t.jsx)(H,{model:z,publicDashboard:ee,isGetLoading:se}):(0,t.jsx)(J,{model:z})})}const j=[];function te(z){j.push(z)}class ne extends i.Bs{constructor(ee){super({activeTab:"link",...ee}),this.onDismiss=()=>{(0,p.YQ)(this).closeModal()},this.onChangeTab=se=>{d.c.sharingCategoryClicked({item:se.value,shareResource:(0,h.hD)(this.state.panelRef)}),this.setState({activeTab:se.value})},this.addActivationHandler(()=>this.buildTabs())}static{this.Component=le}buildTabs(){const{panelRef:ee}=this.state,se=this.getRef(),ie=[new x.R({panelRef:ee,modalRef:se})],Z=(0,p.YQ)(this);if(ee||ie.push(new m.N({modalRef:se})),a.TP.isSignedIn&&n.$.snapshotEnabled&&Z.canEditDashboard()&&ie.push(new C.l({panelRef:ee,dashboardRef:Z.getRef(),modalRef:se})),ee){ie.push(new O({panelRef:ee}));const oe=ee.resolve(),ce=oe.parent instanceof f.F;oe instanceof i.Eb&&(ce||ie.push(new D({panelRef:ee,modalRef:se})))}ee||(ie.push(...j.map(oe=>new oe({modalRef:se}))),(0,o.iR)()&&ie.push(new q({modalRef:se}))),this.setState({tabs:ie})}}function le({model:z}){const{panelRef:ee,tabs:se,activeTab:ie}=z.useState(),Z=ee?(0,c.t)("share-modal.panel.title","Share Panel"):(0,c.t)("share-modal.dashboard.title","Share");if(!se)return;const oe=se?.map(re=>({label:re.getTabLabel(),value:re.tabId})),ce=(0,t.jsx)(s.J,{title:Z,icon:"share-alt",tabs:oe,activeTab:ie,onChangeTab:z.onChangeTab}),ye=se.find(re=>re.tabId===ie);return(0,t.jsx)(r.a,{isOpen:!0,title:ce,onDismiss:z.onDismiss,children:(0,t.jsx)(g.J,{children:ye&&(0,t.jsx)(ye.Component,{model:ye})})})}},12962:(k,R,e)=>{"use strict";e.d(R,{l:()=>M,u:()=>P});var t=e(74848),n=e(5805),i=e(13544),s=e(17172),r=e(80943),g=e(88575),a=e(10354),c=e(94354),o=e(37390),h=e(55852),f=e(67061),d=e(10534),p=e(82467),m=e(3169),v=e(8484),l=e(22699),y=e(69064),u=e(99140),D=e(20455),E=e(7758);const x=i.Tp.pages.ShareDashboardModal.SnapshotScene,P=()=>{const I={label:(0,v.t)("share-modal.snapshot.expire-week","1 Week"),value:604800};return[{label:(0,v.t)("share-modal.snapshot.expire-hour","1 Hour"),value:60*60},{label:(0,v.t)("share-modal.snapshot.expire-day","1 Day"),value:60*60*24},I,{label:(0,v.t)("share-modal.snapshot.expire-never","Never"),value:0}]},b=()=>P()[2];class M extends r.Bs{constructor(T){super({...T,snapshotName:T.dashboardRef.resolve().state.title,selectedExpireOption:b()}),this.tabId=l.wr.snapshot,this.onSnasphotNameChange=C=>{this.setState({snapshotName:C.trim()})},this.onExpireChange=C=>{this.setState({selectedExpireOption:P().find(S=>S.value===C)})},this.onSnapshotCreate=async(C=!1)=>{const{selectedExpireOption:S}=this.state,A=this.prepareSnapshot(),L={dashboard:A,name:A.title,expires:S?.value,external:C};try{const N=await(0,y.s)().create(L);return(0,u.JD)((0,p.dx)((0,m.tZ)((0,v.t)("snapshot.share.success-creation","Your snapshot has been created")))),N}finally{C?E.c.publishSnapshotClicked({expires:L.expires,shareResource:(0,l.hD)(this.state.panelRef)}):E.c.publishSnapshotLocalClicked({expires:L.expires,shareResource:(0,l.hD)(this.state.panelRef)})}},this.onSnapshotDelete=async C=>{const S=await(0,s.AI)().get(C);return(0,u.JD)((0,p.dx)((0,m.tZ)((0,v.t)("snapshot.share.success-delete","Your snapshot has been deleted")))),S},this.addActivationHandler(()=>{this._onActivate()})}static{this.Component=O}_onActivate(){(0,y.s)().getSharingOptions().then(T=>{this.isActive&&this.setState({snapshotSharingOptions:T})})}getTabLabel(){return(0,v.t)("share-modal.tab-title.snapshot","Snapshot")}prepareSnapshot(){const T=r.jh.getTimeRange(this),{dashboardRef:C,panelRef:S}=this.state,A=(0,D.Uy)(C.resolve(),!0);return(0,D.c)(this.state.snapshotName||"",T.state.value,A,S?.resolve())}}function O({model:I}){const{snapshotName:T,selectedExpireOption:C,modalRef:S,snapshotSharingOptions:A}=I.useState(),[L,N]=(0,n.default)(async(B=!1)=>I.onSnapshotCreate(B)),[F,w]=(0,n.default)(async B=>await(0,s.AI)().get(B));return F.value?(0,t.jsx)(v.x6,{i18nKey:"share-modal.snapshot.deleted-message",children:"The snapshot has been deleted. If you have already accessed it once, then it might take up to an hour before before it is removed from browser caches or CDN caches."}):(0,t.jsxs)(t.Fragment,{children:[!L.value&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"share-modal-info-text",children:(0,t.jsx)(v.x6,{i18nKey:"share-modal.snapshot.info-text-1",children:"A snapshot is an instant way to share an interactive dashboard publicly. When created, we strip sensitive data like queries (metric, template, and annotation) and panel links, leaving only the visible metric data and series names embedded in your dashboard."})}),(0,t.jsx)("p",{className:"share-modal-info-text",children:(0,t.jsxs)(v.x6,{i18nKey:"share-modal.snapshot.info-text-2",children:["Keep in mind, your snapshot ",(0,t.jsx)("em",{children:"can be viewed by anyone"})," that has the link and can access the URL. Share wisely."]})})]}),(0,t.jsx)(g.D,{label:(0,v.t)("share-modal.snapshot.name","Snapshot name"),children:(0,t.jsx)(a.p,{id:"snapshot-name-input",width:30,defaultValue:T,onBlur:B=>I.onSnasphotNameChange(B.target.value)})}),(0,t.jsx)(g.D,{label:(0,v.t)("share-modal.snapshot.expire","Expire"),children:(0,t.jsx)(c.z,{id:"expire-select-input",options:P(),value:C?.value,onChange:I.onExpireChange})}),(0,t.jsxs)(o.a.ButtonRow,{children:[(0,t.jsx)(h.$n,{variant:"secondary",onClick:()=>{S?.resolve().onDismiss()},fill:"outline",children:(0,t.jsx)(v.x6,{i18nKey:"share-modal.snapshot.cancel-button",children:"Cancel"})}),A?.externalEnabled&&(0,t.jsx)(h.$n,{variant:"secondary",disabled:L.loading,onClick:()=>N(!0),children:A?.externalSnapshotName}),(0,t.jsx)(h.$n,{variant:"primary",disabled:L.loading,onClick:()=>N(),"data-testid":x.PublishSnapshot,children:(0,t.jsx)(v.x6,{i18nKey:"share-modal.snapshot.local-button",children:"Publish Snapshot"})})]})]}),L.value&&(0,t.jsxs)(f.B,{direction:"column",gap:0,children:[(0,t.jsx)(g.D,{label:(0,v.t)("share-modal.snapshot.url-label","Snapshot URL"),children:(0,t.jsx)(a.p,{"data-testid":x.CopyUrlInput,id:"snapshot-url-input",value:L.value.url,readOnly:!0,addonAfter:(0,t.jsx)(d.b,{"data-testid":x.CopyUrlButton,icon:"copy",variant:"primary",getText:()=>L.value.url,children:(0,t.jsx)(v.x6,{i18nKey:"share-modal.snapshot.copy-link-button",children:"Copy"})})})}),(0,t.jsxs)("div",{style:{alignSelf:"flex-end",padding:"5px"},children:[(0,t.jsx)(v.x6,{i18nKey:"share-modal.snapshot.mistake-message",children:"Did you make a mistake? "}),"\xA0",(0,t.jsx)(h.$n,{fill:"outline",size:"md",variant:"destructive",onClick:()=>{w(L.value.deleteUrl)},children:(0,t.jsx)(v.x6,{i18nKey:"share-modal.snapshot.delete-button",children:"Delete snapshot."})})]})]})]})}},30160:(k,R,e)=>{"use strict";e.d(R,{S:()=>v});var t=e(74848),n=e(32196),i=e(32264),s=e(40845),r=e(94753),g=e(25994),a=e(67061),c=e(10534),o=e(55852),h=e(42418),f=e(8484),d=e(74730),p=e(95007),m=e(58398);class v extends m.R{static{this.Component=l}constructor({panelRef:D}){super({panelRef:D})}}function l({model:u}){const D=(0,s.of)(y),{useLockedTime:E,useShortUrl:x,selectedTheme:P,isBuildUrlLoading:b,imageUrl:M}=u.useState(),I=!!(0,d.YQ)(u).state.uid;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:D.configDescription,children:(0,t.jsx)(r.E,{variant:"body",children:(0,t.jsx)(f.x6,{i18nKey:"link.share-panel.config-description",children:"Create a personalized, direct link to share your panel within your organization, with the following customization settings:"})})}),(0,t.jsx)(p.A,{useLockedTime:E,onToggleLockedTime:()=>u.onToggleLockedTime(),useShortUrl:x,onUrlShorten:()=>u.onUrlShorten(),selectedTheme:P,onChangeTheme:T=>u.onThemeChange(T),isLoading:b}),(0,t.jsx)(g.c,{spacing:1}),(0,t.jsxs)(a.B,{gap:2,direction:"column",children:[(0,t.jsx)("div",{className:D.buttonsContainer,children:(0,t.jsxs)(a.B,{gap:1,flex:1,direction:{xs:"column",sm:"row"},children:[(0,t.jsx)(c.b,{icon:"link",variant:"primary",fill:"outline",disabled:b,getText:u.getShareUrl,onClipboardCopy:u.onCopy,children:(0,t.jsx)(f.x6,{i18nKey:"link.share.copy-link-button",children:"Copy link"})}),(0,t.jsx)(o.z9,{href:M,icon:"external-link-alt",target:"_blank",variant:"secondary",fill:"solid",disabled:!i.$.rendererAvailable||!I,children:(0,t.jsx)(f.x6,{i18nKey:"link.share-panel.render-image",children:"Render image"})})]})}),!I&&(0,t.jsx)(h.F,{severity:"info",title:(0,f.t)("share-modal.link.save-alert","Dashboard is not saved"),bottomSpacing:0,children:(0,t.jsx)(f.x6,{i18nKey:"share-modal.link.save-dashboard",children:"To render a panel image, you must save the dashboard first."})}),!i.$.rendererAvailable&&(0,t.jsx)(h.F,{severity:"info",title:(0,f.t)("share-modal.link.render-alert","Image renderer plugin not installed"),bottomSpacing:0,children:(0,t.jsxs)(f.x6,{i18nKey:"share-modal.link.render-instructions",children:["To render a panel image, you must install the"," ",(0,t.jsx)("a",{href:"https://grafana.com/grafana/plugins/grafana-image-renderer",target:"_blank",rel:"noopener noreferrer",className:"external-link",children:"Grafana image renderer plugin"}),". Please contact your Grafana administrator to install the plugin."]})})]})]})}const y=u=>({configDescription:(0,n.css)({marginBottom:u.spacing(2)}),buttonsContainer:(0,n.css)({marginTop:u.spacing(2)})})},59995:(k,R,e)=>{"use strict";e.d(R,{b:()=>d});var t=e(16817),n=e(26657),i=e(80943),s=e(31204),r=e(31193),g=e(41507),a=e(60656);const c=async p=>{let m=new Set;for(const v of p)s.z.has(v)&&await(0,r.tR)().get(v)instanceof n.iy||m.add(v);return Array.from(m)};function o(p){const m=new Set,v=p.state.body;if(!(v instanceof i.hy))return[];for(const l of v.state.children){if(l instanceof g.U){const y=f(l);for(const u of y)m.add(u)}if(l instanceof i.tI){const y=h(l);for(const u of y)m.add(u)}}return Array.from(m).sort()}function h(p){return new Set(p.state.children.map(v=>f(v)).flat())}function f(p){let m;if(p instanceof g.U)if(p.state.body instanceof a.F)m=p.state.body.state.panel;else if(p.state.body instanceof i.Eb)m=p.state.body;else throw new Error("DashboardGridItem body expected to be VizPanel");if(!m)throw new Error("Unsupported grid item type");const v=m.state.$data,l=new Set;if(v instanceof i.dt)for(const y of v.state.queries)l.add(y.datasource?.type??"");if(v instanceof i.Es){const y=v.state.$data;if(y instanceof i.dt)for(const u of y.state.queries)l.add(u.datasource?.type??"")}return Array.from(l)}function d(p){const{value:m}=(0,t.A)(async()=>{const v=o(p);return c(v)},[]);return m}},53543:(k,R,e)=>{"use strict";e.d(R,{R:()=>i});var t=e(80943),n=e(74730);class i{constructor(r){this._vizPanel=r}get id(){const r=(0,n.Cs)(this._vizPanel);return isNaN(r)?(console.error("VizPanel key could not be translated to a legacy numeric panel id",this._vizPanel),0):r}get description(){return this._vizPanel.state.description}get type(){return this._vizPanel.state.pluginId}get title(){return this._vizPanel.state.title}get transformations(){return this._vizPanel.state.$data instanceof t.Es?this._vizPanel.state.$data.state.transformations:[]}get targets(){const r=(0,n.un)(this._vizPanel);return r?r.state.queries:[]}get datasource(){return(0,n.un)(this._vizPanel)?.state.datasource}get options(){return this._vizPanel.state.options}get fieldConfig(){return this._vizPanel.state.fieldConfig}get pluginVersion(){return this._vizPanel.state.pluginVersion}}},96556:(k,R,e)=>{"use strict";e.d(R,{w:()=>s});var t=e(32264),n=e(80943),i=e(39820);function s(r){if(!r.targets?.length||t.$.panels[r.type]?.skipDataQuery)return;let g;return g=new n.dt({datasource:r.datasource??void 0,queries:r.targets,maxDataPoints:r.maxDataPoints??void 0,maxDataPointsFromWidth:!0,cacheTimeout:r.cacheTimeout,queryCachingTTL:r.queryCachingTTL,minInterval:r.interval??void 0,dataLayerFilter:{panelId:r.id},$behaviors:[new i.L({})]}),new n.Es({$data:g,transformations:r.transformations||[]})}},32023:(k,R,e)=>{"use strict";e.d(R,{WZ:()=>m,b4:()=>v});var t=e(80943),n=e(16279),i=e(41507),s=e(60656),r=e(42397),g=e(74730);function a(l){return l.state.controls?.state.timePicker}function c(l){return l.state.controls?.state.refreshPicker}function o(l){return l.state.titleItems&&Array.isArray(l.state.titleItems)&&l.state.titleItems[0]instanceof r.$?l.state.titleItems[0]:null}function h(l){const y=[];return l.state.body.forEachChild(u=>{if(!(u instanceof i.U)&&!(u instanceof t.tI))throw new Error("Child is not a DashboardGridItem or SceneGridRow, invalid scene");u instanceof i.U?u.state.body instanceof t.Eb&&y.push(u.state.body):u instanceof t.tI&&u.forEachChild(D=>{D instanceof i.U&&D.state.body instanceof t.Eb&&y.push(D.state.body)})}),y}function f(l){const y=t.jh.getData(l);if(!(y instanceof n.s))throw new Error("DashboardDataLayerSet not found");return y}function d(l){const y=l.state.$behaviors?.find(u=>u instanceof t.Gg.K2);if(y instanceof t.Gg.K2)return y}function p(l){let y=0;const u=l.state.body;if(!(u instanceof t.hy))throw new Error("Dashboard body is not a SceneGridLayout");for(const D of u.state.children){if(D instanceof i.U){const E=D.state.body;if(E){const x=E instanceof s.F?(0,g.RQ)(E):(0,g.Cs)(E);x>y&&(y=x)}}if(D instanceof t.tI){const E=(0,g.Cs)(D);E>y&&(y=E);for(const x of D.state.children)if(x instanceof i.U){const P=x.state.body;if(P){const b=P instanceof s.F?(0,g.RQ)(P):(0,g.Cs)(P);b>y&&(y=b)}}}}return y+1}const m=l=>l.parent instanceof s.F?l.parent:l.parent instanceof i.U&&l.parent.state.body instanceof s.F?l.parent.state.body:null,v={getTimePicker:a,getRefreshPicker:c,getPanelLinks:o,getVizPanels:h,getDataLayers:f,getNextPanelId:p,getCursorSync:d}},27734:(k,R,e)=>{"use strict";e.d(R,{Gq:()=>g,zf:()=>a});var t=e(76885),n=e(39601),i=e(32264),s=e(80943);const r="grafana.dashboard.preservedUrlFiltersState";function g(c){const o=window.sessionStorage.getItem(r);if(o){const h=new URLSearchParams(o),f=n.Ny.getSearch();h.forEach((p,m)=>{f.has(m)||f.append(m,p)});for(const p of Array.from(f.keys()))p.startsWith("var-")&&(c.state.$variables?.getByName(p.replace("var-",""))||f.delete(p));const d=f.toString();d&&n.Ny.replace({search:d})}}function a(c){if(i.$.featureToggles.preserveDashboardStateWhenNavigating)return()=>{if(!c.state.uid)return;const o=Object.fromEntries(Object.entries(new s.g5().getUrlState(c)).filter(([f])=>f.startsWith("var-")||f==="from"||f==="to"||f==="timezone")),h=Object.fromEntries(Object.entries(o).filter(([f,d])=>!(Array.isArray(d)&&d.length===0)));Object.keys(h).length>0?window.sessionStorage.setItem(r,t.kM.renderUrl("",h)):window.sessionStorage.removeItem(r)}}},73788:(k,R,e)=>{"use strict";e.d(R,{E:()=>i});var t=e(80943),n=e(53287);function i(s){const r=t.jh.getVariables(s);return(0,n.C)(r)}},7758:(k,R,e)=>{"use strict";e.d(R,{c:()=>i});var t=e(14110);let n=!1;const i={dashboardInitialized:r=>{s("init_dashboard_completed",{...r})},panelLinkClicked:r=>{s("panelheader_datalink_clicked",r)},panelStatusMessageClicked:r=>{s("panelheader_statusmessage_clicked",r)},panelCancelQueryClicked:r=>{s("panelheader_cancelquery_clicked",r)},toolbarFavoritesClick:()=>{s("toolbar_actions_clicked",{item:"favorites"})},toolbarSettingsClick:()=>{s("toolbar_actions_clicked",{item:"settings"})},toolbarShareClick:()=>{s("toolbar_actions_clicked",{item:"share"})},toolbarAddClick:()=>{s("toolbar_actions_clicked",{item:"add"})},sharingCategoryClicked:r=>{s("sharing_category_clicked",r)},shareLinkCopied:r=>{s("sharing_link_copy_clicked",r)},embedSnippetCopy:r=>{s("sharing_embed_copy_clicked",r)},publishSnapshotClicked:r=>{s("sharing_snapshot_publish_clicked",r)},publishSnapshotLocalClicked:r=>{s("sharing_snapshot_local_clicked",r)},exportDownloadJsonClicked:r=>{s("sharing_export_download_json_clicked",r)},exportCopyJsonClicked:r=>{s("sharing_export_copy_json_clicked",r)},exportSaveJsonClicked:r=>{s("sharing_export_save_json_clicked",r)},exportViewJsonClicked:r=>{s("sharing_export_view_json_clicked",r)},generatePublicDashboardUrlClicked:r=>{s("sharing_public_generate_url_clicked",r)},revokePublicDashboardEmailClicked:r=>{s("sharing_public_email_revoke_clicked",r)},resendPublicDashboardEmailClicked:r=>{s("sharing_public_email_resend_clicked",r)},publicDashboardEmailInviteClicked:r=>{s("sharing_public_email_invite_clicked",r)},publicDashboardShareTypeChange:r=>{s("sharing_public_can_view_clicked",r)},publicDashboardTimeSelectionChanged:r=>{s("sharing_public_time_picker_clicked",r)},publicDashboardAnnotationsSelectionChanged:r=>{s("sharing_public_annotations_clicked",r)},publicDashboardUrlCopied:r=>{s("sharing_public_copy_url_clicked",r)},publicDashboardPauseSharingClicked:r=>{s("sharing_public_pause_clicked",r)},revokePublicDashboardClicked:r=>{s("sharing_public_revoke_clicked",r)},emptyDashboardButtonClicked:r=>{s("emptydashboard_clicked",r)},toolbarAddButtonClicked:r=>{s("toolbar_add_clicked",r)},setScenesContext:()=>(n=!0,()=>{n=!1})},s=(r,g)=>{const a=n?{scenesView:!0}:{};g?(0,t.rR)(`dashboards_${r}`,{...g,...a}):(0,t.rR)(`dashboards_${r}`)}},99246:(k,R,e)=>{"use strict";e.d(R,{C:()=>t,Y:()=>n});const t={left:[],right:[]};function n(i,s){t[i].push(s)}},11982:(k,R,e)=>{"use strict";e.d(R,{Lp:()=>p,Uu:()=>d,e0:()=>f,r7:()=>h,uZ:()=>o});var t=e(76885),n=e(71733),i=e(39601),s=e(32264),r=e(80943),g=e(10096),a=e(87490),c=e(74730);function o(m){let v=`/d/${m.uid}`;m.uid||(v="/dashboard/new"),m.soloRoute&&(v=`/d-solo/${m.uid}`),m.slug&&(v+=`/${m.slug}`),m.subPath&&(v+=m.subPath),m.render&&(v="/render"+v,m.updateQuery={...m.updateQuery,width:1e3,height:500,tz:m.timeZone}),m.isHomeDashboard&&(v="/");const l=m.currentQueryParams?(0,i.SE)(m.currentQueryParams):{};if(m.updateQuery)for(const u in m.updateQuery)m.updateQuery[u]===null||m.updateQuery[u]===void 0?delete l[u]:l[u]=m.updateQuery[u];const y=t.kM.renderUrl(v,l);return m.absolute?s.$.appUrl+y.slice(1):y}function h(m){return n.I.getUrlForPartial(i.Ny.getLocation(),{viewPanel:m.state.key,editPanel:void 0})}function f(m){return n.I.getUrlForPartial(i.Ny.getLocation(),{editPanel:m,viewPanel:void 0})}function d(m,v){const l=m.state.key?.replace("-view","");return n.I.getUrlForPartial(i.Ny.getLocation(),{inspect:l,inspectTab:v})}function p(m){const v=m.getPlugin(),l=(0,c.un)(m);if(!g.TP.hasAccessToExplore()||v?.meta.skipDataQuery||!l)return Promise.resolve(void 0);const y=r.jh.getTimeRange(m);return(0,a.Xe)({queries:l.state.queries,dsRef:l.state.datasource,timeRange:y.state.value,scopedVars:{__sceneObject:{value:m}},adhocFilters:l.state.data?.request?.filters})}},74730:(k,R,e)=>{"use strict";e.d(R,{Cs:()=>v,O8:()=>C,RQ:()=>l,SN:()=>T,Sm:()=>x,Ws:()=>S,X0:()=>D,XA:()=>m,YQ:()=>O,Yr:()=>A,a7:()=>E,bx:()=>P,pk:()=>b,sw:()=>d,un:()=>M,vL:()=>y,vm:()=>p,xz:()=>I});var t=e(22391),n=e(19347),i=e(80943),s=e(81515),r=e(39820),g=e(34842),a=e(60656),c=e(42397),o=e(7196),h=e(58029),f=e(32023);const d=8,p=12;function m(L){return`panel-${L}`}function v(L){return parseInt(L.state.key.replace("panel-",""),10)}function l(L){return parseInt(L.state.panelKey.replace("panel-",""),10)}function y(L,N){if(!N)return null;const F=u(L,N);if(F)return F;const w=parseInt(N,10);return isNaN(w)?null:u(L,m(w))}function u(L,N){if(!N)return null;const F=i.jh.findObject(L,w=>w.state.key===N?!0:(w instanceof i.Eb,!1));if(F){if(F instanceof i.Eb)return F;throw new Error(`Found panel with key ${N} but it was not a VizPanel`)}return null}function D(L,N){L.forEachChild(F=>{F.isActive&&(F.forceRender(),D(F,N))})}function E(L){const{value:N,text:F,options:w}=L.state;return L.hasAllValue()?{values:w.map(B=>B.value),texts:w.map(B=>B.label)}:{values:Array.isArray(N)?N:[N],texts:Array.isArray(F)?F:[F]}}function x(L){const N=L.match(/(["'])(.*?)\1|\w+/g);if(!N)return s.Ez.query?.split(",")??[];const F=new Set,w=N.reduce((B,U)=>{const K=U.replace(/["']+/g,"");return K.startsWith("$__auto_interval_")||B.add(K),B},F);return Array.from(w)}function P(L){return Array.isArray(L)?L.join(","):""}function b(L,N){const F=Array.isArray(L.current.value)?L.current.value[0]:L.current.value;return F.startsWith("$__auto_interval_")?"$__auto":N.includes(F)?F:N[0]}function M(L){if(!L)return;const N=L.state.$data??L.parent?.state.$data;if(N instanceof i.dt)return N;if(N instanceof i.Es)return M(N)}function O(L){const N=L.getRoot();if(N instanceof g.H$)return N;throw new Error("SceneObject root is not a DashboardScene")}function I(L){return L instanceof i.Eb?L:L.parent?I(L.parent):null}function T(L){return L.includes("clone")}function C(L){const N=f.b4.getNextPanelId(L);return new i.Eb({title:"Panel Title",key:m(N),pluginId:"timeseries",titleItems:[new c.$({menu:new c.m({})})],hoverHeaderOffset:0,menu:new i.Lw({$behaviors:[o._i]}),$data:new i.Es({$data:new i.dt({queries:[{refId:"A"}],datasource:(0,t.p$)((0,n.l)().getInstanceSettings(null)),$behaviors:[new r.L({})]}),transformations:[]})})}function S(L){const N=f.b4.getNextPanelId(L);return new i.tI({key:m(N),title:"Row title",actions:new h.u({}),y:0})}function A(L){if(L.parent instanceof a.F)return L.parent}},28676:(k,R,e)=>{"use strict";e.d(R,{n:()=>h});var t=e(17172),n=e(32264),i=e(2468),s=e(48814),r=e(6473),g=e(61642);class a{constructor(){}saveDashboard(p){return r.t.ignoreNextSave(),(0,t.AI)().post("/api/dashboards/db/",{dashboard:p.dashboard,message:p.message??"",overwrite:p.overwrite??!1,folderUid:p.folderUid})}deleteDashboard(p,m){return(0,t.AI)().delete(`/api/dashboards/uid/${p}`,{showSuccessAlert:m})}getDashboardDTO(p){const v=(0,g.X)()?.getAll("scopes")??[],l=v.length>0?{scopes:v}:void 0;return(0,t.AI)().get(`/api/dashboards/uid/${p}`,l)}}class c{constructor(){this.client=new i.w({group:"dashboard.grafana.app",version:"v0alpha1",resource:"dashboards"})}saveDashboard(p){const m=p.dashboard,v={metadata:{...p?.k8s},spec:{...m}};return p.message?v.metadata.annotations={...v.metadata.annotations,[s.fY]:p.message}:v.metadata.annotations&&delete v.metadata.annotations[s.fY],p.folderUid&&(v.metadata.annotations={...v.metadata.annotations,[s.ew]:p.folderUid}),m.uid?(v.metadata.name=m.uid,this.client.update(v).then(l=>this.asSaveDashboardResponseDTO(l))):this.client.create(v).then(l=>this.asSaveDashboardResponseDTO(l))}asSaveDashboardResponseDTO(p){return{uid:p.metadata.name,version:p.spec.version??0,id:p.spec.id??0,status:"success",slug:"",url:""}}deleteDashboard(p,m){return this.client.delete(p).then(v=>({id:0,message:v.message,title:"deleted"}))}async getDashboardDTO(p){const m=await this.client.subresource(p,"dto");return{meta:{...m.access,isNew:!1,isFolder:!1,uid:m.metadata.name,k8s:m.metadata},dashboard:m.spec}}}let o;function h(){return o||(o=n.$.featureToggles.kubernetesDashboards?new c:new a),o}function f(d){throw new Error("dashboardAPI can be only overridden in test environment")}},72686:(k,R,e)=>{"use strict";e.d(R,{$L:()=>E,AK:()=>P,Bs:()=>m,NA:()=>x,NY:()=>D,Sm:()=>p,T2:()=>l,U9:()=>v,_e:()=>u,bN:()=>y,eq:()=>O,ft:()=>I,g9:()=>M,kd:()=>b});var t=e(75816),n=e(75505),i=e(17172),s=e(32264),r=e(82467),g=e(3169),a=e(8484),c=e(72254),o=e(34842);function h(T){return typeof T=="object"&&T!=null&&"error"in T}const f=({baseUrl:T})=>async C=>{try{const{data:S,...A}=await(0,n.s)((0,i.AI)().fetch({...C,url:T+C.url,showErrorAlert:C.showErrorAlert}));return{data:S,meta:A}}catch(S){return C.manageError?C.manageError(S):{error:S}}},d=T=>({error:(0,i.NF)(T)&&T.data.messageId!=="publicdashboards.notFound"?T:null}),p=(0,t.xP)({reducerPath:"publicDashboardApi",baseQuery:f({baseUrl:"/api"}),tagTypes:["PublicDashboard","AuditTablePublicDashboard","UsersWithActiveSessions","ActiveUserDashboards"],refetchOnMountOrArgChange:!0,endpoints:T=>({getPublicDashboard:T.query({query:C=>({url:`/dashboards/uid/${C}/public-dashboards`,manageError:d,showErrorAlert:!1}),async onQueryStarted(C,{dispatch:S,queryFulfilled:A}){try{await A}catch(L){h(L)&&(0,i.NF)(L.error)&&S((0,r.dx)((0,g.gi)(L.error.data.message)))}},providesTags:(C,S,A)=>[{type:"PublicDashboard",id:A}]}),createPublicDashboard:T.mutation({query:C=>({url:`/dashboards/uid/${C.dashboard instanceof o.H$?C.dashboard.state.uid:C.dashboard.uid}/public-dashboards`,method:"POST",data:C.payload}),async onQueryStarted({dashboard:C,payload:{share:S}},{dispatch:A,queryFulfilled:L}){const{data:N}=await L;let F=(0,a.t)("public-dashboard.sharing.success-creation","Dashboard is public!");s.$.featureToggles.newDashboardSharingComponent&&(F=S===c.Xo.PUBLIC?(0,a.t)("public-dashboard.public-sharing.success-creation","Your dashboard is now publicly accessible"):(0,a.t)("public-dashboard.email-sharing.success-creation","Your dashboard is ready for external sharing")),A((0,r.dx)((0,g.tZ)(F))),C instanceof o.H$?C.setState({meta:{...C.state.meta,publicDashboardEnabled:N.isEnabled}}):C.updateMeta({publicDashboardEnabled:N.isEnabled})},invalidatesTags:(C,S,{dashboard:A})=>[{type:"PublicDashboard",id:A instanceof o.H$?A.state.uid:A.uid}]}),updatePublicDashboard:T.mutation({query:({payload:C,dashboard:S})=>({url:`/dashboards/uid/${S instanceof o.H$?S.state.uid:S.uid}/public-dashboards/${C.uid}`,method:"PATCH",data:C}),async onQueryStarted({dashboard:C},{dispatch:S,queryFulfilled:A}){await A,S((0,r.dx)((0,g.tZ)(s.$.featureToggles.newDashboardSharingComponent?(0,a.t)("public-dashboard.configuration.success-update","Settings have been successfully updated"):(0,a.t)("public-dashboard.configuration.success-update-old","Public dashboard updated!"))))},invalidatesTags:(C,S,{payload:A})=>[{type:"PublicDashboard",id:A.dashboardUid},"AuditTablePublicDashboard"]}),pauseOrResumePublicDashboard:T.mutation({query:({payload:C,dashboard:S})=>({url:`/dashboards/uid/${S instanceof o.H$?S.state.uid:S.uid}/public-dashboards/${C.uid}`,method:"PATCH",data:C}),async onQueryStarted({dashboard:C,payload:{isEnabled:S}},{dispatch:A,queryFulfilled:L}){const{data:N}=await L;let F=(0,a.t)("public-dashboard.configuration.success-update-old","Public dashboard updated!");s.$.featureToggles.newDashboardSharingComponent&&(F=S?(0,a.t)("public-dashboard.configuration.success-resume","Your dashboard access has been resumed"):(0,a.t)("public-dashboard.configuration.success-pause","Your dashboard access has been paused")),A((0,r.dx)((0,g.tZ)(F))),C instanceof o.H$?C.setState({meta:{...C.state.meta,publicDashboardEnabled:N.isEnabled}}):C.updateMeta?.({publicDashboardEnabled:N.isEnabled})},invalidatesTags:(C,S,{payload:A})=>[{type:"PublicDashboard",id:A.dashboardUid},"AuditTablePublicDashboard"]}),updatePublicDashboardAccess:T.mutation({query:({payload:C,dashboard:S})=>({url:`/dashboards/uid/${S instanceof o.H$?S.state.uid:S.uid}/public-dashboards/${C.uid}`,method:"PATCH",data:C}),async onQueryStarted({dashboard:C,payload:{share:S}},{dispatch:A,queryFulfilled:L}){await L;let N=(0,a.t)("public-dashboard.configuration.success-update-old","Public dashboard updated!");s.$.featureToggles.newDashboardSharingComponent&&(N=S===c.Xo.PUBLIC?(0,a.t)("public-dashboard.public-sharing.success-share-type-change","Dashboard access updated: Anyone with the link can now access"):(0,a.t)("public-dashboard.email-sharing.success-share-type-change","Dashboard access restricted: Only specific people can now access with the link")),A((0,r.dx)((0,g.tZ)(N)))},invalidatesTags:(C,S,{payload:A})=>[{type:"PublicDashboard",id:A.dashboardUid},"AuditTablePublicDashboard"]}),addRecipient:T.mutation({query:()=>({url:""})}),deleteRecipient:T.mutation({query:()=>({url:""})}),reshareAccessToRecipient:T.mutation({query:()=>({url:""})}),getActiveUsers:T.query({query:()=>({url:"/"}),providesTags:["UsersWithActiveSessions"]}),getActiveUserDashboards:T.query({query:()=>({url:""}),providesTags:(C,S,A)=>[{type:"ActiveUserDashboards",id:A}]}),listPublicDashboards:T.query({query:(C=1)=>({url:`/dashboards/public-dashboards?page=${C}&perpage=8`}),transformResponse:C=>({...C,totalPages:Math.ceil(C.totalCount/C.perPage)}),providesTags:["AuditTablePublicDashboard"]}),deletePublicDashboard:T.mutation({query:C=>({url:`/dashboards/uid/${C.dashboardUid}/public-dashboards/${C.uid}`,method:"DELETE"}),async onQueryStarted({dashboard:C},{dispatch:S,queryFulfilled:A}){await A,S((0,r.dx)((0,g.tZ)(s.$.featureToggles.newDashboardSharingComponent?(0,a.t)("public-dashboard.share.success-delete","Your dashboard is no longer shareable"):(0,a.t)("public-dashboard.share.success-delete-old","Public dashboard deleted!")))),S(p.util?.resetApiState()),C instanceof o.H$?C.setState({meta:{...C.state.meta,publicDashboardEnabled:!1}}):C?.updateMeta({publicDashboardEnabled:!1})},invalidatesTags:(C,S,{dashboardUid:A})=>[{type:"PublicDashboard",id:A},"AuditTablePublicDashboard","UsersWithActiveSessions","ActiveUserDashboards"]}),revokeAllAccess:T.mutation({query:()=>({url:""})})})}),{useGetPublicDashboardQuery:m,useCreatePublicDashboardMutation:v,useUpdatePublicDashboardMutation:l,useDeletePublicDashboardMutation:y,useListPublicDashboardsQuery:u,useAddRecipientMutation:D,useDeleteRecipientMutation:E,useReshareAccessToRecipientMutation:x,useGetActiveUsersQuery:P,useGetActiveUserDashboardsQuery:b,useRevokeAllAccessMutation:M,usePauseOrResumePublicDashboardMutation:O,useUpdatePublicDashboardAccessMutation:I}=p},15858:(k,R,e)=>{"use strict";e.d(R,{M:()=>f});var t=e(2543),n=e(12470),i=e(19347),s=e(2913),r=e(57767),g=e(75096),a=e(82792),c=e(98796),o=e(24240);function h(d){return!!(d.libraryPanel?.name&&d.libraryPanel?.uid)}class f{async makeExportable(p){p.cleanUpRepeats();const m=p.getSaveModelCloneOld();m.id=null,p.processRepeats();const v=[],l={},y={},u={},D=new Map;for(const b of m.getVariables())u[b.name]=b;const E=(b,M)=>{if(b.datasource===void 0){b.datasource=M;return}let O=b.datasource,I=null;const T=O?.uid,C=T&&g.SY.exec(T);if(C){const S=C[1]||C[2]||C[4];I=u[S],I&&I.current&&(O=I.current.value)}return(0,i.l)().get(O).then(S=>{if(S.meta?.builtIn||(l["datasource"+S.meta?.id]={type:"datasource",id:S.meta.id,name:S.meta.name,version:S.meta.info.version||"1.0.0"},I))return;const A=b.libraryPanel,L=A?"-for-library-panel":"";let N="DS_"+S.name.replace(" ","_").toUpperCase()+L.toUpperCase();if(y[N]={name:N,label:S.name,description:"",type:"datasource",pluginId:S.meta?.id,pluginName:S.meta?.name,usage:y[N]?.usage},A){const F=y[N]?.usage?.libraryPanels||[];F.push({name:A.name,uid:A.uid}),y[N].usage={libraryPanels:F}}b.datasource={type:S.meta.id,uid:"${"+N+"}"}})},x=async b=>{if(b.type!=="row"){if(await E(b),b.targets)for(const O of b.targets)await E(O,b.datasource);const M=s.Ay.panels[b.type];M&&(l["panel"+M.id]={type:"panel",id:M.id,name:M.name,version:M.info.version})}},P=async b=>{if((0,a.X)(b)){const{name:M,uid:O}=b.libraryPanel;let I=b.libraryPanel.model;I||(I=(await(0,r.Yr)(O,!0)).model),await E(I);const{gridPos:T,id:C,...S}=I;D.has(O)||D.set(O,{name:M,uid:O,kind:c.i.Panel,model:S})}};try{for(const O of m.panels)if(await x(O),O.collapsed!==void 0&&O.collapsed===!0&&O.panels)for(const I of O.panels)await x(I);for(const O of m.getVariables())O.type==="query"?(await E(O),O.options=[],O.current={},O.refresh=O.refresh!==n.CO.never?O.refresh:n.CO.onDashboardLoad):O.type==="datasource"&&(O.current={});for(const O of m.annotations.list)await E(O);l.grafana={type:"grafana",id:"grafana",name:"Grafana",version:s.Ay.buildInfo.version};for(const O of m.panels)if(await P(O),O.collapsed!==void 0&&O.collapsed===!0&&O.panels)for(const I of O.panels)await P(I);(0,t.each)(y,O=>{v.push(O)});for(const O of m.getVariables())if((0,o.VO)(O)){const I="VAR_"+O.name.replace(" ","_").toUpperCase();v.push({name:I,type:"constant",label:O.label||O.name,value:O.query,description:""}),O.query="${"+I+"}",O.current={value:O.query,text:O.query,selected:!1},O.options=[O.current]}const b=[...D.entries()].reduce((O,[I,T])=>(O[I]=T,O),{}),M=(0,t.defaults)({__inputs:v,__elements:b,__requires:(0,t.sortBy)(l,["id"])},m);for(let O=0;O<M.panels.length;O++){const I=M.panels[O];h(I)&&(M.panels[O]={gridPos:I.gridPos,id:I.id,libraryPanel:{uid:I.libraryPanel.uid,name:I.libraryPanel.name}})}return M}catch(b){return console.error("Export failed:",b),{error:b}}}}},20120:(k,R,e)=>{"use strict";e.d(R,{fP:()=>Z,Ay:()=>ce});var t=e(74848),n=e(96540),i=e(32196),s=e(71468),r=e(24180),g=e(80997),a=e(13544),c=e(39601),o=e(69731),h=e(96374),f=e(39938),d=e(19727),p=e(27746),m=e(71678),v=e(15068),l=e(82467),y=e(75269),u=e(10804),D=e(2913),E=e(3169),x=e(10096),P=e(16021),b=e(8484),M=e(91219),O=e(28215),I=e(83122),T=e(55852),C=e(14578),S=e(32264),A=e(38138),L=e(36974),N=e(7758),F=e(31678),w=e(28601);const U=({dashboard:ue})=>{const De=(0,n.useMemo)(()=>(0,L._u)(),[]),ge=(0,F.useDispatch)(),Te=(0,F.useSelector)(Le=>Le.dashboard.initialDatasource);return(0,t.jsxs)(A.W,{children:[(0,t.jsx)(A.W.Item,{testId:a.Tp.pages.AddDashboard.itemButton("Add new visualization menu item"),label:(0,b.t)("dashboard.add-menu.visualization","Visualization"),onClick:()=>{const Le=(0,L.OK)(ue,Te);N.c.toolbarAddButtonClicked({item:"add_visualization"}),c.Ny.partial({editPanel:Le}),ge((0,w.Ub)(void 0))}},"add-visualisation"),S.$.featureToggles.vizAndWidgetSplit&&(0,t.jsx)(A.W.Item,{testId:a.Tp.pages.AddDashboard.itemButton("Add new widget menu item"),label:(0,b.t)("dashboard.add-menu.widget","Widget"),onClick:()=>{N.c.toolbarAddButtonClicked({item:"add_widget"}),c.Ny.partial({addWidget:!0})}},"add-widget"),(0,t.jsx)(A.W.Item,{testId:a.Tp.pages.AddDashboard.itemButton("Add new row menu item"),label:(0,b.t)("dashboard.add-menu.row","Row"),onClick:()=>{N.c.toolbarAddButtonClicked({item:"add_row"}),(0,L.SD)(ue)}},"add-row"),(0,t.jsx)(A.W.Item,{testId:a.Tp.pages.AddDashboard.itemButton("Add new panel from panel library menu item"),label:(0,b.t)("dashboard.add-menu.import","Import from library"),onClick:()=>{N.c.toolbarAddButtonClicked({item:"import_from_library"}),(0,L.s3)(ue)}},"add-panel-lib"),(0,t.jsx)(A.W.Item,{testId:a.Tp.pages.AddDashboard.itemButton("Add new panel from clipboard menu item"),label:(0,b.t)("dashboard.add-menu.paste-panel","Paste panel"),onClick:()=>{N.c.toolbarAddButtonClicked({item:"paste_panel"}),(0,L.no)(ue,De)},disabled:!De},"add-panel-clipboard")]})},V=({dashboard:ue,onToolbarAddMenuOpen:De})=>{const[ge,Te]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{ge&&De&&De()},[ge,De]),(0,t.jsx)(I.m,{overlay:()=>(0,t.jsx)(U,{dashboard:ue}),placement:"bottom",offset:[0,6],onVisibleChange:Te,children:(0,t.jsxs)(T.$n,{variant:"secondary",size:"sm",fill:"outline","data-testid":a.Tp.components.PageToolbar.itemButton("Add button"),children:[(0,t.jsx)(b.x6,{i18nKey:"dashboard.toolbar.add",children:"Add"}),(0,t.jsx)(C.I,{name:ge?"angle-up":"angle-down",size:"lg"})]})})};var H=e(70497),Y=e(14792),X=e(2609),J=e(81862),q=e(28444),ae=e(99246),j=e(93030),te=e(62367);const ne=({dashboard:ue})=>(0,t.jsx)(T.$n,{"data-testid":a.Tp.pages.Dashboard.DashNav.shareButton,variant:"primary",size:"sm",onClick:()=>{N.c.toolbarShareClick(),c.Ny.partial({shareView:"link"})},children:(0,t.jsx)(b.x6,{i18nKey:"dashboard.toolbar.share-button",children:"Share"})}),le={removeNavIndex:O.Im,setStarred:M.ci,updateTimeZoneForSession:J.Cj,updateNavIndex:l.Vz},z=ue=>({navIndex:ue.navIndex}),ee=(0,s.connect)(z,le),se=a.Tp.pages.Dashboard.DashNav;function ie(ue){registerDynamicDashNavAction("left",ue)}function Z(ue){(0,ae.Y)("right",ue)}const oe=(0,n.memo)(ue=>{(0,r.zy)();const De=(0,o.C)();(0,P.u)(ue.dashboard.events,q.Cf);const ge=ue.dashboard.snapshot?.originalUrl??"",Te=()=>{window.location.href=g.sQ.sanitizeUrl(ue.dashboard.snapshot.originalUrl)},Le=(0,E._2)(),Ye=()=>{try{const st=new URL(g.sQ.sanitizeUrl(ge),D.Ay.appUrl),Ve=new URL(D.Ay.appUrl);st.host!==Ve.host?x.lE.publish(new q.S8({component:h.u,props:{title:"Proceed to external site?",modalClass:ye,body:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("p",{children:["This link connects to an external website at"," ",(0,t.jsx)("code",{children:ge})]}),(0,t.jsx)("p",{children:"Are you sure you'd like to proceed?"})]}),confirmVariant:"primary",confirmText:"Proceed",onConfirm:Te}})):Te()}catch(st){Le.error("Invalid URL",st instanceof Error?st.message:void 0)}},je=()=>{N.c.toolbarFavoritesClick();const st=(0,Y.UA)(),{dashboard:Ve,navIndex:pe,removeNavIndex:Ee,setStarred:me,updateNavIndex:ve}=ue;st.starDashboard(Ve.uid,!!Ve.meta.isStarred).then(Se=>{me({id:Ve.uid,title:Ve.title,url:Ve.meta.url??"",isStarred:Se});const Ie=pe.starred;if(Se)Ie.children?.push({id:M.L1+Ve.uid,text:Ve.title,url:Ve.meta.url??"",parentItem:Ie});else{Ee(M.L1+Ve.uid);const Oe=Ie.children?.findIndex(Re=>Re.id===M.L1+Ve.uid);Oe&&Ie.children?.splice(Oe,1)}ve(Ie),Ve.meta.isStarred=Se,De()})},Ze=()=>{N.c.toolbarSettingsClick(),c.Ny.partial({editview:"settings"})},Ne=()=>{X._o.prev()},Pe=()=>{X._o.next()},Ue=()=>{X._o.stop(),De()},$e=(st,Ve)=>{st.map((pe,Ee)=>{const me=pe.component,ve=(0,n.createElement)(me,{...ue,key:`button-custom-${Ee}`});typeof pe.index=="number"?Ve.splice(pe.index,0,ve):Ve.push(ve)})},ze=()=>X._o.state.isPlaying,qe=()=>{const st=D.Ay.buildInfo.env==="development",{dashboard:Ve,kioskMode:pe}=ue,{canStar:Ee,isStarred:me}=Ve.meta,ve=[];if(pe||ze())return[];if(Ee){let Se=me?(0,b.t)("dashboard.toolbar.unmark-favorite","Unmark as favorite"):(0,b.t)("dashboard.toolbar.mark-favorite","Mark as favorite");ve.push((0,t.jsx)(j._,{tooltip:Se,icon:me?"favorite":"star",iconType:me?"mono":"default",iconSize:"lg",onClick:je},"button-star"))}return Ve.meta.publicDashboardEnabled&&ve.push((0,t.jsx)(f.E,{color:"blue",text:"Public",className:re,"data-testid":se.publicDashboardTag},"public-dashboard-button-badge")),st&&D.Ay.featureToggles.dashboardScene&&ve.push((0,t.jsx)(j._,{tooltip:"View as Scene",icon:"apps",onClick:()=>{c.Ny.partial({scenes:!0})}},"button-scenes")),$e(ae.C.left,ve),ve},dt=()=>(0,t.jsxs)(d.e,{children:[(0,t.jsx)(p.I,{tooltip:(0,b.t)("dashboard.toolbar.playlist-previous","Go to previous dashboard"),icon:"backward",onClick:Ne,narrow:!0}),(0,t.jsx)(p.I,{onClick:Ue,children:(0,t.jsx)(b.x6,{i18nKey:"dashboard.toolbar.playlist-stop",children:"Stop playlist"})}),(0,t.jsx)(p.I,{tooltip:(0,b.t)("dashboard.toolbar.playlist-next","Go to next dashboard"),icon:"forward",onClick:Pe,narrow:!0})]},"playlist-buttons"),vt=()=>{const{dashboard:st,updateTimeZoneForSession:Ve,hideTimePicker:pe}=ue;return pe?null:(0,t.jsx)(te.$,{dashboard:st,onChangeTimeZone:Ve},"time-controls")},yt=()=>{const{dashboard:st,isFullscreen:Ve,kioskMode:pe,hideTimePicker:Ee}=ue,{canSave:me,canEdit:ve,showSettings:Se,canShare:Ie}=st.meta,{snapshot:Oe}=st,Re=Oe&&Oe.originalUrl,he=[];return ze()?[dt(),vt()]:pe===F.KioskMode.TV?[vt()]:(Re&&he.push((0,t.jsx)(p.I,{tooltip:(0,b.t)("dashboard.toolbar.open-original","Open original dashboard"),onClick:Ye,icon:"link"},"button-snapshot")),me&&!Ve&&he.push((0,t.jsx)(m.$s,{children:({showModal:Ce,hideModal:We})=>(0,t.jsx)(p.I,{tooltip:(0,b.t)("dashboard.toolbar.save","Save dashboard"),icon:"save",onClick:()=>{Ce(H.$,{dashboard:st,onDismiss:We})}})},"button-save")),$e(ae.C.right,he),Se&&he.push((0,t.jsx)(p.I,{tooltip:(0,b.t)("dashboard.toolbar.settings","Dashboard settings"),icon:"cog",onClick:Ze},"button-settings")),ve&&!Ve&&he.push((0,t.jsx)(V,{onToolbarAddMenuOpen:N.c.toolbarAddClick,dashboard:st},"panel-add-dropdown")),Ie&&he.push((0,t.jsx)(ne,{dashboard:st},"button-share")),Ee||he.push((0,t.jsx)(u.K,{},"toolbar-separator")),he.push(vt()),he)};return(0,t.jsx)(y.H,{actions:(0,t.jsxs)(t.Fragment,{children:[qe(),(0,t.jsx)(u.K,{leftActionsSeparator:!0}),(0,t.jsx)(v.U,{alignment:"right",children:yt()})]})})});oe.displayName="DashNav";const ce=ee(oe),ye=(0,i.css)({width:"max-content",maxWidth:"80vw"}),re=(0,i.css)({color:"grey",backgroundColor:"transparent",border:"1px solid"})},93030:(k,R,e)=>{"use strict";e.d(R,{_:()=>r});var t=e(74848),n=e(32196),i=e(40845),s=e(29158);const r=({icon:a,iconType:c,iconSize:o,tooltip:h,onClick:f,children:d})=>{const p=(0,i.of)(g);return(0,t.jsxs)("div",{className:p.noBorderContainer,children:[a&&(0,t.jsx)(s.K,{name:a,size:o,iconType:c,tooltip:h,tooltipPlacement:"bottom",onClick:f}),d]})},g=a=>({noBorderContainer:(0,n.css)({padding:`0 ${a.spacing(.5)}`,display:"flex"})})},62367:(k,R,e)=>{"use strict";e.d(R,{$:()=>m});var t=e(74848),n=e(96540),i=e(85858),s=e(3591),r=e(32264),g=e(11134),a=e(15648),c=e(25573),o=e(10096),h=e(8484),f=e(16233),d=e(74856),p=e(28444);class m extends n.Component{constructor(){super(...arguments),this.onChangeRefreshInterval=l=>{(0,d.jG)().setAutoRefresh(l),this.forceUpdate()},this.onRefresh=()=>((0,d.jG)().refreshTimeModel(),Promise.resolve()),this.onMoveBack=()=>{o.lE.publish(new p.Io({direction:p.xL.Left}))},this.onMoveForward=()=>{o.lE.publish(new p.Io({direction:p.xL.Right}))},this.onChangeTimePicker=l=>{const{dashboard:y}=this.props,u=y.timepicker,D=u.nowDelay&&l.raw.to==="now",E=i.isMathString(l.raw.from)?l.raw.from:l.from,x=i.isMathString(l.raw.to)?l.raw.to:l.to,P={from:E,to:D?"now-"+u.nowDelay:x};(0,d.jG)().setTime(P)},this.onChangeTimeZone=l=>{this.props.dashboard.timezone=l,this.props.onChangeTimeZone(l),this.onRefresh()},this.onChangeFiscalYearStartMonth=l=>{this.props.dashboard.fiscalYearStartMonth=l,this.onRefresh()},this.onZoom=()=>{this.props.onToolbarZoomClick&&this.props.onToolbarZoomClick(),o.lE.publish(new p.U0({scale:2}))},this.onRefreshClick=()=>{this.props.onToolbarRefreshClick&&this.props.onToolbarRefreshClick(),this.onRefresh()}}componentDidMount(){this.sub=this.props.dashboard.events.subscribe(s.sR,()=>this.forceUpdate())}componentWillUnmount(){this.sub?.unsubscribe()}render(){const{dashboard:l,isOnCanvas:y}=this.props,{refresh_intervals:u}=l.timepicker,D=(0,d.jG)().getValidIntervals(u||g.cb),E=(0,d.jG)().timeRange(),x=l.getTimezone(),P=l.fiscalYearStartMonth,b=l.panelInEdit?.isEditing,M=l.weekStart||(0,a.r)(r.$.bootData.user.weekStart);let O;return l.refresh===f.SM&&(O=(0,d.jG)().getAutoRefreshInteval().interval),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.m,{value:E,onChange:this.onChangeTimePicker,timeZone:x,fiscalYearStartMonth:P,onMoveBackward:this.onMoveBack,onMoveForward:this.onMoveForward,onZoom:this.onZoom,onChangeTimeZone:this.onChangeTimeZone,onChangeFiscalYearStartMonth:this.onChangeFiscalYearStartMonth,isOnCanvas:y,onToolbarTimePickerClick:this.props.onToolbarTimePickerClick,weekStart:M}),(0,t.jsx)(g.cC,{onIntervalChanged:this.onChangeRefreshInterval,onRefresh:this.onRefreshClick,value:l.refresh,intervals:D,isOnCanvas:y,tooltip:(0,h.t)("dashboard.toolbar.refresh","Refresh dashboard"),noIntervalPicker:b,showAutoInterval:!0,text:O})]})}}},16495:(k,R,e)=>{"use strict";e.d(R,{U:()=>t.Ay});var t=e(20120)},46991:(k,R,e)=>{"use strict";e.d(R,{d:()=>r});var t=e(74848),n=e(32196),i=e(40845),s=e(55852);const r=({children:a,...c})=>{const o=(0,i.of)(g);return(0,t.jsx)("div",{className:o.buttonWrapper,children:(0,t.jsx)(s.$n,{icon:"plus",...c,children:a})})},g=a=>({buttonWrapper:(0,n.css)({padding:`${a.spacing(3)} 0`})})},75590:(k,R,e)=>{"use strict";e.d(R,{p:()=>u});var t=e(74848),n=e(2543),i=e(96540),s=e(65879),r=e(13544),g=e(57418),a=e(88575),c=e(20333),o=e(15648),h=e(10354),f=e(15292),d=e(8484),p=e(11134),m=e(74856);const v=({refreshIntervals:D,onRefreshIntervalChange:E,getIntervalsFunc:x=y,validateIntervalsFunc:P=l})=>{const[b,M]=(0,i.useState)(x(D??p.cb)),[O,I]=(0,i.useState)(null);(0,i.useEffect)(()=>{const A=x(D??p.cb);M(A)},[x,D]);const T=(0,i.useMemo)(()=>Array.isArray(b)?b.join(","):"",[b]),C=(0,i.useCallback)(A=>{const L=A.currentTarget.value?A.currentTarget.value.split(","):[];M(L)},[M]),S=(0,i.useCallback)(A=>{const L=P(b);L===null&&E(x(b)),I(L)},[x,b,E,P]);return(0,t.jsx)(a.D,{label:(0,d.t)("dashboard-settings.general.auto-refresh-label","Auto refresh"),description:(0,d.t)("dashboard-settings.general.auto-refresh-description","Define the auto refresh intervals that should be available in the auto refresh list. Use the format '5s' for seconds, '1m' for minutes, '1h' for hours, and '1d' for days (e.g.: '5s,10s,30s,1m,5m,15m,30m,1h,2h,1d')."),error:O,invalid:!!O,children:(0,t.jsx)(h.p,{id:"auto-refresh-input",invalid:!!O,value:T,onChange:C,onBlur:S})})},l=(D,E={getTimeSrv:m.jG})=>{try{return y(D,E),null}catch(x){return x instanceof Error?x.message:"Invalid intervals"}},y=(D,E={getTimeSrv:m.jG})=>{const x=D.filter(P=>P.trim()!=="").map(P=>P.replace(/\s+/g,""));return[...new Set(E.getTimeSrv().getValidIntervals(x))]};class u extends i.PureComponent{constructor(){super(...arguments),this.state={isNowDelayValid:!0},this.onNowDelayChange=E=>{const x=E.currentTarget.value;if((0,n.isEmpty)(x))return this.setState({isNowDelayValid:!0}),this.props.onNowDelayChange(x);if(s.isValidTimeSpan(x))return this.setState({isNowDelayValid:!0}),this.props.onNowDelayChange(x);this.setState({isNowDelayValid:!1})},this.onHideTimePickerChange=()=>{this.props.onHideTimePickerChange(!this.props.timePickerHidden)},this.onLiveNowChange=()=>{this.props.onLiveNowChange(!this.props.liveNow)},this.onTimeZoneChange=E=>{typeof E=="string"&&this.props.onTimeZoneChange(E)},this.onWeekStartChange=E=>{this.props.onWeekStartChange(E)}}render(){return(0,t.jsxs)(g.M,{label:(0,d.t)("dashboard-settings.time-picker.time-options-label","Time options"),isOpen:!0,children:[(0,t.jsx)(a.D,{label:(0,d.t)("dashboard-settings.time-picker.time-zone-label","Time zone"),"data-testid":r.Tp.components.TimeZonePicker.containerV2,children:(0,t.jsx)(c.U,{inputId:"time-options-input",includeInternal:!0,value:this.props.timezone,onChange:this.onTimeZoneChange,width:40})}),(0,t.jsx)(a.D,{label:(0,d.t)("dashboard-settings.time-picker.week-start-label","Week start"),"data-testid":r.Tp.components.WeekStartPicker.containerV2,children:(0,t.jsx)(o.l,{inputId:"week-start-input",width:40,value:this.props.weekStart,onChange:this.onWeekStartChange})}),(0,t.jsx)(v,{refreshIntervals:this.props.refreshIntervals,onRefreshIntervalChange:this.props.onRefreshIntervalChange}),(0,t.jsx)(a.D,{label:(0,d.t)("dashboard-settings.time-picker.now-delay-label","Now delay"),description:(0,d.t)("dashboard-settings.time-picker.now-delay-description","Exclude recent data that may be incomplete."),children:(0,t.jsx)(h.p,{id:"now-delay-input",invalid:!this.state.isNowDelayValid,placeholder:"0m",onChange:this.onNowDelayChange,defaultValue:this.props.nowDelay})}),(0,t.jsx)(a.D,{label:(0,d.t)("dashboard-settings.time-picker.hide-time-picker","Hide time picker"),children:(0,t.jsx)(f.d,{id:"hide-time-picker-toggle",value:!!this.props.timePickerHidden,onChange:this.onHideTimePickerChange})}),(0,t.jsx)(a.D,{label:(0,d.t)("dashboard-settings.time-picker.refresh-live-dashboards-label","Refresh live dashboards"),description:(0,d.t)("dashboard-settings.time-picker.refresh-live-dashboards-description","Continuously re-draw panels where the time range references 'now'"),children:(0,t.jsx)(f.d,{id:"refresh-live-dashboards-toggle",value:!!this.props.liveNow,onChange:this.onLiveNowChange})})]})}}},62639:(k,R,e)=>{"use strict";e.d(R,{s:()=>po});var t=e(74848),n=e(96540),i=e(24180),s=e(71733),r=e(13544),g=e(39601),a=e(55852),c=e(15068),o=e(67061),h=e(94753),f=e(75269),d=e(69444),p=e(8484),m=e(16233),v=e(31678),l=e(28444),y=e(71468),u=e(14644),D=e(32196),E=e(16817),x=e(14110),P=e(40845),b=e(57418),M=e(66864),O=e(62930),I=e(56034),T=e(14578),C=e(29158),S=e(2223);const A=({id:Lt,usages:Ht})=>{const on=(0,n.useMemo)(()=>Ht.find(Un=>Un.variable.id===Lt),[Lt,Ht]);if(!on)return null;const vn=on.nodes.map(Un=>Un.label.includes(`$${Lt}`)?{...Un,color:"#FB7E81"}:Un);return(0,t.jsx)(S.i,{show:!1,title:`Showing usages for: $${Lt}`,nodes:vn,edges:on.edges,children:({showModal:Un})=>(0,t.jsx)(C.K,{onClick:()=>Un(),name:"code-branch",tooltip:"Show usages","data-testid":"VariablesUnknownButton"})})};var L=e(12846);const N=1e3;function F({variables:Lt,dashboard:Ht}){const[on,vn]=(0,n.useState)(!1),[Un,cs]=(0,n.useState)(0),[os,Js]=(0,n.useState)([]),Ss=(0,P.of)(K);(0,n.useEffect)(()=>cs(ss=>ss+1),[Lt,Ht]);const{loading:Ra}=(0,E.A)(async()=>{if(on&&Un>0){const ss=Date.now(),Ia=await(0,L.g0)(Lt,Ht),Dr=Date.now()-ss;return Dr>=N&&(0,x.rR)("Slow unknown variables expansion",{elapsed:Dr}),cs(0),Js(Ia),Ia}return[]},[Lt,Ht,on,Un]),Oa=ss=>{ss&&(0,x.rR)("Unknown variables section expanded"),vn(ss)};return(0,t.jsx)("div",{className:Ss.container,children:(0,t.jsxs)(b.M,{label:(0,t.jsx)(w,{}),isOpen:on,onToggle:Oa,children:[Ra&&(0,t.jsx)(M.gW,{justify:"center",children:(0,t.jsxs)(M.Gy,{justify:"center",children:[(0,t.jsx)("span",{children:"Loading..."}),(0,t.jsx)(O.y,{})]})}),!Ra&&os&&(0,t.jsxs)(t.Fragment,{children:[os.length===0&&(0,t.jsx)(B,{}),os.length>0&&(0,t.jsx)(U,{usages:os})]})]})})}function w(){const Lt=(0,P.of)(K);return(0,t.jsxs)("h5",{children:["Renamed or missing variables",(0,t.jsx)(I.m,{content:"Click to expand a list with all variable references that have been renamed or are missing from the dashboard.",children:(0,t.jsx)(T.I,{name:"info-circle",className:Lt.infoIcon})})]})}function B(){return(0,t.jsx)("span",{children:"No renamed or missing variables found."})}function U({usages:Lt}){const Ht=(0,P.of)(K);return(0,t.jsxs)("table",{className:"filter-table filter-table--hover",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Variable"}),(0,t.jsx)("th",{colSpan:5})]})}),(0,t.jsx)("tbody",{children:Lt.map(on=>{const{variable:vn}=on,{id:Un,name:cs}=vn;return(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{className:Ht.firstColumn,children:(0,t.jsx)("span",{children:cs})}),(0,t.jsx)("td",{className:Ht.defaultColumn}),(0,t.jsx)("td",{className:Ht.defaultColumn}),(0,t.jsx)("td",{className:Ht.defaultColumn}),(0,t.jsx)("td",{className:Ht.lastColumn,children:(0,t.jsx)(A,{id:vn.id,usages:Lt})})]},Un)})})]})}const K=Lt=>({container:(0,D.css)`
    margin-top: ${Lt.spacing(4)};
    padding-top: ${Lt.spacing(4)};
  `,infoIcon:(0,D.css)`
    margin-left: ${Lt.spacing(1)};
  `,defaultColumn:(0,D.css)`
    width: 1%;
  `,firstColumn:(0,D.css)`
    width: 1%;
    vertical-align: top;
    color: ${Lt.colors.text.maxContrast};
  `,lastColumn:(0,D.css)`
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    width: 100%;
    text-align: right;
  `});var V=e(48594),H=e(87421),Y=e(56968),X=e(75096),J=e(96374);function q({varName:Lt,isOpen:Ht=!1,onConfirm:on,onDismiss:vn}){return(0,t.jsx)(J.u,{title:"Delete variable",isOpen:Ht,onConfirm:on,onDismiss:vn,body:`
      Are you sure you want to delete variable "${Lt}"?
    `,modalClass:ae.modal,confirmText:"Delete"})}const ae={modal:(0,D.css)({width:"max-content",maxWidth:"80vw"})};var j=e(39070),te=e(8964),ne=e(58975),le=e(85140),z=e(14329),ee=e(41820),se=e(20601),ie=e(24240),Z=e(72401),oe=e(89458);function ce({onChange:Lt,type:Ht}){const on=(0,n.useMemo)(()=>(0,X.AX)(),[]),vn=(0,n.useMemo)(()=>on.find(Un=>Un.value===Ht)??on[0],[on,Ht]);return(0,t.jsx)(oe.v,{name:"Select variable type",value:vn,options:on,onChange:Lt,testId:r.Tp.pages.Dashboard.Settings.Variables.Edit.General.generalTypeSelectV2})}var ye=e(2543),re=e(27238),ue=e(3843);const De=Lt=>async Ht=>{const{rootStateKey:on}=Lt;Ht((0,V.kb)(on,(0,ue.sJ)({name:(0,H.dn)(Lt).name,id:Lt.id})))},ge=Lt=>async(Ht,on)=>{const{rootStateKey:vn}=Lt;Ht((0,V.kb)(vn,(0,ue.T7)((0,X.qD)(Lt))))},Te=(Lt,Ht)=>(on,vn)=>{const{id:Un,rootStateKey:cs}=Lt;let os=null;if(Ht.match(/^(?!__).*$/)||(os="Template names cannot begin with '__', that's reserved for Grafana's global variables"),Ht.match(/^\w+$/)||(os="Only word characters are allowed in variable names"),(0,H.SS)(cs,vn()).filter(Ra=>Ra.name===Ht&&Ra.id!==Un).length&&(os="Variable with the same name already exists"),os){on((0,V.kb)(cs,(0,ue.DW)({newName:Ht,errorText:os})));return}on(Le(Lt,Ht))},Le=(Lt,Ht)=>(on,vn)=>{const{rootStateKey:Un}=Lt,cs=(0,H.dn)(Lt,vn());if(cs.name===Ht){on((0,V.kb)(Un,(0,ue.FN)((0,X.qD)(Lt,{newName:Ht}))));return}const os={...(0,ye.cloneDeep)(cs),name:Ht,id:Ht},Js=cs.global,Ss=cs.index,Ra=(0,X.jX)(os);on((0,V.kb)(Un,(0,Y.QV)((0,X.qD)(Ra,{global:Js,index:Ss,model:os})))),on((0,V.kb)(Un,(0,ue.FN)((0,X.qD)(Ra,{newName:Ht})))),on((0,V.kb)(Un,(0,Y.Hr)((0,X.qD)(Lt,{reIndex:!1}))))},Ye=(Lt,Ht="query")=>(on,vn)=>{const Un=(0,X.q4)(Lt),cs=(0,H.SS)(Un,vn()),os=Ze(Ht,cs),Js={type:Ht,id:os},Ss=!1,Ra=(0,H.hk)(Un,vn()),Oa=(0,ye.cloneDeep)(se.B.get(Ht).initialState);Oa.id=os,Oa.name=os,Oa.rootStateKey=Un,on((0,V.kb)(Un,(0,Y.QV)((0,X.qD)(Js,{global:Ss,model:Oa,index:Ra})))),g.Ny.partial({editIndex:cs.length})},je=Lt=>(Ht,on)=>{const vn=(0,X.q4)(Lt),Un=on(),cs=(0,H.nS)(vn,Un),os=Un.dashboard.getModel(),{usages:Js}=(0,L.hM)(cs,os),Ss=(0,L.Ow)(Js);Ht((0,V.kb)(vn,(0,re.bX)({usages:Js,usagesNetwork:Ss})))};function Ze(Lt,Ht){let on=0,vn=`${Lt}${on}`;for(;Ht.find(Un=>Un.id===vn);)vn=`${Lt}${++on}`;return vn}var Ne=e(85830);const Pe=(Lt,Ht)=>({editor:(0,H.nx)(Ht.identifier.rootStateKey,Lt).editor,variable:(0,H.dn)(Ht.identifier,Lt)}),Ue=Lt=>({...(0,u.bindActionCreators)({variableEditorMount:De,variableEditorUnMount:ge,changeVariableName:Te,updateOptions:Z.mZ},Lt),changeVariableProp:(Ht,on,vn)=>Lt((0,V.kb)(Ht.rootStateKey,(0,Y.QP)((0,X.qD)(Ht,{propName:on,propValue:vn})))),changeVariableType:(Ht,on)=>Lt((0,V.kb)(Ht.rootStateKey,(0,Y.l_)((0,X.qD)(Ht,{newType:on})))),removeVariable:Ht=>{Lt((0,V.kb)(Ht.rootStateKey,(0,Y.Hr)((0,X.qD)(Ht,{reIndex:!0}))))}}),$e=(0,y.connect)(Pe,Ue);class ze extends n.PureComponent{constructor(){super(...arguments),this.state={showDeleteModal:!1},this.onNameChange=Ht=>{Ht.preventDefault(),this.props.changeVariableName(this.props.identifier,Ht.currentTarget.value)},this.onTypeChange=Ht=>{Ht.value&&this.props.changeVariableType(this.props.identifier,Ht.value)},this.onLabelChange=Ht=>{Ht.preventDefault(),this.props.changeVariableProp(this.props.identifier,"label",Ht.currentTarget.value)},this.onDescriptionChange=Ht=>{this.props.changeVariableProp(this.props.identifier,"description",Ht.currentTarget.value)},this.onHideChange=Ht=>{this.props.changeVariableProp(this.props.identifier,"hide",Ht)},this.onPropChanged=({propName:Ht,propValue:on,updateOptions:vn=!1})=>{this.props.changeVariableProp(this.props.identifier,Ht,on),vn&&this.props.updateOptions((0,X.jX)(this.props.variable))},this.onHandleSubmit=async Ht=>{Ht.preventDefault(),this.props.editor.isValid&&this.props.updateOptions((0,X.jX)(this.props.variable))},this.onModalOpen=()=>{this.setState({showDeleteModal:!0})},this.onModalClose=()=>{this.setState({showDeleteModal:!1})},this.onDelete=()=>{this.props.removeVariable(this.props.identifier),this.onModalClose(),g.Ny.partial({editIndex:null})},this.onApply=()=>{g.Ny.partial({editIndex:null})},this.getVariableOptions=()=>{const{variable:Ht}=this.props;return(0,ie.SP)(Ht)?Ht.options.map(on=>({label:String(on.text),value:String(on.value)})):[]}}componentDidMount(){this.props.variableEditorMount(this.props.identifier)}componentWillUnmount(){this.props.variableEditorUnMount(this.props.identifier)}render(){const{theme:Ht,variable:on}=this.props,vn=se.B.get(this.props.variable.type).editor;if(!vn)return null;const Un=on.state===j.Gu.Loading,cs=window.matchMedia("(prefers-reduced-motion: reduce)").matches,os=vt(Ht);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("form",{"aria-label":"Variable editor Form",onSubmit:this.onHandleSubmit,children:[(0,t.jsx)(ce,{onChange:this.onTypeChange,type:this.props.variable.type}),(0,t.jsx)(ne.Y,{children:"General"}),(0,t.jsx)(z._,{value:this.props.editor.name,onChange:this.onNameChange,name:"Name",placeholder:"Variable name",description:"The name of the template variable. (Max. 50 characters)",invalid:!!this.props.editor.errors.name,error:this.props.editor.errors.name,testId:r.Tp.pages.Dashboard.Settings.Variables.Edit.General.generalNameInputV2,maxLength:Ne.M.MaxSize,required:!0}),(0,t.jsx)(z._,{name:"Label",description:"Optional display name",value:this.props.variable.label??"",placeholder:"Label name",onChange:this.onLabelChange,testId:r.Tp.pages.Dashboard.Settings.Variables.Edit.General.generalLabelInputV2}),(0,t.jsx)(le.Z,{name:"Description",value:on.description??"",placeholder:"Descriptive text",onChange:this.onDescriptionChange,width:52}),(0,t.jsx)(te.D,{onChange:this.onHideChange,hide:this.props.variable.hide,type:this.props.variable.type}),vn&&(0,t.jsx)(vn,{variable:this.props.variable,onPropChange:this.onPropChanged}),(0,ie.SP)(this.props.variable)?(0,t.jsx)(ee.j,{options:this.getVariableOptions()}):null,(0,t.jsx)("div",{style:{marginTop:"16px"},children:(0,t.jsxs)(M.Gy,{spacing:"md",height:"inherit",children:[(0,t.jsx)(a.$n,{variant:"destructive",fill:"outline",onClick:this.onModalOpen,children:"Delete"}),(0,t.jsxs)(a.$n,{type:"submit","data-testid":r.Tp.pages.Dashboard.Settings.Variables.Edit.General.submitButton,disabled:Un,variant:"secondary",children:["Run query",Un&&(0,t.jsx)(T.I,{className:os.spin,name:cs?"hourglass":"sync",size:"sm",style:{marginLeft:"2px"}})]}),(0,t.jsx)(a.$n,{variant:"primary",onClick:this.onApply,"data-testid":r.Tp.pages.Dashboard.Settings.Variables.Edit.General.applyButton,children:"Apply"})]})})]}),(0,t.jsx)(q,{isOpen:this.state.showDeleteModal,varName:this.props.editor.name,onConfirm:this.onDelete,onDismiss:this.onModalClose})]})}}const qe=(0,P.cV)($e(ze)),dt=(0,D.keyframes)({"0%":{transform:"rotate(0deg) scaleX(-1)"},"100%":{transform:"rotate(359deg) scaleX(-1)"}}),vt=Lt=>({spin:(0,D.css)({[Lt.transitions.handleMotion("no-preference")]:{animation:`${dt} 3s linear infinite`}})});var yt=e(91076),st=e(69529),Ve=e(72109);const pe=({variables:Lt})=>{const Ht=(0,n.useMemo)(()=>(0,L.hI)(Lt),[Lt]),on=(0,n.useMemo)(()=>(0,L.qJ)(Lt),[Lt]);return on.length?(0,t.jsx)(S.i,{show:!1,title:"Dependencies",nodes:(0,L.H7)(Ht,on),edges:on,children:({showModal:vn})=>(0,t.jsx)(a.$n,{onClick:()=>{(0,x.rR)("Show variable dependencies"),vn()},icon:"channel-add",variant:"secondary",children:"Show dependencies"})}):null},Ee=({id:Lt,usages:Ht,isAdhoc:on})=>{const vn=(0,n.useMemo)(()=>Ht.find(cs=>cs.variable.id===Lt),[Ht,Lt]);if(Ht.length===0||on||!vn)return null;const Un=vn.nodes.map(cs=>cs.label.includes(`$${Lt}`)?{...cs,color:"#FB7E81"}:cs);return(0,t.jsx)(S.i,{show:!1,title:`Showing usages for: $${Lt}`,nodes:Un,edges:vn.edges,children:({showModal:cs})=>(0,t.jsx)(C.K,{onClick:()=>{(0,x.rR)("Show variable usages"),cs()},name:"code-branch",tooltip:"Show usages"})})};function me({index:Lt,variable:Ht,usageTree:on,usagesNetwork:vn,onEdit:Un,onDuplicate:cs,onDelete:os}){const Js=(0,P.$j)(),Ss=(0,P.of)(Ie),Ra=ve(Ht),ss=(0,L.PK)(Ht.id,on)>0||Ht.type==="adhoc",Ia=(0,X.jX)(Ht);return(0,t.jsx)(yt.sx,{draggableId:JSON.stringify(Ia),index:Lt,children:(Cr,Dr)=>(0,t.jsxs)("tr",{ref:Cr.innerRef,...Cr.draggableProps,style:{userSelect:Dr.isDragging?"none":"auto",background:Dr.isDragging?Js.colors.background.secondary:void 0,...Cr.draggableProps.style},children:[(0,t.jsx)("td",{role:"gridcell",className:Ss.column,children:(0,t.jsx)(a.$n,{size:"xs",fill:"text",onClick:dr=>{dr.preventDefault(),Un(Ia)},className:Ss.nameLink,"aria-label":r.Tp.pages.Dashboard.Settings.Variables.List.tableRowNameFields(Ht.name),children:Ht.name})}),(0,t.jsx)("td",{role:"gridcell",className:Ss.definitionColumn,onClick:dr=>{dr.preventDefault(),Un(Ia)},"aria-label":r.Tp.pages.Dashboard.Settings.Variables.List.tableRowDefinitionFields(Ht.name),children:Ra}),(0,t.jsx)("td",{role:"gridcell",className:Ss.column,children:(0,t.jsxs)("div",{className:Ss.icons,children:[(0,t.jsx)(Se,{passed:ss}),(0,t.jsx)(Ee,{id:Ht.id,isAdhoc:Ht.type==="adhoc",usages:vn}),(0,t.jsx)(C.K,{onClick:dr=>{dr.preventDefault(),(0,x.rR)("Duplicate variable"),cs(Ia)},name:"copy",tooltip:"Duplicate variable","aria-label":r.Tp.pages.Dashboard.Settings.Variables.List.tableRowDuplicateButtons(Ht.name)}),(0,t.jsx)(C.K,{onClick:dr=>{dr.preventDefault(),(0,x.rR)("Delete variable"),os(Ia)},name:"trash-alt",tooltip:"Remove variable","aria-label":r.Tp.pages.Dashboard.Settings.Variables.List.tableRowRemoveButtons(Ht.name)}),(0,t.jsx)("div",{...Cr.dragHandleProps,className:Ss.dragHandle,children:(0,t.jsx)(T.I,{name:"draggabledots",size:"lg"})})]})})]})})}function ve(Lt){let Ht="";return Lt.type==="query"?Lt.definition?Ht=Lt.definition:typeof Lt.query=="string"&&(Ht=Lt.query):(0,ie.SP)(Lt)&&(Ht=Lt.query),Ht}function Se({passed:Lt}){const Ht=(0,P.of)(Ie);return Lt?(0,t.jsx)(T.I,{name:"check",className:Ht.iconPassed,title:"This variable is referenced by other variables or dashboard."}):(0,t.jsx)(T.I,{name:"exclamation-triangle",className:Ht.iconFailed,title:"This variable is not referenced by any variable or dashboard."})}function Ie(Lt){return{dragHandle:(0,D.css)`
      cursor: grab;
      margin-left: ${Lt.spacing(1)};
    `,column:(0,D.css)`
      width: 1%;
    `,nameLink:(0,D.css)`
      cursor: pointer;
      color: ${Lt.colors.primary.text};
    `,definitionColumn:(0,D.css)`
      width: 100%;
      max-width: 200px;
      cursor: pointer;
      overflow: hidden;
      text-overflow: ellipsis;
      -o-text-overflow: ellipsis;
      white-space: nowrap;
    `,iconPassed:(0,D.css)`
      color: ${Lt.v1.palette.greenBase};
      margin-right: ${Lt.spacing(2)};
    `,iconFailed:(0,D.css)`
      color: ${Lt.v1.palette.orange};
      margin-right: ${Lt.spacing(2)};
    `,icons:(0,D.css)`
      display: flex;
      gap: ${Lt.spacing(2)};
      align-items: center;
    `}}function Oe({variables:Lt,usages:Ht,usagesNetwork:on,onChangeOrder:vn,onAdd:Un,onEdit:cs,onDelete:os,onDuplicate:Js}){const Ss=(0,P.of)(he),Ra=Oa=>{if(!Oa.destination||!Oa.source)return;(0,x.rR)("Variable drag and drop");const ss=JSON.parse(Oa.draggableId);vn(ss,Lt[Oa.source.index].index,Lt[Oa.destination.index].index)};return(0,t.jsx)("div",{children:(0,t.jsxs)("div",{children:[Lt.length===0&&(0,t.jsx)(Re,{onAdd:Un}),Lt.length>0&&(0,t.jsxs)(o.B,{direction:"column",gap:4,children:[(0,t.jsx)("div",{className:Ss.tableContainer,children:(0,t.jsxs)("table",{className:"filter-table filter-table--hover","aria-label":r.Tp.pages.Dashboard.Settings.Variables.List.table,role:"grid",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Variable"}),(0,t.jsx)("th",{children:"Definition"}),(0,t.jsx)("th",{colSpan:5})]})}),(0,t.jsx)(yt.JY,{onDragEnd:Ra,children:(0,t.jsx)(yt.gL,{droppableId:"variables-list",direction:"vertical",children:Oa=>(0,t.jsxs)("tbody",{ref:Oa.innerRef,...Oa.droppableProps,children:[Lt.map((ss,Ia)=>(0,t.jsx)(me,{index:Ia,variable:ss,usageTree:Ht,usagesNetwork:on,onDelete:os,onDuplicate:Js,onEdit:cs},`${ss.name}-${Ia}`)),Oa.placeholder]})})})]})}),(0,t.jsxs)(o.B,{children:[(0,t.jsx)(pe,{variables:Lt}),(0,t.jsx)(a.$n,{"aria-label":r.Tp.pages.Dashboard.Settings.Variables.List.newButton,onClick:Un,icon:"plus",children:"New variable"})]})]})]})})}function Re({onAdd:Lt}){return(0,t.jsx)(o.B,{direction:"column",children:(0,t.jsxs)(st.p,{variant:"call-to-action",button:(0,t.jsx)(a.$n,{"data-testid":r.Tp.components.CallToActionCard.buttonV2("Add variable"),icon:"calculator-alt",onClick:Lt,size:"lg",children:(0,t.jsx)(p.x6,{i18nKey:"variables.empty-state.button-title",children:"Add variable"})}),message:(0,p.t)("variables.empty-state.title","There are no variables added yet"),children:[(0,t.jsx)("p",{children:(0,t.jsx)(p.x6,{i18nKey:"variables.empty-state.info-box-content",children:"Variables enable more interactive and dynamic dashboards. Instead of hard-coding things like server or sensor names in your metric queries you can use variables in their place. Variables are shown as list boxes at the top of the dashboard. These drop-down lists make it easy to change the data being displayed in your dashboard."})}),(0,t.jsxs)(p.x6,{i18nKey:"variables.empty-state.info-box-content-2",children:["Check out the"," ",(0,t.jsx)(Ve.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/variables/",children:"Templates and variables documentation"})," ","for more information."]})]})})}const he=()=>({tableContainer:(0,D.css)`
    overflow: scroll;
    width: 100%;
  `}),Ce=(Lt,Ht)=>{const{uid:on}=Ht.dashboard,vn=(0,H.nx)(on,Lt);return{variables:(0,H.nS)(on,Lt),idInEditor:vn.editor.id,usagesNetwork:vn.inspect.usagesNetwork,usages:vn.inspect.usages}},We=Lt=>({...(0,u.bindActionCreators)({createNewVariable:Ye,initListMode:je},Lt),changeVariableOrder:(Ht,on,vn)=>Lt((0,V.kb)(Ht.rootStateKey,(0,Y.hj)((0,X.qD)(Ht,{fromIndex:on,toIndex:vn})))),duplicateVariable:Ht=>Lt((0,V.kb)(Ht.rootStateKey,(0,Y.ut)((0,X.qD)(Ht,{newId:void 0})))),removeVariable:Ht=>{Lt((0,V.kb)(Ht.rootStateKey,(0,Y.Hr)((0,X.qD)(Ht,{reIndex:!0}))))}}),et=(0,y.connect)(Ce,We);class rt extends n.PureComponent{constructor(){super(...arguments),this.state={variableId:void 0},this.onEditVariable=Ht=>{const on=this.props.variables.findIndex(vn=>vn.id===Ht.id);g.Ny.partial({editIndex:on})},this.onNewVariable=()=>{this.props.createNewVariable(this.props.dashboard.uid)},this.onChangeVariableOrder=(Ht,on,vn)=>{this.props.changeVariableOrder(Ht,on,vn)},this.onDuplicateVariable=Ht=>{this.props.duplicateVariable(Ht)},this.onModalOpen=Ht=>{this.setState({variableId:Ht})},this.onModalClose=()=>{this.setState({variableId:void 0})},this.onRemoveVariable=()=>{this.props.removeVariable(this.state.variableId),this.onModalClose()}}componentDidMount(){this.props.initListMode(this.props.dashboard.uid)}render(){const{editIndex:Ht,variables:on,sectionNav:vn}=this.props,Un=Ht!=null?on[Ht]:void 0,os=vn.node.parentItem,Js=Un?{text:Un.name,parentItem:os}:os;return(0,t.jsxs)(d.Y,{navModel:this.props.sectionNav,pageNav:Js,children:[!Un&&(0,t.jsx)(Oe,{variables:this.props.variables,onAdd:this.onNewVariable,onEdit:this.onEditVariable,onChangeOrder:this.onChangeVariableOrder,onDuplicate:this.onDuplicateVariable,onDelete:this.onModalOpen,usages:this.props.usages,usagesNetwork:this.props.usagesNetwork}),!Un&&this.props.variables.length>0&&(0,t.jsx)(F,{variables:this.props.variables,dashboard:this.props.dashboard}),Un&&(0,t.jsx)(qe,{identifier:(0,X.jX)(Un)}),(0,t.jsx)(q,{isOpen:this.state.variableId!==void 0,varName:this.state.variableId?.id??"",onConfirm:this.onRemoveVariable,onDismiss:this.onModalClose})]})}}const nt=et(rt);var gt=e(5108),xt=e(10096);const St=({dashboard:Lt,sectionNav:Ht})=>{const on=xt.TP.hasPermission(v.AccessControlAction.DashboardsPermissionsWrite),vn=Ht.node.parentItem;return(0,t.jsx)(d.Y,{navModel:Ht,pageNav:vn,children:(0,t.jsx)(gt.x,{resource:"dashboards",resourceId:Lt.uid,canSetPermissions:on})})};var zt=e(78050),Nt=e(22391),Vt=e(19347),en=e(84167),Je=e(88575),ct=e(10354),ot=e(42418),Qe=e(10880),pt=e(90182),Pt=e(77268),At=e(2913),mn=e(82241),Pn=e(46502),fn=e(51612);const Rn="New annotation",Kn=({editIdx:Lt,dashboard:Ht})=>{const on=(0,P.of)(Bt),[vn,Un]=(0,n.useState)(Ht.annotations.list[Lt]),cs=(0,n.useMemo)(()=>vn.filter?vn.filter.exclude?2:1:0,[vn.filter]),{value:os}=(0,E.A)(()=>(0,Vt.l)().get(vn.datasource),[vn.datasource]),Js=(0,Vt.l)().getInstanceSettings(vn.datasource),Ss=Ca=>{const Aa=[...Ht.annotations.list];Aa.splice(Lt,1,Ca),Un(Ca),Ht.annotations.list=Aa},Ra=Ca=>{Ss({...vn,name:Ca.currentTarget.value})},Oa=Ca=>{const Aa=(0,Nt.p$)(Ca);vn.datasource?.type!==Aa.type?Ss({datasource:Aa,builtIn:vn.builtIn,enable:vn.enable,iconColor:vn.iconColor,name:vn.name,hide:vn.hide,filter:vn.filter,mappings:vn.mappings,type:vn.type}):Ss({...vn,datasource:Aa})},ss=Ca=>{const Aa=Ca.currentTarget;Ss({...vn,[Aa.name]:Aa.type==="checkbox"?Aa.checked:Aa.value})},Ia=Ca=>{Ss({...vn,iconColor:Ca})},Cr=Ca=>{let Aa=Ca.value===0?void 0:{exclude:Ca.value===2,ids:vn.filter?.ids??[]};Ss({...vn,filter:Aa})},Dr=Ca=>{if(!Array.isArray(Ca))return;const Aa={exclude:cs===2,ids:[]};Ca.forEach(hr=>hr.value&&Aa.ids.push(hr.value)),Ss({...vn,filter:Aa})},dr=an,ur=()=>{g.Ny.partial({editview:null,editIndex:null})},Oo=()=>{const Ca=Ht.annotations.list;Ht.annotations.list=[...Ca.slice(0,Lt),...Ca.slice(Lt+1)],an()},Io=vn.name===Rn,za=(Ca,Aa)=>Ca.label&&Aa.label?Ca.label.toLowerCase().localeCompare(Aa.label.toLowerCase()):-1,Do=(0,n.useMemo)(()=>Ht?.panels.filter(Ca=>At.Ay.panels[Ca.type]).map(Ca=>({value:Ca.id,label:Ca.title??`Panel ${Ca.id}`,description:Ca.description,imgUrl:At.Ay.panels[Ca.type].info.logos.small})).sort(za)??[],[Ht]);return(0,t.jsxs)("div",{children:[(0,t.jsxs)(en.n,{className:on.settingsForm,children:[(0,t.jsx)(Je.D,{label:"Name",children:(0,t.jsx)(ct.p,{"data-testid":r.Tp.pages.Dashboard.Settings.Annotations.Settings.name,name:"name",id:"name",autoFocus:Io,value:vn.name,onChange:Ra})}),(0,t.jsx)(Je.D,{label:"Data source",htmlFor:"data-source-picker",children:(0,t.jsx)(fn.s,{annotations:!0,variables:!0,current:vn.datasource,onChange:Oa})}),!os?.meta.annotations&&(0,t.jsx)(ot.F,{title:"No annotation support for this data source",severity:"error",children:(0,t.jsx)(p.x6,{i18nKey:"errors.dashboard-settings.annotations.datasource",children:"The selected data source does not support annotations. Please select a different data source."})}),(0,t.jsx)(Je.D,{label:"Enabled",description:"When enabled the annotation query is issued every dashboard refresh",children:(0,t.jsx)(Qe.S,{name:"enable",id:"enable",value:vn.enable,onChange:ss})}),(0,t.jsx)(Je.D,{label:"Hidden",description:"Annotation queries can be toggled on or off at the top of the dashboard. With this option checked this toggle will be hidden.",children:(0,t.jsx)(Qe.S,{name:"hide",id:"hide",value:vn.hide,onChange:ss})}),(0,t.jsx)(Je.D,{label:"Color",description:"Color to use for the annotation event markers",children:(0,t.jsx)(M.Gy,{children:(0,t.jsx)(Pt.a,{value:vn?.iconColor,onChange:Ia})})}),(0,t.jsx)(Je.D,{label:"Show in","data-testid":r.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.showInLabel,children:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(pt.l6,{options:Cn,value:cs,onChange:Cr,"data-testid":r.Tp.components.Annotations.annotationsTypeInput}),cs!==0&&(0,t.jsx)(pt.KF,{options:Do,value:Do.filter(Ca=>vn.filter?.ids.includes(Ca.value)),onChange:Dr,isClearable:!0,placeholder:"Choose panels",width:100,closeMenuOnSelect:!1,className:on.select,"data-testid":r.Tp.components.Annotations.annotationsChoosePanelInput})]})})]}),(0,t.jsxs)(en.n,{children:[(0,t.jsx)("h3",{className:"page-heading",children:"Query"}),os?.annotations&&Js&&(0,t.jsx)(mn.A,{datasource:os,datasourceInstanceSettings:Js,annotation:vn,onChange:Ss}),os&&!os.annotations&&(0,t.jsx)(Pn.F,{datasource:os,annotation:vn,onChange:Ss})]}),(0,t.jsxs)(o.B,{children:[!vn.builtIn&&(0,t.jsx)(a.$n,{variant:"destructive",onClick:Oo,children:"Delete"}),(0,t.jsx)(a.$n,{variant:"secondary",onClick:ur,"data-testid":r.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.previewInDashboard,children:"Preview in dashboard"}),(0,t.jsx)(a.$n,{variant:"primary",onClick:dr,children:"Apply"})]})]})},Bt=Lt=>({settingsForm:(0,D.css)({maxWidth:Lt.spacing(60),marginBottom:Lt.spacing(2)}),select:(0,D.css)({marginTop:"8px"})});function an(){g.Ny.partial({editIndex:null})}var tn=(Lt=>(Lt[Lt.AllPanels=0]="AllPanels",Lt[Lt.IncludePanels=1]="IncludePanels",Lt[Lt.ExcludePanels=2]="ExcludePanels",Lt))(tn||{});const Cn=[{label:"All panels",value:0,description:"Send the annotation data to all panels that support annotations"},{label:"Selected panels",value:1,description:"Send the annotations to the explicitly listed panels"},{label:"All panels except",value:2,description:"Do not send annotation data to the following panels"}];var xn=e(14588),Vn=e(91605),Et=e(46991);const Ft=({dashboard:Lt,onNew:Ht,onEdit:on})=>{const vn=(0,P.of)(Gt),[Un,cs]=(0,n.useState)(Lt.annotations.list),os=(ss,Ia)=>{Lt.annotations.list=xn.moveItemImmutably(Un,ss,ss+Ia),cs(Lt.annotations.list)},Js=ss=>{Lt.annotations.list=[...Un.slice(0,ss),...Un.slice(ss+1)],cs(Lt.annotations.list)},Ss=Un.length===0||Un.length===1&&Un[0].builtIn,Ra=ss=>ss.enable===!1?(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("em",{className:"muted",children:["(Disabled) \xA0 ",ss.name]})}):ss.builtIn?(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("em",{className:"muted",children:[ss.name," \xA0 (Built-in)"]})}):(0,t.jsx)(t.Fragment,{children:ss.name}),Oa=(0,Vt.l)();return(0,t.jsxs)(o.B,{direction:"column",children:[Un.length>0&&(0,t.jsx)("div",{className:vn.table,children:(0,t.jsxs)("table",{role:"grid",className:"filter-table filter-table--hover",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Query name"}),(0,t.jsx)("th",{children:"Data source"}),(0,t.jsx)("th",{colSpan:3})]})}),(0,t.jsx)("tbody",{children:Lt.annotations.list.map((ss,Ia)=>(0,t.jsxs)("tr",{children:[ss.builtIn?(0,t.jsx)("td",{role:"gridcell",style:{width:"90%"},className:"pointer",onClick:()=>on(Ia),children:(0,t.jsx)(a.$n,{size:"sm",fill:"text",variant:"secondary",children:Ra(ss)})}):(0,t.jsx)("td",{role:"gridcell",className:"pointer",onClick:()=>on(Ia),children:(0,t.jsx)(a.$n,{size:"sm",fill:"text",variant:"secondary",children:Ra(ss)})}),(0,t.jsx)("td",{role:"gridcell",className:"pointer",onClick:()=>on(Ia),children:Oa.getInstanceSettings(ss.datasource)?.name||ss.datasource?.uid}),(0,t.jsx)("td",{role:"gridcell",style:{width:"1%"},children:Ia!==0&&(0,t.jsx)(C.K,{name:"arrow-up",onClick:()=>os(Ia,-1),tooltip:"Move up"})}),(0,t.jsx)("td",{role:"gridcell",style:{width:"1%"},children:Lt.annotations.list.length>1&&Ia!==Lt.annotations.list.length-1?(0,t.jsx)(C.K,{name:"arrow-down",onClick:()=>os(Ia,1),tooltip:"Move down"}):null}),(0,t.jsx)("td",{role:"gridcell",style:{width:"1%"},children:!ss.builtIn&&(0,t.jsx)(Vn.e,{size:"sm",onConfirm:()=>Js(Ia),"aria-label":`Delete query with title "${ss.name}"`})})]},`${ss.name}-${Ia}`))})]})}),Ss&&(0,t.jsx)(o.B,{direction:"column",children:(0,t.jsxs)(st.p,{variant:"call-to-action",button:(0,t.jsx)(a.$n,{"data-testid":r.Tp.components.CallToActionCard.buttonV2("Add annotation query"),icon:"comment-alt",onClick:Ht,size:"lg",children:(0,t.jsx)(p.x6,{i18nKey:"annotations.empty-state.button-title",children:"Add annotation query"})}),message:(0,p.t)("annotations.empty-state.title","There are no custom annotation queries added yet"),children:[(0,t.jsx)(p.x6,{i18nKey:"annotations.empty-state.info-box-content",children:(0,t.jsx)("p",{children:"Annotations provide a way to integrate event data into your graphs. They are visualized as vertical lines and icons on all graph panels. When you hover over an annotation icon you can get event text & tags for the event. You can add annotation events directly from grafana by holding CTRL or CMD + click on graph (or drag region). These will be stored in Grafana's annotation database."})}),(0,t.jsxs)(p.x6,{i18nKey:"annotations.empty-state.info-box-content-2",children:["Checkout the"," ",(0,t.jsx)(Ve.Y,{external:!0,href:"http://docs.grafana.org/reference/annotations/",children:"Annotations documentation"})," ","for more information."]})]})}),!Ss&&(0,t.jsx)(Et.d,{"data-testid":r.Tp.pages.Dashboard.Settings.Annotations.List.addAnnotationCTAV2,onClick:Ht,children:"New query"})]})},Gt=()=>({table:(0,D.css)({width:"100%",overflowX:"scroll"})});function ln({dashboard:Lt,editIndex:Ht,sectionNav:on}){const vn=()=>{const os={name:Rn,enable:!0,datasource:(0,Nt.p$)((0,Vt.l)().getInstanceSettings(null)),iconColor:"red"};Lt.annotations.list=[...Lt.annotations.list,{...os}],g.Ny.partial({editIndex:Lt.annotations.list.length-1})},Un=os=>{g.Ny.partial({editIndex:os})},cs=Ht!=null&&Ht<Lt.annotations.list.length;return(0,t.jsxs)(d.Y,{navModel:on,pageNav:qt(Lt,Ht,on.node),children:[!cs&&(0,t.jsx)(Ft,{dashboard:Lt,onNew:vn,onEdit:Un}),cs&&(0,t.jsx)(Kn,{dashboard:Lt,editIdx:Ht})]})}function qt(Lt,Ht,on){const vn=on.parentItem;if(Ht==null)return vn;const Un=Lt.annotations.list[Ht];if(Un)return{text:Un.name,parentItem:vn}}var cn=e(32264),En=e(90613),Sn=e(60029),Tn=e(21744),Wn=e(79924),Nn=e(94354),Tt=e(36607),Wt=e(3673),jt=e(71678),ut=e(14792),Zt=e(5805),jn=e(68402),Xn=e(37390),Qn=e(11230);const Fn={cleanUpDashboardAndVariables:Wt.Bz},qn=(0,y.connect)(null,Fn),js=({hideModal:Lt,cleanUpDashboardAndVariables:Ht,dashboard:on})=>{const vn=on.meta.provisioned,[,Un]=(0,Zt.default)(async()=>{(0,x.rR)("grafana_manage_dashboards_delete_clicked",{item_counts:{dashboard:1},source:"dashboard_settings",restore_enabled:cn.$.featureToggles.dashboardRestoreUI}),await(0,Qn.A_)(on.uid,!0),Ht(),Lt(),g.Ny.replace("/")},[Lt]);return vn?(0,t.jsx)(ys,{hideModal:Lt,provisionedId:on.meta.provisionedExternalId}):(0,t.jsx)(J.u,{isOpen:!0,body:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.E,{element:"p",children:(0,t.jsx)(p.x6,{i18nKey:"dashboard-settings.dashboard-delete-modal.text",children:"Do you want to delete this dashboard?"})}),(0,t.jsx)(jn.$,{v:1}),(0,t.jsx)(h.E,{element:"p",children:on.title}),(0,t.jsx)(jn.$,{v:2})]}),onConfirm:Un,onDismiss:Lt,title:(0,p.t)("dashboard-settings.dashboard-delete-modal.title","Delete"),icon:"trash-alt",confirmText:(0,p.t)("dashboard-settings.dashboard-delete-modal.delete-button","Delete"),confirmationText:(0,p.t)("dashboard-settings.dashboard-delete-modal.confirmation-text","Delete")})},ys=({hideModal:Lt,provisionedId:Ht})=>(0,t.jsxs)(Xn.a,{isOpen:!0,title:(0,p.t)("dashboard-settings.provisioned-delete-modal.title","Cannot delete provisioned dashboard"),icon:"trash-alt",onDismiss:Lt,className:(0,D.css)({width:"500px"}),children:[(0,t.jsx)(h.E,{element:"p",children:(0,t.jsx)(p.x6,{i18nKey:"dashboard-settings.provisioned-delete-modal.text-1",children:"This dashboard is managed by Grafana provisioning and cannot be deleted. Remove the dashboard from the config file to delete it."})}),(0,t.jsx)(jn.$,{v:1}),(0,t.jsxs)(h.E,{element:"p",children:[(0,t.jsx)(p.x6,{i18nKey:"dashboard-settings.provisioned-delete-modal.text-2",children:"See grafana documentation for more information about provisioning.\xA0"}),(0,t.jsx)(Ve.Y,{href:"https://grafana.com/docs/grafana/latest/administration/provisioning/#dashboards",external:!0,children:(0,p.t)("dashboard-settings.provisioned-delete-modal.text-link","Go to docs page")})]}),(0,t.jsx)(jn.$,{v:2}),(0,t.jsx)(h.E,{element:"p",children:(0,t.jsxs)(p.x6,{i18nKey:"dashboard-settings.provisioned-delete-modal.text-3",children:["File path: ",{provisionedId:Ht}]})}),(0,t.jsx)(Xn.a.ButtonRow,{children:(0,t.jsx)(a.$n,{variant:"primary",onClick:Lt,children:(0,t.jsx)(p.x6,{i18nKey:"dashboard-settings.provisioned-delete-modal.confirm-button",children:"OK"})})})]}),Ps=qn(js),es=()=>{const Lt=(0,ut.UA)().getCurrent();return(0,t.jsx)(jt.$s,{children:({showModal:Ht,hideModal:on})=>(0,t.jsx)(a.$n,{variant:"destructive",onClick:()=>{Ht(Ps,{dashboard:Lt,hideModal:on})},"data-testid":r.Tp.pages.Dashboard.Settings.General.deleteDashBoard,children:(0,t.jsx)(p.x6,{i18nKey:"dashboard-settings.dashboard-delete-button",children:"Delete dashboard"})})})};var _s=e(81394),ca=e(27966),Ks=e(75590);const Zs=[{value:0,label:"Default"},{value:1,label:"Shared crosshair"},{value:2,label:"Shared Tooltip"}];function nr({dashboard:Lt,updateTimeZone:Ht,updateWeekStart:on,sectionNav:vn}){const[Un,cs]=(0,n.useState)(0),[os,Js]=(0,n.useState)(Lt.title),[Ss,Ra]=(0,n.useState)(Lt.description),Oa=vn.node.parentItem,ss=(Ma,ho)=>{Lt.meta.folderUid=Ma,Lt.meta.folderTitle=ho,Lt.meta.hasUnsavedFolderChange=!0,cs(Un+1)},Ia=(0,n.useCallback)(Ma=>{Lt.title=Ma,Js(Ma)},[Js,Lt]),Cr=(0,n.useCallback)(Ma=>{Lt.description=Ma,Ra(Ma)},[Ra,Lt]),Dr=Ma=>{Lt.graphTooltip=Ma,cs(Un+1)},dr=Ma=>{Lt.timepicker.refresh_intervals=Ma.filter(ho=>ho.trim()!=="")},ur=Ma=>{Lt.timepicker.nowDelay=Ma},Oo=Ma=>{Lt.timepicker.hidden=Ma,cs(Un+1)},Io=Ma=>{Lt.liveNow=Ma,cs(Un+1)},za=Ma=>{Lt.timezone=Ma,cs(Un+1),Ht(Ma)},Do=Ma=>{Lt.weekStart=Ma,cs(Un+1),on(Ma)},Ca=Ma=>{Lt.tags=Ma,cs(Un+1)},Aa=Ma=>{Lt.editable=Ma,cs(Un+1)},hr=[{label:"Editable",value:!0},{label:"Read-only",value:!1}];return(0,t.jsx)(d.Y,{navModel:vn,pageNav:Oa,children:(0,t.jsxs)("div",{style:{maxWidth:"600px"},children:[(0,t.jsxs)(En.a,{marginBottom:5,children:[(0,t.jsx)(Je.D,{label:(0,t.jsxs)(o.B,{justifyContent:"space-between",children:[(0,t.jsx)(Sn.J,{htmlFor:"title-input",children:(0,t.jsx)(p.x6,{i18nKey:"dashboard-settings.general.title-label",children:"Title"})}),cn.$.featureToggles.dashgpt&&(0,t.jsx)(ca.Z,{onGenerate:Ia})]}),children:(0,t.jsx)(ct.p,{id:"title-input",name:"title",value:os,onChange:Ma=>Ia(Ma.target.value)})}),(0,t.jsx)(Je.D,{label:(0,t.jsxs)(o.B,{justifyContent:"space-between",children:[(0,t.jsx)(Sn.J,{htmlFor:"description-input",children:(0,p.t)("dashboard-settings.general.description-label","Description")}),cn.$.featureToggles.dashgpt&&(0,t.jsx)(_s.V,{onGenerate:Cr})]}),children:(0,t.jsx)(Tn.f,{id:"description-input",name:"description",value:Ss,onChange:Ma=>Cr(Ma.target.value)})}),(0,t.jsx)(Je.D,{label:(0,p.t)("dashboard-settings.general.tags-label","Tags"),children:(0,t.jsx)(Wn.u,{id:"tags-input",tags:Lt.tags,onChange:Ca,width:40})}),(0,t.jsx)(Je.D,{label:(0,p.t)("dashboard-settings.general.folder-label","Folder"),children:(0,t.jsx)(Tt.d,{value:Lt.meta.folderUid,onChange:ss,initialTitle:Lt.meta.folderTitle,inputId:"dashboard-folder-input",enableCreateNew:!0,dashboardId:Lt.id,skipInitialLoad:!0})}),(0,t.jsx)(Je.D,{label:(0,p.t)("dashboard-settings.general.editable-label","Editable"),description:(0,p.t)("dashboard-settings.general.editable-description","Set to read-only to disable all editing. Reload the dashboard for changes to take effect"),children:(0,t.jsx)(Nn.z,{value:Lt.editable,options:hr,onChange:Aa})})]}),(0,t.jsx)(Ks.p,{onTimeZoneChange:za,onWeekStartChange:Do,onRefreshIntervalChange:dr,onNowDelayChange:ur,onHideTimePickerChange:Oo,onLiveNowChange:Io,refreshIntervals:Lt.timepicker.refresh_intervals,timePickerHidden:Lt.timepicker.hidden,nowDelay:Lt.timepicker.nowDelay,timezone:Lt.timezone,weekStart:Lt.weekStart,liveNow:Lt.liveNow}),(0,t.jsx)(b.M,{label:(0,p.t)("dashboard-settings.general.panel-options-label","Panel options"),isOpen:!0,children:(0,t.jsx)(Je.D,{label:(0,p.t)("dashboard-settings.general.panel-options-graph-tooltip-label","Graph tooltip"),description:(0,p.t)("dashboard-settings.general.panel-options-graph-tooltip-description","Controls tooltip and hover highlight behavior across different panels. Reload the dashboard for changes to take effect"),children:(0,t.jsx)(Nn.z,{onChange:Dr,options:Zs,value:Lt.graphTooltip})})}),(0,t.jsx)(En.a,{marginTop:3,children:Lt.meta.canDelete&&(0,t.jsx)(es,{})})]})})}const lr={updateTimeZone:Wt.lC,updateWeekStart:Wt.Ss},$a=(0,y.connect)(null,lr)(nr);var Za=e(32372),mr=e(6473);function Va({dashboard:Lt,sectionNav:Ht}){const on=Lt.getSaveModelClone(),[vn,Un]=(0,n.useState)(JSON.stringify(on,null,2)),cs=Ht.node.parentItem,os=async()=>{await(0,ut.UA)().saveJSONDashboard(vn),mr.t.reloadPage()},Js=(0,P.of)(Ea);return(0,t.jsx)(d.Y,{navModel:Ht,pageNav:cs,children:(0,t.jsxs)("div",{className:Js.wrapper,children:[(0,t.jsx)(p.x6,{i18nKey:"dashboard-settings.json-editor.subtitle",children:"The JSON model below is the data structure that defines the dashboard. This includes dashboard settings, panel settings, layout, queries, and so on."}),(0,t.jsx)(Za.B,{value:vn,language:"json",showMiniMap:!0,showLineNumbers:!0,onBlur:Un,containerStyles:Js.codeEditor}),Lt.meta.canSave&&(0,t.jsx)("div",{children:(0,t.jsx)(a.$n,{type:"submit",onClick:os,children:(0,t.jsx)(p.x6,{i18nKey:"dashboard-settings.json-editor.save-button",children:"Save changes"})})})]})})}const Ea=Lt=>({wrapper:(0,D.css)({display:"flex",height:"100%",flexDirection:"column",gap:Lt.spacing(2)}),codeEditor:(0,D.css)({flexGrow:1})});var cr=e(4588),sn=e(65857);const Ln=({editLinkIdx:Lt,dashboard:Ht,onGoBack:on})=>{const[vn,Un]=(0,n.useState)(Lt!==null?Ht.links[Lt]:cr.q),cs=os=>{const Js=[...Ht.links];Js.splice(Lt,1,os),Ht.links=Js,Un(os)};return(0,t.jsx)(sn.d,{link:vn,onUpdate:cs,onGoBack:on})};var Jn=e(6199);const gs=({dashboard:Lt,onNew:Ht,onEdit:on})=>{const[vn,Un]=(0,n.useState)(Lt.links),cs=(Ss,Ra)=>{Lt.links=xn.moveItemImmutably(vn,Ss,Ss+Ra),Un(Lt.links)},os=Ss=>{Lt.links=[...vn,{...Ss}],Un(Lt.links)},Js=Ss=>{Lt.links=[...vn.slice(0,Ss),...vn.slice(Ss+1)],Un(Lt.links)};return(0,t.jsx)(Jn.X,{links:vn,onNew:Ht,onEdit:on,onDuplicate:os,onDelete:Js,onOrderChange:cs})};function kn({dashboard:Lt,sectionNav:Ht,editIndex:on}){const[vn,Un]=(0,n.useState)(!1),cs=()=>{Un(!1),g.Ny.partial({editIndex:void 0})},os=()=>{Lt.links=[...Lt.links,{...cr.q}],Un(!0),g.Ny.partial({editIndex:Lt.links.length-1})},Js=Oa=>{Un(!1),g.Ny.partial({editIndex:Oa})},Ss=on!==void 0;let Ra=Ht.node.parentItem;return Ss&&(Ra={text:vn?"New link":"Edit link",subTitle:vn?"Create a new link on your dashboard":"Edit a specific link of your dashboard",parentItem:Ht.node.parentItem}),(0,t.jsxs)(d.Y,{navModel:Ht,pageNav:Ra,children:[!Ss&&(0,t.jsx)(gs,{dashboard:Lt,onNew:os,onEdit:Js}),Ss&&(0,t.jsx)(Ln,{dashboard:Lt,editLinkIdx:on,onGoBack:cs})]})}var Gn=e(57714),Gs=e(19626),$s=e(22764),Is=e(56596),pa=e(41053),Ta=e(3169);const ua=async(Lt,Ht)=>(mr.t.ignoreNextSave(),await Gn.wL.restoreDashboard(Ht.uid,Lt)),sr=Lt=>{const Ht=(0,v.useSelector)(cs=>cs.dashboard.getModel()),[on,vn]=(0,pa.A)(async()=>await ua(Lt,Ht),[]),Un=(0,Ta._2)();return(0,n.useEffect)(()=>{if(on.value){const cs=g.Ny.getLocation(),os=s.I.stripBaseFromUrl(on.value.url),Js=cs.state?.routeReloadCounter;g.Ny.replace({...cs,pathname:os,state:{routeReloadCounter:Js?Js+1:1}}),Un.success("Dashboard restored",`Restored from version ${Lt}`)}},[on,Lt,Un]),{state:on,onRestoreDashboard:vn}},ma=({hideModal:Lt,version:Ht})=>{const{state:on,onRestoreDashboard:vn}=sr(Ht);return(0,n.useEffect)(()=>{!on.loading&&on.value&&Lt()},[on,Lt]),(0,t.jsx)(J.u,{isOpen:!0,title:"Restore Version",icon:"history",onDismiss:Lt,onConfirm:vn,body:(0,t.jsxs)("p",{children:["Are you sure you want to restore the dashboard to version ",Ht,"? All unsaved changes will be lost."]}),confirmText:`Yes, restore to version ${Ht}`})},ar=({baseInfo:Lt,newInfo:Ht,diffData:on,isNewLatest:vn})=>{const Un=(0,Is.G4)(on.lhs,on.rhs),cs=(0,P.of)(Ya);return(0,t.jsxs)(o.B,{direction:"column",gap:1,children:[(0,t.jsxs)(o.B,{justifyContent:"space-between",alignItems:"center",children:[(0,t.jsxs)(o.B,{alignItems:"center",children:[(0,t.jsxs)("span",{className:(0,D.cx)(cs.versionInfo,cs.noMarginBottom),children:[(0,t.jsxs)("strong",{children:["Version ",Lt.version]})," updated by ",Lt.createdBy," ",Lt.ageString,Lt.message]}),(0,t.jsx)(T.I,{name:"arrow-right",size:"sm"}),(0,t.jsxs)("span",{className:cs.versionInfo,children:[(0,t.jsxs)("strong",{children:["Version ",Ht.version]})," updated by ",Ht.createdBy," ",Ht.ageString,Ht.message]})]}),vn&&(0,t.jsx)(jt.$s,{children:({showModal:os,hideModal:Js})=>(0,t.jsxs)(a.$n,{variant:"destructive",icon:"history",onClick:()=>{os(ma,{version:Lt.version,hideModal:Js})},children:["Restore to version ",Lt.version]})})]}),Object.entries(Un).map(([os,Js])=>(0,t.jsx)(Gs.D,{diffs:Js,title:os},os)),(0,t.jsx)(En.a,{paddingTop:2,children:(0,t.jsx)(b.M,{isOpen:!1,label:"View JSON Diff",children:(0,t.jsx)($s.M,{oldValue:JSON.stringify(on.lhs,null,2),newValue:JSON.stringify(on.rhs,null,2)})})})]})},Ya=Lt=>({versionInfo:(0,D.css)({color:Lt.colors.text.secondary,fontSize:Lt.typography.bodySmall.fontSize}),noMarginBottom:(0,D.css)({marginBottom:0})});var xr=e(78369);const Sr=({versions:Lt,canCompare:Ht,onCheck:on})=>{const vn=(0,P.of)(Yr);return(0,t.jsx)("div",{className:vn.margin,children:(0,t.jsxs)("table",{className:"filter-table",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"width-4"}),(0,t.jsx)("th",{className:"width-4",children:"Version"}),(0,t.jsx)("th",{className:"width-14",children:"Date"}),(0,t.jsx)("th",{className:"width-10",children:"Updated by"}),(0,t.jsx)("th",{children:"Notes"}),(0,t.jsx)("th",{})]})}),(0,t.jsx)("tbody",{children:Lt.map((Un,cs)=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:(0,t.jsx)(Qe.S,{"aria-label":`Toggle selection of version ${Un.version}`,className:(0,D.css)({display:"inline"}),checked:Un.checked,onChange:os=>on(os,Un.id),disabled:!Un.checked&&Ht})}),(0,t.jsx)("td",{children:Un.version}),(0,t.jsx)("td",{children:Un.createdDateString}),(0,t.jsx)("td",{children:Un.createdBy}),(0,t.jsx)("td",{children:Un.message}),(0,t.jsx)("td",{className:"text-right",children:cs===0?(0,t.jsx)(xr.v,{name:"Latest",colorIndex:17}):(0,t.jsx)(jt.$s,{children:({showModal:os,hideModal:Js})=>(0,t.jsx)(a.$n,{variant:"secondary",size:"sm",icon:"history",onClick:()=>{os(ma,{version:Un.version,hideModal:Js})},children:"Restore"})})})]},Un.id))})]})})};function Yr(Lt){return{margin:(0,D.css)({marginBottom:Lt.spacing(4)})}}const Hr=10;class Rr extends n.PureComponent{constructor(Ht){super(Ht),this.getVersions=(on=!1)=>{this.setState({isAppending:on}),Gn.wL.getHistoryList(this.props.dashboard.uid,{limit:this.limit,start:this.start}).then(vn=>{this.setState({isLoading:!1,versions:[...this.state.versions,...this.decorateVersions(vn)]}),this.start+=this.limit}).catch(vn=>console.log(vn)).finally(()=>this.setState({isAppending:!1}))},this.getDiff=async()=>{const on=this.state.versions.filter(Ss=>Ss.checked),[vn,Un]=on,cs=vn.version===this.props.dashboard.version;this.setState({isLoading:!0});const os=await Gn.wL.getDashboardVersion(this.props.dashboard.uid,Un.version),Js=await Gn.wL.getDashboardVersion(this.props.dashboard.uid,vn.version);this.setState({baseInfo:Un,isLoading:!1,isNewLatest:cs,newInfo:vn,viewMode:"compare",diffData:{lhs:os.data,rhs:Js.data}})},this.decorateVersions=on=>on.map(vn=>({...vn,createdDateString:this.props.dashboard.formatDate(vn.created),ageString:this.props.dashboard.getRelativeTime(vn.created),checked:!1})),this.onCheck=(on,vn)=>{this.setState({versions:this.state.versions.map(Un=>Un.id===vn?{...Un,checked:on.currentTarget.checked}:Un)})},this.reset=()=>{this.setState({baseInfo:void 0,diffData:{lhs:"",rhs:""},isNewLatest:!1,newInfo:void 0,versions:this.state.versions.map(on=>({...on,checked:!1})),viewMode:"list"})},this.limit=Hr,this.start=0,this.state={isAppending:!0,isLoading:!0,versions:[],viewMode:"list",isNewLatest:!1,diffData:{lhs:"",rhs:""}}}componentDidMount(){this.getVersions()}isLastPage(){return this.state.versions.find(Ht=>Ht.version===1)}render(){const{versions:Ht,viewMode:on,baseInfo:vn,newInfo:Un,isNewLatest:cs,isLoading:os,diffData:Js}=this.state,Ss=Ht.filter(Ia=>Ia.checked).length===2,Ra=Ht.length>1,Oa=Ht.length>=this.limit,ss=this.props.sectionNav.node.parentItem;return on==="compare"?(0,t.jsxs)(d.Y,{navModel:this.props.sectionNav,pageNav:ss,children:[(0,t.jsx)(Gn.me,{onClick:this.reset,baseVersion:vn?.version,newVersion:Un?.version,isNewLatest:cs}),os?(0,t.jsx)(lo,{msg:"Fetching changes\u2026"}):(0,t.jsx)(ar,{newInfo:Un,baseInfo:vn,isNewLatest:cs,diffData:Js})]}):(0,t.jsxs)(d.Y,{navModel:this.props.sectionNav,pageNav:ss,children:[os?(0,t.jsx)(lo,{msg:"Fetching history list\u2026"}):(0,t.jsx)(Sr,{versions:Ht,onCheck:this.onCheck,canCompare:Ss}),this.state.isAppending&&(0,t.jsx)(lo,{msg:"Fetching more entries\u2026"}),Ra&&(0,t.jsx)(Gn.rJ,{hasMore:Oa,canCompare:Ss,getVersions:this.getVersions,getDiff:this.getDiff,isLastPage:!!this.isLastPage()})]})}}const lo=({msg:Lt})=>(0,t.jsxs)(M.Gy,{children:[(0,t.jsx)(O.y,{}),(0,t.jsx)("em",{children:Lt})]}),Bo=()=>g.Ny.partial({editview:null,editIndex:null});function po({dashboard:Lt,editview:Ht,pageNav:on,sectionNav:vn}){const[Un,cs]=(0,n.useState)(0);(0,n.useEffect)(()=>{Lt.events.subscribe(l.Cf,()=>cs(ur=>ur+1))},[Lt]);const os=(0,n.useMemo)(()=>vr(Lt),[Lt,Un]),Js=()=>{Lt.meta.hasUnsavedFolderChange=!1},Ss=os.find(ur=>ur.id===Ht)??os[0],Ra=m.TP.hasEditPermissionInFolders,Oa=Lt.meta.canSave,ss=(0,i.zy)(),Ia=Eo(ss),Cr=Er(on,vn,os,Ss,ss,Lt.uid),Dr="sm",dr=[(0,t.jsx)(a.$n,{"data-testid":r.Tp.pages.Dashboard.Settings.Actions.close,variant:"secondary",fill:"outline",size:Dr,onClick:Bo,children:"Close"},"close"),Ra&&(0,t.jsx)(zt.m,{dashboard:Lt,onSaveSuccess:Js,variant:"secondary",size:Dr},"save as"),Oa&&(0,t.jsx)(zt.C,{dashboard:Lt,onSaveSuccess:Js,size:Dr},"Save")];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(f.H,{actions:(0,t.jsx)(c.U,{alignment:"right",children:dr})}),(0,t.jsx)(Ss.component,{sectionNav:Cr,dashboard:Lt,editIndex:Ia})]})}function vr(Lt){const Ht=[],on=(0,p.t)("dashboard-settings.general.title","General");Lt.meta.canEdit&&(Ht.push({title:on,id:"settings",icon:"sliders-v-alt",component:$a}),Ht.push({title:(0,p.t)("dashboard-settings.annotations.title","Annotations"),id:"annotations",icon:"comment-alt",component:ln,subTitle:"Annotation queries return events that can be visualized as event markers in graphs across the dashboard."}),Ht.push({title:(0,p.t)("dashboard-settings.variables.title","Variables"),id:"templating",icon:"calculator-alt",component:nt,subTitle:"Variables can make your dashboard more dynamic and act as global filters."}),Ht.push({title:(0,p.t)("dashboard-settings.links.title","Links"),id:"links",icon:"link",component:kn})),Lt.meta.canMakeEditable&&Ht.push({title:on,icon:"sliders-v-alt",id:"settings",component:Qo}),Lt.id&&Lt.meta.canSave&&Ht.push({title:(0,p.t)("dashboard-settings.versions.title","Versions"),id:"versions",icon:"history",component:Rr});const vn=(0,p.t)("dashboard-settings.permissions.title","Permissions");return Lt.id&&Lt.meta.canAdmin&&m.TP.hasPermission(v.AccessControlAction.DashboardsPermissionsRead)&&Ht.push({title:vn,id:"permissions",icon:"lock",component:St}),Ht.push({title:(0,p.t)("dashboard-settings.json-editor.title","JSON Model"),id:"dashboard_json",icon:"arrow",component:Va}),Ht}function Ur(Lt,Ht){return{...Lt,parentItem:Lt.parentItem?Ur(Lt.parentItem,Ht):Ht}}function Er(Lt,Ht,on,vn,Un,cs){const os={text:(0,p.t)("dashboard-settings.settings.title","Settings"),children:[],icon:"apps",hideFromBreadcrumbs:!1,url:s.I.getUrlForPartial(Un,{editview:"settings",editIndex:null})};os.children=on.map(Ss=>({text:Ss.title,icon:Ss.icon,id:`${cs}/${Ss.id}`,url:s.I.getUrlForPartial(Un,{editview:Ss.id,editIndex:null}),active:Ss===vn,parentItem:os,subTitle:Ss.subTitle}));const Js=Ur(Lt,Ht.main);return os.parentItem=Js,{main:os,node:os.children.find(Ss=>Ss.active)}}function Qo({dashboard:Lt,sectionNav:Ht}){return(0,t.jsx)(d.Y,{navModel:Ht,children:(0,t.jsxs)(o.B,{direction:"column",gap:2,alignItems:"flex-start",children:[(0,t.jsx)(h.E,{variant:"h3",children:"Dashboard not editable"}),(0,t.jsx)(a.$n,{type:"submit",onClick:()=>Lt.makeEditable(),children:"Make editable"})]})})}function Eo(Lt){const Ht=new URLSearchParams(Lt.search).get("editIndex");if(Ht!=null)return parseInt(Ht,10)}},10740:(k,R,e)=>{"use strict";e.d(R,{n:()=>V,C:()=>K});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(55852),g=e(94753),a=e(60782),c=e(62930),o=e(56034),h=e(42418),f=e(67061),d=e(10354),p=e(14578),m=e(72109),v=e(8484),l=e(29158);const y=({currentPage:Y,numberOfPages:X,onNavigate:J,hideWhenSinglePage:q,className:ae})=>{const j=(0,s.of)(u);return q&&X<=1?null:(0,t.jsxs)("div",{className:(0,n.cx)(j.wrapper,ae),children:[(0,t.jsx)(l.K,{name:"angle-left",size:"md",tooltip:"Previous",onClick:()=>J(Y-1),disabled:Y===1}),Y," of ",X,(0,t.jsx)(l.K,{name:"angle-right",size:"md",tooltip:"Next",onClick:()=>J(Y+1),disabled:Y===X})]})},u=Y=>({wrapper:(0,n.css)({display:"flex",flexDirection:"row",gap:16,userSelect:"none"})}),D=({history:Y,index:X,onNavigate:J})=>{const q=(0,s.of)(E),ae=Y.length;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:q.contentWrapper,children:(0,t.jsx)(g.E,{element:"p",color:"secondary",children:Y[X-1]})}),(0,t.jsx)(y,{currentPage:X,numberOfPages:ae,onNavigate:J,hideWhenSinglePage:!1,className:q.paginationWrapper})]})},E=Y=>({paginationWrapper:(0,n.css)({display:"flex",flexDirection:"row",justifyContent:"flex-end",marginTop:15}),contentWrapper:(0,n.css)({display:"flex",flexBasis:"100%",flexGrow:3,whiteSpace:"pre-wrap",maxHeight:110,overflowY:"scroll",backgroundColor:Y.colors.background.secondary,border:`1px solid ${Y.colors.border.weak}`,padding:Y.spacing(1),minHeight:60})});var x=e(3363);const P=({onSuggestionClick:Y,isGenerating:X})=>{const J=(0,s.of)(b);return(0,t.jsxs)("div",{className:J.quickSuggestionsWrapper,children:[(0,t.jsx)(r.$n,{onClick:()=>Y(x.HG.Shorter),size:"sm",variant:"secondary",icon:"paragraph",disabled:X,children:x.HG.Shorter}),(0,t.jsx)(r.$n,{onClick:()=>Y(x.HG.MoreDescriptive),size:"sm",variant:"secondary",icon:"document-layout-left",disabled:X,children:x.HG.MoreDescriptive}),(0,t.jsx)(r.$n,{onClick:()=>Y(x.HG.Regenerate),icon:"sync",size:"sm",variant:"secondary",disabled:X,children:"Regenerate"})]})},b=Y=>({quickSuggestionsWrapper:(0,n.css)({display:"flex",flexDirection:"row",gap:8})});var M=e(16817),O=e(65418),I=e(34867),T=e(3169);const C=(0,I.DW)("features.dashboards.genai");var S=(Y=>(Y.IDLE="idle",Y.GENERATING="generating",Y.COMPLETED="completed",Y))(S||{});const A=1e4,L={model:x.C4,temperature:1};function N({model:Y,temperature:X,onResponse:J}=L){const[q,ae]=(0,i.useState)([]),[j,te]=(0,i.useState)(""),[ne,le]=(0,i.useState)("idle"),[z,ee]=(0,i.useState)(),{error:se}=(0,T._2)();let ie="";const Z=(0,i.useCallback)(De=>{le("idle"),ae([]),ee(De),se("Failed to generate content using OpenAI","Please try again or if the problem persists, contact your organization admin."),console.error(De),C.logError(De,{messages:JSON.stringify(q),model:Y,temperature:String(X)})},[q,Y,X,se]);(0,i.useEffect)(()=>{q.length>0&&te("")},[q]);const{error:oe,value:ce}=(0,M.A)(async()=>await(0,x.QX)(),[x.QX]),{error:ye,value:re}=(0,M.A)(async()=>{if(!ce||!q.length)return{enabled:ce};le("generating"),ee(void 0);const De=O.qH({model:Y,temperature:X,messages:q}).pipe(O.qA());return{enabled:ce,stream:De.subscribe({next:ge=>{ie=ge},error:Z,complete:()=>{te(ie),le("completed"),J?.(ie),ae([]),ee(void 0)}})}},[q,ce]);(0,i.useEffect)(()=>()=>{re?.stream?.unsubscribe()},[re]);const ue=(0,i.useCallback)(()=>{re?.stream?.unsubscribe(),le("idle"),ee(void 0),ae([])},[re]);return(0,i.useEffect)(()=>{let De;return ne==="generating"&&j===""&&(De=setTimeout(()=>{Z(new Error(`OpenAI stream timed out after ${A}ms`))},A)),()=>{clearTimeout(De)}},[ne,j,Z]),(ye||oe)&&ee(ye||oe),{setMessages:ae,stopGeneration:ue,messages:q,reply:j,streamStatus:ne,error:z,value:re}}var F=e(57725);const w=.5,B=({eventTrackingSrc:Y,history:X,messages:J,onApplySuggestion:q,updateHistory:ae})=>{const j=(0,s.of)(U),[te,ne]=(0,i.useState)(1),[le,z]=(0,i.useState)(""),ee=(0,i.useCallback)(Ue=>{ae((0,x.Kb)(Ue))},[ae]),{setMessages:se,stopGeneration:ie,reply:Z,streamStatus:oe,error:ce}=N({model:x.C4,temperature:w,onResponse:ee}),ye=(Ue,$e)=>(0,F.XX)(Y,Ue,$e),re=Ue=>{Te(Ue),ye(F.KR.customFeedback,{customFeedback:Ue})},ue=()=>{ie(),Z&&ee(Z)},De=()=>{q(X[te-1])},ge=Ue=>{ne(Ue),ye(Ue>te?F.KR.backHistoryItem:F.KR.forwardHistoryItem)},Te=Ue=>{se($e=>[...$e,...(0,x.To)(X[te-1],Ue)]),Ue in x.HG&&ye(F.KR.quickFeedback,{quickFeedbackItem:Ue})},Le=Ue=>Ue.key==="Enter"&&re(le),Ye=Ue=>z(Ue.currentTarget.value),je=()=>re(le),Ze=()=>ye(F.KR.linkToDocs),Ne=oe===S.GENERATING,Pe=ce&&!Ne;return(0,t.jsxs)("div",{className:j.container,children:[Pe&&(0,t.jsx)(h.F,{title:"",children:(0,t.jsx)(f.B,{direction:"column",children:(0,t.jsx)("p",{children:(0,t.jsx)(v.x6,{i18nKey:"gen-ai.incomplete-request-error",children:"Sorry, I was unable to complete your request. Please try again."})})})}),(0,t.jsx)(D,{history:X,index:te,onNavigate:ge}),(0,t.jsx)("div",{className:j.actionButtons,children:(0,t.jsx)(P,{onSuggestionClick:Te,isGenerating:Ne})}),(0,t.jsx)(d.p,{placeholder:"Tell AI what to do next...",suffix:(0,t.jsx)(r.$n,{icon:"enter",variant:"secondary",fill:"text","aria-label":"Send custom feedback",onClick:je,disabled:!le,children:(0,t.jsx)(v.x6,{i18nKey:"gen-ai.send-custom-feedback",children:"Send"})}),value:le,onChange:Ye,onKeyDown:Le}),(0,t.jsx)("div",{className:j.applySuggestion,children:(0,t.jsx)(f.B,{justifyContent:"flex-end",direction:"row",children:Ne?(0,t.jsx)(r.$n,{icon:"fa fa-spinner",onClick:ue,children:K}):(0,t.jsx)(r.$n,{icon:"check",onClick:De,children:(0,t.jsx)(v.x6,{i18nKey:"gen-ai.apply-suggestion",children:"Apply"})})})}),(0,t.jsxs)("div",{className:j.footer,children:[(0,t.jsx)(p.I,{name:"exclamation-circle","aria-label":"exclamation-circle",className:j.infoColor}),(0,t.jsxs)(g.E,{variant:"bodySmall",color:"secondary",children:["This content is AI-generated using the"," ",(0,t.jsx)(m.Y,{variant:"bodySmall",inline:!0,href:"https://grafana.com/docs/grafana-cloud/alerting-and-irm/machine-learning/llm-plugin/",external:!0,onClick:Ze,children:"Grafana LLM plugin"})]})]})]})},U=Y=>({container:(0,n.css)({display:"flex",flexDirection:"column",width:520,maxHeight:350,paddingBottom:25}),applySuggestion:(0,n.css)({paddingTop:Y.spacing(2)}),actions:(0,n.css)({display:"flex",flexDirection:"row",flexWrap:"wrap"}),footer:(0,n.css)({position:"absolute",bottom:0,left:0,width:"100%",display:"flex",flexDirection:"row",margin:0,padding:Y.spacing(1),paddingLeft:Y.spacing(2),alignItems:"center",gap:Y.spacing(1),borderTop:`1px solid ${Y.colors.border.weak}`,marginTop:Y.spacing(2)}),infoColor:(0,n.css)({color:Y.colors.info.main}),actionButtons:(0,n.css)({display:"flex",flexDirection:"row",justifyContent:"space-between",padding:"24px 0 8px 0"})}),K="Stop generating",V=({text:Y="Auto-generate",toggleTipTitle:X="",onClick:J,model:q=x.C4,messages:ae,onGenerate:j,temperature:te=1,eventTrackingSrc:ne,disabled:le,tooltip:z})=>{const ee=(0,s.of)(H),[se,ie]=(0,i.useState)([]),Z=(0,i.useCallback)(Ve=>{ie(pe=>[Ve,...pe])},[]),oe=(0,i.useCallback)(Ve=>{const pe=(0,x.Kb)(Ve);j(pe),Z(pe)},[j,Z]),{setMessages:ce,stopGeneration:ye,value:re,error:ue,streamStatus:De}=N({model:q,temperature:te,onResponse:oe}),[ge,Te]=(0,i.useState)(!1),Le=se.length>0,Ye=!Le,je=De===S.GENERATING,Ze=le||re&&!re.enabled&&!ue,Ne=(0,i.useCallback)(Ve=>(0,F.XX)(ne,Ve),[ne]),Pe=ue||z?void 0:!1,Ue=ue?"Failed to generate content using OpenAI. Please try again or if the problem persists, contact your organization admin.":z||"",$e=Ve=>{De===S.GENERATING?ye():Le?Te(!0):(J?.(Ve),ce(yt()));const pe=ue?F.KR.erroredRetryButton:je?F.KR.stopGenerationButton:Ye?F.KR.autoGenerateButton:F.KR.improveButton;Ne(pe)};if(!re?.enabled)return null;const ze=Ve=>{Ne(F.KR.applySuggestion),j(Ve),Te(!1)},qe=()=>{if(!je)return ue||re&&!re.enabled?"exclamation-circle":"ai"},dt=()=>{let Ve=Y;return ue&&(Ve="Retry"),je&&(Ve=K),Le&&(Ve="Improve"),Ve},vt=(0,t.jsx)(r.$n,{icon:qe(),onClick:$e,fill:"text",size:"sm",disabled:Ze,variant:ue?"destructive":"primary",children:dt()}),yt=()=>typeof ae=="function"?ae():ae,st=()=>{if(Le){const Ve=(0,t.jsx)(g.E,{element:"p",children:X});return(0,t.jsx)(a.G,{title:Ve,content:(0,t.jsx)(B,{history:se,messages:yt(),onApplySuggestion:ze,updateHistory:Z,eventTrackingSrc:ne}),placement:"left-start",fitContent:!0,show:ge,onClose:()=>Te(!1),onOpen:()=>Te(!0),children:vt})}return vt};return(0,t.jsxs)("div",{className:ee.wrapper,children:[je&&(0,t.jsx)(c.y,{size:"sm",className:ee.spinner}),Ye?(0,t.jsx)(o.m,{show:Pe,interactive:!0,content:Ue,children:vt}):st()]})},H=Y=>({wrapper:(0,n.css)({display:"flex"}),spinner:(0,n.css)({color:Y.colors.text.link})})},81394:(k,R,e)=>{"use strict";e.d(R,{V:()=>c});var t=e(74848),n=e(14792),i=e(10740),s=e(57725),r=e(3363);const a=`You are an expert in creating Grafana Dashboards.
Your goal is to write a descriptive and concise dashboard description.
You will be given the title and description of the dashboard's panels.
The dashboard description is meant to explain the purpose of the dashboard and what its panels show.
If the dashboard has no panels, the description should be "Empty dashboard"
There should be no numbers in the description except where they are important.
The dashboard description should not have the dashboard title or any quotation marks in it.
The description should be, at most, 300 characters.
Respond with only the description of the dashboard.`,c=({onGenerate:h})=>{const f=(0,n.UA)().getCurrent(),d=(0,r.N3)(f);return(0,t.jsx)(i.n,{messages:o(f),onGenerate:h,eventTrackingSrc:s.ec.dashboardDescription,toggleTipTitle:"Improve your dashboard description",disabled:d.length===0,tooltip:d.length===0?r.ZN:void 0})};function o(h){return[{content:a,role:r.Xh.system},{content:`The title of the dashboard is "${h.title}"
${(0,r.BB)(h)}`,role:r.Xh.user}]}},27966:(k,R,e)=>{"use strict";e.d(R,{Z:()=>c});var t=e(74848),n=e(14792),i=e(10740),s=e(57725),r=e(3363);const a=`You are an expert in creating Grafana Dashboards.
Your goal is to write a concise dashboard title.
You will be given the title and description of the dashboard's panels.
The dashboard title is meant to say what it shows on one line for users to navigate to it.
If the dashboard has no panels, the title should be "Empty dashboard"
There should be no numbers in the title.
The dashboard title should not have quotation marks in it.
The title should be, at most, 50 characters.
Respond with only the title of the dashboard.`,c=({onGenerate:h})=>{const f=(0,n.UA)().getCurrent(),d=(0,r.N3)(f);return(0,t.jsx)(i.n,{messages:o(f),onGenerate:h,eventTrackingSrc:s.ec.dashboardTitle,toggleTipTitle:"Improve your dashboard title",disabled:d.length===0,tooltip:d.length===0?r.ZN:void 0})};function o(h){return[{content:a,role:r.Xh.system},{content:`The panels in the dashboard are: ${(0,r.BB)(h)}`,role:r.Xh.user}]}},20214:(k,R,e)=>{"use strict";e.d(R,{t:()=>c});var t=e(74848),n=e(14792),i=e(10740),s=e(57725),r=e(3363);const a=`You are an expert in creating Grafana Panels.
You will be given the title and description of the dashboard the panel is in as well as the JSON for the panel.
Your goal is to write a descriptive and concise panel description.
The panel description is meant to explain the purpose of the panel, not just its attributes.
Do not refer to the panel; simply describe its purpose.
There should be no numbers in the description except for thresholds.
The description should be, at most, 200 characters.`,c=({onGenerate:h,panel:f})=>(0,t.jsx)(i.n,{messages:()=>o(f),onGenerate:h,eventTrackingSrc:s.ec.panelDescription,toggleTipTitle:"Improve your panel description"});function o(h){const f=(0,n.UA)().getCurrent(),d=(0,r.hn)(h);return[{content:a,role:r.Xh.system},{content:`The panel is part of a dashboard with the title: ${f.title}
The panel is part of a dashboard with the description: ${f.description}
This is the JSON which defines the panel: ${d}`,role:r.Xh.user}]}},74410:(k,R,e)=>{"use strict";e.d(R,{h:()=>a});var t=e(74848),n=e(10740),i=e(57725),s=e(3363);const g="You are an expert in creating Grafana Panels.Your goal is to write short, descriptive, and concise panel title.The title should be shorter than 50 characters.",a=({onGenerate:o,panel:h,dashboard:f})=>(0,t.jsx)(n.n,{messages:()=>c(h,f),onGenerate:o,eventTrackingSrc:i.ec.panelTitle,toggleTipTitle:"Improve your panel title"});function c(o,h){const f=(0,s.hn)(o);return[{content:g,role:s.Xh.system},{content:`The panel is part of a dashboard with the title: ${h.title}
The panel is part of a dashboard with the description: ${h.description}
Use this JSON object which defines the panel: ${f}`,role:s.Xh.user}]}},57725:(k,R,e)=>{"use strict";e.d(R,{KR:()=>s,XX:()=>r,ec:()=>i});var t=e(14110);const n="dashboards_autogenerate_clicked";var i=(g=>(g.panelDescription="panel-description",g.panelTitle="panel-title",g.dashboardChanges="dashboard-changes",g.dashboardTitle="dashboard-title",g.dashboardDescription="dashboard-description",g.unknown="unknown",g))(i||{}),s=(g=>(g.autoGenerateButton="auto-generate-button",g.erroredRetryButton="errored-retry-button",g.stopGenerationButton="stop-generating-button",g.improveButton="improve-button",g.backHistoryItem="back-history-item",g.forwardHistoryItem="forward-history-item",g.quickFeedback="quick-feedback",g.linkToDocs="link-to-docs",g.customFeedback="custom-feedback",g.applySuggestion="apply-suggestion",g))(s||{});function r(g,a,c){(0,t.rR)(n,{src:g,item:a,...c})}},3363:(k,R,e)=>{"use strict";e.d(R,{ZN:()=>I,C4:()=>u,HG:()=>y,Xh:()=>l,Yy:()=>E,BB:()=>M,To:()=>b,hn:()=>O,N3:()=>T,QX:()=>P,Kb:()=>D});var t=e(2543),n=e(65418),i=e(32264),s=e(36974),r=e(90254),g=e(34214);function a(S,A){return S===A?A:Array.isArray(S)&&Array.isArray(A)?h(S,A):c(S)&&c(A)?o(S,A):A}function c(S){return typeof S=="object"&&!Array.isArray(S)&&S!==null}function o(S,A){const L=Object.keys(S),N={};for(const F of L)A.hasOwnProperty(F)&&(Array.isArray(S[F])&&Array.isArray(A[F])||typeof S[F]=="object"&&typeof A[F]=="object"?N[F]=a(S[F],A[F]):N[F]=A[F]);return N}function h(S,A){const L=new Array(S.length).fill(void 0),N=new Set([...Array(S.length).keys()]),F=new Set([...Array(A.length).keys()]);for(let w=0;w<S.length&&F.size!==0;w++){let B=S[w];for(let U=0;U<A.length;U++){if(!F.has(U))continue;let K=A[U];K=a(B,K),JSON.stringify(B)===JSON.stringify(K)&&(N.delete(w),F.delete(U),L[w]=K)}}return f(S,A,L,N,F),L.filter(w=>w!==void 0)}function f(S,A,L,N,F){let w={};F.forEach(U=>{let K=A[U];if(typeof K!="object"||Array.isArray(K)){L.push(K),F.delete(U);return}N.forEach(V=>{let H=S[V];if(typeof H!="object"||Array.isArray(H)){N.delete(V);return}let Y=0;for(const X in H){let J=H[X];if(!K.hasOwnProperty(X))continue;let q=K[X];typeof J!="string"&&typeof J!="number"||typeof J!=typeof q||J===q&&(X==="id"&&(Y+=1e3),Y++)}Y!==0&&(w[Y]===void 0&&(w[Y]=[]),w[Y].push([V,U]))})});const B=Object.keys(w).map(Number);B.sort((U,K)=>K-U);for(const U of B){let K=w[U];for(const V of K){const[H,Y]=V;N.has(H)&&F.has(Y)&&(L[H]=A[Y],N.delete(H),F.delete(Y))}}for(const U of F)L.push(A[U])}function d(S){const A=S.split(`
`);let L=S[0].startsWith("Index")?4:3,N=A.slice(0,L);const F=/("title"|Title|\{|\}|\[|\])/i;for(let w=L;w<A.length;w++){let B=A[w];(F.test(B)||B.startsWith("+")||B.startsWith("-"))&&N.push(B)}return N.join(`
`)+`
`}function p(S){if(S===null||S==="")return null;if(Array.isArray(S)){const L=S.map(N=>p(N)).filter(N=>N!==null);return L.length>0?L:null}if(typeof S!="object")return S;const A={};for(const L in S){const N=p(S[L]);if(N!==null){if(Array.isArray(N)&&N.length===0||typeof N=="object"&&Object.keys(N).length===0)continue;A[L]=N}}return Object.keys(A).length>0?A:null}function m(S){return JSON.parse(JSON.stringify(S,null,2))}function v(S){let A=m(S.getOriginalDashboard()),L=m(new g.G(A).getSaveModelClone()),N=m(S.getSaveModelClone());L=p(a(A,L)),N=p(a(L,N)),A=p(A);let F=(0,r.ss)("Before migration changes","After migration changes",JSON.stringify(A,null,2),JSON.stringify(L,null,2),"","",{context:20}),w=(0,r.ss)("Before user changes","After user changes",JSON.stringify(L,null,2),JSON.stringify(N,null,2),"","",{context:20});return F=d(F),w=d(w),{migrationDiff:F,userDiff:w}}var l=(S=>(S.system="system",S.user="user",S))(l||{}),y=(S=>(S.Shorter="Even shorter",S.MoreDescriptive="More descriptive",S.Regenerate="Please, regenerate",S))(y||{});const u="gpt-4",D=S=>S.replace(/^"|"$/g,"");function E(S){const{migrationDiff:A,userDiff:L}=v(S);return{userChanges:L,migrationChanges:A}}let x;async function P(){return i.$.apps["grafana-llm-app"]?x||(x=new Promise(S=>{n.vK().then(A=>{A.ok||(x=void 0),S(A.ok)})}),x):!1}const b=(S,A)=>[{role:"system",content:`Your previous response was: ${S}. The user has provided the following feedback: ${A}. Re-generate your response according to the provided feedback.`}];function M(S){const A=T(S);let L;if(A.length<=10)L=`The panels in the dashboard are:
${A.join(`
`)}`;else{const N=S.panels.filter(B=>B.description),F=S.panels.filter(B=>!B.description);let w;N.length>=10?w=N.slice(10).map(C).join(`
`):(w=N.map(C).join(`
`),w+=`
`,w+=F.slice(10-N.length).map(C).join("n")),L=`There are ${A.length} panels.
Due to space constraints, only the information for ten of them is presented.
These ten are not necessarily the first ten, but prioritized to those with descriptions.
The panels in the dashboard are:
${w}`}return L}function O(S){const A=["datasource","title","description","targets","type"],L={...(0,t.pick)(S,A),options:(0,t.pick)(S.options,["content"])};return JSON.stringify(L,null,2)}const I="To generate this content your dashboard must contain at least one panel with a valid title or description.";function T(S){return S.panels.filter(L=>L.title.length>0&&L.title!==s.LH||L.description&&L.description.length>0).map(C)}const C=(S,A)=>`- Panel ${A}
- Title: ${S.title}${S.description?`
- Description: ${S.description}`:""}`},18803:(k,R,e)=>{"use strict";e.d(R,{B6:()=>f,E_:()=>p,jD:()=>d});var t=e(2543),n=e.n(t),i=e(72985),s=e(89667),r=e(52622),g=e(72724),a=e(39070),c=e(32264),o=e(41524),h=e(68706);function f(u){const D=[];if(u?.series)for(const E of u.series)D.push((0,s.Nw)(E));if(u?.annotations)for(const E of u.annotations){const x=(0,s.Nw)(E);x.schema?.meta||(x.schema.meta={}),x.schema.meta.dataTopic=r.QR.Annotations,D.push(x)}return D}function d(u,D){const E=u.getSaveModel(),x={panelType:E.type,datasource:"??"},P=c.$.buildInfo.versionString;let b=`| Key | Value |
|--|--|
| Panel | ${x.panelType} @ ${E.pluginVersion??P} |
| Grafana | ${P} // ${c.$.buildInfo.edition} |
`;return D&&(b+="<details><summary>Panel debug snapshot dashboard</summary>\n\n```json\n"+D+"\n```\n</details>"),b}async function p(u,D,E){const x=u.getSaveModel(),P=(0,t.cloneDeep)(y),b={panelType:x.type,datasource:"??"},M=await(0,i._)(u.getQueryRunner().getData({withFieldConfig:!1,withTransforms:!1})),O=u.datasource,I=(0,o.W)(f(M),D),T=c.$.buildInfo.versionString,C=x?.targets??[],S=`<table width="100%">
    <tr>
      <th width="2%">Panel</th>
      <td >${b.panelType} @ ${x.pluginVersion??T}</td>
    </tr>
    <tr>
      <th>Queries</th>
      <td>${C.map(A=>{const L=A.datasource??O;return`${A.refId}[${L?.type}]`}).join(", ")}</td>
    </tr>
    ${m(x)}
    ${v(M,I)}
    ${l(M)}
    <tr>
      <th>Grafana</th>
      <td>${T} // ${c.$.buildInfo.edition}</td>
    </tr>
  </table>`.trim();if(P.panels[0]={...x,...P.panels[0],targets:[{refId:"A",datasource:{type:"grafana",uid:"grafana"},queryType:h.nj.Snapshot,snapshot:I}]},x.transformations?.length){const A=P.panels[P.panels.length-1];A.title=A.title+" (after transformations)";const L=(0,t.cloneDeep)(A);L.id=100,L.title="Data (before transformations)",L.gridPos.w=24,L.targets[0].withTransforms=!1,P.panels.push(L)}return M.annotations?.length&&P.panels.push({id:7,gridPos:{h:6,w:24,x:0,y:20},type:"table",title:"Annotations",datasource:{type:"datasource",uid:"-- Dashboard --"},options:{showTypeIcons:!0},targets:[{datasource:{type:"datasource",uid:"-- Dashboard --"},panelId:2,withTransforms:!0,topic:r.QR.Annotations,refId:"A"}]}),P.panels[1].options.content=S,P.panels[2].options.content=JSON.stringify(x,null,2),P.title=`Debug: ${x.title} // ${(0,g.LE)(new Date)}`,P.tags=["debug",`debug-${b.panelType}`],P.time={from:E.from.toISOString(),to:E.to.toISOString()},P}function m(u){return u.transformations?`<tr>
      <th>Transform</th>
      <td>${u.transformations.map(D=>D.id).join(", ")}</td>
  </tr>`:""}function v(u,D){let E=u.series.length??0,x=0,P=0;for(const b of u.series)x+=b.fields.length,P+=b.length;return`<tr><th>Data</th><td>${u.state!==a.Gu.Done?u.state:""} ${E} frames, ${x} fields, ${P} rows </td></tr>`}function l(u){return u.annotations?.length?`<tr>
  <th>Annotations</th>
  <td>${u.annotations.map((D,E)=>`<span>${D.length}</span>`)}</td>
</tr>`:""}const y={panels:[{id:2,title:"Reproduced with embedded data",datasource:{type:"grafana",uid:"grafana"},gridPos:{h:13,w:15,x:0,y:0}},{gridPos:{h:7,w:9,x:15,y:0},id:5,options:{content:"...",mode:"html"},title:"Debug info",type:"text"},{id:6,title:"Original Panel JSON",type:"text",gridPos:{h:13,w:9,x:15,y:7},options:{content:"...",mode:"code",code:{language:"json",showLineNumbers:!0,showMiniMap:!0}}},{id:3,title:"Data from panel above",type:"table",datasource:{type:"datasource",uid:"-- Dashboard --"},gridPos:{h:7,w:15,x:0,y:13},options:{showTypeIcons:!0},targets:[{datasource:{type:"datasource",uid:"-- Dashboard --"},panelId:2,withTransforms:!0,refId:"A"}]}],schemaVersion:37}},65123:(k,R,e)=>{"use strict";e.d(R,{BN:()=>c,kx:()=>o,sd:()=>a});var t=e(96540),n=e(24705),i=e(19347),s=e(8484),r=e(16560),g=e(54612);const a=h=>(0,n.A)(async()=>c(h),[h]).value;async function c(h){const f=h?.request?.targets||[];if(h&&h.series&&f.length){for(const d of h.series)if(d.meta&&d.meta.custom){const p=await(0,i.l)().get(f[0].datasource);if(p&&p.components?.MetadataInspector)return p}}}const o=(h,f,d,p,m)=>(0,t.useMemo)(()=>{const v=[];return(0,g.$)(d)&&(v.push({label:(0,s.t)("dashboard.inspect.data-tab","Data"),value:r.q.Data}),v.push({label:(0,s.t)("dashboard.inspect.stats-tab","Stats"),value:r.q.Stats})),m&&v.push({label:(0,s.t)("dashboard.inspect.meta-tab","Meta data"),value:r.q.Meta}),v.push({label:(0,s.t)("dashboard.inspect.json-tab","JSON"),value:r.q.JSON}),p&&v.push({label:(0,s.t)("dashboard.inspect.error-tab","Error"),value:r.q.Error}),f.meta.canEdit&&(0,g.$)(d)&&v.push({label:(0,s.t)("dashboard.inspect.query-tab","Query"),value:r.q.Query}),v},[d,m,f,p])},57755:(k,R,e)=>{"use strict";e.d(R,{D:()=>d});var t=e(74848),n=e(32196),i=e(96540),s=e(78685),r=e(13544),g=e(53402),a=e(40845),c=e(55852),o=e(83277),h=e(53466);const f="showCategory",d=i.memo(({id:v,title:l,children:y,forceOpen:u,isOpenDefault:D=!0,renderTitle:E,className:x,itemsCount:P,isNested:b=!1,sandboxId:M})=>{const[O,I]=(0,s.A)(m(v),{isExpanded:D}),[T,C]=(0,i.useState)(O?.isExpanded??D),S=(0,i.useRef)(0),A=(0,i.useRef)(null),[L,N]=(0,o.s)(),F=L[f]===v;(0,i.useEffect)(()=>{S.current&&Date.now()-S.current<200||(F||u)&&(T||C(!0),F&&A.current?.scrollIntoView())},[u,T,F]);const w=(0,i.useCallback)(()=>{S.current=Date.now(),N({[f]:T?void 0:v},!0),I({isExpanded:!T}),C(!T)},[I,C,N,T,v]);E||(E=function(Y){return Y||P===void 0||P===0?l:(0,t.jsxs)("span",{children:[l," ",(0,t.jsx)(g.p,{value:P})]})});const B=(0,a.of)(p),U=(0,n.cx)({[B.box]:!0,[B.boxNestedExpanded]:b&&T},x),K=(0,n.cx)(B.header,{[B.headerExpanded]:T,[B.headerNested]:b}),V=(0,n.cx)(B.body,{[B.bodyNested]:b});return(0,t.jsxs)("div",{className:U,"data-plugin-sandbox":M,"data-testid":r.Tp.components.OptionsGroup.group(v),ref:A,children:[(0,t.jsxs)("div",{className:K,onClick:w,children:[(0,t.jsx)(c.$n,{"data-testid":r.Tp.components.OptionsGroup.toggle(v),type:"button",fill:"text",size:"sm",variant:"secondary","aria-expanded":T,className:B.toggleButton,icon:T?"angle-down":"angle-right",onClick:w}),(0,t.jsx)("h6",{id:`button-${v}`,className:B.title,children:E(T)})]}),T&&(0,t.jsx)("div",{className:V,id:v,"aria-labelledby":`button-${v}`,children:y})]})});d.displayName="OptionsPaneCategory";const p=v=>({box:(0,n.css)({borderTop:`1px solid ${v.colors.border.weak}`}),boxNestedExpanded:(0,n.css)({marginBottom:v.spacing(2)}),title:(0,n.css)({flexGrow:1,overflow:"hidden",lineHeight:1.5,fontSize:"1rem",paddingLeft:"6px",fontWeight:v.typography.fontWeightMedium,margin:0}),header:(0,n.css)({display:"flex",cursor:"pointer",alignItems:"center",padding:v.spacing(.5),color:v.colors.text.primary,fontWeight:v.typography.fontWeightMedium,"&:hover":{background:v.colors.emphasize(v.colors.background.primary,.03)}}),toggleButton:(0,n.css)({alignSelf:"baseline"}),headerExpanded:(0,n.css)({color:v.colors.text.primary}),headerNested:(0,n.css)({padding:v.spacing(.5,0,.5,0)}),body:(0,n.css)({padding:v.spacing(1,2,1,4)}),bodyNested:(0,n.css)({position:"relative",paddingRight:0,"&:before":{content:"''",position:"absolute",top:0,left:"8px",width:"1px",height:"100%",background:v.colors.border.weak}})}),m=v=>`${h.wi}.optionGroup[${v}]`},48192:(k,R,e)=>{"use strict";e.d(R,{C:()=>i});var t=e(74848),n=e(57755);class i{constructor(r){this.props=r,this.items=[],this.categories=[]}addItem(r){return r.parent=this,this.items.push(r),this}addCategory(r){return r.props.isNested=!0,r.parent=this,this.categories.push(r),this}getCategory(r){let g=this.categories.find(a=>a.props.id===r);return g||(g=new i({title:r,id:r}),this.addCategory(g)),g}render(r){return this.props.customRender?this.props.customRender():(0,t.jsxs)(n.D,{...this.props,children:[this.items.map(g=>g.render(r)),this.categories.map(g=>g.render(r))]},this.props.title)}}},74097:(k,R,e)=>{"use strict";e.d(R,{v:()=>d});var t=e(74848),n=e(32196),i=e(23257),s=e.n(i),r=e(13544),g=e(60029),a=e(88575),c=e(40845),o=e(56034);function h({overrides:v}){const l=(0,c.of)(f);return(0,t.jsx)("div",{className:l.wrapper,children:v.map((y,u)=>(0,t.jsx)(o.m,{content:y.tooltip,placement:"top",children:(0,t.jsx)("div",{"aria-label":y.description,className:l[y.type]})},u.toString()))})}const f=v=>{const l={width:8,height:8,borderRadius:v.shape.radius.circle,marginLeft:v.spacing(1),top:"-1px"};return{wrapper:(0,n.css)({display:"flex"}),rule:(0,n.css)({...l,position:"relative",backgroundColor:v.colors.primary.main}),data:(0,n.css)({...l,position:"relative",backgroundColor:v.colors.warning.main})}};class d{constructor(l){this.props=l}getLabel(l){const{title:y,description:u,overrides:D,addon:E}=this.props;if(!l)return this.parent.props.title===y&&!D?.length?null:(0,t.jsx)(p,{title:y,description:u,overrides:D,addon:E});const x=[];return this.parent.parent&&x.push(this.highlightWord(this.parent.parent.props.title,l)),this.parent.props.title!==y&&x.push(this.highlightWord(this.parent.props.title,l)),(0,t.jsxs)(g.J,{description:u&&this.highlightWord(u,l),category:x,children:[this.highlightWord(y,l),D&&D.length>0&&(0,t.jsx)(h,{overrides:D})]})}highlightWord(l,y){return(0,t.jsx)(s(),{textToHighlight:l,searchWords:[y],highlightClassName:"search-fragment-highlight"})}renderOverrides(){const{overrides:l}=this.props;!l||l.length}render(l){const{title:y,description:u,render:D,showIf:E,skipField:x}=this.props,P=`${this.parent.props.id} ${y}`;return E&&!E()?null:x?D():(0,t.jsx)(a.D,{label:this.getLabel(l),description:u,"aria-label":r.Tp.components.PanelEditor.OptionsPane.fieldLabel(P),children:D()},P)}}function p({title:v,description:l,overrides:y,addon:u}){const D=(0,c.of)(m);return(0,t.jsxs)("div",{className:D.container,children:[(0,t.jsxs)(g.J,{description:l,children:[v,y&&y.length>0&&(0,t.jsx)(h,{overrides:y})]}),u]})}function m(v){return{container:(0,n.css)({display:"flex",justifyContent:"space-between"})}}},26443:(k,R,e)=>{"use strict";e.d(R,{gs:()=>ne,Ff:()=>j,Po:()=>le});var t=e(74848),n=e(32196),i=e(96540),s=e(32264),r=e(40845),g=e(67647),a=e(94354),c=e(40276),o=e(74106),h=e(82792),f=e(71468),d=e(7376),p=e(79971),m=e(40334),v=e(33390);function l(ee,se){v.A.set(`panel-edit-section-${ee}`,se?"true":"false")}function y(ee,se){return v.A.getBool(`panel-edit-section-${ee}`,se)}const u=(ee,se)=>({angularPanelComponent:(0,m.U)(ee,se.panel)?.angularComponent}),D={changePanelPlugin:p.gW},E=(0,f.connect)(u,D);class x extends i.PureComponent{constructor(se){super(se)}componentDidMount(){this.loadAngularOptions()}componentDidUpdate(se){(this.props.plugin!==se.plugin||this.props.angularPanelComponent!==se.angularPanelComponent)&&this.cleanUpAngularOptions(),this.loadAngularOptions()}componentWillUnmount(){this.cleanUpAngularOptions()}cleanUpAngularOptions(){this.angularOptions&&(this.angularOptions.destroy(),this.angularOptions=null)}loadAngularOptions(){const{panel:se,angularPanelComponent:ie,changePanelPlugin:Z}=this.props;if(!this.element||!ie||this.angularOptions)return;const oe=ie.getScope();if(!oe.$$childHead){setTimeout(()=>{this.forceUpdate()});return}const ce=oe.$$childHead.ctrl;ce.initEditMode(),ce.onPluginTypeChange=De=>{Z({panel:se,pluginId:De.id})};let ye="";for(let De=0;De<ce.editorTabs.length;De++){const ge=ce.editorTabs[De];ge.isOpen=y(ge.title,De===0),ye+=`
      <div class="panel-options-group" ng-cloak>
        <div class="panel-options-group__header" ng-click="toggleOptionGroup(${De})" aria-label="${ge.title} section">
          <div class="panel-options-group__icon">
            <icon name="ctrl.editorTabs[${De}].isOpen ? 'angle-down' : 'angle-right'"></icon>
          </div>
          <div class="panel-options-group__title">${ge.title}</div>
        </div>
        <div class="panel-options-group__body" ng-if="ctrl.editorTabs[${De}].isOpen">
          <panel-editor-tab editor-tab="ctrl.editorTabs[${De}]" ctrl="ctrl"></panel-editor-tab>
        </div>
      </div>
      `}const re=(0,d.E)(),ue={ctrl:ce,toggleOptionGroup:De=>{const ge=ce.editorTabs[De];ge.isOpen=!ge.isOpen,l(ge.title,!!ge.isOpen)}};this.angularOptions=re.load(this.element,ue,ye),this.angularOptions.digest()}render(){return(0,t.jsx)("div",{ref:se=>this.element=se})}}const P=(0,f.connect)(u,D)(x);var b=e(57755),M=e(22290),O=e(10354);const I=({panel:ee,formatDate:se})=>{const ie=(0,r.of)(T),Z=ee.libraryPanel?.meta;return Z?(0,t.jsxs)("div",{className:ie.info,children:[(0,t.jsxs)("div",{className:ie.libraryPanelInfo,children:[`Used on ${Z.connectedDashboards} `,Z.connectedDashboards===1?"dashboard":"dashboards"]}),(0,t.jsxs)("div",{className:ie.libraryPanelInfo,children:["Last edited on ",se?.(Z.updated,"L")??Z.updated," by",Z.updatedBy.avatarUrl&&(0,t.jsx)("img",{width:"22",height:"22",className:ie.userAvatar,src:Z.updatedBy.avatarUrl,alt:`Avatar for ${Z.updatedBy.name}`}),Z.updatedBy.name]})]}):null},T=ee=>({info:(0,n.css)`
      line-height: 1;
    `,libraryPanelInfo:(0,n.css)`
      color: ${ee.colors.text.secondary};
      font-size: ${ee.typography.bodySmall.fontSize};
    `,userAvatar:(0,n.css)`
      border-radius: ${ee.shape.radius.circle};
      box-sizing: content-box;
      width: 22px;
      height: 22px;
      padding-left: ${ee.spacing(1)};
      padding-right: ${ee.spacing(1)};
    `});var C=e(48192),S=e(74097);function A(ee){const{panel:se,onPanelConfigChange:ie,dashboard:Z}=ee,oe=new C.C({title:"Library panel options",id:"Library panel options",isOpenDefault:!0});return(0,h.X)(se)&&oe.addItem(new S.v({title:"Name",value:se.libraryPanel.name,popularRank:1,render:function(){return(0,t.jsx)(O.p,{id:"LibraryPanelFrameName",defaultValue:se.libraryPanel.name,onBlur:ye=>ie("libraryPanel",{...se.libraryPanel,name:ye.currentTarget.value})})}})).addItem(new S.v({title:"Information",render:function(){return(0,t.jsx)(I,{panel:se,formatDate:Z.formatDate})}})),oe}var L=e(13544),N=e(21744),F=e(15292),w=e(64919),B=e(90182),U=e(6923),K=e(20214),V=e(74410),H=e(92378);function Y(ee){const{dashboard:se,panel:ie,onPanelConfigChange:Z}=ee,oe=new C.C({title:"Panel options",id:"Panel options",isOpenDefault:!0}),ce=re=>{const ue=document.getElementById("PanelFrameTitle");ue instanceof HTMLInputElement&&(ue.value=re,Z("title",re))},ye=re=>{const ue=document.getElementById("description-text-area");ue instanceof HTMLTextAreaElement&&(ue.value=re,Z("description",re))};return oe.addItem(new S.v({title:"Title",value:ie.title,popularRank:1,render:function(){return(0,t.jsx)(O.p,{"data-testid":L.Tp.components.PanelEditor.OptionsPane.fieldInput("Title"),id:"PanelFrameTitle",defaultValue:ie.title,onBlur:ue=>Z("title",ue.currentTarget.value)})},addon:s.$.featureToggles.dashgpt&&(0,t.jsx)(V.h,{onGenerate:ce,panel:ie.getSaveModel(),dashboard:se.getSaveModelClone()})})).addItem(new S.v({title:"Description",description:ie.description,value:ie.description,render:function(){return(0,t.jsx)(N.f,{"data-testid":L.Tp.components.PanelEditor.OptionsPane.fieldInput("Description"),id:"description-text-area",defaultValue:ie.description,onBlur:ue=>Z("description",ue.currentTarget.value)})},addon:s.$.featureToggles.dashgpt&&(0,t.jsx)(K.t,{onGenerate:ye,panel:ie.getSaveModel()})})).addItem(new S.v({title:"Transparent background",render:function(){return(0,t.jsx)(F.d,{"data-testid":L.Tp.components.PanelEditor.OptionsPane.fieldInput("Transparent background"),value:ie.transparent,id:"transparent-background",onChange:ue=>Z("transparent",ue.currentTarget.checked)})}})).addCategory(new C.C({title:"Panel links",id:"Panel links",isOpenDefault:!1,itemsCount:ie.links?.length}).addItem(new S.v({title:"Panel links",render:function(){return(0,t.jsx)(w.e,{links:ie.links,onChange:ue=>Z("links",ue),getSuggestions:U.Fq,data:[]})}}))).addCategory(new C.C({title:"Repeat options",id:"Repeat options",isOpenDefault:!1}).addItem(new S.v({title:"Repeat by variable",description:"Repeat this panel for each value in the selected variable. This is not visible while in edit mode. You need to go back to dashboard and then update the variable or reload the dashboard.",render:function(){return(0,t.jsx)(H.G,{id:"repeat-by-variable-select",repeat:ie.repeat,onChange:ue=>{Z("repeat",ue)}})}})).addItem(new S.v({title:"Repeat direction",showIf:()=>!!ie.repeat,render:function(){const ue=[{label:"Horizontal",value:"h"},{label:"Vertical",value:"v"}];return(0,t.jsx)(a.z,{options:ue,value:ie.repeatDirection||"h",onChange:De=>Z("repeatDirection",De)})}})).addItem(new S.v({title:"Max per row",showIf:()=>!!(ie.repeat&&ie.repeatDirection==="h"),render:function(){const ue=[2,3,4,6,8,12].map(De=>({label:De.toString(),value:De}));return(0,t.jsx)(B.l6,{options:ue,value:ie.maxPerRow,onChange:De=>Z("maxPerRow",De.value)})}})))}var X=e(66211);class J{constructor(se,ie){this.categories=se,this.overrides=ie}search(se){const ie=new RegExp(se,"i"),oe=this.collectHits(this.categories,ie,[]).sort(q).map(re=>re.item),ye=this.collectHits(this.overrides,ie,[]).sort(q).map(re=>re.item);return{optionHits:oe,overrideHits:this.buildOverrideHitCategories(ye),totalCount:this.getAllOptionsCount(this.categories)}}collectHits(se,ie,Z){for(const oe of se){const ce=ie.test(oe.props.title);for(const ye of oe.items){if(ie.test(ye.props.title)){Z.push({item:ye,rank:1});continue}if(ye.props.description&&ie.test(ye.props.description)){Z.push({item:ye,rank:2});continue}ce&&Z.push({item:ye,rank:3})}oe.categories.length>0&&this.collectHits(oe.categories,ie,Z)}return Z}getAllOptionsCount(se){let ie=0;for(const Z of se)ie+=Z.items.length,Z.categories.length>0&&(ie+=this.getAllOptionsCount(Z.categories));return ie}buildOverrideHitCategories(se){const ie={};for(const Z of se){let oe=ie[Z.parent.props.title];oe||(oe=ie[Z.parent.props.title]=new C.C(Z.parent.props),oe.addItem(Z.parent.items[0])),oe.items[0].props.title!==Z.props.title&&oe.addItem(Z)}return Object.values(ie)}}function q(ee,se){return ee.rank-se.rank}function ae(ee){const se=[];for(const ie of ee)for(const Z of ie.items)Z.props.title==="Unit"&&(Z.props.popularRank=2),Z.props.title==="Min"&&(Z.props.popularRank=3),Z.props.title==="Max"&&(Z.props.popularRank=4),Z.props.title==="Display name"&&(Z.props.popularRank=5),Z.props.popularRank&&se.push(Z);return se.sort((ie,Z)=>ie.props.popularRank-Z.props.popularRank)}const j=ee=>{const{plugin:se,dashboard:ie,panel:Z}=ee,[oe,ce]=(0,i.useState)(""),[ye,re]=(0,i.useState)("All"),ue=(0,r.of)(z),[De,ge,Te]=(0,i.useMemo)(()=>[Y(ee),(0,X.Zm)(ee),A(ee)],[Z.configRev,ee.data,ee.instanceState,oe]),Le=(0,i.useMemo)(()=>(0,M.v)(ee.panel.fieldConfig,ee.plugin.fieldConfigRegistry,ee.data?.series??[],oe,ee.onFieldConfigsChange),[Z.configRev,ee.data,ee.instanceState,oe]),Ye=[],je=oe.length>0,Ze=(0,i.useMemo)(te,[]),Ne=(0,h.X)(Z)?[Te,De,...ge]:[De,...ge];if(je)Ye.push(le(Ne,Le,oe)),ee.plugin.angularPanelCtrl&&Ye.push((0,t.jsx)("div",{className:ue.searchNotice,children:"This is an old visualization type that does not support searching all options."},"Search notice"));else switch(ye){case"All":(0,h.X)(Z)&&Ye.push(Te.render()),Ye.push(De.render()),ee.plugin.angularPanelCtrl&&Ye.push((0,t.jsx)(P,{plugin:se,dashboard:ie,panel:Z},"AngularOptions"));for(const Ue of ge)Ye.push(Ue.render());for(const Ue of Le)Ye.push(Ue.render());break;case"Overrides":for(const Ue of Le)Ye.push(Ue.render());break;case"Recent":Ye.push((0,t.jsx)(b.D,{id:"Recent options",title:"Recent options",forceOpen:1,children:ae(Ne).map(Ue=>Ue.render())},"Recent options"));break}const Pe=!je&&!se.fieldConfigRegistry.isEmpty();return(0,t.jsxs)("div",{className:ue.wrapper,children:[(0,t.jsxs)("div",{className:ue.formBox,children:[Z.isAngularPlugin()&&!se.meta.angular?.hideDeprecation&&(0,t.jsx)(o.c,{className:ue.angularDeprecationWrapper,showPluginDetailsLink:!0,pluginId:se.meta.id,pluginType:se.meta.type,angularSupportEnabled:s.$?.angularSupportEnabled,interactionElementId:"panel-options"}),(0,t.jsx)("div",{className:ue.formRow,children:(0,t.jsx)(g.Z,{width:0,value:oe,onChange:ce,placeholder:"Search options"})}),Pe&&(0,t.jsx)("div",{className:ue.formRow,children:(0,t.jsx)(a.z,{options:Ze,value:ye,fullWidth:!0,onChange:re})})]}),(0,t.jsx)("div",{className:ue.scrollWrapper,children:(0,t.jsx)(c.E,{autoHeightMin:"100%",children:(0,t.jsx)("div",{className:ue.mainBox,children:Ye})})})]})};function te(){return[{label:"All",value:"All"},{label:"Overrides",value:"Overrides"}]}var ne=(ee=>(ee.All="All",ee.Overrides="Overrides",ee.Recent="Recent",ee))(ne||{});function le(ee,se,ie){const Z=new J(ee,se),{optionHits:oe,totalCount:ce,overrideHits:ye}=Z.search(ie);return(0,t.jsxs)("div",{children:[(0,t.jsx)(b.D,{id:"Found options",title:`Matched ${oe.length}/${ce} options`,forceOpen:1,children:oe.map(re=>re.render(ie))},"Normal options"),ye.map(re=>re.render(ie))]},"search results")}const z=ee=>({wrapper:(0,n.css)({height:"100%",display:"flex",flexDirection:"column",flex:"1 1 0",".search-fragment-highlight":{color:ee.colors.warning.text,background:"transparent"}}),searchBox:(0,n.css)({display:"flex",flexDirection:"column",minHeight:0}),formRow:(0,n.css)({marginBottom:ee.spacing(1)}),formBox:(0,n.css)({padding:ee.spacing(1),background:ee.colors.background.primary,border:`1px solid ${ee.components.panel.borderColor}`,borderTopLeftRadius:ee.shape.borderRadius(1.5),borderBottom:"none"}),closeButton:(0,n.css)({marginLeft:ee.spacing(1)}),searchHits:(0,n.css)({padding:ee.spacing(1,1,0,1)}),scrollWrapper:(0,n.css)({flexGrow:1,minHeight:0}),searchNotice:(0,n.css)({fontSize:ee.typography.size.sm,color:ee.colors.text.secondary,padding:ee.spacing(1),textAlign:"center"}),mainBox:(0,n.css)({background:ee.colors.background.primary,border:`1px solid ${ee.components.panel.borderColor}`,borderTop:"none",flexGrow:1}),angularDeprecationWrapper:(0,n.css)({padding:ee.spacing(1)})})},22290:(k,R,e)=>{"use strict";e.d(R,{v:()=>I});var t=e(74848),n=e(32196),i=e(2543),s=e(85200),r=e(37055),g=e(84349),a=e(51986),c=e(40845),o=e(6923),h=e(96540),f=e(23257),d=e.n(f),p=e(66864),m=e(60029),v=e(53402),l=e(29158),y=e(88575),u=e(57755);const D=({property:A,context:L,registry:N,onChange:F,onRemove:w,isSystemOverride:B,searchQuery:U})=>{const K=(0,c.of)(E),V=N?.getIfExists(A.id),H=(0,h.useId)();if(!V)return null;const Y=Array.isArray(A.value)||A.id===r.uo.Thresholds||A.id===r.uo.Links||A.id===r.uo.Mappings,X=V.category?.filter(ae=>ae!==V.name);let J;const q=(ae=!0,j=!1)=>(te=!1)=>(0,t.jsxs)(p.Gy,{justify:"space-between",children:[(0,t.jsxs)(m.J,{category:X,description:ae?V.description:void 0,htmlFor:H,children:[(0,t.jsx)(d(),{textToHighlight:V.name,searchWords:[U],highlightClassName:"search-fragment-highlight"}),!te&&j&&V.getItemsCount&&(0,t.jsx)(v.p,{value:V.getItemsCount(A.value)})]}),!B&&(0,t.jsx)("div",{children:(0,t.jsx)(l.K,{name:"times",onClick:w,tooltip:"Remove label"})})]});return Y?J=(0,t.jsx)(u.D,{id:V.name,renderTitle:q(!1,!0),className:(0,n.css)({paddingLeft:0,paddingRight:0}),isNested:!0,isOpenDefault:A.value!==void 0,children:(0,t.jsx)(V.override,{value:A.value,onChange:ae=>{F(ae)},item:V,context:L})}):J=(0,t.jsx)("div",{children:(0,t.jsx)(y.D,{label:q()(),description:V.description,children:(0,t.jsx)(V.override,{value:A.value,onChange:ae=>{F(ae)},item:V,context:L,id:H})})}),(0,t.jsx)("div",{className:(0,n.cx)(Y&&K.collapsibleOverrideEditor,!Y&&"dynamicConfigValueEditor--nonCollapsible"),children:J})},E=A=>({collapsibleOverrideEditor:(0,n.css)({label:"collapsibleOverrideEditor","& + .dynamicConfigValueEditor--nonCollapsible":{marginTop:A.spacing(1)}})});var x=e(48192),P=e(74097),b=e(14578);const M=({isExpanded:A,registry:L,matcherUi:N,overrideName:F,override:w,onOverrideRemove:B})=>{const U=(0,c.of)(O),V=w.properties.map(Y=>L.getIfExists(Y.id)).filter(Y=>!!Y).map(Y=>Y?.name).join(", "),H=N.optionsToLabel(w.matcher.options);return(0,t.jsxs)("div",{children:[(0,t.jsxs)(p.Gy,{justify:"space-between",children:[(0,t.jsx)("div",{children:F}),(0,t.jsx)(l.K,{name:"trash-alt",onClick:B,tooltip:"Remove override"})]}),!A&&(0,t.jsx)("div",{className:U.overrideDetails,children:(0,t.jsxs)("div",{className:U.options,title:H,children:[H," ",(0,t.jsx)(b.I,{name:"angle-right"})," ",V]})})]})};M.displayName="OverrideTitle";const O=A=>({matcherUi:(0,n.css)({padding:A.spacing(1)}),propertyPickerWrapper:(0,n.css)({marginTop:A.spacing(2)}),overrideDetails:(0,n.css)({fontSize:A.typography.bodySmall.fontSize,color:A.colors.text.secondary,fontWeight:A.typography.fontWeightRegular}),options:(0,n.css)({overflow:"hidden",paddingRight:A.spacing(4)}),unknownLabel:(0,n.css)({marginBottom:0})});function I(A,L,N,F,w){const B=[],U=A;if(!L||L.isEmpty())return[];const K=(X,J)=>{let q=(0,i.cloneDeep)(U.overrides);q[X]=J,w({...U,overrides:q})},V=X=>{let J=(0,i.cloneDeep)(U.overrides);J.splice(X,1),w({...U,overrides:J})},H=X=>{const J=s.sJ.get(X.value);J&&w({...U,overrides:[...U.overrides,{matcher:{id:J.id,options:J.defaultOptions},properties:[]}]})},Y={data:N,getSuggestions:X=>(0,o.Hf)(N,X),isOverride:!0};for(let X=0;X<U.overrides.length;X++){const J=U.overrides[X],q=`Override ${X+1}`,ae=g.g.get(J.matcher.id),j=T(L),te=(0,r.Ow)(J),ne=J.properties.length===0?1:0,le=new x.C({title:q,id:q,forceOpen:ne,renderTitle:function(ie){return(0,t.jsx)(M,{override:J,isExpanded:ie,registry:L,overrideName:q,matcherUi:ae,onOverrideRemove:()=>V(X)})}}),z=se=>{J.matcher.options=se,K(X,J)},ee=(se,ie)=>{const Z=L.get(ie.value),oe={id:Z.id,value:Z.defaultValue};J.properties?se.properties.push(oe):se.properties=[oe],K(X,se)};le.addItem(new P.v({title:ae.name,render:function(){return(0,t.jsx)(ae.component,{id:`${ae.matcher.id}-${X}`,matcher:ae.matcher,data:N??[],options:J.matcher.options,onChange:z})}}));for(let se=0;se<J.properties.length;se++){const ie=J.properties[se],Z=L.getIfExists(ie.id);if(!Z)continue;const oe=ye=>{J.properties[se].value=ye,K(X,J)},ce=()=>{J.properties.splice(se,1),K(X,J)};le.addItem(new P.v({title:Z.name,skipField:!0,render:function(){return(0,t.jsx)(D,{isSystemOverride:te,onChange:oe,onRemove:ce,property:ie,registry:L,context:Y,searchQuery:F},`${ie.id}/${se}`)}}))}!te&&J.matcher.options&&le.addItem(new P.v({title:"----------",skipField:!0,render:function(){return(0,t.jsx)(a.i,{label:"Add override property",variant:"secondary",isFullWidth:!0,icon:"plus",menuPlacement:"auto",options:j,onChange:ie=>ee(J,ie)},"Add override property")}})),B.push(le)}return B.push(new x.C({title:"add button",id:"add button",customRender:function(){return(0,t.jsx)(C,{children:(0,t.jsx)(a.i,{icon:"plus",label:"Add field override",variant:"secondary",menuPlacement:"auto",isFullWidth:!0,size:"md",options:g.g.list().filter(J=>!J.excludeFromPicker).map(J=>({label:J.name,value:J.id,description:J.description})),onChange:J=>H(J)})},"Add override")}})),B}function T(A){return A.list().filter(L=>!L.hideFromOverrides).map(L=>{let N=L.name;return L.category&&(N=[...L.category,L.name].join(" > ")),{label:N,value:L.id,description:L.description}})}function C({children:A}){const L=(0,c.of)(S);return(0,t.jsx)("div",{className:L,children:A})}function S(A){return(0,n.css)({borderTop:`1px solid ${A.colors.border.weak}`,padding:`${A.spacing(2)}`,display:"flex"})}},66211:(k,R,e)=>{"use strict";e.d(R,{g5:()=>x,tN:()=>D,Zm:()=>u,Z4:()=>E});var t=e(74848),n=e(2543),i=e(60264),s=e(10354),r=e(32196),g=e(72724),a=e(40845);const c=({libraryPanel:P})=>{const b=(0,a.of)(o),M=P.useState(),O=M.$timeRange?.getTimeZone(),I=M._loadedPanel?.meta;return I?(0,t.jsxs)("div",{className:b.info,children:[(0,t.jsxs)("div",{className:b.libraryPanelInfo,children:[`Used on ${I.connectedDashboards} `,I.connectedDashboards===1?"dashboard":"dashboards"]}),(0,t.jsxs)("div",{className:b.libraryPanelInfo,children:[(0,g.LE)(I.updated,{format:"L",timeZone:O})," by",I.updatedBy.avatarUrl&&(0,t.jsx)("img",{className:b.userAvatar,src:I.updatedBy.avatarUrl,alt:`Avatar for ${I.updatedBy.name}`}),I.updatedBy.name]})]}):null},o=P=>({info:(0,r.css)({lineHeight:1}),libraryPanelInfo:(0,r.css)({color:P.colors.text.secondary,fontSize:P.typography.bodySmall.fontSize}),userAvatar:(0,r.css)({borderRadius:P.shape.radius.circle,boxSizing:"content-box",width:"22px",height:"22px",paddingLeft:P.spacing(1),paddingRight:P.spacing(1)})});var h=e(6923),f=e(48192),d=e(74097);const p="Some data fields have this option pre-configured. Add a field override rule to override the pre-configured value.",m="An override rule exists for this property";function v(P,b,M){const O=[];if(M){for(const T of M)for(const C of T.fields)if((0,n.get)(C.config,P.path)!=null){O.push({type:"data",description:p,tooltip:p});break}}return b.overrides.some(T=>T.properties.some(C=>C.id===P.id))&&O.push({type:"rule",description:m,tooltip:m}),O}var l=e(54612);function y({data:P,replaceVariables:b,options:M,eventBus:O,instanceState:I}){const T=P?.series??[];return{data:T,replaceVariables:b,options:M,eventBus:O,getSuggestions:S=>(0,h.Hf)(T,S),instanceState:I}}function u(P){const{plugin:b,panel:M,onPanelOptionsChanged:O,onFieldConfigsChange:I,data:T,dashboard:C,instanceState:S}=P,A=M.getOptions(),L=M.fieldConfig,N={},F=y({data:T,replaceVariables:M.replaceVariables,options:A,eventBus:C.events,instanceState:S}),w=U=>{const K=(U&&U[0])??`${b.meta.name}`,V=N[K];return V||(N[K]=new f.C({title:K,id:K,sandboxId:b.meta.id}))},B={getValue:U=>(0,n.get)(A,U),onChange:(U,K)=>{const V=(0,l.Sf)(A,U,K);O(V)}};x(b.getPanelOptionsSupplier(),B,w,F);for(const U of b.fieldConfigRegistry.list()){if(U.isCustom){if(U.showIf&&!U.showIf(L.defaults.custom,T?.series))continue}else if(U.showIf&&!U.showIf(L.defaults,T?.series))continue;if(U.hideFromDefaults)continue;const K=w(U.category),V=U.editor,H=L.defaults,Y=U.isCustom?H.custom?(0,n.get)(H.custom,U.path):void 0:(0,n.get)(H,U.path);U.getItemsCount&&(K.props.itemsCount=U.getItemsCount(Y)),K.addItem(new d.v({title:U.name,description:U.description,overrides:v(U,L,T?.series),render:function(){const J=q=>{I((0,l.EQ)(L,U.path,q,U.isCustom))};return(0,t.jsx)(V,{value:Y,onChange:J,item:U,context:F,id:U.id})}}))}return Object.values(N)}function D(P){const b=new f.C({title:"Library panel options",id:"Library panel options",isOpenDefault:!0});return b.addItem(new d.v({title:"Name",value:P,popularRank:1,render:function(){return(0,t.jsx)(s.p,{id:"LibraryPanelFrameName","data-testid":"library panel name input",defaultValue:P.state.name,onBlur:O=>P.setState({name:O.currentTarget.value})})}})).addItem(new d.v({title:"Information",render:function(){return(0,t.jsx)(c,{libraryPanel:P})}})),b}function E(P){const{plugin:b,panel:M,data:O,eventBus:I,instanceState:T}=P,C={},S=w=>{const B=w?.[0]??b.meta.name,U=C[B];return U||(C[B]=new f.C({title:B,id:B,sandboxId:b.meta.id}))},A=M.state.options,L={getValue:w=>(0,n.get)(A,w),onChange:(w,B)=>{const U=(0,l.Sf)(A,w,B);M.onOptionsChange(U)}},N=y({data:O,replaceVariables:M.interpolate,options:A,eventBus:I,instanceState:T});x(b.getPanelOptionsSupplier(),L,S,N);const F=M.state.fieldConfig;for(const w of b.fieldConfigRegistry.list()){const B=w.showIf&&(w.isCustom?!w.showIf(F.defaults.custom,O?.series):!w.showIf(F.defaults,O?.series));if(w.hideFromDefaults||B)continue;const U=S(w.category),K=w.editor,V=F.defaults,H=w.isCustom?V.custom?(0,n.get)(V.custom,w.path):void 0:(0,n.get)(V,w.path);w.getItemsCount&&(U.props.itemsCount=w.getItemsCount(H)),U.addItem(new d.v({title:w.name,description:w.description,overrides:v(w,F,O?.series),render:function(){const X=J=>{M.onFieldConfigChange((0,l.EQ)(F,w.path,J,w.isCustom),!0)};return(0,t.jsx)(K,{value:H,onChange:X,item:w,context:N,id:w.id})}}))}return Object.values(C)}function x(P,b,M,O,I){const T=new i.pv;P(T,O);for(const C of T.getItems()){if(C.showIf&&!C.showIf(O.options,O.data))continue;let S=I;if(S?C.category?.[0]?.length&&(S=S.getCategory(C.category[0])):S=M(C.category),(0,i.iF)(C)){const L=C.getNestedValueAccess(b),N=L.getContext?L.getContext(O):{...O,options:b.getValue(C.path)};x(C.getBuilder(),L,M,N,S);continue}const A=C.editor;S.addItem(new d.v({title:C.name,description:C.description,render:function(){return(0,t.jsx)(A,{value:b.getValue(C.path),onChange:N=>{b.onChange(C.path,N)},item:C,context:O,id:C.id})}}))}}},53466:(k,R,e)=>{"use strict";e.d(R,{Ay:()=>D,GU:()=>f,MJ:()=>p,Ox:()=>m,eK:()=>l,fR:()=>v,kw:()=>y,wi:()=>a});var t=e(65307),n=e(39070),i=e(43127),s=e(33390),r=e(84423),g=e(32696);const a="grafana.dashboard.editor.ui",c={isPanelOptionsVisible:!0,rightPaneSize:400,topPaneSize:.45,mode:g.q5.Fill},o=()=>{const E=s.A.getObject(a,c);let x={...E};return typeof E.topPaneSize=="string"&&(x={...E,topPaneSize:parseFloat(E.topPaneSize)/100}),{getPanel:()=>new r.a9({}),getSourcePanel:()=>new r.a9({}),getData:()=>({state:n.Gu.NotStarted,series:[],timeRange:(0,i.E2)()}),initDone:!1,shouldDiscardChanges:!1,isOpen:!1,isVizPickerOpen:!1,tableViewEnabled:!1,ui:{...c,...x}}},h=(0,t.Z0)({name:"panelEditor",initialState:o(),reducers:{updateEditorInitState:(E,x)=>{E.getPanel=()=>x.payload.panel,E.getSourcePanel=()=>x.payload.sourcePanel,E.initDone=!0,E.isOpen=!0,E.shouldDiscardChanges=!1},setEditorPanelData:(E,x)=>{E.getData=()=>x.payload},setDiscardChanges:(E,x)=>{E.shouldDiscardChanges=x.payload},setPanelEditorUIState:(E,x)=>{E.ui={...E.ui,...x.payload},!E.ui.isPanelOptionsVisible&&E.isVizPickerOpen&&(E.isVizPickerOpen=!1)},toggleVizPicker:(E,x)=>{E.isVizPickerOpen=x.payload,E.isVizPickerOpen&&(E.ui.isPanelOptionsVisible=!0)},toggleTableView(E){E.tableViewEnabled=!E.tableViewEnabled},closeEditor:E=>{E.getPanel=()=>new r.a9({}),E.getSourcePanel=()=>new r.a9({}),E.isOpen=!1,E.initDone=!1,E.isVizPickerOpen=!1,E.tableViewEnabled=!1}}}),{updateEditorInitState:f,setEditorPanelData:d,setDiscardChanges:p,closeEditor:m,setPanelEditorUIState:v,toggleVizPicker:l,toggleTableView:y}=h.actions,D={panelEditor:h.reducer}},32696:(k,R,e)=>{"use strict";e.d(R,{M8:()=>t,Nt:()=>s,__:()=>g,q5:()=>n});var t=(a=>(a.Query="query",a.Transform="transform",a.Visualize="visualize",a.Alert="alert",a))(t||{}),n=(a=>(a[a.Fill=0]="Fill",a[a.Fit=1]="Fit",a[a.Exact=2]="Exact",a))(n||{}),i=(a=>(a[a.Off=0]="Off",a[a.Table=1]="Table",a))(i||{});const s=[{value:0,label:"Fill",description:"Use all available space"},{value:2,label:"Actual",description:"Make same size as on the dashboard"}],r=[{value:0,label:"Visualization",description:"Show using selected visualization"},{value:1,label:"Table",description:"Show raw data in table form"}];var g=(a=>(a[a.Visualizations=0]="Visualizations",a[a.LibraryPanels=1]="LibraryPanels",a[a.Suggestions=2]="Suggestions",a[a.Widgets=3]="Widgets",a))(g||{})},54612:(k,R,e)=>{"use strict";e.d(R,{$:()=>g,A:()=>r,EQ:()=>a,Sf:()=>c});var t=e(2543),n=e.n(t),i=e(15054),s=e(32696);function r(o,h,f,d){if(o===s.q5.Fill)return{width:h,height:f};const p=8*6,l=(window.innerWidth-60-i.dU*4)/i.cV*d.gridPos.w,y=i.sD*d.gridPos.h+p,u=Math.min(h/l,f/y);return l<=h&&y<=f?{width:l,height:y}:{width:l*u,height:y*u}}function g(o){return o?.meta.skipDataQuery===!1}const a=(o,h,f,d)=>{let p={...o.defaults};const m=f==null||f==="";return d?p.custom?m?p.custom=(0,t.omit)(p.custom,h):p.custom=c(p.custom,h,f):m||(p.custom=c(p.custom,h,f)):m?p=(0,t.omit)(p,h):p=c(p,h,f),{...o,defaults:p}};function c(o,h,f){const d=Array.isArray(h)?h:h.split("."),p=d.shift();if(p.endsWith("]")){const v=p.lastIndexOf("["),l=+p.substring(v+1,p.length-1),y=p.substring(0,v);let u=o[y];const D=Array.isArray(u)?[...u]:[];return d.length&&(u=D[l],(u==null||typeof u!="object")&&(u={}),f=c(u,d,f)),D[l]=f,{...o,[y]:D}}if(!d.length)return{...o,[p]:f};let m=o[p];return(m==null||typeof m!="object")&&(m={}),{...o,[p]:c(m,d,f)}}},92378:(k,R,e)=>{"use strict";e.d(R,{G:()=>a,U:()=>c});var t=e(74848),n=e(96540),i=e(80943),s=e(90182),r=e(31678),g=e(87421);const a=({repeat:o,onChange:h,id:f})=>{const d=(0,r.useSelector)(v=>(0,g.SS)((0,g.y7)(v),v)),p=(0,n.useMemo)(()=>{const v=d.map(l=>({label:l.name,value:l.name}));return v.length===0&&v.unshift({label:"No template variables found",value:null}),v.unshift({label:"Disable repeating",value:null}),v},[d]),m=(0,n.useCallback)(v=>h(v.value),[h]);return(0,t.jsx)(s.l6,{inputId:f,value:o,onChange:m,options:p})},c=({parent:o,repeat:h,id:f,onChange:d})=>{const m=(0,n.useMemo)(()=>i.jh.getVariables(o),[o]).useState().variables,v=(0,n.useMemo)(()=>{const y=m.map(u=>({label:u.state.name,value:u.state.name}));return y.length===0&&y.unshift({label:"No template variables found",value:null}),y.unshift({label:"Disable repeating",value:null}),y},[m]),l=(0,n.useCallback)(y=>d(y.value),[d]);return(0,t.jsx)(s.l6,{inputId:f,value:h,onChange:l,options:v})}},78050:(k,R,e)=>{"use strict";e.d(R,{C:()=>a,m:()=>c});var t=e(74848),n=e(13544),i=e(14110),s=e(71678),r=e(55852),g=e(70497);const a=({dashboard:o,onSaveSuccess:h,size:f})=>(0,t.jsx)(s.$s,{children:({showModal:d,hideModal:p})=>(0,t.jsx)(r.$n,{size:f,onClick:()=>{d(g.$,{dashboard:o,onSaveSuccess:h,onDismiss:p})},"aria-label":n.Tp.pages.Dashboard.Settings.General.saveDashBoard,children:"Save dashboard"})}),c=({dashboard:o,onClick:h,onSaveSuccess:f,variant:d,size:p})=>(0,t.jsx)(s.$s,{children:({showModal:m,hideModal:v})=>(0,t.jsx)(r.$n,{size:p,onClick:()=>{(0,i.rR)("grafana_dashboard_save_as_clicked"),h?.(),m(g.$,{dashboard:o,onSaveSuccess:f,onDismiss:v,isCopy:!0})},variant:d,"aria-label":n.Tp.pages.Dashboard.Settings.General.saveAsDashBoard,children:"Save as"})})},54943:(k,R,e)=>{"use strict";e.d(R,{l:()=>c});var t=e(74848),n=e(16817),i=e(67061),s=e(62930),r=e(90613),g=e(19626),a=e(22764);const c=({diff:o,oldValue:h,newValue:f,hasFolderChanges:d,oldFolder:p,newFolder:m})=>{const v=(0,n.A)(async()=>{const y=JSON.stringify(h??{},null,2),u=JSON.stringify(f??{},null,2);let D;const E=[];let x=0;if(o)for(const[P,b]of Object.entries(o)){const M=(0,t.jsx)(g.D,{diffs:b,title:P},P);P==="schemaVersion"?D=M:E.push(M),x+=b.length}return{schemaChange:D,diffs:E,count:x,showDiffs:x<15,jsonView:(0,t.jsx)(a.M,{oldValue:y,newValue:u})}},[o,h,f]),{value:l}=v;return(0,t.jsxs)(i.B,{direction:"column",gap:1,children:[d&&(0,t.jsx)(g.D,{diffs:[{op:"replace",value:m,originalValue:p,path:[],startLineNumber:0,endLineNumber:0}],title:"folder"},"folder"),(!l||!h)&&(0,t.jsx)(s.y,{}),l&&l.count>=1?(0,t.jsxs)(t.Fragment,{children:[l&&l.schemaChange&&l.schemaChange,l&&l.showDiffs&&l.diffs,(0,t.jsxs)(r.a,{paddingTop:1,children:[(0,t.jsx)("h4",{children:"Full JSON diff"}),l.jsonView]})]}):(0,t.jsx)(r.a,{paddingTop:1,children:"No changes in the dashboard JSON"})]})}},70497:(k,R,e)=>{"use strict";e.d(R,{$:()=>$e});var t=e(74848),n=e(96540),i=e(17172),s=e(32264),r=e(87978),g=e(63021),a=e(40675),c=e(56596),o=e(32196),h=e(16817),f=e(40845),d=e(42418),p=e(27677);function m({dashboard:ze}){const qe=(0,f.of)(v),{loading:dt,value:vt,error:yt}=(0,h.A)(async()=>{const Ve=ze.getSaveModelCloneOld();return p.IB.validateDashboard(Ve).catch(Ee=>{if(Ee.status>=500)throw Ee;return Ee.data})},[ze]);let st;if(dt)st=(0,t.jsx)(d.F,{severity:"info",title:"Checking dashboard validity"});else if(vt)vt.isValid||(st=(0,t.jsxs)(d.F,{severity:"warning",title:"Dashboard failed schema validation",children:[(0,t.jsx)("p",{children:"Validation is provided for development purposes and should be safe to ignore. If you are a Grafana developer, consider checking and updating the dashboard schema"}),(0,t.jsx)("div",{className:qe.error,children:vt.message})]}));else{const Ve=yt?.message??"Unknown error";st=(0,t.jsx)(d.F,{severity:"info",title:"Error checking dashboard validity",children:(0,t.jsx)("p",{className:qe.error,children:Ve})})}return st?(0,t.jsx)("div",{className:qe.root,children:st}):null}const v=ze=>({root:(0,o.css)({marginTop:ze.spacing(1)}),error:(0,o.css)({fontFamily:ze.typography.fontFamilyMonospace,whiteSpace:"pre-wrap",overflowX:"auto",maxWidth:"100%"})}),l=m;var y=e(54943),u=e(96374),D=e(37390),E=e(55852),x=e(78050),P=e(41053),b=e(71733),M=e(14110),O=e(39601),I=e(28138),T=e(3169),C=e(91219),S=e(55314),A=e(31678),L=e(28444),N=e(36974);const F=async(ze,qe,dt,vt)=>{const yt=await vt({dashboard:ze,folderUid:qe.folderUid??dt.meta.folderUid??ze.meta?.folderUid,message:qe.message,overwrite:qe.overwrite,k8s:dt.meta.k8s});if("error"in yt)throw yt.error;return yt.data},w=(ze=!1)=>{const qe=(0,A.useDispatch)(),dt=(0,T._2)(),[vt]=(0,S.e8)(),[yt,st]=(0,P.A)(async(Ve,pe,Ee)=>{try{const me=await F(Ve,pe,Ee,vt);Ee.version=me.version,Ve.version=me.version,Ee.clearUnsavedChanges(Ve,pe),I.A.publish(new L.Eu),dt.success("Dashboard saved"),(0,N.ko)(me.uid),ze?(0,M.rR)("grafana_dashboard_copied",{name:Ee.title,url:me.url}):(0,M.rR)(`grafana_dashboard_${Ee.id?"saved":"created"}`,{name:Ee.title,url:me.url});const ve=O.Ny.getLocation().pathname,Se=b.I.stripBaseFromUrl(me.url);return Se!==ve&&me.url&&setTimeout(()=>O.Ny.replace(Se)),Ee.meta.isStarred&&qe((0,C.TU)({id:Ee.uid,title:Ee.title,url:Se})),me}catch(me){throw me instanceof Error&&dt.error(me.message??"Error saving dashboard"),me}},[qe,dt]);return{state:yt,onDashboardSave:st}},B=({dashboard:ze,dashboardSaveModel:qe,error:dt,onDismiss:vt,setErrorIsHandled:yt})=>{const{onDashboardSave:st}=w();return(0,t.jsxs)(t.Fragment,{children:[dt.data&&dt.data.status==="version-mismatch"&&(0,t.jsx)(u.u,{isOpen:!0,title:"Conflict",body:(0,t.jsxs)("div",{children:["Someone else has updated this dashboard ",(0,t.jsx)("br",{})," ",(0,t.jsx)("small",{children:"Would you still like to save this dashboard?"})]}),confirmText:"Save and overwrite",onConfirm:async()=>{await st(qe,{overwrite:!0},ze),vt()},onDismiss:vt}),dt.data&&dt.data.status==="name-exists"&&(0,t.jsx)(u.u,{isOpen:!0,title:"Conflict",body:(0,t.jsxs)("div",{children:["A dashboard with the same name in selected folder already exists. ",(0,t.jsx)("br",{}),(0,t.jsx)("small",{children:"Would you still like to save this dashboard?"})]}),confirmText:"Save and overwrite",onConfirm:async()=>{await st(qe,{overwrite:!0},ze),vt()},onDismiss:vt}),dt.data&&dt.data.status==="plugin-dashboard"&&(0,t.jsx)(U,{dashboard:ze,onDismiss:()=>{yt(!0),vt()}})]})},U=({onDismiss:ze,dashboard:qe})=>{const{onDashboardSave:dt}=w(),vt=(0,f.of)(V);return(0,t.jsxs)(D.a,{className:vt.modal,title:"Plugin dashboard",icon:"copy",isOpen:!0,onDismiss:ze,children:[(0,t.jsxs)("div",{className:vt.modalText,children:["Your changes will be lost when you update the plugin.",(0,t.jsx)("br",{}),(0,t.jsxs)("small",{children:["Use ",(0,t.jsx)("strong",{children:"Save As"})," to create custom version."]})]}),(0,t.jsxs)(D.a.ButtonRow,{children:[(0,t.jsx)(E.$n,{variant:"secondary",onClick:ze,fill:"outline",children:"Cancel"}),(0,t.jsx)(x.m,{onClick:ze,dashboard:qe,onSaveSuccess:ze}),(0,t.jsx)(E.$n,{variant:"destructive",onClick:async()=>{await dt(qe.getSaveModelClone(),{overwrite:!0},qe),ze()},children:"Overwrite"})]})]})},K=ze=>{switch(ze){case"version-mismatch":case"name-exists":case"plugin-dashboard":return!0;default:return!1}},V=ze=>({modal:(0,o.css)({width:"500px"}),modalText:(0,o.css)({fontSize:ze.typography.h4.fontSize,color:ze.colors.text.primary,marginBottom:ze.spacing(4),paddingTop:ze.spacing(2)}),modalButtonRow:(0,o.css)({marginBottom:"14px","a, button":{marginRight:ze.spacing(2)}})});var H=e(51253),Y=e(16504),X=e(88575),J=e(67061),q=e(60029),ae=e(10354),j=e(21744),te=e(15292),ne=e(36607),le=e(71500),z=e(81394),ee=e(27966);const se=ze=>{const qe=ze.getSaveModelClone();return qe.id=null,qe.uid="",qe.title+=" Copy",qe.editable=!0,ze.id>0&&qe.panels&&qe.panels.forEach(dt=>{dt.type==="graph"&&dt.alert&&delete dt.thresholds,delete dt.alert}),qe},ie=({dashboard:ze,isLoading:qe,isNew:dt,onSubmit:vt,onCancel:yt,onSuccess:st})=>{const Ve={title:dt?ze.title:`${ze.title} Copy`,description:ze.description,$folder:{uid:ze.meta.folderUid,title:ze.meta.folderTitle},copyTags:!1},pe=Ee=>async me=>{if(me&&me===Ee().$folder.title?.trim())return"Dashboard name cannot be the same as folder name";try{return await le.P.validateNewDashboardName(Ee().$folder.uid??"general",me),!0}catch(ve){return ve instanceof Error?ve.message:"Dashboard name is invalid"}};return(0,t.jsx)(H.l,{defaultValues:Ve,onSubmit:async Ee=>{if(!vt)return;const me=se(ze);me.title=Ee.title,me.description=Ee.description,!dt&&!Ee.copyTags&&(me.tags=[]),(await vt(me,{folderUid:Ee.$folder.uid},ze)).status==="success"&&st()},children:({register:Ee,control:me,errors:ve,getValues:Se})=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Y.e,{render:({field:{ref:Ie,...Oe}})=>(0,t.jsx)(X.D,{label:(0,t.jsxs)(J.B,{justifyContent:"space-between",children:[(0,t.jsx)(q.J,{htmlFor:"title",children:"Title"}),s.$.featureToggles.dashgpt&&dt&&(0,t.jsx)(ee.Z,{onGenerate:Re=>Oe.onChange(Re)})]}),invalid:!!ve.title,error:ve.title?.message,children:(0,t.jsx)(ae.p,{...Oe,onChange:Re=>Oe.onChange(Re.target.value),"aria-label":"Save dashboard title field",autoFocus:!0})}),control:me,name:"title",rules:{validate:pe(Se)}}),(0,t.jsx)(Y.e,{render:({field:{ref:Ie,...Oe}})=>(0,t.jsx)(X.D,{label:(0,t.jsxs)(J.B,{justifyContent:"space-between",children:[(0,t.jsx)(q.J,{htmlFor:"description",children:"Description"}),s.$.featureToggles.dashgpt&&dt&&(0,t.jsx)(z.V,{onGenerate:Re=>Oe.onChange(Re)})]}),invalid:!!ve.description,error:ve.description?.message,children:(0,t.jsx)(j.f,{...Oe,onChange:Re=>Oe.onChange(Re.target.value),"aria-label":"Save dashboard description field",autoFocus:!0})}),control:me,name:"description"}),(0,t.jsx)(X.D,{label:"Folder",children:(0,t.jsx)(Y.e,{render:({field:{ref:Ie,...Oe}})=>(0,t.jsx)(ne.d,{...Oe,onChange:(Re,he)=>Oe.onChange({uid:Re,title:he}),value:Oe.value?.uid,initialTitle:ze.meta.folderTitle,dashboardId:ze.id,enableCreateNew:!0}),control:me,name:"$folder"})}),!dt&&(0,t.jsx)(X.D,{label:"Copy tags",children:(0,t.jsx)(te.d,{...Ee("copyTags")})}),(0,t.jsxs)(J.B,{children:[(0,t.jsx)(E.$n,{type:"button",variant:"secondary",onClick:yt,fill:"outline",children:"Cancel"}),(0,t.jsx)(E.$n,{disabled:qe,type:"submit","aria-label":"Save dashboard button",children:qe?"Saving...":"Save"})]})]})})};var Z=e(13544),oe=e(10880),ce=e(10740),ye=e(57725),re=e(3363);const ue=["You are an expert in Grafana Dashboards","Your goal is to write a description of the changes for a dashboard to display to the user","You will be given human-readable diffs with most irrelevant lines filtered out"].join(`.
`),De=["Respond only with the diff description, which is meant to be loaded directly into the application for the user.",'If there are no substantial user or migration changes, the correct description is "Minor changes only"',`If there are too many changes of either kind, and those changes have a message saying 'too long', the correct response for that section is "Too many changes to auto-summarize"`,"In a diff, lines beginning with - are removed, and lines beginning with + are added.","Lines with neither + nor - are included for context. Be careful not to mark them as added or removed if they do not start with + or -.","If a line is changed, it will show a previous version removed and a new version added","When referring to panel changes, use the panel title","When using panel title, wrap it with double quotes","When the panel changes position, just mention that the panel has changed position","When an entire panel is added or removed, use the panel title and only say it was added or removed and disregard the rest of the changes for that panel","Group together similar changes into one line when multiple panels are affected","Refer to templating elements as variables","Try to make the response as short as possible"].join(`.
`),ge=({dashboard:ze,onGenerate:qe,disabled:dt})=>{const vt=(0,n.useCallback)(()=>Te(ze),[ze]);return(0,t.jsx)(ce.n,{messages:vt,onGenerate:qe,temperature:0,model:"gpt-3.5-turbo-16k",eventTrackingSrc:ye.ec.dashboardChanges,toggleTipTitle:"Improve your dashboard changes summary",disabled:dt})};function Te(ze){let{userChanges:qe,migrationChanges:dt}=(0,re.Yy)(ze);return qe.length>8e3&&(qe="User changes were too long, fill in the user changes section with 'User changes too long to auto-summarize'"),dt.split(`
`).length<10?dt="No significant migration changes":dt.length>8e3&&(dt="Migration changes were too long, fill in the migration changes section with 'Migration changes too long to auto-summarize'"),[{content:ue,role:re.Xh.system},{content:`Summarize the following user changes diff under "User changes":
${qe}`,role:re.Xh.system},{content:`Be sure to only include substantial user changes, such as adding or removing entire panels, changing panel titles or descriptions, etc.
Do not include "User Changes" section if there are no substantial user changes to report.`,role:re.Xh.system},{content:`Summarize the following migration changes diff under "Migration changes":
${dt}`,role:re.Xh.system},{content:`Be sure to only include substantial migration changes, such as adding or removing entire panels, changing panel titles or descriptions, etc.
Ignore any threshold step changes or templating list changes.
Ignore other changes and do not include them in the summary. Do not include "Migration Changes" section if there are no substantial migration changes to report.
If there are substantial migration changes, add "Some autogenerated changes are included to update the dashboard to the latest valid schema version" at the end.`,role:re.Xh.system},{content:De,role:re.Xh.system}]}const Le=({dashboard:ze,isLoading:qe,saveModel:dt,options:vt,onSubmit:yt,onCancel:st,onSuccess:Ve,onOptionsChange:pe})=>{const Ee=(0,n.useMemo)(()=>ze.hasTimeChanged(),[ze]),me=(0,n.useMemo)(()=>ze.hasVariablesChanged(),[ze]),[ve,Se]=(0,n.useState)(!1),[Ie,Oe]=(0,n.useState)(vt.message),Re=(0,f.of)(Ye);return(0,t.jsx)("form",{onSubmit:async he=>{if(he.preventDefault(),!yt)return;Se(!0),vt={...vt,message:Ie},(await yt(dt.clone,vt,ze)).status==="success"?Ve():Se(!1)},style:{maxWidth:600},children:(0,t.jsxs)(J.B,{gap:2,direction:"column",alignItems:"flex-start",children:[Ee&&(0,t.jsx)(oe.S,{checked:!!vt.saveTimerange,onChange:()=>pe({...vt,saveTimerange:!vt.saveTimerange}),label:"Save current time range as dashboard default","aria-label":Z.Tp.pages.SaveDashboardModal.saveTimerange}),me&&(0,t.jsx)(oe.S,{checked:!!vt.saveVariables,onChange:()=>pe({...vt,saveVariables:!vt.saveVariables}),label:"Save current variable values as dashboard default","aria-label":Z.Tp.pages.SaveDashboardModal.saveVariables}),(0,t.jsxs)("div",{className:Re.message,children:[s.$.featureToggles.aiGeneratedDashboardChanges&&(0,t.jsx)(ge,{dashboard:ze,onGenerate:he=>{pe({...vt,message:he}),Oe(he)},disabled:!dt.hasChanges}),(0,t.jsx)(j.f,{"aria-label":"message",value:Ie,onChange:he=>{pe({...vt,message:he.currentTarget.value}),Oe(he.currentTarget.value)},placeholder:"Add a note to describe your changes.",autoFocus:!0,rows:5})]}),(0,t.jsxs)(J.B,{alignItems:"center",children:[(0,t.jsx)(E.$n,{variant:"secondary",onClick:st,fill:"outline",children:"Cancel"}),(0,t.jsx)(E.$n,{type:"submit",disabled:!dt.hasChanges||qe,icon:ve?"spinner":void 0,"aria-label":Z.Tp.pages.SaveDashboardModal.save,children:qe?"Saving...":"Save"}),!dt.hasChanges&&(0,t.jsx)("div",{children:"No changes to save"})]})]})})};function Ye(ze){return{message:(0,o.css)({display:"flex",alignItems:"end",flexDirection:"column",width:"100%"})}}var je=e(4213),Ze=e(66864),Ne=e(10534);const Pe=({dashboard:ze,onCancel:qe})=>{const[dt,vt]=(0,n.useState)(()=>{const st=ze.getSaveModelClone();return delete st.id,JSON.stringify(st,null,2)}),yt=(0,n.useCallback)(()=>{const st=new Blob([dt],{type:"application/json;charset=utf-8"});(0,je.saveAs)(st,ze.title+"-"+new Date().getTime()+".json")},[ze.title,dt]);return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(J.B,{direction:"column",gap:2,children:[(0,t.jsxs)("div",{children:["This dashboard cannot be saved from the Grafana UI because it has been provisioned from another source. Copy the JSON or save it to a file below, then you can update your dashboard in the provisioning source.",(0,t.jsx)("br",{}),(0,t.jsxs)("i",{children:["See"," ",(0,t.jsx)("a",{className:"external-link",href:"https://grafana.com/docs/grafana/latest/administration/provisioning/#dashboards",target:"_blank",rel:"noreferrer",children:"documentation"})," ","for more information about provisioning."]}),(0,t.jsx)("br",{})," ",(0,t.jsx)("br",{}),(0,t.jsx)("strong",{children:"File path: "})," ",ze.meta.provisionedExternalId]}),(0,t.jsx)(j.f,{spellCheck:!1,value:dt,onChange:st=>{vt(st.currentTarget.value)},className:Ue.json}),(0,t.jsxs)(Ze.Gy,{children:[(0,t.jsx)(E.$n,{variant:"secondary",onClick:qe,fill:"outline",children:"Cancel"}),(0,t.jsx)(Ne.b,{icon:"copy",getText:()=>dt,children:"Copy JSON to clipboard"}),(0,t.jsx)(E.$n,{type:"submit",onClick:yt,children:"Save JSON to file"})]})]})})},Ue={json:(0,o.css)({height:"400px",width:"100%",overflow:"auto",resize:"none",fontFamily:"monospace"})},$e=({dashboard:ze,onDismiss:qe,onSaveSuccess:dt,isCopy:vt})=>{const[yt,st]=(0,n.useState)({}),Ve=ze.getOriginalDashboard(),pe=ze.meta.provisioned,Ee=ze.version===0,me=!!ze.meta.hasUnsavedFolderChange,[ve,Se]=(0,n.useState)(!1),Ie=(0,n.useMemo)(()=>{const nt=ze.getSaveModelClone({saveTimerange:!!yt.saveTimerange,saveVariables:!!yt.saveVariables});if(!Ve)return{clone:nt,diff:{},diffCount:0,hasChanges:!1};const gt=(0,c.G4)(Ve,nt);let xt=0;for(const St of Object.values(gt))xt+=St.length;return{clone:nt,diff:gt,diffCount:xt,hasChanges:(xt>0||me)&&!Ee}},[ze,Ve,yt,Ee,me]),[Oe,Re]=(0,n.useState)(!1),{state:he,onDashboardSave:Ce}=w(vt),We=dt?()=>{qe(),dt()}:qe,et=()=>Oe?(0,t.jsx)(y.l,{diff:Ie.diff,oldValue:Ve,newValue:Ie.clone}):Ee||vt?(0,t.jsx)(ie,{dashboard:ze,isLoading:he.loading,onCancel:qe,onSuccess:We,onSubmit:Ce,isNew:Ee}):pe?(0,t.jsx)(Pe,{dashboard:ze,onCancel:qe,onSuccess:We}):(0,t.jsx)(Le,{dashboard:ze,isLoading:he.loading,saveModel:Ie,onCancel:qe,onSuccess:We,onSubmit:Ce,options:yt,onOptionsChange:st});if(he.error&&!ve&&(0,i.NF)(he.error)&&K(he.error.data.status))return(0,t.jsx)(B,{error:he.error,dashboard:ze,dashboardSaveModel:Ie.clone,onDismiss:qe,setErrorIsHandled:Se});let rt="Save dashboard";return vt?rt="Save dashboard copy":pe&&(rt="Provisioned dashboard"),(0,t.jsxs)(r._,{title:rt,onClose:qe,subtitle:ze.title,tabs:(0,t.jsxs)(g.U,{children:[(0,t.jsx)(a.o,{label:"Details",active:!Oe,onChangeTab:()=>Re(!1)}),Ie.hasChanges&&(0,t.jsx)(a.o,{label:"Changes",active:Oe,onChangeTab:()=>Re(!0),counter:Ie.diffCount})]}),children:[et(),s.$.featureToggles.showDashboardValidationWarnings&&(0,t.jsx)(l,{dashboard:ze})]})}},35280:(k,R,e)=>{"use strict";e.d(R,{D:()=>m});var t=e(74848),n=e(96540),i=e(94701),s=e(14110),r=e(88575),g=e(15292),a=e(21744),c=e(37390),o=e(10534),h=e(8484),f=e(7758),d=e(87895),p=e(22699);function m({panel:v,dashboard:l,range:y,buildIframe:u=p.CF}){const[D,E]=(0,n.useState)(!0),[x,P]=(0,n.useState)("current"),[b,M]=(0,n.useState)("");(0,i.A)(()=>{(0,s.rR)("grafana_dashboards_embed_share_viewed",{shareResource:(0,p.hD)(v)})}),(0,n.useEffect)(()=>{const A=u(D,l.uid,x,v,y);M(A)},[x,D,l,v,y,u]);const O=A=>{M(A.currentTarget.value)},I=()=>{E(A=>!A)},T=A=>{P(A)},S=l.time.to==="now"?(0,h.t)("share-modal.embed.time-range-description","Transforms the current relative time range to an absolute time range"):"";return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:"share-modal-info-text",children:(0,t.jsx)(h.x6,{i18nKey:"share-modal.embed.info",children:"Generate HTML for embedding an iframe with this panel."})}),(0,t.jsx)(r.D,{label:(0,h.t)("share-modal.embed.time-range","Current time range"),description:S,children:(0,t.jsx)(g.d,{id:"share-current-time-range",value:D,onChange:I})}),(0,t.jsx)(d.w,{selectedTheme:x,onChange:T}),(0,t.jsx)(r.D,{label:(0,h.t)("share-modal.embed.html","Embed HTML"),description:(0,h.t)("share-modal.embed.html-description","The HTML code below can be pasted and included in another web page. Unless anonymous access is enabled, the user viewing that page need to be signed into Grafana for the graph to load."),children:(0,t.jsx)(a.f,{"data-testid":"share-embed-html",id:"share-panel-embed-embed-html-textarea",rows:5,value:b,onChange:O})}),(0,t.jsx)(c.a.ButtonRow,{children:(0,t.jsx)(o.b,{icon:"copy",variant:"primary",getText:()=>b,onClipboardCopy:()=>{f.c.embedSnippetCopy({currentTimeRange:D,theme:x,shareResource:(0,p.hD)(v)})},children:(0,t.jsx)(h.x6,{i18nKey:"share-modal.embed.copy",children:"Copy to clipboard"})})})]})}},86394:(k,R,e)=>{"use strict";e.d(R,{j:()=>a});var t=e(74848),n=e(96540),i=e(14110),s=e(8484),r=e(96227),g=e(22699);const a=({panel:c,initialFolderUid:o,onCreateLibraryPanel:h,onDismiss:f})=>((0,n.useEffect)(()=>{(0,i.rR)("grafana_dashboards_library_panel_share_viewed",{shareResource:(0,g.hD)(c)})},[c]),c?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:"share-modal-info-text",children:(0,t.jsx)(s.x6,{i18nKey:"share-modal.library.info",children:"Create library panel."})}),(0,t.jsx)(r.b,{panel:c,initialFolderUid:o,onCreateLibraryPanel:h,onDismiss:f})]}):null)},7686:(k,R,e)=>{"use strict";e.d(R,{Zy:()=>se});var t=e(74848),n=e(96540),i=e(25897),s=e(37390),r=e(40980),g=e(40845),a=e(2913),c=e(10096),o=e(8484),h=e(4785),f=e(72254),d=e(7758),p=e(82792),m=e(35280),v=e(4213),l=e(88575),y=e(15292),u=e(55852),D=e(15858),E=e(28444),x=e(70713),P=e(32372),b=e(10534);function M({json:ie,onDismiss:Z}){const oe=(0,n.useCallback)(()=>ie,[ie]);return(0,t.jsxs)(s.a,{title:"JSON",onDismiss:Z,onClickBackdrop:Z,isOpen:!0,children:[(0,t.jsx)(x.Ay,{disableHeight:!0,children:({width:ce})=>(0,t.jsx)(P.B,{value:ie,language:"json",showMiniMap:!1,height:"500px",width:ce})}),(0,t.jsx)(s.a.ButtonRow,{children:(0,t.jsx)(b.b,{icon:"copy",getText:oe,onClipboardCopy:()=>{d.c.exportCopyJsonClicked()},children:(0,t.jsx)(o.x6,{i18nKey:"share-modal.view-json.copy-button",children:"Copy to Clipboard"})})})]})}var O=e(22699);class I extends n.PureComponent{constructor(Z){super(Z),this.onShareExternallyChange=()=>{this.setState({shareExternally:!this.state.shareExternally})},this.onSaveAsFile=()=>{const{dashboard:oe}=this.props,{shareExternally:ce}=this.state;d.c.exportSaveJsonClicked({externally:ce,shareResource:(0,O.hD)(this.props.panel)}),ce?this.exporter.makeExportable(oe).then(ye=>{this.openSaveAsDialog(ye)}):this.openSaveAsDialog(oe.getSaveModelClone())},this.onViewJson=()=>{const{dashboard:oe}=this.props,{shareExternally:ce}=this.state;d.c.exportViewJsonClicked({externally:ce,shareResource:(0,O.hD)(this.props.panel)}),ce?this.exporter.makeExportable(oe).then(ye=>{this.openJsonModal(ye)}):this.openJsonModal(oe.getSaveModelClone())},this.openSaveAsDialog=oe=>{const ce=JSON.stringify(oe,null,2),ye=new Blob([ce],{type:"application/json;charset=utf-8"}),re=new Date().getTime();(0,v.saveAs)(ye,`${oe.title}-${re}.json`)},this.openJsonModal=oe=>{c.lE.publish(new E.S8({props:{json:JSON.stringify(oe,null,2)},component:M})),this.props.onDismiss?.()},this.state={shareExternally:!1},this.exporter=new D.M}render(){const{onDismiss:Z}=this.props,{shareExternally:oe}=this.state,ce=(0,o.t)("share-modal.export.share-externally-label","Export for sharing externally");return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:"share-modal-info-text",children:(0,t.jsx)(o.x6,{i18nKey:"share-modal.export.info-text",children:"Export this dashboard."})}),(0,t.jsx)(l.D,{label:ce,children:(0,t.jsx)(y.d,{id:"share-externally-toggle",value:oe,onChange:this.onShareExternallyChange})}),(0,t.jsxs)(s.a.ButtonRow,{children:[(0,t.jsx)(u.$n,{variant:"secondary",onClick:Z,fill:"outline",children:(0,t.jsx)(o.x6,{i18nKey:"share-modal.export.cancel-button",children:"Cancel"})}),(0,t.jsx)(u.$n,{variant:"secondary",onClick:this.onViewJson,children:(0,t.jsx)(o.x6,{i18nKey:"share-modal.export.view-button",children:"View JSON"})}),(0,t.jsx)(u.$n,{variant:"primary",onClick:this.onSaveAsFile,children:(0,t.jsx)(o.x6,{i18nKey:"share-modal.export.save-button",children:"Save to file"})})]})]})}}var T=e(86394),C=e(13544),S=e(84167),A=e(10354),L=e(72109),N=e(42418),F=e(87895);class w extends n.PureComponent{constructor(Z){super(Z),this.buildUrl=async()=>{const{panel:oe,dashboard:ce}=this.props,{useCurrentTimeRange:ye,useShortUrl:re,selectedTheme:ue}=this.state,De=await(0,O.Xe)(ye,ue,oe,re),ge=(0,O.Lb)(ye,ce.uid,ue,oe);this.setState({shareUrl:De,imageUrl:ge})},this.onUseCurrentTimeRangeChange=()=>{this.setState({useCurrentTimeRange:!this.state.useCurrentTimeRange})},this.onUrlShorten=()=>{this.setState({useShortUrl:!this.state.useShortUrl})},this.onThemeChange=oe=>{this.setState({selectedTheme:oe})},this.getShareUrl=()=>this.state.shareUrl,this.onCopy=()=>{d.c.shareLinkCopied({currentTimeRange:this.state.useCurrentTimeRange,theme:this.state.selectedTheme,shortenURL:this.state.useShortUrl,shareResource:(0,O.hD)(this.props.panel)})},this.state={useCurrentTimeRange:!0,useShortUrl:!1,selectedTheme:"current",shareUrl:"",imageUrl:""}}componentDidMount(){this.buildUrl()}componentDidUpdate(Z,oe){const{useCurrentTimeRange:ce,useShortUrl:ye,selectedTheme:re}=this.state;(oe.useCurrentTimeRange!==ce||oe.selectedTheme!==re||oe.useShortUrl!==ye)&&this.buildUrl()}render(){const{panel:Z,dashboard:oe}=this.props,ce=oe?oe.time.to==="now":!1,{useCurrentTimeRange:ye,useShortUrl:re,selectedTheme:ue,shareUrl:De,imageUrl:ge}=this.state,Te=C.Tp.pages.SharePanelModal,Le=!!oe.id,Ye=(0,o.t)("share-modal.link.time-range-label","Lock time range"),je=(0,o.t)("share-modal.link.time-range-description","Transforms the current relative time range to an absolute time range"),Ze=(0,o.t)("share-modal.link.shorten-url","Shorten URL"),Ne=(0,o.t)("share-modal.link.link-url","Link URL");return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:"share-modal-info-text",children:(0,t.jsx)(o.x6,{i18nKey:"share-modal.link.info-text",children:"Create a direct link to this dashboard or panel, customized with the options below."})}),(0,t.jsxs)(S.n,{children:[(0,t.jsx)(l.D,{label:Ye,description:ce?je:"",children:(0,t.jsx)(y.d,{id:"share-current-time-range",value:ye,onChange:this.onUseCurrentTimeRangeChange})}),(0,t.jsx)(F.w,{selectedTheme:ue,onChange:this.onThemeChange}),(0,t.jsx)(l.D,{label:Ze,children:(0,t.jsx)(y.d,{id:"share-shorten-url",value:re,onChange:this.onUrlShorten})}),(0,t.jsx)(l.D,{label:Ne,children:(0,t.jsx)(A.p,{id:"link-url-input",value:De,readOnly:!0,addonAfter:(0,t.jsx)(b.b,{icon:"copy",variant:"primary",getText:this.getShareUrl,onClipboardCopy:this.onCopy,children:(0,t.jsx)(o.x6,{i18nKey:"share-modal.link.copy-link-button",children:"Copy"})})})})]}),Z&&a.Ay.rendererAvailable&&(0,t.jsxs)(t.Fragment,{children:[Le&&(0,t.jsx)(L.Y,{href:ge,external:!0,icon:"camera","aria-label":Te.linkToRenderedImage,children:(0,o.t)("share-modal.link.rendered-image","Direct link rendered image")}),!Le&&(0,t.jsx)(N.F,{severity:"info",title:(0,o.t)("share-modal.link.save-alert","Dashboard is not saved"),bottomSpacing:0,children:(0,t.jsx)(o.x6,{i18nKey:"share-modal.link.save-dashboard",children:"To render a panel image, you must save the dashboard first."})})]}),Z&&!a.Ay.rendererAvailable&&(0,t.jsx)(N.F,{severity:"info",title:(0,o.t)("share-modal.link.render-alert","Image renderer plugin not installed"),bottomSpacing:0,children:(0,t.jsxs)(o.x6,{i18nKey:"share-modal.link.render-instructions",children:["To render a panel image, you must install the"," ",(0,t.jsx)(L.Y,{href:"https://grafana.com/grafana/plugins/grafana-image-renderer",external:!0,children:"Grafana image renderer plugin"}),". Please contact your Grafana administrator to install the plugin."]})})]})}}var B=e(92041),U=e(12470),K=e(17172),V=e(90182),H=e(67061),Y=e(62930),X=e(74856),J=e(69064);class q extends n.PureComponent{constructor(Z){super(Z),this.createSnapshot=oe=>()=>{const{timeoutSeconds:ce}=this.state;this.dashboard.snapshot={timestamp:new Date},this.setState({isLoading:!0}),this.dashboard.startRefresh(),setTimeout(()=>{this.saveSnapshot(this.dashboard,oe)},ce*1e3)},this.saveSnapshot=async(oe,ce)=>{const{snapshotExpires:ye,timeoutSeconds:re}=this.state,ue=this.dashboard.getSaveModelCloneOld();this.scrubDashboard(ue);const De={dashboard:ue,name:ue.title,expires:ye,external:ce};try{const ge=await(0,J.s)().create(De);this.setState({deleteUrl:ge.deleteUrl,snapshotUrl:ge.url,step:2})}finally{ce?d.c.publishSnapshotClicked({expires:ye,timeout:re,shareResource:(0,O.hD)(this.props.panel)}):d.c.publishSnapshotLocalClicked({expires:ye,timeout:re,shareResource:(0,O.hD)(this.props.panel)}),this.setState({isLoading:!1})}},this.scrubDashboard=oe=>{const{panel:ce}=this.props,{snapshotName:ye}=this.state;oe.title=ye,oe.time=(0,X.jG)().timeRange(),oe.links=[],oe.panels.forEach(ue=>{ue.targets=[],ue.links=[],ue.datasource=null});const re=oe.annotations.list.filter(ue=>ue.enable);if(oe.annotations.list=re.map(ue=>({name:ue.name,enable:ue.enable,iconColor:ue.iconColor,snapshotData:ue.snapshotData,type:ue.type,builtIn:ue.builtIn,hide:ue.hide})),oe.getVariables().forEach(ue=>{"query"in ue&&(ue.query=""),"options"in ue&&(ue.options=ue.current&&!(0,B.R)(ue.current)?[ue.current]:[]),"refresh"in ue&&(ue.refresh=U.CO.never)}),ce){const ue=ce.getSaveModel();ue.gridPos.w=24,ue.gridPos.x=0,ue.gridPos.y=0,ue.gridPos.h=20,oe.panels=[ue]}delete this.dashboard.snapshot,this.dashboard.forEachPanel(ue=>{delete ue.snapshotData}),this.dashboard.annotations.list.forEach(ue=>{delete ue.snapshotData})},this.deleteSnapshot=async()=>{const{deleteUrl:oe}=this.state;await(0,K.AI)().get(oe),this.setState({step:3})},this.getSnapshotUrl=()=>this.state.snapshotUrl,this.onSnapshotNameChange=oe=>{this.setState({snapshotName:oe.target.value})},this.onTimeoutChange=oe=>{this.setState({timeoutSeconds:Number(oe.target.value)})},this.onExpireChange=oe=>{this.setState({selectedExpireOption:oe,snapshotExpires:oe.value})},this.dashboard=Z.dashboard,this.expireOptions=[{label:(0,o.t)("share-modal.snapshot.expire-hour","1 Hour"),value:60*60},{label:(0,o.t)("share-modal.snapshot.expire-day","1 Day"),value:60*60*24},{label:(0,o.t)("share-modal.snapshot.expire-week","1 Week"),value:60*60*24*7},{label:(0,o.t)("share-modal.snapshot.expire-never","Never"),value:0}],this.state={isLoading:!1,step:1,selectedExpireOption:this.expireOptions[2],snapshotExpires:this.expireOptions[2].value,snapshotName:Z.dashboard.title,timeoutSeconds:4,snapshotUrl:"",deleteUrl:"",externalEnabled:!1,sharingButtonText:""}}componentDidMount(){this.getSnaphotShareOptions()}async getSnaphotShareOptions(){const Z=await(0,J.s)().getSharingOptions();this.setState({sharingButtonText:Z.externalSnapshotName,externalEnabled:Z.externalEnabled})}renderStep1(){const{onDismiss:Z}=this.props,{snapshotName:oe,selectedExpireOption:ce,timeoutSeconds:ye,isLoading:re,sharingButtonText:ue,externalEnabled:De}=this.state,ge=(0,o.t)("share-modal.snapshot.name","Snapshot name"),Te=(0,o.t)("share-modal.snapshot.expire","Expire"),Le=(0,o.t)("share-modal.snapshot.timeout","Timeout (seconds)"),Ye=(0,o.t)("share-modal.snapshot.timeout-description","You might need to configure the timeout value if it takes a long time to collect your dashboard metrics.");return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"share-modal-info-text",children:(0,t.jsx)(o.x6,{i18nKey:"share-modal.snapshot.info-text-1",children:"A snapshot is an instant way to share an interactive dashboard publicly. When created, we strip sensitive data like queries (metric, template, and annotation) and panel links, leaving only the visible metric data and series names embedded in your dashboard."})}),(0,t.jsx)("p",{className:"share-modal-info-text",children:(0,t.jsxs)(o.x6,{i18nKey:"share-modal.snapshot.info-text-2",children:["Keep in mind, your snapshot ",(0,t.jsx)("em",{children:"can be viewed by anyone"})," that has the link and can access the URL. Share wisely."]})})]}),(0,t.jsx)(l.D,{label:ge,children:(0,t.jsx)(A.p,{id:"snapshot-name-input",width:30,value:oe,onChange:this.onSnapshotNameChange})}),(0,t.jsx)(l.D,{label:Te,children:(0,t.jsx)(V.l6,{inputId:"expire-select-input",width:30,options:this.expireOptions,value:ce,onChange:this.onExpireChange})}),(0,t.jsx)(l.D,{label:Le,description:Ye,children:(0,t.jsx)(A.p,{id:"timeout-input",type:"number",width:21,value:ye,onChange:this.onTimeoutChange})}),(0,t.jsxs)(s.a.ButtonRow,{children:[(0,t.jsx)(u.$n,{variant:"secondary",onClick:Z,fill:"outline",children:(0,t.jsx)(o.x6,{i18nKey:"share-modal.snapshot.cancel-button",children:"Cancel"})}),De&&(0,t.jsx)(u.$n,{variant:"secondary",disabled:re,onClick:this.createSnapshot(!0),children:ue}),(0,t.jsx)(u.$n,{variant:"primary",disabled:re,onClick:this.createSnapshot(),children:(0,t.jsx)(o.x6,{i18nKey:"share-modal.snapshot.local-button",children:"Publish Snapshot"})})]})]})}renderStep2(){const{snapshotUrl:Z}=this.state;return(0,t.jsxs)(H.B,{direction:"column",gap:0,children:[(0,t.jsx)(l.D,{label:(0,o.t)("share-modal.snapshot.url-label","Snapshot URL"),children:(0,t.jsx)(A.p,{id:"snapshot-url-input",value:Z,readOnly:!0,addonAfter:(0,t.jsx)(b.b,{icon:"copy",variant:"primary",getText:this.getSnapshotUrl,children:(0,t.jsx)(o.x6,{i18nKey:"share-modal.snapshot.copy-link-button",children:"Copy"})})})}),(0,t.jsxs)("div",{style:{alignSelf:"flex-end",padding:"5px"},children:[(0,t.jsx)(o.x6,{i18nKey:"share-modal.snapshot.mistake-message",children:"Did you make a mistake? "}),"\xA0",(0,t.jsx)(u.z9,{fill:"text",target:"_blank",onClick:this.deleteSnapshot,children:(0,t.jsx)(o.x6,{i18nKey:"share-modal.snapshot.delete-button",children:"Delete snapshot."})})]})]})}renderStep3(){return(0,t.jsx)("div",{className:"share-modal-header",children:(0,t.jsx)("p",{className:"share-modal-info-text",children:(0,t.jsx)(o.x6,{i18nKey:"share-modal.snapshot.deleted-message",children:"The snapshot has been deleted. If you have already accessed it once, then it might take up to an hour before before it is removed from browser caches or CDN caches."})})})}render(){const{isLoading:Z,step:oe}=this.state;return(0,t.jsxs)(t.Fragment,{children:[oe===1&&this.renderStep1(),oe===2&&this.renderStep2(),oe===3&&this.renderStep3(),Z&&(0,t.jsx)(Y.y,{inline:!0})]})}}const ae=[],j=[];function te(ie){ae.push(ie)}function ne(ie){j.push(ie)}function le(ie,Z,oe){const ye=[{label:(0,o.t)("share-modal.tab-title.link","Link"),value:O.wr.link,component:w}];if(c.TP.isSignedIn&&a.config.snapshotEnabled&&ie){const ue=(0,o.t)("share-modal.tab-title.snapshot","Snapshot");ye.push({label:ue,value:O.wr.snapshot,component:q})}if(Z){const ue=(0,o.t)("share-modal.tab-title.embed","Embed");if(ye.push({label:ue,value:O.wr.embed,component:m.D}),!(0,p.X)(Z)){const De=(0,o.t)("share-modal.tab-title.library-panel","Library panel");ye.push({label:De,value:O.wr.libraryPanel,component:T.j})}ye.push(...j)}else{const ue=(0,o.t)("share-modal.tab-title.export","Export");ye.push({label:ue,value:O.wr.export,component:I}),ye.push(...ae),(0,f.iR)()&&ye.push({label:(0,o.t)("share-modal.tab-title.public-dashboard-title","Public dashboard"),value:O.wr.publicDashboard,component:h.b})}const re=ye.find(ue=>ue.value===oe);return{tabs:ye,activeTab:re?.value??ye[0].value}}function z(ie){const{tabs:Z,activeTab:oe}=le(ie.dashboard.canEditDashboard(),ie.panel,ie.activeTab);return{tabs:Z,activeTab:oe}}class ee extends n.Component{constructor(Z){super(Z),this.onSelectTab=oe=>{this.setState(ce=>({...ce,activeTab:oe.value})),d.c.sharingCategoryClicked({item:oe.value,shareResource:(0,O.hD)(this.props.panel)})},this.state=z(Z)}getActiveTab(){const{tabs:Z,activeTab:oe}=this.state;return Z.find(ce=>ce.value===oe)}renderTitle(){const{panel:Z}=this.props,{activeTab:oe}=this.state,ce=Z?(0,o.t)("share-modal.panel.title","Share Panel"):(0,o.t)("share-modal.dashboard.title","Share"),ye=this.props.dashboard.canEditDashboard(),re=le(ye,this.props.panel,this.state.activeTab).tabs;return(0,t.jsx)(i.J,{title:ce,icon:"share-alt",tabs:re,activeTab:oe,onChangeTab:this.onSelectTab})}render(){const{dashboard:Z,panel:oe}=this.props,ye=this.getActiveTab().component;return(0,t.jsx)(s.a,{isOpen:!0,title:this.renderTitle(),onDismiss:this.props.onDismiss,children:(0,t.jsx)(r.J,{children:(0,t.jsx)(ye,{dashboard:Z,panel:oe,onDismiss:this.props.onDismiss})})})}}const se=(0,g.cV)(ee)},59037:(k,R,e)=>{"use strict";e.d(R,{K:()=>ce,b:()=>oe});var t=e(74848),n=e(32196),i=e(49785),s=e(13544),r=e(40845),g=e(88575),a=e(10354),c=e(10534),o=e(15292),h=e(60029),f=e(66864),d=e(55852),p=e(71678),m=e(8484),v=e(72686),l=e(21380),y=e(7758),u=e(90591),D=e(16233),E=e(31678),x=e(52908);const P=()=>{const{width:re}=(0,x.A)();return re>1024};var b=e(7686),M=e(22699),O=e(29304),I=e(42418);const T=()=>(0,t.jsx)(I.F,{title:(0,m.t)("public-dashboard.modal-alerts.save-dashboard-changes-alert-title","Please save your dashboard changes before updating the public configuration"),severity:"warning",bottomSpacing:0});var C=e(12257),S=e(10872),A=e(72254),L=e(84167),N=e(54230);const F=s.Tp.pages.ShareDashboardModal.PublicDashboard,w=({disabled:re,onChange:ue,register:De,timeRange:ge})=>(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(L.n,{disabled:re,children:(0,t.jsxs)(f.gW,{spacing:"md",children:[(0,t.jsxs)(f.PE,{orientation:1,spacing:"xs",justify:"space-between",children:[(0,t.jsx)(h.J,{description:(0,m.t)("public-dashboard.settings-configuration.default-time-range-label-desc","The public dashboard uses the default time range settings of the dashboard"),children:(0,t.jsx)(m.x6,{i18nKey:"public-dashboard.settings-configuration.default-time-range-label",children:"Default time range"})}),(0,t.jsx)(N.b,{value:ge,disabled:!0,onChange:()=>{}})]}),(0,t.jsxs)(f.PE,{orientation:0,spacing:"sm",children:[(0,t.jsx)(o.d,{...De("isTimeSelectionEnabled"),"data-testid":F.EnableTimeRangeSwitch,onChange:Te=>{ue("isTimeSelectionEnabled",Te.currentTarget.checked),y.c.publicDashboardTimeSelectionChanged({enabled:Te.currentTarget.checked})}}),(0,t.jsx)(h.J,{description:(0,m.t)("public-dashboard.settings-configuration.time-range-picker-label-desc","Allow viewers to change time range"),children:(0,t.jsx)(m.x6,{i18nKey:"public-dashboard.settings-configuration.time-range-picker-label",children:"Time range picker enabled"})})]}),(0,t.jsxs)(f.PE,{orientation:0,spacing:"sm",children:[(0,t.jsx)(o.d,{...De("isAnnotationsEnabled"),onChange:Te=>{ue("isAnnotationsEnabled",Te.currentTarget.checked),y.c.publicDashboardAnnotationsSelectionChanged({enabled:Te.currentTarget.checked})},"data-testid":F.EnableAnnotationsSwitch}),(0,t.jsx)(h.J,{description:(0,m.t)("public-dashboard.settings-configuration.show-annotations-label-desc","Show annotations on public dashboard"),children:(0,t.jsx)(m.x6,{i18nKey:"public-dashboard.settings-configuration.show-annotations-label",children:"Show annotations"})})]})]})})});var B=e(19727),U=e(94354),K=e(62930),V=e(34842);const H=s.Tp.pages.ShareDashboardModal.PublicDashboard.EmailSharingConfiguration,Y=({recipients:re,dashboardUid:ue,publicDashboardUid:De})=>{const ge=(0,r.of)(J),[Te,{isLoading:Le}]=(0,v.$L)(),[Ye,{isLoading:je}]=(0,v.NA)(),Ze=Le||je,Ne=(Ue,$e)=>{y.c.revokePublicDashboardEmailClicked(),Te({recipientUid:Ue,recipientEmail:$e,dashboardUid:ue,uid:De})},Pe=Ue=>{y.c.resendPublicDashboardEmailClicked(),Ye({recipientUid:Ue,uid:De})};return(0,t.jsx)("table",{className:ge.table,"data-testid":H.EmailSharingList,children:(0,t.jsx)("tbody",{children:re.map((Ue,$e)=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:Ue.recipient}),(0,t.jsx)("td",{children:(0,t.jsxs)(B.e,{className:ge.tableButtonsContainer,children:[(0,t.jsx)(d.$n,{type:"button",variant:"destructive",fill:"text",title:(0,m.t)("public-dashboard.email-sharing.revoke-button-title","Revoke"),size:"sm",disabled:Ze,onClick:()=>Ne(Ue.uid,Ue.recipient),"data-testid":`${H.DeleteEmail}-${$e}`,children:(0,t.jsx)(m.x6,{i18nKey:"public-dashboard.email-sharing.revoke-button",children:"Revoke"})}),(0,t.jsx)(d.$n,{type:"button",variant:"primary",fill:"text",title:(0,m.t)("public-dashboard.email-sharing.resend-button-title","Resend"),size:"sm",disabled:Ze,onClick:()=>Pe(Ue.uid),"data-testid":`${H.ReshareLink}-${$e}`,children:(0,t.jsx)(m.x6,{i18nKey:"public-dashboard.email-sharing.resend-button",children:"Resend"})})]})})]},Ue.uid))})})},X=({dashboard:re})=>{const{width:ue}=(0,x.A)(),De=(0,r.of)(J),ge=re instanceof V.H$?re.state.uid:re.uid,{data:Te}=(0,v.Bs)(ge),[Le]=(0,v.ft)(),[Ye,{isLoading:je}]=(0,v.NY)(),Ze=D.TP.hasPermission(E.AccessControlAction.DashboardsPublicWrite),{register:Ne,setValue:Pe,control:Ue,watch:$e,handleSubmit:ze,formState:{errors:qe},reset:dt}=(0,i.mN)({defaultValues:{shareType:Te?.share||A.Xo.PUBLIC,email:""},mode:"onSubmit"}),vt=st=>{const Ve={dashboard:re,payload:{...Te,share:st}};Le(Ve)},yt=async st=>{y.c.publicDashboardEmailInviteClicked(),await Ye({recipient:st.email,uid:Te.uid,dashboardUid:ge}).unwrap(),dt({email:"",shareType:A.Xo.EMAIL})};return(0,t.jsx)("form",{onSubmit:ze(yt),children:(0,t.jsxs)(L.n,{disabled:!Ze,"data-testid":H.Container,className:De.container,children:[(0,t.jsx)(g.D,{label:(0,m.t)("public-dashboard.config.can-view-dashboard-radio-button-label","Can view dashboard"),className:De.field,children:(0,t.jsx)(i.xI,{name:"shareType",control:Ue,render:({field:st})=>{const{ref:Ve,...pe}=st,Ee=[{label:(0,m.t)("public-dashboard.config.public-share-type-option-label","Anyone with a link"),value:A.Xo.PUBLIC},{label:(0,m.t)("public-dashboard.config.email-share-type-option-label","Only specified people"),value:A.Xo.EMAIL}];return(0,t.jsx)(U.z,{...pe,size:ue<480?"sm":"md",options:Ee,onChange:me=>{y.c.publicDashboardShareTypeChange({shareType:me===A.Xo.EMAIL?"email":"public"}),Pe("shareType",me),vt(me)}})}})}),$e("shareType")===A.Xo.EMAIL&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.D,{label:(0,m.t)("public-dashboard.email-sharing.invite-field-label","Invite"),description:(0,m.t)("public-dashboard.email-sharing.invite-field-desc","Invite people by email"),error:qe.email?.message,invalid:!!qe.email?.message||void 0,className:De.field,children:(0,t.jsxs)("div",{className:De.emailContainer,children:[(0,t.jsx)(a.p,{className:De.emailInput,placeholder:"email",autoCapitalize:"none",...Ne("email",{required:(0,m.t)("public-dashboard.email-sharing.input-required-email-text","Email is required"),pattern:{value:A._l,message:(0,m.t)("public-dashboard.email-sharing.input-invalid-email-text","Invalid email")}}),"data-testid":H.EmailSharingInput}),(0,t.jsxs)(d.$n,{type:"submit",variant:"primary",disabled:je,"data-testid":H.EmailSharingInviteButton,children:[(0,t.jsx)(m.x6,{i18nKey:"public-dashboard.email-sharing.invite-button",children:"Invite"}),je&&(0,t.jsx)(K.y,{})]})]})}),!!Te?.recipients?.length&&(0,t.jsx)(Y,{recipients:Te.recipients,dashboardUid:ge,publicDashboardUid:Te.uid})]})]})})},J=re=>({container:(0,n.css)({label:"emailConfigContainer",display:"flex",flexDirection:"column",flexWrap:"wrap",gap:re.spacing(3)}),field:(0,n.css)({label:"field-noMargin",marginBottom:0}),emailContainer:(0,n.css)({label:"emailContainer",display:"flex",gap:re.spacing(1)}),emailInput:(0,n.css)({label:"emailInput",flexGrow:1}),table:(0,n.css)({label:"table",display:"flex",maxHeight:"220px",overflowY:"scroll","& tbody":{display:"flex",flexDirection:"column",flexGrow:1},"& tr":{minHeight:"40px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:re.spacing(.5,1),":nth-child(odd)":{background:re.colors.background.secondary}}}),tableButtonsContainer:(0,n.css)({display:"flex",justifyContent:"end"})});var q=e(96540),ae=e(67892),j=e(29158);function te({headerElement:re,isContentVisible:ue=!1,onRowToggle:De,title:ge,...Te}){const Le=(0,r.of)(ne),Ye=re&&ae.renderOrCallToRender(re,{className:Le.summaryWrapper});return(0,t.jsx)("div",{className:Le.wrapper,children:(0,t.jsxs)("div",{className:Le.header,children:[(0,t.jsx)(j.K,{name:ue?"angle-down":"angle-right",tooltip:ue?(0,m.t)("public-dashboard.settings-bar-header.collapse-settings-tooltip","Collapse settings"):(0,m.t)("public-dashboard.settings-bar-header.expand-settings-tooltip","Expand settings"),className:Le.collapseIcon,onClick:De,"aria-expanded":ue,...Te}),ge&&(0,t.jsx)("div",{className:Le.titleWrapper,onClick:De,children:(0,t.jsx)("span",{className:Le.title,children:ge})}),Ye]})})}te.displayName="SettingsBarHeader";function ne(re){return{wrapper:(0,n.css)({label:"header",padding:re.spacing(.5,.5),borderRadius:re.shape.radius.default,background:re.colors.background.secondary,minHeight:re.spacing(4),"&:focus":{outline:"none"}}),header:(0,n.css)({label:"column",display:"flex",alignItems:"center",whiteSpace:"nowrap"}),collapseIcon:(0,n.css)({marginLeft:re.spacing(.5),color:re.colors.text.disabled}),titleWrapper:(0,n.css)({display:"flex",alignItems:"center",cursor:"pointer",overflow:"hidden",marginRight:`${re.spacing(.5)}`,[re.breakpoints.down("sm")]:{flex:"1 1"}}),title:(0,n.css)({fontWeight:re.typography.fontWeightBold,marginLeft:re.spacing(.5),overflow:"hidden",textOverflow:"ellipsis"}),summaryWrapper:(0,n.css)({display:"flex",flexWrap:"wrap",[re.breakpoints.down("sm")]:{flex:"2 2"}})}}function le({children:re,title:ue,headerElement:De,...ge}){const Te=(0,r.of)(z),[Le,Ye]=(0,q.useState)(!1);function je(){Ye(Ze=>!Ze)}return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(te,{onRowToggle:je,isContentVisible:Le,title:ue,headerElement:De,...ge}),Le&&(0,t.jsx)("div",{className:Te.content,children:re})]})}le.displayName="SettingsBar";const z=re=>({content:(0,n.css)({marginTop:re.spacing(1),marginLeft:re.spacing(4)})});var ee=e(3799);function se({className:re,isDataLoading:ue=!1,timeRange:De,timeSelectionEnabled:ge,annotationsEnabled:Te}){const Le=(0,r.of)(ie),Ye=(0,m.t)("public-dashboard.settings-summary.time-range-picker-enabled-text","Time range picker = enabled"),je=(0,m.t)("public-dashboard.settings-summary.time-range-picker-disabled-text","Time range picker = disabled"),Ze=(0,m.t)("public-dashboard.settings-summary.annotations-show-text","Annotations = show"),Ne=(0,m.t)("public-dashboard.settings-summary.annotations-hide-text","Annotations = hide");return ue?(0,t.jsx)("div",{className:(0,n.cx)(Le.summaryWrapper,re),children:(0,t.jsx)(K.y,{className:Le.summary,inline:!0,size:"sm"})}):(0,t.jsxs)("div",{className:(0,n.cx)(Le.summaryWrapper,re),children:[(0,t.jsxs)("span",{className:Le.summary,children:[(0,t.jsx)(m.x6,{i18nKey:"public-dashboard.settings-summary.time-range-text",children:"Time range = "}),(0,t.jsx)(ee.f,{className:Le.timeRange,value:De})]}),(0,t.jsx)("span",{className:Le.summary,children:ge?Ye:je}),(0,t.jsx)("span",{className:Le.summary,children:Te?Ze:Ne})]})}se.displayName="SettingsSummary";const ie=re=>({summaryWrapper:(0,n.css)({display:"flex"}),summary:(0,n.css)({label:"collapsedText",marginLeft:`${re.spacing.gridSize*2}px`,fontSize:re.typography.bodySmall.fontSize,color:re.colors.text.secondary}),timeRange:(0,n.css)({display:"inline-block"})}),Z=s.Tp.pages.ShareDashboardModal.PublicDashboard;function oe({onRevoke:re,timeRange:ue,hasTemplateVariables:De=!1,showSaveChangesAlert:ge=!1,unsupportedDatasources:Te=[],publicDashboard:Le,dashboard:Ye}){const je=(0,r.of)(ye),Ze=P(),[Ne,{isLoading:Pe}]=(0,v.T2)(),[Ue,{isLoading:$e}]=(0,v.eq)(),ze=D.TP.hasPermission(E.AccessControlAction.DashboardsPublicWrite),qe=!ze||Pe||$e,{handleSubmit:dt,setValue:vt,register:yt}=(0,i.mN)({defaultValues:{isAnnotationsEnabled:Le?.annotationsEnabled,isTimeSelectionEnabled:Le?.timeSelectionEnabled,isPaused:!Le?.isEnabled}}),st=async ve=>{const{isAnnotationsEnabled:Se,isTimeSelectionEnabled:Ie,isPaused:Oe}=ve;Ne({dashboard:Ye,payload:{...Le,annotationsEnabled:Se,timeSelectionEnabled:Ie,isEnabled:!Oe}})},Ve=async ve=>{const{isAnnotationsEnabled:Se,isTimeSelectionEnabled:Ie,isPaused:Oe}=ve;Ue({dashboard:Ye,payload:{...Le,annotationsEnabled:Se,timeSelectionEnabled:Ie,isEnabled:!Oe}})},pe=async(ve,Se)=>{vt(ve,Se),await dt(Ie=>st(Ie))()},Ee=async ve=>{vt("isPaused",ve),await dt(Se=>Ve(Se))()};function me(){y.c.publicDashboardUrlCopied()}return(0,t.jsxs)("div",{className:je.configContainer,children:[ge&&(0,t.jsx)(T,{}),!ze&&(0,t.jsx)(O.t,{mode:"edit"}),De&&(0,t.jsx)(S.D,{}),Te.length>0&&(0,t.jsx)(C.s,{unsupportedDataSources:Te.join(", ")}),(0,A.AY)()&&(0,t.jsx)(X,{dashboard:Ye}),(0,t.jsx)(g.D,{label:(0,m.t)("public-dashboard.config.dashboard-url-field-label","Dashboard URL"),className:je.fieldSpace,children:(0,t.jsx)(a.p,{value:(0,A.mL)(Le.accessToken),readOnly:!0,disabled:!Le?.isEnabled,"data-testid":Z.CopyUrlInput,addonAfter:(0,t.jsx)(c.b,{"data-testid":Z.CopyUrlButton,variant:"primary",disabled:!Le?.isEnabled,getText:()=>(0,A.mL)(Le.accessToken),onClipboardCopy:me,children:(0,t.jsx)(m.x6,{i18nKey:"public-dashboard.config.copy-button",children:"Copy"})})})}),(0,t.jsx)(g.D,{className:je.fieldSpace,children:(0,t.jsxs)(f.PE,{children:[(0,t.jsx)(o.d,{...yt("isPaused"),disabled:qe,onChange:ve=>{y.c.publicDashboardPauseSharingClicked({paused:ve.currentTarget.checked}),Ee(ve.currentTarget.checked)},"data-testid":Z.PauseSwitch}),(0,t.jsx)(h.J,{className:(0,n.css)({marginBottom:0}),children:(0,t.jsx)(m.x6,{i18nKey:"public-dashboard.config.pause-sharing-dashboard-label",children:"Pause sharing dashboard"})})]})}),(0,t.jsx)(g.D,{className:je.fieldSpace,children:(0,t.jsx)(le,{title:(0,m.t)("public-dashboard.config.settings-title","Settings"),headerElement:({className:ve})=>(0,t.jsx)(se,{className:ve,isDataLoading:Pe,timeRange:ue,timeSelectionEnabled:Le?.timeSelectionEnabled,annotationsEnabled:Le?.annotationsEnabled}),"data-testid":Z.SettingsDropdown,children:(0,t.jsx)(w,{disabled:qe,onChange:pe,register:yt,timeRange:ue})})}),(0,t.jsx)(f.PE,{orientation:Ze?0:1,justify:Ze?"flex-end":"flex-start",align:Ze?"center":"normal",children:(0,t.jsx)(f.Gy,{justify:"flex-end",children:(0,t.jsx)(d.$n,{title:(0,m.t)("public-dashboard.config.revoke-public-URL-button-title","Revoke public URL"),onClick:re,type:"button",disabled:qe,"data-testid":Z.DeleteButton,variant:"destructive",fill:"outline",children:(0,t.jsx)(m.x6,{i18nKey:"public-dashboard.config.revoke-public-URL-button",children:"Revoke public URL"})})})})]})}function ce({publicDashboard:re,unsupportedDatasources:ue}){const ge=(0,E.useSelector)(Ne=>Ne.dashboard).getModel(),Te=(0,l.z)(ge.getDefaultTime(),ge),Le=D.TP.hasPermission(E.AccessControlAction.DashboardsPublicWrite),Ye=(0,A.kD)(ge.getVariables()),[je]=(0,v.bN)(),Ze=Ne=>{je({dashboard:ge,uid:re.uid,dashboardUid:ge.uid}),Ne()};return(0,t.jsx)(p.$s,{children:({showModal:Ne,hideModal:Pe})=>(0,t.jsx)(oe,{publicDashboard:re,dashboard:ge,unsupportedDatasources:ue,timeRange:Te,showSaveChangesAlert:Le&&ge.hasUnsavedChanges(),hasTemplateVariables:Ye,onRevoke:()=>{y.c.revokePublicDashboardClicked(),Ne(u.m,{dashboardTitle:ge.title,onConfirm:()=>Ze(Pe),onDismiss:()=>{Ne(b.Zy,{dashboard:ge,onDismiss:Pe,activeTab:M.wr.publicDashboard})}})}})})}const ye=re=>({configContainer:(0,n.css)({label:"config container",display:"flex",flexDirection:"column",flexWrap:"wrap",gap:re.spacing(3)}),fieldSpace:(0,n.css)({label:"field space",width:"100%",marginBottom:0}),timeRange:(0,n.css)({display:"inline-block"})})},22234:(k,R,e)=>{"use strict";e.d(R,{M:()=>I,D:()=>O});var t=e(74848),n=e(32196),i=e(49785),s=e(13544),r=e(40845),g=e(55852),a=e(62930),c=e(8484),o=e(16233),h=e(72686),f=e(7758),d=e(31678),p=e(29304),m=e(12257),v=e(10872),l=e(72254),y=e(71415),u=e(84167),D=e(66864),E=e(10880);const x=s.Tp.pages.ShareDashboardModal.PublicDashboard,P=({disabled:C,register:S})=>{const A=(0,r.of)(b),L=[{type:"publicAcknowledgment",description:(0,c.t)("public-dashboard.acknowledgment-checkboxes.public-ack-desc","Your entire dashboard will be public*"),testId:x.WillBePublicCheckbox,info:{href:"https://grafana.com/docs/grafana/latest/dashboards/dashboard-public/",tooltip:(0,c.t)("public-dashboard.acknowledgment-checkboxes.public-ack-tooltip","Learn more about public dashboards")}},{type:"dataSourcesAcknowledgment",description:(0,c.t)("public-dashboard.acknowledgment-checkboxes.data-src-ack-desc","Publishing currently only works with a subset of data sources*"),testId:x.LimitedDSCheckbox,info:{href:"https://grafana.com/docs/grafana/latest/datasources/",tooltip:(0,c.t)("public-dashboard.acknowledgment-checkboxes.data-src-ack-tooltip","Learn more about public datasources")}},{type:"usageAcknowledgment",description:(0,c.t)("public-dashboard.acknowledgment-checkboxes.usage-ack-desc","Making a dashboard public will cause queries to run each time it is viewed, which may increase costs*"),testId:x.CostIncreaseCheckbox,info:{href:"https://grafana.com/docs/grafana/latest/enterprise/query-caching/",tooltip:(0,c.t)("public-dashboard.acknowledgment-checkboxes.usage-ack-desc-tooltip","Learn more about query caching")}}];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:A.title,children:(0,t.jsx)(c.x6,{i18nKey:"public-dashboard.acknowledgment-checkboxes.ack-title",children:"Before you make the dashboard public, acknowledge the following:"})}),(0,t.jsx)(u.n,{disabled:C,children:(0,t.jsx)(D.gW,{spacing:"md",children:L.map(N=>(0,t.jsxs)(D.Gy,{spacing:"none",align:"center",children:[(0,t.jsx)(E.S,{...S(N.type,{required:!0}),label:N.description,"data-testid":N.testId}),(0,t.jsx)(g.z9,{variant:"primary",href:N.info.href,target:"_blank",fill:"text",icon:"info-circle",rel:"noopener noreferrer",tooltip:N.info.tooltip})]},N.type))})})]})},b=C=>({title:(0,n.css)({fontWeight:C.typography.fontWeightBold})}),M=s.Tp.pages.ShareDashboardModal.PublicDashboard,O=({unsupportedDatasources:C=[],unsupportedTemplateVariables:S=!1,dashboard:A,hasError:L=!1})=>{const N=(0,r.of)(T),F=o.TP.hasPermission(d.AccessControlAction.DashboardsPublicWrite),[w,{isLoading:B,isError:U}]=(0,h.U9)(),K=()=>{w({dashboard:A,payload:{isEnabled:!0}}),f.c.generatePublicDashboardUrlClicked({})},{handleSubmit:V,register:H,formState:{isValid:Y}}=(0,i.mN)({mode:"onChange"}),X=!F||B||U||L;return(0,t.jsxs)("div",{className:N.container,children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:N.title,children:(0,t.jsx)(c.x6,{i18nKey:"public-dashboard.create-page.welcome-title",children:"Welcome to public dashboards!"})}),(0,t.jsx)("p",{className:N.description,children:(0,t.jsx)(c.x6,{i18nKey:"public-dashboard.create-page.unsupported-features-desc",children:"Currently, we don\u2019t support template variables or frontend data sources"})})]}),!F&&(0,t.jsx)(p.t,{mode:"create"}),S&&(0,t.jsx)(v.D,{}),C.length>0&&(0,t.jsx)(m.s,{unsupportedDataSources:C.join(", ")}),(0,t.jsxs)("form",{onSubmit:V(K),children:[(0,t.jsx)("div",{className:N.checkboxes,children:(0,t.jsx)(P,{disabled:X,register:H})}),(0,t.jsx)("div",{className:N.buttonContainer,children:(0,t.jsxs)(g.$n,{type:"submit",disabled:X||!Y,"data-testid":M.CreateButton,children:[(0,t.jsx)(c.x6,{i18nKey:"public-dashboard.create-page.generate-public-url-button",children:"Generate public URL"}),B&&(0,t.jsx)(a.y,{className:N.loadingSpinner})]})})]})]})};function I({hasError:C}){const A=(0,d.useSelector)(F=>F.dashboard).getModel(),{unsupportedDataSources:L}=(0,y.Z)(A),N=(0,l.kD)(A.getVariables());return(0,t.jsx)(O,{dashboard:A,unsupportedDatasources:L,unsupportedTemplateVariables:N,hasError:C})}const T=C=>({container:(0,n.css)({display:"flex",flexDirection:"column",gap:C.spacing(4)}),title:(0,n.css)({fontSize:C.typography.h4.fontSize,margin:C.spacing(0,0,2)}),description:(0,n.css)({color:C.colors.text.secondary,marginBottom:C.spacing(0)}),checkboxes:(0,n.css)({margin:C.spacing(0,0,4)}),buttonContainer:(0,n.css)({display:"flex",justifyContent:"end"}),loadingSpinner:(0,n.css)({marginLeft:C.spacing(1)})})},29304:(k,R,e)=>{"use strict";e.d(R,{t:()=>g});var t=e(74848),n=e(13544),i=e(42418),s=e(8484);const r=n.Tp.pages.ShareDashboardModal.PublicDashboard,g=({mode:a})=>(0,t.jsx)(i.F,{severity:"warning",title:(0,s.t)("public-dashboard.modal-alerts.no-upsert-perm-alert-title","You don\u2019t have permission to {{ mode }} a public dashboard",{mode:a}),"data-testid":r.NoUpsertPermissionsWarningAlert,bottomSpacing:0,children:(0,t.jsxs)(s.x6,{i18nKey:"public-dashboard.modal-alerts.no-upsert-perm-alert-desc",children:["Contact your admin to get permission to ",{mode:a}," public dashboards"]})})},12257:(k,R,e)=>{"use strict";e.d(R,{s:()=>h});var t=e(74848),n=e(32196),i=e(46942),s=e.n(i),r=e(13544),g=e(40845),a=e(42418),c=e(8484);const o=r.Tp.pages.ShareDashboardModal.PublicDashboard,h=({unsupportedDataSources:d})=>{const p=(0,g.of)(f);return(0,t.jsxs)(a.F,{severity:"warning",title:(0,c.t)("public-dashboard.modal-alerts.unsupported-data-source-alert-title","Unsupported data sources"),"data-testid":o.UnsupportedDataSourcesWarningAlert,bottomSpacing:0,children:[(0,t.jsx)("p",{className:p.unsupportedDataSourceDescription,children:(0,t.jsxs)(c.x6,{i18nKey:"public-dashboard.modal-alerts.unsupported-data-source-alert-desc",children:["There are data sources in this dashboard that are unsupported for public dashboards. Panels that use these data sources may not function properly: ",{unsupportedDataSources:d},"."]})}),(0,t.jsx)("a",{href:"https://grafana.com/docs/grafana/next/dashboards/dashboard-public/",target:"blank",className:s()("text-link",p.unsupportedDataSourceDescription),children:(0,t.jsx)(c.x6,{i18nKey:"public-dashboard.modal-alerts.unsupport-data-source-alert-readmore-link",children:"Read more about supported data sources"})})]})},f=d=>({unsupportedDataSourceDescription:(0,n.css)({color:d.colors.text.secondary,marginBottom:d.spacing(1)})})},10872:(k,R,e)=>{"use strict";e.d(R,{D:()=>g});var t=e(74848),n=e(13544),i=e(42418),s=e(8484);const r=n.Tp.pages.ShareDashboardModal.PublicDashboard,g=({showDescription:a=!0})=>(0,t.jsx)(i.F,{severity:"warning",title:(0,s.t)("public-dashboard.modal-alerts.unsupported-template-variable-alert-title","Template variables are not supported"),"data-testid":r.TemplateVariablesWarningAlert,bottomSpacing:0,children:a&&(0,t.jsx)(s.x6,{i18nKey:"public-dashboard.modal-alerts.unsupported-template-variable-alert-desc",children:"This public dashboard may not work since it uses template variables"})})},4785:(k,R,e)=>{"use strict";e.d(R,{a:()=>d,b:()=>p});var t=e(74848),n=e(32196),i=e(40845),s=e(62930),r=e(72686),g=e(72254),a=e(31678),c=e(42930),o=e(59037),h=e(22234),f=e(71415);const d=()=>{const v=(0,i.of)(m);return(0,t.jsx)(c.G,{className:v.loadingContainer,children:(0,t.jsxs)(t.Fragment,{children:["Loading configuration",(0,t.jsx)(s.y,{size:"lg",className:v.spinner})]})})},p=v=>{const{data:l,isLoading:y,isError:u}=(0,r.Bs)(v.dashboard.uid),E=(0,a.useSelector)(P=>P.dashboard).getModel(),{unsupportedDataSources:x}=(0,f.Z)(E);return(0,t.jsx)(t.Fragment,{children:y?(0,t.jsx)(d,{}):(0,g.lI)(l)?(0,t.jsx)(o.K,{publicDashboard:l,unsupportedDatasources:x}):(0,t.jsx)(h.M,{hasError:u})})},m=v=>({loadingContainer:(0,n.css)({height:"280px",alignItems:"center",justifyContent:"center",gap:v.spacing(1)}),spinner:(0,n.css)({marginBottom:v.spacing(0)})})},72254:(k,R,e)=>{"use strict";e.d(R,{AY:()=>l,Xo:()=>c,_A:()=>f,_l:()=>m,gN:()=>p,iR:()=>v,kD:()=>o,lI:()=>h,mL:()=>d});var t=e(26657),n=e(32264),i=e(33378),s=e(2913),r=e(31193),g=e(22699),a=e(31204),c=(y=>(y.PUBLIC="public",y.EMAIL="email",y))(c||{});const o=y=>y.length>0,h=y=>y?.uid!==""&&y?.uid!==void 0,f=async y=>{let u=new Set;for(const D of y)for(const E of D.targets){const x=E?.datasource?.type;x&&(a.z.has(x)&&await(0,r.tR)().get(E.datasource)instanceof t.iy||u.add(x))}return Array.from(u).sort()},d=y=>`${(0,s.zj)().appUrl}public-dashboards/${y}`,p=(y,u)=>`/d/${y}/${u}?shareView=${g.wr.publicDashboard}`,m=/^[A-Z\d._%+-]+@[A-Z\d.-]+\.[A-Z]{2,}$/i,v=()=>!!n.$.featureToggles.publicDashboards&&n.$.publicDashboardsEnabled,l=()=>v()&&!!n.$.featureToggles.publicDashboardsEmailSharing&&(0,i.a)("publicDashboardsEmailSharing")},31204:(k,R,e)=>{"use strict";e.d(R,{z:()=>t});const t=new Set(["__expr__","aggregations-io-datasource","apache-iotdb-datasource","aquaqanalytics-kdbbackend-datasource","axiomhq-axiom-datasource","cloudwatch","cnos-cnosdb-datasource","datasource","dlopes7-appdynamics-datasource","dvelop-odata-datasource","elasticsearch","factry-historian-datasource","fiskaly-surrealdb-datasource","frser-sqlite-datasource","grafadruid-druid-datasource","grafana-athena-datasource","grafana-azure-data-explorer-datasource","grafana-azure-monitor-datasource","grafana-azurecosmosdb-datasource","grafana-bigquery-datasource","grafana-catchpoint-datasource","grafana-clickhouse-datasource","grafana-databricks-datasource","grafana-datadog-datasource","grafana-dynamodb-datasource","grafana-dynatrace-datasource","grafana-falconlogscale-datasource","grafana-github-datasource","grafana-gitlab-datasource","grafana-honeycomb-datasource","grafana-iot-sitewise-datasource","grafana-jira-datasource","grafana-looker-datasource","grafana-mock-datasource","grafana-mongodb-datasource","grafana-newrelic-datasource","grafana-odbc-datasource","grafana-opensearch-datasource","grafana-oracle-datasource","grafana-orbit-datasource","grafana-pagerduty-datasource","grafana-redshift-datasource","grafana-salesforce-datasource","grafana-saphana-datasource","grafana-sentry-datasource","grafana-servicenow-datasource","grafana-snowflake-datasource","grafana-splunk-datasource","grafana-splunk-monitoring-datasource","grafana-sumologic-datasource","grafana-surrealdb-datasource","grafana-testdata-datasource","grafana-timestream-datasource","grafana-wavefront-datasource","grafana-x-ray-datasource","graphite","hadesarchitect-cassandra-datasource","highlightinc-highlight-datasource","ibm-aql-datasource","ibm-kql-datasource","influxdata-flightsql-datasource","influxdb","innius-grpc-datasource","kniepdennis-neo4j-datasource","loki","manassehzhou-maxcompute-datasource","marcusolsson-csv-datasource","mssql","mysql","nagasudhirpulla-api-datasource","needleinajaystack-haystack-datasource","oci-metrics-datasource","opentsdb","parseable-parseable-datasource","postgres","prometheus","questdb-questdb-datasource","quickwit-quickwit-datasource","redis-datasource","retrodaredevil-wildgraphql-datasource","stackdriver","tdengine-datasource","timeplus-proton-datasource","trino-datasource","vertamedia-clickhouse-datasource","vertica-grafana-datasource","ydbtech-ydb-datasource","yesoreyeram-infinity-datasource"])},71415:(k,R,e)=>{"use strict";e.d(R,{Z:()=>i});var t=e(96540),n=e(72254);const i=s=>{const[r,g]=(0,t.useState)([]);return(0,t.useEffect)(()=>{(async()=>await(0,n._A)(s.panels))().then(c=>{g(c)})},[s.panels]),{unsupportedDataSources:r}}},87895:(k,R,e)=>{"use strict";e.d(R,{w:()=>r});var t=e(74848),n=e(88575),i=e(94354),s=e(8484);const r=({selectedTheme:g="current",onChange:a})=>{const c=[{label:(0,s.t)("share-modal.theme-picker.current","Current"),value:"current"},{label:(0,s.t)("share-modal.theme-picker.dark","Dark"),value:"dark"},{label:(0,s.t)("share-modal.theme-picker.light","Light"),value:"light"}];return(0,t.jsx)(n.D,{label:(0,s.t)("share-modal.theme-picker.field-name","Theme"),children:(0,t.jsx)(i.z,{options:c,value:g,onChange:a})})}},1702:(k,R,e)=>{"use strict";e.d(R,{ShareModal:()=>t.Zy});var t=e(7686)},22699:(k,R,e)=>{"use strict";e.d(R,{CF:()=>p,Lb:()=>d,P_:()=>o,XV:()=>c,Xe:()=>h,hD:()=>v,wr:()=>l});var t=e(65879),n=e(76885),i=e(71733),s=e(47232),r=e(32264),g=e(7030),a=e(74856);function c({useCurrentTimeRange:y,selectedTheme:u,panel:D,search:E=window.location.search,range:x=(0,a.jG)().timeRange(),orgId:P=r.$.bootData.user.orgId}){const b=new URLSearchParams(E),M=D?.timeFrom;if(M){const{from:O,to:I}=t.describeTextRange(M);b.set("from",O),b.set("to",I)}else b.set("from",String(x.from.valueOf())),b.set("to",String(x.to.valueOf()));return b.set("orgId",String(P)),y||(b.delete("from"),b.delete("to")),u!=="current"&&b.set("theme",u),D&&!b.has("editPanel")&&b.set("viewPanel",String(D.id)),b.delete("auth_token"),b.delete("shareView"),b}function o(){let y=window.location.href;const u=y.indexOf("?");return u!==-1&&(y=y.substring(0,u)),y}async function h(y,u,D,E){const x=o(),P=c({useCurrentTimeRange:y,selectedTheme:u,panel:D}),b=n.kM.appendQueryToUrl(x,P.toString());return E?await(0,g.fn)(b):b}function f(y,u,D,E,x){const P=o(),b=c({useCurrentTimeRange:y,selectedTheme:D,panel:E,range:x});let M=P.replace(r.$.appSubUrl+"/dashboard/",r.$.appSubUrl+"/dashboard-solo/");M=M.replace(r.$.appSubUrl+"/d/",r.$.appSubUrl+"/d-solo/"),i.I.stripBaseFromUrl(P)==="/"&&(M=`${r.$.appUrl}d-solo/${u}`);const I=b.get("editPanel")??b.get("viewPanel")??"";return b.set("panelId",I),b.delete("editPanel"),b.delete("viewPanel"),n.kM.appendQueryToUrl(M,b.toString())}function d(y,u,D,E){let P=f(y,u,D,E).replace(r.$.appSubUrl+"/dashboard-solo/",r.$.appSubUrl+"/render/dashboard-solo/");return P=P.replace(r.$.appSubUrl+"/d-solo/",r.$.appSubUrl+"/render/d-solo/"),P+=`&width=${r.$.rendererDefaultImageWidth}&height=${r.$.rendererDefaultImageHeight}&scale=${r.$.rendererDefaultImageScale}`+m(),P}function p(y,u,D,E,x){return`<iframe src="${f(y,u,D,E,x)}" width="450" height="200" frameborder="0"></iframe>`}function m(){const y="&tz=UTC"+encodeURIComponent((0,s.KQ)().format("Z"));if(!window.Intl)return y;const u=window.Intl.DateTimeFormat();if(!u.resolvedOptions)return y;const D=u.resolvedOptions();return D.timeZone?"&tz="+encodeURIComponent(D.timeZone):y}const v=y=>y?"panel":"dashboard",l={link:"link",snapshot:"snapshot",export:"export",embed:"embed",libraryPanel:"library_panel",pdf:"pdf",report:"report",publicDashboard:"public_dashboard"}},52424:(k,R,e)=>{"use strict";e.d(R,{Zx:()=>x,aK:()=>l});var t=e(74848),n=e(32196),i=e(96540),s=e(16817),r=e(80997),g=e(13544),a=e(40845),c=e(38138),o=e(40276),h=e(83122),f=e(14578),d=e(55852),p=e(27677),m=e(6923);function v({dashboardUID:P,link:b}){const M=(0,a.of)(E),O=y({dashboardUID:P,link:b});return!O||D.length===0?null:(0,t.jsx)(c.W,{children:(0,t.jsx)("div",{className:M.dropdown,children:(0,t.jsx)(o.E,{children:O.map((I,T)=>(0,t.jsx)(c.W.Item,{url:I.url,target:b.targetBlank?"_blank":void 0,label:I.title,testId:g.Tp.components.DashboardLinks.link,"aria-label":`${I.title} dashboard`},`dashlinks-dropdown-item-${I.uid}-${T}`))})})})}const l=P=>{const{link:b,linkInfo:M,dashboardUID:O}=P,I=y(P),T=(0,a.of)(E);return b.asDropdown?(0,t.jsx)(h.m,{overlay:(0,t.jsx)(v,{link:b,dashboardUID:O}),children:(0,t.jsxs)(x,{"data-placement":"bottom","data-toggle":"dropdown","aria-controls":"dropdown-list","aria-haspopup":"menu",fill:"outline",variant:"secondary","data-testid":g.Tp.components.DashboardLinks.dropDown,children:[(0,t.jsx)(f.I,{"aria-hidden":!0,name:"bars",className:T.iconMargin}),(0,t.jsx)("span",{children:M.title})]})}):(0,t.jsx)(t.Fragment,{children:I.length>0&&I.map((C,S)=>(0,t.jsx)(x,{icon:"apps",variant:"secondary",fill:"outline",href:C.url,target:b.targetBlank?"_blank":void 0,rel:"noreferrer","data-testid":g.Tp.components.DashboardLinks.link,children:C.title},`dashlinks-list-item-${C.uid}-${S}`))})},y=({link:P,dashboardUID:b})=>{const{tags:M}=P,O=(0,s.A)(()=>u(M),[M]);return O.value?D(b,P,O.value):[]};async function u(P,b={getBackendSrv:p.AI}){return await b.getBackendSrv().search({tag:P,limit:100})}function D(P,b,M,O={getLinkSrv:m.mQ,sanitize:r.aj,sanitizeUrl:r.Jf}){return M.filter(I=>I.uid!==P).map(I=>{const T=I.uid,C=O.sanitize(I.title),S=O.getLinkSrv().getLinkUrl({...b,url:I.url}),A=O.sanitizeUrl(S);return{uid:T,title:C,url:A}})}function E(P){return{iconMargin:(0,n.css)({marginRight:P.spacing(.5)}),dropdown:(0,n.css)({maxWidth:"max(30vw, 300px)",maxHeight:"70vh",overflowY:"auto"}),button:(0,n.css)({color:P.colors.text.primary}),dashButton:(0,n.css)({fontSize:P.typography.bodySmall.fontSize,paddingLeft:P.spacing(1),paddingRight:P.spacing(1)})}}const x=(0,i.forwardRef)(({className:P,...b},M)=>{const O=(0,a.of)(E),I=b.href?d.z9:d.$n;return(0,t.jsx)(I,{...b,variant:"secondary",fill:"outline",className:(0,n.cx)(P,O.dashButton),ref:M})});x.displayName="DashboardLinkButton"},57650:(k,R,e)=>{"use strict";e.d(R,{A:()=>w});var t=e(74848),n=e(97497),i=e(96540),s=e(42941),r=e(1173),g=e(52622),a=e(13544),c=e(14110),o=e(96374),h=e(10343),f=e(7788),d=e(2913),p=e(10803),m=e(32196),v=e(69862),l=e(85200),y=e(2514),u=e(72574),D=e(40845),E=e(87978),x=e(24022),P=e(14578);const b=({debugMode:B,index:U,data:K,uiConfig:V,configs:H,onChange:Y,toggleShowDebug:X})=>{const J=(0,D.of)(M),[q,ae]=(0,i.useState)([]),[j,te]=(0,i.useState)([]),ne=(0,i.useMemo)(()=>H[U],[H,U]);(0,i.useEffect)(()=>{const z=H[U].transformation,ee=z.filter?.options?(0,l.Dq)(z.filter):void 0,se=H.slice(0,U).map(ye=>ye.transformation),ie=H.slice(U,U+1).map(ye=>ye.transformation),Z={interpolate:ye=>(0,u.w)().replace(ye)},oe=(0,y.m)(se,K,Z).subscribe(ye=>{ee&&(ye=K.filter(re=>ee(re))),ae(ye)}),ce=(0,y.m)(se,K,Z).pipe((0,v.Z)(ye=>(0,y.m)(ie,ye,Z))).subscribe(te);return function(){oe.unsubscribe(),ce.unsubscribe()}},[U,K,H]);const le=(0,i.useMemo)(()=>(0,i.createElement)(V.editor,{options:{...V.transformation.defaultOptions,...ne.transformation.options},input:q,onChange:z=>{Y(U,{...ne.transformation,options:z})}}),[V.editor,V.transformation.defaultOptions,ne.transformation,q,Y,U]);return(0,t.jsxs)("div",{"data-testid":a.Tp.components.TransformTab.transformationEditor(V.name),children:[le,B&&(0,t.jsx)(E._,{title:"Debug transformation",subtitle:V.name,onClose:X,children:(0,t.jsxs)("div",{className:J.debugWrapper,"data-testid":a.Tp.components.TransformTab.transformationEditorDebugger(V.name),children:[(0,t.jsxs)("div",{className:J.debug,children:[(0,t.jsx)("div",{className:J.debugTitle,children:"Input data"}),(0,t.jsx)("div",{className:J.debugJson,children:(0,t.jsx)(x.B,{json:q})})]}),(0,t.jsx)("div",{className:J.debugSeparator,children:(0,t.jsx)(P.I,{name:"arrow-right"})}),(0,t.jsxs)("div",{className:J.debug,children:[(0,t.jsx)("div",{className:J.debugTitle,children:"Output data"}),(0,t.jsx)("div",{className:J.debugJson,children:j&&(0,t.jsx)(x.B,{json:j})})]})]})})]})},M=B=>({title:(0,m.css)({display:"flex",padding:"4px 8px 4px 8px",position:"relative",height:"35px",borderRadius:"4px 4px 0 0",flexWrap:"nowrap",justifyContent:"space-between",alignItems:"center"}),name:(0,m.css)({fontWeight:B.typography.fontWeightMedium,color:B.colors.primary.text}),iconRow:(0,m.css)({display:"flex"}),icon:(0,m.css)({background:"transparent",border:"none",boxShadow:"none",cursor:"pointer",color:B.colors.text.secondary,marginLeft:B.spacing(1),"&:hover":{color:B.colors.text.primary}}),debugWrapper:(0,m.css)({display:"flex",flexDirection:"row"}),debugSeparator:(0,m.css)({width:"48px",minHeight:"300px",display:"flex",alignItems:"center",alignSelf:"stretch",justifyContent:"center",margin:`0 ${B.spacing(.5)}`,color:B.colors.primary.text}),debugTitle:(0,m.css)({padding:`${B.spacing(1)} ${B.spacing(.25)}`,fontFamily:B.typography.fontFamilyMonospace,fontSize:B.typography.bodySmall.fontSize,color:B.colors.text.primary,borderBottom:`1px solid ${B.colors.border.weak}`,flexGrow:0,flexShrink:1}),debug:(0,m.css)({marginTop:B.spacing(1),padding:`0 ${B.spacing(1,1,1)}`,border:`1px solid ${B.colors.border.weak}`,background:`${B.isLight?B.v1.palette.white:B.v1.palette.gray05}`,borderRadius:B.shape.radius.default,width:"100%",minHeight:"300px",display:"flex",flexDirection:"column",alignSelf:"stretch"}),debugJson:(0,m.css)({flexGrow:1,height:"100%",overflow:"hidden",padding:B.spacing(.5)})});var O=e(22214),I=e(91847);const T=({isOpen:B,onCloseClick:U,transformer:K})=>{const{transformation:{name:V},help:H}=K,Y=H||(0,I.$n)(),X=(0,t.jsx)(E._,{title:V,subtitle:"Transformation help",onClose:()=>U(!1),children:(0,t.jsx)(O.j,{markdown:Y,styleOverrides:{borderTop:"2px solid"}})});return B?X:null};var C=e(88575),S=e(90182),A=e(19743);const L=({index:B,data:U,config:K,onChange:V})=>{const H=(0,D.of)(N),Y=(0,i.useMemo)(()=>({context:{data:U.series},showTopic:!0,showFilter:K.topic!==g.QR.Annotations,source:[{value:g.QR.Series,label:"Query results"},{value:g.QR.Annotations,label:"Annotation data"}]}),[U,K.topic]);return(0,t.jsx)("div",{className:H.wrapper,children:(0,t.jsx)(C.D,{label:"Apply transformation to",children:(0,t.jsxs)(t.Fragment,{children:[Y.showTopic&&(0,t.jsx)(S.l6,{isClearable:!0,options:Y.source,value:Y.source.find(X=>X.value===K.topic),placeholder:Y.source[0].label,className:H.padded,onChange:X=>{V(B,{...K,topic:X?.value})}}),Y.showFilter&&(0,t.jsx)(A.x,{value:K.filter,context:Y.context,item:{},onChange:X=>V(B,{...K,filter:X})})]})})})},N=B=>{const U=B.shape.radius.default;return{wrapper:(0,m.css)({padding:B.spacing(2),border:`2px solid ${B.colors.background.secondary}`,borderTop:"none",borderRadius:`0 0 ${U} ${U}`,position:"relative",top:"-4px"}),padded:(0,m.css)({marginBottom:B.spacing(1)})}},F=({onRemove:B,index:U,id:K,data:V,configs:H,uiConfig:Y,onChange:X})=>{const[J,q]=(0,s.A)(!1),[ae,j]=(0,s.A)(!1),[te,ne]=(0,s.A)(!1),le=!!H[U].transformation.disabled,z=H[U].transformation.topic,ee=H[U].transformation.filter!=null||z!=null,se=ee||V.series.length>1||(V.annotations?.length??0)>0,ie=(0,i.useCallback)(ye=>{const re=H[ye].transformation;X(ye,{...re,disabled:re.disabled?void 0:!0})},[X,H]),Z=(0,i.useCallback)(()=>{let ye={...H[U].transformation};ye.filter?delete ye.filter:ye.filter={id:r.jR.byRefId,options:""},X(U,ye)},[X,U,H]),oe=(0,i.useCallback)((ye,re,ue)=>De=>{let ge="panel_editor_tabs_transformations_toggle";d.Ay.featureToggles.transformationsRedesign&&(ge="transformations_redesign_"+ge),(0,c.rR)(ge,{action:ue?"off":"on",toggleId:re,transformationId:H[U].transformation.id}),ye(De)},[H,U]),ce=()=>(0,t.jsxs)(t.Fragment,{children:[Y.state&&(0,t.jsx)(p.p,{state:Y.state}),(0,t.jsx)(h.A,{title:"Show transform help",icon:"info-circle",onClick:oe(ne,"help",te),active:te}),se&&(0,t.jsx)(h.A,{title:"Filter",icon:"filter",onClick:oe(Z,"filter",ee),active:ee}),(0,t.jsx)(h.A,{title:"Debug",icon:"bug",onClick:oe(j,"debug",ae),active:ae}),(0,t.jsx)(h.A,{title:"Disable transformation",icon:le?"eye-slash":"eye",onClick:oe(()=>ie(U),"disabled",le),active:le,dataTestId:a.Tp.components.Transforms.disableTransformationButton}),(0,t.jsx)(h.q,{title:"Remove",icon:"trash-alt",onClick:()=>d.Ay.featureToggles.transformationsRedesign?q(!0):B(U)}),d.Ay.featureToggles.transformationsRedesign&&(0,t.jsx)(o.u,{isOpen:J,title:`Delete ${Y.name}?`,body:"Note that removing one transformation may break others. If there is only a single transformation, you will go back to the main selection screen.",confirmText:"Delete",onConfirm:()=>{q(!1),B(U)},onDismiss:()=>q(!1)})]});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(f.u,{id:K,index:U,title:`${U+1} - ${Y.name}`,draggable:!0,actions:ce,disabled:le,expanderMessages:{close:"Collapse transformation row",open:"Expand transformation row"},children:[ee&&(0,t.jsx)(L,{index:U,config:H[U].transformation,data:V,onChange:X}),(0,t.jsx)(b,{debugMode:ae,index:U,data:z===g.QR.Annotations?V.annotations??[]:V.series,configs:H,uiConfig:Y,onChange:X,toggleShowDebug:j})]}),(0,t.jsx)(T,{transformer:Y,isOpen:te,onCloseClick:ne})]})},w=({data:B,onChange:U,onRemove:K,configs:V})=>(0,t.jsx)(t.Fragment,{children:V.map((H,Y)=>{const X=n.h.getIfExists(H.transformation.id);return X?(0,t.jsx)(F,{index:Y,id:`${H.id}`,data:B,configs:V,uiConfig:X,onRemove:K,onChange:U},`${H.id}`):null})})},21427:(k,R,e)=>{"use strict";e.d(R,{R:()=>x});var t=e(74848),n=e(32196),i=e(96540),s=e(81010),r=e(18282),g=e(97497),a=e(13544),c=e(40845),o=e(87978),h=e(10354),f=e(15292),d=e(92174),p=e(10860),m=e(29158),v=e(2913),l=e(10803),y=e(94397);const E=[["viewAll","View all"],...Object.entries(y.eJ)];function x(C){const S=(0,c.of)(P),{suffix:A,xforms:L,search:N,onSearchChange:F,onSearchKeyDown:w,showIllustrations:B,onTransformationAdd:U,selectedFilter:K,data:V,onClose:H,onShowIllustrationsChange:Y,onSelectedFilterChange:X}=C,J=(0,i.useCallback)(q=>{q?.click()},[]);return(0,t.jsxs)(o._,{size:"md",onClose:()=>{H&&H()},title:"Add another transformation",children:[(0,t.jsxs)("div",{className:S.searchWrapper,children:[(0,t.jsx)(h.p,{"data-testid":a.Tp.components.Transforms.searchInput,className:S.searchInput,value:N??"",placeholder:"Search for transformation",onChange:F,onKeyDown:w,suffix:A,ref:J}),(0,t.jsxs)("div",{className:S.showImages,children:[(0,t.jsx)("span",{className:S.illustationSwitchLabel,children:"Show images"})," ",(0,t.jsx)(f.d,{value:B,onChange:()=>Y&&Y(!B)})]})]}),(0,t.jsx)("div",{className:S.filterWrapper,children:E.map(([q,ae])=>(0,t.jsx)(d.m,{onClick:()=>X&&X(q),label:ae,selected:K===q},q))}),(0,t.jsx)(b,{showIllustrations:B,transformations:L,data:V,onClick:q=>{U({value:q})}})]})}function P(C){return{showImages:(0,n.css)({flexBasis:"0",display:"flex",gap:"8px",alignItems:"center"}),pickerInformationLine:(0,n.css)({fontSize:"16px",marginBottom:`${C.spacing(2)}`}),pickerInformationLineHighlight:(0,n.css)({verticalAlign:"middle"}),searchWrapper:(0,n.css)({display:"flex",flexWrap:"wrap",columnGap:"27px",rowGap:"16px",width:"100%"}),searchInput:(0,n.css)({flexGrow:"1",width:"initial"}),illustationSwitchLabel:(0,n.css)({whiteSpace:"nowrap"}),filterWrapper:(0,n.css)({padding:`${C.spacing(1)} 0`,display:"flex",flexWrap:"wrap",rowGap:`${C.spacing(1)}`,columnGap:`${C.spacing(.5)}`})}}function b({showIllustrations:C,transformations:S,onClick:A,data:L}){const N=(0,c.of)(M);return(0,t.jsx)("div",{className:N.grid,children:S.map(F=>{let w=s.M.Applicable;F.transformation.isApplicable!==void 0&&(w=F.transformation.isApplicable(L));const B=w>0;let U=null;F.transformation.isApplicableDescription!==void 0&&(typeof F.transformation.isApplicableDescription=="function"?U=F.transformation.isApplicableDescription(L):U=F.transformation.isApplicableDescription);let K=N.newCard;return B||(K=(0,n.cx)(N.newCard,N.cardDisabled)),(0,t.jsxs)(p.Z,{className:K,"data-testid":a.Tp.components.TransformTab.newTransform(F.name),onClick:()=>A(F.id),children:[(0,t.jsxs)(p.Z.Heading,{className:N.heading,children:[(0,t.jsx)("span",{children:F.name}),(0,t.jsx)("span",{className:N.pluginStateInfoWrapper,children:(0,t.jsx)(l.p,{state:F.state})})]}),(0,t.jsxs)(p.Z.Description,{className:N.description,children:[(0,t.jsx)("span",{children:T(F.id)}),C&&(0,t.jsx)("span",{children:(0,t.jsx)("img",{className:N.image,src:O(F.id,!B),alt:F.name})}),!B&&U!==null&&(0,t.jsx)(m.K,{className:N.cardApplicableInfo,name:"info-circle",tooltip:U})]})]},F.id)})})}function M(C){return{heading:(0,n.css)({fontWeight:400,"> button":{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"nowrap"}}),description:(0,n.css)({fontSize:"12px",display:"flex",flexDirection:"column",justifyContent:"space-between"}),image:(0,n.css)({display:"block",maxEidth:"100%`",marginTop:`${C.spacing(2)}`}),grid:(0,n.css)({display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(220px, 1fr))",gridAutoRows:"1fr",gap:`${C.spacing(2)} ${C.spacing(1)}`,width:"100%"}),cardDisabled:(0,n.css)({backgroundColor:"rgb(204, 204, 220, 0.045)",color:`${C.colors.text.disabled} !important`,img:{filter:"grayscale(100%)",opacity:.33}}),cardApplicableInfo:(0,n.css)({position:"absolute",bottom:`${C.spacing(1)}`,right:`${C.spacing(1)}`}),newCard:(0,n.css)({gridTemplateRows:"min-content 0 1fr 0"}),pluginStateInfoWrapper:(0,n.css)({marginLeft:"5px"})}}const O=(C,S)=>`public/img/transformations/${v.Ay.theme2.isDark?"dark":"light"}/${C}.svg`,I={[r.F.concatenate]:"Combine all fields into a single frame.",[r.F.configFromData]:"Set unit, min, max and more.",[r.F.fieldLookup]:"Use a field value to lookup countries, states, or airports.",[r.F.filterFieldsByName]:"Remove parts of the query results using a regex pattern.",[r.F.filterByRefId]:"Remove rows from the data based on origin query",[r.F.filterByValue]:"Remove rows from the query results using user-defined filters.",[r.F.groupBy]:"Group data by a field value and create aggregate data.",[r.F.groupingToMatrix]:"Summarize and reorganize data based on three fields.",[r.F.joinByField]:"Combine rows from 2+ tables, based on a related field.",[r.F.labelsToFields]:"Group series by time and return labels or tags as fields.",[r.F.merge]:"Merge multiple series. Values will be combined into one row.",[r.F.organize]:"Re-order, hide, or rename fields.",[r.F.partitionByValues]:"Split a one-frame dataset into multiple series.",[r.F.prepareTimeSeries]:"Stretch data frames from the wide format into the long format.",[r.F.reduce]:"Reduce all rows or data points to a single value (ex. max, mean).",[r.F.renameByRegex]:"Rename parts of the query results using a regular expression and replacement pattern.",[r.F.seriesToRows]:"Merge multiple series. Return time, metric and values as a row."},T=C=>I[C]||g.h.getIfExists(C)?.description||""},66879:(k,R,e)=>{"use strict";e.d(R,{o:()=>U,e:()=>w});var t=e(74848),n=e(91076),i=e(96540),s=e(97497),r=e(13544),g=e(14110),a=e(29158),c=e(55852),o=e(96374),h=e(19727),f=e(40276),d=e(66864),p=e(40845),m=e(2913),v=e(79280),l=e(39601),y=e(32696);function u({message:K}){const V=(0,i.useCallback)(()=>{l.Ny.partial({tab:y.M8.Query})},[]);return(0,t.jsx)(d.PE,{justify:"center",style:{marginTop:"100px"},children:(0,t.jsxs)(d.gW,{spacing:"md",children:[(0,t.jsx)("h2",{children:K}),(0,t.jsx)("div",{children:(0,t.jsx)(c.$n,{size:"md",variant:"secondary",icon:"arrow-left",onClick:V,children:"Go back to Queries"})})]})})}var D=e(57650),E=e(32196),x=e(87885),P=e(42418),b=e(10354),M=e(10860),O=e(61680);const I={[x.f.Transformations]:"https://grafana.com/docs/grafana/latest/panels/transformations",[x.f.FieldConfig]:"https://grafana.com/docs/grafana/latest/panels/field-configuration-options/",[x.f.FieldConfigOverrides]:"https://grafana.com/docs/grafana/latest/panels/field-configuration-options/#override-a-field"},T=K=>I[K];var C=e(10803);const S="dashboard.components.TransformationEditor.featureInfoBox.isDismissed";function A(K){const{noTransforms:V,search:H,xforms:Y,onSearchChange:X,onSearchKeyDown:J,onTransformationAdd:q,suffix:ae}=K;return(0,t.jsxs)(d.gW,{children:[V&&(0,t.jsx)(d.mc,{grow:1,children:(0,t.jsx)(O.b,{storageKey:S,defaultValue:!1,children:(j,te)=>j?null:(0,t.jsxs)(P.F,{title:"Transformations",severity:"info",onRemove:()=>{te(!0)},children:[(0,t.jsxs)("p",{children:["Transformations allow you to join, calculate, re-order, hide, and rename your query results before they are visualized. ",(0,t.jsx)("br",{}),"Many transforms are not suitable if you're using the Graph visualization, as it currently only supports time series data. ",(0,t.jsx)("br",{}),"It can help to switch to the Table visualization to understand what a transformation is doing."," "]}),(0,t.jsx)("a",{href:T(x.f.Transformations),className:"external-link",target:"_blank",rel:"noreferrer",children:"Read more"})]})})}),(0,t.jsx)(b.p,{"data-testid":r.Tp.components.Transforms.searchInput,value:H??"",autoFocus:!V,placeholder:"Search for transformation",onChange:X,onKeyDown:J,suffix:ae}),Y.map(j=>(0,t.jsx)(L,{transform:j,onClick:()=>{q({value:j.id})}},j.name))]})}function L({transform:K,onClick:V}){const H=(0,p.of)(N);return(0,t.jsxs)(M.Z,{className:H.card,"data-testid":r.Tp.components.TransformTab.newTransform(K.name),onClick:V,children:[(0,t.jsx)(M.Z.Heading,{children:K.name}),(0,t.jsx)(M.Z.Description,{children:K.description}),K.state&&(0,t.jsx)(M.Z.Tags,{children:(0,t.jsx)(C.p,{state:K.state})})]})}function N(K){return{card:(0,E.css)({margin:"0",padding:`${K.spacing(1)}`})}}var F=e(21427);const w="viewAll";class B extends i.PureComponent{constructor(V){super(V),this.onSearchChange=X=>{this.setState({search:X.target.value})},this.onSearchKeyDown=X=>{if(X.key==="Enter"){const{search:J}=this.state;if(J){const q=J.toLowerCase(),ae=s.h.list().filter(j=>(j.name+j.description).toLowerCase().indexOf(q)>=0);ae.length>0&&this.onTransformationAdd({value:ae[0].id})}}else X.keyCode===27&&(this.setState({search:"",showPicker:!1}),X.stopPropagation())},this.getTransformationNextId=X=>{const{transformations:J}=this.state;let q=0;const ae=J.filter(j=>j.id.startsWith(X)).map(j=>j.id);return ae.length!==0&&(q=Math.max(...ae.map(j=>parseInt(j.match(/\d+/)[0],10)))+1),`${X}-${q}`},this.onTransformationAdd=X=>{let J="panel_editor_tabs_transformations_management";m.Ay.featureToggles.transformationsRedesign&&(J="transformations_redesign_"+J),(0,g.rR)(J,{action:"add",transformationId:X.value});const{transformations:q}=this.state,ae=this.getTransformationNextId(X.value);this.setState({search:"",showPicker:!1}),this.onChange([...q,{id:ae,transformation:{id:X.value,options:{}}}])},this.onTransformationChange=(X,J)=>{const{transformations:q}=this.state,ae=Array.from(q);let j="panel_editor_tabs_transformations_management";m.Ay.featureToggles.transformationsRedesign&&(j="transformations_redesign_"+j),(0,g.rR)(j,{action:"change",transformationId:ae[X].transformation.id}),ae[X].transformation=J,this.onChange(ae)},this.onTransformationRemove=X=>{const{transformations:J}=this.state,q=Array.from(J);let ae="panel_editor_tabs_transformations_management";m.Ay.featureToggles.transformationsRedesign&&(ae="transformations_redesign_"+ae),(0,g.rR)(ae,{action:"remove",transformationId:q[X].transformation.id}),q.splice(X,1),this.onChange(q)},this.onTransformationRemoveAll=()=>{this.onChange([]),this.setState({showRemoveAllModal:!1})},this.onDragEnd=X=>{const{transformations:J}=this.state;if(!X||!X.destination)return;const q=X.source.index,ae=X.destination.index;if(q===ae)return;const j=Array.from(J),[te]=j.splice(q,1);j.splice(ae,0,te),this.onChange(j)},this.renderEmptyMessage=()=>(0,t.jsx)(v.p,{onShowPicker:()=>{this.setState({showPicker:!0})}}),this.renderTransformationEditors=()=>{const{data:X,transformations:J}=this.state;return(0,t.jsx)(n.JY,{onDragEnd:this.onDragEnd,children:(0,t.jsx)(n.gL,{droppableId:"transformations-list",direction:"vertical",children:q=>(0,t.jsxs)("div",{ref:q.innerRef,...q.droppableProps,children:[(0,t.jsx)(D.A,{configs:J,data:X,onRemove:this.onTransformationRemove,onChange:this.onTransformationChange}),q.placeholder]})})})};const H=V.panel.transformations||[],Y=this.buildTransformationIds(H);this.state={transformations:H.map((X,J)=>({transformation:X,id:Y[J]})),data:{series:[]},search:"",selectedFilter:w,showIllustrations:!0}}buildTransformationIds(V){const H={},Y=[];for(let X=0;X<V.length;X++){const J=V[X];H[J.id]===void 0?H[J.id]=0:H[J.id]+=1,Y.push(`${V[X].id}-${H[V[X].id]}`)}return Y}componentDidMount(){this.subscription=this.props.panel.getQueryRunner().getData({withTransforms:!1,withFieldConfig:!1}).subscribe({next:V=>this.setState({data:V})})}componentWillUnmount(){this.subscription&&this.subscription.unsubscribe()}componentDidUpdate(V,H){if(m.Ay.featureToggles.transformationsRedesign){const X=!(H.transformations.length>0)||H.showPicker,q=!(this.state.transformations.length>0)||this.state.showPicker;if(X!==q){const ae=Math.random()/2;this.setState({scrollTop:q?ae:Number.MAX_SAFE_INTEGER})}}}onChange(V){this.setState({transformations:V}),this.props.panel.setTransformations(V.map(H=>H.transformation))}renderTransformsPicker(){let{showPicker:V}=this.state;const{transformations:H,search:Y}=this.state,{transformationsRedesign:X}=m.Ay.featureToggles,J=!H?.length,q=H.length>0;let ae=null,j=s.h.list().sort((z,ee)=>z.name>ee.name?1:ee.name>z.name?-1:0);if(!X&&J&&(V=!0),this.state.selectedFilter!==w&&(j=j.filter(z=>z.categories&&this.state.selectedFilter&&z.categories.has(this.state.selectedFilter))),Y){const z=Y.toLowerCase(),ee=j.filter(se=>(se.name+se.description).toLowerCase().indexOf(z)>=0);ae=(0,t.jsxs)(t.Fragment,{children:[ee.length," / ",j.length," \xA0\xA0",(0,t.jsx)(a.K,{name:"times",onClick:()=>{this.setState({search:""})},tooltip:"Clear search"})]}),j=ee}!ae&&V&&!J&&(ae=(0,t.jsx)(a.K,{name:"times",onClick:()=>{this.setState({showPicker:!1})},tooltip:"Close picker"}));let te=null,ne=null;X?(te=(0,t.jsx)(F.R,{noTransforms:J,search:Y,suffix:ae,xforms:j,onClose:()=>this.setState({showPicker:!1}),onSelectedFilterChange:z=>this.setState({selectedFilter:z}),onShowIllustrationsChange:z=>this.setState({showIllustrations:z}),onSearchChange:this.onSearchChange,onSearchKeyDown:this.onSearchKeyDown,onTransformationAdd:this.onTransformationAdd,data:this.state.data.series,selectedFilter:this.state.selectedFilter,showIllustrations:this.state.showIllustrations}),ne=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.$n,{icon:"times",variant:"secondary",onClick:()=>this.setState({showRemoveAllModal:!0}),style:{marginLeft:this.props.theme.spacing.md},children:"Delete all transformations"}),(0,t.jsx)(o.u,{isOpen:!!this.state.showRemoveAllModal,title:"Delete all transformations?",body:"By deleting all transformations, you will go back to the main selection screen.",confirmText:"Delete all",onConfirm:()=>this.onTransformationRemoveAll(),onDismiss:()=>this.setState({showRemoveAllModal:!1})})]})):te=(0,t.jsx)(A,{noTransforms:J,search:Y,suffix:ae,xforms:j,onSearchChange:this.onSearchChange,onSearchKeyDown:this.onSearchKeyDown,onTransformationAdd:this.onTransformationAdd});const le=(0,t.jsxs)(h.e,{children:[(0,t.jsx)(c.$n,{icon:"plus",variant:"secondary",onClick:()=>{this.setState({showPicker:!0})},"data-testid":r.Tp.components.Transforms.addTransformationButton,children:"Add another transformation"}),ne]});return(0,t.jsxs)(t.Fragment,{children:[V&&te,X&&q&&le||!X&&!V&&q&&le]})}render(){const{panel:{alert:V}}=this.props,{transformations:H}=this.state,Y=H.length>0;if(V){const X=Y?"Transformations can't be used on a panel with alerts":"Transformations can't be used on a panel with existing alerts";return(0,t.jsx)(u,{message:X})}return(0,t.jsx)(f.E,{scrollTop:this.state.scrollTop,autoHeightMin:"100%",children:(0,t.jsx)(d.mc,{padding:"lg",children:(0,t.jsxs)("div",{"data-testid":r.Tp.components.TransformTab.content,children:[!Y&&m.Ay.featureToggles.transformationsRedesign&&this.renderEmptyMessage(),Y&&this.renderTransformationEditors(),this.renderTransformsPicker()]})})})}}const U=(0,p.SL)(B)},68064:(k,R,e)=>{"use strict";e.d(R,{A:()=>D});var t=e(74848),n=e(32196),i=e(13544),s=e(39601),r=e(32264),g=e(40845),a=e(67061),c=e(90613),o=e(94753),h=e(55852),f=e(8484),d=e(36974),p=e(19293),m=e(34842),v=e(7758),l=e(31678),y=e(28601);const D=({dashboard:x,canCreate:P})=>{const b=(0,g.of)(E),M=(0,l.useDispatch)(),O=(0,l.useSelector)(C=>C.dashboard.initialDatasource),I=()=>{let C;if(x instanceof m.H$){const S=x.onCreateNewPanel();x.setState({editPanel:(0,p.L)(S,!0)}),s.Ny.partial({firstPanel:!0})}else C=(0,d.OK)(x,O),M((0,y.Ub)(void 0)),s.Ny.partial({editPanel:C,firstPanel:!0});v.c.emptyDashboardButtonClicked({item:"add_visualization"})},T=()=>{v.c.emptyDashboardButtonClicked({item:"import_from_library"}),x instanceof m.H$?x.onShowAddLibraryPanelDrawer():(0,d.s3)(x)};return(0,t.jsx)(a.B,{alignItems:"center",justifyContent:"center",children:(0,t.jsx)("div",{className:b.wrapper,children:(0,t.jsxs)(a.B,{alignItems:"stretch",justifyContent:"center",gap:4,direction:"column",children:[(0,t.jsx)(c.a,{borderColor:"strong",borderStyle:"dashed",padding:4,children:(0,t.jsxs)(a.B,{direction:"column",alignItems:"center",gap:2,children:[(0,t.jsx)(o.E,{element:"h1",textAlignment:"center",weight:"medium",children:(0,t.jsx)(f.x6,{i18nKey:"dashboard.empty.add-visualization-header",children:"Start your new dashboard by adding a visualization"})}),(0,t.jsx)(c.a,{marginBottom:2,paddingX:4,children:(0,t.jsx)(o.E,{element:"p",textAlignment:"center",color:"secondary",children:(0,t.jsx)(f.x6,{i18nKey:"dashboard.empty.add-visualization-body",children:"Select a data source and then query and visualize your data with charts, stats and tables or create lists, markdowns and other widgets."})})}),(0,t.jsx)(h.$n,{size:"lg",icon:"plus","data-testid":i.Tp.pages.AddDashboard.itemButton("Create new panel button"),onClick:I,disabled:!P,children:(0,t.jsx)(f.x6,{i18nKey:"dashboard.empty.add-visualization-button",children:"Add visualization"})})]})}),(0,t.jsxs)(a.B,{direction:{xs:"column",md:"row"},wrap:"wrap",gap:4,children:[r.$.featureToggles.vizAndWidgetSplit&&(0,t.jsx)(c.a,{borderColor:"strong",borderStyle:"dashed",padding:3,flex:1,children:(0,t.jsxs)(a.B,{direction:"column",alignItems:"center",gap:1,children:[(0,t.jsx)(o.E,{element:"h3",textAlignment:"center",weight:"medium",children:(0,t.jsx)(f.x6,{i18nKey:"dashboard.empty.add-widget-header",children:"Add a widget"})}),(0,t.jsx)(c.a,{marginBottom:2,children:(0,t.jsx)(o.E,{element:"p",textAlignment:"center",color:"secondary",children:(0,t.jsx)(f.x6,{i18nKey:"dashboard.empty.add-widget-body",children:"Create lists, markdowns and other widgets"})})}),(0,t.jsx)(h.$n,{icon:"plus",fill:"outline","data-testid":i.Tp.pages.AddDashboard.itemButton("Create new widget button"),onClick:()=>{v.c.emptyDashboardButtonClicked({item:"add_widget"}),s.Ny.partial({addWidget:!0})},disabled:!P,children:(0,t.jsx)(f.x6,{i18nKey:"dashboard.empty.add-widget-button",children:"Add widget"})})]})}),(0,t.jsx)(c.a,{borderColor:"strong",borderStyle:"dashed",padding:3,flex:1,children:(0,t.jsxs)(a.B,{direction:"column",alignItems:"center",gap:1,children:[(0,t.jsx)(o.E,{element:"h3",textAlignment:"center",weight:"medium",children:(0,t.jsx)(f.x6,{i18nKey:"dashboard.empty.add-library-panel-header",children:"Import panel"})}),(0,t.jsx)(c.a,{marginBottom:2,children:(0,t.jsx)(o.E,{element:"p",textAlignment:"center",color:"secondary",children:(0,t.jsx)(f.x6,{i18nKey:"dashboard.empty.add-library-panel-body",children:"Add visualizations that are shared with other dashboards."})})}),(0,t.jsx)(h.$n,{icon:"plus",fill:"outline","data-testid":i.Tp.pages.AddDashboard.itemButton("Add a panel from the panel library button"),onClick:T,disabled:!P,children:(0,t.jsx)(f.x6,{i18nKey:"dashboard.empty.add-library-panel-button",children:"Add library panel"})})]})}),(0,t.jsx)(c.a,{borderColor:"strong",borderStyle:"dashed",padding:3,flex:1,children:(0,t.jsxs)(a.B,{direction:"column",alignItems:"center",gap:1,children:[(0,t.jsx)(o.E,{element:"h3",textAlignment:"center",weight:"medium",children:(0,t.jsx)(f.x6,{i18nKey:"dashboard.empty.import-a-dashboard-header",children:"Import a dashboard"})}),(0,t.jsx)(c.a,{marginBottom:2,children:(0,t.jsx)(o.E,{element:"p",textAlignment:"center",color:"secondary",children:(0,t.jsxs)(f.x6,{i18nKey:"dashboard.empty.import-a-dashboard-body",children:["Import dashboards from files or ",(0,t.jsx)("a",{href:"https://grafana.com/grafana/dashboards/",children:"grafana.com"}),"."]})})}),(0,t.jsx)(h.$n,{icon:"upload",fill:"outline","data-testid":i.Tp.pages.AddDashboard.itemButton("Import dashboard button"),onClick:()=>{v.c.emptyDashboardButtonClicked({item:"import_dashboard"}),(0,d.VF)()},disabled:!P,children:(0,t.jsx)(f.x6,{i18nKey:"dashboard.empty.import-dashboard-button",children:"Import dashboard"})})]})})]})]})})})};function E(x){return{wrapper:(0,n.css)({label:"dashboard-empty-wrapper",flexDirection:"column",maxWidth:"890px",gap:x.spacing.gridSize*4,paddingTop:x.spacing(2),[x.breakpoints.up("sm")]:{paddingTop:x.spacing(12)}})}}},2038:(k,R,e)=>{"use strict";e.d(R,{Z:()=>d});var t=e(74848),n=e(96540),i=e(39601),s=e(32196),r=e(40845),g=e(27746),a=e(14578),c=e(56034),o=e(16797);const h=({notice:p,onClick:m})=>{const v=(0,r.of)(f),l=p.severity==="error"||p.severity==="warning"?"exclamation-triangle":"file-landscape-alt";return p.inspect&&m?(0,t.jsx)(g.I,{className:v.notice,icon:l,iconSize:"md",tooltip:p.text,onClick:y=>m(y,p.inspect)},p.severity):p.link?(0,t.jsx)("a",{className:v.notice,"aria-label":p.text,href:p.link,target:"_blank",rel:"noreferrer",children:(0,t.jsx)(a.I,{name:l,style:{marginRight:"8px"},size:"md"})}):(0,t.jsx)(c.m,{content:p.text,children:(0,t.jsx)("span",{className:v.iconTooltip,children:(0,t.jsx)(a.I,{name:l,size:"md"})})},p.severity)},f=p=>({notice:(0,s.css)({background:"inherit",border:"none",borderRadius:p.shape.radius.default}),iconTooltip:(0,s.css)({color:`${p.colors.text.secondary}`,backgroundColor:"inherit",cursor:"auto",border:"none",borderRadius:`${p.shape.radius.default}`,padding:`${p.spacing(0,1)}`,height:` ${p.spacing(p.components.height.md)}`,display:"flex",alignItems:"center",justifyContent:"center","&:focus, &:focus-visible":{...(0,o.getFocusStyles)(p),zIndex:1},"&: focus:not(:focus-visible)":(0,o.getMouseFocusStyles)(p),"&:hover ":{boxShadow:`${p.shadows.z1}`,color:`${p.colors.text.primary}`,background:`${p.colors.background.secondary}`}})}),d=({frames:p,panelId:m})=>{const v=(0,n.useCallback)((y,u)=>{y.stopPropagation(),i.Ny.partial({inspect:m,inspectTab:u})},[m]),l={};for(const y of p)if(!(!y.meta||!y.meta.notices))for(const u of y.meta.notices)l[u.severity]=u;return(0,t.jsx)(t.Fragment,{children:Object.values(l).map(y=>(0,t.jsx)(h,{notice:y,onClick:v},y.severity))})}},91126:(k,R,e)=>{"use strict";e.d(R,{M:()=>h});var t=e(37055),n=e(58972),i=e(1173),s=e(11261),r=e(28240),g=e(85200),a=e(88895);const c="hideSeriesFrom",o=(0,t.ZW)(c);function h(y,u,D,E){const{overrides:x}=D,P=y,b=x.findIndex(o);if(b<0){if(u===a.B.ToggleSelection){const S=f([P,...l(x,E)]);return{...D,overrides:[...D.overrides,S]}}const T=v(E,P),C=f(T);return{...D,overrides:[...D.overrides,C]}}const M=Array.from(x),[O]=M.splice(b,1);if(u===a.B.ToggleSelection){let T=p(O);const C=l(M,E);if(C.length>0&&(T=T.filter(A=>C.indexOf(A)<0)),T[0]===P&&T.length===1)return{...D,overrides:M};const S=f([P,...C]);return{...D,overrides:[...M,S]}}const I=d(O,P);return m(I,E)?{...D,overrides:M}:{...D,overrides:[...M,I]}}function f(y,u=n.PP.exclude,D){return D=D??{id:"custom.hideFrom",value:{viz:!0,legend:!1,tooltip:!1}},{__systemRef:c,matcher:{id:i.Ct.byNames,options:{mode:u,names:y,prefix:u===n.PP.exclude?"All except:":void 0,readOnly:!0}},properties:[{...D,value:{viz:!0,legend:!1,tooltip:!1}}]}}const d=(y,u,D=n.PP.exclude)=>{const E=y.properties.find(b=>b.id==="custom.hideFrom"),x=p(y),P=x.findIndex(b=>b===u);return P<0?x.push(u):x.splice(P,1),f(x,D,E)},p=y=>{const u=y.matcher.options?.names;return Array.isArray(u)?[...u]:[]},m=(y,u)=>p(y).length===v(u).length,v=(y,u)=>{const D=new Set;for(const E of y)for(const x of E.fields){if(x.type!==s.PU.number)continue;const P=(0,r.Ct)(x,E,y);P!==u&&D.add(P)}return Array.from(D)},l=(y,u)=>{let D=[];for(const E of y){const x=E.properties.find(P=>P.id==="custom.hideFrom");if(x!==void 0&&x.value?.legend===!0){const b=g.sJ.get(E.matcher.id).get(E.matcher.options);for(const M of u)for(const O of M.fields){if(O.type!==s.PU.number)continue;const I=(0,r.Ct)(O,M,u);b(O,M,u)&&D.push(I)}}}return D}},61582:(k,R,e)=>{"use strict";e.d(R,{a:()=>c});var t=e(49426),n=e(47232),i=e(85858);const s=100;class r{constructor(){this.listeners=[],this.budget=1,this.threshold=1.5,this.ok=new t.t(!0),this.lastUpdate=Date.now(),this.isLive=!1,this.liveTimeOffset=0,this.measure=()=>{const h=Date.now();this.budget=(h-this.lastUpdate)/s;const f=this.ok.getValue(),d=this.budget<=this.threshold;if(f!==d&&this.ok.next(d),this.lastUpdate=h,this.isLive&&this.ok.getValue()&&this.timeRange){let p;for(const m of this.listeners){if(!m.panel.props.isInView)continue;if(h-m.last>=m.intervalMs){if(!p){const{raw:l}=this.timeRange;p={raw:l,from:(0,n.KQ)(h-this.liveTimeOffset),to:(0,n.KQ)(h)}}m.panel.liveTimeChanged(p),m.last=h}}}}}setLiveTimeRange(h){if(this.timeRange=h,this.isLive=h?.raw?.to==="now",this.isLive){const f=i.parse(h.raw.from,!1)?.valueOf(),d=i.parse(h.raw.to,!0)?.valueOf();this.liveTimeOffset=d-f;for(const p of this.listeners)p.intervalMs=a(this.liveTimeOffset,p.panel.props.width)}}listen(h){this.listeners.push({last:this.lastUpdate,panel:h,intervalMs:a(6e4,h.props.width)})}remove(h){this.listeners=this.listeners.filter(f=>f.panel!==h)}updateInterval(h){if(!(!this.timeRange||!this.isLive)){for(const f of this.listeners)if(f.panel===h){f.intervalMs=a(this.liveTimeOffset,f.panel.props.width);return}}}}const g=5*60*1e3;function a(o,h){const f=Math.ceil(o/h/100)*100;return f>g?g:f}const c=new r;setInterval(c.measure,s)},17493:(k,R,e)=>{"use strict";e.d(R,{Fu:()=>E,np:()=>x});var t=e(34796),n=e.n(t),i=e(2543),s=e.n(i),r=e(95093),g=e.n(r),a=e(26272),c=e(85858),o=e(17172),h=e(39601),f=e(27677),d=e(62301),p=e(68576),m=e(72255),v=e(31193),l=e(10096),y=e(28676),u=e(14792),D=e(69064);class E{constructor(){}_dashboardLoadFailed(M,O){return O=O||!1,{meta:{canStar:!1,isSnapshot:O,canDelete:!1,canSave:!1,canEdit:!1,canShare:!1,dashboardNotFound:!0},dashboard:{title:M,uid:M,schemaVersion:0}}}loadDashboard(M,O,I){const T=(0,m.sP)();let C;if(M==="script"&&O)C=this._loadScriptedDashboard(O);else if(M==="snapshot"&&O)C=(0,D.s)().getSnapshot(O).catch(()=>this._dashboardLoadFailed("Snapshot not found",!0));else if(M==="ds"&&O)C=this._loadFromDatasource(O);else if(M==="public"&&I)C=f.IB.getPublicDashboardByUid(I).then(S=>S).catch(S=>{const A=S.data.statusCode===403&&S.data.messageId==="publicdashboards.notEnabled",L=S.data.statusCode===404&&S.data.messageId==="publicdashboards.notFound",N=S.data.statusCode===404&&S.data.messageId==="publicdashboards.dashboardNotFound",F=this._dashboardLoadFailed(A?"Public Dashboard paused":"Public Dashboard Not found",!0);return{...F,meta:{...F.meta,publicDashboardEnabled:L?void 0:!A,dashboardNotFound:L||N}}});else if(I){const S=T.getDashboardFromCache(I);if(S)return Promise.resolve(S);C=(0,y.n)().getDashboardDTO(I).then(A=>{if(A.meta.isFolder)throw l.lE.emit(a.r1.alertError,["Dashboard not found"]),new Error("Dashboard not found");return A}).catch(()=>{const A=this._dashboardLoadFailed("Not found",!0);return A.dashboard.uid=I,A})}else throw new Error("Dashboard uid or slug required");return C.then(S=>(S.meta.dashboardNotFound!==!0&&d.A.addDashboardImpression(S.dashboard.uid),S)),C}_loadScriptedDashboard(M){const O="public/dashboards/"+M.replace(/\.(?!js)/,"/")+"?"+new Date().getTime();return(0,o.AI)().get(O).then(this._executeScript.bind(this)).then(I=>({meta:{fromScript:!0,canDelete:!1,canSave:!1,canStar:!1},dashboard:I.data}),I=>(console.error("Script dashboard error "+I),l.lE.emit(a.r1.alertError,["Script Error","Please make sure it exists and returns a valid dashboard"]),this._dashboardLoadFailed("Scripted dashboard")))}async _loadFromDatasource(M){const O=await(0,v.tR)().get(M);if(!O)return Promise.reject("can not find datasource: "+M);const I=new URLSearchParams(window.location.search),T=I.get("path");if(!T)return Promise.reject("expecting path parameter");const C={};return I.forEach((S,A)=>{C[A]=S}),(0,o.AI)().get(`/api/datasources/uid/${O.uid}/resources/${T}`,C).then(S=>({meta:{fromScript:!0,canDelete:!1,canSave:!1,canStar:!1},dashboard:S}))}_executeScript(M){const O={dashboardSrv:(0,u.UA)(),datasourceSrv:(0,v.tR)()},T=new Function("ARGS","kbn","dateMath","_","moment","window","document","$","jQuery","services",M)(h.Ny.getSearchObject(),p.A,c,s(),g(),window,document,n(),n(),O);return(0,i.isFunction)(T)?new Promise(C=>{T(S=>{C({data:S})})}):{data:T}}}let x=new E;const P=b=>{throw new Error("dashboardLoaderSrv can be only overriden in test environment")}},14792:(k,R,e)=>{"use strict";e.d(R,{UA:()=>d});var t=e(26272),n=e(28138),i=e(8484),s=e(27677),r=e(28676),g=e(28444),a=e(98365),c=e(19752);class o{constructor(){this.onRemovePanel=m=>{const v=this.getCurrent();v&&(0,c.FC)(v,v.getPanelById(m),!0)},n.l.subscribe(g.Vz,m=>this.onRemovePanel(m.payload))}create(m,v){return new a.G(m,v)}setCurrent(m){this.dashboard=m}getCurrent(){return this.dashboard}saveJSONDashboard(m){const v=JSON.parse(m);return(0,r.n)().saveDashboard({dashboard:v,folderUid:this.dashboard?.meta.folderUid||v.folderUid})}saveDashboard(m,v){return(0,r.n)().saveDashboard({message:m.message,folderUid:m.folderUid,dashboard:m.dashboard.getSaveModelClone(),showErrorAlert:v?.showErrorAlert})}starDashboard(m,v){const l=(0,s.AI)(),y={showSuccessAlert:!1,url:"/api/user/stars/dashboard/uid/"+m,method:v?"DELETE":"POST"};return l.request(y).then(()=>{const u=!v;this.dashboard?.uid===m&&(this.dashboard.meta.isStarred=u);const D=u?(0,i.t)("notifications.starred-dashboard","Dashboard starred"):(0,i.t)("notifications.unstarred-dashboard","Dashboard unstarred");return n.l.emit(t.r1.alertSuccess,[D]),u})}}let h;function f(p){h=p}function d(){return h||(h=new o),h}},69064:(k,R,e)=>{"use strict";e.d(R,{s:()=>c});var t=e(75505),n=e(81160),i=e(17172),s=e(32264),r=e(10096);const g={create:o=>(0,i.AI)().post("/api/snapshots",o),getSnapshots:()=>(0,i.AI)().get("/api/dashboard/snapshots"),getSharingOptions:()=>(0,i.AI)().get("/api/snapshot/shared-options"),deleteSnapshot:o=>(0,i.AI)().delete("/api/snapshots/"+o),getSnapshot:async o=>{const h=await(0,i.AI)().get("/api/snapshots/"+o);return h.meta.canShare=!1,h}};class a{constructor(){this.apiVersion="dashboardsnapshot.grafana.app/v0alpha1",this.url=`/apis/${this.apiVersion}/namespaces/${s.$.namespace}/dashboardsnapshots`}async create(h){return(0,i.AI)().post(this.url+"/create",h)}async getSnapshots(){return(await(0,i.AI)().get(this.url)).items.map(f=>({key:f.metadata.name,name:f.spec.title,external:f.spec.externalUrl!=null,externalUrl:f.spec.externalUrl}))}deleteSnapshot(h){return(0,i.AI)().delete(this.url+"/"+h)}async getSharingOptions(){return(0,i.AI)().get("/api/snapshot/shared-options")}async getSnapshot(h){const f={};if(!r.TP.isSignedIn){alert("TODO... need a barer token for anonymous use case");const d=`??? TODO, get anon token for snapshots (${r.TP.user?.name}) ???`;f.Authorization=`Bearer ${d}`}return(0,t.s)((0,i.AI)().fetch({url:this.url+"/"+h+"/body",method:"GET",headers:f}).pipe((0,n.T)(d=>({dashboard:d.data.dashboard,meta:{isSnapshot:!0,canSave:!1,canEdit:!1,canAdmin:!1,canStar:!1,canShare:!1,canDelete:!1,isFolder:!1,provisioned:!1}}))))}}function c(){return s.$.featureToggles.kubernetesSnapshots?new a:g}},74856:(k,R,e)=>{"use strict";e.d(R,{jG:()=>x});var t=e(2543),n=e(47232),i=e(43127),s=e(65879),r=e(26272),g=e(85858),a=e(39601),c=e(80943),o=e(76412),h=e(28138),f=e(2913),d=e(16233),p=e(80582),m=e(21380),v=e(28444),l=e(11134);function y({urlRefresh:P,currentRefresh:b,isAllowedIntervalFn:M,minRefreshInterval:O,refreshIntervals:I=l.cb}){if(!P)return b;const T=M(P),C=I.find(S=>S===P);if(!T||!C){const S=O?I.find(L=>L===O):void 0,A=I?.length?I[0]:void 0;return S??A??b}return P||b}class u{constructor(b){this.contextSrv=b,this.timeRangeForUrl=()=>{const M=this.timeRange().raw;return(0,n.Ar)(M.from)&&(M.from=M.from.valueOf().toString()),(0,n.Ar)(M.to)&&(M.to=M.to.valueOf().toString()),M},this.time=(0,i.E2)().raw,this.timeAtLoad=(0,i.E2)().raw,this.refreshTimeModel=this.refreshTimeModel.bind(this),h.A.subscribe(v.U0,M=>{this.zoomOut(M.payload.scale,M.payload.updateUrl)}),h.A.subscribe(v.Io,M=>{this.shiftTime(M.payload.direction,M.payload.updateUrl)}),h.A.subscribe(v.Rh,M=>{this.makeAbsoluteTime(M.payload.updateUrl)}),h.A.subscribe(v.Bt,()=>{this.copyTimeRangeToClipboard()}),h.A.subscribe(v.VZ,M=>{this.pasteTimeRangeFromClipboard(M.payload.updateUrl)}),document.addEventListener("visibilitychange",()=>{this.autoRefreshBlocked&&document.visibilityState==="visible"&&(this.autoRefreshBlocked=!1,this.refreshTimeModel())})}init(b){this.timeModel=b,this.time=b.time,this.refresh=b.refresh,this.initTimeFromUrl(),this.parseTime(),this.timeAtLoad=(0,t.cloneDeep)(this.time),this.refresh&&this.setAutoRefresh(this.refresh)}getValidIntervals(b){return this.contextSrv.getValidIntervals(b)}parseTime(){(0,t.isString)(this.time.from)&&this.time.from.indexOf("Z")>=0&&(this.time.from=(0,n.KQ)(this.time.from).utc()),(0,t.isString)(this.time.to)&&this.time.to.indexOf("Z")>=0&&(this.time.to=(0,n.KQ)(this.time.to).utc())}parseUrlParam(b,M){if(b.indexOf("now")!==-1)return b;if(b.length===8){const O=(0,n.yT)(b,"YYYYMMDD");if(O.isValid())return O}else if(b.length===15){const O=(0,n.yT)(b,"YYYYMMDDTHHmmss");if(O.isValid())return O}if(!isNaN(Number(b))){const O=parseInt(b,10);return M?(0,n.oZ)(M,O):(0,n.yT)(O)}return null}getTimeWindow(b,M){const O=parseInt(b,10);let I;return M.match(/^\d+$/)&&parseInt(M,10)?I=parseInt(M,10):I=s.intervalToMs(M),{from:(0,n.yT)(O-I/2),to:(0,n.yT)(O+I/2)}}initTimeFromUrl(){if(f.config.publicDashboardAccessToken&&this.timeModel?.timepicker?.hidden)return;const b=a.Ny.getSearch();b.get("time")&&b.get("time.window")&&(this.time=this.getTimeWindow(b.get("time"),b.get("time.window")));const M=this.timeModel?.getTimezone();b.get("from")&&(this.time.from=this.parseUrlParam(b.get("from"),M)||this.time.from),b.get("to")&&(this.time.to=this.parseUrlParam(b.get("to"),M)||this.time.to),b.get("to")&&b.get("to").indexOf("now")===-1&&(this.refresh=!1,this.timeModel&&(this.timeModel.refresh=void 0)),this.refresh=y({urlRefresh:b.get("refresh"),currentRefresh:this.refresh,refreshIntervals:Array.isArray(this.timeModel?.timepicker?.refresh_intervals)?this.timeModel?.timepicker?.refresh_intervals:void 0,isAllowedIntervalFn:this.contextSrv.isAllowedInterval,minRefreshInterval:f.config.minRefreshInterval})}updateTimeRangeFromUrl(){const b=a.Ny.getSearch();if(b.get("left"))return;const M=this.timeRangeForUrl(),O=b.get("from"),I=b.get("to");O&&I?(O!==M.from||I!==M.to)&&(this.initTimeFromUrl(),this.setTime(this.time,!1)):this.timeHasChangedSinceLoad()&&this.setTime(this.timeAtLoad,!0)}timeHasChangedSinceLoad(){return this.timeAtLoad&&(this.timeAtLoad.from!==this.time.from||this.timeAtLoad.to!==this.time.to)}setAutoRefresh(b){this.timeModel&&(this.timeModel.refresh=b),this.stopAutoRefresh();const M=a.Ny.getSearchObject();if(!b){M.refresh&&a.Ny.partial({refresh:null},!0);return}let O=b,I=60*1e3;b===d.SM?I=this.getAutoRefreshInteval().intervalMs:(O=this.contextSrv.getValidInterval(b),I=s.intervalToMs(O)),this.refreshMS=I,this.refreshTimer=window.setTimeout(()=>{this.startNextRefreshTimer(I),this.refreshTimeModel()},I),M.refresh!==O&&a.Ny.partial({refresh:O},!0)}getAutoRefreshInteval(){const b=window?.innerWidth??2e3;return s.calculateInterval(this.timeRange(),b,f.config.minRefreshInterval)}refreshTimeModel(){this.timeModel?.timeRangeUpdated(this.timeRange())}startNextRefreshTimer(b){this.refreshTimer=window.setTimeout(()=>{this.startNextRefreshTimer(b),this.contextSrv.isGrafanaVisible()?this.refreshTimeModel():this.autoRefreshBlocked=!0},b)}stopAutoRefresh(){clearTimeout(this.refreshTimer),this.refreshTimer=void 0,this.refreshMS=void 0}resumeAutoRefresh(){this.timeModel?.refresh&&this.setAutoRefresh(this.timeModel.refresh)}setTime(b,M=!0){if((0,t.extend)(this.time,b),(0,n.Ar)(b.to)?(this.oldRefresh=this.timeModel?.refresh||this.oldRefresh,this.setAutoRefresh("")):this.oldRefresh&&this.oldRefresh!==this.timeModel?.refresh&&(this.setAutoRefresh(this.oldRefresh),this.oldRefresh=void 0),M===!0){const O=this.timeRangeForUrl(),I=a.Ny.getSearchObject();if(I.from===O.from.toString()&&I.to===O.to.toString())return;I.from=O.from.toString(),I.to=O.to.toString(),a.Ny.partial(I)}this.timeModel?.refresh===d.SM&&this.getAutoRefreshInteval().intervalMs!==this.refreshMS&&this.setAutoRefresh(d.SM),this.refreshTimeModel()}timeRange(){return window.__grafanaSceneContext&&window.__grafanaSceneContext.isActive?c.jh.getTimeRange(window.__grafanaSceneContext).state.value:(0,m.z)(this.time,this.timeModel)}zoomOut(b,M=!0){const O=this.timeRange(),{from:I,to:T}=(0,p.Zk)(O,b);this.setTime({from:(0,n.yT)(I),to:(0,n.yT)(T)},M)}shiftTime(b,M=!0){const O=this.timeRange(),{from:I,to:T}=(0,p.Wb)(b,O);this.setTime({from:(0,n.yT)(I),to:(0,n.yT)(T)},M)}makeAbsoluteTime(b){const{from:M,to:O}=this.timeRange();this.setTime({from:M,to:O},b)}copyTimeRangeToClipboard(){const{raw:b}=this.timeRange();navigator.clipboard.writeText(JSON.stringify({from:b.from,to:b.to})),h.A.emit(r.r1.alertSuccess,[(0,o.t)("time-picker.copy-paste.copy-success-message","Time range copied to clipboard")])}async pasteTimeRangeFromClipboard(b=!0){const{range:M,isError:O}=await(0,p.zG)();if(O===!0){h.A.emit(r.r1.alertError,[(0,o.t)("time-picker.copy-paste.default-error-title","Invalid time range"),(0,o.t)("time-picker.copy-paste.default-error-message","{{error}} is not a valid time range",{error:M})]);return}const{from:I,to:T}=M;this.setTime({from:I,to:T},b)}isRefreshOutsideThreshold(b,M=.05){const O=this.timeRange();if(g.isMathString(O.raw.from)){const I=O.to.diff(O.from),T=Date.now()-b,C=I*M;return T>=C}return!1}}let D;function E(P){D=P}function x(){return D||(D=new u(d.TP)),D}},79056:(k,R,e)=>{"use strict";e.d(R,{O2:()=>w,SW:()=>B,og:()=>X});var t=e(2543),n=e(69550),i=e(92041),s=e(12470),r=e(22391),g=e(76885),a=e(6709),c=e(25019),o=e(47737),h=e(1173),f=e(11261),d=e(6829),p=e(58140),m=e(19347),v=e(52622),l=e(57021),y=e(33919),u=e(2913),D=e(15054);function E(z){return Array.from(new Array(z+1),(ee,se)=>se).filter(ee=>z%ee===0)}var x=e(68576),P=e(31193),b=e(24240),M=e(86886),O=e(14678),I=e(14738),T=e(36373),C=e(77789),S=e(25640);function A(z,ee){const se=[];if(z?.statistics&&z?.statistics.length){z.statistic=z.statistics[0];for(const ie of z.statistics.splice(1))se.push({...z,statistic:ie})}for(const ie of se)ie.refId=(0,C.M)(ee),delete ie.statistics,ee.push(ie);return delete z.statistics,se}function L(z){const ee=[];if(z&&"statistics"in z&&z?.statistics?.length){for(const se of z.statistics.splice(1)){const{statistics:ie,name:Z,...oe}=z;ee.push({...oe,statistic:se,name:`${Z} - ${se}`})}z.statistic=z.statistics[0],ee.length!==0&&(z.name=`${z.name} - ${z.statistic}`),delete z.statistics}return ee}function N(z){z.hasOwnProperty("metricQueryType")||(z.metricQueryType=S.d$.Search),z.hasOwnProperty("metricEditorMode")||(z.metricQueryType===S.d$.Insights?z.metricEditorMode=S.Rx.Code:z.metricEditorMode=z.expression?S.Rx.Code:S.Rx.Builder)}var F=e(84423);n.D.setInit(y.H),n.G.setInit(y.u);const w=39;class B{constructor(ee){this.dashboard=ee,(0,m.l)()||(0,m.h)(new P.xq)}updateSchema(ee){let se,ie,Z,oe;const ce=this.dashboard.schemaVersion,ye=[];if(this.dashboard.schemaVersion=w,ce!==this.dashboard.schemaVersion){if(ce<2&&(ee.services&&ee.services.filter&&(this.dashboard.time=ee.services.filter.time,this.dashboard.templating.list=ee.services.filter.list||[]),ye.push(re=>(re.type==="graphite"&&(re.type="graph"),re.type!=="graph"||((0,t.isBoolean)(re.legend)&&(re.legend={show:re.legend}),re.grid&&(re.grid.min&&(re.grid.leftMin=re.grid.min,delete re.grid.min),re.grid.max&&(re.grid.leftMax=re.grid.max,delete re.grid.max)),re.y_format&&(re.y_formats||(re.y_formats=[]),re.y_formats[0]=re.y_format,delete re.y_format),re.y2_format&&(re.y_formats||(re.y_formats=[]),re.y_formats[1]=re.y2_format,delete re.y2_format)),re))),ce<3){let re=this.dashboard.getNextPanelId();ye.push(ue=>(ue.id||(ue.id=re,re+=1),ue))}if(ce<4&&ye.push(re=>(re.type!=="graph"||((0,t.each)(re.aliasYAxis,(ue,De)=>{re.seriesOverrides=[{alias:De,yaxis:ue}]}),delete re.aliasYAxis),re)),ce<6){const re=(0,t.find)(ee.pulldowns,{type:"annotations"});for(re&&(this.dashboard.annotations={list:re.annotations||[]}),se=0;se<this.dashboard.templating.list.length;se++){const ue=this.dashboard.templating.list[se];ue.datasource===void 0&&(ue.datasource=null),ue.type==="filter"&&(ue.type="query"),ue.type===void 0&&(ue.type="query"),ue.allFormat===void 0&&delete ue.allFormat}}if(ce<7&&(ee.nav&&ee.nav.length&&(this.dashboard.timepicker=ee.nav[0]),ye.push(re=>((0,t.each)(re.targets,ue=>{ue.refId||(ue.refId=re.getNextQueryLetter&&re.getNextQueryLetter())}),re))),ce<8&&ye.push(re=>((0,t.each)(re.targets,ue=>{ue.fields&&ue.tags&&ue.groupBy&&(ue.rawQuery?(delete ue.fields,delete ue.fill):(ue.select=(0,t.map)(ue.fields,De=>{const ge=[];return ge.push({type:"field",params:[De.name]}),ge.push({type:De.func,params:[]}),De.mathExpr&&ge.push({type:"math",params:[De.mathExpr]}),De.asExpr&&ge.push({type:"alias",params:[De.asExpr]}),ge}),delete ue.fields,(0,t.each)(ue.groupBy,De=>{De.type==="time"&&De.interval&&(De.params=[De.interval],delete De.interval),De.type==="tag"&&De.key&&(De.params=[De.key],delete De.key)}),ue.fill&&(ue.groupBy.push({type:"fill",params:[ue.fill]}),delete ue.fill)))}),re)),ce<9&&ye.push(re=>{if(re.type!=="singlestat"&&re.thresholds!=="")return re;if(re.thresholds){const ue=re.thresholds.split(",");ue.length>=3&&(ue.shift(),re.thresholds=ue.join(","))}return re}),ce<10&&ye.push(re=>(re.type!=="table"||(0,t.each)(re.styles,ue=>{if(ue.thresholds&&ue.thresholds.length>=3){const De=ue.thresholds;De.shift(),ue.thresholds=De}}),re)),ce<12&&(0,t.each)(this.dashboard.getVariables(),re=>{"refresh"in re&&(re.refresh&&(re.refresh=1),re.refresh||(re.refresh=0)),"hideVariable"in re&&re.hideVariable?re.hide=2:"hideLabel"in re&&re.hideLabel&&(re.hide=1)}),ce<12&&ye.push(re=>(re.type!=="graph"||!re.grid||re.yaxes||(re.yaxes=[{show:re["y-axis"],min:re.grid.leftMin,max:re.grid.leftMax,logBase:re.grid.leftLogBase,format:re.y_formats[0],label:re.leftYAxisLabel},{show:re["y-axis"],min:re.grid.rightMin,max:re.grid.rightMax,logBase:re.grid.rightLogBase,format:re.y_formats[1],label:re.rightYAxisLabel}],re.xaxis={show:re["x-axis"]},delete re.grid.leftMin,delete re.grid.leftMax,delete re.grid.leftLogBase,delete re.grid.rightMin,delete re.grid.rightMax,delete re.grid.rightLogBase,delete re.y_formats,delete re.leftYAxisLabel,delete re.rightYAxisLabel,delete re["y-axis"],delete re["x-axis"]),re)),ce<13&&ye.push(re=>{if(re.type!=="graph"||!re.grid)return re;re.thresholds||(re.thresholds=[]);const ue={},De={};return re.grid.threshold1!==null&&(ue.value=re.grid.threshold1,re.grid.thresholdLine?(ue.line=!0,ue.lineColor=re.grid.threshold1Color,ue.colorMode="custom"):(ue.fill=!0,ue.fillColor=re.grid.threshold1Color,ue.colorMode="custom")),re.grid.threshold2!==null&&(De.value=re.grid.threshold2,re.grid.thresholdLine?(De.line=!0,De.lineColor=re.grid.threshold2Color,De.colorMode="custom"):(De.fill=!0,De.fillColor=re.grid.threshold2Color,De.colorMode="custom")),(0,t.isNumber)(ue.value)&&((0,t.isNumber)(De.value)?ue.value>De.value?(ue.op=De.op="lt",re.thresholds.push(ue),re.thresholds.push(De)):(ue.op=De.op="gt",re.thresholds.push(ue),re.thresholds.push(De)):(ue.op="gt",re.thresholds.push(ue))),delete re.grid.threshold1,delete re.grid.threshold1Color,delete re.grid.threshold2,delete re.grid.threshold2Color,delete re.grid.thresholdLine,re}),ce<14&&(this.dashboard.graphTooltip=ee.sharedCrosshair?1:0),ce<16&&this.upgradeToGridLayout(ee),ce<17&&ye.push(re=>{if(re.minSpan){const ue=D.cV/re.minSpan,De=E(D.cV);re.maxPerRow=De[(0,t.findIndex)(De,ge=>ge>ue)-1]}return delete re.minSpan,re}),ce<18&&ye.push(re=>(re["options-gauge"]&&(re.options=re["options-gauge"],re.options.valueOptions={unit:re.options.unit,stat:re.options.stat,decimals:re.options.decimals,prefix:re.options.prefix,suffix:re.options.suffix},re.options.thresholds&&re.options.thresholds.reverse(),delete re.options.options,delete re.options.unit,delete re.options.stat,delete re.options.decimals,delete re.options.prefix,delete re.options.suffix,delete re["options-gauge"]),re)),ce<19&&ye.push(re=>(re.links&&(0,t.isArray)(re.links)&&(re.links=re.links.map(V)),re)),ce<20){const re=ue=>({...ue,url:H(ue.url)});ye.push(ue=>(ue.options&&ue.options.dataLinks&&(0,t.isArray)(ue.options.dataLinks)&&(ue.options.dataLinks=ue.options.dataLinks.map(re)),ue.options&&ue.options.fieldOptions&&ue.options.fieldOptions.defaults&&(ue.options.fieldOptions.defaults.links&&(0,t.isArray)(ue.options.fieldOptions.defaults.links)&&(ue.options.fieldOptions.defaults.links=ue.options.fieldOptions.defaults.links.map(re)),ue.options.fieldOptions.defaults.title&&(ue.options.fieldOptions.defaults.title=H(ue.options.fieldOptions.defaults.title))),ue))}if(ce<21){const re=ue=>({...ue,url:ue.url.replace(/__series.labels/g,"__field.labels")});ye.push(ue=>(ue.options&&ue.options.dataLinks&&(0,t.isArray)(ue.options.dataLinks)&&(ue.options.dataLinks=ue.options.dataLinks.map(re)),ue.options&&ue.options.fieldOptions&&ue.options.fieldOptions.defaults&&ue.options.fieldOptions.defaults.links&&(0,t.isArray)(ue.options.fieldOptions.defaults.links)&&(ue.options.fieldOptions.defaults.links=ue.options.fieldOptions.defaults.links.map(re)),ue))}if(ce<22&&ye.push(re=>(re.type!=="table"||(0,t.each)(re.styles,ue=>{ue.align="auto"}),re)),ce<23)for(const re of this.dashboard.templating.list){if(!(0,b.iv)(re))continue;const{multi:ue,current:De}=re;(0,i.R)(De)||(re.current=(0,M.C)(De,ue))}if(ce<24&&ye.push(re=>{const ue=re.type==="table";if(ue&&!re.styles)return re;const De=re.table==="table2";return!ue||De||(re.type=ue?"table-old":"table"),re}),ce<25,ce<26&&ye.push(re=>(re.type==="text2"&&(re.type="text",delete re.options.angular),re)),ce<27&&(this.removeRepeatedPanels(),this.dashboard.templating.list=this.dashboard.templating.list.map(re=>{if(!(0,b.VO)(re))return re;const ue={...re};return ue.current={selected:!0,text:ue.query??"",value:ue.query??""},ue.options=[ue.current],ue.hide===s.zL.dontHide||ue.hide===s.zL.hideLabel?{...ue,type:"textbox"}:ue})),ce<28){ye.push(re=>re.type==="singlestat"?Y(re):re);for(const re of this.dashboard.templating.list)re.tags&&delete re.tags,re.tagsQuery&&delete re.tagsQuery,re.tagValuesQuery&&delete re.tagValuesQuery,re.useTags&&delete re.useTags}if(ce<29)for(const re of this.dashboard.templating.list)re.type==="query"&&(re.refresh!==1&&re.refresh!==2&&(re.refresh=1),re.options?.length&&(re.options=[]));if(ce<30&&(ye.push(q),ye.push(ne)),ce<31&&ye.push(re=>{if(re.transformations){for(const ue of re.transformations)if(ue.id===d.V.id)return J(re,d.V.id,{id:p.o.id,options:{}})}return re}),ce<32,ce<33&&ye.push(re=>{if(re.datasource=X(re.datasource,{returnDefaultAsNull:!0}),!re.targets)return re;for(const ue of re.targets){const De=X(ue.datasource,{returnDefaultAsNull:!0});De!=null&&(ue.datasource=De)}return re}),ce<34&&(ye.push(re=>(this.migrateCloudWatchQueries(re),re)),this.migrateCloudWatchAnnotationQuery()),ce<35&&ye.push(le),ce<36){for(const ue of this.dashboard.annotations.list)ue.datasource=X(ue.datasource,{returnDefaultAsNull:!1});const re=(0,m.l)().getInstanceSettings(null);if(re){for(const ue of this.dashboard.templating.list)ue.type==="query"&&ue.datasource===null&&(ue.datasource=(0,r.p$)(re));ye.push(ue=>{if(ue.targets){let De=!1;ue.datasource==null&&ue.targets.length>0&&(ue.datasource=(0,r.p$)(re),De=!0);for(const ge of ue.targets)(ge.datasource==null||ge.datasource.uid==null)&&(ue.datasource?.uid!==O.uv?ge.datasource={...ue.datasource}:ge.datasource=X(ge.datasource,{returnDefaultAsNull:!1})),De&&ge.datasource?.uid!=="__expr__"&&(ue.datasource=ge.datasource)}return ue})}}if(ce<37&&ye.push(re=>(re.options?.legend&&(re.options.legend.displayMode==="hidden"||re.options.legend.showLegend===!1)?(re.options.legend.displayMode="list",re.options.legend.showLegend=!1):re.options?.legend&&(re.options.legend={...re.options?.legend,showLegend:!0}),re)),ce<38&&ye.push(re=>{if(re.type==="table"&&re.fieldConfig!==void 0){const ue=re.fieldConfig.defaults?.custom?.displayMode;if(ue!==void 0&&(re.fieldConfig.defaults.custom.cellOptions=(0,l.o7)(ue),delete re.fieldConfig.defaults.custom.displayMode),re.fieldConfig?.overrides)for(const De of re.fieldConfig.overrides)for(let ge=0;ge<De.properties?.length;ge++){let Te=De.properties[ge].value;De.properties[ge].id==="custom.displayMode"&&(De.properties[ge].id="custom.cellOptions",De.properties[ge].value=(0,l.o7)(Te))}}return re}),ce<39&&ye.push(re=>(re.transformations?.forEach(ue=>{if(ue.id==="timeSeriesTable"&&ue.options!==void 0&&ue.options.refIdToStat!==void 0){let De={};for(const[ge,Te]of Object.entries(ue.options.refIdToStat)){let Le={};Le.stat=Te,De[ge]=Le}ue.options=De}}),re)),ye.length!==0)for(ie=0;ie<this.dashboard.panels.length;ie++)for(Z=0;Z<ye.length;Z++){this.dashboard.panels[ie]=ye[Z].call(this,this.dashboard.panels[ie]);const re=this.dashboard.panels[ie].panels;if(re)for(oe=0;oe<re.length;oe++)re[oe]=ye[Z].call(this,re[oe])}}}removeRepeatedPanels(){const ee=[];for(const se of this.dashboard.panels)se.repeatPanelId||se.repeatByRow||(se.type==="row"&&Array.isArray(se.panels)&&(se.panels=se.panels.filter(ie=>!ie.repeatPanelId)),ee.push(se));this.dashboard.panels=ee}migrateCloudWatchQueries(ee){for(const se of ee.targets||[])if(ae(se)&&(N(se),se.hasOwnProperty("statistics"))){const ie=A(se,[...ee.targets]);for(const Z of ie)ee.targets.push(Z)}}migrateCloudWatchAnnotationQuery(){for(const ee of this.dashboard.annotations.list)if(j(ee)){const se=L(ee);for(const ie of se)this.dashboard.annotations.list.push(ie)}}upgradeToGridLayout(ee){let se=0;const ie=D.cV/12;let oe=(0,t.max)((0,t.flattenDeep)((0,t.map)(ee.rows,ye=>(0,t.map)(ye.panels,"id"))))+1;if(!ee.rows)return;const ce=(0,t.some)(ee.rows,ye=>ye.collapse||ye.showTitle||ye.repeat);for(const ye of ee.rows){if(ye.repeatIteration)continue;const re=ye.height||D.bJ,ue=U(re),De={};let ge;ce&&(De.id=oe,De.type="row",De.title=ye.title,De.collapsed=ye.collapse,De.repeat=ye.repeat,De.panels=[],De.gridPos={x:0,y:se,w:D.cV,h:ue},ge=new F.a9(De),oe++,se++);const Te=new K(ue,D.cV,se);for(const Le of ye.panels){Le.span=Le.span||D.o9,Le.minSpan&&(Le.minSpan=Math.min(D.cV,D.cV/12*Le.minSpan));const Ye=Math.floor(Le.span)*ie,je=Le.height?U(Le.height):ue,Ze=Te.getPanelPosition(je,Ye);se=Te.yPos,Le.gridPos={x:Ze.x,y:se+Ze.y,w:Ye,h:je},Te.addPanel(Le.gridPos),delete Le.span,ge&&De.collapsed?ge.panels?.push(Le):this.dashboard.panels.push(new F.a9(Le))}ge&&this.dashboard.panels.push(ge),ge&&De.collapsed||(se+=ue)}}}function U(z){return(0,t.isString)(z)&&(z=parseInt(z.replace("px",""),10)),z<D.cx&&(z=D.cx),Math.ceil(z/(D.sD+D.dU))}class K{constructor(ee,se=D.cV,ie=0){this.area=new Array(se).fill(0),this.yPos=ie,this.height=ee}reset(){this.area.fill(0)}addPanel(ee){for(let se=ee.x;se<ee.x+ee.w;se++)(!this.area[se]||ee.y+ee.h-this.yPos>this.area[se])&&(this.area[se]=ee.y+ee.h-this.yPos);return this.area}getPanelPosition(ee,se,ie=!1){let Z,oe,ce;for(let ye=this.area.length-1;ye>=0&&this.height-this.area[ye]>0;ye--)if(oe===void 0)oe=ye;else if(ye<this.area.length-1&&this.area[ye]<=this.area[ye+1])Z=ye;else break;if(Z!==void 0&&oe!==void 0&&oe-Z>=se-1){const ye=(0,t.max)(this.area.slice(Z));ce={x:Z,y:ye}}else return ie?null:(this.yPos+=this.height,this.reset(),this.getPanelPosition(ee,se,!0));return ce}}function V(z){let ee=z.url;return!ee&&z.dashboard&&(ee=`dashboard/db/${x.A.slugifyForUrl(z.dashboard)}`),!ee&&z.dashUri&&(ee=`dashboard/${z.dashUri}`),ee||(ee="/"),z.keepTime&&(ee=g.kM.appendQueryToUrl(ee,`$${a.c.keepTime}`)),z.includeVars&&(ee=g.kM.appendQueryToUrl(ee,`$${a.c.includeVars}`)),z.params&&(ee=g.kM.appendQueryToUrl(ee,z.params)),{url:ee,title:z.title,targetBlank:z.targetBlank}}function H(z){const ee=/(__series_name)|(\$__series_name)|(__value_time)|(__field_name)|(\$__field_name)/g;return z.replace(ee,(se,ie,Z,oe,ce,ye)=>ie?"__series.name":Z?"${__series.name}":oe?"__value.time":ce?"__field.name":ye?"${__field.name}":se)}function Y(z){if(u.config.panels["grafana-singlestat-panel"])return z.type="grafana-singlestat-panel",z;let ee=!1;return z.changePlugin||(ee=!0,z=new F.a9(z)),z.plugin={angularPanelCtrl:{}},z.gauge?.show?(I.plugin.meta=u.config.panels.gauge,z.changePlugin(I.plugin)):(T.plugin.meta=u.config.panels.stat,z.changePlugin(T.plugin)),ee?z.getSaveModel():z}function X(z,ee){if(ee.returnDefaultAsNull&&(z==null||z==="default"))return null;if((0,r.fN)(z))return z;const se=(0,m.l)().getInstanceSettings(z);return se?(0,r.p$)(se):{uid:z||void 0}}function J(z,ee,se){if(z.transformations){const ie=[];for(const Z of z.transformations)ie.push(Z),Z.id===ee&&ie.push({...se});z.transformations=ie}return z}function q(z){const ee=z.fieldConfig;if(!ee)return z;if(ee.defaults&&ee.defaults.mappings&&(ee.defaults.mappings=te(ee.defaults.mappings,ee.defaults.thresholds)),Array.isArray(ee.overrides))for(const se of ee.overrides)for(const ie of se.properties)ie.id==="mappings"&&(ie.value=te(ie.value));return z}function ae(z){return z.hasOwnProperty("dimensions")&&z.hasOwnProperty("namespace")&&z.hasOwnProperty("region")&&z.hasOwnProperty("metricName")}function j(z){return z.hasOwnProperty("dimensions")&&z.hasOwnProperty("namespace")&&z.hasOwnProperty("region")&&z.hasOwnProperty("prefixMatching")&&z.hasOwnProperty("statistics")}function te(z,ee){if(!z)return;const se={type:c.d.ValueToText,options:{}},ie=[];for(const Z of z){if(Z.type&&Z.options){Z.type===c.d.ValueToText?se.options={...se.options,...Z.options}:ie.push(Z);continue}let oe;const ce=parseFloat(Z.text);if(ee&&!isNaN(ce)){const ye=(0,o.yQ)(ce,ee.steps);ye&&ye.color&&(oe=ye.color)}switch(Z.type){case 1:Z.value!=null&&(Z.value==="null"?ie.push({type:c.d.SpecialValue,options:{match:c.W.Null,result:{text:Z.text,color:oe}}}):se.options[String(Z.value)]={text:Z.text,color:oe});break;case 2:ie.push({type:c.d.RangeToText,options:{from:+Z.from,to:+Z.to,result:{text:Z.text,color:oe}}});break}}return Object.keys(se.options).length>0&&ie.unshift(se),ie}function ne(z){return(z.type==="timeseries"||z.type==="xychart"||z.type==="xychart2")&&z.options.tooltipOptions&&(z.options={...z.options,tooltip:z.options.tooltipOptions},delete z.options.tooltipOptions),z}function le(z){return z.type==="timeseries"&&z.fieldConfig?.defaults.custom?.axisPlacement===v.vM.Hidden&&(z.fieldConfig={...z.fieldConfig,overrides:[...z.fieldConfig.overrides,{matcher:{id:h.Ct.byType,options:f.PU.time},properties:[{id:"custom.axisPlacement",value:v.vM.Auto}]}]}),z}},98365:(k,R,e)=>{"use strict";e.d(R,{G:()=>N});var t=e(2543),n=e(64423),i=e(18226),s=e(72724),r=e(47232),g=e(3591),a=e(32264),c=e(24284),o=e(15054),h=e(16233),f=e(28874),d=e(8480),p=e(20601),m=e(72401),v=e(87421),l=e(31678),y=e(28444),u=e(10096),D=e(99140),E=e(80484),x=e(75096),P=e(74856),b=e(34214);const M=new Set(["gridPos","title","description","transparent"]);function O(B,U){const K=[],V={changed:!1,actions:{add:[],remove:[],replace:[],update:[],noop:[]},panels:K};let H=0;const Y=new Map;for(let X of U){let{id:J}=X;J||(H||(H=T([B,U])),J=H++,X={...X,id:J}),Y.set(J,X)}for(const X of B){const J=Y.get(X.id);if(!J){V.changed=!0,V.actions.remove.push(X.id),X.destroy();continue}if(Y.delete(X.id),J===X){K.push(X),V.actions.noop.push(X.id);continue}if(X.type===J.type){const ae=X.getSaveModel();let j=!0,te=!1;for(const[ne,le]of Object.entries(J))if(!(0,t.isEqualWith)(le,ae[ne],I))if(V.changed=!0,j=!1,M.has(ne))X[ne]=le,te=!0;else{te=!1;break}if(j){K.push(X),V.actions.noop.push(X.id);continue}if(te){K.push(X),V.actions.update.push(X.id);continue}}X.destroy();const q=new b.a(J);q.key=`${q.id}-update-${Date.now()}`,K.push(q),V.changed=!0,V.actions.replace.push(X.id)}for(const X of Y.values())K.push(new b.a(X)),V.changed=!0,V.actions.add.push(X.id);return V}function I(B,U){if(B==null&&(U===1/0||U===-1/0||U==null)||U==null&&(B===1/0||B===-1/0||B==null))return!0}function T(B){let U=0;for(const K of B)for(const V of K)V.id>U&&(U=V.id);return U+1}var C=e(79056),S=e(84423);function A(B,U){return B.repeatDirection===o.HG?!1:U.gridPos.x>=B.gridPos.x+B.gridPos.w&&U.gridPos.y===B.gridPos.y}function L(B){for(const U of B)if(delete U.scopedVars,U.panels?.length)for(const K of U.panels)delete K.scopedVars}class N{constructor(U,K,V){this.timeRangeUpdatedDuringEditOrView=!1,this.originalDashboard=null,this.getVariablesFromState=V?.getVariablesFromState??v.SS,this.events=new i.o,this.id=U.id||null,this.uid=U.uid||null,this.revision=U.revision??void 0,this.title=U.title??"No Title",this.description=U.description,this.tags=U.tags??[],this.timezone=U.timezone??"",this.weekStart=U.weekStart??"",this.editable=U.editable!==!1,this.graphTooltip=U.graphTooltip||0,this.time=U.time??{from:"now-6h",to:"now"},this.timepicker=U.timepicker??{},this.liveNow=U.liveNow,this.templating=this.removeNullValuesFromVariables(this.ensureListExist(U.templating)),this.annotations=this.ensureListExist(U.annotations),this.refresh=U.refresh,this.snapshot=U.snapshot,this.schemaVersion=U.schemaVersion??0,this.fiscalYearStartMonth=U.fiscalYearStartMonth??0,this.version=U.version??0,this.links=U.links??[],this.gnetId=U.gnetId||null,this.panels=(0,t.map)(U.panels??[],H=>new S.a9(H)),this.originalDashboard=(0,t.cloneDeep)(U),this.originalTemplating=(0,t.cloneDeep)(this.templating),this.originalTime=(0,t.cloneDeep)(this.time),this.ensurePanelsHaveUniqueIds(),this.formatDate=this.formatDate.bind(this),this.initMeta(K),this.updateSchema(U),this.addBuiltInAnnotationQuery(),this.sortPanelsByGridPos(),this.panelsAffectedByVariableChange=null,this.appEventsSubscription=new n.yU,this.lastRefresh=Date.now(),this.appEventsSubscription.add(u.lE.subscribe(E.og,this.variablesChangedHandler.bind(this))),this.appEventsSubscription.add(u.lE.subscribe(E.BS,this.variablesTimeRangeProcessDoneHandler.bind(this))),this.appEventsSubscription.add(u.lE.subscribe(E.eF,this.variablesChangedInUrlHandler.bind(this)))}static{this.nonPersistedProperties={events:!0,meta:!0,panels:!0,templating:!0,originalTime:!0,originalTemplating:!0,originalLibraryPanels:!0,panelInEdit:!0,panelInView:!0,getVariablesFromState:!0,formatDate:!0,appEventsSubscription:!0,panelsAffectedByVariableChange:!0,lastRefresh:!0,timeRangeUpdatedDuringEditOrView:!0,originalDashboard:!0}}addBuiltInAnnotationQuery(){this.annotations.list.some(K=>K.builtIn===1)||this.annotations.list.unshift({datasource:{uid:"-- Grafana --",type:"grafana"},name:"Annotations & Alerts",type:"dashboard",iconColor:c.Mk,enable:!0,hide:!0,builtIn:1})}initMeta(U){U=U||{},U.canShare=U.canShare!==!1,U.canSave=U.canSave!==!1,U.canStar=U.canStar!==!1,U.canEdit=U.canEdit!==!1,U.canDelete=U.canDelete!==!1,U.showSettings=U.canEdit,U.canMakeEditable=U.canSave&&!this.editable,U.hasUnsavedFolderChange=!1,this.editable||(U.canEdit=!1,U.canDelete=!1,U.canSave=!1),this.meta=U}getSaveModelCloneOld(U){const K=(0,t.defaults)(U||{},{saveVariables:!0,saveTimerange:!0});let V={};for(const H in this)N.nonPersistedProperties[H]||!this.hasOwnProperty(H)||(V[H]=(0,t.cloneDeep)(this[H]));return V.templating=this.getTemplatingSaveModel(K),K.saveTimerange||(V.time=this.originalTime),V.panels=this.getPanelSaveModels(),V=(0,f.v)(V),V.getVariables=()=>V.templating.list,V}getSaveModelClone(U){const K=this.getSaveModelCloneOld(U),V=JSON.stringify(K);return JSON.parse(V)}updatePanels(U){const K=O(this.panels,U??[]);return K.changed&&(this.panels=K.panels??[],this.sortPanelsByGridPos(),this.events.publish(new y.Q$)),K}getPanelSaveModels(){return this.panels.filter(U=>this.isSnapshotTruthy()||!(U.repeatPanelId||U.repeatedByRow)).map(U=>{if(U.libraryPanel){const{id:K,title:V,libraryPanel:H,gridPos:Y}=U;return{id:K,title:V,gridPos:Y,libraryPanel:{uid:H.uid,name:H.name}}}return this.panelInEdit&&this.panelInEdit.id===U.id?this.panelInEdit.getSaveModel():U.getSaveModel()}).map(U=>(this.isSnapshotTruthy()||(delete U.scopedVars,U.type==="row"&&U.panels&&U.panels.length>0&&(U.panels=U.panels.filter(K=>!K.repeatPanelId).map(K=>(delete K.scopedVars,K)))),U))}getTemplatingSaveModel(U){const K=this.originalTemplating?.list??[],H=this.getVariablesFromState(this.uid).map(X=>{const J=p.B.get(X.type).getSaveModel(X,U.saveVariables);if(!U.saveVariables){const q=K.find(({name:ae,type:j})=>ae===X.name&&j===X.type);if(!q)return J;X.type==="adhoc"?J.filters=q.filters:(J.current=q.current,J.options=q.options)}return J});return{list:(0,f.v)(H)}}timeRangeUpdated(U){this.events.publish(new g.sR(U)),(0,D.JD)((0,m.RK)(this.uid,U)),(this.panelInEdit||this.panelInView)&&(this.timeRangeUpdatedDuringEditOrView=!0)}startRefresh(U={refreshAll:!0,panelIds:[]}){if(this.events.publish(new g._),this.lastRefresh=Date.now(),this.panelInEdit&&(U.refreshAll||U.panelIds.includes(this.panelInEdit.id))){this.panelInEdit.refresh();return}const K=this.panels.filter(V=>!this.otherPanelInFullscreen(V)&&(U.refreshAll||U.panelIds.includes(V.id)));if(!this.isSnapshot())for(const V of K)V.refreshWhenInView=!0;for(const V of K)V.refresh()}render(){this.events.publish(new y.XM);for(const U of this.panels)U.render()}panelInitialized(U){const K=U.getQueryRunner().getLastResult();!this.otherPanelInFullscreen(U)&&!K&&U.refresh()}otherPanelInFullscreen(U){return(this.panelInEdit||this.panelInView)&&!(U.isViewing||U.isEditing)}initEditPanel(U){return(0,P.jG)().stopAutoRefresh(),this.panelInEdit=U.getEditClone(),this.timeRangeUpdatedDuringEditOrView=!1,this.panelInEdit}exitPanelEditor(){this.panelInEdit.destroy(),this.panelInEdit=void 0,(0,P.jG)().resumeAutoRefresh(),this.refreshIfPanelsAffectedByVariableChangeOrTimeRangeChanged()}initViewPanel(U){this.panelInView=U,this.timeRangeUpdatedDuringEditOrView=!1,U.setIsViewing(!0)}exitViewPanel(U){this.panelInView=void 0,U.setIsViewing(!1),this.refreshIfPanelsAffectedByVariableChangeOrTimeRangeChanged()}refreshIfPanelsAffectedByVariableChangeOrTimeRangeChanged(){(this.panelsAffectedByVariableChange||this.timeRangeUpdatedDuringEditOrView)&&(this.startRefresh({panelIds:this.panelsAffectedByVariableChange??[],refreshAll:this.timeRangeUpdatedDuringEditOrView}),this.panelsAffectedByVariableChange=null,this.timeRangeUpdatedDuringEditOrView=!1)}ensurePanelsHaveUniqueIds(){const U=new Set;let K=this.getNextPanelId();for(const V of this.panelIterator())(!V.id||U.has(V.id))&&(V.id=K++),U.add(V.id)}removeNullValuesFromVariables(U){if(!U.list.length)return U;for(const K of U.list)K.current&&(K.current.value===null||Array.isArray(K.current.value)&&K.current.value.includes(null))&&(K.current=void 0);return U}ensureListExist(U={}){return U.list??=[],U}getNextPanelId(){let U=0;for(const K of this.panelIterator())K.id>U&&(U=K.id);return U+1}*panelIterator(){for(const U of this.panels){yield U;const K=U.panels??[];for(const V of K)yield V}}forEachPanel(U){for(let K=0;K<this.panels.length;K++)U(this.panels[K],K)}getPanelById(U,K=!1){if(this.panelInEdit&&this.panelInEdit.id===U)return this.panelInEdit;if(K){for(const V of this.panelIterator())if(V.id===U)return V;return null}else return this.panels.find(V=>V.id===U)??null}canEditPanel(U){return!!(this.meta.canEdit&&U&&!U.repeatPanelId&&U.type!=="row")}canEditPanelById(U){return this.canEditPanel(this.getPanelById(U))}addPanel(U){U.id=this.getNextPanelId(),this.panels.unshift(new S.a9(U)),this.sortPanelsByGridPos(),this.events.publish(new y.Q$)}updateMeta(U){this.meta={...this.meta,...U},this.events.publish(new y.Cf)}makeEditable(){this.editable=!0,this.updateMeta({canMakeEditable:!1,canEdit:!0,canSave:!0})}sortPanelsByGridPos(){this.panels.sort((U,K)=>U.gridPos.y===K.gridPos.y?U.gridPos.x-K.gridPos.x:U.gridPos.y-K.gridPos.y)}clearUnsavedChanges(U,K){for(const V of this.panels)V.configRev=0;this.panelInEdit&&(this.panelInEdit.hasSavedPanelEditChange=this.panelInEdit.configRev>0,this.panelInEdit.configRev=0),this.originalDashboard=U,this.originalTemplating=U.templating,K.saveTimerange&&(this.originalTime=U.time)}hasUnsavedChanges(){return!!this.panels.find(K=>K.hasChanged)}cleanUpRepeats(){if(this.isSnapshotTruthy()||!this.hasVariables())return;L(this.panels);const U=this.panels.filter(K=>(!K.repeat||K.repeatedByRow)&&K.repeatPanelId);(0,t.pull)(this.panels,...U),U.map(K=>K.destroy()),this.sortPanelsByGridPos()}processRepeats(){if(!(this.isSnapshotTruthy()||!this.hasVariables()||this.panelInView)){this.cleanUpRepeats();for(let U=0;U<this.panels.length;U++){const K=this.panels[U];K.repeat&&this.repeatPanel(K,U)}this.sortPanelsByGridPos(),this.events.publish(new y.Q$)}}cleanUpRowRepeats(U){const K=U.map(H=>H.id),V=U.filter(H=>!H.repeat&&H.repeatPanelId&&K.includes(H.repeatPanelId));(0,t.pull)(U,...V),(0,t.pull)(this.panels,...V)}processRowRepeats(U){if(this.isSnapshotTruthy()||!this.hasVariables())return;let K=U.panels??[];if(!U.collapsed){const V=this.panels.findIndex(H=>H.id===U.id);K=this.getRowPanels(V)}this.cleanUpRowRepeats(K);for(const V of K)if(V.repeat){const H=this.panels.findIndex(Y=>Y.id===V.id);this.repeatPanel(V,H)}}getPanelRepeatClone(U,K,V){if(K===0)return U;const H=U.getSaveModel();H.id=this.getNextPanelId();const Y=new S.a9(H);return this.panels.splice(V+K,0,Y),Y.repeatPanelId=U.id,Y.repeat=void 0,this.panelInView?.id===Y.id&&(Y.setIsViewing(!0),this.panelInView=Y),Y}getRowRepeatClone(U,K,V){if(K===0){if(!U.collapsed){const J=this.getRowPanels(V);U.panels=J}return U}const H=new S.a9(U.getSaveModel());let Y,X;return U.collapsed?(Y=(0,t.cloneDeep)(U.panels)??[],H.panels=Y,X=V+K):(Y=this.getRowPanels(V),H.panels=Y.map(J=>J.getSaveModel()),X=V+(Y.length+1)*K),this.panels.splice(X,0,H),this.updateRepeatedPanelIds(H),H}repeatPanel(U,K){const V=this.getPanelRepeatVariable(U);if(!V)return;if(U.type==="row"){this.repeatRow(U,K,V);return}const H=this.getSelectedVariableOptions(V),Y=U.maxPerRow||4;let X=0,J=U.gridPos.y;for(let ae=0;ae<H.length;ae++){const j=H[ae];let te;te=this.getPanelRepeatClone(U,ae,K),te.scopedVars??={},te.scopedVars[V.name]=j,U.repeatDirection===o.Pz?(ae>0&&(J+=te.gridPos.h),te.gridPos.y=J):(te.gridPos.w=Math.max(o.cV/H.length,o.cV/Y),te.gridPos.x=X,te.gridPos.y=J,X+=te.gridPos.w,X+te.gridPos.w>o.cV&&(X=0,J+=te.gridPos.h))}const q=J-U.gridPos.y;if(q>0){const ae=K+H.length;for(const j of this.panels.slice(ae))A(U,j)||(j.gridPos.y+=q)}}repeatRow(U,K,V){const H=this.getSelectedVariableOptions(V);for(let Y=0;Y<H.length;Y++){const X=H[Y],J=this.getRowRepeatClone(U,Y,K);w(J,V,X);const q=this.getRowHeight(J),ae=J.panels||[];let j;if(U.collapsed){for(const te of ae)w(te,V,X),Y>0&&this.updateRepeatedPanelIds(te,!0);J.gridPos.y+=Y,j=K+Y+1}else{const te=K+(ae.length+1)*Y+1;ae.forEach((ne,le)=>{if(w(ne,V,X),Y>0){const z=new S.a9(ne);this.updateRepeatedPanelIds(z,!0),z.gridPos.y+=q*Y,this.panels.splice(te+le,0,z)}}),J.panels=[],J.gridPos.y+=q*Y,j=te+ae.length}if(H.length>1)for(const te of this.panels.slice(j))te.gridPos.y+=q}}updateRepeatedPanelIds(U,K){return U.repeatPanelId=U.id,U.id=this.getNextPanelId(),K?U.repeatedByRow=!0:U.repeat=void 0,U}getSelectedVariableOptions(U){let K;return(0,x.ML)(U)?K=U.options.slice(1,U.options.length):K=(0,t.filter)(U.options,{selected:!0}),K}getRowHeight(U){if(!U.panels||U.panels.length===0)return 0;if(U.collapsed)return 1;const K=(0,t.maxBy)(U.panels,({gridPos:V})=>V.y+V.h).gridPos;return K.y+K.h-U.gridPos.y}removePanel(U){this.panels=this.panels.filter(K=>K!==U),U.destroy(),this.events.publish(new y.Q$)}removeRow(U,K){(!K&&U.collapsed||K&&!U.collapsed)&&this.toggleRow(U),this.removePanel(U)}expandRows(){const U=this.panels.filter(K=>K.type==="row"&&K.collapsed);for(const K of U)this.toggleRow(K)}collapseRows(){const U=this.panels.filter(K=>K.type==="row"&&!K.collapsed);for(const K of U)this.toggleRow(K)}isSubMenuVisible(){return this.links.length>0||this.getVariables().some(U=>U.hide!==2)||this.annotations.list.some(U=>!U.hide)}getPanelInfoById(U){const K=this.panels.findIndex(V=>V.id===U);return K>=0?{panel:this.panels[K],index:K}:null}duplicatePanel(U){const K=U.getSaveModel();return K.id=this.getNextPanelId(),delete K.repeat,delete K.repeatIteration,delete K.repeatPanelId,delete K.scopedVars,K.alert&&delete K.thresholds,delete K.alert,U.gridPos.x+U.gridPos.w*2<=o.cV?K.gridPos.x+=U.gridPos.w:K.gridPos.y+=U.gridPos.h,this.addPanel(K),K}formatDate(U,K){return(0,s.LE)(U,{format:K,timeZone:this.getTimezone()})}destroy(){this.appEventsSubscription.unsubscribe(),this.events.removeAllListeners();for(const U of this.panels)U.destroy()}toggleRow(U){const K=(0,t.indexOf)(this.panels,U);if(!U.collapsed){const X=this.getRowPanels(K);(0,t.pull)(this.panels,...X),U.panels=X.map(J=>J.getSaveModel()),U.collapsed=!0,X.some(J=>J.hasChanged)&&U.configRev++,this.events.publish(new y.Q$);return}U.collapsed=!1;const V=U.panels??[],H=V.some(X=>X.repeat),Y=U.repeat;if(V.length>0){const J=(V[0].gridPos.y??U.gridPos.y)-(U.gridPos.y+U.gridPos.h);let q=K+1,ae=U.gridPos.y;for(const te of V){if(Y){const ne=this.getPanelRepeatVariable(U);if(te.scopedVars??={},ne){const le=this.getSelectedVariableOptions(ne);te.scopedVars={...te.scopedVars,[ne.name]:le[0]}}}te.gridPos.y??(te.gridPos.y=U.gridPos.y),te.gridPos.y-=J,this.panels.splice(q,0,new S.a9(te)),q+=1,ae=Math.max(ae,te.gridPos.y+te.gridPos.h)}const j=ae-U.gridPos.y-1;for(const te of this.panels.slice(q))te.gridPos.y+=j;U.panels=[],H&&this.processRowRepeats(U)}this.sortPanelsByGridPos(),this.events.publish(new y.Q$)}getRowPanels(U){const K=this.panels.slice(U+1),V=K.findIndex(Y=>Y.type==="row");return K.slice(0,V>=0?V:this.panels.length)}on(U,K){console.log("DashboardModel.on is deprecated use events.subscribe"),this.events.on(U,K)}off(U,K){console.log("DashboardModel.off is deprecated"),this.events.off(U,K)}cycleGraphTooltip(){this.graphTooltip=(this.graphTooltip+1)%3}sharedTooltipModeEnabled(){return this.graphTooltip>0}sharedCrosshairModeOnly(){return this.graphTooltip===1}getRelativeTime(U){return(0,s.fq)(U,{timeZone:this.getTimezone()})}isSnapshot(){return this.snapshot!==void 0}getTimezone(){return this.timezone?this.timezone:h.TP?.user?.timezone}updateSchema(U){new C.SW(this).updateSchema(U)}hasTimeChanged(){const{time:U,originalTime:K}=this;return!((0,t.isEqual)(U,K)||(0,t.isEqual)((0,r.KQ)(U?.from),(0,r.KQ)(K?.from))&&(0,t.isEqual)((0,r.KQ)(U?.to),(0,r.KQ)(K?.to)))}autoFitPanels(U,K){const V=Math.max(...this.panels.map(ae=>ae.gridPos.h+ae.gridPos.y)),H=55;let X=U-H-20;K&&K!==l.KioskMode.TV&&(X+=H);const J=Math.floor(X/(o.sD+o.dU)),q=V/J;for(const ae of this.panels)ae.gridPos.y=Math.round(ae.gridPos.y/q)||1,ae.gridPos.h=Math.round(ae.gridPos.h/q)||1}templateVariableValueUpdated(){this.processRepeats(),this.events.emit(l.CoreEvents.bG)}getPanelByUrlId(U){const K=parseInt(U??"0",10),V=this.panels.filter(H=>H.collapsed);for(const H of V)H.panels?.some(X=>X.id===K)&&this.toggleRow(H);return this.getPanelById(K)}toggleLegendsForAll(){const U=this.panels.filter(F),K=U.filter(Y=>Y.legend.show).length,V=U.length-K,H=K>=V;for(const Y of U)Y.legend.show=!H,Y.render()}toggleExemplarsForAll(){for(const U of this.panels)for(const K of U.targets){if(!(K.datasource&&K.datasource.type==="prometheus"))continue;const V=K;V.exemplar=!V.exemplar}this.startRefresh()}getVariables(){return this.getVariablesFromState(this.uid)}canEditAnnotations(U){let K=!0;return U?K=!!this.meta.annotationsPermissions?.dashboard.canEdit:K=!!this.meta.annotationsPermissions?.organization.canEdit,(a.$.featureToggles.annotationPermissionUpdate||this.canEditDashboard())&&K}canDeleteAnnotations(U){let K=!0;return U?K=!!this.meta.annotationsPermissions?.dashboard.canDelete:K=!!this.meta.annotationsPermissions?.organization.canDelete,a.$.featureToggles.annotationPermissionUpdate?K:K&&this.canEditDashboard()}canAddAnnotations(){return this.annotations.list.find(K=>K.builtIn===1)?.enable===!1?!1:a.$.featureToggles.annotationPermissionUpdate?!!this.meta.annotationsPermissions?.dashboard.canAdd:!!this.meta.annotationsPermissions?.dashboard.canAdd&&this.canEditDashboard()}canEditDashboard(){return!!(this.meta.canEdit||this.meta.canMakeEditable)}shouldUpdateDashboardPanelFromJSON(U,K){!(0,t.isEqual)(U?.gridPos,K?.gridPos)&&this.events.publish(new y.Q$)}getDefaultTime(){return this.originalTime}getPanelRepeatVariable(U){return this.getVariablesFromState(this.uid).find(K=>K.name===U.repeat)}isSnapshotTruthy(){return this.snapshot}hasVariables(){return this.getVariablesFromState(this.uid).length>0}hasVariablesChanged(){const U=this.originalTemplating?.list??[],K=this.getTemplatingSaveModel({saveVariables:!0}).list;return U.length!==K.length?!1:!(0,t.isEqual)(K,U)}variablesTimeRangeProcessDoneHandler(U){const K=U.payload.variableIds.length>0;this.variablesChangedHandler(new E.og({panelIds:[],refreshAll:!0}),K)}variablesChangedHandler(U,K=!0){if(K&&this.processRepeats(),U.payload.refreshAll||(0,P.jG)().isRefreshOutsideThreshold(this.lastRefresh)){this.startRefresh({refreshAll:!0,panelIds:[]});return}(this.panelInEdit||this.panelInView)&&(this.panelsAffectedByVariableChange=U.payload.panelIds.filter(V=>V!==(this.panelInEdit?.id??this.panelInView?.id))),this.startRefresh(U.payload)}variablesChangedInUrlHandler(U){this.templateVariableValueUpdated(),this.startRefresh(U.payload)}getOriginalDashboard(){return this.originalDashboard}hasAngularPlugins(){return this.panels.some(U=>{const K=(a.$.panels[U.type]?.angular?.detected||S.vI.includes(U.type))&&!a.$.panels[U.type]?.angular?.hideDeprecation;let V=!1;return U.datasource?.uid&&(V=(0,d.Hv)(U.datasource?.uid)),K||V})}}function F(B){return!!B.legend}function w(B,U,K){B.scopedVars??={},B.scopedVars[U.name]=K}},84423:(k,R,e)=>{"use strict";e.d(R,{NB:()=>D,a9:()=>x,tD:()=>E,tw:()=>b,vI:()=>u});var t=e(2543),n=e.n(t),i=e(62938),s=e(18226),r=e(77789),g=e(41987),a=e(581),c=e(3591),o=e(72574),h=e(2913),f=e(87490),d=e(28444),p=e(80924),m=e(96382);const v={events:!0,isViewing:!0,isEditing:!0,isInView:!0,hasRefreshed:!0,cachedPluginOptions:!0,plugin:!0,queryRunner:!0,replaceVariables:!0,configRev:!0,hasSavedPanelEditChange:!0,getDisplayTitle:!0,dataSupport:!0,key:!0,isNew:!0,refreshWhenInView:!0},l={id:!0,gridPos:!0,type:!0,title:!0,scopedVars:!0,repeat:!0,repeatPanelId:!0,repeatDirection:!0,repeatedByRow:!0,minSpan:!0,collapsed:!0,panels:!0,targets:!0,datasource:!0,timeFrom:!0,timeShift:!0,hideTimeOverride:!0,description:!0,links:!0,fullscreen:!0,isEditing:!0,isViewing:!0,hasRefreshed:!0,events:!0,cacheTimeout:!0,queryCachingTTL:!0,cachedPluginOptions:!0,transparent:!0,pluginVersion:!0,queryRunner:!0,transformations:!0,fieldConfig:!0,maxDataPoints:!0,interval:!0,replaceVariables:!0,libraryPanel:!0,getDisplayTitle:!0,configRev:!0,key:!0},y={gridPos:{x:0,y:0,h:3,w:6},targets:[{refId:"A"}],cachedPluginOptions:{},transparent:!1,options:{},links:[],transformations:[],fieldConfig:{defaults:{},overrides:[]},title:""},u=["graph","table-old","grafana-piechart-panel","grafana-worldmap-panel","singlestat","grafana-singlestat-panel"],D={graph:"timeseries","table-old":"table",singlestat:"stat","grafana-singlestat-panel":"stat","grafana-piechart-panel":"piechart","grafana-worldmap-panel":"geomap"},E={"heatmap-new":"heatmap"};class x{constructor(O){this.datasource=null,this.isViewing=!1,this.isEditing=!1,this.isInView=!1,this.configRev=0,this.refreshWhenInView=!0,this.cachedPluginOptions={},this.events=new s.o,this.restoreModel(O),this.replaceVariables=this.replaceVariables.bind(this),this.key=(0,i.A)()}restoreModel(O){for(const T in this)v[T]||!this.hasOwnProperty(T)||O[T]||typeof this[T]!="function"&&typeof this[T]!="symbol"&&delete this[T];for(const T in O)this[T]=O[T];const I=(0,m.p)(this);I&&(this.autoMigrateFrom=this.type,this.type=I),(0,t.defaultsDeep)(this,(0,t.cloneDeep)(y)),this.ensureQueryIds()}generateNewKey(){this.key=(0,i.A)()}ensureQueryIds(){if(this.targets&&(0,t.isArray)(this.targets))for(const O of this.targets)O.refId||(O.refId=(0,r.M)(this.targets))}getOptions(){return this.options}get hasChanged(){return this.configRev>0}updateOptions(O){this.options=O,this.configRev++,this.events.publish(new d.PR),this.render()}updateFieldConfig(O){this.fieldConfig=O,this.configRev++,this.events.publish(new d.PR),this.resendLastResult(),this.render()}getSaveModel(){const O={};for(const I in this)v[I]||!this.hasOwnProperty(I)||(0,t.isEqual)(this[I],y[I])||(O[I]=(0,t.cloneDeep)(this[I]));return this.type==="row"&&this.panels&&this.panels.length>0&&(O.panels=this.panels.map(I=>{if(I.libraryPanel){const{id:T,title:C,libraryPanel:S,gridPos:A}=I;return{id:T,title:C,gridPos:A,libraryPanel:{uid:S.uid,name:S.name}}}return I})),O}setIsViewing(O){this.isViewing=O}updateGridPos(O,I=!0){O.x===this.gridPos.x&&O.y===this.gridPos.y&&O.h===this.gridPos.h&&O.w===this.gridPos.w||(this.gridPos.x=O.x,this.gridPos.y=O.y,this.gridPos.w=O.w,this.gridPos.h=O.h,I&&this.configRev++,this.render())}runAllPanelQueries({dashboardUID:O,dashboardTimezone:I,timeData:T,width:C}){this.getQueryRunner().run({datasource:this.datasource,queries:this.targets,panelId:this.id,panelPluginId:this.type,dashboardUID:O,timezone:I,timeRange:T.timeRange,timeInfo:T.timeInfo,maxDataPoints:this.maxDataPoints||Math.floor(C),minInterval:this.interval,scopedVars:this.scopedVars,cacheTimeout:this.cacheTimeout,queryCachingTTL:this.queryCachingTTL,transformations:this.transformations,app:this.isEditing?g.Jk.PanelEditor:this.isViewing?g.Jk.PanelViewer:g.Jk.Dashboard})}refresh(){this.hasRefreshed=!0,this.events.publish(new c._)}render(){this.hasRefreshed?this.events.publish(new d.XM):this.refresh()}getOptionsToRemember(){return Object.keys(this).reduce((O,I)=>v[I]||l[I]?O:{...O,[I]:this[I]},{})}restorePanelOptions(O){const I=this.cachedPluginOptions[O];I&&(Object.keys(I.properties).map(T=>{this[T]=I.properties[T]}),this.fieldConfig=(0,a.H9)(this.fieldConfig,I.fieldConfig))}applyPluginOptionDefaults(O,I){const T=(0,a.F)({plugin:O,currentOptions:this.options,currentFieldConfig:this.fieldConfig,isAfterPluginChange:I});this.fieldConfig=T.fieldConfig,this.options=T.options}async pluginLoaded(O){this.plugin=O;const I=P(O);if(this.autoMigrateFrom){const T=D[this.autoMigrateFrom]!=null,C=this.getOptionsToRemember(),S=this.autoMigrateFrom,A=this.type;this.clearPropertiesBeforePluginChange(),this.type=A,this.plugin=O,this.callPanelTypeChangeHandler(O,S,C,T)}if(O.onPanelMigration&&I!==this.pluginVersion){const T=O.onPanelMigration(this);this.options=await T,this.pluginVersion=I}this.applyPluginOptionDefaults(O,!1),this.resendLastResult()}clearPropertiesBeforePluginChange(){for(const O in this)l[O]||delete this[O];this.options={},this.fieldConfig={defaults:{...this.fieldConfig.defaults,custom:{}},overrides:(0,a.aW)(this.fieldConfig.overrides,a.nx)}}callPanelTypeChangeHandler(O,I,T,C){if(O.onPanelTypeChanged){const S=C?{angular:T}:T.options;Object.assign(this.options,O.onPanelTypeChanged(this,I,S,this.fieldConfig))}}changePlugin(O){const I=O.meta.id,T=this.getOptionsToRemember(),C=this.fieldConfig,S=this.type,A=this.isAngularPlugin()||!!D[S];this.cachedPluginOptions[S]={properties:T,fieldConfig:C},this.clearPropertiesBeforePluginChange(),this.restorePanelOptions(I),this.callPanelTypeChangeHandler(O,S,T,A),this.type=I,this.plugin=O,this.configRev++,this.applyPluginOptionDefaults(O,!0),O.onPanelMigration&&(this.pluginVersion=P(O))}updateQueries(O){const{dataSource:I}=O;this.datasource=I,this.cacheTimeout=O.cacheTimeout,this.queryCachingTTL=O.queryCachingTTL,this.timeFrom=O.timeRange?.from,this.timeShift=O.timeRange?.shift,this.hideTimeOverride=O.timeRange?.hide,this.interval=O.minInterval,this.maxDataPoints=O.maxDataPoints,this.targets=O.queries,this.configRev++,this.events.publish(new d.zq)}addQuery(O){O=O||{refId:"A"},O.refId=(0,r.M)(this.targets),this.targets.push(O),this.configRev++}changeQuery(O,I){O.refId=this.targets[I].refId,this.configRev++,this.targets=this.targets.map((T,C)=>C===I?O:T)}getEditClone(){const O=this.getSaveModel(),I=new x(O);I.isEditing=!0,I.plugin=this.plugin;const T=this.getQueryRunner();return I.getQueryRunner().useLastResultFrom(T),I}getTransformations(){return this.transformations}getFieldOverrideOptions(){if(this.plugin)return{fieldConfig:this.fieldConfig,replaceVariables:this.replaceVariables,fieldConfigRegistry:this.plugin.fieldConfigRegistry,theme:h.Ay.theme2}}getDataSupport(){return this.plugin?.dataSupport??{annotations:!1,alertStates:!1}}getQueryRunner(){return this.queryRunner||(this.queryRunner=new p.Z(this)),this.queryRunner}hasTitle(){return this.title&&this.title.length>0}isAngularPlugin(){return(this.plugin&&this.plugin.angularPanelCtrl)!==void 0||(this.plugin?.meta?.angular?.detected??!1)}destroy(){this.events.removeAllListeners(),this.queryRunner&&this.queryRunner.destroy()}setTransformations(O){this.transformations=O,this.resendLastResult(),this.configRev++,this.events.publish(new d.JI)}setProperty(O,I){this[O]=I,this.configRev++,O==="repeat"&&(this.repeat&&!this.repeatDirection?this.repeatDirection="h":this.repeat||(delete this.repeatDirection,delete this.maxPerRow))}replaceVariables(O,I,T){const C=this.getQueryRunner().getLastRequest(),S=Object.assign({},this.scopedVars,C?.scopedVars,I);return(0,o.w)().replace(O,S,T)}resendLastResult(){this.plugin&&this.getQueryRunner().resendLastResult()}getDisplayTitle(){return this.replaceVariables(this.title,void 0,"text")}initLibraryPanel(O){for(const[I,T]of Object.entries(O.model)){switch(I){case"id":case"gridPos":case"libraryPanel":continue}this[I]=T}this.libraryPanel=O}unlinkLibraryPanel(){delete this.libraryPanel,this.configRev++,this.render()}}function P(M){return M&&M.meta.info.version?M.meta.info.version:h.Ay.buildInfo.version}function b(M){const O={};return Object.entries(M).filter(([I,T])=>!v[I]&&M.hasOwnProperty(I)&&!(0,t.isEqual)(T,y[I])).forEach(([I,T])=>{O[I]=T}),(0,f.MA)(O)}},3673:(k,R,e)=>{"use strict";e.d(R,{Bz:()=>v,Q9:()=>p,Ss:()=>y,TA:()=>m,lC:()=>l});var t=e(17172),n=e(82467),i=e(3169),s=e(28676),r=e(6473),g=e(80095),a=e(81862),c=e(20701),o=e(72401),h=e(14792),f=e(74856),d=e(28601);function p(u,D){return async E=>{await(0,t.AI)().post("/api/dashboards/import",u),E((0,n.dx)((0,i.tZ)("Dashboard Imported",D))),E((0,c.h9)())}}function m(u){return async D=>{await(0,s.n)().deleteDashboard(u,!1),D((0,c.h9)())}}const v=()=>(u,D)=>{const x=D().dashboard.getModel();x&&(x.destroy(),u((0,o.Y7)(x.uid))),(0,f.jG)().stopAutoRefresh(),u((0,d.p0)()),u((0,g.rG)()),r.t.leave(),(0,h.UA)().setCurrent(void 0)},l=u=>D=>{D((0,a.Cj)(u)),(0,f.jG)().refreshTimeModel()},y=u=>D=>{D((0,a.xu)(u)),(0,f.jG)().refreshTimeModel()}},41176:(k,R,e)=>{"use strict";e.d(R,{B:()=>i});var t=e(61298),n=e(14110);function i(s){const r={dashboardId:s.id,dashboardName:s.title,dashboardUid:s.uid,folderName:s.meta.folderTitle,eventName:t.n_.DashboardView};(0,n.G$)(r)}},96382:(k,R,e)=>{"use strict";e.d(R,{p:()=>i});var t=e(2913),n=e(84423);function i(s,r){if(n.tD[s.type])return n.tD[s.type];const g=c=>{const o="__feature."+c,f=new URLSearchParams(window.location.search).get(o);return f==="true"||f===""},a=r||!t.Ay.angularSupportEnabled||t.Ay.featureToggles.autoMigrateOldPanels||g("autoMigrateOldPanels")||g("disableAngular");if(s.type==="graph"&&(a||t.Ay.featureToggles.autoMigrateGraphPanel||g("autoMigrateGraphPanel")))return s.xaxis?.mode==="series"?"barchart":s.xaxis?.mode==="histogram"?"histogram":"timeseries";if(a)return n.NB[s.type];if(s.type==="table-old"&&(t.Ay.featureToggles.autoMigrateTablePanel||g("autoMigrateTablePanel")))return"table";if(s.type==="grafana-piechart-panel"&&(t.Ay.featureToggles.autoMigratePiechartPanel||g("autoMigratePiechartPanel")))return"piechart";if(s.type==="grafana-worldmap-panel"&&(t.Ay.featureToggles.autoMigrateWorldmapPanel||g("autoMigrateWorldmapPanel")))return"geomap";if((s.type==="singlestat"||s.type==="grafana-singlestat-panel")&&t.Ay.featureToggles.autoMigrateStatPanel||g("autoMigrateStatPanel"))return"stat"}},34214:(k,R,e)=>{"use strict";e.d(R,{G:()=>t.G,a:()=>n.a9});var t=e(98365),n=e(84423)},20470:(k,R,e)=>{"use strict";e.d(R,{us:()=>U,vR:()=>B,yZ:()=>V,OI:()=>K});var t=e(71733),n=e(47232),i=e(69129),s=e(39601),r=e(17172),g=e(32264),a=e(82467),c=e(28138),o=e(3169),h=e(27677),f=e(33390),d=e(78160),p=e(17493),m=e(14792),v=e(74856),l=e(72255),y=e(71176),u=e(71101),D=e(54650);function E(H){return async Y=>{const X=await h.IB.getFolderByUid(H);return Y((0,D.jl)(X)),Y((0,a.Vz)((0,u.R4)(X))),X}}var x=e(6473),P=e(2609),b=e(75096),M=e(31678),O=e(42972),I=e(72401),T=e(87421),C=e(16833),S=e(98365),A=e(41176),L=e(28601);const N="initDashboard";async function F(H,Y,X){const J=f.A.getObject(U);if(J)return V(),J;try{switch(H.routeName){case M.DashboardRoutes.Home:{const ae=(0,l.sP)().getDashboardFromCache(l.m6);if(ae)return ae;const j=await h.IB.get("/api/dashboards/home");if(j.redirectUri){const te=t.I.stripBaseFromUrl(j.redirectUri);return s.Ny.replace(te),null}return j.meta.canSave=!1,j.meta.canShare=!1,j.meta.canStar=!1,j}case M.DashboardRoutes.Public:return await p.np.loadDashboard("public",H.urlSlug,H.accessToken);case M.DashboardRoutes.Normal:{const q=await p.np.loadDashboard(H.urlType,H.urlSlug,H.urlUid);if(q.meta.folderUid)try{await Y(E(q.meta.folderUid))}catch(ae){console.warn("Error fetching parent folder",q.meta.folderUid,"for dashboard",ae)}if(H.fixUrl&&q.meta.url&&!P._o.state.isPlaying){const ae=t.I.stripBaseFromUrl(q.meta.url),j=s.Ny.getLocation().pathname;ae!==j&&(s.Ny.replace({...s.Ny.getLocation(),pathname:ae}),console.log("not correct url correcting",ae,j))}return q}case M.DashboardRoutes.New:return H.urlFolderUid&&await Y(E(H.urlFolderUid)),await(0,y.X)(H.urlFolderUid);case M.DashboardRoutes.Path:{const q=H.urlSlug??"";return await p.np.loadDashboard(M.DashboardRoutes.Path,q,q)}default:throw{message:"Unknown route "+H.routeName}}}catch(q){return(0,r.NF)(q)&&q.cancelled||(Y((0,L.ig)({message:"Failed to fetch dashboard",error:q})),console.error(q)),null}}const w=(H,Y={})=>(H.forEach(X=>{X.panels?w(X.panels,Y):X.targets&&X.targets.forEach(J=>{J.datasource?.type&&(Y[J.datasource.type]?Y[J.datasource.type].push(J):Y[J.datasource.type]=[J])})}),Y);function B(H){return async(Y,X)=>{(0,d.j)(N),Y((0,L.xS)());const J=await F(H,Y,X),q=J?.dashboard?.version;if(!J)return;Y((0,L.X1)());let ae;try{ae=new S.G(J.dashboard,J.meta)}catch(ie){Y((0,L.ig)({message:"Failed create dashboard model",error:ie})),console.error(ie);return}const j=X(),te=s.Ny.getSearchObject();te.orgId||s.Ny.partial({orgId:j.user.orgId},!0);const ne=(0,v.jG)();(0,m.UA)().setCurrent(ae),ne.init(ae);const z=(0,b.q4)(H.urlUid??ae.uid);if(await Y((0,I._q)(z,ae)),(0,O.nm)({dashboard:ae,timeSrv:ne}).run({dashboard:ae,range:ne.timeRange()}),(0,T.Tk)(X())!==z||X().dashboard.initPhase!==M.DashboardInitPhase.Services)return;try{ae.processRepeats(),te.autofitpanels&&ae.autoFitPanels(window.innerHeight,te.kiosk),g.$.publicDashboardAccessToken||H.keybindingSrv.setupDashboardBindings(ae)}catch(ie){ie instanceof Error&&Y((0,a.dx)((0,o.gi)("Dashboard init failed",ie))),console.error(ie)}H.routeName!==M.DashboardRoutes.New?((0,A.B)(ae),x.t.watch(ae.uid)):x.t.leave(),ae.weekStart!==""?(0,n.$D)(ae.weekStart):(0,n.$D)(g.$.bootData.user.weekStart),c.A.publish(new i.gc({dashboardId:ae.uid,orgId:j.user.orgId,userId:j.user.user?.id,grafanaVersion:g.$.buildInfo.version,queries:w(ae.panels)}));const se=(0,d.z)(N);(0,C.d)(ae,se?.duration,q),Y((0,L.O9)(ae))}}const U="DASHBOARD_FROM_LS_KEY";function K(H){f.A.setObject(U,H)}function V(){f.A.delete(U)}},28601:(k,R,e)=>{"use strict";e.d(R,{Ay:()=>v,O9:()=>o,Ub:()=>p,X1:()=>h,ig:()=>c,p0:()=>f,xS:()=>a});var t=e(65307),n=e(79422),i=e(31678),s=e(98365);const r={initPhase:i.DashboardInitPhase.NotStarted,getModel:()=>null,initError:null,initialDatasource:void 0},g=(0,t.Z0)({name:"dashboard",initialState:r,reducers:{dashboardInitFetching:l=>{l.initPhase=i.DashboardInitPhase.Fetching},dashboardInitServices:l=>{l.initPhase=i.DashboardInitPhase.Services},dashboardInitCompleted:(l,y)=>{l.getModel=()=>y.payload,l.initPhase=i.DashboardInitPhase.Completed},dashboardInitFailed:(l,y)=>{l.initPhase=i.DashboardInitPhase.Failed,l.initError=y.payload,l.getModel=()=>new s.G({...n.Ye,title:"Dashboard init failed"},{canSave:!1,canEdit:!1})},cleanUpDashboard:l=>{l.initPhase=i.DashboardInitPhase.NotStarted,l.initError=null,l.getModel=()=>null},addPanel:(l,y)=>{},setInitialDatasource:(l,y)=>{l.initialDatasource=y.payload}}}),{dashboardInitFetching:a,dashboardInitFailed:c,dashboardInitCompleted:o,dashboardInitServices:h,cleanUpDashboard:f,addPanel:d,setInitialDatasource:p}=g.actions,v={dashboard:g.reducer}},36974:(k,R,e)=>{"use strict";e.d(R,{B1:()=>D,CW:()=>y,LH:()=>c,OK:()=>o,SD:()=>f,VF:()=>d,_u:()=>v,dH:()=>E,ko:()=>u,no:()=>m,ob:()=>h,s3:()=>p});var t=e(2543),n=e.n(t),i=e(39601),s=e(2913),r=e(15054),g=e(33390),a=e(19752);const c="Panel Title";function o(P,b){const M={type:"timeseries",title:c,gridPos:(0,a.Ft)(P),datasource:b?{uid:b}:null,isNew:!0};return P.addPanel(M),M.id}function h(P,b){const M={type:b,title:"Widget title",gridPos:(0,a.Ft)(P),datasource:null,isNew:!0};return P.addPanel(M),M.id}function f(P){const b={type:"row",title:"Row title",gridPos:{x:0,y:0}};P.addPanel(b)}function d(){i.Ny.push("/dashboard/import")}function p(P){const b={type:"add-library-panel",gridPos:(0,a.Ft)(P)};P.addPanel(b)}function m(P,b){if(!b)return;const M=(0,a.Ft)(P),O={type:b.id,title:c,gridPos:{x:M.x,y:M.y,w:b.defaults.gridPos.w,h:b.defaults.gridPos.h}};b.defaults&&((0,t.defaults)(O,b.defaults),O.title=b.defaults.title,g.A.delete(r.tH)),P.addPanel(O)}function v(){const P=(0,t.chain)(s.Ay.panels).filter({hideFromList:!1}).map(M=>M).value(),b=g.A.get(r.tH);if(b){const M=JSON.parse(b),O=(0,t.find)(P,{id:M.type});if(O){const I=(0,t.cloneDeep)(O);return I.name=M.title,I.sort=-1,{...I,defaults:{...M}}}}}const l="grafana.dashboards.panelEdit.lastUsedDatasource";function y(P){if(g.A.exists(l)){const b=g.A.getObject(l);if(b?.dashboardUid===P)return b}}function u(P){if(!g.A.exists(l))return;const M=g.A.getObject(l)?.datasourceUid??"";x(P,M)}function D(P){g.A.setObject(l,{dashboardUid:P,datasourceUid:""})}function E(P,b){const M=y(P);if(!M)x(P,b);else{const O=M?.dashboardUid??"";x(O,b)}}function x(P,b){g.A.setObject(l,{dashboardUid:P,datasourceUid:b})}},61642:(k,R,e)=>{"use strict";e.d(R,{X:()=>i});var t=e(32264),n=e(39601);function i(){if(!t.$.featureToggles.scopeFilters||!t.$.featureToggles.passScopeToDashboardApi)return;const r=n.Ny.getSearchObject().scopes??[],g=Array.isArray(r)?r:[r];return new URLSearchParams(g.map(a=>["scopes",String(a)]))}},19752:(k,R,e)=>{"use strict";e.d(R,{ET:()=>I,FC:()=>D,Ft:()=>A,KJ:()=>x,Mc:()=>P,ZY:()=>M,d7:()=>b,iU:()=>E,nk:()=>T});var t=e(2543),n=e.n(t),i=e(26272),s=e(65879),r=e(47232),g=e(85858),a=e(72574),c=e(28138),o=e(2913),h=e(15054),f=e(33390),d=e(1702),p=e(84423),m=e(54174),v=e(96227),l=e(79971),y=e(99140),u=e(28444);const D=(L,N,F)=>{if(F!==!1){const w=N.alert?"YES":void 0;c.A.publish(new u.bY({title:"Remove panel",text:"Are you sure you want to remove this panel?",icon:"trash-alt",confirmText:w,yesText:"Remove",onConfirm:()=>D(L,N,!1)}));return}L.removePanel(N),(0,y.JD)((0,l.O6)(N.key))},E=(L,N)=>{L.duplicatePanel(N)},x=L=>{let N=L;L instanceof p.a9&&(N=L.getSaveModel()),f.A.set(h.tH,JSON.stringify(N)),c.A.emit(i.r1.alertSuccess,["Panel copied. Click **Add panel** icon to paste."])},P=(L,N)=>{c.A.publish(new u.S8({component:d.ShareModal,props:{dashboard:L,panel:N}}))},b=(L,N)=>{c.A.publish(new u.S8({component:v.o,props:{panel:N,initialFolderUid:L.meta.folderUid,isOpen:!0}}))},M=L=>{c.A.publish(new u.S8({component:m.l,props:{onConfirm:()=>L.unlinkLibraryPanel(),isOpen:!0}}))},O=L=>{L.refresh()},I=L=>{const N={...L.options};N.legend.showLegend===!0?N.legend.showLegend=!1:N.legend.showLegend=!0,L.updateOptions(N)};function T(L,N){const F={timeInfo:"",timeRange:N};if(L.timeFrom){const w=(0,a.w)().replace(L.timeFrom,L.scopedVars),B=s.describeTextRange(w);if(B.invalid)return F.timeInfo="invalid time override",F;if((0,t.isString)(N.raw.from)){const U=(0,r.AN)(N.from).tz(),K=(0,r.AN)(N.to).tz(),V=g.parse(B.from,void 0,U);F.timeInfo=B.display,F.timeRange={from:V,to:g.parse(B.to,void 0,K),raw:{from:B.from,to:B.to}}}}if(L.timeShift){const w=(0,a.w)().replace(L.timeShift,L.scopedVars);if(s.describeTextRange(w).invalid)return F.timeInfo="invalid timeshift",F;const U="-"+w;F.timeInfo+=" timeshift "+U;const K=g.parseDateMath(U,F.timeRange.from,!1),V=g.parseDateMath(U,F.timeRange.to,!0);F.timeRange={from:K,to:V,raw:{from:K,to:V}}}return L.hideTimeOverride&&(F.timeInfo=""),F}function C(L){const F=document.getElementsByTagName("html")[0].getBoundingClientRect().width;return L.maxDataPoints?L.maxDataPoints:Math.ceil(F*(L.gridPos.w/24))}function S(L,N){const F=L.plugin&&L.plugin.noPadding?0:config.theme.panelPadding*2,w=L.hasTitle()?config.theme.panelHeaderHeight:0;return N-w-F-PANEL_BORDER}function A(L){for(const F of L.panelIterator())F.gridPos.y+=8;return{x:0,y:0,w:12,h:8}}},21380:(k,R,e)=>{"use strict";e.d(R,{z:()=>i});var t=e(47232),n=e(85858);const i=(s,r)=>{const g={from:(0,t.Ar)(s.from)?(0,t.KQ)(s.from):s.from,to:(0,t.Ar)(s.to)?(0,t.KQ)(s.to):s.to},a=r?r.getTimezone():void 0;return{from:n.parse(g.from,!1,a,r?.fiscalYearStartMonth),to:n.parse(g.to,!0,a,r?.fiscalYearStartMonth),raw:g}}},16833:(k,R,e)=>{"use strict";e.d(R,{D:()=>i,d:()=>n});var t=e(7758);function n(c,o,h){const f=r(c.templating.list),d=s(c.panels);t.c.dashboardInitialized({uid:c.uid,title:c.title,theme:c.style,schemaVersion:c.schemaVersion,version_before_migration:h,panels_count:c.panels.length,...d,...f,settings_nowdelay:c.timepicker.nowDelay,settings_livenow:!!c.liveNow,duration:o,isScene:!1})}function i(c,o){const h=c.getInitialSaveModel();if(h){const f=s(h.panels||[]),d=r(h.templating?.list||[]);t.c.dashboardInitialized({uid:h.uid,title:h.title,theme:void 0,schemaVersion:h.schemaVersion,version_before_migration:h.version,panels_count:h.panels?.length||0,...f,...d,settings_nowdelay:void 0,settings_livenow:!!h.liveNow,duration:o,isScene:!0})}}function s(c){return c.map(o=>o.type).reduce((o,h)=>(o[a(h)]=1+o[a(h)]||1,o),{})}function r(c){return c.map(o=>o.type).reduce((o,h)=>(o[g(h)]=1+o[g(h)]||1,o),{})}const g=c=>`variable_type_${c}_count`,a=c=>`panel_type_${c}_count`},40489:(k,R,e)=>{"use strict";e.d(R,{ZF:()=>g,vI:()=>r,o2:()=>a});var t=e(88483),n=e(14236);function i(c){const o=new Set;return Object.keys(c).forEach(h=>{c[h].forEach(f=>{o.add(f)})}),o}function s(c){const o=Array.from(i(c));return o.length===1?o[0]:`${o.slice(0,-1).join(", ")} or ${o.slice(-1)}`}function r(c){return new t.c(o=>{let h=0;Promise.all([e.e(2136),e.e(3686)]).then(e.bind(e,22136)).then(f=>{c.forEach(d=>{const p=new FileReader;p.readAsArrayBuffer(d),p.onload=()=>{const m=p.result;if(m&&m instanceof ArrayBuffer){if(d.type==="application/json"){const v=new TextDecoder("utf-8"),l=JSON.parse(v.decode(m));o.next({dataFrames:[(0,n.Vc)(l)],file:d})}else o.next({dataFrames:f.readSpreadsheet(m),file:d});++h>=c.length&&o.complete()}}})}).catch(()=>{throw"Failed to load sheets module"})})}const g={"text/plain":[".csv",".txt"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"],"application/vnd.ms-excel":[".xls"],"application/vnd.apple.numbers":[".numbers"],"application/vnd.oasis.opendocument.spreadsheet":[".ods"],"application/json":[".json"]},a=5e5},32738:(k,R,e)=>{"use strict";e.d(R,{r:()=>c});var t=e(74848),n=e(71733),i=e(55852),s=e(10096),r=e(8484),g=e(6320),a=e(31678);function c({variant:o,onClick:h}){const f=s.TP.hasPermission(a.AccessControlAction.DataSourcesCreate),d=n.I.assureBaseUrl(g.b.DataSourcesNew);return(0,t.jsx)(i.z9,{variant:o||"primary",href:d,disabled:!f,tooltip:f?void 0:"You do not have permission to configure new data sources",onClick:h,target:"_blank",children:(0,t.jsx)(r.x6,{i18nKey:"data-source-picker.add-new-data-source",children:"Configure a new data source"})})}},2221:(k,R,e)=>{"use strict";e.d(R,{A:()=>g});var t=e(74848),n=e(32196),i=e(40845),s=e(10860),r=e(64149);function g({ds:c,onClick:o,selected:h,description:f,...d}){const p=(0,i.$j)(),m=a(p,c.meta.builtIn);return(0,t.jsxs)(s.Z,{onClick:o,className:(0,n.cx)(m.card,h?m.selected:void 0),...d,children:[(0,t.jsx)(s.Z.Heading,{className:m.heading,children:(0,t.jsxs)("div",{className:m.headingContent,children:[(0,t.jsxs)("span",{className:m.name,children:[c.name," ",c.isDefault?(0,t.jsx)(r.L,{tags:["default"]}):null]}),(0,t.jsx)("small",{className:m.type,children:f||c.meta.name})]})}),(0,t.jsx)(s.Z.Figure,{className:m.logo,children:(0,t.jsx)("img",{src:c.meta.info.logos.small,alt:`${c.meta.name} Logo`})})]},c.uid)}function a(c,o=!1){return{card:(0,n.css)`
      cursor: pointer;
      background-color: ${c.colors.background.primary};
      border-bottom: 1px solid ${c.colors.border.weak};
      // Move to list component
      margin-bottom: 0;
      border-radius: 0;
      padding: ${c.spacing(1)};
    `,heading:(0,n.css)`
      width: 100%;
      overflow: hidden;
      // This is needed to enable ellipsis when text overlfows
      > button {
        width: 100%;
      }
    `,headingContent:(0,n.css)`
      color: ${c.colors.text.secondary};
      width: 100%;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      display: flex;
      justify-content: space-between;
    `,logo:(0,n.css)`
      width: 32px;
      height: 32px;
      padding: ${c.spacing(0,1)};
      display: flex;
      align-items: center;

      > img {
        max-height: 100%;
        min-width: 24px;
        filter: invert(${o&&c.isLight?1:0});
      }
    `,name:(0,n.css)`
      color: ${c.colors.text.primary};
      display: flex;
      gap: ${c.spacing(2)};
    `,type:(0,n.css)`
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      display: flex;
      align-items: center;
    `,separator:(0,n.css)`
      margin: 0 ${c.spacing(1)};
      color: ${c.colors.border.weak};
    `,selected:(0,n.css)`
      background-color: ${c.colors.background.secondary};
    `,meta:(0,n.css)`
      display: block;
      overflow-wrap: unset;
      white-space: nowrap;
      width: 100%;
      overflow: hidden;
      text-overflow: ellipsis;
    `}}},11219:(k,R,e)=>{"use strict";e.d(R,{S:()=>d});var t=e(74848),n=e(32196),i=e(96540),s=e(13544),r=e(72574),g=e(40845),a=e(8484),c=e(87282),o=e(32738),h=e(2221),f=e(47311);function d(y){const u=(0,i.useRef)(null),[D,E]=(0,c.dR)({keyboardEvents:y.keyboardEvents,containerRef:u}),x=(0,g.$j)(),P=l(x,E),{className:b,current:M,onChange:O,enableKeyboardNavigation:I,onClickEmptyStateCTA:T}=y,C=(0,c.Kr)({alerting:y.alerting,annotations:y.annotations,dashboard:y.dashboard,logs:y.logs,metrics:y.metrics,mixed:y.mixed,pluginId:y.pluginId,tracing:y.tracing,type:y.type,variables:y.variables}),[S,A]=(0,c.TX)(),L=y.filter?C.filter(y.filter):C;return(0,t.jsxs)("div",{ref:u,className:(0,n.cx)(b,P.container),"data-testid":s.Tp.components.DataSourcePicker.dataSourceList,children:[L.length===0&&(0,t.jsx)(p,{className:P.emptyState,onClickCTA:T}),L.sort((0,f.Tj)(M,S,v())).map(N=>(0,t.jsx)(h.A,{"data-testid":"data-source-card",ds:N,onClick:()=>{A(N),O(N)},selected:(0,f.Df)(N,M),...I?D:{}},N.uid))]})}function p({className:y,onClickCTA:u}){const D=(0,g.of)(m);return(0,t.jsxs)("div",{className:(0,n.cx)(y,D.container),children:[(0,t.jsx)("p",{className:D.message,children:(0,t.jsx)(a.x6,{i18nKey:"data-source-picker.list.no-data-source-message",children:"No data sources found"})}),(0,t.jsx)(o.r,{onClick:u})]})}function m(y){return{container:(0,n.css)`
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    `,message:(0,n.css)`
      margin-bottom: ${y.spacing(3)};
    `}}function v(){return(0,r.w)().getVariables().filter(u=>u.type==="datasource").map(u=>`\${${u.id}}`)}function l(y,u){return{container:(0,n.css)`
      display: flex;
      flex-direction: column;
      ${u} {
        background-color: ${y.colors.background.secondary};
      }
    `,emptyState:(0,n.css)`
      height: 100%;
      flex: 1;
    `}}},50481:(k,R,e)=>{"use strict";e.d(R,{p:()=>I});var t=e(74848),n=e(32196),i=e(2543),s=e(96540),r=e(14110),g=e(32264),a=e(40845),c=e(37390),o=e(10354),h=e(14578),f=e(40276),d=e(37270),p=e(8484),m=e(40489),v=e(90478),l=e(87282),y=e(32738),u=e(13544),D=e(2221),E=e(47311);function x(C){switch(C){case"grafana":return(0,p.t)("data-source-picker.built-in-list.description-grafana","Discover visualizations using mock data");case"-- Mixed --":return(0,p.t)("data-source-picker.built-in-list.description-mixed","Use multiple data sources");case"-- Dashboard --":return(0,p.t)("data-source-picker.built-in-list.description-dashboard","Reuse query results from other visualizations");default:return""}}function P({className:C,current:S,onChange:A,tracing:L,dashboard:N,mixed:F,metrics:w,type:B,annotations:U,variables:K,alerting:V,pluginId:H,logs:Y,filter:X}){const q=(0,l.Kr)({tracing:L,dashboard:N,mixed:F,metrics:w,type:B,annotations:U,variables:K,alerting:V,pluginId:H,logs:Y}).filter(ae=>(X?X?.(ae):!0)&&!!ae.meta.builtIn);return(0,t.jsx)("div",{className:C,"data-testid":u.Tp.components.DataSourcePicker.advancedModal.builtInDataSourceList,children:q.map(ae=>(0,t.jsx)(D.A,{ds:ae,description:x(ae.uid),selected:(0,E.Df)(ae,S),onClick:()=>A(ae)},ae.uid))})}var b=e(11219);const M="dashboards_dspickermodal_clicked",O={SELECT_DS:"select_ds",UPLOAD_FILE:"upload_file",CONFIG_NEW_DS:"config_new_ds",CONFIG_NEW_DS_EMPTY_STATE:"config_new_ds_empty_state",SEARCH:"search",DISMISS:"dismiss"};function I({tracing:C,dashboard:S,mixed:A,metrics:L,type:N,annotations:F,variables:w,alerting:B,pluginId:U,logs:K,uploadFile:V,filter:H,onChange:Y,current:X,onDismiss:J,reportedInteractionFrom:q}){const ae=(0,a.of)(T),[j,te]=(0,s.useState)(""),ne=q||"modal",le=()=>{J(),(0,r.rR)(M,{item:O.DISMISS,src:ne})},z=oe=>{Y(oe),(0,r.rR)(M,{item:O.SELECT_DS,ds_type:oe.type,src:ne})},ee=(0,s.useMemo)(()=>(0,i.once)(()=>{(0,r.rR)(M,{item:"search",src:ne})}),[ne]),se=(0,l.ps)("-- Grafana --"),ie=(0,v.j)((oe,ce)=>{se&&(Y(se,[oe]),(0,r.rR)(M,{item:O.UPLOAD_FILE,src:ne}),ce.length<1&&J())}),Z=({className:oe})=>(0,t.jsx)(P,{className:oe,onChange:z,current:X,filter:H,variables:w,tracing:C,metrics:L,type:N,annotations:F,alerting:B,pluginId:U,logs:K,dashboard:S,mixed:A});return(0,t.jsxs)(c.a,{title:(0,p.t)("data-source-picker.modal.title","Select data source"),closeOnEscape:!0,closeOnBackdropClick:!0,isOpen:!0,className:ae.modal,contentClassName:ae.modalContent,onClickBackdrop:le,onDismiss:le,children:[(0,t.jsxs)("div",{className:ae.leftColumn,children:[(0,t.jsx)(o.p,{type:"search",autoFocus:!0,className:ae.searchInput,value:j,prefix:(0,t.jsx)(h.I,{name:"search"}),placeholder:(0,p.t)("data-source-picker.modal.input-placeholder","Select data source"),onChange:oe=>{te(oe.currentTarget.value),ee()}}),(0,t.jsxs)(f.E,{children:[(0,t.jsx)(b.S,{onChange:z,current:X,onClickEmptyStateCTA:()=>(0,r.rR)(M,{item:O.CONFIG_NEW_DS_EMPTY_STATE,src:ne}),filter:oe=>(H?H?.(oe):!0)&&(0,E.Zn)(oe,j)&&!oe.meta.builtIn,variables:w,tracing:C,metrics:L,type:N,annotations:F,alerting:B,pluginId:U,logs:K,dashboard:S,mixed:A}),(0,t.jsx)(Z,{className:ae.appendBuiltInDataSourcesList})]})]}),(0,t.jsxs)("div",{className:ae.rightColumn,children:[(0,t.jsxs)("div",{className:ae.builtInDataSources,children:[(0,t.jsx)(f.E,{className:ae.builtInDataSourcesList,children:(0,t.jsx)(Z,{})}),V&&g.$.featureToggles.editPanelCSVDragAndDrop&&(0,t.jsx)(d.gH,{readAs:"readAsArrayBuffer",fileListRenderer:()=>{},options:{maxSize:m.o2,multiple:!1,accept:m.ZF,onDrop:ie},children:(0,t.jsx)(d.wI,{})})]}),(0,t.jsxs)("div",{className:ae.newDSSection,children:[(0,t.jsx)("span",{className:ae.newDSDescription,children:(0,t.jsx)(p.x6,{i18nKey:"data-source-picker.modal.configure-new-data-source",children:"Open a new tab and configure a data source"})}),(0,t.jsx)(y.r,{variant:"secondary",onClick:()=>{(0,r.rR)(M,{item:O.CONFIG_NEW_DS,src:ne}),J()}})]})]})]})}function T(C){return{modal:(0,n.css)`
      width: 80%;
      height: 80%;
      max-width: 1200px;
      max-height: 900px;

      ${C.breakpoints.down("md")} {
        width: 100%;
      }
    `,modalContent:(0,n.css)`
      display: flex;
      flex-direction: row;
      height: 100%;

      ${C.breakpoints.down("md")} {
        flex-direction: column;
      }
    `,leftColumn:(0,n.css)`
      display: flex;
      flex-direction: column;
      width: 50%;
      height: 100%;
      padding-right: ${C.spacing(4)};
      border-right: 1px solid ${C.colors.border.weak};

      ${C.breakpoints.down("md")} {
        width: 100%;
        border-right: 0;
        padding-right: 0;
        flex: 1;
        overflow-y: auto;
      }
    `,rightColumn:(0,n.css)`
      display: flex;
      flex-direction: column;
      width: 50%;
      height: 100%;
      justify-items: space-evenly;
      align-items: stretch;
      padding-left: ${C.spacing(4)};

      ${C.breakpoints.down("md")} {
        width: 100%;
        padding-left: 0;
        flex: 0;
      }
    `,builtInDataSources:(0,n.css)`
      flex: 1 1;
      margin-bottom: ${C.spacing(4)};

      ${C.breakpoints.down("md")} {
        flex: 0;
      }
    `,builtInDataSourcesList:(0,n.css)`
      ${C.breakpoints.down("md")} {
        display: none;
        margin-bottom: 0;
      }

      margin-bottom: ${C.spacing(4)};
    `,appendBuiltInDataSourcesList:(0,n.css)`
      ${C.breakpoints.up("md")} {
        display: none;
      }
    `,newDSSection:(0,n.css)`
      display: flex;
      flex-direction: row;
      width: 100%;
      justify-content: space-between;
      align-items: center;
    `,newDSDescription:(0,n.css)`
      flex: 1 0;
      text-overflow: ellipsis;
      overflow: hidden;
      white-space: nowrap;
      color: ${C.colors.text.secondary};
    `,searchInput:(0,n.css)`
      width: 100%;
      min-height: 32px;
      margin-bottom: ${C.spacing(1)};
    `}}},51612:(k,R,e)=>{"use strict";e.d(R,{s:()=>N});var t=e(74848),n=e(32196),i=e(34743),s=e(36376),r=e(7315),g=e(18828),a=e(85690),c=e(93225),o=e(96540),h=e(13544),f=e(14110),d=e(40845),p=e(10354),m=e(14578),v=e(17464),l=e(40276),y=e(71678),u=e(55852),D=e(2913),E=e(8484),x=e(97427),P=e(68706),b=e(87282),M=e(11219);function O(V){const{dataSource:H}=V,Y=(0,d.$j)(),X=T(Y,H?.meta.builtIn);return H?(0,t.jsx)("img",{className:X.pickerDSLogo,alt:`${H.meta.name} logo`,src:H.meta.info.logos.small}):I()}function I(){const V=(0,d.of)(T);return(0,t.jsx)("div",{className:V.pickerDSLogo})}function T(V,H=!1){return{pickerDSLogo:(0,n.css)`
      height: 20px;
      width: 20px;
      filter: invert(${H&&V.isLight?1:0});
    `}}var C=e(50481),S=e(47311);const A="dashboards_dspicker_clicked",L={OPEN_DROPDOWN:"open_dspicker",SELECT_DS:"select_ds",ADD_FILE:"add_file",OPEN_ADVANCED_DS_PICKER:"open_advanced_ds_picker",CONFIG_NEW_DS_EMPTY_STATE:"config_new_ds_empty_state"};function N(V){const{current:H,onChange:Y,hideTextValue:X=!1,width:J,inputId:q,noDefault:ae=!1,disabled:j=!1,placeholder:te="Select data source",...ne}=V,le=(0,d.of)(F,V),[z,ee]=(0,o.useState)(!1),[se,ie]=(0,o.useState)(!1),[Z,oe]=(0,o.useState)(""),{onKeyDown:ce,keyboardEvents:ye}=(0,x.d)(),re=(0,o.useRef)(null),[ue,De]=(0,o.useState)(),[ge,Te]=(0,o.useState)(),Le=(0,b.ps)(H),Ye=(0,b.ps)("-- Grafana --"),je=!H&&ae?void 0:Le,Ze=Z&&z?(0,t.jsx)(I,{}):(0,t.jsx)(O,{dataSource:je}),Ne=[(0,i.cY)(4),(0,i.Ej)({apply({availableHeight:Ee,elements:me}){me.floating.style.maxHeight=`${Math.max(200,Ee-20)}px`,me.floating.style.minHeight="200px"}}),(0,i.UU)({fallbackStrategy:"initialPlacement",crossAxis:!1,boundary:document.body}),(0,i.BN)()],{refs:Pe,floatingStyles:Ue}=(0,s.we)({open:z,placement:"bottom-start",onOpenChange:ee,middleware:Ne,whileElementsMounted:r.ll,strategy:"fixed"}),$e=(0,o.useCallback)(Ee=>{Pe.setReference(Ee),De(Ee)},[Pe]),ze=(0,o.useCallback)(()=>{oe(""),ee(!1),ue?.focus()},[ee,ue]),{overlayProps:qe,underlayProps:dt}=(0,c.e)({onClose:ze,isDismissable:!0,isOpen:z,shouldCloseOnInteractOutside:Ee=>ue?!ue.isSameNode(Ee):!1},re),{dialogProps:vt}=(0,g.s)({"aria-label":"Opened data source picker list"},re);function yt(){(0,f.rR)(A,{item:L.OPEN_DROPDOWN}),ee(!0),ue?.focus()}function st(){Ye&&Y(Ye,[P.dx])}function Ve(Ee){Ee.key==="Tab"&&!Ee.shiftKey&&z&&(Ee.preventDefault(),ge?.focus()),Ee.key==="Tab"&&Ee.shiftKey&&z&&ze(),ce(Ee)}function pe(Ee){Ee.shiftKey?(Ee.preventDefault(),ue?.focus()):ze()}return(0,o.useEffect)(()=>{const Ee=ye.subscribe({next:me=>{switch(me?.code){case"ArrowDown":yt(),me.preventDefault();break;case"ArrowUp":yt(),me.preventDefault();break;case"Escape":ze(),me.preventDefault();break}}});return()=>Ee.unsubscribe()}),(0,t.jsxs)("div",{className:le.container,"data-testid":h.Tp.components.DataSourcePicker.container,children:[(0,t.jsx)("div",{className:le.trigger,onClick:yt,children:(0,t.jsx)(p.p,{id:q||"data-source-picker",className:se?void 0:le.input,"data-testid":h.Tp.components.DataSourcePicker.inputV2,"aria-label":"Select a data source",autoComplete:"off",prefix:je?Ze:void 0,suffix:(0,t.jsx)(m.I,{name:z?"search":"angle-down"}),placeholder:X?"":(0,S.q7)(je)||te,onFocus:()=>{ie(!0)},onBlur:()=>{ie(!1)},onKeyDown:Ve,value:Z,onChange:Ee=>{yt(),oe(Ee.currentTarget.value)},ref:$e,disabled:j})}),z?(0,t.jsxs)(v.ZL,{children:[(0,t.jsx)("div",{...dt}),(0,t.jsx)("div",{ref:re,...qe,...vt,children:(0,t.jsx)(w,{...ne,style:Ue,ref:Pe.setFloating,footerRef:Te,current:je,filterTerm:Z,keyboardEvents:ye,onChange:(Ee,me)=>{ze(),Ee.uid!==je?.uid&&(Y(Ee,me),(0,f.rR)(A,{item:L.SELECT_DS,ds_type:Ee.type}))},onClose:ze,onClickAddCSV:st,onDismiss:ze,onNavigateOutsiteFooter:pe})})]}):null]})}function F(V,H){return{container:(0,n.css)({position:"relative",cursor:H.disabled?"not-allowed":"pointer",width:V.spacing(H.width||"auto")}),trigger:(0,n.css)({cursor:"pointer",pointerEvents:H.disabled?"none":"auto"}),input:(0,n.css)({"input::placeholder":{color:H.disabled?V.colors.action.disabledText:V.colors.text.primary}})}}const w=o.forwardRef((V,H)=>{const{filterTerm:Y,onChange:X,onClose:J,onClickAddCSV:q,current:ae,filter:j}=V,te=(0,o.useCallback)(z=>{X(z)},[X]),ne=(0,o.useCallback)(()=>{q?.(),J(),(0,f.rR)(A,{item:L.ADD_FILE})},[q,J]),le=(0,d.of)(B);return(0,t.jsxs)("div",{style:V.style,ref:H,className:le.container,children:[(0,t.jsx)(l.E,{children:(0,t.jsx)(M.S,{...V,enableKeyboardNavigation:!0,className:le.dataSourceList,current:ae,onChange:te,filter:z=>(j?j?.(z):!0)&&(0,S.Zn)(z,Y),onClickEmptyStateCTA:()=>(0,f.rR)(A,{item:L.CONFIG_NEW_DS_EMPTY_STATE})})}),(0,t.jsx)(a.n1,{children:(0,t.jsx)(U,{...V,onClickAddCSV:ne,onChange:te,onNavigateOutsiteFooter:V.onNavigateOutsiteFooter})})]})});w.displayName="PickerContent";function B(V){return{container:(0,n.css)({display:"flex",flexDirection:"column",background:V.colors.background.primary,boxShadow:V.shadows.z3}),picker:(0,n.css)({background:V.colors.background.secondary}),dataSourceList:(0,n.css)({flex:1}),footer:(0,n.css)({flex:0,display:"flex",flexDirection:"row-reverse",justifyContent:"space-between",padding:V.spacing(1.5),borderTop:`1px solid ${V.colors.border.weak}`,backgroundColor:V.colors.background.secondary})}}function U({onClose:V,onChange:H,onClickAddCSV:Y,...X}){const J=(0,d.of)(K),q=X.uploadFile&&D.Ay.featureToggles.editPanelCSVDragAndDrop,ae=te=>{te.key==="Tab"&&X.onNavigateOutsiteFooter(te)},j=te=>{te.key==="Tab"&&te.shiftKey&&X.onNavigateOutsiteFooter(te)};return(0,t.jsxs)("div",{className:J.footer,children:[(0,t.jsx)(y.$s,{children:({showModal:te,hideModal:ne})=>(0,t.jsxs)(u.$n,{size:"sm",variant:"secondary",fill:"text",onClick:()=>{V(),te(C.p,{reportedInteractionFrom:"ds_picker",tracing:X.tracing,dashboard:X.dashboard,mixed:X.mixed,metrics:X.metrics,type:X.type,annotations:X.annotations,variables:X.variables,alerting:X.alerting,pluginId:X.pluginId,logs:X.logs,filter:X.filter,uploadFile:X.uploadFile,current:X.current,onDismiss:ne,onChange:(le,z)=>{H(le,z),ne()}}),(0,f.rR)(A,{item:L.OPEN_ADVANCED_DS_PICKER})},ref:X.footerRef,onKeyDown:q?j:ae,children:[(0,t.jsx)(E.x6,{i18nKey:"data-source-picker.open-advanced-button",children:"Open advanced data source picker"}),(0,t.jsx)(m.I,{name:"arrow-right"})]})}),q&&(0,t.jsx)(u.$n,{variant:"secondary",size:"sm",onClick:Y,onKeyDown:ae,children:"Add csv or spreadsheet"})]})}function K(V){return{footer:(0,n.css)({flex:0,display:"flex",flexDirection:"row-reverse",justifyContent:"space-between",padding:V.spacing(1.5),borderTop:`1px solid ${V.colors.border.weak}`,backgroundColor:V.colors.background.secondary})}}},47311:(k,R,e)=>{"use strict";e.d(R,{Df:()=>s,Tj:()=>g,Zn:()=>a,q7:()=>r,tw:()=>c});var t=e(14792),n=e(36974),i=e(14678);function s(o,h){return!o||!h?!1:typeof h=="string"?o.uid===h:o.uid===h.uid}function r(o){if(o){if(typeof o=="string")return`${o} - not found`;if("name"in o)return o.name;if(o.uid)return`${o.uid} - not found`}}function g(o,h,f){return(p,m)=>{const v=p.name.toUpperCase(),l=m.name.toUpperCase();if(o&&s(p,o))return-1;if(o&&s(m,o))return 1;const y=h.indexOf(p.uid),u=h.indexOf(m.uid);if(y>-1&&y>u)return-1;if(u>-1&&u>y)return 1;const D=f.includes(p.uid),E=f.includes(m.uid);return D&&!E?-1:E&&!D||p.meta.builtIn&&!m.meta.builtIn?1:m.meta.builtIn&&!p.meta.builtIn||v<l?-1:1}}function a(o,h=""){return o.name.toLowerCase().includes(h.toLowerCase())}function c(o){if(!o.uid)return;const h=(0,t.UA)().getCurrent()?.uid??"";if(o.uid===i.uv)return(0,n.B1)(h);(0,n.dH)(h,o.uid)}},83883:(k,R,e)=>{"use strict";e.d(R,{I:()=>t});const t={List:"/datasources",Edit:"/datasources/edit/:uid",Dashboards:"/datasources/edit/:uid/dashboards",New:"/datasources/new"}},87282:(k,R,e)=>{"use strict";e.d(R,{Kr:()=>g,TX:()=>r,dR:()=>c,ps:()=>a});var t=e(96540),n=e(78685),i=e(19347);const s="grafana.features.datasources.components.picker.DataSourceDropDown.history";function r(){const[o=[],h]=(0,n.A)(s,[]),f=(0,t.useCallback)(d=>{d.meta.builtIn||(o.includes(d.uid)?(o.splice(o.findIndex(p=>d.uid===p),1),h([...o,d.uid])):h([...o,d.uid].slice(1,6)))},[o,h]);return[o,f]}function g(o){return(0,i.l)().getList(o)}function a(o){const h=(0,i.l)();return h.getInstanceSettings(o)}function c(o){const{keyboardEvents:h,containerRef:f}=o,d=(0,t.useRef)(0),p="data-role",m="keyboardSelectableItem",v={[p]:m},l=`[${p}="${m}"`,y="data-selectedItem",u=`[${y}="true"]`,D=(0,t.useCallback)(x=>{const P=f?.current?.querySelectorAll(l),b=P?.item(x%P?.length);P?.forEach(M=>M.setAttribute(y,"false")),b&&(b.scrollIntoView({block:"center"}),b.setAttribute(y,"true"))},[f,l]),E=(0,t.useCallback)(()=>{f?.current?.querySelector(u)?.querySelector("button")?.click()},[f,u]);return(0,t.useEffect)(()=>{if(!h)return;const x=h.subscribe({next:P=>{switch(P?.code){case"ArrowDown":{D(++d.current),P.preventDefault();break}case"ArrowUp":d.current=d.current>0?d.current-1:d.current,D(d.current),P.preventDefault();break;case"Enter":E();break}}});return()=>x.unsubscribe()},[h,D,E]),(0,t.useEffect)(()=>{const x=new MutationObserver(P=>{P.some(M=>M.addedNodes&&M.addedNodes.length>0||M.removedNodes&&M.removedNodes.length>0)&&D(0)});return f.current&&x.observe(f.current,{childList:!0}),()=>{x.disconnect()}},[f,l,D]),[v,u]}},36227:(k,R,e)=>{"use strict";e.d(R,{Ay:()=>M,Bs:()=>h,C_:()=>m,E1:()=>g,Gc:()=>c,IJ:()=>y,Ks:()=>u,QZ:()=>E,TN:()=>r,Tk:()=>v,UP:()=>P,eB:()=>d,f$:()=>o,gZ:()=>a,jz:()=>s,lg:()=>x,qR:()=>D,rb:()=>p});var t=e(65307),n=e(19484);const i={dataSources:[],plugins:[],categories:[],dataSource:{},layoutMode:n.R.List,searchQuery:"",dataSourcesCount:0,dataSourceTypeSearchQuery:"",isLoadingDataSources:!1,isLoadingDataSourcePlugins:!1,dataSourceMeta:{},isSortAscending:!0},s=(0,t.VP)("dataSources/dataSourceLoaded"),r=(0,t.VP)("dataSources/dataSourcesLoad"),g=(0,t.VP)("dataSources/dataSourcesLoaded"),a=(0,t.VP)("dataSources/dataSourceMetaLoaded"),c=(0,t.VP)("dataSources/dataSourcePluginsLoad"),o=(0,t.VP)("dataSources/dataSourcePluginsLoaded"),h=(0,t.VP)("dataSources/setDataSourcesSearchQuery"),f=(0,t.VP)("dataSources/setDataSourcesLayoutMode"),d=(0,t.VP)("dataSources/setDataSourceTypeSearchQuery"),p=(0,t.VP)("dataSources/setDataSourceName"),m=(0,t.VP)("dataSources/setIsDefault"),v=(0,t.VP)("dataSources/setIsSortAscending"),l=(O=i,I)=>r.match(I)?{...O,isLoadingDataSources:!0}:g.match(I)?{...O,isLoadingDataSources:!1,dataSources:I.payload,dataSourcesCount:I.payload.length}:s.match(I)?{...O,dataSource:I.payload}:h.match(I)?{...O,searchQuery:I.payload}:f.match(I)?{...O,layoutMode:I.payload}:c.match(I)?{...O,plugins:[],isLoadingDataSourcePlugins:!0}:o.match(I)?{...O,plugins:I.payload.plugins,categories:I.payload.categories,isLoadingDataSourcePlugins:!1}:d.match(I)?{...O,dataSourceTypeSearchQuery:I.payload}:a.match(I)?{...O,dataSourceMeta:I.payload}:p.match(I)?{...O,dataSource:{...O.dataSource,name:I.payload}}:m.match(I)?{...O,dataSource:{...O.dataSource,isDefault:I.payload}}:v.match(I)?{...O,isSortAscending:I.payload}:O,y={testingStatus:{},loadError:null,loading:!0,plugin:null},u=(0,t.VP)("dataSourceSettings/initDataSourceSettingsSucceeded"),D=(0,t.VP)("dataSourceSettings/initDataSourceSettingsFailed"),E=(0,t.VP)("dataSourceSettings/testDataSourceStarting"),x=(0,t.VP)("dataSourceSettings/testDataSourceSucceeded"),P=(0,t.VP)("dataSourceSettings/testDataSourceFailed"),M={dataSources:l,dataSourceSettings:(O=y,I)=>u.match(I)?{...O,plugin:I.payload,loadError:null,loading:!1}:D.match(I)?{...O,plugin:null,loadError:I.payload.message,loading:!1}:E.match(I)?{...O,testingStatus:{message:"Testing... this could take up to a couple of minutes",status:"info"}}:x.match(I)?{...O,testingStatus:{status:I.payload?.status,message:I.payload?.message,details:I.payload?.details}}:P.match(I)?{...O,testingStatus:{status:"error",message:I.payload?.message,details:I.payload?.details}}:O}},38074:()=>{"use strict"},25148:(k,R,e)=>{"use strict";e.d(R,{n:()=>l});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(55852),g=e(39268),a=e(14186),c=e(10354),o=e(95868),h=e(13840),f=e(40321),d=e(47694),p=e(21813),m=e(80744),v=e(19448);const l=D=>{const{value:E,src:x,name:P,placeholder:b,onChange:M,onClear:O,mediaType:I,folderName:T,size:C,color:S,maxFiles:A}=D,L=(0,s.of)(u),N=(0,s.$j)(),F=(0,i.createRef)(),w=(0,t.jsx)(v.i,{onChange:M,value:E,mediaType:I,folderName:T,maxFiles:A});let B=x;!B&&E&&(B=(0,p.D)(E));const U=S&&{fill:N.visualization.getColorByName(S)},K=()=>E&&B?(0,t.jsx)(d.y,{src:B,className:L.icon,style:{...U}}):(0,t.jsx)(r.z9,{variant:"primary",fill:"text",size:"sm",children:"Set icon"}),V=()=>(0,t.jsx)(g.C,{children:(0,t.jsx)(a.I,{label:null,grow:!0,children:(0,t.jsx)(c.p,{value:y(x,P),placeholder:b,readOnly:!0,prefix:B&&(0,t.jsx)(d.y,{src:B,className:L.icon,style:{...U}}),suffix:(0,t.jsx)(r.$n,{icon:"times",variant:"secondary",fill:"text",size:"sm",onClick:O})})})});return(0,t.jsx)(o.I,{content:w,children:(H,Y,X)=>(0,t.jsxs)(t.Fragment,{children:[F.current&&(0,t.jsx)(h.A,{...X,referenceElement:F.current,onMouseEnter:H,onKeyDown:J=>{(0,f.Q)(J,Y)}}),(0,t.jsxs)("div",{ref:F,className:L.pointer,onClick:H,onKeyDown:J=>{J.key==="Enter"&&H()},role:"button",tabIndex:0,children:[C===m.Iy.SMALL&&K(),C===m.Iy.NORMAL&&V()]})]})})};function y(D,E){if(D?.startsWith("public/img/icons")){const x=E?.lastIndexOf(".svg")??0;if(x>0)return E.substring(0,x)}return E}const u=D=>({pointer:(0,n.css)`
    cursor: pointer;
    input[readonly] {
      cursor: pointer;
    }
  `,icon:(0,n.css)`
    vertical-align: middle;
    display: inline-block;
    fill: currentColor;
    width: 25px;
  `})},19448:(k,R,e)=>{"use strict";e.d(R,{i:()=>B});var t=e(74848),n=e(32196),i=e(18828),s=e(85690),r=e(93225),g=e(96540),a=e(17172),c=e(40845),o=e(55852),h=e(2913),f=e(80744),d=e(88575),p=e(37270),m=e(47694);function v({secondaryText:K="Drag and drop here or browse"}){const V=(0,c.of)(y);return(0,t.jsxs)("div",{className:V.iconWrapper,children:[(0,t.jsx)("small",{className:V.small,children:K}),(0,t.jsx)(o.$n,{type:"button",icon:"upload",children:"Upload"})]})}const l=({mediaType:K,setFormData:V,setUpload:H,error:Y})=>{const X=(0,c.of)(y),[J,q]=(0,g.useState)(!1),[ae,j]=(0,g.useState)(""),te=()=>(0,t.jsx)(d.D,{label:"Preview",children:(0,t.jsxs)("div",{className:X.iconPreview,children:[K===f.zu.Icon&&(0,t.jsx)(m.y,{src:ae,className:X.img}),K===f.zu.Image&&(0,t.jsx)("img",{src:ae,alt:"Preview of the uploaded file",className:X.img})]})}),ne=z=>{fetch(`/api/storage/delete/upload/${z.file.name}`,{method:"DELETE"}).catch(ee=>console.error("cannot delete file",ee))},le=K==="icon"?{"image/*":[".svg",".xml"]}:{"image/*":[".jpeg",".png",".gif",".webp"]};return(0,t.jsx)(p.gH,{readAs:"readAsBinaryString",onFileRemove:ne,options:{accept:le,multiple:!1,onDrop:z=>{let ee=new FormData;ee.append("file",z[0]),j(URL.createObjectURL(z[0])),q(!0),V(ee),H(!0)}},children:Y.message!==""&&J?(0,t.jsx)("p",{children:Y.message}):J?(0,t.jsx)(te,{}):(0,t.jsx)(v,{})})};function y(K,V){return{container:(0,n.css)`
      display: flex;
      flex-direction: column;
      width: 100%;
    `,dropzone:(0,n.css)`
      display: flex;
      flex: 1;
      flex-direction: column;
      align-items: center;
      padding: ${K.spacing(6)};
      border-radius: 2px;
      border: 2px dashed ${K.colors.border.medium};
      background-color: ${V?K.colors.background.secondary:K.colors.background.primary};
      cursor: pointer;
    `,iconWrapper:(0,n.css)`
      display: flex;
      flex-direction: column;
      align-items: center;
    `,acceptMargin:(0,n.css)`
      margin: ${K.spacing(2,0,1)};
    `,small:(0,n.css)`
      color: ${K.colors.text.secondary};
      margin-bottom: ${K.spacing(2)};
    `,iconContainer:(0,n.css)`
      display: flex;
      flex-direction: column;
      width: 80%;
      align-items: center;
      align-self: center;
    `,iconPreview:(0,n.css)`
      width: 238px;
      height: 198px;
      border: 1px solid ${K.colors.border.medium};
      display: flex;
      align-items: center;
      justify-content: center;
    `,img:(0,n.css)`
      width: 147px;
      height: 147px;
      fill: ${K.colors.text.primary};
    `}}var u=e(90182),D=e(67647),E=e(31193),x=e(70713),P=e(91793);const b=(0,g.memo)(function(V){const{columnIndex:H,rowIndex:Y,style:X,data:J}=V,{cards:q,columnCount:ae,onChange:j,selected:te}=J,ne=H+Y*ae,le=q[ne],z=(0,c.of)(O);return(0,t.jsx)("div",{style:X,children:le&&(0,t.jsxs)("div",{className:te===le.value?(0,n.cx)(z.card,z.selected):z.card,onClick:()=>j(le.value),onKeyDown:ee=>{ee.key==="Enter"&&j(le.value)},role:"button",tabIndex:0,children:[le.imgUrl.endsWith(".svg")?(0,t.jsx)(m.y,{src:le.imgUrl,className:z.img}):(0,t.jsx)("img",{src:le.imgUrl,alt:"",className:z.img}),(0,t.jsx)("h6",{className:z.text,children:le.label.slice(0,-4)})]},le.value)})},P.t7),M=K=>{const{onChange:V,cards:H,value:Y}=K,X=(0,c.of)(O);return(0,t.jsx)(x.Ay,{defaultWidth:680,children:({width:J,height:q})=>{const te=Math.floor(J/90),ne=Math.ceil(H.length/te);return(0,t.jsx)(P.yi,{width:J,height:q,columnCount:te,columnWidth:90,rowCount:ne,rowHeight:90,itemData:{cards:H,columnCount:te,onChange:V,selected:Y},className:X.grid,children:b})}})},O=K=>({card:(0,n.css)`
    display: inline-block;
    width: 90px;
    height: 90px;
    margin: 0.75rem;
    margin-left: 15px;
    text-align: center;
    cursor: pointer;
    position: relative;
    background-color: transparent;
    border: 1px solid transparent;
    border-radius: 8px;
    padding-top: 6px;
    :hover {
      border-color: ${K.colors.action.hover};
      box-shadow: ${K.shadows.z2};
    }
  `,selected:(0,n.css)`
    border: 2px solid ${K.colors.primary.main};
    :hover {
      border-color: ${K.colors.primary.main};
    }
  `,img:(0,n.css)`
    width: 40px;
    height: 40px;
    object-fit: cover;
    vertical-align: middle;
    fill: ${K.colors.text.primary};
  `,text:(0,n.css)`
    color: ${K.colors.text.primary};
    white-space: nowrap;
    font-size: 12px;
    text-overflow: ellipsis;
    display: block;
    overflow: hidden;
  `,grid:(0,n.css)`
    border: 1px solid ${K.colors.border.medium};
  `}),I=K=>K===f.zu.Icon?[f.Iu.Icon,f.Iu.IOT,f.Iu.Marker]:[f.Iu.BG],T=(K,V)=>K.find(H=>V.startsWith(H.value))??K[0],C=K=>{const{value:V,mediaType:H,folderName:Y,newValue:X,setNewValue:J,maxFiles:q}=K,ae=(0,c.of)(S),j=I(H).map(ce=>({label:ce,value:ce})),[te,ne]=(0,g.useState)(),[le,z]=(0,g.useState)(T(j,V?.length?V:Y)),[ee,se]=(0,g.useState)([]),[ie,Z]=(0,g.useState)([]),oe=ce=>{ce?(ce=ce.toLowerCase(),Z(ee.filter(ye=>ye.search.includes(ce)))):Z(ee)};return(0,g.useEffect)(()=>{const ce=le?.value;if(ce){const ye=H===f.zu.Icon?re=>re.name.endsWith(".svg"):re=>re.name.endsWith(".png")||re.name.endsWith(".gif");(0,E.tR)().get("-- Grafana --").then(re=>{re.listFiles(ce,q).subscribe({next:ue=>{const De=[];ue.forEach(ge=>{if(ye(ge)){const Te=ge.name.lastIndexOf(".");De.push({value:`${ce}/${ge.name}`,label:ge.name,search:(Te?ge.name.substring(0,Te):ge.name).toLowerCase(),imgUrl:`public/${ce}/${ge.name}`})}}),se(De),Z(De)}})})}},[H,le,q]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.D,{children:(0,t.jsx)(u.l6,{options:j,onChange:z,value:le,menuShouldPortal:!1})}),(0,t.jsx)(d.D,{children:(0,t.jsx)(D.Z,{value:te??"",placeholder:"Search",onChange:ce=>{oe(ce),ne(ce)}})}),ie&&(0,t.jsx)("div",{className:ae.cardsWrapper,children:(0,t.jsx)(M,{cards:ie,onChange:ce=>J(ce),value:X})})]})},S=K=>({cardsWrapper:(0,n.css)`
    height: 30vh;
    min-height: 50px;
    margin-top: 5px;
    max-width: 680px;
  `});var A=e(10354),L=e(60029),N=e(21813);const F=K=>{const{newValue:V,setNewValue:H,mediaType:Y}=K,X=(0,c.of)(w),J=(0,N.D)(V);let q=V?.substring(V.lastIndexOf("/")+1,V.lastIndexOf("."));return q.length>20&&(q=q.substring(0,20)+"..."),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.D,{children:(0,t.jsx)(A.p,{onChange:ae=>H(ae.currentTarget.value),value:V})}),(0,t.jsxs)("div",{className:X.iconContainer,children:[(0,t.jsx)(d.D,{label:"Preview",children:(0,t.jsxs)("div",{className:X.iconPreview,children:[Y===f.zu.Icon&&(0,t.jsx)(m.y,{src:J,className:X.img}),Y===f.zu.Image&&V&&(0,t.jsx)("img",{src:J,alt:"Preview of the selected URL",className:X.img})]})}),(0,t.jsx)(L.J,{children:q})]})]})},w=K=>({iconContainer:(0,n.css)`
    display: flex;
    flex-direction: column;
    width: 80%;
    align-items: center;
    align-self: center;
  `,iconPreview:(0,n.css)`
    width: 238px;
    height: 198px;
    border: 1px solid ${K.colors.border.medium};
    display: flex;
    align-items: center;
    justify-content: center;
  `,img:(0,n.css)`
    width: 147px;
    height: 147px;
    fill: ${K.colors.text.primary};
  `}),B=K=>{const{value:V,onChange:H,mediaType:Y,folderName:X,maxFiles:J}=K,q=(0,c.of)(U),ae=()=>{H(V)},j=(0,g.createRef)(),{dialogProps:te}=(0,i.s)({},j),{overlayProps:ne}=(0,r.e)({onClose:ae,isDismissable:!0,isOpen:!0},j),le=V&&V.includes("://"),[z,ee]=(0,g.useState)(V??""),[se,ie]=(0,g.useState)(le?f.QC.URL:f.QC.Folder),[Z,oe]=(0,g.useState)(new FormData),[ce,ye]=(0,g.useState)(!1),[re,ue]=(0,g.useState)({message:""}),De=je=>`${q.resourcePickerPopoverTab} ${se===je&&q.resourcePickerPopoverActiveTab}`,ge=()=>(0,t.jsx)(C,{value:V,mediaType:Y,folderName:X,newValue:z,setNewValue:ee,maxFiles:J}),Te=()=>(0,t.jsx)(F,{newValue:z,setNewValue:ee,mediaType:Y}),Le=()=>(0,t.jsx)(l,{mediaType:Y,setFormData:oe,setUpload:ye,newValue:z,error:re}),Ye=()=>{switch(se){case f.QC.Folder:return ge();case f.QC.URL:return Te();case f.QC.Upload:return Le();default:return ge()}};return(0,t.jsx)(s.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,t.jsx)("section",{ref:j,...ne,...te,children:(0,t.jsxs)("div",{className:q.resourcePickerPopover,children:[(0,t.jsxs)("div",{className:q.resourcePickerPopoverTabs,children:[(0,t.jsx)("button",{className:De(f.QC.Folder),onClick:()=>ie(f.QC.Folder),children:"Folder"}),(0,t.jsx)("button",{className:De(f.QC.URL),onClick:()=>ie(f.QC.URL),children:"URL"})]}),(0,t.jsxs)("div",{className:q.resourcePickerPopoverContent,children:[Ye(),(0,t.jsxs)("div",{className:q.buttonRow,children:[(0,t.jsx)(o.$n,{variant:"secondary",onClick:()=>ae(),fill:"outline",children:"Cancel"}),(0,t.jsx)(o.$n,{variant:z&&z!==V?"primary":"secondary",onClick:()=>{ce?fetch("/api/storage/upload",{method:"POST",body:Z}).then(je=>{if(je.status>=400){je.json().then(Ze=>ue(Ze));return}else return je.json()}).then(je=>{(0,a.AI)().get(`api/storage/read/${je.path}`).then(()=>ee(`${h.config.appUrl}api/storage/read/${je.path}`)).then(()=>H(`${h.config.appUrl}api/storage/read/${je.path}`))}).catch(je=>console.error(je)):H(z)},children:"Select"})]})]})]})})})},U=K=>({resourcePickerPopover:(0,n.css)`
    border-radius: ${K.shape.radius.default};
    box-shadow: ${K.shadows.z3};
    background: ${K.colors.background.primary};
    border: 1px solid ${K.colors.border.weak};
  `,resourcePickerPopoverTab:(0,n.css)`
    width: 50%;
    text-align: center;
    padding: ${K.spacing(1,0)};
    background: ${K.colors.background.secondary};
    color: ${K.colors.text.secondary};
    font-size: ${K.typography.bodySmall.fontSize};
    cursor: pointer;
    border: none;

    &:focus:not(:focus-visible) {
      outline: none;
      box-shadow: none;
    }

    :focus-visible {
      position: relative;
    }
  `,resourcePickerPopoverActiveTab:(0,n.css)`
    color: ${K.colors.text.primary};
    font-weight: ${K.typography.fontWeightMedium};
    background: ${K.colors.background.primary};
  `,resourcePickerPopoverContent:(0,n.css)`
    width: 315px;
    font-size: ${K.typography.bodySmall.fontSize};
    min-height: 184px;
    padding: ${K.spacing(1)};
    display: flex;
    flex-direction: column;
  `,resourcePickerPopoverTabs:(0,n.css)`
    display: flex;
    width: 100%;
    border-radius: ${K.shape.radius.default} ${K.shape.radius.default} 0 0;
  `,buttonRow:(0,n.css)({display:"flex",justifyContent:"center",gap:K.spacing(2),padding:K.spacing(1)})})},63577:(k,R,e)=>{"use strict";e.d(R,{MediaType:()=>t.zu,ResourceFolderName:()=>t.Iu,findField:()=>r.UI,findFieldIndex:()=>r.gG,getColorDimension:()=>g,getPublicOrAbsoluteUrl:()=>m.D,getResourceDimension:()=>m.$,getScalarDimension:()=>l.H,getScaledDimension:()=>c.hX,getScaledDimensionForField:()=>c.qx,getTextDimension:()=>d});var t=e(80744),n=e(8066),i=e(58563),s=e(57875),r=e(33924);function g(y,u,D){return a((0,r.UI)(y,u.field),u,D)}function a(y,u,D){if(!y){const P=D.visualization.getColorByName(u.fixed??"grey");return{isAssumed:!!u.field?.length||!u.fixed,fixed:P,value:()=>P,get:b=>P}}const E=(0,n.Qi)(y);if(E.isByValue||y.config.mappings?.length){const P=(0,i.xg)(y,!0);P!==y.config&&(y={...y,config:P},y.state=void 0);const b=(0,s.J)({field:y,theme:D}),M=O=>b(O).color??"#ccc";return{field:y,get:O=>M(y.values[O]),value:()=>M((0,r.sB)(y))}}const x=E.getCalculator(y,D)(0,0);return{fixed:x,value:()=>x,get:P=>x,field:y}}var c=e(18379),o=e(11261),h=e(83195),f=e(52622);function d(y,u){const D=u.field?(0,r.UI)(y,u.field):y?.fields.find(E=>E.type===o.PU.string);return p(D,u)}function p(y,u){let D=u.fixed;const E=u.mode??f.RU.Fixed;if(E===f.RU.Fixed)return{isAssumed:!D,fixed:D,value:()=>D,get:P=>D};if(E===f.RU.Template){const P=b=>`TEMPLATE[${u.fixed} // ${b}]`;return y?{field:y,get:b=>P(y.values[b]),value:()=>P((0,r.sB)(y))}:(D=P(""),{isAssumed:!0,fixed:D,value:()=>D,get:b=>D})}if(!y)return{isAssumed:!0,fixed:D,value:()=>D,get:P=>D};let x=P=>(0,h.cN)(y.display(P));return{field:y,get:P=>x(y.values[P]),value:()=>x((0,r.sB)(y))}}var m=e(21813),v=e(38074),l=e(26781)},21813:(k,R,e)=>{"use strict";e.d(R,{$:()=>s,D:()=>i});var t=e(52622),n=e(33924);function i(r){return r?r.indexOf(":/")>0?r:window.__grafana_public_path__+r:""}function s(r,g){const a=g.mode??t.q_.Fixed;if(a===t.q_.Fixed){const h=i(g.fixed);return{isAssumed:!h,fixed:h,value:()=>h,get:f=>h}}const c=(0,n.UI)(r,g.field);if(!c){const h="";return{isAssumed:!0,fixed:h,value:()=>h,get:f=>h}}if(a===t.q_.Mapping){const h=f=>i(`${f}`);return{field:c,get:f=>h(c.values[f]),value:()=>h((0,n.sB)(c))}}const o=h=>{if(c&&c.display){const f=c.display(h).icon;return i(f??"")}return""};return{field:c,get:h=>o(c.values[h]),value:()=>o((0,n.sB)(c))}}},26781:(k,R,e)=>{"use strict";e.d(R,{H:()=>i});var t=e(52622),n=e(33924);function i(r,g){return s((0,n.UI)(r,g?.field),g)}function s(r,g){if(!r){const o=g.fixed??0;return{isAssumed:!!g.field?.length||!g.fixed,fixed:o,value:()=>o,get:()=>o}}let a=o=>o%g.max;return g.mode===t.WQ.Clamped&&(a=o=>o<g.min?g.min:o>g.max?g.max:o),{field:r,get:o=>{const h=r.values[o];return h===null||typeof h!="number"?0:a(h)},value:()=>(0,n.sB)(r)}}},18379:(k,R,e)=>{"use strict";e.d(R,{Nn:()=>g,Ru:()=>a,hX:()=>s,qx:()=>r});var t=e(58563),n=e(52622),i=e(33924);function s(c,o){return r((0,i.UI)(c,o?.field),o)}function r(c,o,h){if(!c){const l=o.fixed??0;return{isAssumed:!!o.field?.length||!o.fixed,fixed:l,value:()=>l,get:()=>l}}const f=(0,t.AP)(c),d=o.max-o.min;if(c.values.length<1||d<=0||f.delta<=0)return{fixed:o.min,value:()=>o.min,get:()=>o.min};let m=l=>o.min+l*d;if(h===n.QH.Quad){const l=Math.PI*(o.max/2)**2,y=Math.PI*(o.min/2)**2,u=l-y;m=D=>{let E=y+u*D;return Math.sqrt(E/Math.PI)*2}}const v=l=>{const y=c.values[l];let u=0;return y!==-1/0&&(u=(y-f.min)/f.delta),u>1?u=1:u<0&&(u=0),m(u)};return{get:v,value:()=>v((0,i.sB)(c)),field:c}}function g(c){return c||(c={min:0,max:1}),c.min==null&&(c.min=0),c.max==null&&(c.max=1),c}function a(c,o){let{min:h,max:f}=g(o);if(c||(c={}),c.max==null&&(c.max=f),c.min==null&&(c.min=h),c.min>c.max){const d=c.max;c.max=c.min,c.min=d}return c.min<h&&(c.min=h),c.max>f&&(c.max=f),c.fixed==null&&(c.fixed=c.min+(c.max-c.min)/2),c.field||(c.fixed>f?c.fixed=f:c.fixed<h&&(c.fixed=h)),c}},80744:(k,R,e)=>{"use strict";e.d(R,{Iu:()=>i,Iy:()=>g,QC:()=>r,nG:()=>n,zu:()=>s});var t=e(52622);const n=Object.freeze({fixed:"",mode:t.RU.Field,field:""});var i=(a=>(a.Icon="img/icons/unicons",a.IOT="img/icons/iot",a.Marker="img/icons/marker",a.BG="img/bg",a))(i||{}),s=(a=>(a.Icon="icon",a.Image="image",a))(s||{}),r=(a=>(a.Folder="folder",a.URL="url",a.Upload="upload",a))(r||{}),g=(a=>(a.SMALL="small",a.NORMAL="normal",a))(g||{})},33924:(k,R,e)=>{"use strict";e.d(R,{B_:()=>o,UI:()=>f,Wb:()=>g,XV:()=>a,b5:()=>c,gG:()=>d,sB:()=>p,wv:()=>h});var t=e(28240),n=e(75059),i=e(32264),s=e(63577),r=e(26781);function g(m,v){if(m?.series&&v.field)for(const l of m.series){const y=(0,s.getColorDimension)(l,v,i.$.theme2);if(!y.isAssumed||m.series.length===1)return y}return(0,s.getColorDimension)(void 0,v,i.$.theme2)}function a(m,v){if(m?.series&&v.field)for(const l of m.series){const y=(0,s.getScaledDimension)(l,v);if(!y.isAssumed||m.series.length===1)return y}return(0,s.getScaledDimension)(void 0,v)}function c(m,v){if(m?.series&&v.field)for(const l of m.series){const y=(0,r.H)(l,v);if(!y.isAssumed||m.series.length===1)return y}return(0,r.H)(void 0,v)}function o(m,v){if(m?.series&&v.field)for(const l of m.series){const y=(0,s.getResourceDimension)(l,v);if(!y.isAssumed||m.series.length===1)return y}return(0,s.getResourceDimension)(void 0,v)}function h(m,v){if(m?.series&&v.field)for(const l of m.series){const y=(0,s.getTextDimension)(l,v);if(!y.isAssumed||m.series.length===1)return y}return(0,s.getTextDimension)(void 0,v)}function f(m,v){const l=d(v,m);return l==null?void 0:m.fields[l]}function d(m,v,l){if(!(!v||!m?.length))for(let y=0;y<v.fields.length;y++){const u=v.fields[y];if(m===u.name)return y;const D=(0,t.Ct)(u,v,l);if(m===D)return y}}function p(m){const v=m.state?.calcs;if(v){const u=v[n.gy.lastNotNull];if(u!=null)return u}const l=m.values;let y=l.length-1;for(;y>=0;){const u=l[y--];if(u!=null)return u}}},9791:(k,R,e)=>{"use strict";e.d(R,{k:()=>b});var t=e(74848),n=e(2543),i=e(96540),s=e(28528),r=e(24293),g=e(90708),a=e(28240),c=e(94624),o=e(24308),h=e(52622),f=e(40845),d=e(79041),p=e(41706),m=e(91126),v=e(33368),l=e(1932);function y(M,O,I){return(0,l.jM)(M,T=>{T.defaults.custom===void 0&&(T.defaults.custom={}),T.defaults.max=I;const{custom:C}=T.defaults;switch(C.stacking===void 0&&(C.stacking={group:"A"}),O){case"lines":C.drawStyle=h.GR.Line,C.stacking.mode=h.gs.None,C.fillOpacity=0;break;case"bars":C.drawStyle=h.GR.Bars,C.stacking.mode=h.gs.None,C.fillOpacity=100;break;case"points":C.drawStyle=h.GR.Points,C.stacking.mode=h.gs.None,C.fillOpacity=0;break;case"stacked_lines":C.drawStyle=h.GR.Line,C.stacking.mode=h.gs.Normal,C.fillOpacity=100,C.axisSoftMin=0;break;case"stacked_bars":C.drawStyle=h.GR.Bars,C.stacking.mode=h.gs.Normal,C.fillOpacity=100,C.axisSoftMin=0;break;default:{const S=O;throw new Error(`Invalid graph-style: ${S}`)}}})}function u(M,O,I){return(0,l.jM)(M,T=>{T.defaults.thresholds=I,T.defaults.custom=T.defaults.custom??{},T.defaults.custom.thresholdsStyle=O})}var D=e(56737),E=e(84596),x=e(21423);function P(M){const[O,{inc:I}]=(0,D.A)(1),T=(0,E.A)(M);return(0,i.useMemo)(()=>{T&&!(0,x.J3)(M,T,x.bW)&&I()},[M,T,I]),O}function b({data:M,height:O,width:I,timeZone:T,timeRange:C,onChangeTime:S,loadingState:A,annotations:L,onHiddenSeriesChanged:N,splitOpenFn:F,graphStyle:w,tooltipDisplayMode:B=h.$N.Single,anchorToZero:U=!1,yAxisMaximum:K,thresholdsConfig:V,thresholdsStyle:H,eventBus:Y,vizLegendOverrides:X,toggleLegendRef:J}){const q=(0,f.$j)(),ae=(0,i.useMemo)(()=>(0,s.O)((0,p.V)(p.S),"Explore"),[]),[j,te]=(0,i.useState)({defaults:{min:U?0:void 0,max:K||void 0,unit:"short",color:{mode:r.Y.PaletteClassic},custom:{drawStyle:h.GR.Line,fillOpacity:0,pointSize:5}},overrides:[]}),ne=(0,i.useMemo)(()=>{const re=y(j,w,K);return u(re,H,V)},[j,w,K,V,H]),le=(0,v.h)(F,C),z=(0,i.useMemo)(()=>(0,g.we)({fieldConfig:ne,data:M,timeZone:T,replaceVariables:re=>re,theme:q,fieldConfigRegistry:ae,dataLinkPostProcessor:le}),[ae,M,T,q,ne,le]),ee=(0,i.useMemo)(()=>(0,g.we)({fieldConfig:{defaults:{},overrides:[]},data:L,timeZone:T,replaceVariables:re=>re,theme:q,dataLinkPostProcessor:le}),[L,T,q,le]),se=P(z),ie=(0,i.useRef)(N),Z=(0,i.useRef)(void 0);(0,i.useEffect)(()=>{if(ie.current){const re=[];z.forEach(ue=>{ue.fields.map(ge=>ge.config?.custom?.hideFrom?.viz).every(n.identity)&&re.push((0,a.Ri)(ue))}),(Z.current===void 0||!(0,n.isEqual)((0,n.sortBy)(re),(0,n.sortBy)(Z.current)))&&(Z.current=re,ie.current(re))}},[z]);const oe={eventsScope:"explore",eventBus:Y,sync:()=>c.y.Off,onToggleSeriesVisibility(re,ue){te((0,m.M)(re,ue,j,M))},dataLinkPostProcessor:le};function ce(re,ue){te((0,m.M)(re,ue,j,M))}J&&(J.current=ce);const ye=(0,i.useMemo)(()=>({tooltip:{mode:B,sort:h.xB.None},legend:{displayMode:h.lm.List,showLegend:!0,placement:"bottom",calcs:[],...X}}),[B,X]);return(0,t.jsx)(d.XF,{value:oe,children:(0,t.jsx)(o.m,{data:{series:z,timeRange:C,state:A,annotations:ee,structureRev:se},pluginId:"timeseries",title:"",width:I,height:O,onChangeTimeRange:S,timeZone:T,options:ye})})}},72519:(k,R,e)=>{"use strict";e.d(R,{y:()=>M});var t=e(74848),n=e(32196),i=e(96540),s=e(42941),r=e(40845),g=e(91052),a=e(14578),c=e(56034),o=e(55852),h=e(8484),f=e(34028),d=e(9791),p=e(94354),m=e(31678);const v=m.EXPLORE_GRAPH_STYLES.map(I=>({value:I,label:I[0].toUpperCase()+I.slice(1).replace(/_/," ")}));function l(I){const{graphStyle:T,onChangeGraphStyle:C}=I;return(0,t.jsx)(p.z,{size:"sm",options:v,value:T,onChange:C})}var y=e(33390);const u="grafana.explore.style.graph",D=I=>{store.set(u,I)},E=()=>P(y.A.get(u)),x="lines",P=I=>m.EXPLORE_GRAPH_STYLES.find(C=>C===I)??x,b=20,M=({data:I,eventBus:T,height:C,width:S,timeRange:A,timeZone:L,annotations:N,onChangeTime:F,splitOpenFn:w,thresholdsConfig:B,thresholdsStyle:U,loadingState:K,statusMessage:V})=>{const[H,Y]=(0,s.A)(!1),[X,J]=(0,i.useState)(E),q=(0,r.of)(O),ae=(0,i.useCallback)(te=>{(0,f.ng)(te),J(te)},[]),j=(0,i.useMemo)(()=>H?I:I.slice(0,b),[I,H]);return(0,t.jsx)(g.NR,{title:(0,h.t)("graph.container.title","Graph"),titleItems:[!H&&b<I.length&&(0,t.jsxs)("div",{className:q.timeSeriesDisclaimer,children:[(0,t.jsxs)("span",{className:q.warningMessage,children:[(0,t.jsx)(a.I,{name:"exclamation-triangle","aria-hidden":"true"}),(0,t.jsxs)(h.x6,{i18nKey:"graph.container.show-only-series",children:["Showing only ",{MAX_NUMBER_OF_TIME_SERIES:b}," series"]})]}),(0,t.jsx)(c.m,{content:(0,h.t)("graph.container.content","Rendering too many series in a single panel may impact performance and make data harder to read. Consider refining your queries."),children:(0,t.jsx)(o.$n,{variant:"secondary",size:"sm",onClick:Y,children:(0,t.jsxs)(h.x6,{i18nKey:"graph.container.show-all-series",children:["Show all ",{length:I.length}]})})})]},"disclaimer")].filter(Boolean),width:S,height:C,loadingState:K,statusMessage:V,actions:(0,t.jsx)(l,{graphStyle:X,onChangeGraphStyle:ae}),children:(te,ne)=>(0,t.jsx)(d.k,{graphStyle:X,data:j,height:ne,width:te,timeRange:A,onChangeTime:F,timeZone:L,annotations:N,splitOpenFn:w,loadingState:K,thresholdsConfig:B,thresholdsStyle:U,eventBus:T})})},O=I=>({timeSeriesDisclaimer:(0,n.css)({label:"time-series-disclaimer",display:"flex",alignItems:"center",gap:I.spacing(1)}),warningMessage:(0,n.css)({display:"flex",alignItems:"center",gap:I.spacing(.5),color:I.colors.warning.main,fontSize:I.typography.bodySmall.fontSize})})},97186:(k,R,e)=>{"use strict";e.d(R,{$:()=>t,r:()=>n});const t={showLabels:"grafana.explore.logs.showLabels",showTime:"grafana.explore.logs.showTime",wrapLogMessage:"grafana.explore.logs.wrapLogMessage",prettifyLogMessage:"grafana.explore.logs.prettifyLogMessage",logsSortOrder:"grafana.explore.logs.sortOrder",logContextWrapLogMessage:"grafana.explore.logs.logContext.wrapLogMessage"},n="grafana.explore.logs.visualisationType"},9651:(k,R,e)=>{"use strict";e.d(R,{a:()=>a,d:()=>c});var t=e(74848),n=e(32196),i=e(75212),s=e(40845),r=e(9663);const g=(o,h)=>({valueNavigation:(0,n.css)`
      width: ${r.QH};
      font-weight: bold;
    `,valueNavigationWrapper:(0,n.css)`
      display: flex;
      justify-content: flex-end;
    `,itemLabelsWrap:(0,n.css)`
      ${h?"":`border-bottom: 1px solid ${o.colors.border.medium}`};
    `}),a=o=>o.includes(i.gs)?o.replace(i.gs,""):o,c=({valueLabels:o,expanded:h})=>{const f=(0,s.of)(g,h);return(0,t.jsx)("div",{className:f.itemLabelsWrap,children:(0,t.jsx)("div",{className:f.valueNavigationWrapper,children:o.map((d,p)=>(0,t.jsx)("span",{className:f.valueNavigation,children:a(d.name)},d.name))})})}},9663:(k,R,e)=>{"use strict";e.d(R,{Ay:()=>E,QH:()=>v,Jd:()=>l});var t=e(74848),n=e(32196),i=e(73287),s=e(14110),r=e(40845),g=e(29158),a=e(9651),c=e(57408);const o=(x,P)=>({rowWrapper:(0,n.css)`
    position: relative;
    min-width: ${v};
    padding-right: 5px;
  `,rowValue:(0,n.css)`
    white-space: nowrap;
    overflow-x: auto;
    -ms-overflow-style: none; /* IE and Edge */
    scrollbar-width: none; /* Firefox */
    display: block;
    padding-right: 10px;

    &::-webkit-scrollbar {
      display: none; /* Chrome, Safari and Opera */
    }

    &:before {
      pointer-events: none;
      content: '';
      width: 100%;
      height: 100%;
      position: absolute;
      left: 0;
      top: 0;
      background: linear-gradient(to right, transparent calc(100% - 25px), ${x.colors.background.primary});
    }
  `,rowValuesWrap:(0,n.css)`
    padding-left: ${l};
    width: calc(${P} * ${v});
    display: flex;
  `}),h=({totalNumberOfValues:x,values:P,hideFieldsWithoutValues:b})=>{const M=(0,r.of)(o,x);return(0,t.jsx)("div",{role:"cell",className:M.rowValuesWrap,children:P?.map(O=>b&&(O.value===void 0||O.value===c.M)?null:(0,t.jsx)("span",{className:M.rowWrapper,children:(0,t.jsx)("span",{className:M.rowValue,children:O.value})},O.key))})},f=x=>{const P=x.isDark?"#ce9178":"#a31515",b=x.isDark?"#73bf69":"#56a64b";return{metricName:(0,n.css)`
      color: ${b};
    `,metricValue:(0,n.css)`
      color: ${P};
    `,expanded:(0,n.css)`
      display: block;
      text-indent: 1em;
    `}},p=({value:x,index:P,length:b,isExpandedView:M})=>{const O=(0,r.of)(f),I=x.key,T=x.value;return(0,t.jsxs)("span",{className:M?O.expanded:"",children:[(0,t.jsx)("span",{className:O.metricName,children:I}),(0,t.jsx)("span",{children:"="}),(0,t.jsx)("span",{children:'"'}),(0,t.jsx)("span",{className:O.metricValue,children:T}),(0,t.jsx)("span",{children:'"'}),P<b-1&&(0,t.jsx)("span",{children:", "})]},P)},m="20px",v="80px",l="25px",y=(x,P,b)=>({rowWrapper:(0,n.css)`
    border-bottom: 1px solid ${x.colors.border.medium};
    display: flex;
    position: relative;
    padding-left: 22px;
    ${b?"":"align-items: center;"}
    ${b?"":"height: 100%;"}
  `,copyToClipboardWrapper:(0,n.css)`
    position: absolute;
    left: 0;
    ${b?"":"bottom: 0;"}
    ${b?"top: 4px;":"top: 0;"}
    margin: auto;
    z-index: 1;
    height: 16px;
    width: 16px;
  `,rowLabelWrapWrap:(0,n.css)`
    position: relative;
    width: calc(100% - (${P} * ${v}) - ${l});
  `,rowLabelWrap:(0,n.css)`
    white-space: nowrap;
    overflow-x: auto;
    -ms-overflow-style: none; /* IE and Edge */
    scrollbar-width: none; /* Firefox */
    padding-right: ${m};

    &::-webkit-scrollbar {
      display: none; /* Chrome, Safari and Opera */
    }

    &:after {
      pointer-events: none;
      content: '';
      width: 100%;
      height: 100%;
      position: absolute;
      left: 0;
      top: 0;
      background: linear-gradient(
        to right,
        transparent calc(100% - ${m}),
        ${x.colors.background.primary}
      );
    }
  `});function u(x){let P=[],b=[];for(const M in x)M in x&&x[M]&&!M.includes("Value")?P.push({key:M,value:x[M]}):M in x&&x[M]&&M.includes("Value")&&b.push({key:M,value:x[M]});return{values:b,attributeValues:P}}const E=({listItemData:x,listKey:P,totalNumberOfValues:b,valueLabels:M,isExpandedView:O})=>{const{__name__:I,...T}=x,[C,S]=(0,i.A)(),A=M?.length??b,L=(0,r.of)(y,A,O),{values:N,attributeValues:F}=u(T),w=K=>K==="\u221E"||K==="Infinity"?"+Inf":K,B=`${I}{${F.map(K=>`${K.key}="${w(K.value)}"`)}}`,U=!!(M&&M?.length);return(0,t.jsxs)(t.Fragment,{children:[M!==void 0&&O&&(0,t.jsx)(a.d,{valueLabels:M,expanded:O}),(0,t.jsxs)("div",{className:L.rowWrapper,children:[(0,t.jsx)("span",{className:L.copyToClipboardWrapper,children:(0,t.jsx)(g.K,{tooltip:"Copy to clipboard",onClick:()=>{(0,s.rR)("grafana_explore_prometheus_instant_query_ui_raw_toggle_expand"),S(B)},name:"copy"})}),(0,t.jsx)("span",{role:"cell",className:L.rowLabelWrapWrap,children:(0,t.jsxs)("div",{className:L.rowLabelWrap,children:[(0,t.jsx)("span",{children:I}),(0,t.jsx)("span",{children:"{"}),(0,t.jsx)("span",{children:F.map((K,V)=>(0,t.jsx)(p,{isExpandedView:O,value:K,index:V,length:F.length},V))}),(0,t.jsx)("span",{children:"}"})]})}),(0,t.jsx)(h,{hideFieldsWithoutValues:U,totalNumberOfValues:A,values:N})]},P)]})}},57408:(k,R,e)=>{"use strict";e.d(R,{E:()=>i,M:()=>n});var t=e(83195);const n=" ",i=s=>{const r={},g=[],a=s.fields.filter(h=>!["Time"].includes(h.name));let c=a.find(h=>h.name==="__name__")?.values??[];!c.length&&a.length&&a[0].values.length&&(c=Array(a[0].values.length).fill(""));const o=s.fields.filter(h=>!["__name__"].includes(h.name));return c.forEach(function(h,f){r[h]={};const d=r[h][f]??{};for(const p of o){const m=p.name;if(m!=="Time")if(typeof p?.display=="function"){const v=p?.display(p.values[f]);if(!isNaN(v.numeric))d[m]=v.numeric.toString(10);else{const l=(0,t.cN)(v);l?d[m]=l:m.includes("Value #")&&(d[m]=n)}}else console.warn("Field display method is missing!")}g.push({...d,__name__:h})}),g}},97814:(k,R,e)=>{"use strict";e.d(R,{g:()=>i});var t=e(74848),n=e(47232);const i=({timeInMs:r,className:g,humanize:a})=>(0,t.jsx)("span",{className:g,children:s(r,a)}),s=(r,g=!1)=>{const a=r/1e3;if(!g)return`${a.toFixed(1)}s`;const c=(0,n.Ah)(a,"seconds"),o=c.hours(),h=c.minutes(),f=c.seconds();return o?`${o}h ${h}m ${f}s`:h?`${h}m ${f}s`:`${f}s`}},92599:(k,R,e)=>{"use strict";e.d(R,{V:()=>pe});var t=e(74848),n=e(32196),i=e(96540),s=e(42941),r=e(41987),g=e(6709);function a(me){if(me?.tracesToLogsV2)return me.tracesToLogsV2;if(!me?.tracesToLogs)return;const ve={customQuery:!1};return ve.datasourceUid=me.tracesToLogs.datasourceUid,ve.tags=me.tracesToLogs.mapTagNamesEnabled?me.tracesToLogs.mappedTags:me.tracesToLogs.tags?.map(Se=>({key:Se})),ve.filterByTraceID=me.tracesToLogs.filterByTraceID,ve.filterBySpanID=me.tracesToLogs.filterBySpanID,ve.spanStartTimeShift=me.tracesToLogs.spanStartTimeShift,ve.spanEndTimeShift=me.tracesToLogs.spanEndTimeShift,ve}function c({options:me,onOptionsChange:ve}){const Se=["loki","elasticsearch","grafana-splunk-datasource","grafana-opensearch-datasource","grafana-falconlogscale-datasource","googlecloud-logging-datasource"],Ie=useMemo(()=>a(me.jsonData)||{customQuery:!1},[me.jsonData]),{query:Oe="",tags:Re,customQuery:he}=Ie,Ce=useCallback(We=>{ve({...me,jsonData:{...me.jsonData,tracesToLogsV2:{...Ie,...We},tracesToLogs:void 0}})},[ve,me,Ie]);return jsxs("div",{className:css({width:"100%"}),children:[jsx(InlineFieldRow,{children:jsx(InlineField,{tooltip:"The logs data source the trace is going to navigate to",label:"Data source",labelWidth:26,children:jsx(DataSourcePicker,{inputId:"trace-to-logs-data-source-picker",filter:We=>Se.includes(We.type),current:Ie.datasourceUid,noDefault:!0,width:40,onChange:We=>Ce({datasourceUid:We.uid})})})}),jsx(InlineFieldRow,{children:jsx(IntervalInput,{label:h("start"),tooltip:f("start","0"),value:Ie.spanStartTimeShift||"",onChange:We=>{Ce({spanStartTimeShift:We})},isInvalidError:d})}),jsx(InlineFieldRow,{children:jsx(IntervalInput,{label:h("end"),tooltip:f("end","0"),value:Ie.spanEndTimeShift||"",onChange:We=>{Ce({spanEndTimeShift:We})},isInvalidError:d})}),jsx(InlineFieldRow,{children:jsx(InlineField,{tooltip:"Tags that will be used in the query. Default tags: 'cluster', 'hostname', 'namespace', 'pod', 'service.name', 'service.namespace'",label:"Tags",labelWidth:26,children:jsx(TagMappingInput,{values:Re??[],onChange:We=>Ce({tags:We})})})}),jsx(o,{disabled:he,type:"trace",id:"filterByTraceID",value:!!Ie.filterByTraceID,onChange:We=>Ce({filterByTraceID:We})}),jsx(o,{disabled:he,type:"span",id:"filterBySpanID",value:!!Ie.filterBySpanID,onChange:We=>Ce({filterBySpanID:We})}),jsx(InlineFieldRow,{children:jsx(InlineField,{tooltip:"Use a custom query with the possibility to interpolate variables from the trace or span",label:"Use custom query",labelWidth:26,children:jsx(InlineSwitch,{id:"customQuerySwitch",value:he,onChange:We=>Ce({customQuery:We.currentTarget.checked})})})}),he&&jsx(InlineField,{label:"Query",labelWidth:26,tooltip:"The query that will run when navigating from a trace to logs data source. Interpolate tags using the `$__tags` keyword",grow:!0,children:jsx(Input,{label:"Query",type:"text",allowFullScreen:!0,value:Oe,onChange:We=>Ce({query:We.currentTarget.value})})})]})}function o(me){return jsx(InlineFieldRow,{children:jsx(InlineField,{disabled:me.disabled,label:`Filter by ${me.type} ID`,labelWidth:26,grow:!0,tooltip:`Filters logs by ${me.type} ID, where the ${me.type} ID should be part of the log line`,children:jsx(InlineSwitch,{id:me.id,value:me.value,onChange:ve=>me.onChange(ve.currentTarget.checked)})})})}const h=me=>`Span ${me} time shift`,f=(me,ve)=>`Shifts the ${me} time of the span. Default: ${ve} (Time units can be used here, for example: 5s, -1m, 3h)`,d="Invalid time shift. See tooltip for examples.",p=({options:me,onOptionsChange:ve})=>{let Se=me.type;return Se+=me.type==="tempo"?"/configure-tempo-data-source/#trace-to-logs":"/#trace-to-logs",jsx(ConfigSection,{title:"Trace to logs",description:jsx(ConfigDescriptionLink,{description:"Navigate from a trace span to the selected data source's logs.",suffix:Se,feature:"trace to logs"}),isCollapsible:!0,isInitiallyOpen:!0,children:jsx(c,{options:me,onOptionsChange:ve})})};var m=e(72574),v=e(40845),l=e(31193),y=e(32901),u=e(31678),D=e(62256),E=e(56271),x=e(41811);const b=(me,ve,Se)=>{let Ie;return Se?Ie=ve?.childSpanIds.find(Oe=>me.has(Oe)&&me.get(Oe).startTime+me.get(Oe).duration<Se):Ie=ve.childSpanIds[0],Ie?me.get(Ie):void 0},O=me=>{const ve=[],Se=[];me.forEach(Re=>{if(Re.references[0]?.refType==="FOLLOWS_FROM"){ve.push(Re.spanID);const he=me.get(Re.references[0].spanID);he.childSpanIds=he.childSpanIds.filter(Ce=>Ce!==Re.spanID),me.set(he.spanID,{...he})}});const Ie=Re=>{Re.forEach(he=>{const Ce=me.get(he);Ce.hasChildren&&(Se.push(...Ce.childSpanIds),Ie(Ce.childSpanIds))})};return Ie(ve),[...ve,...Se].forEach(Re=>me.delete(Re)),me},T=me=>{let ve=[...me.keys()];return ve.forEach(Se=>{const Ie=me.get(Se);if(!(Ie&&Ie.references.length&&Ie.depth))return;const Oe=me.get(Ie.references[0].spanID);if(!Oe){me.delete(Ie.spanID);return}const Re=Ie.startTime+Ie.duration,he=Oe.startTime+Oe.duration;if(Ie.startTime>=Oe.startTime){if(Ie.startTime>=he){me.delete(Ie.spanID),Oe.childSpanIds=Oe.childSpanIds.filter(Ce=>Ce!==Ie.spanID);return}if(Re>he){me.set(Ie.spanID,{...Ie,duration:he-Ie.startTime});return}return}Re<=Oe.startTime?(me.delete(Ie.spanID),Oe.childSpanIds=Oe.childSpanIds.filter(Ce=>Ce!==Ie.spanID)):Re<=he?me.set(Ie.spanID,{...Ie,startTime:Oe.startTime,duration:Re-Oe.startTime}):me.set(Ie.spanID,{...Ie,startTime:Oe.startTime,duration:he-Oe.startTime})}),ve=[...me.keys()],ve.forEach(Se=>{const Ie=me.get(Se);if(Ie.references.length){const Oe=me.get(Ie.references[0].spanID);Ie.references[0].span=Oe,me.set(Se,{...Ie})}}),me},C=(me,ve,Se,Ie)=>{const Oe=me.get(ve);if(!Oe)return Se;const Re=b(me,Oe,Ie);let he;if(Re)he={spanId:Oe.spanID,section_start:Re.startTime+Re.duration,section_end:Ie||Oe.startTime+Oe.duration},he.section_start!==he.section_end&&Se.push(he),C(me,Re.spanID,Se);else if(he={spanId:Oe.spanID,section_start:Oe.startTime,section_end:Ie||Oe.startTime+Oe.duration},he.section_start!==he.section_end&&Se.push(he),Oe.references.length){const Ce=Oe.references.filter(We=>We.refType==="CHILD_OF")[0].spanID;C(me,Ce,Se,Oe.startTime)}return Se};function S(me){let ve=[];const Se=me?.spans[0].spanID;if(Se){const Ie=me.spans.reduce((Oe,Re)=>(Oe.set(Re.spanID,Re),Oe),new Map);try{const Oe=O(Ie),Re=T(Oe);ve=C(Re,Se,ve)}catch(Oe){console.log("error while computing critical path for a trace",Oe)}}return ve}const L=(0,x.A)(S);var N=e(3911),F=e(71656),w=e(30700);const B=.8,U=2,K=200,V=10,H=60,Y=6;function X(me,ve,Se,Ie,Oe){const Re=new Map,he=ve.length<H?H:Math.min(ve.length,K),Ce=window.innerWidth*2;me.width=Ce,me.height=he;const We=Math.min(Y,Math.max(U,he/ve.length)),et=he/ve.length,rt=me.getContext("2d",{alpha:!1});if(rt){rt.fillStyle=Oe,rt.fillRect(0,0,Ce,he);for(let nt=0;nt<ve.length;nt++){const{valueWidth:gt,valueOffset:xt,serviceName:St}=ve[nt],zt=xt/Se*Ce;let Nt=gt/Se*Ce;Nt<V&&(Nt=V);let Vt=Re.get(St);Vt||(Vt=`rgba(${Ie(St).concat(B).join()})`,Re.set(St,Vt)),rt.fillStyle=Vt,rt.fillRect(zt,nt*et,Nt,We)}}}const J=(0,N.N)(me=>({CanvasSpanGraph:(0,n.css)`
      label: CanvasSpanGraph;
      background: ${(0,F.R)(me,"#fafafa")};
      height: 60px;
      position: absolute;
      width: 100%;
    `}));class q extends i.PureComponent{constructor(ve){super(ve),this.getColor=Se=>(0,w.rY)(Se,this.props.theme),this._setCanvasRef=Se=>{this._canvasElm=Se},this._canvasElm=void 0}componentDidMount(){this._draw()}componentDidUpdate(){this._draw()}_draw(){if(this._canvasElm){const{valueWidth:ve,items:Se}=this.props;X(this._canvasElm,Se,ve,this.getColor,(0,F.R)(this.props.theme,"#fff"))}}render(){return(0,t.jsx)("canvas",{className:J(this.props.theme).CanvasSpanGraph,ref:this._setCanvasRef,"data-testid":"CanvasSpanGraph"})}}const ae=(0,v.cV)(q);var j=e(6389);const te=()=>({TickLabels:(0,n.css)`
      label: TickLabels;
      height: 1rem;
      position: relative;
    `,TickLabelsLabel:(0,n.css)`
      label: TickLabelsLabel;
      color: #717171;
      font-size: 0.7rem;
      position: absolute;
      user-select: none;
    `});function ne(me){const{numTicks:ve,duration:Se}=me,Ie=(0,v.of)(te),Oe=[];for(let Re=0;Re<ve+1;Re++){const he=Re/ve,Ce=he===1?{right:"0%"}:{left:`${he*100}%`};Oe.push((0,t.jsx)("div",{className:Ie.TickLabelsLabel,style:Ce,"data-testid":"tick",children:(0,j.a3)(Se*he)},he))}return(0,t.jsx)("div",{className:Ie.TickLabels,"data-testid":"TickLabels",children:Oe})}var le=e(46942),z=e.n(le),ee=e(55852),se=e(92151);const ie=()=>({GraphTick:(0,n.css)`
      label: GraphTick;
      stroke: #aaa;
      stroke-width: 1px;
    `});function Z(me){const{numTicks:ve}=me,Se=(0,v.of)(ie),Ie=[];for(let Oe=1;Oe<ve;Oe++){const Re=`${Oe/ve*100}%`;Ie.push((0,t.jsx)("line",{className:Se.GraphTick,x1:Re,y1:"0%",x2:Re,y2:"100%"},Oe/ve))}return(0,t.jsx)("g",{"data-testid":"ticks","aria-hidden":"true",children:Ie})}const oe=()=>({ScrubberHandleExpansion:z()((0,n.css)`
        label: ScrubberHandleExpansion;
        cursor: col-resize;
        fill-opacity: 0;
        fill: #44f;
      `,"scrubber-handle-expansion"),ScrubberHandle:z()((0,n.css)`
        label: ScrubberHandle;
        cursor: col-resize;
        fill: #555;
      `,"scrubber-handle"),ScrubberLine:z()((0,n.css)`
        label: ScrubberLine;
        pointer-events: none;
        stroke: #555;
      `,"scrubber-line"),ScrubberDragging:(0,n.css)`
      label: ScrubberDragging;
      & .scrubber-handle-expansion {
        fill-opacity: 1;
      }
      & .scrubber-handle {
        fill: #44f;
      }
      & > .scrubber-line {
        stroke: #44f;
      }
    `,ScrubberHandles:(0,n.css)`
      label: ScrubberHandles;
      &:hover > .scrubber-handle-expansion {
        fill-opacity: 1;
      }
      &:hover > .scrubber-handle {
        fill: #44f;
      }
      &:hover + .scrubber.line {
        stroke: #44f;
      }
    `});function ce({isDragging:me,onMouseDown:ve,onMouseEnter:Se,onMouseLeave:Ie,position:Oe}){const Re=`${Oe*100}%`,he=(0,v.of)(oe),Ce=z()({[he.ScrubberDragging]:me});return(0,t.jsxs)("g",{className:Ce,"data-testid":"scrubber-component",children:[(0,t.jsxs)("g",{"data-testid":"scrubber-component-g",className:he.ScrubberHandles,onMouseDown:ve,onMouseEnter:Se,onMouseLeave:Ie,children:[(0,t.jsx)("rect",{"data-testid":"scrubber-component-rect-1",x:Re,className:he.ScrubberHandleExpansion,style:{transform:"translate(-4.5px)"},width:"9",height:"20"}),(0,t.jsx)("rect",{"data-testid":"scrubber-component-rect-2",x:Re,className:he.ScrubberHandle,style:{transform:"translate(-1.5px)"},width:"3",height:"20"})]}),(0,t.jsx)("line",{className:he.ScrubberLine,y2:"100%",x1:Re,x2:Re,"data-testid":"scrubber-component-line"})]})}const ye=(0,N.N)(me=>{const ve="JaegerUiComponents__ViewingLayerResetZoomHoverClassName",Se=(0,n.css)`
    label: ViewingLayerResetZoom;
    display: none;
    position: absolute;
    right: 1%;
    top: 10%;
    z-index: 1;
  `;return{ViewingLayer:(0,n.css)`
      label: ViewingLayer;
      cursor: vertical-text;
      position: relative;
      z-index: 1;
      &:hover > .${ve} {
        display: unset;
      }
    `,ViewingLayerGraph:(0,n.css)`
      label: ViewingLayerGraph;
      border: 1px solid ${(0,F.R)(me,"#999")};
      /* need !important here to overcome something from semantic UI */
      overflow: visible !important;
      position: relative;
      transform-origin: 0 0;
      width: 100%;
    `,ViewingLayerInactive:(0,n.css)`
      label: ViewingLayerInactive;
      fill: ${(0,F.R)(me,"rgba(214, 214, 214, 0.5)")};
    `,ViewingLayerCursorGuide:(0,n.css)`
      label: ViewingLayerCursorGuide;
      stroke: ${(0,F.R)(me,"#f44")};
      stroke-width: 1;
    `,ViewingLayerDraggedShift:(0,n.css)`
      label: ViewingLayerDraggedShift;
      fill-opacity: 0.2;
    `,ViewingLayerDrag:(0,n.css)`
      label: ViewingLayerDrag;
      fill: ${(0,F.R)(me,"#44f")};
    `,ViewingLayerFullOverlay:(0,n.css)`
      label: ViewingLayerFullOverlay;
      bottom: 0;
      cursor: col-resize;
      left: 0;
      position: fixed;
      right: 0;
      top: 0;
      user-select: none;
    `,ViewingLayerResetZoom:Se,ViewingLayerResetZoomHoverClassName:ve}}),re={SHIFT_END:"SHIFT_END",SHIFT_START:"SHIFT_START",REFRAME:"REFRAME"};function ue(me,ve){const[Se,Ie]=me<ve?[me,ve]:[ve,me];return{x:`${Se*100}%`,width:`${(Ie-Se)*100}%`,leadingX:`${ve*100}%`}}class De extends i.PureComponent{constructor(ve){super(ve),this._setRoot=Se=>{this._root=Se},this._getDraggingBounds=Se=>{if(!this._root)throw new Error("invalid state");const{left:Ie,width:Oe}=this._root.getBoundingClientRect(),[Re,he]=this.props.viewRange.time.current;let Ce=1,We=0;return Se===re.SHIFT_START?Ce=he:Se===re.SHIFT_END&&(We=Re),{clientXLeft:Ie,maxValue:Ce,minValue:We,width:Oe}},this._handleReframeMouseMove=({value:Se})=>{this.props.updateNextViewRangeTime({cursor:Se})},this._handleReframeMouseLeave=()=>{this._draggerReframe.resetBounds(),this.props.updateNextViewRangeTime({cursor:null})},this._handleReframeDragUpdate=({value:Se})=>{const Ie=Se,{time:Oe}=this.props.viewRange,he={reframe:{anchor:Oe.reframe?Oe.reframe.anchor:Ie,shift:Ie}};this.props.updateNextViewRangeTime(he)},this._handleReframeDragEnd=({manager:Se,value:Ie})=>{const{time:Oe}=this.props.viewRange,Re=Oe.reframe?Oe.reframe.anchor:Ie,[he,Ce]=Ie<Re?[Ie,Re]:[Re,Ie];Se.resetBounds(),this.props.updateViewRangeTime(he,Ce,"minimap")},this._handleScrubberEnterLeave=({type:Se})=>{const Ie=Se===se.EUpdateTypes.MouseEnter;this.setState({preventCursorLine:Ie})},this._handleScrubberDragUpdate=({event:Se,tag:Ie,type:Oe,value:Re})=>{Oe===se.EUpdateTypes.DragStart&&Se.stopPropagation(),Ie===re.SHIFT_START?this.props.updateNextViewRangeTime({shiftStart:Re}):Ie===re.SHIFT_END&&this.props.updateNextViewRangeTime({shiftEnd:Re})},this._handleScrubberDragEnd=({manager:Se,tag:Ie,value:Oe})=>{const[Re,he]=this.props.viewRange.time.current;let Ce;if(Ie===re.SHIFT_START)Ce=[Oe,he];else if(Ie===re.SHIFT_END)Ce=[Re,Oe];else throw new Error("bad state");Se.resetBounds(),this.setState({preventCursorLine:!1}),this.props.updateViewRangeTime(Ce[0],Ce[1],"minimap")},this._resetTimeZoomClickHandler=()=>{this.props.updateViewRangeTime(0,1)},this._draggerReframe=new se.default({getBounds:this._getDraggingBounds,onDragEnd:this._handleReframeDragEnd,onDragMove:this._handleReframeDragUpdate,onDragStart:this._handleReframeDragUpdate,onMouseMove:this._handleReframeMouseMove,onMouseLeave:this._handleReframeMouseLeave,tag:re.REFRAME}),this._draggerStart=new se.default({getBounds:this._getDraggingBounds,onDragEnd:this._handleScrubberDragEnd,onDragMove:this._handleScrubberDragUpdate,onDragStart:this._handleScrubberDragUpdate,onMouseEnter:this._handleScrubberEnterLeave,onMouseLeave:this._handleScrubberEnterLeave,tag:re.SHIFT_START}),this._draggerEnd=new se.default({getBounds:this._getDraggingBounds,onDragEnd:this._handleScrubberDragEnd,onDragMove:this._handleScrubberDragUpdate,onDragStart:this._handleScrubberDragUpdate,onMouseEnter:this._handleScrubberEnterLeave,onMouseLeave:this._handleScrubberEnterLeave,tag:re.SHIFT_END}),this._root=void 0,this.state={preventCursorLine:!1}}componentWillUnmount(){this._draggerReframe.dispose(),this._draggerEnd.dispose(),this._draggerStart.dispose()}_getMarkers(ve,Se){const Ie=ye(this.props.theme),Oe=ue(ve,Se);return[(0,t.jsx)("rect",{className:z()(Ie.ViewingLayerDraggedShift,Ie.ViewingLayerDrag),x:Oe.x,y:"0",width:Oe.width,height:this.props.height-2},"fill"),(0,t.jsx)("rect",{className:z()(Ie.ViewingLayerDrag),x:Oe.leadingX,y:"0",width:"1",height:this.props.height-2},"edge")]}render(){const{height:ve,viewRange:Se,numTicks:Ie,theme:Oe}=this.props,{preventCursorLine:Re}=this.state,{current:he,cursor:Ce,shiftStart:We,shiftEnd:et,reframe:rt}=Se.time,nt=We!=null||et!=null||rt!=null,[gt,xt]=he;let St=0;gt&&(St=gt*100);let zt=100;xt&&(zt=100-xt*100);let Nt;!nt&&Ce!=null&&!Re&&(Nt=`${Ce*100}%`);const Vt=ye(Oe);return(0,t.jsxs)("div",{"aria-hidden":!0,className:Vt.ViewingLayer,style:{height:ve},children:[(gt!==0||xt!==1)&&(0,t.jsx)(ee.$n,{onClick:this._resetTimeZoomClickHandler,className:z()(Vt.ViewingLayerResetZoom,Vt.ViewingLayerResetZoomHoverClassName),type:"button",variant:"secondary",children:"Reset Selection"}),(0,t.jsxs)("svg",{height:ve,className:Vt.ViewingLayerGraph,ref:this._setRoot,onMouseDown:this._draggerReframe.handleMouseDown,onMouseLeave:this._draggerReframe.handleMouseLeave,onMouseMove:this._draggerReframe.handleMouseMove,children:[St>0&&(0,t.jsx)("rect",{x:0,y:0,height:"100%",width:`${St}%`,className:Vt.ViewingLayerInactive,"data-testid":"left-ViewingLayerInactive"}),zt>0&&(0,t.jsx)("rect",{x:`${100-zt}%`,y:0,height:"100%",width:`${zt}%`,className:Vt.ViewingLayerInactive,"data-testid":"right-ViewingLayerInactive"}),(0,t.jsx)(Z,{numTicks:Ie}),Nt&&(0,t.jsx)("line",{className:Vt.ViewingLayerCursorGuide,x1:Nt,y1:"0",x2:Nt,y2:ve-2,strokeWidth:"1","data-testid":"ViewingLayerCursorGuide"}),We!=null&&this._getMarkers(gt,We),et!=null&&this._getMarkers(xt,et),(0,t.jsx)(ce,{isDragging:We!=null,onMouseDown:this._draggerStart.handleMouseDown,onMouseEnter:this._draggerStart.handleMouseEnter,onMouseLeave:this._draggerStart.handleMouseLeave,position:gt||0}),(0,t.jsx)(ce,{isDragging:et!=null,position:xt||1,onMouseDown:this._draggerEnd.handleMouseDown,onMouseEnter:this._draggerEnd.handleMouseEnter,onMouseLeave:this._draggerEnd.handleMouseLeave}),rt!=null&&this._getMarkers(rt.anchor,rt.shift)]}),nt&&(0,t.jsx)("div",{className:Vt.ViewingLayerFullOverlay})]})}}const ge=(0,v.cV)(De),Te=()=>({container:(0,n.css)({padding:"0 0.5rem 0.5rem 0.5rem"}),canvasContainer:(0,n.css)({position:"relative"})}),Le=60,Ye=4;function je(me){return{valueOffset:me.relativeStartTime,valueWidth:me.duration,serviceName:me.process.serviceName}}function Ze(me){return me.spans.map(je)}const Ne=(0,x.A)(Ze);class Pe extends i.PureComponent{static{this.defaultProps={height:Le}}render(){const{height:ve,trace:Se,viewRange:Ie,updateNextViewRangeTime:Oe,updateViewRangeTime:Re}=this.props,he=Te();if(!Se)return(0,t.jsx)("div",{});const Ce=Ne(Se);return(0,t.jsxs)("div",{className:he.container,children:[(0,t.jsx)(ne,{numTicks:Ye,duration:Se.duration}),(0,t.jsxs)("div",{className:he.canvasContainer,children:[(0,t.jsx)(ae,{valueWidth:Se.duration,items:Ce}),(0,t.jsx)(ge,{viewRange:Ie,numTicks:Ye,height:ve||Le,updateViewRangeTime:Re,updateNextViewRangeTime:Oe})]})]})}}var Ue=e(28114);function $e(){const[me,ve]=(0,i.useState)(new Set),Se=(0,i.useCallback)(function(We){if(me.size===0)return;let et=-1,rt=!0;const nt=We.reduce((gt,xt)=>(xt.depth<=et&&(rt=!0),rt&&gt.has(xt.spanID)&&(gt.delete(xt.spanID),rt=!1,et=xt.depth),gt),new Set(me));ve(nt)},[me]),Ie=(0,i.useCallback)(function(We){if(ze(We,me))return;let et;const rt=We.reduce((nt,gt)=>(et&&gt.depth<=et.depth?(nt.add(et.spanID),gt.hasChildren&&(et=gt)):gt.hasChildren&&!nt.has(gt.spanID)&&(et=gt),nt),new Set(me));et&&rt.add(et.spanID),ve(rt)},[me]),Oe=(0,i.useCallback)(function(){ve(new Set)},[]),Re=(0,i.useCallback)(function(We){if(ze(We,me))return;const et=We.reduce((rt,nt)=>(nt.hasChildren&&rt.add(nt.spanID),rt),new Set);ve(et)},[me]),he=(0,i.useCallback)(function(We){const et=new Set(me);me.has(We)?et.delete(We):et.add(We),ve(et)},[me]);return{childrenHiddenIDs:me,expandOne:Se,collapseOne:Ie,expandAll:Oe,collapseAll:Re,childrenToggle:he}}function ze(me,ve){return me.filter(Ie=>Ie.hasChildren).length===ve.size}function qe(me){const[ve,Se]=(0,i.useState)(new Map);(0,i.useEffect)(()=>{Se(new Map)},[me,Se]);const Ie=(0,i.useCallback)(function(Ce){const We=new Map(ve);We.has(Ce)?We.delete(Ce):We.set(Ce,new E.DetailState),Se(We)},[ve]),Oe=(0,i.useCallback)(function(Ce,We){const et=ve.get(Ce);if(!et)return;const rt=et.toggleLogItem(We),nt=new Map(ve);return nt.set(Ce,rt),Se(nt)},[ve]),Re=(0,i.useCallback)(function(Ce,We){const et=ve.get(Ce);if(!et)return;const rt=et.toggleReferenceItem(We),nt=new Map(ve);return nt.set(Ce,rt),Se(nt)},[ve]);return{detailStates:ve,toggleDetail:Ie,detailLogItemToggle:Oe,detailLogsToggle:(0,i.useCallback)(he=>dt("logs",ve,Se)(he),[ve]),detailWarningsToggle:(0,i.useCallback)(he=>dt("warnings",ve,Se)(he),[ve]),detailStackTracesToggle:(0,i.useCallback)(he=>dt("stackTraces",ve,Se)(he),[ve]),detailReferenceItemToggle:Re,detailReferencesToggle:(0,i.useCallback)(he=>dt("references",ve,Se)(he),[ve]),detailProcessToggle:(0,i.useCallback)(he=>dt("process",ve,Se)(he),[ve]),detailTagsToggle:(0,i.useCallback)(he=>dt("tags",ve,Se)(he),[ve])}}function dt(me,ve,Se){return Ie=>{const Oe=ve.get(Ie);if(!Oe)return;let Re;me==="tags"?Re=Oe.toggleTags():me==="process"?Re=Oe.toggleProcess():me==="warnings"?Re=Oe.toggleWarnings():me==="references"?Re=Oe.toggleReferences():me==="stackTraces"?Re=Oe.toggleStackTraces():Re=Oe.toggleLogs();const he=new Map(ve);he.set(Ie,Re),Se(he)}}function vt(){const[me,ve]=(0,i.useState)(new Set),Se=(0,i.useCallback)(function(Re){ve(he=>{const Ce=new Set(he);return Ce.add(Re),Ce})},[]),Ie=(0,i.useCallback)(function(Re){ve(he=>{const Ce=new Set(he);return Ce.delete(Re),Ce})},[]);return{hoverIndentGuideIds:me,addHoverIndentGuideId:Se,removeHoverIndentGuideId:Ie}}var yt=e(15583);function st(){const[me,ve]=(0,i.useState)({time:{current:[0,1]}}),Se=(0,i.useCallback)(function(Re){ve(he=>{const Ce={...he.time,...Re};return{...he,time:Ce}})},[]),Ie=(0,i.useCallback)(function(Re,he){const We={current:[Re,he]};ve(et=>({...et,time:We}))},[]);return{viewRange:me,updateViewRangeTime:Ie,updateNextViewRangeTime:Se}}const Ve=me=>({noDataMsg:(0,n.css)`
    height: 100%;
    width: 100%;
    display: grid;
    place-items: center;
    font-size: ${me.typography.h4.fontSize};
    color: ${me.colors.text.secondary};
  `});function pe(me){const{traceProp:ve,datasource:Se,topOfViewRef:Ie,exploreId:Oe,createSpanLink:Re,focusedSpanId:he,createFocusSpanLink:Ce}=me,{detailStates:We,toggleDetail:et,detailLogItemToggle:rt,detailLogsToggle:nt,detailProcessToggle:gt,detailReferencesToggle:xt,detailReferenceItemToggle:St,detailTagsToggle:zt,detailWarningsToggle:Nt,detailStackTracesToggle:Vt}=qe(me.dataFrames[0]),{removeHoverIndentGuideId:en,addHoverIndentGuideId:Je,hoverIndentGuideIds:ct}=vt(),{viewRange:ot,updateViewRangeTime:Qe,updateNextViewRangeTime:pt}=st(),{expandOne:Pt,collapseOne:At,childrenToggle:mn,collapseAll:Pn,childrenHiddenIDs:fn,expandAll:Rn}=$e(),{search:Kn,setSearch:Bt,spanFilterMatches:an}=(0,yt.SQ)(ve?.spans),[tn,Cn]=(0,i.useState)(""),[xn,Vn]=(0,s.A)(!1),[Et,Ft]=(0,i.useState)(!1),[Gt,ln]=(0,i.useState)(!1),[qt,cn]=(0,i.useState)(100),[En,Sn]=(0,i.useState)({}),[Tn,Wn]=(0,i.useState)({}),Nn=(0,v.of)(Ve),[Tt,Wt]=(0,i.useState)(.4),[jt,ut]=Ee({refId:me.dataFrames[0]?.refId,exploreId:me.exploreId,datasource:Se,splitOpenFn:me.splitOpenFn}),Zt=he??jt,jn=Ce??ut,Xn=(0,i.useMemo)(()=>({childrenHiddenIDs:fn,detailStates:We,hoverIndentGuideIds:ct,spanNameColumnWidth:Tt,traceID:me.traceProp?.traceID}),[fn,We,ct,Tt,me.traceProp?.traceID]),Qn=(0,l.tR)().getInstanceSettings(Se?.name),Fn=a(Qn?.jsonData),js=Qn?.jsonData?.tracesToMetrics,Ps=Qn?.jsonData?.tracesToProfiles,es=Qn?.jsonData,_s=(0,i.useMemo)(()=>Re??(0,Ue.lU)({splitOpenFn:me.splitOpenFn,traceToLogsOptions:Fn,traceToMetricsOptions:js,traceToProfilesOptions:Ps,dataFrame:me.dataFrames[0],createFocusSpanLink:jn,trace:ve}),[me.splitOpenFn,Fn,js,Ps,me.dataFrames,jn,ve,Re]),ca=(0,u.useSelector)(lr=>(0,y.O)(lr.user)),Ks=Se?Se?.type:"unknown",Zs=me.scrollElement?me.scrollElement:document.getElementsByClassName(me.scrollElementClass??"")[0],nr=L(ve);return(0,t.jsx)(t.Fragment,{children:me.dataFrames?.length&&ve?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(E.TracePageHeader,{trace:ve,data:me.dataFrames[0],timeZone:ca,search:Kn,setSearch:Bt,showSpanFilters:xn,setShowSpanFilters:Vn,showSpanFilterMatchesOnly:Et,setShowSpanFilterMatchesOnly:Ft,showCriticalPathSpansOnly:Gt,setShowCriticalPathSpansOnly:ln,setFocusedSpanIdForSearch:Cn,spanFilterMatches:an,datasourceType:Ks,setHeaderHeight:cn,app:Oe?r.Jk.Explore:r.Jk.Unknown}),(0,t.jsx)(Pe,{trace:ve,viewRange:ot,updateNextViewRangeTime:pt,updateViewRangeTime:Qe}),(0,t.jsx)(E.TraceTimelineViewer,{findMatchesIDs:an,trace:ve,traceToProfilesOptions:Ps,datasourceType:Ks,spanBarOptions:es?.spanBar,traceTimeline:Xn,updateNextViewRangeTime:pt,updateViewRangeTime:Qe,viewRange:ot,timeZone:ca,setSpanNameColumnWidth:Wt,collapseAll:Pn,collapseOne:At,expandAll:Rn,expandOne:Pt,childrenToggle:mn,detailLogItemToggle:rt,detailLogsToggle:nt,detailWarningsToggle:Nt,detailStackTracesToggle:Vt,detailReferencesToggle:xt,detailReferenceItemToggle:St,detailProcessToggle:gt,detailTagsToggle:zt,detailToggle:et,addHoverIndentGuideId:Je,removeHoverIndentGuideId:en,linksGetter:()=>[],createSpanLink:_s,scrollElement:Zs,focusedSpanId:Zt,focusedSpanIdForSearch:tn,showSpanFilterMatchesOnly:Et,showCriticalPathSpansOnly:Gt,createFocusSpanLink:jn,topOfViewRef:Ie,headerHeight:qt,criticalPath:nr,traceFlameGraphs:En,setTraceFlameGraphs:Sn,redrawListView:Tn,setRedrawListView:Wn})]}):(0,t.jsx)("div",{className:Nn.noDataMsg,children:"No data"})})}function Ee(me){const ve=(0,u.useSelector)(Ce=>Ce.explore.panes[me.exploreId]?.panelsState.trace),Se=ve?.spanId,Ie=(0,u.useDispatch)(),Oe=Ce=>Ie((0,D.EA)(me.exploreId,"trace",{...ve,spanId:Ce})),Re=(0,u.useSelector)(Ce=>Ce.explore.panes[me.exploreId]?.queries.find(We=>We.refId===me.refId));return[Se,(Ce,We)=>{const et={title:"Deep link to this span",url:"",internal:{datasourceUid:me.datasource?.uid,datasourceName:me.datasource?.name,query:{...Re,query:Ce},panelsState:{trace:{spanId:We}}}},rt=Re?.queryType==="traceql"&&Re.query===Ce;return(0,g.u)({link:et,internalLink:et.internal,scopedVars:{},field:{},onClickFn:rt?()=>Oe(Se===We?void 0:We):me.splitOpenFn?()=>me.splitOpenFn({datasourceUid:me.datasource?.uid,queries:[{...Re,query:Ce}],panelsState:{trace:{spanId:We}}}):void 0,replaceVariables:(0,m.w)().replace.bind((0,m.w)())})}]}},71656:(k,R,e)=>{"use strict";e.d(R,{R:()=>n});var t=e(84140);function n(i,s,r){if(i.isLight)return s;{if(r){const c=(0,t.A)(s);return t.A.mostReadable(r,[c.clone().lighten(25),c.clone().lighten(10),c,c.clone().darken(10),c.clone().darken(25)],{includeFallbackColors:!1}).toHex8String()}const g=(0,t.A)(s).toHsl();g.l=1-g.l;const a=(0,t.A)(g);return a.isLight()?a.darken(5).toHex8String():a.lighten(5).toHex8String()}}},56271:(k,R,e)=>{"use strict";e.d(R,{DetailState:()=>Fr,TracePageHeader:()=>gl,TraceTimelineViewer:()=>vr,filterSpans:()=>hl,transformTraceData:()=>Xo});var t=e(74848),n=e(32196),i=e(96540),s=e(14110),r=e(32264),g=e(3911),a=e(40845),c=e(71656),o=e(75888),h=e.n(o);const d={scrollPageDown:{binding:"s",label:"Scroll down"},scrollPageUp:{binding:"w",label:"Scroll up"},scrollToNextVisibleSpan:{binding:"f",label:"Scroll to the next visible span"},scrollToPrevVisibleSpan:{binding:"b",label:"Scroll to the previous visible span"},panLeft:{binding:["a","left"],label:"Pan left"},panLeftFast:{binding:["shift+a","shift+left"],label:"Pan left \u2014 Large"},panRight:{binding:["d","right"],label:"Pan right"},panRightFast:{binding:["shift+d","shift+right"],label:"Pan right \u2014 Large"},zoomIn:{binding:"up",label:"Zoom in"},zoomInFast:{binding:"shift+up",label:"Zoom in \u2014 Large"},zoomOut:{binding:"down",label:"Zoom out"},zoomOutFast:{binding:"shift+down",label:"Zoom out \u2014 Large"},collapseAll:{binding:"]",label:"Collapse All"},expandAll:{binding:"[",label:"Expand All"},collapseOne:{binding:"p",label:"Collapse One Level"},expandOne:{binding:"o",label:"Expand One Level"},searchSpans:{binding:"ctrl+b",label:"Search Spans"},clearSearch:{binding:"escape",label:"Clear Search"}};let p;function m(){if(p)return p;const Fe=new(h())(document.body);return p=Fe,Fe}function v(Fe){const _e=m();Object.keys(Fe).forEach(tt=>{const ft=Fe[tt];ft&&_e.bind(d[tt].binding,ft)})}function l(){m().reset()}var y=e(46942),u=e.n(y),D=e(6389);function E(Fe){const{min:_e,max:tt,viewStart:ft,viewEnd:Mt}=Fe,$t=tt-_e,Jt=_e+ft*$t,Dn=tt-(1-Mt)*$t-Jt;return(In,ts)=>({start:(In-Jt)/Dn,end:(ts-Jt)/Dn})}function x(Fe,_e,tt){return!Array.isArray(tt.tags)||!tt.tags.length?!1:tt.tags.some(ft=>ft.key===Fe&&ft.value===_e)}const P=Fe=>Fe.kind==="client",b=x.bind(null,"span.kind","client"),M=Fe=>P(Fe)||b(Fe),O=Fe=>Fe.kind==="server",I=x.bind(null,"span.kind","server"),T=Fe=>O(Fe)||I(Fe),C=Fe=>Fe.statusCode===2,S=x.bind(null,"error",!0),A=x.bind(null,"error","true"),L=Fe=>C(Fe)||S(Fe)||A(Fe);function N(Fe,_e){const{depth:tt}=Fe[_e];let ft=_e+1;for(;ft<Fe.length&&Fe[ft].depth>tt;ft++)if(L(Fe[ft]))return!0;return!1}function F(Fe){if(Fe.length<=1||!M(Fe[0]))return!1;const tt=Fe[0].depth+1;let ft=1;for(;ft<Fe.length&&Fe[ft].depth===tt;){if(T(Fe[ft]))return Fe[ft];ft++}return null}const w=Fe=>Fe.kind?Fe.kind==="client":Fe.tags.some(({key:_e,value:tt})=>_e==="span.kind"&&tt==="client"),B=Fe=>({Ticks:(0,n.css)`
      label: Ticks;
      pointer-events: none;
    `,TicksTick:(0,n.css)`
      label: TicksTick;
      position: absolute;
      height: 100%;
      width: 1px;
      background: ${(0,c.R)(Fe,"#d8d8d8")};
      &:last-child {
        width: 0;
      }
    `,TicksTickLabel:(0,n.css)`
      label: TicksTickLabel;
      left: 0.25rem;
      position: absolute;
    `,TicksTickLabelEndAnchor:(0,n.css)`
      label: TicksTickLabelEndAnchor;
      left: initial;
      right: 0.25rem;
    `});function U({endTime:Fe=null,numTicks:_e,showLabels:tt=null,startTime:ft=null}){let Mt;if(tt){Mt=[];const nn=(Fe||0)-(ft||0);for(let Dn=0;Dn<_e;Dn++){const In=(ft||0)+Dn/(_e-1)*nn;Mt.push((0,D.a3)(In))}}const $t=(0,a.of)(B),Jt=[];for(let nn=0;nn<_e;nn++){const Dn=nn/(_e-1);Jt.push((0,t.jsx)("div",{"data-testid":"TicksID",className:$t.TicksTick,style:{left:`${Dn*100}%`},children:Mt&&(0,t.jsx)("span",{className:u()($t.TicksTickLabel,{[$t.TicksTickLabelEndAnchor]:Dn>=1}),children:Mt[nn]})},Dn))}return(0,t.jsx)("div",{className:$t.Ticks,children:Jt})}const K=()=>({row:(0,n.css)({display:"flex",flex:"0 1 auto",flexDirection:"row"}),rowCell:(0,n.css)({position:"relative"})});function V({children:Fe,className:_e="",...tt}){const ft=(0,a.of)(K);return(0,t.jsx)("div",{className:u()(ft.row,_e),...tt,children:Fe})}function H({children:Fe,className:_e="",width:tt,style:ft={},...Mt}){const $t=`${tt*100}%`,Jt={...ft,flexBasis:$t,maxWidth:$t},nn=(0,a.of)(K);return(0,t.jsx)("div",{className:u()(nn.rowCell,_e),style:Jt,"data-testid":"TimelineRowCell",...Mt,children:Fe})}V.Cell=H;var Y=e(29158);const X=()=>({TimelineCollapser:(0,n.css)`
      align-items: center;
      display: flex;
      flex: none;
      justify-content: center;
      margin-right: 0.5rem;
    `});function J(Fe){const{onExpandAll:_e,onExpandOne:tt,onCollapseAll:ft,onCollapseOne:Mt}=Fe,$t=(0,a.of)(X);return(0,t.jsxs)("div",{className:$t.TimelineCollapser,"data-testid":"TimelineCollapser",children:[(0,t.jsx)(Y.K,{tooltip:"Expand +1",size:"xl",tooltipPlacement:"top",name:"angle-down",onClick:tt}),(0,t.jsx)(Y.K,{tooltip:"Collapse +1",size:"xl",tooltipPlacement:"top",name:"angle-right",onClick:Mt}),(0,t.jsx)(Y.K,{tooltip:"Expand All",size:"xl",tooltipPlacement:"top",name:"angle-double-down",onClick:_e}),(0,t.jsx)(Y.K,{tooltip:"Collapse All",size:"xl",tooltipPlacement:"top",name:"angle-double-right",onClick:ft})]})}var q=e(92151);const ae=()=>({TimelineColumnResizer:(0,n.css)`
      left: 0;
      position: absolute;
      right: 0;
      top: 0;
    `,wrapper:(0,n.css)`
      bottom: 0;
      position: absolute;
      top: 0;
    `,dragger:(0,n.css)`
      border-left: 2px solid transparent;
      cursor: col-resize;
      height: 5000px;
      margin-left: -1px;
      position: absolute;
      top: 0;
      width: 1px;
      z-index: 10;
      &:hover {
        border-left: 2px solid rgba(0, 0, 0, 0.3);
      }
      &::before {
        position: absolute;
        top: 0;
        bottom: 0;
        left: -8px;
        right: 0;
        content: ' ';
      }
    `,draggerDragging:(0,n.css)`
      background: rgba(136, 0, 136, 0.05);
      width: unset;
      &::before {
        left: -2000px;
        right: -2000px;
      }
    `,draggerDraggingLeft:(0,n.css)`
      border-left: 2px solid #808;
      border-right: 1px solid #999;
    `,draggerDraggingRight:(0,n.css)`
      border-left: 1px solid #999;
      border-right: 2px solid #808;
    `,gripIcon:(0,n.css)`
      position: absolute;
      top: 0;
      bottom: 0;
      &::before,
      &::after {
        border-right: 1px solid #ccc;
        content: ' ';
        height: 9px;
        position: absolute;
        right: 9px;
        top: 25px;
      }
      &::after {
        right: 5px;
      }
    `,gripIconDragging:(0,n.css)`
      &::before,
      &::after {
        border-right: 1px solid rgba(136, 0, 136, 0.5);
      }
    `});class j extends i.PureComponent{constructor(_e){super(_e),this._setRootElm=tt=>{this._rootElm=tt},this._getDraggingBounds=()=>{if(!this._rootElm)throw new Error("invalid state");const{left:tt,width:ft}=this._rootElm.getBoundingClientRect(),{min:Mt,max:$t}=this.props;return{clientXLeft:tt,width:ft,maxValue:$t,minValue:Mt}},this._handleDragUpdate=({value:tt})=>{this.setState({dragPosition:tt})},this._handleDragEnd=({manager:tt,value:ft})=>{tt.resetBounds(),this.setState({dragPosition:null}),this.props.onChange(ft)},this._dragManager=new q.default({getBounds:this._getDraggingBounds,onDragEnd:this._handleDragEnd,onDragMove:this._handleDragUpdate,onDragStart:this._handleDragUpdate}),this._rootElm=void 0,this.state={dragPosition:null}}componentWillUnmount(){this._dragManager.dispose()}render(){let _e,tt;const{position:ft,columnResizeHandleHeight:Mt}=this.props,{dragPosition:$t}=this.state;_e=`${ft*100}%`;const Jt={left:_e};let nn=!1,Dn=!1;const In=ae();if(this._dragManager.isDragging()&&this._rootElm&&$t!=null){nn=$t<ft,Dn=$t>ft;const hs=`${Math.min(ft,$t)*100}%`,Yn=`calc(${(1-Math.max(ft,$t))*100}% - 1px)`;tt={left:hs,right:Yn}}else tt=Jt;tt.height=Mt;const ts=nn||Dn;return(0,t.jsxs)("div",{className:In.TimelineColumnResizer,ref:this._setRootElm,"data-testid":"TimelineColumnResizer",children:[(0,t.jsx)("div",{className:u()(In.gripIcon,ts&&In.gripIconDragging),style:Jt,"data-testid":"TimelineColumnResizer--gripIcon"}),(0,t.jsx)("div",{"aria-hidden":!0,className:u()(In.dragger,ts&&In.draggerDragging,Dn&&In.draggerDraggingRight,nn&&In.draggerDraggingLeft),onMouseDown:this._dragManager.handleMouseDown,style:tt,"data-testid":"TimelineColumnResizer--dragger"})]})}}const te=(0,g.N)(()=>({TimelineViewingLayer:(0,n.css)`
      label: TimelineViewingLayer;
      bottom: 0;
      cursor: vertical-text;
      left: 0;
      position: absolute;
      right: 0;
      top: 0;
    `,TimelineViewingLayerCursorGuide:(0,n.css)`
      label: TimelineViewingLayerCursorGuide;
      position: absolute;
      top: 0;
      bottom: 0;
      left: 0;
      width: 1px;
      background-color: red;
    `,TimelineViewingLayerDragged:(0,n.css)`
      label: TimelineViewingLayerDragged;
      position: absolute;
      top: 0;
      bottom: 0;
    `,TimelineViewingLayerDraggedDraggingLeft:(0,n.css)`
      label: TimelineViewingLayerDraggedDraggingLeft;
      border-left: 1px solid;
    `,TimelineViewingLayerDraggedDraggingRight:(0,n.css)`
      label: TimelineViewingLayerDraggedDraggingRight;
      border-right: 1px solid;
    `,TimelineViewingLayerDraggedShiftDrag:(0,n.css)`
      label: TimelineViewingLayerDraggedShiftDrag;
      background-color: rgba(68, 68, 255, 0.2);
      border-color: #44f;
    `,TimelineViewingLayerDraggedReframeDrag:(0,n.css)`
      label: TimelineViewingLayerDraggedReframeDrag;
      background-color: rgba(255, 68, 68, 0.2);
      border-color: #f44;
    `,TimelineViewingLayerFullOverlay:(0,n.css)`
      label: TimelineViewingLayerFullOverlay;
      bottom: 0;
      cursor: col-resize;
      left: 0;
      position: fixed;
      right: 0;
      top: 0;
      user-select: none;
    `}));function ne(Fe){return Reflect.has(Fe,"isOutOfView")}function le(Fe,_e,tt){return Fe+tt*(_e-Fe)}function z(Fe,_e,tt){return(tt-Fe)/(_e-Fe)}function ee(Fe,_e){let[tt,ft]=Fe<_e?[Fe,_e]:[_e,Fe];return tt>=1||ft<=0?{isOutOfView:!0}:(tt<0&&(tt=0),ft>1&&(ft=1),{isDraggingLeft:Fe>_e,left:`${tt*100}%`,width:`${(ft-tt)*100}%`})}function se(Fe,_e,tt,ft,Mt){const $t=z(Fe,_e,tt),Jt=z(Fe,_e,ft),nn=ee($t,Jt);if(ne(nn))return null;const{isDraggingLeft:Dn,left:In,width:ts}=nn,hs=te(),Yn=(0,n.cx)({[hs.TimelineViewingLayerDraggedDraggingRight]:!Dn,[hs.TimelineViewingLayerDraggedReframeDrag]:!Mt,[hs.TimelineViewingLayerDraggedShiftDrag]:Mt});return(0,t.jsx)("div",{className:(0,n.cx)(hs.TimelineViewingLayerDragged,hs.TimelineViewingLayerDraggedDraggingLeft,Yn),style:{left:In,width:ts},"data-testid":"Dragged"})}class ie extends i.PureComponent{constructor(_e){super(_e),this._setRoot=tt=>{this._root=tt},this._getDraggingBounds=()=>{if(!this._root)throw new Error("invalid state");const{left:tt,width:ft}=this._root.getBoundingClientRect();return{clientXLeft:tt,width:ft}},this._handleReframeMouseMove=({value:tt})=>{const[ft,Mt]=this.props.viewRangeTime.current,$t=le(ft,Mt,tt);this.props.updateNextViewRangeTime({cursor:$t})},this._handleReframeMouseLeave=()=>{this.props.updateNextViewRangeTime({cursor:void 0})},this._handleReframeDragUpdate=({value:tt})=>{const{current:ft,reframe:Mt}=this.props.viewRangeTime,[$t,Jt]=ft,nn=le($t,Jt,tt),In={reframe:{anchor:Mt?Mt.anchor:nn,shift:nn}};this.props.updateNextViewRangeTime(In)},this._handleReframeDragEnd=({manager:tt,value:ft})=>{const{current:Mt,reframe:$t}=this.props.viewRangeTime,[Jt,nn]=Mt,Dn=le(Jt,nn,ft),In=$t?$t.anchor:Dn,[ts,hs]=Dn<In?[Dn,In]:[In,Dn];tt.resetBounds(),this.props.updateViewRangeTime(ts,hs,"timeline-header")},this._draggerReframe=new q.default({getBounds:this._getDraggingBounds,onDragEnd:this._handleReframeDragEnd,onDragMove:this._handleReframeDragUpdate,onDragStart:this._handleReframeDragUpdate,onMouseLeave:this._handleReframeMouseLeave,onMouseMove:this._handleReframeMouseMove}),this._root=void 0}UNSAFE_componentWillReceiveProps(_e){const{boundsInvalidator:tt}=this.props;tt!==_e.boundsInvalidator&&this._draggerReframe.resetBounds()}componentWillUnmount(){this._draggerReframe.dispose()}render(){const{viewRangeTime:_e}=this.props,{current:tt,cursor:ft,reframe:Mt,shiftEnd:$t,shiftStart:Jt}=_e,[nn,Dn]=tt,In=Mt!=null||$t!=null||Jt!=null;let ts;!In&&ft!=null&&ft>=nn&&ft<=Dn&&(ts=`${z(nn,Dn,ft)*100}%`);const hs=te();return(0,t.jsxs)("div",{"aria-hidden":!0,className:hs.TimelineViewingLayer,ref:this._setRoot,onMouseDown:this._draggerReframe.handleMouseDown,onMouseLeave:this._draggerReframe.handleMouseLeave,onMouseMove:this._draggerReframe.handleMouseMove,"data-testid":"TimelineViewingLayer",children:[ts!=null&&(0,t.jsx)("div",{className:hs.TimelineViewingLayerCursorGuide,style:{left:ts},"data-testid":"TimelineViewingLayer--cursorGuide"}),Mt!=null&&se(nn,Dn,Mt.anchor,Mt.shift,!1),$t!=null&&se(nn,Dn,Dn,$t,!0),Jt!=null&&se(nn,Dn,nn,Jt,!0)]})}}const Z=Fe=>({TimelineHeaderRow:(0,n.css)`
      label: TimelineHeaderRow;
      background: ${(0,c.R)(Fe,"#ececec")};
      border-bottom: 1px solid ${(0,c.R)(Fe,"#ccc")};
      height: 38px;
      line-height: 38px;
      width: 100%;
      z-index: 4;
      position: relative;
    `,TimelineHeaderRowTitle:(0,n.css)`
      label: TimelineHeaderRowTitle;
      flex: 1;
      overflow: hidden;
      margin: 0;
      text-overflow: ellipsis;
      white-space: nowrap;
    `,TimelineHeaderWrapper:(0,n.css)`
      label: TimelineHeaderWrapper;
      align-items: center;
      display: flex;
      padding-left: ${Fe.spacing(1)};
      padding-right: ${Fe.spacing(1)};
    `});function oe(Fe){const{duration:_e,nameColumnWidth:tt,numTicks:ft,onCollapseAll:Mt,onCollapseOne:$t,onColummWidthChange:Jt,onExpandAll:nn,onExpandOne:Dn,updateViewRangeTime:In,updateNextViewRangeTime:ts,viewRangeTime:hs,columnResizeHandleHeight:Yn}=Fe,[bs,Ns]=hs.current,ns=(0,a.of)(Z);return(0,t.jsxs)(V,{className:ns.TimelineHeaderRow,"data-testid":"TimelineHeaderRow",children:[(0,t.jsxs)(V.Cell,{className:ns.TimelineHeaderWrapper,width:tt,children:[(0,t.jsx)("h4",{className:ns.TimelineHeaderRowTitle,children:"Service & Operation"}),(0,t.jsx)(J,{onCollapseAll:Mt,onExpandAll:nn,onCollapseOne:$t,onExpandOne:Dn})]}),(0,t.jsxs)(V.Cell,{width:1-tt,children:[(0,t.jsx)(ie,{boundsInvalidator:tt,updateNextViewRangeTime:ts,updateViewRangeTime:In,viewRangeTime:hs}),(0,t.jsx)(U,{numTicks:ft,startTime:bs*_e,endTime:Ns*_e,showLabels:!0})]}),(0,t.jsx)(j,{columnResizeHandleHeight:Yn,position:tt,onChange:Jt,min:.2,max:.85})]})}var ce=e(2543),ye=e(41811),re=e(27746);const ue="peer.service";var De=e(30700);class ge{constructor(_e){this.ys=[],this.heights=[],this.bufferLen=_e,this.dataLen=-1,this.lastI=-1}profileData(_e){_e!==this.dataLen&&(this.dataLen=_e,this.ys.length=_e,this.heights.length=_e,this.lastI>=_e&&(this.lastI=_e-1))}calcHeights(_e,tt,ft){ft!=null&&(this.lastI=ft);let Mt=_e+this.bufferLen;if(Mt<=this.lastI)return;Mt>=this.heights.length&&(Mt=this.heights.length-1);let $t=this.lastI;for(this.lastI===-1&&($t=0,this.ys[0]=0);$t<=Mt;){const Jt=this.heights[$t]=tt($t);this.ys[$t+1]=this.ys[$t]+Jt,$t++}this.lastI=Mt}calcYs(_e,tt){for(;(this.ys[this.lastI]==null||_e>this.ys[this.lastI])&&this.lastI<this.dataLen-1;)this.calcHeights(this.lastI,tt)}confirmHeight(_e,tt){let ft=_e;if(ft>this.lastI){this.calcHeights(ft,tt);return}const Mt=tt(ft);if(Mt===this.heights[ft])return;const $t=Mt-this.heights[ft];for(this.heights[ft]=Mt;++ft<=this.lastI;)this.ys[ft]+=$t;this.ys[this.lastI+1]!=null&&(this.ys[this.lastI+1]+=$t)}findFloorIndex(_e,tt){this.calcYs(_e,tt);let ft=0,Mt=this.lastI;if(this.ys.length<2||_e<this.ys[1])return 0;if(_e>this.ys[Mt])return Mt;let $t;for(;ft<Mt;)if($t=ft+.5*(Mt-ft)|0,_e>this.ys[$t]){if(_e<=this.ys[$t+1])return $t;ft=$t}else if(_e<this.ys[$t]){if(_e>=this.ys[$t-1])return $t-1;Mt=$t}else return $t;throw new Error(`unable to find floor index for y=${_e}`)}getRowPosition(_e,tt){return this.confirmHeight(_e,tt),{height:this.heights[_e],y:this.ys[_e]}}getEstimatedHeight(){const _e=this.ys[this.lastI]+this.heights[this.lastI];return this.lastI>=this.dataLen-1?_e|0:_e/(this.lastI+1)*this.heights.length|0}}const Te=100;class Le extends i.Component{constructor(_e){super(_e),this.getViewHeight=()=>this._viewHeight,this.getBottomVisibleIndex=()=>{const tt=this._scrollTop+this._viewHeight;return this._yPositions.findFloorIndex(tt,this._getHeight)},this.getTopVisibleIndex=()=>this._yPositions.findFloorIndex(this._scrollTop,this._getHeight),this.getRowPosition=tt=>this._yPositions.getRowPosition(tt,this._getHeight),this.scrollToIndex=(tt,ft)=>{const{scrollElement:Mt}=this.props,$t=Mt?.getBoundingClientRect().top||0,nn=(Mt?.scrollTop||0)+(this._itemHolderElm?.getBoundingClientRect().top||0)-$t,Dn=this.getRowPosition(tt).y;this.props.scrollElement?.scrollTo({top:Dn+nn-ft-80})},this._onScroll=()=>{this._isScrolledOrResized||(this._isScrolledOrResized=!0,window.requestAnimationFrame(this._positionList))},this._positionList=()=>{if(this._isScrolledOrResized=!1,!this._wrapperElm)return;this._calcViewIndexes();const tt=this.props.viewBufferMin>this._startIndex?0:this._startIndex-this.props.viewBufferMin,ft=this.props.viewBufferMin<this.props.dataLength-this._endIndex?this._endIndex+this.props.viewBufferMin:this.props.dataLength-1;(tt<this._startIndexDrawn||ft>this._endIndexDrawn)&&this.forceUpdate()},this._initWrapper=tt=>{this.props.windowScroller&&(this._wrapperElm=tt,tt&&(this._viewHeight=tt.clientHeight))},this._initItemHolder=tt=>{this._itemHolderElm=tt,this._scanItemHeights()},this._scanItemHeights=()=>{const tt=this.props.getIndexFromKey;if(!this._itemHolderElm)return;let ft=null,Mt=null,$t=!1;const Jt=this._itemHolderElm.childNodes,nn=Jt.length;for(let Dn=0;Dn<nn;Dn++){const In=Jt[Dn];if(In instanceof HTMLElement){const ts=In.getAttribute("data-item-key");if(!ts){console.warn("itemKey not found");continue}const Yn=(In.firstElementChild||In).clientHeight,bs=this._knownHeights.get(ts);Yn!==bs&&(this._knownHeights.set(ts,Yn),$t?Mt=ts:($t=!0,ft=Mt=ts))}}if(ft!=null&&Mt!=null){const Dn=tt(ft),In=Mt===ft?Dn:tt(Mt);this._yPositions.calcHeights(In,this._getHeight,Dn),this.forceUpdate()}},this._getHeight=tt=>{const ft=this.props.getKeyFromIndex(tt),Mt=this._knownHeights.get(ft);return Mt!=null&&Mt===Mt?Mt:this.props.itemHeightGetter(tt,ft)},this._yPositions=new ge(200),this._knownHeights=new Map,this._startIndexDrawn=2**20,this._endIndexDrawn=-(2**20),this._startIndex=0,this._endIndex=0,this._viewHeight=-1,this._scrollTop=-1,this._isScrolledOrResized=!1,this._htmlTopOffset=-1,this._windowScrollListenerAdded=!1,this._htmlElm=document.documentElement,this._wrapperElm=void 0,this._itemHolderElm=void 0}static{this.defaultProps={initialDraw:Te,itemsWrapperClassName:"",windowScroller:!1}}componentDidMount(){if(this.props.windowScroller){if(this._wrapperElm){const{top:_e}=this._wrapperElm.getBoundingClientRect();this._htmlTopOffset=_e+this._htmlElm.scrollTop}window.addEventListener("scroll",this._onScroll),this._windowScrollListenerAdded=!0}else this._wrapperElm=this.props.scrollElement,this._wrapperElm?.addEventListener("scroll",this._onScroll)}componentDidUpdate(_e){this._itemHolderElm&&this._scanItemHeights(),!this.props.windowScroller&&_e.scrollElement!==this.props.scrollElement&&(_e.scrollElement?.removeEventListener("scroll",this._onScroll),this._wrapperElm=this.props.scrollElement,this._wrapperElm?.addEventListener("scroll",this._onScroll))}componentWillUnmount(){this._windowScrollListenerAdded?window.removeEventListener("scroll",this._onScroll):this._wrapperElm?.removeEventListener("scroll",this._onScroll)}_isViewChanged(){if(!this._wrapperElm)return!1;const _e=this.props.windowScroller,tt=_e?this._htmlElm.clientHeight:this._wrapperElm.clientHeight,ft=_e?this._htmlElm.scrollTop:this._wrapperElm.scrollTop;return tt!==this._viewHeight||ft!==this._scrollTop}_calcViewIndexes(){if(this.props.windowScroller)this._viewHeight=window.innerHeight-this._htmlTopOffset,this._scrollTop=window.scrollY;else{if(!this._wrapperElm){this._viewHeight=-1,this._startIndex=0,this._endIndex=0;return}this._viewHeight=this._wrapperElm.clientHeight,this._scrollTop=this._wrapperElm.scrollTop}const tt=this._scrollTop,ft=this._scrollTop+this._viewHeight;this._startIndex=this._yPositions.findFloorIndex(tt,this._getHeight),this._endIndex=this._yPositions.findFloorIndex(ft,this._getHeight)}render(){const{dataLength:_e,getKeyFromIndex:tt,initialDraw:ft=Te,itemRenderer:Mt,viewBuffer:$t,viewBufferMin:Jt}=this.props,nn=this._getHeight,Dn=[];let In,ts;if(this._yPositions.profileData(_e),!this._wrapperElm)In=0,ts=(ft<_e?ft:_e)-1;else{this._isViewChanged()&&this._calcViewIndexes();const bs=Jt>this._startIndex?0:this._startIndex-Jt,Ns=Jt<_e-this._endIndex?this._endIndex+Jt:_e-1;bs<this._startIndexDrawn||Ns>this._endIndexDrawn?(In=$t>this._startIndex?0:this._startIndex-$t,ts=this._endIndex+$t,ts>=_e&&(ts=_e-1)):(In=this._startIndexDrawn>_e-1?0:this._startIndexDrawn,ts=this._endIndexDrawn>_e-1?_e-1:this._endIndexDrawn)}this._yPositions.calcHeights(ts,nn,In||-1),this._startIndexDrawn=In,this._endIndexDrawn=ts,Dn.length=ts-In+1;for(let bs=In;bs<=ts;bs++){const{y:Ns,height:ns}=this._yPositions.getRowPosition(bs,nn),ta={height:ns,top:Ns,position:"absolute"},Ms=tt(bs),Qs={"data-item-key":Ms};Dn.push(Mt(Ms,ta,bs,Qs))}const hs={style:{position:"relative"},ref:this._initWrapper};this.props.windowScroller||(hs.onScroll=this._onScroll,hs.style.height="100%",hs.style.overflowY="auto");const Yn={position:"relative",height:this._yPositions.getEstimatedHeight()};return(0,t.jsx)("div",{...hs,"data-testid":"ListView",children:(0,t.jsx)("div",{style:Yn,children:(0,t.jsx)("div",{style:{position:"absolute",top:0,margin:0,padding:0},className:this.props.itemsWrapperClassName,ref:this._initItemHolder,children:Dn})})})}}const Ye="None",je="Duration",Ze="Tag";function Ne({options:Fe,onOptionsChange:_e}){const tt=useStyles2(Ue),ft=[Ye,je,Ze].map(toOption);return jsxs("div",{className:css({width:"100%"}),children:[jsx(InlineFieldRow,{className:tt.row,children:jsx(InlineField,{label:"Label",labelWidth:26,tooltip:"Default: duration",grow:!0,children:jsx(Select,{inputId:"label",options:ft,value:Fe.jsonData.spanBar?.type||"",onChange:Mt=>{updateDatasourcePluginJsonDataOption({onOptionsChange:_e,options:Fe},"spanBar",{...Fe.jsonData.spanBar,type:Mt?.value??""})},placeholder:"Duration",isClearable:!0,"aria-label":"select-label-name",width:40})})}),Fe.jsonData.spanBar?.type===Ze&&jsx(InlineFieldRow,{className:tt.row,children:jsx(InlineField,{label:"Tag key",labelWidth:26,tooltip:"Tag key which will be used to get the tag value. A span's attributes and resources will be searched for the tag key",children:jsx(Input,{type:"text",placeholder:"Enter tag key",onChange:Mt=>updateDatasourcePluginJsonDataOption({onOptionsChange:_e,options:Fe},"spanBar",{...Fe.jsonData.spanBar,tag:Mt.currentTarget.value}),value:Fe.jsonData.spanBar?.tag||"",width:40})})})]})}const Pe=({options:Fe,onOptionsChange:_e})=>{let tt=Fe.type;return tt+=Fe.type==="tempo"?"/configure-tempo-data-source/#span-bar":"/#span-bar",jsx(ConfigSubSection,{title:"Span bar",description:jsx(ConfigDescriptionLink,{description:"Add additional info next to the service and operation on a span bar row in the trace view.",suffix:tt,feature:"the span bar"}),children:jsx(Ne,{options:Fe,onOptionsChange:_e})})},Ue=Fe=>({infoText:css({label:"infoText",paddingBottom:Fe.spacing(2),color:Fe.colors.text.secondary}),row:css({label:"row",alignItems:"baseline"})});var $e=e(14578),ze=e(13544),qe=e(56034),dt=e(95868),vt=e(13840);function yt({children:Fe,content:_e,overlayClassName:tt}){const ft=(0,i.useRef)(null);return(0,t.jsx)(dt.I,{content:_e,hideAfter:300,children:(Mt,$t,Jt)=>(0,t.jsxs)(t.Fragment,{children:[ft.current&&(0,t.jsx)(vt.A,{...Jt,referenceElement:ft.current,wrapperClassName:tt,onMouseLeave:$t,onMouseEnter:Mt}),(0,i.cloneElement)(Fe,{ref:ft,onMouseEnter:Mt,onMouseLeave:$t})]})})}const st="label";var Ve=e(55852);const pe=()=>({CopyIcon:(0,n.css)`
      background-color: transparent;
      border: none;
      color: inherit;
      height: 100%;
      overflow: hidden;
      &:focus {
        background-color: rgba(255, 255, 255, 0.25);
        color: inherit;
      }
    `});function Ee({copyText:Fe,icon:_e="copy",tooltipTitle:tt}){const ft=(0,a.of)(pe),[Mt,$t]=(0,i.useState)(!1),Jt=()=>{navigator.clipboard.writeText(Fe),$t(!0)};return(0,t.jsx)(qe.m,{content:Mt?"Copied":tt,children:(0,t.jsx)(Ve.$n,{className:u()(ft.CopyIcon),type:"button",icon:_e,onClick:Jt})})}var me=e(72834),ve=e.n(me);const Se="copyIcon",Ie=Fe=>({KeyValueTable:(0,n.css)`
      label: KeyValueTable;
      background: ${(0,c.R)(Fe,"#fff")};
      border: 1px solid ${(0,c.R)(Fe,"#ddd")};
      margin-bottom: 0.5rem;
      max-height: 450px;
      overflow: auto;
    `,table:(0,n.css)({width:"100%"}),body:(0,n.css)`
      label: body;
      vertical-align: baseline;
    `,row:(0,n.css)`
      label: row;
      & > td {
        padding: 0rem 0.5rem;
        height: 30px;
      }
      &:nth-child(2n) > td {
        background: ${(0,c.R)(Fe,"#f5f5f5")};
      }
      &:not(:hover) .${Se} {
        visibility: hidden;
      }
    `,keyColumn:(0,n.css)`
      label: keyColumn;
      color: ${(0,c.R)(Fe,"#888")};
      white-space: pre;
      width: 125px;
    `,copyColumn:(0,n.css)`
      label: copyColumn;
      text-align: right;
    `,linkIcon:(0,n.css)`
      label: linkIcon;
      vertical-align: middle;
      font-weight: bold;
    `,jsonTable:(0,n.css)({display:"inline-block"})}),Oe=/^(\[|\{)/;function Re(Fe){if(typeof Fe=="string"&&Oe.test(Fe))try{return JSON.parse(Fe)}catch{}return Fe}const he=({href:Fe,title:_e="",children:tt})=>(0,t.jsxs)("a",{href:Fe,title:_e,target:"_blank",rel:"noopener noreferrer",children:[tt," ",(0,t.jsx)($e.I,{name:"external-link-alt"})]});function Ce(Fe){const{data:_e,linksGetter:tt}=Fe,ft=(0,a.of)(Ie);return(0,t.jsx)("div",{className:u()(ft.KeyValueTable),"data-testid":"KeyValueTable",children:(0,t.jsx)("table",{className:ft.table,children:(0,t.jsx)("tbody",{className:ft.body,children:_e.map((Mt,$t)=>{const Jt={__html:ve()(Re(Mt.value))},nn=(0,t.jsx)("div",{className:ft.jsonTable,dangerouslySetInnerHTML:Jt}),Dn=tt?tt(_e,$t):null;let In;return Dn&&Dn.length?In=(0,t.jsx)("div",{children:(0,t.jsx)(he,{href:Dn[0].url,title:Dn[0].text,children:nn})}):In=nn,(0,t.jsxs)("tr",{className:ft.row,children:[(0,t.jsx)("td",{className:ft.keyColumn,"data-testid":"KeyValueTable--keyColumn",children:Mt.key}),(0,t.jsx)("td",{children:In}),(0,t.jsx)("td",{className:ft.copyColumn,children:(0,t.jsx)(Ee,{className:Se,copyText:JSON.stringify(Mt,null,2),tooltipTitle:"Copy JSON"})})]},`${Mt.key}-${$t}`)})})})})}var We=e(11908),et=e(72724),rt=e(39601),nt=e(14689),gt=e(25994),xt=e(21744),St=e(19071),zt=e(28114);const Nt=Fe=>_e=>({LabeledList:(0,n.css)`
      label: LabeledList;
      list-style: none;
      margin: 0;
      padding: 0;
      ${Fe&&`
        margin-right: -8px;
        display: flex;
        flex-wrap: wrap;
        justify-content: flex-end;
      `}
    `,LabeledListItem:(0,n.css)`
      label: LabeledListItem;
      display: inline-block;
      ${Fe&&`
        border-right: 1px solid ${(0,c.R)(_e,"#ddd")};
        padding: 0 8px;
      `}
    `,LabeledListLabel:(0,n.css)`
      label: LabeledListLabel;
      color: ${_e.isLight?"#999":"#666"};
      margin-right: 0.25rem;
    `,LabeledListValue:(0,n.css)`
      label: LabeledListValue;
      ${!Fe&&"margin-right: 0.55rem;"}
    `});function Vt(Fe){const{className:_e,divider:tt=!1,items:ft}=Fe,Mt=(0,a.of)(Nt(tt));return(0,t.jsx)("ul",{className:u()(Mt.LabeledList,_e),children:ft.map(({key:$t,label:Jt,value:nn})=>(0,t.jsxs)("li",{className:Mt.LabeledListItem,children:[(0,t.jsx)("span",{className:Mt.LabeledListLabel,children:Jt}),(0,t.jsx)("strong",{className:Mt.LabeledListValue,children:nn})]},`${$t}`))})}const en="kind",Je="status",ct="status.message",ot="library.name",Qe="library.version",pt="trace.state",Pt="id";var At=e(92102);function mn(Fe){const{reference:_e,children:tt,createFocusSpanLink:ft}=Fe,Mt=ft(_e.traceID,_e.spanID);return(0,t.jsx)("a",{href:Mt.href,target:Mt.target,rel:"noopener noreferrer",onClick:Mt.onClick?$t=>{$t.preventDefault(),Mt.onClick($t)}:void 0,children:tt})}const Pn=Fe=>({AccordianReferenceItem:(0,n.css)`
      border-bottom: 1px solid ${(0,c.R)(Fe,"#d8d8d8")};
    `,AccordianKeyValues:(0,n.css)`
      margin-left: 10px;
    `,AccordianReferences:(0,n.css)`
      label: AccordianReferences;
      border: 1px solid ${(0,c.R)(Fe,"#d8d8d8")};
      position: relative;
      margin-bottom: 0.25rem;
    `,AccordianReferencesHeader:(0,n.css)`
      label: AccordianReferencesHeader;
      background: ${(0,c.R)(Fe,"#e4e4e4")};
      color: inherit;
      display: block;
      padding: 0.25rem 0.5rem;
      &:hover {
        background: ${(0,c.R)(Fe,"#dadada")};
      }
    `,AccordianReferencesContent:(0,n.css)`
      label: AccordianReferencesContent;
      background: ${(0,c.R)(Fe,"#f0f0f0")};
      border-top: 1px solid ${(0,c.R)(Fe,"#d8d8d8")};
      padding: 0.5rem 0.5rem 0.25rem 0.5rem;
    `,AccordianReferencesFooter:(0,n.css)`
      label: AccordianReferencesFooter;
      color: ${(0,c.R)(Fe,"#999")};
    `,AccordianKeyValuesItem:(0,n.css)({marginBottom:Fe.spacing(.5)}),ReferencesList:(0,n.css)`
      background: #fff;
      border: 1px solid #ddd;
      margin-bottom: 0.7em;
      max-height: 450px;
      overflow: auto;
    `,list:(0,n.css)`
      width: 100%;
      list-style: none;
      padding: 0;
      margin: 0;
      background: #fff;
    `,itemContent:(0,n.css)`
      padding: 0.25rem 0.5rem;
      display: flex;
      width: 100%;
      justify-content: space-between;
    `,item:(0,n.css)`
      &:nth-child(2n) {
        background: #f5f5f5;
      }
    `,debugInfo:(0,n.css)`
      letter-spacing: 0.25px;
      margin: 0.5em 0 0;
      flex-wrap: wrap;
      display: flex;
      justify-content: flex-end;
    `,debugLabel:(0,n.css)`
      margin: 0 5px 0 5px;
      &::before {
        color: #bbb;
        content: attr(data-label);
      }
    `,serviceName:(0,n.css)`
      margin-right: 8px;
    `,title:(0,n.css)`
      display: flex;
      align-items: center;
      gap: 4px;
    `});function fn(Fe){const{data:_e,createFocusSpanLink:tt,openedItems:ft,onItemToggle:Mt,interactive:$t}=Fe,Jt=(0,a.of)(Pn);return(0,t.jsx)("div",{className:Jt.AccordianReferencesContent,children:_e.map((nn,Dn)=>(0,t.jsxs)("div",{className:Dn<_e.length-1?Jt.AccordianReferenceItem:void 0,children:[(0,t.jsx)("div",{className:Jt.item,children:(0,t.jsx)(mn,{reference:nn,createFocusSpanLink:tt,children:(0,t.jsxs)("span",{className:Jt.itemContent,children:[nn.span?(0,t.jsxs)("span",{children:[(0,t.jsx)("span",{className:(0,n.cx)("span-svc-name",Jt.serviceName),children:nn.span.process.serviceName}),(0,t.jsx)("small",{className:"endpoint-name",children:nn.span.operationName})]}):(0,t.jsxs)("span",{className:(0,n.cx)("span-svc-name",Jt.title),children:["View Linked Span ",(0,t.jsx)($e.I,{name:"external-link-alt"})]}),(0,t.jsxs)("small",{className:Jt.debugInfo,children:[(0,t.jsx)("span",{className:Jt.debugLabel,"data-label":"TraceID:",children:nn.traceID}),(0,t.jsx)("span",{className:Jt.debugLabel,"data-label":"SpanID:",children:nn.spanID})]})]})})},`${nn.spanID}`),!!nn.tags?.length&&(0,t.jsx)("div",{className:Jt.AccordianKeyValues,children:(0,t.jsx)(Zt,{className:Dn<_e.length-1?Jt.AccordianKeyValuesItem:null,data:nn.tags||[],highContrast:!0,interactive:$t,isOpen:ft?ft.has(nn):!1,label:"attributes",linksGetter:null,onToggle:$t&&Mt?()=>Mt(nn):null})})]},Dn))})}const Rn=({data:Fe,interactive:_e=!0,isOpen:tt,onToggle:ft,onItemToggle:Mt,openedItems:$t,createFocusSpanLink:Jt})=>{const nn=!Array.isArray(Fe)||!Fe.length;let Dn=null,In="span",ts=null;_e&&(Dn=tt?(0,t.jsx)($e.I,{name:"angle-down",className:Nn}):(0,t.jsx)($e.I,{name:"angle-right",className:Nn}),In="a",ts={"aria-checked":tt,onClick:nn?null:ft,role:"switch"});const hs=(0,a.of)(Pn);return(0,t.jsxs)("div",{className:hs.AccordianReferences,children:[(0,t.jsxs)(In,{className:hs.AccordianReferencesHeader,...ts,children:[Dn,(0,t.jsx)("strong",{children:(0,t.jsx)("span",{children:"References"})})," ","(",Fe.length,")"]}),tt&&(0,t.jsx)(fn,{data:Fe,openedItems:$t,createFocusSpanLink:Jt,onItemToggle:Mt,interactive:_e})]})},Kn=i.memo(Rn),Bt=()=>({TextList:(0,n.css)`
      max-height: 450px;
      overflow: auto;
    `,List:(0,n.css)`
      width: 100%;
      list-style: none;
      padding: 0;
      margin: 0;
    `,item:(0,n.css)`
      padding: 0.25rem 0.5rem;
      vertical-align: top;
      &:nth-child(2n) {
        background: #f5f5f5;
      }
    `});function an(Fe){const{data:_e}=Fe,tt=(0,a.of)(Bt);return(0,t.jsx)("div",{className:u()(tt.TextList),"data-testid":"TextList",children:(0,t.jsx)("ul",{className:tt.List,children:_e.map((ft,Mt)=>(0,t.jsx)("li",{className:tt.item,children:ft},`${Mt}`))})})}const tn=Fe=>({header:(0,n.css)`
      cursor: pointer;
      overflow: hidden;
      padding: 0.25em 0.1em;
      text-overflow: ellipsis;
      white-space: nowrap;
      &:hover {
        background: ${(0,c.R)(Fe,"#e8e8e8")};
      }
    `});function Cn({data:Fe}){return(0,t.jsx)(an,{data:Fe})}function xn({className:Fe=null,data:_e,headerClassName:tt,highContrast:ft=!1,interactive:Mt=!0,isOpen:$t,label:Jt,onToggle:nn=null,TextComponent:Dn=Cn}){const In=!Array.isArray(_e)||!_e.length,ts=(0,a.of)(jt),hs=u()(Nn,{[ts.emptyIcon]:In});let Yn=null,bs=null;Mt&&(Yn=$t?(0,t.jsx)($e.I,{name:"angle-down",className:hs}):(0,t.jsx)($e.I,{name:"angle-right",className:hs}),bs={"aria-checked":$t,onClick:In?null:nn,role:"switch"});const Ns=(0,a.of)(tn);return(0,t.jsxs)("div",{className:Fe||"",children:[(0,t.jsxs)("div",{className:u()(Ns.header,tt),...bs,"data-testid":"AccordianText--header",children:[Yn,(0,t.jsx)("strong",{children:Jt})," (",_e.length,")"]}),$t&&(0,t.jsx)(Dn,{data:_e})]})}var Vn=e(49185),Et=e(75505),Ft=e(47232),Gt=e(41987),ln=e(85194),qt=e(26657),cn=e(72574),En=e(31193);function Sn(Fe){const{span:_e,traceToProfilesOptions:tt,timeZone:ft,traceFlameGraphs:Mt,setTraceFlameGraphs:$t,setRedrawListView:Jt,traceDuration:nn,traceName:Dn}=Fe,[In,{height:ts}]=(0,Vn.A)(),hs=(0,a.of)(Tn),Yn=_e.tags.filter(Ms=>Ms.key===zt.QW),bs=Yn.length>0?Yn[0].value:void 0,Ns=(0,i.useCallback)(()=>{const Ms=Math.floor(_e.startTime/1e3)-3e4,Qs=(_e.startTime+_e.duration)/1e3+3e4,oa=(0,Ft.KQ)(Qs),ms=(0,Ft.KQ)(Ms);return{from:ms,to:oa,raw:{from:ms,to:oa}}},[_e.duration,_e.startTime]),ns=async(Ms,Qs)=>{const oa=await(0,En.tR)().get(Qs);if(oa instanceof qt.iy){const xa=(await(0,Et.s)(oa.query(Ms))).data.find(Ua=>Ua.name==="response");if(xa&&xa.length>1)return xa}},ta=(0,i.useCallback)(async(Ms,Qs,oa)=>{let ms="{}";if(Qs.customQuery&&Qs.query){const _a={...(0,zt.gt)(nn,Dn,oa.traceID),...(0,zt.hv)(oa),...(0,zt.Cr)(oa,Qs)};ms=(0,cn.w)().replace(Qs.query,_a)}else{const _a=Qs.tags&&Qs.tags.length>0?Qs.tags:zt.i0;ms=`{${(0,zt._o)(oa,_a)}}`}const xa={requestId:"span-flamegraph-requestId",interval:"2s",intervalMs:2e3,range:Ns(),scopedVars:{},app:Gt.Jk.Unknown,timezone:ft,startTime:oa.startTime,targets:[{labelSelector:ms,groupBy:[],profileTypeId:Qs.profileTypeId??"",queryType:"profile",spanSelector:[bs],refId:"span-flamegraph-refId",datasource:{type:Ms.type,uid:Ms.uid}}]},Ua=await ns(xa,Ms.uid);Ua&&Ua.length>0&&$t({...Mt,[bs]:Ua})},[Ns,bs,$t,ft,nn,Mt,Dn]);return(0,i.useEffect)(()=>{if(!Object.keys(Mt).includes(bs)){let Ms;tt&&tt?.datasourceUid&&(Ms=(0,En.tR)().getInstanceSettings(tt.datasourceUid)),tt&&Ms&&ta(Ms,tt,_e)}},[$t,_e,Mt,tt,Ns,ft,ta,bs]),(0,i.useEffect)(()=>{Jt({})},[ts,Jt]),Mt[bs]?(0,t.jsxs)("div",{className:hs.flameGraph,ref:In,children:[(0,t.jsx)("div",{className:hs.flameGraphTitle,children:"Flame graph"}),(0,t.jsx)(ln.A,{data:Mt[bs],getTheme:()=>r.$.theme2,showFlameGraphOnly:!0,disableCollapsing:!0})]}):(0,t.jsx)(t.Fragment,{})}const Tn=()=>({flameGraph:(0,n.css)({label:"flameGraphInSpan",margin:"5px"}),flameGraphTitle:(0,n.css)({label:"flameGraphTitleInSpan",marginBottom:"5px",fontWeight:"bold"})}),Wn=Fe=>({header:(0,n.css)`
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: 0 1rem;
      margin-bottom: 0.25rem;
    `,listWrapper:(0,n.css)`
      overflow: hidden;
    `,list:(0,n.css)({textAlign:"right"}),operationName:(0,n.css)({margin:0}),debugInfo:(0,n.css)`
      label: debugInfo;
      display: block;
      letter-spacing: 0.25px;
      margin: 0.5em 0 -0.75em;
      text-align: right;
    `,debugLabel:(0,n.css)`
      label: debugLabel;
      &::before {
        color: ${(0,c.R)(Fe,"#bbb")};
        content: attr(data-label);
      }
    `,debugValue:(0,n.css)`
      label: debugValue;
      background-color: inherit;
      border: none;
      color: ${(0,c.R)(Fe,"#888")};
      cursor: pointer;
      &:hover {
        color: ${(0,c.R)(Fe,"#333")};
      }
    `,AccordianWarnings:(0,n.css)`
      label: AccordianWarnings;
      background: ${(0,c.R)(Fe,"#fafafa")};
      border: 1px solid ${(0,c.R)(Fe,"#e4e4e4")};
      margin-bottom: 0.25rem;
    `,AccordianWarningsHeader:(0,n.css)`
      label: AccordianWarningsHeader;
      background: ${(0,c.R)(Fe,"#fff7e6")};
      padding: 0.25rem 0.5rem;
      &:hover {
        background: ${(0,c.R)(Fe,"#ffe7ba")};
      }
    `,AccordianWarningsHeaderOpen:(0,n.css)`
      label: AccordianWarningsHeaderOpen;
      border-bottom: 1px solid ${(0,c.R)(Fe,"#e8e8e8")};
    `,AccordianWarningsLabel:(0,n.css)`
      label: AccordianWarningsLabel;
      color: ${(0,c.R)(Fe,"#d36c08")};
    `,AccordianKeyValuesItem:(0,n.css)({marginBottom:Fe.spacing(.5)}),Textarea:(0,n.css)`
      word-break: break-all;
      white-space: pre;
    `,LinkIcon:(0,n.css)`
      font-size: 1.5em;
    `,linkList:(0,n.css)({display:"flex",flexWrap:"wrap",gap:"10px"})}),Nn=(0,n.css)({margin:"-0.2rem 0.25rem 0 0"});function Tt(Fe){const{detailState:_e,linksGetter:tt,logItemToggle:ft,logsToggle:Mt,processToggle:$t,span:Jt,tagsToggle:nn,traceStartTime:Dn,traceDuration:In,traceName:ts,warningsToggle:hs,stackTracesToggle:Yn,referencesToggle:bs,referenceItemToggle:Ns,createSpanLink:ns,createFocusSpanLink:ta,datasourceType:Ms,traceFlameGraphs:Qs,setTraceFlameGraphs:oa,traceToProfilesOptions:ms,setRedrawListView:xa}=Fe,{isTagsOpen:Ua,isProcessOpen:_a,logs:La,isWarningsOpen:va,references:wa,isStackTracesOpen:Kr}=_e,{operationName:Pr,process:fr,duration:Qr,relativeStartTime:$r,startTime:Zr,traceID:co,spanID:gr,logs:as,tags:ls,warnings:Cs,references:zs,stackTraces:Nr}=Jt,{timeZone:Ge}=Fe;let Ae=[{key:"svc",label:"Service:",value:fr.serviceName},{key:"duration",label:"Duration:",value:(0,D.a3)(Qr)},{key:"start",label:"Start Time:",value:(0,D.a3)($r)+Wt(Zr,Ge)},...Jt.childSpanCount>0?[{key:"child_count",label:"Child Count:",value:Jt.childSpanCount}]:[]];const Ke=(0,a.of)(Wn);Jt.kind&&Ae.push({key:en,label:"Kind:",value:Jt.kind}),Jt.statusCode!==void 0&&Ae.push({key:Je,label:"Status:",value:We.s[Jt.statusCode].toLowerCase()}),Jt.statusMessage&&Ae.push({key:ct,label:"Status Message:",value:Jt.statusMessage}),Jt.instrumentationLibraryName&&Ae.push({key:ot,label:"Library Name:",value:Jt.instrumentationLibraryName}),Jt.instrumentationLibraryVersion&&Ae.push({key:Qe,label:"Library Version:",value:Jt.instrumentationLibraryVersion}),Jt.traceState&&Ae.push({key:pt,label:"Trace State:",value:Jt.traceState});const lt=(yn,Mn,is,rs)=>(0,t.jsx)(nt.R,{link:{...yn,title:is,target:"_blank",origin:yn.field,onClick:ws=>{(0,s.rR)("grafana_traces_trace_view_span_link_clicked",{datasourceType:Ms,grafana_version:r.$.buildInfo.version,type:Mn,location:"spanDetails"}),yn.onClick?yn.onClick?.(ws):rt.Ny.push(yn.href)}},buttonProps:{icon:rs}});let It=null,Xt=null,Yt=null;if(ns){const yn=ns(Jt),Mn=yn?.filter(ws=>ws.type===At.N.Logs);yn&&Mn&&Mn.length>0&&(It=lt(Mn[0],At.N.Logs,"Logs for this span","gf-logs"));const is=yn?.filter(ws=>ws.type===At.N.Profiles&&ws.title===St.cd);yn&&is&&is.length>0&&(Xt=lt(is[0],At.N.Profiles,"Profiles for this span","link"));const rs=yn?.filter(ws=>ws.type===At.N.Session);yn&&rs&&rs.length>0&&(Yt=lt(rs[0],At.N.Session,"Session for this span","frontend-observability"))}const gn=ta(co,gr);return(0,t.jsxs)("div",{"data-testid":"span-detail-component",children:[(0,t.jsxs)("div",{className:Ke.header,children:[(0,t.jsx)("h2",{className:Ke.operationName,children:Pr}),(0,t.jsx)("div",{className:Ke.listWrapper,children:(0,t.jsx)(Vt,{className:Ke.list,divider:!0,items:Ae})})]}),(0,t.jsxs)("div",{className:Ke.linkList,children:[It,Xt,Yt]}),(0,t.jsx)(gt.c,{spacing:1}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(Zt,{data:ls,label:"Span Attributes",linksGetter:tt,isOpen:Ua,onToggle:()=>nn(gr)}),fr.tags&&(0,t.jsx)(Zt,{className:Ke.AccordianKeyValuesItem,data:fr.tags,label:"Resource Attributes",linksGetter:tt,isOpen:_a,onToggle:()=>$t(gr)})]}),as&&as.length>0&&(0,t.jsx)(Xn,{linksGetter:tt,logs:as,isOpen:La.isOpen,openedItems:La.openedItems,onToggle:()=>Mt(gr),onItemToggle:yn=>ft(gr,yn),timestamp:Dn}),Cs&&Cs.length>0&&(0,t.jsx)(xn,{className:Ke.AccordianWarnings,headerClassName:Ke.AccordianWarningsHeader,label:(0,t.jsx)("span",{className:Ke.AccordianWarningsLabel,children:"Warnings"}),data:Cs,isOpen:va,onToggle:()=>hs(gr)}),Nr?.length?(0,t.jsx)(xn,{label:"Stack trace",data:Nr,isOpen:Kr,TextComponent:yn=>{let Mn;return yn.data?.length>1?Mn=yn.data.map((is,rs)=>`StackTrace ${rs+1}:
${is}`).join(`
`):Mn=yn.data?.[0],(0,t.jsx)(xt.f,{className:Ke.Textarea,style:{cursor:"unset"},readOnly:!0,cols:10,rows:10,value:Mn})},onToggle:()=>Yn(gr)}):null,zs&&zs.length>0&&(zs.length>1||zs[0].refType!=="CHILD_OF")&&(0,t.jsx)(Kn,{data:zs,isOpen:wa.isOpen,openedItems:wa.openedItems,onToggle:()=>bs(gr),onItemToggle:yn=>Ns(gr,yn),createFocusSpanLink:ta}),Jt.tags.some(yn=>yn.key===zt.QW)&&(0,t.jsx)(Sn,{span:Jt,timeZone:Ge,traceFlameGraphs:Qs,setTraceFlameGraphs:oa,traceToProfilesOptions:ms,setRedrawListView:xa,traceDuration:In,traceName:ts}),(0,t.jsxs)("small",{className:Ke.debugInfo,children:[(0,t.jsx)("a",{...gn,onClick:yn=>{gn.onClick&&yn.button===0&&(!yn.currentTarget.target||yn.currentTarget.target==="_self")&&!(yn.metaKey||yn.altKey||yn.ctrlKey||yn.shiftKey)&&(yn.preventDefault(),gn.onClick(yn))},children:(0,t.jsx)($e.I,{name:"link",className:u()(Nn,Ke.LinkIcon)})}),(0,t.jsx)("span",{className:Ke.debugLabel,"data-label":"SpanID:"})," ",gr]})]})]})}const Wt=(Fe,_e)=>{const tt=(0,et.LE)(Fe/1e3,{timeZone:_e,defaultWithMS:!0}),ft=tt.split(" ");return` (${ft[1]?ft[1]:tt})`},jt=Fe=>({container:(0,n.css)({textOverflow:"ellipsis"}),header:(0,n.css)`
      label: header;
      cursor: pointer;
      overflow: hidden;
      padding: 0.25em 0.1em;
      text-overflow: ellipsis;
      white-space: nowrap;
      &:hover {
        background: ${(0,c.R)(Fe,"#e8e8e8")};
      }
    `,headerEmpty:(0,n.css)`
      label: headerEmpty;
      background: none;
      cursor: initial;
    `,headerHighContrast:(0,n.css)`
      label: headerHighContrast;
      &:hover {
        background: ${(0,c.R)(Fe,"#ddd")};
      }
    `,emptyIcon:(0,n.css)`
      label: emptyIcon;
      color: ${(0,c.R)(Fe,"#aaa")};
    `,summary:(0,n.css)`
      label: summary;
      display: inline;
      list-style: none;
      padding: 0;
    `,summaryItem:(0,n.css)`
      label: summaryItem;
      display: inline;
      margin-left: 0.7em;
      padding-right: 0.5rem;
      border-right: 1px solid ${(0,c.R)(Fe,"#ddd")};
      &:last-child {
        padding-right: 0;
        border-right: none;
      }
    `,summaryLabel:(0,n.css)`
      label: summaryLabel;
      color: ${(0,c.R)(Fe,"#777")};
    `,summaryDelim:(0,n.css)`
      label: summaryDelim;
      color: ${(0,c.R)(Fe,"#bbb")};
      padding: 0 0.2em;
    `});function ut({data:Fe=null}){const _e=(0,a.of)(jt);return!Array.isArray(Fe)||!Fe.length?null:(0,t.jsx)("ul",{className:_e.summary,children:Fe.map((tt,ft)=>(0,t.jsxs)("li",{className:_e.summaryItem,children:[(0,t.jsx)("span",{className:_e.summaryLabel,children:tt.key}),(0,t.jsx)("span",{className:_e.summaryDelim,children:"="}),String(tt.value)]},`${tt.key}-${ft}`))})}function Zt({className:Fe=null,data:_e,highContrast:tt=!1,interactive:ft=!0,isOpen:Mt,label:$t,linksGetter:Jt,onToggle:nn=null}){const Dn=!Array.isArray(_e)||!_e.length,In=(0,a.of)(jt),ts=u()(Nn,{[In.emptyIcon]:Dn});let hs=null,Yn=null;return ft&&(hs=Mt?(0,t.jsx)($e.I,{name:"angle-down",className:ts}):(0,t.jsx)($e.I,{name:"angle-right",className:ts}),Yn={"aria-checked":Mt,onClick:Dn?null:nn,role:"switch"}),(0,t.jsxs)("div",{className:u()(Fe,In.container),children:[(0,t.jsxs)("div",{className:u()(In.header,{[In.headerEmpty]:Dn,[In.headerHighContrast]:tt&&!Dn}),...Yn,"data-testid":"AccordianKeyValues--header",children:[hs,(0,t.jsxs)("strong",{"data-test":st,children:[$t,Mt||":"]}),!Mt&&(0,t.jsx)(ut,{data:_e})]}),Mt&&(0,t.jsx)(Ce,{data:_e,linksGetter:Jt})]})}const jn=Fe=>({AccordianLogs:(0,n.css)`
      label: AccordianLogs;
      border: 1px solid ${(0,c.R)(Fe,"#d8d8d8")};
      position: relative;
      margin-bottom: 0.25rem;
    `,AccordianLogsHeader:(0,n.css)`
      label: AccordianLogsHeader;
      background: ${(0,c.R)(Fe,"#e4e4e4")};
      color: inherit;
      display: block;
      padding: 0.25rem 0.5rem;
      &:hover {
        background: ${(0,c.R)(Fe,"#dadada")};
      }
    `,AccordianLogsContent:(0,n.css)`
      label: AccordianLogsContent;
      background: ${(0,c.R)(Fe,"#f0f0f0")};
      border-top: 1px solid ${(0,c.R)(Fe,"#d8d8d8")};
      padding: 0.5rem 0.5rem 0.25rem 0.5rem;
    `,AccordianLogsFooter:(0,n.css)`
      label: AccordianLogsFooter;
      color: ${(0,c.R)(Fe,"#999")};
    `,AccordianKeyValuesItem:(0,n.css)({marginBottom:Fe.spacing(.5)})});function Xn({interactive:Fe=!0,isOpen:_e,linksGetter:tt,logs:ft,openedItems:Mt,onItemToggle:$t,onToggle:Jt,timestamp:nn}){let Dn=null,In="span",ts=null;Fe&&(Dn=_e?(0,t.jsx)($e.I,{name:"angle-down",className:Nn}):(0,t.jsx)($e.I,{name:"angle-right",className:"u-align-icon"}),In="a",ts={"aria-checked":_e,onClick:Jt,role:"switch"});const hs=(0,a.of)(jn);return(0,t.jsxs)("div",{className:hs.AccordianLogs,children:[(0,t.jsxs)(In,{className:hs.AccordianLogsHeader,...ts,children:[Dn," ",(0,t.jsx)("strong",{children:"Events"})," (",ft.length,")"]}),_e&&(0,t.jsxs)("div",{className:hs.AccordianLogsContent,children:[(0,ce.sortBy)(ft,"timestamp").map((Yn,bs)=>(0,t.jsx)(Zt,{className:bs<ft.length-1?hs.AccordianKeyValuesItem:null,data:Yn.fields||[],highContrast:!0,interactive:Fe,isOpen:Mt?Mt.has(Yn):!1,label:`${(0,D.a3)(Yn.timestamp-nn)}`,linksGetter:tt,onToggle:Fe&&$t?()=>$t(Yn):null},`${Yn.timestamp}-${bs}`)),(0,t.jsx)("small",{className:hs.AccordianLogsFooter,children:"Log timestamps are relative to the start time of the full trace."})]})]})}const Qn=Fe=>({wrapper:(0,n.css)({label:"wrapper",bottom:0,left:0,position:"absolute",right:0,top:0,overflow:"hidden",zIndex:0}),bar:(0,n.css)({label:"bar",borderRadius:Fe.shape.radius.default,minWidth:"2px",position:"absolute",height:"36%",top:"32%"}),rpc:(0,n.css)({label:"rpc",position:"absolute",top:"35%",bottom:"35%",zIndex:1}),label:(0,n.css)({label:"label",color:"#aaa",fontSize:"12px",fontFamily:"'Helvetica Neue', Helvetica, Arial, sans - serif",lineHeight:"1em",whiteSpace:"nowrap",padding:"0 0.5em",position:"absolute"}),logMarker:(0,n.css)({label:"logMarker",backgroundColor:(0,c.R)(Fe,"#2c3235"),cursor:"pointer",height:"60%",minWidth:"1px",position:"absolute",top:"20%","&:hover":{backgroundColor:(0,c.R)(Fe,"#464c54")},"&::before, &::after":{content:"''",position:"absolute",top:0,bottom:0,right:0,border:"1px solid transparent"},"&::after":{left:0}}),criticalPath:(0,n.css)({position:"absolute",top:"45%",height:"11%",zIndex:2,overflow:"hidden",background:(0,c.R)(Fe,"#f1f1f1"),borderLeft:`1px solid ${(0,c.R)(Fe,"#2c3235")}`,borderRight:`1px solid ${(0,c.R)(Fe,"#2c3235")}`})});function Fn(Fe){return`${(Fe*100).toFixed(1)}%`}function qn(Fe){return`${Fe*100}%`}function js({criticalPath:Fe,viewEnd:_e,viewStart:tt,getViewedBounds:ft,color:Mt,shortLabel:$t,longLabel:Jt,onClick:nn,rpc:Dn,traceStartTime:In,span:ts,className:hs,labelClassName:Yn}){const[bs,Ns]=(0,i.useState)($t),ns=()=>Ns($t),ta=()=>Ns(Jt),Ms=(0,ce.groupBy)(ts.logs,oa=>{const ms=ft(oa.timestamp,oa.timestamp).start;return Fn(Math.round(ms*500)/500)}),Qs=(0,a.of)(Qn);return(0,t.jsxs)("div",{className:u()(Qs.wrapper,hs),onBlur:ns,onClick:nn,onFocus:ta,onMouseOut:ns,onMouseOver:ta,"aria-hidden":!0,"data-testid":ze.Tp.components.TraceViewer.spanBar,children:[(0,t.jsx)("div",{"aria-label":bs,className:u()(Qs.bar),style:{background:Mt,left:Fn(tt),width:Fn(_e-tt)},children:(0,t.jsx)("div",{className:u()(Qs.label,Yn),"data-testid":"SpanBar--label",children:bs})}),(0,t.jsx)("div",{children:Object.keys(Ms).map(oa=>(0,t.jsx)(yt,{content:(0,t.jsx)(Xn,{interactive:!1,isOpen:!0,logs:Ms[oa],timestamp:In}),children:(0,t.jsx)("div",{"data-testid":"SpanBar--logMarker",className:u()(Qs.logMarker),style:{left:oa}})},oa))}),Dn&&(0,t.jsx)("div",{className:u()(Qs.rpc),style:{background:Dn.color,left:Fn(Dn.viewStart),width:Fn(Dn.viewEnd-Dn.viewStart)}}),Fe?.map((oa,ms)=>{const xa=ft(oa.section_start,oa.section_end),Ua=xa.start,_a=xa.end,La=`${oa.spanId}-${ms}`;return(0,t.jsx)(qe.m,{placement:"top",content:(0,t.jsxs)("div",{children:["A segment on the ",(0,t.jsx)("em",{children:"critical path"})," of the overall trace / request / workflow."]}),children:(0,t.jsx)("div",{"data-testid":"SpanBar--criticalPath",className:Qs.criticalPath,style:{left:qn(Ua),width:qn(_a-Ua)}})},La)})]})}const ys=i.memo(js);var Ps=e(64539),es=e(28122);const _s=(Fe,_e,tt,ft)=>(Fe.sort(function(Mt,$t){return(Mt.title||"link").toLowerCase().localeCompare(($t.title||"link").toLowerCase())}),Fe.map((Mt,$t)=>(0,t.jsx)(Ps.D,{label:Mt.title||"Link",onClick:Mt.onClick?Jt=>{(0,s.rR)("grafana_traces_trace_view_span_link_clicked",{datasourceType:ft,grafana_version:r.$.buildInfo.version,type:Mt.type,location:"menu"}),Jt?.preventDefault(),Mt.onClick(Jt),tt()}:void 0,url:Mt.href,className:_e.menuItem},$t))),ca=({links:Fe,datasourceType:_e,color:tt})=>{const ft=(0,a.of)(()=>Ks(tt)),[Mt,$t]=(0,i.useState)(!1),[Jt,nn]=(0,i.useState)({x:0,y:0}),Dn=()=>$t(!1);return(0,t.jsxs)("div",{"data-testid":"SpanLinksMenu",className:ft.wrapper,children:[(0,t.jsx)("button",{onClick:In=>{$t(!0),nn({x:In.pageX,y:In.pageY})},className:ft.button,children:(0,t.jsx)($e.I,{name:"link",className:ft.icon})}),Mt?(0,t.jsx)(es.t,{onClose:()=>$t(!1),renderMenuItems:()=>_s(Fe,ft,Dn,_e),focusOnOpen:!1,x:Jt.x,y:Jt.y}):null]})},Ks=Fe=>({wrapper:(0,n.css)`
      border: none;
      background: ${Fe}10;
      border-bottom: 1px solid ${Fe}CF;
      padding-right: 4px;
    `,button:(0,n.css)`
      background: transparent;
      border: none;
      padding: 0;
    `,icon:(0,n.css)`
      background: transparent;
      border: none;
      padding: 0;
    `,menuItem:(0,n.css)`
      max-width: 60ch;
      overflow: hidden;
    `});function Zs(Fe){return(0,ce.get)((0,ce.find)(Fe.references,({span:_e,refType:tt})=>_e&&_e.spanID&&(tt==="CHILD_OF"||tt==="FOLLOWS_FROM")),"span")}function nr(Fe){const _e=[];if(!Fe)return _e;let tt=Zs(Fe);for(;tt;)_e.push(tt.spanID),tt=Zs(tt);return _e}const lr=(0,g.N)(Fe=>({SpanTreeOffset:(0,n.css)`
      label: SpanTreeOffset;
      color: ${(0,c.R)(Fe,"#000")};
      position: relative;
    `,SpanTreeOffsetParent:(0,n.css)`
      label: SpanTreeOffsetParent;
      &:hover {
        cursor: pointer;
      }
    `,indentGuide:(0,n.css)`
      label: indentGuide;
      /* The size of the indentGuide is based off of the iconWrapper */
      padding-right: 1rem;
      height: 100%;
      display: inline-flex;
      transition: padding 300ms ease-out;
      &::before {
        content: '';
        padding-left: 1px;
        background-color: ${(0,c.R)(Fe,"lightgrey")};
      }
    `,indentGuideActive:(0,n.css)`
      label: indentGuideActive;
      &::before {
        background-color: ${(0,c.R)(Fe,"#777")};
      }
    `,indentGuideThin:(0,n.css)`
      padding-right: 0.3rem;
    `,iconWrapper:(0,n.css)`
      label: iconWrapper;
      position: absolute;
      right: 0;
    `}));class ga extends i.PureComponent{constructor(_e){super(_e),this.handleMouseLeave=(tt,ft)=>{(!(tt.relatedTarget instanceof HTMLSpanElement)||(0,ce.get)(tt,"relatedTarget.dataset.ancestorId")!==ft)&&this.props.removeHoverIndentGuideId(ft)},this.handleMouseEnter=(tt,ft)=>{(!(tt.relatedTarget instanceof HTMLSpanElement)||(0,ce.get)(tt,"relatedTarget.dataset.ancestorId")!==ft)&&this.props.addHoverIndentGuideId(ft)},this.ancestorIds=nr(_e.span),this.ancestorIds.push("root"),this.ancestorIds.reverse()}static{this.displayName="UnthemedSpanTreeOffset"}static{this.defaultProps={childrenVisible:!1,showChildrenIcon:!0}}render(){const{childrenVisible:_e,onClick:tt,showChildrenIcon:ft,span:Mt,theme:$t,visibleSpanIds:Jt}=this.props,{hasChildren:nn,spanID:Dn}=Mt,In=nn?{onClick:tt,role:"switch","aria-checked":_e}:null,ts=ft&&nn&&(_e?(0,t.jsx)($e.I,{name:"angle-down","data-testid":"icon-arrow-down",size:"sm"}):(0,t.jsx)($e.I,{name:"angle-right","data-testid":"icon-arrow-right",size:"sm"})),hs=lr($t);return(0,t.jsxs)("span",{className:u()(hs.SpanTreeOffset,{[hs.SpanTreeOffsetParent]:nn}),...In,children:[this.ancestorIds.map((Yn,bs)=>(0,t.jsx)("span",{className:u()(hs.indentGuide,{[hs.indentGuideActive]:this.props.hoverIndentGuideIds.has(Yn),[hs.indentGuideThin]:bs!==this.ancestorIds.length-1&&Yn!=="root"&&!Jt.includes(Yn)}),"data-ancestor-id":Yn,"data-testid":"SpanTreeOffset--indentGuide",onMouseEnter:Ns=>this.handleMouseEnter(Ns,Yn),onMouseLeave:Ns=>this.handleMouseLeave(Ns,Yn)},Yn)),ts&&(0,t.jsx)("span",{className:hs.iconWrapper,onMouseEnter:Yn=>this.handleMouseEnter(Yn,Dn),onMouseLeave:Yn=>this.handleMouseLeave(Yn,Dn),"data-testid":"icon-wrapper",children:ts})]})}}const $a=(0,a.cV)(ga),Za="spanBar",mr="spanBarLabel",Va="nameWrapper",Ea="nameWrapperMatchingFilter",cr="jaegerView",sn="nameColumn",Ln=(0,g.N)((Fe,_e)=>{const tt={label:"flash",flash:(0,n.keyframes)`
    from {
      background-color: ${(0,c.R)(Fe,"#68b9ff")};
    }
    to {
      background-color: 'default';
    }
  `},ft=_e?"":(0,c.R)(Fe,"#fffce4");return{nameWrapper:(0,n.css)`
      label: nameWrapper;
      line-height: 27px;
      overflow: hidden;
      display: flex;
    `,nameWrapperMatchingFilter:(0,n.css)`
      label: nameWrapperMatchingFilter;
      background-color: ${ft};
    `,nameColumn:(0,n.css)`
      label: nameColumn;
      position: relative;
      white-space: nowrap;
      z-index: 1;
      &:hover {
        z-index: 1;
      }
    `,endpointName:(0,n.css)`
      label: endpointName;
      color: ${(0,c.R)(Fe,"#484848")};
      font-size: 0.9em;
    `,view:(0,n.css)`
      label: view;
      position: relative;
    `,viewExpanded:(0,n.css)`
      label: viewExpanded;
      background: ${(0,c.R)(Fe,"#f8f8f8")};
      outline: 1px solid ${(0,c.R)(Fe,"#ddd")};
    `,viewExpandedAndMatchingFilter:(0,n.css)`
      label: viewExpandedAndMatchingFilter;
      background: ${(0,c.R)(Fe,"#fff3d7")};
      outline: 1px solid ${(0,c.R)(Fe,"#ddd")};
    `,row:(0,n.css)`
      label: row;
      font-size: 0.9em;
      &:hover .${Za} {
        opacity: 1;
      }
      &:hover .${mr} {
        color: ${(0,c.R)(Fe,"#000")};
      }
      &:hover .${Va} {
        background: #f8f8f8;
        background: linear-gradient(
          90deg,
          ${(0,c.R)(Fe,"#fafafa")},
          ${(0,c.R)(Fe,"#f8f8f8")} 75%,
          ${(0,c.R)(Fe,"#eee")}
        );
      }
      &:hover .${cr} {
        background-color: ${(0,c.R)(Fe,"#f5f5f5")};
        outline: 1px solid ${(0,c.R)(Fe,"#ddd")};
      }
    `,rowClippingLeft:(0,n.css)`
      label: rowClippingLeft;
      & .${sn}::before {
        content: ' ';
        height: 100%;
        position: absolute;
        width: 6px;
        background-image: linear-gradient(
          to right,
          ${(0,c.R)(Fe,"rgba(25, 25, 25, 0.25)")},
          ${(0,c.R)(Fe,"rgba(32, 32, 32, 0)")}
        );
        left: 100%;
        z-index: -1;
      }
    `,rowClippingRight:(0,n.css)`
      label: rowClippingRight;
      & .${cr}::before {
        content: ' ';
        height: 100%;
        position: absolute;
        width: 6px;
        background-image: linear-gradient(
          to left,
          ${(0,c.R)(Fe,"rgba(25, 25, 25, 0.25)")},
          ${(0,c.R)(Fe,"rgba(25, 25, 25, 0.25)")}
        );
        right: 0%;
        z-index: 1;
      }
    `,rowExpanded:(0,n.css)`
      label: rowExpanded;
      & .${Za} {
        opacity: 1;
      }
      & .${mr} {
        color: ${(0,c.R)(Fe,"#000")};
      }
      & .${Va}, &:hover .${Va} {
        background: ${(0,c.R)(Fe,"#f0f0f0")};
        box-shadow: 0 1px 0 ${(0,c.R)(Fe,"#ddd")};
      }
      & .${Ea} {
        background: ${(0,c.R)(Fe,"#fff3d7")};
      }
      &:hover .${cr} {
        background: ${(0,c.R)(Fe,"#eee")};
      }
    `,rowMatchingFilter:(0,n.css)`
      label: rowMatchingFilter;
      // background-color: ${(0,c.R)(Fe,"#fffbde")};
      &:hover .${Va} {
        background: linear-gradient(
          90deg,
          ${(0,c.R)(Fe,"#fffbde")},
          ${(0,c.R)(Fe,"#fffbde")} 75%,
          ${(0,c.R)(Fe,"#f7f1c6")}
        );
      }
      &:hover .${cr} {
        background-color: ${(0,c.R)(Fe,"#f7f1c6")};
        outline: 1px solid ${(0,c.R)(Fe,"#ddd")};
      }
    `,rowFocused:(0,n.css)`
      label: rowFocused;
      background-color: ${(0,c.R)(Fe,"#cbe7ff")};
      animation: ${tt.flash} 1s cubic-bezier(0.12, 0, 0.39, 0);
      & .${Va}, .${cr}, .${Ea} {
        background-color: ${(0,c.R)(Fe,"#cbe7ff")};
        animation: ${tt.flash} 1s cubic-bezier(0.12, 0, 0.39, 0);
      }
      & .${Za} {
        opacity: 1;
      }
      & .${mr} {
        color: ${(0,c.R)(Fe,"#000")};
      }
      &:hover .${Va}, :hover .${cr} {
        background: ${(0,c.R)(Fe,"#d5ebff")};
        box-shadow: 0 1px 0 ${(0,c.R)(Fe,"#ddd")};
      }
    `,rowExpandedAndMatchingFilter:(0,n.css)`
      label: rowExpandedAndMatchingFilter;
      &:hover .${cr} {
        background: ${(0,c.R)(Fe,"#ffeccf")};
      }
    `,name:(0,n.css)`
      label: name;
      color: ${(0,c.R)(Fe,"#000")};
      cursor: pointer;
      flex: 1 1 auto;
      outline: none;
      overflow-y: hidden;
      overflow-x: auto;
      padding-left: 4px;
      padding-right: 0.25em;
      position: relative;
      -ms-overflow-style: none;
      scrollbar-width: none;
      &::-webkit-scrollbar {
        display: none;
      }
      &:focus {
        text-decoration: none;
      }
      &:hover > span {
        color: ${(0,c.R)(Fe,"#000")};
      }
      text-align: left;
      background: transparent;
      border: none;
      border-bottom-width: 1px;
      border-bottom-style: solid;
    `,nameDetailExpanded:(0,n.css)`
      label: nameDetailExpanded;
      &::before {
        bottom: 0;
      }
    `,svcName:(0,n.css)`
      label: svcName;
      font-size: 0.9em;
      font-weight: bold;
      margin-right: 0.25rem;
    `,svcNameChildrenCollapsed:(0,n.css)`
      label: svcNameChildrenCollapsed;
      font-weight: bold;
      font-style: italic;
    `,errorIcon:(0,n.css)`
      label: errorIcon;
      border-radius: 6.5px;
      color: ${(0,c.R)(Fe,"#fff")};
      font-size: 0.85em;
      margin-right: 0.25rem;
      padding: 1px;
    `,rpcColorMarker:(0,n.css)`
      label: rpcColorMarker;
      border-radius: 6.5px;
      display: inline-block;
      font-size: 0.85em;
      height: 1em;
      margin-right: 0.25rem;
      padding: 1px;
      width: 1em;
      vertical-align: middle;
    `,labelRight:(0,n.css)`
      label: labelRight;
      left: 100%;
    `,labelLeft:(0,n.css)`
      label: labelLeft;
      right: 100%;
    `}});class Jn extends i.PureComponent{constructor(){super(...arguments),this._detailToggle=()=>{this.props.onDetailToggled(this.props.span.spanID)},this._childrenToggle=()=>{this.props.onChildrenToggled(this.props.span.spanID)},this.getSpanBarLabel=(_e,tt,ft)=>{const Mt=tt?.type??"";if(Mt===Ye)return"";if(Mt===""||Mt===je)return`(${ft})`;if(Mt===Ze){const $t=tt?.tag?.trim()??"";if($t!==""&&_e.tags){const Jt=_e.tags?.find(Dn=>Dn.key===$t);if(Jt)return`(${Jt.value})`;const nn=_e.process?.tags?.find(Dn=>Dn.key===$t);if(nn)return`(${nn.value})`}}return""}}static{this.displayName="UnthemedSpanBarRow"}static{this.defaultProps={className:"",rpc:null}}render(){const{className:_e,color:tt,spanBarOptions:ft,columnDivision:Mt,isChildrenExpanded:$t,isDetailExpanded:Jt,isMatchingFilter:nn,showSpanFilterMatchesOnly:Dn,isFocused:In,numTicks:ts,rpc:hs,noInstrumentedServer:Yn,showErrorIcon:bs,getViewedBounds:Ns,traceStartTime:ns,span:ta,hoverIndentGuideIds:Ms,addHoverIndentGuideId:Qs,removeHoverIndentGuideId:oa,clippingLeft:ms,clippingRight:xa,theme:Ua,createSpanLink:_a,datasourceType:La,showServiceName:va,visibleSpanIds:wa,criticalPath:Kr}=this.props,{duration:Pr,hasChildren:fr,operationName:Qr,process:{serviceName:$r}}=ta,Zr=(0,D.a3)(Pr),co=Ns(ta.startTime,ta.startTime+ta.duration),gr=co.start,as=co.end,ls=Ln(Ua,Dn),Cs=`${$r}::${Qr}`;let zs,Nr;return gr>1-as?(zs=`${Cs} | ${Zr}`,Nr=ls.labelLeft):(zs=`${Zr} | ${Cs}`,Nr=ls.labelRight),(0,t.jsxs)(V,{className:u()(ls.row,{[ls.rowExpanded]:Jt,[ls.rowMatchingFilter]:nn,[ls.rowExpandedAndMatchingFilter]:nn&&Jt,[ls.rowFocused]:In,[ls.rowClippingLeft]:ms,[ls.rowClippingRight]:xa},_e),children:[(0,t.jsx)(V.Cell,{className:u()(ls.nameColumn,sn),width:Mt,children:(0,t.jsxs)("div",{className:u()(ls.nameWrapper,Va,{[ls.nameWrapperMatchingFilter]:nn,nameWrapperMatchingFilter:nn}),children:[(0,t.jsx)($a,{onClick:fr?this._childrenToggle:void 0,childrenVisible:$t,span:ta,hoverIndentGuideIds:Ms,addHoverIndentGuideId:Qs,removeHoverIndentGuideId:oa,visibleSpanIds:wa}),(0,t.jsxs)("button",{type:"button",className:u()(ls.name,{[ls.nameDetailExpanded]:Jt}),"aria-checked":Jt,title:Cs,onClick:this._detailToggle,role:"switch",style:{background:`${tt}10`,borderBottomColor:`${tt}CF`},tabIndex:0,children:[bs&&(0,t.jsx)($e.I,{name:"exclamation-circle",style:{backgroundColor:ta.errorIconColor?(0,c.R)(Ua,ta.errorIconColor):(0,c.R)(Ua,"#db2828")},className:ls.errorIcon}),va&&(0,t.jsx)("span",{className:u()(ls.svcName,{[ls.svcNameChildrenCollapsed]:fr&&!$t}),children:`${$r} `}),hs&&(0,t.jsxs)("span",{children:[(0,t.jsx)($e.I,{name:"arrow-right"})," ",(0,t.jsx)("i",{className:ls.rpcColorMarker,style:{background:hs.color}}),hs.serviceName]}),Yn&&(0,t.jsxs)("span",{children:[(0,t.jsx)($e.I,{name:"arrow-right"})," ",(0,t.jsx)("i",{className:ls.rpcColorMarker,style:{background:Yn.color}}),Yn.serviceName]}),(0,t.jsx)("span",{className:ls.endpointName,children:hs?hs.operationName:Qr}),(0,t.jsxs)("span",{className:ls.endpointName,children:[" ",this.getSpanBarLabel(ta,ft,Zr)]})]}),_a&&(()=>{const Ge=_a(ta),Ae=Ge?.length||0;return Ge&&Ae===1?Ge[0]?(0,t.jsx)("a",{href:Ge[0].href,target:"_blank",style:{background:`${tt}10`,borderBottom:`1px solid ${tt}CF`,paddingRight:"4px"},rel:"noopener noreferrer",onClick:Ge[0].onClick?Ke=>{!(Ke.ctrlKey||Ke.metaKey||Ke.shiftKey)&&Ge[0].onClick&&(Ke.preventDefault(),Ge[0].onClick(Ke))}:void 0,children:Ge[0].content}):null:Ge&&Ae>1?(0,t.jsx)(ca,{links:Ge,datasourceType:La,color:tt}):null})()]})}),(0,t.jsxs)(V.Cell,{className:u()(ls.view,cr,{[ls.viewExpanded]:Jt,[ls.viewExpandedAndMatchingFilter]:nn&&Jt}),"data-testid":"span-view",style:{cursor:"pointer"},width:1-Mt,onClick:this._detailToggle,children:[(0,t.jsx)(U,{numTicks:ts}),(0,t.jsx)(ys,{criticalPath:Kr,rpc:hs,viewStart:gr,viewEnd:as,getViewedBounds:Ns,color:tt,shortLabel:Zr,longLabel:zs,traceStartTime:ns,span:ta,labelClassName:`${mr} ${Nr}`,className:Za})]})]})}}const gs=(0,a.cV)(Jn),kn=(0,g.N)(Fe=>({expandedAccent:(0,n.css)`
      cursor: pointer;
      height: 100%;
      overflow: hidden;
      position: absolute;
      width: 100%;
      &::before {
        border-left: 1px solid;
        pointer-events: none;
        width: 1000px;
      }
      &::after {
        border-right: 1000px solid;
        border-color: inherit;
        cursor: pointer;
        opacity: 0.2;
      }

      /* border-color inherit must come AFTER other border declarations for accent */
      &::before,
      &::after {
        border-color: inherit;
        content: ' ';
        position: absolute;
        height: 100%;
      }

      &:hover::after {
        opacity: 0.35;
      }
    `,infoWrapper:(0,n.css)`
      label: infoWrapper;
      border: 1px solid ${(0,c.R)(Fe,"#d3d3d3")};
      border-top: 3px solid;
      padding: 0.75rem;
    `}));class Gn extends i.PureComponent{constructor(){super(...arguments),this._detailToggle=()=>{this.props.onDetailToggled(this.props.span.spanID)},this._linksGetter=(_e,tt)=>{const{linksGetter:ft,span:Mt}=this.props;return ft(Mt,_e,tt)}}render(){const{color:_e,columnDivision:tt,detailState:ft,logItemToggle:Mt,logsToggle:$t,processToggle:Jt,referenceItemToggle:nn,referencesToggle:Dn,warningsToggle:In,stackTracesToggle:ts,span:hs,traceToProfilesOptions:Yn,timeZone:bs,tagsToggle:Ns,traceStartTime:ns,traceDuration:ta,traceName:Ms,hoverIndentGuideIds:Qs,addHoverIndentGuideId:oa,removeHoverIndentGuideId:ms,theme:xa,createSpanLink:Ua,focusedSpanId:_a,createFocusSpanLink:La,datasourceType:va,visibleSpanIds:wa,traceFlameGraphs:Kr,setTraceFlameGraphs:Pr,setRedrawListView:fr}=this.props,Qr=kn(xa);return(0,t.jsxs)(V,{children:[(0,t.jsxs)(V.Cell,{width:tt,style:{overflow:"hidden"},children:[(0,t.jsx)($a,{span:hs,showChildrenIcon:!1,hoverIndentGuideIds:Qs,addHoverIndentGuideId:oa,removeHoverIndentGuideId:ms,visibleSpanIds:wa}),(0,t.jsx)(Ve.$n,{fill:"text",onClick:this._detailToggle,className:u()(Qr.expandedAccent,(0,Ve.my)(xa)),style:{borderColor:_e},"data-testid":"detail-row-expanded-accent"})]}),(0,t.jsx)(V.Cell,{width:1-tt,children:(0,t.jsx)("div",{className:Qr.infoWrapper,style:{borderTopColor:_e},children:(0,t.jsx)(Tt,{detailState:ft,linksGetter:this._linksGetter,logItemToggle:Mt,logsToggle:$t,processToggle:Jt,referenceItemToggle:nn,referencesToggle:Dn,warningsToggle:In,stackTracesToggle:ts,span:hs,traceToProfilesOptions:Yn,timeZone:bs,tagsToggle:Ns,traceStartTime:ns,traceDuration:ta,traceName:Ms,createSpanLink:Ua,focusedSpanId:_a,createFocusSpanLink:La,datasourceType:va,traceFlameGraphs:Kr,setTraceFlameGraphs:Pr,setRedrawListView:fr})})})]})}}const Gs=(0,a.cV)(Gn),$s=(0,g.N)(()=>({rowsWrapper:(0,n.css)`
      width: 100%;
    `,row:(0,n.css)`
      width: 100%;
    `,scrollToTopButton:(0,n.css)`
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      width: 40px;
      height: 40px;
      position: absolute;
      bottom: 30px;
      right: 30px;
      z-index: 1;
    `})),Is={bar:28,detail:161,detailWithLogs:197},pa=5,Ta=33;function ua(Fe,_e,tt,ft,Mt,$t,Jt){if(!Fe)return[];Mt&&ft&&(Fe=Fe.filter(In=>ft.has(In.spanID))),$t&&Jt&&(Fe=Fe.filter(In=>Jt.find(ts=>ts.spanId===In.spanID)));let nn=null;const Dn=[];for(let In=0;In<Fe.length;In++){const ts=Fe[In],{spanID:hs,depth:Yn}=ts;let bs=!1;nn!=null&&(Yn>=nn?bs=!0:nn=null),!bs&&(_e.has(hs)&&(nn=Yn+1),Dn.push({span:ts,isDetail:!1,spanIndex:In}),tt.has(hs)&&Dn.push({span:ts,isDetail:!0,spanIndex:In}))}return Dn}function sr(Fe){const[_e,tt]=Fe;return{left:_e>0,right:tt<1}}function ma(Fe,_e,tt,ft,Mt,$t,Jt){return Fe?ua(Fe.spans,_e,tt,ft,Mt,$t,Jt):[]}function ar(Fe){const _e=new Map;return Fe&&Fe.spans.forEach(tt=>{tt.childSpanIds.length&&_e.set(tt.spanID,tt.childSpanIds)}),_e}const Ya=(0,ye.A)(ma),xr=(0,ye.A)(E,ce.isEqual),Sr=(0,ye.A)(sr,ce.isEqual),Yr=(0,ye.A)(ar);class Hr extends i.Component{constructor(){super(...arguments),this.hasScrolledToSpan=!1,this.getViewRange=()=>this.props.currentViewRangeTime,this.getSearchedSpanIDs=()=>this.props.findMatchesIDs,this.getCollapsedChildren=()=>this.props.childrenHiddenIDs,this.mapRowIndexToSpanIndex=_e=>this.getRowStates()[_e].spanIndex,this.mapSpanIndexToRowIndex=_e=>{const tt=this.getRowStates().length;for(let ft=0;ft<tt;ft++){const{spanIndex:Mt}=this.getRowStates()[ft];if(Mt===_e)return ft}throw new Error(`unable to find row for span index: ${_e}`)},this.setListView=_e=>{this.listView=_e},this.getKeyFromIndex=_e=>{const{isDetail:tt,span:ft}=this.getRowStates()[_e];return`${ft.traceID}--${ft.spanID}--${tt?"detail":"bar"}`},this.getIndexFromKey=_e=>{const tt=_e.split("--"),ft=tt[0],Mt=tt[1],$t=tt[2]==="detail",Jt=this.getRowStates().length;for(let nn=0;nn<Jt;nn++){const{span:Dn,isDetail:In}=this.getRowStates()[nn];if(Dn.spanID===Mt&&Dn.traceID===ft&&In===$t)return nn}return-1},this.getRowHeight=_e=>{const{span:tt,isDetail:ft}=this.getRowStates()[_e];return ft?Array.isArray(tt.logs)&&tt.logs.length?Is.detailWithLogs:Is.detail:Is.bar},this.renderRow=(_e,tt,ft,Mt)=>{const{isDetail:$t,span:Jt,spanIndex:nn}=this.getRowStates()[ft],Dn=Math.max((this.listView?.getTopVisibleIndex()||0)-Ta,0),In=(this.listView?.getBottomVisibleIndex()||0)+Ta,ts=this.getVisibleSpanIds(Dn,In);return $t?this.renderSpanDetailRow(Jt,_e,tt,Mt,ts):this.renderSpanBarRow(Jt,nn,_e,tt,Mt,ts)},this.scrollToSpan=(_e,tt)=>{if(tt==null)return;const ft=this.getRowStates().findIndex(Mt=>Mt.span.spanID===tt);ft>=0&&this.listView?.scrollToIndex(ft,_e)},this.scrollToTop=()=>{const{topOfViewRef:_e,datasourceType:tt,trace:ft}=this.props;_e?.current?.scrollIntoView({behavior:"smooth"}),(0,s.rR)("grafana_traces_trace_view_scroll_to_top_clicked",{datasourceType:tt,grafana_version:r.$.buildInfo.version,numServices:ft.services.length,numSpans:ft.spans.length})},this.getVisibleSpanIds=(0,ye.A)((_e,tt)=>{const ft=[];for(let Mt=_e;Mt<tt;Mt++){const $t=this.getRowStates()[Mt];$t?.span&&ft.push($t.span.spanID)}return ft})}componentDidMount(){this.scrollToSpan(this.props.headerHeight,this.props.focusedSpanId)}shouldComponentUpdate(_e){let tt;for(tt in _e)if(_e[tt]!==this.props[tt])return!0;return!1}componentDidUpdate(_e){const{headerHeight:tt,focusedSpanId:ft,focusedSpanIdForSearch:Mt}=this.props;this.hasScrolledToSpan||(this.scrollToSpan(tt,ft),this.hasScrolledToSpan=!0),ft!==_e.focusedSpanId&&this.scrollToSpan(tt,ft),Mt!==_e.focusedSpanIdForSearch&&this.scrollToSpan(tt,Mt)}getRowStates(){const{childrenHiddenIDs:_e,detailStates:tt,trace:ft,findMatchesIDs:Mt,showSpanFilterMatchesOnly:$t,showCriticalPathSpansOnly:Jt,criticalPath:nn}=this.props;return Ya(ft,_e,tt,Mt,$t,Jt,nn)}getClipping(){const{currentViewRangeTime:_e}=this.props;return Sr(_e)}getViewedBounds(){const{currentViewRangeTime:_e,trace:tt}=this.props,[ft,Mt]=_e;return xr({min:tt.startTime,max:tt.endTime,viewStart:ft,viewEnd:Mt})}getChildSpansMap(){return Yr(this.props.trace)}getAccessors(){const _e=this.listView;if(!_e)throw new Error("ListView unavailable");return{getViewRange:this.getViewRange,getSearchedSpanIDs:this.getSearchedSpanIDs,getCollapsedChildren:this.getCollapsedChildren,getViewHeight:_e.getViewHeight,getBottomRowIndexVisible:_e.getBottomVisibleIndex,getTopRowIndexVisible:_e.getTopVisibleIndex,getRowPosition:_e.getRowPosition,mapRowIndexToSpanIndex:this.mapRowIndexToSpanIndex,mapSpanIndexToRowIndex:this.mapSpanIndexToRowIndex}}renderSpanBarRow(_e,tt,ft,Mt,$t,Jt){const{spanID:nn,childSpanIds:Dn}=_e,{serviceName:In}=_e.process,{childrenHiddenIDs:ts,childrenToggle:hs,detailStates:Yn,detailToggle:bs,findMatchesIDs:Ns,spanNameColumnWidth:ns,trace:ta,spanBarOptions:Ms,hoverIndentGuideIds:Qs,addHoverIndentGuideId:oa,removeHoverIndentGuideId:ms,createSpanLink:xa,focusedSpanId:Ua,focusedSpanIdForSearch:_a,showSpanFilterMatchesOnly:La,theme:va,datasourceType:wa,criticalPath:Kr}=this.props;if(!ta)return null;const Pr=(0,De.Kv)(In,va),fr=ts.has(nn),Qr=Yn.has(nn),$r=Ns?Ns.has(nn):!1,Zr=nn===Ua||nn===_a,co=L(_e)||fr&&N(ta.spans,tt);let gr=null;if(fr){const Ke=F(ta.spans.slice(tt));if(Ke){const lt=this.getViewedBounds()(Ke.startTime,Ke.startTime+Ke.duration);gr={color:(0,De.Kv)(Ke.process.serviceName,va),operationName:Ke.operationName,serviceName:Ke.process.serviceName,viewEnd:lt.end,viewStart:lt.start}}}const as=_e.tags.find(Ke=>Ke.key===ue);let ls=null;!_e.hasChildren&&as&&w(_e)&&(ls={serviceName:as.value,color:(0,De.Kv)(as.value,va)});const Cs=tt>0?ta.spans[tt-1]:null,zs=[nn,...Dn],Nr=Ke=>{Ke.forEach(lt=>{const It=this.getChildSpansMap().get(lt);It?.length&&(zs.push(...It),Nr(It))})};Nr(Dn);const Ge=Kr?.filter(Ke=>fr?zs.includes(Ke.spanId):Ke.spanId===nn),Ae=$s();return(0,t.jsx)("div",{className:Ae.row,style:Mt,...$t,children:(0,t.jsx)(gs,{clippingLeft:this.getClipping().left,clippingRight:this.getClipping().right,color:Pr,spanBarOptions:Ms,columnDivision:ns,isChildrenExpanded:!fr,isDetailExpanded:Qr,isMatchingFilter:$r,isFocused:Zr,showSpanFilterMatchesOnly:La,numTicks:pa,onDetailToggled:bs,onChildrenToggled:hs,rpc:gr,noInstrumentedServer:ls,showErrorIcon:co,getViewedBounds:this.getViewedBounds(),traceStartTime:ta.startTime,span:_e,hoverIndentGuideIds:Qs,addHoverIndentGuideId:oa,removeHoverIndentGuideId:ms,createSpanLink:xa,datasourceType:wa,showServiceName:Cs===null||Cs.process.serviceName!==_e.process.serviceName,visibleSpanIds:Jt,criticalPath:Ge})},ft)}renderSpanDetailRow(_e,tt,ft,Mt,$t){const{spanID:Jt}=_e,{serviceName:nn}=_e.process,{detailLogItemToggle:Dn,detailLogsToggle:In,detailProcessToggle:ts,detailReferencesToggle:hs,detailReferenceItemToggle:Yn,detailWarningsToggle:bs,detailStackTracesToggle:Ns,detailStates:ns,detailTagsToggle:ta,detailToggle:Ms,spanNameColumnWidth:Qs,trace:oa,traceToProfilesOptions:ms,timeZone:xa,hoverIndentGuideIds:Ua,addHoverIndentGuideId:_a,removeHoverIndentGuideId:La,linksGetter:va,createSpanLink:wa,focusedSpanId:Kr,createFocusSpanLink:Pr,theme:fr,datasourceType:Qr,traceFlameGraphs:$r,setTraceFlameGraphs:Zr,setRedrawListView:co}=this.props,gr=ns.get(Jt);if(!oa||!gr)return null;const as=(0,De.Kv)(nn,fr),ls=$s();return(0,t.jsx)("div",{className:ls.row,style:{...ft,zIndex:1},...Mt,children:(0,t.jsx)(Gs,{color:as,columnDivision:Qs,onDetailToggled:Ms,detailState:gr,linksGetter:va,logItemToggle:Dn,logsToggle:In,processToggle:ts,referenceItemToggle:Yn,referencesToggle:hs,warningsToggle:bs,stackTracesToggle:Ns,span:_e,traceToProfilesOptions:ms,timeZone:xa,tagsToggle:ta,traceStartTime:oa.startTime,traceDuration:oa.duration,traceName:oa.traceName,hoverIndentGuideIds:Ua,addHoverIndentGuideId:_a,removeHoverIndentGuideId:La,createSpanLink:wa,focusedSpanId:Kr,createFocusSpanLink:Pr,datasourceType:Qr,visibleSpanIds:$t,traceFlameGraphs:$r,setTraceFlameGraphs:Zr,setRedrawListView:co})},tt)}render(){const _e=$s(),{scrollElement:tt,redrawListView:ft}=this.props;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Le,{ref:this.setListView,dataLength:this.getRowStates().length,itemHeightGetter:this.getRowHeight,itemRenderer:this.renderRow,viewBuffer:Ta,viewBufferMin:Ta,itemsWrapperClassName:_e.rowsWrapper,getKeyFromIndex:this.getKeyFromIndex,getIndexFromKey:this.getIndexFromKey,windowScroller:!1,scrollElement:tt,redraw:ft}),this.props.topOfViewRef&&(0,t.jsx)(re.I,{className:_e.scrollToTopButton,onClick:this.scrollToTop,title:"Scroll to top",icon:"arrow-up"})]})}}const Rr=(0,a.cV)(Hr),lo=(0,g.N)(Fe=>({TraceTimelineViewer:(0,n.css)`
      label: TraceTimelineViewer;
      border-bottom: 1px solid ${(0,c.R)(Fe,"#bbb")};

      & .json-markup {
        line-height: 17px;
        font-size: 13px;
        font-family: monospace;
        white-space: pre-wrap;
      }

      & .json-markup-key {
        font-weight: bold;
      }

      & .json-markup-bool {
        color: ${(0,c.R)(Fe,"firebrick")};
      }

      & .json-markup-string {
        color: ${(0,c.R)(Fe,"teal")};
      }

      & .json-markup-null {
        color: ${(0,c.R)(Fe,"teal")};
      }

      & .json-markup-number {
        color: ${(0,c.R)(Fe,"blue","black")};
      }
    `})),Bo=5;class po extends i.PureComponent{constructor(_e){super(_e),this.collapseAll=()=>{this.props.collapseAll(this.props.trace.spans),(0,s.rR)("grafana_traces_traceID_expand_collapse_clicked",{datasourceType:this.props.datasourceType,grafana_version:r.$.buildInfo.version,type:"collapseAll"})},this.collapseOne=()=>{this.props.collapseOne(this.props.trace.spans),(0,s.rR)("grafana_traces_traceID_expand_collapse_clicked",{datasourceType:this.props.datasourceType,grafana_version:r.$.buildInfo.version,type:"collapseOne"})},this.expandAll=()=>{this.props.expandAll(),(0,s.rR)("grafana_traces_traceID_expand_collapse_clicked",{datasourceType:this.props.datasourceType,grafana_version:r.$.buildInfo.version,type:"expandAll"})},this.expandOne=()=>{this.props.expandOne(this.props.trace.spans),(0,s.rR)("grafana_traces_traceID_expand_collapse_clicked",{datasourceType:this.props.datasourceType,grafana_version:r.$.buildInfo.version,type:"expandOne"})},this.state={height:0}}componentDidMount(){v({collapseAll:this.collapseAll,expandAll:this.expandAll,collapseOne:this.collapseOne,expandOne:this.expandOne})}render(){const{setSpanNameColumnWidth:_e,updateNextViewRangeTime:tt,updateViewRangeTime:ft,viewRange:Mt,traceTimeline:$t,theme:Jt,topOfViewRef:nn,focusedSpanIdForSearch:Dn,...In}=this.props,{trace:ts}=In,hs=lo(Jt);return(0,t.jsxs)("div",{className:hs.TraceTimelineViewer,ref:Yn=>Yn&&this.setState({height:Yn.getBoundingClientRect().height}),children:[(0,t.jsx)(oe,{duration:ts.duration,nameColumnWidth:$t.spanNameColumnWidth,numTicks:Bo,onCollapseAll:this.collapseAll,onCollapseOne:this.collapseOne,onColummWidthChange:_e,onExpandAll:this.expandAll,onExpandOne:this.expandOne,viewRangeTime:Mt.time,updateNextViewRangeTime:tt,updateViewRangeTime:ft,columnResizeHandleHeight:this.state.height}),(0,t.jsx)(Rr,{...In,...$t,setSpanNameColumnWidth:_e,currentViewRangeTime:Mt.time.current,topOfViewRef:nn,focusedSpanIdForSearch:Dn,datasourceType:this.props.datasourceType})]})}}const vr=(0,a.cV)(po);var Ur=e(39938);const Er=()=>({NewWindowIconLarge:(0,n.css)`
      label: NewWindowIconLarge;
      font-size: 1.5em;
    `});function Qo({isLarge:Fe=!1,className:_e}){const tt=(0,a.of)(Er),ft=u()({[tt.NewWindowIconLarge]:Fe},_e);return(0,t.jsx)($e.I,{className:ft,name:"anchor"})}const Eo=Fe=>(0,t.jsxs)("a",{href:Fe.href,title:Fe.title,target:"_blank",rel:"noopener noreferrer",className:Fe.className,children:[Fe.children," ",(0,t.jsx)(Qo,{})]});function Lt(Fe){const{links:_e}=Fe;return(0,t.jsx)(Eo,{href:_e[0].url,title:_e[0].text,className:Fe.className})}const Ht=100,on="<trace-without-root-span>",vn=()=>({BreakableText:(0,n.css)`
      label: BreakableText;
      display: inline-block;
      white-space: pre;
    `}),Un=/\W*\w+\W*/g;function cs({text:Fe,className:_e,wordRegexp:tt=Un}){const ft=(0,a.of)(vn);if(!Fe)return null;const Mt=[];tt.exec("");let $t=tt.exec(Fe)||[Fe];for(;$t;)Mt.push((0,t.jsx)("span",{className:_e||ft.BreakableText,children:$t[0]},`${Fe}-${Mt.length}`)),$t=tt.exec(Fe);return(0,t.jsx)(t.Fragment,{children:Mt})}const os=Fe=>({TraceName:(0,n.css)`
      label: TraceName;
      font-size: ${Fe.typography.size.lg};
    `});function Js(Fe){const{className:_e,traceName:tt}=Fe,ft=(0,a.of)(os),Mt=String(tt||on),$t=(0,t.jsx)(cs,{text:Mt});return(0,t.jsx)("span",{className:u()(ft.TraceName,_e),children:$t})}var Ss=e(40784);const Ra=Object.defineProperty({archiveEnabled:!1,dependencies:{dagMaxNumServices:Ht,menuEnabled:!0},linkPatterns:[],search:{maxLookback:{label:"2 Days",value:"2d"},maxLimit:1500},tracking:{gaID:null,trackErrors:!0}},"__mergeFields",{value:["dependencies","search","tracking"]});function Oa(){return Ra}function ss(Fe){return(0,ce.get)(Oa(),Fe)}const Ia=/#\{([^{}]*)\}/g;function Cr(Fe){const _e=new Set;return Fe.replace(Ia,(tt,ft)=>(_e.add(ft),tt)),Array.from(_e)}function Dr(Fe,_e,tt){return Fe.replace(Ia,(ft,Mt)=>{const $t=tt[Mt];return $t==null?"":_e($t)})}function dr(Fe,_e){if(typeof Fe!="string")throw new Error("Invalid template");return{parameters:Cr(Fe),template:Dr.bind(null,Fe,_e)}}function ur(Fe){if(typeof Fe=="string")return _e=>_e===Fe;if(Array.isArray(Fe))return _e=>Fe.indexOf(_e)>-1;if(Fe==null)return()=>!0;throw new Error(`Invalid value: ${Fe}`)}const Oo=Fe=>Fe;function Io(Fe){try{const _e=dr(Fe.url,encodeURIComponent),tt=dr(Fe.text,Oo);return{object:Fe,type:ur(Fe.type),key:ur(Fe.key),value:ur(Fe.value),url:_e,text:tt,parameters:(0,ce.uniq)(_e.parameters.concat(tt.parameters))}}catch(_e){return console.error(`Ignoring invalid link pattern: ${_e}`,Fe),null}}function za(Fe,_e){return Fe.template(_e)}function Do(Fe,_e){const tt=[],ft=Object.keys(_e).filter(Mt=>typeof _e[Mt]=="string"||_e[Mt]==="number");return Fe?.filter(Mt=>Mt?.type("traces")).forEach(Mt=>{const $t={};Mt?.parameters.every(nn=>{const Dn=nn;return ft.includes(Dn)?($t[nn]=_e[Dn],!0):!1})&&tt.push({url:za(Mt.url,$t),text:za(Mt.text,$t)})}),tt}const Ca=(ss("linkPatterns")||[]).map(Io).filter(Fe=>!!Fe),Aa=(0,Ss.A)(10)(Fe=>{const _e=[];return Fe?Do(Ca,Fe):_e});function hr(Fe){let _e;const tt=new Set(Fe.map(({spanID:ft})=>ft));for(let ft=0;ft<Fe.length;ft++){if(Fe[ft].references&&Fe[ft].references.some(({traceID:nn,spanID:Dn})=>nn===Fe[ft].traceID&&tt.has(Dn)))continue;if(!_e){_e=Fe[ft];continue}const $t=Fe[ft].references&&Fe[ft].references.length||0,Jt=_e.references&&_e.references.length||0;($t<Jt||$t===Jt&&Fe[ft].startTime<_e.startTime)&&(_e=Fe[ft])}return _e?`${_e.process.serviceName}: ${_e.operationName}`:""}const Ma=(0,ce.memoize)(hr,Fe=>Fe.length?Fe[0].traceID:0);function ho(Fe){for(let _e=0;_e<Fe.length;_e++){const tt=Fe[_e].tags.filter($t=>$t.key==="http.request.method"),ft=Fe[_e].tags.filter($t=>$t.key==="http.response.status_code"),Mt=Fe[_e].tags.filter($t=>$t.key==="http.route");if(tt.length>0||ft.length>0||Mt.length>0)return{method:tt,status:ft,url:Mt}}for(let _e=0;_e<Fe.length;_e++){const tt=Fe[_e].tags.filter($t=>$t.key==="http.method"),ft=Fe[_e].tags.filter($t=>$t.key==="http.status_code"),Mt=Fe[_e].tags.filter($t=>$t.key==="http.url"||$t.key==="http.target"||$t.key==="http.path");if(tt.length>0||ft.length>0||Mt.length>0)return{method:tt,status:ft,url:Mt}}return{}}const Uo=(0,ce.memoize)(ho,Fe=>Fe.length?Fe[0].traceID:0);var No=e(2913),Mi=e(18358);const ri=Fe=>({ActionButton:(0,n.css)`
      label: ActionButton;
      overflow: hidden;
      position: relative;
      &:after {
        content: '';
        background: ${Fe.colors.primary.main};
        display: block;
        position: absolute;
        right: 0;
        width: 100%;
        height: 100%;
        opacity: 0;
        transition: all 0.8s;
      }
      &:active:after {
        margin: 0;
        opacity: 0.3;
        transition: 0s;
      }
    `});function wo(Fe){const{onClick:_e,ariaLabel:tt,label:ft,icon:Mt}=Fe,$t=(0,a.of)(ri);return(0,t.jsx)(Ve.$n,{className:$t.ActionButton,size:"sm",variant:"secondary",fill:"outline",type:"button",icon:Mt,"aria-label":tt,onClick:_e,children:ft})}const oi=Fe=>({TracePageActions:(0,n.css)({label:"TracePageActions",display:"flex",alignItems:"center",justifyContent:"center",gap:"4px",marginBottom:"10px"}),feedback:(0,n.css)({margin:"6px 6px 6px 0",color:Fe.colors.text.secondary,fontSize:Fe.typography.bodySmall.fontSize,"&:hover":{color:Fe.colors.text.link}})});function cl(Fe){const{traceId:_e,data:tt,app:ft}=Fe,Mt=(0,a.$j)(),$t=oi(Mt),[Jt,nn]=(0,i.useState)(!1),Dn=()=>{navigator.clipboard.writeText(_e),nn(!0),setTimeout(()=>{nn(!1)},5e3)},In=()=>{const ts=(0,Mi.ek)(tt,"Trace-"+_e.substring(_e.length-6));(0,s.rR)("grafana_traces_download_traces_clicked",{app:ft,grafana_version:No.config.buildInfo.version,trace_format:ts,location:"trace-view"})};return(0,t.jsxs)("div",{className:$t.TracePageActions,children:[(0,t.jsxs)("a",{href:"https://forms.gle/RZDEx8ScyZNguDoC8",className:$t.feedback,title:"Share your thoughts about tracing in Grafana.",target:"_blank",rel:"noreferrer noopener",children:[(0,t.jsx)($e.I,{name:"comment-alt-message"})," Give feedback"]}),(0,t.jsx)(wo,{onClick:Dn,ariaLabel:"Copy Trace ID",label:Jt?"Copied!":"Trace ID",icon:"copy"}),(0,t.jsx)(wo,{onClick:In,ariaLabel:"Export Trace",label:"Export",icon:"save"})]})}var Lr=e(50877),Vi=e(3721),Si=e(40996),Tr=e(14186),ii=e(10354);const Yo=/^(-?\d+(?:\.\d+)?)(ms|[Mwdhmsy])$/,kr=(Fe,_e)=>!(Fe.match(_e)||!Fe),_i=Fe=>{const _e=Fe.validationRegex||Yo,[tt,ft]=(0,i.useState)(()=>Fe.value?kr(Fe.value,_e):!1);(0,Si.A)(()=>{ft(kr(Fe.value,_e))},500,[Fe.value]);const Mt={labelWidth:26,disabled:Fe.disabled??!1,invalid:tt,error:Fe.isInvalidError};return Fe.label&&(Mt.label=Fe.label,Mt.tooltip=Fe.tooltip||""),(0,t.jsx)(Tr.I,{...Mt,children:(0,t.jsx)(ii.p,{type:"text",placeholder:Fe.placeholder||"0",width:Fe.width||40,onChange:$t=>{Fe.onChange($t.currentTarget.value)},value:Fe.value,"aria-label":Fe.ariaLabel||"interval input"})})};var zi=e(82762),Po=e(39268),fo=e(66864),rr=e(90182),li=e(15583);class dl extends i.PureComponent{constructor(){super(...arguments),this.clearUiFind=()=>{this.props.onChange("")}}static{this.defaultProps={value:void 0}}render(){const{value:_e}=this.props,tt=(0,t.jsx)(t.Fragment,{children:_e&&_e.length&&(0,t.jsx)(Y.K,{name:"times",onClick:this.clearUiFind,tooltip:"Clear input"})});return(0,t.jsx)("div",{style:{width:"200px"},children:(0,t.jsx)(ii.p,{placeholder:"Find...",onChange:ft=>this.props.onChange(ft.currentTarget.value),suffix:tt,value:_e})})}}const Hi=(0,i.memo)(function(_e){const{trace:tt,spanFilterMatches:ft,setFocusedSpanIdForSearch:Mt,focusedSpanIndexForSearch:$t,setFocusedSpanIndexForSearch:Jt,datasourceType:nn,showSpanFilters:Dn}=_e,In=ul((0,a.$j)(),Dn);(0,i.useEffect)(()=>{if(ft&&$t!==-1){const ms=Array.from(ft);Mt(ms[$t])}},[$t,Mt,ft]);const ts=(ms,xa)=>{if(ms.preventDefault(),ms.stopPropagation(),xa){if((0,s.rR)("grafana_traces_trace_view_find_next_prev_clicked",{datasourceType:nn,grafana_version:r.$.buildInfo.version,direction:"next"}),$t===-1||ft&&$t===ft.size-1){Jt(0);return}Jt($t+1)}},hs=(ms,xa)=>{if(ms.preventDefault(),ms.stopPropagation(),xa){if((0,s.rR)("grafana_traces_trace_view_find_next_prev_clicked",{datasourceType:nn,grafana_version:r.$.buildInfo.version,direction:"prev"}),ft&&($t===-1||$t===0)){Jt(ft.size-1);return}Jt($t-1)}},Yn=(ms,xa)=>{ms.key==="Enter"&&ts(ms,xa)},bs=(ms,xa)=>{ms.key==="Enter"&&hs(ms,xa)},Ns=(ft&&ft?.size>0)??!1,ns=Ns?In.button:(0,n.cx)(In.button,In.buttonDisabled),ta=(0,i.useCallback)(ms=>(0,t.jsx)(qe.m,{content:ms,placement:"top",children:(0,t.jsx)("span",{className:In.tooltip,children:(0,t.jsx)($e.I,{name:"info-circle",size:"md"})})}),[In.tooltip]),Ms=(0,i.useCallback)((ms,xa)=>{let Ua=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{children:`${tt.spans.length} spans`}),ta((0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{children:["Services: ",xa]}),(0,t.jsxs)("div",{children:["Depth: ",ms]})]}))]});if(ft)if(ft.size===0)Ua=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{children:"0 matches"}),ta("There are 0 span matches for the filters selected. Please try removing some of the selected filters.")]});else{const _a=ft.size===1?"match":"matches",La=$t!==-1?`${$t+1}/${ft.size} ${_a}`:`${ft.size} ${_a}`,va=[];ft.forEach(wa=>{tt.processes[wa]&&va.push(tt.processes[wa].serviceName)}),Ua=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{children:La}),ta((0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{children:["Services: ",new Set(va).size,"/",xa]}),(0,t.jsxs)("div",{children:["Depth: ",ms]})]}))]})}return Ua},[$t,ta,ft,tt.processes,tt.spans]),Qs=new Set((0,ce.values)(tt.processes).map(ms=>ms.serviceName)).size,oa=(0,ce.get)((0,ce.maxBy)(tt.spans,"depth"),"depth",0)+1;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:In.matches,children:Ms(oa,Qs)}),(0,t.jsxs)("div",{className:Ns?In.buttons:(0,n.cx)(In.buttons,In.buttonsDisabled),children:[(0,t.jsx)("div",{"aria-label":"Prev result button",className:ns,onClick:ms=>hs(ms,Ns),onKeyDown:ms=>bs(ms,Ns),role:"button",tabIndex:Ns?0:-1,children:"Prev"}),(0,t.jsx)("div",{"aria-label":"Next result button",className:ns,onClick:ms=>ts(ms,Ns),onKeyDown:ms=>Yn(ms,Ns),role:"button",tabIndex:Ns?0:-1,children:"Next"})]})]})}),ul=(Fe,_e)=>{const tt=(0,Ve.hs)({theme:Fe,variant:"secondary",size:_e?"md":"sm",iconOnly:!1,fill:"outline"});return{buttons:(0,n.css)`
      display: inline-flex;
      gap: 4px;
    `,buttonsDisabled:(0,n.css)`
      cursor: not-allowed;
    `,button:(0,n.css)`
      ${tt.button};
    `,buttonDisabled:(0,n.css)`
      ${tt.disabled};
      pointer-events: none;
    `,matches:(0,n.css)`
      margin-right: ${Fe.spacing(2)};
      text-wrap: nowrap;
    `,tooltip:(0,n.css)`
      color: #aaa;
      margin: 0 0 0 5px;
    `}};var ki=e(15292);function hl(Fe,_e){if(!_e)return;let tt=!1;Fe.serviceName&&(_e=Oi(_e,Fe),tt=!0),Fe.spanName&&(_e=mo(_e,Fe),tt=!0),(Fe.from||Fe.to)&&(_e=Ii(_e,Fe),tt=!0);const ft=fl(_e,Fe.tags);if(ft&&(_e=ft,tt=!0),Fe.query){const Mt=Gi(Fe.query,_e);Mt&&(_e=Mt,tt=!0)}return tt?new Set(_e.map(Mt=>Mt.spanID)):void 0}function Gi(Fe,_e){if(!_e)return;const tt=[];Fe.split(/\s+/).filter(Boolean).forEach(Jt=>{tt.push(Jt.toLowerCase())});const ft=(Jt,nn)=>Jt.some(Dn=>nn.toLowerCase().includes(Dn)),Mt=Jt=>Jt?Jt.some(nn=>ft(tt,nn.key)||ft(tt,ci(nn.value))):!1,$t=Jt=>ft(tt,Jt.operationName)||ft(tt,Jt.process.serviceName)||Mt(Jt.tags)||Jt.kind&&ft(tt,Jt.kind)||Jt.statusCode!==void 0&&ft(tt,We.s[Jt.statusCode])||Jt.statusMessage&&ft(tt,Jt.statusMessage)||Jt.instrumentationLibraryName&&ft(tt,Jt.instrumentationLibraryName)||Jt.instrumentationLibraryVersion&&ft(tt,Jt.instrumentationLibraryVersion)||Jt.traceState&&ft(tt,Jt.traceState)||Jt.logs!==null&&Jt.logs.some(nn=>Mt(nn.fields))||Mt(Jt.process.tags)||tt.some(nn=>nn===Jt.spanID);return _e.filter($t)}const fl=(Fe,_e)=>{if(_e=_e.filter(tt=>tt.key&&tt.key!==""||tt.value),_e.length>0)return Fe.filter(tt=>_e.every(ft=>ft.key&&ft.value?ft.operator==="="&&Yi(ft,tt)?Ko(ft.operator,!0):ft.operator==="=~"&&Qi(ft,tt)||ft.operator==="!="&&!Yi(ft,tt)||ft.operator==="!~"&&!Qi(ft,tt)?Ko(ft.operator,!1):!1:ft.key&&(tt.tags.some(Mt=>Wo(ft.key,Mt.key))||tt.process.tags.some(Mt=>Wo(ft.key,Mt.key))||tt.logs&&tt.logs.some(Mt=>Mt.fields.some($t=>Wo(ft.key,$t.key)))||tt.kind&&ft.key===en||tt.statusCode!==void 0&&ft.key===Je||tt.statusMessage&&ft.key===ct||tt.instrumentationLibraryName&&ft.key===ot||tt.instrumentationLibraryVersion&&ft.key===Qe||tt.traceState&&ft.key===pt||ft.key===Pt)?Ko(ft.operator,!0):Ko(ft.operator,!1)))},Qi=(Fe,_e)=>_e.tags.some(tt=>bo(Fe,tt))||_e.process.tags.some(tt=>bo(Fe,tt))||_e.logs&&_e.logs.some(tt=>tt.fields.some(ft=>bo(Fe,ft)))||_e.kind&&Fe.key===en&&Fe.value?.includes(_e.kind)||_e.statusCode!==void 0&&Fe.key===Je&&Fe.value?.includes(We.s[_e.statusCode].toLowerCase())||_e.statusMessage&&Fe.key===ct&&Fe.value?.includes(_e.statusMessage)||_e.instrumentationLibraryName&&Fe.key===ot&&Fe.value?.includes(_e.instrumentationLibraryName)||_e.instrumentationLibraryVersion&&Fe.key===Qe&&Fe.value?.includes(_e.instrumentationLibraryVersion)||_e.traceState&&Fe.key===pt&&Fe.value?.includes(_e.traceState)||Fe.key===Pt&&Fe.value?.includes(_e.spanID),Yi=(Fe,_e)=>_e.tags.some(tt=>Fo(Fe,tt))||_e.process.tags.some(tt=>Fo(Fe,tt))||_e.logs&&_e.logs.some(tt=>tt.fields.some(ft=>Fo(Fe,ft)))||_e.kind&&Fe.key===en&&Fe.value===_e.kind||_e.statusCode!==void 0&&Fe.key===Je&&Fe.value===We.s[_e.statusCode].toLowerCase()||_e.statusMessage&&Fe.key===ct&&Fe.value===_e.statusMessage||_e.instrumentationLibraryName&&Fe.key===ot&&Fe.value===_e.instrumentationLibraryName||_e.instrumentationLibraryVersion&&Fe.key===Qe&&Fe.value===_e.instrumentationLibraryVersion||_e.traceState&&Fe.key===pt&&Fe.value===_e.traceState||Fe.key===Pt&&Fe.value===_e.spanID,Wo=(Fe,_e)=>Fe===_e.toString(),Fo=(Fe,_e)=>Fe.key===_e.key&&Fe.value===ci(_e.value),bo=(Fe,_e)=>_e.key.includes(Fe.key||"")&&ci(_e.value).includes(Fe.value||""),ci=Fe=>Fe?Fe.toString():"",Ko=(Fe,_e)=>{switch(Fe){case"=":return _e;case"!=":return!_e;case"~=":return!_e;case"!~":return!_e;default:return!_e}},Oi=(Fe,_e)=>Fe.filter(tt=>_e.serviceNameOperator==="="?tt.process.serviceName===_e.serviceName:tt.process.serviceName!==_e.serviceName),mo=(Fe,_e)=>Fe.filter(tt=>_e.spanNameOperator==="="?tt.operationName===_e.spanName:tt.operationName!==_e.spanName),Ii=(Fe,_e)=>{const tt=Co(_e?.from||""),ft=Co(_e?.to||"");let Mt=[];if(tt&&(Mt=Fe.filter($t=>_e.fromOperator===">"?$t.duration>tt:$t.duration>=tt)),ft){const $t=Jt=>_e.toOperator==="<"?Jt.duration<ft:Jt.duration<=ft;Mt=Mt.length>0?Mt.filter(Jt=>$t(Jt)):Fe.filter(Jt=>$t(Jt))}return Mt},Co=Fe=>{if(Fe.includes("ns"))return parseFloat(Fe.split("ns")[0])/1e3;if(Fe.includes("us"))return parseFloat(Fe.split("us")[0]);if(Fe.includes("\xB5s"))return parseFloat(Fe.split("\xB5s")[0]);if(Fe.includes("ms"))return parseFloat(Fe.split("ms")[0])*1e3;if(Fe.includes("s"))return parseFloat(Fe.split("s")[0])*1e3*1e3;if(Fe.includes("m"))return parseFloat(Fe.split("m")[0])*1e3*1e3*60;if(Fe.includes("h"))return parseFloat(Fe.split("h")[0])*1e3*1e3*60*60},jr=(0,i.memo)(function(_e){const{trace:tt,search:ft,spanFilterMatches:Mt,showSpanFilterMatchesOnly:$t,setShowSpanFilterMatchesOnly:Jt,showCriticalPathSpansOnly:nn,setShowCriticalPathSpansOnly:Dn,focusedSpanIndexForSearch:In,setFocusedSpanIndexForSearch:ts,setFocusedSpanIdForSearch:hs,datasourceType:Yn,clear:bs,showSpanFilters:Ns}=_e,ns=(0,a.of)(di),ta=(0,i.useMemo)(()=>ft.serviceName&&ft.serviceName!==""||ft.spanName&&ft.spanName!==""||Co(ft.from||"")||Co(ft.to||"")||ft.tags.length>1||ft.tags.some(Ms=>Ms.key)||ft.query&&ft.query!==""||$t,[ft.serviceName,ft.spanName,ft.from,ft.to,ft.tags,ft.query,$t]);return(0,t.jsx)("div",{className:ns.container,children:(0,t.jsx)("div",{className:ns.controls,children:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(Ve.$n,{variant:"destructive",disabled:!ta,type:"button",fill:"outline","aria-label":"Clear filters button",onClick:bs,children:"Clear"}),(0,t.jsxs)("div",{className:ns.matchesOnly,children:[(0,t.jsx)(ki.d,{value:$t,onChange:Ms=>Jt(Ms.currentTarget.checked??!1),label:"Show matches only switch",disabled:!Mt?.size}),(0,t.jsx)(Ve.$n,{onClick:()=>Jt(!$t),className:ns.clearMatchesButton,variant:"secondary",fill:"text",disabled:!Mt?.size,children:"Show matches only"})]}),(0,t.jsxs)("div",{className:ns.matchesOnly,children:[(0,t.jsx)(ki.d,{value:nn,onChange:Ms=>Dn(Ms.currentTarget.checked??!1),label:"Show critical path only switch"}),(0,t.jsx)(Ve.$n,{onClick:()=>Dn(!nn),className:ns.clearMatchesButton,variant:"secondary",fill:"text",children:"Show critical path only"})]})]}),(0,t.jsx)("div",{className:ns.nextPrevResult,children:(0,t.jsx)(Hi,{trace:tt,spanFilterMatches:Mt,setFocusedSpanIdForSearch:hs,focusedSpanIndexForSearch:In,setFocusedSpanIndexForSearch:ts,datasourceType:Yn,showSpanFilters:Ns})})]})})})}),di=Fe=>{const _e=(0,Ve.hs)({theme:Fe,variant:"secondary",size:"md",iconOnly:!1,fill:"outline"});return{button:(0,n.css)(_e.button),buttonDisabled:(0,n.css)(_e.disabled,{pointerEvents:"none",cursor:"not-allowed"}),container:(0,n.css)`
      display: inline;
    `,controls:(0,n.css)`
      display: flex;
      justify-content: flex-end;
      margin: 5px 0 0 0;
    `,matchesOnly:(0,n.css)`
      display: inline-flex;
      margin: 0 0 0 25px;
      vertical-align: middle;
      align-items: center;
    `,clearMatchesButton:(0,n.css)`
      color: ${Fe.colors.text.primary};

      &:hover {
        background: inherit;
      }
    `,nextPrevResult:(0,n.css)`
      margin-left: auto;
      display: flex;
      align-items: center;
    `}},vo=(0,i.memo)(Fe=>{const{trace:_e,search:tt,setSearch:ft,showSpanFilters:Mt,setShowSpanFilters:$t,showSpanFilterMatchesOnly:Jt,setShowSpanFilterMatchesOnly:nn,showCriticalPathSpansOnly:Dn,setShowCriticalPathSpansOnly:In,setFocusedSpanIdForSearch:ts,spanFilterMatches:hs,datasourceType:Yn}=Fe,bs={...(0,a.of)(ui)},[Ns,ns]=(0,i.useState)(),[ta,Ms]=(0,i.useState)(),[Qs,oa]=(0,i.useState)(),[ms,xa]=(0,i.useState)({}),[Ua,_a]=(0,i.useState)(-1),La=/^\d+(?:\.\d)?\d*(?:ns|us|µs|ms|s|m|h)$/,va=(0,i.useCallback)(()=>{ns(void 0),Ms(void 0),oa(void 0),xa({}),ft(li.Ji),nn(!1)},[ft,nn]);if((0,i.useEffect)(()=>{va()},[va,_e]),!_e)return null;const wa=as=>{_a(-1),ts(""),ft(as)},Kr=()=>{if(!Ns){const as=_e.spans.map(ls=>ls.process.serviceName);ns((0,ce.uniq)(as).sort().map(Lr.z))}},Pr=()=>{if(!ta){const as=_e.spans.map(ls=>ls.operationName);Ms((0,ce.uniq)(as).sort().map(Lr.z))}},fr=()=>{if(!Qs){let as=[],ls=[];_e.spans.forEach(Cs=>{Cs.tags.forEach(zs=>{as.push(zs.key)}),Cs.process.tags.forEach(zs=>{as.push(zs.key)}),Cs.logs!==null&&Cs.logs.forEach(zs=>{zs.fields.forEach(Nr=>{ls.push(Nr.key)})}),Cs.kind&&as.push(en),Cs.statusCode!==void 0&&as.push(Je),Cs.statusMessage&&as.push(ct),Cs.instrumentationLibraryName&&as.push(ot),Cs.instrumentationLibraryVersion&&as.push(Qe),Cs.traceState&&as.push(pt),as.push(Pt)}),as=(0,ce.uniq)(as).sort(),ls=(0,ce.uniq)(ls).sort(),oa([...as,...ls].map(Lr.z))}},Qr=async as=>{const ls=[];return _e.spans.forEach(Cs=>{const zs=Cs.tags.find(Ge=>Ge.key===as)?.value;zs&&ls.push(zs.toString());const Nr=Cs.process.tags.find(Ge=>Ge.key===as)?.value;switch(Nr&&ls.push(Nr.toString()),Cs.logs!==null&&Cs.logs.forEach(Ge=>{const Ae=Ge.fields.find(Ke=>Ke.key===as)?.value;Ae&&ls.push(Ae.toString())}),as){case en:Cs.kind&&ls.push(Cs.kind);break;case Je:Cs.statusCode!==void 0&&ls.push(We.s[Cs.statusCode].toLowerCase());break;case ct:Cs.statusMessage&&ls.push(Cs.statusMessage);break;case ot:Cs.instrumentationLibraryName&&ls.push(Cs.instrumentationLibraryName);break;case Qe:Cs.instrumentationLibraryVersion&&ls.push(Cs.instrumentationLibraryVersion);break;case pt:Cs.traceState&&ls.push(Cs.traceState);break;case Pt:ls.push(Cs.spanID);break;default:break}}),(0,ce.uniq)(ls).sort().map(Lr.z)},$r=(as,ls)=>{ft({...tt,tags:tt.tags?.map(zs=>zs.id===as.id?{...zs,key:ls?.value||"",value:void 0}:zs)}),(async()=>{if(ls?.value)xa({...ms,[as.id]:await Qr(ls.value)});else{const zs={...ms};zs[as.id]&&delete zs[as.id],xa(zs)}})()},Zr=()=>{const as={id:(0,li.zE)(),operator:"="};ft({...tt,tags:[...tt.tags,as]})},co=as=>{let ls=tt.tags.filter(Cs=>Cs.id!==as);ls.length===0&&(ls=[{id:(0,li.zE)(),operator:"="}]),ft({...tt,tags:ls})},gr=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(qe.m,{content:"Filter your spans below. You can continue to apply filters until you have narrowed down your resulting spans to the select few you are most interested in.",placement:"right",children:(0,t.jsxs)("span",{className:bs.collapseLabel,children:["Span Filters",(0,t.jsx)($e.I,{size:"md",name:"info-circle"})]})}),!Mt&&(0,t.jsx)("div",{className:bs.nextPrevResult,children:(0,t.jsx)(Hi,{trace:_e,spanFilterMatches:hs,setFocusedSpanIdForSearch:ts,focusedSpanIndexForSearch:Ua,setFocusedSpanIndexForSearch:_a,datasourceType:Yn,showSpanFilters:Mt})})]});return(0,t.jsx)("div",{className:bs.container,children:(0,t.jsxs)(zi.S,{label:gr,collapsible:!0,isOpen:Mt,onToggle:$t,children:[(0,t.jsxs)(Po.C,{className:bs.flexContainer,children:[(0,t.jsx)(Tr.I,{label:"Service Name",labelWidth:16,children:(0,t.jsxs)(fo.Gy,{spacing:"xs",children:[(0,t.jsx)(rr.l6,{"aria-label":"Select service name operator",onChange:as=>wa({...tt,serviceNameOperator:as.value}),options:[(0,Lr.z)("="),(0,Lr.z)("!=")],value:tt.serviceNameOperator}),(0,t.jsx)(rr.l6,{"aria-label":"Select service name",isClearable:!0,onChange:as=>wa({...tt,serviceName:as?.value||""}),onOpenMenu:Kr,options:Ns,placeholder:"All service names",value:tt.serviceName||null})]})}),(0,t.jsx)(dl,{onChange:as=>{wa({...tt,query:as}),as===""&&nn(!1)},value:tt.query||""})]}),(0,t.jsx)(Po.C,{children:(0,t.jsx)(Tr.I,{label:"Span Name",labelWidth:16,children:(0,t.jsxs)(fo.Gy,{spacing:"xs",children:[(0,t.jsx)(rr.l6,{"aria-label":"Select span name operator",onChange:as=>wa({...tt,spanNameOperator:as.value}),options:[(0,Lr.z)("="),(0,Lr.z)("!=")],value:tt.spanNameOperator}),(0,t.jsx)(rr.l6,{"aria-label":"Select span name",isClearable:!0,onChange:as=>wa({...tt,spanName:as?.value||""}),onOpenMenu:Pr,options:ta,placeholder:"All span names",value:tt.spanName||null})]})})}),(0,t.jsx)(Po.C,{children:(0,t.jsx)(Tr.I,{label:"Duration",labelWidth:16,tooltip:"Filter by duration. Accepted units are ns, us, ms, s, m, h",children:(0,t.jsxs)(fo.Gy,{spacing:"xs",align:"flex-start",children:[(0,t.jsx)(rr.l6,{"aria-label":"Select min span operator",onChange:as=>wa({...tt,fromOperator:as.value}),options:[(0,Lr.z)(">"),(0,Lr.z)(">=")],value:tt.fromOperator}),(0,t.jsx)("div",{className:bs.intervalInput,children:(0,t.jsx)(_i,{ariaLabel:"Select min span duration",onChange:as=>wa({...tt,from:as}),isInvalidError:"Invalid duration",placeholder:"e.g. 100ms, 1.2s",width:18,value:tt.from||"",validationRegex:La})}),(0,t.jsx)(rr.l6,{"aria-label":"Select max span operator",onChange:as=>wa({...tt,toOperator:as.value}),options:[(0,Lr.z)("<"),(0,Lr.z)("<=")],value:tt.toOperator}),(0,t.jsx)(_i,{ariaLabel:"Select max span duration",onChange:as=>wa({...tt,to:as}),isInvalidError:"Invalid duration",placeholder:"e.g. 100ms, 1.2s",width:18,value:tt.to||"",validationRegex:La})]})})}),(0,t.jsx)(Po.C,{className:bs.tagsRow,children:(0,t.jsx)(Tr.I,{label:"Tags",labelWidth:16,tooltip:"Filter by tags, process tags or log fields in your spans.",children:(0,t.jsx)("div",{children:tt.tags.map((as,ls)=>(0,t.jsx)("div",{children:(0,t.jsxs)(fo.Gy,{spacing:"xs",width:"auto",children:[(0,t.jsx)(rr.l6,{"aria-label":"Select tag key",isClearable:!0,onChange:Cs=>$r(as,Cs),onOpenMenu:fr,options:Qs,placeholder:"Select tag",value:as.key||null},as.key),(0,t.jsx)(rr.l6,{"aria-label":"Select tag operator",onChange:Cs=>{wa({...tt,tags:tt.tags?.map(zs=>zs.id===as.id?{...zs,operator:Cs.value}:zs)})},options:[(0,Lr.z)("="),(0,Lr.z)("!="),(0,Lr.z)("=~"),(0,Lr.z)("!~")],value:as.operator}),(0,t.jsxs)("span",{className:bs.tagValues,children:[(as.operator==="="||as.operator==="!=")&&(0,t.jsx)(rr.l6,{"aria-label":"Select tag value",isClearable:!0,onChange:Cs=>{wa({...tt,tags:tt.tags?.map(zs=>zs.id===as.id?{...zs,value:Cs?.value||""}:zs)})},options:ms[as.id]?ms[as.id]:[],placeholder:"Select value",value:as.value},as.value),(as.operator==="=~"||as.operator==="!~")&&(0,t.jsx)(ii.p,{"aria-label":"Input tag value",onChange:Cs=>{wa({...tt,tags:tt.tags?.map(zs=>zs.id===as.id?{...zs,value:Cs?.currentTarget?.value||""}:zs)})},placeholder:"Tag value",width:18,value:as.value||""})]}),(as.key||as.value||tt.tags.length>1)&&(0,t.jsx)(Vi.Z,{"aria-label":"Remove tag",variant:"secondary",icon:"times",onClick:()=>co(as.id),tooltip:"Remove tag"}),(as.key||as.value)&&ls===tt.tags.length-1&&(0,t.jsx)("span",{className:bs.addTag,children:(0,t.jsx)(Vi.Z,{"aria-label":"Add tag",variant:"secondary",icon:"plus",onClick:Zr,tooltip:"Add tag"})})]})},ls))})})}),(0,t.jsx)(jr,{trace:_e,search:tt,spanFilterMatches:hs,showSpanFilterMatchesOnly:Jt,setShowSpanFilterMatchesOnly:nn,showCriticalPathSpansOnly:Dn,setShowCriticalPathSpansOnly:In,setFocusedSpanIdForSearch:ts,focusedSpanIndexForSearch:Ua,setFocusedSpanIndexForSearch:_a,datasourceType:Yn,clear:va,showSpanFilters:Mt})]})})});vo.displayName="SpanFilters";const ui=Fe=>({container:(0,n.css)`
      label: SpanFilters;
      margin: 0.5em 0 -${Fe.spacing(1)} 0;
      z-index: 5;

      & > div {
        border-left: none;
        border-right: none;
      }
    `,collapseLabel:(0,n.css)`
      svg {
        color: #aaa;
        margin: -2px 0 0 10px;
      }
    `,flexContainer:(0,n.css)({display:"flex",justifyContent:"space-between"}),addTag:(0,n.css)({marginLeft:Fe.spacing(1)}),intervalInput:(0,n.css)`
      margin: 0 -4px 0 0;
    `,tagsRow:(0,n.css)`
      margin: -4px 0 0 0;
    `,tagValues:(0,n.css)`
      max-width: 200px;
    `,nextPrevResult:(0,n.css)`
      flex: 1;
      align-items: center;
      display: flex;
      justify-content: flex-end;
      margin-right: ${Fe.spacing(1)};
    `}),gl=(0,i.memo)(Fe=>{const{trace:_e,data:tt,app:ft,timeZone:Mt,search:$t,setSearch:Jt,showSpanFilters:nn,setShowSpanFilters:Dn,showSpanFilterMatchesOnly:In,setShowSpanFilterMatchesOnly:ts,showCriticalPathSpansOnly:hs,setShowCriticalPathSpansOnly:Yn,setFocusedSpanIdForSearch:bs,spanFilterMatches:Ns,datasourceType:ns,setHeaderHeight:ta}=Fe,Ms=(0,a.of)(yo);(0,i.useEffect)(()=>{ta(document.querySelector("."+Ms.header)?.scrollHeight??0)},[ta,nn,Ms.header]);const Qs=(0,i.useMemo)(()=>_e?Aa(_e):[],[_e]);if(!_e)return null;const oa=(wa,Kr)=>{const Pr=(0,et.LE)(wa.startTime/1e3,{timeZone:Kr,defaultWithMS:!0}),fr=Pr.match(/^(.+)(:\d\d\.\d+)$/);return fr?(0,t.jsxs)("span",{className:Ms.TracePageHeaderOverviewItemValue,children:[fr[1],(0,t.jsx)("span",{className:Ms.TracePageHeaderOverviewItemValueDetail,children:fr[2]})]}):Pr},ms=(0,t.jsxs)("h1",{className:u()(Ms.title),children:[(0,t.jsx)(Js,{traceName:Ma(_e.spans)}),(0,t.jsx)("small",{className:Ms.duration,children:(0,D.a3)(_e.duration)})]}),{method:xa,status:Ua,url:_a}=Uo(_e.spans);let La="green";Ua&&Ua.length>0&&(Ua[0].value.toString().charAt(0)==="4"?La="orange":Ua[0].value.toString().charAt(0)==="5"&&(La="red"));const va=wa=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{children:"http.url or http.target or http.path"}),(0,t.jsxs)("div",{children:["(",wa,")"]})]});return(0,t.jsxs)("header",{className:Ms.header,children:[(0,t.jsxs)("div",{className:Ms.titleRow,children:[Qs&&Qs.length>0&&(0,t.jsx)(Lt,{links:Qs,className:Ms.TracePageHeaderBack}),ms,(0,t.jsx)(cl,{traceId:_e.traceID,data:tt,app:ft})]}),(0,t.jsxs)("div",{className:Ms.subtitle,children:[(0,t.jsx)("span",{className:Ms.timestamp,children:oa(_e,Mt)}),(0,t.jsxs)("span",{className:Ms.tagMeta,children:[xa&&xa.length>0&&(0,t.jsx)(qe.m,{content:"http.method",interactive:!0,children:(0,t.jsx)("span",{className:Ms.tag,children:(0,t.jsx)(Ur.E,{text:xa[0].value,color:"blue"})})}),Ua&&Ua.length>0&&(0,t.jsx)(qe.m,{content:"http.status_code",interactive:!0,children:(0,t.jsx)("span",{className:Ms.tag,children:(0,t.jsx)(Ur.E,{text:Ua[0].value,color:La})})}),_a&&_a.length>0&&(0,t.jsx)(qe.m,{content:va(_a[0].value),interactive:!0,children:(0,t.jsx)("span",{className:Ms.url,children:_a[0].value})})]})]}),(0,t.jsx)(vo,{trace:_e,showSpanFilters:nn,setShowSpanFilters:Dn,showSpanFilterMatchesOnly:In,setShowSpanFilterMatchesOnly:ts,showCriticalPathSpansOnly:hs,setShowCriticalPathSpansOnly:Yn,search:$t,setSearch:Jt,spanFilterMatches:Ns,setFocusedSpanIdForSearch:bs,datasourceType:ns})]})});gl.displayName="TracePageHeader";const yo=Fe=>({TracePageHeaderBack:(0,n.css)`
      label: TracePageHeaderBack;
      align-items: center;
      align-self: stretch;
      background-color: #fafafa;
      border-bottom: 1px solid #ddd;
      border-right: 1px solid #ddd;
      color: inherit;
      display: flex;
      font-size: 1.4rem;
      padding: 0 1rem;
      margin-bottom: -1px;
      &:hover {
        background-color: #f0f0f0;
        border-color: #ccc;
      }
    `,TracePageHeaderOverviewItemValueDetail:u()((0,n.css)`
        label: TracePageHeaderOverviewItemValueDetail;
        color: #aaa;
      `,"trace-item-value-detail"),TracePageHeaderOverviewItemValue:(0,n.css)`
      label: TracePageHeaderOverviewItemValue;
      &:hover > .trace-item-value-detail {
        color: unset;
      }
    `,header:(0,n.css)({label:"TracePageHeader",backgroundColor:Fe.colors.background.primary,padding:"0.5em 0 0 0",position:"sticky",top:0,zIndex:5,textAlign:"left"}),titleRow:(0,n.css)({alignItems:"flex-start",display:"flex",padding:"0 8px",flexWrap:"wrap"}),title:(0,n.css)({color:"inherit",flex:1,fontSize:"1.7em",lineHeight:"1em",marginBottom:0,minWidth:"200px"}),subtitle:(0,n.css)({flex:1,lineHeight:"1em",margin:"-0.5em 0.5em 0.75em 0.5em"}),tag:(0,n.css)({margin:"0 0.5em 0 0"}),duration:(0,n.css)({color:"#aaa",margin:"0 0.75em"}),timestamp:(0,n.css)({verticalAlign:"middle"}),tagMeta:(0,n.css)({margin:"0 0.75em",verticalAlign:"text-top"}),url:(0,n.css)({margin:"-2.5px 0.3em",height:"15px",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"700px",display:"inline-block"}),TracePageHeaderTraceId:(0,n.css)({label:"TracePageHeaderTraceId",whiteSpace:"nowrap",textOverflow:"ellipsis",maxWidth:"30%",display:"inline-block"})}),Jr="None",Ji="Duration",$o="Tag";function Ai({options:Fe,onOptionsChange:_e}){const tt=useStyles2(Xi),ft=[Jr,Ji,$o].map(toOption);return jsxs("div",{className:css({width:"100%"}),children:[jsx(InlineFieldRow,{className:tt.row,children:jsx(InlineField,{label:"Label",labelWidth:26,tooltip:"Default: duration",grow:!0,children:jsx(Select,{inputId:"label",options:ft,value:Fe.jsonData.spanBar?.type||"",onChange:Mt=>{updateDatasourcePluginJsonDataOption({onOptionsChange:_e,options:Fe},"spanBar",{...Fe.jsonData.spanBar,type:Mt?.value??""})},placeholder:"Duration",isClearable:!0,"aria-label":"select-label-name",width:40})})}),Fe.jsonData.spanBar?.type===$o&&jsx(InlineFieldRow,{className:tt.row,children:jsx(InlineField,{label:"Tag key",labelWidth:26,tooltip:"Tag key which will be used to get the tag value. A span's attributes and resources will be searched for the tag key",children:jsx(Input,{type:"text",placeholder:"Enter tag key",onChange:Mt=>updateDatasourcePluginJsonDataOption({onOptionsChange:_e,options:Fe},"spanBar",{...Fe.jsonData.spanBar,tag:Mt.currentTarget.value}),value:Fe.jsonData.spanBar?.tag||"",width:40})})})]})}const Vo=({options:Fe,onOptionsChange:_e})=>{let tt=Fe.type;return tt+=Fe.type==="tempo"?"/configure-tempo-data-source/#span-bar":"/#span-bar",jsx(ConfigSubSection,{title:"Span bar",description:jsx(ConfigDescriptionLink,{description:"Add additional info next to the service and operation on a span bar row in the trace view.",suffix:tt,feature:"the span bar"}),children:jsx(Ai,{options:Fe,onOptionsChange:_e})})},Xi=Fe=>({infoText:css`
    label: infoText;
    padding-bottom: ${Fe.spacing(2)};
    color: ${Fe.colors.text.secondary};
  `,row:css`
    label: row;
    align-items: baseline;
  `});class Fr{constructor(_e){const{isTagsOpen:tt,isProcessOpen:ft,isReferencesOpen:Mt,isWarningsOpen:$t,isStackTracesOpen:Jt,logs:nn,references:Dn}=_e||{};this.isTagsOpen=!!tt,this.isProcessOpen=!!ft,this.isReferencesOpen=!!Mt,this.isWarningsOpen=!!$t,this.isStackTracesOpen=!!Jt,this.logs={isOpen:!!(nn&&nn.isOpen),openedItems:nn&&nn.openedItems?new Set(nn.openedItems):new Set},this.references={isOpen:!!(Dn&&Dn.isOpen),openedItems:Dn&&Dn.openedItems?new Set(Dn.openedItems):new Set}}toggleTags(){const _e=new Fr(this);return _e.isTagsOpen=!this.isTagsOpen,_e}toggleProcess(){const _e=new Fr(this);return _e.isProcessOpen=!this.isProcessOpen,_e}toggleReferences(){const _e=new Fr(this);return _e.references.isOpen=!this.references.isOpen,_e}toggleReferenceItem(_e){const tt=new Fr(this);return tt.references.openedItems.has(_e)?tt.references.openedItems.delete(_e):tt.references.openedItems.add(_e),tt}toggleWarnings(){const _e=new Fr(this);return _e.isWarningsOpen=!this.isWarningsOpen,_e}toggleStackTraces(){const _e=new Fr(this);return _e.isStackTracesOpen=!this.isStackTracesOpen,_e}toggleLogs(){const _e=new Fr(this);return _e.logs.isOpen=!this.logs.isOpen,_e}toggleLogItem(_e){const tt=new Fr(this);return tt.logs.openedItems.has(_e)?tt.logs.openedItems.delete(_e):tt.logs.openedItems.add(_e),tt}}var Xr=e(25508);class Gr{static iterFunction(_e,tt=0){return ft=>_e(ft.value,ft,tt)}static searchFunction(_e){return typeof _e=="function"?_e:(tt,ft)=>_e instanceof Gr?ft===_e:tt===_e}constructor(_e,tt=[]){this.value=_e,this.children=tt}get depth(){return this.children.reduce((_e,tt)=>Math.max(tt.depth+1,_e),1)}get size(){let _e=0;return this.walk(()=>_e++),_e}addChild(_e){return this.children.push(_e instanceof Gr?_e:new Gr(_e)),this}find(_e){if(Gr.iterFunction(Gr.searchFunction(_e))(this))return this;for(let ft=0;ft<this.children.length;ft++){const Mt=this.children[ft].find(_e);if(Mt)return Mt}return null}getPath(_e){const tt=Gr.iterFunction(Gr.searchFunction(_e)),ft=(Mt,$t)=>{const Jt=$t.concat([Mt]);if(tt(Mt))return Jt;for(let nn=0;nn<Mt.children.length;nn++){const Dn=Mt.children[nn],In=ft(Dn,Jt);if(In)return In}return null};return ft(this,[])}walk(_e,tt=0){const ft=[];let Mt=tt;for(ft.push({node:this,depth:Mt});ft.length;){const $t=ft[ft.length-1];ft.pop();const{node:Jt,depth:nn}=$t;_e(Jt.value,Jt,nn),Mt=nn+1;let Dn=Jt.children.length-1;for(;Dn>=0;)ft.push({node:Jt.children[Dn],depth:Mt}),Dn--}}paths(_e){const tt=[];tt.push({node:this,childIndex:0});const ft=[];for(;tt.length;){const{node:Mt,childIndex:$t}=tt[tt.length-1];if(Mt.children.length>=$t+1)tt[tt.length-1].childIndex++,tt.push({node:Mt.children[$t],childIndex:0});else{if(Mt.children.length===0){const Jt=tt.map(nn=>nn.node.value);_e(Jt)}tt.pop()}}return ft}}const Ri=Fe=>Fe.spanID,pl=Fe=>Fe.references||[],Jo=(0,Xr.Mz)((0,Xr.Mz)(({span:Fe})=>Fe,pl),({type:Fe})=>Fe,(Fe,_e)=>Fe.find(tt=>tt.refType===_e)),Ul=(0,Xr.Mz)(Fe=>Jo({span:Fe,type:"CHILD_OF"}),Fe=>Fe?Fe.spanID:null),hi=Fe=>Fe.spans,Zi=(0,Xr.Mz)(hi,Fe=>Fe.reduce((_e,tt)=>_e.set(Ri(tt),tt),new Map)),qi="__root__";function Li(Fe,_e=null){const tt=new Map(Fe.spans.map(Jt=>[Jt.spanID,new Gr(Jt.spanID)])),ft=_e??new Map(Fe.spans.map(Jt=>[Jt.spanID,Jt])),Mt=new Gr(qi);Fe.spans.forEach(Jt=>{const nn=tt.get(Jt.spanID);if(Array.isArray(Jt.references)&&Jt.references.length){const{refType:Dn,spanID:In}=Jt.references[0];if(Dn==="CHILD_OF"||Dn==="FOLLOWS_FROM")(tt.get(In)||Mt).children?.push(nn);else throw new Error(`Unrecognized ref type: ${Dn}`)}else Mt.children.push(nn)});const $t=(Jt,nn)=>{const Dn=Jt?.value?ft.get(Jt.value.toString()):void 0,In=nn?.value?ft.get(nn.value.toString()):void 0;return+(Dn?.startTime>In?.startTime)||+(Dn?.startTime===In?.startTime)-1};return Fe.spans.forEach(Jt=>{const nn=tt.get(Jt.spanID);nn.children.length>1&&nn?.children.sort($t)}),Mt.children.sort($t),Mt}function fi(Fe){const _e=new Map,tt=Fe.reduce((Mt,$t)=>(Mt.some(Jt=>Jt.key===$t.key&&Jt.value===$t.value)?_e.set(`${$t.key}:${$t.value}`,`Duplicate tag "${$t.key}:${$t.value}"`):Mt.push($t),Mt),[]),ft=Array.from(_e.values());return{dedupedTags:tt,warnings:ft}}function ji(Fe,_e){const tt=Fe?.slice()??[],ft=(_e||[]).map(Mt=>Mt.toLowerCase());return tt.sort((Mt,$t)=>{const Jt=Mt.key.toLowerCase(),nn=$t.key.toLowerCase();for(let Dn=0;Dn<ft.length;Dn++){const In=ft[Dn];if(Jt.startsWith(In)&&!nn.startsWith(In))return-1;if(!Jt.startsWith(In)&&nn.startsWith(In))return 1}return Jt>nn?1:Jt<nn?-1:0}),tt}function Xo(Fe){if(!Fe?.traceID)return null;const _e=Fe.traceID.toLowerCase();let tt=0,ft=Number.MAX_SAFE_INTEGER;const Mt=new Map,$t=new Map;Fe.spans=Fe.spans.filter(Yn=>!!Yn.startTime),Fe.processes=Object.entries(Fe.processes).reduce((Yn,[bs,Ns])=>(Yn[bs]={...Ns,tags:ji(Ns.tags)},Yn),{});const Jt=Fe.spans.length;for(let Yn=0;Yn<Jt;Yn++){const bs=Fe.spans[Yn],{startTime:Ns,duration:ns,processID:ta}=bs;let Ms=bs.spanID;Ns<ft&&(ft=Ns),Ns+ns>tt&&(tt=Ns+ns);const Qs=Mt.get(Ms);Qs!=null?(console.warn(`Dupe spanID, ${Qs+1} x ${Ms}`,bs,$t.get(Ms)),(0,ce.isEqual)(bs,$t.get(Ms))&&console.warn("	 two spans with same ID have `isEqual(...) === true`"),Mt.set(Ms,Qs+1),Ms=`${Ms}_${Qs}`,bs.spanID=Ms):Mt.set(Ms,1),bs.process=Fe.processes[ta],$t.set(Ms,bs)}const nn=Li(Fe,$t),Dn=[],In={};nn.walk((Yn,bs,Ns=0)=>{if(Yn==="__root__"||typeof Yn!="string")return;const ns=$t.get(Yn);if(!ns)return;const{serviceName:ta}=ns.process;In[ta]=(In[ta]||0)+1,ns.relativeStartTime=ns.startTime-ft,ns.depth=Ns-1,ns.hasChildren=bs.children.length>0,ns.childSpanCount=bs.children.length,ns.warnings=ns.warnings||[],ns.tags=ns.tags||[],ns.references=ns.references||[],ns.childSpanIds=bs.children.slice().sort((Qs,oa)=>{const ms=$t.get(Qs.value),xa=$t.get(oa.value);return xa.startTime+xa.duration-(ms.startTime+ms.duration)}).map(Qs=>Qs.value);const Ms=fi(ns.tags);ns.tags=ji(Ms.dedupedTags,ss("topTagPrefixes")),ns.warnings=ns.warnings.concat(Ms.warnings),ns.references.forEach((Qs,oa)=>{const ms=$t.get(Qs.spanID);ms&&(Qs.span=ms,oa>0&&(ms.subsidiarilyReferencedBy=ms.subsidiarilyReferencedBy||[],ms.subsidiarilyReferencedBy.push({spanID:Yn,traceID:_e,span:ns,refType:Qs.refType})))}),Dn.push(ns)});const ts=Ma(Dn);return{services:Object.keys(In).map(Yn=>({name:Yn,numberOfSpans:In[Yn]})),spans:Dn,traceID:_e,traceName:ts,processes:Fe.processes,duration:tt-ft,startTime:ft,endTime:tt}}},92102:(k,R,e)=>{"use strict";e.d(R,{N:()=>t});var t=(n=>(n.Logs="log",n.Traces="trace",n.Metrics="metric",n.Profiles="profile",n.Session="session",n.Unknown="unknown",n))(t||{})},92151:(k,R,e)=>{"use strict";e.d(R,{EUpdateTypes:()=>n,default:()=>r});var t=(g=>(g.DragEnd="DragEnd",g.DragMove="DragMove",g.DragStart="DragStart",g.MouseEnter="MouseEnter",g.MouseLeave="MouseLeave",g.MouseMove="MouseMove",g))(t||{});const n=t;var i=e(2543);const s=0;class r{constructor({getBounds:a,tag:c,resetBoundsOnResize:o=!0,...h}){this.resetBounds=()=>{this._bounds=void 0},this._handleMinorMouseEvent=f=>{const{button:d,clientX:p,type:m}=f;if(this._isDragging||d!==s)return;let v=null,l;if(m==="mouseenter")v=n.MouseEnter,l=this._onMouseEnter;else if(m==="mouseleave")v=n.MouseLeave,l=this._onMouseLeave;else if(m==="mousemove")v=n.MouseMove,l=this._onMouseMove;else throw new Error(`invalid event type: ${m}`);if(!l)return;const{value:y,x:u}=this._getPosition(p);l({event:f,type:v,value:y,x:u,manager:this,tag:this.tag})},this._handleDragEvent=f=>{const{button:d,clientX:p,type:m}=f;let v=null,l;if(m==="mousedown"){if(this._isDragging||d!==s)return;window.addEventListener("mousemove",this._handleDragEvent),window.addEventListener("mouseup",this._handleDragEvent);const D=(0,i.get)(document,"body.style");D&&(D.userSelect="none"),this._isDragging=!0,v=n.DragStart,l=this._onDragStart}else if(m==="mousemove"){if(!this._isDragging)return;v=n.DragMove,l=this._onDragMove}else if(m==="mouseup"){if(!this._isDragging)return;this._stopDragging(),v=n.DragEnd,l=this._onDragEnd}else throw new Error(`invalid event type: ${m}`);if(!l)return;const{value:y,x:u}=this._getPosition(p);l({event:f,type:v,value:y,x:u,manager:this,tag:this.tag})},this.handleMouseDown=this._handleDragEvent,this.handleMouseEnter=this._handleMinorMouseEvent,this.handleMouseMove=this._handleMinorMouseEvent,this.handleMouseLeave=this._handleMinorMouseEvent,this.getBounds=a,this.tag=c,this._isDragging=!1,this._bounds=void 0,this._resetBoundsOnResize=!!o,this._resetBoundsOnResize&&window.addEventListener("resize",this.resetBounds),this._onMouseEnter=h.onMouseEnter,this._onMouseLeave=h.onMouseLeave,this._onMouseMove=h.onMouseMove,this._onDragStart=h.onDragStart,this._onDragMove=h.onDragMove,this._onDragEnd=h.onDragEnd}_getBounds(){return this._bounds||(this._bounds=this.getBounds(this.tag)),this._bounds}_getPosition(a){const{clientXLeft:c,maxValue:o,minValue:h,width:f}=this._getBounds();let d=a-c,p=d/f;return h!=null&&p<h?(p=h,d=h*f):o!=null&&p>o&&(p=o,d=o*f),{value:p,x:d}}_stopDragging(){window.removeEventListener("mousemove",this._handleDragEvent),window.removeEventListener("mouseup",this._handleDragEvent);const a=(0,i.get)(document,"body.style");a&&(a.userSelect="auto"),this._isDragging=!1}isDragging(){return this._isDragging}dispose(){this._isDragging&&this._stopDragging(),this._resetBoundsOnResize&&window.removeEventListener("resize",this.resetBounds),this._bounds=void 0,this._onMouseEnter=void 0,this._onMouseLeave=void 0,this._onMouseMove=void 0,this._onDragStart=void 0,this._onDragMove=void 0,this._onDragEnd=void 0}}},30700:(k,R,e)=>{"use strict";e.d(R,{Kv:()=>c,rY:()=>o});var t=e(41811),n=e(84140),i=e(24284);function s(f){if(f.length!==7)return[0,0,0];const d=f.slice(1,3),p=f.slice(3,5),m=f.slice(5);return[parseInt(d,16),parseInt(p,16),parseInt(m,16)]}class r{constructor(d,p){const m=h(d,p);this.colorsHex=m,this.colorsRgb=m.map(s),this.cache=new Map,this.prevColorIndex=void 0}_getColorIndex(d){let p=this.cache.get(d);if(p==null){const m=this.hashCode(d?d.toLowerCase():"");if(p=Math.abs(m%this.colorsHex.length),this.prevColorIndex!==void 0){this.prevColorIndex===p&&(p=this.getNextIndex(p));const v=this.colorsHex[this.prevColorIndex];if(n.A.readability(v,this.colorsHex[p])<1.5){let l=p;for(let y=0;y<this.colorsHex.length;y++)if(l=this.getNextIndex(l),n.A.readability(v,this.colorsHex[l])>1.5){p=l;break}}}this.cache.set(d,p),this.prevColorIndex=p}return p}getNextIndex(d){return d+1<this.colorsHex.length?d+1:0}hashCode(d){let p=0,m,v;for(m=0;m<d.length;m++)v=d.charCodeAt(m),p=(p<<5)-p+v;return p}getColorByKey(d){const p=this._getColorIndex(d);return this.colorsHex[p]}getRgbColorByKey(d){const p=this._getColorIndex(d);return this.colorsRgb[p]}clear(){this.cache.clear()}}const g=(0,t.A)((f,d)=>new r(f,d));function a(f){g([],f)}function c(f,d){return g(i.Tj,d).getColorByKey(f)}function o(f,d){return g(i.Tj,d).getRgbColorByKey(f)}function h(f,d){const p=[...f],m=p.indexOf("#E24D42");m>-1&&p.splice(m,1);const v=f.indexOf("#BF1B00");v>-1&&p.splice(v,1);let l=[];for(const y of p)n.A.readability(d.colors.background.primary,y)>=3&&l.push(y);return l}},6389:(k,R,e)=>{"use strict";e.d(R,{a3:()=>D});var t=e(2543),n=e.n(t),i=e(84743),s=e.n(i);const r="YYYY-MM-DD",g="HH:mm",a=1e3,c=1e3*a,o=60*c,h=60*o,f=24*h,d=Math.log10(a),p=[{unit:"d",microseconds:f,ofPrevious:24},{unit:"h",microseconds:h,ofPrevious:60},{unit:"m",microseconds:o,ofPrevious:60},{unit:"s",microseconds:c,ofPrevious:1e3},{unit:"ms",microseconds:a,ofPrevious:1e3},{unit:"\u03BCs",microseconds:1,ofPrevious:1e3}],m=(E,x,P)=>toFloatPrecision(E/P,x)*P;function v(E){return moment(E/a).format(r)}function l(E){return moment(E/a).format(g)}function y(E){const x=m(E,d,a);return`${moment.duration(x/a).asMilliseconds()}ms`}function u(E){const x=m(E,d,c);return`${moment.duration(x/a).asSeconds()}s`}function D(E){const[x,P]=(0,t.dropWhile)(p,({microseconds:T},C)=>C<p.length-1&&T>E);if(x.ofPrevious===1e3)return`${(0,t.round)(E/x.microseconds,2)}${x.unit}`;const M=`${Math.floor(E/x.microseconds)}${x.unit}`,O=Math.round(E/P.microseconds%x.ofPrevious),I=`${O}${P.unit}`;return O===0?M:`${M} ${I}`}},28114:(k,R,e)=>{"use strict";e.d(R,{Cr:()=>T,QW:()=>m,_o:()=>b,gt:()=>O,hv:()=>I,i0:()=>p,lU:()=>h});var t=e(74848),n=e(6709),i=e(65879),s=e(47232),r=e(72574),g=e(14578),a=e(31193),c=e(96192),o=e(92102);function h({splitOpenFn:C,traceToLogsOptions:S,traceToMetricsOptions:A,traceToProfilesOptions:L,dataFrame:N,createFocusSpanLink:F,trace:w}){if(!N)return;let B=O(w.duration,w.traceName,w.traceID);const U=N.fields.some(V=>!!V.config.links?.length),K=l(C,N.fields[0],S,A,F,B);return function(H){let Y=K(H);if(U){B={...B,...I(H),...T(H,L)};const X=N.fields.filter(J=>!!J.config.links?.length);try{let J;L?.datasourceUid&&(J=(0,a.tR)().getInstanceSettings(L.datasourceUid));const q=J?.type==="grafana-pyroscope-datasource",ae=H.tags.some(le=>le.key===m),j=q&&ae;let te=[];X.forEach(le=>{const z=(0,c.QL)({field:le,rowIndex:H.dataFrameRowIndex,splitOpenFn:C,range:M(H,void 0,void 0,j),dataFrame:N,vars:B});te=te.concat(z)});const ne=te.map(le=>({title:le.title,href:le.href,onClick:le.onClick,content:(0,t.jsx)(g.I,{name:"link",title:le.title||"Link"}),field:le.origin,type:j?o.N.Profiles:o.N.Unknown}));Y.push.apply(Y,ne)}catch(J){return console.error(J),Y}}return Y}}const f=C=>C.map(S=>({key:S,value:S.includes(".")?S.replace(".","_"):void 0})),d=f(["cluster","hostname","namespace","pod","service.name","service.namespace"]),p=f(["service.name","service.namespace"]),m="pyroscope.profile.id",v="gf.feo11y.app.id";function l(C,S,A,L,N,F){let w;A?.datasourceUid&&(w=(0,a.tR)().getInstanceSettings(A.datasourceUid));const B=w?.type==="grafana-splunk-datasource";let U;return L?.datasourceUid&&(U=(0,a.tR)().getInstanceSettings(L.datasourceUid)),function(V){F={...F,...I(V)};const H=[];let Y,X="";if(w&&A){const q=A.customQuery?A.query:void 0,ae=A.tags&&A.tags.length>0?A.tags:d;switch(w?.type){case"loki":X=b(V,ae),Y=y(V,A,X,q);break;case"grafana-splunk-datasource":X=b(V,ae,{joinBy:" "}),Y=E(V,A,X,q);break;case"elasticsearch":case"grafana-opensearch-datasource":X=b(V,ae,{labelValueSign:":",joinBy:" AND "}),Y=D(V,A,X,q);break;case"grafana-falconlogscale-datasource":X=b(V,ae,{joinBy:" OR "}),Y=P(V,A,X,q);break;case"googlecloud-logging-datasource":X=b(V,ae,{joinBy:" AND "}),Y=x(V,A,X,q)}if(Y){const j={title:w.name,url:"",internal:{datasourceUid:w.uid,datasourceName:w.name,query:Y}};if(F={...F,__tags:{text:"Tags",value:X}},(0,c.O1)(j.internal.query,F).allVariablesDefined){const te=(0,n.u)({link:j,internalLink:j.internal,scopedVars:F,range:M(V,{startMs:A.spanStartTimeShift?i.intervalToMs(A.spanStartTimeShift):0,endMs:A.spanEndTimeShift?i.intervalToMs(A.spanEndTimeShift):0},B),field:{},onClickFn:C,replaceVariables:(0,r.w)().replace.bind((0,r.w)())});H.push({href:te.href,title:"Related logs",onClick:te.onClick,content:(0,t.jsx)(g.I,{name:"gf-logs",title:"Explore the logs for this in split view"}),field:S,type:o.N.Logs})}}}if(U&&L?.queries)for(const q of L.queries){const ae=q.query||`histogram_quantile(0.5, sum(rate(traces_spanmetrics_latency_bucket{service="${V.process.serviceName}"}[5m])) by (le))`,j={title:U.name,url:"",internal:{datasourceUid:U.uid,datasourceName:U.name,query:{expr:ae,refId:"A"}}},te=L.tags&&L.tags.length>0?L.tags:d;F={...F,__tags:{text:"Tags",value:b(V,te)}};const ne=(0,n.u)({link:j,internalLink:j.internal,scopedVars:F,range:M(V,{startMs:L.spanStartTimeShift?i.intervalToMs(L.spanStartTimeShift):-12e4,endMs:L.spanEndTimeShift?i.intervalToMs(L.spanEndTimeShift):12e4}),field:{},onClickFn:C,replaceVariables:(0,r.w)().replace.bind((0,r.w)())});H.push({title:q?.name,href:ne.href,onClick:ne.onClick,content:(0,t.jsx)(g.I,{name:"chart-line",title:"Explore metrics for this span"}),field:S,type:o.N.Metrics})}if(V.references&&N)for(const q of V.references){if(q.refType==="CHILD_OF")continue;const ae=N(q.traceID,q.spanID);H.push({href:ae.href,title:q.span?q.span.operationName:"View linked span",content:(0,t.jsx)(g.I,{name:"link",title:"View linked span"}),onClick:ae.onClick,field:ae.origin,type:o.N.Traces})}if(V.subsidiarilyReferencedBy&&N)for(const q of V.subsidiarilyReferencedBy){const ae=N(q.traceID,q.spanID);H.push({href:ae.href,title:q.span?q.span.operationName:"View linked span",content:(0,t.jsx)(g.I,{name:"link",title:"View linked span"}),onClick:ae.onClick,field:ae.origin,type:o.N.Traces})}const J=u(V);return J&&H.push({title:"Session for this span",href:J,content:(0,t.jsx)(g.I,{name:"frontend-observability",title:"Session for this span"}),field:S,type:o.N.Session}),H}}function y(C,S,A,L){const{filterByTraceID:N,filterBySpanID:F}=S;if(L)return{expr:L,refId:""};if(!A)return;let w="{${__tags}}";return N&&C.traceID&&(w+=' |="${__span.traceId}"'),F&&C.spanID&&(w+=' |="${__span.spanId}"'),{expr:w,refId:""}}function u(C){const S=C.process.tags.find(L=>L.key===v)?.value,A=C.tags.find(L=>L.key==="session_id"||L.key==="session.id")?.value;return S&&A?`/a/grafana-kowalski-app/apps/${S}/sessions/${A}`:void 0}function D(C,S,A,L){const{filterByTraceID:N,filterBySpanID:F}=S;if(L)return{query:L,refId:"",metrics:[{id:"1",type:"logs"}]};let w=[];return F&&C.spanID&&w.push('"${__span.spanId}"'),N&&C.traceID&&w.push('"${__span.traceId}"'),A&&w.push("${__tags}"),{query:w.join(" AND "),refId:"",metrics:[{id:"1",type:"logs"}]}}function E(C,S,A,L){const{filterByTraceID:N,filterBySpanID:F}=S;if(L)return{query:L,refId:""};let w="";return A&&(w+="${__tags}"),N&&C.traceID&&(w+=' "${__span.traceId}"'),F&&C.spanID&&(w+=' "${__span.spanId}"'),{query:w,refId:""}}function x(C,S,A,L){const{filterByTraceID:N,filterBySpanID:F}=S;if(L)return{query:L,refId:""};let w=[];return F&&C.spanID&&w.push('"${__span.spanId}"'),N&&C.traceID&&w.push('"${__span.traceId}"'),A&&w.push("${__tags}"),{query:w.join(" AND "),refId:""}}function P(C,S,A,L){const{filterByTraceID:N,filterBySpanID:F}=S;if(L)return{lsql:L,refId:""};if(!A)return;let w="${__tags}";return N&&C.traceID&&(w+=' or "${__span.traceId}"'),F&&C.spanID&&(w+=' or "${__span.spanId}"'),{lsql:w,refId:""}}function b(C,S,{labelValueSign:A="=",joinBy:L=", "}={}){return[...C.process.tags,...C.tags,{key:"spanId",value:C.spanID},{key:"traceId",value:C.traceID},{key:"name",value:C.operationName},{key:"duration",value:C.duration}].map(N=>{const F=S.find(w=>w.key===N.key);if(F)return`${F.value?F.value:F.key}${A}"${N.value}"`}).filter(N=>!!N).join(L)}function M(C,S={startMs:0,endMs:0},A=!1,L=!1){let N=Math.floor(C.startTime/1e3+S.startMs);const F=(C.startTime+C.duration)/1e3;let w=Math.floor(F+S.endMs);A&&w-N<1e3?w=N+1e3:L?(N=N-6e4,w=w+6e4):N===w&&w++;const B=(0,s.KQ)(w),U=(0,s.KQ)(N);return{from:U,to:B,raw:{from:U,to:B}}}function O(C,S,A){return{__trace:{text:"Trace",value:{duration:C,name:S,traceId:A}}}}function I(C){const S={};for(const A of C.process.tags)S[A.key]=A.value;for(const A of C.tags)S[A.key]=A.value;return{__span:{text:"Span",value:{spanId:C.spanID,traceId:C.traceID,duration:C.duration,name:C.operationName,tags:S}}}}function T(C,S){let A={};if(S){const L=S.tags&&S.tags.length>0?S.tags:p;A={__tags:{text:"Tags",value:b(C,L)}}}return A}},15583:(k,R,e)=>{"use strict";e.d(R,{Ji:()=>g,SQ:()=>a,zE:()=>s});var t=e(96540),n=e(62938),i=e(56271);const s=()=>(0,n.A)().slice(0,12),g={spanNameOperator:"=",serviceNameOperator:"=",fromOperator:">",toOperator:"<",tags:[{id:s(),operator:"="}]};function a(c){const[o,h]=(0,t.useState)(g),f=(0,t.useMemo)(()=>c&&(0,i.filterSpans)(o,c),[o,c]);return{search:o,setSearch:h,spanFilterMatches:f}}},35090:(k,R,e)=>{"use strict";e.d(R,{L:()=>i});var t=e(78368),n=e(56271);function i(r){if(!r)return null;let g=r.fields.length===1?r.fields[0].values[0]:s(r);return g?(0,n.transformTraceData)(g):null}function s(r){const g=new t.R(r),a={};for(let c=0;c<g.length;c++){const o=g.get(c);if(!o.spanID)return null;a[o.spanID]||(a[o.spanID]={serviceName:o.serviceName,tags:o.serviceTags})}return{traceID:g.get(0).traceID,processes:a,spans:g.toArray().map((c,o)=>{const h=[];return c.parentSpanID&&h.push({refType:"CHILD_OF",spanID:c.parentSpanID,traceID:c.traceID}),c.references&&h.push(...c.references.map(f=>({refType:"FOLLOWS_FROM",...f}))),{...c,duration:c.duration*1e3,startTime:c.startTime*1e3,processID:c.spanID,flags:0,references:h,logs:c.logs?.map(f=>({...f,timestamp:f.timestamp*1e3}))||[],dataFrameRowIndex:o}})}}},11140:(k,R,e)=>{"use strict";e.d(R,{v:()=>L});var t=e(74848),n=e(2543),i=e(96540),s=e(49785),r=e(71733),g=e(14110),a=e(39601),c=e(32264),o=e(88575),h=e(94354),f=e(42418),d=e(37390),p=e(55852),m=e(59429),v=e(16233),l=e(20470),y=e(31678),u=e(9955),D=e(28676),E=e(71176),x=(N=>(N.FETCH_DASHBOARD="fetch-dashboard",N.SET_DASHBOARD_LS="set-dashboard-ls-error",N))(x||{});function P(N,F){let w=[];return N==="table"&&F.panelState?.logs?.columns&&(F.panelState.logs?.labelFieldName&&w.push({id:"extractFields",options:{source:F.panelState.logs.labelFieldName}}),w.push({id:"organize",options:{indexByName:Object.values(F.panelState.logs.columns).reduce((B,U,K)=>({...B,[U]:K}),{}),includeByName:Object.values(F.panelState.logs.columns).reduce((B,U)=>({...B,[U]:!0}),{})}})),w}async function b(N){const F=I(N.queries,N.queryResponse,N?.panelState),w={targets:N.queries,type:F,title:"New Panel",gridPos:{x:0,y:0,w:12,h:8},datasource:N.datasource,transformations:P(F,N)};let B;if(N.dashboardUid)try{B=await(0,D.n)().getDashboardDTO(N.dashboardUid)}catch{throw"fetch-dashboard"}else B=await(0,E.X)();B.dashboard.panels=[w,...B.dashboard.panels??[]],B.dashboard.time=N.time;try{(0,l.OI)(B)}catch{throw"set-dashboard-ls-error"}}const M=N=>!N.hide,O=N=>F=>F.refId===N;function I(N,F,w){for(const{refId:B}of N.filter(M)){const U=O(B);if(F.flameGraphFrames.some(U))return"flamegraph";if(F.graphFrames.some(U))return"timeseries";if(F.logsFrames.some(U))return w?.logs?.visualisationType?w.logs.visualisationType:"logs";if(F.nodeGraphFrames.some(U))return"nodeGraph";if(F.traceFrames.some(U))return"traces";if(F.customFrames.some(U))return F.customFrames.find(U)?.meta?.preferredVisualisationPluginId??"table"}return"table"}var T=(N=>(N.NewDashboard="new-dashboard",N.ExistingDashboard="existing-dashboard",N))(T||{});function C(N){}function S(N){return N?`d/${N}`:"dashboard/new"}var A=(N=>(N.UNKNOWN="unknown-error",N.NAVIGATION="navigation-error",N))(A||{});function L(N){const{exploreId:F,onClose:w}=N,B=(0,y.useSelector)((0,u.qq)(F)),[U,K]=(0,i.useState)(),{handleSubmit:V,control:H,formState:{errors:Y},watch:X}=(0,s.mN)({defaultValues:{saveTarget:"new-dashboard"}}),J=v.TP.hasPermission(y.AccessControlAction.DashboardsCreate),q=v.TP.hasPermission(y.AccessControlAction.DashboardsWrite),ae=[];J&&ae.push({label:"New dashboard",value:"new-dashboard"}),q&&ae.push({label:"Existing dashboard",value:"existing-dashboard"});const j=ae.length>1?X("saveTarget"):ae[0].value,te=async(ne,le)=>{K(void 0);const z=le.saveTarget==="existing-dashboard"?le.dashboardUid:void 0;(0,g.rR)("e_2_d_submit",{newTab:ne,saveTarget:le.saveTarget,queries:B.queries.length});const{from:ee,to:se}=B.range.raw;try{await b({dashboardUid:z,datasource:B.datasourceInstance?.getRef(),queries:B.queries,queryResponse:B.queryResponse,panelState:B?.panelsState,time:{from:typeof ee=="string"?ee:ee.toISOString(),to:typeof se=="string"?se:se.toISOString()}})}catch(oe){switch(oe){case x.FETCH_DASHBOARD:K({error:oe,message:"Could not fetch dashboard information. Please try again."});break;case x.SET_DASHBOARD_LS:K({error:oe,message:"Could not add panel to dashboard. Please try again."});break;default:K({error:"unknown-error",message:"Something went wrong. Please try again."})}return}const ie=S(z);if(!ne){w(),a.Ny.push(r.I.stripBaseFromUrl(ie));return}if(!!!e.g.open(c.$.appUrl+ie,"_blank")){K({error:"navigation-error",message:"Could not navigate to the selected dashboard. Please try again."}),(0,l.yZ)();return}w()};return(0,i.useEffect)(()=>{(0,g.rR)("e_2_d_open")},[]),(0,t.jsxs)("form",{children:[ae.length>1&&(0,t.jsx)(s.xI,{control:H,render:({field:{ref:ne,...le}})=>(0,t.jsx)(o.D,{label:"Target dashboard",description:"Choose where to add the panel.",children:(0,t.jsx)(h.z,{options:ae,...le,id:"e2d-save-target"})}),name:"saveTarget"}),j==="existing-dashboard"&&(0,t.jsx)(s.xI,{render:({field:{ref:ne,value:le,onChange:z,...ee}})=>(0,t.jsx)(o.D,{label:"Dashboard",description:"Select in which dashboard the panel will be created.",error:Y.dashboardUid?.message,invalid:!!Y.dashboardUid,children:(0,t.jsx)(m.b,{...ee,inputId:"e2d-dashboard-picker",defaultOptions:!0,onChange:se=>z(se?.uid)})}),control:H,name:"dashboardUid",shouldUnregister:!0,rules:{required:{value:!0,message:"This field is required."}}}),U&&(0,t.jsx)(f.F,{severity:"error",title:"Error adding the panel",children:U.message}),(0,t.jsxs)(d.a.ButtonRow,{children:[(0,t.jsx)(p.$n,{type:"reset",onClick:w,fill:"outline",variant:"secondary",children:"Cancel"}),(0,t.jsx)(p.$n,{type:"submit",variant:"secondary",onClick:V((0,n.partial)(te,!0)),icon:"external-link-alt",children:"Open in new tab"}),(0,t.jsx)(p.$n,{type:"submit",variant:"primary",onClick:V((0,n.partial)(te,!1)),icon:"apps",children:"Open dashboard"})]})]})}},12881:(k,R,e)=>{"use strict";e.d(R,{t:()=>i});var t=e(16233),n=e(31678);function i(){const s=t.TP.hasPermission(n.AccessControlAction.DashboardsCreate),r=t.TP.hasPermission(n.AccessControlAction.DashboardsWrite);return s&&!r?"Add panel to new dashboard":r&&!s?"Add panel to existing dashboard":"Add panel to dashboard"}},24401:(k,R,e)=>{"use strict";e.d(R,{s:()=>a});var t=e(74848),n=e(71733),i=e(39601),s=e(37390),r=e(67061),g=e(55852);function a(c){const{onDismiss:o,path:h,title:f}=c,d=()=>{e.g.open(n.I.assureBaseUrl(h),"_blank"),o()},p=()=>i.Ny.push(h);return(0,t.jsxs)(s.a,{title:f,isOpen:!0,onDismiss:o,children:[(0,t.jsx)(r.B,{direction:"column",gap:1,children:(0,t.jsx)("p",{children:"Do you want to proceed in the current tab or open a new tab?"})}),(0,t.jsxs)(s.a.ButtonRow,{children:[(0,t.jsx)(g.$n,{onClick:o,fill:"outline",variant:"secondary",children:"Cancel"}),(0,t.jsx)(g.$n,{type:"submit",variant:"secondary",onClick:d,icon:"external-link-alt",children:"Open in new tab"}),(0,t.jsx)(g.$n,{type:"submit",variant:"primary",onClick:p,icon:"apps",children:"Open"})]})]})}},30973:(k,R,e)=>{"use strict";e.d(R,{w:()=>r});var t=e(74848),n=e(96540),i=e(38138),s=e(75462);function r({extensions:c,onSelect:o}){const{categorised:h,uncategorised:f}=a(c),d=f.length>0&&Object.keys(h).length>0;return(0,t.jsx)(i.W,{children:(0,t.jsxs)(t.Fragment,{children:[Object.keys(h).map(p=>(0,t.jsx)(i.W.Group,{label:(0,s.pL)(p,25),children:g(h[p],o)},p)),d&&(0,t.jsx)(i.W.Divider,{},"divider"),g(f,o)]})})}function g(c,o){return c.map(h=>(0,t.jsx)(i.W.Item,{ariaLabel:h.title,icon:h?.icon||"plug",label:(0,s.pL)(h.title,25),onClick:f=>{if(h.path)return o(h);h.onClick?.(f)}},h.id))}function a(c){return(0,n.useMemo)(()=>{const o=[],h={};for(const f of c){if(!f.category){o.push(f);continue}Array.isArray(h[f.category])||(h[f.category]=[]),h[f.category].push(f)}return{uncategorised:o,categorised:h}},[c])}},33368:(k,R,e)=>{"use strict";e.d(R,{h:()=>i});var t=e(96540),n=e(96192);const i=(s,r)=>(0,t.useMemo)(()=>(0,n.YV)(s,r),[s,r])},39590:(k,R,e)=>{"use strict";e.d(R,{m:()=>ae,s:()=>te});var t=e(96540),n=e(76888),i=e(3169),s=e(31678),r=e(9955),g=e(34028);const a={parse:ne=>{if(!ne.left&&!ne.right)return{to:{left:{datasource:null,queries:[],range:{from:g.kn.from,to:g.kn.to}},schemaVersion:0},error:!1};let le,z,ee,se;return typeof ne.left=="string"&&([le,ee]=f(ne.left)),typeof ne.right=="string"?[z,se]=f(ne.right):ne.right&&(z=h,se=!0),le||(le=h),{to:{schemaVersion:0,left:le,...z&&{right:z}},error:!!ee||!!se}}},c=(ne,...le)=>le.some(z=>ne.hasOwnProperty(z));var o=(ne=>(ne[ne.RangeFrom=0]="RangeFrom",ne[ne.RangeTo=1]="RangeTo",ne[ne.Datasource=2]="Datasource",ne[ne.SegmentsStart=3]="SegmentsStart",ne))(o||{});const h={datasource:null,queries:[],range:g.kn};function f(ne){let le;try{le=JSON.parse(ne)}catch{return[h,!0]}if(!Array.isArray(le))return[{queries:[],range:g.kn,...le},!1];if(le.length<=3)return[h,!0];const z={from:le[0],to:le[1]},ee=le[2],se=le.slice(3),ie=se.filter(oe=>!c(oe,"ui","mode","__panelsState")),Z=se.find(oe=>c(oe,"__panelsState"))?.__panelsState;return[{datasource:ee,queries:ie,range:z,panelsState:Z},!1]}var d=e(87490),p=e(15961);const m={parse:ne=>{if(!ne||!ne.panes||typeof ne.panes!="string")return{to:{schemaVersion:1,panes:{[(0,d.o$)()]:v}},error:!1};let le;try{le=JSON.parse(ne.panes)}catch{}if(le==null||typeof le!="object")return{to:{schemaVersion:1,panes:{[(0,d.o$)()]:v}},error:!0};const z=Object.entries(le).map(([ee,se])=>[ee,l(se)]).reduce((ee,[se,ie])=>{let Z=se;return(Z.length!==3||/^\d+$/.test(Z)||Z.split("").some(oe=>d.WP.indexOf(oe)===-1))&&(Z=(0,d.o$)()),{...ee,[Z]:ie}},{});return Object.keys(z).length||(z[(0,d.o$)()]=v),{to:{schemaVersion:1,panes:z},error:!1}},migrate:ne=>({schemaVersion:1,panes:{[(0,d.o$)()]:ne.left,...ne.right&&{[(0,d.o$)()]:ne.right}}})},v={datasource:null,queries:[],range:g.kn};function l(ne){return!ne||typeof ne!="object"?v:{...v,...(0,p.C)("queries",ne)&&Array.isArray(ne.queries)&&{queries:ne.queries},...(0,p.C)("datasource",ne)&&typeof ne.datasource=="string"&&{datasource:ne.datasource},...(0,p.C)("panelsState",ne)&&!!ne.panelsState&&typeof ne.panelsState=="object"&&{panelsState:ne.panelsState},...(0,p.C)("range",ne)&&!!ne.range&&typeof ne.range=="object"&&(0,p.C)("from",ne.range)&&(0,p.C)("to",ne.range)&&typeof ne.range.from=="string"&&typeof ne.range.to=="string"&&{range:{from:ne.range.from,to:ne.range.to}}}}const y=ne=>D(ne),u=[a,m],D=ne=>{const le=E(ne),[z,...ee]=u.slice(le),{error:se,to:ie}=z.parse(ne);return[ee.reduce((oe,ce)=>ce.migrate?ce.migrate(oe):oe,ie),se]};function E(ne){return!ne||!("schemaVersion"in ne)||!ne.schemaVersion?0:typeof ne.schemaVersion=="number"?ne.schemaVersion:typeof ne.schemaVersion=="string"?Number.parseInt(ne.schemaVersion,10):0}var x=e(2543),P=e(18226),b=e(62860),M=e(62256),O=e(29436),I=e(23994),T=e(89224),C=e(27649),S=e(39070),A=e(41987),L=e(31193),N=e(14678);const F=(ne,le)=>{const z=!(0,x.isEqual)(le?.datasource,ne?.datasource),ee=!(0,x.isEqual)(le?.queries,ne?.queries),se=!(0,x.isEqual)(le?.range||g.kn,ne?.range||g.kn),ie=!(0,x.isEqual)(le?.panelsState,ne?.panelsState);return{datasource:z,queries:ee,range:se,panelsState:ie}};async function w(ne,le,z){if(ne)try{return await(0,L.tR)().get(ne)}catch{}const ee=[...new Set(le.map(se=>se.datasource).filter(S.zz).map(se=>typeof se=="string"?se:se.uid))];try{if(ee.length>=1){const se=(await Promise.allSettled(ee.map(ie=>(0,L.tR)().get(ie)))).filter(p.s);if(se.length>1)return await(0,L.tR)().get(N.uv);if(se.length===1)return await(0,L.tR)().get(ee[0])}}catch{}return(0,L.tR)().get((0,d.HQ)(z)).catch(()=>(0,L.tR)().get()).catch(()=>{})}function B(ne){return{...ne.getDefaultQuery?.(A.Jk.Explore),refId:"A",datasource:ne.getRef()}}function U(ne){return ne.name===N.uv}function K(ne){return ne&&U(ne)?le=>!!le.datasource:le=>le.datasource?typeof le.datasource=="string"?le.datasource===ne?.uid||le.datasource===ne?.name:le.datasource.uid===ne?.uid:!0}async function V(ne){return(await Promise.allSettled(ne.map(z=>(0,L.tR)().get(z.datasource).then(ee=>({query:z,ds:ee}))))).filter(p.s).map(({value:z})=>z.query)}function H(ne,le,z){const ee=Object.values(ne.panes);if(ee.length>1){const se=ee.some(({range:ie},Z,[{range:oe}])=>!(0,x.isEqual)(ie,oe));z((0,O.qz)({syncedTimes:!se}))}Object.entries(ne.panes).forEach(async([se,ie],Z)=>{const{datasource:oe,queries:ce,range:ye,panelsState:re}=ie,ue=le[se];if(ue!==void 0){const De=F(ie,ae(ue));Promise.resolve().then(async()=>{De.datasource&&oe&&await z((0,b.wh)({exploreId:se,datasource:oe}))}).then(async()=>{De.range&&z((0,T.JA)({exploreId:se,rawRange:(0,g.Z9)(ye)})),De.queries&&z((0,I.h9)({exploreId:se,queries:(0,C.v)(ce)})),(De.queries||De.range)&&(await z((0,I.hS)(se)),z((0,I.Od)({exploreId:se}))),De.panelsState&&re&&z((0,M.fx)({exploreId:se,panelsState:re}))})}else z((0,M.Gd)({exploreId:se,datasource:oe||"",queries:(0,C.v)(ce),range:(0,g.Z9)(ye),panelsState:re,position:Z,eventBridge:new P.o}))}),Object.keys(le).filter(se=>!Object.keys(ne.panes).includes(se)).forEach(se=>z((0,O.J8)(se)))}function Y(ne,le,z,ee,se){ee((0,O.Ve)()),Promise.all(Object.entries(ne.panes).map(([ie,{datasource:Z,queries:oe,range:ce,panelsState:ye}])=>w(Z,oe,z).then(re=>Promise.resolve(re?oe.length?(0,C.v)(oe).filter(K(re)).map(U(re)?x.identity:ue=>({...ue,datasource:re.getRef()})):(0,L.tR)().get(U(re)?void 0:re.getRef()).then(ue=>[B(ue)]):[]).then(async ue=>{let De=await V(ue);return!De.length&&re&&(De=[B(U(re)?await(0,L.tR)().get():re)]),{exploreId:ie,range:ce,panelsState:ye,queries:De,datasource:re}})))).then(async ie=>{const Z=await Promise.all(ie.map(({exploreId:ue,range:De,panelsState:ge,queries:Te,datasource:Le})=>ee((0,M.Gd)({exploreId:ue,datasource:Le,queries:Te,range:(0,g.Z9)(De),panelsState:ge,eventBridge:new P.o})).unwrap()));if(Z.length>1){const ue=Z.some(({state:De},ge,[{state:Te}])=>!(0,x.isEqual)(De.range.raw,Te.range.raw));ee((0,O.qz)({syncedTimes:!ue}))}const oe=Z.reduce((ue,{exploreId:De,state:ge})=>({...ue,[De]:ae(ge)}),{}),ce=se.getSearchObject();let ye={};for(const[ue,De]of Object.entries(ce).filter(([ge])=>!["schemaVersion","panes","orgId","left","right"].includes(ge)))ye[ue]=De;const re=new URLSearchParams({schemaVersion:`${ne.schemaVersion}`,panes:JSON.stringify(oe),orgId:`${z}`,...ye});se.replace({pathname:se.getLocation().pathname,search:re.toString()}),le.current="done"})}function X(ne,le){return ne.current=b.wh.pending.type===le.type,[O.J8.type,O.ve.fulfilled.type,I.Od.pending.type,T.eM.type,M.fx.type,b.wh.fulfilled.type].includes(le.type)&&!ne.current}function J(ne,le,z,ee){const se=Object.entries(ne.panes).reduce((ie,[Z,oe])=>oe?{...ie,[Z]:ae(oe)}:ie,{});if(!(0,x.isEqual)(le.current.panes,JSON.stringify(se))){const ie=!!le.current.panes&&Object.values(le.current.panes).filter(Boolean).length===0||z.current==="pending";le.current={panes:JSON.stringify(se)},ee.partial({panes:le.current.panes},ie)}}var q=e(76885);function ae(ne){return{datasource:ne.datasourceInstance?.uid||"",queries:ne.queries.map(d.w4),range:(0,q.sQ)(ne.range.raw),panelsState:j(ne.panelsState)}}function j(ne){let le=(0,x.mapValues)(ne,z=>(0,x.isObject)(z)?j(z):z);if(le=(0,x.omitBy)(le,x.isEmpty),!(0,x.isEmpty)(le))return le}function te(ne){const{location:le}=(0,n.Il)(),z=(0,s.useDispatch)(),ee=(0,s.useSelector)(r.Qb),se=(0,t.useRef)(ee),ie=(0,s.useSelector)(re=>re.user.orgId),Z=(0,t.useRef)(ne),oe=(0,t.useRef)("notstarted"),ce=(0,t.useRef)(!1),{warning:ye}=(0,i._2)();(0,t.useEffect)(()=>{ne.panes||(oe.current="notstarted",Z.current=ne)},[ne]),(0,t.useEffect)(()=>{const re=z((0,s.addListener)({predicate:ue=>X(ce,ue),effect:async(ue,{cancelActiveListeners:De,delay:ge,getState:Te})=>{De(),await ge(200),J(Te().explore,Z,oe,le)}}));return()=>re()},[z,le]),(0,t.useEffect)(()=>{se.current=ee},[ee]),(0,t.useEffect)(()=>{const re=Z.current?.panes!==ne.panes,[ue,De]=y(ne);De&&ye("Could not parse Explore URL","The requested URL contains invalid parameters, a default Explore state has been loaded."),!re&&oe.current==="notstarted"&&(oe.current="pending",Y(ue,oe,ie,z,le)),Z.current=ne,re&&oe.current==="done"&&H(ue,se.current,z)},[z,ie,le,ne,ye])}},15961:(k,R,e)=>{"use strict";e.d(R,{C:()=>n,s:()=>t});const t=i=>i.status==="fulfilled";function n(i,s){return i in s}},324:(k,R,e)=>{"use strict";e.d(R,{M:()=>f,v:()=>p});var t=e(88483),n=e(19347),i=e(14110),s=e(82467),r=e(3169),g=e(18380),a=e(99140),c=e(62256),o=e(29436),h=e(23994);const f=m=>new t.c(v=>{const l=a.M_.getState().explore.panes[m]?.correlations;if(l)v.next(l),v.complete();else{const y=a.M_.subscribe(()=>{const u=a.M_.getState().explore.panes[m]?.correlations;u&&(y(),v.next(u),v.complete())})}});function d(m){return async(v,l)=>{const y=l().explore.panes[m];if(y.datasourceInstance?.uid!==void 0){let u=y.datasourceInstance.meta.mixed?y.queries.map(E=>E.datasource?.uid).filter(E=>E!==null):[y.datasourceInstance.uid];const D=await(0,g.J6)(u);v((0,c.Fb)({exploreId:m,correlations:D.correlations||[]}))}}}function p(m,v,l){return async(y,u)=>{const D=Object.keys(u().explore?.panes),E=u().explore?.panes[D[0]],x=u().explore?.panes[D[1]];if(!E||!x)return;const P=E.datasourceInstance?.meta.mixed?E.queries[0].datasource:E.datasourceInstance?.getRef(),b=x.datasourceInstance?.meta.mixed?x.queries[0].datasource:x.datasourceInstance?.getRef(),[M,O]=await Promise.all([(0,n.l)().get(P),(0,n.l)().get(b)]);if(M?.uid&&O?.uid&&x.correlationEditorHelperData?.resultField){const I={sourceUID:M.uid,targetUID:O.uid,label:m||await(0,g.tZ)(E,x),description:v,config:{field:x.correlationEditorHelperData.resultField,target:x.queries[0],type:"query",transformations:l}};await(0,g.$q)(M.uid,I).then(async()=>{y((0,o.J8)(D[1])),await y(d(D[0])),await y((0,h.Od)({exploreId:D[0]})),(0,i.rR)("grafana_explore_correlation_editor_saved",{sourceDatasourceType:M.type,targetDataSourceType:O.type})}).catch(T=>{y((0,s.dx)((0,r.gi)("Error creating correlation",T))),console.error(T)})}}}},62860:(k,R,e)=>{"use strict";e.d(R,{YR:()=>m,wh:()=>p});var t=e(65307),n=e(14110),i=e(11134),s=e(87490),r=e(18380),g=e(31678),a=e(57288),c=e(62256),o=e(23994),h=e(89224),f=e(34028);const d=(0,t.VP)("explore/updateDatasourceInstance"),p=(0,g.createAsyncThunk)("explore/changeDatasource",async({datasource:v,exploreId:l,options:y},{getState:u,dispatch:D})=>{const E=u().user.orgId,{history:x,instance:P}=await(0,f.BE)(E,v),b=u().explore.panes[l].datasourceInstance;(0,n.rR)("explore_change_ds",{from:(b?.meta?.mixed?"mixed":b?.type)||"unknown",to:P.meta.mixed?"mixed":P.type,exploreId:l}),D(d({exploreId:l,datasourceInstance:P,history:x}));const M=u().explore.panes[l].queries,O=(0,f.dq)(P.uid,M),I=await(0,r.J6)(O);D((0,c.Fb)({exploreId:l,correlations:I.correlations||[]})),y?.importQueries&&await D((0,o.y2)(l,M,b,P)),u().explore.panes[l].isLive&&D((0,h.hO)({exploreId:l,refreshInterval:i.cC.offOption.value})),y?.importQueries&&D((0,o.Od)({exploreId:l}))}),m=(v,l)=>{if(d.match(l)){const{datasourceInstance:y,history:u}=l.payload;return(0,s._u)(v.querySubscription),{...v,datasourceInstance:y,graphResult:null,tableResult:null,logsResult:null,supplementaryQueries:(0,a.Ez)(),queryResponse:(0,f.RA)(),queryKeys:[],history:u}}return v}},62256:(k,R,e)=>{"use strict";e.d(R,{EA:()=>d,Fb:()=>l,Gd:()=>u,LJ:()=>D,QZ:()=>y,fx:()=>f,nE:()=>p});var t=e(65307),n=e(87490),i=e(18380),s=e(32901),r=e(31678),g=e(62860),a=e(23994),c=e(89224),o=e(34028);const h=(0,t.VP)("explore/changeSize"),f=(0,t.VP)("explore/changePanels");function d(E,x,P){return async(b,M)=>{const O=M().explore.panes[E];if(O===void 0)return;const{panelsState:I}=O;b(f({exploreId:E,panelsState:{...I,[x]:P}}))}}const p=(0,t.VP)("explore/changeCorrelationHelperData"),m=(0,t.VP)("explore/initializeExploreAction"),v=(0,t.VP)("explore/setUrlReplaced"),l=(0,t.VP)("explore/saveCorrelationsAction");function y(E,{width:x}){return h({exploreId:E,width:x})}const u=(0,r.createAsyncThunk)("explore/initializeExplore",async({exploreId:E,datasource:x,queries:P,range:b,panelsState:M,correlationHelperData:O,eventBridge:I},{dispatch:T,getState:C,fulfillWithValue:S})=>{let A,L=[];if(x){const N=C().user.orgId,F=await(0,o.BE)(N,x);A=F.instance,L=F.history}if(T(m({exploreId:E,queries:P,range:(0,o.eO)(b,(0,s.O)(C().user)),datasourceInstance:A,history:L,eventBridge:I})),M!==void 0&&T(f({exploreId:E,panelsState:M})),T((0,c.JA)({exploreId:E})),A){const N=(0,o.dq)(A.uid,P),F=await(0,i.J6)(N);T(l({exploreId:E,correlations:F.correlations||[]})),T((0,a.Od)({exploreId:E}))}return O!==void 0&&C().explore.correlationEditorDetails?.editorMode&&T(p({exploreId:E,correlationEditorHelperData:O})),S({exploreId:E,state:C().explore.panes[E]})}),D=(E=(0,o.HZ)(),x)=>{if(E=(0,a.JQ)(E,x),E=(0,g.YR)(E,x),E=(0,c.QP)(E,x),h.match(x)){const P=x.payload.width;return{...E,containerWidth:P}}if(f.match(x)){const{panelsState:P}=x.payload;return{...E,panelsState:P}}if(p.match(x)){const{correlationEditorHelperData:P}=x.payload;return{...E,correlationEditorHelperData:P}}if(l.match(x))return{...E,correlations:x.payload.correlations};if(m.match(x)){const{queries:P,range:b,datasourceInstance:M,history:O,eventBridge:I}=x.payload;return{...E,range:b,queries:P,initialized:!0,eventBridge:I,queryKeys:(0,n.dY)(P),datasourceInstance:M,history:O,queryResponse:(0,o.RA)(),cache:[],correlations:[]}}return E}},72433:(k,R,e)=>{"use strict";e.d(R,{Bj:()=>y,H9:()=>o,PA:()=>v,Uu:()=>p,VM:()=>h,fP:()=>l,jX:()=>d,ri:()=>a,s1:()=>f,sh:()=>c,wk:()=>m});var t=e(65307),n=e(81523),i=e(11401),s=e(29436);const r=(0,t.VP)("explore/historyUpdated"),g=({updatedQuery:u,deletedId:D})=>async(E,x)=>{const P=x().explore.richHistory,b=P.map(O=>O.id===u?.id?u:O).filter(O=>O.id!==D),M=P.length-b.length;E((0,s.U2)({richHistoryResults:{richHistory:b,total:x().explore.richHistoryTotal-M}}))},a=(u,D,E,x,P)=>async(b,M)=>{const O=P?{quotaExceededError:!1,limitExceededWarning:!1,otherErrors:!1}:{quotaExceededError:!M().explore.richHistoryStorageFull,limitExceededWarning:!M().explore.richHistoryLimitExceededWarningShown},{richHistoryStorageFull:I,limitExceeded:T}=await(0,n.l0)({localOverride:u,datasource:{uid:D,name:E},queries:x,starred:!1,showNotif:O});P||(I&&b((0,s.fj)()),T&&b((0,s.D)()))},c=(u,D)=>async(E,x)=>{const P=await(0,n.oU)(u,D);E(g({updatedQuery:P}))},o=(u,D)=>async E=>{const x=await(0,n.cX)(u,D);E(g({updatedQuery:x}))},h=u=>async D=>{const E=await(0,n.NC)(u);D(g({deletedId:E}))},f=()=>async u=>{await(0,n.X1)(),u((0,s.U2)({richHistoryResults:{richHistory:[],total:0}})),u((0,s.U2)({richHistoryResults:{richHistory:[],total:0}}))},d=()=>async(u,D)=>{const E=D().explore.richHistorySearchFilters;if(E){const x=await(0,n.DI)(E);u((0,s.U2)({richHistoryResults:x}))}},p=()=>async(u,D)=>{const E=D().explore.richHistorySearchFilters,x=D().explore.richHistory;if(E&&x){const P={...E,page:(E?.page||1)+1},b=await(0,n.DI)(P),M=[...x,...b.richHistory];u((0,s.Ju)({filters:P})),u((0,s.U2)({richHistoryResults:{richHistory:M,total:b.total}}))}},m=()=>async u=>{u((0,s.Ju)({filters:void 0})),u((0,s.U2)({richHistoryResults:{richHistory:[],total:0}}))},v=()=>async(u,D)=>{let E=D().explore.richHistorySettings;E||(E=await(0,n.Gx)(),u((0,s.bZ)(E)))},l=u=>async D=>{D((0,s.bZ)(u)),await(0,n.rs)(u)},y=u=>async(D,E)=>{await D((0,s.Ju)({filters:{...u}}));const x=E().explore.richHistorySettings;(0,i.gQ)().lastUsedDataSourcesAvailable&&await D(l({...x,lastUsedDatasourceFilters:u.datasourceFilters}))}},29436:(k,R,e)=>{"use strict";e.d(R,{Ay:()=>L,D:()=>v,J8:()=>x,JA:()=>E,Ju:()=>y,U2:()=>p,Ve:()=>b,am:()=>I,bZ:()=>l,fj:()=>m,nD:()=>u,ow:()=>T,qz:()=>d,tP:()=>D,ve:()=>M});var t=e(65307),n=e(2543),i=e.n(n),s=e(18226),r=e(39601),g=e(87490),a=e(23989),c=e(31678),o=e(27649),h=e(62256),f=e(34028);const d=(0,t.VP)("explore/syncTimes"),p=(0,t.VP)("explore/richHistoryUpdated"),m=(0,t.VP)("explore/richHistoryStorageFullAction"),v=(0,t.VP)("explore/richHistoryLimitExceededAction"),l=(0,t.VP)("explore/richHistorySettingsUpdated"),y=(0,t.VP)("explore/richHistorySearchFiltersUpdatedAction"),u=(0,t.VP)("explore/splitSizeUpdateAction"),D=(0,t.VP)("explore/maximizePaneAction"),E=(0,t.VP)("explore/evenPaneResizeAction"),x=(0,t.VP)("explore/splitClose"),P=(0,t.VP)("explore/setPaneState"),b=(0,t.VP)("explore/clearPanes"),M=(0,c.createAsyncThunk)("explore/splitOpen",async(N,{getState:F,dispatch:w})=>{const B=Object.values(F().explore.panes)[0],U=N?.queries??B?.queries??[];Object.keys(F().explore.panes).forEach((H,Y)=>{Y>=1&&w(x(H))});const K=N?.range||B?.range.raw||f.kn;let V=(0,g.o$)();for(;F().explore.panes[V];)V=(0,g.o$)();await w(O({exploreId:V,datasource:N?.datasourceUid||B?.datasourceInstance?.getRef(),queries:(0,o.v)(U),range:K,panelsState:N?.panelsState||B?.panelsState,correlationHelperData:N?.correlationHelperData,eventBridge:new s.o})),B?.range&&await w(d({syncedTimes:(0,n.isEqual)(B.range.raw,K)}))}),O=(0,c.createAsyncThunk)("explore/createNewSplitOpen",async(N,{dispatch:F})=>{await F((0,h.Gd)(N))}),I=(0,t.VP)("explore/changeCorrelationEditorDetails"),T=(N,F)=>async w=>{const{timeRange:B,getExploreUrl:U,openInNewWindow:K}=F,V=await U({queries:N.targets,dsRef:N.datasource,scopedVars:N.scopedVars,timeRange:B,adhocFilters:(0,a.w)().getAdhocFilters(N.datasource?.uid??"",!0)});if(K&&V){K(V);return}r.Ny.push(V)},C=(0,f.HZ)(),S={syncedTimes:!1,panes:{},correlationEditorDetails:{editorMode:!1,correlationDirty:!1,queryEditorDirty:!1,isExiting:!1},richHistoryStorageFull:!1,richHistoryLimitExceededWarningShown:!1,largerExploreId:void 0,maxedExploreId:void 0,evenSplitPanes:!0,richHistory:[]},L={explore:(N=S,F)=>{if(x.match(F)){const{[F.payload]:B,...U}={...N.panes};return{...N,panes:U,largerExploreId:void 0,maxedExploreId:void 0,evenSplitPanes:!0,syncedTimes:!1}}if(u.match(F)){const{largerExploreId:B}=F.payload;return{...N,largerExploreId:B,maxedExploreId:void 0,evenSplitPanes:B===void 0}}if(D.match(F)){const{exploreId:B}=F.payload;return{...N,largerExploreId:B,maxedExploreId:B,evenSplitPanes:!1}}if(E.match(F))return{...N,largerExploreId:void 0,maxedExploreId:void 0,evenSplitPanes:!0};if(d.match(F))return{...N,syncedTimes:F.payload.syncedTimes};if(m.match(F))return{...N,richHistoryStorageFull:!0};if(v.match(F))return{...N,richHistoryLimitExceededWarningShown:!0};if(l.match(F)){const B=F.payload;return{...N,richHistorySettings:B}}if(p.match(F)){const{richHistory:B,total:U}=F.payload.richHistoryResults;return{...N,richHistory:B,richHistoryTotal:U}}if(y.match(F)){const B=F.payload.filters;return{...N,richHistorySearchFilters:B}}if(O.pending.match(F))return{...N,panes:{...N.panes,[F.meta.arg.exploreId]:C}};if(h.Gd?.pending.match(F)){const B=Object.entries(N.panes),U=B.slice(0,F.meta.arg.position),K=B.slice(U.length),V=[...U,[F.meta.arg.exploreId,C],...K].reduce((H,[Y,X])=>({...H,[Y]:X}),{});return{...N,panes:V}}if(b.match(F))return{...N,panes:{}};if(I.match(F)){const{editorMode:B,label:U,description:K,canSave:V,correlationDirty:H,queryEditorDirty:Y,isExiting:X,postConfirmAction:J,transformations:q}=F.payload;return{...N,correlationEditorDetails:{editorMode:!!(B??N.correlationEditorDetails?.editorMode),canSave:!!(V??N.correlationEditorDetails?.canSave),label:U??N.correlationEditorDetails?.label,description:K??N.correlationEditorDetails?.description,transformations:q??N.correlationEditorDetails?.transformations,correlationDirty:!!(H??N.correlationEditorDetails?.correlationDirty),queryEditorDirty:!!(Y??N.correlationEditorDetails?.queryEditorDirty),isExiting:!!(X??N.correlationEditorDetails?.isExiting),postConfirmAction:J}}}const w=F.payload?.exploreId;return typeof w=="string"?{...N,panes:Object.entries(N.panes).reduce((B,[U,K])=>({...B,[U]:U===w?(0,h.LJ)(K,F):K}),{})}:N}}},23994:(k,R,e)=>{"use strict";e.d(R,{_0:()=>Ve,He:()=>xt,hS:()=>pe,bO:()=>ve,IL:()=>St,rR:()=>qe,y2:()=>Se,Az:()=>zt,PD:()=>Ie,JQ:()=>Vt,S6:()=>Ce,Od:()=>he,GI:()=>gt,q9:()=>vt,h1:()=>ce,qk:()=>ze,Rk:()=>nt,h9:()=>Ue,TO:()=>Nt});var t=e(65307),n=e(32017),i=e.n(n),s=e(2543),r=e(49510),g=e(62467),a=e(58307),c=e(69862),o=e(99165),h=e(39070),f=e(73372),d=e(47232),p=e(9557),m=e(40187),v=e(26272),l=e(14236),y=e(80822),u=e(19347),D=e(32264),E=e(87490),x=e(80582),P=e(18380),b=e(31193),M=e(32901),O=e(13137),I=e(14678),T=e(31678),C=e(82467),S=e(3169),A=e(39374),L=e(81160),N=e(57875),F=e(91890),w=e(57934),B=e(11261),U=e(69147),K=e(91002),V=e(15162);const H=Je=>{const ct=[],ot=[],Qe=[],pt=[],Pt=[],At=[],mn=[],Pn=[];for(const fn of Je.series){if(ne(fn)){Pn.push(fn);continue}switch(fn.meta?.preferredVisualisationType){case"logs":pt.push(fn);break;case"graph":ct.push(fn);break;case"trace":Pt.push(fn);break;case"table":ot.push(fn);break;case"rawPrometheus":Qe.push(fn);break;case"nodeGraph":At.push(fn);break;case"flamegraph":mn.push(fn);break;default:te(fn)&&ct.push(fn),ot.push(fn)}}return{...Je,graphFrames:ct,tableFrames:ot,logsFrames:pt,traceFrames:Pt,nodeGraphFrames:At,customFrames:Pn,flameGraphFrames:mn,rawPrometheusFrames:Qe,graphResult:null,tableResult:null,logsResult:null,rawPrometheusResult:null}},Y=({showCorrelationEditorLinks:Je,queries:ct,correlations:ot,defaultTargetDatasource:Qe})=>pt=>{if(Je&&Qe)for(const Pt of pt.series)for(const At of Pt.fields){At.config.links=[],At.display=At.display||(0,N.H)();const mn={};Pt.fields.map(Pn=>{mn[`${Pn.name}`]=`\${__data.fields.['${Pn.name}']}`}),At.config.links.push({url:"",origin:F.x0.ExploreCorrelationsEditor,title:`Correlate with ${At.name}`,internal:{datasourceUid:Qe.uid,datasourceName:Qe.name,query:{datasource:{uid:Qe.uid}},meta:{correlationData:{resultField:At.name,vars:mn,origVars:mn}}}})}else if(ct?.length&&ot?.length){const Pt=(0,s.mapValues)((0,s.groupBy)(ct,"refId"),"0.datasource.uid");(0,P.cA)(pt.series,ot,Pt)}return pt},X=Je=>Je.graphFrames.length?{...Je,graphResult:Je.graphFrames}:{...Je,graphResult:null},J=Je=>{if(Je.tableFrames.length===0)return(0,g.of)({...Je,tableResult:null});Je.tableFrames.sort((pt,Pt)=>{const At=pt.refId,mn=Pt.refId;return At>mn?1:At<mn?-1:0});const ct=Je.tableFrames.every(pt=>te(pt)),ot={interpolate:pt=>pt};return(ct?(0,g.of)(Je.tableFrames).pipe(w.c.joinByFieldTransformer.operator({},ot)):(0,g.of)(Je.tableFrames).pipe(w.c.mergeTransformer.operator({},ot))).pipe((0,L.T)(pt=>{for(const Pt of pt)for(const At of Pt.fields)At.display=At.display??(0,N.J)({field:At,theme:D.$.theme2,timeZone:Je.request?.timezone??"browser"});return{...Je,tableResult:pt}}))},q=Je=>{const ct=Je.rawPrometheusFrames;if(!ct||ct.length===0)return(0,g.of)({...Je,tableResult:null});ct.sort((Pt,At)=>{const mn=Pt.refId,Pn=At.refId;return mn>Pn?1:mn<Pn?-1:0});const ot=ct.every(Pt=>te(Pt)),Qe={interpolate:Pt=>Pt};return(ot?(0,g.of)(ct).pipe(w.c.joinByFieldTransformer.operator({},Qe)):(0,g.of)(ct).pipe(w.c.mergeTransformer.operator({},Qe))).pipe((0,L.T)(Pt=>{const At=Pt[0];for(const mn of At.fields)mn.display=mn.display??(0,N.J)({field:mn,theme:D.$.theme2,timeZone:Je.request?.timezone??"browser"});return{...Je,rawPrometheusResult:At}}))},ae=(Je={})=>ct=>{if(ct.logsFrames.length===0)return{...ct,logsResult:null};const ot=ct.request?.intervalMs,Qe=(0,U.HT)(ct.logsFrames,ot,Je.absoluteRange,Je.queries,Je.deduplicate),pt=(0,E.uE)(Je.refreshInterval),Pt=(0,K.zy)(Qe,pt),At=Pt.rows,mn=Pt.series,Pn={...Pt,rows:At,series:mn};return{...ct,logsResult:Pn}};function j(Je,ct,ot,Qe,pt,Pt,At){return(0,g.of)(Je).pipe((0,L.T)(mn=>(0,l.N$)(mn,ct)),(0,L.T)(Y({defaultTargetDatasource:At,showCorrelationEditorLinks:Pt,queries:Qe,correlations:pt})),(0,L.T)(H),(0,L.T)(X),(0,L.T)(ot),(0,c.Z)(q),(0,c.Z)(J))}function te(Je){const ct=(0,s.groupBy)(Je.fields,ot=>ot.type);return!!(Object.keys(ct).length===2&&ct[B.PU.time]?.length===1&&ct[B.PU.number])}function ne(Je){return Je.meta?.preferredVisualisationPluginId?(0,V.oZ)(Je.meta?.preferredVisualisationPluginId):!1}var le=e(57288),z=e(324),ee=e(62256),se=e(72433),ie=e(29436),Z=e(89224),oe=e(34028);const ce=Je=>ct=>{const ot=ct.explore.panes[Je];return ot&&ot.queryResponse?ot.queryResponse.state===h.Gu.Loading||ot.queryResponse.state===h.Gu.Streaming:!1},ye=(0,t.VP)("explore/addQueryRow"),re=(0,t.VP)("explore/changeQueries"),ue=(0,t.VP)("explore/cancelQueries"),De=(0,t.VP)("explore/queriesImported"),ge=(0,t.VP)("explore/queryStoreSubscription"),Te=(0,t.VP)("explore/setSupplementaryQueryEnabledAction"),Le=(0,t.VP)("explore/storeSupplementaryQueryDataProviderAction"),Ye=(0,t.VP)("explore/cleanSupplementaryQueryDataProviderAction"),je=(0,t.VP)("explore/cleanSupplementaryQueryAction"),Ze=(0,t.VP)("explore/storeSupplementaryQueryDataSubscriptionAction"),Ne=(0,t.VP)("explore/updateSupplementaryQueryDataAction"),Pe=(0,t.VP)("explore/queryStreamUpdated"),Ue=(0,t.VP)("explore/setQueries"),$e=(0,t.VP)("changeLoadingState"),ze=(0,t.VP)("explore/setPausedState"),qe=(0,t.VP)("explore/clearLogs"),dt=(0,t.VP)("explore/scanStart"),vt=(0,t.VP)("explore/scanStop"),yt=(0,t.VP)("explore/addResultsToCache"),st=(0,t.VP)("explore/clearCache");function Ve(Je,ct){return async(ot,Qe)=>{const pt=Qe().explore.panes[Je];let Pt;pt.datasourceInstance?.meta.mixed?Pt=(0,s.findLast)(pt.queries,mn=>!!mn.datasource)?.datasource||void 0:Pt=pt.datasourceInstance?.getRef();const At=await(0,E.Ll)(pt.queries,ct,Pt);ot(ye({exploreId:Je,index:ct,query:At}))}}function pe(Je){return(ct,ot)=>{ct(vt({exploreId:Je})),ct(ue({exploreId:Je}));const Qe=ot().explore.panes[Je].supplementaryQueries;for(const pt of le.VW)ct(Ye({exploreId:Je,type:pt})),Qe[pt]?.data?.state!==h.Gu.Done&&ct(je({exploreId:Je,type:pt}))}}const Ee=(Je,ct)=>{const ot=Je.getRef();return ct.map(Qe=>({...Qe,datasource:ot}))},me=async(Je,ct,ot)=>{let Qe=[];if(ct.meta?.id===Je.meta?.id)Qe=ot;else if((0,f.Ee)(ct)&&(0,f.FL)(Je)){const pt=await ct.exportToAbstractQueries(ot);Qe=await Je.importFromAbstractQueries(pt)}else Je.importQueries&&(Qe=await Je.importQueries(ot,ct));return Ee(Je,Qe)},ve=(0,T.createAsyncThunk)("explore/changeQueries",async({queries:Je,exploreId:ct},{getState:ot,dispatch:Qe})=>{let pt=!1;const Pt=ot().explore.panes[ct].queries,At=ot().explore.panes[ct].datasourceInstance?.uid,mn=ot().explore.correlationEditorDetails,Pn=mn?.editorMode||!1;!(Object.keys(ot().explore.panes)[0]===ct)&&Pn&&!mn?.queryEditorDirty&&Qe((0,ie.am)({queryEditorDirty:!0}));for(const Rn of Je)for(const Kn of Pt){if(Rn.refId===Kn.refId&&Rn.datasource?.type!==Kn.datasource?.type){const Bt=await(0,u.l)().get(Kn.datasource),an=await(0,u.l)().get({uid:Rn.datasource?.uid});await Qe(Se(ct,Pt,Bt,an,Rn.refId)),pt=!0}if(At===I.uv&&Rn.refId===Kn.refId&&Rn.datasource?.uid!==Kn.datasource?.uid){const Bt=(0,oe.dq)(I.uv,Je),an=await(0,P.J6)(Bt);Qe((0,ee.Fb)({exploreId:ct,correlations:an.correlations||[]}))}}pt||Qe(re({queries:Je,exploreId:ct})),Je.length<Pt.length&&Qe(he({exploreId:ct}))}),Se=(Je,ct,ot,Qe,pt)=>async Pt=>{if(!ot){Pt(De({exploreId:Je,queries:ct}));return}let At=ct;if(Qe.uid===I.uv)At=ct.map(Pn=>({...Pn,datasource:ot.getRef()}));else if(ot.uid===I.uv){const Pn=(0,s.groupBy)(ct,Rn=>Rn.datasource?.uid),fn=await Promise.all(Object.keys(Pn).map(async Rn=>{const Kn=await(0,u.l)().get({uid:Rn});return await me(Qe,Kn,Pn[Rn])}));At=(0,s.flatten)(fn.filter(Rn=>Rn.length>0))}else{let Pn=ct;if(pt!==void 0){const fn=ct.find(Rn=>Rn.refId===pt);fn&&(Pn=[fn])}At=await me(Qe,ot,Pn)}let mn=await(0,E.di)(At,Qe.getRef());if(pt!==void 0){At.length===0&&(At=[await(0,E.Ll)([],void 0,Qe.getRef())]);const Pn=ct.findIndex(Rn=>Rn.refId===pt),fn={...mn[0],refId:ct[Pn].refId};mn=[...ct],mn[Pn]=fn}return Pt(De({exploreId:Je,queries:mn})),mn};function Ie(Je,ct,ot){return async(Qe,pt)=>{const Pt=pt().explore.panes[Je],{queries:At}=Pt,Pn=(await Promise.all(At.map(fn=>ot({...fn},ct)))).map((fn,Rn)=>(0,E.eF)(fn,At,Rn));Qe(Ue({exploreId:Je,queries:Pn})),ct.preventSubmit||Qe(he({exploreId:Je}))}}function Oe(Je,ct){if(!(Je.filterQuery&&!Je.filterQuery(ct)))return ct}async function Re(Je,ct,ot,Qe){const Pt=(await Promise.all(Qe.map(async At=>{if(At.datasource?.uid===ot.uid)return Oe(ot,At);{const mn=await(0,b.tR)().get(At.datasource);return Oe(mn,At)}}))).filter(At=>!!At);Pt.length>0&&(Je((0,se.ri)(!0,ot.uid,ot.name,Pt,D.$.queryHistoryEnabled)),D.$.queryHistoryEnabled&&Je((0,se.ri)(!1,ot.uid,ot.name,Pt,!1)),await Je((0,se.jX)()))}const he=(0,T.createAsyncThunk)("explore/runQueries",async({exploreId:Je,preserveCache:ct},{dispatch:ot,getState:Qe})=>{ot(pe(Je));const{defaultCorrelationEditorDatasource:pt,scopedVars:Pt,showCorrelationEditorLinks:At}=await(0,oe.aj)(Qe(),Je),mn=(0,z.M)(Je);ot((0,Z.JA)({exploreId:Je})),ct!==!0&&ot(St(Je));const fn=Qe().explore.panes[Je],{datasourceInstance:Rn,containerWidth:Kn,isLive:Bt,range:an,scanning:tn,queryResponse:Cn,querySubscription:xn,refreshInterval:Vn,absoluteRange:Et,cache:Ft,supplementaryQueries:Gt}=fn;let ln,qt;const cn=fn.queries.map(Sn=>({...Sn,datasource:Sn.datasource||Rn?.getRef()}));Rn!=null&&Re(ot,Qe().explore,Rn,cn);const En=(0,oe.rk)(Ft,Et);if(En)ln=(0,r.z)([(0,g.of)(En),mn]).pipe((0,c.Z)(([Sn,Tn])=>j(Sn,Cn,ae({absoluteRange:Et,refreshInterval:Vn,queries:cn}),cn,Tn,At,pt))),qt=ln.subscribe(Sn=>{ot(Pe({exploreId:Je,response:Sn}))});else{if(!(0,E.zT)(cn)||!Rn)return;const Sn=Rn?.interval;(0,E._u)(xn);const Tn={minInterval:Sn,maxDataPoints:Kn,liveStreaming:Bt},Wn=(0,M.O)(Qe().user),Nn=(0,E.bI)(Je,cn,Tn,an,tn,Wn,Pt);if(ot($e({exploreId:Je,loadingState:h.Gu.Loading})),ln=(0,r.z)([(0,A.BN)(Rn,Nn.request).pipe(Bt?(0,o.c)(500):a.D),mn]).pipe((0,c.Z)(([Tt,Wt])=>j(Tt,Cn,ae({absoluteRange:Et,refreshInterval:Vn,queries:cn}),cn,Wt,At,pt))),qt=ln.subscribe({next(Tt){const Wt=Qe().explore.panes[Je];if(ot(Pe({exploreId:Je,response:Tt})),Wt.scanning)if(Tt.state===h.Gu.Done&&Tt.series.length===0){const jt=(0,x.Wb)(-1,Wt.range);ot((0,Z.JA)({exploreId:Je,absoluteRange:jt})),ot(he({exploreId:Je}))}else ot(vt({exploreId:Je}))},error(Tt){ot((0,C.dx)((0,S.gi)("Query processing error",Tt))),ot($e({exploreId:Je,loadingState:h.Gu.Error})),console.error(Tt)},complete(){Qe().explore.panes[Je].queryResponse.state===h.Gu.Loading&&ot($e({exploreId:Je,loadingState:h.Gu.Done}))}}),Bt)for(const Tt of le.VW)ot(Ye({exploreId:Je,type:Tt})),ot(je({exploreId:Je,type:Tt}));else ot(et({exploreId:Je,datasourceInstance:Rn,transaction:Nn,newQuerySource:ln,supplementaryQueries:Gt,queries:cn,absoluteRange:Et}))}ot(ge({exploreId:Je,querySubscription:qt}))}),Ce=(0,T.createAsyncThunk)("explore/runLoadMoreQueries",async({exploreId:Je,absoluteRange:ct},{dispatch:ot,getState:Qe})=>{ot(pe(Je));const{datasourceInstance:pt,containerWidth:Pt,queryResponse:At}=Qe().explore.panes[Je],{defaultCorrelationEditorDatasource:mn,scopedVars:Pn,showCorrelationEditorLinks:fn}=await(0,oe.aj)(Qe(),Je),Rn=(0,z.M)(Je);let Kn;const Bt=At.logsResult?.queries||[],an=At.logsFrames.map(Ft=>Ft.refId),tn=Bt.filter(Ft=>an.includes(Ft.refId)).map(Ft=>({...Ft,datasource:Ft.datasource||pt?.getRef(),refId:Ft.refId,supportingQueryType:O.Q$.InfiniteScroll}));if(!(0,E.zT)(tn)||!pt)return;const Cn={minInterval:pt?.interval,maxDataPoints:Pt},xn=(0,M.O)(Qe().user),Vn=(0,E.zq)(xn,{from:(0,d.oZ)(xn,ct.from),to:(0,d.oZ)(xn,ct.to)},(0,M.q)(Qe().user)),Et=(0,E.bI)(Je,tn,Cn,Vn,!1,xn,Pn);ot($e({exploreId:Je,loadingState:h.Gu.Loading})),Kn=(0,r.z)([(0,A.BN)(pt,Et.request),Rn]).pipe((0,c.Z)(([Ft,Gt])=>Ft.state!==h.Gu.Done?(0,g.of)({...At,state:h.Gu.Loading}):j((0,y._k)(At,Ft),At,ae({absoluteRange:ct,queries:Bt,deduplicate:!0}),tn,Gt,fn,mn))),Kn.subscribe({next(Ft){ot(Pe({exploreId:Je,response:Ft}))},error(Ft){ot((0,C.dx)((0,S.gi)("Query processing error",Ft))),ot($e({exploreId:Je,loadingState:h.Gu.Error})),console.error(Ft)},complete(){ot($e({exploreId:Je,loadingState:h.Gu.Done}))}})}),We=async(Je,ct)=>{const ot=Je.filter(pt=>pt.datasource?.uid!==I.uv),Qe=(0,s.groupBy)(ot,"datasource.uid");return await Promise.all(Object.values(Qe).map(async pt=>({datasource:await(0,u.l)().get(pt[0].datasource,ct),targets:pt})))},et=(0,T.createAsyncThunk)("explore/handleSupplementaryQueries",async({datasourceInstance:Je,exploreId:ct,transaction:ot,newQuerySource:Qe,supplementaryQueries:pt,queries:Pt,absoluteRange:At},{dispatch:mn})=>{let Pn;Je.meta.mixed?Pn=await We(ot.request.targets,ot.request.scopedVars):Pn=[{datasource:Je,targets:ot.request.targets}];for(const fn of le.VW){const Rn=(0,le.Pm)(Pn,fn,{...ot.request,requestId:`${ot.request.requestId}_${(0,s.snakeCase)(fn)}`},Qe);Rn?(mn(Le({exploreId:ct,type:fn,dataProvider:Rn})),rt(pt[fn].data,Pt,At)||(mn(je({exploreId:ct,type:fn})),pt[fn].enabled&&mn(zt(ct,fn)))):mn(Ye({exploreId:ct,type:fn}))}});function rt(Je,ct,ot){if(!Je)return!1;const Qe=(0,s.zipObject)((0,s.map)(ct,"refId"),ct),pt=(0,s.mapValues)((0,s.groupBy)(Je.data.map(Pn=>Pn.meta?.custom?.sourceQuery),"refId"),s.head),Pt=Je.data.every(Pn=>Pn.meta?.custom?.logsVolumeType===p.Aj.FullRange),At=i()(Qe,pt),mn=Je.data.every(Pn=>{const fn=Pn.meta?.custom?.absoluteRange;return fn?fn&&fn.from<=ot.from&&ot.to<=fn.to:!0});return Pt&&At&&mn}function nt(Je,ct){return(ot,Qe)=>{const pt=Qe().explore.panes[Je].queries,Pt=ct.map((At,mn)=>(0,E.eF)(At,pt,mn));ot(Ue({exploreId:Je,queries:Pt})),ot(he({exploreId:Je}))}}function gt(Je){return(ct,ot)=>{ct(dt({exploreId:Je}));const Qe=(0,x.Wb)(-1,ot().explore.panes[Je].range);ct((0,Z.JA)({exploreId:Je,absoluteRange:Qe})),ct(he({exploreId:Je}))}}function xt(Je){return(ct,ot)=>{const Qe=ot().explore.panes[Je].queryResponse,pt=ot().explore.panes[Je].absoluteRange,Pt=(0,oe.O2)(pt);Qe.state===h.Gu.Done&&ct(yt({exploreId:Je,cacheKey:Pt,queryResponse:Qe}))}}function St(Je){return(ct,ot)=>{ct(st({exploreId:Je}))}}function zt(Je,ct){return(ot,Qe)=>{const{supplementaryQueries:pt}=Qe().explore.panes[Je],Pt=pt[ct].dataProvider;if(Pt){const At=Pt.subscribe({next:mn=>{ot(Ne({exploreId:Je,type:ct,data:mn}))}});ot(Ze({exploreId:Je,type:ct,dataSubscription:At}))}}}function Nt(Je,ct,ot){return(Qe,pt)=>{Qe(Te({exploreId:Je,enabled:ct,type:ot})),(0,le.Oi)(ct,ot),ct&&Qe(zt(Je,ot))}}const Vt=(Je,ct)=>{if(ye.match(ct)){const{queries:ot}=Je,{index:Qe,query:pt}=ct.payload,Pt=[...ot.slice(0,Qe+1),{...pt},...ot.slice(Qe+1)];return{...Je,queries:Pt,queryKeys:(0,E.dY)(Pt)}}if(re.match(ct)){const{queries:ot}=ct.payload;return{...Je,queries:ot}}if(ue.match(ct))return(0,E._u)(Je.querySubscription),{...Je,...Je.queryResponse?{queryResponse:{...Je.queryResponse,state:h.Gu.Done}}:{}};if(Ue.match(ct)){const{queries:ot}=ct.payload;return{...Je,queries:ot.slice(),queryKeys:(0,E.dY)(ot)}}if(ge.match(ct)){const{querySubscription:ot}=ct.payload;return{...Je,querySubscription:ot}}if(Te.match(ct)){const{enabled:ot,type:Qe}=ct.payload,{supplementaryQueries:pt}=Je,Pt=pt[Qe].dataSubscription;!ot&&Pt&&Pt.unsubscribe();const At={...pt,[Qe]:{...pt[Qe],enabled:ot,data:void 0}};return{...Je,supplementaryQueries:At}}if(Le.match(ct)){const{dataProvider:ot,type:Qe}=ct.payload,{supplementaryQueries:pt}=Je,Pt=pt[Qe];Pt?.dataSubscription&&Pt.dataSubscription.unsubscribe();const At={...pt,[Qe]:{...Pt,dataProvider:ot,dataSubscription:void 0}};return{...Je,supplementaryQueries:At}}if(Ye.match(ct)){const{type:ot}=ct.payload,{supplementaryQueries:Qe}=Je,pt=Qe[ot];pt?.dataSubscription&&pt.dataSubscription.unsubscribe();const Pt={...Qe,[ot]:{...pt,dataProvider:void 0,dataSubscription:void 0}};return{...Je,supplementaryQueries:Pt}}if(je.match(ct)){const{type:ot}=ct.payload,{supplementaryQueries:Qe}=Je,pt={...Qe,[ot]:{...Qe[ot],data:void 0}};return{...Je,supplementaryQueries:pt}}if(Ze.match(ct)){const{dataSubscription:ot,type:Qe}=ct.payload,{supplementaryQueries:pt}=Je,Pt={...pt,[Qe]:{...pt[Qe],dataSubscription:ot}};return{...Je,supplementaryQueries:Pt}}if(Ne.match(ct)){let{data:ot,type:Qe}=ct.payload;const{supplementaryQueries:pt}=Je,Pt={...pt,[Qe]:{...pt[Qe],data:ot}};return{...Je,supplementaryQueries:Pt}}if(Pe.match(ct))return en(Je,ct);if(De.match(ct)){const{queries:ot}=ct.payload;return{...Je,queries:ot,queryKeys:(0,E.dY)(ot)}}if($e.match(ct)){const{loadingState:ot}=ct.payload;return{...Je,queryResponse:{...Je.queryResponse,state:ot}}}if(ze.match(ct)){const{isPaused:ot}=ct.payload;return{...Je,isPaused:ot}}if(dt.match(ct))return{...Je,scanning:!0};if(vt.match(ct))return{...Je,scanning:!1,scanRange:void 0};if(yt.match(ct)){const{cache:Qe}=Je,{queryResponse:pt,cacheKey:Pt}=ct.payload;let At=[...Qe];return At.some(Pn=>Pn.key===Pt)||(At=[{key:Pt,value:pt},...At].slice(0,5)),{...Je,cache:At}}if(st.match(ct))return{...Je,cache:[]};if(qe.match(ct)){if(!Je.logsResult)return{...Je,clearedAtIndex:null};if(Je.queryResponse.state===h.Gu.Loading)return{...Je,clearedAtIndex:null,logsResult:{...Je.logsResult,rows:[]}};const ot=Je.clearedAtIndex?Je.clearedAtIndex+Je.logsResult.rows.length:Je.logsResult.rows.length-1;return{...Je,clearedAtIndex:ot,logsResult:{...Je.logsResult,rows:[]}}}return Je},en=(Je,ct)=>{const{response:ot}=ct.payload,{request:Qe,series:pt,error:Pt,graphResult:At,logsResult:mn,tableResult:Pn,rawPrometheusResult:fn,traceFrames:Rn,nodeGraphFrames:Kn,flameGraphFrames:Bt,rawPrometheusFrames:an,customFrames:tn}=ot;if(Pt){if(Pt.type===m.v2.Timeout||Pt.type===m.v2.Cancelled)return{...Je};D.$.angularSupportEnabled&&Je.datasourceInstance?.components?.QueryCtrl&&Je.eventBridge.emit(v.ee.dataError,Pt)}if(!Qe)return{...Je};if(D.$.angularSupportEnabled&&Je.datasourceInstance?.components?.QueryCtrl){const Cn=pt.map(xn=>(0,l.w3)(xn));Je.eventBridge.emit(v.ee.dataReceived,Cn)}return{...Je,queryResponse:ot,graphResult:At,tableResult:Pn,rawPrometheusResult:fn,logsResult:Je.isLive&&mn?{...mn,rows:(0,oe.pg)(Je.clearedAtIndex,mn.rows)}:mn,showLogs:!!mn,showMetrics:!!At,showTable:!!Pn?.length,showTrace:!!Rn.length,showNodeGraph:!!Kn.length,showRawPrometheus:!!an.length,showFlameGraph:!!Bt.length,showCustom:!!tn?.length,clearedAtIndex:Je.isLive?Je.clearedAtIndex:null}}},9955:(k,R,e)=>{"use strict";e.d(R,{Jr:()=>h,K6:()=>a,Kl:()=>p,Qb:()=>s,i6:()=>g,pF:()=>c,qq:()=>f,st:()=>o,vC:()=>d});var t=e(25508),n=e(2543),i=e.n(n);const s=m=>m.explore.panes,r=m=>m.explore,g=m=>m.explore.richHistorySettings,a=(0,t.Mz)(s,Object.entries),c=(0,t.Mz)(a,m=>m.length>1),o=(0,t.Mz)(a,m=>m.some(v=>v[1].correlationEditorHelperData!==void 0)),h=m=>(0,t.Mz)(s,v=>Object.keys(v)[0]===m),f=m=>(0,t.Mz)(s,v=>v[m]),d=(0,t.Mz)(r,m=>m.correlationEditorDetails),p=(0,t.Mz)(a,m=>{const v=m.map(([u,D])=>{const E=[D?.datasourceInstance?.getRef()],x=D?.queries.map(b=>b.datasource)||[],P=[...E,...x].filter(b=>!!b);if(!(P===void 0||P.length===0))return{exploreId:u,datasources:(0,n.uniqBy)(P,b=>b.uid)}}).filter(u=>!!u),y=(0,n.uniqBy)((0,n.flatten)(v.map(u=>u.datasources)),u=>u.uid).map(u=>{let D=[];return v.forEach(E=>{E.datasources.some(x=>x.uid===u.uid)&&D.push(E.exploreId)}),{datasource:u,exploreIds:D}});return{exploreToDS:v,dsToExplore:y}})},89224:(k,R,e)=>{"use strict";e.d(R,{$_:()=>b,GA:()=>T,GH:()=>u,Iy:()=>M,JA:()=>E,QP:()=>C,Xk:()=>I,eM:()=>l,hO:()=>y,iO:()=>x,ke:()=>O,zY:()=>D});var t=e(65307),n=e(47232),i=e(26272),s=e(39070),r=e(72574),g=e(11134),a=e(76412),c=e(28138),o=e(87490),h=e(80582),f=e(74856),d=e(91002),p=e(32901),m=e(29436),v=e(23994);const l=(0,t.VP)("explore/changeRange"),y=(0,t.VP)("explore/changeRefreshInterval"),u=S=>(A,L)=>{const{syncedTimes:N}=L().explore;N?Object.keys(L().explore.panes).forEach(F=>{A(E({...S,exploreId:F})),A((0,v.Od)({exploreId:F,preserveCache:!0}))}):(A(E({...S})),A((0,v.Od)({exploreId:S.exploreId,preserveCache:!0})))},D=S=>A=>{A((0,v.S6)({...S}))},E=S=>(A,L)=>{const{exploreId:N,absoluteRange:F,rawRange:w}=S,B=L().explore.panes[N],U=(0,p.O)(L().user),K=(0,p.q)(L().user),{range:V}=B;let H=V.raw;F&&(H={from:(0,n.oZ)(U,F.from),to:(0,n.oZ)(U,F.to)}),w&&(H=w);const Y=(0,o.zq)(U,H,K),X={from:Y.from.valueOf(),to:Y.to.valueOf()};(0,f.jG)().init({timepicker:{},getTimezone:()=>U,timeRangeUpdated(J){},time:Y.raw}),(0,r.w)().updateTimeRange(Y),A(l({exploreId:N,range:Y,absoluteRange:X}))};function x(S){return(A,L)=>{const N=L().explore.panes[S].range.raw;Object.keys(L().explore.panes).filter(w=>w!==S).forEach(w=>{A(u({exploreId:w,rawRange:N}))});const F=L().explore.syncedTimes;A((0,m.qz)({syncedTimes:!F}))}}function P(S){return(A,L)=>{const N=(0,p.O)(L().user),F=(0,p.q)(L().user);Object.entries(L().explore.panes).forEach(([w,B])=>{const U=(0,o.zq)(N,B.range.raw,F);S(w,B,U,A)})}}function b(){return P((S,A,L,N)=>{const F={from:L.from.valueOf(),to:L.to.valueOf()};N(u({exploreId:S,absoluteRange:F}))})}function M(S){return P((A,L,N,F)=>{const w=(0,h.Wb)(S,N);F(u({exploreId:A,absoluteRange:w}))})}function O(S){return P((A,L,N,F)=>{const w=(0,h.Zk)(N,S);F(u({exploreId:A,absoluteRange:w}))})}function I(){return(S,A)=>{const L=A().explore.panes[Object.keys(A().explore.panes)[0]].range.raw;navigator.clipboard.writeText(JSON.stringify(L)),c.A.emit(i.r1.alertSuccess,[(0,a.t)("time-picker.copy-paste.copy-success-message","Time range copied to clipboard")])}}function T(){return async(S,A)=>{const{range:L,isError:N}=await(0,h.zG)();if(N===!0){c.A.emit(i.r1.alertError,[(0,a.t)("time-picker.copy-paste.default-error-title","Invalid time range"),(0,a.t)("time-picker.copy-paste.default-error-message","{{error}} is not a valid time range",{error:L})]);return}if(A().explore.syncedTimes){S(u({exploreId:Object.keys(A().explore.panes)[0],rawRange:L})),S(u({exploreId:Object.keys(A().explore.panes)[1],rawRange:L}));return}S(u({exploreId:Object.keys(A().explore.panes)[0],rawRange:L}))}}const C=(S,A)=>{if(y.match(A)){const{refreshInterval:L}=A.payload,N=g.cC.isLive(L),F=(0,o.uE)(L),w=(0,d.zy)(S.logsResult,F);return g.cC.isLive(S.refreshInterval)&&!N&&(0,o._u)(S.querySubscription),{...S,refreshInterval:L,queryResponse:{...S.queryResponse,state:N?s.Gu.Streaming:s.Gu.Done},isLive:N,isPaused:N?!1:S.isPaused,logsResult:w}}if(l.match(A)){const{range:L,absoluteRange:N}=A.payload;return{...S,range:L,absoluteRange:N}}return S}},34028:(k,R,e)=>{"use strict";e.d(R,{BE:()=>P,HZ:()=>E,O2:()=>b,RA:()=>x,Z9:()=>I,aj:()=>A,dq:()=>S,eO:()=>O,kn:()=>y,ng:()=>D,pg:()=>C,rk:()=>M});var t=e(2543),n=e.n(t),i=e(39070),s=e(43127),r=e(85858),g=e(47232),a=e(32264),c=e(19347),o=e(11401),h=e(81523),f=e(14678),d=e(33390),p=e(87490),m=e(31193),v=e(57288);const l=100,y={from:`now-${a.$.exploreDefaultTimeOffset}`,to:"now"},u="grafana.explore.style.graph",D=L=>{d.A.set(u,L)},E=L=>({containerWidth:0,datasourceInstance:null,history:[],queries:[],initialized:!1,range:{from:null,to:null,raw:y},absoluteRange:{from:null,to:null},scanning:!1,queryKeys:[],isLive:!1,isPaused:!1,queryResponse:x(),tableResult:null,graphResult:null,logsResult:null,clearedAtIndex:null,rawPrometheusResult:null,eventBridge:null,cache:[],supplementaryQueries:(0,v.Ez)(),panelsState:{},correlations:void 0,...L}),x=()=>({state:i.Gu.NotStarted,series:[],timeRange:(0,s.E2)(),graphFrames:[],logsFrames:[],traceFrames:[],nodeGraphFrames:[],flameGraphFrames:[],customFrames:[],tableFrames:[],rawPrometheusFrames:[],rawPrometheusResult:null,graphResult:null,logsResult:null,tableResult:null});async function P(L,N){let F;try{F=await(0,m.tR)().get(N)}catch{F=await(0,m.tR)().get()}if(F.init)try{F.init()}catch(K){console.error(K)}let w=[];const B=(0,o.tU)(),U=await B.getRichHistory({search:"",sortOrder:h.xB.Ascending,datasourceFilters:[F.name],starred:!1});if((U.total||0)>0&&U.richHistory.forEach(K=>{K.queries.forEach(V=>{w.push({ts:parseInt(K.id,10),query:V})})}),w.length<l){const K=await B.getRichHistory({search:"",sortOrder:h.xB.Ascending,datasourceFilters:[f.uv],starred:!1});(K.total||0)>0&&K.richHistory.forEach(V=>{V.queries.forEach(H=>{H?.datasource?.uid===F.uid&&w.push({ts:parseInt(V.id,10),query:H})})})}if(w.length<l){const K=`grafana.explore.history.${F.meta?.id}`;w=[...w,...d.A.getObject(K,[])]}return w.length>l&&(w.length=l),(0,p.dr)(L,F.uid),{history:w,instance:F}}function b(L){const N={from:L.from,to:L.to};return Object.entries(N).map(([w,B])=>`${encodeURIComponent(w)}=${encodeURIComponent(B.toString())}`).join("&")}function M(L,N){const F=b(N),w=L.findIndex(U=>U.key===F);return w>=0?L[w].value:void 0}function O(L,N){return{from:r.parse(L.from,!1,N),to:r.parse(L.to,!0,N),raw:L}}function I(L){let N=y,F={from:T(L.from),to:T(L.to)};return F.from!==null&&F.to!==null&&(N={from:F.from,to:F.to}),N}function T(L){if(L===null)return null;if((0,g.Ar)(L))return L;if(typeof L!="string")return null;const N=L;if(N.indexOf("now")!==-1)return N;if(N.length===8)return(0,g.yT)(N,"YYYYMMDD");if(N.length===15)return(0,g.yT)(N,"YYYYMMDDTHHmmss");if(N.length===19)return(0,g.yT)(N,"YYYY-MM-DD HH:mm:ss");if(N.match(/^\d+$/)){const w=parseInt(N,10);return(0,g.yT)(w)}const F=(0,g.yT)(N);return F.isValid()?F:null}const C=(L,N)=>N?L?N.slice(L+1):N:[],S=(L,N)=>L===f.uv?(0,t.uniq)(N.map(F=>F.datasource?.uid).filter(F=>!!F)):[L];async function A(L,N){const F=L.explore.panes[N].correlationEditorHelperData,w=L.explore.correlationEditorDetails?.editorMode||!1,B=Object.keys(L.explore.panes)[0]===N,U=w&&B,K=U?await(0,c.l)().get():void 0,V=w&&!B&&F!==void 0;let H={};return V&&F!==void 0&&Object.entries(F?.vars).forEach(Y=>{H[Y[0]]={value:Y[1]}}),{defaultCorrelationEditorDatasource:K,scopedVars:H,showCorrelationEditorLinks:U}}},96192:(k,R,e)=>{"use strict";e.d(R,{JQ:()=>x,O1:()=>b,QL:()=>D,YV:()=>u,_O:()=>I});var t=e(2543),n=e.n(t),i=e(96540),s=e(92461),r=e(91890),g=e(41987),a=e(6709),c=e(76885),o=e(72574),h=e(14110),f=e(16233),d=e(67023),p=e(6923),m=e(39590);const l=[T=>!T.internal||f.TP.hasAccessToExplore()],y="grafana_data_link_clicked",u=(T,C)=>A=>{const{field:L,dataLinkScopedVars:N,frame:F,link:w,linkModel:B}=A,{valueRowIndex:U}=A.config;if(!w.internal||U===void 0)return B;const K=D({field:L,rowIndex:U,splitOpenFn:T,range:C,vars:N,dataFrame:F,linksToProcess:[w]});return K.length?(0,t.first)(K):void 0},D=T=>{const{field:C,vars:S,splitOpenFn:A,range:L,rowIndex:N,dataFrame:F}=T,w={...S||{}};w.__value={value:{raw:C.values[N]},text:"Raw value"};let B;F&&(B=(0,s.F)({frame:F,rowIndex:N}),w.__data={value:{name:F.name,refId:F.refId,fields:B},text:"Data"},F.fields.forEach(K=>{B&&B[K.name]&&(w[K.name]={value:B[K.name]})}),w.__targetField={value:B[C.name]});const U=T.linksToProcess||C.config.links;return U?U.filter(H=>l.every(Y=>Y(H,w))).map(H=>{if(H.internal){let Y={};H.internal?.transformations&&H.internal?.transformations.forEach(j=>{let te;j.field?te=F?.fields.find(le=>le.name===j.field)?.values[N]:te=C.values[N],Y={...Y,...(0,d.k)(j,te,C.name)}});const X={...w,...Y},J=b(H,X);let q=[];if(J.variables.length===0){const j=C.name.toString();q.push({variableName:j,value:"",match:""})}else q=J.variables;const ae=j=>{(0,h.rR)(y,{origin:H.origin||r.x0.Datasource,app:g.Jk.Explore,internal:!0}),A?.(j)};return J.allVariablesDefined?{...(0,a.u)({link:H,internalLink:H.internal,scopedVars:X,range:L,field:C,onClickFn:T.splitOpenFn?te=>ae(te):void 0,replaceVariables:(0,o.w)().replace.bind((0,o.w)())}),variables:q}:void 0}else{const Y=(J,q)=>(0,o.w)().replace(J,{...q,...w}),X=(0,p.mQ)().getDataLinkUIModel(H,Y,C);return X.title||(X.title=E(X.href)),X}}).filter(H=>!!H):[]};function E(T){T.indexOf("://")<0&&(T=`http://${T}`);let C;try{C=new URL(T).hostname}catch{C=T}return C}function x(T,C){return(0,i.useCallback)((S,A)=>S.fields.flatMap(L=>L.config?.links&&L.config?.links.length?D({field:L,rowIndex:A,range:T,dataFrame:S,splitOpenFn:C}):[]),[T,C])}const P=["__from","__to","__interval","__interval_ms","__org","__user","__range","__rate_interval","__timeFilter","timeFilter"];function b(T,C){let S=[];return(0,o.w)().replace.bind((0,o.w)())(M(T),C,void 0,S),S=(0,t.uniqBy)(S,"variableName"),{variables:S,allVariablesDefined:S.filter(L=>!P.includes(L.variableName)).every(L=>L.found)}}function M(T){let C="",S;for(S in T)typeof T[S]=="string"?C+=" "+T[S]:typeof T[S]=="object"&&(C+=" "+M(T[S]));return C}const O=T=>T[1]!==void 0,I=T=>{const C=Object.entries(T).filter(O).map(([S,A])=>{const L=(0,m.m)(A);return L.range={to:A.range.to.valueOf().toString(),from:A.range.from.valueOf().toString()},[S,L]}).reduce((S,[A,L])=>({...S,[A]:L}),{});return c.kM.renderUrl("/explore",{schemaVersion:1,panes:JSON.stringify(C)})}},27649:(k,R,e)=>{"use strict";e.d(R,{v:()=>n});var t=e(77789);function n(i){const s=new Set(i.map(r=>r.refId).filter(Boolean));return s.size===i.length?i:(s.clear(),i.map(r=>{if(r.refId&&!s.has(r.refId))return s.add(r.refId),r;const g=(0,t.M)(i);return s.add(g),{...r,refId:g}}))}},57288:(k,R,e)=>{"use strict";e.d(R,{Ez:()=>m,Oi:()=>p,Pm:()=>y,VW:()=>f});var t=e(2543),n=e.n(t),i=e(88483),s=e(44240),r=e(6276),g=e(29405),a=e(9557),c=e(39070),o=e(33390),h=e(69147);const f=[a.cF.LogsVolume,a.cF.LogsSample],d=u=>`grafana.explore.logs.enable${u}`,p=(u,D)=>{o.A.set(d(D),u?"true":"false")},m=()=>{let u={[a.cF.LogsVolume]:{enabled:!0},[a.cF.LogsSample]:{enabled:!1}};for(const D of f){if(D===a.cF.LogsSample)continue;o.A.get(d(D))==="false"&&(u[D]={enabled:!1})}return u},v=(u,D,E)=>new i.c(x=>u.subscribe(P=>{if(P.logsResult&&P.logsResult.rows&&P.logsResult.visibleRange&&P.logsResult.bucketSize!==void 0&&P.state===c.Gu.Done){const b=P.logsResult.bucketSize,M=D.map(T=>T.refId),O=(0,t.groupBy)(P.logsResult.rows,"dataFrame.refId");let I=[];M.forEach(T=>{if(O[T]?.length){const C=(0,h.J9)(O[T],b);I=[...I,...C];const S={logsVolumeType:a.Aj.Limited,absoluteRange:P.logsResult?.visibleRange,datasourceName:E,sourceQuery:D.find(A=>A.refId===T)};x.next({data:I.map(A=>{const L=A.meta?.custom||{};return{...A,meta:{custom:{...L,...S}}}}),state:P.state})}}),x.complete()}})),l=(u,D,E,x)=>{if(u===a.cF.LogsVolume)return v(D,E,x)},y=(u,D,E,x)=>{const b=u.map(({datasource:M,targets:O},I)=>{const T=(0,t.cloneDeep)(E);if(T.requestId=`${T.requestId||""}_${I}`,T.targets=O,(0,a.Nc)(M,D)){if(M.getDataProvider)return M.getDataProvider(D,T);if(M.getSupplementaryRequest){const C=M.getSupplementaryRequest(D,T);return C?D===a.cF.LogsVolume?(0,h.sg)(M,C,{targets:T.targets}):(0,h.Wr)(M,C):void 0}else return}else return l(D,x,O,M.name)}).filter(c.zz);if(b.length!==0)return b.length===1?b[0]:(0,s.h)(...b).pipe((0,g.S)((M,O)=>M.errors&&M.errors.length||O.state===c.Gu.NotStarted?M:O.state===c.Gu.Loading&&M.state===c.Gu.NotStarted?{...M,state:c.Gu.Loading}:O.state&&O.state!==c.Gu.Done?M:{...M,data:[...M.data,...O.data],state:c.Gu.Done},{data:[],state:c.Gu.NotStarted}),(0,r.d)())}},53478:(k,R,e)=>{"use strict";e.d(R,{Ex:()=>M,$i:()=>b});var t=e(65474),n=e(69862),i=e(43429),s=e(26657),r=e(72574),g=e(19347),a=e(74848),c=e(96540),o=e(14186),h=e(90182),f=e(98808),d=e(71680),p=e(1712),m=e(34263),v=e(18225),l=e(76658),y=e(66718),u=e(76942);const D=15;function E(){const O=(0,c.useRef)({}),I=(0,c.useCallback)(C=>{switch(C){case y.Tz.math:case y.Tz.reduce:case y.Tz.resample:case y.Tz.threshold:case y.Tz.sql:return O.current[C];case y.Tz.classic:return}},[]),T=(0,c.useCallback)((C,S)=>{switch(C){case y.Tz.math:O.current.math=S;break;case y.Tz.reduce:case y.Tz.resample:case y.Tz.resample:O.current.reduce=S,O.current.resample=S,O.current.threshold=S;break;case y.Tz.sql:O.current.sql=S}},[]);return{getCachedExpression:I,setCachedExpression:T}}function x(O){const{query:I,queries:T,onRunQuery:C,onChange:S}=O,{getCachedExpression:A,setCachedExpression:L}=E();(0,c.useEffect)(()=>{L(I.type,I.expression)},[I.expression,I.type,L]);const N=(0,c.useCallback)(B=>{const U=A(B.value),K=(0,u.r)({...I,type:B.value});S({...K,expression:U??K.expression})},[I,S,A]),F=()=>{const B=T.filter(U=>I.refId!==U.refId).map(U=>({value:U.refId,label:U.refId}));switch(I.type){case y.Tz.math:return(0,a.jsx)(d.z,{onChange:S,query:I,labelWidth:D,onRunQuery:C});case y.Tz.reduce:return(0,a.jsx)(p.Z,{refIds:B,onChange:S,labelWidth:D,query:I});case y.Tz.resample:return(0,a.jsx)(m.C,{query:I,labelWidth:D,onChange:S,refIds:B});case y.Tz.classic:return(0,a.jsx)(f.z,{onChange:S,query:I,refIds:B});case y.Tz.threshold:return(0,a.jsx)(l.O,{onChange:S,query:I,labelWidth:D,refIds:B});case y.Tz.sql:return(0,a.jsx)(v.k,{onChange:S,query:I,refIds:B})}},w=y.uQ.find(B=>B.value===I.type);return(0,a.jsxs)("div",{children:[(0,a.jsx)(o.I,{label:"Operation",labelWidth:D,children:(0,a.jsx)(h.l6,{options:y.uQ,value:w,onChange:N,width:25})}),F()]})}class P extends s.iy{constructor(I){super(I),this.instanceSettings=I}applyTemplateVariables(I,T){const C=(0,r.w)();return{...I,expression:C.replace(I.expression,T),window:C.replace(I.window,T)}}getCollapsedText(I){return`Expression: ${I.type}`}query(I){let T=I.targets.map(async S=>{const A=await(0,g.l)().get(S.datasource);return A.interpolateVariablesInQueries?A?.interpolateVariablesInQueries([S],I.scopedVars,I.filters)[0]:S});return(0,t.H)(Promise.all(T)).pipe((0,n.Z)(S=>super.query({...I,targets:S})))}newQuery(I){return{refId:"--",datasource:s.dR,type:I?.type??y.Tz.math,...I}}}const b={id:-100,uid:y.Uj,name:s.dR.name,type:s.dR.type,access:"proxy",meta:{baseUrl:"",module:"",type:i.QE.datasource,name:s.dR.type,id:s.dR.type,info:{author:{name:"Grafana Labs"},logos:{small:"public/img/icn-datasource.svg",large:"public/img/icn-datasource.svg"},description:"Adds expression support to Grafana",screenshots:[],links:[],updated:"",version:""}},jsonData:{},readOnly:!0},M=new P(b);M.meta={id:s.dR.type,info:{logos:{small:"public/img/icn-datasource.svg",large:"public/img/icn-datasource.svg"}}},M.components={QueryEditor:x}},98808:(k,R,e)=>{"use strict";e.d(R,{z:()=>D});var t=e(74848),n=e(39268),i=e(14186),s=e(55852),r=e(14578),g=e(76942),a=e(32196),c=e(40845),o=e(67061),h=e(9261),f=e(90182),d=e(10354),p=e(55907);const m=p.A.reducerTypes.map(E=>({label:E.text,value:E.value})),v=p.A.evalOperators.map(E=>({label:E.text,value:E.value})),l=p.A.evalFunctions.map(E=>({label:E.text,value:E.value})),y=({condition:E,index:x,onChange:P,onRemoveCondition:b,refIds:M})=>{const O=(0,c.of)(u),I=F=>{P({...E,operator:{type:F.value}})},T=F=>{P({...E,reducer:{type:F.value,params:[]}})},C=F=>{P({...E,query:{params:[F.value]}})},S=F=>{P({...E,evaluator:{params:E.evaluator.params,type:F.value}})},A=(F,w)=>{const B=parseFloat(F.currentTarget.value),U=[...E.evaluator.params];U[w]=B,P({...E,evaluator:{...E.evaluator,params:U}})},L=(0,a.css)`
    width: 60px;
  `,N=E.evaluator.type===p.p.IsWithinRange||E.evaluator.type===p.p.IsOutsideRange;return(0,t.jsxs)(o.B,{children:[(0,t.jsxs)("div",{style:{flex:1},children:[(0,t.jsxs)(n.C,{children:[x===0?(0,t.jsx)("div",{className:(0,a.cx)(O.button,L),children:"WHEN"}):(0,t.jsx)(h.f,{className:(0,a.cx)(O.buttonSelectText,L),options:v,onChange:I,value:v.find(F=>F.value===E.operator.type)}),(0,t.jsx)(f.l6,{options:m,onChange:T,width:20,value:m.find(F=>F.value===E.reducer.type)}),(0,t.jsx)("div",{className:O.button,children:"OF"}),(0,t.jsx)(f.l6,{onChange:C,options:M,width:"auto",value:M.find(F=>F.value===E.query.params[0])})]}),(0,t.jsxs)(n.C,{children:[(0,t.jsx)(h.f,{className:O.buttonSelectText,options:l,onChange:S,value:l.find(F=>F.value===E.evaluator.type)}),N?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.p,{type:"number",width:10,onChange:F=>A(F,0),value:E.evaluator.params[0]}),(0,t.jsx)("div",{className:O.button,children:"TO"}),(0,t.jsx)(d.p,{type:"number",width:10,onChange:F=>A(F,1),value:E.evaluator.params[1]})]}):E.evaluator.type!==p.p.HasNoValue?(0,t.jsx)(d.p,{type:"number",width:10,onChange:F=>A(F,0),value:E.evaluator.params[0]}):null]})]}),(0,t.jsx)(s.$n,{variant:"secondary",type:"button",onClick:()=>b(x),children:(0,t.jsx)(r.I,{name:"trash-alt"})})]})},u=E=>{const x=(0,a.css)`
    color: ${E.colors.primary.text};
    font-size: ${E.typography.bodySmall.fontSize};
  `;return{buttonSelectText:x,button:(0,a.cx)((0,a.css)`
        display: flex;
        align-items: center;
        border-radius: ${E.shape.radius.default};
        font-weight: ${E.typography.fontWeightMedium};
        border: 1px solid ${E.colors.border.weak};
        white-space: nowrap;
        padding: 0 ${E.spacing(1)};
        background-color: ${E.colors.background.canvas};
      `,x)}},D=({onChange:E,query:x,refIds:P})=>{const b=(I,T)=>{x.conditions&&E({...x,conditions:[...x.conditions.slice(0,T),I,...x.conditions.slice(T+1)]})},M=()=>{if(x.conditions){const I=x.conditions.at(-1)?.query?.params??[],T={...g.P,query:{params:I}};E({...x,conditions:x.conditions.length>0?[...x.conditions,T]:[T]})}},O=I=>{if(x.conditions){const T=x.conditions[I],C=x.conditions.filter(S=>S!==T).map((S,A)=>A===0?{...S,operator:{type:"when"}}:S);E({...x,conditions:C})}};return(0,t.jsxs)("div",{children:[(0,t.jsx)(n.C,{children:(0,t.jsx)(i.I,{label:"Conditions",labelWidth:14,children:(0,t.jsx)("div",{children:x.conditions?.map((I,T)=>{if(I)return(0,t.jsx)(y,{index:T,condition:I,onChange:C=>b(C,T),onRemoveCondition:O,refIds:P},T)})})})}),(0,t.jsx)(s.$n,{variant:"secondary",type:"button",onClick:M,children:(0,t.jsx)(r.I,{name:"plus-circle"})})]})}},71680:(k,R,e)=>{"use strict";e.d(R,{z:()=>f});var t=e(74848),n=e(32196),i=e(40845),s=e(67061),r=e(14186),g=e(76892),a=e(60782),c=e(14578),o=e(21744);const h="Math operations on one or more queries. You reference the query by ${refId} ie. $A, $B, $C etc\nThe sum of two scalar values: $A + $B > 10",f=({labelWidth:v,onChange:l,query:y,onRunQuery:u})=>{const D=P=>{l({...y,expression:P.target.value})},E=(0,i.of)(p),x=()=>{y.expression&&u()};return(0,t.jsx)(s.B,{children:(0,t.jsx)(r.I,{label:(0,t.jsx)(g.c,{width:"auto",children:(0,t.jsx)(a.G,{fitContent:!0,content:(0,t.jsxs)("div",{className:E.documentationContainer,children:[(0,t.jsxs)("div",{children:["Run math operations on one or more queries. You reference the query by ","${refId}"," ie. $A, $B, $C etc.",(0,t.jsx)("br",{}),"Example: ",(0,t.jsx)("code",{children:"$A + $B"})]}),(0,t.jsx)("header",{className:E.documentationHeader,children:"Available Math functions"}),(0,t.jsxs)("div",{className:E.documentationFunctions,children:[(0,t.jsx)(d,{name:"abs",description:"returns the absolute value of its argument which can be a number or a series"}),(0,t.jsx)(d,{name:"is_inf",description:"returns 1 for Inf values (negative or positive) and 0 for other values. It's able to operate on series or scalar values."}),(0,t.jsx)(d,{name:"is_nan",description:"returns 1 for NaN values and 0 for other values. It's able to operate on series or scalar values."}),(0,t.jsx)(d,{name:"is_null",description:"returns 1 for null values and 0 for other values. It's able to operate on series or scalar values."}),(0,t.jsx)(d,{name:"is_number",description:"returns 1 for all real number values and 0 for non-number. It's able to operate on series or scalar values."}),(0,t.jsx)(d,{name:"log",description:"returns the natural logarithm of its argument, which can be a number or a series"}),(0,t.jsx)(d,{name:"inf, infn, nan, and null",description:"The inf for infinity positive, infn for infinity negative, nan, and null functions all return a single scalar value that matches its name."}),(0,t.jsx)(d,{name:"round",description:"returns a rounded integer value. It's able to operate on series or escalar values."}),(0,t.jsx)(d,{name:"ceil",description:"rounds the number up to the nearest integer value. It's able to operate on series or escalar values."}),(0,t.jsx)(d,{name:"floor",description:"rounds the number down to the nearest integer value. It's able to operate on series or escalar values."})]})]}),title:(0,t.jsxs)(s.B,{gap:1,direction:"row",children:[(0,t.jsx)(c.I,{name:"book-open"})," Math operator"]}),footer:(0,t.jsxs)("div",{children:["See our additional documentation on"," ",(0,t.jsxs)("a",{className:E.documentationLink,target:"_blank",href:"https://grafana.com/docs/grafana/latest/panels/query-a-data-source/use-expressions-to-manipulate-data/about-expressions/#math",rel:"noreferrer",children:[(0,t.jsx)(c.I,{size:"xs",name:"external-link-alt"})," Math expressions"]}),"."]}),closeButton:!0,placement:"bottom-start",children:(0,t.jsxs)("div",{className:E.info,children:["Expression ",(0,t.jsx)(c.I,{name:"info-circle"})]})})}),labelWidth:v,grow:!0,shrink:!0,children:(0,t.jsx)(o.f,{value:y.expression,onChange:D,rows:1,placeholder:h,onBlur:x,style:{minWidth:250,lineHeight:"26px",minHeight:32}})})})},d=({name:v,description:l})=>{const y=(0,i.of)(m);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:y.name,children:v}),(0,t.jsx)("span",{className:y.description,children:l})]})},p=v=>({documentationHeader:(0,n.css)`
    font-size: ${v.typography.h5.fontSize};
    font-weight: ${v.typography.h5.fontWeight};
  `,documentationLink:(0,n.css)`
    color: ${v.colors.text.link};
  `,documentationContainer:(0,n.css)`
    display: flex;
    flex: 1;
    flex-direction: column;
    gap: ${v.spacing(2)};

    padding: ${v.spacing(1)} ${v.spacing(2)};
  `,documentationFunctions:(0,n.css)`
    display: grid;
    grid-template-columns: max-content auto;
    column-gap: ${v.spacing(2)};
  `,info:(0,n.css)`
    display: flex;
    flex-direction: row;
    align-items: center;
    cursor: pointer;
    gap: ${v.spacing(1)};
  `}),m=v=>({name:(0,n.css)`
    font-weight: ${v.typography.fontWeightBold};
  `,description:(0,n.css)`
    font-size: ${v.typography.bodySmall.fontSize};
    color: ${v.colors.text.disabled};
  `})},1712:(k,R,e)=>{"use strict";e.d(R,{Z:()=>a});var t=e(74848),n=e(14186),i=e(10354),s=e(39268),r=e(90182),g=e(66718);const a=({labelWidth:c="auto",onChange:o,refIds:h,query:f})=>{const d=g.Cu.find(E=>E.value===f.reducer),p=E=>{o({...f,expression:E.value})},m=E=>{o({...f,reducer:E.value})},v=E=>{o({...f,settings:E})},l=E=>{let x;switch(E.value){case g.Mt.ReplaceNonNumbers:let P=0;f.settings?.mode===g.Mt.ReplaceNonNumbers&&(P=f.settings?.replaceWithValue??0),x={mode:g.Mt.ReplaceNonNumbers,replaceWithValue:P};break;default:x={mode:E.value}}v(x)},y=E=>{const x=E.currentTarget.valueAsNumber;v({mode:g.Mt.ReplaceNonNumbers,replaceWithValue:x??0})},u=f.settings?.mode??g.Mt.Strict,D=()=>{if(u===g.Mt.ReplaceNonNumbers)return(0,t.jsx)(n.I,{label:"Replace With",labelWidth:c,children:(0,t.jsx)(i.p,{type:"number",width:10,onChange:y,value:f.settings?.replaceWithValue??0})})};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.C,{children:(0,t.jsx)(n.I,{label:"Input",labelWidth:c,children:(0,t.jsx)(r.l6,{onChange:p,options:h,value:f.expression,width:"auto"})})}),(0,t.jsxs)(s.C,{children:[(0,t.jsx)(n.I,{label:"Function",labelWidth:c,children:(0,t.jsx)(r.l6,{options:g.Cu,value:d,onChange:m,width:20})}),(0,t.jsx)(n.I,{label:"Mode",labelWidth:c,children:(0,t.jsx)(r.l6,{onChange:l,options:g.HZ,value:u,width:25})}),D()]})]})}},34263:(k,R,e)=>{"use strict";e.d(R,{C:()=>a});var t=e(74848),n=e(39268),i=e(14186),s=e(90182),r=e(10354),g=e(66718);const a=({labelWidth:c="auto",onChange:o,refIds:h,query:f})=>{const d=g.PN.find(u=>u.value===f.downsampler),p=g.iX.find(u=>u.value===f.upsampler),m=u=>{o({...f,window:u.target.value})},v=u=>{o({...f,expression:u.value})},l=u=>{o({...f,downsampler:u.value})},y=u=>{o({...f,upsampler:u.value})};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.C,{children:(0,t.jsx)(i.I,{label:"Input",labelWidth:c,children:(0,t.jsx)(s.l6,{onChange:v,options:h,value:f.expression,width:20})})}),(0,t.jsxs)(n.C,{children:[(0,t.jsx)(i.I,{label:"Resample to",labelWidth:c,tooltip:"10s, 1m, 30m, 1h",children:(0,t.jsx)(r.p,{onChange:m,value:f.window,width:15})}),(0,t.jsx)(i.I,{label:"Downsample",children:(0,t.jsx)(s.l6,{options:g.PN,value:d,onChange:l,width:25})}),(0,t.jsx)(i.I,{label:"Upsample",children:(0,t.jsx)(s.l6,{options:g.iX,value:p,onChange:y,width:25})})]})]})}},18225:(k,R,e)=>{"use strict";e.d(R,{k:()=>s});var t=e(74848),n=e(96540),i=e(6867);const s=({onChange:r,refIds:g,query:a})=>{const o=`select * from ${(0,n.useMemo)(()=>g.map(f=>f.value),[g])[0]} limit 1`,h=f=>{r({...a,expression:f})};return(0,t.jsx)(i.Y,{query:a.expression||o,onChange:h})}},76658:(k,R,e)=>{"use strict";e.d(R,{O:()=>I});var t=e(74848),n=e(32196),i=e(96540),s=e(46819),r=e(40845),g=e(39268),a=e(14186),c=e(90182),o=e(9261),h=e(10354),f=e(15292),d=e(2913),p=e(55907),m=e(66718),v=e(65307);const l=(0,v.VP)("thresold/updateRefId"),y=(0,v.VP)("thresold/updateThresholdType"),u=(0,v.VP)("thresold/updateThresholdParams"),D=(0,v.VP)("thresold/updateHysteresis"),E=(0,v.VP)("thresold/updateUnloadParams"),x=(0,v.vy)({type:m.Tz.threshold,refId:"",conditions:[]},S=>{S.addCase(l,(A,L)=>{A.expression=L.payload}),S.addCase(y,(A,L)=>{const N=L.payload.evalFunction,F=L.payload.onError;if(A.conditions[0].evaluator.type=N,!!A.conditions[0].unloadEvaluator){const B=P(A.conditions[0].evaluator.type);F&&F(void 0),A.conditions[0].evaluator.type=N;const U={type:B,params:A.conditions[0].evaluator?.params??[0,0]};A.conditions[0].unloadEvaluator=U}}),S.addCase(u,(A,L)=>{const{param:N,index:F}=L.payload;A.conditions[0].evaluator.params[F]=N}),S.addCase(D,(A,L)=>{const{hysteresisChecked:N,onError:F}=L.payload;N?A.conditions[0].unloadEvaluator={type:P(A.conditions[0].evaluator.type),params:A.conditions[0].evaluator?.params??[0,0]}:(A.conditions[0].unloadEvaluator=void 0,F&&F(void 0))}),S.addCase(E,(A,L)=>{const{param:N,index:F,onError:w}=L.payload;A.conditions[0].unloadEvaluator?A.conditions[0].unloadEvaluator.params[F]=N:A.conditions[0].unloadEvaluator={type:P(A.conditions[0].evaluator.type),params:A.conditions[0].evaluator?.params??[0,0]};const B=b(A.conditions[0]),{errorMsg:U,errorMsgFrom:K,errorMsgTo:V}=B??{};w&&w(U||K||V)})});function P(S){return S===p.p.IsAbove?p.p.IsBelow:S===p.p.IsBelow?p.p.IsAbove:S===p.p.IsWithinRange?p.p.IsOutsideRange:S===p.p.IsOutsideRange?p.p.IsWithinRange:p.p.IsBelow}function b(S){const{unloadEvaluator:A,evaluator:L}=S;if(!L)return;if(A?.params[0]===void 0||Number.isNaN(A?.params[0]))return{errorMsg:"This value cannot be empty"};const{type:N,params:F}=L,{params:w}=A;if(N===p.p.IsWithinRange||N===p.p.IsOutsideRange){if(w[0]===void 0||Number.isNaN(w[0]))return{errorMsgFrom:"This value cannot be empty"};if(w[1]===void 0||Number.isNaN(w[1]))return{errorMsgTo:"This value cannot be empty"}}const[B,U]=A.params,[K,V]=F;switch(N){case p.p.IsAbove:if(B>K)return{errorMsg:`Enter a number less than or equal to ${K}`};break;case p.p.IsBelow:if(B<K)return{errorMsg:`Enter a number more than or equal to ${K}`};break;case p.p.IsOutsideRange:if(B<K)return{errorMsgFrom:`Enter a number more than or equal to ${K}`};if(U>V)return{errorMsgTo:`Enter a number less than or equal to ${V}`};break;case p.p.IsWithinRange:if(B>K)return{errorMsgFrom:`Enter a number less than or equal to ${K}`};if(U<V)return{errorMsgTo:`Enter a number be more than or equal to ${V}`};break;default:throw new Error(`evaluator function type ${N} not supported.`)}}const M=p.p.IsAbove,O={type:"query",evaluator:{type:M,params:[0,0]},query:{params:[]},reducer:{params:[],type:"last"}},I=({labelWidth:S,onChange:A,refIds:L,query:N,onError:F,useHysteresis:w=!1})=>{const B=(0,r.of)(C),U={...N,conditions:N.conditions?.length?N.conditions:[O]},[K,V]=(0,i.useReducer)(x,U),H=K.conditions[0],Y=m.zd.find(ne=>ne.value===K.conditions[0].evaluator?.type),X=ne=>{V(l(ne.value))};(0,i.useEffect)(()=>{K&&A(K)},[K]);const J=ne=>{V(y({evalFunction:ne.value??M,onError:F}))},q=(ne,le)=>{V(u({param:parseFloat(ne.currentTarget.value),index:le}))},ae=H.evaluator.type===p.p.IsWithinRange||H.evaluator.type===p.p.IsOutsideRange,j=!!d.config.featureToggles?.recoveryThreshold&&w;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.C,{children:(0,t.jsx)(a.I,{label:"Input",labelWidth:S,children:(0,t.jsx)(c.l6,{onChange:X,options:L,value:N.expression,width:20})})}),(0,t.jsxs)(g.C,{children:[(0,t.jsx)(o.f,{className:B.buttonSelectText,options:m.zd,onChange:J,value:Y}),ae?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.p,{type:"number",width:10,onChange:ne=>q(ne,0),defaultValue:H.evaluator.params[0]}),(0,t.jsx)("div",{className:B.button,children:"TO"}),(0,t.jsx)(h.p,{type:"number",width:10,onChange:ne=>q(ne,1),defaultValue:H.evaluator.params[1]})]}):(0,t.jsx)(h.p,{type:"number",width:10,onChange:ne=>q(ne,0),defaultValue:H.evaluator.params[0]||0})]}),j&&(0,t.jsx)(te,{isRange:ae,onError:F})]});function te({isRange:ne,onError:le}){const z=!!H.unloadEvaluator,ee=Z=>{V(D({hysteresisChecked:Z.currentTarget.checked,onError:le})),se.current=!0},se=i.useRef(!0),ie=()=>{se.current=!1};return(0,t.jsxs)("div",{className:B.hysteresis,children:[(0,t.jsx)("div",{onMouseDown:ie,children:(0,t.jsx)(f.K,{showLabel:!0,label:"Custom recovery threshold",value:z,onChange:ee,className:B.switch})}),z&&(0,t.jsx)(T,{isRange:ne,condition:H,onError:le,dispatch:V,allowOnblur:se})]})}};function T({isRange:S,condition:A,onError:L,dispatch:N,allowOnblur:F}){const w=(0,r.of)(C),B=(J,q)=>{const ae=parseFloat(J.currentTarget.value);N(E({param:ae,index:q,onError:L}))},U=b(A),{errorMsg:K,errorMsgFrom:V,errorMsgTo:H}=U??{};if(S)return(0,t.jsx)(Y,{allowOnblur:F});return(0,t.jsx)(X,{allowOnblur:F});function Y({allowOnblur:J}){return A.evaluator.type===p.p.IsWithinRange?(0,t.jsx)(g.C,{className:w.hysteresis,children:(0,t.jsx)(a.I,{label:"Stop alerting when outside range",labelWidth:"auto",children:(0,t.jsxs)(s.B,{direction:"row",gap:0,children:[(0,t.jsx)("div",{className:w.range,children:(0,t.jsx)(a.I,{invalid:!!V,error:V,className:w.noMargin,children:(0,t.jsx)(h.p,{type:"number",width:10,onBlur:q=>J.current&&B(q,0),defaultValue:A.unloadEvaluator?.params[0]})})}),(0,t.jsx)("div",{className:w.button,children:"TO"}),(0,t.jsx)("div",{className:w.range,children:(0,t.jsx)(a.I,{invalid:!!H,error:H,children:(0,t.jsx)(h.p,{type:"number",width:10,onBlur:q=>J.current&&B(q,1),defaultValue:A.unloadEvaluator?.params[1]})})})]})})}):(0,t.jsx)(g.C,{className:w.hysteresis,children:(0,t.jsx)(a.I,{label:"Stop alerting when inside range",labelWidth:"auto",children:(0,t.jsxs)(s.B,{direction:"row",gap:0,children:[(0,t.jsx)("div",{className:w.range,children:(0,t.jsx)(a.I,{invalid:!!V,error:V,children:(0,t.jsx)(h.p,{type:"number",width:10,onBlur:q=>J.current&&B(q,0),defaultValue:A.unloadEvaluator?.params[0]})})}),(0,t.jsx)("div",{className:w.button,children:"TO"}),(0,t.jsx)("div",{className:w.range,children:(0,t.jsx)(a.I,{invalid:!!H,error:H,children:(0,t.jsx)(h.p,{type:"number",width:10,onBlur:q=>J.current&&B(q,1),defaultValue:A.unloadEvaluator?.params[1]})})})]})})})}function X({allowOnblur:J}){return A.evaluator.type===p.p.IsAbove?(0,t.jsx)(g.C,{className:w.hysteresis,children:(0,t.jsx)(a.I,{label:"Stop alerting when below",labelWidth:"auto",invalid:!!K,error:K,children:(0,t.jsx)(h.p,{type:"number",width:10,onBlur:q=>{J.current&&B(q,0)},defaultValue:A.unloadEvaluator?.params[0]})})}):(0,t.jsx)(g.C,{className:w.hysteresis,children:(0,t.jsx)(a.I,{label:"Stop alerting when above",labelWidth:"auto",invalid:!!K,error:K,children:(0,t.jsx)(h.p,{type:"number",width:10,onBlur:q=>{J.current&&B(q,0)},defaultValue:A.unloadEvaluator?.params[0]})})})}}const C=S=>({buttonSelectText:(0,n.css)({color:S.colors.primary.text,fontSize:S.typography.bodySmall.fontSize,textTransform:"uppercase",padding:`0 ${S.spacing(1)}`}),button:(0,n.css)({height:"32px",color:S.colors.primary.text,fontSize:S.typography.bodySmall.fontSize,textTransform:"uppercase",display:"flex",alignItems:"center",borderRadius:S.shape.radius.default,fontWeight:S.typography.fontWeightBold,border:`1px solid ${S.colors.border.medium}`,whiteSpace:"nowrap",padding:`0 ${S.spacing(1)}`,backgroundColor:S.colors.background.primary}),range:(0,n.css)({width:"min-content"}),hysteresis:(0,n.css)({marginTop:S.spacing(2)}),switch:(0,n.css)({paddingLeft:S.spacing(1)}),noMargin:(0,n.css)({margin:0})})},69437:(k,R,e)=>{"use strict";e.d(R,{f:()=>i});var t=e(26657),n=e(66718);const i=s=>{if(!s)return!1;if((0,t.s9)(s.datasource))return!0;const r=s;return typeof r.type!="string"?!1:Object.values(n.Tz).includes(r.type)}},66718:(k,R,e)=>{"use strict";e.d(R,{Cu:()=>c,HZ:()=>h,Mt:()=>o,NI:()=>g,PN:()=>f,Tz:()=>r,Uj:()=>s,iX:()=>d,uQ:()=>a,zd:()=>p});var t=e(75059),n=e(2913),i=e(55907);const s="__expr__";var r=(m=>(m.math="math",m.reduce="reduce",m.resample="resample",m.classic="classic_conditions",m.threshold="threshold",m.sql="sql",m))(r||{});const g=m=>{switch(m){case"math":return"Math";case"reduce":return"Reduce";case"resample":return"Resample";case"classic_conditions":return"Classic condition (legacy)";case"threshold":return"Threshold";case"sql":return"SQL"}},a=[{value:"math",label:"Math",description:"Free-form math formulas on time series or number data."},{value:"reduce",label:"Reduce",description:"Takes one or more time series returned from a query or an expression and turns each series into a single number."},{value:"resample",label:"Resample",description:"Changes the time stamps in each time series to have a consistent time interval."},{value:"classic_conditions",label:"Classic condition (legacy)",description:"Takes one or more time series returned from a query or an expression and checks if any of the series match the condition. Disables multi-dimensional alerts for this rule."},{value:"threshold",label:"Threshold",description:"Takes one or more time series returned from a query or an expression and checks if any of the series match the threshold condition."},{value:"sql",label:"SQL",description:"Transform data using SQL. Supports Aggregate/Analytics functions from DuckDB"}].filter(m=>m.value==="sql"?n.config.featureToggles?.sqlExpressions:!0),c=[{value:t.gy.min,label:"Min",description:"Get the minimum value"},{value:t.gy.max,label:"Max",description:"Get the maximum value"},{value:t.gy.mean,label:"Mean",description:"Get the average value"},{value:t.gy.median,label:"Median",description:"Get the median value"},{value:t.gy.sum,label:"Sum",description:"Get the sum of all values"},{value:t.gy.count,label:"Count",description:"Get the number of values"},{value:t.gy.last,label:"Last",description:"Get the last value"}];var o=(m=>(m.Strict="",m.ReplaceNonNumbers="replaceNN",m.DropNonNumbers="dropNN",m))(o||{});const h=[{value:"",label:"Strict",description:"Result can be NaN if series contains non-numeric data"},{value:"dropNN",label:"Drop Non-numeric Values",description:"Drop NaN, +/-Inf and null from input series before reducing"},{value:"replaceNN",label:"Replace Non-numeric Values",description:"Replace NaN, +/-Inf and null with a constant value before reducing"}],f=[{value:t.gy.last,label:"Last",description:"Fill with the last value"},{value:t.gy.min,label:"Min",description:"Fill with the minimum value"},{value:t.gy.max,label:"Max",description:"Fill with the maximum value"},{value:t.gy.mean,label:"Mean",description:"Fill with the average value"},{value:t.gy.sum,label:"Sum",description:"Fill with the sum of all values"}],d=[{value:"pad",label:"pad",description:"fill with the last known value"},{value:"backfilling",label:"backfilling",description:"fill with the next known value"},{value:"fillna",label:"fillna",description:"Fill with NaNs"}],p=[{value:i.p.IsAbove,label:"Is above"},{value:i.p.IsBelow,label:"Is below"},{value:i.p.IsWithinRange,label:"Is within range"},{value:i.p.IsOutsideRange,label:"Is outside range"}]},76942:(k,R,e)=>{"use strict";e.d(R,{P:()=>r,r:()=>s});var t=e(75059),n=e(55907),i=e(66718);const s=g=>{switch(g.type){case i.Tz.reduce:g.reducer||(g.reducer=t.gy.mean);break;case i.Tz.resample:g.downsampler||(g.downsampler=t.gy.mean),g.upsampler||(g.upsampler="fillna"),g.reducer=void 0;break;case i.Tz.math:g.expression=void 0;break;case i.Tz.classic:g.conditions||(g.conditions=[r]);break;default:g.reducer=void 0}return g},r={type:"query",reducer:{params:[],type:"avg"},operator:{type:"and"},query:{params:[]},evaluator:{params:[0,0],type:n.p.IsAbove}}},71101:(k,R,e)=>{"use strict";e.d(R,{Cg:()=>a,Fk:()=>o,R4:()=>d,Rj:()=>g,pq:()=>c});var t=e(32264),n=e(8484),i=e(16233),s=e(36689),r=e(31678);const g="manage-folder",a=m=>`folder-dashboards-${m}`,c=m=>`folder-library-panels-${m}`,o=m=>`folder-alerting-${m}`,h=m=>`folder-permissions-${m}`,f=m=>`folder-settings-${m}`;function d(m,v=m.parents){const l={icon:"folder",id:g,subTitle:(0,s.o)("manage-folder"),url:m.url,text:m.title,children:[{active:!1,icon:"apps",id:a(m.uid),text:(0,n.t)("browse-dashboards.manage-folder-nav.dashboards","Dashboards"),url:m.url}]};if(v&&v.length>0){const y=v[v.length-1],u=v.slice(0,v.length-1);l.parentItem=d(y,u)}return l.children.push({active:!1,icon:"library-panel",id:c(m.uid),text:(0,n.t)("browse-dashboards.manage-folder-nav.panels","Panels"),url:`${m.url}/library-panels`}),i.TP.hasPermission(r.AccessControlAction.AlertingRuleRead)&&t.$.unifiedAlertingEnabled&&l.children.push({active:!1,icon:"bell",id:o(m.uid),text:(0,n.t)("browse-dashboards.manage-folder-nav.alert-rules","Alert rules"),url:`${m.url}/alerting`}),l}function p(m){const v=d({created:"",createdBy:"",hasAcl:!1,updated:"",updatedBy:"",id:1,uid:"loading",title:"Loading",url:"url",canSave:!0,canEdit:!0,canAdmin:!0,canDelete:!0,version:0});return v.children[m].active=!0,{main:v,node:v.children[m]}}},54650:(k,R,e)=>{"use strict";e.d(R,{Ay:()=>o,jl:()=>g});var t=e(65307),n=e(55314);const i={id:0,uid:"loading",title:"loading",url:"",canSave:!1,canDelete:!1,hasChanged:!1,version:1},s=(h,f)=>({...h,...f.payload,hasChanged:!1}),r=(0,t.Z0)({name:"folder",initialState:i,reducers:{loadFolder:s,setFolderTitle:(h,f)=>({...h,title:f.payload,hasChanged:f.payload.trim().length>0})},extraReducers:h=>{h.addMatcher(n.vZ.getFolder.matchFulfilled,s)}}),{loadFolder:g,setFolderTitle:a}=r.actions,o={folder:r.reducer}},84350:(k,R,e)=>{"use strict";e.d(R,{G:()=>o});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(90182),g=e(42418),a=e(67140);const c=[{label:"Countries",description:"Lookup countries by name, two letter code, or three letter code",value:a.fx},{label:"USA States",description:"Lookup states by name or 2 ",value:"public/gazetteer/usa-states.json"},{label:"Airports",description:"Lookup airports by id or code",value:"public/gazetteer/airports.geojson"}],o=({value:f,onChange:d,context:p,item:m})=>{const v=(0,s.of)(h),[l,y]=(0,i.useState)(),u=m.settings;(0,i.useEffect)(()=>{async function x(){const P=await(0,a.q3)(f);y(P)}x()},[f,y]);const{current:D,options:E}=(0,i.useMemo)(()=>{let x=u?.options?[...u.options]:[...c],P=x?.find(b=>b.value===l?.path);return!P&&l&&(P={label:l.path,value:l.path},x.push(P)),{options:x,current:P}},[l,u?.options]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.l6,{value:D,options:E,onChange:x=>d(x.value),allowCustomValue:!0,formatCreateLabel:x=>`Load from URL: ${x}`}),l&&(0,t.jsxs)(t.Fragment,{children:[l.error&&(0,t.jsx)(g.F,{title:l.error,severity:"warning"}),l.count&&(0,t.jsxs)("div",{className:v.keys,children:[(0,t.jsxs)("b",{children:["(",l.count,")"]}),l.examples(10).map(x=>(0,t.jsxs)("span",{children:[x,","]},x)),l.count>10&&" ..."]})]})]})},h=()=>({keys:(0,n.css)`
    margin-top: 4px;
    text-overflow: ellipsis;
    overflow: hidden;
    white-space: nowrap;

    > span {
      margin-left: 4px;
    }
  `})},61983:(k,R,e)=>{"use strict";e.d(R,{G:()=>u});var t=e(11261),n=e(52622),i=e(84350),s=e(74848),r=e(32196),g=e(96540),a=e(13544),c=e(40845),o=e(42418),h=e(14578),f=e(90182),d=e(66864),p=e(31484);const m=[{value:n.aG.Auto,label:"Auto",ariaLabel:a.Tp.components.Transforms.SpatialOperations.location.autoOption,description:"Automatically identify location data based on default field names"},{value:n.aG.Coords,label:"Coords",ariaLabel:a.Tp.components.Transforms.SpatialOperations.location.coords.option,description:"Specify latitude and longitude fields"},{value:n.aG.Geohash,label:"Geohash",ariaLabel:a.Tp.components.Transforms.SpatialOperations.location.geohash.option,description:"Specify geohash field"},{value:n.aG.Lookup,label:"Lookup",ariaLabel:a.Tp.components.Transforms.SpatialOperations.location.lookup.option,description:"Specify Gazetteer and lookup field"}],v="https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/geomap/#location",l=({value:D,onChange:E,context:x,item:P})=>{const[b,M]=(0,g.useState)();(0,g.useEffect)(()=>{P.settings?.source&&P.settings?.data?.length&&P.settings.data[0]&&(0,p.nE)(P.settings.source).then(T=>{P.settings&&P.settings.data&&M((0,p.FM)(P.settings.data[0],T))})},[P.settings]);const O=(0,c.of)(y),I=()=>{if(b){if(b.warning)return(0,s.jsx)(o.F,{title:b.warning,severity:"warning",buttonContent:(0,s.jsx)(h.I,{name:"question-circle",size:"xl"}),className:O.alert,onRemove:()=>{const T=window.open(v,"_blank","noopener,noreferrer");T&&(T.opener=null)}});if(D===n.aG.Auto&&b.description)return(0,s.jsx)("span",{children:b.description})}return null};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(f.l6,{options:m,value:D,onChange:T=>{E(T.value)}}),(0,s.jsx)(d.Gy,{className:O.hGroup,children:I()})]})},y=D=>({alert:(0,r.css)`
      & div {
        padding: 4px;
      }
      margin-bottom: 0px;
      margin-top: 5px;
      padding: 2px;
    `,hGroup:(0,r.css)`
      & div {
        width: 100%;
      }
    `});function u(D,E,x,P,b){switch(x.addCustomEditor({id:"modeEditor",path:`${E}mode`,name:"Location Mode",editor:l,settings:{data:b,source:P}}),P?.mode){case n.aG.Coords:x.addFieldNamePicker({path:`${E}latitude`,name:"Latitude field",settings:{filter:M=>M.type===t.PU.number,noFieldsMessage:"No numeric fields found"}}).addFieldNamePicker({path:`${E}longitude`,name:"Longitude field",settings:{filter:M=>M.type===t.PU.number,noFieldsMessage:"No numeric fields found"}});break;case n.aG.Geohash:x.addFieldNamePicker({path:`${E}geohash`,name:"Geohash field",settings:{filter:M=>M.type===t.PU.string,noFieldsMessage:"No strings fields found"}});break;case n.aG.Lookup:x.addFieldNamePicker({path:`${E}lookup`,name:"Lookup field",settings:{filter:M=>M.type===t.PU.string,noFieldsMessage:"No strings fields found"}}).addCustomEditor({id:"gazetteer",path:`${E}gazetteer`,name:"Gazetteer",editor:i.G})}}},96606:(k,R,e)=>{"use strict";e.d(R,{RA:()=>d,XR:()=>p,Dc:()=>f,qy:()=>o,Pz:()=>h});var t=e(44294),n=e(34338),i=e(11217),s=e(22796),r=e(11261),g=e(78134);function a(v){if(!v?.length)return;const l=[16,8,4,2,1],y="0123456789bcdefghjkmnpqrstuvwxyz";let u=!0;const D=[],E=[];D[0]=-90,D[1]=90,E[0]=-180,E[1]=180;let x;v.split("").forEach(M=>{x=y.indexOf(M),l.forEach(O=>{c(u?E:D,x,O),u=!u})});const P=(D[0]+D[1])/2;return[(E[0]+E[1])/2,P]}function c(v,l,y){l&y?v[0]=(v[0]+v[1])/2:v[1]=(v[0]+v[1])/2}function o(v){return{name:v.name??"Point",type:r.PU.geo,values:v.values.map(l=>{const y=a(l);if(y)return new t.A((0,s.Rb)(y))}),config:m}}function h(v,l){const y=new Array(v.values.length);for(let u=0;u<v.values.length;u++){const D=v.values[u],E=l.values[u];D===null||E===null||(y[u]=new t.A((0,s.Rb)([D,E])))}return{name:"Point",type:r.PU.geo,values:y,config:m}}function f(v,l){const y=l.values.length,u=new Array(y);for(let D=0;D<y;D++)u[D]=v.find(l.values[D])?.geometry();return{name:"Geometry",type:r.PU.geo,values:u,config:m}}function d(v,l){const y=v.values,u=l.values;if(!y||!u)throw"missing src/dest";if(y.length!==u.length)throw"Source and destination field lengths do not match";const D=v.values.length,E=new Array(D);for(let x=0;x<D;x++){const P=y[x],b=u[x];P&&b?E[x]=new n.A([P,b]):P?E[x]=P:b&&(E[x]=b)}return{name:"Geometry",type:r.PU.geo,values:E,config:m}}function p(v,l){const y=v.values,u=l.values;if(!y||!u)throw"missing src/dest";if(y.length!==u.length)throw"Source and destination field lengths do not match";const D=v.values.length,E=new Array(D);for(let x=0;x<D;x++){const P=y[x],b=u[x];P&&b&&(E[x]=new i.A([(0,g.EX)(P),(0,g.EX)(b)]))}return{name:"Geometry",type:r.PU.geo,values:E,config:m}}const m=Object.freeze({custom:{hideFrom:{tooltip:!0}}})},67140:(k,R,e)=>{"use strict";e.d(R,{fx:()=>v,q3:()=>l});var t=e(70915),n=e(44294),i=e(14236),s=e(11261),r=e(17172),g=e(11365);function a(y){const u=new g.A().readFeatures(y,{featureProjection:"EPSG:3857"}),D=u.length,E=new Array(D).fill(null),x=[],P=new Map,b=T=>{let C=P.get(T);return C||(C={types:new Set,values:new Array(D).fill(null),count:0},x.push(T),P.set(T,C)),C},M=(...T)=>{for(const C of T)if(!P.has(C))return C;return"___"+T[0]},O={types:new Set,values:new Array(D).fill(null),count:0};for(let T=0;T<D;T++){const C=u[T];E[T]=C.getGeometry();const S=C.getId();S!=null&&(O.values[T]=S,O.types.add((0,i.oE)(S)),O.count++);for(const A of C.getKeys()){const L=C.get(A);if(L===E[T]||L==null)continue;const N=b(A);N.values[T]=L,N.types.add((0,i.oE)(L)),N.count++}}const I=[];if(O.count>0){const T=c(O);I.push({name:M("id","_id","__id"),type:T,values:O.values,config:{}})}I.push({name:M("geo","geometry"),type:s.PU.geo,values:E,config:{}});for(const T of x){const C=P.get(T);if(!C)continue;const S=c(C);I.push({name:T,type:S,values:C.values,config:{}})}return{fields:I,length:D}}function c(y){return y.count<1?s.PU.other:y.types.size>1?(y.values=y.values.map(u=>u!=null?`${u}`:u),s.PU.string):y.types.values().next().value}var o=e(96606),h=e(22796);function f(y,u){let D=0;const E=new Map;for(const x of u){const P=new n.A((0,h.Rb)([x.longitude,x.latitude])),b={point:()=>P,geometry:()=>P};if(x.name&&(E.set(x.name,b),E.set(x.name.toUpperCase(),b)),x.key&&(E.set(x.key,b),E.set(x.key.toUpperCase(),b)),x.keys)for(const M of x.keys)E.set(M,b),E.set(M.toUpperCase(),b);D++}return{path:y,find:x=>{let P=E.get(x);return!P&&typeof x=="string"&&(P=E.get(x.toUpperCase())),P},count:D,examples:x=>{const P=[];if(E.size<1)P.push("no values found");else for(const b of E.keys())if(P.push(b),P.length>=x)break;return P}}}function d(y,u){let D;if(Array.isArray(u)){const E=u[0];if(E.latitude&&E.longitude&&(E.key||E.keys))return f(y,u)}else Array.isArray(u?.features)&&u?.type==="FeatureCollection"&&(D=a(u));if(!D)try{D=(0,i.Vc)(u)}catch(E){return{path:y,error:`${E}`,find:x=>{},examples:x=>[]}}return p(D,{path:y})}function p(y,u){const D=[];let E,x,P,b,M;for(const T of y.fields)if(T.type===s.PU.geo&&(E=T),!M&&T.type===s.PU.string&&(M=T),T.name){u.keys&&u.keys.includes(T.name)&&D.push(T);const C=T.name.toUpperCase();switch(C){case"LAT":case"LATITUTE":x=T;break;case"LON":case"LNG":case"LONG":case"LONGITUE":P=T;break;case"GEOHASH":b=T;break;case"ID":case"UID":case"KEY":case"CODE":u.keys||D.push(T);break;default:u.keys||(C.endsWith("_ID")||C.endsWith("_CODE"))&&D.push(T)}}!D.length&&M&&D.push(M);let O=!1;E?O=E.values[0]?.getType()==="Point":b?(E=(0,o.qy)(b),O=!0):x&&P&&(E=(0,o.Pz)(P,x),O=!0);const I=new Map;return D.forEach(T=>{T.values.forEach((C,S)=>{const A=`${C}`;I.set(A.toUpperCase(),S),I.set(A,S)})}),{path:u.path,find:T=>{const C=I.get(T);if(C!=null){const S=E?.values[C];return{frame:y,index:C,point:()=>!S||O?S:new n.A((0,t.q1)(S.getExtent())),geometry:()=>S}}},examples:T=>{const C=[];for(let S of I.keys())if(C.push(S),C.length>T)break;return C},frame:()=>y,count:y.length}}const m={},v="public/gazetteer/countries.json";async function l(y){y||(y=v);let u=m[y];if(!u){try{const D=await(0,r.AI)().get(y);u=d(y,D)}catch(D){console.warn("Error loading placename lookup",y,D),u={path:y,error:"Error loading URL",find:E=>{},examples:E=>[]}}m[y]=u}return u}},31484:(k,R,e)=>{"use strict";e.d(R,{FM:()=>p,nE:()=>f});var t=e(28240),n=e(11261),i=e(85200),s=e(1173),r=e(52622),g=e(96606),a=e(67140);function c(m){return v=>{for(const l of v.fields)if(m(l,v,[]))return l}}function o(m){return v=>{for(const l of v.fields){if(m.has(l.name.toLowerCase()))return l;const y=(0,t.Ct)(l,v);if(m.has(y))return l}}}const h={mode:r.aG.Auto,geohash:o(new Set(["geohash"])),latitude:o(new Set(["latitude","lat"])),longitude:o(new Set(["longitude","lon","lng"])),h3:o(new Set(["h3"])),wkt:o(new Set(["wkt"])),lookup:o(new Set(["lookup"])),geo:m=>m.fields.find(v=>v.type===n.PU.geo)};async function f(m){const v={...h,mode:m?.mode??r.aG.Auto};switch(v.gazetteer=await(0,a.q3)(m?.gazetteer),v.mode){case r.aG.Geohash:m?.geohash?v.geohash=c((0,i.NS)({id:s.Ct.byName,options:m.geohash})):v.geohash=()=>{};break;case r.aG.Lookup:const l=m?.lookup?.length?(0,i.NS)({id:s.Ct.byName,options:m.lookup}):(0,i.NS)({id:s.Ct.byType,options:n.PU.string});v.lookup=c(l);break;case r.aG.Coords:m?.latitude?v.latitude=c((0,i.NS)({id:s.Ct.byName,options:m.latitude})):v.latitude=()=>{},m?.longitude?v.longitude=c((0,i.NS)({id:s.Ct.byName,options:m.longitude})):v.longitude=()=>{};break}return v}function d(m,v){const l={mode:v.mode??r.aG.Auto};if(l.mode===r.aG.Auto){if(l.geo=v.geo(m),l.geo)return l;if(l.latitude=v.latitude(m),l.longitude=v.longitude(m),l.latitude&&l.longitude)return l.mode=r.aG.Coords,l;if(l.geohash=v.geohash(m),l.geohash)return l.mode=r.aG.Geohash,l;if(l.lookup=v.lookup(m),l.lookup)return l.mode=r.aG.Lookup,l}switch(l.mode){case r.aG.Coords:l.latitude=v.latitude(m),l.longitude=v.longitude(m);break;case r.aG.Geohash:l.geohash=v.geohash(m);break;case r.aG.Lookup:l.lookup=v.lookup(m);break}return l}function p(m,v){const l=d(m,v);switch(l.mode){case r.aG.Auto:return l.geo?{field:l.geo}:{warning:"Unable to find location fields"};case r.aG.Coords:return l.latitude&&l.longitude?{field:(0,g.Pz)(l.longitude,l.latitude),derived:!0,description:`${l.mode}: ${l.latitude.name}, ${l.longitude.name}`}:{warning:"Select latitude/longitude fields"};case r.aG.Geohash:return l.geohash?{field:(0,g.qy)(l.geohash),derived:!0,description:`${l.mode}`}:{warning:"Select geohash field"};case r.aG.Lookup:return l.lookup?v.gazetteer?{field:(0,g.Dc)(v.gazetteer,l.lookup),derived:!0,description:`${l.mode}: ${v.gazetteer.path}`}:{warning:"Gazetteer not found"}:{warning:"Select lookup field"}}return{warning:"unable to find geometry"}}},61453:(k,R,e)=>{"use strict";e.d(R,{q:()=>A});var t=e(74848),n=e(2543),i=e(96540),s=e(70713),r=e(18282),g=e(2514),a=e(90708),c=e(13544),o=e(14110),h=e(72574),f=e(55852),d=e(62930),p=e(77093),m=e(2913),v=e(8484),l=e(69147),y=e(28240),u=e(40845),D=e(66864),E=e(88575),x=e(90182),P=e(15292),b=e(7788),M=e(32196);const O=N=>(0,M.css)`
  padding: ${N.spacing(0,2)};
  font-size: ${N.typography.bodySmall.fontSize};
  color: ${N.colors.text.secondary};
  overflow: hidden;
  text-overflow: ellipsis;
`,I=({children:N})=>{const F=(0,u.of)(O);return(0,t.jsx)("div",{className:F,children:N})};var T=e(26323);const C=({options:N,actions:F,formattedDataDescription:w,onOptionsChange:B,hasTransformations:U,data:K,dataFrames:V,transformationOptions:H,selectedDataFrame:Y,onDataFrameChange:X,downloadForExcel:J,toggleDownloadForExcel:q})=>{const ae=(0,u.of)(T.A);let j=V;Y===r.F.joinByField&&(j=K);const te=j.map((z,ee)=>({value:ee,label:`${(0,y.Ri)(z)} (${ee})`})),ne=[...H,...te];function le(){let z="";if(!K)return z;const ee=[];return Y===r.F.joinByField?ee.push((0,v.t)("dashboard.inspect-data.series-to-columns","Series joined by time")):K.length>1&&ee.push((0,y.Ri)(K[Y])),(N.withTransforms||N.withFieldConfig)&&(N.withTransforms&&ee.push((0,v.t)("dashboard.inspect-data.panel-transforms","Panel transforms")),N.withTransforms&&N.withFieldConfig,N.withFieldConfig&&ee.push((0,v.t)("dashboard.inspect-data.formatted","Formatted data"))),J&&ee.push((0,v.t)("dashboard.inspect-data.excel-header","Excel header")),ee.join(", ")}return(0,t.jsx)("div",{className:ae.dataDisplayOptions,children:(0,t.jsx)(b.u,{id:"Data options",index:0,title:(0,v.t)("dashboard.inspect-data.data-options","Data options"),headerElement:(0,t.jsx)(I,{children:le()}),isOpen:!1,actions:F,children:(0,t.jsx)("div",{className:ae.options,"data-testid":"dataOptions",children:(0,t.jsxs)(D.gW,{spacing:"none",children:[K.length>1&&(0,t.jsx)(E.D,{label:(0,v.t)("dashboard.inspect-data.dataframe-label","Show data frame"),children:(0,t.jsx)(x.l6,{options:ne,value:Y,onChange:X,width:30,"aria-label":(0,v.t)("dashboard.inspect-data.dataframe-aria-label","Select dataframe")})}),(0,t.jsxs)(D.Gy,{children:[U&&B&&(0,t.jsx)(E.D,{label:(0,v.t)("dashboard.inspect-data.transformations-label","Apply panel transformations"),description:(0,v.t)("dashboard.inspect-data.transformations-description","Table data is displayed with transformations defined in the panel Transform tab."),children:(0,t.jsx)(P.d,{value:!!N.withTransforms,onChange:()=>B({...N,withTransforms:!N.withTransforms})})}),B&&(0,t.jsx)(E.D,{label:(0,v.t)("dashboard.inspect-data.formatted-data-label","Formatted data"),description:w||(0,v.t)("dashboard.inspect-data.formatted-data-description","Table data is formatted with options defined in the Field and Override tabs."),children:(0,t.jsx)(P.d,{id:"formatted-data-toggle",value:!!N.withFieldConfig,onChange:()=>B({...N,withFieldConfig:!N.withFieldConfig})})}),(0,t.jsx)(E.D,{label:(0,v.t)("dashboard.inspect-data.download-excel-label","Download for Excel"),description:(0,v.t)("dashboard.inspect-data.download-excel-description","Adds header to CSV for use with Excel"),children:(0,t.jsx)(P.d,{id:"excel-toggle",value:J,onChange:q})})]})]})})})})};var S=e(18358);class A extends i.PureComponent{constructor(F){super(F),this.onExportLogsAsTxt=()=>{const{data:w,dataName:B,app:U}=this.props;(0,o.rR)("grafana_logs_download_logs_clicked",{app:U,format:"logs",area:"inspector"});const K=(0,l.HT)(w||[]);(0,S.Zy)(K,B)},this.onExportTracesAsJson=()=>{const{data:w,dataName:B,app:U}=this.props;if(w)for(const K of w){if(K.meta?.preferredVisualisationType!=="trace")continue;const V=(0,S.ek)(K,B+"-traces");(0,o.rR)("grafana_traces_download_traces_clicked",{app:U,grafana_version:m.config.buildInfo.version,trace_format:V,location:"inspector"})}},this.onExportServiceGraph=()=>{const{data:w,dataName:B,app:U}=this.props;(0,o.rR)("grafana_traces_download_service_graph_clicked",{app:U,grafana_version:m.config.buildInfo.version,location:"inspector"}),w&&(0,S.ny)(w,B)},this.onDataFrameChange=w=>{this.setState({transformId:w.value===r.F.joinByField?r.F.joinByField:r.F.noop,dataFrameIndex:typeof w.value=="number"?w.value:0,selectedDataFrame:w.value})},this.onToggleDownloadForExcel=()=>{this.setState(w=>({downloadForExcel:!w.downloadForExcel}))},this.state={selectedDataFrame:0,dataFrameIndex:0,transformId:r.F.noop,transformationOptions:L(),transformedData:F.data??[],downloadForExcel:!1}}componentDidUpdate(F,w){if(!this.props.data){this.setState({transformedData:[]});return}if(this.props.options.withTransforms){this.setState({transformedData:this.props.data});return}if(F.data!==this.props.data||w.transformId!==this.state.transformId){const B=this.state.transformationOptions.find(U=>U.value===this.state.transformId);if(B&&B.transformer.id!==r.F.noop){const U=this.state.selectedDataFrame,K=this.state.dataFrameIndex,V=(0,g.m)([B.transformer],this.props.data).subscribe(H=>{this.setState({transformedData:H,selectedDataFrame:U,dataFrameIndex:K},()=>V.unsubscribe())});return}this.setState({transformedData:this.props.data});return}}exportCsv(F,w){const{dataName:B}=this.props,{transformId:U}=this.state,K=F[this.state.dataFrameIndex];w&&(0,o.rR)("grafana_logs_download_clicked",{app:this.props.app,format:"csv"}),(0,S.EM)(K,B,{useExcelHeader:this.state.downloadForExcel},U)}getProcessedData(){const{options:F,panelPluginId:w,fieldConfig:B,timeZone:U}=this.props,K=this.state.transformedData;if(!F.withFieldConfig)return(0,a.K3)(K);let V=B??{defaults:{},overrides:[]};return w==="table"&&B&&(V=this.cleanTableConfigFromFieldConfig(B)),(0,a.we)({data:K,theme:m.config.theme2,fieldConfig:V,timeZone:U,replaceVariables:(H,Y,X)=>(0,h.w)().replace(H,Y,X)})}cleanTableConfigFromFieldConfig(F){F=(0,n.cloneDeep)(F),F.defaults.custom={};for(const w of F.overrides)for(const B of w.properties)if(B.id.startsWith("custom.")){const U=w.properties.indexOf(B);w.properties.slice(U,1)}return F}renderActions(F,w,B,U){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(f.$n,{variant:"primary",onClick:()=>this.exportCsv(F,w),size:"sm",children:(0,t.jsx)(v.x6,{i18nKey:"dashboard.inspect-data.download-csv",children:"Download CSV"})}),w&&(0,t.jsx)(f.$n,{variant:"primary",onClick:this.onExportLogsAsTxt,size:"sm",children:(0,t.jsx)(v.x6,{i18nKey:"dashboard.inspect-data.download-logs",children:"Download logs"})}),B&&(0,t.jsx)(f.$n,{variant:"primary",onClick:this.onExportTracesAsJson,size:"sm",children:(0,t.jsx)(v.x6,{i18nKey:"dashboard.inspect-data.download-traces",children:"Download traces"})}),U&&(0,t.jsx)(f.$n,{variant:"primary",onClick:this.onExportServiceGraph,size:"sm",children:(0,t.jsx)(v.x6,{i18nKey:"dashboard.inspect-data.download-service",children:"Download service graph"})})]})}render(){const{isLoading:F,options:w,data:B,formattedDataDescription:U,onOptionsChange:K,hasTransformations:V}=this.props,{dataFrameIndex:H,transformationOptions:Y,selectedDataFrame:X,downloadForExcel:J}=this.state,q=(0,T.c)();if(F)return(0,t.jsxs)("div",{children:[(0,t.jsx)(d.y,{inline:!0})," Loading"]});const ae=this.getProcessedData();if(!ae||!ae.length)return(0,t.jsx)("div",{children:"No Data"});const j=ae[H]?H:0,te=ae[j],ne=ae.some(ee=>ee?.meta?.preferredVisualisationType==="logs"),le=ae.some(ee=>ee?.meta?.preferredVisualisationType==="trace"),z=ae.some(ee=>ee?.meta?.preferredVisualisationType==="nodeGraph");return(0,t.jsxs)("div",{className:q.wrap,"aria-label":c.Tp.components.PanelInspector.Data.content,children:[(0,t.jsx)("div",{className:q.toolbar,children:(0,t.jsx)(C,{data:B,hasTransformations:V,options:w,dataFrames:ae,transformationOptions:Y,selectedDataFrame:X,downloadForExcel:J,formattedDataDescription:U,onOptionsChange:K,onDataFrameChange:this.onDataFrameChange,toggleDownloadForExcel:this.onToggleDownloadForExcel,actions:this.renderActions(ae,ne,le,z)})}),(0,t.jsx)("div",{className:q.content,children:(0,t.jsx)(s.Ay,{children:({width:ee,height:se})=>ee===0?null:(0,t.jsx)(p.X,{width:ee,height:se,data:te,showTypeIcons:!0})})})]})}}function L(){return[{value:r.F.joinByField,label:(0,v.t)("dashboard.inspect-data.transformation","Series joined by time"),transformer:{id:r.F.joinByField,options:{byField:void 0}}}]}},32067:(k,R,e)=>{"use strict";e.d(R,{N:()=>m});var t=e(74848),n=e(32196),i=e(13544),s=e(8484),r=e(57875),g=e(11261),a=e(83195),c=e(40845);const o=({timeZone:l,name:y,stats:u})=>{const D=(0,c.$j)(),E=(0,c.of)(f);return!u||!u.length?null:(0,t.jsxs)("div",{className:E.wrapper,children:[(0,t.jsx)("div",{className:E.heading,children:y}),(0,t.jsx)("table",{className:"filter-table width-30",children:(0,t.jsx)("tbody",{children:u.map((x,P)=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:x.displayName}),(0,t.jsx)("td",{className:E.cell,children:h(x,l,D)})]},`${x.displayName}-${P}`))})})]})};function h(l,y,u){const D=(0,r.J)({field:{type:g.PU.number,config:l},theme:u,timeZone:y});return(0,a.cN)(D(l.value))}const f=l=>({heading:(0,n.css)({fontSize:l.typography.body.fontSize,marginBottom:l.spacing(1)}),wrapper:(0,n.css)({paddingBottom:l.spacing(2)}),cell:(0,n.css)({textAlign:"right"})}),d=({name:l,traceIds:y})=>{const u=(0,c.of)(p);return y.length===0?null:(0,t.jsxs)("div",{className:u.wrapper,children:[(0,t.jsx)("div",{className:u.heading,children:l}),(0,t.jsx)("table",{className:"filter-table width-30",children:(0,t.jsx)("tbody",{children:y.map((D,E)=>(0,t.jsx)("tr",{children:(0,t.jsx)("td",{children:D})},`${D}-${E}`))})})]})},p=l=>({heading:(0,n.css)({fontSize:l.typography.body.fontSize,marginBottom:l.spacing(1)}),wrapper:(0,n.css)({paddingBottom:l.spacing(2)}),cell:(0,n.css)({textAlign:"right"})}),m=({data:l,timeZone:y})=>{if(!l.request)return null;let u=[];const D=l.request.endTime?l.request.endTime-l.request.startTime:-1,E=l.timings?.dataProcessingTime||-1;let x=0;for(const I of l.series)x+=I.length;D>0&&u.push({displayName:(0,s.t)("dashboard.inspect-stats.request-time","Total request time"),value:D,unit:"ms"}),E>0&&u.push({displayName:(0,s.t)("dashboard.inspect-stats.processing-time","Data processing time"),value:E,unit:"ms"}),u.push({displayName:(0,s.t)("dashboard.inspect-stats.queries","Number of queries"),value:l.request.targets?.length??0}),u.push({displayName:(0,s.t)("dashboard.inspect-stats.rows","Total number rows"),value:x});let P=[];for(const I of l.series)I.meta&&I.meta.stats&&(P=P.concat(I.meta.stats));const b=(0,s.t)("dashboard.inspect-stats.table-title","Stats"),M=(0,s.t)("dashboard.inspect-stats.data-title","Data source stats"),O=(0,s.t)("dashboard.inspect-stats.data-traceids","Trace IDs");return(0,t.jsxs)("div",{"aria-label":i.Tp.components.PanelInspector.Stats.content,className:v,children:[(0,t.jsx)(o,{timeZone:y,name:b,stats:u}),(0,t.jsx)(o,{timeZone:y,name:M,stats:P}),(0,t.jsx)(d,{name:O,traceIds:l.traceIds??[]})]})},v=(0,n.css)`
  height: 100%;
  overflow-y: scroll;
`},90820:(k,R,e)=>{"use strict";e.d(R,{e:()=>l});var t=e(74848),n=e(32196),i=e(96540),s=e(64423),r=e(39070),g=e(13544),a=e(32264),c=e(67061),o=e(55852),h=e(10534),f=e(39558),d=e(24022),p=e(8484),m=e(27677),v=e(26323);class l extends i.PureComponent{constructor(u){super(u),this.subs=new s.yU,this.setFormattedJson=D=>{this.formattedJson=D},this.getTextForClipboard=()=>JSON.stringify(this.formattedJson,null,2),this.onToggleExpand=()=>{this.setState(D=>({...D,allNodesExpanded:!this.state.allNodesExpanded}))},this.onToggleMocking=()=>{this.setState(D=>({...D,isMocking:!this.state.isMocking}))},this.getNrOfOpenNodes=()=>this.state.allNodesExpanded===null?3:this.state.allNodesExpanded?20:1,this.state={executedQueries:[],allNodesExpanded:null,isMocking:!1,mockedResponse:"",response:{}}}componentDidMount(){this.subs.add(m.IB.getInspectorStream().subscribe({next:u=>{let D=!0;if(this.props.instanceId&&u?.requestId&&(D=u.requestId.startsWith(this.props.instanceId)),D)return this.onDataSourceResponse(u.response)}}))}componentDidUpdate(u){this.props.data!==u.data&&this.updateQueryList()}updateQueryList(){const{data:u}=this.props,D=u.series,E=[];if(D?.length){let x;D.forEach((P,b)=>{const M=P.meta?.executedQueryString;if(M){const O=P.refId||"?";x?.refId===O?(x.frames++,x.rows+=P.length):(x={refId:O,frames:0,rows:P.length,query:M},E.push(x))}})}this.setState({executedQueries:E})}componentWillUnmount(){this.subs.unsubscribe()}onDataSourceResponse(u){u.config?.hideFromInspector||(u={...u},u.headers&&delete u.headers,u.config&&(u.request=u.config,delete u.config,delete u.request.transformRequest,delete u.request.transformResponse,delete u.request.paramSerializer,delete u.request.jsonpCallbackParam,delete u.request.headers,delete u.request.requestId,delete u.request.inspect,delete u.request.retry,delete u.request.timeout),u.data&&(u.response=u.data,delete u.config,delete u.data,delete u.status,delete u.statusText,delete u.ok,delete u.url,delete u.redirected,delete u.type,delete u.$$config),this.setState({response:u}))}renderExecutedQueries(u){if(!u.length)return null;const D={refId:(0,n.css)`
        font-weight: ${a.$.theme.typography.weight.semibold};
        color: ${a.$.theme.colors.textBlue};
        margin-right: 8px;
      `};return(0,t.jsx)("div",{children:u.map(E=>(0,t.jsxs)(c.B,{gap:1,direction:"column",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("span",{className:D.refId,children:[E.refId,":"]}),E.frames>1&&(0,t.jsxs)("span",{children:[E.frames," frames, "]}),(0,t.jsxs)("span",{children:[E.rows," rows"]})]}),(0,t.jsx)("pre",{children:E.query})]},E.refId))})}render(){const{allNodesExpanded:u,executedQueries:D,response:E}=this.state,{onRefreshQuery:x,data:P}=this.props,b=this.getNrOfOpenNodes(),M=(0,v.A)(a.$.theme2),O=Object.keys(E).length>0,I=P.state===r.Gu.Loading;return(0,t.jsxs)("div",{className:M.wrap,children:[(0,t.jsxs)("div",{"aria-label":g.Tp.components.PanelInspector.Query.content,children:[(0,t.jsx)("h3",{className:M.heading,children:"Query inspector"}),(0,t.jsx)("p",{className:"small muted",children:(0,t.jsx)(p.x6,{i18nKey:"inspector.query.description",children:"Query inspector allows you to view raw request and response. To collect this data Grafana needs to issue a new query. Click refresh button below to trigger a new query."})})]}),this.renderExecutedQueries(D),(0,t.jsxs)("div",{className:M.toolbar,children:[(0,t.jsx)(o.$n,{icon:"sync",onClick:x,"aria-label":g.Tp.components.PanelInspector.Query.refreshButton,children:(0,t.jsx)(p.x6,{i18nKey:"inspector.query.refresh",children:"Refresh"})}),O&&u&&(0,t.jsx)(o.$n,{icon:"minus",variant:"secondary",className:M.toolbarItem,onClick:this.onToggleExpand,children:(0,t.jsx)(p.x6,{i18nKey:"inspector.query.collapse-all",children:"Collapse all"})}),O&&!u&&(0,t.jsx)(o.$n,{icon:"plus",variant:"secondary",className:M.toolbarItem,onClick:this.onToggleExpand,children:(0,t.jsx)(p.x6,{i18nKey:"inspector.query.expand-all",children:"Expand all"})}),O&&(0,t.jsx)(h.b,{getText:this.getTextForClipboard,className:M.toolbarItem,icon:"copy",variant:"secondary",children:(0,t.jsx)(p.x6,{i18nKey:"inspector.query.copy-to-clipboard",children:"Copy to clipboard"})}),(0,t.jsx)("div",{className:"flex-grow-1"})]}),(0,t.jsxs)("div",{className:M.content,children:[I&&(0,t.jsx)(f._,{text:"Loading query inspector..."}),!I&&O&&(0,t.jsx)(d.B,{json:E,open:b,onDidRender:this.setFormattedJson}),!I&&!O&&(0,t.jsx)("p",{className:"muted",children:(0,t.jsx)(p.x6,{i18nKey:"inspector.query.no-data",children:"No request and response collected yet. Hit refresh button"})})]})]})}}},26323:(k,R,e)=>{"use strict";e.d(R,{A:()=>r,c:()=>s});var t=e(32196),n=e(3911),i=e(2913);const s=(0,n.N)(()=>r(i.config.theme2)),r=g=>({heading:(0,t.css)({fontSize:g.typography.body.fontSize,marginBottom:g.spacing(1)}),wrap:(0,t.css)({display:"flex",flexDirection:"column",height:"100%",width:"100%",flex:"1 1 0",minHeight:0}),toolbar:(0,t.css)({display:"flex",width:"100%",flexGrow:0,alignItems:"center",justifyContent:"flex-end",marginBottom:g.v1.spacing.sm}),toolbarItem:(0,t.css)({marginLeft:g.v1.spacing.md}),content:(0,t.css)({flexGrow:1,height:"100%"}),editor:(0,t.css)({fontFamily:"monospace",height:"100%",flexGrow:1}),viewer:(0,t.css)({overflow:"scroll"}),dataFrameSelect:(0,t.css)({flexGrow:2}),leftActions:(0,t.css)({display:"flex",flexGrow:1,maxWidth:"85%","@media (max-width: 1345px)":{maxWidth:"75%"}}),options:(0,t.css)({paddingTop:g.v1.spacing.sm}),dataDisplayOptions:(0,t.css)({flexGrow:1,minWidth:"300px",marginRight:g.v1.spacing.sm}),selects:(0,t.css)({display:"flex","> *":{marginRight:g.v1.spacing.sm}})})},16560:(k,R,e)=>{"use strict";e.d(R,{q:()=>t});var t=(n=>(n.Data="data",n.Meta="meta",n.Error="error",n.Stats="stats",n.JSON="json",n.Query="query",n.Help="help",n))(t||{})},18358:(k,R,e)=>{"use strict";e.d(R,{ny:()=>N,EM:()=>L,Zy:()=>A,ek:()=>F});var t=e(4213),n=e.n(t),i=e(72724),s=e(18282),r=e(72436),g=e(37471),a=e(19071),c=e(2543);const h=Object.defineProperty({archiveEnabled:!1,dependencies:{dagMaxNumServices:100,menuEnabled:!0},linkPatterns:[],search:{maxLookback:{label:"2 Days",value:"2d"},maxLimit:1500},tracking:{gaID:null,trackErrors:!0}},"__mergeFields",{value:["dependencies","search","tracking"]});function f(){return defaultConfig}function d(w){return _get(f(),w)}function p(w){let B;const U=new Set(w.map(({spanID:K})=>K));for(let K=0;K<w.length;K++){if(w[K].references&&w[K].references.some(({traceID:X,spanID:J})=>X===w[K].traceID&&U.has(J)))continue;if(!B){B=w[K];continue}const H=w[K].references&&w[K].references.length||0,Y=B.references&&B.references.length||0;(H<Y||H===Y&&w[K].startTime<B.startTime)&&(B=w[K])}return B?`${B.process.serviceName}: ${B.operationName}`:""}const m=(0,c.memoize)(p,w=>w.length?w[0].traceID:0);function v(w){const B=new Map,U=w.reduce((V,H)=>(V.some(Y=>Y.key===H.key&&Y.value===H.value)?B.set(`${H.key}:${H.value}`,`Duplicate tag "${H.key}:${H.value}"`):V.push(H),V),[]),K=Array.from(B.values());return{dedupedTags:U,warnings:K}}function l(w,B){const U=w?.slice()??[],K=(B||[]).map(V=>V.toLowerCase());return U.sort((V,H)=>{const Y=V.key.toLowerCase(),X=H.key.toLowerCase();for(let J=0;J<K.length;J++){const q=K[J];if(Y.startsWith(q)&&!X.startsWith(q))return-1;if(!Y.startsWith(q)&&X.startsWith(q))return 1}return Y>X?1:Y<X?-1:0}),U}function y(w){if(!w?.traceID)return null;const B=w.traceID.toLowerCase();let U=0,K=Number.MAX_SAFE_INTEGER;const V=new Map,H=new Map;w.spans=w.spans.filter(te=>!!te.startTime),w.processes=Object.entries(w.processes).reduce((te,[ne,le])=>(te[ne]={...le,tags:l(le.tags)},te),{});const Y=w.spans.length;for(let te=0;te<Y;te++){const ne=w.spans[te],{startTime:le,duration:z,processID:ee}=ne;let se=ne.spanID;le<K&&(K=le),le+z>U&&(U=le+z);const ie=V.get(se);ie!=null?(console.warn(`Dupe spanID, ${ie+1} x ${se}`,ne,H.get(se)),_isEqual(ne,H.get(se))&&console.warn("	 two spans with same ID have `isEqual(...) === true`"),V.set(se,ie+1),se=`${se}_${ie}`,ne.spanID=se):V.set(se,1),ne.process=w.processes[ee],H.set(se,ne)}const X=getTraceSpanIdsAsTree(w,H),J=[],q={};X.walk((te,ne,le=0)=>{if(te==="__root__"||typeof te!="string")return;const z=H.get(te);if(!z)return;const{serviceName:ee}=z.process;q[ee]=(q[ee]||0)+1,z.relativeStartTime=z.startTime-K,z.depth=le-1,z.hasChildren=ne.children.length>0,z.childSpanCount=ne.children.length,z.warnings=z.warnings||[],z.tags=z.tags||[],z.references=z.references||[],z.childSpanIds=ne.children.slice().sort((ie,Z)=>{const oe=H.get(ie.value),ce=H.get(Z.value);return ce.startTime+ce.duration-(oe.startTime+oe.duration)}).map(ie=>ie.value);const se=v(z.tags);z.tags=l(se.dedupedTags,getConfigValue("topTagPrefixes")),z.warnings=z.warnings.concat(se.warnings),z.references.forEach((ie,Z)=>{const oe=H.get(ie.spanID);oe&&(ie.span=oe,Z>0&&(oe.subsidiarilyReferencedBy=oe.subsidiarilyReferencedBy||[],oe.subsidiarilyReferencedBy.push({spanID:te,traceID:B,span:z,refType:ie.refType})))}),J.push(z)});const ae=getTraceName(J);return{services:Object.keys(q).map(te=>({name:te,numberOfSpans:q[te]})),spans:J,traceID:B,traceName:ae,processes:w.processes,duration:U-K,startTime:K,endTime:U}}function u(w){const B=w.spans.map(K=>D(K,w.processes)),U=new MutableDataFrame({fields:[{name:"traceID",type:FieldType.string},{name:"spanID",type:FieldType.string},{name:"parentSpanID",type:FieldType.string},{name:"operationName",type:FieldType.string},{name:"serviceName",type:FieldType.string},{name:"serviceTags",type:FieldType.other},{name:"startTime",type:FieldType.number},{name:"duration",type:FieldType.number},{name:"logs",type:FieldType.other},{name:"tags",type:FieldType.other},{name:"warnings",type:FieldType.other},{name:"stackTraces",type:FieldType.other}],meta:{preferredVisualisationType:"trace",custom:{traceFormat:"jaeger"}}});for(const K of B)U.add(K);return U}function D(w,B){return{spanID:w.spanID,traceID:w.traceID,parentSpanID:w.references?.find(U=>U.refType==="CHILD_OF")?.spanID,operationName:w.operationName,startTime:w.startTime/1e3,duration:w.duration/1e3,logs:w.logs.map(U=>({...U,timestamp:U.timestamp/1e3})),tags:w.tags,warnings:w.warnings??void 0,stackTraces:w.stackTraces,serviceName:B[w.processID].serviceName,serviceTags:B[w.processID].tags}}function E(w,B){const U=new MutableDataFrame({fields:[{name:"traceID",type:FieldType.string,config:{unit:"string",displayNameFromDS:"Trace ID",links:[{title:"Trace: ${__value.raw}",url:"",internal:{datasourceUid:B.uid,datasourceName:B.name,query:{query:"${__value.raw}"}}}]}},{name:"traceName",type:FieldType.string,config:{displayNameFromDS:"Trace name"}},{name:"startTime",type:FieldType.time,config:{displayNameFromDS:"Start time"}},{name:"duration",type:FieldType.number,config:{displayNameFromDS:"Duration",unit:"\xB5s"}}],meta:{preferredVisualisationType:"table"}}),K=w.map(x).sort((V,H)=>H?.startTime-V?.startTime);for(const V of K)U.add(V);return U}function x(w){const B=transformTraceData(w);if(B)return{traceID:B.traceID,startTime:B.startTime/1e3,duration:B.duration,traceName:B.traceName}}function P(w){let B={traceID:"",spans:[],processes:{},warnings:null},U=[];for(let K=0;K<w.length;K++){const V=w.get(K);B.traceID||(B.traceID=V.traceID),U.find(H=>H===V.serviceName)||(U.push(V.serviceName),B.processes[`p${U.length}`]={serviceName:V.serviceName,tags:V.serviceTags}),B.spans.push({traceID:V.traceID,spanID:V.spanID,duration:V.duration*1e3,references:V.parentSpanID?[{refType:"CHILD_OF",spanID:V.parentSpanID,traceID:V.traceID}]:[],flags:0,logs:V.logs.map(H=>({...H,timestamp:H.timestamp*1e3})),operationName:V.operationName,processID:Object.keys(B.processes).find(H=>B.processes[H].serviceName===V.serviceName)||"",startTime:V.startTime*1e3,tags:V.tags,warnings:V.warnings?V.warnings:null})}return{data:[B],total:0,limit:0,offset:0,errors:null}}function b(w){const B=w.map(M),U=new MutableDataFrame({fields:[{name:"traceID",type:FieldType.string,values:[]},{name:"spanID",type:FieldType.string,values:[]},{name:"parentSpanID",type:FieldType.string,values:[]},{name:"operationName",type:FieldType.string,values:[]},{name:"serviceName",type:FieldType.string,values:[]},{name:"serviceTags",type:FieldType.other,values:[]},{name:"startTime",type:FieldType.number,values:[]},{name:"duration",type:FieldType.number,values:[]},{name:"logs",type:FieldType.other,values:[]},{name:"tags",type:FieldType.other,values:[]}],meta:{preferredVisualisationType:"trace",custom:{traceFormat:"zipkin"}}});for(const K of B)U.add(K);return U}function M(w){const B={traceID:w.traceId,spanID:w.id,parentSpanID:w.parentId,operationName:w.name,serviceName:w.localEndpoint?.serviceName||w.remoteEndpoint?.serviceName||"unknown",serviceTags:I(w),startTime:w.timestamp/1e3,duration:w.duration/1e3,logs:w.annotations?.map(O)??[],tags:Object.keys(w.tags||{}).reduce((U,K)=>K==="error"?(U.push({key:"error",value:!0}),U.push({key:"errorValue",value:w.tags.error}),U):(U.push({key:K,value:w.tags[K]}),U),[])};return w.kind&&(B.tags=[{key:"kind",value:w.kind},...B.tags??[]]),w.shared&&(B.tags=[{key:"shared",value:w.shared},...B.tags??[]]),B}function O(w){return{timestamp:w.timestamp,fields:[{key:"annotation",value:w.value}]}}function I(w){const B=w.localEndpoint||w.remoteEndpoint;return B?[T("ipv4",B.ipv4),T("ipv6",B.ipv6),T("port",B.port),T("endpointType",w.localEndpoint?"local":"remote")].filter(U=>!!U):[]}function T(w,B){if(B)return{key:w,value:B}}const C=w=>{let B=[];for(let U=0;U<w.length;U++){const K=w.get(U);B.push({traceId:K.traceID,parentId:K.parentSpanID,name:K.operationName,id:K.spanID,timestamp:K.startTime*1e3,duration:K.duration*1e3,...S(K),annotations:K.logs.length?K.logs.map(V=>({timestamp:V.timestamp,value:V.fields[0].value})):void 0,tags:K.tags.length?K.tags.filter(V=>V.key!=="kind"&&V.key!=="endpointType"&&V.key!=="shared").reduce((V,H)=>H.key==="error"?{...V,[H.key]:K.tags.find(Y=>Y.key==="errorValue").value||""}:{...V,[H.key]:H.value},{}):void 0,kind:K.tags.find(V=>V.key==="kind")?.value,shared:K.tags.find(V=>V.key==="shared")?.value})}return B},S=w=>{const B=w.serviceTags.find(U=>U.key==="endpointType")?.value==="local"?"localEndpoint":"remoteEndpoint";return w.serviceName!=="unknown"?{[B]:{serviceName:w.serviceName,ipv4:w.serviceTags.find(U=>U.key==="ipv4")?.value,ipv6:w.serviceTags.find(U=>U.key==="ipv6")?.value,port:w.serviceTags.find(U=>U.key==="port")?.value}}:void 0};function A(w,B){let U="";w.meta?.forEach(H=>{const Y=`${H.label}: ${JSON.stringify(H.value)}
`;U=U+Y}),U=U+`

`,w.rows.forEach(H=>{const Y=(0,i.LE)(H.timeEpochMs,{defaultWithMS:!0})+"	"+H.entry+`
`;U=U+Y});const K=new Blob([U],{type:"text/plain;charset=utf-8"}),V=`${B}-logs-${(0,i.LE)(new Date)}.txt`;n()(K,V)}function L(w,B,U,K=s.F.noop){const V=(0,r._O)([w],U),H=U?.useExcelHeader?"\uFEFF":"",Y=new Blob([H,V],{type:"text/csv;charset=utf-8"}),X=K!==s.F.noop?"-as-"+K.toLocaleLowerCase():"",J=`${B}-data${X}-${(0,i.LE)(new Date)}.csv`;n()(Y,J)}function N(w,B){const U=new Blob([JSON.stringify(w)],{type:"application/json"}),K=`${B}-${(0,i.LE)(new Date)}.json`;n()(U,K)}function F(w,B){let U="otlp";switch(w.meta?.custom?.traceFormat){case"jaeger":{let K=P(new g.k(w));N(K,B),U="jaeger";break}case"zipkin":{let K=C(new g.k(w));N(K,B),U="zipkin";break}case"otlp":default:{let K=(0,a.xw)(new g.k(w));N(K,B);break}}return U}},77938:(k,R,e)=>{"use strict";e.d(R,{p:()=>i});var t=e(26272),n=e(28138);function i(r){let g="";try{g=JSON.stringify(r,s(),2)}catch(a){a instanceof Error&&(a.toString().includes("RangeError")||a.toString().includes("allocation size overflow"))?n.A.emit(t.r1.alertError,[a.toString(),"Cannot display JSON, the object is too big."]):n.A.emit(t.r1.alertError,[a instanceof Error?a.toString():a])}return g}function s(){const r=new WeakSet;return(g,a)=>{if(g==="__dataContext"||g==="__sceneObject")return"Filtered out in JSON serialization";if(typeof a=="object"&&a!==null){if(r.has(a))return;r.add(a)}return a}}},47259:(k,R,e)=>{"use strict";e.d(R,{G7:()=>s,KU:()=>r,eb:()=>g});var t=e(17172),n=e(10096),i=e(31678);const s=(0,i.createAsyncThunk)("users/fetchInvitees",async()=>n.TP.hasPermission(i.AccessControlAction.OrgUsersAdd)?await(0,t.AI)().get("/api/org/invites"):[]),r=(0,i.createAsyncThunk)("users/addInvitee",async(a,{dispatch:c})=>{await(0,t.AI)().post("/api/org/invites",a),await c(s())}),g=(0,i.createAsyncThunk)("users/revokeInvite",async a=>(await(0,t.AI)().patch(`/api/org/invites/${a}/revoke`,{}),a))},40823:(k,R,e)=>{"use strict";e.d(R,{Ay:()=>c,Tp:()=>s});var t=e(65307),n=e(47259);const i=(0,t.pU)({selectId:o=>o.code}),s=i.getSelectors(),r=i.getInitialState({status:"idle"}),c={invites:(0,t.Z0)({name:"invites",initialState:r,reducers:{},extraReducers:o=>{o.addCase(n.G7.pending,h=>{h.status="loading"}).addCase(n.G7.fulfilled,(h,{payload:f})=>{i.setAll(h,f),h.status="succeeded"}).addCase(n.G7.rejected,h=>{h.status="failed"}).addCase(n.eb.fulfilled,(h,{payload:f})=>{i.removeOne(h,f),h.status="succeeded"})}}).reducer}},96227:(k,R,e)=>{"use strict";e.d(R,{b:()=>m,o:()=>v});var t=e(74848),n=e(96540),i=e(40996),s=e(16817),r=e(17172),g=e(88575),a=e(10354),c=e(37390),o=e(55852),h=e(36607),f=e(8484),d=e(57767),p=e(88861);const m=({panel:l,initialFolderUid:y,onCreateLibraryPanel:u,onDismiss:D})=>{const[E,x]=(0,n.useState)(y),[P,b]=(0,n.useState)(l.title),[M,O]=(0,n.useState)(l.title),[I,T]=(0,n.useState)(!1);(0,n.useEffect)(()=>T(!0),[P]),(0,i.A)(()=>O(P),350,[P]);const{saveLibraryPanel:C}=(0,p.b)(),S=(0,n.useCallback)(()=>{l.libraryPanel={uid:"",name:P},C(l,E).then(N=>{(0,r.NF)(N)?l.libraryPanel=void 0:(D?.(),u?.(N))})},[l,P,C,E,D,u]),A=(0,s.A)(async()=>{try{return!(await(0,d.e9)(P)).some(N=>N.folderUid===E)}catch(N){return(0,r.NF)(N)&&(N.isHandled=!0),!0}finally{T(!1)}},[M,E]);console.log("isValidName:",A);const L=!A?.value&&A.value!==void 0&&P===M&&!I;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.D,{label:(0,f.t)("library-panel.add-modal.name","Library panel name"),invalid:L,error:L?(0,f.t)("library-panel.add-modal.error","Library panel with this name already exists"):"",children:(0,t.jsx)(a.p,{id:"share-panel-library-panel-name-input",name:"name",value:P,onChange:N=>b(N.currentTarget.value)})}),(0,t.jsx)(g.D,{label:(0,f.t)("library-panel.add-modal.folder","Save in folder"),description:(0,f.t)("library-panel.add-modal.folder-description","Library panel permissions are derived from the folder permissions"),children:(0,t.jsx)(h.d,{onChange:N=>x(N),value:E,inputId:"share-panel-library-panel-folder-picker"})}),(0,t.jsxs)(c.a.ButtonRow,{children:[(0,t.jsx)(o.$n,{variant:"secondary",onClick:D,fill:"outline",children:(0,t.jsx)(f.x6,{i18nKey:"library-panel.add-modal.cancel",children:"Cancel"})}),(0,t.jsx)(o.$n,{onClick:S,disabled:L,children:(0,t.jsx)(f.x6,{i18nKey:"library-panel.add-modal.create",children:"Create library panel"})})]})]})},v=({isOpen:l=!1,panel:y,initialFolderUid:u,...D})=>(0,t.jsx)(c.a,{title:"Create library panel",isOpen:l,onDismiss:D.onDismiss,children:(0,t.jsx)(m,{panel:y,initialFolderUid:u,onDismiss:D.onDismiss})})},86474:(k,R,e)=>{"use strict";e.d(R,{E:()=>S});var t=e(74848),n=e(32196),i=e(96540),s=e(70255),r=e(32264),g=e(40845),a=e(14578),c=e(50720),o=e(72129),h=e(41394),f=e(25701),d=e(39070),p=e(37390),m=e(55852),v=e(43535),l=e(16547),y=e(57767),u=e(65307);const D={loadingState:d.Gu.Loading,dashboardTitles:[]},E=(0,u.VP)("libraryPanels/delete/searchCompleted"),x=(N=D,F)=>E.match(F)?{...N,dashboardTitles:F.payload.dashboards.map(w=>w.title),loadingState:d.Gu.Done}:N;function P(N){return async function(F){const w=await(0,y.xV)(N.uid);F(E({dashboards:w}))}}const b=({libraryPanel:N,onDismiss:F,onConfirm:w})=>{const B=(0,g.of)(v.o),[{dashboardTitles:U,loadingState:K},V]=(0,i.useReducer)(x,D),H=(0,i.useMemo)(()=>(0,l.QC)(V),[V]);(0,i.useEffect)(()=>{H(P(N))},[H,N]);const Y=!!U.length,X=K===d.Gu.Done;return(0,t.jsxs)(p.a,{className:B.modal,title:"Delete library panel",icon:"trash-alt",onDismiss:F,isOpen:!0,children:[X?null:(0,t.jsx)(M,{}),X?(0,t.jsxs)("div",{children:[Y?(0,t.jsx)(I,{dashboardTitles:U}):null,Y?null:(0,t.jsx)(O,{}),(0,t.jsxs)(p.a.ButtonRow,{children:[(0,t.jsx)(m.$n,{variant:"secondary",onClick:F,fill:"outline",children:"Cancel"}),(0,t.jsx)(m.$n,{variant:"destructive",onClick:w,disabled:Y,children:"Delete"})]})]}):null]})},M=()=>(0,t.jsx)("span",{children:"Loading library panel..."}),O=()=>{const N=(0,g.of)(v.o);return(0,t.jsx)("div",{className:N.modalText,children:"Do you want to delete this panel?"})},I=({dashboardTitles:N})=>{const F=(0,g.of)(v.o),w=N.length===1?"dashboard.":"dashboards.",B=`${N.length} ${w}`;return N.length===0?null:(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:F.textInfo,children:["This library panel can not be deleted because it is connected to ",(0,t.jsx)("strong",{children:B})," Remove the library panel from the dashboards listed below and retry."]}),(0,t.jsxs)("table",{className:F.myTable,children:[(0,t.jsx)("thead",{children:(0,t.jsx)("tr",{children:(0,t.jsx)("th",{children:"Dashboard name"})})}),(0,t.jsx)("tbody",{children:N.map((U,K)=>(0,t.jsx)("tr",{children:(0,t.jsx)("td",{children:U})},`dash-title-${K}`))})]})]})},T=({libraryPanel:N,onClick:F,onDelete:w,showSecondaryActions:B})=>{const[U,K]=(0,i.useState)(!1),V=()=>{w?.(N),K(!1)},H=r.$.panels[N.model.type]??(0,h.$)(N.model.type).meta;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(f.b,{isCurrent:!1,title:N.name,description:N.description,plugin:H,onClick:()=>F?.(N),onDelete:B?()=>K(!0):void 0,children:(0,t.jsx)(A,{libraryPanel:N})}),U&&(0,t.jsx)(b,{libraryPanel:N,onConfirm:V,onDismiss:()=>K(!1)})]})},C=({showSecondaryActions:N,rootProps:F})=>{const w=(0,g.of)(L);return(0,t.jsx)(f.b.Skeleton,{hasDelete:N,...F,children:(0,t.jsx)(s.A,{containerClassName:w.metaContainer,width:80})})},S=(0,o.j)(T,C);function A({libraryPanel:N}){const F=(0,g.of)(L);return!N.meta?.folderUid&&!N.meta?.folderName?null:N.meta.folderUid?(0,t.jsx)("span",{className:F.metaContainer,children:(0,t.jsxs)(c.N,{href:`/dashboards/f/${N.meta.folderUid}`,children:[(0,t.jsx)(a.I,{name:"folder-upload",size:"sm"}),(0,t.jsx)("span",{children:N.meta.folderName})]})}):(0,t.jsxs)("span",{className:F.metaContainer,children:[(0,t.jsx)(a.I,{name:"folder",size:"sm"}),(0,t.jsx)("span",{children:"Dashboards"})]})}function L(N){return{metaContainer:(0,n.css)({display:"flex",alignItems:"center",color:N.colors.text.secondary,fontSize:N.typography.bodySmall.fontSize,paddingTop:N.spacing(.5),svg:{marginRight:N.spacing(.5),marginBottom:3}})}}},16678:(k,R,e)=>{"use strict";e.d(R,{j:()=>M,s:()=>b});var t=e(74848),n=e(32196),i=e(96540),s=e(40996),r=e(40845),g=e(66864),a=e(67647),c=e(76459),o=e.n(c),h=e(55852),f=e(90182),d=e(14578),p=e(27677),m=e(64161),v=e(31678);function l({onChange:C,maxMenuHeight:S}){const A=(0,r.of)(u),[L,N]=(0,i.useState)(!1),F=(0,i.useCallback)(V=>y(V,N),[]),w=(0,i.useMemo)(()=>o()(F,300),[F]),[B,U]=(0,i.useState)([]),K=(0,i.useCallback)(V=>{const H=V.filter(Y=>!!Y.value).map(Y=>Y.value);C(H),U(V)},[C]);return(0,t.jsxs)("div",{className:A.container,children:[B.length>0&&(0,t.jsx)(h.$n,{size:"xs",icon:"trash-alt",fill:"text",className:A.clear,onClick:()=>C([]),"aria-label":"Clear folders",children:"Clear folders"}),(0,t.jsx)(f.Iv,{value:B,onChange:K,isLoading:L,loadOptions:w,maxMenuHeight:S,placeholder:"Filter by folder",noOptionsMessage:"No folders found",prefix:(0,t.jsx)(d.I,{name:"filter"}),"aria-label":"Folder filter",defaultOptions:!0})]})}async function y(C,S){S(!0);const A={query:C,type:m.G.DashFolder,permission:v.PermissionLevelString.View},N=(await(0,p.AI)().search(A)).map(F=>({label:F.title,value:{uid:F.uid,title:F.title}}));return(!C||"dashboards".includes(C.toLowerCase()))&&N.unshift({label:"Dashboards",value:{uid:"general",title:"Dashboards"}}),S(!1),N}function u(C){return{container:(0,n.css)({label:"container",position:"relative",minWidth:"180px",flexGrow:1}),clear:(0,n.css)({label:"clear",fontSize:C.spacing(1.5),position:"absolute",top:-C.spacing(4.5),right:0})}}var D=e(68313),E=e(73725),x=e(15054),P=e(83791),b=(C=>(C.Tight="tight",C.Spacious="spacious",C))(b||{});const M=({onClick:C,variant:S="spacious",currentPanelId:A,currentFolderUID:L,perPage:N=x.FG,showPanelFilter:F=!1,showFolderFilter:w=!1,showSort:B=!1,showSecondaryActions:U=!1})=>{const K=(0,r.of)(O,S),[V,H]=(0,i.useState)(""),[Y,X]=(0,i.useState)("");(0,s.A)(()=>X(V),200,[V]);const[J,q]=(0,i.useState)({}),[ae,j]=(0,i.useState)(L?[L]:[]),[te,ne]=(0,i.useState)([]),le=B||F||w,z=S==="tight"?"lg":"xs";return(0,t.jsx)("div",{className:K.container,children:(0,t.jsxs)(g.gW,{spacing:z,children:[(0,t.jsxs)("div",{className:(0,n.cx)(K.gridContainer,{[K.tightLayout]:S==="tight"}),children:[(0,t.jsx)("div",{className:K.filterInputWrapper,children:(0,t.jsx)(a.Z,{value:V,onChange:H,placeholder:"Search by name or description",width:0,escapeRegex:!1})}),le&&(0,t.jsx)(I,{showSort:B,showPanelFilter:F,showFolderFilter:w,onSortChange:q,onFolderFilterChange:j,onPanelFilterChange:ne,sortDirection:J.value,variant:S})]}),(0,t.jsx)("div",{className:K.libraryPanelsView,children:(0,t.jsx)(P.y,{onClickCard:C,searchString:Y,sortDirection:J.value,panelFilter:te,folderFilter:ae,currentPanelId:A,showSecondaryActions:U,perPage:N})})]})})};function O(C,S){return{filterInputWrapper:(0,n.css)({flexGrow:S==="tight"?1:"initial"}),container:(0,n.css)({width:"100%",overflowY:"auto",padding:C.spacing(1)}),libraryPanelsView:(0,n.css)({width:"100%"}),gridContainer:(0,n.css)({display:"flex",flexDirection:"column",width:"100%",columnGap:C.spacing(1),rowGap:C.spacing(1),paddingBottom:C.spacing(2)}),tightLayout:(0,n.css)({flexDirection:"row",rowGap:C.spacing(1)})}}const I=(0,i.memo)(({variant:C="spacious",showSort:S,showPanelFilter:A,showFolderFilter:L,sortDirection:N,onSortChange:F,onFolderFilterChange:w,onPanelFilterChange:B})=>{const U=(0,r.of)(T),K=(0,i.useCallback)(H=>B(H.map(Y=>Y.id)),[B]),V=(0,i.useCallback)(H=>w(H.map(Y=>Y.uid??"")),[w]);return(0,t.jsxs)("div",{className:(0,n.cx)(U.container,{[U.containerTight]:C==="tight"}),children:[S&&(0,t.jsx)(E.r,{value:N,onChange:F,filter:["alpha-asc","alpha-desc"]}),(L||A)&&(0,t.jsxs)("div",{className:(0,n.cx)(U.filterContainer,{[U.filterContainerTight]:C==="tight"}),children:[L&&(0,t.jsx)(l,{onChange:V}),A&&(0,t.jsx)(D.$,{onChange:K})]})]})});I.displayName="SearchControls";function T(C){return{container:(0,n.css)({display:"flex",gap:C.spacing(1),flexGrow:1,flexDirection:"row",justifyContent:"space-between",flexWrap:"wrap"}),containerTight:(0,n.css)({flexGrow:"initial",flexDirection:"column",justifyContent:"normal"}),filterContainer:(0,n.css)({display:"flex",flexDirection:"row",gap:C.spacing(1)}),filterContainerTight:(0,n.css)({flexDirection:"column",marginLeft:"initial"})}}},83791:(k,R,e)=>{"use strict";e.d(R,{y:()=>v});var t=e(74848),n=e(32196),i=e(96540),s=e(40996),r=e(39070),g=e(40845),a=e(69529),c=e(72109),o=e(67061),h=e(19384),f=e(8484),d=e(86474),p=e(16547),m=e(8184);const v=({onClickCard:y,searchString:u,sortDirection:D,panelFilter:E,folderFilter:x,showSecondaryActions:P,currentPanelId:b,perPage:M=40,isWidget:O})=>{const I=(0,g.of)(l),[{libraryPanels:T,page:C,perPage:S,numberOfPages:A,loadingState:L,currentPanelId:N},F]=(0,i.useReducer)(m.w_,{...m.Xb,currentPanelId:b,perPage:M}),w=(0,i.useMemo)(()=>(0,p.QC)(F),[F]);(0,s.A)(()=>w((0,p.IF)({searchString:u,sortDirection:D,panelFilter:E,folderFilterUIDs:x,page:C,perPage:S,currentPanelId:N,isWidget:O})),300,[u,D,E,x,C,w]);const B=({uid:V})=>w((0,p.h4)(V,{searchString:u,sortDirection:D,panelFilter:E,folderFilterUIDs:x,page:C,perPage:S})),U=V=>w((0,m.yd)({page:V}));return!(u||E?.length||x?.length)&&L===r.Gu.Done&&T.length<1?(0,t.jsx)(a.p,{variant:"call-to-action",message:(0,f.t)("library-panel.empty-state.message","You haven't created any library panels yet"),children:(0,t.jsxs)(f.x6,{i18nKey:"library-panel.empty-state.more-info",children:["Create a library panel from any existing dashboard panel through the panel context menu."," ",(0,t.jsx)(c.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/dashboards/build-dashboards/manage-library-panels/#create-a-library-panel",children:"Learn more"})]})}):(0,t.jsxs)(o.B,{direction:"column",wrap:"nowrap",children:[L===r.Gu.Loading?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.E.Skeleton,{showSecondaryActions:P}),(0,t.jsx)(d.E.Skeleton,{showSecondaryActions:P}),(0,t.jsx)(d.E.Skeleton,{showSecondaryActions:P})]}):T.length<1?(0,t.jsx)(a.p,{variant:"not-found",message:(0,f.t)("library-panels.empty-state.message","No library panels found")}):T?.map((V,H)=>(0,t.jsx)(d.E,{libraryPanel:V,onDelete:B,onClick:y,showSecondaryActions:P},`library-panel=${H}`)),T.length?(0,t.jsx)("div",{className:I.pagination,children:(0,t.jsx)(h.d,{currentPage:C,numberOfPages:A,onNavigate:U,hideWhenSinglePage:!0})}):null]})},l=y=>({pagination:(0,n.css)({alignSelf:"center",marginTop:y.spacing(1)})})},16547:(k,R,e)=>{"use strict";e.d(R,{IF:()=>l,QC:()=>u,h4:()=>y});var t=e(64423),n=e(65474),i=e(62467),s=e(44240),r=e(39697),g=e(69862),a=e(66847),c=e(69850),o=e(1005),h=e(65961),f=e(67791),d=e(32264),p=e(17706),m=e(57767),v=e(8184);function l(D){const E=(P,b)=>P.id===b.type,x=(P,b)=>{const M=(0,p.A4)();return P.filter(O=>{const I=M.find(T=>E(T,O));return b?!!I?.skipDataQuery:!I?.skipDataQuery})};return function(P){const b=new t.yU,M=(0,n.H)((0,m.dq)({searchString:D.searchString,perPage:D.perPage,page:D.page,excludeUid:D.currentPanelId,sortDirection:D.sortDirection,typeFilter:D.panelFilter,folderFilterUIDs:D.folderFilterUIDs})).pipe((0,g.Z)(O=>{const{elements:I}=O;if(d.$.featureToggles.vizAndWidgetSplit&&D.isWidget!==void 0){const T=x(I,D.isWidget);return(0,i.of)({...O,elements:T})}return(0,i.of)({...O,elements:I})}),(0,g.Z)(({perPage:O,elements:I,page:T,totalCount:C})=>(0,i.of)((0,v.c4)({libraryPanels:I,page:T,perPage:O,totalCount:C}))),(0,a.W)(O=>(console.error(O),(0,i.of)((0,v.c4)({...v.Xb,page:D.page,perPage:D.perPage})))),(0,c.j)(()=>b.unsubscribe()),(0,o.u)());b.add((0,s.h)((0,r.O)(50).pipe((0,h.u)((0,v.d9)()),(0,f.Q)(M)),M).subscribe(P))}}function y(D,E){return async function(x){try{await(0,m.h4)(D),l(E)(x)}catch(P){console.error(P)}}}function u(D){return function(E){return E instanceof Function?E(D):D(E)}}},8184:(k,R,e)=>{"use strict";e.d(R,{Xb:()=>i,c4:()=>r,d9:()=>s,w_:()=>a,yd:()=>g});var t=e(65307),n=e(39070);const i={loadingState:n.Gu.Loading,libraryPanels:[],totalCount:0,perPage:40,page:1,numberOfPages:0,currentPanelId:void 0},s=(0,t.VP)("libraryPanels/view/initSearch"),r=(0,t.VP)("libraryPanels/view/searchCompleted"),g=(0,t.VP)("libraryPanels/view/changePage"),a=(c,o)=>{if(s.match(o))return{...c,loadingState:n.Gu.Loading};if(r.match(o)){const{libraryPanels:h,page:f,perPage:d,totalCount:p}=o.payload,m=Math.ceil(p/d);return{...c,libraryPanels:h,perPage:d,totalCount:p,loadingState:n.Gu.Done,numberOfPages:m,page:f>m?f-1:f}}return g.match(o)?{...c,page:o.payload.page}:c}},82792:(k,R,e)=>{"use strict";e.d(R,{X:()=>t});function t(n){return!!n.libraryPanel?.uid}},57767:(k,R,e)=>{"use strict";e.d(R,{GN:()=>m,GX:()=>y,Yr:()=>o,d7:()=>f,dq:()=>c,e9:()=>h,h4:()=>p,jc:()=>d,xV:()=>v});var t=e(75505),n=e(79422),i=e(34214),s=e(41507),r=e(20455),g=e(27677),a=e(98796);async function c({searchString:u="",perPage:D=100,page:E=1,excludeUid:x="",sortDirection:P="",typeFilter:b=[],folderFilterUIDs:M=[]}={}){const O=new URLSearchParams;O.append("searchString",u),O.append("sortDirection",P),O.append("typeFilter",b.join(",")),O.append("folderFilterUIDs",M.join(",")),O.append("excludeUid",x),O.append("perPage",D.toString(10)),O.append("page",E.toString(10)),O.append("kind",a.i.Panel.toString(10));const{result:I}=await(0,g.AI)().get(`/api/library-elements?${O.toString()}`);return I}async function o(u,D=!1){const E=await(0,t.s)((0,g.AI)().fetch({method:"GET",url:`/api/library-elements/${u}`,showSuccessAlert:!D,showErrorAlert:!D})),{result:x}=E.data,P=new i.G({...n.Ye,schemaVersion:35,panels:[x.model]}),{scopedVars:b,...M}=P.panels[0].getSaveModel();return delete M.gridPos,delete M.id,delete M.libraryPanel,P.destroy(),{...x,model:M}}async function h(u){const{result:D}=await(0,g.AI)().get(`/api/library-elements/name/${u}`);return D}async function f(u,D){const{result:E}=await(0,g.AI)().post("/api/library-elements",{folderUid:D,name:u.libraryPanel.name,model:u,kind:a.i.Panel});return E}async function d(u){const{libraryPanel:D,...E}=u,{uid:x,name:P,version:b,folderUid:M}=D,O=a.i.Panel,{result:I}=await(0,g.AI)().patch(`/api/library-elements/${x}`,{folderUid:M,name:P,model:E,version:b,kind:O});return I}function p(u){return(0,g.AI)().delete(`/api/library-elements/${u}`)}async function m(u){const{result:D}=await(0,g.AI)().get(`/api/library-elements/${u}/connections`);return D}async function v(u){const D=await m(u);return D.length===0?[]:await(0,g.AI)().search({dashboardUIDs:D.map(x=>x.connectionUid)})}function l(u){const{panel:D,uid:E,name:x,_loadedPanel:P}=u.state,b=u.parent;if(!b||!(b instanceof s.U))throw new Error("LibraryVizPanel must be a child of DashboardGridItem");return{uid:E,folderUID:P?.folderUid,name:x,version:P?.version||0,model:(0,r.Z6)(D,{x:b.state.x??0,y:b.state.y??0,w:b.state.width??0,h:b.state.height??0},!1,b),kind:a.i.Panel}}async function y(u){const{uid:D,folderUID:E,name:x,model:P,version:b,kind:M}=l(u),{result:O}=await(0,g.AI)().patch(`/api/library-elements/${D}`,{folderUID:E,name:x,model:P,version:b,kind:M});return O}},43535:(k,R,e)=>{"use strict";e.d(R,{o:()=>n});var t=e(32196);function n(i){return{myTable:(0,t.css)`
      max-height: 204px;
      overflow-y: auto;
      margin-top: 11px;
      margin-bottom: 28px;
      border-radius: ${i.shape.radius.default};
      border: 1px solid ${i.colors.action.hover};
      background: ${i.colors.background.primary};
      color: ${i.colors.text.secondary};
      font-size: ${i.typography.h6.fontSize};
      width: 100%;

      thead {
        color: #538ade;
        font-size: ${i.typography.bodySmall.fontSize};
      }

      th,
      td {
        padding: 6px 13px;
        height: ${i.spacing(4)};
      }

      tbody > tr:nth-child(odd) {
        background: ${i.colors.background.secondary};
      }
    `,noteTextbox:(0,t.css)`
      margin-bottom: ${i.spacing(4)};
    `,textInfo:(0,t.css)`
      color: ${i.colors.text.secondary};
      font-size: ${i.typography.size.sm};
    `,dashboardSearch:(0,t.css)`
      margin-top: ${i.spacing(2)};
    `,modal:(0,t.css)`
      width: 500px;
    `,modalText:(0,t.css)`
      font-size: ${i.typography.h4.fontSize};
      color: ${i.colors.text.primary};
      margin-bottom: ${i.spacing(4)};
      padding-top: ${i.spacing(2)};
    `}}},98796:(k,R,e)=>{"use strict";e.d(R,{i:()=>t});var t=(i=>(i[i.Panel=1]="Panel",i))(t||{}),n=(i=>(i[i.Dashboard=1]="Dashboard",i))(n||{})},88861:(k,R,e)=>{"use strict";e.d(R,{b:()=>h});var t=e(5805),n=e(17172),i=e(3169),s=e(8484),r=e(57767);async function g(f,d){const p=a(f),m=await o(p,d);return c(f,m),m}function a(f){let{scopedVars:d,...p}=f.getSaveModel();return p={libraryPanel:{name:f.title,uid:void 0},...p},p}function c(f,d){f.restoreModel({...d.model,configRev:0,libraryPanel:d,title:f.title}),f.hasSavedPanelEditChange=!0,f.refresh()}function o(f,d){return f.libraryPanel?f.libraryPanel&&f.libraryPanel.uid===""?(0,r.d7)(f,d):(0,r.jc)(f):Promise.reject()}const h=()=>{const f=(0,i._2)(),[d,p]=(0,t.default)(async(m,v)=>{try{const l=await g(m,v);return f.success((0,s.t)("library-panels.save.success","Library panel saved")),l}catch(l){throw(0,n.NF)(l)&&(l.isHandled=!0,f.error((0,s.t)("library-panels.save.error",'Error saving library panel: "{{errorMsg}}"',{errorMsg:l.message??l.data.message}))),l}},[]);return{state:d,saveLibraryPanel:p}}},6473:(k,R,e)=>{"use strict";e.d(R,{t:()=>D});var t=e(62938),n=e(55004),i=e(26272),s=e(78731),r=e(39601),g=e(10096),a=e(28444),c=e(14792),o=e(74848),h=e(32196),f=e(40845),d=e(37390),p=e(55852),m=(E=>(E.Saved="saved",E.EditingStarted="editing-started",E.EditingCanceled="editing-cancelled",E.Deleted="deleted",E))(m||{});function v({onDismiss:E,event:x}){const P=(0,f.of)(l),b=()=>{if(x?.action===m.Deleted){r.Ny.push("/");return}D.reloadPage(),E()};return(0,o.jsxs)(d.a,{isOpen:!0,title:"Dashboard changed",icon:"copy",onDismiss:E,onClickBackdrop:()=>{},className:P.modal,children:[(0,o.jsx)("div",{className:P.description,children:"The dashboad has been updated by another session. Do you want to continue editing or discard your local changes?"}),(0,o.jsxs)(d.a.ButtonRow,{children:[(0,o.jsx)(p.$n,{onClick:E,variant:"secondary",fill:"outline",children:"Continue editing"}),(0,o.jsx)(p.$n,{onClick:b,variant:"destructive",children:"Discard local changes"})]})]})}const l=E=>({modal:(0,h.css)({width:"600px"}),description:(0,h.css)({color:E.colors.text.secondary,paddingBottom:E.spacing(1)})}),y=(0,t.A)();class u{constructor(){this.editing=!1,this.observer={next:x=>{if((0,n.ew)(x)&&this.editing&&x.state===n.ZF.Connected&&this.sendEditingState(),(0,n.Z7)(x)){if(x.message.sessionId===y)return;const{action:P}=x.message;switch(P){case m.EditingStarted:case m.Saved:{if(this.ignoreSave){this.ignoreSave=!1;return}const b=(0,c.UA)().getCurrent();if(b?.uid!==x.message.uid){console.log("dashboard event for different dashboard?",x,b);return}const M=this.editing||b.hasUnsavedChanges();if(P===m.Saved)M?g.lE.publish(new a.S8({component:v,props:{event:x}})):(g.lE.emit(i.r1.alertSuccess,["Dashboard updated"]),this.reloadPage());else if(M&&P===m.EditingStarted&&!this.hasSeenNotice){const O=x.message,I=this.getRecentEditingEvent();(!I||I.message!==O.message)&&(this.hasSeenNotice=!0,g.lE.emit(i.r1.alertWarning,["Another session is editing this dashboard",O.message])),this.lastEditing=O}return}}}}}}setEditingState(x){const P=this.editing=x;this.editing=x,this.hasSeenNotice=!1,P&&g.TP.isEditor&&this.sendEditingState()}sendEditingState(){const{channel:x,uid:P}=this;x&&P&&(0,s.oF)().publish(x,{sessionId:y,uid:P,action:this.editing?m.EditingStarted:m.EditingCanceled,timestamp:Date.now()})}watch(x){const P=(0,s.oF)();P&&x!==this.uid&&(this.channel={scope:n.qD.Grafana,namespace:"dashboard",path:`uid/${x}`},this.leave(),x&&(this.subscription=P.getStream(this.channel).subscribe(this.observer)),this.uid=x)}leave(){this.subscription&&this.subscription.unsubscribe(),this.subscription=void 0,this.uid=void 0}ignoreNextSave(){this.ignoreSave=!0}getRecentEditingEvent(){return this.lastEditing&&this.lastEditing.timestamp&&Date.now()-this.lastEditing.timestamp>5e3&&(this.lastEditing=void 0),this.lastEditing}reloadPage(){r.Ny.reload()}}const D=new u},47118:(k,R,e)=>{"use strict";e.d(R,{_w:()=>n,o$:()=>g,ot:()=>i});var t=e(14236),n=(a=>(a.NewValuesSameSchema="NewValuesSameSchema",a.FullFrame="FullFrame",a))(n||{});const i=(a,c)=>"type"in a&&a.type===c,s=Object.values(n),r=a=>"type"in a&&s.includes(a.type),g=a=>(0,t.ci)(a)&&"packetInfo"in a},39408:(k,R,e)=>{"use strict";e.d(R,{l:()=>i});var t=e(89667),n=e(17172);async function i(){return(0,n.AI)().get("api/live/list").then(s=>{const r=s.channels??[],g={},a=r.map(c=>{if(c.data){const o=new Set,h=(0,t.or)(c.data);for(const f of h.fields)o.add(f.name);g[c.channel]=Array.from(o).map(f=>({value:f,label:f}))}return{value:c.channel,label:c.channel+" ["+c.minute_rate+" msg/min]"}});return{channelFields:g,channels:a}})}},81073:(k,R,e)=>{"use strict";e.d(R,{I:()=>s});var t=e(74848),n=e(32196),i=e(62930);const s=({adjective:g="newer"})=>{const a=`Loading ${g} logs...`;return(0,t.jsx)("div",{className:r,children:(0,t.jsxs)("div",{children:[a," ",(0,t.jsx)(i.y,{inline:!0})]})})},r=(0,n.css)`
  display: flex;
  justify-content: center;
`},93463:(k,R,e)=>{"use strict";e.d(R,{A:()=>c,h:()=>a});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(56034);const g=["level","lvl","filename"],a=(0,i.memo)(({labels:f,emptyMessage:d})=>{const p=(0,s.of)(h),m=(0,i.useMemo)(()=>Object.keys(f).filter(v=>!v.startsWith("_")&&!g.includes(v)).sort(),[f]);return m.length===0&&d?(0,t.jsx)("span",{className:(0,n.cx)([p.logsLabels]),children:(0,t.jsx)("span",{className:(0,n.cx)([p.logsLabel]),children:d})}):(0,t.jsx)("span",{className:(0,n.cx)([p.logsLabels]),children:m.map(v=>{const l=f[v];if(!l)return;const y=`${v}=${l}`;return(0,t.jsx)(r.m,{content:y,placement:"top",children:(0,t.jsx)(o,{styles:p,children:y})},v)})})});a.displayName="LogLabels";const c=(0,i.memo)(({labels:f})=>{const d=(0,s.of)(h);return(0,t.jsx)("span",{className:(0,n.cx)([d.logsLabels]),children:f.map(p=>(0,t.jsx)(o,{styles:d,tooltip:p,children:p},p))})});c.displayName="LogLabelsList";const o=(0,i.forwardRef)(({styles:f,tooltip:d,children:p},m)=>(0,t.jsx)("span",{className:(0,n.cx)([f.logsLabel]),ref:m,children:(0,t.jsx)("span",{className:(0,n.cx)([f.logsLabelValue]),title:d,children:p})}));o.displayName="LogLabel";const h=f=>({logsLabels:(0,n.css)`
      display: flex;
      flex-wrap: wrap;
      font-size: ${f.typography.size.xs};
    `,logsLabel:(0,n.css)`
      label: logs-label;
      display: flex;
      padding: ${f.spacing(0,.25)};
      background-color: ${f.colors.background.secondary};
      border-radius: ${f.shape.radius.default};
      margin: ${f.spacing(.125,.5,0,0)};
      text-overflow: ellipsis;
      white-space: nowrap;
      overflow: hidden;
    `,logsLabelValue:(0,n.css)`
      label: logs-label__value;
      display: inline-block;
      max-width: ${f.spacing(25)};
      text-overflow: ellipsis;
      overflow: hidden;
    `})},85492:(k,R,e)=>{"use strict";e.d(R,{$:()=>h});var t=e(74848),n=e(88838),i=e(96540),s=e(23257),r=e.n(s),g=e(21),a=e(40845);function c(f,d){return d.split(/;\s*/).reduce((p,m)=>{if(m==="color:rgba(0,0,0,0.5)")return{color:f.colors.text.secondary};const v=m.match(/([^:\s]+)\s*:\s*(.+)/);if(v&&v[1]&&v[2]){const l=v[1].replace(/-([a-z])/g,(y,u)=>u.toUpperCase());p[l]=v[2]}return p},{})}class o extends i.PureComponent{constructor(){super(...arguments),this.state={chunks:[],prevValue:""}}static getDerivedStateFromProps(d,p){return d.value===p.prevValue?null:{chunks:n.Ay.parse(d.value).spans.map(v=>v.css?{style:c(d.theme,v.css),text:v.text}:{text:v.text}),prevValue:d.value}}render(){const{chunks:d}=this.state;return d.map((p,m)=>{const v=this.props.highlight?.searchWords?(0,t.jsx)(r(),{textToHighlight:p.text,searchWords:this.props.highlight.searchWords,findChunks:g.Oq,highlightClassName:this.props.highlight.highlightClassName},m):p.text;return p.style?(0,t.jsx)("span",{style:p.style,"data-testid":"ansiLogLine",children:v},m):v})}}const h=(0,a.cV)(o);h.displayName="LogMessageAnsi"},42785:(k,R,e)=>{"use strict";e.d(R,{Q:()=>o});var t=e(74848),n=e(96540),i=e(76885),s=e(71733),r=e(43127),g=e(29158),a=e(10534),c=e(2913);const o=(0,n.memo)(({logText:h,onOpenContext:f,onPermalinkClick:d,onPinLine:p,onUnpinLine:m,pinLineButtonTooltipTitle:v,pinned:l,row:y,showContextToggle:u,styles:D,mouseIsOver:E,onBlur:x,getRowContextQuery:P})=>{const b=u?u(y):!1,M=(0,n.useCallback)(C=>{C.stopPropagation()},[]),O=(0,n.useCallback)(async C=>{if(C.stopPropagation(),P&&(C.nativeEvent.ctrlKey||C.nativeEvent.metaKey||C.nativeEvent.shiftKey)){const S=window.open("about:blank"),A=await P(y,void 0,!1);if(A&&S){const L=i.kM.renderUrl(s.I.assureBaseUrl(`${(0,c.zj)().appSubUrl}explore`),{left:JSON.stringify({datasource:A.datasource,queries:[A],range:(0,r.E2)()})});S.location=L;return}S?.close()}f(y)},[f,P,y]),I=(0,n.useCallback)(C=>{!C.currentTarget.contains(C.relatedTarget)&&x&&x()},[x]),T=(0,n.useCallback)(()=>h,[h]);return(0,t.jsxs)("span",{className:`log-row-menu ${D.rowMenu}`,onClick:M,onBlur:I,children:[l&&!E&&(0,t.jsx)(g.K,{className:D.unPinButton,size:"md",name:"gf-pin",onClick:()=>m&&m(y),tooltip:"Unpin line",tooltipPlacement:"top","aria-label":"Unpin line",tabIndex:0}),E&&(0,t.jsxs)(t.Fragment,{children:[b&&(0,t.jsx)(g.K,{size:"md",name:"gf-show-context",onClick:O,tooltip:"Show context",tooltipPlacement:"top","aria-label":"Show context",tabIndex:0}),(0,t.jsx)(a.b,{className:D.copyLogButton,icon:"copy",variant:"secondary",fill:"text",size:"md",getText:T,tooltip:"Copy to clipboard",tooltipPlacement:"top",tabIndex:0}),l&&m&&(0,t.jsx)(g.K,{className:D.unPinButton,size:"md",name:"gf-pin",onClick:()=>m&&m(y),tooltip:"Unpin line",tooltipPlacement:"top","aria-label":"Unpin line",tabIndex:0}),!l&&p&&(0,t.jsx)(g.K,{className:D.unPinButton,size:"md",name:"gf-pin",onClick:()=>p&&p(y),tooltip:v??"Pin line",tooltipPlacement:"top","aria-label":"Pin line",tabIndex:0}),d&&y.rowId!==void 0&&y.uid&&(0,t.jsx)(g.K,{tooltip:"Copy shortlink","aria-label":"Copy shortlink",tooltipPlacement:"top",size:"md",name:"share-alt",onClick:()=>d(y),tabIndex:0})]})]})});o.displayName="LogRowMenuCell"},40455:(k,R,e)=>{"use strict";e.d(R,{S:()=>c,a:()=>f});var t=e(74848),n=e(96540),i=e(23257),s=e.n(i),r=e(21),g=e(85492),a=e(42785);const c=1e5,o=({hasAnsi:d,entry:p,highlights:m,styles:v})=>{const l=m&&m.length>0&&m[0]&&m[0].length>0&&p.length<c,y=m??[];if(d){const u=l?{searchWords:y,highlightClassName:v.logsRowMatchHighLight}:void 0;return(0,t.jsx)(g.$,{value:p,highlight:u})}else if(l)return(0,t.jsx)(s(),{textToHighlight:p,searchWords:y,findChunks:r.Oq,highlightClassName:v.logsRowMatchHighLight});return(0,t.jsx)(t.Fragment,{children:p})},h=(d,p,m,v)=>{if(p)try{return JSON.stringify(JSON.parse(d),void 0,2)}catch{}return!m&&!v&&(d=d.replace(/(\r\n|\n|\r)/g,"")),d},f=(0,n.memo)(d=>{const{row:p,wrapLogMessage:m,prettifyLogMessage:v,showContextToggle:l,styles:y,onOpenContext:u,onPermalinkClick:D,onUnpinLine:E,onPinLine:x,pinLineButtonTooltipTitle:P,pinned:b,mouseIsOver:M,onBlur:O,getRowContextQuery:I,expanded:T}=d,{hasAnsi:C,raw:S}=p,A=(0,n.useMemo)(()=>h(S,v,m,!!T),[S,v,m,T]),L=(0,n.useMemo)(()=>M||b,[M,b]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("td",{className:y.logsRowMessage,children:(0,t.jsx)("div",{className:m?y.positionRelative:y.horizontalScroll,children:(0,t.jsx)("button",{className:`${y.logLine} ${y.positionRelative}`,children:(0,t.jsx)(o,{hasAnsi:C,entry:A,highlights:p.searchWords,styles:y})})})}),(0,t.jsx)("td",{className:`log-row-menu-cell ${y.logRowMenuCell}`,children:L&&(0,t.jsx)(a.Q,{logText:A,row:p,showContextToggle:l,getRowContextQuery:I,onOpenContext:u,onPermalinkClick:D,onPinLine:x,onUnpinLine:E,pinLineButtonTooltipTitle:P,pinned:b,styles:y,mouseIsOver:M,onBlur:O})})]})});f.displayName="LogRowMessage"},14647:(k,R,e)=>{"use strict";e.d(R,{k:()=>z});var t=e(74848),n=e(32196),i=e(41811),s=e(96540),r=e(52622),g=e(32264),a=e(40845),c=e(14110),o=e(38138),h=e(91002);const f=({x:ee,y:se,onClickFilterString:ie,onClickFilterOutString:Z,selection:oe,row:ce,close:ye})=>{const re=(0,s.useRef)(null),ue=(0,a.of)(p);return(0,s.useEffect)(()=>{function ge(Te){Te.key==="Escape"&&ye()}return document.addEventListener("keyup",ge),()=>{document.removeEventListener("keyup",ge)}},[ye]),ie||Z?(0,t.jsx)("div",{className:ue.menu,style:{top:se,left:ee},children:(0,t.jsxs)(o.W,{ref:re,children:[(0,t.jsx)(o.W.Item,{label:"Copy selection",onClick:()=>{(0,h.Dk)(oe,re),ye(),d("copy",oe.length,ce.datasourceType)}}),ie&&(0,t.jsx)(o.W.Item,{label:"Add as line contains filter",onClick:()=>{ie(oe,ce.dataFrame.refId),ye(),d("line_contains",oe.length,ce.datasourceType)}}),Z&&(0,t.jsx)(o.W.Item,{label:"Add as line does not contain filter",onClick:()=>{Z(oe,ce.dataFrame.refId),ye(),d("line_does_not_contain",oe.length,ce.datasourceType)}})]})}):null};function d(ee,se,ie){(0,c.rR)("grafana_explore_logs_popover_menu",{action:ee,selectionLength:se,datasourceType:ie||"unknown"})}const p=ee=>({menu:(0,n.css)({position:"fixed",zIndex:ee.zIndex.modal})});class m{constructor(){this.seen=new Set,this.count=0}getKey(se){this.count+=1;const ie=`k_${se}`;return this.seen.has(ie)?`i_${this.count}`:(this.seen.add(ie),ie)}}var v=e(2543),l=e(72724),y=e(56034),u=e(14578),D=e(41260),E=e(41987),x=e(10534),P=e(29158),b=e(14689),M=e(69147),O=e(3911);const I=ee=>({logsStatsRow:(0,n.css)`
    label: logs-stats-row;
    margin: ${parseInt(ee.spacing(2),10)/1.75}px 0;
  `,logsStatsRowActive:(0,n.css)`
    label: logs-stats-row--active;
    color: ${ee.colors.primary.text};
    position: relative;
  `,logsStatsRowLabel:(0,n.css)`
    label: logs-stats-row__label;
    display: flex;
    margin-bottom: 1px;
  `,logsStatsRowValue:(0,n.css)`
    label: logs-stats-row__value;
    flex: 1;
    text-overflow: ellipsis;
    overflow: hidden;
  `,logsStatsRowCount:(0,n.css)`
    label: logs-stats-row__count;
    text-align: right;
    margin-left: ${ee.spacing(.75)};
  `,logsStatsRowPercent:(0,n.css)`
    label: logs-stats-row__percent;
    text-align: right;
    margin-left: ${ee.spacing(.75)};
    width: ${ee.spacing(4.5)};
  `,logsStatsRowBar:(0,n.css)`
    label: logs-stats-row__bar;
    height: ${ee.spacing(.5)};
    overflow: hidden;
    background: ${ee.colors.text.disabled};
  `,logsStatsRowInnerBar:(0,n.css)`
    label: logs-stats-row__innerbar;
    height: ${ee.spacing(.5)};
    overflow: hidden;
    background: ${ee.colors.primary.main};
  `}),T=({active:ee,count:se,proportion:ie,value:Z})=>{const oe=(0,a.of)(I),ce=`${Math.round(ie*100)}%`,ye={width:ce},re=ee?(0,n.cx)([oe.logsStatsRow,oe.logsStatsRowActive]):(0,n.cx)([oe.logsStatsRow]);return(0,t.jsxs)("div",{className:re,children:[(0,t.jsxs)("div",{className:(0,n.cx)([oe.logsStatsRowLabel]),children:[(0,t.jsx)("div",{className:(0,n.cx)([oe.logsStatsRowValue]),title:Z,children:Z}),(0,t.jsx)("div",{className:(0,n.cx)([oe.logsStatsRowCount]),children:se}),(0,t.jsx)("div",{className:(0,n.cx)([oe.logsStatsRowPercent]),children:ce})]}),(0,t.jsx)("div",{className:(0,n.cx)([oe.logsStatsRowBar]),children:(0,t.jsx)("div",{className:(0,n.cx)([oe.logsStatsRowInnerBar]),style:ye})})]})};T.displayName="LogLabelStatsRow";const C=5,S=(0,O.N)(ee=>({logsStats:(0,n.css)`
      label: logs-stats;
      background: inherit;
      color: ${ee.colors.text.primary};
      word-break: break-all;
      width: fit-content;
      max-width: 100%;
    `,logsStatsHeader:(0,n.css)`
      label: logs-stats__header;
      border-bottom: 1px solid ${ee.colors.border.medium};
      display: flex;
    `,logsStatsTitle:(0,n.css)`
      label: logs-stats__title;
      font-weight: ${ee.typography.fontWeightMedium};
      padding-right: ${ee.spacing(2)};
      display: inline-block;
      white-space: nowrap;
      text-overflow: ellipsis;
      flex-grow: 1;
    `,logsStatsClose:(0,n.css)`
      label: logs-stats__close;
      cursor: pointer;
    `,logsStatsBody:(0,n.css)`
      label: logs-stats__body;
      padding: 5px 0px;
    `}));class A extends s.PureComponent{render(){const{label:se,rowCount:ie,stats:Z,value:oe,theme:ce,isLabel:ye}=this.props,re=S(ce),ue=Z.slice(0,C);let De=ue.find(Ne=>Ne.value===oe),ge=Z.slice(C);const Te=!De;Te&&(De=ge.find(Ne=>Ne.value===oe),ge=ge.filter(Ne=>Ne.value!==oe));const Le=ge.reduce((Ne,Pe)=>Ne+Pe.count,0),je=ue.reduce((Ne,Pe)=>Ne+Pe.count,0)+Le,Ze=Le/je;return(0,t.jsxs)("div",{className:re.logsStats,"data-testid":"logLabelStats",children:[(0,t.jsx)("div",{className:re.logsStatsHeader,children:(0,t.jsxs)("div",{className:re.logsStatsTitle,children:[se,": ",je," of ",ie," rows have that ",ye?"label":"field"]})}),(0,t.jsxs)("div",{className:re.logsStatsBody,children:[ue.map(Ne=>(0,t.jsx)(T,{...Ne,active:Ne.value===oe},Ne.value)),Te&&De&&(0,t.jsx)(T,{...De,active:!0},De.value),Le>0&&(0,t.jsx)(T,{count:Le,value:"Other",proportion:Ze},"__OTHERS__")]})]})}}const L=(0,a.cV)(A);L.displayName="LogLabelStats";var N=e(77020);const F=(0,i.A)(ee=>({wordBreakAll:(0,n.css)`
      label: wordBreakAll;
      word-break: break-all;
    `,copyButton:(0,n.css)`
      & > button {
        color: ${ee.colors.text.secondary};
        padding: 0;
        justify-content: center;
        border-radius: ${ee.shape.radius.circle};
        height: ${ee.spacing(ee.components.height.sm)};
        width: ${ee.spacing(ee.components.height.sm)};
        svg {
          margin: 0;
        }

        span > div {
          top: -5px;
          & button {
            color: ${ee.colors.success.main};
          }
        }
      }
    `,adjoiningLinkButton:(0,n.css)`
      margin-left: ${ee.spacing(1)};
    `,wrapLine:(0,n.css)`
      label: wrapLine;
      white-space: pre-wrap;
    `,logDetailsStats:(0,n.css)`
      padding: 0 ${ee.spacing(1)};
    `,logDetailsValue:(0,n.css)`
      display: flex;
      align-items: center;
      line-height: 22px;

      .log-details-value-copy {
        visibility: hidden;
      }
      &:hover {
        .log-details-value-copy {
          visibility: visible;
        }
      }
    `,buttonRow:(0,n.css)`
      display: flex;
      flex-direction: row;
      gap: ${ee.spacing(.5)};
      margin-left: ${ee.spacing(.5)};
    `}));class w extends s.PureComponent{constructor(){super(...arguments),this.state={showFieldsStats:!1,fieldCount:0,fieldStats:null},this.showField=()=>{const{onClickShowField:se,parsedKeys:ie,row:Z}=this.props;se&&se(ie[0]),(0,c.rR)("grafana_explore_logs_log_details_replace_line_clicked",{datasourceType:Z.datasourceType,logRowUid:Z.uid,type:"enable"})},this.hideField=()=>{const{onClickHideField:se,parsedKeys:ie,row:Z}=this.props;se&&se(ie[0]),(0,c.rR)("grafana_explore_logs_log_details_replace_line_clicked",{datasourceType:Z.datasourceType,logRowUid:Z.uid,type:"disable"})},this.isFilterLabelActive=async()=>{const{isFilterLabelActive:se,parsedKeys:ie,parsedValues:Z,row:oe}=this.props;return se?await se(ie[0],Z[0],oe.dataFrame?.refId):!1},this.filterLabel=()=>{const{onClickFilterLabel:se,parsedKeys:ie,parsedValues:Z,row:oe}=this.props;se&&se(ie[0],Z[0],(0,M.f8)(oe)||void 0),(0,c.rR)("grafana_explore_logs_log_details_filter_clicked",{datasourceType:oe.datasourceType,filterType:"include",logRowUid:oe.uid})},this.filterOutLabel=()=>{const{onClickFilterOutLabel:se,parsedKeys:ie,parsedValues:Z,row:oe}=this.props;se&&se(ie[0],Z[0],(0,M.f8)(oe)||void 0),(0,c.rR)("grafana_explore_logs_log_details_filter_clicked",{datasourceType:oe.datasourceType,filterType:"exclude",logRowUid:oe.uid})},this.updateStats=()=>{const{getStats:se}=this.props,ie=se(),Z=ie?ie.reduce((oe,ce)=>oe+ce.count,0):0;(!(0,v.isEqual)(this.state.fieldStats,ie)||Z!==this.state.fieldCount)&&this.setState({fieldStats:ie,fieldCount:Z})},this.showStats=()=>{const{isLabel:se,row:ie,app:Z}=this.props,{showFieldsStats:oe}=this.state;oe||this.updateStats(),this.toggleFieldsStats(),(0,c.rR)("grafana_explore_logs_log_details_stats_clicked",{dataSourceType:ie.datasourceType,fieldType:se?"label":"detectedField",type:oe?"close":"open",logRowUid:ie.uid,app:Z})}}componentDidUpdate(){this.state.showFieldsStats&&this.updateStats()}toggleFieldsStats(){this.setState(se=>({showFieldsStats:!se.showFieldsStats}))}generateClipboardButton(se){const{theme:ie}=this.props,Z=F(ie);return(0,t.jsx)("div",{className:`log-details-value-copy ${Z.copyButton}`,children:(0,t.jsx)(x.b,{getText:()=>se,title:"Copy value to clipboard",fill:"text",variant:"secondary",icon:"copy",size:"md"})})}generateMultiVal(se,ie){return(0,t.jsx)("table",{children:(0,t.jsx)("tbody",{children:se?.map((Z,oe)=>(0,t.jsx)("tr",{children:(0,t.jsxs)("td",{children:[Z,ie&&Z!==""&&this.generateClipboardButton(Z)]})},`${Z}-${oe}`))})})}render(){const{theme:se,parsedKeys:ie,parsedValues:Z,isLabel:oe,links:ce,displayedFields:ye,wrapLogMessage:re,onClickFilterLabel:ue,onClickFilterOutLabel:De,disableActions:ge,row:Te,app:Le,onPinLine:Ye,pinLineButtonTooltipTitle:je}=this.props,{showFieldsStats:Ze,fieldStats:Ne,fieldCount:Pe}=this.state,Ue=F(se),$e=(0,N.D)(se),ze=ie==null?!1:ie.length===1,qe=Z==null?!1:Z.length===1,dt=!ge&&ue&&De,vt=Le===E.Jk.Explore&&Te.dataFrame?.refId?` in query ${Te.dataFrame?.refId}`:"",yt=!qe&&Z!=null&&!Z.every(Ve=>Ve===""),st=ye&&ie!=null&&ye.includes(ie[0])?(0,t.jsx)(P.K,{variant:"primary",tooltip:"Hide this field",name:"eye",onClick:this.hideField}):(0,t.jsx)(P.K,{tooltip:"Show this field instead of the message",name:"eye",onClick:this.showField});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("tr",{className:$e.logDetailsValue,children:[(0,t.jsx)("td",{className:$e.logsDetailsIcon,children:(0,t.jsxs)("div",{className:Ue.buttonRow,children:[dt&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(B,{name:"search-plus",onClick:this.filterLabel,isActive:()=>this.isFilterLabelActive(),tooltipSuffix:vt}),(0,t.jsx)(P.K,{name:"search-minus",tooltip:`Filter out value${vt}`,onClick:this.filterOutLabel})]}),!ge&&ye&&st,!ge&&(0,t.jsx)(P.K,{variant:Ze?"primary":"secondary",name:"signal",tooltip:"Ad-hoc statistics",className:"stats-button",disabled:!ze,onClick:this.showStats})]})}),(0,t.jsx)("td",{className:$e.logDetailsLabel,children:ze?ie[0]:this.generateMultiVal(ie)}),(0,t.jsx)("td",{className:(0,n.cx)(Ue.wordBreakAll,re&&Ue.wrapLine),children:(0,t.jsxs)("div",{className:Ue.logDetailsValue,children:[qe?Z[0]:this.generateMultiVal(Z,!0),qe&&this.generateClipboardButton(Z[0]),(0,t.jsx)("div",{className:(0,n.cx)((qe||yt)&&Ue.adjoiningLinkButton),children:ce?.map((Ve,pe)=>{if(Ve.onClick&&Ye){const Ee=Ve.onClick;Ve.onClick=(me,ve)=>{Ye(Te,!1),Ee(me,ve)}}return(0,t.jsx)("span",{children:(0,t.jsx)(b.R,{buttonProps:{tooltip:typeof je=="object"&&Ve.onClick?je:void 0},link:Ve})},`${Ve.title}-${pe}`)})})]})})]}),Ze&&ze&&qe&&(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:(0,t.jsx)(P.K,{variant:Ze?"primary":"secondary",name:"signal",tooltip:"Hide ad-hoc statistics",onClick:this.showStats})}),(0,t.jsx)("td",{colSpan:2,children:(0,t.jsx)("div",{className:Ue.logDetailsStats,children:(0,t.jsx)(L,{stats:Ne,label:ie[0],value:Z[0],rowCount:Pe,isLabel:oe})})})]})]})}}const B=({isActive:ee,tooltipSuffix:se,...ie})=>{const[Z,oe]=(0,s.useState)(!1),ce=Z?"Remove filter":"Filter for value";return(0,s.useEffect)(()=>{ee().then(oe)},[ee]),(0,t.jsx)(P.K,{...ie,variant:Z?"primary":void 0,tooltip:ce+se})},U=(0,a.cV)(w);U.displayName="LogDetailsRow";var K=e(70377);class V extends s.PureComponent{render(){const{app:se,row:ie,theme:Z,hasError:oe,onClickFilterOutLabel:ce,onClickFilterLabel:ye,getRows:re,showDuplicates:ue,className:De,onClickShowField:ge,onClickHideField:Te,displayedFields:Le,getFieldLinks:Ye,wrapLogMessage:je,onPinLine:Ze,styles:Ne,pinLineButtonTooltipTitle:Pe}=this.props,Ue=(0,N.L)(Z,ie.logLevel),$e=ie.labels?ie.labels:{},ze=Object.keys($e).length>0,qe=(0,K.jE)(ie,Ye);let dt=qe.filter(ve=>ve.links?.length);const vt=dt.filter(ve=>ve.fieldIndex!==ie.entryFieldIndex).sort(),yt=dt.filter(ve=>ve.fieldIndex===ie.entryFieldIndex).sort(),st=(0,K.qE)(yt),Ve=vt&&vt.length>0||st&&st.length>0,pe=ie.dataFrame.meta?.type===D.m.LogLines?[]:qe.filter(ve=>ve.links?.length===0&&ve.fieldIndex!==ie.entryFieldIndex).sort(),Ee=pe&&pe.length>0,me=oe?"":`${Ue.logsRowLevelColor} ${Ne.logsRowLevel} ${Ne.logsRowLevelDetails}`;return(0,t.jsxs)("tr",{className:(0,n.cx)(De,Ne.logDetails),children:[ue&&(0,t.jsx)("td",{}),(0,t.jsx)("td",{className:me,"aria-label":"Log level"}),(0,t.jsx)("td",{colSpan:4,children:(0,t.jsx)("div",{className:Ne.logDetailsContainer,children:(0,t.jsx)("table",{className:Ne.logDetailsTable,children:(0,t.jsxs)("tbody",{children:[(ze||Ee)&&(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:100,className:Ne.logDetailsHeading,"aria-label":"Fields",children:"Fields"})}),Object.keys($e).sort().map((ve,Se)=>{const Ie=$e[ve];return(0,t.jsx)(U,{parsedKeys:[ve],parsedValues:[Ie],isLabel:!0,getStats:()=>(0,h.Tj)(re(),ve),onClickFilterOutLabel:ce,onClickFilterLabel:ye,onClickShowField:ge,onClickHideField:Te,row:ie,app:se,wrapLogMessage:je,displayedFields:Le,disableActions:!1,isFilterLabelActive:this.props.isFilterLabelActive},`${ve}=${Ie}-${Se}`)}),pe.map((ve,Se)=>{const{keys:Ie,values:Oe,fieldIndex:Re}=ve;return(0,t.jsx)(U,{parsedKeys:Ie,parsedValues:Oe,onClickShowField:ge,onClickHideField:Te,onClickFilterOutLabel:ce,onClickFilterLabel:ye,getStats:()=>(0,h.s2)(ie.dataFrame.fields[Re].values),displayedFields:Le,wrapLogMessage:je,row:ie,app:se,disableActions:!1,isFilterLabelActive:this.props.isFilterLabelActive},`${Ie[0]}=${Oe[0]}-${Se}`)}),Ve&&(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:100,className:Ne.logDetailsHeading,"aria-label":"Data Links",children:"Links"})}),vt.map((ve,Se)=>{const{keys:Ie,values:Oe,links:Re,fieldIndex:he}=ve;return(0,t.jsx)(U,{parsedKeys:Ie,parsedValues:Oe,links:Re,onClickShowField:ge,onClickHideField:Te,onPinLine:Ze,pinLineButtonTooltipTitle:Pe,getStats:()=>(0,h.s2)(ie.dataFrame.fields[he].values),displayedFields:Le,wrapLogMessage:je,row:ie,app:se,disableActions:!1},`${Ie[0]}=${Oe[0]}-${Se}`)}),st?.map((ve,Se)=>{const{keys:Ie,values:Oe,links:Re,fieldIndex:he}=ve;return(0,t.jsx)(U,{parsedKeys:Ie,parsedValues:Oe,links:Re,onClickShowField:ge,onClickHideField:Te,onPinLine:Ze,pinLineButtonTooltipTitle:Pe,getStats:()=>(0,h.s2)(ie.dataFrame.fields[he].values),displayedFields:Le,wrapLogMessage:je,row:ie,app:se,disableActions:!0},`${Ie[0]}=${Oe[0]}-${Se}`)}),!Ee&&!ze&&!Ve&&(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:100,"aria-label":"No details",children:"No details available"})})]})})})})]})}}const H=(0,a.cV)(V);H.displayName="LogDetails";var Y=e(93463),X=e(40455),J=e(42785);const q=(0,s.memo)(ee=>{const{row:se,detectedFields:ie,getFieldLinks:Z,wrapLogMessage:oe,styles:ce,mouseIsOver:ye,pinned:re,...ue}=ee,De=oe?"":ae.noWrap,ge=(0,s.useMemo)(()=>(0,K.jE)(se,Z),[Z,se]),Te=(0,s.useMemo)(()=>{let Ye="";for(let je=0;je<ie.length;je++){const Ze=ie[je],Ne=ge.find(Pe=>{const{keys:Ue}=Pe;return Ue[0]===Ze});Ne&&(Ye+=` ${Ze}=${Ne.values}`),se.labels[Ze]!==void 0&&se.labels[Ze]!==null&&(Ye+=` ${Ze}=${se.labels[Ze]}`)}return Ye.trimStart()},[ie,ge,se.labels]),Le=(0,s.useMemo)(()=>ye||re,[ye,re]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("td",{className:ce.logsRowMessage,children:(0,t.jsx)("div",{className:De,children:Te})}),(0,t.jsx)("td",{className:`log-row-menu-cell ${ce.logRowMenuCell}`,children:Le&&(0,t.jsx)(J.Q,{logText:Te,row:se,styles:ce,pinned:re,mouseIsOver:ye,...ue})})]})}),ae={noWrap:(0,n.css)`
    white-space: nowrap;
  `};q.displayName="LogRowMessageDisplayedFields";class j extends s.PureComponent{constructor(se){super(se),this.state={permalinked:!1,showingContext:!1,showDetails:!1,mouseIsOver:!1},this.debouncedContextClose=(0,v.debounce)(()=>{this.setState({showingContext:!1})},3e3),this.onOpenContext=ie=>{this.setState({showingContext:!0}),this.props.onOpenContext(ie,this.debouncedContextClose)},this.onRowClick=ie=>{this.props.handleTextSelection?.(ie,this.props.row)||this.props.enableLogDetails&&this.setState(Z=>({showDetails:!Z.showDetails}))},this.onMouseEnter=()=>{this.setState({mouseIsOver:!0}),this.props.onLogRowHover&&this.props.onLogRowHover(this.props.row)},this.onMouseMove=ie=>{this.props.handleTextSelection&&document.getSelection()?.toString()&&ie.buttons>0&&this.setState({mouseIsOver:!1})},this.onMouseLeave=()=>{this.setState({mouseIsOver:!1})},this.scrollToLogRow=(ie,Z=!1)=>{const{row:oe,permalinkedRowId:ce,scrollIntoView:ye,containerRendered:re}=this.props;if(ce!==oe.uid){(ie.permalinked||Z)&&this.setState({permalinked:!1});return}!this.state.permalinked&&re&&this.logLineRef.current&&ye&&(ye(this.logLineRef.current),(0,c.rR)("grafana_explore_logs_permalink_opened",{datasourceType:oe.datasourceType??"unknown",logRowUid:oe.uid}),this.setState({permalinked:!0}))},this.escapeRow=(0,i.A)((ie,Z)=>ie.hasUnescapedContent&&Z?{...ie,entry:(0,h.Hw)(ie.entry),raw:(0,h.Hw)(ie.raw)}:ie),this.logLineRef=s.createRef()}renderTimeStamp(se){return(0,l.LE)(se,{timeZone:this.props.timeZone,defaultWithMS:!0})}componentDidMount(){this.scrollToLogRow(this.state,!0)}componentDidUpdate(se,ie){this.scrollToLogRow(ie)}render(){const{getRows:se,onClickFilterLabel:ie,onClickFilterOutLabel:Z,onClickShowField:oe,onClickHideField:ce,enableLogDetails:ye,row:re,showDuplicates:ue,showContextToggle:De,showLabels:ge,showTime:Te,displayedFields:Le,wrapLogMessage:Ye,prettifyLogMessage:je,theme:Ze,getFieldLinks:Ne,forceEscape:Pe,app:Ue,styles:$e,getRowContextQuery:ze,pinned:qe}=this.props,{showDetails:dt,showingContext:vt,permalinked:yt}=this.state,st=(0,N.L)(Ze,re.logLevel),{errorMessage:Ve,hasError:pe}=(0,h.Ei)(re),{sampleMessage:Ee,isSampled:me}=(0,h.qR)(re),ve=(0,n.cx)($e.logsRow,{[$e.errorLogRow]:pe,[$e.highlightBackground]:vt||yt||qe}),Se=(0,n.cx)($e.logsRow,{[$e.errorLogRow]:pe,[$e.highlightBackground]:yt&&!this.state.showDetails}),Ie=this.escapeRow(re,Pe);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("tr",{ref:this.logLineRef,className:ve,onClick:this.onRowClick,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onMouseMove:this.onMouseMove,onFocus:this.onMouseEnter,children:[ue&&(0,t.jsx)("td",{className:$e.logsRowDuplicates,children:Ie.duplicates&&Ie.duplicates>0?`${Ie.duplicates+1}x`:null}),(0,t.jsxs)("td",{className:pe||me?$e.logsRowWithError:`${st.logsRowLevelColor} ${$e.logsRowLevel}`,children:[pe&&(0,t.jsx)(y.m,{content:`Error: ${Ve}`,placement:"right",theme:"error",children:(0,t.jsx)(u.I,{className:$e.logIconError,name:"exclamation-triangle",size:"xs"})}),me&&(0,t.jsx)(y.m,{content:`${Ee}`,placement:"right",theme:"info",children:(0,t.jsx)(u.I,{className:$e.logIconInfo,name:"info-circle",size:"xs"})})]}),(0,t.jsx)("td",{title:ye?dt?"Hide log details":"See log details":"",className:ye?$e.logsRowToggleDetails:"",children:ye&&(0,t.jsx)(u.I,{className:$e.topVerticalAlign,name:dt?"angle-down":"angle-right"})}),Te&&(0,t.jsx)("td",{className:$e.logsRowLocalTime,children:this.renderTimeStamp(re.timeEpochMs)}),ge&&Ie.uniqueLabels&&(0,t.jsx)("td",{className:$e.logsRowLabels,children:(0,t.jsx)(Y.h,{labels:Ie.uniqueLabels})}),Le&&Le.length>0?(0,t.jsx)(q,{row:Ie,showContextToggle:De,detectedFields:Le,getFieldLinks:Ne,wrapLogMessage:Ye,onOpenContext:this.onOpenContext,onPermalinkClick:this.props.onPermalinkClick,styles:$e,onPinLine:this.props.onPinLine,onUnpinLine:this.props.onUnpinLine,pinned:this.props.pinned,mouseIsOver:this.state.mouseIsOver,onBlur:this.onMouseLeave}):(0,t.jsx)(X.a,{row:Ie,showContextToggle:De,getRowContextQuery:ze,wrapLogMessage:Ye,prettifyLogMessage:je,onOpenContext:this.onOpenContext,onPermalinkClick:this.props.onPermalinkClick,app:Ue,styles:$e,onPinLine:this.props.onPinLine,onUnpinLine:this.props.onUnpinLine,pinLineButtonTooltipTitle:this.props.pinLineButtonTooltipTitle,pinned:this.props.pinned,mouseIsOver:this.state.mouseIsOver,onBlur:this.onMouseLeave,expanded:this.state.showDetails})]}),this.state.showDetails&&(0,t.jsx)(H,{onPinLine:this.props.onPinLine,className:Se,showDuplicates:ue,getFieldLinks:Ne,onClickFilterLabel:ie,onClickFilterOutLabel:Z,onClickShowField:oe,onClickHideField:ce,getRows:se,row:Ie,wrapLogMessage:Ye,hasError:pe,displayedFields:Le,app:Ue,styles:$e,isFilterLabelActive:this.props.isFilterLabelActive,pinLineButtonTooltipTitle:this.props.pinLineButtonTooltipTitle})]})}}const te=(0,a.cV)(j);te.displayName="LogRow";const ne=100;class le extends s.PureComponent{constructor(){super(...arguments),this.renderAllTimer=null,this.logRowsRef=(0,s.createRef)(),this.state={renderAll:!1,selection:"",selectedRow:null,popoverMenuCoordinates:{x:0,y:0}},this.openContext=(se,ie)=>{this.props.onOpenContext&&this.props.onOpenContext(se,ie)},this.handleSelection=(se,ie)=>{if(this.popoverMenuSupported()===!1)return!1;const Z=document.getSelection()?.toString();if(!Z||!this.logRowsRef.current)return!1;const oe=270,ce=105,ye=se.clientX+oe>window.innerWidth?window.innerWidth-oe:se.clientX,re=se.clientY+ce>window.innerHeight?window.innerHeight-ce:se.clientY;return this.setState({selection:Z,popoverMenuCoordinates:{x:ye,y:re},selectedRow:ie}),document.addEventListener("click",this.handleDeselection),document.addEventListener("contextmenu",this.handleDeselection),!0},this.handleDeselection=se=>{if((0,h.a8)(se.target)&&!this.logRowsRef.current?.contains(se.target)){this.closePopoverMenu();return}document.getSelection()?.toString()||this.closePopoverMenu()},this.closePopoverMenu=()=>{document.removeEventListener("click",this.handleDeselection),document.removeEventListener("contextmenu",this.handleDeselection),this.setState({selection:"",popoverMenuCoordinates:{x:0,y:0},selectedRow:null})},this.makeGetRows=(0,i.A)(se=>()=>se),this.sortLogs=(0,i.A)((se,ie)=>(0,h.oR)(se,ie))}static{this.defaultProps={previewLimit:ne}}popoverMenuSupported(){return g.$.featureToggles.logRowsPopoverMenu?!!(this.props.onClickFilterOutString||this.props.onClickFilterString):!1}componentDidMount(){const{logRows:se,previewLimit:ie}=this.props,oe=(se?se.length:0)<=ie*2;oe?this.setState({renderAll:oe}):this.renderAllTimer=window.setTimeout(()=>this.setState({renderAll:!0}),2e3)}componentWillUnmount(){document.removeEventListener("click",this.handleDeselection),document.removeEventListener("contextmenu",this.handleDeselection),document.removeEventListener("selectionchange",this.handleDeselection),this.renderAllTimer&&clearTimeout(this.renderAllTimer)}render(){const{deduplicatedRows:se,logRows:ie,dedupStrategy:Z,theme:oe,logsSortOrder:ce,previewLimit:ye,pinnedLogs:re,...ue}=this.props,{renderAll:De}=this.state,ge=(0,N.D)(oe),Te=se||ie,Le=ie&&ie.length>0,Ye=Te?Te.reduce((qe,dt)=>dt.duplicates?qe+dt.duplicates:qe,0):0,je=Z!==r.fY.none&&Ye>0,Ze=Te||[],Ne=ce?this.sortLogs(Ze,ce):Ze,Pe=Ne.slice(0,ye),Ue=Ne.slice(ye,Ne.length),$e=this.makeGetRows(Ne),ze=new m;return(0,t.jsxs)("div",{className:ge.logRows,ref:this.logRowsRef,children:[this.state.selection&&this.state.selectedRow&&(0,t.jsx)(f,{close:this.closePopoverMenu,row:this.state.selectedRow,selection:this.state.selection,...this.state.popoverMenuCoordinates,onClickFilterString:ue.onClickFilterString,onClickFilterOutString:ue.onClickFilterOutString}),(0,t.jsx)("table",{className:(0,n.cx)(ge.logsRowsTable,this.props.overflowingContent?"":ge.logsRowsTableContain),children:(0,t.jsxs)("tbody",{children:[Le&&Pe.map(qe=>(0,t.jsx)(te,{getRows:$e,row:qe,showDuplicates:je,logsSortOrder:ce,onOpenContext:this.openContext,styles:ge,onPermalinkClick:this.props.onPermalinkClick,scrollIntoView:this.props.scrollIntoView,permalinkedRowId:this.props.permalinkedRowId,onPinLine:this.props.onPinLine,onUnpinLine:this.props.onUnpinLine,pinLineButtonTooltipTitle:this.props.pinLineButtonTooltipTitle,pinned:this.props.pinnedRowId===qe.uid||re?.some(dt=>dt===qe.rowId),isFilterLabelActive:this.props.isFilterLabelActive,handleTextSelection:this.popoverMenuSupported()?this.handleSelection:void 0,...ue},ze.getKey(qe.uid))),Le&&De&&Ue.map(qe=>(0,t.jsx)(te,{getRows:$e,row:qe,showDuplicates:je,logsSortOrder:ce,onOpenContext:this.openContext,styles:ge,onPermalinkClick:this.props.onPermalinkClick,scrollIntoView:this.props.scrollIntoView,permalinkedRowId:this.props.permalinkedRowId,onPinLine:this.props.onPinLine,onUnpinLine:this.props.onUnpinLine,pinLineButtonTooltipTitle:this.props.pinLineButtonTooltipTitle,pinned:this.props.pinnedRowId===qe.uid||re?.some(dt=>dt===qe.rowId),isFilterLabelActive:this.props.isFilterLabelActive,handleTextSelection:this.popoverMenuSupported()?this.handleSelection:void 0,...ue},ze.getKey(qe.uid))),Le&&!De&&(0,t.jsx)("tr",{children:(0,t.jsxs)("td",{colSpan:5,children:["Rendering ",Ne.length-ye," rows..."]})})]})})]})}}const z=(0,a.cV)(le);z.displayName="LogsRows"},77020:(k,R,e)=>{"use strict";e.d(R,{D:()=>c,L:()=>a});var t=e(32196),n=e(41811),i=e(84140),s=e(9557),r=e(23596),g=e(16797);const a=(o,h)=>{let f=o.isLight?o.v1.palette.gray5:o.v1.palette.gray2;switch(h){case s.$b.crit:case s.$b.critical:f="#705da0";break;case s.$b.error:case s.$b.err:f="#e24d42";break;case s.$b.warning:case s.$b.warn:f=o.colors.warning.main;break;case s.$b.info:f="#7eb26d";break;case s.$b.debug:f="#1f78c1";break;case s.$b.trace:f="#6ed0e0";break}return{logsRowLevelColor:(0,t.css)`
      &::after {
        background-color: ${f};
      }
    `}},c=(0,n.A)(o=>{const h=g.hoverColor(o.colors.background.secondary,o),f=(0,i.A)(o.components.dashboard.background).setAlpha(.7).toRgbString();return{logsRowLevel:(0,t.css)`
      label: logs-row__level;
      max-width: ${o.spacing(1.25)};
      cursor: default;
      &::after {
        content: '';
        display: block;
        position: absolute;
        top: 1px;
        bottom: 1px;
        width: 3px;
        left: ${o.spacing(.5)};
      }
    `,logsRowWithError:(0,t.css)({maxWidth:`${o.spacing(1.5)}`}),logsRowMatchHighLight:(0,t.css)`
      label: logs-row__match-highlight;
      background: inherit;
      padding: inherit;
      color: ${o.components.textHighlight.text}
      background-color: ${o.components.textHighlight};
    `,logRows:(0,t.css)({position:"relative"}),logsRowsTable:(0,t.css)`
      label: logs-rows;
      font-family: ${o.typography.fontFamilyMonospace};
      font-size: ${o.typography.bodySmall.fontSize};
      width: 100%;
      position: relative;
    `,logsRowsTableContain:(0,t.css)`
      contain: strict;
    `,highlightBackground:(0,t.css)`
      background-color: ${(0,i.A)(o.colors.info.transparent).setAlpha(.25).toString()};
    `,logsRow:(0,t.css)`
      label: logs-row;
      width: 100%;
      cursor: pointer;
      vertical-align: top;

      &:hover {
        .log-row-menu {
          z-index: 1;
        }

        background: ${h};
      }

      td:not(.log-row-menu-cell):last-child {
        width: 100%;
      }

      > td:not(.log-row-menu-cell) {
        position: relative;
        padding-right: ${o.spacing(1)};
        border-top: 1px solid transparent;
        border-bottom: 1px solid transparent;
        height: 100%;
      }
    `,logsRowDuplicates:(0,t.css)`
      label: logs-row__duplicates;
      text-align: right;
      width: 4em;
      cursor: default;
    `,logIconError:(0,t.css)({color:o.colors.warning.main,position:"relative",top:"-2px"}),logIconInfo:(0,t.css)({color:o.colors.info.main,position:"relative",top:"-2px"}),logsRowToggleDetails:(0,t.css)`
      label: logs-row-toggle-details__level;
      font-size: 9px;
      padding-top: 5px;
      max-width: 15px;
    `,logsRowLocalTime:(0,t.css)`
      label: logs-row__localtime;
      white-space: nowrap;
    `,logsRowLabels:(0,t.css)`
      label: logs-row__labels;
      white-space: nowrap;
      max-width: 22em;

      /* This is to make the labels vertical align */
      > span {
        margin-top: 0.75px;
      }
    `,logsRowMessage:(0,t.css)`
      label: logs-row__message;
      white-space: pre-wrap;
      word-break: break-all;
      overflow-wrap: anywhere;
      width: 100%;
      text-align: left;
    `,copyLogButton:(0,t.css)`
      padding: 0 0 0 ${o.spacing(.5)};
      height: ${o.spacing(3)};
      width: ${o.spacing(3.25)};
      line-height: ${o.spacing(2.5)};
      overflow: hidden;
      &:hover {
          background-color: ${r.MV.alpha(o.colors.text.primary,.12)};
        }
      }
    `,logDetailsContainer:(0,t.css)`
      label: logs-row-details-table;
      border: 1px solid ${o.colors.border.medium};
      padding: 0 ${o.spacing(1)} ${o.spacing(1)};
      border-radius: ${o.shape.radius.default};
      margin: ${o.spacing(2.5)} ${o.spacing(1)} ${o.spacing(2.5)} ${o.spacing(2)};
      cursor: default;
    `,logDetailsTable:(0,t.css)`
      label: logs-row-details-table;
      line-height: 18px;
      width: 100%;
      td:last-child {
        width: 100%;
      }
    `,logsDetailsIcon:(0,t.css)`
      label: logs-row-details__icon;
      position: relative;
      color: ${o.v1.palette.gray3};
      padding-top: 1px;
      padding-bottom: 1px;
      padding-right: ${o.spacing(.75)};
    `,logDetailsLabel:(0,t.css)`
      label: logs-row-details__label;
      max-width: 30em;
      min-width: 20em;
      padding: 0 ${o.spacing(1)};
      overflow-wrap: break-word;
    `,logDetailsHeading:(0,t.css)`
      label: logs-row-details__heading;
      font-weight: ${o.typography.fontWeightBold};
      padding: ${o.spacing(1)} 0 ${o.spacing(.5)};
    `,logDetailsValue:(0,t.css)`
      label: logs-row-details__row;
      position: relative;
      vertical-align: middle;
      cursor: default;

      &:hover {
        background-color: ${h};
      }
    `,topVerticalAlign:(0,t.css)`
      label: topVerticalAlign;
      margin-top: -${o.spacing(.9)};
      margin-left: -${o.spacing(.25)};
    `,detailsOpen:(0,t.css)`
      &:hover {
        background-color: ${g.hoverColor(o.colors.background.primary,o)};
      }
    `,errorLogRow:(0,t.css)`
      label: erroredLogRow;
      color: ${o.colors.text.secondary};
    `,positionRelative:(0,t.css)`
      label: positionRelative;
      position: relative;
    `,rowWithContext:(0,t.css)`
      label: rowWithContext;
      z-index: 1;
      outline: 9999px solid ${f};
      display: inherit;
    `,horizontalScroll:(0,t.css)`
      label: horizontalScroll;
      white-space: pre;
    `,contextNewline:(0,t.css)`
      display: block;
      margin-left: 0px;
    `,rowMenu:(0,t.css)`
      label: rowMenu;
      display: flex;
      flex-wrap: nowrap;
      flex-direction: row;
      align-content: flex-end;
      justify-content: space-evenly;
      align-items: center;
      position: absolute;
      top: 0;
      bottom: auto;
      background: ${o.colors.background.primary};
      box-shadow: ${o.shadows.z3};
      padding: ${o.spacing(.5,1,.5,1)};
      z-index: 100;
      gap: ${o.spacing(.5)};

      & > button {
        margin: 0;
      }
    `,logRowMenuCell:(0,t.css)`
      position: sticky;
      z-index: ${o.zIndex.dropdown};
      margin-top: -${o.spacing(.125)};
      right: 0px;

      & > span {
        transform: translateX(-100%);
      }
    `,logLine:(0,t.css)`
      background-color: transparent;
      border: none;
      diplay: inline;
      font-family: ${o.typography.fontFamilyMonospace};
      font-size: ${o.typography.bodySmall.fontSize};
      letter-spacing: ${o.typography.bodySmall.letterSpacing};
      text-align: left;
      padding: 0;
      user-select: text;
    `,logsRowLevelDetails:(0,t.css)`
      label: logs-row__level_details;
      &::after {
        top: -3px;
      }
    `,logDetails:(0,t.css)`
      label: logDetailsDefaultCursor;
      cursor: default;

      &:hover {
        background-color: ${o.colors.background.primary};
      }
    `,visibleRowMenu:(0,t.css)`
      label: visibleRowMenu;
      aspect-ratio: 1/1;
      z-index: 90;
    `,linkButton:(0,t.css)`
      label: linkButton;
      > button {
        padding-top: ${o.spacing(.5)};
      }
    `,hidden:(0,t.css)`
      label: hidden;
      visibility: hidden;
    `,unPinButton:(0,t.css)`
      height: ${o.spacing(3)};
      line-height: ${o.spacing(2.5)};
    `}})},81166:(k,R,e)=>{"use strict";e.d(R,{V:()=>N});var t=e(74848),n=e(32196),i=e(2543),s=e(96540),r=e(16817),g=e(39070),a=e(52622),c=e(9557),o=e(47232),h=e(14110),f=e(32264),d=e(40845),p=e(37390),m=e(55852),v=e(33390),l=e(97186),y=e(29436),u=e(31678),D=e(69147),E=e(91002),x=e(81073),P=e(14647),b=e(15292);function M(F){return{buttons:(0,n.css)({display:"flex",gap:F.spacing(1)})}}const O=F=>{const w=(0,d.of)(M),{wrapLines:B,onChangeWrapLines:U,onScrollCenterClick:K}=F,V=(0,s.useCallback)(H=>{const Y=H.currentTarget.checked;(0,h.rR)("grafana_explore_logs_log_context_toggle_lines_clicked",{state:Y}),U(Y)},[U]);return(0,t.jsxs)("div",{className:w.buttons,children:[(0,t.jsx)(b.K,{showLabel:!0,value:B,onChange:V,label:"Wrap lines"}),(0,t.jsx)(m.$n,{variant:"secondary",onClick:K,children:"Center matched line"})]})},I=F=>({modal:(0,n.css)`
      width: 85vw;
      ${F.breakpoints.down("md")} {
        width: 100%;
      }
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    `,sticky:(0,n.css)`
      position: sticky;
      z-index: 1;
      top: -1px;
      bottom: -1px;
    `,entry:(0,n.css)`
      & > td {
        padding: ${F.spacing(1)} 0 ${F.spacing(1)} 0;
      }
      background: ${F.colors.emphasize(F.colors.background.secondary)};

      & > table {
        margin-bottom: 0;
      }

      & .log-row-menu {
        margin-top: -6px;
      }
    `,datasourceUi:(0,n.css)`
      padding-bottom: ${F.spacing(1.25)};
      display: flex;
      align-items: center;
    `,logRowGroups:(0,n.css)`
      overflow: auto;
      max-height: 75%;
      align-self: stretch;
      display: inline-block;
      border: 1px solid ${F.colors.border.weak};
      border-radius: ${F.shape.radius.default};
      & > table {
        min-width: 100%;
      }
    `,flexColumn:(0,n.css)`
      display: flex;
      flex-direction: column;
      padding: 0 ${F.spacing(3)} ${F.spacing(3)} ${F.spacing(3)};
    `,flexRow:(0,n.css)`
      display: flex;
      flex-direction: row;
      align-items: center;
      & > div:last-child {
        margin-left: auto;
      }
    `,noMarginBottom:(0,n.css)`
      & > table {
        margin-bottom: 0;
      }
    `,hidden:(0,n.css)`
      display: none;
    `,paddingTop:(0,n.css)`
      padding-top: ${F.spacing(1)};
    `,paddingBottom:(0,n.css)`
      padding-bottom: ${F.spacing(1)};
    `,link:(0,n.css)`
      color: ${F.colors.text.secondary};
      font-size: ${F.typography.bodySmall.fontSize};
      :hover {
        color: ${F.colors.text.link};
      }
    `,loadingCell:(0,n.css)`
      position: sticky;
      left: 50%;
      display: inline-block;
      transform: translateX(-50%);
    `}),T=()=>({above:{loadingState:g.Gu.NotStarted,rows:[]},below:{loadingState:g.Gu.NotStarted,rows:[]}}),C=(F,w)=>F==="above"&&w===a.uH.Descending||F==="below"&&w===a.uH.Ascending?c.ZF.Forward:c.ZF.Backward,S=(F,w)=>({...F,dataFrame:{...F.dataFrame,refId:`context_${w.above}_${w.below}`}}),A=(F,w)=>F.some(B=>B.entry===w.entry&&B.timeEpochNs===w.timeEpochNs),L=100,N=({row:F,open:w,logsSortOrder:B,timeZone:U,getLogRowContextUi:K,getRowContextQuery:V,onClose:H,getRowContext:Y})=>{const X=(0,s.useRef)(null),J=(0,s.useRef)(null),q=(0,s.useRef)(null),ae=(0,s.useRef)(null),j=(0,s.useRef)(null),te=(0,s.useRef)(null),ne=(0,s.useRef)(null),le=(0,s.useRef)({above:0,below:0}),z=(0,u.useDispatch)(),ee=(0,d.$j)(),se=I(ee),[ie,Z]=(0,s.useState)(!0),[oe,ce]=(0,s.useState)(T()),ye=(st,Ve)=>{ce(pe=>{const Ee={...pe};return Ee[st]=Ve(pe[st]),Ee})},re=(0,s.useRef)(1),[ue,De]=(0,s.useState)(null),[ge,Te]=(0,s.useState)(v.A.getBool(l.$.logContextWrapLogMessage,v.A.getBool(l.$.wrapLogMessage,!0))),Le=(0,s.useCallback)(()=>{const{below:st,above:Ve}=oe,pe=(0,E.oR)([...st.rows,F,...Ve.rows],a.uH.Ascending),Ee=pe[0].timeEpochMs;let me=pe[pe.length-1].timeEpochMs;Ee===me&&(me+=1);const ve=(0,o.KQ)(Ee),Se=(0,o.KQ)(me);return{from:ve,to:Se,raw:{from:ve,to:Se}}},[oe,F]),Ye=(0,s.useCallback)(async()=>{const st=V?await V(F):null;De(st)},[F,V]),je=async()=>{await Ye(),ce(T()),le.current={above:0,below:0},re.current+=1},Ze=async(st,Ve)=>{le.current[st]+=1;const pe=Ve.at(st==="above"?0:-1);if(pe==null)throw new Error("should never happen. the array always contains at least 1 item (the middle row)");(0,h.rR)("grafana_explore_logs_log_context_load_more_called",{datasourceType:pe.datasourceType,above:le.current.above,below:le.current.below});const Ee=C(st,B),me=await Y(S(pe,le.current),{limit:L,direction:Ee}),ve=(0,D.HT)(me.data).rows;return B===a.uH.Ascending&&ve.reverse(),ve.filter(Ie=>!A(Ve,Ie))};(0,s.useEffect)(()=>{w&&Ye()},[Ye,w]);const[Ne,Pe]=(0,s.useState)([]),Ue=st=>{Ne.indexOf(st)===-1&&Pe([...Ne,st])},$e=st=>{const Ve=Ne.indexOf(st);Ve>-1&&(Ne.splice(Ve,1),Pe([...Ne]))},ze=async st=>{const{below:Ve,above:pe}=oe;if(oe[st].loadingState===g.Gu.Loading)return;ye(st,ve=>({...ve,loadingState:g.Gu.Loading}));const me=re.current;try{const ve=[...pe.rows,F,...Ve.rows],Se=(await Ze(st,ve)).map(Ce=>!Ce.searchWords||!Ce.searchWords?.length?{...Ce,searchWords:F.searchWords}:Ce),[Ie,Oe]=(0,i.partition)(Se,Ce=>Ce.timeEpochNs>F.timeEpochNs),Re=B===a.uH.Ascending?Oe:Ie,he=B===a.uH.Ascending?Ie:Oe;me===re.current&&ce(Ce=>{const We=Re.length>0?(0,E.oR)([...Re,...Ce.above.rows],B):Ce.above.rows,et=he.length>0?(0,E.oR)([...Ce.below.rows,...he],B):Ce.below.rows;return{above:{rows:We,loadingState:st==="above"?Se.length===0?g.Gu.Done:g.Gu.NotStarted:Ce.above.loadingState},below:{rows:et,loadingState:st==="below"?Se.length===0?g.Gu.Done:g.Gu.NotStarted:Ce.below.loadingState}}})}catch{ye(st,ve=>({rows:ve.rows,loadingState:g.Gu.Error}))}},qe=async(st,Ve)=>{for(const pe of st){if(!pe.isIntersecting)continue;const Ee=pe.target;Ee===te.current?ze("above"):Ee===ne.current&&ze("below")}};(0,s.useEffect)(()=>{const st=X.current,Ve=te.current,pe=ne.current;if(st==null)return;const Ee=new IntersectionObserver(qe,{root:st});return Ve!=null&&Ee.observe(Ve),pe!=null&&Ee.observe(pe),()=>{Ee.disconnect()}});const dt=(0,s.useCallback)(()=>{q.current?.scrollIntoView({block:"center"}),J.current?.scrollIntoView({block:"center"})},[q,J]);(0,s.useLayoutEffect)(()=>{const st=X.current;if(st==null)return;const Ve=j.current,pe=st.clientHeight;if(j.current=pe,Ve!==pe){dt();return}if(le.current.above<=1&&le.current.below<=1){dt();return}const Ee=ae.current,me=st.scrollHeight;if(ae.current=me,Ee!=null){const ve=st.scrollTop+(me-Ee);st.scrollTop=ve}},[oe.above.rows,dt]),(0,r.A)(Ye,[V,F]);const vt=oe.above.loadingState,yt=oe.below.loadingState;return(0,t.jsxs)(p.a,{isOpen:w,title:"Log context",contentClassName:se.flexColumn,className:se.modal,onDismiss:H,children:[f.$.featureToggles.logsContextDatasourceUi&&K&&(0,t.jsx)("div",{className:se.datasourceUi,children:K(F,je)}),(0,t.jsx)("div",{className:(0,n.cx)(se.flexRow,se.paddingBottom),children:(0,t.jsx)("div",{children:(0,t.jsx)(O,{wrapLines:ge,onChangeWrapLines:Te,onScrollCenterClick:dt})})}),(0,t.jsx)("div",{ref:X,className:se.logRowGroups,children:(0,t.jsx)("table",{children:(0,t.jsxs)("tbody",{children:[(0,t.jsx)("tr",{children:(0,t.jsxs)("td",{className:se.loadingCell,children:[vt!==g.Gu.Done&&vt!==g.Gu.Error&&(0,t.jsx)("div",{ref:te,children:(0,t.jsx)(x.I,{adjective:"newer"})}),vt===g.Gu.Error&&(0,t.jsx)("div",{children:"Error loading log more logs."}),vt===g.Gu.Done&&(0,t.jsx)("div",{children:"No more logs available."})]})}),(0,t.jsx)("tr",{children:(0,t.jsx)("td",{className:se.noMarginBottom,children:(0,t.jsx)(P.k,{logRows:oe.above.rows,dedupStrategy:a.fY.none,showLabels:v.A.getBool(l.$.showLabels,!1),showTime:v.A.getBool(l.$.showTime,!0),wrapLogMessage:ge,prettifyLogMessage:v.A.getBool(l.$.prettifyLogMessage,!1),enableLogDetails:!0,timeZone:U,displayedFields:Ne,onClickShowField:Ue,onClickHideField:$e})})}),(0,t.jsx)("tr",{ref:q}),(0,t.jsx)("tr",{ref:J,className:(0,n.cx)(se.entry,ie?se.sticky:null),"data-testid":"entry-row",children:(0,t.jsx)("td",{className:se.noMarginBottom,children:(0,t.jsx)(P.k,{logRows:[F],dedupStrategy:a.fY.none,showLabels:v.A.getBool(l.$.showLabels,!1),showTime:v.A.getBool(l.$.showTime,!0),wrapLogMessage:ge,prettifyLogMessage:v.A.getBool(l.$.prettifyLogMessage,!1),enableLogDetails:!0,timeZone:U,displayedFields:Ne,onClickShowField:Ue,onClickHideField:$e,onUnpinLine:()=>Z(!1),onPinLine:()=>Z(!0),pinnedRowId:ie?F.uid:void 0,overflowingContent:!0})})}),(0,t.jsx)("tr",{children:(0,t.jsx)("td",{children:(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(P.k,{logRows:oe.below.rows,dedupStrategy:a.fY.none,showLabels:v.A.getBool(l.$.showLabels,!1),showTime:v.A.getBool(l.$.showTime,!0),wrapLogMessage:ge,prettifyLogMessage:v.A.getBool(l.$.prettifyLogMessage,!1),enableLogDetails:!0,timeZone:U,displayedFields:Ne,onClickShowField:Ue,onClickHideField:$e})})})}),(0,t.jsx)("tr",{children:(0,t.jsxs)("td",{className:se.loadingCell,children:[yt!==g.Gu.Done&&yt!==g.Gu.Error&&(0,t.jsx)("div",{ref:ne,children:(0,t.jsx)(x.I,{adjective:"older"})}),yt===g.Gu.Error&&(0,t.jsx)("div",{children:"Error loading log more logs."}),yt===g.Gu.Done&&(0,t.jsx)("div",{children:"No more logs available."})]})})]})})}),(0,t.jsx)(p.a.ButtonRow,{children:ue?.datasource?.uid&&(0,t.jsx)(m.$n,{variant:"secondary",onClick:async()=>{let st=F.uid;F.dataFrame.refId&&(st=F.uid.replace(F.dataFrame.refId,ue.refId)),z((0,y.ve)({queries:[ue],range:Le(),datasourceUid:ue.datasource.uid,panelsState:{logs:{id:st}}})),H(),(0,h.rR)("grafana_explore_logs_log_context_open_split_view_clicked",{datasourceType:F.datasourceType,logRowUid:F.uid})},children:"Open in split view"})})]})}},70377:(k,R,e)=>{"use strict";e.d(R,{FE:()=>a,jE:()=>r,qE:()=>g});var t=e(2543),n=e.n(t),i=e(87490),s=e(98101);const r=(f,d)=>a(f,d),g=f=>{let d=[];return f.forEach(p=>{p.links?.forEach(m=>{if(m.variables){const v=m.variables.map(y=>{const u=y.variableName,D=y.fieldPath?`.${y.fieldPath}`:"";return`${u}${D}`}),l=m.variables.map(y=>y.found?y.value:"");d.push({keys:v,values:l,links:[m],fieldIndex:p.fieldIndex})}})}),d},a=(f,d)=>h(f).map(m=>{const v=d?d(m,f.rowIndex,f.dataFrame):[],l=m.values[f.rowIndex],y=typeof l=="string"||typeof l=="number"?l.toString():(0,i.MA)(l);return{keys:[m.name],values:[y],links:v,fieldIndex:m.index}});function c(f,d){const p=(0,s.O)(f);if(p===null)return new Set;const m=new Set(p.extraFields.map(v=>v.index));return p.severityField!==null&&m.add(p.severityField.index),d.keepBody&&m.add(p.bodyField.index),d.keepTimestamp&&m.add(p.timeField.index),m}function o(f,d){const p=f.fields.map((y,u)=>({...y,index:u})),m=c(f,d??{}),[v,l]=partition(p,y=>y.config.custom?.hidden?!1:(y.config.links??[]).length>0?!0:m.has(y.index));return{visible:v,hidden:l}}function h(f,d){const p=f.dataFrame,m=c(p,d??{}),v=[];for(let l=0;l<p.fields.length;l++){const y=p.fields[l];y.values[f.rowIndex]!=null&&(y.config.custom?.hidden||(y.config.links&&y.config.links.length>0||m.has(l))&&v.push({...y,index:l}))}return v}},98101:(k,R,e)=>{"use strict";e.d(R,{n:()=>p,O:()=>v});var t=e(85404),n=e(11261),i=e(41260);function s(l,y){const u=l.labels;if(u!==void 0){const D=new Array(y);return D.fill(u),D}else return null}function r(l,y,u){const D=l.getFieldByName("labels");if(D!==void 0&&D.type===n.PU.other){const E=D.values.map(p);return[D,()=>E]}else return[null,()=>s(y,u.length)]}function g(l){const y=new t.L(l),u=y.getFirstFieldOfType(n.PU.time),D=y.getFirstFieldOfType(n.PU.string);if(u===void 0||D===void 0)return null;const E=y.getFieldByName("tsNs")??null,x=y.getFieldByName("level")??null,P=y.getFieldByName("id")??null,[b,M]=r(y,D,l),O=y.fields.filter((I,T)=>T!==u.index&&T!==D.index&&T!==E?.index&&T!==x?.index&&T!==P?.index&&T!==b?.index);return{timeField:u,bodyField:D,timeNanosecondField:E,severityField:x,idField:P,getLogFrameLabels:M,getLogFrameLabelsAsLabels:M,getLabelFieldName:()=>b?.name??null,extraFields:O}}function a(l,y,u){const D=l.getFieldByName(y);if(D!==void 0)return D.type===u?D:void 0}const c="timestamp",o="body",h="severity",f="id",d="labels";function p(l){const y={};return Object.entries(l).forEach(([u,D])=>{y[u]=typeof D=="string"?D:JSON.stringify(D)}),y}function m(l){const y=new t.L(l),u=a(y,c,n.PU.time),D=a(y,o,n.PU.string);if(u===void 0||D===void 0)return null;const E=a(y,h,n.PU.string)??null,x=a(y,f,n.PU.string)??null,P=a(y,d,n.PU.other)??null,b=P===null?null:P.values,M=y.fields.filter((O,I)=>I!==u.index&&I!==D.index&&I!==E?.index&&I!==x?.index&&I!==P?.index);return{timeField:u,bodyField:D,severityField:E,idField:x,getLogFrameLabels:()=>b,timeNanosecondField:null,getLogFrameLabelsAsLabels:()=>b!==null?b.map(p):null,getLabelFieldName:()=>P!==null?P.name:null,extraFields:M}}function v(l){return l.meta?.type===i.m.LogLines?m(l):g(l)}},69147:(k,R,e)=>{"use strict";e.d(R,{yR:()=>I,cZ:()=>T,HT:()=>H,M0:()=>B,ct:()=>U,f8:()=>ie,J9:()=>K,Wr:()=>ee,sg:()=>z});var t=e(2543),n=e(88483),i=e(50832),s=e(65474),r=e(9557),g=e(52622),a=e(14236),c=e(85404),o=e(11261),h=e(24293),f=e(47232),d=e(8249),p=e(80997),m=e(72724),v=e(65879),l=e(39070),y=e(26517),u=e(32264),D=e(24284),E=e(88838),x=e(2913);function P(Z,oe){return x.Ay.bootData?.user?.lightTheme?oe:Z}var b=e(98101),M=e(91002);const O="Line limit",I="Common labels",T={[r.$b.critical]:D.Tj[7],[r.$b.error]:D.Tj[4],[r.$b.warning]:D.Tj[1],[r.$b.info]:D.Tj[0],[r.$b.debug]:D.Tj[5],[r.$b.trace]:D.Tj[2],[r.$b.unknown]:P("#8e8e8e","#bdc4cd")},C=1,S=1e3*C,A=60*S,L=60*A,N=24*L,F=/\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-6]\d[,\.]\d+([+-][0-2]\d:[0-5]\d|Z)/g;function w(Z,oe,ce){switch(ce){case g.fY.exact:return Z.entry.replace(F,"")===oe.entry.replace(F,"");case g.fY.numbers:return Z.entry.replace(/\d/g,"")===oe.entry.replace(/\d/g,"");case g.fY.signature:return Z.entry.replace(/\w/g,"")===oe.entry.replace(/\w/g,"");default:return!1}}function B(Z,oe){return oe===g.fY.none?Z:Z.reduce((ce,ye,re)=>{const ue={...ye},De=ce[ce.length-1];return re>0&&w(ye,De,oe)?De.duplicates++:(ue.duplicates=0,ce.push(ue)),ce},[])}function U(Z,oe){return oe.size===0?Z:Z.filter(ce=>!oe.has(ce.logLevel))}function K(Z,oe){const ce={},ye=[];for(const re of Z){let ue=ce[re.logLevel];ue||(ce[re.logLevel]=ue={lastTs:null,datapoints:[],target:re.logLevel,color:T[re.logLevel]},ye.push(ue));const De=Math.floor(re.timeEpochMs/oe)*oe;De===ue.lastTs?ue.datapoints[ue.datapoints.length-1][0]++:(ue.datapoints.push([1,De]),ue.lastTs=De);for(const ge of ye)ge!==ue&&ge.lastTs!==De&&(ge.datapoints.push([0,De]),ge.lastTs=De)}return ye.map((re,ue)=>{re.datapoints.sort((Le,Ye)=>Le[1]-Ye[1]);const De=(0,a.Vc)(re),Te=new c.L(De).getFirstFieldOfType(o.PU.number);return De.fields[Te.index].config.min=0,De.fields[Te.index].config.decimals=0,De.fields[Te.index].config.color={mode:h.Y.Fixed,fixedColor:re.color},De.fields[Te.index].config.custom={drawStyle:g.GR.Bars,barAlignment:g.Nj.Center,barWidthFactor:.9,barMaxWidth:5,lineColor:re.color,pointColor:re.color,fillColor:re.color,lineWidth:0,fillOpacity:100,stacking:{mode:g.gs.Normal,group:"A"}},De})}function V(Z){return Z.fields.some(oe=>oe.type===o.PU.time)&&Z.fields.some(oe=>oe.type===o.PU.string)}function H(Z,oe,ce,ye,re){const{logSeries:ue}=X(Z),De=q(ue,ye,!!re);if(De){if(oe&&De.rows.length>0){const ge=De.rows.sort(M.M1),{visibleRange:Te,bucketSize:Le,visibleRangeMs:Ye,requestedRangeMs:je}=Y(ge,oe,ce);De.visibleRange=Te,De.bucketSize=Le,De.series=K(ge,Le),De.meta&&(De.meta=ae(De,Ye,je))}else De.series=[];return De.queries=ye,De}return{hasUniqueLabels:!1,rows:[],meta:[],series:[],queries:ye}}function Y(Z,oe,ce,ye=20,re=1e3){let ue=ce,De=oe,ge=Math.max(De*ye,re),Te,Le;if(ce){const Ye=Z[0].timeEpochMs;if(Le=ce.to-ce.from,Te=ce.to-Ye,Te>0){const je=Te/Le;De*=je,ge=Math.max(Math.ceil(De*ye),re),ue={from:Math.floor(Ye/ge)*ge,to:ce.to}}else Te=1}return{bucketSize:ge,visibleRange:ue,visibleRangeMs:Te,requestedRangeMs:Le}}function X(Z){const oe=[],ce=[];for(const ye of Z){if(V(ye)||!ye.fields.length){ce.push(ye);continue}ye.length>0&&oe.push(ye)}return{logSeries:ce,metricSeries:oe}}function J(Z,oe,ce){const ye=Z.values[ce],ue=(0,f.yT)(ye).valueOf();if(oe)return{ts:ye,timeEpochMs:ue,timeEpochNs:oe.values[ce]};if(Z.nanos!==void 0){const De=Z.nanos[ce].toString().padStart(6,"0"),ge=`${ue}${De}`;return{ts:ye,timeEpochMs:ue,timeEpochNs:ge}}return{ts:ye,timeEpochMs:ue,timeEpochNs:ue+"000000"}}function q(Z,oe=[],ce=!1){if(Z.length===0)return;const ye=[];let re=[];const ue=Z.filter(qe=>qe.fields.length);ue.length&&ue.forEach(qe=>{const dt=(0,b.O)(qe);if(dt!=null){const vt=dt.getLogFrameLabelsAsLabels()??void 0,yt={rawFrame:qe,logsFrame:dt,frameLabels:vt};re.push(yt),vt&&vt.length>0&&ye.push(vt)}});const De=ye.flat(),ge=De.length>0?(0,d.yO)(De):{};let Te=[],Le=!1;const Ye=(0,M.kA)();for(const qe of re){const{logsFrame:dt,rawFrame:vt,frameLabels:yt}=qe,{timeField:st,timeNanosecondField:Ve,bodyField:pe,severityField:Ee,idField:me}=dt;for(let ve=0;ve<vt.length;ve++){const{ts:Se,timeEpochMs:Ie,timeEpochNs:Oe}=J(st,Ve??void 0,ve),Re=pe.values[ve]??"",he=typeof Re=="string"?Re:JSON.stringify(Re),Ce=p.sQ.hasAnsiCodes(he),We=!!he.match(/\\n|\\t|\\r/),et=vt.meta?.custom?.searchWords??vt.meta?.searchWords??[],rt=Ce?E.DB.strip(he):he,nt=yt?.[ve],gt=(0,d.s6)(nt,ge);Object.keys(gt).length>0&&(Le=!0);let xt=r.$b.unknown;const St=Ee&&Ee.values[ve]||nt&&nt.level;typeof St=="number"||typeof St=="string"?xt=(0,M.EK)(St):xt=(0,M.XM)(rt);const zt=oe.find(Vt=>Vt.refId===vt.refId)?.datasource?.type,Nt={entryFieldIndex:pe.index,rowIndex:ve,dataFrame:vt,logLevel:xt,timeFromNow:(0,m.fq)(Se),timeEpochMs:Ie,timeEpochNs:Oe,timeLocal:(0,m.LE)(Se,{timeZone:"browser"}),timeUtc:(0,m.LE)(Se,{timeZone:"utc"}),uniqueLabels:gt,hasAnsi:Ce,hasUnescapedContent:We,searchWords:et,entry:rt,raw:he,labels:nt||{},uid:`${vt.refId}_${me?me.values[ve]:ve.toString()}`,datasourceType:zt};me!==null&&(Nt.rowId=me.values[ve]),!(ce&&Ye(Nt))&&Te.push(Nt)}}const je=[];(0,t.size)(ge)>0&&je.push({label:I,value:ge,kind:r.tG.LabelsMap});const Ne=Z.filter(qe=>qe?.meta?.custom?.limit??qe?.meta?.limit).reduce((qe,dt)=>(qe[dt.refId??""]=dt.meta?.custom?.limit??dt.meta?.limit??0,qe),{}),Pe=Object.values(Ne).reduce((qe,dt)=>qe+=dt,0);Pe>0&&je.push({label:O,value:Pe,kind:r.tG.Number});let Ue=0;const $e={};let ze=!1;for(const qe of Z){const dt=qe.meta?.custom?.lokiQueryStatKey,{refId:vt}=qe;if(!ze&&qe.meta?.custom?.error&&(je.push({label:"",value:qe.meta?.custom.error,kind:r.tG.Error}),ze=!0),vt&&!$e[vt]){if(dt&&qe.meta?.stats){const yt=qe.meta.stats.find(st=>st.displayName===dt);yt&&(Ue+=yt.value)}$e[vt]=!0}}if(Ue>0){const{text:qe,suffix:dt}=(0,y.rT)("B")(Ue);je.push({label:"Total bytes processed",value:`${qe} ${dt}`,kind:r.tG.String})}return{hasUniqueLabels:Le,meta:je,rows:Te}}function ae(Z,oe,ce){if(!Z.meta)return[];let ye=[...Z.meta];const re=ye.findIndex(De=>De.label===O),ue=re>=0&&ye[re]?.value;if(ue&&typeof ue=="number"&&ue>0){let De;if(ue===Z.rows.length&&oe&&ce){const ge=(oe/ce*100).toFixed(2);De=`${ue} reached, received logs cover ${ge}% (${v.msRangeToTimeString(oe)}) of your selected time range (${v.msRangeToTimeString(ce)})`}else{const ge=u.$.featureToggles.logsInfiniteScrolling?"displayed":"returned";De=`${ue} (${Z.rows.length} ${ge})`}ye[re]={label:O,value:De,kind:r.tG.String}}return ye}function j(Z,oe){const ce=oe&&Z===r.$b.unknown?"logs":Z,ye=T[Z];return{displayNameFromDS:ce,color:{mode:h.Y.Fixed,fixedColor:ye},custom:{drawStyle:g.GR.Bars,barAlignment:g.Nj.Center,lineColor:ye,pointColor:ye,fillColor:ye,lineWidth:1,fillOpacity:100,stacking:{mode:g.gs.Normal,group:"A"}}}}const te=(Z,oe,ce)=>(Z.fields=Z.fields.map(ye=>(ye.type===o.PU.number&&(ye.config={...ye.config,...j(oe(Z),ce)}),ye)),Z);function ne(Z){let oe;try{oe=new c.L(Z).getFirstFieldOfType(o.PU.number)}catch{}return oe?.labels?le(oe.labels):r.$b.unknown}function le(Z){const oe=Z.level??Z.lvl??Z.loglevel??"";return oe?(0,M.EK)(oe):r.$b.unknown}function z(Z,oe,ce){const ye=oe.range,re=ce.targets,ue=ne,De=ye.to.valueOf()-ye.from.valueOf(),ge=se(oe.scopedVars,De);return oe.interval=ge.interval,oe.scopedVars.__interval={value:ge.interval,text:ge.interval},ge.intervalMs!==void 0&&(oe.intervalMs=ge.intervalMs,oe.scopedVars.__interval_ms={value:ge.intervalMs,text:ge.intervalMs}),oe.hideFromInspector=!0,new n.c(Te=>{let Le=[];Te.next({state:l.Gu.Loading,error:void 0,data:[]});const Ye=Z.query(oe),Ze=((0,i.A)(Ye)?Ye:(0,s.H)(Ye)).subscribe({complete:()=>{Te.complete()},next:Ne=>{const{error:Pe}=Ne;if(Pe!==void 0)Te.next({state:l.Gu.Error,error:Pe,data:[]}),Te.error(Pe);else{const Ue=(0,t.groupBy)(Ne.data,"refId");Le=Ne.data.map($e=>{if($e.meta?.dataTopic===g.QR.Annotations)return $e;let ze=$e.refId||"";ze.startsWith("log-volume-")&&(ze=ze.substr(11));const qe={logsVolumeType:r.Aj.FullRange,absoluteRange:{from:ye.from.valueOf(),to:ye.to.valueOf()},datasourceName:Z.name,sourceQuery:re.find(dt=>dt.refId===ze)};return $e.meta={...$e.meta,custom:{...$e.meta?.custom,...qe}},te($e,ue,Ue[$e.refId].length===1)}),Te.next({state:Ne.state,error:void 0,data:Le})}},error:Ne=>{Te.next({state:l.Gu.Error,error:Ne,data:[]}),Te.error(Ne)}});return()=>{Ze?.unsubscribe()}})}function ee(Z,oe){return oe.hideFromInspector=!0,new n.c(ce=>{let ye=[];ce.next({state:l.Gu.Loading,error:void 0,data:[]});const re=Z.query(oe),De=((0,i.A)(re)?re:(0,s.H)(re)).subscribe({complete:()=>{ce.next({state:l.Gu.Done,error:void 0,data:ye}),ce.complete()},next:ge=>{const{error:Te}=ge;Te!==void 0?(ce.next({state:l.Gu.Error,error:Te,data:[]}),ce.error(Te)):ye=ge.data.map(Le=>{const Ye=(0,a.Vc)(Le),{timeIndex:je}=(0,a.KR)(Ye);return(0,a.ES)(Ye,je)})},error:ge=>{ce.next({state:l.Gu.Error,error:ge,data:[]}),ce.error(ge)}});return()=>{De?.unsubscribe()}})}function se(Z,oe){if(Z.__interval_ms){let ce=Z.__interval_ms.value,ye="";return oe<S*5?(ce=C,ye="1ms"):ce>L?(ce=N,ye="1d"):ce>A?(ce=L,ye="1h"):ce>S?(ce=A,ye="1m"):(ce=S,ye="1s"),{interval:ye,intervalMs:ce}}else return{interval:"$__interval"}}function ie(Z){const oe=Z.dataFrame;return oe.length===0||oe.length<=Z.rowIndex?null:(0,a.EI)({fields:oe.fields.map(ye=>({...ye,values:[ye.values[Z.rowIndex]]})),refId:oe.refId})}},91002:(k,R,e)=>{"use strict";e.d(R,{Dg:()=>x,Dk:()=>I,Dm:()=>M,Dx:()=>P,EK:()=>h,Ei:()=>u,Hw:()=>E,M1:()=>m,Tj:()=>f,XM:()=>o,a8:()=>C,e3:()=>O,kA:()=>S,oR:()=>y,oT:()=>b,qR:()=>D,s2:()=>d,tX:()=>T,zy:()=>l});var t=e(2543),n=e.n(t),i=e(9557),s=e(52622),r=e(37471),g=e(11261),a=e(85404),c=e(70377);function o(A){if(!A)return i.$b.unknown;let L=i.$b.unknown,N;for(const[F,w]of Object.entries(i.$b)){const U=new RegExp(`\\b${F}\\b`,"i").exec(A);U&&(N===void 0||U.index<N)&&(L=w,N=U.index)}return L}function h(A){const L=i.$b[A.toString().toLowerCase()];if(L)return L;if(typeof A=="string"){const N=parseInt(A,10);if(A.length===N.toString().length)return i.s5[A]||i.$b.unknown}else if(typeof A=="number")return i.s5[A]||i.$b.unknown;return i.$b.unknown}function f(A,L){const N=A.filter(B=>B.labels[L]!==void 0),F=N.length,w=(0,t.countBy)(N,B=>B.labels[L]);return p(w,F)}function d(A){const L=A.filter(F=>F!=null),N=(0,t.countBy)(L);return p(N,L.length)}const p=(A,L)=>(0,t.chain)(A).map((N,F)=>({count:N,value:F,proportion:N/L})).sortBy("count").reverse().value(),m=(A,L)=>A.timeEpochMs<L.timeEpochMs?-1:A.timeEpochMs>L.timeEpochMs?1:A.timeEpochNs<L.timeEpochNs?-1:A.timeEpochNs>L.timeEpochNs?1:0,v=(A,L)=>A.timeEpochMs>L.timeEpochMs?-1:A.timeEpochMs<L.timeEpochMs?1:A.timeEpochNs>L.timeEpochNs?-1:A.timeEpochNs<L.timeEpochNs?1:0,l=(A,L)=>{const N=A?y(A.rows,L):[];return A?{...A,rows:N}:{hasUniqueLabels:!1,rows:N}},y=(A,L)=>L===s.uH.Ascending?A.sort(m):A.sort(v),u=A=>A.labels.__error__?{hasError:!0,errorMessage:A.labels.__error__}:{hasError:!1},D=A=>A.labels.__adaptive_logs_sampled__?{isSampled:!0,sampleMessage:A.labels.__adaptive_logs_sampled__==="true"?"Logs like this one have been dropped by Adaptive Logs":`${A.labels.__adaptive_logs_sampled__}% of logs like this one have been dropped by Adaptive Logs`}:{isSampled:!1},E=A=>A.replace(/\\r\\n|\\n|\\t|\\r/g,L=>L.slice(1)==="t"?"	":`
`);function x(A){return A.map(L=>{const N=(0,c.FE)(L).reduce((F,w)=>{const B=w.keys[0];return F[B]=w.values[0],F},{});return{line:L.entry,timestamp:L.timeEpochNs,fields:{...N,...L.labels}}})}const P=A=>{let L={from:1/0,to:-1/0};return A.forEach(N=>{const F=N.meta?.custom||{};F.absoluteRange?.from&&F.absoluteRange?.to&&(L={from:Math.min(L.from,F.absoluteRange.from),to:Math.max(L.to,F.absoluteRange.to)})}),L},b=A=>{if(A.length===0)throw new Error("Cannot aggregate data frames: there must be at least one data frame to aggregate");const L={},N={};let F=-1/0;const w={};let B=[];return A.forEach(U=>{const{level:K,valueField:V,timeField:H,length:Y}=T(U);w[K]={meta:U.meta,valueFieldConfig:V.config,timeFieldConfig:H.config};for(let X=0;X<Y;X++){const J=H.values[X],q=V.values[X];L[K]??={},L[K][J]=(L[K][J]||0)+q,N[J]=(N[J]||0)+q,F=Math.max(N[J],F)}}),Object.keys(L).forEach(U=>{const K=new r.k,{meta:V,timeFieldConfig:H,valueFieldConfig:Y}=w[U];K.name=U,K.meta=V,K.addField({name:"Time",type:g.PU.time,config:H}),K.addField({name:"Value",type:g.PU.number,config:Y}),Object.entries(L[U]).sort((X,J)=>Number(X[0])-Number(J[0])).forEach(([X,J])=>{K.add({Time:Number(X),Value:J})}),B.push(K)}),{dataFrames:B,maximum:F}},M=A=>{const L=A[0]?.meta?.custom;return L&&L.datasourceName?{name:L.datasourceName}:null},O=A=>A[0]?.meta?.custom?.logsVolumeType===i.Aj.Limited,I=async(A,L)=>{if(navigator.clipboard&&window.isSecureContext)return navigator.clipboard.writeText(A);{const N=document.createElement("textarea");L.current?.appendChild(N),N.value=A,N.focus(),N.select(),document.execCommand("copy"),N.remove()}};function T(A){const L=new a.L(A),N=L.getFirstFieldOfType(g.PU.time),F=L.getFirstFieldOfType(g.PU.number);if(!N)throw new Error("Missing time field");if(!F)throw new Error("Missing value field");const w=F.config.displayNameFromDS||A.name||"logs",B=F.values.length;return{level:w,valueField:F,timeField:N,length:B}}function C(A){return A instanceof Element}function S(){const A=new Set;return function(L){let N=`${L.dataFrame.refId}_${L.rowId?L.rowId:`${L.timeEpochNs}_${L.entry}`}`;return A.has(N)?!0:(A.add(N),!1)}}},90591:(k,R,e)=>{"use strict";e.d(R,{m:()=>a});var t=e(74848),n=e(32196),i=e(40845),s=e(96374),r=e(8484);const g=({title:o})=>{const h=(0,i.of)(c);return(0,t.jsx)("p",{className:h.description,children:o?(0,r.t)("public-dashboard.delete-modal.revoke-nonorphaned-body-text","Are you sure you want to revoke this URL? The dashboard will no longer be public."):(0,r.t)("public-dashboard.delete-modal.revoke-orphaned-body-text","Orphaned public dashboard will no longer be public.")})},a=({dashboardTitle:o,onConfirm:h,onDismiss:f})=>{const d=(0,r.t)("public-dashboard.delete-modal.revoke-title","Revoke public URL");return(0,t.jsx)(s.u,{isOpen:!0,body:(0,t.jsx)(g,{title:o}),onConfirm:h,onDismiss:f,title:d,icon:"trash-alt",confirmText:d})},c=o=>({title:(0,n.css)`
    margin-bottom: ${o.spacing(1)};
  `,description:(0,n.css)`
    font-size: ${o.typography.body.fontSize};
  `})},71500:(k,R,e)=>{"use strict";e.d(R,{P:()=>s});var t=e(24439);class n extends Error{constructor(g,a){super(a),this.type=g}}class i{constructor(){this.rootName="general"}validateNewDashboardName(g,a){return this.validate(g,a,"A dashboard or a folder with the same name already exists")}validateNewFolderName(g){return this.validate(this.rootName,g,"A folder or dashboard in the general folder with the same name already exists")}async validate(g,a,c){a=(a||"").trim();const o=a.toLowerCase();if(a.length===0)throw new n("REQUIRED","Name is required");if(o===this.rootName)throw new n("EXISTING","This is a reserved name and cannot be used for a folder.");const f=await(0,t.getGrafanaSearcher)().search({kind:["dashboard"],query:a,location:g||"general"});for(const d of f.view)if(o===d.name.toLowerCase())throw new n("EXISTING",c)}}const s=new i},11230:(k,R,e)=>{"use strict";e.d(R,{A_:()=>w,FG:()=>E,Q9:()=>x,Ql:()=>N,c0:()=>L,iP:()=>d,rw:()=>f,vV:()=>C});var t=e(17172),n=e(19347),i=e(82467),s=e(3169),r=e(55314),g=e(28676),a=e(31678),c=e(57767),o=e(98796),h=e(88264);function f(U){return async K=>{try{K((0,h.f7)());const V=await(0,t.AI)().get(`/api/gnet/dashboards/${U}`);await K(u(V.json)),await K(v(V)),K(y())}catch(V){K((0,h.oQ)()),(0,t.NF)(V)&&K((0,i.dx)((0,s.gi)(V.data.message||V)))}}}function d(U){return async K=>{await K(u(U)),await K(l(U)),K(y())}}const p=(U,K)=>U?.usage?.libraryPanels?.filter(V=>K.inputs.libraryPanels.some(H=>H.state!==h.J7.Exists&&H.model.uid===V.uid));function m(U,K){let V=U.__inputs;if(K.inputs.libraryPanels?.length){const H=[];U.__inputs?.forEach(Y=>{if(!Y?.usage?.libraryPanels){H.push(Y);return}const X=p(Y,K);Y.usage={libraryPanels:X},!!X?.length&&H.push(Y)}),V=H}return{...U,__inputs:V}}function v(U){return(K,V)=>{const H=V().importDashboard,Y=m(U.json,H);K((0,h.Rp)({...U,json:Y}))}}function l(U){return(K,V)=>{const H=V().importDashboard,Y=m(U,H);K((0,h.dd)(Y))}}function y(){return(U,K)=>{const V=K().importDashboard.dashboard;if(V&&V.__inputs){const H=[];V.__inputs.forEach(Y=>{const X={name:Y.name,label:Y.label,info:Y.description,value:Y.value,type:Y.type,pluginId:Y.pluginId,options:[]};X.description=b(Y),Y.type===h.NZ.DataSource?P(Y,X):X.info||(X.info="Specify a string constant"),H.push(X)}),U((0,h.y3)(H))}}}function u(U){return async function(K){const V=await D(U);K((0,h.dW)(V))}}async function D(U){if(!U||!U.__elements)return[];const K=[];for(const V of Object.values(U.__elements)){if(V.kind!==o.i.Panel)continue;const H=V.model,{type:Y,description:X}=H,{uid:J,name:q}=V,ae={model:{model:H,uid:J,name:q,version:0,type:Y,kind:o.i.Panel,description:X},state:h.J7.New};try{const j=await(0,c.Yr)(J,!0);ae.state=h.J7.Exists,ae.model=j}catch(j){if(j.status!==404)throw j}K.push(ae)}return K}function E(){return U=>{U((0,h.SN)())}}function x(U){return async(K,V)=>{const H=V().importDashboard.dashboard,Y=V().importDashboard.inputs,X=[];U.dataSources?.forEach((J,q)=>{const ae=Y.dataSources[q];X.push({name:ae.name,type:ae.type,pluginId:ae.pluginId,value:J.uid})}),U.constants?.forEach((J,q)=>{const ae=Y.constants[q];X.push({value:J,name:ae.name,type:ae.type})}),K(r.cU.endpoints.importDashboard.initiate({dashboard:{...H,title:U.title,uid:U.uid||H.uid},overwrite:!0,inputs:X,folderUid:U.folder.uid}))}}const P=(U,K)=>{(0,n.l)().getList({pluginId:U.pluginId}).length===0?K.info="No data sources of type "+U.pluginName+" found":K.info||(K.info="Select a "+U.pluginName+" data source")},b=U=>{if(U.usage&&U.usage.libraryPanels)return`List of affected library panels: ${U.usage.libraryPanels.reduce((V,H,Y)=>Y===0?H.name:`${V}, ${H.name}`,"")}`};async function M(U,K){const V={totalCount:U.length,successCount:0};for(const H of U)try{await S(H,K)!==null&&(V.successCount+=1)}catch(Y){console.error("Failed to move a folder",Y)}return V}function O(U,K,...V){return async H=>{try{const Y=await U(...V);return Array.prototype.concat(H,[Y])}catch(Y){if(K)return H;throw Y}}}function I(U,K){const V=[];for(const H of U)V.push(O(T,!0,H,!0));for(const H of K)V.push(O(w,!0,H,!0));return B(V)}function T(U,K){return getBackendSrv().delete(`/api/folders/${U}?forceDeleteRules=false`,void 0,{showSuccessAlert:K})}function C(U){return(0,t.AI)().post("/api/folders",U)}function S(U,K){const V={parentUid:K.uid};return getBackendSrv().post(`/api/folders/${U}/move`,V,{showErrorAlert:!1})}const A=1e3;function L(U,K,V=a.SearchQueryType.Folder){return(0,t.AI)().get("/api/search",{query:U,type:V,permission:K,limit:A})}function N(U){return(0,t.AI)().get(`/api/folders/${U}`)}function F(U){return getBackendSrv().get(`/api/folders/id/${U}`)}function w(U,K){return(0,g.n)().deleteDashboard(U,K)}function B(U){return U.reduce((K,V)=>Promise.resolve(K).then(V),[])}},88264:(k,R,e)=>{"use strict";e.d(R,{Ay:()=>l,J7:()=>r,NZ:()=>s,Rp:()=>h,SN:()=>c,V9:()=>g,dW:()=>d,dd:()=>f,f7:()=>m,oQ:()=>p,qx:()=>i,y3:()=>o});var t=e(65307),n=e(39070),i=(y=>(y[y.Gcom=0]="Gcom",y[y.Json=1]="Json",y))(i||{}),s=(y=>(y.DataSource="datasource",y.Constant="constant",y.LibraryPanel="libraryPanel",y))(s||{}),r=(y=>(y.New="new",y.Exists="exists",y.Different="different",y))(r||{});const g={meta:{updatedAt:"",orgName:""},dashboard:{},source:1,inputs:{},state:n.Gu.NotStarted},a=(0,t.Z0)({name:"manageDashboards",initialState:g,reducers:{setGcomDashboard:(y,u)=>{y.dashboard={...u.payload.json,id:null},y.meta={updatedAt:u.payload.updatedAt,orgName:u.payload.orgName},y.source=0,y.state=n.Gu.Done},setJsonDashboard:(y,u)=>{y.dashboard={...u.payload,id:null},y.meta=g.meta,y.source=1,y.state=n.Gu.Done},clearDashboard:y=>{y.dashboard={},y.state=n.Gu.NotStarted},setInputs:(y,u)=>{y.inputs={dataSources:u.payload.filter(D=>D.type==="datasource"),constants:u.payload.filter(D=>D.type==="constant"),libraryPanels:y.inputs.libraryPanels||[]}},setLibraryPanelInputs:(y,u)=>{y.inputs.libraryPanels=u.payload},fetchFailed:y=>{y.dashboard={},y.state=n.Gu.Error},fetchDashboard:y=>{y.state=n.Gu.Loading}}}),{clearDashboard:c,setInputs:o,setGcomDashboard:h,setJsonDashboard:f,setLibraryPanelInputs:d,fetchFailed:p,fetchDashboard:m}=a.actions,l={importDashboard:a.reducer}},59120:(k,R,e)=>{"use strict";e.d(R,{O5:()=>E,r3:()=>p,dX:()=>y,hZ:()=>c,ri:()=>f,WH:()=>u,AC:()=>o,YX:()=>l,bM:()=>D,SM:()=>a,M8:()=>v,YD:()=>d,aD:()=>m});var t=e(75816),n=e(75505),i=e(17172);function s({baseURL:P}){async function b(M){try{const{data:O,...I}=await(0,n.s)((0,i.AI)().fetch({...M,url:P+M.url,showErrorAlert:!1,data:M.body}));return{data:O,meta:I}}catch(O){return M.manageError?M.manageError(O):{error:O}}}return b}const g=(0,t.xP)({reducerPath:"migrateToCloudGeneratedAPI",baseQuery:s({baseURL:"/api"}),endpoints:()=>({})}).injectEndpoints({endpoints:P=>({getSessionList:P.query({query:()=>({url:"/cloudmigration/migration"})}),createSession:P.mutation({query:b=>({url:"/cloudmigration/migration",method:"POST",body:b.cloudMigrationSessionRequestDto})}),deleteSession:P.mutation({query:b=>({url:`/cloudmigration/migration/${b.uid}`,method:"DELETE"})}),getSession:P.query({query:b=>({url:`/cloudmigration/migration/${b.uid}`})}),createSnapshot:P.mutation({query:b=>({url:`/cloudmigration/migration/${b.uid}/snapshot`,method:"POST"})}),getSnapshot:P.query({query:b=>({url:`/cloudmigration/migration/${b.uid}/snapshot/${b.snapshotUid}`,params:{resultPage:b.resultPage,resultLimit:b.resultLimit}})}),cancelSnapshot:P.mutation({query:b=>({url:`/cloudmigration/migration/${b.uid}/snapshot/${b.snapshotUid}/cancel`,method:"POST"})}),uploadSnapshot:P.mutation({query:b=>({url:`/cloudmigration/migration/${b.uid}/snapshot/${b.snapshotUid}/upload`,method:"POST"})}),getShapshotList:P.query({query:b=>({url:`/cloudmigration/migration/${b.uid}/snapshots`,params:{page:b.page,limit:b.limit}})}),getCloudMigrationToken:P.query({query:()=>({url:"/cloudmigration/token"})}),createCloudMigrationToken:P.mutation({query:()=>({url:"/cloudmigration/token",method:"POST"})}),deleteCloudMigrationToken:P.mutation({query:b=>({url:`/cloudmigration/token/${b.uid}`,method:"DELETE"})}),getDashboardByUid:P.query({query:b=>({url:`/dashboards/uid/${b.uid}`})})}),overrideExisting:!1}),{useGetSessionListQuery:a,useCreateSessionMutation:c,useDeleteSessionMutation:o,useGetSessionQuery:h,useCreateSnapshotMutation:f,useGetSnapshotQuery:d,useCancelSnapshotMutation:p,useUploadSnapshotMutation:m,useGetShapshotListQuery:v,useGetCloudMigrationTokenQuery:l,useCreateCloudMigrationTokenMutation:y,useDeleteCloudMigrationTokenMutation:u,useGetDashboardByUidQuery:D}=g,E=g.enhanceEndpoints({addTagTypes:["cloud-migration-token","cloud-migration-session","cloud-migration-snapshot"],endpoints:{getCloudMigrationToken:{providesTags:["cloud-migration-token"]},createCloudMigrationToken:{invalidatesTags:["cloud-migration-token"]},deleteCloudMigrationToken:{invalidatesTags:["cloud-migration-token"]},getSessionList:{providesTags:["cloud-migration-session"]},getSession:{providesTags:["cloud-migration-session"]},createSession:{invalidatesTags:["cloud-migration-session"]},deleteSession:{invalidatesTags:["cloud-migration-session","cloud-migration-snapshot"]},getShapshotList:{providesTags:["cloud-migration-snapshot"]},getSnapshot:{providesTags:["cloud-migration-snapshot"]},createSnapshot:{invalidatesTags:["cloud-migration-snapshot"]},uploadSnapshot:{invalidatesTags:["cloud-migration-snapshot"]},getDashboardByUid:x}});function x(P){if(!P.query)return;const b=P.query;P.query=(...M)=>{const O=b(...M);return O.showErrorAlert=!1,O}}},32931:(k,R,e)=>{"use strict";e.d(R,{EC:()=>a,L_:()=>r,YS:()=>s,bA:()=>g,wV:()=>c});var t=e(17172),n=e(82467),i=e(10943);function s(o={getBackendSrv:t.AI}){return async h=>{const f=await o.getBackendSrv().get("/api/org");return h((0,i.bK)(f)),f}}function r(o={getBackendSrv:t.AI}){return async(h,f)=>{const d=f().organization.organization;await o.getBackendSrv().put("/api/org",{name:d.name}),h((0,n.YA)(d.name)),h(s(o))}}function g(o,h={getBackendSrv:t.AI}){return async f=>{const d=await h.getBackendSrv().post("/api/user/using/"+o);f((0,n.YA)(d.name))}}function a(o,h={getBackendSrv:t.AI}){return async f=>{const d=await h.getBackendSrv().post("/api/orgs/",o);f(g(d.orgId))}}function c(o={getBackendSrv:t.AI}){return async h=>{const f=await o.getBackendSrv().get("/api/user/orgs");return h((0,i.Bz)(f)),f}}},10943:(k,R,e)=>{"use strict";e.d(R,{Ay:()=>c,Bz:()=>g,bK:()=>r,n:()=>s});var t=e(65307);const n={organization:{},userOrgs:[]},i=(0,t.Z0)({name:"organization",initialState:n,reducers:{organizationLoaded:(o,h)=>({...o,organization:h.payload}),setOrganizationName:(o,h)=>({...o,organization:{...o.organization,name:h.payload}}),userOrganizationsLoaded:(o,h)=>({...o,userOrgs:h.payload})}}),{setOrganizationName:s,organizationLoaded:r,userOrganizationsLoaded:g}=i.actions,c={organization:i.reducer}},17888:(k,R,e)=>{"use strict";e.d(R,{a:()=>E});var t=e(74848),n=e(32196),i=e(47070),s=e(41987),r=e(13544),g=e(39601),a=e(40845),c=e(79041),o=e(96540),h=e(14578);const f=o.forwardRef(({icon:b,children:M,onClick:O,...I},T)=>{const C=(0,a.of)(d);return(0,t.jsxs)("button",{...I,className:C.action,onClick:O,children:[(0,t.jsx)(h.I,{name:b,size:"xl"}),M]})});f.displayName="CardButton";const d=b=>({action:(0,n.css)({display:"flex",flexDirection:"column",height:"100%",justifySelf:"center",cursor:"pointer",background:b.colors.background.secondary,borderRadius:b.shape.radius.default,color:b.colors.text.primary,border:"unset",width:"100%",justifyContent:"center",alignItems:"center",textAlign:"center","&:hover":{background:b.colors.emphasize(b.colors.background.secondary)}})});var p=e(15054),m=e(33390),v=e(53466),l=e(32696),y=e(14792),u=e(31678),D=e(79971);function E(b){const M=(0,a.of)(P),O=(0,c.d2)(),I=new i.v2(b.data),{dataSummary:T}=I,C=x(b,T),S=(0,u.useDispatch)(),A=(0,y.UA)().getCurrent()?.getPanelById(b.panelId),L=()=>{m.A.setObject(p.wV,l.__.Suggestions),S((0,v.eK)(!0))},N=()=>{A&&S((0,D.gW)({panel:A,pluginId:"table"}))},F=w=>{A&&(S((0,D.gW)({...w,panel:A})),w.transformations&&setTimeout(()=>{g.Ny.partial({tab:"transform"})},100))};return(0,t.jsxs)("div",{className:M.wrapper,children:[(0,t.jsx)("div",{className:M.message,"data-testid":r.Tp.components.Panels.Panel.PanelDataErrorMessage,children:C}),O.app===s.Jk.PanelEditor&&T.hasData&&A&&(0,t.jsxs)("div",{className:M.actions,children:[b.suggestions&&(0,t.jsx)(t.Fragment,{children:b.suggestions.map(w=>(0,t.jsx)(f,{icon:"process",onClick:()=>F(w),children:w.name},w.name))}),(0,t.jsx)(f,{icon:"table",onClick:N,children:"Switch to table"}),(0,t.jsx)(f,{icon:"chart-line",onClick:L,children:"Open visualization suggestions"})]})]})}function x({data:b,fieldConfig:M,message:O,needsNumberField:I,needsTimeField:T,needsStringField:C},S){return O||(!b.series||b.series.length===0||b.series.every(A=>A.length===0)?M?.defaults.noValue??"No data":C&&!S.hasStringField?"Data is missing a string field":I&&!S.hasNumberField?"Data is missing a number field":T&&!S.hasTimeField?"Data is missing a time field":"Cannot visualize data")}const P=b=>({wrapper:(0,n.css)({display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%",width:"100%"}),message:(0,n.css)({textAlign:"center",color:b.colors.text.secondary,fontSize:b.typography.size.lg,width:"100%"}),actions:(0,n.css)({marginTop:b.spacing(2),display:"flex",height:"50%",maxHeight:"150px",columnGap:b.spacing(1),rowGap:b.spacing(1),width:"100%",maxWidth:"600px"})})},41394:(k,R,e)=>{"use strict";e.d(R,{$:()=>o,W:()=>c});var t=e(74848),n=e(96540),i=e(65158),s=e(43429),r=e(42418),g=e(31678);class a extends n.PureComponent{constructor(f){super(f)}render(){const f={display:"flex",alignItems:"center",justifyContent:"center",height:"100%"};return(0,t.jsx)("div",{style:f,children:(0,t.jsx)(r.F,{severity:g.AppNotificationSeverity.Error,...this.props})})}}function c(h,f){const d=class extends n.PureComponent{render(){const v=(0,t.jsxs)(t.Fragment,{children:["Check the server startup logs for more information. ",(0,t.jsx)("br",{}),"If this plugin was loaded from Git, then make sure it was compiled."]});return(0,t.jsx)(a,{title:`Error loading: ${h.id}`,text:v})}},p=new i.m(d);return p.meta=h,p.loadError=!0,p}function o(h,f){const d=class extends n.PureComponent{render(){return(0,t.jsx)(a,{title:`Panel plugin not found: ${h}`})}},p=new i.m(f?()=>null:d);return p.meta={id:h,name:h,sort:100,type:s.QE.panel,module:"",baseUrl:"",info:{author:{name:""},description:"",links:[],logos:{large:"",small:"public/img/grafana_icon.svg"},screenshots:[],updated:"",version:""}},p}},20726:(k,R,e)=>{"use strict";e.d(R,{m:()=>m});var t=e(74848),n=e(96540),i=e(1933),s=e(90708),r=e(13834),g=e(581),a=e(72574),c=e(40845),o=e(79041),h=e(66602),f=e(10096),d=e(15162);const p={defaults:{},overrides:[]};function m(l){const{pluginId:y,data:u,timeZone:D=(0,i.O)(),options:E={},width:x,height:P,title:b,onOptionsChange:M=()=>{},onChangeTimeRange:O=()=>{},onFieldConfigChange:I=()=>{},fieldConfig:T=p}=l,C=(0,c.$j)(),S=(0,a.w)(),A=(0,n.useMemo)(()=>S.replace.bind(S),[S]),[L,N]=(0,n.useState)((0,d.PY)(y)),[F,w]=(0,n.useState)(),B=v(L,E,T),{dataLinkPostProcessor:U}=(0,o.d2)(),K=(0,s.rJ)(L,B?.fieldConfig,u,D,C,A,U);if((0,n.useEffect)(()=>{L&&L.hasPluginId(y)||(0,d.TV)(y).then(H=>N(H)).catch(H=>{w(H.message)})},[y,L]),F)return(0,t.jsxs)("div",{children:["Failed to load plugin: ",F]});if(!L||!L.hasPluginId(y))return(0,t.jsx)("div",{children:"Loading plugin panel..."});if(!L.panel)return(0,t.jsx)("div",{children:"Seems like the plugin you are trying to load does not have a panel component."});if(!K)return(0,t.jsx)("div",{children:"No panel data"});const V=L.panel;return(0,t.jsx)(h.Xw,{dependencies:[L,u],children:(0,t.jsx)(r.a,{meta:L.meta,children:(0,t.jsx)(V,{id:1,data:K,title:b,timeRange:K.timeRange,timeZone:D,options:B.options,fieldConfig:T,transparent:!1,width:x,height:P,renderCounter:0,replaceVariables:H=>H,onOptionsChange:M,onFieldConfigChange:I,onChangeTimeRange:O,eventBus:f.lE})})})}function v(l,y,u){return(0,n.useMemo)(()=>{if(l)return(0,g.F)({plugin:l,currentOptions:y,currentFieldConfig:u,isAfterPluginChange:!1})},[l,u,y])}},25701:(k,R,e)=>{"use strict";e.d(R,{b:()=>v});var t=e(74848),n=e(32196),i=e(70255),s=e(43429),r=e(51527),g=e(13544),a=e(40845),c=e(29158),o=e(98624),h=e(72129),f=e(10803);const d=38,p=({isCurrent:D,title:E,plugin:x,onClick:P,onDelete:b,disabled:M,showBadge:O,description:I,children:T})=>{const C=(0,a.of)(y),S=M||x.state===s.pn.deprecated,A=(0,n.cx)({[C.item]:!0,[C.itemDisabled]:S,[C.current]:D});return(0,t.jsxs)("div",{className:A,"aria-label":g.Tp.components.PluginVisualization.item(x.name),"data-testid":g.Tp.components.PluginVisualization.item(x.name),onClick:S?void 0:P,title:D?"Click again to close this section":x.name,children:[(0,t.jsx)("img",{className:(0,n.cx)(C.img,{[C.disabled]:S}),src:x.info.logos.small,alt:""}),(0,t.jsxs)("div",{className:(0,n.cx)(C.itemContent,{[C.disabled]:S}),children:[(0,t.jsx)("div",{className:C.name,children:E}),I?(0,t.jsx)("span",{className:C.description,children:I}):null,T]}),O&&(0,t.jsx)("div",{className:(0,n.cx)(C.badge,{[C.disabled]:S}),children:(0,t.jsx)(u,{plugin:x})}),b&&(0,t.jsx)(c.K,{name:"trash-alt",onClick:L=>{L.stopPropagation(),b()},className:C.deleteButton,"aria-label":"Delete button on panel type card",tooltip:"Delete"})]})};p.displayName="PanelTypeCard";const m=({children:D,hasDescription:E,hasDelete:x,rootProps:P})=>{const b=(0,a.of)(y),M=(0,a.of)(l);return(0,t.jsxs)("div",{className:b.item,...P,children:[(0,t.jsx)(i.A,{className:(0,n.cx)(b.img,M.image),width:d,height:d}),(0,t.jsxs)("div",{className:b.itemContent,children:[(0,t.jsx)("div",{className:b.name,children:(0,t.jsx)(i.A,{width:160})}),E?(0,t.jsx)(i.A,{containerClassName:b.description,width:80}):null,D]}),x&&(0,t.jsx)(i.A,{containerClassName:(0,n.cx)(b.deleteButton,M.deleteButton),width:16,height:16})]})},v=(0,h.j)(p,m),l=()=>({deleteButton:(0,n.css)({lineHeight:1}),image:(0,n.css)({lineHeight:1})}),y=D=>({item:(0,n.css)({position:"relative",display:"flex",flexShrink:0,cursor:"pointer",background:D.colors.background.secondary,borderRadius:D.shape.radius.default,boxShadow:D.shadows.z1,border:`1px solid ${D.colors.background.secondary}`,alignItems:"center",padding:D.spacing(1),width:"100%",overflow:"hidden",[D.transitions.handleMotion("no-preference","reduce")]:{transition:D.transitions.create(["background"],{duration:D.transitions.duration.short})},"&:hover":{background:D.colors.emphasize(D.colors.background.secondary,.03)}}),itemContent:(0,n.css)({overflow:"hidden",position:"relative",padding:D.spacing(0,1)}),itemDisabled:(0,n.css)({cursor:"default","&, &:hover":{background:D.colors.action.disabledBackground}}),current:(0,n.css)({label:"currentVisualizationItem",border:`1px solid ${D.colors.primary.border}`,background:D.colors.action.selected}),disabled:(0,n.css)({opacity:.6,filter:"grayscale(1)",cursor:"default",pointerEvents:"none"}),name:(0,n.css)({textOverflow:"ellipsis",overflow:"hidden",fontSize:D.typography.size.sm,fontWeight:D.typography.fontWeightMedium,width:"100%"}),description:(0,n.css)({display:"block",textOverflow:"ellipsis",overflow:"hidden",color:D.colors.text.secondary,fontSize:D.typography.bodySmall.fontSize,fontWeight:D.typography.fontWeightLight,width:"100%",maxHeight:"4.5em"}),img:(0,n.css)({maxHeight:d,width:d,display:"flex",alignItems:"center"}),badge:(0,n.css)({background:D.colors.background.primary}),deleteButton:(0,n.css)({cursor:"pointer",marginLeft:"auto"})}),u=({plugin:D})=>(0,r.x)(D.signature)?(0,t.jsx)(o.B,{status:D.signature}):(0,t.jsx)(f.p,{state:D.state});u.displayName="PanelPluginBadge"},56707:(k,R,e)=>{"use strict";e.d(R,{a:()=>u});var t=e(74848),n=e(32196),i=e(16817),s=e(70713),r=e(40845),g=e(47070),a=e(32264),c=e(15162);const o=["timeseries","barchart","gauge","stat","piechart","bargauge","table","state-timeline","status-history","logs","candlestick","flamegraph","traces","nodeGraph"];async function h(x,P){const b=new g.v2(x,P);for(const O of o){const T=(await(0,c.TV)(O)).getSuggestionsSupplier();T&&T.getSuggestionsForData(b)}const M=b.getList();if(!a.$.featureToggles.vizAndWidgetSplit&&b.dataSummary.fieldCount===0)for(const O of Object.values(a.$.panels))!O.skipDataQuery||O.hideFromList||M.push({name:O.name,pluginId:O.id,description:O.info.description,cardOptions:{imgSrc:O.info.logos.small}});return M.sort((O,I)=>{if(b.dataSummary.preferredVisualisationType){if(O.pluginId===b.dataSummary.preferredVisualisationType)return-1;if(I.pluginId===b.dataSummary.preferredVisualisationType)return 1}return(I.score??g.nQ.OK)-(O.score??g.nQ.OK)})}var f=e(2543),d=e(13544),p=e(56034),m=e(20726);function v({data:x,suggestion:P,onChange:b,width:M}){const O=(0,r.of)(l),{innerStyles:I,outerStyles:T,renderWidth:C,renderHeight:S}=y(M),A=P.cardOptions??{},L={"aria-label":P.name,className:O.vizBox,"data-testid":d.Tp.components.VisualizationPreview.card(P.name),style:T,onClick:()=>{b({pluginId:P.pluginId,options:P.options,fieldConfig:P.fieldConfig})}};if(A.imgSrc)return(0,t.jsx)(p.m,{content:P.description??P.name,children:(0,t.jsxs)("button",{...L,className:(0,n.cx)(O.vizBox,O.imgBox),children:[(0,t.jsx)("div",{className:O.name,children:P.name}),(0,t.jsx)("img",{className:O.img,src:A.imgSrc,alt:P.name})]})});let N=P;return P.cardOptions?.previewModifier&&(N=(0,f.cloneDeep)(P),P.cardOptions.previewModifier(N)),(0,t.jsx)("button",{...L,children:(0,t.jsx)(p.m,{content:P.name,children:(0,t.jsxs)("div",{style:I,className:O.renderContainer,children:[(0,t.jsx)(m.m,{title:"",data:x,pluginId:P.pluginId,width:C,height:S,options:N.options,fieldConfig:N.fieldConfig}),(0,t.jsx)("div",{className:O.hoverPane})]})})})}const l=x=>({hoverPane:(0,n.css)({position:"absolute",top:0,right:0,left:0,borderRadius:x.spacing(2),bottom:0}),vizBox:(0,n.css)`
      position: relative;
      background: none;
      border-radius: ${x.shape.radius.default};
      cursor: pointer;
      border: 1px solid ${x.colors.border.medium};

      transition: ${x.transitions.create(["background"],{duration:x.transitions.duration.short})};

      &:hover {
        background: ${x.colors.background.secondary};
      }
    `,imgBox:(0,n.css)`
      display: flex;
      flex-direction: column;
      height: 100%;

      justify-self: center;
      color: ${x.colors.text.primary};
      width: 100%;
      display: flex;

      justify-content: center;
      align-items: center;
      text-align: center;
    `,name:(0,n.css)`
      padding-bottom: ${x.spacing(.5)};
      margin-top: ${x.spacing(-1)};
      font-size: ${x.typography.bodySmall.fontSize};
      white-space: nowrap;
      overflow: hidden;
      color: ${x.colors.text.secondary};
      font-weight: ${x.typography.fontWeightMedium};
      text-overflow: ellipsis;
    `,img:(0,n.css)`
      max-width: ${x.spacing(8)};
      max-height: ${x.spacing(8)};
    `,renderContainer:(0,n.css)`
      position: absolute;
      transform-origin: left top;
      top: 6px;
      left: 6px;
    `});function y(x){const b=x,M=x*(1/1.6),O=350,I=O*(1/1.6),T=6,C=(b-T*2)/O,S=(M-T*2)/I;return{renderHeight:I,renderWidth:O,outerStyles:{width:b,height:M},innerStyles:{width:O,height:I,transform:`scale(${C}, ${S})`}}}function u({searchQuery:x,onChange:P,data:b,panel:M}){const O=(0,r.of)(E),{value:I}=(0,i.A)(()=>h(b,M),[b,M]),T=D(x,I);return(0,t.jsx)("div",{children:(0,t.jsx)(s.Ay,{disableHeight:!0,style:{width:"100%",height:"100%"},children:({width:C})=>{if(!C)return null;C=C-1;const S=Math.floor(C/200),A=8*(S-1),L=Math.floor((C-A)/S);return(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:O.filterRow,children:(0,t.jsx)("div",{className:O.infoText,children:"Based on current data"})}),(0,t.jsxs)("div",{className:O.grid,style:{gridTemplateColumns:`repeat(auto-fill, ${L}px)`},children:[T.map((N,F)=>(0,t.jsx)(v,{data:b,suggestion:N,onChange:P,width:L-1},F)),x&&T.length===0&&(0,t.jsx)("div",{className:O.infoText,children:"No results matched your query"})]})]})}})})}function D(x,P){if(!x||!P)return P||[];const b=new RegExp(x,"i");return P.filter(M=>b.test(M.name)||b.test(M.pluginId))}const E=x=>({heading:(0,n.css)({...x.typography.h5,margin:x.spacing(0,.5,1)}),filterRow:(0,n.css)({display:"flex",flexDirection:"row",justifyContent:"space-around",alignItems:"center",paddingBottom:"8px"}),infoText:(0,n.css)({fontSize:x.typography.bodySmall.fontSize,color:x.colors.text.secondary,fontStyle:"italic"}),grid:(0,n.css)({display:"grid",gridGap:x.spacing(1),gridTemplateColumns:"repeat(auto-fill, 144px)",marginBottom:x.spacing(1),justifyContent:"space-evenly"})})},86292:(k,R,e)=>{"use strict";e.d(R,{G:()=>o});var t=e(74848),n=e(32196),i=e(96540),s=e(32264),r=e(40845),g=e(41670),a=e(17706),c=e(48889);function o({pluginId:f,searchQuery:d,onChange:p,isWidget:m=!1}){const v=(0,r.of)(h),l=(0,i.useMemo)(()=>s.$.featureToggles.vizAndWidgetSplit?m?(0,a.nr)():(0,a.if)():(0,a.A4)(),[m]),y=(0,i.useMemo)(()=>(0,a.CO)(l,d,f),[l,d,f]);return y.length===0?(0,t.jsx)(g.Z,{children:"Could not find anything matching your query"}):(0,t.jsx)("div",{className:v.grid,children:y.map(u=>(0,t.jsx)(c.f,{disabled:!1,isCurrent:u.id===f,plugin:u,onClick:D=>p({pluginId:u.id,withModKey:D.metaKey||D.ctrlKey||D.altKey})},u.id))})}const h=f=>({grid:(0,n.css)({maxWidth:"100%",display:"grid",gridGap:f.spacing(.5)}),heading:(0,n.css)({...f.typography.h5,margin:f.spacing(0,.5,1)})})},48889:(k,R,e)=>{"use strict";e.d(R,{f:()=>i});var t=e(74848),n=e(25701);const i=({isCurrent:s,plugin:r,onClick:g,disabled:a})=>(0,t.jsx)(n.b,{title:r.name,plugin:r,description:r.info.description,onClick:g,isCurrent:s,disabled:a,showBadge:!0});i.displayName="VizTypePickerPlugin"},32349:(k,R,e)=>{"use strict";e.d(R,{CH:()=>c,E7:()=>a,EO:()=>g});var t=e(14236),n=e(83195),i=e(92461),s=e(32023),r=e(6923);const g=o=>{const h=o.field.links;if(!(!h||h.length===0))return{getLinks:f=>{const d={};if(o.view){const{dataFrame:m}=o.view;d.__series={value:{name:m.name,refId:m.refId},text:"Series"};const v=o.colIndex!==void 0?m.fields[o.colIndex]:void 0;if(v){if(d.__field={value:{name:v.name,labels:v.labels},text:"Field"},o.rowIndex!==void 0&&o.rowIndex>=0){const{timeField:l}=(0,t.KR)(m);d.__value={value:{raw:v.values[o.rowIndex],numeric:o.display.numeric,text:(0,n.cN)(o.display),time:l?l.values[o.rowIndex]:void 0},text:"Value"}}o.view&&(d.__data={value:{name:m.name,refId:m.refId,fields:(0,i.F)({frame:m,rowIndex:o.rowIndex})},text:"Data"})}else d.__value={value:{raw:o.display.numeric,numeric:o.display.numeric,text:(0,n.cN)(o.display),calc:o.name},text:"Value"}}else console.log("VALUE",o);const p=(m,v,l)=>{const y={...d,...v};return f(m,y,l)};return h.map(m=>(0,r.mQ)().getDataLinkUIModel(m,p,o))}}},a=(o,h)=>{const f=o.links;if(!(!f||f.length===0))return{getLinks:()=>f.map(d=>(0,r.mQ)().getDataLinkUIModel(d,h||o.replaceVariables,o))}},c=(o,h)=>{const f=s.b4.getPanelLinks(o)?.state.rawLinks;if(!(!f||f.length===0))return{getLinks:()=>f.map(d=>(0,r.mQ)().getDataLinkUIModel(d,h,o))}}},6923:(k,R,e)=>{"use strict";e.d(R,{Fq:()=>u,Hf:()=>x,mQ:()=>I});var t=e(2543),n=e.n(t),i=e(6709),s=e(91890),r=e(28240),g=e(11261),a=e(71733),c=e(80997),o=e(76885),h=e(95344),f=e(72574),d=e(52622),p=e(2913);const m=[{value:`${i.c.keepTime}`,label:"Time range",documentation:"Adds current time range",origin:s.$0.BuiltIn},{value:`${i.c.timeRangeFrom}`,label:"Time range: from",documentation:"Adds current time range's from value",origin:s.$0.BuiltIn},{value:`${i.c.timeRangeTo}`,label:"Time range: to",documentation:"Adds current time range's to value",origin:s.$0.BuiltIn}],v=[{value:`${i.c.seriesName}`,label:"Name",documentation:"Name of the series",origin:s.$0.Series}],l=[{value:`${i.c.valueNumeric}`,label:"Numeric",documentation:"Numeric representation of selected value",origin:s.$0.Value},{value:`${i.c.valueText}`,label:"Text",documentation:"Text representation of selected value",origin:s.$0.Value},{value:`${i.c.valueRaw}`,label:"Raw",documentation:"Raw value",origin:s.$0.Value}],y=T=>T.includes(".")||T.trim().includes(" ")?`["${T}"]`:`.${T}`,u=()=>[...(0,f.w)().getVariables().map(T=>({value:T.name,label:T.name,origin:s.$0.Template})),{value:`${i.c.includeVars}`,label:"All variables",documentation:"Adds current variables",origin:s.$0.Template},...m],D=T=>{const C=[];for(const A of T)for(const L of A.fields)if(L.labels)for(const N of Object.keys(L.labels))C.push(N);const S=(0,t.chain)(C).flatten().uniq().value();return[{value:`${i.c.fieldName}`,label:"Name",documentation:"Field name of the clicked datapoint (in ms epoch)",origin:s.$0.Field},...S.map(A=>({value:`__field.labels${y(A)}`,label:`labels.${A}`,documentation:`${A} label value`,origin:s.$0.Field}))]},E=T=>{let C,S;const A=[],L={};if(T.length!==1)return[];const N=T[0];for(const F of N.fields){const w=(0,r.Ct)(F,N,T);L[w]||(A.push({value:`__data.fields${y(w)}`,label:`${w}`,documentation:`Formatted value for ${w} on the same row`,origin:s.$0.Fields}),L[w]=!0,!C&&F.type===g.PU.number&&(C={...F,name:w}),!S&&F.config.displayName&&F.config.displayName!==F.name&&(S={...F,name:w}))}return A.length&&A.push({value:"__data.fields[0]",label:"Select by index",documentation:"Enter the field order",origin:s.$0.Fields}),C&&(A.push({value:`__data.fields${y(C.name)}.numeric`,label:"Show numeric value",documentation:"the numeric field value",origin:s.$0.Fields}),A.push({value:`__data.fields${y(C.name)}.text`,label:"Show text value",documentation:"the text value",origin:s.$0.Fields})),S&&A.push({value:`__data.fields${y(S.name)}`,label:"Select by title",documentation:"Use the title to pick the field",origin:s.$0.Fields}),A},x=(T,C)=>{const S={value:`${i.c.valueTime}`,label:"Time",documentation:"Time value of the clicked datapoint (in ms epoch)",origin:s.$0.Value};return C===s.uP.Values?[...v,...D(T),...l,S,...E(T),...u()]:[...v,...D(T),...E(T),...u()]},P=T=>{const C=D(T),S={value:`${DataLinkBuiltInVars.valueCalc}`,label:"Calculation name",documentation:"Name of the calculation the value is a result of",origin:VariableOrigin.Value};return[...v,...C,...l,S,...u()]};class b{constructor(){this.getDataLinkUIModel=(C,S,A)=>{let L=C.url;C.onBuildUrl&&(L=C.onBuildUrl({origin:A,replaceVariables:S}));const N={href:a.I.assureBaseUrl(L.replace(/\n/g,"")),title:C.title??"",target:C.targetBlank?"_blank":void 0,origin:A};return S&&(N.href=S(N.href,void 0,d.$m.UriEncode),N.title=S(C.title)),C.onClick&&(N.onClick=F=>{C.onClick({origin:A,replaceVariables:S,e:F})}),N.href=(0,p.zj)().disableSanitizeHtml?N.href:c.sQ.sanitizeUrl(N.href),N}}getLinkUrl(C){let S={};C.keepTime&&(S[`$${i.c.keepTime}`]=!0),C.includeVars&&(S[`$${i.c.includeVars}`]=!0);let A=a.I.assureBaseUrl(o.kM.appendQueryToUrl(C.url||"",o.kM.toUrlParams(S)));return A=(0,f.w)().replace(A),(0,p.zj)().disableSanitizeHtml?A:c.sQ.sanitizeUrl(A)}getAnchorInfo(C){const S=(0,f.w)();return{href:this.getLinkUrl(C),title:S.replace(C.title||""),tooltip:S.replace(C.tooltip||"")}}getPanelLinkAnchorInfo(C,S){(0,h.l)("link_srv.ts","getPanelLinkAnchorInfo","getDataLinkUIModel");const A=(L,N,F)=>(0,f.w)().replace(L,{...S,...N},F);return this.getDataLinkUIModel(C,A,{})}}let M;function O(T){M=T}function I(){return M||(M=new b),M}},79971:(k,R,e)=>{"use strict";e.d(R,{Ap:()=>a,O6:()=>c,Xk:()=>h,gW:()=>o});var t=e(581),n=e(57767),i=e(41394),s=e(20701),r=e(28444),g=e(80095);function a(d){return async(p,m)=>{if(d.libraryPanel?.uid&&!("model"in d.libraryPanel)){p(f(d));return}d.maxDataPoints&&(d.maxDataPoints=Number(d.maxDataPoints));let v=d.type,l=m().plugins.panels[v];if(!l)try{l=await p((0,s.y7)(v))}catch{l=(0,i.$)(v,v==="row")}d.plugin||await d.pluginLoaded(l),p((0,g.XM)({key:d.key,plugin:l}))}}function c(d){return p=>{p((0,g.FC)({key:d}))}}function o({panel:d,pluginId:p,options:m,fieldConfig:v,transformations:l}){return async(y,u)=>{if(d.type===p&&!m&&!v&&!l)return;let E=u().plugins.panels[p];if(E||(E=await y((0,s.y7)(p))),d.type!==p&&d.changePlugin(E),m||v||l){const x=(0,t.F)({plugin:E,currentOptions:m||d.options,currentFieldConfig:v||d.fieldConfig,isAfterPluginChange:!1});d.options=x.options,d.fieldConfig=x.fieldConfig,d.transformations=l||d.transformations,d.configRev++}d.generateNewKey(),y((0,g.XM)({key:d.key,plugin:E}))}}function h(d,p){return async(m,v)=>{const l=p.model.type,y=d.type;if(d.restoreModel({...p.model,gridPos:d.gridPos,id:d.id,libraryPanel:p}),d.getQueryRunner().clearLastResult(),y!==l){let D=v().plugins.panels[l];D||(D=await m((0,s.y7)(l))),await d.pluginLoaded(D),d.generateNewKey(),await m((0,g.XM)({key:d.key,plugin:D}))}else{const u=d.key;d.generateNewKey(),m((0,g.io)({oldKey:u,newKey:d.key}))}d.configRev=0,d.hasSavedPanelEditChange=!0,d.refresh(),d.events.publish(r.zq),d.events.publish(r.PR)}}function f(d){return async(p,m)=>{const v=d.libraryPanel.uid;try{const l=await(0,n.Yr)(v,!0);d.initLibraryPanel(l);const y=m().dashboard.getModel();if(d.repeat&&y){const u=y.panels.findIndex(D=>D.id===d.id);y.repeatPanel(d,u),y.sortPanelsByGridPos(),y.events.publish(new r.Q$)}await p(a(d))}catch(l){console.log("ERROR: ",l),p((0,g.XM)({key:d.key,plugin:(0,i.$)("Unable to load library panel: "+v,!1)}))}}}},80095:(k,R,e)=>{"use strict";e.d(R,{Ay:()=>f,FC:()=>c,S3:()=>r,XM:()=>s,io:()=>a,nF:()=>g,rG:()=>o});var t=e(65307);const n={},i=(0,t.Z0)({name:"panels",initialState:n,reducers:{panelModelAndPluginReady:(d,p)=>{d[p.payload.key]={plugin:p.payload.plugin}},changePanelKey:(d,p)=>{d[p.payload.newKey]=d[p.payload.oldKey],delete d[p.payload.oldKey]},removePanel:(d,p)=>{delete d[p.payload.key]},removeAllPanels:d=>{Object.keys(d).forEach(p=>delete d[p])},setPanelInstanceState:(d,p)=>{d[p.payload.key].instanceState=p.payload.value},setPanelAngularComponent:(d,p)=>{const m=d[p.payload.key];m.angularComponent=p.payload.angularComponent}}}),{panelModelAndPluginReady:s,setPanelAngularComponent:r,setPanelInstanceState:g,changePanelKey:a,removePanel:c,removeAllPanels:o}=i.actions,f={panels:i.reducer}},40334:(k,R,e)=>{"use strict";e.d(R,{U:()=>t});function t(n,i){return n.panels[i.key]}},17706:(k,R,e)=>{"use strict";e.d(R,{A4:()=>s,CO:()=>a,if:()=>g,nr:()=>r});var t=e(43429),n=e(54479),i=e(2913);function s(){const c=i.config.panels;return Object.keys(c).filter(o=>c[o].hideFromList===!1).map(o=>c[o]).sort((o,h)=>o.sort-h.sort)}function r(){return s().filter(c=>!!c.skipDataQuery)}function g(){return s().filter(c=>!c.skipDataQuery)}function a(c,o,h){if(!o.length)return c.filter(v=>v.state===t.pn.deprecated?h===v.id:!0);const f=(0,n.xb)(o).toLowerCase(),d=[],p=[],m="graph".startsWith(f);for(const v of c){if(v.state===t.pn.deprecated&&h!==v.id)continue;const y=v.name.toLowerCase().indexOf(f);y===0?d.push(v):y>0?p.push(v):m&&v.id==="timeseries"&&d.push(v)}return d.concat(p)}},2609:(k,R,e)=>{"use strict";e.d(R,{_o:()=>f});var t=e(2543),n=e.n(t),i=e(71733),s=e(76885),r=e(65879),g=e(39601),a=e(2619),c=e(86022);const o={kiosk:!0,autofitpanels:!0,orgId:!0,"_dash.hideTimePicker":!0,"_dash.hideVariables":!0,"_dash.hideLinks":!0};class h extends a.Q{constructor(){super({isPlaying:!1}),this.urls=[],this.index=0,this.numberOfLoops=0,this.locationUpdated=this.locationUpdated.bind(this),this.api=(0,c.NF)()}next(){if(clearTimeout(this.nextTimeoutId),this.index>this.urls.length-1){if(this.numberOfLoops++,this.numberOfLoops>=3){window.location.href=this.startUrl;return}this.index=0}const m=this.urls[this.index],v=g.Ny.getSearchObject(),l=(0,t.pickBy)(v,(u,D)=>o[D]),y=i.I.stripBaseFromUrl(m);this.index++,this.validPlaylistUrl=y,this.nextTimeoutId=setTimeout(()=>this.next(),this.interval),g.Ny.push(y+"?"+s.kM.toUrlParams(l))}prev(){this.index=Math.max(this.index-2,0),this.next()}locationUpdated(p){p.pathname!==this.validPlaylistUrl&&this.stop()}async start(p){this.stop(),this.startUrl=window.location.href,this.index=0,this.setState({isPlaying:!0}),this.locationListenerUnsub=g.Ny.getHistory().listen(this.locationUpdated);const m=[];let v=await this.api.getPlaylist(p);if(!v.items?.length)return;this.interval=r.intervalToMs(v.interval);const l=await(0,c.qY)(v.items);for(const y of l)if(y.dashboards)for(const u of y.dashboards)m.push(u.url);m.length&&(this.urls=m,this.setState({isPlaying:!0}),this.next())}stop(){this.state.isPlaying&&(this.index=0,this.setState({isPlaying:!1}),this.locationListenerUnsub&&this.locationListenerUnsub(),this.nextTimeoutId&&clearTimeout(this.nextTimeoutId),g.Ny.getSearchObject().kiosk&&g.Ny.partial({kiosk:null}))}}const f=new h},86022:(k,R,e)=>{"use strict";e.d(R,{GM:()=>D,NF:()=>E,aV:()=>u,qY:()=>y});var t=e(75505),n=e(78368),i=e(17172),s=e(32264),r=e(82467),g=e(3169),a=e(90183),c=e(68706),o=e(99140),h=e(2468),f=e(24439);class d{async getAllPlaylist(){return(0,i.AI)().get("/api/playlists/")}async getPlaylist(P){const b=await(0,i.AI)().get(`/api/playlists/${P}`);return await v(b),b}async createPlaylist(P){await l(()=>(0,i.AI)().post("/api/playlists",P))}async updatePlaylist(P){await l(()=>(0,i.AI)().put(`/api/playlists/${P.uid}`,P))}async deletePlaylist(P){await l(()=>(0,i.AI)().delete(`/api/playlists/${P}`),"Playlist deleted")}}class p{constructor(){this.playlistAsK8sResource=P=>({metadata:{name:P.uid},spec:{title:P.name,interval:P.interval,items:P.items??[]}}),this.server=new h.w({group:"playlist.grafana.app",version:"v0alpha1",resource:"playlists"})}async getAllPlaylist(){return(await this.server.list()).items.map(m)}async getPlaylist(P){const b=await this.server.get(P),M=m(b);return await v(M),M}async createPlaylist(P){const b=this.playlistAsK8sResource(P);await l(async()=>{await this.server.create(b)})}async updatePlaylist(P){const b=this.playlistAsK8sResource(P);await l(()=>this.server.update(b).then(()=>{}))}async deletePlaylist(P){await l(()=>this.server.delete(P).then(()=>{}),"Playlist deleted")}}function m(x){const{spec:P,metadata:b}=x;return{uid:b.name,name:P.title,interval:P.interval,items:P.items}}async function v(x){if(x?.items){for(const P of x.items)if(P.type==="dashboard_by_id"){P.type="dashboard_by_uid";const b=await(0,i.AI)().get(`/api/dashboards/ids/${P.value}`);b?.length&&(P.value=b[0])}}}async function l(x,P="Playlist saved"){try{await x(),(0,o.JD)((0,r.dx)((0,g.tZ)(P)))}catch(b){b instanceof Error&&(0,o.JD)((0,r.dx)((0,g.gi)("Unable to save playlist",b)))}}async function y(x){let P=0;if(!x?.length)return[];const b=[];for(const I of x){const T={query:"*",kind:["dashboard"],limit:1e3};switch(I.type){case"dashboard_by_id":throw new Error("invalid item (with id)");case"dashboard_by_uid":T.uid=[I.value];break;case"dashboard_by_tag":T.tags=[I.value];break}b.push({refId:`${P++}`,queryType:c.nj.Search,search:T})}if(!s.$.featureToggles.panelTitleSearch){const I=(0,f.getGrafanaSearcher)(),T=[];for(let C=0;C<b.length;C++){const S=(await I.search(b[C].search)).view;T.push({...x[C],dashboards:S.map(A=>({...A}))})}return T}const M=await(0,a.o)(),O=await(0,t.s)(M.query({targets:b}));if(O.data.length!==x.length)throw new Error("unexpected result size");return x.map((I,T)=>{const C=new n.R(O.data[T]);return{...I,dashboards:C.map(S=>({...S}))}})}function u(){return{items:[],interval:"5m",name:"",uid:""}}function D(x,P){return P?.length?(P=P.toLowerCase(),x.filter(b=>b.name.toLowerCase().includes(P))):x}function E(){return s.$.featureToggles.kubernetesPlaylists?new p:new d}},84684:(k,R,e)=>{"use strict";e.d(R,{Ap:()=>p,Bj:()=>c,CB:()=>g,Gd:()=>d,T_:()=>a,XP:()=>m,cu:()=>l,ij:()=>y,xZ:()=>v});var t=e(36663),n=e(17172),i=e(80714),s=e(6745),r=e(5129);async function g(D){const E=await o(D),x=!!E,[P,b,M]=await Promise.all([d(),h(D,x),f(D)]),O=P.find(T=>T.id===D),I=O?.dependencies||E?.json?.dependencies;return{grafanaDependency:I?.grafanaDependency??I?.grafanaVersion??"",pluginDependencies:I?.plugins||[],links:O?.info.links||E?.json?.info.links||[],readme:M||E?.readme,versions:b,statusContext:E?.statusContext??"",iam:E?.json?.iam}}async function a(){try{const{items:D}=await(0,n.AI)().get(`${s.P5}/plugins`,{includeDeprecated:!0});return D.filter(r.hY)}catch(D){if((0,n.NF)(D))return D.isHandled=!0,console.error("Failed to fetch plugins from catalog (default https://grafana.com/api/plugins)"),[];throw D}}async function c(){try{return await(0,n.AI)().get(`${s.Sw}/errors`)}catch{return[]}}async function o(D){try{return await(0,n.AI)().get(`${s.P5}/plugins/${D}`,{})}catch(E){(0,n.NF)(E)&&(E.isHandled=!0);return}}async function h(D,E){try{return E?((await(0,n.AI)().get(`${s.P5}/plugins/${D}/versions`)).items||[]).map(P=>({version:P.version,createdAt:P.createdAt,isCompatible:P.isCompatible,grafanaDependency:P.grafanaDependency})):[]}catch(x){return(0,n.NF)(x)&&(x.isHandled=!0),[]}}async function f(D){try{const E=await(0,n.AI)().get(`${s.Sw}/${D}/markdown/README`);return E?(0,t.G)(E):""}catch(E){return(0,n.NF)(E)&&(E.isHandled=!0),""}}async function d(){return(await(0,n.AI)().get(`${s.Sw}`,(0,i.F)({embedded:0}))).filter(r.Sq)}async function p(){const{items:D}=await(0,n.AI)().get(`${s.Mi}/plugins`);return D}async function m(){const{items:D}=await(0,n.AI)().get(`${s.Mi}/provisioned-plugins`);return D.map(E=>({slug:E.type}))}async function v(D){return await(0,n.AI)().post(`${s.Sw}/${D}/install`,void 0,{showErrorAlert:!1})}async function l(D){return await(0,n.AI)().post(`${s.Sw}/${D}/uninstall`)}async function y(D,E){return(await(0,n.AI)().datasourceRequest({url:`/api/plugins/${D}/settings`,method:"POST",data:E}))?.data}const u={getRemotePlugins:a,getInstalledPlugins:d,installPlugin:v,uninstallPlugin:l}},42930:(k,R,e)=>{"use strict";e.d(R,{G:()=>s});var t=e(74848),n=e(32196),i=e(40845);const s=({children:g,wrap:a,className:c})=>{const o=(0,i.$j)(),h=r(o,a);return(0,t.jsx)("div",{className:(0,n.cx)(h.container,c),children:g})},r=(g,a)=>({container:(0,n.css)`
    display: flex;
    flex-direction: row;
    flex-wrap: ${a?"wrap":"no-wrap"};
    & > * {
      margin-bottom: ${g.spacing()};
      margin-right: ${g.spacing()};
    }
    & > *:last-child {
      margin-right: 0;
    }
  `})},6745:(k,R,e)=>{"use strict";e.d(R,{Mi:()=>n,P5:()=>i,Sw:()=>t,fu:()=>s});const t="/api/plugins",n="/api/instance",i="/api/gnet",s="plugins"},5129:(k,R,e)=>{"use strict";e.d(R,{Gl:()=>P,H2:()=>l,N6:()=>M,Sq:()=>O,TD:()=>F,Xc:()=>u,by:()=>y,hY:()=>I,j_:()=>b,kH:()=>m,td:()=>f,tr:()=>x});var t=e(53076),n=e(43429),i=e(53531),s=e(32264),r=e(33378),g=e(2913),a=e(10096),c=e(27677),o=e(31678),h=e(66253);function f({local:w=[],remote:B=[],instance:U=[],provisioned:K=[],pluginErrors:V}){const H=[],Y=D(V),X=U.reduce((q,ae)=>(q.set(ae.pluginSlug,ae),q),new Map),J=K.reduce((q,ae)=>(q.add(ae.slug),q),new Set);return w.forEach(q=>{const ae=B.find(te=>te.slug===q.id),j=Y[q.id];ae||H.push(d(q,void 0,j))}),B.forEach(q=>{const ae=w.find(ne=>ne.id===q.slug),j=Y[q.slug];if(!(q.status===h.Uy.Deprecated&&!ae)){const ne=d(ae,q,j);if(g.Ay.featureToggles.managedPluginsInstall&&s.$.pluginAdminExternalManageEnabled){ne.isFullyInstalled=ne.isCore?!0:(X.has(q.slug)||J.has(q.slug))&&ne.isInstalled,ne.isInstalled=X.has(q.slug)||ne.isInstalled;const le=X.get(q.slug);ne.isUpdatingFromInstance=X.has(q.slug)&&ne.hasUpdate&&ne.installedVersion!==le?.version,le?.version&&le?.version!==q.version&&(ne.hasUpdate=!0),ne.isUninstallingFromInstance=!!ae&&!X.has(q.slug),ne.isProvisioned=J.has(q.slug)}H.push(ne)}}),H}function d(w,B,U){return!w&&B?p(B,U):w&&!B?m(w,U):v(w,B,U)}function p(w,B){const{name:U,slug:K,description:V,version:H,orgName:Y,popularity:X,downloads:J,typeCode:q,updatedAt:ae,createdAt:j,status:te,angularDetected:ne,keywords:le}=w,z=!!B||S(q);return{description:V,downloads:J,id:K,info:{logos:{small:`${s.$.appSubUrl}/api/gnet/plugins/${K}/versions/${H}/logos/small`,large:`${s.$.appSubUrl}/api/gnet/plugins/${K}/versions/${H}/logos/large`},keywords:le},name:U,orgName:Y,popularity:X,publishedAt:j,signature:E({remote:w,error:B}),updatedAt:ae,hasUpdate:!1,isPublished:!0,isInstalled:z,isDisabled:z,isManaged:C(K),isDeprecated:te===h.Uy.Deprecated,isCore:w.internal,isDev:!1,isEnterprise:te===h.Uy.Enterprise,type:q,error:B?.errorCode,angularDetected:ne,isFullyInstalled:z}}function m(w,B){const{name:U,info:{description:K,version:V,logos:H,updated:Y,author:X,keywords:J},id:q,dev:ae,type:j,signature:te,signatureOrg:ne,signatureType:le,hasUpdate:z,accessControl:ee,angularDetected:se}=w,ie=!!B||S(j);return{description:K,downloads:0,id:q,info:{logos:H,keywords:J},name:U,orgName:X.name,popularity:0,publishedAt:"",signature:E({local:w,error:B}),signatureOrg:ne,signatureType:le,updatedAt:Y,installedVersion:V,hasUpdate:z,isInstalled:!0,isDisabled:ie,isCore:te==="internal",isPublished:!1,isDeprecated:!1,isDev:!!ae,isEnterprise:!1,isManaged:C(q),type:j,error:B?.errorCode,accessControl:ee,angularDetected:se,isFullyInstalled:!0,iam:w.iam}}function v(w,B,U){const K=w?.info.version,V=B?.slug||w?.id||"",H=w?.type||B?.typeCode,Y=!!U||S(H),X=B?.keywords||w?.info.keywords||[];let J={small:`/public/img/icn-${H}.svg`,large:`/public/img/icn-${H}.svg`};return B?J={small:`${s.$.appSubUrl}/api/gnet/plugins/${V}/versions/${B.version}/logos/small`,large:`${s.$.appSubUrl}/api/gnet/plugins/${V}/versions/${B.version}/logos/large`}:w&&w.info.logos&&(J=w.info.logos),{description:w?.info.description||B?.description||"",downloads:B?.downloads||0,hasUpdate:w?.hasUpdate||!1,id:V,info:{logos:J,keywords:X},isCore:!!(B?.internal||w?.signature===n.Ac.internal),isDev:!!w?.dev,isEnterprise:B?.status===h.Uy.Enterprise,isInstalled:!!w||Y,isDisabled:Y,isDeprecated:B?.status===h.Uy.Deprecated,isPublished:!0,isManaged:C(V),name:B?.name||w?.name||"",orgName:B?.orgName||w?.info.author.name||"",popularity:B?.popularity||0,publishedAt:B?.createdAt||"",type:H,signature:E({local:w,remote:B,error:U}),signatureOrg:w?.signatureOrg||B?.versionSignedByOrgName,signatureType:w?.signatureType||B?.versionSignatureType||B?.signatureType||void 0,updatedAt:B?.updatedAt||w?.info.updated||"",installedVersion:K,error:U?.errorCode,accessControl:w?.accessControl,angularDetected:w?.angularDetected??B?.angularDetected,isFullyInstalled:!!w||Y,iam:w?.iam}}const l=w=>`${s.$.pluginCatalogURL}${w}`;var y=(w=>(w.nameAsc="nameAsc",w.nameDesc="nameDesc",w.updated="updated",w.published="published",w.downloads="downloads",w))(y||{});const u=(w,B)=>{const U={nameAsc:(K,V)=>K.name.localeCompare(V.name),nameDesc:(K,V)=>V.name.localeCompare(K.name),updated:(K,V)=>(0,i.b)(V.updatedAt).valueOf()-(0,i.b)(K.updatedAt).valueOf(),published:(K,V)=>(0,i.b)(V.publishedAt).valueOf()-(0,i.b)(K.publishedAt).valueOf(),downloads:(K,V)=>V.downloads-K.downloads};return U[B]?w.sort(U[B]):w};function D(w=[]){return w.reduce((B,U)=>(B[U.pluginId]=U,B),{})}function E(w){const{error:B,local:U,remote:K}=w;if(B)switch(B.errorCode){case n.ZK.invalidSignature:return n.Ac.invalid;case n.ZK.missingSignature:return n.Ac.missing;case n.ZK.modifiedSignature:return n.Ac.modified}return U?.signature?U.signature:K?.signatureType&&K?.versionSignatureType?n.Ac.valid:n.Ac.missing}const x=()=>(0,c.AI)().get("/api/frontend/settings").then(w=>{s.$.panels=w.panels});function P(w){if(!w)return;const[B]=w.filter(U=>!!U.isCompatible);return B}const b=()=>s.$.pluginAdminEnabled,M=(w,B,U)=>{const K=s.$.pluginAdminExternalManageEnabled,V=a.TP.hasPermission(o.AccessControlAction.PluginsInstall),H=!!U;return w.type===n.QE.renderer||w.type===n.QE.secretsmanager||w.isEnterprise&&!(0,r.a)("enterprise.plugins")||w.isDev||!V&&!K||!w.isPublished||!H||!B},O=w=>T(w.id),I=w=>T(w.slug);function T(w){const{pluginCatalogHiddenPlugins:B}=s.$;return!B.includes(w)}function C(w){const{pluginCatalogManagedPlugins:B}=s.$;return B?.includes(w)}function S(w){return w===n.QE.secretsmanager&&!s.$.secretsManagerPluginEnabled}function A(w){return w?.signature==="internal"}function L(w){return w.split(" - ")[0]}function N(w){return w.reduce((B,{id:U,name:K,type:V,orgName:H,info:Y})=>{const X=Y.keywords?.join(" ").toLowerCase(),J=`${U} - ${K} - ${V} - ${H} - ${X}`;return B.push(J),B},[])}function F(w,B){const U=N(w);let V=new t.A({intraMode:1,intraSub:0}).filter(U,B);return V===null?null:V.map(H=>L(U[H]))}},20701:(k,R,e)=>{"use strict";e.d(R,{JC:()=>I,JJ:()=>u,LR:()=>y,NJ:()=>C,aU:()=>E,ai:()=>M,h9:()=>T,mj:()=>l,nT:()=>O,t5:()=>D,y7:()=>S});var t=e(65307),n=e(65474),i=e(62467),s=e(66847),r=e(45650),g=e(90593),a=e(75505),c=e(32264),o=e(17172),h=e(2913),f=e(15162),d=e(81900),p=e(84684),m=e(6745),v=e(5129);const l=(0,t.zD)(`${m.fu}/fetchAll`,async(A,L)=>{try{L.dispatch({type:`${m.fu}/fetchLocal/pending`}),L.dispatch({type:`${m.fu}/fetchRemote/pending`});const N=c.$.pluginAdminExternalManageEnabled&&h.Ay.featureToggles.managedPluginsInstall?(0,n.H)((0,p.Ap)()):(0,i.of)(void 0),F=c.$.pluginAdminExternalManageEnabled&&h.Ay.featureToggles.managedPluginsInstall?(0,n.H)((0,p.XP)()):(0,i.of)(void 0),w=500,B=(0,n.H)((0,p.Bj)()),U=(0,n.H)((0,p.Gd)()),K=(0,n.H)((0,p.T_)()).pipe((0,s.W)(V=>(L.dispatch({type:`${m.fu}/fetchRemote/rejected`}),console.error(V),(0,i.of)([]))));return(0,r.p)({local:U,remote:K,instance:N,provisioned:F,pluginErrors:B}).pipe((0,g.w)({each:w,with:()=>(K.subscribe(async V=>{if(L.dispatch({type:`${m.fu}/fetchRemote/fulfilled`}),V.length>0){const H=await(0,a.s)(U),Y=await(0,a.s)(N),X=await(0,a.s)(F),J=await(0,a.s)(B);L.dispatch(E((0,v.td)({local:H,remote:V,instance:Y,provisioned:X,pluginErrors:J})))}}),(0,r.p)({local:U,instance:N,provisioned:F,pluginErrors:B}))})).subscribe(({local:V,remote:H,instance:Y,provisioned:X,pluginErrors:J})=>{V&&H?(L.dispatch({type:`${m.fu}/fetchLocal/fulfilled`}),L.dispatch({type:`${m.fu}/fetchRemote/fulfilled`}),L.dispatch(E((0,v.td)({local:V,remote:H,instance:Y,provisioned:X,pluginErrors:J})))):V&&(L.dispatch({type:`${m.fu}/fetchLocal/fulfilled`}),L.dispatch(E((0,v.td)({local:V,pluginErrors:J}))))},V=>(console.log(V),L.dispatch({type:`${m.fu}/fetchLocal/rejected`}),L.dispatch({type:`${m.fu}/fetchRemote/rejected`}),L.rejectWithValue("Unknown error."))),null}catch{return L.rejectWithValue("Unknown error.")}}),y=(0,t.zD)(`${m.fu}/fetchAllLocal`,async(A,L)=>{try{return(await(0,p.Gd)()).map(F=>(0,v.kH)(F))}catch{return L.rejectWithValue("Unknown error.")}}),u=(0,t.zD)(`${m.fu}/fetchRemotePlugins`,async(A,L)=>{try{return await(0,p.T_)()}catch(N){return(0,o.NF)(N)&&(N.isHandled=!0),L.rejectWithValue([])}}),D=(0,t.zD)(`${m.fu}/fetchDetails`,async(A,L)=>{try{const N=await(0,p.CB)(A);return{id:A,changes:{details:N}}}catch{return L.rejectWithValue("Unknown error.")}}),E=(0,t.VP)(`${m.fu}/addPlugins`),x=(0,t.VP)(`${m.fu}/addLocalPlugins`),P=(0,t.VP)(`${m.fu}/addLocalPlugins`),b=(0,t.VP)(`${m.fu}/addLocalPlugins`),M=(0,t.zD)(`${m.fu}/install`,async({id:A,version:L,isUpdating:N=!1},F)=>{const w=N?{isInstalled:!0,installedVersion:L,hasUpdate:!1}:{isInstalled:!0,installedVersion:L};try{return await(0,p.xZ)(A),await(0,v.tr)(),N&&(0,d.sk)(A),{id:A,changes:w}}catch(B){return console.error(B),(0,o.NF)(B)?F.rejectWithValue(B.data):F.rejectWithValue("Unknown error.")}}),O=(0,t.zD)(`${m.fu}/install`,async()=>({})),I=(0,t.zD)(`${m.fu}/uninstall`,async(A,L)=>{try{return await(0,p.cu)(A),await(0,v.tr)(),(0,d.sk)(A),{id:A,changes:{isInstalled:!1,installedVersion:void 0}}}catch(N){return console.error(N),L.rejectWithValue("Unknown error.")}}),T=(0,t.zD)(`${m.fu}/loadPluginDashboards`,async(A,L)=>{const w=`api/plugins/${L.getState().dataSources.dataSource.type}/dashboards`;return(0,o.AI)().get(w)}),C=(0,t.VP)(`${m.fu}/panelPluginLoaded`),S=A=>async(L,N)=>{let F=N().plugins.panels[A];return F||(F=await(0,f.TV)(A),N().plugins.panels[A]||L(C(F))),F}},31326:(k,R,e)=>{"use strict";e.d(R,{AI:()=>r,Ff:()=>p,qo:()=>d});var t=e(65307),n=e(6745),i=e(66253),s=e(20701);const r=(0,t.pU)(),g=m=>new RegExp(`${n.fu}/(.*)/pending`).test(m.type),a=m=>new RegExp(`${n.fu}/(.*)/fulfilled`).test(m.type),c=m=>new RegExp(`${n.fu}/(.*)/rejected`).test(m.type),o=m=>{const v=m.lastIndexOf("/");return m.substring(0,v)},h={items:r.getInitialState(),requests:{},settings:{displayMode:i.fy.Grid},plugins:[],errors:[],searchQuery:"",hasFetched:!1,dashboards:[],isLoadingPluginDashboards:!1,panels:{}},f=(0,t.Z0)({name:"plugins",initialState:h,reducers:{setDisplayMode(m,v){m.settings.displayMode=v.payload}},extraReducers:m=>m.addCase(s.aU,(v,l)=>{r.upsertMany(v.items,l.payload)}).addCase(s.LR.fulfilled,(v,l)=>{r.upsertMany(v.items,l.payload)}).addCase(s.t5.fulfilled,(v,l)=>{r.updateOne(v.items,l.payload)}).addCase(s.ai.fulfilled,(v,l)=>{r.updateOne(v.items,l.payload)}).addCase(s.JC.fulfilled,(v,l)=>{r.updateOne(v.items,l.payload)}).addCase(s.NJ,(v,l)=>{v.panels[l.payload.meta.id]=l.payload}).addCase(s.h9.pending,(v,l)=>{v.isLoadingPluginDashboards=!0,v.dashboards=[]}).addCase(s.h9.fulfilled,(v,l)=>{v.isLoadingPluginDashboards=!1,v.dashboards=l.payload}).addMatcher(g,(v,l)=>{v.requests[o(l.type)]={status:i.IZ.Pending}}).addMatcher(a,(v,l)=>{v.requests[o(l.type)]={status:i.IZ.Fulfilled}}).addMatcher(c,(v,l)=>{v.requests[o(l.type)]={status:i.IZ.Rejected,error:l.payload}})}),{setDisplayMode:d}=f.actions,p=f.reducer},66253:(k,R,e)=>{"use strict";e.d(R,{IZ:()=>c,Ip:()=>i,LZ:()=>a,Uy:()=>s,fy:()=>t,og:()=>g,u8:()=>r,vk:()=>n});var t=(o=>(o.Grid="grid",o.List="list",o))(t||{}),n=(o=>(o.Home="plugins-home",o.Browse="plugins-browse",o.Details="plugins-details",o))(n||{}),i=(o=>(o.app="apps",o.datasource="database",o.panel="credit-card",o.renderer="capture",o.secretsmanager="key-skeleton-alt",o))(i||{}),s=(o=>(o.Deleted="deleted",o.Active="active",o.Pending="pending",o.Deprecated="deprecated",o.Enterprise="enterprise",o))(s||{}),r=(o=>(o.INSTALL="INSTALL",o.UNINSTALL="UNINSTALL",o.UPDATE="UPDATE",o.REINSTALL="REINSTALL",o))(r||{}),g=(o=>(o.OVERVIEW="Overview",o.VERSIONS="Version history",o.CONFIG="Config",o.DASHBOARDS="Dashboards",o.USAGE="Usage",o.IAM="IAM",o))(g||{}),a=(o=>(o.OVERVIEW="overview",o.VERSIONS="version-history",o.CONFIG="config",o.DASHBOARDS="dashboards",o.USAGE="usage",o.IAM="iam",o))(a||{}),c=(o=>(o.Pending="Pending",o.Fulfilled="Fulfilled",o.Rejected="Rejected",o))(c||{})},74106:(k,R,e)=>{"use strict";e.d(R,{c:()=>a});var t=e(74848),n=e(96540),i=e(43429),s=e(14110),r=e(42418);function g(c,o){let h;switch(c){case i.QE.app:h="app plugin";break;case i.QE.panel:h="panel plugin";break;case i.QE.datasource:h="data source plugin";break;default:h="plugin"}let f=`This ${h} uses a deprecated, legacy platform based on AngularJS and `;return o===void 0?f+" may be incompatible depending on your Grafana configuration.":o?f+" will stop working in future releases of Grafana.":f+" is incompatible with your current Grafana configuration."}function a(c){const{className:o,angularSupportEnabled:h,pluginId:f,pluginType:d,showPluginDetailsLink:p,interactionElementId:m}=c,[v,l]=(0,n.useState)(!1),y={};return f&&(y.pluginId=f),m&&(y.elementId=m),v?null:(0,t.jsxs)(r.F,{severity:"warning",title:"Angular plugin",className:o,onRemove:()=>l(!0),children:[(0,t.jsx)("p",{children:g(d,h)}),(0,t.jsx)("div",{className:"markdown-html",children:(0,t.jsxs)("ul",{children:[(0,t.jsx)("li",{children:(0,t.jsx)("a",{href:"https://grafana.com/docs/grafana/latest/developers/angular_deprecation/",className:"external-link",target:"_blank",rel:"noreferrer",onClick:()=>{(0,s.rR)("angular_deprecation_docs_clicked",y)},children:"Read our deprecation notice and migration advice."})}),p&&f?(0,t.jsx)("li",{children:(0,t.jsx)("a",{href:`plugins/${encodeURIComponent(f)}`,className:"external-link",target:"_blank",rel:"noreferrer",children:"View plugin details"})}):null]})})]})}},8480:(k,R,e)=>{"use strict";e.d(R,{Hv:()=>s,mz:()=>r});var t=e(32264);function n(g){return Object.values(t.$.datasources).find(a=>a.uid===g)??null}function i(g){return n(g)?.meta.angular?.detected??!1}function s(g){const a=n(g);return(a?.meta.angular?.detected&&!a?.meta.angular.hideDeprecation)??!1}const r=new Set(["autoMigrateOldPanels","autoMigrateGraphPanel","autoMigrateTablePanel","autoMigratePiechartPanel","autoMigrateWorldmapPanel","autoMigrateStatPanel","disableAngular"])},10803:(k,R,e)=>{"use strict";e.d(R,{p:()=>s});var t=e(74848),n=e(43429),i=e(39938);const s=g=>{const a=r(g.state);return a?(0,t.jsx)(i.E,{className:g.className,color:a.color,title:a.tooltip,text:a.text,icon:a.icon}):null};function r(g){switch(g){case n.pn.deprecated:return{text:"Deprecated",color:"red",tooltip:"This feature is deprecated and will be removed in a future release"};case n.pn.alpha:return{text:"Alpha",color:"blue",tooltip:"This feature is experimental and future updates might not be backward compatible"};case n.pn.beta:return{text:"Beta",color:"blue",tooltip:"This feature is close to complete but not fully tested"};default:return null}}},31193:(k,R,e)=>{"use strict";e.d(R,{tR:()=>y,xq:()=>m});var t=e(40187),n=e(26272),i=e(80147),s=e(72574),r=e(81634),g=e(17172),a=e(19347),c=e(26657),o=e(28138),h=e(2913),f=e(53478),d=e(66718),p=e(59421);class m{constructor(D=(0,s.w)()){this.templateSrv=D,this.datasources={},this.settingsMapByName={},this.settingsMapByUid={},this.settingsMapById={},this.defaultName=""}init(D,E){this.datasources={},this.settingsMapByUid={},this.settingsMapByName=D,this.defaultName=E;for(const x of Object.values(D))x.uid||(x.uid=x.name),this.settingsMapByUid[x.uid]=x,this.settingsMapById[x.id]=x;this.datasources[c.dR.type]=f.Ex,this.datasources[d.Uj]=f.Ex,this.settingsMapByUid[c.dR.uid]=f.$i,this.settingsMapByUid[d.Uj]=f.$i}getDataSourceSettingsByUid(D){return this.settingsMapByUid[D]}getInstanceSettings(D,E){let x=v(D);if((0,c.s9)(x))return f.$i;if(x==="default"||x==null)return this.settingsMapByUid[this.defaultName]??this.settingsMapByName[this.defaultName];if(x[0]==="$"){const P=this.templateSrv.replace(x,E,l);let b;return P==="default"?b=this.settingsMapByName[this.defaultName]:b=this.settingsMapByUid[P]??this.settingsMapByName[P],b?{...b,isDefault:!1,name:x,uid:x,rawRef:{type:b.type,uid:b.uid}}:void 0}return this.settingsMapByUid[x]??this.settingsMapByName[x]??this.settingsMapById[x]}get(D,E){let x=v(D);if(!x)return this.get(this.defaultName);if((0,c.s9)(D))return Promise.resolve(this.datasources[d.Uj]);const P=this.settingsMapByName[x];return P&&(x=P.uid),this.datasources[x]?Promise.resolve(this.datasources[x]):(x=this.templateSrv.replace(x,E,l),x==="default"&&this.defaultName!=="default"?this.get(this.defaultName):this.datasources[x]?Promise.resolve(this.datasources[x]):this.loadDatasource(x))}async loadDatasource(D){if(this.datasources[D])return Promise.resolve(this.datasources[D]);const E=this.getInstanceSettings(D);if(!E)return Promise.reject({message:`Datasource ${D} was not found`});try{const x=await(0,p.cS)(E.meta);if(this.datasources[D])return this.datasources[D];const P=x.DataSourceClass.length!==1;let b;if(P?b=(0,r.C)().instantiate(x.DataSourceClass,{instanceSettings:E}):b=new x.DataSourceClass(E),b.components=x.components,!(b instanceof t.mA)){const M=b;M.name=E.name,M.id=E.id,M.type=E.type,M.meta=E.meta,M.uid=E.uid,b.getRef=t.mA.prototype.getRef}return this.datasources[D]=b,this.datasources[b.uid]=b,b}catch(x){return x instanceof Error&&o.A.emit(n.r1.alertError,[E.name+" plugin failed",x.toString()]),Promise.reject({message:`Datasource: ${D} was not found`})}}getAll(){return Object.values(this.settingsMapByName)}getList(D={}){const E=Object.values(this.settingsMapByName).filter(P=>!(P.meta.id==="grafana"||P.meta.id==="mixed"||P.meta.id==="dashboard"||D.metrics&&!P.meta.metrics||D.tracing&&!P.meta.tracing||D.logs&&P.meta.category!=="logging"&&!P.meta.logs||D.annotations&&!P.meta.annotations||D.alerting&&!P.meta.alerting||D.pluginId&&!(0,i._)(D.pluginId,P.meta)||D.filter&&!D.filter(P)||D.type&&(Array.isArray(D.type)?!D.type.includes(P.type):D.type!==P.type)||!D.all&&P.meta.metrics!==!0&&P.meta.annotations!==!0&&P.meta.tracing!==!0&&P.meta.logs!==!0&&P.meta.alerting!==!0));if(D.variables)for(const P of this.templateSrv.getVariables()){if(P.type!=="datasource")continue;let b=P.current.value==="default"?this.defaultName:P.current.value;Array.isArray(b)&&(b=b[0]);const M=!Array.isArray(b)&&(this.settingsMapByName[b]||this.settingsMapByUid[b]);if(M){const O=`\${${P.name}}`;E.push({...M,isDefault:!1,name:O,uid:O})}}const x=E.sort((P,b)=>P.name.toLowerCase()>b.name.toLowerCase()?1:P.name.toLowerCase()<b.name.toLowerCase()?-1:0);if(!D.pluginId&&!D.alerting){if(D.mixed){const P=this.getInstanceSettings("-- Mixed --");P&&E.push(P)}if(D.dashboard){const P=this.getInstanceSettings("-- Dashboard --");P&&E.push(P)}if(!D.tracing){const P=this.getInstanceSettings("-- Grafana --");P&&E.push(P)}}return x}getExternal(){return this.getList()}getAnnotationSources(){return this.getList({annotations:!0,variables:!0}).map(D=>({name:D.name,value:D.name,meta:D.meta}))}getMetricSources(D){return this.getList({metrics:!0,variables:!D?.skipVariables}).map(E=>({name:E.name,value:E.name,meta:E.meta}))}async reload(){const D=await(0,g.AI)().get("/api/frontend/settings");h.Ay.datasources=D.datasources,h.Ay.defaultDatasource=D.defaultDatasource,this.init(D.datasources,D.defaultDatasource)}}function v(u){return(0,c.s9)(u)?c.dR.uid:typeof u=="string"?u:u?.uid}function l(u){return Array.isArray(u)?u[0]:u}const y=()=>(0,a.l)()},75462:(k,R,e)=>{"use strict";e.d(R,{$Y:()=>M,FF:()=>p,N9:()=>A,WW:()=>l,io:()=>T,nv:()=>D,ol:()=>x,pL:()=>S,yS:()=>v,yb:()=>u,yt:()=>P,z1:()=>m});var t=e(74848),n=e(32196),i=e(2543),s=e.n(i),r=e(16817),g=e(74135),a=e(13834),c=e(47232),o=e(37390),h=e(28138),f=e(27716),d=e(28444);function p(L){console.warn(`[Plugin Extensions] ${L}`)}function m(L){return typeof L=="object"&&"type"in L&&L.type===g.u.link}function v(L){return typeof L=="object"&&"type"in L&&L.type===g.u.component}function l(L){return typeof L=="object"&&"type"in L&&L.type===g.u.component&&L.extensionPointId.startsWith("capabilities/")}function y(L,N=""){return(...F)=>{try{return L(...F)}catch(w){w instanceof Error&&console.warn(`${N}${w.message}`)}}}function u(L,N){return{openModal:async w=>{const{title:B,body:U,width:K,height:V}=w;h.A.publish(new d.S8({component:D(L,E({title:B,body:U,width:K,height:V}))}))},context:N}}const D=(L,N)=>w=>{const{error:B,loading:U,value:K}=(0,r.A)(()=>(0,f.x)(L,{showErrorAlert:!1}));return U?null:B?(p(`Could not fetch plugin meta information for "${L}", aborting. (${B.message})`),null):K?(0,t.jsx)(a.a,{meta:K,children:(0,t.jsx)(N,{...w})}):(p(`Fetched plugin meta information is empty for "${L}", aborting.`),null)},E=({title:L,body:N,width:F,height:w})=>{const B=(0,n.css)({width:F,height:w});return({onDismiss:K})=>(0,t.jsx)(o.a,{title:L,className:B,isOpen:!0,onDismiss:K,onClickBackdrop:K,children:(0,t.jsx)(N,{onDismiss:K})})};function x(L,N=new Map){if(!L||typeof L!="object"||Object.isFrozen(L))return L;const F=Array.isArray(L)?[...L]:{...L};if(N.has(L))return N.get(L);N.set(L,F);const w=Reflect.ownKeys(F);for(const B of w){const U=Array.isArray(F)?F[Number(B)]:F[B];U&&(typeof U=="object"||typeof U=="function")&&(Array.isArray(F)?F[Number(B)]=x(U,N):F[B]=x(U,N))}return Object.freeze(F)}function P(L,N){const F=`${L}${N.extensionPointId}${N.title}`;return Array.from(F).reduce((w,B)=>Math.imul(31,w)+B.charCodeAt(0)|0,0).toString()}const b=Symbol("isReadOnlyProxy");function M(L){if(!L||typeof L!="object"||I(L))return L;const N=new WeakMap;return new Proxy(L,{defineProperty:()=>!1,deleteProperty:()=>!1,isExtensible:()=>!1,set:()=>!1,get(F,w,B){if(w===b)return!0;const U=Reflect.get(F,w,B);return(0,c.Ar)(U)?(0,c.KQ)(U):(0,i.isObject)(U)||(0,i.isArray)(U)?(N.has(U)||N.set(U,M(U)),N.get(U)):U}})}function O(L){return typeof L=="object"&&L!==null}function I(L){return O(L)&&L[b]===!0}function T(L){const N={type:g.u.link,...L};return C(N),N}function C(L){if(L.type!==g.u.link)throw Error("config is not a extension link")}function S(L,N){return L.length<N?L:`${L.slice(0,N-3).trimEnd()}...`}function A(L){const N={},F=[];for(const B of L){const U=B.category;if(!U){F.push({text:S(B.title,25),href:B.path,onClick:B.onClick});continue}Array.isArray(N[U])||(N[U]=[]),N[U].push({text:S(B.title,25),href:B.path,onClick:B.onClick})}const w=Object.keys(N).reduce((B,U)=>(B.push({text:S(U,25),type:"group",subMenu:N[U]}),B),[]);return F.length>0&&(w.length>0&&w.push({text:"divider",type:"divider"}),Array.prototype.push.apply(w,F)),w}},15162:(k,R,e)=>{"use strict";e.d(R,{Kk:()=>h,PY:()=>f,TV:()=>a,d4:()=>o,f7:()=>m,oZ:()=>c});var t=e(65158),n=e(2913),i=e(41394),s=e(59421);const r={},g={};function a(v){const l=r[v];if(l)return l;const y=o(v);if(!y)throw new Error(`Plugin ${v} not found`);return r[v]=d(y),v!==y.type&&(r[y.type]=r[v]),r[v]}function c(v){return!!o(v)}function o(v){const l=n.Ay.panels[v];if(!l){for(const y of Object.values(n.Ay.panels))if(y.aliasIDs?.includes(v))return y}return l}function h(v){return d(v)}function f(v){return g[v]}function d(v){return(0,s.j4)({path:v.module,version:v.info?.version,isAngular:v.angular?.detected,pluginId:v.id}).then(l=>{if(l.plugin)return l.plugin;if(l.PanelCtrl){const y=new t.m(null);return y.angularPanelCtrl=l.PanelCtrl,y}throw new Error("missing export: plugin or PanelCtrl")}).then(l=>(l.meta=v,g[v.id]=l,!l.panel&&l.angularPanelCtrl&&(l.panel=p(l)),l)).catch(l=>(console.warn("Error loading panel plugin: "+v.id,l),(0,i.W)(v,l)))}let p=v=>null;function m(v){p=v}},81900:(k,R,e)=>{"use strict";e.d(R,{GD:()=>s,QO:()=>a,ni:()=>g,sk:()=>r});var t=e(27716),n=e(45179);const i={};function s({pluginId:o,version:h,isAngular:f}){const d=o;d&&!i[d]&&(i[d]={version:encodeURI(h),isAngular:f,pluginId:o})}function r(o){const h=o;i[h]&&delete i[h],(0,t.o)(o)}function g(o,h=n.x8){const f=c(o);if(!f)return`${o}?_cache=${h}`;const p=i[f]?.version||h;return`${o}?_cache=${p}`}function a(o){const h=c(o);if(h)return i[h]}function c(o){const h=Object.keys(i).find(f=>o.includes(f));if(h)return h}},45179:(k,R,e)=>{"use strict";e.d(R,{$b:()=>n,Bu:()=>i,XV:()=>t,x8:()=>s});const t="package",n=/^plugins.+\.css$/i,i=/^(text|application)\/(x-)?javascript(;|$)/,s=Date.now()},63770:(k,R,e)=>{"use strict";e.d(R,{z:()=>a});var t=e(59511),n=e.n(t),i=e(65024),s=e.n(i),r=e(35135),g=e.n(r);const a=window.System},94429:(k,R,e)=>{"use strict";e.d(R,{kB:()=>f,OD:()=>d,Av:()=>p});var t=e(32264),n=e(66161),i=e(45179),s=e(34867);const r=new WeakMap,g={};function a(m,v,l){const y={get(u,D){if(document.currentScript===null&&typeof D!="symbol"&&D.toString()!=="__useDefault"){const x=`${v}.${String(D)}`,P=`${x}`;g[P]||(g[P]=!0,(0,s.fH)(`Plugin using ${x}`,{key:String(D),parent:v,packageName:l}))}let E=Reflect.get(u,D);return E!==null&&typeof E=="object"&&!(E instanceof RegExp)?(r.has(E)||r.set(E,a(E,`${v}.${String(D)}`,l)),r.get(E)):(typeof E=="function"&&(E=E.bind(u)),E)}};return typeof m=="object"&&m!==null?new Proxy(m,y):m}const c=/^(@grafana|app\/)/;function o(m,v){return c.test(v)?a(m,v,v):m}var h=e(63770);function f(m){return Object.keys(m).reduce((v,l)=>{const y=`${i.XV}:${l}`,u=t.$.featureToggles.pluginsAPIMetrics?o(m[l],l):m[l];return h.z.set(y,u),n.s.set(l,m[l]),v[l]=y,v},{})}function d(m){return!!t.$.pluginsCDNBaseURL&&m.startsWith(t.$.pluginsCDNBaseURL)}function p(m){return m.startsWith("http")||m.startsWith("/")?m:`${t.$.appSubUrl??""}/${m}`}},27716:(k,R,e)=>{"use strict";e.d(R,{o:()=>s,x:()=>i});var t=e(17172);const n={};function i(r,g){const a=n[r];return a?Promise.resolve(a):(0,t.AI)().get(`/api/plugins/${r}/settings`,void 0,void 0,g).then(c=>(n[r]=c,c)).catch(c=>typeof c=="object"&&c!==null&&"status"in c&&c.status===403?(c.isHandled=!0,Promise.reject(c)):Promise.reject(new Error("Unknown Plugin")))}const s=r=>r?delete n[r]:Object.keys(n).forEach(g=>delete n[g])},59421:(k,R,e)=>{"use strict";e.d(R,{ui:()=>np,cS:()=>tp,j4:()=>td});var t={};e.r(t),e.d(t,{plugin:()=>Qe});var n={};e.r(n),e.d(n,{plugin:()=>Tn});var i={};e.r(i),e.d(i,{plugin:()=>Cr});var s={};e.r(s),e.d(s,{plugin:()=>Ca});var r={};e.r(r),e.d(r,{plugin:()=>Ul});var g={};e.r(g),e.d(g,{plugin:()=>bs});var a={};e.r(a),e.d(a,{plugin:()=>ka});var c={};e.r(c),e.d(c,{plugin:()=>Ku});var o={};e.r(o),e.d(o,{plugin:()=>_u});var h={};e.r(h),e.d(h,{plugin:()=>Fl});var f={};e.r(f),e.d(f,{plugin:()=>rh});var d={};e.r(d),e.d(d,{plugin:()=>yh});var p={};e.r(p),e.d(p,{plugin:()=>bc});var m={};e.r(m),e.d(m,{plugin:()=>Bh});var v={};e.r(v),e.d(v,{plugin:()=>ef});var l={};e.r(l),e.d(l,{plugin:()=>nf});var y={};e.r(y),e.d(y,{plugin:()=>af});var u={};e.r(u),e.d(u,{plugin:()=>hf});var D={};e.r(D),e.d(D,{plugin:()=>eu});var E={};e.r(E),e.d(E,{plugin:()=>Af});var x={};e.r(x),e.d(x,{plugin:()=>Bf});var P={};e.r(P),e.d(P,{plugin:()=>lu});var b={};e.r(b),e.d(b,{plugin:()=>du});var M=e(40187),O=e(41987),I=e(32264),T=e(74848),C=e(65158),S=e(67061),A=e(55852),L=e(85242),N=e(51612),F=e(31678),w=e(57220),B=e(2543),U=e.n(B),K=e(96540),V=e(90182),H=e(14578),Y=e(61410),X=e(23770),J=e(88467),q=e(94822),ae=e(75214);const j=Q=>{const{onChange:fe,id:be,defaultValue:Be,dataSource:He}=Q,at=(0,F.useDispatch)();(0,K.useEffect)(()=>{He?He&&at((0,X.mB)({rulesSourceName:He})):at((0,X.nV)())},[at,He]);const it=(0,Y.$)(_t=>_t.promRules),Dt=(0,J.p0)(it),Ot=(0,J.Vf)(it),wt=(0,K.useMemo)(()=>{if((0,B.isEmpty)(it))return[];if(!Dt)return[];const _t=Object.keys(it).flatMap(Qt=>it[Qt].result??[]).flatMap(Qt=>Qt.groups).flatMap(Qt=>Qt.rules.filter(rn=>rn.type===q.JS.Alerting)).flatMap(Qt=>Qt.alerts??[]).map(Qt=>Object.keys(Qt.labels??{})).flatMap(Qt=>Qt.filter(rn=>!(0,ae.F2)(rn)));return(0,B.uniq)(_t)},[Dt,it]);return(0,T.jsx)(V.KF,{id:be,isLoading:Ot,defaultValue:Be,"aria-label":"group by label keys",placeholder:"Group by",prefix:(0,T.jsx)(H.I,{name:"tag-alt"}),onChange:_t=>{fe(_t.map(Qt=>Qt.value??""))},options:wt.map(_t=>({label:_t,value:_t}))})};var te=e(32196),ne=e(42941),le=e(94701),z=e(3591),ee=e(40845),se=e(40276),ie=e(37494),Z=e(39558),oe=e(42418),ce=e(2913),ye=e(55907),re=e(79938),ue=e(75648),De=e(9518),ge=e(55740),Te=e(32642),Le=e(23662),Ye=e(14792),je=e(19073),Ze=e(64861),Ne=e(15458),Pe=e(55127),Ue=e.n(Pe),$e=e(2426),ze=e(56361),qe=e(15054),dt=e(98164),vt=e(54317);function yt(Q,fe){const be=(0,Te.Zc)(Q);return(0,dt.Av)(fe,be)}function st(Q,fe){const{stateFilter:be,alertInstanceLabelFilter:Be}=Q;return(0,B.isEmpty)(be)?fe:fe.filter(He=>(be.firing&&((0,vt.S)(He,q.Gi.Alerting)||(0,vt.S)(He,q.cF.Firing))||be.pending&&((0,vt.S)(He,q.Gi.Pending)||(0,vt.S)(He,q.cF.Pending))||be.noData&&(0,vt.S)(He,q.Gi.NoData)||be.normal&&(0,vt.S)(He,q.Gi.Normal)||be.error&&(0,vt.S)(He,q.Gi.Error)||be.inactive&&(0,vt.S)(He,q.cF.Inactive))&&(Be?yt(Q.alertInstanceLabelFilter,He.labels):!0))}const Ve=({rule:Q,alerts:fe,options:be,grafanaTotalInstances:Be,handleInstancesLimit:He,limitInstances:at,grafanaFilteredInstancesTotal:it})=>{const Dt=be.groupMode===Ze.r6.Custom?!0:be.showInstances,[Ot,wt]=(0,K.useState)(Dt),_t=(0,ee.of)(pe),Qt=(0,ee.of)(A.my),rn=(0,K.useCallback)(()=>{wt(Xs=>!Xs)},[]),kt=(0,K.useMemo)(()=>st(be,(0,ze.Cp)(be.sortOrder,fe))??[],[fe,be]),pn=Be!==void 0,_n=Be&&it?Be-it:0,An=fe.length-kt.length,$n=pn?_n:An,Bn=kt.length>0,un=Bn?rn:B.noop;(0,K.useEffect)(()=>{kt.length===0&&wt(!1)},[kt]);const bn=async()=>{He&&(He(!1),wt(!0))},Us=async()=>{He&&(He(!0),wt(!0))},us=at?it:kt.length,Ts=kt.length,zn=pn?us:Ts,On=at?`Showing ${ue.Ys} of ${Be} instances`:`Showing all ${Be} instances`,fs=at?"View all instances":`Limit the result to ${ue.Ys} instances`,Hn=Be&&ue.Ys===kt.length&&Be>kt.length,ps=Be&&ue.Ys<kt.length&&!at,ks=Hn||ps?(0,T.jsxs)("div",{className:_t.footerRow,children:[(0,T.jsx)("div",{children:On}),(0,T.jsx)(A.$n,{size:"sm",variant:"secondary",onClick:at?bn:Us,children:fs})]}):void 0;return(0,T.jsxs)("div",{children:[be.groupMode===Ze.r6.Default&&(0,T.jsxs)("button",{className:(0,te.cx)(Qt,Bn?_t.clickable:""),onClick:()=>un(),children:[Bn&&(0,T.jsx)(H.I,{name:Ot?"angle-down":"angle-right",size:"md"}),(0,T.jsx)("span",{children:`${zn} ${Ue()("instance",zn)}`}),$n>0&&(0,T.jsxs)("span",{children:[", ",`${$n} hidden by filters`]})]}),Ot&&(0,T.jsx)($e.D,{rule:Q,instances:kt,pagination:{itemsPerPage:2*qe.FG},footerRow:ks})]})},pe=Q=>({clickable:(0,te.css)`
    cursor: pointer;
  `,footerRow:(0,te.css)`
    display: flex;
    flex-direction: column;
    gap: ${Q.spacing(1)};
    justify-content: space-between;
    align-items: center;
    width: 100%;
  `}),Ee="__ungrouped__",me=({rules:Q,options:fe})=>{const be=(0,ee.of)(Je),Be=fe.groupBy,He=(0,K.useMemo)(()=>{const at=new Map,it=wt=>Be?Ie(wt,Be):!0;Q.forEach(wt=>{const _t=(0,Le.TU)(wt),Qt=it(wt);(_t?.alerts??[]).forEach(rn=>{const kt=Qt?ve(Be,rn.labels):Ee,pn=at.get(kt)?.alerts??[];at.set(kt,{rule:wt,alerts:[...pn,rn]})})});const Dt=at.get(Ee)?.alerts??[];return at.delete(Ee),at.set(Ee,{alerts:Dt}),Array.from(at.entries()).reduce((wt,[_t,{rule:Qt,alerts:rn}])=>{const kt=st(fe,rn);return kt.length>0&&wt.set(_t,{rule:Qt,alerts:kt}),wt},new Map)},[Be,Q,fe]);return(0,T.jsx)(T.Fragment,{children:Array.from(He).map(([at,{rule:it,alerts:Dt}])=>(0,T.jsx)("li",{className:be.alertRuleItem,"data-testid":at,children:(0,T.jsxs)("div",{children:[(0,T.jsx)("div",{className:be.customGroupDetails,children:(0,T.jsxs)("div",{className:be.alertLabels,children:[at!==Ee&&Se(at).map(([Ot,wt])=>(0,T.jsx)(Ne.R,{labelKey:Ot,value:wt},Ot)),at===Ee&&"No grouping"]})}),(0,T.jsx)(Ve,{rule:it,alerts:Dt,options:fe})]})},at))})};function ve(Q,fe){return new URLSearchParams(Q.map(be=>[be,fe[be]])).toString()}function Se(Q){return[...new URLSearchParams(Q)]}function Ie(Q,fe){const be=(0,Le.TU)(Q);return fe.every(Be=>(be?.alerts??[]).some(He=>He.labels[Be]))}const Oe=me;var Re=e(87586),he=e(70416),Ce=e(26058),We=e(18461),et=e(3704);function rt(Q){return Object.values(Q).filter(fe=>fe!==void 0).reduce((fe,be)=>fe+be,0)}const nt=({rules:Q,options:fe,handleInstancesLimit:be,limitInstances:Be,hideViewRuleLinkText:He})=>{const at=(0,ee.of)(Je),it=(0,ee.of)(gt),{href:Dt}=(0,Re.A)(),Ot=Q.length<=fe.maxItems?Q:Q.slice(0,fe.maxItems);return(0,T.jsx)(T.Fragment,{children:(0,T.jsx)("ol",{className:at.alertRuleList,children:Ot.map((wt,_t)=>{const{namespaceName:Qt,groupName:rn,dataSourceName:kt}=wt,pn=(0,Le.Z8)(wt.promRule)?wt.promRule:void 0,_n=(0,Le.Om)(pn),An=(0,We.UP)(wt.dataSourceName,wt),$n=(0,We.$9)(An),Bn=wt.dataSourceName===w.hY?rt(wt.instanceTotals):void 0,un=wt.dataSourceName===w.hY?rt(wt.filteredInstanceTotals):void 0,bn=(0,et.G)(`/alerting/${encodeURIComponent(kt)}/${encodeURIComponent($n)}/view`,{returnTo:Dt??""});return pn?(0,T.jsxs)("li",{className:at.alertRuleItem,children:[(0,T.jsx)("div",{className:it.icon,children:(0,T.jsx)(H.I,{name:ye.A.getStateDisplayModel(pn.state).iconClass,className:it[(0,Le.Wy)(pn.state)],size:"lg"})}),(0,T.jsxs)("div",{className:at.alertNameWrapper,children:[(0,T.jsxs)("div",{className:at.instanceDetails,children:[(0,T.jsxs)(S.B,{direction:"row",gap:1,children:[(0,T.jsx)("div",{className:at.alertName,title:wt.name,children:wt.name}),(0,T.jsx)(Ce.h,{}),bn&&(0,T.jsxs)("a",{href:bn,target:"__blank",className:at.link,rel:"noopener","aria-label":"View alert rule",children:[(0,T.jsx)("span",{className:(0,te.cx)({[at.hidden]:He}),children:"View alert rule"}),(0,T.jsx)(H.I,{name:"external-link-alt",size:"sm"})]})]}),(0,T.jsxs)("div",{className:at.alertDuration,children:[(0,T.jsx)("span",{className:it[(0,Le.Wy)(pn.state)],children:(0,Le.XI)(pn.state)})," ",_n&&pn.state!==q.cF.Inactive&&(0,T.jsxs)(T.Fragment,{children:["for"," ",(0,T.jsx)("span",{children:(0,he.dU)({start:_n,end:Date.now()})})]})]})]}),(0,T.jsx)(Ve,{rule:wt,alerts:pn.alerts??[],options:fe,grafanaTotalInstances:Bn,grafanaFilteredInstancesTotal:un,handleInstancesLimit:be,limitInstances:Be})]})]},`alert-${Qt}-${rn}-${wt.name}-${_t}`):null})})})},gt=Q=>({common:(0,te.css)`
    width: 70px;
    text-align: center;
    align-self: stretch;

    display: inline-block;
    color: white;
    border-radius: ${Q.shape.radius.default};
    font-size: ${Q.typography.bodySmall.fontSize};
    text-transform: capitalize;
    line-height: 1.2;
    flex-shrink: 0;

    display: flex;
    flex-direction: column;
    justify-content: center;
  `,icon:(0,te.css)`
    margin-top: ${Q.spacing(2.5)};
    align-self: flex-start;
  `,good:(0,te.css)`
    color: ${Q.colors.success.main};
  `,bad:(0,te.css)`
    color: ${Q.colors.error.main};
  `,warning:(0,te.css)`
    color: ${Q.colors.warning.main};
  `,neutral:(0,te.css)`
    color: ${Q.colors.secondary.main};
  `,info:(0,te.css)`
    color: ${Q.colors.primary.main};
  `}),xt=nt;function St(Q){const fe=(be,[Be,He])=>He?[...be,Be]:be;return Object.entries(Q).reduce(fe,[])}const zt=({dispatch:Q,limitInstances:fe,matcherList:be,dataSourceName:Be,stateList:He})=>{Q(Be?(0,X.Lc)({rulesSourceName:Be,limitAlerts:fe?ue.Ys:void 0,matcher:be,state:He}):(0,X.yo)(!1,{limitAlerts:fe?ue.Ys:void 0,matcher:be,state:He}))};function Nt(Q){const fe=(0,F.useDispatch)(),[be,Be]=(0,ne.A)(!0),[,He]=(0,je.Ej)(je.RY.ViewAlertRule),{usePrometheusRulesByNamespaceQuery:at}=re.hK,it=(0,Y.$)(xs=>xs.promRules),Dt=(0,Y.$)(xs=>xs.rulerRules),Ot=(0,J.t4)(it),wt=Q.width<320;(0,K.useEffect)(()=>{Q.options.stateFilter.inactive===!0&&(Q.options.stateFilter.normal=!0),Q.options.stateFilter.inactive=void 0},[Q.options.stateFilter]);let _t;(0,le.A)(()=>{_t=(0,Ye.UA)().getCurrent()});const Qt=(0,K.useMemo)(()=>St(Q.options.stateFilter),[Q.options.stateFilter]),{options:rn,replaceVariables:kt}=Q,pn=rn.datasource===w.vv?w.hY:rn.datasource,_n={...Q.options,alertName:kt(rn.alertName),alertInstanceLabelFilter:kt(rn.alertInstanceLabelFilter)},An=(0,K.useMemo)(()=>(0,Te.Zc)(_n.alertInstanceLabelFilter),[_n.alertInstanceLabelFilter]),$n=(!pn||pn===w.hY)&&He,{currentData:Bn=[],isLoading:un,refetch:bn}=at({limitAlerts:be?ue.Ys:void 0,matcher:An,state:Qt},{skip:!$n});(0,K.useEffect)(()=>{it.loading||zt({dispatch:fe,limitInstances:be,matcherList:An,dataSourceName:pn,stateList:Qt});const xs=_t?.events.subscribe(z.sR,()=>{$n&&bn(),(!pn||pn!==w.hY)&&zt({dispatch:fe,limitInstances:be,matcherList:An,dataSourceName:pn,stateList:Qt})});return()=>{xs?.unsubscribe()}},[fe,_t,An,Qt,be,pn,bn,$n,it.loading]);const Us=xs=>{xs?(zt({dispatch:fe,limitInstances:be,matcherList:An,dataSourceName:pn,stateList:Qt}),Be(!0)):(zt({dispatch:fe,limitInstances:!1,matcherList:An,dataSourceName:pn,stateList:Qt}),Be(!1))},us=(0,De.dy)(void 0,Bn),Ts=(0,J.t4)(Dt),zn=(0,J.BU)(it),On=Ot||Ts,fs=(0,J.Vf)(it),Hn=(0,ee.of)(Je),ps=(0,Le.dS)(us),ks=Q.options.sortOrder,Xs=(0,K.useMemo)(()=>en(Q,Vt(ks,ps)),[ps,ks,Q]),ia=Xs.length===0?"No alerts matching filters":void 0,ja=un||On&&fs&&!zn,Ys=Object.values(it).some(xs=>xs.result);return(0,T.jsx)(se.E,{autoHeightMin:"100%",autoHeightMax:"100%",children:(0,T.jsxs)("div",{className:Hn.container,children:[Ys&&ia&&(0,T.jsx)("div",{className:Hn.noAlertsMessage,children:ia}),Ys&&(0,T.jsxs)("section",{children:[Q.options.viewMode===Ze.nE.Stat&&(0,T.jsx)(ie.yV,{width:Q.width,height:Q.height,graphMode:ie.$p.None,textMode:ie.SV.Auto,justifyMode:ie.F8.Auto,theme:ce.config.theme2,value:{text:`${Xs.length}`,numeric:Xs.length}}),Q.options.viewMode===Ze.nE.List&&Q.options.groupMode===Ze.r6.Custom&&(0,T.jsx)(Oe,{rules:Xs,options:_n}),Q.options.viewMode===Ze.nE.List&&Q.options.groupMode===Ze.r6.Default&&(0,T.jsx)(xt,{rules:Xs,options:_n,handleInstancesLimit:Us,limitInstances:be,hideViewRuleLinkText:wt})]}),ja&&(0,T.jsx)(Z._,{text:"Loading..."})]})})}function Vt(Q,fe){if(Q===Ze.xB.Importance)return(0,B.sortBy)(fe,Be=>ye.A.alertStateSortScore[Be.state]);if(Q===Ze.xB.TimeAsc)return(0,B.sortBy)(fe,Be=>{const He=(0,Le.TU)(Be)??void 0;return(0,Le.Om)(He)||new Date});if(Q===Ze.xB.TimeDesc)return(0,B.sortBy)(fe,Be=>{const He=(0,Le.TU)(Be)??void 0;return(0,Le.Om)(He)||new Date}).reverse();const be=(0,B.sortBy)(fe,Be=>Be.name.toLowerCase());return Q===Ze.xB.AlphaDesc&&be.reverse(),be}function en(Q,fe){const{options:be,replaceVariables:Be}=Q;let He=[...fe];if(be.dashboardAlerts){const at=(0,Ye.UA)().getCurrent()?.uid;He=He.filter(({annotations:it={}})=>Object.entries(it).some(([Dt,Ot])=>Dt===ge.YH.dashboardUID&&Ot===at))}if(be.alertName){const at=Be(be.alertName);He=He.filter(({name:it})=>it.toLocaleLowerCase().includes(at.toLocaleLowerCase()))}if(He=He.filter(at=>{const it=(0,Le.TU)(at);return it?be.stateFilter.firing&&it.state===q.cF.Firing||be.stateFilter.pending&&it.state===q.cF.Pending||be.stateFilter.normal&&it.state===q.cF.Inactive:!1}),be.folder&&(He=He.filter(at=>at.namespaceName===be.folder.title)),be.datasource){const at=be.datasource===w.vv;He=He.filter(at?({dataSourceName:it})=>it===w.hY:({dataSourceName:it})=>it===be.datasource)}return He=He.reduce((at,it)=>{const Dt=(0,Le.TU)(it);return(Dt?st({stateFilter:be.stateFilter,alertInstanceLabelFilter:Be(be.alertInstanceLabelFilter)},Dt.alerts??[]):[]).length&&at.push(it),at},[]),He}const Je=Q=>({cardContainer:(0,te.css)`
    padding: ${Q.spacing(.5)} 0 ${Q.spacing(.25)} 0;
    line-height: ${Q.typography.body.lineHeight};
    margin-bottom: 0px;
  `,container:(0,te.css)`
    overflow-y: auto;
    height: 100%;
  `,alertRuleList:(0,te.css)`
    display: flex;
    flex-wrap: wrap;
    justify-content: space-between;
    list-style-type: none;
  `,alertRuleItem:(0,te.css)`
    display: flex;
    align-items: center;
    width: 100%;
    height: 100%;
    background: ${Q.colors.background.secondary};
    padding: ${Q.spacing(.5)} ${Q.spacing(1)};
    border-radius: ${Q.shape.radius.default};
    margin-bottom: ${Q.spacing(.5)};

    gap: ${Q.spacing(2)};
  `,alertName:(0,te.css)`
    font-size: ${Q.typography.h6.fontSize};
    font-weight: ${Q.typography.fontWeightBold};

    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  `,alertNameWrapper:(0,te.css)`
    display: flex;
    flex: 1;
    flex-wrap: nowrap;
    flex-direction: column;

    min-width: 100px;
  `,alertLabels:(0,te.css)`
    > * {
      margin-right: ${Q.spacing(.5)};
    }
  `,alertDuration:(0,te.css)`
    font-size: ${Q.typography.bodySmall.fontSize};
  `,alertRuleItemText:(0,te.css)`
    font-weight: ${Q.typography.fontWeightBold};
    font-size: ${Q.typography.bodySmall.fontSize};
    margin: 0;
  `,alertRuleItemTime:(0,te.css)`
    color: ${Q.colors.text.secondary};
    font-weight: normal;
    white-space: nowrap;
  `,alertRuleItemInfo:(0,te.css)`
    font-weight: normal;
    flex-grow: 2;
    display: flex;
    align-items: flex-end;
  `,noAlertsMessage:(0,te.css)`
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    height: 100%;
  `,alertIcon:(0,te.css)`
    margin-right: ${Q.spacing(.5)};
  `,instanceDetails:(0,te.css)`
    min-width: 1px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  `,customGroupDetails:(0,te.css)`
    margin-bottom: ${Q.spacing(.5)};
  `,link:(0,te.css)`
    word-break: break-all;
    color: ${Q.colors.primary.text};
    display: flex;
    align-items: center;
    gap: ${Q.spacing(1)};
  `,hidden:(0,te.css)`
    display: none;
  `});function ct(Q){const[,fe]=(0,je.Ej)(je.RY.ViewAlertRule),[,be]=(0,je.Ej)(je.RY.ViewExternalAlertRule);return!fe&&!be?(0,T.jsx)(oe.F,{title:"Permission required",children:"Sorry, you do not have the required permissions to read alert rules"}):(0,T.jsx)(Nt,{...Q})}const Qe=new C.m(ct).setPanelOptions(Q=>{Q.addRadio({path:"viewMode",name:"View mode",description:"Toggle between list view and stat view",defaultValue:Ze.nE.List,settings:{options:[{label:"List",value:Ze.nE.List},{label:"Stat",value:Ze.nE.Stat}]},category:["Options"]}).addRadio({path:"groupMode",name:"Group mode",description:"How alert instances should be grouped",defaultValue:Ze.r6.Default,settings:{options:[{value:Ze.r6.Default,label:"Default grouping"},{value:Ze.r6.Custom,label:"Custom grouping"}]},category:["Options"]}).addCustomEditor({path:"groupBy",name:"Group by",description:"Filter alerts using label querying",id:"groupBy",defaultValue:[],showIf:fe=>fe.groupMode===Ze.r6.Custom,category:["Options"],editor:fe=>(0,T.jsx)(j,{id:fe.id??"groupBy",defaultValue:fe.value.map(be=>({label:be,value:be})),onChange:fe.onChange,dataSource:fe.context.options.datasource})}).addNumberInput({name:"Max items",path:"maxItems",description:"Maximum alerts to display",defaultValue:20,category:["Options"]}).addSelect({name:"Sort order",path:"sortOrder",description:"Sort order of alerts and alert instances",settings:{options:[{label:"Alphabetical (asc)",value:Ze.xB.AlphaAsc},{label:"Alphabetical (desc)",value:Ze.xB.AlphaDesc},{label:"Importance",value:Ze.xB.Importance},{label:"Time (asc)",value:Ze.xB.TimeAsc},{label:"Time (desc)",value:Ze.xB.TimeDesc}]},defaultValue:Ze.xB.AlphaAsc,category:["Options"]}).addBooleanSwitch({path:"dashboardAlerts",name:"Alerts linked to this dashboard",description:"Only show alerts linked to this dashboard",defaultValue:!1,category:["Options"]}).addTextInput({path:"alertName",name:"Alert name",description:"Filter for alerts containing this text",defaultValue:"",category:["Filter"]}).addTextInput({path:"alertInstanceLabelFilter",name:"Alert instance label",description:'Filter alert instances using label querying, ex: {severity="critical", instance=~"cluster-us-.+"}',defaultValue:"",category:["Filter"]}).addCustomEditor({path:"datasource",name:"Datasource",description:"Filter from alert source",id:"datasource",defaultValue:null,editor:function(be){return(0,T.jsxs)(S.B,{gap:1,children:[(0,T.jsx)(N.s,{...be,type:["prometheus","loki","grafana"],noDefault:!0,current:be.value,onChange:Be=>be.onChange(Be.name)}),(0,T.jsx)(A.$n,{variant:"secondary",onClick:()=>be.onChange(null),children:"Clear"})]})},category:["Filter"]}).addCustomEditor({showIf:fe=>fe.datasource===w.vv||!fe.datasource,path:"folder",name:"Folder",description:"Filter for alerts in the selected folder (only for Grafana alerts)",id:"folder",defaultValue:null,editor:function(be){return(0,T.jsx)(L.sR,{enableReset:!0,showRoot:!1,allowEmpty:!0,initialTitle:be.value?.title,initialFolderUid:be.value?.uid,permissionLevel:F.PermissionLevelString.View,onClear:()=>be.onChange(""),...be})},category:["Filter"]}).addBooleanSwitch({path:"stateFilter.firing",name:"Alerting / Firing",defaultValue:!0,category:["Alert state filter"]}).addBooleanSwitch({path:"stateFilter.pending",name:"Pending",defaultValue:!0,category:["Alert state filter"]}).addBooleanSwitch({path:"stateFilter.noData",name:"No Data",defaultValue:!1,category:["Alert state filter"]}).addBooleanSwitch({path:"stateFilter.normal",name:"Normal",defaultValue:!1,category:["Alert state filter"]}).addBooleanSwitch({path:"stateFilter.error",name:"Error",defaultValue:!0,category:["Alert state filter"]})});var pt=e(79924),Pt=e(64423),At=e(71733),mn=e(26272),Pn=e(69129),fn=e(47232),Rn=e(39601),Kn=e(17172),Bt=e(64149),an=e(3911),tn=e(85918),Cn=e(28138),xn=e(10860),Vn=e(44522),Et=e(56034);const Ft=({options:Q,annotation:fe,formatDate:be,onClick:Be,onAvatarClick:He,onTagClick:at})=>{const it=(0,ee.of)(qt),{showUser:Dt,showTags:Ot,showTime:wt}=Q,{text:_t="",login:Qt,email:rn,avatarUrl:kt,tags:pn,time:_n,timeEnd:An}=fe,$n=()=>{Be(fe)},Bn=()=>{He(fe)},un=Qt&&Dt,bn=_n&&wt,Us=An&&An!==_n&&wt;return(0,T.jsxs)(xn.Z,{className:it.card,onClick:$n,children:[(0,T.jsx)(xn.Z.Heading,{children:(0,T.jsx)(Vn.I,{className:it.heading,onClick:us=>{us.stopPropagation()},content:_t})}),bn&&(0,T.jsxs)(xn.Z.Description,{className:it.timestamp,children:[(0,T.jsx)(ln,{formatDate:be,time:_n}),Us&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)("span",{className:it.time,children:"-"}),(0,T.jsx)(ln,{formatDate:be,time:An})," "]})]}),un&&(0,T.jsx)(xn.Z.Meta,{className:it.meta,children:(0,T.jsx)(Gt,{email:rn,login:Qt,avatarUrl:kt,onClick:Bn})}),Ot&&pn&&(0,T.jsx)(xn.Z.Tags,{children:(0,T.jsx)(Bt.L,{tags:pn,onClick:us=>at(us,!1)})})]})},Gt=({onClick:Q,avatarUrl:fe,login:be,email:Be})=>{const He=(0,ee.of)(qt),at=Dt=>{Dt.stopPropagation(),Q()},it=(0,T.jsxs)("span",{children:["Created by:",(0,T.jsx)("br",{})," ",Be]});return(0,T.jsx)(Et.m,{content:it,theme:"info",placement:"top",children:(0,T.jsx)("button",{onClick:at,className:He.avatar,children:(0,T.jsx)("img",{src:fe,alt:"avatar icon"})})})},ln=({time:Q,formatDate:fe})=>{const be=(0,ee.of)(qt);return(0,T.jsx)("span",{className:be.time,children:(0,T.jsx)("span",{children:fe(Q)})})};function qt(Q){return{card:(0,te.css)({gridTemplateAreas:'"Heading Description Meta Tags"',gridTemplateColumns:"auto 1fr auto auto",padding:Q.spacing(1),margin:Q.spacing(.5),width:"inherit"}),heading:(0,te.css)({a:{zIndex:1,position:"relative",color:Q.colors.text.link,"&:hover":{textDecoration:"underline"}}}),meta:(0,te.css)({margin:0,position:"relative",justifyContent:"end"}),timestamp:(0,te.css)({margin:0,alignSelf:"center"}),time:(0,te.css)({marginLeft:Q.spacing(1),marginRight:Q.spacing(1),fontSize:Q.typography.bodySmall.fontSize,color:Q.colors.text.secondary}),avatar:(0,te.css)({border:"none",background:"inherit",margin:0,padding:Q.spacing(.5),img:{borderRadius:Q.shape.radius.circle,width:Q.spacing(2),height:Q.spacing(2)}})}}class cn extends K.PureComponent{constructor(fe){super(fe),this.style=En(I.$.theme2),this.subs=new Pt.yU,this.tagListRef=(0,K.createRef)(),this.onAnnoClick=async be=>{if(!be.time)return;const{options:Be}=this.props,at=(0,Ye.UA)().getCurrent(),it={from:this._timeOffset(be.time,Be.navigateBefore,!0),to:this._timeOffset(be.timeEnd??be.time,Be.navigateAfter,!1),viewPanel:Be.navigateToPanel&&be.panelId?be.panelId:void 0};if(!be.dashboardUID||at?.uid===be.dashboardUID){Rn.Ny.partial(it);return}const Dt=await(0,Kn.AI)().get("/api/search",{dashboardUIDs:be.dashboardUID});if(Dt&&Dt.length&&Dt[0].uid===be.dashboardUID){const Ot=Dt[0],wt=new URL(Ot.url,window.location.origin);wt.searchParams.set("from",String(it.from)),wt.searchParams.set("to",String(it.to)),Rn.Ny.push(At.I.stripBaseFromUrl(wt.toString()));return}Cn.A.emit(mn.r1.alertWarning,["Unknown Dashboard: "+be.dashboardUID])},this.onTagClick=(be,Be)=>{if(!Be&&this.state.queryTags.includes(be))return;const He=Be?this.state.queryTags.filter(it=>it!==be):[...this.state.queryTags,be];let at;if(Be){const it=document.activeElement,Dt=it?.getAttribute("data-tag-id");if(this.tagListRef.current?.contains(it)&&Dt){const Ot=Number.parseInt(Dt,10),wt=this.tagListRef.current.querySelector(`[data-tag-id="${Ot+1}"]`)??this.tagListRef.current.querySelector(`[data-tag-id="${Ot-1}"]`);wt instanceof HTMLElement&&(at=wt)}}this.setState({queryTags:He},()=>at?.focus())},this.onUserClick=be=>{this.setState({queryUser:{id:be.userId,login:be.login,email:be.email}})},this.onClearUser=()=>{this.setState({queryUser:void 0})},this.renderItem=(be,Be)=>{const{options:He}=this.props,at=(0,Ye.UA)().getCurrent();return at?(0,T.jsx)(Ft,{annotation:be,formatDate:at.formatDate,onClick:this.onAnnoClick,onAvatarClick:this.onUserClick,onTagClick:this.onTagClick,options:He}):(0,T.jsx)(T.Fragment,{})},this.state={annotations:[],timeInfo:"",loaded:!1,queryTags:[]}}componentDidMount(){this.doSearch(),this.subs.add(this.props.eventBus.getStream(Pn.We).subscribe({next:()=>{this.doSearch()}}))}componentWillUnmount(){this.subs.unsubscribe()}componentDidUpdate(fe,be){const{options:Be,timeRange:He}=this.props;(Be!==fe.options||this.state.queryTags!==be.queryTags||this.state.queryUser!==be.queryUser||fe.renderCounter!==this.props.renderCounter||Be.onlyInTimeRange&&He!==fe.timeRange)&&this.doSearch()}async doSearch(){const{options:fe}=this.props,{queryUser:be,queryTags:Be}=this.state,He={tags:fe.tags,limit:fe.limit,type:"annotation"};fe.onlyFromThisDashboard&&(He.dashboardUID=(0,Ye.UA)().getCurrent()?.uid);let at="";if(fe.onlyInTimeRange){const{timeRange:Dt}=this.props;He.from=Dt.from.valueOf(),He.to=Dt.to.valueOf()}else at="All Time";be&&(He.userId=be.id),fe.tags&&fe.tags.length&&(He.tags=fe.tags.map(Dt=>this.props.replaceVariables(Dt))),Be.length&&(He.tags=He.tags?[...He.tags,...Be]:Be);const it=await(0,Kn.AI)().get("/api/annotations",He,`anno-list-panel-${this.props.id}`);this.setState({annotations:it,timeInfo:at,loaded:!0})}_timeOffset(fe,be,Be=!1){let He=5,at="m";const it=/^(\d+)(\w)/.exec(be);it&&it.length===3&&(He=parseInt(it[1],10),at=it[2]);const Dt=(0,fn.KQ)(fe);return Be&&(He*=-1),Dt.add(He,at).valueOf()}render(){const{loaded:fe,annotations:be,queryUser:Be,queryTags:He}=this.state;if(!fe)return(0,T.jsx)("div",{children:"loading..."});const at=Be||He.length>0;return(0,T.jsxs)(se.E,{autoHeightMin:"100%",children:[at&&(0,T.jsxs)("div",{className:this.style.filter,children:[(0,T.jsx)("b",{children:"Filter:"}),Be&&(0,T.jsx)(A.$n,{size:"sm",variant:"secondary",fill:"text",onClick:this.onClearUser,"aria-label":`Remove filter: ${Be.email}`,children:Be.email}),He.length>0&&(0,T.jsx)(Bt.L,{icon:"times",tags:He,onClick:it=>this.onTagClick(it,!0),getAriaLabel:it=>`Remove ${it} tag`,className:this.style.tagList,ref:this.tagListRef})]}),be.length<1&&(0,T.jsx)("div",{className:this.style.noneFound,children:"No Annotations Found"}),(0,T.jsx)(tn.p,{items:be,renderItem:this.renderItem,getItemKey:it=>`${it.id}`})]})}}const En=(0,an.N)(Q=>({noneFound:(0,te.css)({display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"calc(100% - 30px)"}),filter:(0,te.css)({alignItems:"center",display:"flex",flexWrap:"wrap",gap:Q.spacing(.5),padding:Q.spacing(.5)}),tagList:(0,te.css)({justifyContent:"flex-start","li > button":{paddingLeft:"3px"}})})),Sn={limit:10,navigateAfter:"10m",navigateBefore:"10m",navigateToPanel:!0,onlyFromThisDashboard:!1,onlyInTimeRange:!1,showTags:!0,showTime:!0,showUser:!0,tags:[]},Tn=new C.m(cn).setPanelOptions(Q=>{Q.addRadio({category:["Annotation query"],path:"onlyFromThisDashboard",name:"Query filter",defaultValue:Sn.onlyFromThisDashboard,settings:{options:[{value:!1,label:"All dashboards"},{value:!0,label:"This dashboard"}]}}).addRadio({category:["Annotation query"],path:"onlyInTimeRange",name:"Time range",defaultValue:Sn.onlyInTimeRange,settings:{options:[{value:!1,label:"None"},{value:!0,label:"This dashboard"}]}}).addCustomEditor({category:["Annotation query"],id:"tags",path:"tags",name:"Tags",description:"Match annotation tags",editor(fe){return(0,T.jsx)(pt.u,{tags:fe.value,onChange:fe.onChange})}}).addNumberInput({category:["Annotation query"],path:"limit",name:"Limit",defaultValue:Sn.limit}).addBooleanSwitch({category:["Display"],path:"showUser",name:"Show user",defaultValue:Sn.showUser}).addBooleanSwitch({category:["Display"],path:"showTime",name:"Show time",defaultValue:Sn.showTime}).addBooleanSwitch({category:["Display"],path:"showTags",name:"Show tags",defaultValue:Sn.showTags}).addRadio({category:["Link behavior"],path:"navigateToPanel",name:"Link target",defaultValue:Sn.navigateToPanel,settings:{options:[{value:!0,label:"Panel"},{value:!1,label:"Dashboard"}]}}).addTextInput({category:["Link behavior"],path:"navigateBefore",name:"Time before",defaultValue:Sn.navigateBefore,description:""}).addTextInput({category:["Link behavior"],path:"navigateAfter",name:"Time after",defaultValue:Sn.navigateAfter,description:""})}).setPanelChangeHandler((Q,fe,be)=>fe==="ryantxu-annolist-panel"?be:Q.options);var Wn=e(37055),Nn=e(24293),Tt=e(27310),Wt=e(47070),jt=e(11261),ut=e(52622),Zt=e(52198),jn=e(38248),Xn=e(11404),Qn=e(89654),Fn=e(22680),qn=e(71242),js=e(24882),ys=e(97152),Ps=e(29413),es=e(30501),_s=e(67266),ca=e(81297),Ks=e(38761),Zs=e(22731),nr=e(8066),lr=e(96516),ga=e(16895),$a=e(28895);function Za(Q,fe){return fe[0].fields.slice(1).some(be=>!be.config.custom?.hideFrom?.legend)}const mr=(0,K.memo)(({data:Q,placement:fe,calcs:be,displayMode:Be,colorField:He,...at})=>{const it=(0,ee.$j)();if(He!=null){const Ot=(0,$a.jY)([He],it);if(Ot?.length)return(0,T.jsx)(_s.KU.Legend,{placement:fe,children:(0,T.jsx)(lr.t,{placement:fe,items:Ot,displayMode:Be})})}const Dt=Q[0].fields.slice(1).map((Ot,wt)=>{const Qt=wt+1;if(!Ot||Ot.config.custom?.hideFrom?.legend)return;const rn=Ot.state?.displayName??Ot.name,kt=(0,nr.lz)(Ot,it).color;return{disabled:Ot.state?.hideFrom?.viz,color:kt,label:rn,yAxis:Ot.config.custom?.axisPlacement===ut.vM.Right?2:1,getDisplayValues:()=>(0,ga.UO)(be,Ot,it),getItemKey:()=>`${rn}-0-${Qt}`}}).filter(Ot=>Ot!==void 0);return(0,T.jsx)(_s.KU.Legend,{placement:fe,...at,children:(0,T.jsx)(lr.t,{placement:fe,items:Dt,displayMode:Be,sortBy:at.sortBy,sortDesc:at.sortDesc,isSortable:!0})})});mr.displayName="BarChartLegend";var Va=e(36613),Ea=e(28240),cr=e(73060),sn=e(57875),Ln=e(83195),Jn=e(73134),gs=e(51336),kn=e(52811),Gn=e(82915),Gs=e(42994),$s=e(72724),Is=e(23596),pa=e(39758),Ta=e(4134);const ua=Gs.WC.interval,sr=pa.ur,ma=pa.ur,ar=8,Ya=30,xr=.65,Sr=.1,Yr=.15,Hr=5,Rr=10,lo=.1;function Bo(Q,fe,be,Be,He){const at=(0,Ps.kD)(Q,14),it=fe/(at.width+2)*14,Dt=be/Be,Ot=Math.min(Dt,it);return{fontSize:Math.min(Ot,He??Ot),textMetrics:at}}function po(Q,fe){const{xOri:be,xDir:Be,rawValue:He,getColor:at,formatValue:it,formatShortValue:Dt,fillOpacity:Ot=1,showValue:wt,xSpacing:_t=0,hoverMulti:Qt=!1,timeZone:rn="browser"}=Q,kt=be===ut.Lt.Horizontal,pn=!Q.text?.valueSize,_n=Q.stacking!==ut.gs.None,An=Q.stacking===ut.gs.Percent;let{groupWidth:$n,barWidth:Bn,barRadius:un=0}=Q;_n&&([$n,Bn]=[Bn,$n]);let bn;const us=Array(30).fill(null);let Ts;const zn=vs=>Array.from(vs.data[0].map((ds,Ls)=>Ls)),On=_t===0?void 0:(vs,ds)=>{const Ls=vs.bbox.width,ra=Be*(kt?1:-1);let qs=ds.length,la=qs-1,Pa=0,br=Ls/Va.A.pxRatio,ao=Math.abs(Math.floor(br/_t));Pa=qs<ao?0:Math.ceil(qs/ao);let ba=ds.map((Ka,ro)=>Pa!==0&&(_t>0?ro:la-ro)%Pa>0?null:Ka);return ra===1?ba:ba.reverse()},fs=(vs,ds,Ls,ra,qs)=>{if(Q.xTimeAuto){let la=ua.year;return qs<es.Zj.second?la=ua.millisecond:qs<es.Zj.minute?la=ua.second:qs<es.Zj.hour?la=ua.minute:qs<es.Zj.day?la=ua.hour:qs<es.Zj.month?la=ua.day:qs<es.Zj.year?la=ua.month:la=ua.year,ds.map(Pa=>Pa==null?"":(0,$s.LE)(Pa,{format:la,timeZone:rn}))}return ds.map(la=>kt?Dt(0,la):it(0,la))},Hn=(vs,ds,Ls)=>{ds=0,Ls=Math.max(1,vs.data[0].length-1);let ra=0;(0,pa.mn)(vs.data[0].length,$n,sr,0,(la,Pa,br)=>{ra=Pa+br/2});let qs=Ls-ds;if(ra===.5)ds-=qs;else{let Pa=(1/(1-ra*2)*qs-qs)/2;ds-=Pa,Ls+=Pa}return[ds,Ls]};let ps=(vs,ds)=>{let Ls=Array.from({length:ds},()=>({offs:Array(vs).fill(0),size:Array(vs).fill(0)}));return(0,pa.mn)(vs,$n,sr,null,(ra,qs,la)=>{(0,pa.mn)(ds,Bn,ma,null,(Pa,br,ao)=>{Ls[Pa].offs[ra]=qs+la*br,Ls[Pa].size[ra]=la*ao})}),Ls},ks=(vs,ds)=>{let Ls=Array.from({length:ds},()=>({offs:Array(vs).fill(0),size:Array(vs).fill(0)}));return(0,pa.mn)(vs,$n,sr,null,(ra,qs,la)=>{(0,pa.mn)(ds,Bn,ma,null,(Pa,br,ao)=>{Ls[Pa].offs[ra]=qs,Ls[Pa].size[ra]=la})}),Ls};const Xs=kt?Sr:Yr,ia=kt?Hr:Rr;let ja=[],Ys=[],xs=1,Os,ha=Q.text?.valueSize??Ya,Ha=ia,Ws=1/0,Rs=1/0,na=at!=null,ya=na?{fill:{unit:3,values:(vs,ds)=>Ys[ds].fill},stroke:{unit:3,values:(vs,ds)=>Ys[ds].stroke}}:{},da=Va.A.paths.bars({radius:An?0:_n?(vs,ds)=>ds===vs.data.length-1?[un,0]:[0,0]:un,disp:{x0:{unit:2,values:(vs,ds)=>ja[ds].offs},size:{unit:2,values:(vs,ds)=>ja[ds].size},...ya},each:(vs,ds,Ls,ra,qs,la,Pa)=>{ra-=vs.bbox.left,qs-=vs.bbox.top;let br=vs.data[ds][Ls];kt?(Ws=Math.min(Ws,br<0?vs.bbox.height-(qs+Pa):qs),Rs=la):(Ws=Pa,Rs=Math.min(Rs,br<0?ra:vs.bbox.width-(ra+la)));let ao={x:ra,y:qs,w:la,h:Pa,sidx:ds,didx:Ls};if(!_n&&Q.fullHighlight&&(Q.xOri===ut.Lt.Horizontal?(ao.y=0,ao.h=vs.bbox.height):(ao.x=0,ao.w=vs.bbox.width)),bn.add(ao),wt!==ut.yL.Never){const ba=He(ds,Ls);let Ka=1;An&&Ja[ds][Ls]&&(Ka=Ja[ds][Ls]);const ro=Ka===0?0:ba/Ka,go=it(ds,ro);if(Ha=Math.min(Ha,Math.round(Xs*(kt?la:Pa))),Os[Ls]===void 0&&(Os[Ls]={}),Os[Ls][ds]={text:go,value:He(ds,Ls),hidden:!1},pn){const{fontSize:Ki,textMetrics:bi}=Bo(Os[Ls][ds].text,Rs*(kt?xr:1)-(kt?0:Ha),Ws*(kt?1:xr)-(kt?Ha:0),1);Os[Ls][ds].textMetrics=bi;let oo=Math.round(Math.min(ha,Ya,Ki));xs=oo/ha*(oo/14),ha=oo}else Os[Ls][ds].textMetrics=(0,Ps.kD)(Os[Ls][ds].text,ha);let ti=kt?0:-Math.round(lo*ha),jo=He(ds,Ls);if(Q.negY?.[ds]&&jo!=null&&(jo*=-1),jo!=null){const Ki=vs.bbox.left+(kt?ra+la/2:jo<0?ra-Ha:ra+la+Ha);let bi=vs.bbox.top+(kt?jo<0?qs+Pa+Ha:qs-Ha:qs+Pa/2-ti);const{textMetrics:oo={width:1,actualBoundingBoxAscent:1,actualBoundingBoxDescent:1}}=Os[Ls][ds];let Ll=0,jl=0;kt?(Ll=oo.width*xs/2,jl=jo>0?(oo.actualBoundingBoxAscent+oo.actualBoundingBoxDescent)*xs:0):(jl=(oo.actualBoundingBoxAscent+oo.actualBoundingBoxDescent)*xs/2,Ll=jo<0?oo.width*xs:0),bi-jl<0&&(bi=jl),Os[Ls][ds].x=Ki,Os[Ls][ds].y=bi,Os[Ls][ds].bbox={x:Ki-Ll,y:bi-jl,w:oo.width*xs,h:(oo.actualBoundingBoxAscent+oo.actualBoundingBoxDescent)*xs}}}}});const Ba=vs=>{vs.root.querySelectorAll(".u-cursor-pt").forEach(ds=>{ds.style.borderRadius="0",Q.fullHighlight&&(ds.style.zIndex="-1")})},Fa={x:!1,y:!1,drag:{x:!1,y:!1},dataIdx:(vs,ds)=>{if(ds===0){us.fill(null),Ts=null;let Ls=vs.cursor.left*Va.A.pxRatio,ra=vs.cursor.top*Va.A.pxRatio;bn.get(Ls,ra,1,1,qs=>{(0,Ta.ur)(Ls,ra,qs.x,qs.y,qs.x+qs.w,qs.y+qs.h)&&(Ts=us[0]=qs,us[Ts.sidx]=Ts,Qt&&(0,Ta.Tr)(bn,void 0,Ts.didx).forEach(la=>{us[la.sidx]=la}))})}return us[ds]?.didx},points:{fill:"rgba(255,255,255,0.4)",bbox:(vs,ds)=>{let Ls=us[ds],ra=Ls!=null;return{left:ra?Ls.x/Va.A.pxRatio:-10,top:ra?Ls.y/Va.A.pxRatio:-10,width:ra?Ls.w/Va.A.pxRatio:0,height:ra?Ls.h/Va.A.pxRatio:0}}},focus:{prox:1e3,dist:(vs,ds)=>Ts?.sidx===ds?0:1/0}},fa=vs=>{if(bn=bn||new Ta.C$(0,0,vs.bbox.width,vs.bbox.height),bn.clear(),vs.series.forEach(ds=>{ds._paths=null}),_n?ja=[null,...ks(vs.data[0].length,vs.data.length-1)]:ja=[null,...ps(vs.data[0].length,vs.data.length-1)],na){Ys=[null];for(let ds=1;ds<vs.data.length;ds++){let Ls=vs.data[ds].map((ra,qs)=>ra!=null?at(ds,qs,ra):null);Ys.push({fill:Ot<1?Ls.map(ra=>ra!=null?(0,Is.X4)(ra,Ot):null):Ls,stroke:Ls})}}Os={},ha=Q.text?.valueSize??Ya,Ha=ia,Ws=Rs=1/0},Ga=vs=>{if(wt===ut.yL.Never||ha<ar)return;vs.ctx.save(),vs.ctx.fillStyle=fe.colors.text.primary,vs.ctx.font=`${ha}px ${fe.typography.fontFamily}`;let ds,Ls;for(const ra in Os){let qs=!0;for(const la in Os[ra]){const Pa=Os[ra][la],{text:br,x:ao=0,y:ba=0}=Pa;let{value:Ka}=Pa;Q.negY?.[la]&&Ka!=null&&(Ka*=-1);let ro=kt?"center":Ka!==null&&Ka<0?"right":"left",go=kt?Ka!==null&&Ka<0?"top":"alphabetic":"middle";if(ro!==ds&&(vs.ctx.textAlign=ds=ro),go!==Ls&&(vs.ctx.textBaseline=Ls=go),wt===ut.yL.Always)vs.ctx.fillText(br,ao,ba);else if(wt===ut.yL.Auto){let{bbox:ti}=Pa,jo=!1;if(ti==null)jo=!0,Pa.hidden=!0;else if(!qs)for(const Ki in Os[ra]){if(Ki===la)continue;const bi=Os[ra][Ki],{bbox:oo,hidden:Ll}=bi;if(!Ll&&oo&&(0,Ta.HY)(ti,oo)){jo=!0,Pa.hidden=!0;break}}qs=!1,!jo&&vs.ctx.fillText(br,ao,ba)}}}vs.ctx.restore()};let Ja=null;function pr(vs,ds){return Ja=null,(0,ga.bq)(vs[0],ds,({totals:Ls})=>{Ja=Ls})}return{cursor:Fa,xRange:Hn,xValues:fs,xSplits:zn,hFilter:On,barsBuilder:da,init:Ba,drawClear:fa,draw:Ga,prepData:pr}}const vr={barRadius:0,barWidth:.97,fullHighlight:!1,groupWidth:.7,orientation:ut.wV.Auto,showValue:ut.yL.Auto,stacking:ut.gs.None,xTickLabelRotation:0,xTickLabelSpacing:0},Ur={fillOpacity:80,gradientMode:ut.on.None,lineWidth:1};function Er(Q,fe,be,Be,He,at){if(Q.length===0||Q.every(wt=>wt.length===0))return{series:[],_rest:[],warn:"No data in response"};(0,Ea.Fm)(Q),(0,Ea.j2)(Q,fe);let it={...Q[0]};const Dt=it.fields.findIndex(wt=>wt.type===jt.PU.time);Dt>=0&&Q.length>1&&(it=(0,cr.Fd)({frames:Q,keepDisplayNames:!0})??it);const Ot=it.fields.find(wt=>wt.state?.displayName===He||wt.name===He)??it.fields.find(wt=>wt.type===jt.PU.string)??it.fields[Dt];if(Ot!=null){const wt=[Ot],_t=[],Qt=at==null?void 0:it.fields.find(pn=>pn.state?.displayName===at||pn.name===at);it.fields.forEach(pn=>{if(pn!==Ot)if(pn.type===jt.PU.number&&!pn.config.custom?.hideFrom?.viz){const _n={...pn,values:pn.values.map(An=>Number.isFinite(An)?An:null),config:{...pn.config,custom:{...pn.config.custom,stacking:{group:"_",mode:be}}}};wt.push(_n)}else _t.push(pn)});let rn=null;wt.length===1&&(rn="No numeric fields found"),it.fields=wt;const kt=[it];return(0,Gn.O2)(kt,Be,0),{series:kt,_rest:_t,color:Qt,warn:rn}}return{series:[],_rest:[],color:null,warn:"Bar charts requires a string or time field"}}const Qo=({series:Q,totalSeries:fe,color:be,orientation:Be,options:He,timeZone:at,theme:it})=>{let{showValue:Dt,groupWidth:Ot,barWidth:wt,barRadius:_t=0,stacking:Qt,text:rn,tooltip:kt,xTickLabelRotation:pn,xTickLabelMaxLength:_n,xTickLabelSpacing:An=0,legend:$n,fullHighlight:Bn}=He,un=Q[0];const bn=new gs.e,Us=un.fields.map((Ys,xs)=>Qt===ut.gs.Percent?(0,sn.J)({field:{...Ys,config:{...Ys.config,unit:"percentunit"}},theme:it}):Ys.display),us=(Ys,xs)=>(0,Ln.cN)(Us[Ys](xs)),Ts=(Ys,xs)=>Eo(us(Ys,xs),_n),zn=Ht(Be);un.fields.length===2&&Qt===ut.gs.None&&(fe===1&&(Ot=wt),wt=1);const On=(Ys,xs)=>un.fields[Ys].values[xs];let fs,Hn=1;if(be!=null){const Ys=be.display;Hn=(be.config.custom.fillOpacity??100)/100,fs=(xs,Os)=>Ys(be.values[Os]).color}else un.fields.some(xs=>xs.config.custom?.gradientMode===ut.on.Scheme&&xs.config.color?.mode===Jn.Yb.Thresholds||xs.config.mappings?.some(ha=>ha.type==="value"?Object.values(ha.options).some(Ha=>Ha.color!=null):ha.options.result.color!=null))&&(Hn=(un.fields.find(Os=>Os.type===jt.PU.number).config.custom.fillOpacity??100)/100,fs=(Os,ha)=>{let Ha=un.fields[Os];return Ha.display(Ha.values[ha]).color});const ps={xOri:zn.xOri,xDir:zn.xDir,groupWidth:Ot,barWidth:wt,barRadius:_t,stacking:Qt,rawValue:On,getColor:fs,fillOpacity:Hn,formatValue:us,formatShortValue:Ts,timeZone:at,text:rn,showValue:Dt,legend:$n,xSpacing:An,xTimeAuto:un.fields[0]?.type===jt.PU.time&&!un.fields[0].config.unit?.startsWith("time:"),negY:un.fields.map(Ys=>Ys.config.custom?.transform===ut.NU.NegativeY),fullHighlight:Bn,hoverMulti:kt.mode===ut.$N.Multi},ks=po(ps,it);if(bn.setCursor(ks.cursor),bn.addHook("init",ks.init),bn.addHook("drawClear",ks.drawClear),bn.addHook("draw",ks.draw),pn!==0){let Ys=50,xs=zn.xOri===ut.Lt.Horizontal?14:5;bn.setPadding(Lt(un,pn,_n,Ys,xs))}bn.setPrepData(ks.prepData),bn.addScale({scaleKey:"x",isTime:!1,range:ks.xRange,distribution:ut.L4.Ordinal,orientation:zn.xOri,direction:zn.xDir});const Xs=un.fields[0]?.config.custom?.axisPlacement!==ut.vM.Hidden?zn.xOri===ut.Lt.Horizontal?ut.vM.Bottom:ut.vM.Left:ut.vM.Hidden,ia=un.fields[0]?.config.custom?.axisPlacement!==ut.vM.Hidden;bn.addAxis({scaleKey:"x",isTime:!1,placement:Xs,label:un.fields[0]?.config.custom?.axisLabel,splits:ks.xSplits,filter:zn.xOri===0?ks.hFilter:void 0,values:ks.xValues,timeZone:at,grid:{show:!1},ticks:{show:!1},gap:15,tickLabelRotation:zn.xOri===0?pn*-1:0,theme:it,show:ia});for(let Ys=1;Ys<un.fields.length;Ys++){const xs=un.fields[Ys],Os={...Ur,...xs.config.custom},ha=xs.config.unit||kn.s,Ha=(0,nr.Qi)(xs),Rs=(0,nr.lz)(xs,it).color;let na=Os.axisSoftMin,ya=Os.axisSoftMax;if(na==null&&xs.config.min==null&&(na=0),ya==null&&xs.config.max==null&&(ya=0),Os.thresholdsStyle&&xs.config.thresholds&&(Os.thresholdsStyle.mode??ut.Ly.Off)!==ut.Ly.Off&&bn.addThresholds({config:Os.thresholdsStyle,thresholds:xs.config.thresholds,scaleKey:ha,theme:it,hardMin:xs.config.min,hardMax:xs.config.max,softMin:Os.axisSoftMin,softMax:Os.axisSoftMax}),bn.addSeries({scaleKey:ha,pxAlign:!0,lineWidth:Os.lineWidth,lineColor:Rs,fillOpacity:Os.fillOpacity,theme:it,colorMode:Ha,pathBuilder:ks.barsBuilder,show:!Os.hideFrom?.viz,gradientMode:Os.gradientMode,thresholds:xs.config.thresholds,hardMin:xs.config.min,hardMax:xs.config.max,softMin:Os.axisSoftMin,softMax:Os.axisSoftMax}),bn.addScale({scaleKey:ha,min:xs.config.min,max:xs.config.max,softMin:na,softMax:ya,centeredZero:Os.axisCenteredZero,orientation:zn.yOri,direction:zn.yDir,distribution:Os.scaleDistribution?.type,log:Os.scaleDistribution?.log}),Os.axisPlacement!==ut.vM.Hidden){let da=Os.axisPlacement;(!da||da===ut.vM.Auto)&&(da=ut.vM.Left),zn.xOri===1&&(da===ut.vM.Left&&(da=ut.vM.Bottom),da===ut.vM.Right&&(da=ut.vM.Top));let Ba={scaleKey:ha,label:Os.axisLabel,size:Os.axisWidth,placement:da,formatValue:(Fa,fa)=>(0,Ln.cN)(xs.display(Fa,fa)),filter:zn.yOri===0?ks.hFilter:void 0,tickLabelRotation:zn.xOri===1?pn*-1:0,theme:it,grid:{show:Os.axisGridShow}};Os.axisBorderShow&&(Ba.border={show:!0}),Os.axisColorMode===ut.Y$.Series&&(Ba.color=Rs),bn.addAxis(Ba)}}let ja=(0,ga.ro)(un);return bn.setStackingGroups(ja),{builder:bn,prepData:(Ys,xs)=>(Q=Ys,un=Q[0],be=xs,bn.prepData(Q))}};function Eo(Q,fe){return Q.length>fe?Q.substring(0,fe).concat("..."):Q}function Lt(Q,fe,be,Be=0,He=0){const at=Q.fields[0].values,it=es.pi,Dt=Q.fields[0].display,Ot=kt=>Dt?Dt(at[kt]):at[kt];let wt=0;for(let kt=0;kt<at.length;kt++){let pn=(0,Ps.kD)(Eo((0,Ln.cN)(Ot(kt)),be),it);wt=pn.width>wt?pn.width:wt}const _t=fe>0?Math.cos(fe*Math.PI/180)*(0,Ps.kD)(Eo((0,Ln.cN)(Ot(at.length-1)),be),it).width:0,Qt=fe<0?Math.cos(fe*-1*Math.PI/180)*(0,Ps.kD)(Eo((0,Ln.cN)(Ot(0)),be),it).width:0,rn=Math.sin((fe>=0?fe:fe*-1)*Math.PI/180)*wt-He;return[Math.round(es.pi*Va.A.pxRatio),_t,rn,Math.max(0,Qt-Be)]}function Ht(Q){return Q===ut.wV.Vertical?{xOri:ut.Lt.Horizontal,xDir:ut.ON.Right,yOri:ut.Lt.Vertical,yDir:ut.ON.Up}:{xOri:ut.Lt.Vertical,xDir:ut.ON.Down,yOri:ut.Lt.Horizontal,yDir:ut.ON.Right}}const on=(0,Ps.kD)("M",es.pi).width,vn=Math.PI/180,Un=Q=>{const{data:fe,options:be,fieldConfig:Be,width:He,height:at,timeZone:it,id:Dt}=Q,Ot=(0,ee.$j)(),{barWidth:wt,barRadius:_t=0,showValue:Qt,groupWidth:rn,stacking:kt,legend:pn,tooltip:_n,text:An,xTickLabelRotation:$n,xTickLabelSpacing:Bn,fullHighlight:un,xField:bn,colorByField:Us}=be;let{orientation:us,xTickLabelMaxLength:Ts=0}=be;us=us===Wt.wV.Auto?He<at?Wt.wV.Horizontal:Wt.wV.Vertical:us,Ts=$n===0?1/0:Ts||Math.floor(at/2/Math.sin(Math.abs($n*vn))/on-3);const zn=(0,K.useMemo)(()=>Er(fe.series,Be,kt,Ot,bn,Us),[fe.series,Be,kt,Ot,bn,Us]),On=(0,K.useMemo)(()=>zn.series.map(Ys=>({...Ys,fields:Ys.fields.filter((xs,Os)=>Os===0||!xs.state?.hideFrom?.viz)})),[zn.series]),fs=On[0]?.length??0,Hn=On[0]?.fields.length??0,ps=Math.max(0,(zn.series[0]?.fields.length??0)-1);let{builder:ks,prepData:Xs}=(0,K.useMemo)(()=>fs===0?{builder:null,prepData:null}:Qo({series:On,totalSeries:ps,color:zn.color,orientation:us,options:be,timeZone:it,theme:Ot}),[us,it,Q.data.structureRev,ps,Hn,fs,wt,_t,Qt,rn,kt,pn,_n,An?.valueSize,$n,Bn,un,bn,Us,Ts]);const ia=(0,K.useMemo)(()=>Xs==null?[]:Xs(On,zn.color),[Xs,On,zn.color]);if(zn.warn!=null||ks==null)return(0,T.jsx)(ys.a,{panelId:Dt,fieldConfig:Be,data:fe,message:zn.warn??"",needsNumberField:!0});const ja=pn.showLegend&&Za(ks,zn.series)?(0,T.jsx)(mr,{data:zn.series,colorField:zn.color,...pn}):null;return(0,T.jsx)(_s.KU,{width:Q.width,height:Q.height,legend:ja,children:(Ys,xs)=>(0,T.jsx)(ca.Z,{config:ks,data:ia,width:Ys,height:xs,children:Q.options.tooltip.mode!==ut.$N.None&&(0,T.jsx)(Ks.xl,{config:ks,maxWidth:be.tooltip.maxWidth,hoverMode:be.tooltip.mode===ut.$N.Single?Ks.b3.xOne:Ks.b3.xAll,render:(Os,ha,Ha,Ws,Rs,na)=>(0,T.jsx)(Zs.k,{series:On[0],_rest:zn._rest,dataIdxs:ha,seriesIdx:Ha,mode:be.tooltip.mode,sortOrder:be.tooltip.sort,isPinned:Ws,maxHeight:be.tooltip.maxHeight})})})})};var cs=e(66864),os=e(94354),Js=e(10880);const Ss=[{label:"None",value:0,description:"Show all tick marks"},{label:"Small",value:100,description:"Require 100px spacing"},{label:"Medium",value:200,description:"Require 200px spacing"},{label:"Large",value:300,description:"Require 300px spacing"}],Ra=Q=>{let fe=Q.value??0;const be=fe<0;be&&(fe*=-1);let Be=Ss[0];for(const it of Ss)if(Be=it,fe<=Be.value)break;const He=it=>{Q.onChange(it*(be?-1:1))},at=()=>{Q.onChange(Q.value*-1)};return(0,T.jsxs)(cs.Gy,{children:[(0,T.jsx)(os.z,{value:Be.value,options:Ss,onChange:He}),fe!==0&&(0,T.jsx)(Et.m,{content:"Require space from the right side",placement:"top",children:(0,T.jsx)("div",{children:(0,T.jsx)(Js.S,{value:be,onChange:at,label:"RTL"})})})]})},Oa=(Q,fe,be,Be)=>{if(fe==="graph"){const He=be.angular;if(He.xaxis?.mode==="series"){const at=Q.transformations||[];at.push({id:"reduce",options:{reducers:He.xaxis?.values??["sum"]}}),Q.transformations=at}}return{}};var ss=e(38824);class Ia{getListWithDefaults(fe){return fe.getListAppender({name:ss.m.BarChart,pluginId:"barchart",options:{showValue:ut.yL.Never,legend:{calcs:[],displayMode:ut.lm.List,showLegend:!0,placement:"right"}},fieldConfig:{defaults:{unit:"short",custom:{}},overrides:[]},cardOptions:{previewModifier:be=>{be.options.barWidth=.8}}})}getSuggestionsForData(fe){const be=this.getListWithDefaults(fe),{dataSummary:Be}=fe;Be.frameCount===1&&(!Be.hasNumberField||!Be.hasStringField||Be.rowCountTotal>50||(be.append({name:ss.m.BarChart}),Be.numberFieldCount>1&&(be.append({name:ss.m.BarChartStacked,options:{stacking:ut.gs.Normal}}),be.append({name:ss.m.BarChartStackedPercent,options:{stacking:ut.gs.Percent}})),be.append({name:ss.m.BarChartHorizontal,options:{orientation:Wt.wV.Horizontal}}),Be.numberFieldCount>1&&(be.append({name:ss.m.BarChartHorizontalStacked,options:{stacking:ut.gs.Normal,orientation:Wt.wV.Horizontal}}),be.append({name:ss.m.BarChartHorizontalStackedPercent,options:{orientation:Wt.wV.Horizontal,stacking:ut.gs.Percent}}))))}}const Cr=new C.m(Un).setPanelChangeHandler(Oa).useFieldConfig({standardOptions:{[Wn.uo.Color]:{settings:{byValueSupport:!0,preferThresholdsMode:!1},defaultValue:{mode:Nn.Y.PaletteClassic}}},useCustomConfig:Q=>{const fe=Ur;Q.addSliderInput({path:"lineWidth",name:"Line width",defaultValue:fe.lineWidth,settings:{min:0,max:10,step:1}}).addSliderInput({path:"fillOpacity",name:"Fill opacity",defaultValue:fe.fillOpacity,settings:{min:0,max:100,step:1}}).addRadio({path:"gradientMode",name:"Gradient mode",defaultValue:Zt.t.fillGradient[0].value,settings:{options:Zt.t.fillGradient}}),Q.addSelect({category:["Graph styles"],name:"Transform",path:"transform",settings:{options:[{label:"Constant",value:ut.NU.Constant,description:"The first value will be shown as a constant line"},{label:"Negative Y",value:ut.NU.NegativeY,description:"Flip the results to negative values on the y axis"}],isClearable:!0},hideFromDefaults:!0}),Q.addCustomEditor({id:"thresholdsStyle",path:"thresholdsStyle",name:"Show thresholds",category:["Thresholds"],defaultValue:{mode:ut.Ly.Off},settings:{options:Zt.t.thresholdsDisplayModes},editor:js.D,override:js.D,process:Tt.hS,shouldApply:()=>!0}),jn.r(Q,fe,!1),Xn.e(Q)}}).setPanelOptions(Q=>{Q.addFieldNamePicker({path:"xField",name:"X Axis",settings:{placeholderText:"First string or time field"}}).addRadio({path:"orientation",name:"Orientation",settings:{options:[{value:Wt.wV.Auto,label:"Auto"},{value:Wt.wV.Horizontal,label:"Horizontal"},{value:Wt.wV.Vertical,label:"Vertical"}]},defaultValue:vr.orientation}).addSliderInput({path:"xTickLabelRotation",name:"Rotate x-axis tick labels",defaultValue:vr.xTickLabelRotation,settings:{min:-90,max:90,step:15,marks:{"-90":"-90\xB0","-45":"-45\xB0",0:"0\xB0",45:"45\xB0",90:"90\xB0"},included:!1}}).addNumberInput({path:"xTickLabelMaxLength",name:"X-axis tick label max length",description:"X-axis labels will be truncated to the length provided",settings:{placeholder:"None",min:0},showIf:fe=>fe.xTickLabelRotation!==0}).addCustomEditor({id:"xTickLabelSpacing",path:"xTickLabelSpacing",name:"X-axis labels minimum spacing",defaultValue:vr.xTickLabelSpacing,editor:Ra}).addRadio({path:"showValue",name:"Show values",settings:{options:[{value:ut.yL.Auto,label:"Auto"},{value:ut.yL.Always,label:"Always"},{value:ut.yL.Never,label:"Never"}]},defaultValue:vr.showValue}).addRadio({path:"stacking",name:"Stacking",settings:{options:Zt.t.stacking},defaultValue:vr.stacking}).addSliderInput({path:"groupWidth",name:"Group width",defaultValue:vr.groupWidth,settings:{min:0,max:1,step:.01},showIf:(fe,be)=>fe.stacking&&fe.stacking!==ut.gs.None?!1:Dr(be)!==1}).addSliderInput({path:"barWidth",name:"Bar width",defaultValue:vr.barWidth,settings:{min:0,max:1,step:.01}}).addSliderInput({path:"barRadius",name:"Bar radius",defaultValue:vr.barRadius,settings:{min:0,max:.5,step:.05}}).addBooleanSwitch({path:"fullHighlight",name:"Highlight full area on hover",defaultValue:vr.fullHighlight,showIf:fe=>fe.stacking===ut.gs.None}),Q.addFieldNamePicker({path:"colorByField",name:"Color by field",description:"Use the color value for a sibling field to color each bar value."}),Qn.D(Q),Fn.H(Q),qn.I(Q,!1)}).setSuggestionsSupplier(new Ia);function Dr(Q){let fe=0;if(Q)for(const be of Q)for(const Be of be.fields)Be.type===jt.PU.number&&fe++;return fe}var dr=e(63250),ur=e(23799);const Oo=Q=>(0,dr._$)(Q);var Io=e(58384),za=e(17516);class Do{getSuggestionsForData(fe){const{dataSummary:be}=fe;if(!be.hasData||!be.hasNumberField)return;const Be=fe.getListAppender({name:"",pluginId:"bargauge",options:{},fieldConfig:{defaults:{custom:{}},overrides:[]}});be.numberFieldCount>50||(be.hasStringField&&be.frameCount===1&&be.rowCountTotal<30?(Be.append({name:ss.m.BarGaugeBasic,options:{reduceOptions:{values:!0,calcs:[]},displayMode:ut.eX.Basic,orientation:Wt.wV.Horizontal},fieldConfig:{defaults:{color:{mode:"continuous-GrYlRd"}},overrides:[]}}),Be.append({name:ss.m.BarGaugeLCD,options:{reduceOptions:{values:!0,calcs:[]},displayMode:ut.eX.Lcd,orientation:Wt.wV.Horizontal},fieldConfig:{defaults:{color:{mode:"continuous-GrYlRd"}},overrides:[]}})):(Be.append({name:ss.m.BarGaugeBasic,options:{displayMode:ut.eX.Basic,orientation:Wt.wV.Horizontal,reduceOptions:{values:!1,calcs:["lastNotNull"]}},fieldConfig:{defaults:{color:{mode:"continuous-GrYlRd"}},overrides:[]}}),Be.append({name:ss.m.BarGaugeLCD,options:{displayMode:ut.eX.Lcd,orientation:Wt.wV.Horizontal,reduceOptions:{values:!1,calcs:["lastNotNull"]}},fieldConfig:{defaults:{color:{mode:"continuous-GrYlRd"}},overrides:[]}})))}}const Ca=new C.m(Io.d).useFieldConfig().setPanelOptions(Q=>{(0,ur.L)(Q),(0,ur.h)(Q),qn.I(Q),Q.addRadio({path:"displayMode",name:"Display mode",settings:{options:[{value:ut.eX.Gradient,label:"Gradient"},{value:ut.eX.Lcd,label:"Retro LCD"},{value:ut.eX.Basic,label:"Basic"}]},defaultValue:za.K.displayMode}).addRadio({path:"valueMode",name:"Value display",settings:{options:[{value:ut.$l.Color,label:"Value color"},{value:ut.$l.Text,label:"Text color"},{value:ut.$l.Hidden,label:"Hidden"}]},defaultValue:za.K.valueMode}).addRadio({path:"namePlacement",name:"Name placement",settings:{options:[{value:ut.TZ.Auto,label:"Auto"},{value:ut.TZ.Top,label:"Top"},{value:ut.TZ.Left,label:"Left"}]},defaultValue:za.K.namePlacement,showIf:fe=>fe.orientation!==Wt.wV.Vertical}).addBooleanSwitch({path:"showUnfilled",name:"Show unfilled area",description:"When enabled renders the unfilled region as gray",defaultValue:za.K.showUnfilled,showIf:fe=>fe.displayMode!=="lcd"}).addRadio({path:"sizing",name:"Bar size",settings:{options:[{value:ut.T6.Auto,label:"Auto"},{value:ut.T6.Manual,label:"Manual"}]},defaultValue:za.K.sizing}).addSliderInput({path:"minVizWidth",name:"Min width",description:"Minimum column width (vertical orientation)",defaultValue:za.K.minVizWidth,settings:{min:0,max:300,step:1},showIf:fe=>fe.sizing===ut.T6.Manual&&(fe.orientation===Wt.wV.Auto||fe.orientation===Wt.wV.Vertical)}).addSliderInput({path:"minVizHeight",name:"Min height",description:"Minimum row height (horizontal orientation)",defaultValue:za.K.minVizHeight,settings:{min:0,max:300,step:1},showIf:fe=>fe.sizing===ut.T6.Manual&&(fe.orientation===Wt.wV.Auto||fe.orientation===Wt.wV.Horizontal)}).addSliderInput({path:"maxVizHeight",name:"Max height",description:"Maximum row height (horizontal orientation)",defaultValue:za.K.maxVizHeight,settings:{min:0,max:300,step:1},showIf:fe=>fe.sizing===ut.T6.Manual&&(fe.orientation===Wt.wV.Auto||fe.orientation===Wt.wV.Horizontal)})}).setPanelChangeHandler(dr.gl).setMigrationHandler(Oo).setSuggestionsSupplier(new Do);var Aa=e(41706),hr=e(79041),Ma=e(23117),ho=e(68268),Uo=e(24182),No=e(30249),Mi=e(74863),ri=e(55129);const wo=new Set(["bytes","bits","kbytes","mbytes","gbytes","tbytes","pbytes","binBps","binbps","KiBs","Kibits","MiBs","Mibits","GiBs","Gibits","TiBs","Tibits","PiBs","Pibits"]),oi=Array(53);for(let Q=0;Q<oi.length;Q++)oi[Q]=2**Q;const cl=(Q,fe=1)=>Q==null?"-":Q.toFixed(fe),Lr={drawStyle:ut.GR.Line,showPoints:ut.yL.Auto,axisPlacement:ut.vM.Auto},Vi=({frame:Q,theme:fe,timeZones:be,getTimeRange:Be,allFrames:He,renderers:at,tweakScale:it=_t=>_t,tweakAxis:Dt=_t=>_t,hoverProximity:Ot,orientation:wt=ut.wV.Horizontal})=>{const _t=wt!==ut.wV.Vertical,Qt=new gs.e(be[0]);let rn;Qt.setPrepData(zn=>(rn=zn[0],(0,ga.bq)(zn[0],Qt.getStackingGroups())));const kt=Q.fields[0];if(!kt)return Qt;const pn="x";let _n="";const An=kt.config.custom?.axisPlacement===ut.vM.Hidden?ut.vM.Hidden:_t?ut.vM.Bottom:ut.vM.Left,$n=kt.config.custom?.axisPlacement!==ut.vM.Hidden;if(kt.type===jt.PU.time){Qt.addScale({scaleKey:pn,orientation:_t?ut.Lt.Horizontal:ut.Lt.Vertical,direction:_t?ut.ON.Right:ut.ON.Up,isTime:!0,range:()=>{const On=Be();return[On.from.valueOf(),On.to.valueOf()]}});const zn=be.length>1?(On,fs)=>_t?fs.map((Hn,ps)=>ps<2?null:Hn):fs:void 0;for(let On=0;On<be.length;On++){const fs=be[On];Qt.addAxis({scaleKey:pn,isTime:!0,placement:An,show:$n,label:kt.config.custom?.axisLabel,timeZone:fs,theme:fe,grid:{show:On===0&&kt.config.custom?.axisGridShow},filter:zn})}be.length>1&&Qt.addHook("drawAxes",On=>{On.ctx.save();let fs=0;On.axes.forEach(Hn=>{if(_t&&Hn.side===2){On.ctx.fillStyle=fe.colors.text.primary,On.ctx.textAlign="left",On.ctx.textBaseline="bottom";let ps=Hn._pos+Hn._size;On.ctx.fillText(be[fs],On.bbox.left,ps*Va.A.pxRatio),fs++}}),On.ctx.restore()})}else Qt.addScale({scaleKey:pn,orientation:_t?ut.Lt.Horizontal:ut.Lt.Vertical,direction:_t?ut.ON.Right:ut.ON.Up,range:(zn,On,fs)=>[kt.config.min??On,kt.config.max??fs]}),Qt.addAxis({scaleKey:pn,placement:An,show:$n,label:kt.config.custom?.axisLabel,theme:fe,grid:{show:kt.config.custom?.axisGridShow},formatValue:(zn,On)=>(0,Ln.cN)(kt.display(zn,On))});let Bn=at?.flatMap(zn=>Object.values(zn.fieldMap).filter(On=>zn.indicesOnly.indexOf(On)===-1))??[],un;for(let zn=1;zn<Q.fields.length;zn++){const On=Q.fields[zn],fs={...On.config,custom:{...Lr,...On.config.custom}},Hn=fs.custom;if(On===kt||On.type!==jt.PU.number&&On.type!==jt.PU.enum)continue;let ps=On.display??cl;On.config.custom?.stacking?.mode===ut.gs.Percent&&(ps=(0,sn.J)({field:{...On,config:{...On.config,unit:"percentunit"}},theme:fe}));const ks=(0,ri.M)(fs,On.type),Xs=(0,nr.Qi)(On),ja=(0,nr.lz)(On,fe).color;if(Qt.addScale(it({scaleKey:ks,orientation:_t?ut.Lt.Vertical:ut.Lt.Horizontal,direction:_t?ut.ON.Up:ut.ON.Right,distribution:Hn.scaleDistribution?.type,log:Hn.scaleDistribution?.log,linearThreshold:Hn.scaleDistribution?.linearThreshold,min:On.config.min,max:On.config.max,softMin:Hn.axisSoftMin,softMax:Hn.axisSoftMax,centeredZero:Hn.axisCenteredZero,range:Hn.stacking?.mode===ut.gs.Percent?(Rs,na,ya)=>(na=na<0?-1:0,ya=ya>0?1:0,[na,ya]):On.type===jt.PU.enum?(Rs,na,ya)=>[-1,On.config.type.enum.text.length]:void 0,decimals:On.config.decimals},On)),_n||(_n=ks),Hn.axisPlacement!==ut.vM.Hidden){let Rs;Hn.axisColorMode===ut.Y$.Series&&(Xs.isByValue&&On.config.custom?.gradientMode===ut.on.Scheme&&Xs.id===Nn.Y.Thresholds?Rs=(0,Mi.pl)(1,fe,Xs,On.config.thresholds):Rs=ja);const na={border:{show:Hn.axisBorderShow||!1,width:1/devicePixelRatio,stroke:Rs||fe.colors.text.primary},ticks:{show:Hn.axisBorderShow||!1,stroke:Rs||fe.colors.text.primary},color:Rs||fe.colors.text.primary};let ya,da,Ba;if(wo.has(fs.unit))ya=oi;else if(On.type===jt.PU.enum){let Fa=On.config.type.enum.text;Ba=Fa.map((fa,Ga)=>Ga),da=Fa}Qt.addAxis(Dt({scaleKey:ks,label:Hn.axisLabel,size:Hn.axisWidth,placement:_t?Hn.axisPlacement??ut.vM.Auto:ut.vM.Bottom,formatValue:(Fa,fa)=>(0,Ln.cN)(ps(Fa,fa)),theme:fe,grid:{show:Hn.axisGridShow},decimals:On.config.decimals,distr:Hn.scaleDistribution?.type,splits:Ba,values:da,incrs:ya,...na},On))}const Ys=Hn.drawStyle===ut.GR.Points?ut.yL.Always:Hn.showPoints;let xs=()=>null;Hn.spanNulls!==!0&&(xs=(Rs,na,ya,da)=>{let Ba=[],Fa=Rs.series[na];if(!ya&&da&&da.length){const[fa,Ga]=Fa.idxs,Ja=Rs.data[0],pr=Rs.data[na],vs=Math.round(Rs.valToPos(Ja[fa],"x",!0)),ds=Math.round(Rs.valToPos(Ja[Ga],"x",!0));da[0][0]===vs&&Ba.push(fa);for(let Ls=0;Ls<da.length;Ls++){let ra=da[Ls],qs=da[Ls+1];if(qs&&ra[1]===qs[0]){let la=Rs.posToIdx(ra[1],!0);if(pr[la]==null)for(let Pa=1;Pa<100;Pa++){if(pr[la+Pa]!=null){la+=Pa;break}if(pr[la-Pa]!=null){la-=Pa;break}}Ba.push(la)}}da[da.length-1][1]===ds&&Ba.push(Ga)}return Ba.length?Ba:null});let{fillOpacity:Os}=Hn,ha=null,Ha=null;if(On.state?.origin){un||(un=Si(Q,He));const Rs=He[On.state.origin.frameIndex],na=Rs?.fields[On.state.origin.fieldIndex],ya=(0,Ea.Ct)(na??On,Rs,He);if(Bn.indexOf(ya)>=0)ha=()=>null,Ha=()=>{};else if(Hn.transform===ut.NU.Constant){const da=Va.A.paths.linear();ha=(Ba,Fa)=>{const fa=Ba._data,Ga=Be();let Ja=[Ga.from.valueOf(),Ga.to.valueOf()],pr=fa[Fa].find(Ls=>Ls!=null),vs=[pr,pr],ds=fa.slice();return ds[0]=Ja,ds[Fa]=vs,da({...Ba,_data:ds},Fa,0,1)}}if(Hn.fillBelowTo){const da=Q.fields.find(Ga=>Hn.fillBelowTo===Ga.name||Hn.fillBelowTo===Ga.config?.displayNameFromDS||Hn.fillBelowTo===(0,Ea.Ct)(Ga,Q,He)),Ba=da?(0,Ea.Ct)(da,Q,He):Hn.fillBelowTo,Fa=un.get(ya),fa=un.get(Ba);(0,B.isNumber)(fa)&&(0,B.isNumber)(Fa)?(Qt.addBand({series:[Fa,fa],fill:void 0}),Os||(Os=35)):Os=0}}let Ws;Xs.id===Nn.Y.Thresholds&&(Ws=Rs=>(0,nr.lz)(rn.fields[Rs],fe).color),Qt.addSeries({pathBuilder:ha,pointsBuilder:Ha,scaleKey:ks,showPoints:Ys,pointsFilter:xs,colorMode:Xs,fillOpacity:Os,theme:fe,dynamicSeriesColor:Ws,drawStyle:Hn.drawStyle,lineColor:Hn.lineColor??ja,lineWidth:Hn.lineWidth,lineInterpolation:Hn.lineInterpolation,lineStyle:Hn.lineStyle,barAlignment:Hn.barAlignment,barWidthFactor:Hn.barWidthFactor,barMaxWidth:Hn.barMaxWidth,pointSize:Hn.pointSize,spanNulls:Hn.spanNulls||!1,show:!Hn.hideFrom?.viz,gradientMode:Hn.gradientMode,thresholds:fs.thresholds,hardMin:On.config.min,hardMax:On.config.max,softMin:Hn.axisSoftMin,softMax:Hn.axisSoftMax,dataFrameFieldIndex:On.state?.origin}),Hn.thresholdsStyle&&fs.thresholds&&(Hn.thresholdsStyle.mode??ut.Ly.Off)!==ut.Ly.Off&&Qt.addThresholds({config:Hn.thresholdsStyle,thresholds:fs.thresholds,scaleKey:ks,theme:fe,hardMin:On.config.min,hardMax:On.config.max,softMin:Hn.axisSoftMin,softMax:Hn.axisSoftMax})}let bn=(0,ga.ro)(Q);Qt.setStackingGroups(bn),at?.forEach(zn=>{un||(un=Si(Q,He));let On={};for(let fs in zn.fieldMap){let Hn=zn.fieldMap[fs];On[fs]=un.get(Hn)}zn.init(Qt,On)});const Us=15;let Ts={hover:{prox:(zn,On,fs)=>Ot??(zn.data[On][fs]===null?Us:null),skip:[null]},focus:{prox:Ot??30}};return Qt.setCursor(Ts),Qt};function Si(Q,fe){const be=new Map;return Q.fields.forEach((Be,He)=>{const at=Be.state?.origin;if(at){const it=fe[at.frameIndex]?.fields[at.fieldIndex];it&&be.set((0,Ea.Ct)(it,fe[at.frameIndex],fe),He)}}),be}const Tr=["legend","options","theme"];class ii extends K.Component{constructor(){super(...arguments),this.prepConfig=(fe,be,Be)=>{const{theme:He,timeZone:at,options:it,renderers:Dt,tweakAxis:Ot,tweakScale:wt}=this.props;return Vi({frame:fe,theme:He,timeZones:Array.isArray(at)?at:[at],getTimeRange:Be,allFrames:be,renderers:Dt,tweakScale:wt,tweakAxis:Ot,hoverProximity:it?.tooltip?.hoverProximity,orientation:it?.orientation})},this.renderLegend=fe=>{const{legend:be,frames:Be}=this.props;return!fe||be&&!be.showLegend||!(0,Uo.t)(fe,Be)?null:(0,T.jsx)(Uo.$,{data:Be,config:fe,...be})}}render(){return(0,T.jsx)(No.o,{...this.props,prepConfig:this.prepConfig,propsToDiff:Tr,renderLegend:this.renderLegend})}}const Yo=(0,ee.cV)(ii);Yo.displayName="TimeSeries";var kr=e(62567),_i=e(78226),zi=e(34743),Po=e(36376),fo=e(7315),rr=e(13544),li=e(17464),dl=e(74007),Hi=e(25469);function ul(Q){const fe={position:"relative",top:"auto",right:"auto",marginRight:0};return(0,T.jsx)("div",{style:{width:"100%",display:"flex",justifyContent:"flex-end",paddingBottom:"6px"},children:(0,T.jsx)(Hi.J,{onClick:Q.onClick,style:Q.style??fe})})}const ki=({timeZone:Q,dataFrame:fe,dataFrameFieldIndex:be,config:Be,exemplarColor:He,clickedExemplarFieldIndex:at,setClickedExemplarFieldIndex:it})=>{const Dt=(0,ee.of)(hl),[Ot,wt]=(0,K.useState)(!1),[_t,Qt]=(0,K.useState)(!1),rn=[(0,zi.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,zi.BN)()],{context:kt,refs:pn,floatingStyles:_n}=(0,Po.we)({open:Ot,placement:"bottom",onOpenChange:wt,middleware:rn,whileElementsMounted:fo.ll,strategy:"fixed"}),An=(0,Po.s9)(kt),$n=(0,Po.Mk)(kt,{handleClose:(0,Po.iB)(),enabled:at===void 0}),{getReferenceProps:Bn,getFloatingProps:un}=(0,Po.bv)([An,$n]);(0,K.useEffect)(()=>{at?.fieldIndex===be.fieldIndex&&at?.frameIndex===be.frameIndex||Qt(!1)},[at,be]);const bn=()=>{const On=[(0,T.jsx)("rect",{fill:He,x:"3.38672",width:"4.78985",height:"4.78985",transform:"rotate(45 3.38672 0)"},"diamond"),(0,T.jsx)("path",{fill:He,d:"M1.94444 3.49988L0 5.44432L1.55552 6.99984L3.49996 5.05539L5.4444 6.99983L6.99992 5.44431L5.05548 3.49988L6.99983 1.55552L5.44431 0L3.49996 1.94436L1.5556 0L8.42584e-05 1.55552L1.94444 3.49988Z"},"x"),(0,T.jsx)("path",{fill:He,d:"M4 0L7.4641 6H0.535898L4 0Z"},"triangle"),(0,T.jsx)("rect",{fill:He,width:"5",height:"5"},"rectangle"),(0,T.jsx)("path",{fill:He,d:"M3 0.5L5.85317 2.57295L4.76336 5.92705H1.23664L0.146831 2.57295L3 0.5Z"},"pentagon"),(0,T.jsx)("path",{fill:He,d:"m2.35672,4.2425l0,2.357l1.88558,0l0,-2.357l2.3572,0l0,-1.88558l-2.3572,0l0,-2.35692l-1.88558,0l0,2.35692l-2.35672,0l0,1.88558l2.35672,0z"},"plus")];return On[be.frameIndex%On.length]},Us=()=>{Qt(!0)},us=(0,K.useCallback)(()=>{const On=fe.fields.filter(ia=>ia.config.links?.length&&ia.config.links?.length>0)||[],fs=[...On,...fe.fields.filter(ia=>!On.includes(ia))],Hn=()=>{Qt(!1),wt(!1),it(void 0)};let ps=[],ks=[];fs.map((ia,ja)=>{const Ys=ia.values[be.fieldIndex];ia.config.links?.length&&ks?.push(...ia.getLinks?.({valueRowIndex:be.fieldIndex})||[]);const xs=ia.display?ia.display(Ys):{text:`${Ys}`,numeric:+Ys};ps.push({name:ia.name,value:Ys,valueString:(0,Ln.cN)(xs),highlight:!1})});const Xs={position:"relative",top:"35px",right:"5px",marginRight:0};return(0,T.jsxs)("div",{className:Dt.tooltip,ref:pn.setFloating,style:_n,...un(),children:[_t&&(0,T.jsx)(ul,{onClick:Hn,style:Xs}),(0,T.jsx)(dl.i,{displayValues:ps,links:ks})]})},[fe.fields,be,Dt,_t,it,_n,un,pn.setFloating]),Ts=Be.getSeries().find(On=>On.props.dataFrameFieldIndex?.frameIndex===be.frameIndex)?.props.lineColor,zn=()=>{it(be),Us()};return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)("div",{ref:pn.setReference,className:Dt.markerWrapper,"data-testid":rr.Tp.components.DataSource.Prometheus.exemplarMarker,role:"button",tabIndex:0,...Bn(),onClick:zn,onKeyDown:On=>{On.key==="Enter"&&zn()},children:(0,T.jsx)("svg",{viewBox:"0 0 7 7",width:"7",height:"7",style:{fill:Ts},className:(0,te.cx)(Dt.marble,(Ot||_t)&&Dt.activeMarble),children:bn()})}),(Ot||_t)&&(0,T.jsx)(li.ZL,{children:us()})]})},hl=Q=>{const fe=Q.isDark?Q.v1.palette.dark2:Q.v1.palette.white,be=Q.isDark?Q.v1.palette.dark9:Q.v1.palette.gray5,Be=Q.isDark?Q.v1.palette.black:Q.v1.palette.white,He=Q.isDark?Q.v1.palette.dark3:Q.v1.palette.gray6;return{markerWrapper:(0,te.css)({padding:"0 4px 4px 4px",width:"8px",height:"8px",boxSizing:"content-box",transform:"translate3d(-50%, 0, 0)","&:hover":{"> svg":{transform:"scale(1.3)",opacity:1,filter:"drop-shadow(0 0 8px rgba(0, 0, 0, 0.5))"}}}),marker:(0,te.css)({width:0,height:0,borderLeft:"4px solid transparent",borderRight:"4px solid transparent",borderBottom:`4px solid ${Q.v1.palette.red}`,pointerEvents:"none"}),wrapper:(0,te.css)({background:fe,border:`1px solid ${be}`,borderRadius:Q.shape.borderRadius(2),boxShadow:`0 0 20px ${Be}`,padding:Q.spacing(1)}),exemplarsTable:(0,te.css)({width:"100%","tr td":{padding:"5px 10px",whiteSpace:"nowrap",borderBottom:`4px solid ${Q.components.panel.background}`},tr:{backgroundColor:Q.colors.background.primary,"&:nth-child(even)":{backgroundColor:He}}}),valueWrapper:(0,te.css)({display:"flex",flexDirection:"row",flexWrap:"wrap",columnGap:Q.spacing(1),"> span":{flexGrow:0},"> *":{flex:"1 1",alignSelf:"center"}}),tooltip:(0,te.css)({background:"none",padding:0,overflowY:"auto",maxHeight:"95vh"}),header:(0,te.css)({background:be,padding:"6px 10px",display:"flex"}),title:(0,te.css)({fontWeight:Q.typography.fontWeightMedium,paddingRight:Q.spacing(2),overflow:"hidden",display:"inline-block",whiteSpace:"nowrap",textOverflow:"ellipsis",flexGrow:1}),body:(0,te.css)({fontWeight:Q.typography.fontWeightMedium,borderRadius:Q.shape.borderRadius(2),overflow:"hidden"}),marble:(0,te.css)({display:"block",opacity:.5,[Q.transitions.handleMotion("no-preference")]:{transition:"transform 0.15s ease-out"}}),activeMarble:(0,te.css)({transform:"scale(1.3)",opacity:1,filter:"drop-shadow(0 0 8px rgba(0, 0, 0, 0.5))"})}},Gi=({exemplars:Q,timeZone:fe,config:be,visibleSeries:Be})=>{const He=(0,K.useRef)(),[at,it]=(0,K.useState)();(0,K.useLayoutEffect)(()=>{be.addHook("init",wt=>{He.current=wt})},[be]);const Dt=(0,K.useCallback)((wt,_t)=>{const Qt=wt.fields.find($n=>$n.name===jt.LE),rn=wt.fields.find($n=>$n.name===jt.Bc);if(!Qt||!rn||!He.current)return;const kt=Object.keys(He.current.scales).find($n=>!["x","y"].some(Bn=>Bn===$n))??kn.s,pn=He.current.scales[kt].min,_n=He.current.scales[kt].max;let An=rn.values[_t.fieldIndex];return pn!=null&&An<pn&&(An=pn),_n!=null&&An>_n&&(An=_n),{x:He.current.valToPos(Qt.values[_t.fieldIndex],"x"),y:He.current.valToPos(An,kt)}},[]),Ot=(0,K.useCallback)((wt,_t)=>{const Qt=Be!==void 0?Yi(Be,wt,_t):!0,rn=Be!==void 0?Qi(wt,_t,Be):void 0;return Qt?(0,T.jsx)(ki,{setClickedExemplarFieldIndex:it,clickedExemplarFieldIndex:at,timeZone:fe,dataFrame:wt,dataFrameFieldIndex:_t,config:be,exemplarColor:rn}):(0,T.jsx)(T.Fragment,{})},[be,fe,Be,it,at]);return(0,T.jsx)(_i.a,{config:be,id:"exemplars",events:Q,renderEventMarker:Ot,mapEventToXYCoords:Dt})},fl=(Q,fe)=>{const be=Q.series.filter(He=>He.props.show),Be=[];return fe?.length&&be.forEach(He=>{const at=He.props?.dataFrameFieldIndex?.frameIndex,it=He.props?.dataFrameFieldIndex?.fieldIndex;if(at!==void 0&&it!==void 0){const Dt=fe[at]?.fields[it];Dt?.labels&&Be.push({labels:Dt.labels,color:He.props?.lineColor??""})}}),{labels:Be,totalSeriesCount:Q.series.length}},Qi=(Q,fe,be)=>{let Be;return be.labels.some(He=>{const at=Object.keys(He.labels),it=Q.fields.filter(Dt=>at.find(Ot=>Ot===Dt.name));return it.length&&it.every((Ot,wt,_t)=>{const Qt=Ot.values[fe.fieldIndex];return He.labels[Ot.name]===Qt})?(Be=He.color,!0):!1}),Be},Yi=(Q,fe,be)=>{let Be=!1;return Q.labels.length===Q.totalSeriesCount?Be=!0:Q.labels.some(He=>{const at=Object.keys(He.labels);if(Object.keys(He.labels).length===0)Be=!0;else{const it=fe.fields.filter(Dt=>at.find(Ot=>Ot===Dt.name));it.length&&(Be=Q.labels.some(Dt=>Object.keys(Dt.labels).every(Ot=>{const wt=Dt.labels[Ot];return it.find(_t=>_t.values[be.fieldIndex]===wt)})))}return Be}),Be};var Wo=e(7874),Fo=e(55794),bo=e.n(Fo);const ci=({step:Q,y:fe,dragBounds:be,mapPositionToValue:Be,formatValue:He,onChange:at})=>{const it=(0,ee.$j)();let Dt=fe,Ot="none";fe<(be.top??0)&&(Ot="top"),fe>(be.bottom??0)+22&&(Ot="bottom"),Ot==="bottom"&&(Dt=be.bottom??fe),Ot==="top"&&(Dt=be.top??fe);const wt=typeof at!="function",_t=(0,ee.of)(Ko,Q,Ot,wt),[Qt,rn]=(0,K.useState)(Q.value),kt=(0,K.useMemo)(()=>it.colors.getContrastText(it.visualization.getColorByName(Q.color)),[Q.color,it]);return(0,T.jsx)(bo(),{axis:"y",grid:[1,1],disabled:wt,onStop:wt?B.noop:(pn,_n)=>(at(Be(_n.lastY)),!1),onDrag:(pn,_n)=>rn(Be(_n.lastY)),position:{x:0,y:Dt},bounds:be,children:(0,T.jsx)("div",{className:_t.handle,style:{color:kt},children:(0,T.jsx)("span",{className:_t.handleText,children:He(Qt)})})})};ci.displayName="ThresholdDragHandle";const Ko=(Q,fe,be,Be)=>{const He=Q.visualization.getColorByName(fe.color),at=Oi(be),it=be!=="none";return{handle:(0,te.css)`
      display: flex;
      align-items: center;
      position: absolute;
      left: 0;
      width: calc(100% - 9px);
      height: 18px;
      margin-top: -9px;
      border-color: ${He};
      cursor: ${Be?"initial":"grab"};
      border-top-right-radius: ${Q.shape.radius.default};
      border-bottom-right-radius: ${Q.shape.radius.default};
      ${it&&(0,te.css)`
        margin-top: 0;
        border-radius: ${Q.shape.radius.default};
      `}
      background: ${He};
      font-size: ${Q.typography.bodySmall.fontSize};
      &:before {
        ${at};
      }
    `,handleText:(0,te.css)`
      text-align: center;
      width: 100%;
      display: block;
      text-overflow: ellipsis;
      white-space: nowrap;
      overflow: hidden;
    `}};function Oi(Q){const fe=Q==="none",be=Be=>(0,te.css)`
    content: '';
    position: absolute;

    bottom: 0;
    top: 0;
    width: 0;
    height: 0;
    left: 0;

    border-right-style: solid;
    border-right-width: ${Be}px;
    border-right-color: inherit;
    border-top: ${Be}px solid transparent;
    border-bottom: ${Be}px solid transparent;
  `;return fe?(0,te.css)`
      ${be(9)};
      left: -9px;
    `:Q==="top"?(0,te.css)`
      ${be(5)};
      left: calc(50% - 2.5px);
      top: -7px;
      transform: rotate(90deg);
    `:Q==="bottom"?(0,te.css)`
      ${be(5)};
      left: calc(50% - 2.5px);
      top: calc(100% - 2.5px);
      transform: rotate(-90deg);
    `:""}const mo=60,Ii=({config:Q,fieldConfig:fe,onThresholdsChange:be})=>{const Be=(0,K.useRef)(),[He,at]=(0,K.useState)(0);(0,K.useLayoutEffect)(()=>{Q.setPadding([0,mo,0,0]),Q.addHook("init",Dt=>{Be.current=Dt}),Q.addHook("draw",()=>{at(Dt=>Dt+1)})},[Q]);const it=(0,K.useMemo)(()=>{const Dt=Be.current;if(!Dt)return null;const Ot=fe.defaults.thresholds;if(!Ot)return null;const wt=(0,ri.M)(fe.defaults,jt.PU.number),_t=fe.defaults.decimals,Qt=[];for(let rn=0;rn<Ot.steps.length;rn++){const kt=Ot.steps[rn],pn=Dt.valToPos(kt.value,wt);if(Number.isNaN(pn)||!Number.isFinite(pn))continue;const _n=Dt.bbox.height/window.devicePixelRatio,$n=typeof be=="function"?un=>{const bn=[...Ot.steps.slice(0,rn),...Ot.steps.slice(rn+1),{...Ot.steps[rn],value:un}].sort((Us,us)=>Us.value-us.value);be({...Ot,steps:bn})}:void 0,Bn=(0,T.jsx)(ci,{step:kt,y:pn,dragBounds:{top:0,bottom:_n},mapPositionToValue:un=>Dt.posToVal(un,wt),formatValue:un=>(0,Ln.j_)(wt)(un,_t).text,onChange:$n},`${kt.value}-${rn}`);Qt.push(Bn)}return Qt},[He,fe,be]);return Be.current?(0,T.jsx)("div",{style:{position:"absolute",overflow:"visible",left:`${(Be.current.bbox.left+Be.current.bbox.width)/window.devicePixelRatio}px`,top:`${Be.current.bbox.top/window.devicePixelRatio}px`,width:`${mo}px`,height:`${Be.current.bbox.height/window.devicePixelRatio}px`},children:it}):null};Ii.displayName="ThresholdControlsPlugin";var Co=e(63577),jr=(Q=>(Q.Candles="candles",Q.CandlesVolume="candles+volume",Q.Volume="volume",Q))(jr||{}),di=(Q=>(Q.Candles="candles",Q.OHLCBars="ohlcbars",Q))(di||{}),vo=(Q=>(Q.CloseClose="close-close",Q.OpenClose="open-close",Q))(vo||{});const ui={down:"red",flat:"gray",up:"green"},yo={...{candleStyle:"candles",colorStrategy:"open-close",colors:{down:"red",up:"green",flat:"gray"},fields:{},includeAllFields:!1,mode:"candles+volume"},legend:{displayMode:ut.lm.List,showLegend:!0,placement:"bottom",calcs:[]},tooltip:{mode:ut.$N.Multi,sort:ut.xB.None}},Jr={open:{key:"open",name:"Open",defaults:["open","o"],description:"Value at the start of the period"},high:{key:"high",name:"High",defaults:["high","h","max"],description:"Maximum value within the period"},low:{key:"low",name:"Low",defaults:["low","l","min"],description:"Minimum value within the period"},close:{key:"close",name:"Close",defaults:["close","c"],description:"Value at the end of the period"},volume:{key:"volume",name:"Volume",defaults:["volume","v"],description:"Sample count within the period"}};function Ji(Q,fe,be){const Be=(0,Co.findField)(Q,be[fe.key]);if(!Be)for(const He of Q.fields){const at=(0,Ea.Ct)(He,Q).toLowerCase();if(fe.defaults.includes(at)||fe.defaults.includes(He.name))return He}return Be}function $o(Q,fe,be,Be){if(!Q?.length)return null;const He=fe.fields??{},at=Q.length===1?(0,cr.Yj)(Q[0],Q[0].fields.findIndex(kt=>kt.type===jt.PU.time)):(0,cr.Fd)({frames:Q});if(!at?.length)return null;const it={aligned:at,frame:at,names:{}},Dt=(0,Gn.B_)([at],be,Be);if(!Dt)return null;const Ot=it.frame=Dt[0],wt=Ot.fields.findIndex(kt=>kt.type===jt.PU.time);if(wt<0)return null;const _t=new Set;for(const kt of Object.values(Jr)){const pn=Ji(Ot,kt,He);pn&&(it[kt.key]=pn,_t.add(pn))}if(!it.open&&!it.close&&(it.open=Ot.fields.find(kt=>kt.type===jt.PU.number),it.open&&_t.add(it.open)),it.open&&!it.close&&!He.close){const kt=it.open.values.slice(1);kt.push(kt[kt.length-1]),it.close={...it.open,values:kt,name:"Next open",state:void 0},_t.add(it.close),Ot.fields.push(it.close),it.autoOpenClose=!0}if(it.close&&!it.open&&!He.open){const kt=it.close.values.slice();kt.unshift(kt[0]),kt.length=Ot.length,it.open={...it.close,values:kt,name:"Previous close",state:void 0},_t.add(it.open),Ot.fields.push(it.open),it.autoOpenClose=!0}!it.high&&!He.high&&(it.high=it.open),!it.low&&!He.low&&(it.low=it.open),fe.mode===jr.Volume?(it.high&&(it.high!==it.open&&_t.delete(it.high),it.high=void 0),it.low&&(it.low!==it.open&&_t.delete(it.low),it.low=void 0)):fe.mode===jr.Candles&&it.volume&&(_t.delete(it.volume),it.volume=void 0);for(const kt of Object.values(Jr)){const pn=it[kt.key];pn&&(it.names[kt.key]=(0,Ea.Ct)(pn,it.frame))}const Qt=Ot.fields[wt],rn=[Qt];fe.includeAllFields?rn.push(...Ot.fields.filter(kt=>kt!==Qt)):rn.push(..._t),it.frame={...it.frame,fields:rn};for(let kt=0;kt<it.frame.fields.length;kt++){const pn=it.frame.fields[kt];pn.state={...pn.state,seriesIndex:kt-1,origin:{fieldIndex:kt,frameIndex:0}}}return it}const{alpha:Ai}=Is.MV;function Vo(Q){let{mode:fe,candleStyle:be,fields:Be,colorStrategy:He,upColor:at,downColor:it,flatColor:Dt,volumeAlpha:Ot,flatAsUp:wt=!0}=Q;const _t=fe!==jr.Volume&&Be.high!=null&&Be.low!=null,Qt=_t&&be===di.Candles,rn=fe!==jr.Candles&&Be.volume!=null;function kt(bn,Us,us,Ts,zn){return bn>0?us:bn<0?Ts:zn?us:Us}let pn=0,_n=Be.open,An=Be.high,$n=Be.low,Bn=Be.close,un=Be.volume;return bn=>{let Us,us,Ts,zn,On,fs;_t&&(Ts=new Path2D,us=new Path2D,Us=new Path2D),rn&&(zn=new Path2D,On=new Path2D,fs=new Path2D);let Hn=new Path2D,ps=bn.ctx,ks=bn.data[pn],Xs=bn.data[_n],ia=bn.data[Bn],ja=_t?bn.data[An]:null,Ys=_t?bn.data[$n]:null,xs=rn?bn.data[un]:null,Os=un!=null?Math.round(bn.valToPos(0,bn.series[un].scale,!0)):null,[ha,Ha]=bn.series[0].idxs,Ws=bn.data[0],Rs=Xs,na=bn.bbox.width;if(Ws.length>1){let fa=null;for(let Ga=0,Ja=1/0;Ga<Ws.length;Ga++)if(Rs[Ga]!==void 0){if(fa!=null){let pr=Math.abs(Ws[Ga]-Ws[fa]);pr<Ja&&(Ja=pr,na=Math.abs(bn.valToPos(Ws[Ga],"x",!0)-bn.valToPos(Ws[fa],"x",!0)))}fa=Ga}}let ya=Math.round(.6*na),da=2,Ba=2;ya<=12&&(da=Ba=1);let Fa=Math.floor(ya/2);for(let fa=ha;fa<=Ha;fa++){let Ga=Math.round(bn.valToPos(ks[fa],"x",!0)),Ja=fa===ha?0:Math.sign(ia[fa]-ia[fa-1]),pr=Math.sign(ia[fa]-Xs[fa]);if(rn&&fs&&On&&zn){let vs=kt(He===vo.CloseClose?Ja:pr,fs,On,zn,fa===ha&&vo.CloseClose?!1:wt),ds=Math.round(bn.valToPos(xs[fa],bn.series[un].scale,!0));vs.rect(Ga-Fa,ds,ya,Os-ds)}if(_t&&Ts&&us&&Us){let vs=kt(He===vo.CloseClose?Ja:pr,Ts,us,Us,fa===ha&&vo.CloseClose?!1:wt),ds=Math.round(bn.valToPos(ja[fa],bn.series[An].scale,!0)),Ls=Math.round(bn.valToPos(Ys[fa],bn.series[$n].scale,!0));vs.rect(Ga-Math.floor(da/2),ds,da,Ls-ds);let ra=Math.round(bn.valToPos(Xs[fa],bn.series[_n].scale,!0)),qs=Math.round(bn.valToPos(ia[fa],bn.series[Bn].scale,!0));if(Qt){let la=Math.min(ra,qs),Pa=Math.max(ra,qs),br=Math.max(1,Pa-la);vs.rect(Ga-Fa,la,ya,br),He===vo.CloseClose&&pr>=0&&br>Ba*2&&Hn.rect(Ga-Fa+Ba,la+Ba,ya-Ba*2,br-Ba*2)}else vs.rect(Ga-Fa,ra,Fa,da),vs.rect(Ga,qs,Fa,da)}}ps.save(),ps.rect(bn.bbox.left,bn.bbox.top,bn.bbox.width,bn.bbox.height),ps.clip(),rn&&fs&&On&&zn&&(ps.fillStyle=Ai(at,Ot),ps.fill(On),ps.fillStyle=Ai(it,Ot),ps.fill(zn),ps.fillStyle=Ai(Dt,Ot),ps.fill(fs)),_t&&Ts&&us&&Us&&(ps.fillStyle=at,ps.fill(us),ps.fillStyle=it,ps.fill(Us),ps.fillStyle=Dt,ps.fill(Ts),ps.globalCompositeOperation="destination-out",ps.fill(Hn)),ps.restore()}}const Xi=({data:Q,id:fe,timeRange:be,timeZone:Be,width:He,height:at,options:it,fieldConfig:Dt,onChangeTimeRange:Ot,replaceVariables:wt})=>{const{sync:_t,eventsScope:Qt,canAddAnnotations:rn,onThresholdsChange:kt,canEditThresholds:pn,showThresholds:_n,dataLinkPostProcessor:An,eventBus:$n}=(0,hr.d2)(),Bn=(0,ee.$j)(),un=(0,K.useMemo)(()=>$o(Q.series,it,Bn,be),[Q.series,it,Bn,be]),[bn,Us]=(0,K.useState)(null),us=_t?.()??Jn.yV.Off,{renderers:Ts,tweakScale:zn,tweakAxis:On,shouldRenderPrice:fs}=(0,K.useMemo)(()=>{let ps=(Ja,pr)=>Ja,ks=(Ja,pr)=>Ja,Xs={renderers:[],tweakScale:ps,tweakAxis:ks,shouldRenderPrice:!1};if(!un)return Xs;const ia=un.names;if(!Object.keys(ia).length)return Xs;const{mode:ja,candleStyle:Ys,colorStrategy:xs}=it,Os={...ui,...it.colors};let{open:ha,high:Ha,low:Ws,close:Rs,volume:na}=ia;if(ha==null||Rs==null)return Xs;let ya=.5,da=-1,Ba=!1;if(na!=null&&ja!==jr.Candles){let Ja=un.volume;if(Ja!=null){Ba=!0;let{fillOpacity:pr}=Ja.config.custom;pr&&(ya=pr/100),ja!==jr.Volume&&(Ja.config={...Ja.config},Ja.config.unit="short",Ja.display=(0,sn.J)({field:Ja,theme:ce.config.theme2}),ks=(vs,ds)=>{if(ds.name===un.volume?.name){let Ls=(ra,qs)=>{let la=[],Pa=ra.series[da].max;for(let br=0;br<qs.length&&(la.push(qs[br]),!(Pa&&qs[br]>Pa));br++);return la};vs.space=20,vs.filter=Ls,vs.ticks={...vs.ticks,filter:Ls}}return vs},ps=(vs,ds)=>(ds.name===un.volume?.name&&(vs.range=(Ls,ra,qs)=>[0,qs*7]),vs))}}let Fa=ja!==jr.Volume&&Ha!=null&&Ws!=null;if(!Fa&&!Ba)return Xs;let fa={},Ga=[];return Fa?fa={open:ha,high:Ha,low:Ws,close:Rs}:Ga.push(ha,Rs),Ba&&(fa.volume=na,fa.open=ha,fa.close=Rs),{shouldRenderPrice:Fa,renderers:[{fieldMap:fa,indicesOnly:Ga,init:(Ja,pr)=>{da=pr.volume,Ja.addHook("drawAxes",Vo({mode:ja,fields:pr,upColor:ce.config.theme2.visualization.getColorByName(Os.up),downColor:ce.config.theme2.visualization.getColorByName(Os.down),flatColor:ce.config.theme2.visualization.getColorByName(Os.flat),volumeAlpha:ya,colorStrategy:xs,candleStyle:Ys,flatAsUp:!0}))}}],tweakScale:ps,tweakAxis:ks}},[it,Q.structureRev,Q.series.length]);if(!un)return(0,T.jsx)(ys.a,{panelId:fe,fieldConfig:Dt,data:Q,needsTimeField:!0,needsNumberField:!0});if(fs)for(let ps in Ts[0].fieldMap){let ks=un[ps];ks.config={...ks.config,custom:{...ks.config.custom,hideFrom:{legend:!0,tooltip:!1,viz:!1}}}}const Hn=!!rn?.();return(0,T.jsx)(Yo,{frames:[un.frame],structureRev:Q.structureRev,timeRange:be,timeZone:Be,width:He,height:at,legend:it.legend,renderers:Ts,tweakAxis:On,tweakScale:zn,options:it,replaceVariables:wt,dataLinkPostProcessor:An,cursorSync:us,children:(ps,ks)=>(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(Ma.Z,{config:ps}),us!==Jn.yV.Off&&(0,T.jsx)(ho.K,{config:ps,eventBus:$n,frame:ks}),it.tooltip.mode!==ut.$N.None&&(0,T.jsx)(Ks.xl,{config:ps,hoverMode:it.tooltip.mode===ut.$N.Single?Ks.b3.xOne:Ks.b3.xAll,queryZoom:Ot,clientZoom:!0,syncMode:us,syncScope:Qt,render:(Xs,ia,ja,Ys=!1,xs,Os,ha)=>{if(Hn&&Os!=null){Us(Os),xs();return}const Ha=()=>{let Ws=Xs.posToVal(Xs.cursor.left,"x");Us({from:Ws,to:Ws}),xs()};return(0,T.jsx)(Zs.k,{series:ks,dataIdxs:ia,seriesIdx:ja,mode:ha?ut.$N.Multi:it.tooltip.mode,sortOrder:it.tooltip.sort,isPinned:Ys,annotate:Hn?Ha:void 0,maxHeight:it.tooltip.maxHeight})},maxWidth:it.tooltip.maxWidth}),(0,T.jsx)(kr.W,{annotations:Q.annotations??[],config:ps,timeZone:Be,newRange:bn,setNewRange:Us}),(0,T.jsx)(Wo.U,{config:ps,onChangeTimeRange:Ot}),Q.annotations&&(0,T.jsx)(Gi,{config:ps,exemplars:Q.annotations,timeZone:Be}),(pn&&kt||_n)&&(0,T.jsx)(Ii,{config:ps,fieldConfig:Dt,onThresholdsChange:pn?kt:void 0})]})})};class Fr{getSuggestionsForData(fe){const{dataSummary:be}=fe;if(!fe.data?.series||!be.hasData||be.timeFieldCount<1||be.numberFieldCount<2||be.numberFieldCount>10)return;const Be=$o(fe.data.series,yo,I.$.theme2);if(!Be||Be.open===Be.high&&Be.open===Be.low)return;fe.getListAppender({name:"",pluginId:"candlestick",options:{},fieldConfig:{defaults:{custom:{}},overrides:[]}}).append({name:ss.m.Candlestick,options:yo,fieldConfig:{defaults:{},overrides:[]},score:Be.autoOpenClose?Wt.nQ.Good:Wt.nQ.Best})}}const Xr=[{label:"Candles",value:jr.Candles},{label:"Volume",value:jr.Volume},{label:"Both",value:jr.CandlesVolume}],Gr=[{label:"Candles",value:di.Candles},{label:"OHLC Bars",value:di.OHLCBars}],Ri=[{label:"Since Open",value:vo.OpenClose},{label:"Since Prior Close",value:vo.CloseClose}],pl=Q=>Q.type===jt.PU.number;function Jo(Q,fe,be){let Be="Auto ";if(be){const He=be[fe.key];He?.config?(Be+="= "+(0,Ea.Ct)(He),He===be?.open&&fe.key!=="open"&&(Be+=` (${fe.defaults.join(",")})`)):Be+=`(${fe.defaults.join(",")})`}Q.addFieldNamePicker({path:`fields.${fe.key}`,name:fe.name,description:fe.description,settings:{filter:pl,placeholderText:Be}})}const Ul=new C.m(Xi).useFieldConfig((0,Aa.V)(Aa.S)).setPanelOptions((Q,fe)=>{const be=fe.options??yo,Be=$o(fe.data,be,I.$.theme2);Q.addRadio({path:"mode",name:"Mode",description:"",defaultValue:yo.mode,settings:{options:Xr}}).addRadio({path:"candleStyle",name:"Candle style",description:"",defaultValue:yo.candleStyle,settings:{options:Gr},showIf:He=>He.mode!==jr.Volume}).addRadio({path:"colorStrategy",name:"Color strategy",description:"",defaultValue:yo.colorStrategy,settings:{options:Ri}}).addColorPicker({path:"colors.up",name:"Up color",defaultValue:ui.up}).addColorPicker({path:"colors.down",name:"Down color",defaultValue:ui.down}),Jo(Q,Jr.open,Be),be.mode!==jr.Volume&&(Jo(Q,Jr.high,Be),Jo(Q,Jr.low,Be)),Jo(Q,Jr.close,Be),be.mode!==jr.Candles&&Jo(Q,Jr.volume,Be),Q.addRadio({path:"includeAllFields",name:"Additional fields",description:"Use standard timeseries options to configure any fields not mapped above",defaultValue:yo.includeAllFields,settings:{options:[{label:"Ignore",value:!1},{label:"Include",value:!0}]}}),Qn.D(Q,!1,!0,be),Fn.H(Q)}).setDataSupport({annotations:!0,alertStates:!0}).setSuggestionsSupplier(new Fr);var hi=e(36607),Zi=e(76885),qi=e(80997),Li=e(6709),fi=e(29158),ji=e(82467),Xo=e(10096),Fe=e(16021),_e=e(91219),tt=e(28215),ft=e(27677),Mt=e(62301),$t=e(80484);const Jt=Q=>({dashlistSectionHeader:(0,te.css)`
    padding: ${Q.spacing(.25,1)};
    margin-right: ${Q.spacing(1)};
  `,dashlistSection:(0,te.css)`
    margin-bottom: ${Q.spacing(2)};
    padding-top: 3px;
  `,dashlistLink:(0,te.css)`
    display: flex;
    cursor: pointer;
    border-bottom: 1px solid ${Q.colors.border.weak};
    margin-right: ${Q.spacing(1)};
    padding: ${Q.spacing(1)};
    align-items: center;

    &:hover {
      a {
        color: ${Q.colors.text.link};
        text-decoration: underline;
      }
    }
  `,dashlistFolder:(0,te.css)`
    color: ${Q.colors.text.secondary};
    font-size: ${Q.typography.bodySmall.fontSize};
    line-height: ${Q.typography.body.lineHeight};
  `,dashlistTitle:(0,te.css)`
    &::after {
      position: absolute;
      content: '';
      left: 0;
      top: 0;
      bottom: 0;
      right: 0;
    }
  `,dashlistLinkBody:(0,te.css)`
    flex-grow: 1;
    overflow: hidden;
    text-overflow: ellipsis;
  `,dashlistItem:(0,te.css)`
    position: relative;
    list-style: none;
  `});async function nn(Q,fe){let be=Promise.resolve([]);if(Q.showStarred){const _t={limit:Q.maxItems,starred:"true"};be=(0,ft.AI)().search(_t)}let Be=Promise.resolve([]),He=[];if(Q.showRecentlyViewed){let _t=await Mt.A.getDashboardOpened();He=(0,B.take)(_t,Q.maxItems),Be=(0,ft.AI)().search({dashboardUIDs:He,limit:Q.maxItems})}let at=Promise.resolve([]);if(Q.showSearch){const _t=Q.folderUID===""?"general":Q.folderUID,Qt={limit:Q.maxItems,query:fe(Q.query,{},"text"),folderUIDs:_t,tag:Q.tags.map(rn=>fe(rn,{},"text")),type:"dash-db"};at=(0,ft.AI)().search(Qt)}const[it,Dt,Ot]=await Promise.all([be,at,Be]);let wt=new Map;for(const _t of He){const Qt=Ot.find(rn=>rn.uid===_t);Qt&&wt.set(_t,{...Qt,isRecent:!0})}return Dt.forEach(_t=>{_t.uid&&(wt.has(_t.uid)?wt.get(_t.uid).isSearchResult=!0:wt.set(_t.uid,{..._t,isSearchResult:!0}))}),it.forEach(_t=>{_t.uid&&(wt.has(_t.uid)?wt.get(_t.uid).isStarred=!0:wt.set(_t.uid,{..._t,isStarred:!0}))}),wt}function Dn(Q){const[fe,be]=(0,K.useState)(new Map),Be=(0,F.useDispatch)(),He=(0,F.useSelector)(Bn=>Bn.navIndex);(0,K.useEffect)(()=>{nn(Q.options,Q.replaceVariables).then(Bn=>{be(Bn)})},[Q.options,Q.replaceVariables,Q.renderCounter]);const at=async(Bn,un)=>{const{uid:bn,title:Us,url:us}=un;Bn.preventDefault(),Bn.stopPropagation();const Ts=await(0,Ye.UA)().starDashboard(un.uid,un.isStarred),zn=new Map(fe);zn.set(un?.uid??"",{...un,isStarred:Ts}),be(zn),Be((0,_e.ci)({id:bn??"",title:Us,url:us,isStarred:Ts}));const On=He.starred;if(Ts)On.children?.push({id:_e.L1+bn,text:Us,url:us??"",parentItem:On});else{Be((0,tt.Im)(_e.L1+bn));const fs=On.children?.findIndex(Hn=>Hn.id===_e.L1+bn);fs&&On.children?.splice(fs,1)}Be((0,ji.Vz)(On))},[it,Dt,Ot]=(0,K.useMemo)(()=>{const Bn=[...fe.values()];return[Bn.filter(un=>un.isStarred).sort((un,bn)=>un.title.localeCompare(bn.title)),Bn.filter(un=>un.isRecent),Bn.filter(un=>un.isSearchResult).sort((un,bn)=>un.title.localeCompare(bn.title))]},[fe]),{showStarred:wt,showRecentlyViewed:_t,showHeadings:Qt,showFolderNames:rn,showSearch:kt}=Q.options,pn=[{header:"Starred dashboards",dashboards:it,show:wt},{header:"Recently viewed dashboards",dashboards:Dt,show:_t},{header:"Search",dashboards:Ot,show:kt}],_n=(0,ee.of)(Jt),An=In(Q),$n=Bn=>(0,T.jsx)("ul",{children:Bn.map(un=>{let bn=un.url;return bn=Zi.kM.appendQueryToUrl(bn,An),bn=(0,ce.zj)().disableSanitizeHtml?bn:qi.sQ.sanitizeUrl(bn),(0,T.jsx)("li",{className:_n.dashlistItem,children:(0,T.jsxs)("div",{className:_n.dashlistLink,children:[(0,T.jsxs)("div",{className:_n.dashlistLinkBody,children:[(0,T.jsx)("a",{className:_n.dashlistTitle,href:bn,children:un.title}),rn&&un.folderTitle&&(0,T.jsx)("div",{className:_n.dashlistFolder,children:un.folderTitle})]}),(0,T.jsx)(fi.K,{tooltip:un.isStarred?`Unmark "${un.title}" as favorite`:`Mark "${un.title}" as favorite`,name:un.isStarred?"favorite":"star",iconType:un.isStarred?"mono":"default",onClick:Us=>at(Us,un)})]})},`dash-${un.uid}`)})});return(0,T.jsx)(se.E,{autoHeightMin:"100%",autoHeightMax:"100%",children:pn.map(({show:Bn,header:un,dashboards:bn},Us)=>Bn&&(0,T.jsxs)("div",{className:_n.dashlistSection,children:[Qt&&(0,T.jsx)("h6",{className:_n.dashlistSectionHeader,children:un}),$n(bn)]},`dash-group-${Us}`))})}function In(Q){(0,Fe.u)(Xo.lE,$t.og);let fe={};return Q.options.keepTime&&(fe[`$${Li.c.keepTime}`]=!0),Q.options.includeVars&&(fe[`$${Li.c.includeVars}`]=!0),Q.replaceVariables(Zi.kM.toUrlParams(fe))}async function ts(Q){return Q===0?"":(await(0,Kn.AI)().get(`/api/folders/id/${Q}`,void 0,void 0,{showErrorAlert:!1})).uid}async function hs(Q){const fe={...Q.options,showStarred:Q.options.showStarred??Q.starred,showRecentlyViewed:Q.options.showRecentlyViewed??Q.recent,showSearch:Q.options.showSearch??Q.search,showHeadings:Q.options.showHeadings??Q.headings,maxItems:Q.options.maxItems??Q.limit,query:Q.options.query??Q.query,folderId:Q.options.folderId??Q.folderId,tags:Q.options.tags??Q.tags};if(parseFloat(Q.pluginVersion||"6.1")<6.3&&["starred","recent","search","headings","limit","query","folderId"].forEach(He=>delete Q[He]),fe.folderId!==void 0){const Be=fe.folderId;try{const He=await ts(Be);fe.folderUID=He,delete fe.folderId}catch(He){console.warn("Dashlist: Error migrating folder ID to UID",He)}}return fe}const Yn={includeVars:!1,keepTime:!1,maxItems:10,query:"",showFolderNames:!0,showHeadings:!0,showRecentlyViewed:!1,showSearch:!1,showStarred:!0,tags:[]},bs=new C.m(Dn).setPanelOptions(Q=>{Q.addBooleanSwitch({path:"keepTime",name:"Include current time range",defaultValue:Yn.keepTime}).addBooleanSwitch({path:"includeVars",name:"Include current template variable values",defaultValue:Yn.includeVars}).addBooleanSwitch({path:"showStarred",name:"Starred",defaultValue:Yn.showStarred}).addBooleanSwitch({path:"showRecentlyViewed",name:"Recently viewed",defaultValue:Yn.showRecentlyViewed}).addBooleanSwitch({path:"showSearch",name:"Search",defaultValue:Yn.showSearch}).addBooleanSwitch({path:"showHeadings",name:"Show headings",defaultValue:Yn.showHeadings}).addBooleanSwitch({path:"showFolderNames",name:"Show folder names",defaultValue:Yn.showFolderNames}).addNumberInput({path:"maxItems",name:"Max items",defaultValue:Yn.maxItems}).addTextInput({path:"query",name:"Query",defaultValue:Yn.query}).addCustomEditor({path:"folderUID",name:"Folder",id:"folderUID",defaultValue:void 0,editor:function({value:be,onChange:Be}){return(0,T.jsx)(hi.d,{clearable:!0,permission:F.PermissionLevelString.View,value:be,onChange:He=>Be(He)})}}).addCustomEditor({id:"tags",path:"tags",name:"Tags",description:"",defaultValue:Yn.tags,editor(fe){return(0,T.jsx)(pt.u,{tags:fe.value,onChange:fe.onChange})}})}).setMigrationHandler(hs);var Ns=e(47187),ns=e(14110),ta=e(11503);const Ms=({onBlur:Q,placeholder:fe})=>{const be=(0,K.useRef)(null);(0,K.useEffect)(()=>{be.current&&be.current.focus()});const Be=He=>{He.key==="Enter"&&He.currentTarget.blur()};return(0,T.jsx)("input",{type:"text",placeholder:fe,onBlur:Q,ref:be,onKeyDown:Be,"data-testid":"column-input"})},Qs=({divStyle:Q,onColumnInputBlur:fe})=>{const[be,Be]=(0,K.useState)(!1),He=()=>{Be(!0)},at=it=>{const Dt=it.target.value;Dt&&fe(Dt),Be(!1)};return(0,T.jsx)("div",{className:Q,children:be?(0,T.jsx)(Ms,{placeholder:"Column Name",onBlur:at}):(0,T.jsx)("button",{onClick:He,children:"+"})})};var oa=e(50311),ms=e(64539),xa=e(59093),Ua=e(28122),_a=e(27183),La=e(69321);const va=()=>I.$.featureToggles.enableDatagridEditing,wa="600 13px Inter",Kr="400 13px Inter",Pr=document.createElement("canvas"),fr=20,Qr=300,$r=65,Zr="both",co="number",gr={isContextMenuOpen:!1},as={isInputOpen:!1},ls="datagrid_panel",Cs={EDIT_CELL:"edit_cell",GRID_SELECTED:"grid_selected",APPEND_ROW:"append_row",APPEND_COLUMN:"append_column",DELETE_BTN_PRESSED:"delete_btn_pressed",COLUMN_RESIZE:"column_resize",COLUMN_REORDER:"column_reorder",ROW_REORDER:"row_reorder",CONTEXT_MENU_ACTION:"context_menu_action",HEADER_MENU_ACTION:"header_menu_action"},zs={name:"A",fields:[],length:0},Nr={kind:La.dd.Text,data:"",allowOverlay:!0,readonly:!1,displayData:""},Ge={columns:La.I1.empty(),rows:La.I1.empty()},Ae={sticky:!1,tint:!0},Ke={fill:!0,sticky:!1};async function lt(Q,fe){if(fe&&va()){for(let be=0;be<Q.fields.length;be++)delete Q.fields[be].config.displayName,delete Q.fields[be].config.displayNameFromDS;return await fe([Q])}return!1}const It=(Q,fe=!1)=>{const be=Pr.getContext("2d");return be.font=fe?wa:Kr,be.measureText(Q).width},Xt=Q=>Math.max(It(Q.name,!0)+$r,Math.min(Qr,Q.values.toArray().reduce((fe,be)=>{const Be=It(be?.toString()??"");return Be>fe?Be:fe},0)+fr)),Yt=(Q,fe,be=!1)=>{const Be={...Q,fields:Q.fields.map(He=>({...He,values:He.values.slice()}))};for(const He of Be.fields){const at=He.values.toArray();for(let it=fe.length-1;it>=0;it--)be?at.splice(fe[it],1):at.splice(fe[it],1,null);He.values=[...at]}return{...Be,length:Be.fields[0]?.values.length??0}},gn=(Q,fe)=>{const be=fe.x,Be=fe.y,He=fe.x+fe.width-1,at={...Q,fields:Q.fields.map(it=>({...it,values:it.values.slice()}))};for(let it=be;it<=He;it++){const Dt=at.fields[it],Ot=Dt.values.toArray();Ot.splice(Be,fe.height,...new Array(fe.height).fill(null)),Dt.values=[...Ot]}return{...at,length:at.fields[0]?.values.length??0}},yn=Q=>{const fe=Q.values.toArray();Q.values=fe.map(be=>be==="undefined"||be==="null"?null:be)};function Mn(Q){return{accentColor:Q.colors.primary.main,accentFg:Q.colors.secondary.main,textDark:Q.colors.text.primary,textMedium:Q.colors.text.secondary,textLight:Q.colors.text.secondary,textBubble:Q.colors.text.primary,textHeader:Q.colors.text.primary,bgCell:Q.colors.background.primary,bgCellMedium:Q.colors.background.primary,bgHeader:Q.colors.background.primary,bgHeaderHasFocus:Q.colors.background.secondary,bgHeaderHovered:Q.colors.background.secondary,linkColor:Q.colors.text.link,fontFamily:Q.typography.fontFamily,headerFontStyle:`${Q.typography.fontWeightMedium} ${Q.typography.fontSize}px`,fgIconHeader:Q.colors.secondary.contrastText,bgIconHeader:Q.colors.secondary.main}}const is=(Q,fe,be=!1)=>{const Be=Q.values.get(fe);switch(Q.type){case jt.PU.boolean:return{kind:La.dd.Boolean,data:Be||!1,allowOverlay:!1,readonly:!1};case jt.PU.number:return{kind:La.dd.Number,data:Be||0,allowOverlay:va()&&!be,readonly:!1,displayData:Be!=null?Be.toString():""};case jt.PU.string:return{kind:La.dd.Text,data:Be||"",allowOverlay:va()&&!be,readonly:!1,displayData:Be!=null?Be.toString():""};default:return{kind:La.dd.Text,data:Be||"",allowOverlay:va()&&!be,readonly:!1,displayData:Be!=null?Be.toString():""}}},rs=(Q,fe)=>({dataEditor:(0,te.css)`
      .dvn-scroll-inner > div:nth-child(2) {
        pointer-events: none !important;
      }
      scrollbar-color: ${Q.colors.background.secondary} ${Q.colors.background.primary};
      ::-webkit-scrollbar {
        width: 10px;
        height: 10px;
      }
      ::-webkit-scrollbar-track {
        background: ${Q.colors.background.primary};
      }
      ::-webkit-scrollbar-thumb {
        border-radius: 10px;
      }
      ::-webkit-scrollbar-corner {
        display: none;
      }
    `,addColumnDiv:(0,te.css)`
      width: 120px;
      display: flex;
      flex-direction: column;
      background-color: ${Q.colors.background.primary};
      button {
        pointer-events: ${fe?"none":"auto"};
        border: none;
        outline: none;
        height: 37px;
        font-size: 20px;
        background-color: ${Q.colors.background.primary};
        color: ${Q.colors.text.primary};
        border-right: 1px solid ${Q.components.panel.borderColor};
        border-bottom: 1px solid ${Q.components.panel.borderColor};
        transition: background-color 200ms;
        cursor: pointer;
        :hover {
          background-color: ${Q.colors.background.secondary};
        }
      }
      input {
        height: 37px;
        border: 1px solid ${Q.colors.primary.main};
        :focus {
          outline: none;
        }
      }
    `,renameColumnInput:(0,te.css)`
      height: 37px;
      border: 1px solid ${Q.colors.primary.main};
      :focus {
        outline: none;
      }
    `}),ws=Q=>Q.rows.length||Q.columns.length?!0:Q.current===void 0?!1:Q.current.range&&!(Q.current.range.height===1&&Q.current.range.width===1);var Es=(Q=>(Q.columnResizeStart="columnResizeStart",Q.columnResizeEnd="columnResizeEnd",Q.columnMove="columnMove",Q.updateColumns="updateColumns",Q.showColumnRenameInput="showColumnRenameInput",Q.hideColumnRenameInput="hideColumnRenameInput",Q.openCellContextMenu="openCellContextMenu",Q.openHeaderContextMenu="openHeaderContextMenu",Q.openHeaderDropdownMenu="openHeaderDropdownMenu",Q.closeContextMenu="closeContextMenu",Q.multipleCellsSelected="multipleCellsSelected",Q.gridSelectionCleared="gridSelectionCleared",Q.columnFreezeReset="columnFreezeReset",Q.columnFreezeChanged="columnFreezeChanged",Q.openSearch="openSearch",Q.closeSearch="closeSearch",Q))(Es||{});const Sa={columns:[],contextMenuData:gr,renameColumnInputData:as,gridSelection:Ge,columnFreezeIndex:0,toggleSearch:!1,isResizeInProgress:!1},Na=new Map([[jt.PU.number,La.Gf.HeaderNumber],[jt.PU.string,La.Gf.HeaderTextTemplate],[jt.PU.boolean,La.Gf.HeaderBoolean],[jt.PU.time,La.Gf.HeaderDate],[jt.PU.other,La.Gf.HeaderReference]]),sa=(Q,fe)=>{let be=[];switch(fe.type){case"columnResizeStart":be=[...Q.columns];const Be=fe.payload;return be[Be.columnIndex]={...Q.columns[Be.columnIndex],width:Be.width},{...Q,columns:be,isResizeInProgress:!0};case"columnMove":be=[...Q.columns];const He=fe.payload,at=Q.columns[He.from].width;let it=be.splice(He.from,1)[0];return it={...it,width:at},be.splice(He.to,0,it),{...Q,columns:be};case"columnResizeEnd":return{...Q,isResizeInProgress:!1};case"updateColumns":const Dt=fe.payload;return be=[...Dt.frame.fields.map(($n,Bn)=>{const un=Q.columns.find(Us=>Us.title===$n.name)?.width;return{title:(0,Ea.Ct)($n,Dt.frame),width:un??Xt($n),icon:Na.get($n.type),hasMenu:va(),trailingRowOptions:{targetColumn:--Bn}}})],{...Q,columns:be};case"showColumnRenameInput":return{...Q,renameColumnInputData:{...Q.renameColumnInputData,isInputOpen:!0}};case"hideColumnRenameInput":return{...Q,renameColumnInputData:{...Q.renameColumnInputData,isInputOpen:!1}};case"openCellContextMenu":const Ot=fe.payload,wt=Ot.event,_t=Ot.cell;return{...Q,contextMenuData:{x:wt.bounds.x+wt.localEventX,y:wt.bounds.y+wt.localEventY,column:_t[0]===-1?void 0:_t[0],row:_t[1],isContextMenuOpen:!0,isHeaderMenu:!1}};case"openHeaderContextMenu":const Qt=fe.payload,rn=Qt.event;return{...Q,contextMenuData:{x:rn.bounds.x+rn.localEventX,y:rn.bounds.y+rn.localEventY,column:Qt.columnIndex,row:void 0,isContextMenuOpen:!0,isHeaderMenu:!1}};case"openHeaderDropdownMenu":const kt=fe.payload,pn=kt.screenPosition;return{...Q,contextMenuData:{x:pn.x+pn.width,y:pn.y+pn.height,column:kt.columnIndex,row:void 0,isContextMenuOpen:!0,isHeaderMenu:!0},renameColumnInputData:{x:pn.x,y:pn.y,width:pn.width,height:pn.height,columnIdx:kt.columnIndex,isInputOpen:!1,inputValue:kt.value}};case"closeContextMenu":return{...Q,contextMenuData:{isContextMenuOpen:!1}};case"closeSearch":return{...Q,toggleSearch:!1};case"openSearch":return{...Q,toggleSearch:!0};case"multipleCellsSelected":const _n=fe.payload;return{...Q,gridSelection:_n.selection};case"gridSelectionCleared":return{...Q,gridSelection:Ge};case"columnFreezeReset":return{...Q,columnFreezeIndex:0};case"columnFreezeChanged":const An=fe.payload;return{...Q,columnFreezeIndex:An.columnIndex};default:return Q}},ea=({menuData:Q,data:fe,saveData:be,closeContextMenu:Be,dispatch:He,gridSelection:at,columnFreezeIndex:it,renameColumnClicked:Dt})=>{let Ot=[],wt=[];const{row:_t,column:Qt,x:rn,y:kt,isHeaderMenu:pn}=Q;at.rows&&(Ot=at.rows.toArray()),at.columns&&(wt=at.columns.toArray());let _n="Delete row";Ot.length&&Ot.length>1&&(_n=`Delete ${Ot.length} rows`);let An="Delete column";wt.length&&wt.length>1&&(An=`Delete ${wt.length} columns`);const $n=_t!==void 0&&_t>=0||Ot.length,Bn=Qt!==void 0&&Qt>=0&&_t!==void 0||wt.length,un=_t!==void 0&&_t>=0&&!Ot.length,bn=Qt!==void 0&&Qt>=0&&_t!==void 0&&!wt.length,Us=()=>(0,T.jsxs)(T.Fragment,{children:[$n?(0,T.jsx)(ms.D,{label:_n,onClick:()=>{if(Ot.length){be(Yt(fe,Ot,!0)),He({type:Es.gridSelectionCleared});return}_t!==void 0&&_t>=0&&((0,ns.rR)(ls,{item:Cs.CONTEXT_MENU_ACTION,menu_action:"row_delete"}),be(Yt(fe,[_t],!0)))}}):null,Bn?(0,T.jsx)(ms.D,{label:An,onClick:()=>{if(wt.length){be({...fe,fields:fe.fields.filter((Ts,zn)=>!wt.includes(zn))}),He({type:Es.gridSelectionCleared});return}Qt!==void 0&&Qt>=0&&((0,ns.rR)(ls,{item:Cs.CONTEXT_MENU_ACTION,menu_action:"column_delete"}),be({...fe,fields:fe.fields.filter((Ts,zn)=>zn!==Qt)}))}}):null,Bn||$n?(0,T.jsx)(_a.N,{}):null,un?(0,T.jsx)(ms.D,{label:"Clear row",onClick:()=>{(0,ns.rR)(ls,{item:Cs.CONTEXT_MENU_ACTION,menu_action:"row_clear"}),be(Yt(fe,[_t]))}}):null,bn?(0,T.jsx)(ms.D,{label:"Clear column",onClick:()=>{const Ts=fe.fields[Qt];Ts.values=Ts.values.map(()=>null),(0,ns.rR)(ls,{item:Cs.CONTEXT_MENU_ACTION,menu_action:"column_clear"}),be({...fe})}}):null,un||bn?(0,T.jsx)(_a.N,{}):null,(0,T.jsx)(ms.D,{label:"Remove all data",onClick:()=>{(0,ns.rR)(ls,{item:Cs.CONTEXT_MENU_ACTION,menu_action:"remove_all"}),be(zs)}}),(0,T.jsx)(ms.D,{label:"Search...",onClick:()=>{(0,ns.rR)(ls,{item:Cs.CONTEXT_MENU_ACTION,menu_action:"open_search"}),He({type:Es.openSearch})}})]}),us=()=>{if(Qt==null)return null;const Ts=fe.fields[Qt].type,zn=[],On=ps=>{zn.push({label:(0,B.capitalize)(ps),options:{targetField:fe.fields[Qt].name,destinationType:ps}})};Ts===jt.PU.string?(On(jt.PU.number),On(jt.PU.boolean)):Ts===jt.PU.number?(On(jt.PU.string),On(jt.PU.boolean)):Ts===jt.PU.boolean?(On(jt.PU.number),On(jt.PU.string)):(On(jt.PU.string),On(jt.PU.number),On(jt.PU.boolean));let fs="Set column freeze position";const Hn=Qt+1;return it===Hn&&(fs="Unset column freeze"),(0,T.jsxs)(T.Fragment,{children:[zn.length?(0,T.jsx)(xa.r,{label:"Set field type",children:zn.map((ps,ks)=>(0,T.jsx)(ms.D,{label:ps.label,onClick:()=>{const Xs=(0,oa.s7)(fe.fields[Qt],ps.options);ps.options.destinationType===jt.PU.string&&yn(Xs);const ia={name:fe.name,fields:[...fe.fields],length:fe.length};ia.fields[Qt]=Xs,(0,ns.rR)(ls,{item:Cs.HEADER_MENU_ACTION,menu_action:"convert_field"}),be(ia)}},ks))}):null,(0,T.jsx)(_a.N,{}),(0,T.jsx)(ms.D,{label:fs,onClick:()=>{(0,ns.rR)(ls,{item:Cs.HEADER_MENU_ACTION,menu_action:"column_freeze"}),He(it===Hn?{type:Es.columnFreezeReset}:{type:Es.columnFreezeChanged,payload:{columnIndex:Hn}})}}),(0,T.jsx)(ms.D,{label:"Rename column",onClick:Dt}),(0,T.jsx)(_a.N,{}),(0,T.jsx)(ms.D,{label:"Delete column",onClick:()=>{(0,ns.rR)(ls,{item:Cs.HEADER_MENU_ACTION,menu_action:"delete_column"}),be({...fe,fields:fe.fields.filter((ps,ks)=>ks!==Qt)}),He({type:Es.gridSelectionCleared})}}),(0,T.jsx)(ms.D,{label:"Clear column",onClick:()=>{const ps=fe.fields[Qt];ps.values=ps.values.map(()=>null),(0,ns.rR)(ls,{item:Cs.HEADER_MENU_ACTION,menu_action:"clear_column"}),be({...fe})}})]})};return(0,T.jsx)(Ua.t,{renderMenuItems:pn?us:Us,x:rn,y:kt,onClose:Be})},Da=({renameColumnData:Q,onColumnInputBlur:fe,classStyle:be})=>{const{x:Be,y:He,width:at,height:it,inputValue:Dt,columnIdx:Ot}=Q,[wt,_t]=(0,K.useState)({}),[Qt,rn]=(0,K.useState)(Dt),kt=(0,K.useRef)(null);(0,K.useLayoutEffect)(()=>{kt.current?.focus();const $n=kt.current?.getBoundingClientRect();if($n){const Bn={right:window.innerWidth<Be+$n.width,bottom:window.innerHeight<He+$n.height};_t({position:"fixed",left:Bn.right?Be-$n.width:Be,top:Bn.bottom?He-$n.height:He,width:at,height:it})}},[it,at,Be,He]);const pn=$n=>{const Bn=$n.target.value;Bn&&fe(Bn,Ot)},_n=$n=>{rn($n.target.value)},An=$n=>{$n.key==="Enter"&&$n.currentTarget.blur()};return(0,T.jsx)(li.ZL,{children:(0,T.jsx)("input",{type:"text",className:be,value:Qt,onBlur:pn,ref:kt,style:wt,onChange:_n,onKeyDown:An})})};function or({options:Q,data:fe,id:be,fieldConfig:Be,width:He,height:at}){const[it,Dt]=(0,K.useReducer)(sa,Sa),{onUpdateData:Ot}=(0,hr.d2)(),{columns:wt,contextMenuData:_t,renameColumnInputData:Qt,gridSelection:rn,columnFreezeIndex:kt,toggleSearch:pn,isResizeInProgress:_n}=it,An=fe.series[Q.selectedSeries??0],$n=(0,ee.$j)(),Bn=Mn($n);(0,K.useEffect)(()=>{An&&Dt({type:Es.updateColumns,payload:{frame:An}})},[An]);const un=([Ws,Rs])=>{const na=An.fields[Ws];return!na||Rs>An.length?Nr:is(na,Rs,ws(rn))},bn=(Ws,Rs)=>{if(ws(rn))return;const[na,ya]=Ws,da={...An,fields:An.fields.map(fa=>({...fa,values:[...fa.values]}))},Ba=da.fields[na];if(!Ba)return;const Fa=Ba.values.toArray();Fa[ya]=Rs.data,Ba.values=[...Fa],(0,ns.rR)(ls,{item:Cs.EDIT_CELL}),lt(da,Ot)},Us=Ws=>{const Rs=An.length??0;(0,ns.rR)(ls,{item:Cs.APPEND_COLUMN}),lt({...An,fields:[...An.fields,{name:Ws,type:jt.PU.string,config:{},values:new Array(Rs).fill("")}]},Ot)},us=()=>{const Ws=An.fields.map(Rs=>{const na=Rs.values.slice();return na.push(null),{...Rs,values:na}});(0,ns.rR)(ls,{item:Cs.APPEND_ROW}),lt({...An,fields:Ws,length:An.length+1},Ot)},Ts=(Ws,Rs,na,ya)=>{(0,ns.rR)(ls,{item:Cs.COLUMN_RESIZE}),Dt({type:Es.columnResizeStart,payload:{columnIndex:na,width:Rs}})},zn=(Ws,Rs,na,ya)=>{Dt({type:Es.columnResizeEnd})},On=()=>{Dt({type:Es.closeContextMenu})},fs=Ws=>{if(Ws.current&&Ws.current.range)return(0,ns.rR)(ls,{item:Cs.DELETE_BTN_PRESSED,selection:"grid-cell"}),lt(gn(An,Ws.current.range),Ot),!0;const Rs=Ws.rows.toArray(),na=Ws.columns.toArray();if(Rs.length)return(0,ns.rR)(ls,{item:Cs.DELETE_BTN_PRESSED,selection:"rows"}),lt(Yt(An,Rs),Ot),!0;if(na.length){const ya={...An,fields:An.fields.map((da,Ba)=>na.includes(Ba)?{...da,values:new Array(An.length).fill(null)}:da)};return(0,ns.rR)(ls,{item:Cs.DELETE_BTN_PRESSED,selection:"columns"}),lt(ya,Ot),!0}return!1},Hn=(Ws,Rs)=>{Rs.preventDefault(),Dt({type:Es.openCellContextMenu,payload:{event:Rs,cell:Ws}})},ps=(Ws,Rs)=>{Rs.preventDefault(),Dt({type:Es.openHeaderContextMenu,payload:{event:Rs,columnIndex:Ws}})},ks=(Ws,Rs)=>{Dt({type:Es.openHeaderDropdownMenu,payload:{screenPosition:Rs,columnIndex:Ws,value:it.columns[Ws].title}})},Xs=async(Ws,Rs)=>{const na=An.fields.map(Ba=>Ba),ya=na[Ws];na.splice(Ws,1),na.splice(Rs,0,ya),await lt({...An,fields:na},Ot)&&((0,ns.rR)(ls,{item:Cs.COLUMN_REORDER}),Dt({type:Es.columnMove,payload:{from:Ws,to:Rs}}))},ia=(Ws,Rs)=>{const na=An.fields.map(ya=>({...ya,values:ya.values.slice()}));for(const ya of na){const da=ya.values[Ws];ya.values.splice(Ws,1),ya.values.splice(Rs,0,da)}(0,ns.rR)(ls,{item:Cs.ROW_REORDER}),lt({...An,fields:na},Ot)},ja=()=>{(0,ns.rR)(ls,{item:Cs.HEADER_MENU_ACTION,menu_action:"rename_column"}),Dt({type:Es.showColumnRenameInput})},Ys=(Ws,Rs)=>{const na=An.fields.map(ya=>ya);na[Rs].name=Ws,Dt({type:Es.hideColumnRenameInput}),lt({...An,fields:na},Ot)},xs=()=>{Dt({type:Es.closeSearch})},Os=Ws=>{(0,ns.rR)(ls,{item:Cs.GRID_SELECTED}),Dt({type:Es.multipleCellsSelected,payload:{selection:Ws}})},ha=Ws=>{lt(Ws,Ot)};if(!An)return(0,T.jsx)(ys.a,{panelId:be,fieldConfig:Be,data:fe});if(!va())return(0,T.jsx)(ys.a,{panelId:be,message:"Datagrid is not enabled",fieldConfig:Be,data:fe});if(!document.getElementById("portal")){const Ws=document.createElement("div");Ws.id="portal",document.body.appendChild(Ws)}const Ha=rs($n,_n);return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(Ns.D,{className:Ha.dataEditor,getCellContent:un,columns:wt,rows:An.length,width:He,height:at,initialSize:[He,at],theme:Bn,smoothScrollX:!0,smoothScrollY:!0,overscrollY:50,onCellEdited:va()?bn:void 0,getCellsForSelection:va()?!0:void 0,showSearch:va()?pn:!1,onSearchClose:xs,gridSelection:rn,onGridSelectionChange:va()?Os:void 0,onRowAppended:va()?us:void 0,onDelete:va()?fs:void 0,rowMarkers:va()?Zr:co,onColumnResize:Ts,onColumnResizeEnd:zn,onCellContextMenu:va()?Hn:void 0,onHeaderContextMenu:va()?ps:void 0,onHeaderMenuClick:va()?ks:void 0,trailingRowOptions:Ae,rightElement:va()?(0,T.jsx)(Qs,{onColumnInputBlur:Us,divStyle:Ha.addColumnDiv}):null,rightElementProps:Ke,freezeColumns:kt,onRowMoved:va()?ia:void 0,onColumnMoved:va()?Xs:void 0}),_t.isContextMenuOpen&&(0,T.jsx)(ea,{menuData:_t,data:An,saveData:ha,closeContextMenu:On,dispatch:Dt,gridSelection:rn,columnFreezeIndex:kt,renameColumnClicked:ja}),Qt.isInputOpen?(0,T.jsx)(Da,{onColumnInputBlur:Ys,renameColumnData:Qt,classStyle:Ha.renameColumnInput}):null]})}const Vs={selectedSeries:0},ka=new C.m(or).setPanelOptions((Q,fe)=>{const be=fe.data.map((Be,He)=>({value:He,label:Be.refId}));return fe.options&&!be.map(Be=>Be.value).includes(fe.options.selectedSeries??0)&&(fe.options.selectedSeries=Vs.selectedSeries),Q.addSelect({path:"selectedSeries",name:"Select series",defaultValue:Vs.selectedSeries,settings:{options:be}})});var qa=e(1819);class Bi extends K.Component{constructor(){super(...arguments),this.subscription=new Pt.yU,this.state={}}componentDidMount(){const{eventBus:fe}=this.props;this.subscription.add(fe.subscribe(Pn.b_,be=>{this.setState({event:be})})),this.subscription.add(fe.subscribe(Pn.ql,be=>{this.setState({event:be})})),this.subscription.add(fe.subscribe(mn.kb,be=>{this.setState({event:be})})),this.subscription.add(fe.subscribe(mn.Tq,be=>{this.setState({event:be})}))}componentWillUnmount(){this.subscription.unsubscribe()}render(){const{event:fe}=this.state;if(!fe)return(0,T.jsx)("div",{children:"no events yet"});const{type:be,payload:Be,origin:He}=fe;return(0,T.jsxs)(se.E,{autoHeightMin:"100%",autoHeightMax:"100%",children:[(0,T.jsxs)("h3",{children:["Origin: ",He?.path]}),(0,T.jsxs)("span",{children:["Type: ",be]}),!!Be&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)("pre",{children:JSON.stringify(Be.point,null,"  ")}),Be.data&&(0,T.jsx)(qa.e,{data:Be.data,rowIndex:Be.rowIndex,columnIndex:Be.columnIndex})]})]})}}var Vr=e(36120);let Or=100;class Ui extends K.PureComponent{constructor(fe){super(fe),this.history=new Vr.$({capacity:40,append:"head"}),this.eventObserver={next:Be=>{const He=Be.origin;this.history.add({key:Or++,type:Be.type,path:He?.path,payload:Be.payload}),this.setState({counter:Or})}},this.state={counter:Or};const be=[];be.push(fe.eventBus.getStream(Pn.b_).subscribe(this.eventObserver)),be.push(fe.eventBus.getStream(Pn.ql).subscribe(this.eventObserver)),be.push(fe.eventBus.getStream(Pn.LO).subscribe(this.eventObserver)),this.subs=be}componentWillUnmount(){for(const fe of this.subs)fe.unsubscribe()}render(){return(0,T.jsx)(se.E,{autoHeightMin:"100%",autoHeightMax:"100%",children:this.history.map((fe,be)=>(0,T.jsxs)("div",{children:[JSON.stringify(fe.path)," ",fe.type," / X:",JSON.stringify(fe.payload.x)," / Y:",JSON.stringify(fe.payload.y)]},fe.key))})}}var uc=e(21423),Ni=e(75059);class _r extends K.Component{constructor(){super(...arguments),this.lastRender=Date.now(),this.counters={render:0,dataChanged:0,schemaChanged:0},this.resetCounters=()=>{this.counters={render:0,dataChanged:0,schemaChanged:0},this.forceUpdate()}}shouldComponentUpdate(fe){const{data:be,options:Be}=this.props;if(fe.data!==be&&(this.counters.dataChanged++,Be.counters?.schemaChanged)){const He=fe.data?.series,at=be.series;at&&He&&((0,uc.J3)(at,He,uc.bW)||this.counters.schemaChanged++)}return!0}render(){const{data:fe,options:be}=this.props,Be=be.counters??{render:!1,dataChanged:!1,schemaChanged:!1};this.counters.render++;const He=Date.now(),at=He-this.lastRender;this.lastRender=He;const it=Ni.AS.get(Ni.gy.lastNotNull);return(0,T.jsxs)("div",{children:[(0,T.jsxs)("div",{children:[(0,T.jsx)(fi.K,{name:"step-backward",title:"reset counters",onClick:this.resetCounters,tooltip:"Step back"}),(0,T.jsxs)("span",{children:[Be.render&&(0,T.jsxs)("span",{children:["Render: ",this.counters.render,"\xA0"]}),Be.dataChanged&&(0,T.jsxs)("span",{children:["Data: ",this.counters.dataChanged,"\xA0"]}),Be.schemaChanged&&(0,T.jsxs)("span",{children:["Schema: ",this.counters.schemaChanged,"\xA0"]}),(0,T.jsxs)("span",{children:["TIME: ",at,"ms"]})]})]}),fe.series&&fe.series.map((Dt,Ot)=>(0,T.jsxs)("div",{children:[(0,T.jsxs)("h4",{children:[(0,Ea.Ri)(Dt,Ot)," (",Dt.length,")"]}),(0,T.jsxs)("table",{className:"filter-table",children:[(0,T.jsx)("thead",{children:(0,T.jsxs)("tr",{children:[(0,T.jsx)("td",{children:"Field"}),(0,T.jsx)("td",{children:"Type"}),(0,T.jsx)("td",{children:"Last"})]})}),(0,T.jsx)("tbody",{children:Dt.fields.map((wt,_t)=>{const Qt=it.reduce(wt,!1,!1)[it.id];return(0,T.jsxs)("tr",{children:[(0,T.jsx)("td",{children:(0,Ea.Ct)(wt,Dt,fe.series)}),(0,T.jsx)("td",{children:wt.type}),(0,T.jsx)("td",{children:`${Qt}`})]},`${_t}/${wt.name}`)})})]})]},`${Ot}/${Dt.refId}`))]})}}var To=e(88575),aa=e(10354);function Wu(Q){const fe=(0,hr.d2)(),be=Be=>{fe.onInstanceStateChange({name:Be.currentTarget.value})};return(0,T.jsx)(T.Fragment,{children:(0,T.jsx)(To.D,{label:"State name",children:(0,T.jsx)(aa.p,{value:fe.instanceState?.name??"",onChange:be})})})}function Fu({value:Q,context:fe,onChange:be,item:Be}){return(0,T.jsxs)("div",{children:["Current value: ",fe.instanceState?.name," "]})}var qr=(Q=>(Q.Cursor="cursor",Q.Events="events",Q.Render="render",Q.State="State",Q.ThrowError="ThrowError",Q))(qr||{});class hc extends K.Component{render(){const{options:fe}=this.props;switch(fe.mode){case qr.Events:return(0,T.jsx)(Ui,{eventBus:this.props.eventBus});case qr.Cursor:return(0,T.jsx)(Bi,{eventBus:this.props.eventBus});case qr.State:return(0,T.jsx)(Wu,{...this.props});case qr.ThrowError:throw new Error("I failed you and for that i am deeply sorry");default:return(0,T.jsx)(_r,{...this.props})}}}const Ku=new C.m(hc).useFieldConfig().setPanelOptions(Q=>{Q.addSelect({path:"mode",name:"Mode",defaultValue:qr.Render,settings:{options:[{label:"Render",value:qr.Render},{label:"Events",value:qr.Events},{label:"Cursor",value:qr.Cursor},{label:"Cursor",value:qr.Cursor},{label:"Share state",value:qr.State},{label:"Throw error",value:qr.ThrowError}]}}).addCustomEditor({id:"stateView",path:"stateView",name:"State view",defaultValue:"",showIf:({mode:fe})=>fe===qr.State,editor:Fu}).addBooleanSwitch({path:"counters.render",name:"Render count",defaultValue:!0,showIf:({mode:fe})=>fe===qr.Render}).addBooleanSwitch({path:"counters.dataChanged",name:"Data changed count",defaultValue:!0,showIf:({mode:fe})=>fe===qr.Render}).addBooleanSwitch({path:"counters.schemaChanged",name:"Schema changed count",defaultValue:!0,showIf:({mode:fe})=>fe===qr.Render}).addDashboardPicker({path:"dashboardUID",name:"Dashboard",settings:{placeholder:"Select dashboard",isClearable:!0}})});var fc=e(76365),dd=e(85194);function Nl(Q,fe={}){(0,ns.rR)(`grafana_flamegraph_${Q}`,{app:O.Jk.Unknown,grafana_version:I.$.buildInfo.version,...fe})}const $u=Q=>{const fe=(0,fc.oA)(Q.data.series[0]);return fe?(0,T.jsx)(ys.a,{panelId:Q.id,data:Q.data,message:(0,fc.Ik)(fe)}):(0,T.jsx)(dd.A,{data:Q.data.series[0],stickyHeader:!1,getTheme:()=>I.$.theme2,showFlameGraphOnly:Q.options?.showFlameGraphOnly??!1,onTableSymbolClick:()=>Nl("table_item_selected"),onViewSelected:be=>Nl("view_selected",{view:be}),onTextAlignSelected:be=>Nl("text_align_selected",{align:be}),onTableSort:be=>Nl("table_sort_selected",{sort:be})})};class Vu{getListWithDefaults(fe){return fe.getListAppender({name:ss.m.FlameGraph,pluginId:"flamegraph"})}getSuggestionsForData(fe){if(!fe.data)return;const be=fe.data.series[0];!be||(0,fc.oA)(be)||this.getListWithDefaults(fe).append({name:ss.m.FlameGraph})}}const _u=new C.m($u).setSuggestionsSupplier(new Vu);var zu=e(14738),Hu=e(62930);const zr=(Q,fe)=>{const be="linear-gradient(to right, #5182CC 0%, #245BAF 100%)",Be=fe?be:"linear-gradient(to right, #f05a28 0%, #fbca0a 100%)",He=fe?be:"linear-gradient(to right, #FBCA0A 0%, #F05A28 100%)",at=Q.isDark?Be:He;return`
      background-color: ${Q.colors.background.secondary};
      margin-right: ${Q.spacing(4)};
      border: 1px solid ${Q.colors.border.weak};
      border-bottom-left-radius: ${Q.shape.borderRadius(2)};
      border-bottom-right-radius: ${Q.shape.borderRadius(2)};
      position: relative;
      max-height: 230px;

      ${Q.breakpoints.down("xxl")} {
        margin-right: ${Q.spacing(2)};
      }
      &::before {
        display: block;
        content: ' ';
        position: absolute;
        left: 0;
        right: 0;
        height: 2px;
        top: 0;
        background-image: ${at};
      }
`},ud=(0,te.css)`
  padding: 16px;
`,gc=({card:Q})=>{const fe=(0,ee.of)(hd,Q.done);return(0,T.jsxs)("div",{className:fe.card,children:[(0,T.jsx)("div",{className:ud,children:(0,T.jsxs)("a",{href:`${Q.href}?utm_source=grafana_gettingstarted`,className:fe.url,onClick:()=>(0,ns.rR)("grafana_getting_started_docs",{title:Q.title,link:Q.href}),children:[(0,T.jsx)("div",{className:fe.heading,children:Q.done?"complete":Q.heading}),(0,T.jsx)("h4",{className:fe.title,children:Q.title})]})}),(0,T.jsxs)("a",{href:`${Q.learnHref}?utm_source=grafana_gettingstarted`,className:fe.learnUrl,target:"_blank",rel:"noreferrer",onClick:()=>(0,ns.rR)("grafana_getting_started_docs",{title:Q.title,link:Q.learnHref}),children:["Learn how in the docs ",(0,T.jsx)(H.I,{name:"external-link-alt"})]})]})},hd=(Q,fe)=>({card:(0,te.css)`
      ${zr(Q,fe)}

      min-width: 230px;

      ${Q.breakpoints.down("md")} {
        min-width: 192px;
      }
    `,heading:(0,te.css)`
      text-transform: uppercase;
      color: ${fe?Q.v1.palette.blue95:"#FFB357"};
      margin-bottom: ${Q.spacing(2)};
    `,title:(0,te.css)`
      margin-bottom: ${Q.spacing(2)};
    `,url:(0,te.css)`
      display: inline-block;
    `,learnUrl:(0,te.css)`
      border-top: 1px solid ${Q.colors.border.weak};
      position: absolute;
      bottom: 0;
      padding: 8px 16px;
      width: 100%;
    `});var wl=e(33390);const _o=({card:Q})=>{const fe=(0,ee.of)(Wl,Q.done);return(0,T.jsx)("a",{className:fe.card,target:"_blank",rel:"noreferrer",href:`${Q.href}?utm_source=grafana_gettingstarted`,onClick:be=>ku(be,Q),children:(0,T.jsxs)("div",{className:ud,children:[(0,T.jsx)("div",{className:fe.type,children:Q.type}),(0,T.jsx)("div",{className:fe.heading,children:Q.done?"complete":Q.heading}),(0,T.jsx)("h4",{className:fe.cardTitle,children:Q.title}),(0,T.jsx)("div",{className:fe.info,children:Q.info})]})})},ku=(Q,fe)=>{wl.A.get(fe.key)||wl.A.set(fe.key,!0),(0,ns.rR)("grafana_getting_started_tutorial",{title:fe.title})},Wl=(Q,fe)=>({card:(0,te.css)`
      ${zr(Q,fe)}
      width: 460px;
      min-width: 460px;

      ${Q.breakpoints.down("xl")} {
        min-width: 368px;
      }

      ${Q.breakpoints.down("lg")} {
        min-width: 272px;
      }
    `,type:(0,te.css)`
      color: ${Q.colors.primary.text};
      text-transform: uppercase;
    `,heading:(0,te.css)`
      text-transform: uppercase;
      color: ${Q.colors.primary.text};
      margin-bottom: ${Q.spacing(1)};
    `,cardTitle:(0,te.css)`
      margin-bottom: ${Q.spacing(2)};
    `,info:(0,te.css)`
      margin-bottom: ${Q.spacing(2)};
    `,status:(0,te.css)`
      display: flex;
      justify-content: flex-end;
    `}),fd=({step:Q})=>{const fe=(0,ee.of)(Gu);return(0,T.jsxs)("div",{className:fe.setup,children:[(0,T.jsxs)("div",{className:fe.info,children:[(0,T.jsx)("h2",{className:fe.title,children:Q.title}),(0,T.jsx)("p",{children:Q.info})]}),(0,T.jsx)("div",{className:fe.cards,children:Q.cards.map((be,Be)=>{const He=`${be.title}-${Be}`;return be.type==="tutorial"?(0,T.jsx)(_o,{card:be},He):(0,T.jsx)(gc,{card:be},He)})})]})},Gu=Q=>({setup:(0,te.css)({display:"flex",width:"95%"}),info:(0,te.css)({width:"172px",marginRight:"5%",[Q.breakpoints.down("xxl")]:{marginRight:Q.spacing(4)},[Q.breakpoints.down("sm")]:{display:"none"}}),title:(0,te.css)({color:Q.v1.palette.blue95}),cards:(0,te.css)({overflowX:"auto",overflowY:"hidden",width:"100%",display:"flex",justifyContent:"flex-start"})});var ir=e(31193);const pc="Grafana fundamentals",Wa="Create users and teams",wn="getting.started.",mc=`${wn}${pc.replace(" ","-").trim().toLowerCase()}`,vc=`${wn}${Wa.replace(" ","-").trim().toLowerCase()}`,Qu=()=>[{heading:"Welcome to Grafana",subheading:"The steps below will guide you to quickly finish setting up your Grafana installation.",title:"Basic",info:"The steps below will guide you to quickly finish setting up your Grafana installation.",done:!1,cards:[{type:"tutorial",heading:"Data source and dashboards",title:pc,info:"Set up and understand Grafana if you have no prior experience. This tutorial guides you through the entire process and covers the \u201CData source\u201D and \u201CDashboards\u201D steps to the right.",href:"https://grafana.com/tutorials/grafana-fundamentals",icon:"grafana",check:()=>Promise.resolve(wl.A.get(mc)),key:mc,done:!1},{type:"docs",title:"Add your first data source",heading:"data sources",icon:"database",learnHref:"https://grafana.com/docs/grafana/latest/features/datasources/add-a-data-source",href:"datasources/new",check:()=>new Promise(Q=>{Q((0,ir.tR)().getMetricSources().filter(fe=>fe.meta.builtIn!==!0).length>0)}),done:!1},{type:"docs",heading:"dashboards",title:"Create your first dashboard",icon:"apps",href:"dashboard/new",learnHref:"https://grafana.com/docs/grafana/latest/guides/getting_started/#create-a-dashboard",check:async()=>(await(0,ft.AI)().search({limit:1})).length>0,done:!1}]},{heading:"Setup complete!",subheading:"All necessary steps to use Grafana are done. Now tackle advanced steps or make the best use of this home dashboard \u2013 it is, after all, a fully customizable dashboard \u2013 and remove this panel.",title:"Advanced",info:" Manage your users and teams and add plugins. These steps are optional",done:!1,cards:[{type:"tutorial",heading:"Users",title:"Create users and teams",info:"Learn to organize your users in teams and manage resource access and roles.",href:"https://grafana.com/tutorials/create-users-and-teams",icon:"users-alt",key:vc,check:()=>Promise.resolve(wl.A.get(vc)),done:!1},{type:"docs",heading:"plugins",title:"Find and install plugins",learnHref:"https://grafana.com/docs/grafana/latest/plugins/installation",href:"plugins",icon:"plug",check:async()=>{const Q=await(0,ft.AI)().get("/api/plugins",{embedded:0,core:0});return Promise.resolve(Q.length>0)},done:!1}]}];class Yu extends K.PureComponent{constructor(){super(...arguments),this.state={checksDone:!1,currentStep:0,steps:Qu()},this.onForwardClick=()=>{(0,ns.rR)("grafana_getting_started_button_to_advanced_tutorials"),this.setState(fe=>({currentStep:fe.currentStep+1}))},this.onPreviousClick=()=>{(0,ns.rR)("grafana_getting_started_button_to_basic_tutorials"),this.setState(fe=>({currentStep:fe.currentStep-1}))},this.dismiss=()=>{const{id:fe}=this.props,be=(0,Ye.UA)().getCurrent(),Be=be?.getPanelById(fe);(0,ns.rR)("grafana_getting_started_remove_panel"),be?.removePanel(Be),ft.IB.put("/api/user/helpflags/1",void 0,{showSuccessAlert:!1}).then(He=>{Xo.TP.user.helpFlags1=He.helpFlags1})}}async componentDidMount(){const{steps:fe}=this.state,be=fe.map(async He=>{const at=He.cards.map(async Dt=>Dt.check().then(Ot=>({...Dt,done:Ot}))),it=await Promise.all(at);return{...He,done:it.every(Dt=>Dt.done),cards:it}}),Be=await Promise.all(be);this.setState({currentStep:Be[0].done?1:0,steps:Be,checksDone:!0})}render(){const{checksDone:fe,currentStep:be,steps:Be}=this.state,He=Ju(),at=Be[be];return(0,T.jsx)("div",{className:He.container,children:fe?(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(A.$n,{variant:"secondary",fill:"text",className:He.dismiss,onClick:this.dismiss,children:"Remove this panel"}),be===Be.length-1&&(0,T.jsx)(A.$n,{className:(0,te.cx)(He.backForwardButtons,He.previous),onClick:this.onPreviousClick,"aria-label":"To basic tutorials",icon:"angle-left",variant:"secondary"}),(0,T.jsx)("div",{className:He.content,children:(0,T.jsx)(fd,{step:at})}),be<Be.length-1&&(0,T.jsx)(A.$n,{className:(0,te.cx)(He.backForwardButtons,He.forward),onClick:this.onForwardClick,"aria-label":"To advanced tutorials",icon:"angle-right",variant:"secondary"})]}):(0,T.jsxs)("div",{className:He.loading,children:[(0,T.jsx)("div",{className:He.loadingText,children:"Checking completed setup steps"}),(0,T.jsx)(Hu.y,{size:"xl",inline:!0})]})})}}const Ju=(0,an.N)(()=>{const Q=I.$.theme2;return{container:(0,te.css)({display:"flex",flexDirection:"column",height:"100%",backgroundSize:"cover",padding:`${Q.spacing(4)} ${Q.spacing(2)} 0`}),content:(0,te.css)({label:"content",display:"flex",justifyContent:"center",[Q.breakpoints.down("xxl")]:{marginLeft:Q.spacing(3),justifyContent:"flex-start"}}),header:(0,te.css)({label:"header",marginBottom:Q.spacing(3),display:"flex",flexDirection:"column",[Q.breakpoints.down("lg")]:{flexDirection:"row"}}),headerLogo:(0,te.css)({height:"58px",paddingRight:Q.spacing(2),display:"none",[Q.breakpoints.up("md")]:{display:"block"}}),heading:(0,te.css)({label:"heading",marginRight:Q.spacing(3),marginBottom:Q.spacing(3),flexGrow:1,display:"flex",[Q.breakpoints.up("md")]:{marginBottom:0}}),backForwardButtons:(0,te.css)({position:"absolute",top:"50%",transform:"translateY(-50%)"}),previous:(0,te.css)({left:"10px",[Q.breakpoints.down("md")]:{left:0}}),forward:(0,te.css)({right:"10px",[Q.breakpoints.down("md")]:{right:0}}),dismiss:(0,te.css)({alignSelf:"flex-end",textDecoration:"underline",marginBottom:Q.spacing(1)}),loading:(0,te.css)({display:"flex",justifyContent:"center",alignItems:"center",height:"100%"}),loadingText:(0,te.css)({marginRight:Q.spacing(1)})}}),Fl=new C.m(Yu).setNoPadding();var Br=e(77678),yc=e(56675),gi=e(97706);const ml={bucketCount:30,bucketOffset:0},Kl={fillOpacity:80,gradientMode:ut.on.None,lineWidth:1};function gd(Q,fe){return Math.floor(Q/fe)*fe}function pd(Q,fe){return Math.ceil(Q/fe)*fe}function md(Q){return Q.fields[0].type===jt.PU.string?1:(0,gi.h)(Q.fields[1].values[0]-Q.fields[0].values[0],9)}function Xu(Q){return Q.fields[0].type===jt.PU.string?1:(0,gi.h)(Q.fields[1].values[1]-Q.fields[0].values[1],9)}const Zu=(Q,fe)=>{let{min:be,max:Be}=Q.fields[2].config,He=new gs.e,at=Q.fields[0].type===jt.PU.string,it=md(Q),Dt=Xu(Q),Ot=Dt/it,wt=Dt!==it,_t=(Bn,un,bn,Us,us,Ts)=>{let zn=Bn.axes[un]._space,On=Bn.valToPos(Bn.data[0][0]+it,"x")-Bn.valToPos(Bn.data[0][0],"x"),fs=gd(be??Bn.data[0][0],it),Hn=pd(Be??Bn.data[0][Bn.data[0].length-1]+it,it),ps=[],ks=Math.ceil(zn/On);for(let Xs=0,ia=fs;ia<=Hn;Xs++,ia+=it)!(Xs%ks)&&ps.push(ia);return ps};He.addScale({scaleKey:"x",isTime:!1,distribution:at?ut.L4.Ordinal:wt?ut.L4.Log:ut.L4.Linear,log:2,orientation:ut.Lt.Horizontal,direction:ut.ON.Right,range:wt?(Bn,un,bn)=>Va.A.rangeLog(un,bn*Ot,2,!0):(Bn,un,bn)=>{be!=null&&(un=be),Be!=null&&(bn=Be);let Us=Bn.data[0][Bn.data[0].length-1];return un=pd(un,it),bn=!at&&bn===Us?bn+it:gd(bn,it),[un,bn]}}),He.addScale({scaleKey:"y",isTime:!1,distribution:ut.L4.Linear,orientation:ut.Lt.Vertical,direction:ut.ON.Up,softMin:0});const Qt=Q.fields[0].display,rn=Bn=>(0,Ln.cN)(Qt(Bn));He.addAxis({scaleKey:"x",isTime:!1,placement:ut.vM.Bottom,incrs:at?[1]:wt?void 0:Br.rW,splits:wt||at?void 0:_t,values:at?(Bn,un)=>un:(Bn,un)=>{const bn=un.map(rn),Us=bn.reduce((On,fs)=>Math.max((0,Ps.kD)(fs,es.pi).width,On),0),Ts=Bn.bbox.width/((Us+10)*devicePixelRatio),zn=Math.ceil(bn.length/Ts);return bn.map((On,fs)=>fs%zn===0?On:null)},theme:fe});let pn=Q.fields[2].display;He.addAxis({scaleKey:"y",isTime:!1,placement:ut.vM.Left,formatValue:(Bn,un)=>(0,Ln.cN)(pn(Bn,un)),theme:fe}),He.setCursor({points:{show:!1},drag:{x:!0,y:!1,setScale:!0}});let _n=(0,ga.ro)(vd(Q));He.setStackingGroups(_n);let An=Va.A.paths.bars({align:1,size:[1,1/0]}),$n=0;for(let Bn=2;Bn<Q.fields.length;Bn++){const un=Q.fields[Bn];un.state=un.state??{},un.state.seriesIndex=$n++;const bn={...Kl,...un.config.custom},Us="y",us=(0,nr.Qi)(un),zn=(0,nr.lz)(un,fe).color;He.addSeries({scaleKey:Us,lineWidth:bn.lineWidth,lineColor:zn,fillOpacity:bn.fillOpacity,theme:fe,colorMode:us,pathBuilder:An,show:!bn.hideFrom?.viz,gradientMode:bn.gradientMode,thresholds:un.config.thresholds,hardMin:un.config.min,hardMax:un.config.max,softMin:bn.axisSoftMin,softMax:bn.axisSoftMax,dataFrameFieldIndex:un.state.origin})}return He},vd=Q=>({...Q,fields:Q.fields.filter(fe=>fe.name!==Br.dA)}),qu=(Q,fe)=>{for(let be=1;be<fe.fields.length;be++){let Be=fe.fields[be].values;for(let He=0;He<Be.length;He++)Be[He]===0&&(Be[He]=null)}return(0,ga.bq)(fe,Q.getStackingGroups())};class eh extends K.Component{constructor(fe){super(fe),this.state=this.prepState(fe)}prepState(fe,be=!0){const{alignedFrame:Be}=fe,He=be?Zu(Be,this.props.theme):this.state.config,at=vd(Be),it=qu(He,at);return{alignedFrame:Be,alignedData:it,config:He,xMinOnlyFrame:at}}renderLegend(fe){const{legend:be}=this.props;if(!fe||be.showLegend===!1)return null;const Be=this.props.options.combine?[this.props.alignedFrame]:this.props.rawSeries;return(0,T.jsx)(Uo.$,{data:Be,config:fe,maxHeight:"35%",maxWidth:"60%",...be})}componentDidUpdate(fe){const{structureRev:be,alignedFrame:Be,bucketSize:He,bucketCount:at}=this.props;if(Be!==fe.alignedFrame){const it=this.state.config==null||at!==fe.bucketCount||He!==fe.bucketSize||this.props.options!==fe.options||this.state.config===void 0||be!==fe.structureRev||!be,Dt=this.prepState(this.props,it);this.setState(Dt)}}render(){const{width:fe,height:be,children:Be,alignedFrame:He}=this.props,{config:at}=this.state;return at?(0,T.jsx)(_s.KU,{width:fe,height:be,legend:this.renderLegend(at),children:(it,Dt)=>(0,T.jsx)(ca.Z,{config:this.state.config,data:this.state.alignedData,width:it,height:Dt,children:Be?Be(at,He,this.state.xMinOnlyFrame):null})}):null}}var yd=e(11389),xd=e(58749),Ed=e(52415),xc=e(10875),Dd=e(21164);const th=({series:Q,xMinOnlyFrame:fe,dataIdxs:be,seriesIdx:Be,mode:He=ut.$N.Single,sortOrder:at=ut.xB.None,isPinned:it,maxHeight:Dt})=>{const Ot=(0,ee.of)(nh),wt=Q.fields[0],_t=Q.fields[1],{display:Qt}=wt.config.unit!=null?wt:_t,{display:rn}=_t.config.unit!=null?_t:wt,kt=(0,Ln.cN)(Qt(wt.values[be[0]])),pn=(0,Ln.cN)(rn(_t.values[be[1]])),_n=wt.config.custom?.hideFrom?.tooltip?null:{label:"Bucket",value:`${kt} - ${pn}`},An=(0,K.useMemo)(()=>(0,xc.cp)(fe.fields,wt,be,Be,He,at),[fe.fields,wt,be,Be,He,at]);let $n;if(it&&Be!=null){const Bn=Q.fields[Be],un=be[Be],bn=(0,Dd.u)(Bn,un);$n=(0,T.jsx)(xd.S,{dataLinks:bn})}return(0,T.jsxs)("div",{className:Ot.wrapper,children:[_n!=null&&(0,T.jsx)(Ed.A,{item:_n,isPinned:it}),(0,T.jsx)(yd.o,{items:An,isPinned:it,scrollable:(0,Gn.T5)({mode:He,maxHeight:Dt}),maxHeight:Dt}),$n]})},nh=()=>({wrapper:(0,te.css)({display:"flex",flexDirection:"column"})}),sh=({data:Q,options:fe,width:be,height:Be})=>{const He=(0,ee.$j)(),at=(0,K.useMemo)(()=>{if(!Q.series.length)return;if(Q.series.forEach((Ot,wt)=>{Ot.fields.forEach((_t,Qt)=>{_t.state={..._t.state,origin:{frameIndex:wt,fieldIndex:Qt}}})}),Q.series.length===1){const Ot=(0,Br.ix)(Q.series[0]);if(Ot)return(0,Br.cg)(Ot)}const Dt=(0,Br.p3)(Q.series,fe);if(Dt)return(0,Br.cg)(Dt,He)},[Q.series,fe,He]);if(!at||!at.fields.length)return(0,T.jsx)("div",{className:"panel-empty",children:(0,T.jsx)("p",{children:"No histogram found in response"})});const it=md(at);return(0,T.jsx)(eh,{options:fe,theme:He,legend:fe.legend,rawSeries:Q.series,structureRev:Q.structureRev,width:be,height:Be,alignedFrame:at,bucketSize:it,bucketCount:fe.bucketCount,children:(Dt,Ot,wt)=>(0,T.jsx)(T.Fragment,{children:fe.tooltip.mode!==ut.$N.None&&(0,T.jsx)(Ks.xl,{config:Dt,hoverMode:fe.tooltip.mode===ut.$N.Single?Ks.b3.xOne:Ks.b3.xAll,render:(_t,Qt,rn,kt=!1)=>(0,T.jsx)(th,{series:at,xMinOnlyFrame:wt,dataIdxs:Qt,seriesIdx:rn,mode:fe.tooltip.mode,sortOrder:fe.tooltip.sort,isPinned:kt,maxHeight:fe.tooltip.maxHeight}),maxWidth:fe.tooltip.maxWidth})})})},vl={stacking:{mode:ut.gs.None,group:"A"}},Pd=(Q,fe,be,Be)=>{if(fe==="graph"&&be.angular.xaxis?.mode==="histogram"){const{fieldConfig:at,options:it}=ah({...be.angular,fieldConfig:Be});return Q.fieldConfig=at,it}return{}};function ah(Q){const fe=Q;let be={};const Be={legend:{displayMode:ut.lm.List,showLegend:!0,placement:"bottom",calcs:[]},tooltip:{mode:ut.$N.Single,sort:ut.xB.None},combine:!1};return fe.stack&&(be.stacking={mode:fe.percentage?ut.gs.Percent:ut.gs.Normal,group:vl.stacking.group},Be.combine=!1),{fieldConfig:{defaults:(0,B.omitBy)({custom:be},B.isNil),overrides:[]},options:Be}}function Zo(Q){if(Q?.length!==1)return!1;const fe=Q[0];if(fe.fields.length<3||!(0,Br.NX)(fe.fields[0].name)||!(0,Br.H1)(fe.fields[1].name))return!1;for(const be of fe.fields)if(be.type!==jt.PU.number)return!1;return!0}const rh=new C.m(sh).setPanelChangeHandler(Pd).setPanelOptions(Q=>{Q.addCustomEditor({id:"__calc__",path:"__calc__",name:"Values",description:"Showing frequencies that are calculated in the query",editor:()=>null,showIf:(fe,be)=>Zo(be)}).addNumberInput({path:"bucketCount",name:Br.Rt.bucketCount.name,description:Br.Rt.bucketCount.description,settings:{placeholder:`Default: ${ml.bucketCount}`,min:0},showIf:(fe,be)=>!Zo(be)}).addNumberInput({path:"bucketSize",name:Br.Rt.bucketSize.name,description:Br.Rt.bucketSize.description,settings:{placeholder:"Auto",min:0},defaultValue:ml.bucketSize,showIf:(fe,be)=>!Zo(be)}).addNumberInput({path:"bucketOffset",name:Br.Rt.bucketOffset.name,description:Br.Rt.bucketOffset.description,settings:{placeholder:`Default: ${ml.bucketOffset}`,min:0},showIf:(fe,be)=>!Zo(be)}).addBooleanSwitch({path:"combine",name:Br.Rt.combine.name,description:Br.Rt.combine.description,defaultValue:ml.combine,showIf:(fe,be)=>!Zo(be)}),Qn.D(Q),Fn.H(Q)}).useFieldConfig({standardOptions:{[Wn.uo.Color]:{settings:{byValueSupport:!1,bySeriesSupport:!0,preferThresholdsMode:!1},defaultValue:{mode:Nn.Y.PaletteClassic}}},useCustomConfig:Q=>{const fe=Kl;Q.addCustomEditor({id:"stacking",path:"stacking",name:"Stacking",category:["Histogram"],defaultValue:vl.stacking,editor:yc.m,override:yc.m,settings:{options:Zt.t.stacking},process:Tt.hS,shouldApply:be=>be.type===jt.PU.number,showIf:(be,Be)=>!Zo(Be)}).addSliderInput({path:"lineWidth",name:"Line width",defaultValue:fe.lineWidth,settings:{min:0,max:10,step:1}}).addSliderInput({path:"fillOpacity",name:"Fill opacity",defaultValue:fe.fillOpacity,settings:{min:0,max:100,step:1}}).addRadio({path:"gradientMode",name:"Gradient mode",defaultValue:Zt.t.fillGradient[0].value,settings:{options:Zt.t.fillGradient}}),Xn.e(Q)}});var eo=e(55004),yl=e(60029),oh=e(39408);const wr=[{label:"Grafana",value:eo.qD.Grafana,description:"Core grafana live features"},{label:"Data Sources",value:eo.qD.DataSource,description:"Data sources with live support"},{label:"Plugins",value:eo.qD.Plugin,description:"Plugins with live support"},{label:"Stream",value:eo.qD.Stream,description:"data streams (eg, influx style)"}];function ih(Q){const[fe,be]=(0,K.useState)([]),[Be,He]=(0,K.useMemo)(()=>{const rn=[],kt=[],pn=Q.value.scope,_n=Q.value.namespace;if(!pn?.length)return[rn,kt];const An={};for(let $n of fe){const Bn=(0,eo.DG)($n.value);!Bn||Bn.scope!==pn||(An[Bn.namespace]||(rn.push({value:Bn.namespace,label:Bn.namespace}),An[Bn.namespace]=!0),_n?.length&&_n===Bn.namespace&&kt.push({...$n,value:Bn.path}))}return[rn,kt]},[fe,Q.value.scope,Q.value.namespace]);(0,K.useEffect)(()=>{(0,oh.l)().then(rn=>{be(rn.channels)})},[Q.value.scope]);const at=rn=>{rn.value&&Q.onChange({scope:rn.value,namespace:void 0,path:void 0})},it=rn=>{Q.onChange({scope:Q.value?.scope,namespace:rn?.value,path:void 0})},Dt=rn=>{const{value:kt,onChange:pn}=Q;pn({scope:kt.scope,namespace:kt.namespace,path:rn?.value})},{scope:Ot,namespace:wt,path:_t}=Q.value,Qt=ch(ce.config.theme2);return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(oe.F,{title:"Grafana Live",severity:"info",children:"This supports real-time event streams in grafana core. This feature is under heavy development. Expect the intefaces and structures to change as this becomes more production ready."}),(0,T.jsxs)("div",{children:[(0,T.jsxs)("div",{className:Qt.dropWrap,children:[(0,T.jsx)(yl.J,{children:"Scope"}),(0,T.jsx)(V.l6,{options:wr,value:wr.find(rn=>rn.value===Ot),onChange:at})]}),Ot&&(0,T.jsxs)("div",{className:Qt.dropWrap,children:[(0,T.jsx)(yl.J,{children:"Namespace"}),(0,T.jsx)(V.l6,{options:Be,value:Be.find(rn=>rn.value===wt)??(wt?{label:wt,value:wt}:void 0),onChange:it,allowCustomValue:!0,backspaceRemovesValue:!0,isClearable:!0})]}),Ot&&wt&&(0,T.jsxs)("div",{className:Qt.dropWrap,children:[(0,T.jsx)(yl.J,{children:"Path"}),(0,T.jsx)(V.l6,{options:He,value:lh(He,_t),onChange:Dt,allowCustomValue:!0,backspaceRemovesValue:!0,isClearable:!0})]})]})]})}function lh(Q,fe){const be=Q.find(Be=>Be.value===fe);if(be)return be;if(fe)return{label:fe,value:fe}}const ch=(0,an.N)(Q=>({dropWrap:(0,te.css)`
    margin-bottom: ${Q.spacing(1)};
  `}));var Ep=e(9631),dh=e(90708),bd=e(39070),pi=e(78731),uh=e(24022),wi=e(94624),mi=e(1173),hh=e(77093),$l=e(65885);function Cd(Q){const{data:fe,height:be,width:Be,options:He,fieldConfig:at,id:it,timeRange:Dt}=Q,Ot=(0,ee.$j)(),wt=(0,hr.d2)(),_t=(0,$l.gy)(fe.series)?(0,$l.S5)(fe.series):fe.series,Qt=_t?.length,rn=_t.some(un=>un.fields.length>0),kt=fh(_t,He),pn=_t[kt];let _n=be;if(!Qt||!rn)return(0,T.jsx)(ys.a,{panelId:it,fieldConfig:at,data:fe});if(Qt>1){const un=Ot.spacing.gridSize*Ot.components.height.md,bn=Ot.spacing.gridSize;_n=be-un-bn}const An=wt.sync&&wt.sync()!==wi.y.Off,$n=(0,T.jsx)(hh.X,{height:_n,width:Be,data:pn,noHeader:!He.showHeader,showTypeIcons:He.showTypeIcons,resizable:!0,initialSortBy:He.sortBy,onSortByChange:un=>ph(un,Q),onColumnResize:(un,bn)=>gh(un,bn,Q),onCellFilterAdded:wt.onAddAdHocFilter,footerOptions:He.footer,enablePagination:He.footer?.enablePagination,cellHeight:He.cellHeight,timeRange:Dt,enableSharedCrosshair:I.$.featureToggles.tableSharedCrosshair&&An,fieldConfig:at});if(Qt===1)return $n;const Bn=_t.map((un,bn)=>({label:(0,Ea.Ri)(un),value:bn}));return(0,T.jsxs)("div",{className:Td.wrapper,children:[$n,(0,T.jsx)("div",{className:Td.selectWrapper,children:(0,T.jsx)(V.l6,{options:Bn,value:Bn[kt],onChange:un=>mh(un,Q)})})]})}function fh(Q,fe){return fe.frameIndex>0&&fe.frameIndex<Q.length?fe.frameIndex:0}function gh(Q,fe,be){const{fieldConfig:Be}=be,{overrides:He}=Be,at=mi.Ct.byName,it="custom.width",Dt=He.find(Ot=>Ot.matcher.id===at&&Ot.matcher.options===Q);if(Dt){const Ot=Dt.properties.find(wt=>wt.id===it);Ot?Ot.value=fe:Dt.properties.push({id:it,value:fe})}else He.push({matcher:{id:at,options:Q},properties:[{id:it,value:fe}]});be.onFieldConfigChange({...Be,overrides:He})}function ph(Q,fe){fe.onOptionsChange({...fe.options,sortBy:Q})}function mh(Q,fe){fe.onOptionsChange({...fe.options,frameIndex:Q.value||0})}const Td={wrapper:(0,te.css)`
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    height: 100%;
  `,selectWrapper:(0,te.css)`
    padding: 8px 8px 0px 8px;
  `};var Ec=e(32372),zo=(Q=>(Q.Raw="raw",Q.JSON="json",Q.Auto="auto",Q.None="none",Q))(zo||{}),Ao=(Q=>(Q.None="none",Q.JSON="json",Q.Influx="influx",Q))(Ao||{});function vh({height:Q,mode:fe,body:be,addr:Be,onSave:He}){const at=(0,K.useMemo)(()=>fe===Ao.JSON?be?JSON.stringify(be,null,2):"{ }":be==null?"":`${be}`,[fe,be]),it=Ot=>{fe===Ao.JSON?He(JSON.parse(Ot)):He(Ot)},Dt=async()=>{if(fe===Ao.Influx){if(Be?.scope!=="stream"){alert("expected stream scope!");return}return(0,Kn.AI)().post(`api/live/push/${Be.namespace}`,be)}if(!(0,eo.aj)(Be)){alert("invalid address");return}const Ot=await(0,pi.oF)().publish(Be,be);console.log("onPublishClicked (response from publish)",Ot)};return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(Ec.B,{height:Q-32,language:fe===Ao.JSON?"json":"text",value:at,onBlur:it,onSave:it,showMiniMap:!1,showLineNumbers:!0}),(0,T.jsx)("div",{style:{height:32},children:(0,T.jsx)(A.$n,{onClick:Dt,children:"Publish"})})]})}class Bs extends K.PureComponent{constructor(fe){super(fe),this.styles=Ir(I.$.theme2),this.streamObserver={next:be=>{(0,eo.ew)(be)?this.setState({status:be,changed:Date.now()}):(0,eo.Z7)(be)?this.setState({message:be.message,changed:Date.now()}):console.log("ignore",be)}},this.unsubscribe=()=>{this.subscription&&(this.subscription.unsubscribe(),this.subscription=void 0)},this.isValid=!!(0,pi.oF)(),this.state={changed:0}}async componentDidMount(){this.loadChannel()}componentWillUnmount(){this.subscription&&this.subscription.unsubscribe()}componentDidUpdate(fe){this.props.options?.channel!==fe.options?.channel&&this.loadChannel()}async loadChannel(){const fe=this.props.options?.channel;if(!(0,eo.aj)(fe)){console.log("INVALID",fe),this.unsubscribe(),this.setState({addr:void 0});return}if((0,B.isEqual)(fe,this.state.addr)){console.log("Same channel",this.state.addr);return}const be=(0,pi.oF)();if(!be){console.log("INVALID",fe),this.unsubscribe(),this.setState({addr:void 0});return}this.unsubscribe(),console.log("LOAD",fe);try{this.subscription=be.getStream(fe).subscribe(this.streamObserver),this.setState({addr:fe,error:void 0})}catch(Be){this.setState({addr:void 0,error:Be})}}renderNotEnabled(){return(0,T.jsxs)(oe.F,{title:"Grafana Live",severity:"info",children:[(0,T.jsx)("p",{children:"Grafana live requires a feature flag to run"}),(0,T.jsx)("b",{children:"custom.ini:"}),(0,T.jsx)("pre",{children:`[feature_toggles]
    enable = live`})]})}renderMessage(fe){const{options:be}=this.props,{message:Be}=this.state;if(!Be)return(0,T.jsxs)("div",{children:[(0,T.jsx)("h4",{children:"Waiting for data:"}),be.channel?.scope,"/",be.channel?.namespace,"/",be.channel?.path]});if(be.display===zo.JSON)return(0,T.jsx)(uh.B,{json:Be,open:5});if(be.display===zo.Auto&&Be instanceof Ep.k9){const He={series:(0,dh.we)({data:[Be],theme:I.$.theme2,replaceVariables:it=>it,fieldConfig:{defaults:{},overrides:[]}}),state:bd.Gu.Streaming},at={...this.props,options:{frameIndex:0,showHeader:!0}};return(0,T.jsx)(Cd,{...at,data:He,height:fe})}return(0,T.jsx)("pre",{children:JSON.stringify(Be)})}renderPublish(fe){const{options:be}=this.props;return(0,T.jsx)(vh,{height:fe,body:be.message,mode:be.publish??Ao.JSON,onSave:Be=>this.props.onOptionsChange({...be,message:Be}),addr:this.state.addr})}renderStatus(){const{status:fe}=this.state;if(fe?.state===eo.ZF.Connected)return;let be="";return fe&&(be=this.styles.status[fe.state]),(0,T.jsx)("div",{className:(0,te.cx)(be,this.styles.statusWrap),children:fe?.state})}renderBody(){const{status:fe}=this.state,{options:be,height:Be}=this.props;if(be.publish===Ao.JSON||be.publish===Ao.Influx){if(be.display===zo.None)return this.renderPublish(Be);const at=Be/2;return(0,T.jsxs)("div",{children:[(0,T.jsx)("div",{style:{height:at,overflow:"hidden"},children:(0,T.jsx)(se.E,{autoHeightMin:"100%",autoHeightMax:"100%",children:this.renderMessage(at)})}),(0,T.jsx)("div",{children:this.renderPublish(at)})]})}return be.display===zo.None?(0,T.jsx)("pre",{children:JSON.stringify(fe)}):(0,T.jsx)("div",{style:{overflow:"hidden",height:Be},children:(0,T.jsx)(se.E,{autoHeightMin:"100%",autoHeightMax:"100%",children:this.renderMessage(Be)})})}render(){if(!this.isValid)return this.renderNotEnabled();const{addr:fe,error:be}=this.state;return fe?be?(0,T.jsxs)("div",{children:[(0,T.jsx)("h2",{children:"ERROR"}),(0,T.jsx)("div",{children:JSON.stringify(be)})]}):(0,T.jsxs)(T.Fragment,{children:[this.renderStatus(),this.renderBody()]}):(0,T.jsx)(oe.F,{title:"Grafana Live",severity:"info",children:"Use the panel editor to pick a channel"})}}const Ir=(0,an.N)(Q=>({statusWrap:(0,te.css)`
    margin: auto;
    position: absolute;
    top: 0;
    right: 0;
    background: ${Q.components.panel.background};
    padding: 10px;
    z-index: ${Q.zIndex.modal};
  `,status:{[eo.ZF.Pending]:(0,te.css)`
      border: 1px solid ${Q.v1.palette.orange};
    `,[eo.ZF.Connected]:(0,te.css)`
      border: 1px solid ${Q.colors.success.main};
    `,[eo.ZF.Connecting]:(0,te.css)`
      border: 1px solid ${Q.v1.palette.brandWarning};
    `,[eo.ZF.Disconnected]:(0,te.css)`
      border: 1px solid ${Q.colors.warning.main};
    `,[eo.ZF.Shutdown]:(0,te.css)`
      border: 1px solid ${Q.colors.error.main};
    `,[eo.ZF.Invalid]:(0,te.css)`
      border: 1px solid red;
    `}})),yh=new C.m(Bs).setPanelOptions(Q=>{Q.addCustomEditor({category:["Channel"],id:"channel",path:"channel",name:"Channel",editor:ih,defaultValue:{}}),Q.addRadio({path:"display",name:"Show message",description:"Display the last message received on this channel",settings:{options:[{value:zo.Raw,label:"Raw Text"},{value:zo.JSON,label:"JSON"},{value:zo.Auto,label:"Auto"},{value:zo.None,label:"None"}]},defaultValue:zo.JSON}).addRadio({path:"publish",name:"Publish",description:"Display a form to publish values",settings:{options:[{value:Ao.None,label:"None"},{value:Ao.JSON,label:"JSON"},{value:Ao.Influx,label:"Influx"}]},defaultValue:Ao.None})});var Xa=e(9557),Dc=e(96192),el=e(81166),xh=e(17888),Eh=e(7030),Dh=e(93463),tl=e(14647),Wi=e(69147);const Vl={displayedFields:[]};function _l(Q){return typeof Q=="function"}function Pc(Q){return typeof Q=="function"}function Ph(Q){return typeof Q=="function"}function Md(Q){return typeof Q=="function"}function bh(Q){return typeof Q=="function"}function Ch(Q){return typeof Q=="function"}function Th(Q){return typeof Q=="function"}var Sd=e(16817),Od=e(19347);const Mh=Q=>{const[fe,be]=(0,K.useState)(new Map);return(0,Sd.A)(async()=>{if(!Q){be(new Map);return}const Be=await Promise.all(Q.filter(He=>!!He.datasource?.uid).map(He=>(0,Od.l)().get(He.datasource?.uid).then(at=>({key:He.refId,ds:at}))));be(new Map(Be.map(({key:He,ds:at})=>[He,at])))},[Q]),fe},Sh={},Oh=({data:Q,timeZone:fe,fieldConfig:be,options:{showLabels:Be,showTime:He,wrapLogMessage:at,showCommonLabels:it,prettifyLogMessage:Dt,sortOrder:Ot,dedupStrategy:wt,enableLogDetails:_t,showLogContextToggle:Qt,onClickFilterLabel:rn,onClickFilterOutLabel:kt,onClickFilterOutString:pn,onClickFilterString:_n,isFilterLabelActive:An,...$n},id:Bn})=>{const un=Ot===ut.uH.Ascending,bn=(0,ee.of)(xl),[Us,us]=(0,K.useState)(0),Ts=(0,K.useRef)(null),[zn,On]=(0,K.useState)(null),fs=Q.timeRange,Hn=Mh(Q.request?.targets),[ps,ks]=(0,K.useState)(null),[Xs,ia]=(0,K.useState)($n.displayedFields??[]);let ja=(0,K.useRef)();const{eventBus:Ys,onAddAdHocFilter:xs}=(0,hr.d2)(),Os=(0,K.useCallback)(ba=>{ba&&Ys.publish(new Pn.b_({point:{time:ba.timeEpochMs}}))},[Ys]),ha=(0,K.useCallback)(()=>{Ys.publish(new Pn.ql)},[Ys]),Ha=(0,K.useCallback)(()=>{On(null),ja.current&&ja.current()},[ja]),Ws=(0,K.useCallback)((ba,Ka)=>{On(ba),ja.current=Ka},[ja]),Rs=(0,K.useCallback)(async ba=>await Ih(ba,fs),[fs]),na=(0,K.useCallback)(ba=>{if(!ba.dataFrame.refId||!Hn||!Qt&&Q.request?.app!==O.Jk.Dashboard&&Q.request?.app!==O.Jk.PanelEditor&&Q.request?.app!==O.Jk.PanelViewer)return!1;const Ka=Hn.get(ba.dataFrame.refId);return(0,Xa.Ol)(Ka)},[Hn,Qt,Q.request?.app]),ya=(0,K.useCallback)(()=>!(Q.request?.app!==O.Jk.Dashboard&&Q.request?.app!==O.Jk.PanelEditor&&Q.request?.app!==O.Jk.PanelViewer),[Q.request?.app]),da=(0,K.useCallback)(async(ba,Ka,ro)=>{if(!Ka.dataFrame.refId||!Hn)return Promise.resolve({data:[]});const go=Q.request?.targets[0];if(!go)return Promise.resolve({data:[]});const ti=Hn.get(Ka.dataFrame.refId);return(0,Xa.Ol)(ti)?ti.getLogRowContext(ba,ro,go):Promise.resolve({data:[]})},[Q.request?.targets,Hn]),Ba=(0,K.useCallback)((ba,Ka)=>{if(!ba.dataFrame.refId||!Hn)return(0,T.jsx)(T.Fragment,{});const ro=Q.request?.targets[0];if(!ro)return(0,T.jsx)(T.Fragment,{});const go=Hn.get(ba.dataFrame.refId);return(0,Xa.wj)(go)?go.getLogRowContextUi?go.getLogRowContextUi(ba,Ka,ro):(0,T.jsx)(T.Fragment,{}):(0,T.jsx)(T.Fragment,{})},[Q.request?.targets,Hn]),[Fa,fa,Ga]=(0,K.useMemo)(()=>{const ba=Q?(0,Wi.HT)(Q.series,Q.request?.intervalMs,void 0,Q.request?.targets):null,Ka=ba?.rows||[],ro=ba?.meta?.find(ti=>ti.label===Wi.yR),go=(0,Wi.M0)(Ka,wt);return[Ka,go,ro]},[Q,wt]);(0,K.useLayoutEffect)(()=>{un&&Ts.current?us(Ts.current.offsetHeight):us(0)},[un,Fa]);const Ja=(0,K.useCallback)((ba,Ka)=>(0,Dc.QL)({field:ba,rowIndex:Ka,range:Q.timeRange}),[Q]),pr=(0,K.useCallback)(ba=>{ps?.scrollTo({top:ba.offsetTop,behavior:"smooth"})},[ps]),vs=(0,K.useCallback)((ba,Ka)=>{xs?.({key:ba,value:Ka,operator:"="})},[xs]),ds=(0,K.useCallback)((ba,Ka)=>{xs?.({key:ba,value:Ka,operator:"!="})},[xs]),Ls=(0,K.useCallback)(ba=>{Xs?.indexOf(ba)===-1&&ia(Xs?.concat(ba))},[Xs]),ra=(0,K.useCallback)(ba=>{const Ka=Xs?.indexOf(ba);Ka!==void 0&&Ka>-1&&ia(Xs?.filter(ro=>ba!==ro))},[Xs]);if(!Q||Fa.length===0)return(0,T.jsx)(xh.a,{fieldConfig:be,panelId:Bn,data:Q,needsStringField:!0});const qs=()=>(0,T.jsxs)("div",{className:(0,te.cx)(bn.labelContainer,un&&bn.labelContainerAscending),children:[(0,T.jsx)("span",{className:bn.label,children:"Common labels:"}),(0,T.jsx)(Dh.h,{labels:typeof Ga?.value=="object"?Ga?.value:Sh,emptyMessage:"(no common labels)"})]}),la=xs?vs:void 0,Pa=xs?ds:void 0,br=Ch($n.onClickShowField)?$n.onClickShowField:Ls,ao=Th($n.onClickHideField)?$n.onClickHideField:ra;return(0,T.jsxs)(T.Fragment,{children:[zn&&(0,T.jsx)(el.V,{open:zn!==null,row:zn,onClose:Ha,getRowContext:(ba,Ka)=>da(ba,zn,Ka),logsSortOrder:Ot,timeZone:fe,getLogRowContextUi:Ba}),(0,T.jsx)(se.E,{autoHide:!0,scrollTop:Us,scrollRefCallback:ba=>ks(ba),children:(0,T.jsxs)("div",{onMouseLeave:ha,className:bn.container,ref:Ts,children:[it&&!un&&qs(),(0,T.jsx)(tl.k,{containerRendered:Ts.current!==null,scrollIntoView:pr,permalinkedRowId:El()?.logs?.id??void 0,onPermalinkClick:ya()?Rs:void 0,logRows:Fa,showContextToggle:na,deduplicatedRows:fa,dedupStrategy:wt,showLabels:Be,showTime:He,wrapLogMessage:at,prettifyLogMessage:Dt,timeZone:fe,getFieldLinks:Ja,logsSortOrder:Ot,enableLogDetails:_t,previewLimit:un?Fa.length:void 0,onLogRowHover:Os,app:O.Jk.Dashboard,onOpenContext:Ws,onClickFilterLabel:_l(rn)?rn:la,onClickFilterOutLabel:Pc(kt)?kt:Pa,onClickFilterString:Ph(_n)?_n:void 0,onClickFilterOutString:Md(pn)?pn:void 0,isFilterLabelActive:bh(An)?An:void 0,displayedFields:Xs,onClickShowField:Xs!==void 0?br:void 0,onClickHideField:Xs!==void 0?ao:void 0}),it&&un&&qs()]})})]})},xl=Q=>({container:(0,te.css)({marginBottom:Q.spacing(1.5)}),labelContainer:(0,te.css)({margin:Q.spacing(0,0,.5,.5),display:"flex",alignItems:"center"}),labelContainerAscending:(0,te.css)({margin:Q.spacing(.5,0,.5,0)}),label:(0,te.css)({marginRight:Q.spacing(.5),fontSize:Q.typography.bodySmall.fontSize,fontWeight:Q.typography.fontWeightMedium})});function El(){const fe=Zi.kM.getUrlSearchParams()?.panelState;if(fe&&Array.isArray(fe)&&fe?.length>0&&typeof fe[0]=="string")try{return JSON.parse(fe[0])}catch(be){console.error("error parsing logsPanelState",be)}}async function Ih(Q,fe){if(Q.rowId===void 0||!Q.dataFrame.refId)return;const be={logs:{id:Q.uid}},Be=new URL(window.location.href);return Be.searchParams.set("panelState",JSON.stringify(be)),Be.searchParams.set("from",(0,fn.yT)(fe.from).valueOf().toString(10)),Be.searchParams.set("to",(0,fn.yT)(fe.to).valueOf().toString(10)),await(0,Eh.VP)(Be.toString()),Promise.resolve()}class Ah{getSuggestionsForData(fe){const be=fe.getListAppender({name:"",pluginId:"logs",options:{},fieldConfig:{defaults:{custom:{}},overrides:[]}}),{dataSummary:Be}=fe;!Be.hasData||!Be.hasTimeField||!Be.hasStringField||(Be.preferredVisualisationType==="logs"?be.append({name:ss.m.Logs,score:Wt.nQ.Best}):be.append({name:ss.m.Logs}))}}const bc=new C.m(Oh).setPanelOptions(Q=>{Q.addBooleanSwitch({path:"showTime",name:"Time",description:"",defaultValue:!1}).addBooleanSwitch({path:"showLabels",name:"Unique labels",description:"",defaultValue:!1}).addBooleanSwitch({path:"showCommonLabels",name:"Common labels",description:"",defaultValue:!1}).addBooleanSwitch({path:"wrapLogMessage",name:"Wrap lines",description:"",defaultValue:!1}).addBooleanSwitch({path:"prettifyLogMessage",name:"Prettify JSON",description:"",defaultValue:!1}).addBooleanSwitch({path:"enableLogDetails",name:"Enable log details",description:"",defaultValue:!0}).addRadio({path:"dedupStrategy",name:"Deduplication",description:"",settings:{options:[{value:ut.fY.none,label:"None",description:Xa._C[ut.fY.none]},{value:ut.fY.exact,label:"Exact",description:Xa._C[ut.fY.exact]},{value:ut.fY.numbers,label:"Numbers",description:Xa._C[ut.fY.numbers]},{value:ut.fY.signature,label:"Signature",description:Xa._C[ut.fY.signature]}]},defaultValue:ut.fY.none}).addRadio({path:"sortOrder",name:"Order",description:"",settings:{options:[{value:ut.uH.Descending,label:"Newest first"},{value:ut.uH.Ascending,label:"Oldest first"}]},defaultValue:ut.uH.Descending})}).setSuggestionsSupplier(new Ah);var Rh=e(69386),Cc=e(62372),Lh=e(4172);function jh(Q){const{width:fe,options:{feedUrl:be=Cc.$,showImage:Be}}=Q,{state:He,getNews:at}=(0,Lh.n)(be);return(0,K.useEffect)(()=>{const it=Q.eventBus.subscribe(z._,at);return()=>{it.unsubscribe()}},[at,Q.eventBus]),(0,K.useEffect)(()=>{at()},[at]),He.error?(0,T.jsxs)(oe.F,{title:"Error loading RSS feed",children:["Make sure that the feed URL is correct and that CORS is configured correctly on the server. See"," ",(0,T.jsxs)("a",{style:{textDecoration:"underline"},href:"https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/news/",children:["News panel documentation. ",(0,T.jsx)(H.I,{name:"external-link-alt"})]})]}):He.loading?(0,T.jsx)("div",{children:"Loading..."}):He.value?(0,T.jsx)(se.E,{autoHeightMin:"100%",autoHeightMax:"100%",children:He.value.map((it,Dt)=>(0,T.jsx)(Rh.K,{index:Dt,width:fe,showImage:Be,data:He.value},Dt))}):null}const Id={showImage:!0},Bh=new C.m(jh).setPanelOptions(Q=>{Q.addTextInput({path:"feedUrl",name:"URL",description:"Supports RSS and Atom feeds",settings:{placeholder:Cc.$},defaultValue:Id.feedUrl}).addBooleanSwitch({path:"showImage",name:"Show image",description:"Controls if the news item social (og:image) image is shown above text content",defaultValue:Id.showImage})});var Uh=e(56323),Nh=e(29995),wh=e(89227),Wh=e(98361),Fh=e(33434),Kh=e(44916),$h=e(4118),Vh=e(35472),zl=e(84140),Ad=e(59796),_h=e(3139),zh=e(16797);let Hh=0;const Rd=()=>Hh++;function Hl(Q){const fe=(0,K.useRef)(null);return fe.current===null&&(fe.current=Q+Rd()),fe.current.toString()}var xo=(Q=>(Q.Donut="donut",Q.Pie="pie",Q))(xo||{}),Mo=(Q=>(Q.Name="name",Q.Percent="percent",Q.Value="value",Q))(Mo||{}),vi=(Q=>(Q.Percent="percent",Q.Value="value",Q))(vi||{});const Dp={values:[]},Pp={displayLabels:[]};function Ld(Q){return!Q.field.custom?.hideFrom?.viz&&!isNaN(Q.display.numeric)}function jd(Q,fe){return fe.display.numeric+Q}const kh=({fieldDisplayValues:Q,pieType:fe,width:be,height:Be,highlightedTitle:He,displayLabels:at=[],tooltipOptions:it})=>{const Dt=(0,ee.$j)(),Ot=Hl("PieChart"),wt=(0,ee.of)(Sc),_t=(0,$h.A)(),{containerRef:Qt,TooltipInPortal:rn}=(0,Vh.A)({detectBounds:!0,scroll:!0}),kt=Q.filter(Ld),pn=us=>us.display.numeric,_n=us=>`${Ot}-${(0,zl.A)(us).toHex()}`,An=us=>`url(#${_n(us)})`,$n=at.length>0,Bn=it.mode!=="none"&&_t.tooltipOpen,un=kt.reduce(jd,0),bn=Mc(be,Be,fe),Us=[...new Set(kt.map(us=>us.display.color??Nn.F))];return(0,T.jsxs)("div",{className:wt.container,children:[(0,T.jsx)("svg",{width:bn.size,height:bn.size,ref:Qt,style:{overflow:"visible"},children:(0,T.jsxs)(Fh.A,{top:bn.position,left:bn.position,children:[Us.map(us=>(0,T.jsx)(Wh.A,{id:_n(us),from:Yh(us,Dt),to:Jh(us,Dt),fromOffset:bn.gradientFromOffset,toOffset:"1",gradientUnits:"userSpaceOnUse",cx:0,cy:0,radius:bn.outerRadius},us)),(0,T.jsx)(Kh.A,{data:kt,pieValue:pn,outerRadius:bn.outerRadius,innerRadius:bn.innerRadius,cornerRadius:3,padAngle:.005,children:us=>(0,T.jsxs)(T.Fragment,{children:[us.arcs.map(Ts=>{const zn=Ts.data.display.color??Nn.F,On=kl(He,Ts);return Ts.data.hasLinks&&Ts.data.getLinks?(0,T.jsx)(Ad.e,{links:Ts.data.getLinks,children:fs=>(0,T.jsx)(Bd,{tooltip:_t,highlightState:On,arc:Ts,pie:us,fill:An(zn),openMenu:fs.openMenu,tooltipOptions:it})},Ts.index):(0,T.jsx)(Bd,{highlightState:On,tooltip:_t,arc:Ts,pie:us,fill:An(zn),tooltipOptions:it},Ts.index)}),$n&&us.arcs.map(Ts=>{const zn=kl(He,Ts);return(0,T.jsx)(Gh,{arc:Ts,highlightState:zn,outerRadius:bn.outerRadius,innerRadius:bn.innerRadius,displayLabels:at,total:un,color:Dt.colors.text.primary},Ts.index)})]})})]})}),Bn?(0,T.jsx)(rn,{top:_t.tooltipTop,className:wt.tooltipPortal,left:_t.tooltipLeft,unstyled:!0,applyPositionStyle:!0,children:(0,T.jsx)(_h.o,{series:_t.tooltipData})},Math.random()):null]})};function Bd({arc:Q,pie:fe,highlightState:be,openMenu:Be,fill:He,tooltip:at,tooltipOptions:it}){const Dt=(0,ee.$j)(),Ot=(0,ee.of)(Sc),{eventBus:wt}=(0,hr.d2)(),_t=(0,K.useCallback)(kt=>{wt?.publish({type:Pn.ql.type,payload:{raw:kt,x:0,y:0,dataId:Q.data.display.title}}),at.hideTooltip()},[wt,Q,at]),Qt=(0,K.useCallback)(kt=>{wt?.publish({type:Pn.b_.type,payload:{raw:kt,x:0,y:0,dataId:Q.data.display.title}});const pn=kt.currentTarget.ownerSVGElement;if(pn){const _n=(0,wh.A)(pn,kt);at.showTooltip({tooltipLeft:_n.x,tooltipTop:_n.y,tooltipData:Tc(fe,Q,it)})}},[wt,Q,at,fe,it]),rn=Ud(be,Ot);return(0,T.jsx)("g",{className:rn,onMouseMove:it.mode!=="none"?Qt:void 0,onMouseOut:_t,onClick:Be,"data-testid":rr.Tp.components.Panels.Visualization.PieChart.svgSlice,children:(0,T.jsx)("path",{d:fe.path({...Q}),fill:He,stroke:Dt.colors.background.primary,strokeWidth:1})},Q.data.display.title)}function Gh({arc:Q,outerRadius:fe,innerRadius:be,displayLabels:Be,total:He,color:at,highlightState:it}){const Dt=(0,ee.of)(Sc),Ot=be===0?fe/6:be,[wt,_t]=Qh(Q,fe,Ot);if(!(Q.endAngle-Q.startAngle>=.3))return null;let rn=Be.includes(Mo.Name)?Math.min(Math.max(fe/150*14,12),30):Math.min(Math.max(fe/100*14,12),36);return(0,T.jsx)("g",{className:Ud(it,Dt),children:(0,T.jsxs)("text",{fill:at,x:wt,y:_t,dy:".33em",fontSize:rn,fontWeight:500,textAnchor:"middle",pointerEvents:"none",children:[Be.includes(Mo.Name)&&(0,T.jsx)("tspan",{x:wt,dy:"1.2em",children:Q.data.display.title}),Be.includes(Mo.Value)&&(0,T.jsx)("tspan",{x:wt,dy:"1.2em",children:(0,Ln.cN)(Q.data.display)}),Be.includes(Mo.Percent)&&(0,T.jsx)("tspan",{x:wt,dy:"1.2em",children:(Q.data.display.numeric/He*100).toFixed(Q.data.field.decimals??0)+"%"})]})})}function Tc(Q,fe,be){return be.mode==="multi"?Q.arcs.filter(Be=>{const He=Be.data.field;return He&&!He.custom?.hideFrom?.tooltip&&!He.custom?.hideFrom?.viz}).map(Be=>({color:Be.data.display.color??Nn.F,label:Be.data.display.title,value:(0,Ln.cN)(Be.data.display),isActive:Be.index===fe.index})):[{color:fe.data.display.color??Nn.F,label:fe.data.display.title,value:(0,Ln.cN)(fe.data.display)}]}function Qh(Q,fe,be){const Be=(fe+be)/2,He=(+Q.startAngle+ +Q.endAngle)/2-Math.PI/2;return[Math.cos(He)*Be,Math.sin(He)*Be]}function Yh(Q,fe){return(0,zl.A)(Q).darken(20*(fe.isDark?1:-.7)).spin(4).toRgbString()}function Jh(Q,fe){return(0,zl.A)(Q).darken(10*(fe.isDark?1:-.7)).spin(-4).toRgbString()}function Mc(Q,fe,be,Be=16){const He=Math.min(fe,Q),at=(He-Be*2)/2,it=be===xo.Pie?at:Math.max(at/3,20),Dt=at-it,Ot=(He-Be*2)/2,wt=1-(at-Dt)/at;return{position:Ot+Be,size:He,outerRadius:at,innerRadius:Dt,gradientFromOffset:wt}}var Xh=(Q=>(Q[Q.Highlighted=0]="Highlighted",Q[Q.Deemphasized=1]="Deemphasized",Q[Q.Normal=2]="Normal",Q))(Xh||{});function kl(Q,fe){return Q?Q===fe.data.display.title?0:1:2}function Ud(Q,fe){switch(Q){case 0:return fe.svgArg.highlighted;case 1:return fe.svgArg.deemphasized;case 2:default:return fe.svgArg.normal}}const Sc=Q=>({container:(0,te.css)`
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
    `,svgArg:{normal:(0,te.css)`
        transition: all 200ms ease-in-out;
      `,highlighted:(0,te.css)`
        transition: all 200ms ease-in-out;
        transform: scale3d(1.03, 1.03, 1);
      `,deemphasized:(0,te.css)`
        transition: all 200ms ease-in-out;
        fill-opacity: 0.5;
      `},tooltipPortal:(0,te.css)`
      ${(0,zh.getTooltipContainerStyles)(Q)}
    `}),Ho={displayMode:ut.lm.List,showLegend:!0,placement:"right",calcs:[],values:[vi.Percent]};function Zh(Q){const{data:fe,timeZone:be,fieldConfig:Be,replaceVariables:He,width:at,height:it,options:Dt,id:Ot}=Q,wt=(0,ee.$j)(),_t=qh(),Qt=(0,Uh.PI)({fieldConfig:Be,reduceOptions:Dt.reduceOptions,data:fe.series,theme:wt,replaceVariables:He,timeZone:be});return Fi(Qt)?(0,T.jsx)(_s.KU,{width:at,height:it,legend:Oc(Q,Qt),children:(rn,kt)=>(0,T.jsx)(kh,{width:rn,height:kt,highlightedTitle:_t,fieldDisplayValues:Qt,tooltipOptions:Dt.tooltip,pieType:Dt.pieType,displayLabels:Dt.displayLabels})}):(0,T.jsx)(ys.a,{panelId:Ot,fieldConfig:Be,data:fe})}function Oc(Q,fe){const be=Q.options.legend??Ho;if(be.showLegend===!1)return;const Be=fe.filter(Ld).reduce(jd,0),He=fe.sort((at,it)=>isNaN(at.display.numeric)?1:isNaN(it.display.numeric)?-1:it.display.numeric-at.display.numeric).map((at,it)=>{const Dt=at.field.custom?.hideFrom??{};if(Dt.legend)return;const Ot=!!Dt.viz,wt=at.display;return{label:wt.title??"",color:wt.color??Nn.F,yAxis:1,disabled:Ot,getItemKey:()=>(wt.title??"")+it,getDisplayValues:()=>{const _t=be.values??[];let Qt=[];if(_t.includes(vi.Value)&&Qt.push({numeric:wt.numeric,text:(0,Ln.cN)(wt),title:"Value"}),_t.includes(vi.Percent)){const rn=Ot?0:wt.numeric/Be,kt=rn*100;Qt.push({numeric:rn,percent:kt,text:Ot||isNaN(rn)?Q.fieldConfig.defaults.noValue??"-":kt.toFixed(at.field.decimals??0)+"%",title:_t.length>1?"Percent":""})}return Qt}}}).filter(at=>!!at);return(0,T.jsx)(_s.KU.Legend,{placement:be.placement,width:be.width,children:(0,T.jsx)(lr.t,{items:He,seriesVisibilityChangeBehavior:Nh.K.Hide,placement:be.placement,displayMode:be.displayMode})})}function Fi(Q){return Q.some(fe=>fe.view?.dataFrame.length)}function qh(){const[Q,fe]=(0,K.useState)(),{eventBus:be}=(0,hr.d2)();return(0,K.useEffect)(()=>{const Be=it=>{fe(it.payload.dataId)},He=it=>{fe(void 0)},at=new Pt.yU;return at.add(be.getStream(Pn.b_).subscribe({next:Be})),at.add(be.getStream(Pn.ql).subscribe({next:He})),()=>{at.unsubscribe()}},[fe,be]),Q}const Ro=(Q,fe,be)=>{if(fe==="grafana-piechart-panel"&&be.angular){const Be=be.angular,He=[];let at=Q.options;if(Be.aliasColors)for(const it of Object.keys(Be.aliasColors)){const Dt=Be.aliasColors[it];Dt&&He.push({matcher:{id:mi.Ct.byName,options:it},properties:[{id:Wn.uo.Color,value:{mode:Nn.Y.Fixed,fixedColor:Dt}}]})}if(Q.fieldConfig={overrides:He,defaults:{unit:Be.format,decimals:Be.decimals?Be.decimals:0}},at.legend={placement:"right",values:[],displayMode:ut.lm.Table,showLegend:!0,calcs:[]},Be.valueName)switch(at.reduceOptions={calcs:[]},Be.valueName){case"current":at.reduceOptions.calcs=["lastNotNull"];break;case"min":at.reduceOptions.calcs=["min"];break;case"max":at.reduceOptions.calcs=["max"];break;case"avg":at.reduceOptions.calcs=["mean"];break;case"total":at.reduceOptions.calcs=["sum"];break}switch(Be.legendType){case"Under graph":at.legend.placement="bottom";break;case"Right side":at.legend.placement="right";break}switch(Be.pieType){case"pie":at.pieType=xo.Pie;break;case"donut":at.pieType=xo.Donut;break}return Be.legend&&(Be.legend.show||(at.legend.showLegend=!1),Be.legend.values&&at.legend.values.push(vi.Value),Be.legend.percentage&&at.legend.values.push(vi.Percent)),Be.legendType==="On graph"&&(at.legend.showLegend=!1,at.displayLabels=[Mo.Name],Be.legend.values&&at.displayLabels.push(Mo.Value),Be.legend.percentage&&at.displayLabels.push(Mo.Percent)),at}return{}};class bp{getSuggestionsForData(fe){const be=fe.getListAppender({name:ss.m.PieChart,pluginId:"piechart",options:{reduceOptions:{values:!1,calcs:["lastNotNull"]},displayLabels:[Mo.Percent],legend:{calcs:[],displayMode:ut.lm.Hidden,placement:"right",values:[],showLegend:!1}}}),{dataSummary:Be}=fe;if(Be.hasNumberField){if(Be.hasStringField&&Be.frameCount===1){if(Be.rowCountTotal>30||Be.rowCountTotal<2)return;be.append({name:ss.m.PieChart,options:{reduceOptions:{values:!0,calcs:[]}}}),be.append({name:ss.m.PieChartDonut,options:{reduceOptions:{values:!0,calcs:[]},pieType:xo.Donut}});return}Be.numberFieldCount>30||Be.numberFieldCount<2||(be.append({name:ss.m.PieChart}),be.append({name:ss.m.PieChartDonut,options:{pieType:xo.Donut}}))}}}const ef=new C.m(Zh).setPanelChangeHandler(Ro).useFieldConfig({disableStandardOptions:[Wn.uo.Thresholds],standardOptions:{[Wn.uo.Color]:{settings:{byValueSupport:!1,bySeriesSupport:!0,preferThresholdsMode:!1},defaultValue:{mode:Nn.Y.PaletteClassic}}},useCustomConfig:Q=>{Xn.e(Q)}}).setPanelOptions(Q=>{(0,ur.L)(Q),Q.addRadio({name:"Piechart type",description:"How the piechart should be rendered",path:"pieType",settings:{options:[{value:xo.Pie,label:"Pie"},{value:xo.Donut,label:"Donut"}]},defaultValue:xo.Pie}).addMultiSelect({name:"Labels",path:"displayLabels",description:"Select the labels to be displayed in the pie chart",settings:{options:[{value:Mo.Percent,label:"Percent"},{value:Mo.Name,label:"Name"},{value:Mo.Value,label:"Value"}]}}),Qn.D(Q),Fn.H(Q,!1),Q.addMultiSelect({name:"Legend values",path:"legend.values",category:["Legend"],settings:{options:[{value:vi.Percent,label:"Percent"},{value:vi.Value,label:"Value"}]},showIf:fe=>fe.legend.showLegend!==!1})}).setSuggestionsSupplier(new bp);var Gl=e(36373),Nd=e(11082),Ic=e(34163),wd=e(49185),Wd=e(19384),Ql=e(82389);const Ac=({series:Q,dataIdxs:fe,seriesIdx:be,mode:Be=ut.$N.Single,sortOrder:He=ut.xB.None,isPinned:at,annotate:it,timeRange:Dt,withDuration:Ot,maxHeight:wt})=>{const _t=(0,ee.of)(Zs.$),Qt=Q.fields[0],rn=be!=null?fe[be]:fe.find($n=>$n!=null),kt=Qt.display(Qt.values[rn]).text;Be=at?ut.$N.Single:Be;const pn=(0,xc.cp)(Q.fields,Qt,fe,be,Be,He);if(Ot&&Be===ut.$N.Single){const $n=Q.fields[be],Bn=(0,$a.GY)($n,rn);let un;Bn&&(un=Qt.values[Bn]);const bn=Qt.values[rn];let Us;if(un)Us=un&&(0,$a.c5)(un-bn);else{const us=Dt.to.valueOf();Us=(0,$a.c5)(us-bn)}pn.push({label:"Duration",value:Us})}let _n;if(at&&be!=null){const $n=Q.fields[be],Bn=fe[be],un=(0,Dd.u)($n,Bn);_n=(0,T.jsx)(xd.S,{dataLinks:un,annotate:it})}const An={label:Qt.type===jt.PU.time?"":Qt.state?.displayName??Qt.name,value:kt};return(0,T.jsxs)("div",{className:_t.wrapper,children:[(0,T.jsx)(Ed.A,{item:An,isPinned:at}),(0,T.jsx)(yd.o,{items:pn,isPinned:at,scrollable:(0,Gn.T5)({mode:Be,maxHeight:wt}),maxHeight:wt}),_n]})},Dl={alignValue:"left",mergeValues:!0,perPage:20,rowHeight:.9,showValue:ut.yL.Auto},Rc={fillOpacity:70,lineWidth:0},Lc={container:(0,te.css)({display:"flex",flexDirection:"column"}),paginationContainer:(0,te.css)({display:"flex",justifyContent:"center",width:"100%"}),paginationElement:(0,te.css)({marginTop:"8px"})};function Pl(Q,fe){const[be,Be]=(0,K.useState)(1),[He,{height:at,width:it}]=(0,wd.A)(),Dt=(0,K.useMemo)(()=>!fe||Q==null?Q:(0,$a.uB)(Q),[Q,fe]);if(!fe||Dt==null)return{paginatedFrames:Dt,paginationRev:"disabled",paginationElement:void 0,paginationHeight:0};fe||=Dl.perPage;const Ot=Math.ceil(Dt.length/fe),wt=Math.min(be,Ot),_t=(wt-1)*fe,Qt=Dt.slice(_t,_t+fe),rn=`${wt}/${fe}`,kt=it<550,pn=(0,T.jsx)("div",{className:Lc.paginationContainer,ref:He,children:(0,T.jsx)(Wd.d,{className:Lc.paginationElement,currentPage:wt,numberOfPages:Ot,showSmallVersion:kt,onNavigate:Be})});return{paginatedFrames:Qt,paginationRev:rn,paginationElement:pn,paginationHeight:at}}const tf=({data:Q,timeRange:fe,timeZone:be,options:Be,width:He,height:at,replaceVariables:it,onChangeTimeRange:Dt})=>{const Ot=(0,ee.$j)(),[wt,_t]=(0,K.useState)(null),{sync:Qt,eventsScope:rn,canAddAnnotations:kt,dataLinkPostProcessor:pn,eventBus:_n}=(0,hr.d2)(),An=Qt?.()??wi.y.Off,{frames:$n,warn:Bn}=(0,K.useMemo)(()=>(0,$a.Qe)(Q.series,Be.mergeValues??!0,fe,Ot),[Q.series,Be.mergeValues,fe,Ot]),{paginatedFrames:un,paginationRev:bn,paginationElement:Us,paginationHeight:us}=Pl($n,Be.perPage),Ts=(0,K.useMemo)(()=>(0,$a.Or)(un,Be.legend,Ot),[un,Be.legend,Ot]),zn=(0,K.useMemo)(()=>(0,Gn.Fg)(Be.timezone,be),[Be.timezone,be]);if(!un||Bn)return(0,T.jsx)("div",{className:"panel-empty",children:(0,T.jsx)("p",{children:Bn??"No data found in response"})});const On=!!(kt&&kt());return(0,T.jsxs)("div",{className:Lc.container,children:[(0,T.jsx)(Ql.I,{theme:Ot,frames:un,structureRev:Q.structureRev,paginationRev:bn,timeRange:fe,timeZone:zn,width:He,height:at-us,legendItems:Ts,...Be,mode:$a.pm.Changes,replaceVariables:it,dataLinkPostProcessor:pn,cursorSync:An,children:(fs,Hn)=>(0,T.jsxs)(T.Fragment,{children:[An!==wi.y.Off&&(0,T.jsx)(ho.K,{config:fs,eventBus:_n,frame:Hn}),Be.tooltip.mode!==ut.$N.None&&(0,T.jsx)(Ks.xl,{config:fs,hoverMode:Be.tooltip.mode===ut.$N.Multi?Ks.b3.xAll:Ks.b3.xOne,queryZoom:Dt,syncMode:An,syncScope:rn,render:(ps,ks,Xs,ia,ja,Ys,xs)=>{if(On&&Ys!=null){_t(Ys),ja();return}const Os=()=>{let ha=ps.posToVal(ps.cursor.left,"x");_t({from:ha,to:ha}),ja()};return(0,T.jsx)(Ac,{series:Hn,dataIdxs:ks,seriesIdx:Xs,mode:xs?ut.$N.Multi:Be.tooltip.mode,sortOrder:Be.tooltip.sort,isPinned:ia,timeRange:fe,annotate:On?Os:void 0,withDuration:!0,maxHeight:Be.tooltip.maxHeight})},maxWidth:Be.tooltip.maxWidth}),(0,T.jsx)(kr.W,{annotations:Q.annotations??[],config:fs,timeZone:be,newRange:wt,setNewRange:_t,canvasRegionRendering:!1}),(0,T.jsx)(Wo.U,{config:fs,onChangeTimeRange:Dt})]})}),Us]})};var Fd=e(25019);const Kd=(Q,fe,be)=>{let Be=Q.options??{};if(fe==="natel-discrete-panel"&&be.angular){const He=be.angular,at=Q.fieldConfig??{defaults:{},overrides:[]};He.units&&(at.defaults.unit=He.units);const it={fillOpacity:100,lineWidth:0};at.defaults.custom=it,Be.mergeValues=!0;const Dt={type:Fd.d.ValueToText,options:{}};if(at.defaults.mappings=[Dt],(0,B.isArray)(He.colorMaps))for(const Ot of He.colorMaps){const wt=Ot.color;wt&&(Dt.options[Ot.text]={color:wt})}if((0,B.isArray)(He.valueMaps))for(const Ot of He.valueMaps){const wt=Ot.text,_t=Ot.value;if(wt&&_t){let Qt=Dt.options[_t];Qt?Qt.text=wt:Dt.options[_t]={text:wt}}}if((0,B.isArray)(He.rangeMaps))for(const Ot of He.rangeMaps){let wt=+Ot.from,_t=+Ot.to;const Qt=Ot.text;Qt&&at.defaults.mappings.push({type:Fd.d.RangeToText,options:{from:wt,to:_t,result:{text:Qt}}})}Q.fieldConfig=at}return Be};class er{getSuggestionsForData(fe){const{dataSummary:be}=fe;if(!be.hasData||!be.hasTimeField||!be.hasStringField&&!be.hasNumberField||be.numberFieldCount>=30||be.preferredVisualisationType==="logs")return;fe.getListAppender({name:"",pluginId:"state-timeline",options:{},fieldConfig:{defaults:{custom:{}},overrides:[]}}).append({name:ss.m.StateTimeline})}}const nf=new C.m(tf).setPanelChangeHandler(Kd).useFieldConfig({standardOptions:{[Wn.uo.Color]:{settings:{byValueSupport:!0},defaultValue:{mode:Nn.Y.ContinuousGrYlRd}}},useCustomConfig:Q=>{Q.addSliderInput({path:"lineWidth",name:"Line width",defaultValue:Rc.lineWidth,settings:{min:0,max:10,step:1}}).addSliderInput({path:"fillOpacity",name:"Fill opacity",defaultValue:Rc.fillOpacity,settings:{min:0,max:100,step:1}}).addCustomEditor({id:"spanNulls",path:"spanNulls",name:"Connect null values",defaultValue:!1,editor:Ic.e,override:Ic.e,shouldApply:fe=>fe.type!==jt.PU.time,process:Tt.hS,settings:{isTime:!0}}).addCustomEditor({id:"insertNulls",path:"insertNulls",name:"Disconnect values",defaultValue:!1,editor:Nd.Z,override:Nd.Z,shouldApply:fe=>fe.type!==jt.PU.time,process:Tt.hS,settings:{isTime:!0}}),Xn.e(Q)}}).setPanelOptions(Q=>{Q.addBooleanSwitch({path:"mergeValues",name:"Merge equal consecutive values",defaultValue:Dl.mergeValues}).addRadio({path:"showValue",name:"Show values",settings:{options:[{value:ut.yL.Auto,label:"Auto"},{value:ut.yL.Always,label:"Always"},{value:ut.yL.Never,label:"Never"}]},defaultValue:Dl.showValue}).addRadio({path:"alignValue",name:"Align values",settings:{options:[{value:"left",label:"Left"},{value:"center",label:"Center"},{value:"right",label:"Right"}]},defaultValue:Dl.alignValue}).addSliderInput({path:"rowHeight",name:"Row height",settings:{min:0,max:1,step:.01},defaultValue:Dl.rowHeight}).addNumberInput({path:"perPage",name:"Page size (enable pagination)",settings:{min:1,step:1,integer:!0}}),Fn.H(Q,!1),Qn.D(Q)}).setSuggestionsSupplier(new er).setDataSupport({annotations:!0}),$d=({data:Q,timeRange:fe,timeZone:be,options:Be,width:He,height:at,replaceVariables:it,onChangeTimeRange:Dt})=>{const Ot=(0,ee.$j)(),[wt,_t]=(0,K.useState)(null),{sync:Qt,eventsScope:rn,canAddAnnotations:kt,dataLinkPostProcessor:pn,eventBus:_n}=(0,hr.d2)(),An=Qt?.()??wi.y.Off,$n=!!(kt&&kt()),{frames:Bn,warn:un}=(0,K.useMemo)(()=>(0,$a.Qe)(Q.series,!1,fe,Ot),[Q.series,fe,Ot]),bn=(0,K.useMemo)(()=>(0,$a.Or)(Bn,Be.legend,Ot),[Bn,Be.legend,Ot]),Us=(0,K.useMemo)(()=>(0,Gn.Fg)(Be.timezone,be),[Be.timezone,be]);return!Bn||un?(0,T.jsx)("div",{className:"panel-empty",children:(0,T.jsx)("p",{children:un??"No data found in response"})}):Bn[0].length>He/2?(0,T.jsx)("div",{className:"panel-empty",children:(0,T.jsxs)("p",{children:["Too many points to visualize properly. ",(0,T.jsx)("br",{}),"Update the query to return fewer points. ",(0,T.jsx)("br",{}),"(",Bn[0].length," points received)"]})}):(0,T.jsx)(Ql.I,{theme:Ot,frames:Bn,structureRev:Q.structureRev,timeRange:fe,timeZone:Us,width:He,height:at,legendItems:bn,...Be,mode:$a.pm.Samples,replaceVariables:it,dataLinkPostProcessor:pn,cursorSync:An,children:(us,Ts)=>(0,T.jsxs)(T.Fragment,{children:[An!==wi.y.Off&&(0,T.jsx)(ho.K,{config:us,eventBus:_n,frame:Ts}),Be.tooltip.mode!==ut.$N.None&&(0,T.jsx)(Ks.xl,{config:us,hoverMode:Be.tooltip.mode===ut.$N.Multi?Ks.b3.xAll:Ks.b3.xOne,queryZoom:Dt,syncMode:An,syncScope:rn,render:(zn,On,fs,Hn,ps,ks,Xs)=>{if($n&&ks!=null){_t(ks),ps();return}const ia=()=>{let ja=zn.posToVal(zn.cursor.left,"x");_t({from:ja,to:ja}),ps()};return(0,T.jsx)(Ac,{series:Ts,dataIdxs:On,seriesIdx:fs,mode:Xs?ut.$N.Multi:Be.tooltip.mode,sortOrder:Be.tooltip.sort,isPinned:Hn,timeRange:fe,annotate:$n?ia:void 0,withDuration:!1,maxHeight:Be.tooltip.maxHeight})},maxWidth:Be.tooltip.maxWidth}),(0,T.jsx)(kr.W,{annotations:Q.annotations??[],config:us,timeZone:be,newRange:wt,setNewRange:_t,canvasRegionRendering:!1}),(0,T.jsx)(Wo.U,{config:us,onChangeTimeRange:Dt})]})})},Cp={colWidth:.9,rowHeight:.9,showValue:ut.yL.Auto},jc={fillOpacity:70,lineWidth:1};class sf{getSuggestionsForData(fe){const{dataSummary:be}=fe;if(!be.hasData||!be.hasTimeField||!be.hasStringField&&!be.hasNumberField||be.numberFieldCount>=30||be.rowCountMax>100||be.preferredVisualisationType==="logs")return;fe.getListAppender({name:"",pluginId:"status-history",options:{},fieldConfig:{defaults:{color:{mode:Nn.Y.ContinuousGrYlRd},custom:{}},overrides:[]},cardOptions:{previewModifier:He=>{He.options.colWidth=.7}}}).append({name:ss.m.StatusHistory})}}const af=new C.m($d).useFieldConfig({standardOptions:{[Wn.uo.Color]:{settings:{byValueSupport:!0},defaultValue:{mode:Nn.Y.Thresholds}}},useCustomConfig:Q=>{Q.addSliderInput({path:"lineWidth",name:"Line width",defaultValue:jc.lineWidth,settings:{min:0,max:10,step:1}}).addSliderInput({path:"fillOpacity",name:"Fill opacity",defaultValue:jc.fillOpacity,settings:{min:0,max:100,step:1}}),Xn.e(Q)}}).setPanelOptions(Q=>{Q.addRadio({path:"showValue",name:"Show values",settings:{options:[{value:ut.yL.Auto,label:"Auto"},{value:ut.yL.Always,label:"Always"},{value:ut.yL.Never,label:"Never"}]},defaultValue:ut.yL.Auto}).addSliderInput({path:"rowHeight",name:"Row height",defaultValue:.9,settings:{min:0,max:1,step:.01}}).addSliderInput({path:"colWidth",name:"Column width",defaultValue:.9,settings:{min:0,max:1,step:.01}}),Fn.H(Q,!1),Qn.D(Q)}).setSuggestionsSupplier(new sf).setDataSupport({annotations:!0});var rf=e(69550),Yl=e(39651),nl=e(15292);function Tp({onChange:Q,value:fe,context:be}){const Be=He=>{He?.currentTarget.checked&&(be.options.footer.show=!1),Q(He?.currentTarget.checked)};return(0,T.jsx)(nl.d,{value:!!fe,onChange:Be})}var of=e(39938);const Mp=({cellOptions:Q,onChange:fe})=>{const be=()=>{Q.wrapText=!Q.wrapText,fe(Q)},Be=(0,T.jsxs)(yl.J,{description:"If selected text will be wrapped to the width of text in the configured column",children:["Wrap text ",(0,T.jsx)(of.E,{text:"Alpha",color:"blue",style:{fontSize:"11px",marginLeft:"5px",lineHeight:"1.2"}})]});return(0,T.jsx)(T.Fragment,{children:(0,T.jsx)(To.D,{label:Be,children:(0,T.jsx)(nl.d,{value:Q.wrapText,onChange:be})})})};function lf({cellOptions:Q,onChange:fe}){const be=He=>{Q.mode=He,fe(Q)},Be=He=>{Q.valueDisplayMode=He,fe(Q)};return(0,T.jsxs)(S.B,{direction:"column",gap:0,children:[(0,T.jsx)(To.D,{label:"Gauge display mode",children:(0,T.jsx)(os.z,{value:Q?.mode??ut.eX.Gradient,onChange:be,options:cf})}),(0,T.jsx)(To.D,{label:"Value display",children:(0,T.jsx)(os.z,{value:Q?.valueDisplayMode??ut.$l.Text,onChange:Be,options:Sp})})]})}const cf=[{value:ut.eX.Basic,label:"Basic"},{value:ut.eX.Gradient,label:"Gradient"},{value:ut.eX.Lcd,label:"Retro LCD"}],Sp=[{value:ut.$l.Color,label:"Value color"},{value:ut.$l.Text,label:"Text color"},{value:ut.$l.Hidden,label:"Hidden"}],Bc=[{value:ut.Wq.Basic,label:"Basic"},{value:ut.Wq.Gradient,label:"Gradient"}],Vd=({cellOptions:Q,onChange:fe})=>{const be=it=>{Q.mode=it,fe(Q)},Be=()=>{Q.applyToRow=!Q.applyToRow,fe(Q)},He=()=>{Q.wrapText=!Q.wrapText,fe(Q)},at=(0,T.jsxs)(yl.J,{description:"If selected text will be wrapped to the width of text in the configured column",children:["Wrap text ",(0,T.jsx)(of.E,{text:"Alpha",color:"blue",style:{fontSize:"11px",marginLeft:"5px",lineHeight:"1.2"}})]});return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(To.D,{label:"Background display mode",children:(0,T.jsx)(os.z,{value:Q?.mode??ut.Wq.Gradient,onChange:be,options:Bc})}),(0,T.jsx)(To.D,{label:"Apply to entire row",description:"If selected the entire row will be colored as this cell would be.",children:(0,T.jsx)(nl.d,{value:Q.applyToRow,onChange:Be})}),(0,T.jsx)(To.D,{label:at,children:(0,T.jsx)(nl.d,{value:Q.wrapText,onChange:He})})]})},Jl=({cellOptions:Q,onChange:fe})=>{const be=He=>{Q.alt=He.currentTarget.value,fe(Q)},Be=He=>{Q.title=He.currentTarget.value,fe(Q)};return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(To.D,{label:"Alt text",description:"Alternative text that will be displayed if an image can't be displayed or for users who use a screen reader",children:(0,T.jsx)(aa.p,{onChange:be,defaultValue:Q.alt})}),(0,T.jsx)(To.D,{label:"Title text",description:"Text that will be displayed when the image is hovered by a cursor",children:(0,T.jsx)(aa.p,{onChange:Be,defaultValue:Q.title})})]})};var to=e(28528),Mr=e(30355);const df=["hideValue","drawStyle","lineInterpolation","barAlignment","lineWidth","fillOpacity","gradientMode","lineStyle","spanNulls","showPoints","pointSize"];function _d(Q){const fe=(0,Aa.V)(Q);return{...fe,useCustomConfig:be=>{fe.useCustomConfig?.(be),be.addBooleanSwitch({path:"hideValue",name:"Hide value"})}}}const zd=Q=>{const{cellOptions:fe,onChange:be}=Q,Be=(0,K.useMemo)(()=>{const it=_d(Mr.t);return(0,to.O)(it,"ChartCell")},[]),He=(0,ee.of)(Hd),at={...Mr.t,...fe};return(0,T.jsx)(cs.gW,{children:Be.list(df.map(it=>`custom.${it}`)).map(it=>{if(it.showIf&&!it.showIf(at))return null;const Dt=it.editor,Ot=it.path;return(0,T.jsx)(To.D,{label:it.name,className:He.field,children:(0,T.jsx)(Dt,{onChange:wt=>be({...fe,[Ot]:wt}),value:(Xl(Ot,at)?at[Ot]:void 0)??it.defaultValue,item:it,context:{data:[]}})},it.id)})})};function Xl(Q,fe){return Q in fe}const Hd=()=>({field:(0,te.css)`
    width: 100%;

    // @TODO don't show "scheme" option for custom gradient mode.
    // it needs thresholds to work, which are not supported
    // for area chart cell right now
    [title='Use color scheme to define gradient'] {
      display: none;
    }
  `}),Zl=({value:Q,onChange:fe})=>{const be=Q.type,Be=(0,ee.of)(ql),He=kd.find(wt=>wt.value.type===be);let[at,it]=(0,K.useState)({});const Dt=wt=>{wt.value!==void 0&&(Q=wt.value,at[Q.type]!==void 0&&Object.keys(at[Q.type]).length>1&&(Q=(0,B.merge)(Q,at[Q.type])),fe(Q))},Ot=wt=>{at[Q.type]=(0,B.merge)(Q,wt),it(at),fe(at[Q.type])};return(0,T.jsxs)("div",{className:Be.fixBottomMargin,children:[(0,T.jsx)(To.D,{children:(0,T.jsx)(V.l6,{options:kd,value:He,onChange:Dt})}),(be===ut.ob.Auto||be===ut.ob.ColorText)&&(0,T.jsx)(Mp,{cellOptions:Q,onChange:Ot}),be===ut.ob.Gauge&&(0,T.jsx)(lf,{cellOptions:Q,onChange:Ot}),be===ut.ob.ColorBackground&&(0,T.jsx)(Vd,{cellOptions:Q,onChange:Ot}),be===ut.ob.Sparkline&&(0,T.jsx)(zd,{cellOptions:Q,onChange:Ot}),be===ut.ob.Image&&(0,T.jsx)(Jl,{cellOptions:Q,onChange:Ot})]})},kd=[{value:{type:ut.ob.Auto},label:"Auto"},{value:{type:ut.ob.Sparkline},label:"Sparkline"},{value:{type:ut.ob.ColorText},label:"Colored text"},{value:{type:ut.ob.ColorBackground},label:"Colored background"},{value:{type:ut.ob.Gauge},label:"Gauge"},{value:{type:ut.ob.DataLinks},label:"Data links"},{value:{type:ut.ob.JSONView},label:"JSON View"},{value:{type:ut.ob.Image},label:"Image"}],ql=Q=>({fixBottomMargin:(0,te.css)({marginBottom:Q.spacing(-2)})}),ec={cellHeight:ut.qM.Sm,footer:{show:!1,countRows:!1,reducer:[]},frameIndex:0,showHeader:!0,showTypeIcons:!1,sortBy:[]};class uf{getSuggestionsForData(fe){const be=fe.getListAppender({name:ss.m.Table,pluginId:"table",options:{},fieldConfig:{defaults:{custom:{}},overrides:[]},cardOptions:{previewModifier:Be=>{Be.fieldConfig.defaults.custom.minWidth=50}}});fe.dataSummary.fieldCount===0?be.append({cardOptions:{imgSrc:"public/app/plugins/panel/table/img/icn-table-panel.svg"}}):be.append({})}}const tc="Table footer",Gd=["Cell options"],hf=new C.m(Cd).setPanelChangeHandler($l.l1).setMigrationHandler($l.fq).useFieldConfig({useCustomConfig:Q=>{Q.addNumberInput({path:"minWidth",name:"Minimum column width",description:"The minimum width for column auto resizing",settings:{placeholder:"150",min:50,max:500},shouldApply:()=>!0,defaultValue:Yl.gB.minWidth}).addNumberInput({path:"width",name:"Column width",settings:{placeholder:"auto",min:20,max:300},shouldApply:()=>!0,defaultValue:Yl.gB.width}).addRadio({path:"align",name:"Column alignment",settings:{options:[{label:"Auto",value:"auto"},{label:"Left",value:"left"},{label:"Center",value:"center"},{label:"Right",value:"right"}]},defaultValue:Yl.gB.align}).addCustomEditor({id:"cellOptions",path:"cellOptions",name:"Cell type",editor:Zl,override:Zl,defaultValue:Yl.gB.cellOptions,process:Tt.hS,category:Gd,shouldApply:()=>!0}).addBooleanSwitch({path:"inspect",name:"Cell value inspect",description:"Enable cell value inspection in a modal window",defaultValue:!1,category:Gd,showIf:fe=>fe.cellOptions.type===ut.ob.Auto||fe.cellOptions.type===ut.ob.JSONView||fe.cellOptions.type===ut.ob.ColorText||fe.cellOptions.type===ut.ob.ColorBackground}).addBooleanSwitch({path:"filterable",name:"Column filter",description:"Enables/disables field filters in table",defaultValue:Yl.gB.filterable}).addBooleanSwitch({path:"hidden",name:"Hide in table",defaultValue:void 0,hideFromDefaults:!0})}}).setPanelOptions(Q=>{Q.addBooleanSwitch({path:"showHeader",name:"Show table header",defaultValue:ec.showHeader}).addRadio({path:"cellHeight",name:"Cell height",defaultValue:ec.cellHeight,settings:{options:[{value:ut.qM.Sm,label:"Small"},{value:ut.qM.Md,label:"Medium"},{value:ut.qM.Lg,label:"Large"}]}}).addBooleanSwitch({path:"footer.show",category:[tc],name:"Show table footer",defaultValue:ec.footer?.show}).addCustomEditor({id:"footer.reducer",category:[tc],path:"footer.reducer",name:"Calculation",description:"Choose a reducer function / calculation",editor:rf.D.get("stats-picker").editor,defaultValue:[Ni.gy.sum],showIf:fe=>fe.footer?.show}).addBooleanSwitch({path:"footer.countRows",category:[tc],name:"Count rows",description:"Display a single count for all data rows",defaultValue:ec.footer?.countRows,showIf:fe=>fe.footer?.reducer?.length===1&&fe.footer?.reducer[0]===Ni.gy.count}).addMultiSelect({path:"footer.fields",category:[tc],name:"Fields",description:"Select the fields that should be calculated",settings:{allowCustomValue:!1,options:[],placeholder:"All Numeric Fields",getOptions:async fe=>{const be=[];if(fe&&fe.data&&fe.data.length>0){const Be=fe.data[0];for(const He of Be.fields)if(He.type===jt.PU.number){const at=(0,Ea.Ct)(He,Be,fe.data),it=He.name;be.push({value:it,label:at})}}return be}},defaultValue:"",showIf:fe=>fe.footer?.show&&!fe.footer?.countRows}).addCustomEditor({id:"footer.enablePagination",path:"footer.enablePagination",name:"Enable pagination",editor:Tp})}).setSuggestionsSupplier(new uf);var ff=e(49880),Qd=e.n(ff),yi=e(40996),gf=e(36663),no=(Q=>(Q.Code="code",Q.HTML="html",Q.Markdown="markdown",Q))(no||{}),qo=(Q=>(Q.Go="go",Q.Html="html",Q.Json="json",Q.Markdown="markdown",Q.Plaintext="plaintext",Q.Sql="sql",Q.Typescript="typescript",Q.Xml="xml",Q.Yaml="yaml",Q))(qo||{});const Op="plaintext",bl={language:"plaintext",showLineNumbers:!1,showMiniMap:!1},Yd={content:`# Title

For markdown syntax help: [commonmark.org/help](https://commonmark.org/help/)`,mode:"markdown"};function pf(Q){const fe=(0,ee.of)(Cl),[be,Be]=(0,K.useState)({mode:Q.options.mode,content:Jd(Q.options,Q.replaceVariables,ce.Ay.disableSanitizeHtml)});if((0,yi.A)(()=>{const{options:He,replaceVariables:at}=Q,it=Jd(He,at,ce.Ay.disableSanitizeHtml);(it!==be.content||He.mode!==be.mode)&&Be({mode:He.mode,content:it})},100,[Q]),be.mode===no.Code){const He=Q.options.code??bl;return(0,T.jsx)(Ec.B,{value:be.content,language:He.language??bl.language,width:Q.width,height:Q.height,containerStyles:fe.codeEditorContainer,showMiniMap:He.showMiniMap,showLineNumbers:He.showLineNumbers,readOnly:!0},`${He.showLineNumbers}/${He.showMiniMap}`)}return(0,T.jsx)(se.E,{autoHeightMin:"100%",className:fe.containStrict,children:(0,T.jsx)(Qd(),{allowRerender:!0,html:be.content,className:fe.markdown,"data-testid":"TextPanel-converted-content"})})}function Jd(Q,fe,be){let{mode:Be,content:He}=Q;if(!He)return" ";switch(He=fe(He,{},Q.code?.language==="json"?"json":"html"),Be){case no.Code:break;case no.HTML:be||(He=qi.sQ.sanitizeTextPanelContent(He));break;case no.Markdown:default:He=(0,gf.P)(He,{noSanitize:be})}return He}const Cl=Q=>({codeEditorContainer:(0,te.css)`
    .monaco-editor .margin,
    .monaco-editor-background {
      background-color: ${Q.colors.background.primary};
    }
  `,markdown:(0,te.cx)("markdown-html",(0,te.css)`
      height: 100%;
    `),containStrict:(0,te.css)({contain:"strict"})});var xi=e(70713),Xd=e(99544);const Zd=({value:Q,onChange:fe,context:be})=>{const Be=(0,K.useMemo)(()=>be.options?.mode??no.Markdown,[be]),He=(0,ee.of)(qd),at=()=>be.getSuggestions?be.getSuggestions().map(it=>(0,Xd.O)(it)):[];return(0,T.jsx)("div",{className:(0,te.cx)(He.editorBox),children:(0,T.jsx)(xi.Ay,{disableHeight:!0,children:({width:it})=>it===0?null:(0,T.jsx)(Ec.B,{value:Q,onBlur:fe,onSave:fe,language:Be,width:it,showMiniMap:!1,showLineNumbers:!1,height:"500px",getSuggestions:at})})})},qd=Q=>({editorBox:(0,te.css)`
    label: editorBox;
    border: 1px solid ${Q.colors.border.medium};
    border-radius: ${Q.shape.radius.default};
    margin: ${Q.spacing(.5)} 0;
    width: 100%;
  `}),mf=Q=>{const fe=parseFloat(Q.pluginVersion||"6.1");let be=Q.options;if(Q.hasOwnProperty("content")&&Q.hasOwnProperty("mode")){const He=Q,at=He.content,it=He.mode;delete He.content,delete He.mode,fe<7.1&&(be={content:at,mode:it})}return[no.Code,no.HTML,no.Markdown].find(He=>He===be.mode)||(be={...be,mode:no.Markdown}),be},eu=new C.m(pf).setPanelOptions(Q=>{Q.addRadio({path:"mode",name:"Mode",settings:{options:[{value:no.Markdown,label:"Markdown"},{value:no.HTML,label:"HTML"},{value:no.Code,label:"Code"}]},defaultValue:Yd.mode}).addSelect({path:"code.language",name:"Language",settings:{options:Object.values(qo).map(fe=>({value:fe,label:fe}))},defaultValue:bl.language,showIf:fe=>fe.mode===no.Code}).addBooleanSwitch({path:"code.showLineNumbers",name:"Show line numbers",defaultValue:bl.showLineNumbers,showIf:fe=>fe.mode===no.Code}).addBooleanSwitch({path:"code.showMiniMap",name:"Show mini map",defaultValue:bl.showMiniMap,showIf:fe=>fe.mode===no.Code}).addCustomEditor({id:"content",path:"content",name:"Content",editor:Zd,defaultValue:Yd.content})}).setMigrationHandler(mf);var vf=e(41260),nc=e(18282);class yf{getSuggestionsForData(fe){const{dataSummary:be}=fe;if(!be.hasTimeField||!be.hasNumberField||be.rowCountTotal<2)return;const Be=fe.getListAppender({name:ss.m.LineChart,pluginId:"timeseries",options:{legend:{calcs:[],displayMode:ut.lm.Hidden,placement:"right",showLegend:!1}},fieldConfig:{defaults:{custom:{}},overrides:[]},cardOptions:{previewModifier:at=>{at.fieldConfig?.defaults.custom?.drawStyle!==ut.GR.Bars&&(at.fieldConfig.defaults.custom.lineWidth=Math.max(at.fieldConfig.defaults.custom.lineWidth??1,2))}}}),He=100;if(Be.append({name:ss.m.LineChart}),be.rowCountMax<200&&Be.append({name:ss.m.LineChartSmooth,fieldConfig:{defaults:{custom:{lineInterpolation:ut.dx.Smooth}},overrides:[]}}),be.numberFieldCount===1){Be.append({name:ss.m.AreaChart,fieldConfig:{defaults:{custom:{fillOpacity:25}},overrides:[]}}),Be.append({name:ss.m.LineChartGradientColorScheme,fieldConfig:{defaults:{color:{mode:Nn.Y.ContinuousGrYlRd},custom:{gradientMode:ut.on.Scheme,lineInterpolation:ut.dx.Smooth,lineWidth:3,fillOpacity:20}},overrides:[]}}),be.rowCountMax<He&&(Be.append({name:ss.m.BarChart,fieldConfig:{defaults:{custom:{drawStyle:ut.GR.Bars,fillOpacity:100,lineWidth:1,gradientMode:ut.on.Hue}},overrides:[]}}),Be.append({name:ss.m.BarChartGradientColorScheme,fieldConfig:{defaults:{color:{mode:Nn.Y.ContinuousGrYlRd},custom:{drawStyle:ut.GR.Bars,fillOpacity:90,lineWidth:1,gradientMode:ut.on.Scheme}},overrides:[]}}));return}Be.append({name:ss.m.AreaChartStacked,fieldConfig:{defaults:{custom:{fillOpacity:25,stacking:{mode:ut.gs.Normal,group:"A"}}},overrides:[]}}),Be.append({name:ss.m.AreaChartStackedPercent,fieldConfig:{defaults:{custom:{fillOpacity:25,stacking:{mode:ut.gs.Percent,group:"A"}}},overrides:[]}}),be.rowCountTotal/be.numberFieldCount<He&&(Be.append({name:ss.m.BarChartStacked,fieldConfig:{defaults:{custom:{drawStyle:ut.GR.Bars,fillOpacity:100,lineWidth:1,gradientMode:ut.on.Hue,stacking:{mode:ut.gs.Normal,group:"A"}}},overrides:[]}}),Be.append({name:ss.m.BarChartStackedPercent,fieldConfig:{defaults:{custom:{drawStyle:ut.GR.Bars,fillOpacity:100,lineWidth:1,gradientMode:ut.on.Hue,stacking:{mode:ut.gs.Percent,group:"A"}}},overrides:[]}}))}}function tu(Q){const fe=(0,Ye.UA)().getCurrent()?.getPanelById(Q);if(fe){const be=fe.transformations?[...fe.transformations]:[];return be.push({id:nc.F.prepareTimeSeries,options:{format:"wide"}}),{name:"Transform to wide time series format",pluginId:"timeseries",transformations:be}}}const xf=({data:Q,timeRange:fe,timeZone:be,width:Be,height:He,options:at,fieldConfig:it,onChangeTimeRange:Dt,replaceVariables:Ot,id:wt})=>{const{sync:_t,eventsScope:Qt,canAddAnnotations:rn,onThresholdsChange:kt,canEditThresholds:pn,showThresholds:_n,dataLinkPostProcessor:An,eventBus:$n}=(0,hr.d2)(),Bn=at.orientation===ut.wV.Vertical,un=(0,K.useMemo)(()=>(0,Gn.B_)(Q.series,ce.config.theme2,fe),[Q.series,fe]),bn=(0,K.useMemo)(()=>(0,Gn.Fg)(at.timezone,be),[at.timezone,be]),Us=(0,K.useMemo)(()=>{if(un?.length&&un.every(fs=>fs.meta?.type===vf.m.TimeSeriesLong)){const fs=tu(wt);return{message:"Long data must be converted to wide",suggestions:fs?[fs]:void 0}}},[un,wt]),us=!!(rn&&rn()),[Ts,zn]=(0,K.useState)(null),On=_t?.()??wi.y.Off;return!un||Us?(0,T.jsx)(ys.a,{panelId:wt,message:Us?.message,fieldConfig:it,data:Q,needsTimeField:!0,needsNumberField:!0,suggestions:Us?.suggestions}):(0,T.jsx)(Yo,{frames:un,structureRev:Q.structureRev,timeRange:fe,timeZone:bn,width:Be,height:He,legend:at.legend,options:at,replaceVariables:Ot,dataLinkPostProcessor:An,cursorSync:On,children:(fs,Hn)=>(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(Ma.Z,{config:fs}),On!==wi.y.Off&&(0,T.jsx)(ho.K,{config:fs,eventBus:$n,frame:Hn}),at.tooltip.mode!==ut.$N.None&&(0,T.jsx)(Ks.xl,{config:fs,hoverMode:at.tooltip.mode===ut.$N.Single?Ks.b3.xOne:Ks.b3.xAll,queryZoom:Dt,clientZoom:!0,syncMode:On,syncScope:Qt,render:(ps,ks,Xs,ia=!1,ja,Ys,xs)=>{if(us&&Ys!=null){zn(Ys),ja();return}const Os=()=>{let ha=ps.posToVal(ps.cursor.left,"x");zn({from:ha,to:ha}),ja()};return(0,T.jsx)(Zs.k,{series:Hn,dataIdxs:ks,seriesIdx:Xs,mode:xs?ut.$N.Multi:at.tooltip.mode,sortOrder:at.tooltip.sort,isPinned:ia,annotate:us?Os:void 0,maxHeight:at.tooltip.maxHeight})},maxWidth:at.tooltip.maxWidth}),!Bn&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(kr.W,{annotations:Q.annotations??[],config:fs,timeZone:be,newRange:Ts,setNewRange:zn}),(0,T.jsx)(Wo.U,{config:fs,onChangeTimeRange:Dt}),Q.annotations&&(0,T.jsx)(Gi,{visibleSeries:fl(fs,un),config:fs,exemplars:Q.annotations,timeZone:be}),(pn&&kt||_n)&&(0,T.jsx)(Ii,{config:fs,fieldConfig:it,onThresholdsChange:pn?kt:void 0})]})]})})};var Uc=e(91410),Ef=e(20333);const Df=({value:Q,onChange:fe})=>{const be=(0,ee.of)(nu);(!Q||Q.length<1)&&(Q=[""]);const Be=()=>{fe([...Q,Uc.g$.default])},He=it=>{const Dt=Q.slice();Dt.splice(it,1),fe(Dt)},at=(it,Dt)=>{const Ot=Q.slice();Ot[it]=Dt??Uc.g$.default,Ot.length===0||Ot.length===1&&Ot[0]===""?fe(void 0):fe(Ot)};return(0,T.jsx)("div",{children:Q.map((it,Dt)=>(0,T.jsxs)("div",{className:be.wrapper,children:[(0,T.jsx)("span",{className:be.first,children:(0,T.jsx)(Ef.U,{onChange:Ot=>at(Dt,Ot),includeInternal:!0,value:it??Uc.g$.default})}),Dt===Q.length-1?(0,T.jsx)(fi.K,{name:"plus",onClick:Be,tooltip:"Add timezone"}):(0,T.jsx)(fi.K,{name:"times",onClick:()=>He(Dt),tooltip:"Remove timezone"})]},`${Dt}.${it}`))})},nu=Q=>({wrapper:(0,te.css)`
    width: 100%;
    display: flex;
    flex-direction: rows;
    align-items: center;
  `,first:(0,te.css)`
    margin-right: 8px;
    flex-grow: 2;
  `});var Pf=e(50082),bf=e(74856),Cf=e(38477),Nc=e(34842),Tf=e(32023),Mf=e(68706);let wc=null;const su=(Q,fe,be,Be)=>{if(fe==="graph"&&be.angular){const{fieldConfig:He,options:at,annotations:it}=Sf({...be.angular,fieldConfig:Be,panel:Q});return it?.length>0&&If(it),Q.fieldConfig=He,Q.alert=be.angular.alert,at}return ou(Q),{}};function Sf(Q){let fe=[];const be=Q.fieldConfig?.overrides??[],Be=Q.yaxes??[];let He=au(Be[0]);Q.fieldConfig?.defaults&&(He={...Q.fieldConfig?.defaults,...He});const at={fill:Q.dashes?"dash":"solid",dash:[Q.dashLength??10,Q.spaceLength??10]};if(Q.aliasColors)for(const Qt of Object.keys(Q.aliasColors)){const rn=Q.aliasColors[Qt];rn&&be.push({matcher:{id:mi.Ct.byName,options:Qt},properties:[{id:Wn.uo.Color,value:{mode:Nn.Y.Fixed,fixedColor:rn}}]})}let it=!1;if(Q.seriesOverrides?.length)for(const Qt of Q.seriesOverrides){if(!Qt.alias)continue;const kt={matcher:{id:/^([/~@;%#'])(.*?)\1([gimsuy]*)$/.test(Qt.alias)?mi.Ct.byRegexp:mi.Ct.byName,options:Qt.alias},properties:[]};let pn;for(const _n of Object.keys(Qt)){const An=Qt[_n];switch(_n){case"alias":case"$$hashKey":break;case"yaxis":if(An===2){const $n=au(Be[1]);Of(He,$n,kt.properties)}break;case"fill":kt.properties.push({id:"custom.fillOpacity",value:An*10});break;case"fillBelowTo":it=!0,kt.properties.push({id:"custom.fillBelowTo",value:An});break;case"fillGradient":An&&(kt.properties.push({id:"custom.fillGradient",value:"opacity"}),kt.properties.push({id:"custom.fillOpacity",value:An*10}));break;case"points":kt.properties.push({id:"custom.showPoints",value:An?ut.yL.Always:ut.yL.Never});break;case"bars":An?(kt.properties.push({id:"custom.drawStyle",value:ut.GR.Bars}),kt.properties.push({id:"custom.fillOpacity",value:100})):kt.properties.push({id:"custom.drawStyle",value:ut.GR.Line});break;case"lines":An?kt.properties.push({id:"custom.drawStyle",value:"line"}):kt.properties.push({id:"custom.lineWidth",value:0});break;case"linewidth":kt.properties.push({id:"custom.lineWidth",value:An});break;case"pointradius":kt.properties.push({id:"custom.pointSize",value:2+An*2});break;case"dashLength":case"spaceLength":case"dashes":switch(pn||(pn={fill:at.fill,dash:[...at.dash]}),_n){case"dashLength":pn.dash[0]=An;break;case"spaceLength":pn.dash[1]=An;break;case"dashes":pn.fill=An?"dash":"solid";break}break;case"stack":kt.properties.push({id:"custom.stacking",value:Tl(An)});break;case"color":kt.properties.push({id:"color",value:{fixedColor:An,mode:Nn.Y.Fixed}});break;case"transform":kt.properties.push({id:"custom.transform",value:An==="negative-Y"?ut.NU.NegativeY:ut.NU.Constant});break;default:console.log("Ignore override migration:",Qt.alias,_n,An)}}pn&&kt.properties.push({id:"custom.lineStyle",value:pn}),kt.properties.length&&be.push(kt)}const Dt=He.custom??{};Dt.drawStyle=Q.bars?ut.GR.Bars:Q.lines?ut.GR.Line:ut.GR.Points,Q.points?(Dt.showPoints=ut.yL.Always,(0,B.isNumber)(Q.pointradius)&&(Dt.pointSize=2+Q.pointradius*2)):Dt.drawStyle!==ut.GR.Points&&(Dt.showPoints=ut.yL.Never),Dt.lineWidth=Q.linewidth,at.fill!=="solid"&&(Dt.lineStyle=at),it?Dt.fillOpacity=35:(0,B.isNumber)(Q.fill)&&(Dt.fillOpacity=Q.fill*10),(0,B.isNumber)(Q.fillGradient)&&Q.fillGradient>0&&(Dt.gradientMode=ut.on.Opacity,Dt.fillOpacity=Q.fillGradient*10),Dt.spanNulls=Q.nullPointMode===bd.UW.Ignore,Q.steppedLine&&(Dt.lineInterpolation=ut.dx.StepAfter),Dt.drawStyle===ut.GR.Bars&&(Dt.fillOpacity=100),Q.stack&&(Dt.stacking={mode:Q.percentage?ut.gs.Percent:ut.gs.Normal,group:Aa.S.stacking.group},Q.percentage&&Q.yaxis&&(delete He.min,delete He.max,He.decimals===0&&delete He.decimals)),He.custom=(0,B.omitBy)(Dt,B.isNil),He.nullValueMode=Q.nullPointMode;const Ot={legend:{displayMode:ut.lm.List,showLegend:!0,placement:"bottom",calcs:[]},tooltip:{mode:ut.$N.Single,sort:ut.xB.None}},wt=Q.legend;if(wt){if(wt.show?Ot.legend.displayMode=wt.alignAsTable?ut.lm.Table:ut.lm.List:Ot.legend.showLegend=!1,wt.rightSide&&(Ot.legend.placement="right"),Q.legend.values){const Qt=(0,B.pickBy)(Q.legend);Ot.legend.calcs=ru(Qt)}Q.legend.sideWidth&&(Ot.legend.width=Q.legend.sideWidth),wt.hideZero&&be.push(iu(Ni.gy.allIsZero)),wt.hideEmpty&&be.push(iu(Ni.gy.allIsNull))}Q.timeRegions?.length&&Q.timeRegions.map((rn,kt)=>({name:`T${kt}`,color:rn.colorMode!=="custom"?rn.colorMode:rn.fillColor,line:rn.line,fill:rn.fill,fromDayOfWeek:rn.fromDayOfWeek,toDayOfWeek:rn.toDayOfWeek,from:rn.from,to:rn.to})).forEach((rn,kt)=>{const pn={datasource:{type:"datasource",uid:"grafana"},enable:!0,hide:!0,filter:{exclude:!1,ids:[Q.panel.id]},iconColor:rn.fillColor??rn.color,name:`Time region for panel ${Q.panel.title}${kt>0?` ${kt}`:""}`,target:{queryType:Mf.nj.TimeRegions,refId:"Anno",timeRegion:{fromDayOfWeek:rn.fromDayOfWeek,toDayOfWeek:rn.toDayOfWeek,from:rn.from,to:rn.to,timezone:"utc"}}};rn.fill?fe.push(pn):rn.line&&(pn.iconColor=rn.lineColor??"white",fe.push(pn))});const _t=Q.tooltip;if(_t&&(_t.shared!==void 0&&(Ot.tooltip.mode=_t.shared?ut.$N.Multi:ut.$N.Single),_t.sort!==void 0&&_t.shared))switch(_t.sort){case 1:Ot.tooltip.sort=ut.xB.Ascending;break;case 2:Ot.tooltip.sort=ut.xB.Descending;break;default:Ot.tooltip.sort=ut.xB.None}if(Q.thresholds&&Q.thresholds.length>0){let Qt=[],rn=!1,kt=!1;const pn=Q.thresholds.sort((An,$n)=>An.value>$n.value?1:-1);for(let An=0;An<pn.length;An++){const $n=pn[An],Bn=pn.length>An+1?pn[An+1]:null;$n.fill&&(rn=!0),$n.line&&(kt=!0),$n.op==="gt"&&Qt.push({value:$n.value,color:Wc($n)}),$n.op==="lt"&&(Qt.length===0&&Qt.push({value:-1/0,color:Wc($n)}),Bn&&Bn.op==="gt"&&Bn.value>$n.value?Qt.push({value:$n.value,color:"transparent"}):Bn&&Bn.op==="lt"?Qt.push({value:$n.value,color:Wc(Bn)}):Qt.push({value:$n.value,color:"transparent"}))}Qt.length>0&&Qt[0].value!==-1/0&&Qt.unshift({color:"transparent",value:-1/0});let _n=rn?ut.Ly.Area:ut.Ly.Line;kt&&rn&&(_n=ut.Ly.LineAndArea),He.custom.thresholdsStyle={mode:_n},He.thresholds={mode:Pf.O.Absolute,steps:Qt}}return Q.xaxis&&Q.xaxis.show===!1&&Q.xaxis.mode==="time"&&be.push({matcher:{id:mi.Ct.byType,options:jt.PU.time},properties:[{id:"custom.axisPlacement",value:ut.vM.Hidden}]}),{fieldConfig:{defaults:(0,B.omitBy)(He,B.isNil),overrides:be},options:Ot,annotations:fe}}function Wc(Q){return Q.colorMode==="critical"?"red":Q.colorMode==="warning"?"orange":Q.colorMode==="custom"?Q.fillColor||Q.lineColor:"red"}function au(Q){if(!Q)return{};const fe={axisPlacement:Q.show?ut.vM.Auto:ut.vM.Hidden};if(Q.label&&(fe.axisLabel=Q.label),Q.logBase){const be=Q.logBase;(be===2||be===10)&&(fe.scaleDistribution={type:ut.L4.Log,log:be})}return(0,B.omitBy)({unit:Q.format,decimals:sl(Q.decimals),min:sl(Q.min),max:sl(Q.max),custom:fe},B.isNil)}function Of(Q,fe,be){for(const[at,it]of Object.entries(fe))at!=="custom"&&it!==Q[at]&&be.push({id:at,value:it});be.push({id:"custom.axisPlacement",value:ut.vM.Right});const Be=Q.custom??{},He=fe.custom??{};for(const[at,it]of Object.entries(He))it!==Be[at]&&be.push({id:`custom.${at}`,value:it})}function sl(Q){if((0,B.isNumber)(Q))return Q;if((0,B.isString)(Q)){const fe=Number(Q);if(!isNaN(fe))return fe}}function ru(Q){const fe=[];for(const be in Q){const Be=Ni.AS.getIfExists(be);Be&&fe.push(Be.id)}return fe}function ou(Q){Q.fieldConfig?.defaults?.custom?.hideFrom?.graph!==void 0&&(Q.fieldConfig.defaults.custom.hideFrom.viz=Q.fieldConfig.defaults.custom.hideFrom.graph,delete Q.fieldConfig.defaults.custom.hideFrom.graph),Q.fieldConfig?.overrides&&(Q.fieldConfig.overrides=Q.fieldConfig.overrides.map(fe=>(fe.properties=fe.properties.map(be=>(be.id==="custom.hideFrom"&&be.value.graph&&(be.value.viz=be.value.graph,delete be.value.graph),be)),fe)))}function iu(Q){return{matcher:{id:mi.Ct.byValue,options:{reducer:Q,op:ut.zT.GTE,value:0}},properties:[{id:"custom.hideFrom",value:{tooltip:!0,viz:!1,legend:!0}}]}}function Tl(Q){const fe=Aa.S.stacking?.group;return{mode:Q?ut.gs.Normal:ut.gs.None,group:(0,B.isString)(Q)?Q:fe}}function If(Q){const fe=window.__grafanaSceneContext;if(fe instanceof Nc.H$){const Be=Tf.b4.getDataLayers(fe),He=[...Be.state.annotationLayers];for(let at of Q){const it=new Cf.g({key:`annotations-${at.name}`,query:at,name:at.name,isEnabled:at.enable,isHidden:at.hide});He.push(it)}Be.setState({annotationLayers:He});return}const be=(0,Ye.UA)().getCurrent();be&&(be.annotations.list=[...be.annotations.list,...Q],wc==null&&(wc=setTimeout(()=>{wc=null,(0,bf.jG)().refreshTimeModel()})))}const Af=new C.m(xf).setPanelChangeHandler(su).useFieldConfig((0,Aa.V)(Aa.S)).setPanelOptions(Q=>{Qn.D(Q,!1,!0),Fn.H(Q),Q.addCustomEditor({id:"timezone",name:"Time zone",path:"timezone",category:["Axis"],editor:Df,defaultValue:void 0})}).setSuggestionsSupplier(new yf).setDataSupport({annotations:!0,alertStates:!0});var Rf=e(92599),Lf=e(35090);const Fc={wrapper:(0,te.css)`
    height: 100%;
    overflow: scroll;
  `},Kc=({data:Q,options:fe})=>{const be=(0,K.createRef)(),Be=(0,K.useMemo)(()=>(0,Lf.L)(Q.series[0]),[Q.series]),He=(0,Sd.A)(async()=>await(0,Od.l)().get(Q.request?.targets[0].datasource?.uid));return!Q||!Q.series.length||!Be?(0,T.jsx)("div",{className:"panel-empty",children:(0,T.jsx)("p",{children:"No data found in response"})}):(0,T.jsxs)("div",{className:Fc.wrapper,children:[(0,T.jsx)("div",{ref:be}),(0,T.jsx)(Rf.V,{dataFrames:Q.series,scrollElementClass:Fc.wrapper,traceProp:Be,datasource:He.value,topOfViewRef:be,createSpanLink:fe.createSpanLink,focusedSpanId:fe.focusedSpanId,createFocusSpanLink:fe.createFocusSpanLink})]})};class jf{getListWithDefaults(fe){return fe.getListAppender({name:ss.m.Trace,pluginId:"traces"})}getSuggestionsForData(fe){!fe.data||!fe.data.series[0]||fe.data.series[0].meta?.preferredVisualisationType==="trace"&&this.getListWithDefaults(fe).append({name:ss.m.Trace,score:Wt.nQ.Best})}}const Bf=new C.m(Kc).setSuggestionsSupplier(new jf);var Uf=e(85200),Nf=e(40458);const wf=({data:Q,timeRange:fe,timeZone:be,width:Be,height:He,options:at,fieldConfig:it,replaceVariables:Dt,id:Ot})=>{const{dataLinkPostProcessor:wt}=(0,hr.d2)(),_t=at.xField??Q.series[0].fields.find(kt=>kt.type===jt.PU.number)?.name,Qt=(kt,pn,_n)=>(pn={...pn,x:Uf.sJ.get(mi.Ct.byName).get(_t)},(0,Nf.m)(kt,pn)),rn=(0,K.useMemo)(()=>{if(Q.series.length>1)return{warning:"Only one frame is supported, consider adding a join transformation",frames:Q.series};let kt=Q.series,pn;if(at.xField){if(pn=(0,Co.findFieldIndex)(at.xField,kt[0]),pn==null)return{warning:"Unable to find field: "+at.xField,frames:Q.series}}else if(pn=kt[0].fields.findIndex(_n=>_n.type===jt.PU.number),pn===-1)return{warning:"No numeric fields found for X axis",frames:kt};if(pn!=null){const _n=kt[0].fields[pn];if(_n.type===jt.PU.number&&!(0,cr.g2)(_n.values))return{warning:"Values must be in ascending order",frames:kt}}return{frames:(0,Gn.B_)(kt,I.$.theme2,void 0,pn)}},[Q.series,at.xField]);return rn.warning||!rn.frames?(0,T.jsx)(ys.a,{panelId:Ot,fieldConfig:it,data:Q,message:rn.warning,needsNumberField:!0}):(0,T.jsx)(Yo,{frames:rn.frames,structureRev:Q.structureRev,timeRange:fe,timeZone:be,width:Be,height:He,legend:at.legend,options:at,preparePlotFrame:Qt,replaceVariables:Dt,dataLinkPostProcessor:wt,children:(kt,pn)=>(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(Ma.Z,{config:kt}),at.tooltip.mode!==ut.$N.None&&(0,T.jsx)(Ks.xl,{config:kt,hoverMode:at.tooltip.mode===ut.$N.Single?Ks.b3.xOne:Ks.b3.xAll,render:(_n,An,$n,Bn=!1)=>(0,T.jsx)(Zs.k,{series:pn,dataIdxs:An,seriesIdx:$n,mode:at.tooltip.mode,sortOrder:at.tooltip.sort,isPinned:Bn,maxHeight:at.tooltip.maxHeight}),maxWidth:at.tooltip.maxWidth})]})})};class Wf{getSuggestionsForData(fe){const{dataSummary:be}=fe;return be.numberFieldCount<2||be.rowCountTotal<2||be.rowCountTotal<2?void 0:fe.getListAppender({name:ss.m.LineChart,pluginId:"trend",options:{legend:{calcs:[],displayMode:ut.lm.Hidden,placement:"right",showLegend:!1}},fieldConfig:{defaults:{custom:{}},overrides:[]},cardOptions:{previewModifier:He=>{He.fieldConfig?.defaults.custom?.drawStyle!==ut.GR.Bars&&(He.fieldConfig.defaults.custom.lineWidth=Math.max(He.fieldConfig.defaults.custom.lineWidth??1,2))}}})}}const lu=new C.m(wf).useFieldConfig((0,Aa.V)(Aa.S,!1)).setPanelOptions(Q=>{const fe=["X axis"];Q.addFieldNamePicker({path:"xField",name:"X field",description:"An increasing numeric value",category:fe,defaultValue:void 0,settings:{isClearable:!0,placeholderText:"First numeric value",filter:be=>be.type===jt.PU.number}}),Qn.D(Q,!1,!0),Fn.H(Q)}).setSuggestionsSupplier(new Wf),Ff=[{value:0,label:"Documentation",href:"https://grafana.com/docs/grafana/latest"},{value:1,label:"Tutorials",href:"https://grafana.com/tutorials"},{value:2,label:"Community",href:"https://community.grafana.com"},{value:3,label:"Public Slack",href:"http://slack.grafana.com"}],cu=()=>{const Q=(0,ee.of)(Kf);return(0,T.jsxs)("div",{className:Q.container,children:[(0,T.jsx)("h1",{className:Q.title,children:"Welcome to Grafana"}),(0,T.jsxs)("div",{className:Q.help,children:[(0,T.jsx)("h3",{className:Q.helpText,children:"Need help?"}),(0,T.jsx)("div",{className:Q.helpLinks,children:Ff.map((fe,be)=>(0,T.jsx)("a",{className:Q.helpLink,href:`${fe.href}?utm_source=grafana_gettingstarted`,children:fe.label},`${fe.label}-${be}`))})]})]})},Kf=Q=>({container:(0,te.css)`
      display: flex;
      /// background: url(public/img/g8_home_v2.svg) no-repeat;
      background-size: cover;
      height: 100%;
      align-items: center;
      padding: 0 16px;
      justify-content: space-between;
      padding: 0 ${Q.spacing(3)};

      ${Q.breakpoints.down("lg")} {
        background-position: 0px;
        flex-direction: column;
        align-items: flex-start;
        justify-content: center;
      }

      ${Q.breakpoints.down("sm")} {
        padding: 0 ${Q.spacing(1)};
      }
    `,title:(0,te.css)`
      margin-bottom: 0;

      ${Q.breakpoints.down("lg")} {
        margin-bottom: ${Q.spacing(1)};
      }

      ${Q.breakpoints.down("md")} {
        font-size: ${Q.typography.h2.fontSize};
      }
      ${Q.breakpoints.down("sm")} {
        font-size: ${Q.typography.h3.fontSize};
      }
    `,help:(0,te.css)`
      display: flex;
      align-items: baseline;
    `,helpText:(0,te.css)`
      margin-right: ${Q.spacing(2)};
      margin-bottom: 0;

      ${Q.breakpoints.down("md")} {
        font-size: ${Q.typography.h4.fontSize};
      }

      ${Q.breakpoints.down("sm")} {
        display: none;
      }
    `,helpLinks:(0,te.css)`
      display: flex;
      flex-wrap: wrap;
    `,helpLink:(0,te.css)`
      margin-right: ${Q.spacing(2)};
      text-decoration: underline;
      text-wrap: no-wrap;

      ${Q.breakpoints.down("sm")} {
        margin-right: 8px;
      }
    `}),du=new C.m(cu).setNoPadding(),Hf={"core:plugin/graphite":async()=>await e.e(6134).then(e.bind(e,8652)),"core:plugin/cloudwatch":async()=>await Promise.all([e.e(9045),e.e(2651),e.e(3766)]).then(e.bind(e,92651)),"core:plugin/dashboard":async()=>await e.e(2058).then(e.bind(e,92058)),"core:plugin/elasticsearch":async()=>await Promise.all([e.e(9045),e.e(6144),e.e(8747),e.e(1717)]).then(e.bind(e,18747)),"core:plugin/opentsdb":async()=>await e.e(747).then(e.bind(e,24989)),"core:plugin/grafana":async()=>await e.e(3648).then(e.bind(e,62391)),"core:plugin/influxdb":async()=>await Promise.all([e.e(7774),e.e(9404)]).then(e.bind(e,21106)),"core:plugin/loki":async()=>await Promise.all([e.e(6144),e.e(9430),e.e(1477)]).then(e.bind(e,27049)),"core:plugin/mixed":async()=>await e.e(2513).then(e.bind(e,12870)),"core:plugin/mssql":async()=>await Promise.all([e.e(7774),e.e(9040)]).then(e.bind(e,56694)),"core:plugin/prometheus":async()=>await Promise.all([e.e(9045),e.e(6144),e.e(8314),e.e(9546)]).then(e.bind(e,88314)),"core:plugin/alertmanager":async()=>await Promise.all([e.e(9045),e.e(4737)]).then(e.bind(e,27013)),"core:plugin/text":D,"core:plugin/timeseries":E,"core:plugin/trend":P,"core:plugin/state-timeline":l,"core:plugin/status-history":y,"core:plugin/candlestick":r,"core:plugin/graph":async()=>await Promise.all([e.e(9362),e.e(8068)]).then(e.bind(e,229)),"core:plugin/xychart":async()=>I.$.featureToggles.autoMigrateXYChartPanel?await Promise.all([e.e(8891),e.e(3772)]).then(e.bind(e,80983)):await Promise.all([e.e(707),e.e(5594)]).then(e.bind(e,31552)),"core:plugin/geomap":async()=>await Promise.all([e.e(1698),e.e(707),e.e(7734),e.e(190)]).then(e.bind(e,7734)),"core:plugin/canvas":async()=>await Promise.all([e.e(707),e.e(7523)]).then(e.bind(e,44210)),"core:plugin/dashlist":g,"core:plugin/alertlist":t,"core:plugin/annolist":n,"core:plugin/heatmap":async()=>await Promise.all([e.e(8891),e.e(5857)]).then(e.bind(e,26235)),"core:plugin/table":u,"core:plugin/table-old":async()=>await e.e(8777).then(e.bind(e,78491)),"core:plugin/news":m,"core:plugin/live":d,"core:plugin/stat":Gl,"core:plugin/datagrid":a,"core:plugin/debug":c,"core:plugin/flamegraph":o,"core:plugin/gettingstarted":h,"core:plugin/gauge":zu,"core:plugin/piechart":v,"core:plugin/bargauge":s,"core:plugin/barchart":i,"core:plugin/logs":p,"core:plugin/traces":x,"core:plugin/welcome":b,"core:plugin/nodeGraph":async()=>await Promise.all([e.e(1698),e.e(5511),e.e(7317)]).then(e.bind(e,68403)),"core:plugin/histogram":f};var Ml=e(81900),sc=e(63770),kf=e(52762),ko=e(20582),hu=e(21313),fu=e(72635),Gf=e(34796),Qf=e.n(Gf),Yf=e(95093),Jf=e.n(Yf),Xf=e(28848),ac=e.n(Xf),Zf=e(40961),qf=e(8867),_c=e(71468),zc=e(54625),eg=e(24160),Hc=e(14644),tg=e(75091),gu=e(32975),ng=e(82611),pu=e(75226),mu=e(29317),vu=e(54087),$p=e(80851),Vp=e(32176),_p=e(31221),Sl=e(91520),zp=e(92275),Hp=e(82013),kp=e(2341),Gp=e(19538),sg=e(33459),yu=e(85858),ag=e(7117),rg=e(8984),og=e(91950),xu=e(31140),ig=e(78827),Eu=e(68576),lg=e(92247);const Ol=rg;Ol.PanelPlugin=C.m,Ol.DataSourcePlugin=M.tD,Ol.AppPlugin=O.hX,Ol.DataSourceApi=M.mA;const cg=["jquery.flot.crosshair","jquery.flot.events","jquery.flot.fillbelow","jquery.flot.gauge","jquery.flot.pie","jquery.flot.selection","jquery.flot.stack","jquery.flot.stackpercent","jquery.flot.time","jquery.flot"].reduce((Q,fe)=>({...Q,[fe]:{fakeDep:1}}),{}),dg={"@emotion/css":te,"@emotion/react":kf,"@grafana/data":sg,"@grafana/runtime":ag,"@grafana/slate-react":mu.Ay,"@grafana/ui":Ol,"@kusto/monaco-kusto":ko,"app/core/app_events":{default:Xo.lE,__useDefault:!0},"app/core/config":{default:ce.Ay,__useDefault:!0},"app/core/core":{appEvents:Xo.lE,contextSrv:Xo.TP},"app/core/services/backend_srv":{BackendSrv:ft.Mf,getBackendSrv:ft.AI},"app/core/table_model":{default:og.A,__useDefault:!0},"app/core/time_series":{default:xu.A,__useDefault:!0},"app/core/time_series2":{default:xu.A,__useDefault:!0},"app/core/utils/datemath":yu,"app/core/utils/flatten":ig,"app/core/utils/kbn":{default:Eu.A,__useDefault:!0},"app/core/utils/ticks":lg,"app/features/dashboard/impression_store":{impressions:Mt.A},d3:hu,emotion:te,i18next:fu,jquery:{default:Qf(),__useDefault:!0},...cg,lodash:{default:U(),__useDefault:!0},moment:{default:Jf(),__useDefault:!0},prismjs:ac(),react:K,"react-dom":Zf,"react-inlinesvg":qf,"react-redux":_c,"react-router-dom":zc,"react-router":eg,redux:Hc,rxjs:tg,"rxjs/operators":gu,slate:ng.Ay,"slate-plain-serializer":pu.A,"slate-react":mu.Ay};function rl({url:Q,source:fe,transformSourceMapURL:be=!1,transformAssets:Be=!0}){const He=Q.split("/public/plugins/"),at=He[0],it=He[1].split("/")[0];let Dt=fe;return Be&&(Dt=Dt.replace(/(\/?)(public\/plugins)/g,`${at}/$2`),Dt=Dt.replace(/(["|'])(plugins\/.+?.css)(["|'])/g,`$1${at}/public/$2$3`)),be&&(Dt=Dt.replace(/(\/\/#\ssourceMappingURL=)(.+)\.map/g,`$1${at}/public/plugins/${it}/$2.map`)),Dt}var rc=e(45179),Ei=e(94429);async function ug(Q,fe,be){const Be=await Q(fe,be),He=Be.headers.get("content-type")||"";if(rc.Bu.test(He)){let it=await Be.text();if((0,Ei.OD)(Be.url)){const Dt=rl({url:Be.url,source:it});return new Response(new Blob([Dt],{type:"text/javascript"}))}return new Response(new Blob([it],{type:"text/javascript"}))}return Be}function hg(Q,fe,be){try{const Be=Q.apply(this,[fe,be]),He=gg(Be);return(He.endsWith(".js")||He.endsWith(".css"))&&!(0,Ei.OD)(He)?(0,Ml.ni)(He):He}catch{if(rc.$b.test(fe)){const He=`${I.$.appSubUrl??""}/public/${fe}`,at=Q.apply(this,[He,be]);return(0,Ml.ni)(at)}return console.warn(`SystemJS: failed to resolve '${fe}'`),fe}}function fg(Q,fe){if(new URL(fe,window.location.origin).pathname.endsWith(".css")&&!Q){const He=sc.z.get(fe)?.default;He&&(document.adoptedStyleSheets=[...document.adoptedStyleSheets,He])}}function gg(Q){return Q.startsWith(`${rc.XV}:`)?Q:(Q.endsWith("!")&&(Q=Q.slice(0,-1)),["css","js","json","wasm"].some(Be=>Q.endsWith(Be))?Q:Q+".js")}var pg=e(22055),kc=e(6262),Du=e(35853),Il=e(43429);function mg(Q){const fe=new URL(window.location.href),be=new URL(Q);return fe.host===be.host}async function vg(Q,fe){let be="";if(mg(Q)?(be=await(await fetch(Q)).text(),be=rl({url:Q,source:be,transformSourceMapURL:!0,transformAssets:!1})):(0,Ei.OD)(Q)&&(be=await(await fetch(Q)).text(),be=rl({url:Q,source:be,transformSourceMapURL:!0,transformAssets:!0})),be.length===0)throw new Error("Only same domain scripts are allowed in sandboxed plugins");be=ol(be),fe.evaluate(be)}async function yg(Q){if((0,Ei.OD)(Q.module)){const fe=Q.module;let Be=await(await fetch(fe)).text();return Be=rl({url:fe,source:Be,transformSourceMapURL:!0,transformAssets:!0}),Be}else{let fe=(0,Ei.Av)(Q.module);const be=(0,Ml.ni)(fe);let He=await(await fetch(be)).text();return He=rl({url:be,source:He,transformSourceMapURL:!0,transformAssets:!1}),He=ol(He),He}}function ol(Q){return Q.replace(/window\.location/gi,"window.locationSandbox")}function Pu(Q){Q.evaluate(`${Du.V.toString()};${Du.V.name}()`)}function oc(Q){for(const fe of Object.values(I.$.datasources))if(fe.type===Q)return fe.meta;for(const fe of Object.values(I.$.panels))if(fe.id===Q)return fe;for(const fe of Object.values(I.$.apps))if(fe.id===Q)return{id:Q,type:Il.QE.app,module:fe.path};throw new Error(`Could not find plugin ${Q}`)}const Di=["iframe"];var Gc=e(7077),xg=e(29505),Eg=e(34867),Dg=e(27716);const Pg=!!I.$.featureToggles.frontendSandboxMonitorOnly;function bg(Q){return!!Q&&typeof Q=="object"&&Q?.hasOwnProperty("plugin")}function Qp(Q){throw new Error(`Unexpected object: ${Q}. This should never happen.`)}const Qc=(0,Eg.DW)("sandbox",{monitorOnly:String(Pg)});function bu(Q){return Q instanceof K.Component}function Lo(Q,fe){Qc.logWarning(Q,fe)}function Al(Q,fe){Qc.logError(Q,fe)}function Cu(Q,fe){Qc.logInfo(Q,fe)}async function Cg({isAngular:Q,pluginId:fe}){if(!I.$.featureToggles.pluginsFrontendSandbox||Q||location.search.includes("nosandbox")&&I.$.buildInfo.env==="development"||I.$.disableFrontendSandboxForPlugins.includes(fe))return!1;const He=await(0,Dg.x)(fe);return!(He.type===Il.QE.app&&He.signatureType===Il.kv.grafana)}function Tg(Q){return Q?.constructor?.name==="RegExp"}function Yc(Q){return Q&&(Tg(Q)&&(0,Gc.U)(Q)?new RegExp(Q):Array.isArray(Q)?Q.map(Yc):typeof Q=="object"?Object.keys(Q).reduce((fe,be)=>(Reflect.set(fe,be,Yc(Reflect.get(Q,be))),fe),{}):Q)}function Jc(Q){return Q&&((0,Gc.U)(Q)?(0,B.cloneDeep)(Q):Array.isArray(Q)?Q.map(Jc):typeof Q=="object"?Object.keys(Q).reduce((fe,be)=>(Reflect.set(fe,be,Jc(Reflect.get(Q,be))),fe),{}):Q)}const Pi=Symbol.for("@@SANDBOX_LIVE_VALUE"),Tu=!!I.$.featureToggles.frontendSandboxMonitorOnly;function Mg(Q,fe){const be=Reflect.get(Q,"nodeName");if(be==="body"||Q===document.body)return document.body;if(be==="head"||Q===document.head||Q===document.documentElement)return Q;if(Di.includes(be)&&(Lo("<"+be+"> is not allowed in sandboxed plugins",{pluginId:fe,param:be}),!Tu))throw new Error("<"+be+"> is not allowed in sandboxed plugins");if(Ag(Q,fe)||Q.parentNode===document.body||Q.closest("#reactRoot")===null||Tu)return Q;{const Be=document.createElement(be);return Be.dataset.grafanaPluginSandboxElement="true",Be}}function Sg(Q){if(typeof Q=="object"&&Q instanceof Element)try{return Q.nodeName!==void 0}catch{return!1}return!1}function Og(Q){const fe=Reflect.get(Q,"style");Object.hasOwn(fe,Pi)||Reflect.defineProperty(fe,Pi,{})}function ic(Q){Q&&(Array.isArray(Q)?(Q.forEach(ic),Xc(Q)):typeof Q=="object"&&(Object.values(Q).forEach(ic),Xc(Q)))}function Xc(Q){if(Q)return Object.hasOwn(Q,Pi)||Reflect.defineProperty(Q,Pi,{}),Q}function Ig(Q){Q&&(Object.hasOwn(Q,Pi)||((0,Gc.U)(Q)&&!(Q instanceof Function)&&(bu(Q)||Q instanceof M.mA||Q instanceof xg.f5)?Reflect.defineProperty(Q,Pi,{}):Q===ac().languages&&Object.defineProperty(Q,Pi,{})))}function Zc(Q){return Object.hasOwn(Q,Pi)}function Ag(Q,fe){return!document.contains(Q)||Q.closest(`[data-plugin-sandbox=${fe}]`)!==null}let So;function Rg(){return So||(So=document.createElement("div"),So.setAttribute("id","grafana-plugin-sandbox-body"),So.setAttribute("data-plugin-sandbox","true"),So.dataset.pluginSandbox="sandboxed-plugin",So.style.width="100%",So.style.height="0%",So.style.overflow="hidden",So.style.top="0",So.style.left="0",document.body.appendChild(So)),So}let qc=!1;function Yp(){qc||(qc=!0,Lg(),Jp())}function Jp(){const Q=Worker.prototype.postMessage;Object.defineProperty(Worker.prototype,"postMessage",{value:function(...fe){return Q.apply(this,Jc(fe))}})}function Lg(){const Q=window.history.replaceState;Object.defineProperty(window.history,"replaceState",{value:function(...fe){let be=fe;try{be=(0,B.cloneDeep)(fe)}catch(Be){Lo("Error cloning args in window.history.replaceState",{error:String(Be)})}return Reflect.apply(Q,this,be)},writable:!0,configurable:!0,enumerable:!1})}const so=new Map,Go=!!I.$.featureToggles.frontendSandboxMonitorOnly,Mu=Symbol.for("@SANDBOX_LIVE_API_PATCHED");function jg(){return so.size===0&&(Bg(so),Ug(so),Ng(so),Kg(so),Fg(so),wg(so),Wg(so),$g(so),Vg(so),Su(so),_g(so),Hg(so)),so}function lc(Q,fe){return Lo(`Plugin ${fe.id} tried to set a sandboxed property`,{pluginId:fe.id,attrOrMethod:String(Q),entity:"window"}),Go?Q:()=>{throw new Error("Plugins are not allowed to set sandboxed properties")}}function Bg(Q){const fe=["contentDocument","contentWindow","src","srcdoc","srcObject","srcset"];for(const Be of fe){const He=Object.getOwnPropertyDescriptor(HTMLIFrameElement.prototype,Be);if(He){let at=function(it,Dt){const Ot=Dt.id;return Lo(`Plugin ${Ot} tried to access iframe.${Be}`,{pluginId:Ot,attrOrMethod:Be,entity:"iframe"}),Go?it:()=>{throw new Error("iframe."+Be+" is not allowed in sandboxed plugins")}};var be=at;He.value&&Q.set(He.value,at),He.set&&Q.set(He.set,at),He.get&&Q.set(He.get,at)}}}function Ug(Q){const fe=Object.getOwnPropertyDescriptor(window,"console");if(fe?.value){let Be=function(He,at){const it=at.id;if(Go)return He;function Dt(...Ot){console.log(`[plugin ${it}]`,...Ot)}return{log:Dt,warn:Dt,error:Dt,info:Dt,debug:Dt,table:Dt}};var be=Be;Q.set(fe.value,Be)}fe?.set&&Q.set(fe.set,lc)}function Ng(Q){function fe(Be,He){const at=He.id;return Lo(`Plugin ${at} accessed window.alert`,{pluginId:at,attrOrMethod:"alert",entity:"window"}),Go?Be:function(...it){console.log(`[plugin ${at}]`,...it)}}const be=Object.getOwnPropertyDescriptor(window,"alert");be?.value&&Q.set(be.value,fe),be?.set&&Q.set(be.set,lc)}function wg(Q){function fe(Be,He){const at=He.id;return function(...Dt){for(const Ot of Dt){const wt=String(Ot||"").toLowerCase();for(const _t of Di)if(wt.includes("<"+_t)){if(Lo(`Plugin ${at} tried to set ${_t} in innerHTML`,{pluginId:at,attrOrMethod:"innerHTML",param:_t,entity:"HTMLElement"}),Go)continue;throw new Error("<"+_t+"> is not allowed in sandboxed plugins")}}if((0,B.isFunction)(Be))return Be.apply(this,Dt)}}const be=[Object.getOwnPropertyDescriptor(Element.prototype,"innerHTML"),Object.getOwnPropertyDescriptor(Element.prototype,"outerHTML"),Object.getOwnPropertyDescriptor(Element.prototype,"insertAdjacentHTML"),Object.getOwnPropertyDescriptor(DOMParser.prototype,"parseFromString")];for(const Be of be)Be?.set&&Q.set(Be.set,fe),Be?.value&&Q.set(Be.value,fe)}function Wg(Q){function fe(Be,He){const at=He.id;return function(Dt,Ot){if(Dt&&Di.includes(Dt)&&(Lo(`Plugin ${at} tried to create ${Dt}`,{pluginId:at,attrOrMethod:"createElement",param:Dt,entity:"document"}),!Go))return document.createDocumentFragment();if((0,B.isFunction)(Be))return Be.apply(this,[Dt,Ot])}}const be=Object.getOwnPropertyDescriptor(Document.prototype,"createElement");be?.value&&Q.set(be.value,fe)}function Fg(Q){function fe(at,it){const Dt=it.id;return function(wt,_t){const Qt=wt?.nodeName?.toLowerCase()||"";if(wt&&Di.includes(Qt)&&(Lo(`Plugin ${Dt} tried to insert ${Qt}`,{pluginId:Dt,attrOrMethod:"insertChild",param:Qt,entity:"HTMLElement"}),!Go))return document.createDocumentFragment();if((0,B.isFunction)(at))return at.call(this,wt,_t)}}function be(at,it){const Dt=it.id;return function(wt,_t){const Qt=_t?.nodeName?.toLowerCase()||"";if(_t&&Di.includes(Qt)&&(Lo(`Plugin ${Dt} tried to insert ${Qt}`,{pluginId:Dt,attrOrMethod:"insertAdjacentElement",param:Qt,entity:"HTMLElement"}),!Go))return document.createDocumentFragment();if((0,B.isFunction)(at))return at.call(this,wt,_t)}}const Be=[Object.getOwnPropertyDescriptor(Node.prototype,"insertBefore"),Object.getOwnPropertyDescriptor(Node.prototype,"replaceChild")];for(const at of Be)at?.value&&Q.set(at.set,fe);const He=Object.getOwnPropertyDescriptor(Element.prototype,"insertAdjacentElement");He?.value&&Q.set(He.set,be)}function Kg(Q){function fe(at,it){const Dt=it.id;return function(...wt){let _t=wt;const Qt=wt?.filter(rn=>!Di.includes(rn.nodeName.toLowerCase()));Go||(_t=Qt),_t.length!==Qt.length&&Lo(`Plugin ${Dt} tried to append fobiddenElements`,{pluginId:Dt,attrOrMethod:"append",param:wt?.filter(rn=>Di.includes(rn.nodeName.toLowerCase()))?.join(",")||"",entity:"HTMLElement"}),(0,B.isFunction)(at)&&at.apply(this,_t)}}function be(at,it,Dt){const Ot=it.id;return function(_t){const Qt=_t?.nodeName?.toLowerCase()||"";if(_t&&Di.includes(Qt)&&(Lo(`Plugin ${Ot} tried to append ${Qt}`,{pluginId:Ot,attrOrMethod:"appendChild",param:Qt,entity:"HTMLElement"}),!Go))return document.createDocumentFragment();if(Dt&&_t&&Qt==="script"&&_t instanceof HTMLScriptElement){vg(_t.src,Dt).then(()=>{_t.onload?.call(_t,new Event("load"))}).catch(rn=>{_t.onerror?.call(_t,new ErrorEvent("error",{error:rn}))});return}if((0,B.isFunction)(at))return at.call(this,_t)}}const Be=[Object.getOwnPropertyDescriptor(Element.prototype,"append"),Object.getOwnPropertyDescriptor(Element.prototype,"prepend"),Object.getOwnPropertyDescriptor(Element.prototype,"after"),Object.getOwnPropertyDescriptor(Element.prototype,"before"),Object.getOwnPropertyDescriptor(Document.prototype,"append"),Object.getOwnPropertyDescriptor(Document.prototype,"prepend")];for(const at of Be)at?.value&&Q.set(at.value,fe);const He=Object.getOwnPropertyDescriptor(Node.prototype,"appendChild");He?.value&&Q.set(He.value,be)}function $g(Q){const fe=Object.getOwnPropertyDescriptor(Worker.prototype,"postMessage");function be(Be){return function(...at){try{const it=(0,B.cloneDeep)(at);(0,B.isFunction)(Be)&&Be.apply(this,it)}catch{throw new Error("postMessage arguments are invalid objects")}}}fe?.value&&Q.set(fe.value,be)}function Vg(Q){const fe=Object.getOwnPropertyDescriptor(Document.prototype,"defaultView");fe?.get&&Q.set(fe.get,()=>()=>window);const be=["write"];for(const Be of be){const He=Object.getOwnPropertyDescriptor(Document.prototype,Be);He?.set&&Q.set(He.set,lc),He?.value&&Q.set(He.value,lc)}}async function Su(Q){const fe=Reflect.get(window,"monaco");if(!fe||Object.hasOwn(fe,Mu))return;const be=fe.languages.setMonarchTokensProvider;function Be(){return function(...He){return He.length!==2?be.apply(fe,He):be.call(fe,He[0],Yc(He[1]))}}Q.set(fe.languages.setMonarchTokensProvider,Be),Reflect.set(fe,Mu,{})}async function _g(Q){const fe=Object.getOwnPropertyDescriptor(window,"postMessage");function be(Be){return function(...at){try{const it=(0,B.cloneDeep)(at);(0,B.isFunction)(Be)&&Be.apply(this,it)}catch{throw new Error("postMessage arguments are invalid objects")}}}fe?.value&&Q.set(fe.value,be)}function zg(Q){Su(so)}function Hg(Q){function fe(be){return(0,B.isFunction)(be)?function(...Be){const He=be.apply(this,Be);return ic(He),He}:be}Q.set(B.cloneDeep,fe)}var kg=e(66161);async function Gg(Q,fe){if(!bg(Q))return Q;const be=await Promise.resolve(Q.plugin);if(Reflect.has(be,"panel")&&Reflect.set(be,"panel",Rl(Reflect.get(be,"panel"),fe)),Reflect.has(be,"components")){const Be=Reflect.get(be,"components");Object.entries(Be).forEach(([He,at])=>{Reflect.set(Be,He,Rl(at,fe))}),Reflect.set(be,"components",Be)}if(Reflect.has(be,"root")&&Reflect.set(be,"root",Rl(Reflect.get(be,"root"),fe)),Reflect.has(be,"extensionConfigs")){const Be=Reflect.get(be,"extensionConfigs");for(const He of Be)Reflect.has(He,"component")&&Reflect.set(He,"component",Rl(Reflect.get(He,"component"),fe));Reflect.set(be,"extensionConfigs",Be)}if(Reflect.has(be,"configPages")){const Be=Reflect.get(be,"configPages")??[];for(const[He,at]of Object.entries(Be))!at.body||!(0,B.isFunction)(at.body)||Reflect.set(Be,He,{...at,body:Rl(at.body,fe)});Reflect.set(be,"configPages",Be)}return Q}const Rl=(Q,fe)=>{const be=K.memo(Be=>(0,T.jsx)("div",{"data-plugin-sandbox":fe.id,style:{height:fe.type===Il.QE.app||fe.type===Il.QE.panel?"100%":"auto"},children:(0,T.jsx)(Q,{...Be})}));return be.displayName=`GrafanaSandbox(${Q.displayName||Q.name||"Component"})`,be},ed=new Map,Ou={};async function Qg({pluginId:Q}){Yp();try{const fe=oc(Q);return ed.has(Q)||ed.set(Q,Yg(fe)),ed.get(Q)}catch(fe){const be=new Error(`Could not import plugin ${Q} inside sandbox: `+fe);throw Al(be,{pluginId:Q,error:String(fe)}),be}}async function Yg(Q){return Cu("Loading with sandbox",{pluginId:Q.id}),new Promise(async(fe,be)=>{const Be=jg();let He;function at(Dt){if(Sg(Dt)){const _t=Mg(Dt,Q.id);return Og(_t),_t}else Ig(Dt);const Ot=Be.get(Dt);if(Ot)return Ot(Dt,Q,He);const wt=zg(Dt);return wt||Dt}He=(0,pg.A)(window,{distortionCallback:at,defaultPolicy:kc.G,liveTargetCallback:Zc,endowments:Object.getOwnPropertyDescriptors({locationSandbox:window.location,setImmediate:function(Dt,...Ot){return setTimeout(Dt,0,...Ot)},get monaco(){return Reflect.get(window,"monaco")},get Prism(){return Reflect.get(window,"Prism")},get jQuery(){return Reflect.get(window,"jQuery")},get $(){return Reflect.get(window,"jQuery")},get grafanaBootData(){if(Ou[Q.id+"-grafanaBootData"]||(Ou[Q.id+"-grafanaBootData"]=!0,Cu("Plugin using window.grafanaBootData",{sandbox:"true",pluginId:Q.id,guessedPluginName:Q.id,parent:"window",packageName:"window",key:"grafanaBootData"})),I.$.buildInfo.env==="development")throw new Error(`Error in ${Q.id}: Plugins should not use window.grafanaBootData. Use "config" from "@grafana/runtime" instead.`);return console.error(`${Q.id.toUpperCase()}: Plugins should not use window.grafanaBootData. Use "config" from "@grafana/runtime" instead.`),I.$.bootData},async define(Dt,Ot,wt){let _t,Qt;Array.isArray(Dt)?(_t=Dt,Qt=Ot):(_t=Ot,Qt=wt);try{const rn=Jg(_t,Q),kt=Qt.apply(null,rn),pn=await Gg(kt,Q);fe(pn)}catch(rn){const kt=new Error(`Could not execute plugin's define ${Q.id}: `+rn);Al(kt,{pluginId:Q.id,error:String(rn)}),be(kt)}}})}),Pu(He);let it="";try{it=await yg(Q)}catch(Dt){const Ot=new Error(`Could not load plugin code ${Q.id}: `+Dt);Al(Ot,{pluginId:Q.id,error:String(Dt)}),be(Ot)}try{He.evaluate(it)}catch(Dt){const Ot=new Error(`Could not run plugin ${Q.id} inside sandbox: `+Dt);Al(Ot,{pluginId:Q.id,error:String(Dt)}),be(Ot)}})}function Jg(Q,fe){const be={},Be={id:fe.id,uri:fe.module,exports:be},He=[];for(const at of Q){let it=kg.s.get(at);if(it?.__useDefault&&(it=it.default),at==="module"&&(it=Be),at==="exports"&&(it=be),!it){const Dt=new Error(`[sandbox] Could not resolve dependency ${at}`);throw Al(Dt,{pluginId:fe.id,dependency:at,error:String(Dt)}),Dt}He.push(it)}return He}const Xg=(0,Ei.kB)(dg);sc.z.addImportMap({imports:Xg});const ei=sc.z.constructor.prototype;ei.shouldFetch=function(Q){const fe=(0,Ml.QO)(Q),be=/^[^#?]+\.(js)([?#].*)?$/;return(0,Ei.OD)(Q)||!!fe?.isAngular||!be.test(Q)};const Zg=ei.import;ei.import=function(...Q){return Zg.apply(this,Q).then(fe=>fe&&fe.__useDefault?fe.default:fe)};const qg=ei.fetch;ei.fetch=function(Q,fe){return ug(qg,Q,fe)};const ep=ei.resolve;ei.resolve=hg.bind(ei,ep),ei.onload=fg;async function td({path:Q,version:fe,isAngular:be,pluginId:Be}){fe&&(0,Ml.GD)({pluginId:Be,version:fe,isAngular:be});const He=Hf[Q];if(He)return typeof He=="function"?await He():He;let at=(0,Ei.Av)(Q);return await Cg({isAngular:be,pluginId:Be})?Qg({pluginId:Be}):sc.z.import(at)}function tp(Q){const fe=Q.angular?.detected??Q.angularDetected;return td({path:Q.module,version:Q.info?.version,isAngular:fe,pluginId:Q.id}).then(be=>{if(be.plugin){const Be=be.plugin;return Be.meta=Q,Be}if(be.Datasource){const Be=new M.tD(be.Datasource);return Be.setComponentsFromLegacyExports(be),Be.meta=Q,Be}throw new Error("Plugin module is missing DataSourcePlugin or Datasource constructor export")})}function np(Q){const fe=Q.angular?.detected??Q.angularDetected;return td({path:Q.module,version:Q.info?.version,isAngular:fe,pluginId:Q.id}).then(be=>{const Be=be.plugin?be.plugin:new O.hX;return Be.init(Q),Be.meta=Q,Be.setComponentsFromLegacyExports(be),Be})}},66161:(k,R,e)=>{"use strict";e.d(R,{s:()=>t});const t=new Map([])},60677:(k,R,e)=>{"use strict";e.d(R,{W3:()=>g,Wy:()=>a,z4:()=>c});var t=e(43429),n=e(34867),i=e(15162),s=e(27716),r=e(59421);async function g(o){const h=await(0,s.x)(o);let f;if(h.type===t.QE.app&&(f=await(0,r.ui)(h)),h.type===t.QE.datasource&&(f=await(0,r.cS)(h)),h.type===t.QE.panel&&(f=await(0,i.Kk)(h)),h.type===t.QE.renderer&&(f={meta:h}),!f)throw new Error("Unknown Plugin type: "+h.type);return f}function a(o,h,f){let p={...o},m;function v(y,u){return!u.startsWith(y.url??"")||m&&(m.url?.length??0)>(y.url?.length??0)?y:(m&&(m.active=!1),m={...y,active:!0},m)}function l(y,u=0){if(u>10)return y;if(y.children){const D=y.children.map(E=>l(E,u+1));return{...v(y,f),children:D}}return v(y,f)}return p.children=(p?.children??[]).map(l),{main:p,node:m??p}}const c=(0,n.DW)("features.plugins")},81862:(k,R,e)=>{"use strict";e.d(R,{Ay:()=>I,Cj:()=>f,HO:()=>u,Mj:()=>m,Nm:()=>p,Q9:()=>y,RS:()=>x,c1:()=>h,g$:()=>D,ny:()=>v,ri:()=>l,uh:()=>E,xu:()=>d});var t=e(65307),n=e(2543),i=e.n(n),s=e(72724),r=e(47232),g=e(2913),a=e(10096);const c={orgId:g.Ay.bootData.user.orgId,timeZone:g.Ay.bootData.user.timezone,weekStart:g.Ay.bootData.user.weekStart,fiscalYearStartMonth:0,orgsAreLoading:!1,sessionsAreLoading:!1,teamsAreLoading:!1,isUpdating:!1,orgs:[],sessions:[],teams:[],user:null},o=(0,t.Z0)({name:"user/profile",initialState:c,reducers:{updateTimeZone:(T,C)=>{T.timeZone=C.payload.timeZone},updateWeekStart:(T,C)=>{T.weekStart=C.payload.weekStart},updateFiscalYearStartMonth:(T,C)=>{T.fiscalYearStartMonth=C.payload.fiscalYearStartMonth},setUpdating:(T,C)=>{T.isUpdating=C.payload.updating},userLoaded:(T,C)=>{T.user=C.payload.user},initLoadTeams:(T,C)=>{T.teamsAreLoading=!0},teamsLoaded:(T,C)=>{T.teams=C.payload.teams,T.teamsAreLoading=!1},initLoadOrgs:(T,C)=>{T.orgsAreLoading=!0},orgsLoaded:(T,C)=>{T.orgs=C.payload.orgs,T.orgsAreLoading=!1},initLoadSessions:(T,C)=>{T.sessionsAreLoading=!0},sessionsLoaded:(T,C)=>{const S=C.payload.sessions.sort((A,L)=>Number(L.isActive)-Number(A.isActive));T.sessions=S.map(A=>({id:A.id,isActive:A.isActive,seenAt:(0,s.fq)(A.seenAt),createdAt:A.createdAt,clientIp:A.clientIp,browser:A.browser,browserVersion:A.browserVersion,os:A.os,osVersion:A.osVersion,device:A.device})),T.sessionsAreLoading=!1},userSessionRevoked:(T,C)=>{T.sessions=T.sessions.filter(S=>S.id!==C.payload.tokenId),T.isUpdating=!1}}}),h=T=>async C=>{(0,n.set)(a.TP,"user.fiscalYearStartMonth",T),C(M({fiscalYearStartMonth:T}))},f=T=>async C=>{(!(0,n.isString)(T)||(0,n.isEmpty)(T))&&(T=g.Ay?.bootData?.user?.timezone),(0,n.set)(a.TP,"user.timezone",T),C(P({timeZone:T}))},d=T=>async C=>{(!(0,n.isString)(T)||(0,n.isEmpty)(T))&&(T=g.Ay?.bootData?.user?.weekStart),(0,n.set)(a.TP,"user.weekStart",T),C(b({weekStart:T})),(0,r.$D)(T)},{setUpdating:p,initLoadOrgs:m,orgsLoaded:v,initLoadTeams:l,teamsLoaded:y,userLoaded:u,userSessionRevoked:D,initLoadSessions:E,sessionsLoaded:x,updateTimeZone:P,updateWeekStart:b,updateFiscalYearStartMonth:M}=o.actions,O=o.reducer,I={user:o.reducer}},32901:(k,R,e)=>{"use strict";e.d(R,{O:()=>t,q:()=>n});const t=i=>i.timeZone,n=i=>i.fiscalYearStartMonth},2858:(k,R,e)=>{"use strict";e.d(R,{g:()=>a});var t=e(75816),n=e(56389);const i="grafana.app/createdBy",s=c=>c||void 0,r=c=>c.items?c.items.map(o=>({uid:o.metadata.name||"",title:o.spec.title,targets:o.spec.targets.map(h=>h.properties),createdAtTimestamp:new Date(o.metadata.creationTimestamp||"").getTime(),user:s(o.metadata?.annotations?.[i])})):[],g=c=>{const{title:o,targets:h}=c;return{apiVersion:n.mG,kind:n.GY.QueryTemplate,metadata:{generateName:"A"+o.replaceAll(" ","-")},spec:{title:o,vars:[],targets:h.map(f=>({variables:{},properties:f}))}}},a=(0,t.xP)({baseQuery:n.Su,tagTypes:["QueryTemplatesList"],endpoints:c=>({allQueryTemplates:c.query({query:()=>({}),transformResponse:r,providesTags:["QueryTemplatesList"]}),addQueryTemplate:c.mutation({query:o=>({method:"POST",data:g(o)}),invalidatesTags:["QueryTemplatesList"]}),deleteQueryTemplate:c.mutation({query:({uid:o})=>({url:`${o}`,method:"DELETE"}),invalidatesTags:["QueryTemplatesList"]})}),reducerPath:"queryLibrary"})},56389:(k,R,e)=>{"use strict";e.d(R,{C1:()=>g,GY:()=>r,Su:()=>a,mG:()=>s});var t=e(75505),n=e(32264),i=e(17172);const s="peakq.grafana.app/v0alpha1";var r=(c=>(c.QueryTemplate="QueryTemplate",c))(r||{});const g=`/apis/${s}/namespaces/${n.$.namespace}/querytemplates/`,a=async c=>{try{const o=(0,i.AI)().fetch({url:`${g}${c.url??""}`,showErrorAlert:!0,method:c.method||"GET",data:c.data});return await(0,t.s)(o)}catch(o){return(0,i.NF)(o)?{error:new Error(o.data.message)}:o instanceof Error?{error:o}:{error:new Error("Unknown error")}}}},64152:(k,R,e)=>{"use strict";e.d(R,{d:()=>i,m:()=>n});class t{constructor(){this.extraRenderActions=[],this.keyedScopedExtraRenderActions=new Map}addExtraRenderAction(r){this.extraRenderActions=this.extraRenderActions.concat(r)}addKeyedExtraRenderAction(r,g){this.keyedScopedExtraRenderActions.set(r,g)}getAllExtraRenderAction(){return this.extraRenderActions}getScopedExtraRenderAction(r){return Array.from(this.keyedScopedExtraRenderActions,a=>a[1]).filter(a=>a.scope===r).map(a=>a.queryActionComponent)}}const n=new t,i=new t},48514:(k,R,e)=>{"use strict";e.d(R,{c:()=>V,E:()=>Y});var t=e(74848),n=e(46942),i=e.n(n),s=e(2543),r=e(55127),g=e.n(r),a=e(96540),c=e(41987),o=e(76287),h=e(22391),f=e(18226),d=e(39070),p=e(14236),m=e(26272),v=e(13544),l=e(19347),y=e(7376),u=e(14110),D=e(39938),E=e(66602),x=e(22214),P=e(10343),b=e(7788),M=e(8484),O=e(74856),I=e(84423),T=e(64152),C=e(32196),S=e(40845),A=e(14578),L=e(10354),N=e(72093),F=e(51612);const w=X=>{const{query:J,queries:q,onChange:ae,collapsedText:j,renderExtras:te,hidden:ne}=X,le=(0,S.of)(U),[z,ee]=(0,a.useState)(!1),[se,ie]=(0,a.useState)(null),Z=De=>{ee(!0)},oe=De=>{if(ee(!1),se){ie(null);return}J.refId!==De&&ae({...J,refId:De})},ce=De=>{const ge=De.currentTarget.value.trim();if(ge.length===0){ie("An empty query name is not allowed");return}for(const Te of q)if(Te!==J&&ge===Te.refId){ie("Query name already exists");return}se&&ie(null)},ye=De=>{oe(De.currentTarget.value.trim())},re=De=>{De.key==="Enter"&&oe(De.currentTarget.value)},ue=De=>{De.target.select()};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:le.wrapper,children:[!z&&(0,t.jsxs)("button",{className:le.queryNameWrapper,"aria-label":v.Tp.components.QueryEditorRow.title(J.refId),title:"Edit query name",onClick:Z,"data-testid":"query-name-div",type:"button",children:[(0,t.jsx)("span",{className:le.queryName,children:J.refId}),(0,t.jsx)(A.I,{name:"pen",className:le.queryEditIcon,size:"sm"})]}),z&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(L.p,{type:"text",defaultValue:J.refId,onBlur:ye,autoFocus:!0,onKeyDown:re,onFocus:ue,invalid:se!==null,onChange:ce,className:le.queryNameInput,"data-testid":"query-name-input"}),se&&(0,t.jsx)(N.P,{horizontal:!0,children:se})]}),B(X,le),te&&(0,t.jsx)("div",{className:le.itemWrapper,children:te()}),ne&&(0,t.jsx)("em",{className:le.contextInfo,children:"Hidden"})]}),j&&(0,t.jsx)("div",{className:le.collapsedText,children:j})]})},B=(X,J)=>{const{alerting:q,dataSource:ae,onChangeDataSource:j}=X;return j?(0,t.jsx)("div",{className:J.itemWrapper,children:(0,t.jsx)(F.s,{variables:!0,alerting:q,current:ae.name,onChange:j})}):(0,t.jsxs)("em",{className:J.contextInfo,children:["(",ae.name,")"]})},U=X=>({wrapper:(0,C.css)`
      label: Wrapper;
      display: flex;
      align-items: center;
      margin-left: ${X.spacing(.5)};
      overflow: hidden;
    `,queryNameWrapper:(0,C.css)`
      display: flex;
      cursor: pointer;
      border: 1px solid transparent;
      border-radius: ${X.shape.borderRadius(2)};
      align-items: center;
      padding: 0 0 0 ${X.spacing(.5)};
      margin: 0;
      background: transparent;
      overflow: hidden;

      &:hover {
        background: ${X.colors.action.hover};
        border: 1px dashed ${X.colors.border.strong};
      }

      &:focus {
        border: 2px solid ${X.colors.primary.border};
      }

      &:hover,
      &:focus {
        .query-name-edit-icon {
          visibility: visible;
        }
      }
    `,queryName:(0,C.css)`
      font-weight: ${X.typography.fontWeightMedium};
      color: ${X.colors.primary.text};
      cursor: pointer;
      overflow: hidden;
      margin-left: ${X.spacing(.5)};
    `,queryEditIcon:(0,C.cx)((0,C.css)`
        margin-left: ${X.spacing(2)};
        visibility: hidden;
      `,"query-name-edit-icon"),queryNameInput:(0,C.css)`
      max-width: 300px;
      margin: -4px 0;
    `,collapsedText:(0,C.css)`
      font-weight: ${X.typography.fontWeightRegular};
      font-size: ${X.typography.bodySmall.fontSize};
      color: ${X.colors.text.secondary};
      padding-left: ${X.spacing(1)};
      align-items: center;
      overflow: hidden;
      font-style: italic;
      white-space: nowrap;
      text-overflow: ellipsis;
    `,contextInfo:(0,C.css)`
      font-size: ${X.typography.bodySmall.fontSize};
      font-style: italic;
      color: ${X.colors.text.secondary};
      padding-left: 10px;
      padding-right: 10px;
    `,itemWrapper:(0,C.css)`
      display: flex;
      margin-left: 4px;
    `});var K=e(84959);class V extends a.PureComponent{constructor(){super(...arguments),this.element=null,this.angularScope=null,this.angularQueryEditor=null,this.dataSourceSrv=(0,l.l)(),this.id="",this.state={datasource:null,hasTextEditMode:!1,data:void 0,isOpen:!0,showingHelp:!1},this.renderAngularQueryEditor=()=>{if(!this.element)return;this.angularQueryEditor&&(this.angularQueryEditor.destroy(),this.angularQueryEditor=null);const J=(0,y.E)(),q='<plugin-component type="query-ctrl" />',ae={ctrl:this.getAngularQueryComponentScope()};this.angularQueryEditor=J.load(this.element,ae,q),this.angularScope=ae.ctrl},this.onOpen=()=>{this.renderAngularQueryEditor()},this.renderPluginEditor=()=>{const{query:J,onChange:q,queries:ae,onRunQuery:j,onAddQuery:te,app:ne=c.Jk.PanelEditor,history:le}=this.props,{datasource:z,data:ee}=this.state;if(this.isWaitingForDatasourceToLoad())return null;if(z?.components?.QueryCtrl)return(0,t.jsx)("div",{ref:se=>this.element=se});if(z){let se=this.getReactQueryEditor(z);if(se)return(0,t.jsx)(o.p,{instanceSettings:this.props.dataSource,children:(0,t.jsx)(se,{query:J,datasource:z,onChange:q,onRunQuery:j,onAddQuery:te,data:ee,range:(0,O.jG)().timeRange(),queries:ae,app:ne,history:le},z?.name)})}return(0,t.jsx)("div",{children:(0,t.jsx)(M.x6,{i18nKey:"query-operation.query-editor-not-exported",children:"Data source plugin does not export any Query Editor component"})})},this.onToggleEditMode=(J,q)=>{J.stopPropagation(),this.angularScope&&this.angularScope.toggleEditorMode&&(this.angularScope.toggleEditorMode(),this.angularQueryEditor?.digest(),q.isOpen||q.onOpen())},this.onRemoveQuery=()=>{const{onRemoveQuery:J,query:q,onQueryRemoved:ae}=this.props;J(q),ae&&ae()},this.onCopyQuery=()=>{const{query:J,onAddQuery:q,onQueryCopied:ae}=this.props,j=(0,s.cloneDeep)(J);q(j),ae&&ae()},this.onHideQuery=()=>{const{query:J,onChange:q,onRunQuery:ae,onQueryToggled:j}=this.props;q({...J,hide:!J.hide}),ae(),j&&j(J.hide),(0,u.rR)("query_editor_row_hide_query_clicked",{hide:!J.hide})},this.onToggleHelp=()=>{this.setState(J=>({showingHelp:!J.showingHelp}))},this.onClickExample=J=>{J.datasource===void 0&&(J.datasource=(0,h.p$)(this.props.dataSource)),this.props.onChange({...J,refId:this.props.query.refId}),this.onToggleHelp()},this.renderWarnings=()=>{const{data:J,query:q}=this.props,j=(Y(J,q.refId)?.series??[]).reduce((z,ee)=>{if(!ee.meta?.notices)return z;const se=(0,s.filter)(ee.meta.notices,{severity:"warning"})??[];return z.concat(se)},[]),te=(0,s.uniqBy)(j,"text");if(!(te.length>0))return null;const le=te.map(z=>z.text).join(`
`);return(0,t.jsx)(D.E,{color:"orange",icon:"exclamation-triangle",text:(0,t.jsxs)(t.Fragment,{children:[te.length," ",g()("warning",te.length)]}),tooltip:le},"query-warning")},this.renderExtraActions=()=>{const{query:J,queries:q,data:ae,onAddQuery:j,dataSource:te,app:ne}=this.props,le=T.d.getAllExtraRenderAction();let z=[];ne!==void 0&&(z=T.d.getScopedExtraRenderAction(ne));const ee=[...le,...z].map((se,ie)=>se({query:J,queries:q,timeRange:ae.timeRange,onAddQuery:j,dataSource:te,key:ie})).filter(Boolean);return ee.push(this.renderWarnings()),ee},this.renderActions=J=>{const{query:q,hideHideQueryButton:ae=!1}=this.props,{hasTextEditMode:j,datasource:te,showingHelp:ne}=this.state,le=!!q.hide,z=te?.components?.QueryEditorHelp;return(0,t.jsxs)(t.Fragment,{children:[z&&(0,t.jsx)(P.A,{title:(0,M.t)("query-operation.header.datasource-help","Show data source help"),icon:"question-circle",onClick:this.onToggleHelp,active:ne}),j&&(0,t.jsx)(P.q,{title:(0,M.t)("query-operation.header.toggle-edit-mode","Toggle text edit mode"),icon:"pen",onClick:ee=>{this.onToggleEditMode(ee,J)}}),this.renderExtraActions(),(0,t.jsx)(P.q,{title:(0,M.t)("query-operation.header.duplicate-query","Duplicate query"),icon:"copy",onClick:this.onCopyQuery}),ae?null:(0,t.jsx)(P.A,{dataTestId:v.Tp.components.QueryEditorRow.actionButton("Hide response"),title:q.hide?(0,M.t)("query-operation.header.show-response","Show response"):(0,M.t)("query-operation.header.hide-response","Hide response"),icon:le?"eye-slash":"eye",active:le,onClick:this.onHideQuery}),(0,t.jsx)(P.q,{title:(0,M.t)("query-operation.header.remove-query","Remove query"),icon:"trash-alt",onClick:this.onRemoveQuery})]})},this.renderHeader=J=>{const{alerting:q,query:ae,dataSource:j,onChangeDataSource:te,onChange:ne,queries:le,renderHeaderExtras:z}=this.props;return(0,t.jsx)(w,{query:ae,queries:le,onChangeDataSource:te,dataSource:j,hidden:ae.hide,onClick:ee=>this.onToggleEditMode(ee,J),onChange:ne,collapsedText:J.isOpen?null:this.renderCollapsedText(),renderExtras:z,alerting:q})}}componentDidMount(){const{data:J,query:q,id:ae}=this.props,j=Y(J,q.refId);this.id=(0,s.uniqueId)(ae+"_"),this.setState({data:j}),this.loadDatasource()}componentWillUnmount(){this.angularQueryEditor&&this.angularQueryEditor.destroy()}getAngularQueryComponentScope(){const{query:J,queries:q}=this.props,{datasource:ae}=this.state,j=new I.a9({targets:q}),te={},ne=this;return{datasource:ae,target:J,panel:j,dashboard:te,refresh:()=>{J.hide!==ne.props.query.hide&&(J.hide=ne.props.query.hide),this.props.onChange(J),this.props.onRunQuery()},render:()=>()=>console.log("legacy render function called, it does nothing"),events:this.props.eventBus||new f.o,range:(0,O.jG)().timeRange()}}getInterpolatedDataSourceUID(){if(this.props.query.datasource){const J=this.dataSourceSrv.getInstanceSettings(this.props.query.datasource);return J?.rawRef?.uid??J?.uid}return this.props.dataSource.rawRef?.uid??this.props.dataSource.uid}async loadDatasource(){let J;const q=this.getInterpolatedDataSourceUID();try{J=await this.dataSourceSrv.get(q)}catch{J=await this.dataSourceSrv.get()}typeof this.props.onDataSourceLoaded=="function"&&this.props.onDataSourceLoaded(J),this.setState({datasource:J,queriedDataSourceIdentifier:q,hasTextEditMode:(0,s.has)(J,"components.QueryCtrl.prototype.toggleEditorMode")})}componentDidUpdate(J){const{datasource:q,queriedDataSourceIdentifier:ae}=this.state,{data:j,query:te}=this.props;if(J.id!==this.props.id&&(this.id=(0,s.uniqueId)(this.props.id+"_")),j!==J.data){const ne=Y(j,te.refId);this.setState({data:ne}),this.angularScope&&(this.angularScope.range=(0,O.jG)().timeRange()),this.angularQueryEditor&&ne&&H(this.angularScope,ne,this.angularQueryEditor)}if(q&&ae!==this.getInterpolatedDataSourceUID()){this.angularQueryEditor&&(this.angularQueryEditor.destroy(),this.angularQueryEditor=null),this.loadDatasource();return}!this.element||this.angularQueryEditor||this.renderAngularQueryEditor()}getReactQueryEditor(J){if(J)switch(this.props.app){case c.Jk.Explore:return J.components?.ExploreMetricsQueryField||J.components?.ExploreLogsQueryField||J.components?.ExploreQueryField||J.components?.QueryEditor;case c.Jk.PanelEditor:case c.Jk.Dashboard:default:return J.components?.QueryEditor}}isWaitingForDatasourceToLoad(){return this.getInterpolatedDataSourceUID()!==this.state.queriedDataSourceIdentifier}renderCollapsedText(){const{datasource:J}=this.state;return J?.getQueryDisplayText?J.getQueryDisplayText(this.props.query):this.angularScope&&this.angularScope.getCollapsedText?this.angularScope.getCollapsedText():null}render(){const{query:J,index:q,visualization:ae,collapsable:j}=this.props,{datasource:te,showingHelp:ne,data:le}=this.state,z=J.hide,ee=le?.error&&le.error.refId===J.refId?le.error:le?.errors?.find(oe=>oe.refId===J.refId),se=i()("query-editor-row",{"query-editor-row--disabled":z,"gf-form-disabled":z});if(!te)return null;const ie=this.renderPluginEditor(),Z=te.components?.QueryEditorHelp;return(0,t.jsx)("div",{"data-testid":"query-editor-row","aria-label":v.Tp.components.QueryEditorRows.rows,children:(0,t.jsx)(b.u,{id:this.id,draggable:!0,collapsable:j,index:q,headerElement:this.renderHeader,actions:this.renderActions,onOpen:this.onOpen,children:(0,t.jsxs)("div",{className:se,id:this.id,children:[(0,t.jsxs)(E.Xw,{children:[ne&&Z&&(0,t.jsx)(x.j,{children:(0,t.jsx)(Z,{onClickExample:oe=>this.onClickExample(oe),query:this.props.query,datasource:te})}),ie]}),ee&&(0,t.jsx)(K.x,{error:ee}),ae]})})})}}function H(X,J,q){if(J.state===d.Gu.Done){const ae=J.series.map(j=>(0,p.w3)(j));X.events.emit(m.ee.dataReceived,ae)}else J.state===d.Gu.Error&&X.events.emit(m.ee.dataError,J.error);setTimeout(q.digest)}function Y(X,J){const q=X.series.filter(ne=>ne.refId===J);if(X.state!==d.Gu.Loading&&(X.error||X.errors?.length)&&!X.series.length)return{...X,state:d.Gu.Error};let ae=X.state,j=X.errors?.find(ne=>ne.refId===J);!j&&X.error&&(j=X.error.refId===J?X.error:void 0),ae!==d.Gu.Loading&&(j?ae=d.Gu.Error:X.state===d.Gu.Error&&(ae=d.Gu.Done));const te=X.timeRange;return{...X,state:ae,series:q,error:j,errors:j?[j]:void 0,timeRange:te}}},44932:(k,R,e)=>{"use strict";e.d(R,{L:()=>c});var t=e(74848),n=e(91076),i=e(96540),s=e(22391),r=e(14110),g=e(19347),a=e(48514);class c extends i.PureComponent{constructor(){super(...arguments),this.onRemoveQuery=f=>{this.props.onQueriesChange(this.props.queries.filter(d=>d!==f))},this.onDragStart=f=>{const{queries:d,dsSettings:p}=this.props;(0,r.rR)("query_row_reorder_started",{startIndex:f.source.index,numberOfQueries:d.length,datasourceType:p.type})},this.onDragEnd=f=>{const{queries:d,onQueriesChange:p,dsSettings:m}=this.props;if(!f||!f.destination)return;const v=f.source.index,l=f.destination.index;if(v===l){(0,r.rR)("query_row_reorder_canceled",{startIndex:v,endIndex:l,numberOfQueries:d.length,datasourceType:m.type});return}const y=Array.from(d),[u]=y.splice(v,1);y.splice(l,0,u),p(y),(0,r.rR)("query_row_reorder_ended",{startIndex:v,endIndex:l,numberOfQueries:d.length,datasourceType:m.type})}}onChangeQuery(f,d){const{queries:p,onQueriesChange:m}=this.props;m(p.map((v,l)=>l===d?f:v))}onDataSourceChange(f,d){const{queries:p,onQueriesChange:m}=this.props;m(p.map((v,l)=>{if(l!==d)return v;const y=(0,s.p$)(f);return v.datasource&&(0,g.l)().getInstanceSettings(v.datasource)?.type===f.type?{...v,datasource:y}:{refId:v.refId,hide:v.hide,datasource:y}}))}render(){const{dsSettings:f,data:d,queries:p,app:m,history:v,eventBus:l,onAddQuery:y,onRunQueries:u,onQueryCopied:D,onQueryRemoved:E,onQueryToggled:x,queryRowWrapper:P}=this.props;return(0,t.jsx)(n.JY,{onDragStart:this.onDragStart,onDragEnd:this.onDragEnd,children:(0,t.jsx)(n.gL,{droppableId:"transformations-list",direction:"vertical",children:b=>(0,t.jsxs)("div",{"data-testid":"query-editor-rows",ref:b.innerRef,...b.droppableProps,children:[p.map((M,O)=>{const I=o(M,f),T=f.meta.mixed?S=>this.onDataSourceChange(S,O):void 0,C=(0,t.jsx)(a.c,{id:M.refId,index:O,data:d,query:M,dataSource:I,onChangeDataSource:T,onChange:S=>this.onChangeQuery(S,O),onRemoveQuery:this.onRemoveQuery,onAddQuery:y,onRunQuery:u,onQueryCopied:D,onQueryRemoved:E,onQueryToggled:x,queries:p,app:m,history:v,eventBus:l},M.refId);return P?P(C,M.refId):C}),b.placeholder]})})})}}const o=(h,f)=>h.datasource&&(0,g.l)().getInstanceSettings(h.datasource)||f},84959:(k,R,e)=>{"use strict";e.d(R,{x:()=>r});var t=e(74848),n=e(32196),i=e(40845),s=e(14578);function r({error:a}){const c=(0,i.of)(g),o=a?.message??a?.data?.message??"Query error";return(0,t.jsxs)("div",{className:c.wrapper,children:[(0,t.jsx)("div",{className:c.icon,children:(0,t.jsx)(s.I,{name:"exclamation-triangle"})}),(0,t.jsxs)("div",{className:c.message,children:[o,a.traceId!=null&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("br",{})," ",(0,t.jsxs)("span",{children:["(Trace ID: ",a.traceId,")"]})]})]})]})}const g=a=>({wrapper:(0,n.css)({marginTop:a.spacing(.5),background:a.colors.background.secondary,display:"flex"}),icon:(0,n.css)({background:a.colors.error.main,color:a.colors.error.contrastText,padding:a.spacing(1)}),message:(0,n.css)({fontSize:a.typography.bodySmall.fontSize,fontFamily:a.typography.fontFamilyMonospace,padding:a.spacing(1)})})},37464:(k,R,e)=>{"use strict";e.d(R,{g:()=>q,K:()=>j});var t=e(74848),n=e(32196),i=e(96540),s=e(39070),r=e(43127),g=e(22391),a=e(41987),c=e(43429),o=e(13544),h=e(19347),f=e(39601),d=e(66864),p=e(55852),m=e(40276),v=e(37390),l=e(3911),y=e(38894),u=e(16817),D=e(36663),E=e(17172),x=e(39558);function P({pluginId:ne}){const{value:le,loading:z,error:ee}=(0,u.A)(async()=>(0,E.AI)().get(`/api/plugins/${ne}/markdown/query_help`),[]),se=(0,D.G)(le);return z?(0,t.jsx)(x._,{text:"Loading help..."}):ee?(0,t.jsx)("h3",{children:"An error occurred when loading help."}):le===""?(0,t.jsx)("h3",{children:"No query help could be found."}):(0,t.jsx)("div",{className:"markdown-html",dangerouslySetInnerHTML:{__html:se}})}var b=e(2913),M=e(27677),O=e(21969),I=e(50481),T=e(51612),C=e(53478),S=e(74106),A=e(14348),L=e(8480),N=e(93117),F=e(64152),w=e(44932),B=e(65879),U=e(10354),K=e(15292),V=e(7788);class H extends i.PureComponent{constructor(le){super(le),this.onRelativeTimeChange=ee=>{this.setState({timeRangeFrom:ee.target.value})},this.onTimeShiftChange=ee=>{this.setState({timeRangeShift:ee.target.value})},this.onOverrideTime=ee=>{const{options:se,onChange:ie}=this.props,Z=X(ee.target.value),oe=Y(Z);oe&&se.timeRange?.from!==Z&&ie({...se,timeRange:{...se.timeRange??{},from:Z}}),this.setState({relativeTimeIsValid:oe})},this.onTimeShift=ee=>{const{options:se,onChange:ie}=this.props,Z=X(ee.target.value),oe=Y(Z);oe&&se.timeRange?.shift!==Z&&ie({...se,timeRange:{...se.timeRange??{},shift:Z}}),this.setState({timeShiftIsValid:oe})},this.onToggleTimeOverride=()=>{const{onChange:ee,options:se}=this.props;this.setState({timeRangeHide:!this.state.timeRangeHide},()=>{ee({...se,timeRange:{...se.timeRange??{},hide:this.state.timeRangeHide}})})},this.onCacheTimeoutBlur=ee=>{const{options:se,onChange:ie}=this.props;ie({...se,cacheTimeout:X(ee.target.value)})},this.onQueryCachingTTLBlur=ee=>{const{options:se,onChange:ie}=this.props;let Z=parseInt(ee.target.value,10);(isNaN(Z)||Z===0)&&(Z=null),ie({...se,queryCachingTTL:Z})},this.onMaxDataPointsBlur=ee=>{const{options:se,onChange:ie}=this.props;let Z=parseInt(ee.currentTarget.value,10);(isNaN(Z)||Z===0)&&(Z=null),Z!==se.maxDataPoints&&ie({...se,maxDataPoints:Z})},this.onMinIntervalBlur=ee=>{const{options:se,onChange:ie}=this.props,Z=X(ee.target.value);Z!==se.minInterval&&ie({...se,minInterval:Z})},this.onOpenOptions=()=>{this.setState({isOpen:!0})},this.onCloseOptions=()=>{this.setState({isOpen:!1})};const{options:z}=le;this.state={timeRangeFrom:z.timeRange?.from||"",timeRangeShift:z.timeRange?.shift||"",timeRangeHide:z.timeRange?.hide??!1,isOpen:!1,relativeTimeIsValid:!0,timeShiftIsValid:!0}}renderCacheTimeoutOption(){const{dataSource:le,options:z}=this.props,ee=`If your time series store has a query cache this option can override the default cache timeout. Specify a
    numeric value in seconds.`;return le.meta.queryOptions?.cacheTimeout?(0,t.jsx)("div",{className:"gf-form-inline",children:(0,t.jsxs)("div",{className:"gf-form",children:[(0,t.jsx)(y.I,{width:9,tooltip:ee,children:"Cache timeout"}),(0,t.jsx)(U.p,{type:"text",className:"width-6",placeholder:"60",spellCheck:!1,onBlur:this.onCacheTimeoutBlur,defaultValue:z.cacheTimeout??""})]})}):null}renderQueryCachingTTLOption(){const{dataSource:le,options:z}=this.props,ee="Cache time-to-live: How long results from this queries in this panel will be cached, in milliseconds. Defaults to the TTL in the caching configuration for this datasource.";return le.cachingConfig?.enabled?(0,t.jsx)("div",{className:"gf-form-inline",children:(0,t.jsxs)("div",{className:"gf-form",children:[(0,t.jsx)(y.I,{width:9,tooltip:ee,children:"Cache TTL"}),(0,t.jsx)(U.p,{type:"number",className:"width-6",placeholder:`${le.cachingConfig.TTLMs}`,spellCheck:!1,onBlur:this.onQueryCachingTTLBlur,defaultValue:z.queryCachingTTL??void 0})]})}):null}renderMaxDataPointsOption(){const{data:le,options:z}=this.props,ee=le.request?.maxDataPoints,se=z.maxDataPoints??"",ie=se==="";return(0,t.jsx)("div",{className:"gf-form-inline",children:(0,t.jsxs)("div",{className:"gf-form",children:[(0,t.jsx)(y.I,{width:9,tooltip:(0,t.jsx)(t.Fragment,{children:"The maximum data points per series. Used directly by some data sources and used in calculation of auto interval. With streaming data this value is used for the rolling buffer."}),children:"Max data points"}),(0,t.jsx)(U.p,{type:"number",className:"width-6",placeholder:`${ee}`,spellCheck:!1,onBlur:this.onMaxDataPointsBlur,defaultValue:se}),ie&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"gf-form-label query-segment-operator",children:"="}),(0,t.jsx)("div",{className:"gf-form-label",children:"Width of panel"})]})]})})}renderIntervalOption(){const{data:le,dataSource:z,options:ee}=this.props,se=le.request?.interval,ie=z.interval??"No limit";return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"gf-form-inline",children:(0,t.jsxs)("div",{className:"gf-form",children:[(0,t.jsx)(y.I,{width:9,tooltip:(0,t.jsxs)(t.Fragment,{children:["A lower limit for the interval. Recommended to be set to write frequency, for example ",(0,t.jsx)("code",{children:"1m"})," ","if your data is written every minute. Default value can be set in data source settings for most data sources."]}),children:"Min interval"}),(0,t.jsx)(U.p,{type:"text",className:"width-6",placeholder:`${ie}`,spellCheck:!1,onBlur:this.onMinIntervalBlur,defaultValue:ee.minInterval??""})]})}),(0,t.jsx)("div",{className:"gf-form-inline",children:(0,t.jsxs)("div",{className:"gf-form",children:[(0,t.jsx)(y.I,{width:9,tooltip:(0,t.jsxs)(t.Fragment,{children:["The evaluated interval that is sent to data source and is used in ",(0,t.jsx)("code",{children:"$__interval"})," and"," ",(0,t.jsx)("code",{children:"$__interval_ms"}),". This value is not exactly equal to"," ",(0,t.jsx)("code",{children:"Time range / max data points"}),", it will approximate a series of magic number."]}),children:"Interval"}),(0,t.jsx)(y.I,{width:6,children:se}),(0,t.jsx)("div",{className:"gf-form-label query-segment-operator",children:"="}),(0,t.jsx)("div",{className:"gf-form-label",children:"Time range / max data points"})]})})]})}renderCollapsedText(le){const{data:z,options:ee}=this.props,{isOpen:se}=this.state;if(se)return;let ie=ee.maxDataPoints??"";ie===""&&z.request&&(ie=`auto = ${z.request.maxDataPoints}`);let Z=ee.minInterval;return z.request&&(Z=`${z.request.interval}`),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:le.collapsedText,children:["MD = ",ie]}),(0,t.jsxs)("div",{className:le.collapsedText,children:["Interval = ",Z]})]})}render(){const{timeRangeHide:le,relativeTimeIsValid:z,timeShiftIsValid:ee}=this.state,{timeRangeFrom:se,timeRangeShift:ie,isOpen:Z}=this.state,oe=J();return(0,t.jsxs)(V.u,{id:"Query options",index:0,title:"Query options",headerElement:this.renderCollapsedText(oe),isOpen:Z,onOpen:this.onOpenOptions,onClose:this.onCloseOptions,children:[this.renderMaxDataPointsOption(),this.renderIntervalOption(),this.renderCacheTimeoutOption(),this.renderQueryCachingTTLOption(),(0,t.jsxs)("div",{className:"gf-form",children:[(0,t.jsx)(y.I,{width:9,tooltip:(0,t.jsxs)(t.Fragment,{children:["Overrides the relative time range for individual panels, which causes them to be different than what is selected in the dashboard time picker in the top-right corner of the dashboard. For example to configure the Last 5 minutes the Relative time should be ",(0,t.jsx)("code",{children:"now-5m"})," and ",(0,t.jsx)("code",{children:"5m"}),", or variables like ",(0,t.jsx)("code",{children:"$_relativeTime"}),"."]}),children:"Relative time"}),(0,t.jsx)(U.p,{type:"text",className:"width-6",placeholder:"1h",onChange:this.onRelativeTimeChange,onBlur:this.onOverrideTime,invalid:!z,value:se})]}),(0,t.jsxs)("div",{className:"gf-form",children:[(0,t.jsx)(y.I,{width:9,tooltip:(0,t.jsxs)(t.Fragment,{children:["Overrides the time range for individual panels by shifting its start and end relative to the time picker. For example to configure the Last 1h the Time shift should be ",(0,t.jsx)("code",{children:"now-1h"})," and"," ",(0,t.jsx)("code",{children:"1h"}),", or variables like ",(0,t.jsx)("code",{children:"$_timeShift"}),"."]}),children:"Time shift"}),(0,t.jsx)(U.p,{type:"text",className:"width-6",placeholder:"1h",onChange:this.onTimeShiftChange,onBlur:this.onTimeShift,invalid:!ee,value:ie})]}),(ie||se)&&(0,t.jsxs)("div",{className:"gf-form-inline align-items-center",children:[(0,t.jsx)(y.I,{width:9,children:"Hide time info"}),(0,t.jsx)(K.d,{value:le,onChange:this.onToggleTimeOverride})]})]})}}const Y=ne=>ne?B.isValidTimeSpan(ne):!0,X=ne=>ne===""?null:ne,J=(0,l.N)(()=>{const{theme:ne}=b.config;return{collapsedText:(0,n.css)`
      margin-left: ${ne.spacing.md};
      font-size: ${ne.typography.size.sm};
      color: ${ne.colors.textWeak};
    `}});class q extends i.PureComponent{constructor(){super(...arguments),this.backendSrv=M.IB,this.dataSourceSrv=(0,h.l)(),this.querySubscription=null,this.state={isDataSourceModalOpen:!!f.Ny.getSearchObject().firstPanel,isLoadingHelp:!1,helpContent:null,isPickerOpen:!1,isHelpOpen:!1,queries:[],data:{state:s.Gu.NotStarted,series:[],timeRange:(0,r.E2)()}},this.onChangeDataSource=async(le,z)=>{const{dsSettings:ee}=this.state,se=ee?await(0,h.l)().get(ee.uid):void 0,ie=await(0,h.l)().get(le.uid),Z=z||await(0,N.y)(ie,le.uid,this.state.queries,se),oe=await this.dataSourceSrv.get(le.name);this.onChange({queries:Z,dataSource:{name:le.name,uid:le.uid,...(0,g.p$)(le)}}),this.setState({queries:Z,dataSource:oe,dsSettings:le}),z&&this.props.onRunQueries()},this.onAddQueryClick=()=>{const{queries:le}=this.state;this.onQueriesChange((0,O.U7)(le,this.newQuery())),this.onScrollBottom()},this.onAddExpressionClick=()=>{this.onQueriesChange((0,O.U7)(this.state.queries,C.Ex.newQuery())),this.onScrollBottom()},this.onScrollBottom=()=>{setTimeout(()=>{this.state.scrollElement&&this.state.scrollElement.scrollTo({top:1e4})},20)},this.onUpdateAndRun=le=>{this.props.onOptionsChange(le),this.props.onRunQueries()},this.onOpenHelp=()=>{this.setState({isHelpOpen:!0})},this.onCloseHelp=()=>{this.setState({isHelpOpen:!1})},this.onCloseDataSourceModal=()=>{this.setState({isDataSourceModalOpen:!1})},this.onAddQuery=le=>{const{dsSettings:z,queries:ee}=this.state;this.onQueriesChange((0,O.U7)(ee,le,z?(0,g.p$)(z):{type:void 0,uid:void 0})),this.onScrollBottom()},this.onQueriesChange=le=>{this.onChange({queries:le}),this.setState({queries:le})},this.setScrollRef=le=>{this.setState({scrollElement:le})}}async componentDidMount(){const{options:le,queryRunner:z}=this.props;this.querySubscription=z.getData({withTransforms:!1,withFieldConfig:!1}).subscribe({next:ee=>this.onPanelDataUpdate(ee)}),this.setNewQueriesAndDatasource(le)}componentWillUnmount(){this.querySubscription&&(this.querySubscription.unsubscribe(),this.querySubscription=null)}async componentDidUpdate(){const{options:le}=this.props,z=await(0,h.l)().get(le.dataSource);this.state.dataSource&&z.uid!==this.state.dataSource?.uid&&this.setNewQueriesAndDatasource(le)}async setNewQueriesAndDatasource(le){try{const z=await this.dataSourceSrv.get(le.dataSource),ee=this.dataSourceSrv.getInstanceSettings(le.dataSource),se=await this.dataSourceSrv.get(),ie=z.getRef(),Z=le.queries.map(oe=>({...(0,O.Ih)(oe)&&z?.getDefaultQuery?.(a.Jk.PanelEditor),datasource:ie,...oe}));this.setState({queries:Z,dataSource:z,dsSettings:ee,defaultDataSource:se})}catch(z){console.error("failed to load data source",z)}}onPanelDataUpdate(le){this.setState({data:le})}newQuery(){const{dsSettings:le,defaultDataSource:z}=this.state,ee=le&&!le.meta.mixed?(0,g.p$)(le):z?z.getRef():{type:void 0,uid:void 0};return{...this.state.dataSource?.getDefaultQuery?.(a.Jk.PanelEditor),datasource:ee}}onChange(le){this.props.onOptionsChange({...this.props.options,...le})}renderTopSection(le){const{onOpenQueryInspector:z,options:ee}=this.props,{dataSource:se,data:ie,dsSettings:Z}=this.state;return!Z||!se?null:(0,t.jsx)(j,{data:ie,dataSource:se,options:ee,dsSettings:Z,onOptionsChange:this.onUpdateAndRun,onDataSourceChange:this.onChangeDataSource,onOpenQueryInspector:z})}renderQueries(le){const{onRunQueries:z}=this.props,{data:ee,queries:se}=this.state;return(0,t.jsx)("div",{"aria-label":o.Tp.components.QueryTab.content,children:(0,t.jsx)(w.L,{queries:se,dsSettings:le,onQueriesChange:this.onQueriesChange,onAddQuery:this.onAddQuery,onRunQueries:z,data:ee})})}isExpressionsSupported(le){return(le.meta.alerting||le.meta.mixed)===!0}renderExtraActions(){return F.m.getAllExtraRenderAction().map((le,z)=>le({onAddQuery:this.onAddQuery,onChangeDataSource:this.onChangeDataSource,key:z})).filter(Boolean)}renderAddQueryRow(le,z){const ee=!(0,A.kN)(le.name);return(0,t.jsxs)(d.Gy,{spacing:"md",align:"flex-start",children:[ee&&(0,t.jsx)(p.$n,{icon:"plus",onClick:this.onAddQueryClick,variant:"secondary","data-testid":o.Tp.components.QueryTab.addQuery,children:"Add query"}),b.Ay.expressionsEnabled&&this.isExpressionsSupported(le)&&(0,t.jsx)(p.$n,{icon:"plus",onClick:this.onAddExpressionClick,variant:"secondary",className:z.expressionButton,"data-testid":"query-tab-add-expression",children:(0,t.jsx)("span",{children:"Expression\xA0"})}),this.renderExtraActions()]})}render(){const{isHelpOpen:le,dsSettings:z}=this.state,ee=ae();return(0,t.jsx)(m.E,{autoHeightMin:"100%",scrollRefCallback:this.setScrollRef,children:(0,t.jsxs)("div",{className:ee.innerWrapper,children:[this.renderTopSection(ee),z&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:ee.queriesWrapper,children:this.renderQueries(z)}),this.renderAddQueryRow(z,ee),le&&(0,t.jsx)(v.a,{title:"Data source help",isOpen:!0,onDismiss:this.onCloseHelp,children:(0,t.jsx)(P,{pluginId:z.meta.id})})]})]})})}}const ae=(0,l.N)(()=>{const{theme:ne}=b.Ay;return{innerWrapper:(0,n.css)`
      display: flex;
      flex-direction: column;
      padding: ${ne.spacing.md};
    `,dataSourceRow:(0,n.css)`
      display: flex;
      margin-bottom: ${ne.spacing.md};
    `,dataSourceRowItem:(0,n.css)`
      margin-right: ${ne.spacing.inlineFormMargin};
    `,dataSourceRowItemOptions:(0,n.css)`
      flex-grow: 1;
      margin-right: ${ne.spacing.inlineFormMargin};
    `,queriesWrapper:(0,n.css)`
      padding-bottom: 16px;
    `,expressionWrapper:(0,n.css)``,expressionButton:(0,n.css)`
      margin-right: ${ne.spacing.sm};
    `}});function j({dataSource:ne,options:le,data:z,dsSettings:ee,onDataSourceChange:se,onOptionsChange:ie,onOpenQueryInspector:Z}){const oe=ae(),[ce,ye]=(0,i.useState)(!1);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{"data-testid":o.Tp.components.QueryTab.queryGroupTopSection,children:[(0,t.jsxs)("div",{className:oe.dataSourceRow,children:[(0,t.jsx)(y.I,{htmlFor:"data-source-picker",width:"auto",children:"Data source"}),(0,t.jsx)("div",{className:oe.dataSourceRowItem,children:(0,t.jsx)(te,{options:le,onChange:async(re,ue)=>await se?.(re,ue),isDataSourceModalOpen:!!f.Ny.getSearchObject().firstPanel})}),ne&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:oe.dataSourceRowItem,children:(0,t.jsx)(p.$n,{variant:"secondary",icon:"question-circle",title:"Open data source help",onClick:()=>ye(!0),"data-testid":"query-tab-help-button"})}),(0,t.jsx)("div",{className:oe.dataSourceRowItemOptions,children:(0,t.jsx)(H,{options:le,dataSource:ne,data:z,onChange:re=>{ie?.(re)}})}),Z&&(0,t.jsx)("div",{className:oe.dataSourceRowItem,children:(0,t.jsx)(p.$n,{variant:"secondary",onClick:Z,"aria-label":o.Tp.components.QueryTab.queryInspectorButton,children:"Query inspector"})})]})]}),ne&&(0,L.Hv)(ne.uid)&&(0,t.jsx)(S.c,{pluginId:ne.type,pluginType:c.QE.datasource,angularSupportEnabled:b.Ay?.angularSupportEnabled,showPluginDetailsLink:!0,interactionElementId:"datasource-query"})]}),ce&&(0,t.jsx)(v.a,{title:"Data source help",isOpen:!0,onDismiss:()=>ye(!1),children:(0,t.jsx)(P,{pluginId:ee.meta.id})})]})}function te({options:ne,onChange:le,...z}){const[ee,se]=(0,i.useState)(!!z.isDataSourceModalOpen);(0,i.useEffect)(()=>{f.Ny.getSearchObject().firstPanel&&f.Ny.partial({firstPanel:null},!0)},[]);const ie={metrics:!0,mixed:!0,dashboard:!0,variables:!0,current:ne.dataSource,uploadFile:!0,onChange:async(Z,oe)=>{await le(Z,oe),se(!1)}};return(0,t.jsxs)(t.Fragment,{children:[ee&&(0,t.jsx)(I.p,{...ie,onDismiss:()=>se(!1)}),(0,t.jsx)(T.s,{...ie})]})}},42972:(k,R,e)=>{"use strict";e.d(R,{nm:()=>se,Dh:()=>le});var t=e(39741),n=e(13752),i=e(64423),s=e(44240),r=e(39697),g=e(81160),a=e(67791),c=e(93031),o=e(71030),h=e(69850),f=e(1005),d=e(65961),p=e(3591),m=e(2543);function v(ie){let Z=[];const oe=(0,m.partition)(ie,"id"),ce=(0,m.groupBy)(oe[0],"id");return Z=(0,m.map)(ce,ye=>ye.length>1&&!(0,m.every)(ye,l)?(0,m.find)(ye,re=>re.eventType!=="panel-alert"):(0,m.head)(ye)),Z=(0,m.concat)(Z,oe[1]),Z}function l(ie){return ie.eventType==="panel-alert"}var y=e(74856),u=e(62467),D=e(65474),E=e(66847),x=e(69862),P=e(16126),b=e(32264),M=e(19347),O=e(90569),I=e(28444),T=e(27302),C=e(7436);class S{canRun(Z){return Z?!!(!Z.annotationQuery||Z.annotations):!1}run({annotation:Z,datasource:oe,dashboard:ce,range:ye}){if(!this.canRun(oe))return(0,u.of)([]);const re={};return(0,T.b)({dashboard:ce,range:ye,panel:re},oe,Z).pipe((0,g.T)(ue=>ue.events??[]),(0,E.W)(C.SD))}}var A=e(42493);class L{canRun(Z){return Z?(0,A.E7)(Z)?!0:!!(Z.annotationQuery&&!Z.annotations):!1}run({annotation:Z,datasource:oe,dashboard:ce,range:ye}){return this.canRun(oe)?(0,D.H)(oe.annotationQuery({range:ye,rangeRaw:ye.raw,annotation:Z,dashboard:ce})).pipe((0,E.W)(C.SD)):(0,u.of)([])}}class N{constructor(Z=[new L,new S]){this.runners=Z}canWork({dashboard:Z}){return!!Z.annotations.list.find(N.getAnnotationsToProcessFilter)}work(Z){if(!this.canWork(Z))return(0,C.$)();const{dashboard:oe,range:ce}=Z;let ye=oe.annotations.list.filter(N.getAnnotationsToProcessFilter);b.$.publicDashboardAccessToken&&ye.length>0&&(ye=[ye[0]]);const re=ye.map(ue=>{let De;if(b.$.publicDashboardAccessToken){const ge=new O.X;De=(0,u.of)(ge).pipe((0,E.W)(C.H0))}else De=(0,D.H)((0,M.l)().get(ue.datasource)).pipe((0,E.W)(C.H0));return De.pipe((0,x.Z)(ge=>{const Te=this.runners.find(Le=>Le.canRun(ge));return Te?(oe.events.publish(new I.xc(ue)),Te.run({annotation:ue,datasource:ge,dashboard:oe,range:ce}).pipe((0,a.Q)(le().cancellations().pipe((0,P.p)(Le=>Le===ue))),(0,g.T)(Le=>(oe.snapshot&&(ue.snapshotData=(0,m.cloneDeep)(Le)),b.$.publicDashboardAccessToken?Le:(0,C.G9)(ue,Le))),(0,h.j)(()=>{oe.events.publish(new I.yj(ue))}))):(0,u.of)([])}))});return(0,s.h)(re).pipe((0,c.U)(),(0,o.T)((ue,De)=>ue.concat(De)),(0,g.T)(ue=>({annotations:ue,alertStates:[]})))}static getAnnotationsToProcessFilter(Z){return Z.enable&&!Z.snapshotData}}var F=e(85595),w=e(43585),B=e(16233),U=e(79938),K=e(49498),V=e(55740),H=e(57220),Y=e(23662),X=e(91309),J=e(99140),q=e(31678);class ae{constructor(){this.hasAlertRules={}}canWork({dashboard:Z,range:oe}){return!(!Z.uid||b.$.publicDashboardAccessToken||oe.raw.to!=="now"||this.hasAlertRules[Z.uid]===!1||!(B.TP.hasPermission(q.AccessControlAction.AlertingRuleRead)&&B.TP.hasPermission(q.AccessControlAction.AlertingRuleExternalRead)))}work(Z){if(!this.canWork(Z))return(0,C.$)();const{dashboard:oe}=Z,ce=async()=>(await(0,J.JD)(U.hK.endpoints.prometheusRuleNamespaces.initiate({ruleSourceName:H.hY,dashboardUid:oe.uid}))).data;return(0,D.H)(ce()).pipe((0,g.T)(re=>(0,K.Kw)(re))).pipe((0,g.T)(re=>{this.hasAlertRules[oe.uid]=!1;const ue={};return re.forEach(De=>De.rules.forEach(ge=>{if((0,Y.Z8)(ge)&&ge.annotations&&ge.annotations[V.YH.panelID]){this.hasAlertRules[oe.uid]=!0;const Te=Number(ge.annotations[V.YH.panelID]),Le=(0,X.S)(ge.state);ue[Te]?Le===w.O.Alerting&&ue[Te].state!==w.O.Alerting?ue[Te].state=w.O.Alerting:Le===w.O.Pending&&ue[Te].state!==w.O.Alerting&&ue[Te].state!==w.O.Pending&&(ue[Te].state=w.O.Pending):ue[Te]={state:Le,id:Object.keys(ue).length,panelId:Te,dashboardId:oe.id}}})),{alertStates:Object.values(ue),annotations:[]}}),(0,E.W)(C.Zr))}}class j{constructor(Z,oe=(0,y.jG)(),ce=[new ae,new F.F,new N]){this.dashboard=Z,this.timeSrv=oe,this.workers=ce,this.run=this.run.bind(this),this.getResult=this.getResult.bind(this),this.cancel=this.cancel.bind(this),this.destroy=this.destroy.bind(this),this.executeRun=this.executeRun.bind(this),this.results=new t.m(1),this.runs=new n.B,this.cancellationStream=new n.B,this.runsSubscription=this.runs.subscribe(ye=>this.executeRun(ye)),this.eventsSubscription=Z.events.subscribe(p._,ye=>{this.run({dashboard:this.dashboard,range:this.timeSrv.timeRange()})})}run(Z){this.runs.next(Z)}getResult(Z){return this.results.asObservable().pipe((0,g.T)(oe=>{const ce=(0,C.FK)(oe.annotations,Z),ye=oe.alertStates.find(re=>!!Z&&re.panelId===Z);return{annotations:v(ce),alertState:ye}}))}executeRun(Z){const ce=this.workers.filter(ge=>ge.canWork(Z)).map(ge=>ge.work(Z)),ye=new i.yU,re=(0,s.h)(ce).pipe((0,a.Q)(this.runs.asObservable()),(0,c.U)(),(0,o.T)((ge,Te)=>(ge.annotations=ge.annotations.concat(Te.annotations),ge.alertStates=ge.alertStates.concat(Te.alertStates),ge)),(0,h.j)(()=>{ye.unsubscribe()}),(0,f.u)()),ue=new i.yU,De=(0,r.O)(200).pipe((0,d.u)({annotations:[],alertStates:[]}),(0,a.Q)(re),(0,h.j)(()=>{ue.unsubscribe()}));ue.add(De.subscribe(ge=>{this.results.next(ge)})),ye.add(re.subscribe(ge=>{this.results.next(ge)}))}cancel(Z){this.cancellationStream.next(Z)}cancellations(){return this.cancellationStream.asObservable().pipe((0,f.u)())}destroy(){this.results.complete(),this.runs.complete(),this.cancellationStream.complete(),this.runsSubscription.unsubscribe(),this.eventsSubscription.unsubscribe()}}let te;function ne(ie){te&&te.destroy(),te=ie}function le(){if(!te)throw new Error("getDashboardQueryRunner can only be used after Grafana instance has started.");return te}let z;function ee(ie){z=ie}function se(ie){z||(z=({dashboard:oe,timeSrv:ce,workers:ye})=>new j(oe,ce,ye));const Z=z(ie);return ne(Z),Z}},90569:(k,R,e)=>{"use strict";e.d(R,{X:()=>h});var t=e(62467),n=e(65474),i=e(40187),s=e(14236),r=e(17172),g=e(32264),a=e(57220),c=e(68706);const o="-- Public --";class h extends i.mA{constructor(){let d={};super({name:"public-ds",id:0,type:"public-ds",meta:d,uid:o,jsonData:{},access:"proxy",readOnly:!0}),this.annotations={prepareQuery(p){return{...p,queryType:c.nj.Annotations,refId:"anno"}}}}query(d){return d.targets.length?d.targets[0]?.datasource?.uid===a.vv?(0,n.H)(this.getAnnotations(d)):(0,t.of)({data:[]}):(0,t.of)({data:[]})}async getAnnotations(d){const{range:{to:p,from:m}}=d,v={from:m.valueOf(),to:p.valueOf()},l=await(0,r.AI)().get(`/api/public/dashboards/${g.$.publicDashboardAccessToken}/annotations`,v);return{data:[(0,s.Vc)(l)]}}testDatasource(){return Promise.resolve({message:"",status:""})}}},85595:(k,R,e)=>{"use strict";e.d(R,{F:()=>i});var t=e(62467),n=e(7436);class i{canWork({dashboard:r}){return r?.annotations?.list?.some(g=>g.enable&&!!g.snapshotData)}work(r){if(!this.canWork(r))return(0,n.$)();const g=this.getAnnotationsFromSnapshot(r.dashboard);return(0,t.of)({annotations:g,alertStates:[]})}getAnnotationsFromSnapshot(r){return(r?.annotations?.list?.filter(o=>o.enable)).filter(o=>!!o.snapshotData).reduce((o,h)=>o.concat((0,n.G9)(h,h.snapshotData)),[])}getAnnotationsInSnapshot(r,g){const a=this.getAnnotationsFromSnapshot(r);return(0,n.FK)(a,g)}}},7436:(k,R,e)=>{"use strict";e.d(R,{$:()=>d,FK:()=>v,G9:()=>l,H:()=>y,H0:()=>f,SD:()=>h,Zr:()=>p});var t=e(2543),n=e.n(t),i=e(62467),s=e(78368),r=e(12091),g=e(32264),a=e(99140),c=e(3169),o=e(16001);function h(u){return u.cancelled?(0,i.of)([]):(m("AnnotationQueryRunner failed",u),(0,i.of)([]))}function f(u){return m("Failed to retrieve datasource",u),(0,i.of)(void 0)}const d=()=>(0,i.of)({annotations:[],alertStates:[]});function p(u){return u.cancelled||m("DashboardQueryRunner failed",u),d()}function m(u,D){const E=(0,r.u)(D);console.error("handleAnnotationQueryRunnerError",E);const x=(0,c.gi)(u,E.message);(0,a.JD)((0,o.dx)(x))}function v(u,D){return D==null?u:u.filter(E=>{let x;if(x=E.source,!x)return!0;if(x.filter){const P=(x.filter.ids??[]).includes(D);if(x.filter.exclude){if(P)return!1}else if(!P)return!1}return E.panelId&&E.source.type==="dashboard"?E.panelId===D:!0})}function l(u,D){u.snapshotData&&(u=(0,t.cloneDeep)(u),delete u.snapshotData);for(const E of D)switch(E.source=u,E.color=g.$.theme2.visualization.getColorByName(u.iconColor),E.type=u.name,E.isRegion=!!(E.timeEnd&&E.time!==E.timeEnd),E.newState?.toLowerCase()){case"pending":E.color="yellow";break;case"alerting":E.color="red";break;case"ok":E.color="green";break;case"normal":E.color="green";break;case"no_data":E.color="gray";break;case"nodata":E.color="gray";break}return D}function y(u){if(!u||!u.length)return[];const D=[];for(const E of u){const x=new s.R(E);for(let P=0;P<E.length;P++){const b=(0,t.cloneDeep)(x.get(P));D.push(b)}}return D}},80924:(k,R,e)=>{"use strict";e.d(R,{Z:()=>A,S:()=>S});var t=e(2543),n=e(39741),i=e(62467),s=e(69862),r=e(81160),g=e(66847),a=e(39070),c=e(14236),o=e(43127),h=e(90708),f=e(21423),d=e(52622),p=e(2514),m=e(41987),v=e(65879),l=e(12091),y=e(26657),u=e(47118),D=e(31193),E=e(23989),x=e(14348),P=e(42972),b=e(49510),M=e(33948);function O(N=[]){N.forEach(F=>{F.meta={...F.meta,dataTopic:d.QR.Annotations}})}function I(N,F){return(0,b.z)([N,F]).pipe((0,s.Z)(w=>{const[B,U]=w;if(U.annotations?.length||U.alertState){B.annotations||(B.annotations=[]);const K=B.annotations.concat((0,M.I)(U.annotations));O(K);const V=U.alertState;return(0,i.of)({...B,annotations:K,alertState:V})}return O(B.annotations),(0,i.of)(B)}))}var T=e(39374);let C=100;function S(){return"Q"+C++}class A{constructor(F){this.templateSrv=(0,E.w)(),this.resendLastResult=()=>{this.lastResult&&this.subject.next(this.lastResult)},this.subject=new n.m(1),this.dataConfigSource=F}getData(F){const{withFieldConfig:w,withTransforms:B}=F;let U=1,K,V=[],H=[],Y,X=!0,J=-1;if(this.dataConfigSource.snapshotData){const q={state:a.Gu.Done,series:this.dataConfigSource.snapshotData.map(ae=>(0,c.Vc)(ae)),timeRange:(0,o.E2)(),structureRev:U};return(0,i.of)(q)}return this.subject.pipe((0,s.Z)(q=>{let ae=this.dataConfigSource.getFieldOverrideOptions(),j=this.dataConfigSource.getTransformations();if(q.series===H&&K?.fieldConfig===ae?.fieldConfig&&Y===j)return(0,i.of)({...q,structureRev:U,series:V});K=ae,Y=j,H=q.series;let te=(0,i.of)(q);return B&&(te=this.applyTransformations(q)),te.pipe((0,r.T)(ne=>{let le=ne,z=!1;if(w&&ne.series?.length){if(J===this.dataConfigSource.configRev){let ee;for(const se of ne.series)if((0,u.o$)(se)){ee=se;break}ee&&!ee.packetInfo.schemaChanged&&V[0].fields.length===ee.fields.length&&(le={...le,series:V.map((se,ie)=>({...se,length:ne.series[ie].length,fields:se.fields.map((Z,oe)=>({...Z,values:ne.series[ie].fields[oe].values,state:{...Z.state,calcs:void 0,range:void 0}}))}))},z=!0)}ae!=null&&(X||!z)&&(J=this.dataConfigSource.configRev,le={...le,series:(0,h.we)({timeZone:ne.request?.timezone??"browser",data:le.series,...ae})},le.annotations&&(le.annotations=(0,h.we)({data:le.annotations,...ae,fieldConfig:{defaults:{},overrides:[]}})),X=!1)}return!z&&!(0,f.J3)(V,le.series,f.bW)&&U++,V=le.series,{...le,structureRev:U}}))}))}applyTransformations(F){const w=this.dataConfigSource.getTransformations();if(w&&w.every(X=>X.disabled)||!w||w.length===0)return(0,i.of)(F);const U={interpolate:X=>this.templateSrv.replace(X,F?.request?.scopedVars)};let K=w.filter(X=>X.topic==null||X.topic===d.QR.Series),V=w.filter(X=>X.topic===d.QR.Annotations),H=(0,p.m)(K,F.series,U),Y=(0,p.m)(V,F.annotations??[],U);return(0,t.merge)(H,Y).pipe((0,r.T)(X=>{let q=X.some(ae=>ae.meta?.dataTopic===d.QR.Annotations)?{annotations:X}:{series:X};return{...F,...q}}),(0,g.W)(X=>(console.warn("Error running transformation:",X),(0,i.of)({...F,state:a.Gu.Error,errors:[(0,l.u)(X)]}))))}async run(F){const{queries:w,timezone:B,datasource:U,panelId:K,panelPluginId:V,dashboardUID:H,timeRange:Y,timeInfo:X,cacheTimeout:J,queryCachingTTL:q,maxDataPoints:ae,scopedVars:j,minInterval:te,app:ne}=F;if((0,x.kN)(U)){this.pipeToSubject((0,x.mw)(F,w[0]),K,!0);return}const le=this.shouldAddErrorWhenDatasourceVariableIsMultiple(U,j),z={app:ne??m.Jk.Dashboard,requestId:S(),timezone:B,panelId:K,panelPluginId:V,dashboardUID:H,range:Y,timeInfo:X,interval:"",intervalMs:0,targets:(0,t.cloneDeep)(w),maxDataPoints:ae,scopedVars:j||{},cacheTimeout:J,queryCachingTTL:q,startTime:Date.now(),rangeRaw:Y.raw};try{const ee=await L(U,z.scopedVars),se=ee.meta?.mixed;z.targets=z.targets.map(oe=>{const ce=oe.datasource?.type===y.dR.type;return(!oe.datasource||oe.datasource.uid!==ee.uid&&!se&&!ce)&&(oe.datasource=ee.getRef()),oe});const ie=te?this.templateSrv.replace(te,z.scopedVars):ee.interval,Z=v.calculateInterval(Y,ae,ie);z.scopedVars=Object.assign({},z.scopedVars,{__interval:{text:Z.interval,value:Z.interval},__interval_ms:{text:Z.intervalMs.toString(),value:Z.intervalMs}}),z.interval=Z.interval,z.intervalMs=Z.intervalMs,z.filters=this.templateSrv.getAdhocFilters(ee.name,!0),this.lastRequest=z,this.pipeToSubject((0,T.BN)(ee,z),K,!1,le)}catch(ee){this.pipeToSubject((0,i.of)({state:a.Gu.Error,error:(0,l.u)(ee),series:[],timeRange:z.range}),K)}}pipeToSubject(F,w,B=!1,U=!1){this.subscription&&this.subscription.unsubscribe();let K=F;const V=this.dataConfigSource.getDataSupport();if(V.alertStates||V.annotations){const H=this.dataConfigSource;K=I(F,(0,P.Dh)().getResult(H.id))}this.subscription=K.subscribe({next:H=>{const Y=this.lastResult,X=B?H:(0,c.N$)(H,Y);if(Y!=null&&X.state!==a.Gu.Streaming){let J=(0,f.J3)(Y.series??[],X.series??[],(j,te)=>j===te),q=(0,f.J3)(Y.annotations??[],X.annotations??[],(j,te)=>j===te),ae=Y.state===X.state;if(J&&(X.series=Y.series),q&&(X.annotations=Y.annotations),J&&q&&ae)return}this.lastResult=X,U&&(X.errors=[{message:"Panel is using a variable datasource with multiple values without repeat option. Please configure the panel to be repeated by the same datasource variable."}],X.state=a.Gu.Error),this.subject.next(X)}})}cancelQuery(){this.subscription&&(this.subscription.unsubscribe(),this.lastResult&&(this.lastResult.state===a.Gu.Loading||this.lastResult.state===a.Gu.Streaming)&&this.subject.next({...this.lastResult,state:a.Gu.Done}))}clearLastResult(){this.lastResult=void 0,this.subject=new n.m(1)}destroy(){this.subject&&this.subject.complete(),this.subscription&&this.subscription.unsubscribe()}useLastResultFrom(F){this.lastResult=F.getLastResult(),this.lastResult&&this.subject.next(this.lastResult)}setLastResult(F){this.lastResult=F}getLastResult(){return this.lastResult}getLastRequest(){return this.lastRequest}shouldAddErrorWhenDatasourceVariableIsMultiple(F,w){let B=!1;return F?.uid?.startsWith("${")&&this.templateSrv.replace(F.uid,w,U=>(Array.isArray(U)&&U.length>1&&(B=!0),"")),B}}async function L(N,F){return N&&typeof N=="object"&&"query"in N?N:await(0,D.tR)().get(N,F)}},81583:(k,R,e)=>{"use strict";e.d(R,{N:()=>n});var t=e(69850);function n(i,s){return(0,t.j)(()=>{s&&i.resolveCancelerIfExists(s)})}},72955:(k,R,e)=>{"use strict";e.d(R,{B:()=>n});var t=e(21423);const n=(i,s)=>{let r=1;return s?.structureRev&&s.series&&(r=s.structureRev,(0,t.J3)(i.series,s.series,t.bW)||r++),i.structureRev=r,i}},39374:(k,R,e)=>{"use strict";e.d(R,{BN:()=>F});var t=e(2543),n=e(62467),i=e(44240),s=e(39697),r=e(65474),g=e(81160),a=e(66847),c=e(59099),o=e(1005),h=e(65961),f=e(67791),d=e(39070),p=e(52622),m=e(85858),v=e(41987),l=e(12091),y=e(32264),u=e(26657),D=e(27677),E=e(21969),x=e(53478),P=e(34867);const b=(0,P.DW)("features.query");var M=e(81583),O=e(76885),I=e(61298),T=e(14110),C=e(14792);function S(B){let U=!1;return V=>{if(!V.request||U||O.kM.getUrlSearchParams().editPanel!=null||V.state!==d.Gu.Done&&V.state!==d.Gu.Error)return;const Y={eventName:I.n_.DataRequest,source:V.request.app,datasourceName:B.name,datasourceId:B.id,datasourceUid:B.uid,datasourceType:B.type,dataSize:0,panelId:0,panelPluginId:V.request?.panelPluginId,duration:V.request.endTime-V.request.startTime};K(Y,V),V.request.app!==v.Jk.Explore&&V.request.app!==v.Jk.Correlations&&A(Y,V),V.series&&V.series.length>0&&(Y.dataSize=V.series.length),(0,T.G$)(Y),U=!0};function K(V,H){const Y={};for(let J=0;J<H.series.length;J++){const q=H.series[J].refId;q&&!Y[q]&&(Y[q]=H.series[J].meta?.isCachedResponse??!1)}V.totalQueries=Object.keys(Y).length,V.cachedQueries=Object.values(Y).filter(J=>J===!0).length,H.request&&Number.isInteger(H.request.panelId)&&(V.panelId=H.request.panelId);const X=(0,C.UA)().getCurrent();X&&(V.dashboardId=X.id,V.dashboardName=X.title,V.dashboardUid=X.uid,V.folderName=X.meta.folderTitle)}}function A(B,U){U.errors?.length?B.error=U.errors.join(", "):U.error&&(B.error=U.error.message)}function L(B,U){const K=U.panelData.request,V={...U.packets},H=B.key??B.data?.[0]?.refId??"A";V[H]=B;let Y=B.state||d.Gu.Done,X,J;const q=[],ae=[];for(const le in V){const z=V[le];if((z.error||z.errors?.length)&&(Y=d.Gu.Error,X=z.error,J=z.errors),z.data&&z.data.length)for(const ee of z.data){if(ee.meta?.dataTopic===p.QR.Annotations){ae.push(ee);continue}q.push(ee)}}const j=N(K,Y),te={state:Y,series:q,annotations:ae,error:X,errors:J,request:K,timeRange:j},ne=new Set([...U.panelData.traceIds??[],...B.traceIds??[]]);return ne.size>0&&(te.traceIds=Array.from(ne)),{packets:V,panelData:te}}function N(B,U){const K=B.range;return!(0,t.isString)(K.raw.from)||U!==d.Gu.Streaming?K:{...K,from:m.parse(K.raw.from,!1),to:m.parse(K.raw.to,!0)}}function F(B,U,K){let V={panelData:{state:d.Gu.Loading,series:[],request:U,timeRange:U.range},packets:{}};if(!U.targets.length)return U.endTime=Date.now(),V.panelData.state=d.Gu.Done,(0,n.of)(V.panelData);const H=w(B,U,K).pipe((0,g.T)(Y=>{if(!(0,t.map)(Y.data))throw new Error(`Expected response data to be array, got ${typeof Y.data}.`);const X=U.targets.filter(J=>J.hide);for(const J of X)Y.data=Y.data.filter(q=>q.refId!==J.refId);return U.endTime=Date.now(),V=L(Y,V),V.panelData}),(0,a.W)(Y=>(console.error("runRequest.catchError",Y),b.logError(Y),(0,n.of)({...V.panelData,state:d.Gu.Error,error:(0,l.u)(Y)}))),(0,c.M)(S(B)),(0,M.N)(D.IB,U.requestId),(0,o.u)());return(0,i.h)((0,s.O)(200).pipe((0,h.u)(V.panelData),(0,f.Q)(H)),H)}function w(B,U,K){if(U.targets=U.targets.map(H=>(0,E.Ih)(H)?{...B?.getDefaultQuery?.(v.Jk.PanelEditor),...H}:H),y.$.publicDashboardAccessToken)return(0,r.H)(B.query(U));for(const H of U.targets)if((0,u.s9)(H.datasource))return x.Ex.query(U);if(K||(U.targets=U.targets.filter(H=>B.filterQuery?.(H)??!0)),U.targets.length===0)return(0,n.of)({data:[]});const V=K?K(U):B.query(U);return(0,r.H)(V)}},93117:(k,R,e)=>{"use strict";e.d(R,{y:()=>g});var t=e(41987),n=e(73372),i=e(77789),s=e(72574),r=e(26657);async function g(a,c,o,h){let f=o;const d={...a.getRef(),uid:c},p={...a?.getDefaultQuery?.(t.Jk.PanelEditor),datasource:d,refId:"A"};if(h?.meta.id!==a.meta.id){if(a.meta.mixed)return o;if((0,n.Ee)(h)&&(0,n.FL)(a)){const m=await h.exportToAbstractQueries(o);f=await a.importFromAbstractQueries(m)}else if(h&&a.importQueries)f=await a.importQueries(o,h);else{if(h){const m=(0,s.w)(),v=[];let l=a.uid;const y=m.containsTemplate(c);y&&(l=m.replace(a.uid));const u=o.reduce((D,E)=>{if(E.datasource){let x=E.datasource.uid;const P=m.containsTemplate(x);if(P&&(x=m.replace(E.datasource.uid)),x===l&&P===y)return E.refId=(0,i.M)(D),D.concat([E])}return D},v);if(u.length>0)return u}return[p]}}return f.length===0?[p]:f.map(m=>(!(0,r.s9)(m.datasource)&&!a.meta.mixed&&(m.datasource=d),m))}},53477:(k,R,e)=>{"use strict";e.d(R,{G3:()=>g,TF:()=>o,XJ:()=>m,YU:()=>d,d7:()=>f,if:()=>v,r4:()=>r,w7:()=>p});var t=e(64161);const n=null,i=58,s=8,r={label:"A\u2013Z",value:"alpha-asc"},g="search.sections",a="grafana.search.expanded-folder",c=0,o="general",h="Dashboards",f="grafana.search.include.panels",d="grafana.search.layout",p="grafana.search.sort",m={dashboard:t.G.DashDB,folder:t.G.DashFolder,home:t.G.DashHome},v=1e3},97427:(k,R,e)=>{"use strict";e.d(R,{d:()=>r,n:()=>g});var t=e(96540),n=e(13752),i=e(71733),s=e(39601);function r(){const a=(0,t.useRef)(new n.B);return{keyboardEvents:a.current,onKeyDown:c=>{switch(c.code){case"ArrowDown":case"ArrowUp":case"ArrowLeft":case"ArrowRight":case"Enter":a.current.next(c);default:}}}}function g(a,c,o){const h=(0,t.useRef)({x:0,y:-1}),[f,d]=(0,t.useState)({x:0,y:-1}),p=(0,t.useRef)();return(0,t.useEffect)(()=>{p.current=o.view.fields.url,h.current.x=0,h.current.y=-1,d({...h.current})},[o]),(0,t.useEffect)(()=>{const m=a.subscribe({next:v=>{switch(v?.code){case"ArrowDown":{h.current.y++,d({...h.current});break}case"ArrowUp":h.current.y=Math.max(0,h.current.y-1),d({...h.current});break;case"ArrowRight":{c>0&&(h.current.x=Math.min(c,h.current.x+1),d({...h.current}));break}case"ArrowLeft":{c>0&&(h.current.x=Math.max(0,h.current.x-1),d({...h.current}));break}case"Enter":if(!p.current)break;const l=h.current.x*c+h.current.y;if(l<0){h.current.x=0,h.current.y=0,d({...h.current});break}const y=p.current.values?.[l];typeof y=="string"&&s.Ny.push(i.I.stripBaseFromUrl(y))}}});return()=>m.unsubscribe()},[a,c]),f}},6204:(k,R,e)=>{"use strict";e.d(R,{B9:()=>g,J$:()=>s,KZ:()=>r,MK:()=>i,Pf:()=>n});var t=e(14110);const n=(c,o)=>{(0,t.rR)(`${c}_viewed`,a(o))},i=(c,o)=>{(0,t.rR)(`${c}_result_clicked`,a(o))},s=(c,o)=>{(0,t.rR)(`${c}_query_submitted`,a(o))},r=(c,{error:o,...h})=>{(0,t.rR)(`${c}_query_failed`,{...a(h),error:o})},g=(c,o,h)=>{(0,t.rR)(`grafana_panel_inspect_${c}_${o}_clicked`,h)},a=c=>({layout:c.layout,starredFilter:c.starred??!1,sort:c.sortValue??"",tagCount:c.tagCount??0,queryLength:c.query?.length??0,includePanels:c.includePanels??!1,deleted:c.deleted??!1})},24439:(k,R,e)=>{"use strict";e.d(R,{getGrafanaSearcher:()=>O});var t=e(32264),n=e(78368),i=e(14236),s=e(57875),r=e(17172),g=e(40957);const a="Loading",c="api/search-v2",o="name_sort";class h{constructor(T){this.fallbackSearcher=T}async search(T){if(T.facet?.length)throw new Error("facets not supported!");return this.doSearchQuery(T)}async starred(T){if(T.facet?.length)throw new Error("facets not supported!");const C=await(0,r.AI)().get("api/user/stars");return C?.length?this.doSearchQuery({uid:C,query:T.query??"*"}):{view:new n.R({length:0,fields:[]}),totalRows:0,loadMoreItems:async(S,A)=>{},isItemLoaded:S=>!0}}async tags(T){const C={...T,query:T.query??"*",sort:void 0,facet:[{field:"tag"}],limit:1},A=(await(0,r.AI)().post(c,C)).frames.map(L=>(0,i.Vc)(L));if(A[0]?.name===a)return this.fallbackSearcher.tags(T);for(const L of A)if(L.fields[0].name==="tag")return p(L);return[]}getSortOptions(){const T=[{value:o,label:"Alphabetically (A-Z)"},{value:"-name_sort",label:"Alphabetically (Z-A)"}];if(t.$.licenseInfo.enabledFeatures.analytics){for(const C of m)T.push({value:`-${C.name}`,label:`${C.display} (most)`}),T.push({value:`${C.name}`,label:`${C.display} (least)`});for(const C of v)T.push({value:`-${C.name}`,label:`${C.display} (recent)`}),T.push({value:`${C.name}`,label:`${C.display} (oldest)`})}return Promise.resolve(T)}async doSearchQuery(T){T=await(0,g.u4)(T);const C={...T,query:T.query??"*",limit:T.limit??f},A=(await(0,r.AI)().post(c,C)).frames.map(K=>(0,i.Vc)(K)),L=A.length?(0,i.Vc)(A[0]):{fields:[],length:0};if(L.name===a)return this.fallbackSearcher.search(T);for(const K of L.fields)K.display=(0,s.J)({field:K,theme:t.$.theme2});L.meta?.custom||(L.meta={...L.meta,custom:{count:L.length,max_score:1}});const N=L.meta.custom;if(N.locationInfo||(N.locationInfo={}),N.sortBy?.length){const K=L.fields.find(V=>V.name===N.sortBy);if(K){const V=l(K.name);N.sortBy=V,K.name=V}}let F=0,w;const B=async()=>{for(;F>U.dataFrame.length;){const K=U.dataFrame.length;if(K>=N.count)return;const V=await(0,r.AI)().post(c,{...C??{},from:K,limit:d}),H=(0,i.Vc)(V.frames[0]);if(!H){console.log("no results",H);return}if(H.fields.length!==U.dataFrame.fields.length){console.log("invalid shape",H,U.dataFrame);return}const Y=H.length+U.dataFrame.length;for(let J=0;J<H.fields.length;J++)U.dataFrame.fields[J].values.push(...H.fields[J].values);U.dataFrame.length=Y;const X=H.meta?.custom;if(X?.locationInfo&&N)for(const[J,q]of Object.entries(X.locationInfo))N.locationInfo[J]=q}w=void 0},U=new n.R(L);return{totalRows:N.count??L.length,view:U,loadMoreItems:async(K,V)=>(F=Math.max(F,V),w||(w=B()),w),isItemLoaded:K=>K<U.dataFrame.length}}getFolderViewSort(){return"name_sort"}}const f=50,d=100;function p(I){const T=I.fields[0].values,C=I.fields[1].values,S=[];for(let A=0;A<I.length;A++)S.push({term:T[A],count:C[A]});return S}const m=[{name:"views_total",display:"Views total"},{name:"views_last_30_days",display:"Views 30 days"},{name:"errors_total",display:"Errors total"},{name:"errors_last_30_days",display:"Errors 30 days"}],v=[{name:"created_at",display:"Created time"},{name:"updated_at",display:"Updated time"}];function l(I){for(const T of m)if(T.name===I)return T.display;for(const T of v)if(T.name===I)return T.display;return I}var y=e(53076);class u{constructor(T){this.parent=T,this.cache=new Map,this.sortPlaceholder="Default (Relevance)"}async search(T){if(T.facet?.length)throw new Error("facets not supported!");if(T.sort!=null)throw new Error("custom sorting is not supported yet");if(T.tags?.length||T.ds_uid?.length)return this.parent.search(T);const S=(await this.getCache(T.kind)).search(T.query);return{isItemLoaded:()=>!0,loadMoreItems:async(A,L)=>{},totalRows:S.length,view:S}}async getCache(T){const C=T?T.sort().join(","):"*",S=this.cache.get(C);if(S)try{return await S}catch{return this.cache.delete(C),new D(new n.R({name:"error",fields:[],length:0}))}const A=this.parent.search({kind:T,limit:5e3}).then(L=>new D(L.view));return this.cache.set(C,A),A}async starred(T){return this.parent.starred(T)}async getSortOptions(){return this.parent.getSortOptions()}async tags(T){return this.parent.tags(T)}getFolderViewSort(){return this.parent.getFolderViewSort()}}class D{constructor(T){this.full=T,this.ufuzzy=new y.A({intraMode:1,intraIns:1,intraSub:1,intraTrn:1,intraDel:1}),this.names=this.full.fields.name.values,this.empty=new n.R({...this.full.dataFrame,fields:this.full.dataFrame.fields.map(C=>({...C,values:[]})),length:0})}search(T){if(!T?.length||T==="*")return this.full;const C=this.full.dataFrame.fields,S=this.names,A=C.map(w=>[]);let[L,N,F]=this.ufuzzy.search(S,T,5);for(let w=0;w<C.length;w++){let B=C[w].values,U=A[w];if(N&&F)for(let K=0;K<F.length;K++){let V=N.idx[F[K]];U.push(B[V])}else if(L)for(let K=0;K<L.length;K++){let V=L[K];U.push(B[V])}}return this.empty.dataFrame.fields.forEach((w,B)=>{w.values=A[B]}),this.empty.dataFrame.length=this.empty.dataFrame.fields[0].values.length,this.empty}}var E=e(11261),x=e(27677),P=e(53477);class b{constructor(){this.locationInfo={general:{kind:"folder",name:"Dashboards",url:"/dashboards"}},this.getFolderViewSort=()=>""}async composeQuery(T,C){const S=await(0,g.u4)(C);return S.query?.length&&S.query!=="*"&&(T.query=S.query),S.kind?.length===1&&P.XJ[S.kind[0]]&&(T.type=P.XJ[S.kind[0]]),S.uid?T.dashboardUID=S.uid:S.location?.length&&(T.folderUIDs=[S.location]),T}async search(T){if(T.facet?.length)throw new Error("facets not supported!");if(T.from!==void 0){if(!T.limit)throw new Error("Must specify non-zero limit parameter when using from");if(T.from/T.limit%1!==0)throw new Error("From parameter must be a multiple of limit")}const C=T.limit??(T.from!==void 0?1:P.if),S=T.from!==void 0?T.from/C+1:void 0,A=await this.composeQuery({limit:C,tag:T.tags,sort:T.sort,permission:T.permission,page:S,deleted:T.deleted},T);return this.doAPIQuery(A)}async starred(T){if(T.facet?.length)throw new Error("facets not supported!");const C=await this.composeQuery({limit:T.limit??P.if,tag:T.tags,sort:T.sort,starred:T.starred},T);return this.doAPIQuery(C)}async getSortOptions(){return(await x.IB.get("/api/search/sorting")).sortOptions.map(C=>({value:C.name,label:C.displayName}))}async tags(T){return(await x.IB.get("/api/dashboards/tags")).sort((S,A)=>A.count-S.count)}async doAPIQuery(T){const C=await x.IB.get("/api/search",T),S=[],A=[],L=[],N=[],F=[],w=[],B=[],U=[],K=[];let V;for(let X of C){const J=X.type==="dash-folder"?"folder":"dashboard";S.push(J),A.push(X.title),L.push(X.uid),N.push(X.url),F.push(X.tags),B.push(X.sortMeta),U.push(X.isDeleted??!1),K.push(X.permanentlyDeleteDate?new Date(X.permanentlyDeleteDate):void 0);let q=X.folderUid;!q&&J==="dashboard"&&(q="general"),w.push(q),X.sortMetaName?.length&&(V=X.sortMetaName),X.folderUid&&X.folderTitle?this.locationInfo[X.folderUid]={kind:"folder",name:X.folderTitle,url:X.folderUrl,folderUid:X.folderUid}:J==="folder"&&(this.locationInfo[X.uid]={kind:J,name:X.title,url:X.url,folderUid:X.folderUid})}const H={fields:[{name:"kind",type:E.PU.string,config:{},values:S},{name:"name",type:E.PU.string,config:{},values:A},{name:"uid",type:E.PU.string,config:{},values:L},{name:"url",type:E.PU.string,config:{},values:N},{name:"tags",type:E.PU.other,config:{},values:F},{name:"location",type:E.PU.string,config:{},values:w},{name:"isDeleted",type:E.PU.boolean,config:{},values:U},{name:"permanentlyDeleteDate",type:E.PU.time,config:{},values:K}],length:A.length,meta:{custom:{count:A.length,max_score:1,locationInfo:this.locationInfo}}};V?.length&&B.length&&(H.meta.custom.sortBy=V,H.fields.push({name:V,type:E.PU.number,config:{},values:B}));for(const X of H.fields)X.display=(0,s.J)({field:X,theme:t.$.theme2});const Y=new n.R(H);return{totalRows:H.length,view:Y,loadMoreItems:async(X,J)=>{},isItemLoaded:X=>!0}}}let M;function O(){if(!M){const I=new b,T=t.$.featureToggles.panelTitleSearch;M=T?new h(I):I,T&&location.search.includes("do-frontend-query")&&(M=new u(M))}return M}},40957:(k,R,e)=>{"use strict";e.d(R,{TM:()=>g,cu:()=>a,hI:()=>o,u4:()=>i});var t=e(49952),n=e(14792);async function i(h){return h.query&&h.query.indexOf("folder:current")>=0&&(h={...h,location:await s(),query:h.query.replace("folder:current","").trim()},h.query?.length||(h.query="*")),Promise.resolve(h)}async function s(){try{let h=(0,n.UA)().getCurrent();return h||(await r(500),h=(0,n.UA)().getCurrent()),Promise.resolve(h?.meta?.folderUid)}catch(h){console.error(h)}}function r(h){return new Promise(f=>setTimeout(f,h))}function g(h,f){return h==="dashboard"?"apps":h==="folder"?f?"folder-open":"folder":"question-circle"}function a(h,f){return h&&(0,t.I)(h.uid)?"users-alt":g(h.kind,f)}function c(h){switch(h){case"dashboard":case"folder":case"panel":return h;default:return"dashboard"}}function o(h,f){const d=f?.dataFrame.meta?.custom,p={kind:c(h.kind),uid:h.uid,title:h.name,url:h.url,tags:h.tags??[]},m=d?.sortBy;if(m){const v=h[m];(typeof v=="string"||typeof v=="number")&&(p.sortMetaName=m,p.sortMeta=v)}if(h.location){const v=h.location.split("/"),l=v[v.length-1],y=d?.locationInfo[l];y&&(p.parentTitle=y.name,p.parentKind=y.kind,p.parentUID=l)}return p}},64161:(k,R,e)=>{"use strict";e.d(R,{G:()=>t,P:()=>n});var t=(i=>(i.DashDB="dash-db",i.DashHome="dash-home",i.DashFolder="dash-folder",i))(t||{}),n=(i=>(i.List="list",i.Folders="folders",i))(n||{})},16757:(k,R,e)=>{"use strict";e.d(R,{N1:()=>r,W1:()=>i});var t=e(53477);const n=g=>g?!!(g.query||g.tag?.length>0||g.starred||g.sort):!1,i=()=>{const g=t.G3+".";for(let a=0;a<window.localStorage.length;a++){const c=window.localStorage.key(a);c?.startsWith(g)&&window.localStorage.removeItem(c)}},s=(g="General")=>`${SECTION_STORAGE_KEY}.${g.toLowerCase()}`,r=g=>{const a=Object.entries(g).reduce((c,[o,h])=>{if(h){if(o==="tag"&&!Array.isArray(h))return{...c,tag:[h]}}else return c;return{...c,[o]:h}},{});if(g.folder){const c=`folder:${g.folder}`;return{...a,query:`${c} ${(a.query??"").replace(c,"")}`}}return{...a}}},1936:(k,R,e)=>{"use strict";e.d(R,{Ay:()=>P,EC:()=>D,FW:()=>v,G3:()=>c,L5:()=>x,QM:()=>g,Yh:()=>l,aD:()=>o,c3:()=>E,ch:()=>a,dJ:()=>h,ew:()=>u,jE:()=>f,zh:()=>y});var t=e(65307),n=e(31678);const i={serviceAccount:{},isLoading:!0,tokens:[]},s=(0,t.Z0)({name:"serviceaccount",initialState:i,reducers:{serviceAccountFetchBegin:b=>({...b,isLoading:!0}),serviceAccountFetchEnd:b=>({...b,isLoading:!1}),serviceAccountLoaded:(b,M)=>({...b,serviceAccount:M.payload,isLoading:!1}),serviceAccountTokensLoaded:(b,M)=>({...b,tokens:M.payload,isLoading:!1}),rolesFetchBegin:b=>({...b,rolesLoading:!0}),rolesFetchEnd:b=>({...b,rolesLoading:!1})}}),r=s.reducer,{serviceAccountLoaded:g,serviceAccountTokensLoaded:a,serviceAccountFetchBegin:c,serviceAccountFetchEnd:o,rolesFetchBegin:h,rolesFetchEnd:f}=s.actions,d={serviceAccounts:[],isLoading:!0,roleOptions:[],query:"",page:0,perPage:50,totalPages:1,showPaging:!1,serviceAccountStateFilter:n.ServiceAccountStateFilter.All},p=(0,t.Z0)({name:"serviceaccounts",initialState:d,reducers:{serviceAccountsFetched:(b,M)=>{const{totalCount:O,perPage:I,...T}=M.payload,C=Math.ceil(O/I);return{...b,...T,totalPages:C,perPage:I,showPaging:C>1,isLoading:!1}},serviceAccountsFetchBegin:b=>({...b,isLoading:!0}),serviceAccountsFetchEnd:b=>({...b,isLoading:!1}),acOptionsLoaded:(b,M)=>({...b,roleOptions:M.payload}),queryChanged:(b,M)=>({...b,query:M.payload,page:0}),pageChanged:(b,M)=>({...b,page:M.payload}),stateFilterChanged:(b,M)=>({...b,serviceAccountStateFilter:M.payload})}}),m=p.reducer,{serviceAccountsFetchBegin:v,serviceAccountsFetchEnd:l,serviceAccountsFetched:y,acOptionsLoaded:u,pageChanged:D,stateFilterChanged:E,queryChanged:x}=p.actions,P={serviceAccountProfile:r,serviceAccounts:m}},8212:(k,R,e)=>{"use strict";e.d(R,{Ay:()=>p,NV:()=>f,Y1:()=>c,j7:()=>a,kH:()=>g,pB:()=>h,s7:()=>o,sF:()=>r,sJ:()=>s});var t=e(65307);const n={supportBundles:[],isLoading:!1,supportBundleCollectors:[],createBundlePageLoading:!1,loadBundlesError:"",createBundleError:""},i=(0,t.Z0)({name:"supportBundles",initialState:n,reducers:{supportBundlesLoaded:(m,v)=>({...m,supportBundles:v.payload,isLoading:!1}),fetchBegin:m=>({...m,isLoading:!0}),fetchEnd:m=>({...m,isLoading:!1}),collectorsFetchBegin:m=>({...m,createBundlePageLoading:!0}),collectorsFetchEnd:m=>({...m,createBundlePageLoading:!1}),supportBundleCollectorsLoaded:(m,v)=>({...m,supportBundleCollectors:v.payload,createBundlePageLoading:!1}),setLoadBundleError:(m,v)=>({...m,loadBundlesError:v.payload,supportBundleCollectors:[]}),setCreateBundleError:(m,v)=>({...m,createBundleError:v.payload})}}),{supportBundlesLoaded:s,fetchBegin:r,fetchEnd:g,supportBundleCollectorsLoaded:a,collectorsFetchBegin:c,collectorsFetchEnd:o,setLoadBundleError:h,setCreateBundleError:f}=i.actions,p={supportBundles:i.reducer}},34655:(k,R,e)=>{"use strict";e.d(R,{$T:()=>p,$u:()=>a,Ay:()=>u,EC:()=>g,L5:()=>r,Q9:()=>s,dJ:()=>c,jE:()=>o,tC:()=>m});var t=e(65307);const n={teams:[],page:1,query:"",perPage:30,totalPages:0,noTeams:!1,hasFetched:!1},i=(0,t.Z0)({name:"teams",initialState:n,reducers:{teamsLoaded:(D,E)=>{const{totalCount:x,perPage:P,...b}=E.payload,M=Math.ceil(x/P);return{...D,...b,totalPages:M,perPage:P,hasFetched:!0}},queryChanged:(D,E)=>({...D,page:1,query:E.payload}),pageChanged:(D,E)=>({...D,page:E.payload}),sortChanged:(D,E)=>({...D,sort:E.payload,page:1}),rolesFetchBegin:D=>({...D,rolesLoading:!0}),rolesFetchEnd:D=>({...D,rolesLoading:!1})}}),{teamsLoaded:s,queryChanged:r,pageChanged:g,sortChanged:a,rolesFetchBegin:c,rolesFetchEnd:o}=i.actions,h=i.reducer,f={team:{},members:[],groups:[],searchMemberQuery:""},d=(0,t.Z0)({name:"team",initialState:f,reducers:{teamLoaded:(D,E)=>({...D,team:E.payload}),teamMembersLoaded:(D,E)=>({...D,members:E.payload}),setSearchMemberQuery:(D,E)=>({...D,searchMemberQuery:E.payload}),teamGroupsLoaded:(D,E)=>({...D,groups:E.payload})}}),{teamLoaded:p,teamGroupsLoaded:m,teamMembersLoaded:v,setSearchMemberQuery:l}=d.actions,y=d.reducer,u={teams:h,team:y}},23989:(k,R,e)=>{"use strict";e.d(R,{w:()=>ne});var t=e(2543),n=e(95344),i=e(19347),s=e(72574),r=e(80943),g=e(52622),a=e(73788),c=e(20601),o=e(13344),h=e(24240),f=e(87421),d=e(75096);let p={};function m(le){const z=p[le];return z||(p[le]=(0,t.property)(le))}class v{constructor(z,ee,se){this.state={name:z.name,value:ee,text:se,type:z.type}}getValue(z){let{value:ee}=this.state;return ee==="string"||ee==="number"||ee==="boolean"?ee:String(ee)}getValueText(){const{value:z,text:ee}=this.state;return typeof ee=="string"?z===o.To?o.Zm:ee:Array.isArray(ee)?ee.join(" + "):(console.log("value",ee),String(ee))}}let l;function y(le,z,ee){return l?(l.state.name=le.name,l.state.type=le.type,l.state.value=z,l.state.text=ee):l=new v(le,z,ee),l}function u(le,z,ee,se){if(ee=ee||{},le==null||(0,h.EW)(ee)&&z!==g.$m.QueryParam)return"";if(!Array.isArray(le)&&typeof le=="object"&&(le=`${le}`),typeof z=="function")return z(le,ee,u);z||(z=g.$m.Glob);let ie=z.split(":");ie.length>1?(z=ie[0],ie=ie.slice(1)):ie=[];let Z=r.vz.getIfExists(z);Z||(console.error(`Variable format ${z} not found. Using glob format as fallback.`),Z=r.vz.get(g.$m.Glob));const oe=y(ee,le,se??le);return Z.formatter(le,ie,oe)}var D=e(84743),E=e.n(D),x=e(6709),P=e(76885),b=e(1933),M=e(74856),O=e(25304),I=e(83195),T=e(11261),C=e(92461),S=e(57875),A=e(28240),L=e(8249);function N(le,z,ee){return new Proxy({},{get:(se,ie)=>{if(ie==="name")return le.name;if(ie==="displayName")return(0,A.Ct)(le,z,ee);if(ie==="labels"||ie==="formattedLabels")return le.labels?{...le.labels,__values:Object.values(le.labels).sort().join(", "),toString:()=>(0,L.h6)(le.labels,"",!0)}:""}})}function F(le,z,ee,se){const ie=w(le,z,ee);return u(ie,se)}function w(le,z,ee){const se=ee?.__dataContext;if(!se)return le;const{frame:ie,rowIndex:Z,field:oe,calculatedValue:ce}=se.value;if(ce)switch(z){case"numeric":return ce.numeric.toString();case"raw":return ce.numeric;case"time":return"";case"text":default:return(0,I.cN)(ce)}if(Z===void 0)return le;if(z==="time"){const De=ie.fields.find(ge=>ge.type===T.PU.time);return De?De.values[Z]:void 0}const ye=oe.values[Z];if(z==="raw")return ye;const ue=(oe.display??K())(ye);switch(z){case"numeric":return ue.numeric;case"text":return ue.text;default:return(0,I.cN)(ue)}}function B(le,z,ee,se){const ie=ee?.__dataContext;if(!ie||!z)return le;const{frame:Z,rowIndex:oe}=ie.value;if(oe===void 0||z===void 0)return le;const ce={name:Z.name,refId:Z.refId,fields:(0,C.F)({frame:Z,rowIndex:oe})},ye=m(z)(ce)??"";return u(ye,se)}let U;function K(){return U||(U=(0,S.J)()),U}function V(le,z,ee,se){const ie=ee?.__dataContext;if(!ie||z!=="name")return le;const{frame:Z,frameIndex:oe}=ie.value,ce=(0,A.Ri)(Z,oe);return u(ce,se)}function H(le,z,ee,se){const ie=ee?.__dataContext;if(!ie||z===void 0||z==="")return le;const{frame:Z,field:oe,data:ce}=ie.value,ye=N(oe,Z,ce),re=m(z)(ye)??"";return u(re,se)}const Y={__value:F,__data:B,__series:V,__field:H,[x.c.includeVars]:X,[x.c.keepTime]:J,__timezone:q};function X(le,z,ee){const se=(0,O.z)(ee);return P.kM.toUrlParams(se)}function J(){return P.kM.toUrlParams((0,M.jG)().timeRangeForUrl())}function q(){const le=(0,b.O)({timeZone:(0,M.jG)().timeModel?.getTimezone()});return le==="browser"?E().tz.guess():le}const ae={getFilteredVariables:f.bZ,getVariables:f.UN,getVariableWithName:f._2};class j{constructor(z=ae){this.dependencies=z,this.regex=d.SY,this.index={},this.grafanaVariables=new Map,this._timeRange=null,this._adhocFiltersDeprecationWarningLogged=new Map,this._variables=[]}init(z,ee){this._variables=z,this._timeRange=ee,this.updateIndex()}get variables(){return(0,n.l)("template_srv.ts","variables","getVariables"),this.getVariables()}getVariables(){return window.__grafanaSceneContext?(0,a.E)(window.__grafanaSceneContext):this.dependencies.getVariables()}get timeRange(){return window.__grafanaSceneContext&&window.__grafanaSceneContext.isActive?r.jh.getTimeRange(window.__grafanaSceneContext).state.value:this._timeRange}updateIndex(){const z=ee=>ee||ee==="";if(this.index=this._variables.reduce((ee,se)=>(se.current&&(se.current.isNone||z(se.current.value))&&(ee[se.name]=se),ee),{}),this.timeRange){const ee=this.timeRange.from.valueOf().toString(),se=this.timeRange.to.valueOf().toString();this.index={...this.index,__from:{current:{value:ee,text:ee}},__to:{current:{value:se,text:se}}}}}updateTimeRange(z){this._timeRange=z,this.updateIndex()}variableInitialized(z){this.index[z.name]=z}getAdhocFilters(z,ee){let se=[],ie=(0,i.l)().getInstanceSettings(z);if(!ie)return[];!ee&&!this._adhocFiltersDeprecationWarningLogged.get(ie.type)&&((0,n.l)(`DataSource ${ie.type}`,"templateSrv.getAdhocFilters","filters property on the request (DataQueryRequest). Or if this is called from interpolateVariablesInQueries or applyTemplateVariables it is passed as a new argument"),this._adhocFiltersDeprecationWarningLogged.set(ie.type,!0));for(const Z of this.getAdHocVariables()){const oe=Z.datasource?.uid;(oe===ie.uid||oe?.indexOf("$")===0&&this.replace(oe)===ie.uid)&&(se=se.concat(Z.filters))}return se}setGrafanaVariable(z,ee){this.grafanaVariables.set(z,ee)}setGlobalVariable(z,ee){(0,n.l)("template_srv.ts","setGlobalVariable",""),this.index={...this.index,[z]:{current:ee}}}getVariableName(z){this.regex.lastIndex=0;const ee=this.regex.exec(z);return ee?ee.slice(1).find(ie=>ie!==void 0):null}containsTemplate(z){if(!z)return!1;const ee=this.getVariableName(z),se=ee&&this.getVariableAtIndex(ee);return se!=null}variableExists(z){return(0,n.l)("template_srv.ts","variableExists","containsTemplate"),this.containsTemplate(z)}highlightVariablesAsHtml(z){return!z||!(0,t.isString)(z)?z:(z=(0,t.escape)(z),this._replaceWithVariableRegex(z,void 0,(ee,se)=>this.getVariableAtIndex(se)?'<span class="template-variable">'+ee+"</span>":ee))}getAllValue(z){if(z.allValue)return z.allValue;const ee=[];for(let se=1;se<z.options.length;se++)ee.push(z.options[se].value);return ee}getVariableValue(z,ee){return ee?m(ee)(z.value):z.value}getVariableText(z,ee){return z.value===ee||typeof ee!="string"?z.text:ee}replace(z,ee,se,ie){if(ee&&ee.__sceneObject){const Z=ee.__sceneObject.value.valueOf();return r.jh.interpolate(Z,z,ee,se,ie)}return window.__grafanaSceneContext&&window.__grafanaSceneContext.isActive?r.jh.interpolate(window.__grafanaSceneContext,z,ee,se,ie):z?(this.regex.lastIndex=0,this._replaceWithVariableRegex(z,se,(Z,oe,ce,ye)=>{const re=this._evaluateVariableExpression(Z,oe,ce,ye,ee);return ie&&ie.push({match:Z,variableName:oe,fieldPath:ce,format:ye,value:re,found:re!==Z}),re})):z??""}_evaluateVariableExpression(z,ee,se,ie,Z){const oe=this.getVariableAtIndex(ee),ce=Z?.[ee];if(ce){const De=this.getVariableValue(ce,se),ge=this.getVariableText(ce,De);if(De!=null)return u(De,ie,oe,ge)}if(!oe){const De=Y[ee];return De?De(z,se,Z,ie):z}if(ie===g.$m.QueryParam||(0,h.EW)(oe)){const De=c.B.get(oe.type).getValueForUrl(oe),ge=(0,h.EW)(oe)?oe.id:oe.current.text;return u(De,ie,oe,ge)}const ye=this.grafanaVariables.get(oe.current.value);if(ye)return u(ye,ie,oe);let re=oe.current.value,ue=oe.current.text;if(this.isAllValue(re)&&(re=this.getAllValue(oe),ue=o.Zm,oe.allValue&&ie!==g.$m.Text&&ie!==g.$m.PercentEncode))return this.replace(re);if(se){const De=this.getVariableValue({value:re,text:ue},se);if(De!=null)return u(De,ie,oe,ue)}return u(re,ie,oe,ue)}_replaceWithVariableRegex(z,ee,se){return this.regex.lastIndex=0,z.replace(this.regex,(ie,Z,oe,ce,ye,re,ue)=>se(ie,Z||oe||ye,re,ce||ue||ee))}isAllValue(z){return z===o.To||Array.isArray(z)&&z[0]===o.To}replaceWithText(z,ee){return(0,n.l)("template_srv.ts","replaceWithText()","replace(), and specify the :text format"),this.replace(z,ee,"text")}getVariableAtIndex(z){if(z)return this.index[z]?this.index[z]:this.dependencies.getVariableWithName(z)}getAdHocVariables(){return this.dependencies.getFilteredVariables(h.EW)}}const te=new j;(0,s.d)(te);const ne=()=>te},29352:(k,R,e)=>{"use strict";e.d(R,{v:()=>A});var t=e(4200),n=e(80943);function i({title:L,unit:N}){return n.d0.timeseries().setTitle(L).setUnit(N).setOption("legend",{showLegend:!1}).setCustomFieldConfig("fillOpacity",9)}function s({description:L,mainQueryExpr:N,breakdownQueryExpr:F,unit:w}){const B={title:`${t.Rp}`,unit:w},U={refId:"A",expr:N,legendFormat:L},K={...B,title:L,queries:[U],variant:"main",vizBuilder:()=>i({...K})},V={...K,title:`${t.Rp}`,queries:[{...U,legendFormat:L}],vizBuilder:()=>i(V),variant:"preview"},H={...B,queries:[{refId:"A",expr:F,legendFormat:`{{${t.aZ}}}`}],vizBuilder:()=>i(H),variant:"breakdown"};return{preview:V,main:K,breakdown:H,variants:[]}}const r=`${t.Rp}${t.ui}`,g=`rate(${r}[$__rate_interval])`;function a(L){return L?g:r}const c={avg:"average",sum:"overall"};function o(L){return c[L]||L}function h({agg:L,rate:N,unit:F}){const w=a(N),B=N?`${o(L)} per-second rate`:`${o(L)}`,U=`${t.Rp} (${B})`,K=`${L}(${w})`,V=`${L}(${w})by(${t.aZ})`;return s({description:U,mainQueryExpr:K,breakdownQueryExpr:V,unit:F})}var f=e(8620);const d=new Set(["count","total"]),p=new Set(["sum","bucket"]),m={count:"sum",total:"sum"};function v(L){return L==="total"}function l(L){const N=L.at(-1);if(N==null||p.has(N))throw new Error(`This function does not support a metric suffix of "${N}"`);const F=d.has(N),w=m[N]||"avg",B=v(N)?L.at(-2):N,U=F?(0,f.MM)(B):(0,f.l_)(B);return{agg:w,unit:U,rate:F}}function y(L){const N=l(L);return h(N)}const u={generator:y};var D=e(52995);function E({title:L,unit:N}){return n.d0.heatmap().setTitle(L).setUnit(N).setOption("calculate",!1).setOption("color",{mode:D.P7.Scheme,exponent:.5,scheme:"Spectral",steps:32,reverse:!1})}function x({title:L,unit:N}){return n.d0.timeseries().setTitle(L).setUnit(N).setCustomFieldConfig("fillOpacity",9)}function P(L){const N=`${t.Rp}`,F=L.at(-2),w=(0,f.l_)(F),B={title:N,unit:w},U={...B,variant:"p50",queries:[I(50)],vizBuilder:()=>i(U)},K={...B,variant:"p50",queries:[I(50,[t.aZ])],vizBuilder:()=>i(K)},V={...B,variant:"percentiles",queries:[99,90,50].map(Y=>I(Y)),vizBuilder:()=>x(V)},H={...B,variant:"heatmap",queries:[O()],vizBuilder:()=>E(H)};return{preview:U,main:V,variants:[V,H],breakdown:K}}const b=`rate(${t.Rp}${t.ui}[$__rate_interval])`;function M(L=[]){return`sum by(${["le",...L].join(", ")}) (${b})`}function O(L=[]){return{refId:"Heatmap",expr:M(L),format:"heatmap"}}function I(L,N=[]){const F=L/100;let w=`${L}th Percentile`;return N[0]&&(w=`{{${N[0]}}}`),{refId:`Percentile${L}`,expr:`histogram_quantile(${F}, ${M(N)})`,legendFormat:w}}function T(L){if(L.at(-1)!=="sum")throw new Error('createSummaryQueryDefs is only to be used for metrics that end in "_sum"');const F=L.at(-2),w=(0,f.l_)(F),U=a(!0),K=L.slice(0,-1).join("_"),V=J(`sum(${U})`),H=J(`sum(${U})by(${t.aZ})`),X=`${K} (average)`;function J(q){const ae=q.replace(t.Rp,`${K}_sum`),j=q.replace(t.Rp,`${K}_count`);return`${ae}/${j}`}return s({description:X,mainQueryExpr:V,breakdownQueryExpr:H,unit:w})}const C={sum:T,bucket:P};function S(L){return L&&C[L]||u.generator}function A(L){const N=L.split("_"),F=N.at(-1),w=S(F);if(!w)throw new Error(`Unable to generate queries for metric "${L}" due to issues with derived suffix "${F}"`);return w(N)}},8620:(k,R,e)=>{"use strict";e.d(R,{MM:()=>c,l_:()=>i,vL:()=>n});const t="short";function n(o){const h=o.split("_"),f=h.at(-1)??"",d=h.at(-2)??"";return r.includes(f)?f:r.includes(d)?d:null}function i(o){return o&&s[o]||t}const s={bytes:"bytes",seconds:"s"},r=["bytes","seconds"],g={bytes:"Bps",seconds:"short"},a="cps";function c(o){return o&&g[o]||a}},56833:(k,R,e)=>{"use strict";e.d(R,{b:()=>P,B:()=>b});var t=e(74848),n=e(32196),i=e(76885),s=e(12470),r=e(39601),g=e(23172),a=e(80943),c=e(40845),o=e(15292),h=e(83122),f=e(27746),d=e(40588);class p extends a.Bs{constructor(C){super({stickyMainGraph:C.stickyMainGraph??!0,isOpen:C.isOpen??!1}),this.onToggleStickyMainGraph=()=>{const S=!this.state.stickyMainGraph;(0,d.z)("settings_changed",{stickyMainGraph:S}),this.setState({stickyMainGraph:S})},this.onToggleOpen=S=>{this.setState({isOpen:S})}}static{this.Component=({model:C})=>{const{stickyMainGraph:S,isOpen:A}=C.useState(),L=(0,c.of)(m),N=()=>(0,t.jsxs)("div",{className:L.popover,onClick:F=>F.stopPropagation(),children:[(0,t.jsx)("div",{className:L.heading,children:"Settings"}),(0,t.jsxs)("div",{className:L.options,children:[(0,t.jsx)("div",{children:"Always keep selected metric graph in-view"}),(0,t.jsx)(o.d,{value:S,onChange:C.onToggleStickyMainGraph})]})]});return(0,t.jsx)(h.m,{overlay:N,placement:"bottom",onVisibleChange:C.onToggleOpen,children:(0,t.jsx)(f.I,{icon:"cog",variant:"canvas",isOpen:A})})}}}function m(T){return{popover:(0,n.css)({display:"flex",padding:T.spacing(2),flexDirection:"column",background:T.colors.background.primary,boxShadow:T.shadows.z3,borderRadius:T.shape.borderRadius(),border:`1px solid ${T.colors.border.weak}`,zIndex:1,marginRight:T.spacing(2)}),heading:(0,n.css)({fontWeight:T.typography.fontWeightMedium,paddingBottom:T.spacing(2)}),options:(0,n.css)({display:"grid",gridTemplateColumns:"1fr 50px",rowGap:T.spacing(1),columnGap:T.spacing(2)})}}var v=e(13054),l=e(94383),y=e(21028),u=e(90623),D=e(74764),E=e(88434),x=e(4200);class P extends a.Bs{constructor(C){super({$timeRange:C.$timeRange??new a.JZ({}),$variables:C.$variables??M(C.initialDS,C.metric,C.initialFilters),controls:C.controls??[new a.K8({layout:"vertical"}),new a.N0,new a.KE({}),new a.WM({})],history:C.history??new v.LR({}),settings:C.settings??new p({}),createdAt:C.createdAt??new Date().getTime(),...C}),this._urlSync=new a.So(this,{keys:["metric","metricSearch"]}),this._variableDependency=new a.Sh(this,{variableNames:[x.EY],onReferencedVariableValueChanged:async S=>{const{name:A}=S.state;A===x.EY&&this.datasourceHelper.reset()}}),this._addingFilterWithoutReportingInteraction=!1,this.datasourceHelper=new E.q(this),this.addActivationHandler(this._onActivate.bind(this))}_onActivate(){this.state.topScene||this.setState({topScene:b(this.state.metric)}),this.subscribeToEvent(x.OO,this._handleMetricSelectedEvent.bind(this));const C=a.jh.lookupVariable(x.Ao,this);C instanceof a.H9&&this._subs.add(C?.subscribeToState((A,L)=>{this._addingFilterWithoutReportingInteraction||(0,d.h)(A.filters,L.filters)}));const S=()=>(0,D._r)().setRecentTrail(this);return window.addEventListener("unload",S),()=>{this.state.embedded||S(),window.removeEventListener("unload",S)}}addFilterWithoutReportingInteraction(C){const S=a.jh.lookupVariable("filters",this);S instanceof a.H9&&(this._addingFilterWithoutReportingInteraction=!0,S.setState({filters:[...S.state.filters,C]}),this._addingFilterWithoutReportingInteraction=!1)}getMetricMetadata(C){return this.datasourceHelper.getMetricMetadata(C)}getCurrentMetricMetadata(){return this.getMetricMetadata(this.state.metric)}restoreFromHistoryStep(C){!C.topScene&&!C.metric&&(C.topScene=new y.t({})),this.setState(a.Go.cloneSceneObjectState(C,{history:this.state.history,metric:C.metric?C.metric:void 0,metricSearch:C.metricSearch?C.metricSearch:void 0}));const S=(0,a.Is)().getUrlState(this),A=i.kM.renderUrl(r.Ny.getLocation().pathname,S);r.Ny.replace(A)}_handleMetricSelectedEvent(C){this.setState(this.getSceneUpdatesForNewMetricValue(C.payload));const S=a.jh.lookupVariable(x.Ao,this);S instanceof a.H9&&S.setState({baseFilters:I(C.payload)})}getSceneUpdatesForNewMetricValue(C){const S={};return S.metric=C,S.topScene=b(C),S}getUrlState(){const{metric:C,metricSearch:S}=this.state;return{metric:C,metricSearch:S}}updateFromUrl(C){const S={};typeof C.metric=="string"?this.state.metric!==C.metric&&Object.assign(S,this.getSceneUpdatesForNewMetricValue(C.metric)):C.metric==null&&(S.metric=void 0,S.topScene=new y.t({})),typeof C.metricSearch=="string"?S.metricSearch=C.metricSearch:C.metric==null&&(S.metricSearch=void 0),this.setState(S)}static{this.Component=({model:C})=>{const{controls:S,topScene:A,history:L,settings:N}=C.useState(),F=(0,g.k)(),w=(0,c.of)(O,F??0),B=(0,D._r)().recent.length<2;return(0,t.jsxs)("div",{className:w.container,children:[B&&(0,t.jsx)(u.p,{}),(0,t.jsx)(L.Component,{model:L}),S&&(0,t.jsxs)("div",{className:w.controls,children:[S.map(U=>(0,t.jsx)(U.Component,{model:U},U.state.key)),(0,t.jsx)(N.Component,{model:N})]}),(0,t.jsx)("div",{className:w.body,children:A&&(0,t.jsx)(A.Component,{model:A})})]})}}}function b(T){return T?new l.R({metric:T}):new y.t({})}function M(T,C,S){return new a.Pj({variables:[new a.mI({name:x.EY,label:"Data source",description:"Only prometheus data sources are supported",value:T,pluginId:"prometheus"}),new a.H9({name:x.Ao,addFilterButtonText:"Add label",datasource:x.GH,hide:s.zL.hideLabel,layout:"vertical",filters:S??[],baseFilters:I(C)})]})}function O(T,C){return{container:(0,n.css)({flexGrow:1,display:"flex",gap:T.spacing(1),flexDirection:"column",background:T.isLight?T.colors.background.primary:T.colors.background.canvas,padding:T.spacing(2,3,2,3)}),body:(0,n.css)({flexGrow:1,display:"flex",flexDirection:"column"}),controls:(0,n.css)({display:"flex",gap:T.spacing(1),padding:T.spacing(1,0),alignItems:"flex-end",flexWrap:"wrap",position:"sticky",background:T.isDark?T.colors.background.canvas:T.colors.background.primary,zIndex:T.zIndex.navbarFixed,top:C})}}function I(T){return T?[{key:"__name__",operator:"=",value:T}]:[]}},13054:(k,R,e)=>{"use strict";e.d(R,{LR:()=>x,hi:()=>v});var t=e(74848),n=e(32196),i=e(96540),s=e(91410),r=e(43127),g=e(65879),a=e(80943),c=e(67061),o=e(40845),h=e(56034),f=e(56833),d=e(40588),p=e(4200),m=e(51080);function v(T){return"currentStep"in T&&"steps"in T}function l(T){return!!T}const y=T=>typeof T=="string",u=" $2 ",D=/(\|)(=|=~|!=|>|<|!~)(\|)/g,E={start:"Start of history",metric:"Metric selected:",metric_page:"Metric select page",filters:"Filter applied:",time:"Time range changed:"};class x extends a.Bs{constructor(C){super({steps:C.steps??[],currentStep:C.currentStep??0,filtersApplied:[]}),this.stepTransitionInProgress=!1,this.addActivationHandler(this._onActivate.bind(this))}_onActivate(){const C=(0,m.kj)(this);if(this.state.steps.length===0)if(this.addTrailStep(C,"start"),C.state.metric){const{metric:S,...A}=C.state;A.topScene=(0,f.B)(void 0),this.state.steps[0].trailState=A,this.addTrailStep(C,"metric",C.state.metric)}else this.addTrailStep(C,"metric_page");C.subscribeToState((S,A)=>{S.metric!==A.metric&&(this.state.steps.length===1&&(this.state.steps[0].trailState=a.Go.cloneSceneObjectState(A,{history:this})),S.metric?this.addTrailStep(C,"metric",S.metric):this.addTrailStep(C,"metric_page"))}),C.subscribeToEvent(a.oh,S=>{if(S.payload.state.name===p.Ao){const A=this.state.filtersApplied,L=(0,a.Is)().getUrlState(C);this.addTrailStep(C,"filters",b(L,A)),this.setState({filtersApplied:A})}}),C.subscribeToEvent(a.bZ,S=>{if(S.payload.changedObject instanceof a.JZ){const{prevState:A,newState:L}=S.payload;if((0,m.iG)(A)&&(0,m.iG)(L)){if(A.from===L.from&&A.to===L.to)return;this.addTrailStep(C,"time",P({from:L.from,to:L.to,timeZone:L.timeZone}))}}})}addTrailStep(C,S,A=""){if(this.stepTransitionInProgress)return;const L=this.state.steps.length,N=S==="start"?-1:this.state.currentStep;this.setState({currentStep:L,steps:[...this.state.steps,{type:S,detail:A,description:E[S],trailState:a.Go.cloneSceneObjectState(C.state,{history:this}),parentIndex:N}]})}addTrailStepFromStorage(C,S){if(this.stepTransitionInProgress)return;const A=S.type,L=this.state.steps.length,N=A==="start"?-1:this.state.currentStep,F=this.state.filtersApplied;let w="";switch(S.type){case"metric":w=S.urlValues.metric?.toString()??"";break;case"filters":w=b(S.urlValues,F);break;case"time":w=P(S.urlValues);break}this.setState({filtersApplied:F,currentStep:L,steps:[...this.state.steps,{type:A,detail:w,description:E[A],trailState:a.Go.cloneSceneObjectState(C.state,{history:this}),parentIndex:N}]})}goBackToStep(C){if(C===this.state.currentStep)return;const S=this.state.steps[C],A=S.type==="metric"&&S.trailState.metric===void 0?"metric-clear":S.type;(0,d.z)("history_step_clicked",{type:A,step:C,numberOfSteps:this.state.steps.length}),this.stepTransitionInProgress=!0,this.setState({currentStep:C}),(0,m.kj)(this).restoreFromHistoryStep(S.trailState),this.stepTransitionInProgress=!1}renderStepTooltip(C){return(0,t.jsxs)(c.B,{direction:"column",children:[(0,t.jsx)("div",{children:C.description}),C.detail!==""&&(0,t.jsx)("div",{children:C.detail})]})}static{this.Component=({model:C})=>{const{steps:S,currentStep:A}=C.useState(),L=(0,o.of)(M),{ancestry:N,alternatePredecessorStyle:F}=(0,i.useMemo)(()=>{const w=new Set;let B=A;for(;B>=0;){const K=S[B];if(!K)break;w.add(B),B=K.parentIndex}const U=new Map;return w.forEach(K=>{const V=S[K].parentIndex;V+1!==K&&U.set(K,I(K,V))}),{ancestry:w,alternatePredecessorStyle:U}},[A,S]);return(0,t.jsxs)("div",{className:L.container,children:[(0,t.jsx)("div",{className:L.heading,children:"History"}),S.map((w,B)=>{let U=w.type;return U==="metric"&&w.trailState.metric===void 0&&(U="start"),(0,t.jsx)(h.m,{content:()=>C.renderStepTooltip(w),children:(0,t.jsx)("button",{className:(0,n.cx)(L.step,L.stepTypes[U],A===B?L.stepSelected:"",F.get(B)??"",B!==w.parentIndex+1?L.stepOmitsDirectLeftLink:"",B===0?L.stepOmitsDirectLeftLink:"",N.has(B)?"":L.stepIsNotAncestorOfCurrent),onClick:()=>C.goBackToStep(B)})},B)})]})}}}function P(T){if(!(0,m.iG)(T))return"";const C=(0,g.convertRawToRange)({from:T.from,to:T.to}),S=y(T.timeZone)?T.timeZone:s.g$.localBrowserTime,A=(0,s.QZ)(S,Date.now()),L=C.from.subtract(A?.offsetInMins??0,"minute").format(r.G$),N=C.to.subtract(A?.offsetInMins??0,"minute").format(r.G$);return`${L} - ${N}`}function b(T,C){let S="";const A=T["var-filters"];return l(A)&&(S=A.filter(L=>L!==""&&!C.includes(L)?(C.push(L),!0):!1)[0]??""),S.replace(D,u)}function M(T){const C=T.visualization;return{container:(0,n.css)({display:"flex",gap:10,alignItems:"center"}),heading:(0,n.css)({}),step:(0,n.css)({flexGrow:0,cursor:"pointer",border:"none",boxShadow:"none",padding:0,margin:0,width:8,height:8,opacity:.7,borderRadius:T.shape.radius.circle,background:T.colors.primary.main,position:"relative","&:hover":{opacity:1},"&:hover:before":{opacity:.7},"&:before":{content:'""',position:"absolute",width:10,height:2,left:-10,top:3,background:T.colors.primary.border,pointerEvents:"none"}}),stepSelected:(0,n.css)({"&:after":{content:'""',borderStyle:"solid",borderWidth:2,borderRadius:"50%",position:"absolute",width:16,height:16,left:-4,top:-4,boxShadow:`0px 0px 0px 2px inset ${T.colors.background.canvas}`}}),stepOmitsDirectLeftLink:(0,n.css)({"&:before":{background:"none"}}),stepIsNotAncestorOfCurrent:(0,n.css)({opacity:.2,"&:hover:before":{opacity:.2}}),stepTypes:{start:O(C.getColorByName("green")),filters:O(C.getColorByName("purple")),metric:O(C.getColorByName("orange")),metric_page:O(C.getColorByName("orange")),time:O(T.colors.primary.main)}}}function O(T){return(0,n.css)({background:T,"&:before":{background:T,borderColor:T},"&:after":{borderColor:T}})}function I(T,C){const L=(T-C)*18;return(0,n.css)({"&:before":{content:'""',width:L+2,height:10,borderStyle:"solid",borderWidth:2,borderBottom:"none",borderTopLeftRadius:8,borderTopRightRadius:8,top:-10,left:3-L,background:"none"}})}},94383:(k,R,e)=>{"use strict";e.d(R,{k:()=>Ee,R:()=>Ve});var t=e(74848),n=e(32196),i=e(32264),s=e(80943),r=e(40845),g=e(90613),a=e(67061),c=e(27746),o=e(14578),h=e(55852),f=e(63021),d=e(40675),p=e(56034),m=e(87490),v=e(2543),l=e(11261),y=e(88575),u=e(13344),D=e(29352),E=e(77366),x=e(96540),P=e(29413),b=e(94354),M=e(90182);function O({options:Se,value:Ie,onChange:Oe}){const Re=(0,r.of)(I),he=(0,r.$j)(),[Ce,We]=(0,x.useState)(0),[et,rt]=(0,x.useState)(0),nt=et>Ce,gt=(0,x.useRef)(null);return(0,E.w)({ref:gt,onResize:()=>{const xt=gt.current;xt&&rt(xt.clientWidth)}}),(0,x.useEffect)(()=>{const{fontSize:xt}=he.typography,St=Se.map(Vt=>Vt.label||Vt.value||"").join(" "),zt=(0,P.kD)(St,xt).width;We(zt+32*Se.length)},[Se,he]),(0,t.jsx)("div",{ref:gt,children:nt?(0,t.jsx)(b.z,{options:Se,value:Ie,onChange:Oe}):(0,t.jsx)(M.l6,{options:Se,value:Ie,onChange:xt=>Oe(xt.value),className:Re.select})})}function I(Se){return{select:(0,n.css)({maxWidth:Se.spacing(16)})}}var T=e(69096),C=e(40588),S=e(4200),A=e(51080);class L extends s.Bs{constructor(){super(...arguments),this.onClick=()=>{if(!(s.jh.lookupVariable("filters",this)instanceof s.H9))return;const Oe=this.state.frame.fields[1]?.labels??{};if(Object.keys(Oe).length!==1)return;const Re=Object.keys(Oe)[0];(0,C.z)("label_filter_changed",{label:Re,action:"added",cause:"breakdown"});const he=(0,A.kj)(this),Ce={key:Re,operator:"=",value:Oe[Re]};he.addFilterWithoutReportingInteraction(Ce)}}static{this.Component=({model:Ie})=>{const Re=Ie.useState().frame.fields[1]?.labels||{};return Object.keys(Re).length!==0?(0,t.jsx)(h.$n,{variant:"secondary",size:"sm",fill:"solid",onClick:Ie.onClick,children:"Add to filters"}):null}}}var N=e(39070);function F(Se,Ie){const Oe=s.jh.lookupVariable(S.Ao,Se),Re=[];if(!(Oe instanceof s.H9))return[];const he=Oe.state.filters;for(const Ce of Ie.getOptionsForSelect()){const We=he.find(et=>et.key===Ce.value);Ce.label!=="le"&&(We||Re.push({label:Ce.label,value:String(Ce.value)}))}return Re}function w(Se,Ie){const Oe=sceneGraph.findObject(Se,Re=>Re instanceof Ie);return Oe instanceof Ie?Oe:null}function B(Se,Ie){function Oe(he){return he instanceof Ie}return s.jh.findAllObjects(Se,Oe).filter(Oe)}class U extends s.Bs{constructor(Ie){super(Ie),this.addActivationHandler(()=>{const Oe=s.jh.getData(this);this._subs.add(Oe.subscribeToState((Re,he)=>{if(Re.data===void 0)return;const Ce=Re.data;Re.data!==void 0&&Re.data?.state!==he.data?.state&&B(this,s.Zv).forEach(We=>{We.setState({data:{...We.state.data,state:Ce.state}})}),Ce.state===N.Gu.Done&&this.performRepeat(Ce)})),Oe.state.data&&this.performRepeat(Oe.state.data)})}performRepeat(Ie){const Oe=[];for(let Re=0;Re<Ie.series.length;Re++){const he=Ie.series[Re];if(he.length<=1)continue;const Ce=this.state.getLayoutChild(Ie,he,Re);Oe.push(Ce)}this.state.body.setState({children:Oe}),this.setState({body:this.state.body})}static{this.Component=({model:Ie})=>{const{body:Oe}=Ie.useState(),{children:Re}=Oe.useState(),We=s.jh.getData(Ie).useState()?.data,et=We?.state==="Loading"&&Re.length===0,rt=We?.state===N.Gu.Error?"Failed to load data.":void 0,nt=!et&&Re.length===0&&!rt?"There is no data available. Try adjusting your filters, time range, or selecting a different label.":void 0;return(0,t.jsx)(T.O,{blockingMessage:nt,error:rt,isLoading:et,children:(0,t.jsx)(Oe.Component,{model:Oe})})}}}class K extends s.Bs{constructor(){super(...arguments),this.onLayoutChange=Ie=>{(0,C.z)("breakdown_layout_changed",{layout:Ie}),localStorage.setItem(S.Pp,Ie),this.getMetricScene().setState({layout:Ie})}}getMetricScene(){return s.jh.getAncestor(this,Ve)}Selector({model:Ie}){const{options:Oe}=Ie.useState(),Re=Ie.useActiveLayout();return(0,t.jsx)(y.D,{label:"View",children:(0,t.jsx)(b.z,{options:Oe,value:Re,onChange:Ie.onLayoutChange})})}useActiveLayout(){const{options:Ie}=this.useState(),{layout:Oe}=this.getMetricScene().useState();return Ie.map(he=>he.value).includes(Oe)?Oe:Ie[0].value}static{this.Component=({model:Ie})=>{const{layouts:Oe,options:Re}=Ie.useState(),he=Ie.useActiveLayout(),Ce=Re.findIndex(et=>et.value===he);if(Ce===-1)return null;const We=Oe[Ce];return(0,t.jsx)(We.Component,{model:We})}}}var V=e(52622);const H=s.zd.timeseries().setOption("tooltip",{mode:V.$N.Multi,sort:V.xB.Descending}).setOption("legend",{showLegend:!1}).build();var Y=e(65463);class X extends Y.x{static{this.type="selected-metric-query-results-event"}}const J=Se=>{const Ie=s.jh.getAncestor(Se,ae);B(Se,s.Eb).forEach(he=>{he.isActive?Oe(he.state.$data):he.addActivationHandler(()=>{Oe(he.state.$data)})}),B(Se,s.Eb).forEach(he=>Oe(he.state.$data));function Oe(he){he&&(he.isActive||he.addActivationHandler(()=>{Oe(he)}),he.state.data&&Ie.reportBreakdownPanelData(he.state.data),he.subscribeToState(({data:Ce},We)=>{Ie.reportBreakdownPanelData(Ce)}))}const Re=Ie.subscribeToEvent(X,he=>{if(!Se.isActive){Re.unsubscribe();return}const Ce=s.No.timeseries().setCustomFieldConfig("axisSoftMin",he.payload.min).setCustomFieldConfig("axisSoftMax",he.payload.max).build();B(Se,s.Eb).forEach(We=>{function et(){We.onFieldConfigChange(Ce)}We.isActive?et():We.addActivationHandler(et)})})},q=60;class ae extends s.Bs{constructor(Ie){super({labels:Ie.labels??[],...Ie}),this._variableDependency=new s.Sh(this,{variableNames:[S.Ao],onReferencedVariableValueChanged:this.onReferencedVariableValueChanged.bind(this)}),this._triggerAxisChangedEvent=(0,v.throttle)(()=>{const{breakdownPanelMinValue:Oe,breakdownPanelMaxValue:Re}=this;Oe!==void 0&&Re!==void 0&&this.publishEvent(new X({min:Oe,max:Re}))},1e3),this.onChange=Oe=>{if(!Oe)return;(0,C.z)("label_selected",{label:Oe,cause:"selector"}),this.getVariable().changeValueTo(Oe)},this.addActivationHandler(this._onActivate.bind(this))}_onActivate(){const Ie=this.getVariable();Ie.subscribeToState((Ce,We)=>{(Ce.options!==We.options||Ce.value!==We.value||Ce.loading!==We.loading)&&this.updateBody(Ie)});const Oe=s.jh.getAncestor(this,Ve),Re=Oe.state.metric;this._query=(0,D.v)(Re).breakdown,(0,A.kj)(this).state.$timeRange?.subscribeToState(()=>{this.clearBreakdownPanelAxisValues()}),Oe.subscribeToState(({layout:Ce},We)=>{Ce!==We.layout&&this.clearBreakdownPanelAxisValues()}),this.updateBody(Ie)}reportBreakdownPanelData(Ie){if(!Ie)return;let Oe=this.breakdownPanelMinValue,Re=this.breakdownPanelMaxValue;Ie.series.forEach(he=>{he.fields.forEach(Ce=>{if(Ce.type!==l.PU.number)return;const We=Ce.values.filter(v.isNumber),et=(0,v.max)(We),rt=(0,v.min)(We);Re=(0,v.max)([Re,et].filter(v.isNumber)),Oe=(0,v.min)([Oe,rt].filter(v.isNumber))})}),!(Re===void 0||Oe===void 0||!Number.isFinite(Re+Oe))&&(this.breakdownPanelMaxValue===Re&&this.breakdownPanelMinValue===Oe||(this.breakdownPanelMaxValue=Re,this.breakdownPanelMinValue=Oe,this._triggerAxisChangedEvent()))}clearBreakdownPanelAxisValues(){this.breakdownPanelMaxValue=void 0,this.breakdownPanelMinValue=void 0}getVariable(){const Ie=s.jh.lookupVariable(S.yr,this);if(!(Ie instanceof s.fS))throw new Error("Group by variable not found");return Ie}onReferencedVariableValueChanged(){const Ie=this.getVariable();Ie.changeValueTo(u.To),this.updateBody(Ie)}updateBody(Ie){const Oe=F(this,Ie),Re={loading:Ie.state.loading,value:String(Ie.state.value),labels:Oe,error:Ie.state.error,blockingMessage:void 0};!Ie.state.loading&&Ie.state.options.length?Re.body=Ie.hasAllValue()?te(Oe,this._query):le(this._query):Ie.state.loading||(Re.body=void 0,Re.blockingMessage="Unable to retrieve label options for currently selected metric."),this.clearBreakdownPanelAxisValues(),this.setState(Re)}static{this.Component=({model:Ie})=>{const{labels:Oe,body:Re,loading:he,value:Ce,blockingMessage:We}=Ie.useState(),et=(0,r.of)(j);return(0,t.jsx)("div",{className:et.container,children:(0,t.jsxs)(T.O,{isLoading:he,blockingMessage:We,children:[(0,t.jsxs)("div",{className:et.controls,children:[!he&&Oe.length&&(0,t.jsx)("div",{className:et.controlsLeft,children:(0,t.jsx)(y.D,{label:"By label",children:(0,t.jsx)(O,{options:Oe,value:Ce,onChange:Ie.onChange})})}),Re instanceof K&&(0,t.jsx)("div",{className:et.controlsRight,children:(0,t.jsx)(Re.Selector,{model:Re})})]}),(0,t.jsx)("div",{className:et.content,children:Re&&(0,t.jsx)(Re.Component,{model:Re})})]})})}}}function j(Se){return{container:(0,n.css)({flexGrow:1,display:"flex",minHeight:"100%",flexDirection:"column"}),content:(0,n.css)({flexGrow:1,display:"flex",paddingTop:Se.spacing(0)}),controls:(0,n.css)({flexGrow:0,display:"flex",alignItems:"top",gap:Se.spacing(2)}),controlsRight:(0,n.css)({flexGrow:0,display:"flex",justifyContent:"flex-end"}),controlsLeft:(0,n.css)({display:"flex",justifyContent:"flex-left",justifyItems:"left",width:"100%",flexDirection:"column"})}}function te(Se,Ie){const Oe=[];for(const Re of Se){if(Re.value===u.To)continue;if(Oe.length===q)break;const he=Ie.queries[0].expr.replaceAll(S.aZ,String(Re.value)),Ce=Ie.unit,We=s.d0.timeseries().setTitle(Re.label).setData(new s.dt({maxDataPoints:250,datasource:S.GH,queries:[{refId:"A",expr:he,legendFormat:`{{${Re.label}}}`}]})).setHeaderActions(new se({labelName:String(Re.value)})).setUnit(Ce).setBehaviors([Z]).build();We.addActivationHandler(()=>{We.onOptionsChange(H)}),Oe.push(new s.xK({$behaviors:[J],body:We}))}return new K({options:[{value:"grid",label:"Grid"},{value:"rows",label:"Rows"}],layouts:[new s.gF({templateColumns:ne,autoRows:"200px",children:Oe,isLazy:!0}),new s.gF({templateColumns:"1fr",autoRows:"200px",children:Oe.map(Re=>Re.clone()),isLazy:!0})]})}const ne="repeat(auto-fit, minmax(400px, 1fr))";function le(Se){const Ie=Se.unit;function Oe(Re,he,Ce){const We=Se.vizBuilder().setTitle(z(he)).setData(new s.Zv({data:{...Re,series:[he]}})).setColor({mode:"fixed",fixedColor:(0,A.Vy)(Ce)}).setHeaderActions(new L({frame:he})).setUnit(Ie).build(),et=he.length<=1,rt=new s.xK({$behaviors:[J],body:We,isHidden:et});return We.addActivationHandler(()=>{We.onOptionsChange(H)}),rt}return new K({$data:new s.dt({datasource:S.GH,maxDataPoints:300,queries:Se.queries}),options:[{value:"single",label:"Single"},{value:"grid",label:"Grid"},{value:"rows",label:"Rows"}],layouts:[new s.G1({direction:"column",children:[new s.vA({minHeight:300,body:s.d0.timeseries().setTitle("$metric").build()})]}),new U({body:new s.gF({templateColumns:ne,autoRows:"200px",children:[]}),getLayoutChild:Oe}),new U({body:new s.gF({templateColumns:"1fr",autoRows:"200px",children:[]}),getLayoutChild:Oe})]})}function z(Se){const Ie=Se.fields[1]?.labels||{},Oe=Object.keys(Ie);return Oe.length===0?"<unspecified>":Ie[Oe[0]]}function ee(){return new ae({})}class se extends s.Bs{constructor(){super(...arguments),this.onClick=()=>{const Ie=this.state.labelName;(0,C.z)("label_selected",{label:Ie,cause:"breakdown_panel"}),ie(this).onChange(Ie)}}static{this.Component=({model:Ie})=>(0,t.jsx)(h.$n,{variant:"secondary",size:"sm",fill:"solid",onClick:Ie.onClick,children:"Select"})}}function ie(Se){if(Se instanceof ae)return Se;if(Se.parent)return ie(Se.parent);throw new Error("Unable to find breakdown scene")}function Z(Se){Se.state.$data?.subscribeToState((Ie,Oe)=>{const Re=Ie.data?.request?.targets[0];if(oe(Re)){const{legendFormat:he}=Re,Ce=he.slice(2,-2);Ie.data?.series.forEach(We=>{if(!We.fields[1].labels?.[Ce]){const et=We.fields[1].labels;et&&(et[Ce]=`<unspecified ${Ce}>`)}})}})}function oe(Se){return Se!==void 0&&"legendFormat"in Se&&typeof Se.legendFormat=="string"}var ce=e(94753),ye=e(72109),re=e(8484),ue=e(8620);class De extends s.Bs{constructor(Ie){super({...Ie}),this._variableDependency=new s.Sh(this,{variableNames:[S.gR],onReferencedVariableValueChanged:this.onReferencedVariableValueChanged.bind(this)}),this.addActivationHandler(this._onActivate.bind(this))}getVariable(){const Ie=s.jh.lookupVariable(S.yr,this);if(!(Ie instanceof s.fS))throw new Error("Group by variable not found");return Ie}_onActivate(){this.updateMetadata()}onReferencedVariableValueChanged(){this.updateMetadata()}async updateMetadata(){this.setState({metadataLoading:!0,metadata:void 0});const Oe=(0,A.aM)(this).state.metric,he=await(0,A.kj)(this).getMetricMetadata(Oe);this.setState({metadata:he,metadataLoading:!1})}static{this.Component=({model:Ie})=>{const{metadata:Oe,metadataLoading:Re}=Ie.useState(),he=Ie.getVariable(),{loading:Ce,options:We}=he.useState(),rt=(0,A.aM)(Ie).state.metric;let nt=(0,ue.vL)(rt)??"Unknown";return(0,t.jsx)(T.O,{isLoading:Ce||Re,children:(0,t.jsx)(a.B,{gap:6,children:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(a.B,{direction:"column",gap:.5,children:[(0,t.jsx)(ce.E,{weight:"medium",children:(0,t.jsx)(re.x6,{i18nKey:"trails.metric-overview.description-label",children:"Description"})}),(0,t.jsx)("div",{style:{maxWidth:360},children:Oe?.help?(0,t.jsx)("div",{children:Oe?.help}):(0,t.jsx)("i",{children:(0,t.jsx)(re.x6,{i18nKey:"trails.metric-overview.no-description",children:"No description available"})})})]}),(0,t.jsxs)(a.B,{direction:"column",gap:.5,children:[(0,t.jsx)(ce.E,{weight:"medium",children:(0,t.jsx)(re.x6,{i18nKey:"trails.metric-overview.type-label",children:"Type"})}),Oe?.type?(0,t.jsx)("div",{children:Oe?.type}):(0,t.jsx)("i",{children:(0,t.jsx)(re.x6,{i18nKey:"trails.metric-overview.unknown-type",children:"Unknown"})})]}),(0,t.jsxs)(a.B,{direction:"column",gap:.5,children:[(0,t.jsx)(ce.E,{weight:"medium",children:(0,t.jsx)(re.x6,{i18nKey:"trails.metric-overview.unit-label",children:"Unit"})}),Oe?.unit?(0,t.jsx)("div",{children:Oe?.unit}):(0,t.jsx)("i",{children:nt})]}),(0,t.jsxs)(a.B,{direction:"column",gap:.5,children:[(0,t.jsx)(ce.E,{weight:"medium",children:(0,t.jsx)(re.x6,{i18nKey:"trails.metric-overview.labels-label",children:"Labels"})}),We.length===0&&"Unable to fetch labels.",We.map(gt=>(0,t.jsx)(ye.Y,{href:`#View breakdown for ${gt.label}`,title:`View breakdown for ${gt.label}`,onClick:xt=>{xt.preventDefault(),xt.stopPropagation(),s.jh.getAncestor(Ie,Ve).setActionView("breakdown");const St=s.jh.lookupVariable(S.yr,Ie);return St instanceof s.fS&&gt.label!=null&&((0,C.z)("label_selected",{label:gt.label,cause:"overview_link"}),St.setState({value:gt.value})),!1},children:gt.label},gt.label))]})]})})})}}}function ge(){return new De({})}var Te=e(21028);function Le(){return new Te.t({})}const Ye=["single","grid","rows"];function je(Se){return!!Se&&Se in Ye}var Ze=e(94624);class Ne extends s.Bs{constructor(Ie){super(Ie),this.onChangeQuery=Oe=>{const Re=(0,A.aM)(this),he=Re.state.autoQuery.variants.find(Ce=>Ce.variant===Oe);this.setState({panel:this.getVizPanelFor(he)}),Re.setState({queryDef:he})},this.addActivationHandler(this.onActivate.bind(this))}onActivate(){if(!this.state.panel){const{autoQuery:Ie}=(0,A.aM)(this).state;this.setState({panel:this.getVizPanelFor(Ie.main)})}}getQuerySelector(Ie){const{autoQuery:Oe}=(0,A.aM)(this).state;if(Oe.variants.length===0)return;const Re=Oe.variants.map(he=>({label:he.variant,value:he.variant}));return(0,t.jsx)(b.z,{size:"sm",options:Re,value:Ie.variant,onChange:this.onChangeQuery})}getVizPanelFor(Ie){return Ie.vizBuilder().setData(new s.dt({datasource:S.GH,maxDataPoints:500,queries:Ie.queries})).setHeaderActions(this.getQuerySelector(Ie)).build()}static{this.Component=({model:Ie})=>{const{panel:Oe}=Ie.useState();if(Oe)return(0,t.jsx)(Oe.Component,{model:Oe})}}}const Pe=280,Ue="40%";class $e extends s.Bs{constructor(Ie){super({topView:Ie.topView??qe(),...Ie})}static{this.Component=({model:Ie})=>{const{topView:Oe,selectedTab:Re}=Ie.useState(),{stickyMainGraph:he}=(0,A.KE)(Ie).useState(),Ce=(0,r.of)(ze);return(0,t.jsxs)("div",{className:Ce.container,children:[(0,t.jsx)("div",{className:he?Ce.sticky:Ce.nonSticky,children:(0,t.jsx)(Oe.Component,{model:Oe})}),Re&&(0,t.jsx)(Re.Component,{model:Re})]})}}}function ze(Se){return{container:(0,n.css)({display:"flex",flexDirection:"column",position:"relative"}),sticky:(0,n.css)({display:"flex",flexDirection:"row",background:Se.isLight?Se.colors.background.primary:Se.colors.background.canvas,position:"sticky",top:"70px",zIndex:10}),nonSticky:(0,n.css)({display:"flex",flexDirection:"row"})}}function qe(){return new s.G1({direction:"column",$behaviors:[new s.Gg.K2({key:"metricCrosshairSync",sync:Ze.y.Crosshair})],children:[new s.vA({minHeight:Pe,maxHeight:Ue,body:new Ne({})}),new s.vA({ySizing:"content",body:new Ee({})})]})}const dt=({trail:Se})=>{const[Ie,Oe]=(0,x.useState)("Copy url"),Re=()=>{if(navigator.clipboard){(0,C.z)("selected_metric_action_clicked",{action:"share_url"});const Ce=(i.$.appUrl.endsWith("/")?i.$.appUrl.slice(0,-1):i.$.appUrl)+(0,A.xi)(Se);navigator.clipboard.writeText(Ce),Oe("Copied!"),setTimeout(()=>{Oe("Copy url")},2e3)}};return(0,t.jsx)(c.I,{variant:"canvas",icon:"share-alt",tooltip:Ie,onClick:Re})};var vt=e(13054),yt=e(74764);function st(Se){const Ie=()=>(0,yt._r)().getBookmarkIndex(Se),Oe=Ie(),[Re,he]=(0,x.useState)(Oe);(0,x.useEffect)(()=>{const rt=Se.subscribeToEvent(s.bZ,({payload:{prevState:nt,newState:gt}})=>{(0,vt.hi)(nt)&&(0,vt.hi)(gt)&&gt.steps.length>nt.steps.length&&he((0,yt._r)().getBookmarkIndex(Se))});return()=>rt.unsubscribe()},[Se]),Oe!==Re&&he(Oe);const Ce=Re!=null;return[Ce,()=>{if((0,C.z)("bookmark_changed",{action:Ce?"toggled_off":"toggled_on"}),Ce){let rt=Ie();for(;rt!=null;)(0,yt._r)().removeBookmark(rt),rt=Ie()}else(0,yt._r)().addBookmark(Se);he(Ie())}]}class Ve extends s.Bs{constructor(Ie){const Oe=Ie.autoQuery??(0,D.v)(Ie.metric),Re=localStorage.getItem(S.Pp);super({$variables:Ie.$variables??ve(Ie.metric),body:Ie.body??new $e({}),autoQuery:Oe,queryDef:Ie.queryDef??Oe.main,layout:je(Re)?Re:"grid",...Ie}),this._urlSync=new s.So(this,{keys:["actionView","layout"]}),this.addActivationHandler(this._onActivate.bind(this))}_onActivate(){this.state.actionView===void 0&&this.setActionView("overview")}getUrlState(){return{actionView:this.state.actionView,layout:this.state.layout}}updateFromUrl(Ie){if(typeof Ie.actionView=="string"){if(this.state.actionView!==Ie.actionView){const Oe=pe.find(Re=>Re.value===Ie.actionView);Oe&&this.setActionView(Oe.value)}}else Ie.actionView===null&&this.setActionView(void 0);if(typeof Ie.layout=="string"){const Oe=Ie.layout;this.state.layout!==Oe&&this.setState({layout:Oe})}}setActionView(Ie){const{body:Oe}=this.state,Re=pe.find(he=>he.value===Ie);Re&&Re.value!==this.state.actionView?(Oe.state.topView.state.children[0].setState({maxHeight:Pe}),Oe.setState({selectedTab:Re.getScene()}),this.setState({actionView:Re.value})):(Oe.state.topView.state.children[0].setState({maxHeight:Ue}),Oe.setState({selectedTab:void 0}),this.setState({actionView:void 0}))}static{this.Component=({model:Ie})=>{const{body:Oe}=Ie.useState();return(0,t.jsx)(Oe.Component,{model:Oe})}}}const pe=[{displayName:"Overview",value:"overview",getScene:ge},{displayName:"Breakdown",value:"breakdown",getScene:ee},{displayName:"Related metrics",value:"related",getScene:Le,description:"Relevant metrics based on current label filters"}];class Ee extends s.Bs{constructor(){super(...arguments),this.getLinkToExplore=async()=>{const Ie=s.jh.getAncestor(this,Ve),Oe=(0,A.kj)(this),Re=(0,A.U4)(Oe),he=Ie.state.queryDef?.queries||[],Ce=s.jh.getTimeRange(this);return(0,m.Xe)({queries:he,dsRef:{uid:Re},timeRange:Ce.state.value,scopedVars:{__sceneObject:{value:Ie}}})},this.openExploreLink=async()=>{(0,C.z)("selected_metric_action_clicked",{action:"open_in_explore"}),this.getLinkToExplore().then(Ie=>{const Oe=`${i.$.appSubUrl}${Ie}`;window.open(Oe,"_blank")})}}static{this.Component=({model:Ie})=>{const Oe=s.jh.getAncestor(Ie,Ve),Re=(0,r.of)(me),he=(0,A.kj)(Ie),[Ce,We]=st(he),{actionView:et}=Oe.useState();return(0,t.jsxs)(g.a,{paddingY:1,children:[(0,t.jsx)("div",{className:Re.actions,children:(0,t.jsxs)(a.B,{gap:1,children:[(0,t.jsx)(c.I,{variant:"canvas",tooltip:"Remove existing metric and choose a new metric",onClick:()=>{(0,C.z)("selected_metric_action_clicked",{action:"unselect"}),he.publishEvent(new S.OO(void 0))},children:"Select new metric"}),(0,t.jsx)(c.I,{variant:"canvas",icon:"compass",tooltip:"Open in explore",onClick:Ie.openExploreLink}),(0,t.jsx)(dt,{trail:he}),(0,t.jsx)(c.I,{variant:"canvas",icon:Ce?(0,t.jsx)(o.I,{name:"favorite",type:"mono",size:"lg"}):(0,t.jsx)(o.I,{name:"star",type:"default",size:"lg"}),tooltip:"Bookmark",onClick:We}),he.state.embedded&&(0,t.jsx)(h.z9,{href:(0,A.xi)(he),variant:"secondary",onClick:()=>(0,C.z)("selected_metric_action_clicked",{action:"open_from_embedded"}),children:"Open"})]})}),(0,t.jsx)(f.U,{children:pe.map((rt,nt)=>{const gt=(0,t.jsx)(d.o,{label:rt.displayName,active:et===rt.value,onChangeTab:()=>{(0,C.z)("metric_action_view_changed",{view:rt.value}),Oe.setActionView(rt.value)}},nt);return rt.description?(0,t.jsx)(p.m,{content:rt.description,placement:"bottom-start",theme:"info",children:gt},nt):gt})})]})}}}function me(Se){return{actions:(0,n.css)({[Se.breakpoints.up(Se.breakpoints.values.md)]:{position:"absolute",right:0,top:16,zIndex:2}})}}function ve(Se){return new s.Pj({variables:[...(0,S.ym)(Se),new s.fS({name:S.yr,label:"Group by",datasource:S.GH,includeAll:!0,defaultToAll:!0,query:{query:`label_names(${S.Rp})`,refId:"A"},value:"",text:""})]})}},21028:(k,R,e)=>{"use strict";e.d(R,{t:()=>ee});var t=e(74848),n=e(32196),i=e(2543),s=e(96540),r=e(17172),g=e(80943),a=e(40845),c=e(56034),o=e(14578),h=e(88575),f=e(10354),d=e(29158),p=e(90182),m=e(15292),v=e(42418),l=e(8484),y=e(94383),u=e(69096);class D{constructor(){this.config={minGroupSize:3,idealMaxGroupSize:30,maxDepth:100}}parse(ce){if(this.config.maxDepth<=0)throw new Error("Max depth must be greater than 0");if(this.config.minGroupSize<1)throw new Error("Min group size must be greater than 0");if(this.config.idealMaxGroupSize<this.config.minGroupSize)throw new Error("Max group size must be greater than min group size");if(this.config.miscGroupKey&&this.config.miscGroupKey==="")throw new Error("miscGroupKey cannot be empty");return{root:this.parseStrings(ce,0)}}parseStrings(ce,ye){const re={groups:new Map,values:[],descendants:0};for(const De of ce){if(De.trim()==="")continue;const ge=E(De,ye);let Te=re.groups.get(ge);Te||(Te={groups:new Map,values:[],descendants:0},re.groups.set(ge,Te)),Te.values.push(De),Te.descendants++}const ue=[];for(let[De,ge]of re.groups.entries())ge.values.length<this.config.minGroupSize?(this.config.miscGroupKey?ue.push(...ge.values):re.values.push(...ge.values),re.descendants+=ge.values.length,re.groups.delete(De)):(ge.values.length>this.config.idealMaxGroupSize&&ye<this.config.maxDepth-1&&(ge=this.parseStrings(ge.values,ye+1),re.groups.set(De,ge)),re.descendants+=ge.descendants);if(this.config.miscGroupKey&&ue.length>0){const De={groups:new Map,values:ue,descendants:ue.length};re.groups.set(this.config.miscGroupKey,De)}return re}}function E(oe,ce){let ye=0;for(let re=0;re<oe.length;re++){const ue=oe.charCodeAt(re);if(!(ue>=48&&ue<=57||ue>=65&&ue<=90||ue>=97&&ue<=122||ue>=192&&ue<=214||ue>=216&&ue<=246||ue>=248&&ue<=255||ue>=256&&ue<=383)&&(ye++,ye>ce))return oe.slice(0,re)}return oe}var x=e(88434),P=e(40588),b=e(4200),M=e(51080),O=e(55852);class I extends g.Bs{constructor(){super(...arguments),this.onClick=()=>{this.publishEvent(new b.OO(this.state.metric),!0)}}static{this.Component=({model:ce})=>{const{title:ye}=ce.useState();return(0,t.jsx)(O.$n,{variant:"secondary",size:"sm",fill:"solid",onClick:ce.onClick,children:ye})}}}var T=e(81996);const C="results truncated due to limit";async function S(oe,ce,ye,re){const ue=`/api/datasources/uid/${oe}/resources/api/v1/label/__name__/values`,De={start:(0,T.mv)(ce.from,!1),end:(0,T.mv)(ce.to,!0),...ye&&ye!=="{}"?{"match[]":ye}:{},...re?{limit:re}:{}},ge=await(0,r.AI)().get(ue,De,"explore-metrics-names");return re&&ge.warnings?.includes(C)?{...ge,limitReached:!0}:{...ge,limitReached:!1}}var A=e(29352),L=e(39070),N=e(11261);function F(oe){return ce=>{const ye=g.jh.getData(ce);ye&&ye.subscribeToState(re=>{if(re.data?.state===L.Gu.Loading||re.data?.state===L.Gu.Error)return;const ue=g.jh.getAncestor(ce,ee);if(!re.data?.series.length){ue.updateMetricPanel(oe,!0,!0);return}let De=!1;for(const ge of re.data.series){for(const Te of ge.fields)if(Te.type===N.PU.number&&(De=Te.values.some(Le=>Le!=null&&!isNaN(Le)&&Le!==0),De))break;if(De)break}ue.updateMetricPanel(oe,!0,!De)})}}function w(oe,ce,ye,re){const ue=(0,A.v)(oe),De=ue.preview.vizBuilder().setColor({mode:"fixed",fixedColor:(0,M.Vy)(ce)}).setDescription(re).setHeaderActions(new I({metric:oe,title:"Select"})).build(),ge=ue.preview.queries.map(Te=>B(Te,ye));return new g.xK({$variables:new g.Pj({variables:(0,b.ym)(oe)}),$behaviors:[F(oe)],$data:new g.dt({datasource:b.GH,maxDataPoints:200,queries:ge}),body:De})}function B(oe,ce){const ye=ce>0?'${filters},__ignore_usage__=""':'__ignore_usage__=""',re=oe.expr?.replace("${filters}",ye);return{...oe,expr:re}}var U=e(51088);function K(oe,ce){return oe.sort((ye,re)=>{const ue=H(ye,ce),De=H(re,ce);return ue.halfLeven+ue.wholeLeven-(De.halfLeven+De.wholeLeven)})}const V=new Map;function H(oe,ce){let ye=V.get(oe);ye||(ye=new Map,V.set(oe,ye));let re=ye.get(ce);if(!re){const ue=oe.split("_"),De=ue.slice(0,ue.length/2).join("_"),ge=(0,U.A)(De,ce)||0,Te=(0,U.A)(oe,ce)||0;re={halfLeven:ge,wholeLeven:Te},ye.set(ce,re)}return re}const Y=/[^a-z0-9_:]+/;function X(oe){return oe?.toLowerCase().split(Y).filter(ce=>ce.length>0)||[]}function J(oe){const ce=X(oe).map(re=>`(?=(.*${re.toLowerCase()}.*))`);if(ce.length===0)return null;const ye=ce.join("");return new RegExp(ye,"igy")}function q(oe){const ce=ae(X(oe)).filter(ue=>ue.length>0).map(ue=>`(.*${ue.toLowerCase()}.*)`),ye=ce.length;return ce.length===0?null:`(?i:${ce.join("|")}){${ye}}`}function ae(oe=[]){const ce=new Set(oe.map(ye=>ye.toLowerCase().trim()));return Array.from(ce)}const j="175px",te="64px",ne="all",le=2e4,z="View by the metric prefix. A metric prefix is a single word at the beginning of the metric name, relevant to the domain the metric belongs to.";class ee extends g.Bs{constructor(ce){super({showPreviews:!0,$variables:ce.$variables,metricPrefix:ce.metricPrefix??ne,body:ce.body??new g.gF({children:[],templateColumns:"repeat(auto-fill, minmax(450px, 1fr))",autoRows:j,isLazy:!0}),...ce}),this.previewCache={},this.ignoreNextUpdate=!1,this._debounceRefreshMetricNames=(0,i.debounce)(()=>this._refreshMetricNames(),1e3),this._urlSync=new g.So(this,{keys:["metricPrefix"]}),this._variableDependency=new g.Sh(this,{variableNames:[b.EY,b.Ao],onReferencedVariableValueChanged:ye=>{this._debounceRefreshMetricNames()}}),this.updateMetricPanel=(ye,re,ue)=>{const De=this.previewCache[ye];De&&(De.isEmpty=ue,De.loaded=re,this.previewCache[ye]=De,this.state.metricPrefix==="All"&&this.buildLayout())},this.onSearchQueryChange=ye=>{const re=ye.currentTarget.value;(0,M.kj)(this).setState({metricSearch:re})},this.onPrefixFilterChange=ye=>{this.setState({metricPrefix:ye.value}),this._refreshMetricNames()},this.reportPrefixFilterInteraction=ye=>{const re=(0,M.kj)(this),{steps:ue,currentStep:De}=re.state.history.state,Te=ue[De]?.trailState.metric!==void 0;(0,P.z)("prefix_filter_clicked",{from:Te?"related_metrics":"metric_list",action:ye?"open":"close"})},this.onTogglePreviews=()=>{this.setState({showPreviews:!this.state.showPreviews}),this.buildLayout()},this.addActivationHandler(this._onActivate.bind(this))}getUrlState(){return{metricPrefix:this.state.metricPrefix}}updateFromUrl(ce){typeof ce.metricPrefix=="string"&&this.state.metricPrefix!==ce.metricPrefix&&this.setState({metricPrefix:ce.metricPrefix})}_onActivate(){this.state.body.state.children.length===0?this.buildLayout():this.ignoreNextUpdate=!0;const ce=(0,M.kj)(this);this._subs.add(ce.subscribeToEvent(b.OO,ye=>{const{steps:re,currentStep:ue}=ce.state.history.state,De=re[ue].parentIndex,Te=re[De].trailState.metric!==void 0;if(ye.payload!==void 0){const Le=Z(ce),Ye=X(Le).length;(0,P.z)("metric_selected",{from:Te?"related_metrics":"metric_list",searchTermCount:Ye})}})),this._subs.add(ce.subscribeToEvent(g.bZ,ye=>{if(ye.payload.changedObject instanceof g.JZ){const{prevState:re,newState:ue}=ye.payload;if((0,M.iG)(re)&&(0,M.iG)(ue)&&re.from===ue.from&&re.to===ue.to)return}})),this._subs.add(ce.subscribeToState(({metricSearch:ye},re)=>{const ue=X(re.metricSearch),De=X(ye);(0,i.isEqual)(ue,De)||this._debounceRefreshMetricNames()})),this.subscribeToState((ye,re)=>{ye.metricNames!==re.metricNames&&this.onMetricNamesChanged()}),this._debounceRefreshMetricNames()}async _refreshMetricNames(){const ce=(0,M.kj)(this),ye=ce.state.$timeRange?.state;if(!ye)return;const re=[],ue=g.jh.lookupVariable(b.Ao,this);ue instanceof g.H9&&ue.getValue()?.valueOf()&&re.push(g.jh.interpolate(ce,"${filters}"));const ge=q(ce.state.metricSearch);ge&&re.push(`__name__=~"${ge}"`);const Te=`{${re.join(",")}}`,Le=g.jh.interpolate(ce,b.gR);this.setState({metricNamesLoading:!0,metricNamesError:void 0,metricNamesWarning:void 0});try{const Ye=await S(Le,ye,Te,le),je=J(Z(this));let Ze=je?Ye.data.filter(qe=>!je||je.test(qe)):Ye.data;const Ne=Ze,Pe=this.state.metricPrefix;if(Pe&&Pe!=="all"){const qe=new RegExp(`(^${Pe}.*)`,"igy");Ze=Ze.filter(dt=>!qe||qe.test(dt))}const Ue=Ye.limitReached?`This feature will only return up to ${le} metric names for performance reasons. This limit is being exceeded for the current data source. Add search terms or label filters to narrow down the number of metric names returned.`:void 0;let $e=this.state.body,ze=this.state.rootGroup;ze=await this.generateGroups(Ne),this.setState({metricNames:Ze,rootGroup:ze,body:$e,metricNamesLoading:!1,metricNamesWarning:Ue,metricNamesError:Ye.error})}catch(Ye){let je="Unknown error";(0,r.NF)(Ye)&&(Ye.cancelled?je="Request cancelled":Ye.statusText&&(je=Ye.statusText)),this.setState({metricNames:void 0,metricNamesLoading:!1,metricNamesError:je})}}async generateGroups(ce=[]){const ye=new D;ye.config={...ye.config,maxDepth:2,minGroupSize:2,miscGroupKey:"misc"};const{root:re}=ye.parse(ce);return re}onMetricNamesChanged(){const ce=this.state.metricNames||[],ye=new Set(ce);Object.values(this.previewCache).forEach(Te=>{ye.has(Te.name)||(Te.isEmpty=!0)});const re=(0,M.kj)(this),ue=re.state.metric!==void 0?K(ce,re.state.metric):ce,De={},ge=120;Object.keys(this.previewCache).forEach(Te=>{ye.has(Te)||delete this.previewCache[Te]});for(let Te=0;Te<ue.length;Te++){const Le=ue[Te];if(Object.keys(De).length>ge)break;const je=this.previewCache[Le]||{name:Le,index:Te,loaded:!1};De[Le]=je}try{const Te=g.jh.getAncestor(this,y.R).state.metric;delete De[Te]}catch{}this.previewCache=De,this.buildLayout()}sortedPreviewMetrics(){return Object.values(this.previewCache).sort((ce,ye)=>ce.isEmpty&&ye.isEmpty?ce.index-ye.index:ce.isEmpty?1:ye.isEmpty?-1:ce.index-ye.index)}async buildLayout(){if(this.ignoreNextUpdate){this.ignoreNextUpdate=!1;return}const ce=[],ye=(0,M.kj)(this),re=this.sortedPreviewMetrics(),De=(0,M.gA)(this)?.length||0;for(let Te=0;Te<re.length;Te++){const Le=re[Te],Ye=await ye.getMetricMetadata(Le.name),je=(0,x.R)(Ye);if(this.state.showPreviews){if(Le.itemRef&&Le.isPanel){ce.push(Le.itemRef.resolve());continue}const Ze=w(Le.name,Te,De,je);Le.itemRef=Ze.getRef(),Le.isPanel=!0,ce.push(Ze)}else{const Ze=new g.xK({$variables:new g.Pj({variables:(0,b.ym)(Le.name)}),body:se(Le.name,je)});Le.itemRef=Ze.getRef(),Le.isPanel=!1,ce.push(Ze)}}const ge=this.state.showPreviews?j:te;this.state.body.setState({children:ce,autoRows:ge})}static{this.Component=({model:ce})=>{const{showPreviews:ye,body:re,metricNames:ue,metricNamesError:De,metricNamesLoading:ge,metricNamesWarning:Te,rootGroup:Le,metricPrefix:Ye}=ce.useState(),{children:je}=re.useState(),Ze=(0,M.kj)(ce),Ne=(0,a.of)(ie),[Pe,Ue]=(0,s.useReducer)(()=>!0,!1),{metricSearch:$e}=Ze.useState(),ze=je.length===0&&$e,qe=!ge&&ue&&ue.length===0,dt=ge&&je.length===0,vt=dt?void 0:qe&&"There are no results found. Try a different time range or a different data source."||ze&&"There are no results found. Try adjusting your search or filters."||void 0,yt=Te?(0,t.jsx)(c.m,{content:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h4",{children:"Unable to retrieve metric names"}),(0,t.jsx)("p",{children:Te})]}),children:(0,t.jsx)(o.I,{className:Ne.warningIcon,name:"exclamation-triangle"})}):void 0;return(0,t.jsxs)("div",{className:Ne.container,children:[(0,t.jsxs)("div",{className:Ne.header,children:[(0,t.jsx)(h.D,{label:"Search metrics",className:Ne.searchField,children:(0,t.jsx)(f.p,{placeholder:"Search metrics",prefix:(0,t.jsx)(o.I,{name:"search"}),value:$e,onChange:ce.onSearchQueryChange,suffix:yt})}),(0,t.jsx)(h.D,{label:(0,t.jsxs)("div",{className:Ne.displayOptionTooltip,children:[(0,t.jsx)(l.x6,{i18nKey:"explore-metrics.viewBy",children:"View by"}),(0,t.jsx)(d.K,{name:"info-circle",size:"sm",variant:"secondary",tooltip:z})]}),className:Ne.displayOption,children:(0,t.jsx)(p.l6,{value:Ye,onChange:ce.onPrefixFilterChange,onOpenMenu:()=>ce.reportPrefixFilterInteraction(!0),onCloseMenu:()=>ce.reportPrefixFilterInteraction(!1),options:[{label:"All metric names",value:ne},...Array.from(Le?.groups.keys()??[]).map(st=>({label:`${st}_`,value:st}))]})}),(0,t.jsx)(m.K,{showLabel:!0,label:"Show previews",value:ye,onChange:ce.onTogglePreviews})]}),De&&(0,t.jsxs)(v.F,{title:"Unable to retrieve metric names",severity:"error",children:[(0,t.jsx)("div",{children:"We are unable to connect to your data source. Double check your data source URL and credentials."}),(0,t.jsxs)("div",{children:["(",De,")"]})]}),Te&&!Pe&&(0,t.jsx)(v.F,{title:"Unable to retrieve all metric names",severity:"warning",onSubmit:Ue,onRemove:Ue,children:(0,t.jsx)("div",{children:Te})}),(0,t.jsxs)(u.O,{isLoading:dt,blockingMessage:vt,children:[re instanceof g.G1&&(0,t.jsx)(re.Component,{model:re}),re instanceof g.gF&&(0,t.jsx)(re.Component,{model:re})]})]})}}}function se(oe,ce){return g.d0.text().setTitle(oe).setDescription(ce).setHeaderActions(new I({metric:oe,title:"Select"})).setOption("content","").build()}function ie(oe){return{container:(0,n.css)({display:"flex",flexDirection:"column"}),headingWrapper:(0,n.css)({marginBottom:oe.spacing(.5)}),header:(0,n.css)({flexGrow:0,display:"flex",gap:oe.spacing(2),marginBottom:oe.spacing(2),alignItems:"flex-end"}),searchField:(0,n.css)({flexGrow:1,marginBottom:0}),metricTabGroup:(0,n.css)({marginBottom:oe.spacing(2)}),displayOption:(0,n.css)({flexGrow:0,marginBottom:0,minWidth:"184px"}),displayOptionTooltip:(0,n.css)({display:"flex",gap:oe.spacing(1)}),warningIcon:(0,n.css)({color:oe.colors.warning.main})}}function Z(oe){return(0,M.kj)(oe).state.metricSearch||""}},90623:(k,R,e)=>{"use strict";e.d(R,{p:()=>s});var t=e(74848),n=e(67061),i=e(94753);const s=()=>(0,t.jsxs)(n.B,{direction:"column",gap:1,children:[(0,t.jsx)(i.E,{variant:"h1",children:"Metrics"}),(0,t.jsx)(i.E,{color:"secondary",children:"Explore your Prometheus-compatible metrics without writing a query"})]})},69096:(k,R,e)=>{"use strict";e.d(R,{O:()=>r});var t=e(74848),n=e(32196),i=e(40845),s=e(39558);function r({blockingMessage:a,isLoading:c,children:o}){const h=(0,i.of)(g);return c&&!a&&(a="Loading..."),c?(0,t.jsx)(s._,{className:h.statusMessage,text:a}):a?(0,t.jsx)("div",{className:h.statusMessage,children:a}):o}function g(a){return{statusMessage:(0,n.css)({fontStyle:"italic",marginTop:a.spacing(7),textAlign:"center",width:"100%"})}}},74764:(k,R,e)=>{"use strict";e.d(R,{yn:()=>u,_r:()=>E});var t=e(2543),n=e(76885),i=e(80943),s=e(99140),r=e(16001),g=e(56833),a=e(4200),c=e(51080),o=e(74848),h=e(67061),f=e(55852),d=e(3169);function p(){const P=(0,d.tZ)("Bookmark created");return P.component=(0,o.jsxs)(h.B,{gap:2,direction:"row",children:[(0,o.jsxs)("div",{children:["You can view bookmarks under ",(0,o.jsx)("i",{children:"Explore > Metrics"})]}),(0,o.jsx)(f.z9,{fill:"solid",variant:"secondary",href:a.QX,children:"View bookmarks"})]}),P}const m=20;class v{constructor(){this._recent=[],this._bookmarks=[],this._bookmarkIndexMap=new Map,this.load();const b=()=>{const M=this._recent.slice(0,m).map(O=>this._serializeTrail(O.resolve()));localStorage.setItem(a.sQ,JSON.stringify(M)),localStorage.setItem(a.jT,JSON.stringify(this._bookmarks))};this._save=(0,t.debounce)(b,1e3),window.addEventListener("beforeunload",M=>{this._save=b})}_loadRecentTrailsFromStorage(){const b=[],M=localStorage.getItem(a.sQ);if(M){const O=JSON.parse(M);for(const I of O){const T=this._deserializeTrail(I);b.push(T.getRef())}}return b}_loadBookmarksFromStorage(){const b=localStorage.getItem(a.jT);return(b?JSON.parse(b):[]).map(O=>{if(x(O)){const I=O.currentStep!=null?O.currentStep:O.history.length-1;return{urlValues:O.history[I].urlValues,createdAt:O.createdAt||Date.now()}}return O})}_deserializeTrail(b){const M=new g.b({createdAt:b.createdAt});b.history.map(I=>{this._loadFromUrl(M,I.urlValues);const T=I.parentIndex??M.state.history.state.steps.length-1;M.state.history.setState({currentStep:T}),M.state.history.addTrailStepFromStorage(M,I)});const O=b.currentStep??M.state.history.state.steps.length-1;return M.state.history.setState({currentStep:O}),M.setState(i.Go.cloneSceneObjectState(M.state.history.state.steps[O].trailState,{history:M.state.history})),M}_serializeTrail(b){return{history:b.state.history.state.steps.map(O=>{const I=new g.b(i.Go.cloneSceneObjectState(O.trailState));return{urlValues:(0,i.Is)().getUrlState(I),type:O.type,description:O.description,parentIndex:O.parentIndex}}),currentStep:b.state.history.state.currentStep,createdAt:b.state.createdAt}}getTrailForBookmarkIndex(b){const M=this._bookmarks[b];return M?this.getTrailForBookmark(M):(0,c.ef)()}getTrailForBookmark(b){const M=u(b);for(const I of this._recent){const T=I.resolve();if(u(T)===M)return T}const O=new g.b({});return this._loadFromUrl(O,b.urlValues),O}_loadFromUrl(b,M){const O=n.kM.renderUrl("",M);i.Go.syncStateFromSearchParams(b,new URLSearchParams(O))}get recent(){return this._recent}load(){this._recent=this._loadRecentTrailsFromStorage(),this._bookmarks=this._loadBookmarksFromStorage(),this._refreshBookmarkIndexMap()}setRecentTrail(b){const{steps:M}=b.state.history.state;if(M.length===0||M.length===1&&M[0].type==="start")return;this._recent=this._recent.filter(I=>I!==b.getRef());const O=l(b);this._recent=this._recent.filter(I=>{const T=l(I.resolve());return!(0,t.isEqual)(O,T)}),this._recent.unshift(b.getRef()),this._save()}get bookmarks(){return this._bookmarks}addBookmark(b){const O={urlValues:(0,i.Is)().getUrlState(b),createdAt:Date.now()};this._bookmarks.unshift(O),this._refreshBookmarkIndexMap(),this._save(),(0,s.JD)((0,r.dx)(p()))}removeBookmark(b){b<this._bookmarks.length&&(this._bookmarks.splice(b,1),this._refreshBookmarkIndexMap(),this._save())}getBookmarkIndex(b){const M=u(b);return this._bookmarkIndexMap.get(M)}_refreshBookmarkIndexMap(){this._bookmarkIndexMap.clear(),this._bookmarks.forEach((b,M)=>{const O=u(b);this._bookmarkIndexMap.set(O,M)})}}function l(P){const b=(0,i.Is)().getUrlState(P);return y(b),b}function y(P){return delete P.actionView,delete P.layout,delete P.metricSearch,delete P.refresh,(P["var-groupby"]===""||P["var-groupby"]===void 0)&&(P["var-groupby"]="$__all"),typeof P["var-filters"]!="string"&&(P["var-filters"]=P["var-filters"]?.filter(b=>b!=="")),P}function u(P){return P instanceof g.b?JSON.stringify(l(P)):JSON.stringify(y({...P.urlValues}))}let D;function E(){return D||(D=new v),D}function x(P){return P!=null&&typeof P=="object"&&"history"in P}},88434:(k,R,e)=>{"use strict";e.d(R,{R:()=>r,q:()=>s});var t=e(50556),n=e(19347),i=e(4200);class s{constructor(a){this._trail=a}reset(){this._datasource=void 0,this._metricsMetadata=void 0}async getDatasource(){return this._datasource||(this._datasource=(0,n.l)().get(i.gR,{__sceneObject:{value:this._trail}})),await this._datasource}async _getMetricsMetadata(){const a=await this.getDatasource();if(a.languageProvider instanceof t.Ay)return a.languageProvider.metricsMetadata||await a.languageProvider.loadMetricsMetadata(),a.languageProvider.metricsMetadata}async getMetricMetadata(a){return a?(this._metricsMetadata||(this._metricsMetadata=this._getMetricsMetadata()),(await this._metricsMetadata)?.[a]):void 0}}function r(g){if(!g)return;const{type:a,help:c,unit:o}=g;return[c,a&&`**Type:** *${a}*`,o&&`**Unit:** ${o}`].join(`

`)}},40588:(k,R,e)=>{"use strict";e.d(R,{h:()=>s,z:()=>i});var t=e(14110);const n="grafana_explore_metrics_";function i(r,g){(0,t.rR)(`${n}${r}`,g)}function s(r,g){if(r.length===g.length)for(const a of g)for(const c of r)a.key===c.key&&a.value!==c.value&&i("label_filter_changed",{label:a.key,action:"changed",cause:"adhoc_filter"});else if(r.length<g.length)for(const a of g){let c=!1;for(const o of r)if(a.key===o.key){c=!0;break}c||i("label_filter_changed",{label:a.key,action:"removed",cause:"adhoc_filter"})}else for(const a of r){let c=!1;for(const o of g)if(o.key===a.key){c=!0;break}c||i("label_filter_changed",{label:a.key,action:"added",cause:"adhoc_filter"})}}},4200:(k,R,e)=>{"use strict";e.d(R,{Ao:()=>g,EY:()=>d,GH:()=>u,OO:()=>b,Pp:()=>x,QX:()=>r,Rp:()=>o,aZ:()=>f,gR:()=>p,jT:()=>E,km:()=>s,sQ:()=>D,td:()=>l,ui:()=>a,ym:()=>P,yr:()=>h});var t=e(65463),n=e(80943),i=e(79422);const s="/explore/metrics/trail",r="/explore/metrics",g="filters",a="{${filters}}",c="metric",o="${metric}",h="groupby",f="${groupby}",d="ds",p="${ds}",m="logsDs",v="${logsDs}",l="$__logs__",y="sqr-metric-viz-query",u={uid:p},D="grafana.trails.recent",E="grafana.trails.bookmarks",x="grafana.trails.breakdown.view";function P(M){return[new n.x0({name:c,value:M,hide:i.zL.hideVariable})]}class b extends t.x{static{this.type="metric-selected-event"}}},51080:(k,R,e)=>{"use strict";e.d(R,{KE:()=>f,U4:()=>l,Vy:()=>E,aM:()=>v,aO:()=>u,ef:()=>d,gA:()=>P,hR:()=>D,iG:()=>x,kj:()=>h,nH:()=>y,xi:()=>p});var t=e(76885),n=e(19347),i=e(32264),s=e(80943),r=e(31193),g=e(56833),a=e(94383),c=e(74764),o=e(4200);function h(b){return s.jh.getAncestor(b,g.b)}function f(b){return s.jh.getAncestor(b,g.b).state.settings}function d(b){return new g.b({initialDS:b,$timeRange:new s.JZ({from:"now-1h",to:"now"}),embedded:!1})}function p(b){const M=(0,s.Is)().getUrlState(b);return m(M)}function m(b){return t.kM.renderUrl(o.km,b)}function v(b){if(b instanceof a.R)return b;if(b.parent)return v(b.parent);throw console.error("Unable to find graph view for",b),new Error("Unable to find trail")}function l(b){return s.jh.interpolate(b,o.gR)}function y(b){return(0,n.l)().getInstanceSettings(b)?.name||b}function u(b){return b?b===o.td?"Logs":b:"Select metric"}function D(){const b=(0,c._r)().recent[0];if(b){const O=s.jh.interpolate(b.resolve(),o.gR);if(typeof O=="string"&&O.length>0)return O}const M=(0,r.tR)().getList({type:"prometheus"});if(M.length>0)return M.find(O=>O.uid===i.$.defaultDatasource)?.uid??M[0].uid}function E(b){const M=i.$.theme2.visualization;return M.getColorByName(M.palette[b%8])}function x(b){const M=Object.keys(b);return M.includes("from")&&M.includes("to")}function P(b){const M=s.jh.lookupVariable("filters",b);return M instanceof s.H9?M.state.filters:null}},27825:(k,R,e)=>{"use strict";e.d(R,{J:()=>l});var t=e(52622),n=e(38248),i=e(74848),s=e(96540),r=e(91890),g=e(72574),a=e(32264),c=e(66864),o=e(94354),h=e(10354),f=e(88841),d=e(94397);const p=[{label:"Size",value:t.J1.Size,description:"Split the buckets based on size"},{label:"Count",value:t.J1.Count,description:"Split the buckets based on count"}],m=[{label:"Split",value:t.J1.Size,description:"Split the buckets based on size"}],v=({value:y,onChange:u,item:D})=>{const[E,x]=(0,s.useState)(!1),P=O=>{x(!(0,d.N_)(O)),u({...y,value:O})},M=(0,g.w)().getVariables().map(O=>({value:O.name,label:O.label||O.name,origin:r.$0.Template}));return(0,i.jsxs)(c.Gy,{children:[(0,i.jsx)(o.z,{value:y?.mode||t.J1.Size,options:y?.scale?.type===t.L4.Log?m:p,onChange:O=>{u({...y,mode:O})}}),a.$.featureToggles.transformationsVariableSupport?(0,i.jsx)(f.y,{invalid:E,error:"Value needs to be an integer or a variable",value:y?.value??"",placeholder:"Auto",onChange:P,suggestions:M}):(0,i.jsx)(h.p,{value:y?.value??"",placeholder:"Auto",onChange:O=>{u({...y,value:O.currentTarget.value})}})]})};function l(y,u,D,E){u.addCustomEditor({id:"xBuckets",path:`${y}xBuckets`,name:"X Bucket",editor:v,category:E,defaultValue:{mode:t.J1.Size}}),u.addCustomEditor({id:"yBuckets",path:`${y}yBuckets`,name:"Y Bucket",editor:v,category:E,defaultValue:{mode:t.J1.Size}}),u.addCustomEditor({id:"yBuckets-scale",path:`${y}yBuckets.scale`,name:"Y Bucket scale",category:E,editor:n.W,defaultValue:{type:t.L4.Linear}})}},3290:(k,R,e)=>{"use strict";e.d(R,{VQ:()=>V,wY:()=>L,Nb:()=>B,eE:()=>w,yJ:()=>U});var t=e(81160),n=e(18282),i=e(81010),s=e(11261),r=e(28240),g=e(83195),a=e(41260),c=e(70416),o=e(77678),h=e(73060),f=e(32264),d=e(52622),p=e(97706);const{abs:m,pow:v}=Math,l=new Map;function y(J,q,ae,j){let te=[],ne=j.map(p.E);for(let le=q;le<ae;le++){let z=m(le),ee=(0,p.h)(v(J,le),z);for(let se=0;se<j.length;se++){let ie=j[se]*ee,Z=(ie>=0&&le>=0?0:z)+(le>=ne[se]?0:ne[se]),oe=(0,p.h)(ie,Z);te.push(oe),l.set(oe,Z)}}return te}const u=J=>J%1===0,D=[1,1.5,2,2.5,3,3.5,4,4.5,5,5.5,6,6.5,7,7.5,8,8.5,9,9.5],E=y(10,-16,0,D),x=y(10,0,16,D),P=x.filter(u),b=E.concat(x),M=E.concat(P),O=1*1e3,I=60*O,T=60*I,C=24*T,S=365*C,A=[1,2,4,5,10,20,25,40,50,100,200,250,400,500,O,2*O,4*O,5*O,10*O,15*O,20*O,30*O,I,2*I,4*I,5*I,10*I,15*I,20*I,30*I,T,2*T,4*T,6*T,8*T,12*T,18*T,C,2*C,3*C,4*C,5*C,6*C,7*C,10*C,15*C,30*C,45*C,60*C,90*C,180*C,S,2*S,3*S,4*S,5*S,6*S,7*S,8*S,9*S,10*S],L={id:n.F.heatmap,name:"Create heatmap",description:"Generate heatmap data from source data.",defaultOptions:{},isApplicable:J=>{const{xField:q,yField:ae,xs:j,ys:te}=H(J);return q||ae||!j.length||!te.length?i.M.NotPossible:i.M.Applicable},isApplicableDescription:"The Heatmap transformation requires fields with Heatmap compatible data. No fields with Heatmap data could be found.",operator:(J,q)=>ae=>ae.pipe((0,t.T)(j=>{if(f.$.featureToggles.transformationsVariableSupport){const te={...J,xBuckets:{...J.xBuckets},yBuckets:{...J.yBuckets}};return te.xBuckets?.value&&(te.xBuckets.value=q.interpolate(te.xBuckets.value)),te.yBuckets?.value&&(te.yBuckets.value=q.interpolate(te.yBuckets.value)),L.transformer(te,q)(j)}else return L.transformer(J,q)(j)})),transformer:J=>q=>{const ae=V(q,J);return J.keepOriginalData?[ae,...q]:[ae]}};function N(J){return J==="+Inf"?1/0:J==="-Inf"?-1/0:+(J??0)}function F(J,q){return N(J)-N(q)}function w(J){return J?.meta?.custom??{}}function B(J){let q=!1;for(let ae of J.fields)switch(ae.name){case"y":case"yMin":case"yMax":if(q)return!1;q=!0}return q}function U(J){const q=J.frame.fields[0],ae=q.values,j=J.frame.fields.filter((ce,ye)=>ce.type===s.PU.number&&ye>0),te=ae.length*j.length,ne=new Array(te),le=new Array(te),z=new Array(te),ee=j.map(ce=>ce.values.slice());ee.forEach((ce,ye)=>{for(let re=0;re<ce.length;re++)z[ee.length*re+ye]=ce[re]});const se=Array.from({length:j.length},(ce,ye)=>ye);for(let ce=0,ye=0,re=0;ce<te;ye=++ce%se.length)le[ce]=se[ye],ye===0&&ce>=se.length&&re++,ne[ce]=ae[re];let ie=j[0].labels?.le!=null?"yMax":"y";switch(J.layout){case d.D7.le:ie="yMax";break;case d.D7.ge:ie="yMin";break;case d.D7.unknown:ie="y";break}const Z={yOrdinalDisplay:j.map(ce=>(0,r.Ct)(ce,J.frame)),yMatchWithLabel:Object.keys(j[0].labels??{})[0]};if(Z.yMatchWithLabel&&(Z.yOrdinalLabel=j.map(ce=>ce.labels?.[Z.yMatchWithLabel]??""),Z.yMatchWithLabel==="le"&&(Z.yMinDisplay="0.0")),J.unit?.length||J.decimals!=null){const ce=(0,g.j_)(J.unit??"short");Z.yMinDisplay&&(Z.yMinDisplay=(0,g.cN)(ce(0,J.decimals))),Z.yOrdinalDisplay=Z.yOrdinalDisplay.map(ye=>{let re=+ye;return Number.isNaN(re)?ye:(0,g.cN)(ce(re,J.decimals))})}const oe={...j[0].config};return oe.displayNameFromDS&&delete oe.displayNameFromDS,{length:ne.length,refId:J.frame.refId,meta:{type:a.m.HeatmapCells,custom:Z},fields:[{name:q.type===s.PU.time?"xMax":"x",type:q.type,values:ne,config:q.config},{name:ie,type:s.PU.number,values:le,config:{unit:"short"}},{name:J.value?.length?J.value:"Value",type:s.PU.number,values:z,config:oe,display:j[0].display}]}}function K(J){J=J.slice(),J.sort((ae,j)=>F(ae.name,j.name));const q=J.map(ae=>ae.fields[1].values.slice());return q.reverse(),q.forEach((ae,j)=>{if(j<q.length-1)for(let te=0;te<ae.length;te++)ae[te]-=q[j+1][te]}),q.reverse(),J.map((ae,j)=>({...ae,fields:[ae.fields[0],{...ae.fields[1],values:q[j]}]}))}function V(J,q){const{xField:ae,yField:j,xs:te,ys:ne}=H(J);if(!ae||!j)throw"no heatmap fields found";if(!te.length||!ne.length)throw"no values found";const le=q.xBuckets??{},z=q.yBuckets??{};if(le.scale?.type===d.L4.Log)throw"X axis only supports linear buckets";const ee=q.yBuckets?.scale??{type:d.L4.Linear},se=Y(te,ne,{xSorted:(0,h.g2)(te),xTime:ae.type===s.PU.time,xMode:le.mode,xSize:le.mode===d.J1.Size?(0,c.WT)((0,c.E9)(le.value??"")):le.value?+le.value:void 0,yMode:z.mode,ySize:z.value?+z.value:void 0,yLog:ee?.type===d.L4.Log?ee?.log:void 0,xMin:q.timeRange?.from.valueOf(),xMax:q.timeRange?.to.valueOf()});return{length:se.x.length,name:(0,r.Ct)(j),meta:{type:a.m.HeatmapCells},fields:[{name:"xMin",type:ae.type,values:se.x,config:ae.config},{name:"yMin",type:s.PU.number,values:se.y,config:{...j.config,custom:{scaleDistribution:ee}}},{name:"Count",type:s.PU.number,values:se.count,config:{unit:"short"}}]}}function H(J){let q,ae,j=0;for(let z of J)z.fields.find(se=>se.type===s.PU.time)&&(j+=z.length);let te=Array(j),ne=Array(j),le=0;for(let z of J){const ee=z.fields.find(ie=>ie.type===s.PU.time);if(!ee)continue;q||(q=ee);const se=ee.values;for(let ie of z.fields)if(ie!==ee&&ie.type===s.PU.number){const Z=ie.values;for(let oe=0;oe<se.length;oe++,le++)te[le]=se[oe],ne[le]=Z[oe];ae||(ae=ie)}}return{xField:q,yField:ae,xs:te,ys:ne}}function Y(J,q,ae){let j=J.length,te=ae?.xSorted??!1,ne=ae?.ySorted??!1,le=ae?.xMin??(te?J[0]:1/0),z=ne?q[0]:1/0,ee=ae?.xMax??(te?J[j-1]:-1/0),se=ne?q[j-1]:-1/0,ie=ae?.yLog,Z=ae?.xMin!=null&&ae?.xMax!=null,oe=ae?.yMin!=null&&ae?.yMax!=null;for(let ze=0;ze<j;ze++)!te&&!Z&&(le=Math.min(le,J[ze]),ee=Math.max(ee,J[ze])),!ne&&!oe&&(!ie||q[ze]>0)&&(z=Math.min(z,q[ze]),se=Math.max(se,q[ze]));let ce=ae?.xSize??0,ye=ae?.ySize??0,re=ae?.xMode,ue=ae?.yMode;if((!Number.isFinite(ce)||ce<=0)&&(re=d.J1.Count,ce=20),(!Number.isFinite(ye)||ye<=0)&&(ue=d.J1.Count,ye=10),re===d.J1.Count){let ze=(ee-le)/Math.max(ce-1,1),qe=ae?.xTime?A:M,dt=qe.findIndex(vt=>vt>ze)-1;ce=qe[Math.max(dt,0)]}if(ue===d.J1.Count){let ze=(se-z)/Math.max(ye-1,1),qe=ae?.yTime?A:M,dt=qe.findIndex(vt=>vt>ze)-1;ye=qe[Math.max(dt,0)]}let De=ae?.xCeil?ze=>(0,o.Uh)(ze,ce):ze=>(0,o.rs)(ze,ce),ge=ae?.yCeil?ze=>(0,o.Uh)(ze,ye):ze=>(0,o.rs)(ze,ye);if(ie){ye=1/(ae?.ySize??1);let ze=ie===2?Math.log2:Math.log10;ge=ae?.yCeil?qe=>(0,o.Uh)(ze(qe),ye):qe=>(0,o.rs)(ze(qe),ye)}let Te=De(le),Le=De(ee),Ye=ge(z),je=ge(se),Ze=Math.round((Le-Te)/ce)+1,Ne=Math.round((je-Ye)/ye)+1,[Pe,Ue,$e]=X(Ze,Ne,Te,ce,Ye,ye,ie);for(let ze=0;ze<j;ze++){if(ie&&q[ze]<=0)continue;const qe=(De(J[ze])-Te)/ce,dt=(ge(q[ze])-Ye)/ye,vt=qe*Ne+dt;$e[vt]++}return{x:Pe,y:Ue,count:$e}}function X(J,q,ae,j,te,ne,le){const z=J*q,ee=new Array(z),se=new Array(z),ie=new Array(z);for(let Z=0,oe=0,ce=ae;Z<z;oe=++Z%q)ie[Z]=0,le?se[Z]=le**(te+oe*ne):se[Z]=te+oe*ne,oe===0&&Z>=q&&(ce+=j),ee[Z]=ce;return[ee,se,ie]}},91847:(k,R,e)=>{"use strict";e.d(R,{$n:()=>i,g_:()=>t,uk:()=>n});var t=(r=>(r.ShortcodeFigure="shortcodeFigure",r.UIImage="uiImage",r))(t||{});const n={calculateField:{name:"Add field from calculation",getHelperDocs:function(r="shortcodeFigure"){return`
Use this transformation to add a new field calculated from two other fields. Each transformation allows you to add one new field.

- **Mode** - Select a mode:
  - **Reduce row** - Apply selected calculation on each row of selected fields independently.
  - **Binary operation** - Apply basic binary operations (for example, sum or multiply) on values in a single row from two selected fields.
  - **Unary operation** - Apply basic unary operations on values in a single row from a selected field. The available operations are:
    - **Absolute value (abs)** - Returns the absolute value of a given expression. It represents its distance from zero as a positive number.
    - **Natural exponential (exp)** - Returns _e_ raised to the power of a given expression.
    - **Natural logarithm (ln)** - Returns the natural logarithm of a given expression.
    - **Floor (floor)** - Returns the largest integer less than or equal to a given expression.
    - **Ceiling (ceil)** - Returns the smallest integer greater than or equal to a given expression.
  - **Cumulative functions** - Apply functions on the current row and all preceding rows.
    - **Total** - Calculates the cumulative total up to and including the current row.
    - **Mean** - Calculates the mean up to and including the current row.
  - **Window functions** - Apply window functions. The window can either be **trailing** or **centered**.
    With a trailing window the current row will be the last row in the window.
    With a centered window the window will be centered on the current row.
    For even window sizes, the window will be centered between the current row, and the previous row.
    - **Mean** - Calculates the moving mean or running average.
    - **Stddev** - Calculates the moving standard deviation.
    - **Variance** - Calculates the moving variance.
  - **Row index** - Insert a field with the row index.
- **Field name** - Select the names of fields you want to use in the calculation for the new field.
- **Calculation** - If you select **Reduce row** mode, then the **Calculation** field appears. Click in the field to see a list of calculation choices you can use to create the new field. For information about available calculations, refer to [Calculation types][].
- **Operation** - If you select **Binary operation** or **Unary operation** mode, then the **Operation** fields appear. These fields allow you to apply basic math operations on values in a single row from selected fields. You can also use numerical values for binary operations.
- **As percentile** - If you select **Row index** mode, then the **As percentile** switch appears. This switch allows you to transform the row index as a percentage of the total number of rows.
- **Alias** - (Optional) Enter the name of your new field. If you leave this blank, then the field will be named to match the calculation.
- **Replace all fields** - (Optional) Select this option if you want to hide all other fields and display only your calculated field in the visualization.

In the example below, we added two fields together and named them Sum.

${s("/static/img/docs/transformations/add-field-from-calc-stat-example-7-0.png",r,"A stat visualization including one field called Sum")}
  `},links:[{title:"Calculation types",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/calculation-types/"}]},concatenate:{name:"Concatenate fields",getHelperDocs:function(){return`
Use this transformation to combine all fields from all frames into one result.

For example, if you have separate queries retrieving temperature and uptime data (Query A) and air quality index and error information (Query B), applying the concatenate transformation yields a consolidated data frame with all relevant information in one view.

Consider the following:

**Query A:**

| Temp  | Uptime  |
| ----- | ------- |
| 15.4  | 1230233 |

**Query B:**

| AQI   | Errors |
| ----- | ------ |
| 3.2   | 5      |

After you concatenate the fields, the data frame would be:

| Temp | Uptime  | AQI | Errors |
| ---- | ------- | --- | ------ |
| 15.4 | 1230233 | 3.2 | 5      |

This transformation simplifies the process of merging data from different sources, providing a comprehensive view for analysis and visualization.
  `}},configFromData:{name:"Config from query results",getHelperDocs:function(){return`
Use this transformation to select a query and extract standard options, such as **Min**, **Max**, **Unit**, and **Thresholds**, and apply them to other query results. This feature enables dynamic visualization configuration based on the data returned by a specific query.

#### Options

- **Config query** - Select the query that returns the data you want to use as configuration.
- **Apply to** - Select the fields or series to which the configuration should be applied.
- **Apply to options** - Specify a field type or use a field name regex, depending on your selection in **Apply to**.

#### Field mapping table

Below the configuration options, you'll find the field mapping table. This table lists all fields found in the data returned by the config query, along with **Use as** and **Select** options. It provides control over mapping fields to config properties, and for multiple rows, it allows you to choose which value to select.

#### Example

Input[0] (From query: A, name: ServerA)

| Time          | Value |
| ------------- | ----- |
| 1626178119127 | 10    |
| 1626178119129 | 30    |

Input[1] (From query: B)

| Time          | Value |
| ------------- | ----- |
| 1626178119127 | 100   |
| 1626178119129 | 100   |

Output (Same as Input[0] but now with config on the Value field)

| Time          | Value (config: Max=100) |
| ------------- | ----------------------- |
| 1626178119127 | 10                      |
| 1626178119129 | 30                      |

Each row in the source data becomes a separate field. Each field now has a maximum configuration option set. Options such as **Min**, **Max**, **Unit**, and **Thresholds** are part of the field configuration. If set, they are used by the visualization instead of any options manually configured in the panel editor options pane.

#### Value mappings

You can also transform a query result into value mappings. With this option, every row in the configuration query result defines a single value mapping row. See the following example.

Config query result:

| Value | Text   | Color |
| ----- | ------ | ----- |
| L     | Low    | blue  |
| M     | Medium | green |
| H     | High   | red   |

In the field mapping specify:

| Field | Use as                  | Select     |
| ----- | ----------------------- | ---------- |
| Value | Value mappings / Value  | All values |
| Text  | Value mappings / Text   | All values |
| Color | Value mappings / Color | All values |

Grafana builds value mappings from your query result and applies them to the real data query results. You should see values being mapped and colored according to the config query results.
  `}},convertFieldType:{name:"Convert field type",getHelperDocs:function(){return`
Use this transformation to modify the field type of a specified field.

This transformation has the following options:

- **Field** - Select from available fields
- **as** - Select the FieldType to convert to
  - **Numeric** - attempts to make the values numbers
  - **String** - will make the values strings
  - **Time** - attempts to parse the values as time
    - The input will be parsed according to the [Moment.js parsing format](https://momentjs.com/docs/#/parsing/)
    - It will parse the numeric input as a Unix epoch timestamp in milliseconds.
      You must multiply your input by 1000 if it's in seconds.
    - Will show an option to specify a DateFormat as input by a string like yyyy-mm-dd or DD MM YYYY hh:mm:ss
  - **Boolean** - will make the values booleans
  - **Enum** - will make the values enums
    - Will show a table to manage the enums
  - **Other** - attempts to parse the values as JSON

For example, consider the following query that could be modified by selecting the time field as Time and specifying Date Format as YYYY.

#### Sample Query

| Time       | Mark  | Value |
|------------|-------|-------|
| 2017-07-01 | above | 25    |
| 2018-08-02 | below | 22    |
| 2019-09-02 | below | 29    |
| 2020-10-04 | above | 22    |

The result:

#### Transformed Query

| Time                | Mark  | Value |
|---------------------|-------|-------|
| 2017-01-01 00:00:00 | above | 25    |
| 2018-01-01 00:00:00 | below | 22    |
| 2019-01-01 00:00:00 | below | 29    |
| 2020-01-01 00:00:00 | above | 22    |

This transformation allows you to flexibly adapt your data types, ensuring compatibility and consistency in your visualizations.
  `}},extractFields:{name:"Extract fields",getHelperDocs:function(){return`
Use this transformation to select a source of data and extract content from it in different formats. This transformation has the following fields:

- **Source** - Select the field for the source of data.
- **Format** - Choose one of the following:
  - **JSON** - Parse JSON content from the source.
  - **Key+value pairs** - Parse content in the format 'a=b' or 'c:d' from the source.
  - **Auto** - Discover fields automatically.
- **Replace All Fields** - (Optional) Select this option to hide all other fields and display only your calculated field in the visualization.
- **Keep Time** - (Optional) Available only if **Replace All Fields** is true. Keeps the time field in the output.

Consider the following dataset:

#### Dataset Example

| Timestamp           | json_data     |
|---------------------|---------------|
| 1636678740000000000 | {"value": 1}  |
| 1636678680000000000 | {"value": 5}  |
| 1636678620000000000 | {"value": 12} |

You could prepare the data to be used by a [Time series panel][] with this configuration:

- Source: json_data
- Format: JSON
  - Field: value
  - Alias: my_value
- Replace all fields: true
- Keep time: true

This will generate the following output:

#### Transformed Data

| Timestamp           | my_value |
|---------------------|----------|
| 1636678740000000000 | 1        |
| 1636678680000000000 | 5        |
| 1636678620000000000 | 12       |

This transformation allows you to extract and format data in various ways. You can customize the extraction format based on your specific data needs.
  `},links:[{title:"Time series panel",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/time-series/"}]},fieldLookup:{name:"Lookup fields from resource",getHelperDocs:function(){return`
Use this transformation to enrich a field value by looking up additional fields from an external source. 
  
This transformation has the following fields:

- **Field** - Select a text field from your dataset.
- **Lookup** - Choose from **Countries**, **USA States**, and **Airports**.

This transformation currently supports spatial data.

For example, if you have this data:

#### Dataset Example

| Location  | Values |
|-----------|--------|
| AL        | 0      |
| AK        | 10     |
| Arizona   | 5      |
| Arkansas  | 1      |
| Somewhere | 5      |

With this configuration:

- Field: location
- Lookup: USA States

You'll get the following output:

#### Transformed Data

| Location  | ID | Name     | Lng         | Lat       | Values |
|-----------|----|----------|-------------|-----------|--------|
| AL        | AL | Alabama  | -80.891064  | 12.448457 | 0      |
| AK        | AK | Arkansas | -100.891064 | 24.448457 | 10     |
| Arizona   |    |          |             |           | 5      |
| Arkansas  |    |          |             |           | 1      |
| Somewhere |    |          |             |           | 5      |

This transformation lets you augment your data by fetching additional information from external sources, providing a more comprehensive dataset for analysis and visualization.
  `}},filterByRefId:{name:"Filter data by query refId",getHelperDocs:function(r="shortcodeFigure"){return`
Use this transformation to hide one or more queries in panels that have multiple queries.

Grafana displays the query identification letters in dark gray text. Click a query identifier to toggle filtering. If the query letter is white, then the results are displayed. If the query letter is dark, then the results are hidden.

> **Note:** This transformation is not available for Graphite because this data source does not support correlating returned data with queries.

In the example below, the panel has three queries (A, B, C). We removed the B query from the visualization.

${s("/static/img/docs/transformations/filter-by-query-stat-example-7-0.png",r,"A stat visualization with results from two queries, A and C")}
  `}},filterByValue:{name:"Filter data by values",getHelperDocs:function(){return`
Use this transformation to selectively filter data points directly within your visualization. This transformation provides options to include or exclude data based on one or more conditions applied to a selected field.

This transformation is very useful if your data source does not natively filter by values. You might also use this to narrow values to display if you are using a shared query.

The available conditions for all fields are:

- **Regex** - Match a regex expression.
- **Is Null** - Match if the value is null.
- **Is Not Null** - Match if the value is not null.
- **Equal** - Match if the value is equal to the specified value.
- **Different** - Match if the value is different than the specified value.

The available conditions for string fields are:

- **Contains substring** - Match if the value contains the specified substring (case insensitive).
- **Does not contain substring** - Match if the value doesn't contain the specified substring (case insensitive).

The available conditions for number fields are:

- **Greater** - Match if the value is greater than the specified value.
- **Lower** - Match if the value is lower than the specified value.
- **Greater or equal** - Match if the value is greater or equal.
- **Lower or equal** - Match if the value is lower or equal.
- **Range** - Match a range between a specified minimum and maximum, min and max included.

Consider the following dataset:

#### Dataset Example

| Time                | Temperature | Altitude |
|---------------------|-------------|----------|
| 2020-07-07 11:34:23 | 32          | 101      |
| 2020-07-07 11:34:22 | 28          | 125      |
| 2020-07-07 11:34:21 | 26          | 110      |
| 2020-07-07 11:34:20 | 23          | 98       |
| 2020-07-07 10:32:24 | 31          | 95       |
| 2020-07-07 10:31:22 | 20          | 85       |
| 2020-07-07 09:30:57 | 19          | 101      |

If you **Include** the data points that have a temperature below 30\xB0C, the configuration will look as follows:

- Filter Type: 'Include'
- Condition: Rows where 'Temperature' matches 'Lower Than' '30'

And you will get the following result, where only the temperatures below 30\xB0C are included:

#### Transformed Data

| Time                | Temperature | Altitude |
|---------------------|-------------|----------|
| 2020-07-07 11:34:22 | 28          | 125      |
| 2020-07-07 11:34:21 | 26          | 110      |
| 2020-07-07 11:34:20 | 23          | 98       |
| 2020-07-07 10:31:22 | 20          | 85       |
| 2020-07-07 09:30:57 | 19          | 101      |

You can add more than one condition to the filter. For example, you might want to include the data only if the altitude is greater than 100. To do so, add that condition to the following configuration:

- Filter type: 'Include' rows that 'Match All' conditions
- Condition 1: Rows where 'Temperature' matches 'Lower' than '30'
- Condition 2: Rows where 'Altitude' matches 'Greater' than '100'

When you have more than one condition, you can choose if you want the action (include/exclude) to be applied on rows that **Match all** conditions or **Match any** of the conditions you added.

In the example above, we chose **Match all** because we wanted to include the rows that have a temperature lower than 30\xB0C *AND* an altitude higher than 100. If we wanted to include the rows that have a temperature lower than 30\xB0C *OR* an altitude higher than 100 instead, then we would select **Match any**. This would include the first row in the original data, which has a temperature of 32\xB0C (does not match the first condition) but an altitude of 101 (which matches the second condition), so it is included.

Conditions that are invalid or incompletely configured are ignored.

This versatile data filtering transformation lets you to selectively include or exclude data points based on specific conditions. Customize the criteria to tailor your data presentation to meet your unique analytical needs.
  `}},filterFieldsByName:{name:"Filter fields by name",getHelperDocs:function(r="shortcodeFigure"){return`
Use this transformation to selectively remove parts of your query results. There are three ways to filter field names:

- [Using a regular expression](#use-a-regular-expression)
- [Manually selecting included fields](#manually-select-included-fields)
- [Using a dashboard variable](#use-a-dashboard-variable)

#### Use a regular expression

When you filter using a regular expression, field names that match the regular expression are included. 

For example, from the input data:

| Time                | dev-eu-west | dev-eu-north | prod-eu-west | prod-eu-north |
| ------------------- | ----------- | ------------ | ------------ | ------------- |
| 2023-03-04 23:56:23 | 23.5        | 24.5         | 22.2         | 20.2          |
| 2023-03-04 23:56:23 | 23.6        | 24.4         | 22.1         | 20.1          |

The result from using the regular expression 'prod.*' would be:

| Time                | prod-eu-west | prod-eu-north |
| ------------------- | ------------ | ------------- |
| 2023-03-04 23:56:23 | 22.2         | 20.2          |
| 2023-03-04 23:56:23 | 22.1         | 20.1          |

The regular expression can include an interpolated dashboard variable by using the \${variableName} syntax.

#### Manually select included fields

Click and uncheck the field names to remove them from the result. Fields that are matched by the regular expression are still included, even if they're unchecked.

#### Use a dashboard variable

Enable 'From variable' to let you select a dashboard variable that's used to include fields. By setting up a [dashboard variable][] with multiple choices, the same fields can be displayed across multiple visualizations.

${s("/static/img/docs/transformations/filter-name-table-before-7-0.png",r,"A table visualization with time, value, Min, and Max columns")}

Here's the table after we applied the transformation to remove the Min field.

${s("/static/img/docs/transformations/filter-name-table-after-7-0.png",r,"A table visualization with time, value, and Max columns")}

Here is the same query using a Stat visualization.

${s("/static/img/docs/transformations/filter-name-stat-after-7-0.png",r,"A stat visualization with value and Max fields")}

This transformation provides flexibility in tailoring your query results to focus on the specific fields you need for effective analysis and visualization.
  `}},formatString:{name:"Format string",getHelperDocs:function(){return`
Use this transformation to customize the output of a string field. This transformation has the following fields:

- **Upper case** - Formats the entire string in uppercase characters.
- **Lower case** - Formats the entire string in lowercase characters.
- **Sentence case** - Formats the first character of the string in uppercase.
- **Title case** - Formats the first character of each word in the string in uppercase.
- **Pascal case** - Formats the first character of each word in the string in uppercase and doesn't include spaces between words.
- **Camel case** - Formats the first character of each word in the string in uppercase, except the first word, and doesn't include spaces between words.
- **Snake case** - Formats all characters in the string in lowercase and uses underscores instead of spaces between words.
- **Kebab case** - Formats all characters in the string in lowercase and uses dashes instead of spaces between words.
- **Trim** - Removes all leading and trailing spaces from the string.
- **Substring** - Returns a substring of the string, using the specified start and end positions.

This transformation provides a convenient way to standardize and tailor the presentation of string data for better visualization and analysis.`}},formatTime:{name:"Format time",getHelperDocs:function(){return`
Use this transformation to customize the output of a time field. Output can be formatted using [Moment.js format strings](https://momentjs.com/docs/#/displaying/). For example, if you want to display only the year of a time field, the format string 'YYYY' can be used to show the calendar year (for example, 1999 or 2012).

**Before Transformation:**

| Timestamp           | Event        |
| ------------------- | ------------ |
| 1636678740000000000 | System Start |
| 1636678680000000000 | User Login   |
| 1636678620000000000 | Data Updated |

**After applying 'YYYY-MM-DD HH:mm:ss':**

| Timestamp           | Event        |
| ------------------- | ------------ |
| 2021-11-12 14:25:40 | System Start |
| 2021-11-12 14:24:40 | User Login   |
| 2021-11-12 14:23:40 | Data Updated |

This transformation lets you tailor the time representation in your visualizations, providing flexibility and precision in displaying temporal data.

> **Note:** This transformation is available in Grafana 10.1+ as an alpha feature.
  `}},groupBy:{name:"Group by",getHelperDocs:function(){return`
Use this transformation to group the data by a specified field (column) value and process calculations on each group. Click to see a list of calculation choices. For information about available calculations, refer to [Calculation types][].

Here's an example of original data.

| Time                | Server ID | CPU Temperature | Server Status |
| ------------------- | --------- | --------------- | ------------- |
| 2020-07-07 11:34:20 | server 1  | 80              | Shutdown      |
| 2020-07-07 11:34:20 | server 3  | 62              | OK            |
| 2020-07-07 10:32:20 | server 2  | 90              | Overload      |
| 2020-07-07 10:31:22 | server 3  | 55              | OK            |
| 2020-07-07 09:30:57 | server 3  | 62              | Rebooting     |
| 2020-07-07 09:30:05 | server 2  | 88              | OK            |
| 2020-07-07 09:28:06 | server 1  | 80              | OK            |
| 2020-07-07 09:25:05 | server 2  | 88              | OK            |
| 2020-07-07 09:23:07 | server 1  | 86              | OK            |

This transformation goes in two steps. First you specify one or multiple fields to group the data by. This will group all the same values of those fields together, as if you sorted them. For instance if we group by the Server ID field, then it would group the data this way:

| Time                | Server ID      | CPU Temperature | Server Status |
| ------------------- | -------------- | --------------- | ------------- |
| 2020-07-07 11:34:20 | **server 1**   | 80              | Shutdown      |
| 2020-07-07 09:28:06 | **server 1**   | 80              | OK            |
| 2020-07-07 09:23:07 | **server 1**   | 86              | OK            |
| 2020-07-07 10:32:20 | server 2       | 90              | Overload      |
| 2020-07-07 09:30:05 | server 2       | 88              | OK            |
| 2020-07-07 09:25:05 | server 2       | 88              | OK            |
| 2020-07-07 11:34:20 | **_server 3_** | 62              | OK            |
| 2020-07-07 10:31:22 | **_server 3_** | 55              | OK            |
| 2020-07-07 09:30:57 | **_server 3_** | 62              | Rebooting     |

All rows with the same value of Server ID are grouped together.

After choosing which field you want to group your data by, you can add various calculations on the other fields, and apply the calculation to each group of rows. For instance, we could want to calculate the average CPU temperature for each of those servers. So we can add the _mean_ calculation applied on the CPU Temperature field to get the following:

| Server ID | CPU Temperature (mean) |
| --------- | ---------------------- |
| server 1  | 82                     |
| server 2  | 88.6                   |
| server 3  | 59.6                   |

And we can add more than one calculation. For instance:

- For field Time, we can calculate the _Last_ value, to know when the last data point was received for each server
- For field Server Status, we can calculate the _Last_ value to know what is the last state value for each server
- For field Temperature, we can also calculate the _Last_ value to know what is the latest monitored temperature for each server

We would then get:

| Server ID | CPU Temperature (mean) | CPU Temperature (last) | Time (last)         | Server Status (last) |
| --------- | ---------------------- | ---------------------- | ------------------- | -------------------- |
| server 1  | 82                     | 80                     | 2020-07-07 11:34:20 | Shutdown             |
| server 2  | 88.6                   | 90                     | 2020-07-07 10:32:20 | Overload             |
| server 3  | 59.6                   | 62                     | 2020-07-07 11:34:20 | OK                   |

This transformation allows you to extract essential information from your time series and present it conveniently.
  `},links:[{title:"Calculation types",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/calculation-types/"}]},groupingToMatrix:{name:"Grouping to matrix",getHelperDocs:function(){return`
Use this transformation to combine three fields\u2014which are used as input for the **Column**, **Row**, and **Cell value** fields from the query output\u2014and generate a matrix. The matrix is calculated as follows:

**Original data**

| Server ID | CPU Temperature | Server Status |
| --------- | --------------- | ------------- |
| server 1  | 82              | OK            |
| server 2  | 88.6            | OK            |
| server 3  | 59.6            | Shutdown      |

We can generate a matrix using the values of 'Server Status' as column names, the 'Server ID' values as row names, and the 'CPU Temperature' as content of each cell. The content of each cell will appear for the existing column ('Server Status') and row combination ('Server ID'). For the rest of the cells, you can select which value to display between: **Null**, **True**, **False**, or **Empty**.

**Output**

| Server IDServer Status | OK   | Shutdown |
| ----------------------- | ---- | -------- |
| server 1                | 82   |          |
| server 2                | 88.6 |          |
| server 3                |      | 59.6     |

Use this transformation to construct a matrix by specifying fields from your query results. The matrix output reflects the relationships between the unique values in these fields. This helps you present complex relationships in a clear and structured matrix format.
  `}},groupToNestedTable:{name:"Group to nested tables",getHelperDocs:function(r="shortcodeFigure"){return`
  Use this transformation to group the data by a specified field (column) value and process calculations on each group. Records are generated that share the same grouped field value, to be displayed in a nested table.
    
  To calculate a statistic for a field, click the selection box next to it and select the **Calculate** option:

  ${s("/static/img/docs/transformations/nested-table-select-calculation.png",r,"A select box showing the Group and Calculate options for the transformation.")}

  Once **Calculate** has been selected, another selection box will appear next to the respective field which will allow statistics to be selected:

  ${s("/static/img/docs/transformations/nested-table-select-stat.png",r,"A select box showing available statistic calculations once the calculate option for the field has been selected.")}

  For information about available calculations, refer to [Calculation types][].

  Here's an example of original data:

  | Time                | Server ID | CPU Temperature | Server Status |
  | ------------------- | --------- | --------------- | ------------- |
  | 2020-07-07 11:34:20 | server 1  | 80              | Shutdown      |
  | 2020-07-07 11:34:20 | server 3  | 62              | OK            |
  | 2020-07-07 10:32:20 | server 2  | 90              | Overload      |
  | 2020-07-07 10:31:22 | server 3  | 55              | OK            |
  | 2020-07-07 09:30:57 | server 3  | 62              | Rebooting     |
  | 2020-07-07 09:30:05 | server 2  | 88              | OK            |
  | 2020-07-07 09:28:06 | server 1  | 80              | OK            |
  | 2020-07-07 09:25:05 | server 2  | 88              | OK            |
  | 2020-07-07 09:23:07 | server 1  | 86              | OK            |

  This transformation has two steps. First, specify one or more fields by which to group the data. This groups all the same values of those fields together, as if you sorted them. For instance, if you group by the Server ID field, Grafana groups the data this way:

  | Server ID      |  |
  | -------------- | ------------- |
  | server 1 | <table><th><tr><td>Time</td><td>CPU Temperature</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 11:34:20</td><td>80</td><td>Shutdown</td></tr><tr><td>2020-07-07 09:28:06</td><td>80</td><td>OK</td></tr><tr><td>2020-07-07 09:23:07</td><td>86</td><td>OK</td></tr></tbody></table> |
  | server 2 | <table><th><tr><td>Time</td><td>CPU Temperature</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 10:32:20</td><td>90</td><td>Overload</td></tr><tr><td>2020-07-07 09:30:05</td><td>88</td><td>OK</td></tr><tr><td>2020-07-07 09:25:05</td><td>88</td><td>OK</td></tr></tbody></table> |
  | server 3 | <table><th><tr><td>Time</td><td>CPU Temperature</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 11:34:20</td><td>62</td><td>OK</td></tr><tr><td>2020-07-07 10:31:22</td><td>55</td><td>OK</td></tr><tr><td>2020-07-07 09:30:57</td><td>62</td><td>Rebooting</td></tr></tbody></table> |

  After choosing the field by which you want to group your data, you can add various calculations on the other fields and apply the calculation to each group of rows. For instance, you might want to calculate the average CPU temperature for each of those servers. To do so, add the **mean calculation** applied on the CPU Temperature field to get the following result:

  | Server ID      | CPU Temperatute (mean) | |
  | -------------- | ------------- | ------------- |
  | server 1 | 82 | <table><th><tr><td>Time</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 11:34:20</td><td>Shutdown</td></tr><tr><td>2020-07-07 09:28:06</td><td>OK</td></tr><tr><td>2020-07-07 09:23:07</td><td>OK</td></tr></tbody></table> |
  | server 2 | 88.6 | <table><th><tr><td>Time</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 10:32:20</td><td>Overload</td></tr><tr><td>2020-07-07 09:30:05</td><td>OK</td></tr><tr><td>2020-07-07 09:25:05</td><td>OK</td></tr></tbody></table> |
  | server 3 | 59.6 | <table><th><tr><td>Time</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 11:34:20</td><td>OK</td></tr><tr><td>2020-07-07 10:31:22</td><td>OK</td></tr><tr><td>2020-07-07 09:30:57</td><td>Rebooting</td></tr></tbody></table> |
      `},links:[{title:"Calculation types",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/calculation-types/"}]},heatmap:{name:"Create heatmap",getHelperDocs:function(){return`
Use this transformation to prepare histogram data for visualizing trends over time. Similar to the heatmap visualization, this transformation converts histogram metrics into temporal buckets.

#### X Bucket

This setting determines how the x-axis is split into buckets.

- **Size** - Specify a time interval in the input field. For example, a time range of '1h' creates cells one hour wide on the x-axis.
- **Count** - For non-time-related series, use this option to define the number of elements in a bucket.

#### Y Bucket

This setting determines how the y-axis is split into buckets.

- **Linear**
- **Logarithmic** - Choose between log base 2 or log base 10.
- **Symlog** - Uses a symmetrical logarithmic scale. Choose between log base 2 or log base 10, allowing for negative values.

Assume you have the following dataset:

| Timestamp           | Value |
|-------------------- |-------|
| 2023-01-01 12:00:00 | 5     |
| 2023-01-01 12:15:00 | 10    |
| 2023-01-01 12:30:00 | 15    |
| 2023-01-01 12:45:00 | 8     |

- With X Bucket set to 'Size: 15m' and Y Bucket as 'Linear', the histogram organizes values into time intervals of 15 minutes on the x-axis and linearly on the y-axis.
- For X Bucket as 'Count: 2' and Y Bucket as 'Logarithmic (base 10)', the histogram groups values into buckets of two on the x-axis and use a logarithmic scale on the y-axis.
  `}},histogram:{name:"Histogram",getHelperDocs:function(){return`
Use this transformation to generate a histogram based on input data, allowing you to visualize the distribution of values.

- **Bucket size** - The range between the lowest and highest items in a bucket (xMin to xMax).
- **Bucket offset** - The offset for non-zero-based buckets.
- **Combine series** - Create a unified histogram using all available series.

**Original data**

Series 1:

| A | B | C |
| - | - | - |
| 1 | 3 | 5 |
| 2 | 4 | 6 |
| 3 | 5 | 7 |
| 4 | 6 | 8 |
| 5 | 7 | 9 |

Series 2:

| C |
| - |
| 5 |
| 6 |
| 7 |
| 8 |
| 9 |

**Output**

| xMin | xMax | A | B | C | C |
| ---- | ---- | --| --| --| --|
| 1    | 2    | 1 | 0 | 0 | 0 |
| 2    | 3    | 1 | 0 | 0 | 0 |
| 3    | 4    | 1 | 1 | 0 | 0 |
| 4    | 5    | 1 | 1 | 0 | 0 |
| 5    | 6    | 1 | 1 | 1 | 1 |
| 6    | 7    | 0 | 1 | 1 | 1 |
| 7    | 8    | 0 | 1 | 1 | 1 |
| 8    | 9    | 0 | 0 | 1 | 1 |
| 9    | 10   | 0 | 0 | 1 | 1 |

Visualize the distribution of values using the generated histogram, providing insights into the data's spread and density.
  `}},joinByField:{name:"Join by field",getHelperDocs:function(r="shortcodeFigure"){return`
Use this transformation to merge multiple results into a single table, enabling the consolidation of data from different queries.

This is especially useful for converting multiple time series results into a single wide table with a shared time field.

#### Inner join (for Time Series or SQL-like data)

An inner join merges data from multiple tables where all tables share the same value from the selected field. This type of join excludes data where values do not match in every result.

Use this transformation to combine the results from multiple queries (combining on a passed join field or the first time column) into one result, and drop rows where a successful join cannot occur. This is not optimized for large Time Series datasets.

In the following example, two queries return Time Series data. It is visualized as two separate tables before applying the inner join transformation.

**Query A:**

| Time                | Job     | Uptime    |
| ------------------- | ------- | --------- |
| 2020-07-07 11:34:20 | node    | 25260122  |
| 2020-07-07 11:24:20 | postgre | 123001233 |
| 2020-07-07 11:14:20 | postgre | 345001233 |

**Query B:**

| Time                | Server   | Errors |
| ------------------- | -------- | ------ |
| 2020-07-07 11:34:20 | server 1 | 15     |
| 2020-07-07 11:24:20 | server 2 | 5      |
| 2020-07-07 11:04:20 | server 3 | 10     |

The result after applying the inner join transformation looks like the following:

| Time                | Job     | Uptime    | Server   | Errors |
| ------------------- | ------- | --------- | -------- | ------ |
| 2020-07-07 11:34:20 | node    | 25260122  | server 1 | 15     |
| 2020-07-07 11:24:20 | postgre | 123001233 | server 2 | 5      |

This works in the same way for non-Time Series tabular data as well.

**Students**

| StudentID | Name     | Major            |
| --------- | -------- | ---------------- |
| 1         | John     | Computer Science |
| 2         | Emily    | Mathematics      |
| 3         | Michael  | Physics          |
| 4         | Jennifer | Chemistry        |

**Enrollments**

| StudentID | CourseID | Grade |
|-----------|----------|-------|
| 1         | CS101    | A     |
| 1         | CS102    | B     |
| 2         | MATH201  | A     |
| 3         | PHYS101  | B     |
| 5         | HIST101  | B     |

The result after applying the inner join transformation looks like the following:

| StudentID | Name    | Major            | CourseID | Grade |
| --------- | ------- | ---------------- | -------  | ----- |
| 1         | John    | Computer Science | CS101    | A     |
| 1         | John    | Computer Science | CS102    | B     |
| 2         | Emily   | Mathematics      | MATH201  | A     |
| 3         | Michael | Physics          | PHYS101  | B     |

The inner join only includes rows where there is a match between the "StudentID" in both tables. In this case, the result does not include "Jennifer" from the "Students" table because there are no matching enrollments for her in the "Enrollments" table.

#### Outer join (for Time Series data)

An outer join includes all data from an inner join and rows where values do not match in every input. While the inner join joins Query A and Query B on the time field, the outer join includes all rows that don't match on the time field.

In the following example, two queries return table data. It is visualized as two tables before applying the outer join transformation.

**Query A:**

| Time                | Job     | Uptime    |
| ------------------- | ------- | --------- |
| 2020-07-07 11:34:20 | node    | 25260122  |
| 2020-07-07 11:24:20 | postgre | 123001233 |
| 2020-07-07 11:14:20 | postgre | 345001233 |

**Query B:**

| Time                | Server   | Errors |
| ------------------- | -------- | ------ |
| 2020-07-07 11:34:20 | server 1 | 15     |
| 2020-07-07 11:24:20 | server 2 | 5      |
| 2020-07-07 11:04:20 | server 3 | 10     |

The result after applying the outer join transformation looks like the following:

| Time                | Job     | Uptime    | Server   | Errors |
| ------------------- | ------- | --------- | -------- | ------ |
| 2020-07-07 11:04:20 |         |           | server 3 | 10     |
| 2020-07-07 11:14:20 | postgre | 345001233 |          |        |
| 2020-07-07 11:34:20 | node    | 25260122  | server 1 | 15     |
| 2020-07-07 11:24:20 | postgre | 123001233 | server 2 | 5      |

In the following example, a template query displays time series data from multiple servers in a table visualization. The results of only one query can be viewed at a time.

${s("/static/img/docs/transformations/join-fields-before-7-0.png",r,"A table visualization showing results for one server")}

I applied a transformation to join the query results using the time field. Now I can run calculations, combine, and organize the results in this new table.

${s("/static/img/docs/transformations/join-fields-after-7-0.png",r,"A table visualization showing results for multiple servers")}

#### Outer join (for SQL-like data)

A tabular outer join combining tables so that the result includes matched and unmatched rows from either or both tables.

| StudentID | Name      | Major            |
| --------- | --------- | ---------------- |
| 1         | John      | Computer Science |
| 2         | Emily     | Mathematics      |
| 3         | Michael   | Physics          |
| 4         | Jennifer  | Chemistry        |

Can now be joined with:

| StudentID | CourseID | Grade |
| --------- | -------- | ----- |
| 1         | CS101    | A     |
| 1         | CS102    | B     |
| 2         | MATH201  | A     |
| 3         | PHYS101  | B     |
| 5         | HIST101  | B     |

The result after applying the outer join transformation looks like the following:

| StudentID | Name     | Major            | CourseID | Grade |
| --------- | -------- | ---------------- | -------- | ----- |
| 1         | John     | Computer Science | CS101    | A     |
| 1         | John     | Computer Science | CS102    | B     |
| 2         | Emily    | Mathematics      | MATH201  | A     |
| 3         | Michael  | Physics          | PHYS101  | B     |
| 4         | Jennifer | Chemistry        | NULL     | NULL  |
| 5         | NULL     | NULL             | HIST101  | B     |

Combine and analyze data from various queries with table joining for a comprehensive view of your information.
  `}},joinByLabels:{name:"Join by labels",getHelperDocs:function(){return`
Use this transformation to join multiple results into a single table.

This is especially useful for converting multiple time series results into a single wide table with a shared **Label** field.

- **Join** - Select the label to join by between the labels available or common across all time series.
- **Value** - The name for the output result.

#### Example

##### Input

series1{what="Temp", cluster="A", job="J1"}

| Time | Value |
| ---- | ----- |
| 1    | 10    |
| 2    | 200   |

series2{what="Temp", cluster="B", job="J1"}

| Time | Value |
| ---- | ----- |
| 1    | 10    |
| 2    | 200   |

series3{what="Speed", cluster="B", job="J1"}

| Time | Value |
| ---- | ----- |
| 22   | 22    |
| 28   | 77    |

##### Config

value: "what"

##### Output

| cluster | job | Temp | Speed |
| ------- | --- | ---- | ----- |
| A       | J1  | 10   |       |
| A       | J1  | 200  |       |
| B       | J1  | 10   | 22    |
| B       | J1  | 200  | 77    |

Combine and organize time series data effectively with this transformation for comprehensive insights.
  `}},labelsToFields:{name:"Labels to fields",getHelperDocs:function(){return`
Use this transformation to convert time series results with labels or tags into a table, including each label's keys and values in the result. Display labels as either columns or row values for enhanced data visualization.

Given a query result of two time series:

- Series 1: labels Server=Server A, Datacenter=EU
- Series 2: labels Server=Server B, Datacenter=EU

In "Columns" mode, the result looks like this:

| Time                | Server   | Datacenter | Value |
| ------------------- | -------- | ---------- | ----- |
| 2020-07-07 11:34:20 | Server A | EU         | 1     |
| 2020-07-07 11:34:20 | Server B | EU         | 2     |

In "Rows" mode, the result has a table for each series and show each label value like this:

| label      | value    |
| ---------- | -------- |
| Server     | Server A |
| Datacenter | EU       |

| label      | value    |
| ---------- | -------- |
| Server     | Server B |
| Datacenter | EU       |

#### Value field name

If you selected Server as the **Value field name**, then you would get one field for every value of the Server label.

| Time                | Datacenter | Server A | Server B |
| ------------------- | ---------- | -------- | -------- |
| 2020-07-07 11:34:20 | EU         | 1        | 2        |

#### Merging behavior

The labels to fields transformer is internally two separate transformations. The first acts on single series and extracts labels to fields. The second is the [merge](#merge) transformation that joins all the results into a single table. The merge transformation tries to join on all matching fields. This merge step is required and cannot be turned off.

To illustrate this, here is an example where you have two queries that return time series with no overlapping labels.

- Series 1: labels Server=ServerA
- Series 2: labels Datacenter=EU

This will first result in these two tables:

| Time                | Server  | Value |
| ------------------- | ------- | ----- |
| 2020-07-07 11:34:20 | ServerA | 10    |

| Time                | Datacenter | Value |
| ------------------- | ---------- | ----- |
| 2020-07-07 11:34:20 | EU         | 20    |

After merge:

| Time                | Server  | Value | Datacenter |
| ------------------- | ------- | ----- | ---------- |
| 2020-07-07 11:34:20 | ServerA | 10    |            |
| 2020-07-07 11:34:20 |         | 20    | EU         |

Convert your time series data into a structured table format for a clearer and more organized representation.
  `}},limit:{name:"Limit",getHelperDocs:function(){return`
Use this transformation to restrict the number of rows displayed, providing a more focused view of your data. This is particularly useful when dealing with large datasets.

Below is an example illustrating the impact of the **Limit** transformation on a response from a data source:

| Time                | Metric      | Value |
| ------------------- | ----------- | ----- |
| 2020-07-07 11:34:20 | Temperature | 25    |
| 2020-07-07 11:34:20 | Humidity    | 22    |
| 2020-07-07 10:32:20 | Humidity    | 29    |
| 2020-07-07 10:31:22 | Temperature | 22    |
| 2020-07-07 09:30:57 | Humidity    | 33    |
| 2020-07-07 09:30:05 | Temperature | 19    |

Here is the result after adding a Limit transformation with a value of '3':

| Time                | Metric      | Value |
| ------------------- | ----------- | ----- |
| 2020-07-07 11:34:20 | Temperature | 25    |
| 2020-07-07 11:34:20 | Humidity    | 22    |
| 2020-07-07 10:32:20 | Humidity    | 29    |

This transformation helps you tailor the visual presentation of your data to focus on the most relevant information.
  `}},merge:{name:"Merge series/tables",getHelperDocs:function(){return`
Use this transformation to combine the results from multiple queries into a single result, which is particularly useful when using the table panel visualization. This transformation merges values into the same row if the shared fields contain the same data.

Here's an example illustrating the impact of the **Merge series/tables** transformation on two queries returning table data:

**Query A:**

| Time                | Job     | Uptime    |
| ------------------- | ------- | --------- |
| 2020-07-07 11:34:20 | node    | 25260122  |
| 2020-07-07 11:24:20 | postgre | 123001233 |

**Query B:**

| Time                | Job     | Errors |
| ------------------- | ------- | ------ |
| 2020-07-07 11:34:20 | node    | 15     |
| 2020-07-07 11:24:20 | postgre | 5      |

Here is the result after applying the Merge transformation.

| Time                | Job     | Errors | Uptime    |
| ------------------- | ------- | ------ | --------- |
| 2020-07-07 11:34:20 | node    | 15     | 25260122  |
| 2020-07-07 11:24:20 | postgre | 5      | 123001233 |

This transformation combines values from Query A and Query B into a unified table, enhancing the presentation of data for better insights.
  `},links:[{title:"Table panel",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/table/"}]},organize:{name:"Organize fields by name",getHelperDocs:function(){return`
Use this transformation to provide the flexibility to rename, reorder, or hide fields returned by a single query in your panel. This transformation is applicable only to panels with a single query. If your panel has multiple queries, consider using an "Outer join" transformation or removing extra queries.

#### Transforming fields

Grafana displays a list of fields returned by the query, allowing you to perform the following actions:

- **Change field order** - Hover over a field, and when your cursor turns into a hand, drag the field to its new position.
- **Hide or show a field** - Use the eye icon next to the field name to toggle the visibility of a specific field.
- **Rename fields** - Type a new name in the "Rename <field>" box to customize field names.

#### Example:

##### Original Query Result

| Time                | Metric      | Value |
| ------------------- | ----------- | ----- |
| 2020-07-07 11:34:20 | Temperature | 25    |
| 2020-07-07 11:34:20 | Humidity    | 22    |
| 2020-07-07 10:32:20 | Humidity    | 29    |

##### After Applying Field Overrides

| Time                | Sensor      | Reading |
| ------------------- | ----------- | ------- |
| 2020-07-07 11:34:20 | Temperature | 25      |
| 2020-07-07 11:34:20 | Humidity    | 22      |
| 2020-07-07 10:32:20 | Humidity    | 29      |

This transformation lets you to tailor the display of query results, ensuring a clear and insightful representation of your data in Grafana.
  `}},partitionByValues:{name:"Partition by values",getHelperDocs:function(){return`
Use this transformation to streamline the process of graphing multiple series without the need for multiple queries with different 'WHERE' clauses.

This is particularly useful when dealing with a metrics SQL table, as illustrated below:

| Time                | Region | Value |
| ------------------- | ------ | ----- |
| 2022-10-20 12:00:00 | US     | 1520  |
| 2022-10-20 12:00:00 | EU     | 2936  |
| 2022-10-20 01:00:00 | US     | 1327  |
| 2022-10-20 01:00:00 | EU     | 912   |

With the **Partition by values** transformation, you can issue a single query and split the results by unique values in one or more columns (fields) of your choosing. The following example uses 'Region':

'SELECT Time, Region, Value FROM metrics WHERE Time > "2022-10-20"'

| Time                | Region | Value |
| ------------------- | ------ | ----- |
| 2022-10-20 12:00:00 | US     | 1520  |
| 2022-10-20 01:00:00 | US     | 1327  |

| Time                | Region | Value |
| ------------------- | ------ | ----- |
| 2022-10-20 12:00:00 | EU     | 2936  |
| 2022-10-20 01:00:00 | EU     | 912   |

This transformation simplifies the process and enhances the flexibility of visualizing multiple series within the same time series visualization.
  `}},prepareTimeSeries:{name:"Prepare time series",getHelperDocs:function(){return`
Use this transformation to address issues when a data source returns time series data in a format that isn't compatible with the desired visualization. This transformation allows you to convert time series data between wide and long formats, providing flexibility in data frame structures.

#### Available options

##### Multi-frame time series

Use this option to transform the time series data frame from the wide format to the long format. This is particularly helpful when your data source delivers time series information in a format that needs to be reshaped for optimal compatibility with your visualization.

**Example: Converting from wide to long format**

| Timestamp           | Value1 | Value2 |
|---------------------|--------|--------|
| 2023-01-01 00:00:00 | 10     | 20     |
| 2023-01-01 01:00:00 | 15     | 25     |

**Transformed to:**

| Timestamp           | Variable | Value |
|---------------------|----------|-------|
| 2023-01-01 00:00:00 | Value1   | 10    |
| 2023-01-01 00:00:00 | Value2   | 20    |
| 2023-01-01 01:00:00 | Value1   | 15    |
| 2023-01-01 01:00:00 | Value2   | 25    |


##### Wide time series

Select this option to transform the time series data frame from the long format to the wide format. If your data source returns time series data in a long format and your visualization requires a wide format, this transformation simplifies the process.

**Example: Converting from long to wide format**

| Timestamp           | Variable | Value |
|---------------------|----------|-------|
| 2023-01-01 00:00:00 | Value1   | 10    |
| 2023-01-01 00:00:00 | Value2   | 20    |
| 2023-01-01 01:00:00 | Value1   | 15    |
| 2023-01-01 01:00:00 | Value2   | 25    |

**Transformed to:**

| Timestamp           | Value1 | Value2 |
|---------------------|--------|--------|
| 2023-01-01 00:00:00 | 10     | 20     |
| 2023-01-01 01:00:00 | 15     | 25     |

> **Note:** This transformation is available in Grafana 7.5.10+ and Grafana 8.0.6+.
  `},links:[{title:"Data frames",url:"https://grafana.com/docs/grafana/latest/developers/plugins/introduction-to-plugin-development/data-frames/"}]},reduce:{name:"Reduce",getHelperDocs:function(){return`
Use this transformation to apply a calculation to each field in the data frame and return a single value. This transformation is particularly useful for consolidating multiple time series data into a more compact, summarized format. Time fields are removed when applying this transformation.

Consider the input:

**Query A:**

| Time                | Temp | Uptime  |
| ------------------- | ---- | ------- |
| 2020-07-07 11:34:20 | 12.3 | 256122  |
| 2020-07-07 11:24:20 | 15.4 | 1230233 |

**Query B:**

| Time                | AQI | Errors |
| ------------------- | --- | ------ |
| 2020-07-07 11:34:20 | 6.5 | 15     |
| 2020-07-07 11:24:20 | 3.2 | 5      |

The reduce transformer has two modes:

- **Series to rows** - Creates a row for each field and a column for each calculation.
- **Reduce fields** - Keeps the existing frame structure, but collapses each field into a single value.

For example, if you used the **First** and **Last** calculation with a **Series to rows** transformation, then
the result would be:

| Field  | First  | Last    |
| ------ | ------ | ------- |
| Temp   | 12.3   | 15.4    |
| Uptime | 256122 | 1230233 |
| AQI    | 6.5    | 3.2     |
| Errors | 15     | 5       |

The **Reduce fields** with the **Last** calculation,
results in two frames, each with one row:

**Query A:**

| Temp | Uptime  |
| ---- | ------- |
| 15.4 | 1230233 |

**Query B:**

| AQI | Errors |
| --- | ------ |
| 3.2 | 5      |

This flexible transformation simplifies the process of consolidating and summarizing data from multiple time series into a more manageable and organized format.
  `}},renameByRegex:{name:"Rename by regex",getHelperDocs:function(r="shortcodeFigure"){return`
Use this transformation to rename parts of the query results using a regular expression and replacement pattern.

You can specify a regular expression, which is only applied to matches, along with a replacement pattern that support back references. For example, let's imagine you're visualizing CPU usage per host and you want to remove the domain name. You could set the regex to '/^([^.]+).*/' and the replacement pattern to '$1', 'web-01.example.com' would become 'web-01'.

> **Note:** The Rename by regex transformation was improved in Grafana v9.0.0 to allow global patterns of the form '/<stringToReplace>/g'. Depending on the regex match used, this may cause some transformations to behave slightly differently. You can guarantee the same behavior as before by wrapping the match string in forward slashes '(/)', e.g. '(.*)' would become '/(.*)/'.

In the following example, we are stripping the 'A-' prefix from field names. In the before image, you can see everything is prefixed with 'A-':

${s("/media/docs/grafana/panels-visualizations/screenshot-rename-by-regex-before-v11.0.png",r,"A time series with full series names")}

With the transformation applied, you can see we are left with just the remainder of the string.

${s("/media/docs/grafana/panels-visualizations/screenshot-rename-by-regex-after-v11.0.png",r,"A time series with shortened series names")}

This transformation lets you to tailor your data to meet your visualization needs, making your dashboards more informative and user-friendly.
  `}},rowsToFields:{name:"Rows to fields",getHelperDocs:function(){return`
Use this transformation to convert rows into separate fields. This can be useful because fields can be styled and configured individually. It can also use additional fields as sources for dynamic field configuration or map them to field labels. The additional labels can then be used to define better display names for the resulting fields.

This transformation includes a field table which lists all fields in the data returned by the configuration query. This table gives you control over what field should be mapped to each configuration property (the **Use as** option). You can also choose which value to select if there are multiple rows in the returned data.

This transformation requires:

- One field to use as the source of field names.

  By default, the transform uses the first string field as the source. You can override this default setting by selecting **Field name** in the **Use as** column for the field you want to use instead.

- One field to use as the source of values.

  By default, the transform uses the first number field as the source. But you can override this default setting by selecting **Field value** in the **Use as** column for the field you want to use instead.

Useful when visualizing data in:

- Gauge
- Stat
- Pie chart

#### Map extra fields to labels

If a field does not map to config property Grafana will automatically use it as source for a label on the output field-

**Example:**

| Name    | DataCenter | Value |
| ------- | ---------- | ----- |
| ServerA | US         | 100   |
| ServerB | EU         | 200   |

**Output:**

| ServerA (labels: DataCenter: US) | ServerB (labels: DataCenter: EU) |
| -------------------------------- | -------------------------------- |
| 10                               | 20                               |

The extra labels can now be used in the field display name provide more complete field names.

If you want to extract config from one query and apply it to another you should use the config from query results transformation.

#### Example

**Input:**

| Name    | Value | Max |
| ------- | ----- | --- |
| ServerA | 10    | 100 |
| ServerB | 20    | 200 |
| ServerC | 30    | 300 |

**Output:**

| ServerA (config: max=100) | ServerB (config: max=200) | ServerC (config: max=300) |
| ------------------------- | ------------------------- | ------------------------- |
| 10                        | 20                        | 30                        |

As you can see each row in the source data becomes a separate field. Each field now also has a max config option set. Options like **Min**, **Max**, **Unit** and **Thresholds** are all part of field configuration and if set like this will be used by the visualization instead of any options manually configured in the panel editor options pane.

This transformation enables the conversion of rows into individual fields, facilitates dynamic field configuration, and maps additional fields to labels.
  `}},seriesToRows:{name:"Series to rows",getHelperDocs:function(){return`
Use this transformation to combine the result from multiple time series data queries into one single result. This is helpful when using the table panel visualization.

The result from this transformation will contain three columns: Time, Metric, and Value. The Metric column is added so you easily can see from which query the metric originates from. Customize this value by defining Label on the source query.

In the example below, we have two queries returning time series data. It is visualized as two separate tables before applying the transformation.

**Query A:**

| Time                | Temperature |
| ------------------- | ----------- |
| 2020-07-07 11:34:20 | 25          |
| 2020-07-07 10:31:22 | 22          |
| 2020-07-07 09:30:05 | 19          |

**Query B:**

| Time                | Humidity |
| ------------------- | -------- |
| 2020-07-07 11:34:20 | 24       |
| 2020-07-07 10:32:20 | 29       |
| 2020-07-07 09:30:57 | 33       |

Here is the result after applying the Series to rows transformation.

| Time                | Metric      | Value |
| ------------------- | ----------- | ----- |
| 2020-07-07 11:34:20 | Temperature | 25    |
| 2020-07-07 11:34:20 | Humidity    | 22    |
| 2020-07-07 10:32:20 | Humidity    | 29    |
| 2020-07-07 10:31:22 | Temperature | 22    |
| 2020-07-07 09:30:57 | Humidity    | 33    |
| 2020-07-07 09:30:05 | Temperature | 19    |

This transformation facilitates the consolidation of results from multiple time series queries, providing a streamlined and unified dataset for efficient analysis and visualization in a tabular format.

> **Note:** This transformation is available in Grafana 7.1+.
  `}},sortBy:{name:"Sort by",getHelperDocs:function(){return`
Use this transformation to sort each frame within a query result based on a specified field, making your data easier to understand and analyze. By configuring the desired field for sorting, you can control the order in which the data is presented in the table or visualization.

Use the **Reverse** switch to inversely order the values within the specified field. This functionality is particularly useful when you want to quickly toggle between ascending and descending order to suit your analytical needs.

For example, in a scenario where time-series data is retrieved from a data source, the **Sort by** transformation can be applied to arrange the data frames based on the timestamp, either in ascending or descending order, depending on the analytical requirements. This capability ensures that you can easily navigate and interpret time-series data, gaining valuable insights from the organized and visually coherent presentation.
  `}},spatial:{name:"Spatial",getHelperDocs:function(){return`
Use this transformation to apply spatial operations to query results.

- **Action** - Select an action:
  - **Prepare spatial field** - Set a geometry field based on the results of other fields.
    - **Location mode** - Select a location mode (these options are shared by the **Calculate value** and **Transform** modes):
      - **Auto** - Automatically identify location data based on default field names.
      - **Coords** - Specify latitude and longitude fields.
      - **Geohash** - Specify a geohash field.
      - **Lookup** - Specify Gazetteer location fields.
  - **Calculate value** - Use the geometry to define a new field (heading/distance/area).
    - **Function** - Choose a mathematical operation to apply to the geometry:
      - **Heading** - Calculate the heading (direction) between two points.
      - **Area** - Calculate the area enclosed by a polygon defined by the geometry.
      - **Distance** - Calculate the distance between two points.
  - **Transform** - Apply spatial operations to the geometry.
    - **Operation** - Choose an operation to apply to the geometry:
      - **As line** - Create a single line feature with a vertex at each row.
      - **Line builder** - Create a line between two points.

This transformation allows you to manipulate and analyze geospatial data, enabling operations such as creating lines between points, calculating spatial properties, and more.
  `}},timeSeriesTable:{name:"Time series to table transform",getHelperDocs:function(r="shortcodeFigure"){return`
Use this transformation to convert time series results into a table, transforming a time series data frame into a **Trend** field which can then be used with the [sparkline cell type][]. If there are multiple time series queries, each will result in a separate table data frame. These can be joined using join or merge transforms to produce a single table with multiple sparklines per row.

${s("/static/img/docs/transformations/table-sparklines.png",r,"A table panel showing multiple values and their corresponding sparklines.")}

For each generated **Trend** field value, a calculation function can be selected. This value is displayed next to the sparkline and will be used for sorting table rows.

${s("/static/img/docs/transformations/timeseries-table-select-stat.png",r,"A select box showing available statistics that can be calculated.")}


> **Note:** This transformation is available in Grafana 9.5+ as an opt-in beta feature. Modify the Grafana [configuration file][] to use it.
  `},links:[{title:"sparkline cell type",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/table/#sparkline"},{title:"configuration file",url:"https://grafana.com/docs/grafana/latest/setup-grafana/configure-grafana/"}]},transpose:{name:"Transpose",getHelperDocs:function(r="shortcodeFigure"){return`
Use this transformation to pivot the data frame, converting rows into columns and columns into rows. This transformation is particularly useful when you want to switch the orientation of your data to better suit your visualization needs.
If you have multiple types it will default to string type.

**Before Transformation:**

| env  | January   | February |
| ---- | --------- | -------- |
| prod | 1 | 2 |
| dev | 3 | 4 |

**After applying transpose transformation:**

| Field  | prod   | dev |
| ---- | --------- | -------- |
| January | 1 | 3 |
| February  | 2 | 4 |

${s("/media/docs/grafana/transformations/screenshot-grafana-11-2-transpose-transformation.png",r,"Before and after transpose transformation")}
  `}},regression:{name:"Regression analysis",getHelperDocs:function(r="shortcodeFigure"){return`
Use this transformation to create a new data frame containing values predicted by a statistical model. This is useful for finding a trend in chaotic data. It works by fitting a mathematical function to the data, using either linear or polynomial regression. The data frame can then be used in a visualization to display a trendline.

There are two different models:

- **Linear regression** - Fits a linear function to the data.
${s("/static/img/docs/transformations/linear-regression.png",r,"A time series visualization with a straight line representing the linear function")}
- **Polynomial regression** - Fits a polynomial function to the data.
${s("/static/img/docs/transformations/polynomial-regression.png",r,"A time series visualization with a curved line representing the polynomial function")}

> **Note:** This transformation is currently in public preview. Grafana Labs offers limited support, and breaking changes might occur prior to the feature being made generally available. Enable the \`regressionTransformation\` feature toggle in Grafana to use this feature. Contact Grafana Support to enable this feature in Grafana Cloud.
  `}}};function i(){return`
  Go to the <a href="https://grafana.com/docs/grafana/latest/panels/transformations/?utm_source=grafana" target="_blank" rel="noreferrer">
  transformation documentation
  </a> for more general documentation.
  `}function s(r,g,a){return g==="shortcodeFigure"?`{{< figure src="${r}" class="docs-image--no-shadow" max-width= "1100px" alt="${a}" >}}`:`![${a}](https://grafana.com${r})`}},9581:(k,R,e)=>{"use strict";e.d(R,{YD:()=>s,dy:()=>n,kD:()=>i});var t=e(52622),n=(g=>(g.Prepare="prepare",g.Calculate="calculate",g.Modify="modify",g))(n||{}),i=(g=>(g.Heading="heading",g.Distance="distance",g.Area="area",g))(i||{}),s=(g=>(g.AsLine="asLine",g.LineBuilder="lineBuilder",g))(s||{});const r={action:"prepare",source:{mode:t.aG.Auto}}},78134:(k,R,e)=>{"use strict";e.d(R,{EX:()=>h,pp:()=>d,tt:()=>c});var t=e(70915),n=e(11217),i=e(44294),s=e(22796),r=e(52490),g=e(11261),a=e(9581);function c(p){const m=[];for(const v of p.values)v&&m.push(h(v));return new n.A(m)}function o(p){const m=new Array(p.length);if(p.length>1){let v=f(p[0]);for(let l=1;l<p.length;l++){let y=f(p[l]);if(v&&y){let u=Math.atan2(y[0]-v[0],y[1]-v[1])*180/Math.PI;u<0&&(u+=360),m[l-1]=m[l]=u}}}else m.fill(0);return m}function h(p){return p instanceof i.A?p.getCoordinates():(0,t.q1)(p.getExtent())}function f(p){if(p)return(0,s.WP)(h(p))}function d(p,m){const v=p.values,l=new Array(p.values.length),y=m.calc??a.kD.Heading,u=m.field??y;switch(y){case a.kD.Area:{for(let D=0;D<v.length;D++){const E=v[D];E&&(l[D]=(0,r.UG)(E))}return{name:u,type:g.PU.number,config:{unit:"areaM2"},values:l}}case a.kD.Distance:{for(let D=0;D<v.length;D++){const E=v[D];E&&(l[D]=(0,r.R3)(E))}return{name:u,type:g.PU.number,config:{unit:"lengthm"},values:l}}case a.kD.Heading:default:return{name:u,type:g.PU.number,config:{unit:"degree"},values:o(v)}}}},88841:(k,R,e)=>{"use strict";e.d(R,{y:()=>l});var t=e(74848),n=e(32196),i=e(34743),s=e(36376),r=e(7315),g=e(96540),a=e(40845),c=e(17464),o=e(40276),h=e(72093),f=e(10354),d=e(43538);const p=(u,D)=>u-D*Math.floor(u/D),m=8,v=(u,D)=>({suggestionsWrapper:(0,n.css)({boxShadow:u.shadows.z2}),errorTooltip:(0,n.css)({position:"absolute",top:D+m+"px",zIndex:u.zIndex.tooltip}),inputWrapper:(0,n.css)({position:"relative"})}),l=({value:u="",onChange:D,suggestions:E,placeholder:x,error:P,invalid:b})=>{const[M,O]=(0,g.useState)(!1),[I,T]=(0,g.useState)(0),[C,S]=(0,g.useState)(u.toString()),[A,L]=(0,g.useState)(0),[N,F]=(0,g.useState)(0),[w,B]=(0,g.useState)(0),U=(0,a.$j)(),K=v(U,N),V=(0,g.useRef)(),H=[(0,i.UU)({fallbackAxisSideDirection:"start",crossAxis:!1,boundary:document.body}),(0,i.BN)()],{refs:Y,floatingStyles:X}=(0,s.we)({open:M,placement:"bottom-start",onOpenChange:O,middleware:H,whileElementsMounted:r.ll,strategy:"fixed"}),J=(0,g.useCallback)(le=>{Y.setReference(le),V.current=le},[Y]),q=(0,g.useRef)(null);(0,g.useEffect)(()=>{L(y(q.current,I))},[I]);const ae=g.useCallback((le,z=V.current)=>{const ee=z.selectionStart,se=z.value;se[w-1]==="$"?z.value=se.slice(0,w)+le.value+se.slice(ee):z.value=se.slice(0,w)+"$"+le.value+se.slice(ee),S(z.value),O(!1),T(0),D(z.value)},[D,w]),j=g.useCallback(le=>{if(!M){if(le.key==="$"||le.key===" "&&le.ctrlKey){B(V.current.selectionStart||0),O(!0);return}return}switch(le.key){case"Backspace":case"Escape":case"ArrowLeft":case"ArrowRight":return O(!1),T(0);case"Enter":return le.preventDefault(),ae(E[I]);case"ArrowDown":case"ArrowUp":le.preventDefault();const z=le.key==="ArrowDown"?1:-1;return T(ee=>p(ee+z,E.length));default:return}},[M,E,I,ae]),te=g.useCallback(le=>{S(le.currentTarget.value)},[]),ne=g.useCallback(le=>{D(le.currentTarget.value)},[D]);return(0,g.useEffect)(()=>{F(V.current.clientHeight)},[]),(0,t.jsxs)("div",{className:K.inputWrapper,children:[M&&(0,t.jsx)(c.ZL,{children:(0,t.jsx)("div",{ref:Y.setFloating,style:X,className:K.suggestionsWrapper,children:(0,t.jsx)(o.E,{scrollTop:A,autoHeightMax:"300px",setScrollTop:({scrollTop:le})=>L(le),children:(0,t.jsx)(d.k,{activeRef:q,suggestions:E,onSuggestionSelect:ae,onClose:()=>O(!1),activeIndex:I})})})}),b&&P&&(0,t.jsx)("div",{className:K.errorTooltip,children:(0,t.jsx)(h.P,{children:P})}),(0,t.jsx)(f.p,{placeholder:x,invalid:b,ref:J,value:C,onChange:te,onBlur:ne,onKeyDown:j})]})};l.displayName="SuggestionsInput";function y(u,D){return(u?.clientHeight??0)*D}},94397:(k,R,e)=>{"use strict";e.d(R,{N_:()=>c,ZI:()=>r,aG:()=>g,eJ:()=>a,qt:()=>o});var t=e(96540),n=e(28240),i=e(91410),s=e(32264);function r(h){return(0,t.useMemo)(()=>Array.isArray(h)?Object.keys(h.reduce((f,d)=>!d||!Array.isArray(d.fields)?f:d.fields.reduce((p,m)=>{const v=(0,n.Ct)(m,d,h);return p[v]=!0,p},f),{})):[],[h])}function g(h){const f=new Set;for(const d of h)for(const p of d.fields)if(p.labels)for(const m of Object.keys(p.labels))f.add(m);return f}const a={combine:"Combine",calculateNewFields:"Calculate new fields",createNewVisualization:"Create new visualization",filter:"Filter",performSpatialOperations:"Perform spatial operations",reformat:"Reformat",reorderAndRename:"Reorder and rename"},c=h=>!!(typeof h=="number"||!Number.isNaN(Number(h))||/^\$[A-Za-z0-9_]+$/.test(h)&&s.$.featureToggles.transformationsVariableSupport);function o(h){const f=[];h&&(f.push({label:"Browser",value:"browser"}),f.push({label:"UTC",value:"utc"}));const d=(0,i.P3)();for(const p of d)f.push({label:p,value:p});return f}},87617:(k,R,e)=>{"use strict";e.d(R,{$u:()=>f,Ay:()=>v,Cj:()=>c,EC:()=>h,Y_:()=>a,dJ:()=>d,g4:()=>o,jE:()=>p,t_:()=>r});var t=e(65307),n=e(2913);const i={users:[],searchQuery:"",page:0,perPage:30,totalPages:1,externalUserMngInfo:n.Ay.externalUserMngInfo,externalUserMngLinkName:n.Ay.externalUserMngLinkName,externalUserMngLinkUrl:n.Ay.externalUserMngLinkUrl,isLoading:!1,rolesLoading:!1},s=(0,t.Z0)({name:"users",initialState:i,reducers:{usersLoaded:(l,y)=>{const{totalCount:u,perPage:D,page:E,orgUsers:x}=y.payload,P=Math.ceil(u/D);return{...l,isLoading:!0,users:x,perPage:D,page:E,totalPages:P}},searchQueryChanged:(l,y)=>({...l,searchQuery:y.payload,page:i.page}),setUsersSearchPage:(l,y)=>({...l,page:y.payload}),pageChanged:(l,y)=>({...l,page:y.payload}),sortChanged:(l,y)=>({...l,sort:y.payload}),usersFetchBegin:l=>({...l,isLoading:!0}),usersFetchEnd:l=>({...l,isLoading:!1}),rolesFetchBegin:l=>({...l,rolesLoading:!0}),rolesFetchEnd:l=>({...l,rolesLoading:!1})}}),{searchQueryChanged:r,setUsersSearchPage:g,usersLoaded:a,usersFetchBegin:c,usersFetchEnd:o,pageChanged:h,sortChanged:f,rolesFetchBegin:d,rolesFetchEnd:p}=s.actions,v={users:s.reducer}},20601:(k,R,e)=>{"use strict";e.d(R,{B:()=>n});var t=e(83077);const n=new t.O},26260:(k,R,e)=>{"use strict";e.d(R,{$u:()=>m,D4:()=>y,Iv:()=>u,U2:()=>l,VT:()=>v,z_:()=>p});var t=e(2543),n=e.n(t),i=e(31193),s=e(3843),r=e(24240),g=e(72401),a=e(48594),c=e(87421),o=e(56968),h=e(75096),f=e(53699);const d="Filters",p=x=>async(P,b)=>{let M=E(x,b());if(!M&&(P(D(x)),M=E(x,b()),!M))return;const O=M.filters.findIndex(T=>T.key===x.key&&T.value===x.value);if(O===-1){const{value:T,key:C,operator:S}=x,A={value:T,key:C,operator:S};return await P(l((0,h.jX)(M),A))}const I={...M.filters[O],operator:x.operator};return await P(m((0,h.jX)(M),{index:O,filter:I}))},m=(x,P)=>async(b,M)=>{const O=(0,c.dn)(x,M());b((0,a.kb)(x.rootStateKey,(0,f.E2)((0,h.qD)(O,P)))),await b((0,g.us)((0,h.jX)(O),!0))},v=(x,P)=>async(b,M)=>{const O=(0,c.dn)(x,M());b((0,a.kb)(x.rootStateKey,(0,f.D$)((0,h.qD)(O,P)))),await b((0,g.us)((0,h.jX)(O),!0))},l=(x,P)=>async(b,M)=>{const O=(0,c.dn)(x,M());b((0,a.kb)(x.rootStateKey,(0,f.xt)((0,h.qD)(O,P)))),await b((0,g.us)((0,h.jX)(O),!0))},y=(x,P)=>async(b,M)=>{const O=(0,c.dn)(x,M());b((0,a.kb)(x.rootStateKey,(0,f.qZ)((0,h.qD)(O,P)))),await b((0,g.us)((0,h.jX)(O),!0))},u=(x,P)=>async(b,M)=>{const O=(0,c.dn)(x,M());b((0,a.kb)(x.rootStateKey,(0,o.QP)((0,h.qD)(O,{propName:"datasource",propValue:P}))));const T=(await(0,i.tR)().get(P))?.getTagKeys?"Ad hoc filters are applied automatically to all queries that target this data source":"This data source does not support ad hoc filters yet.";b((0,a.kb)(x.rootStateKey,(0,s.BC)({infoText:T})))},D=x=>(P,b)=>{const M=(0,c.y7)(b()),O={...(0,t.cloneDeep)(f.MK),datasource:x.datasource,name:d,id:d,rootStateKey:M},I=!1,T=(0,c.hk)(M,b()),C={type:"adhoc",id:O.id,rootStateKey:M};P((0,a.kb)(M,(0,o.QV)((0,h.qD)(C,{global:I,model:O,index:T}))))},E=(x,P)=>{const b=(0,c.y7)(P),M=(0,c.nx)(b,P);let O;for(const I of Object.values(M.variables))if((0,r.EW)(I)&&I.datasource?.uid===x.datasource.uid){O=I;break}return O}},53699:(k,R,e)=>{"use strict";e.d(R,{AA:()=>f,D$:()=>c,E2:()=>o,MK:()=>r,qZ:()=>h,xt:()=>a});var t=e(65307),n=e(80484),i=e(87421),s=e(83370);const r={...n.Vg,type:"adhoc",datasource:null,filters:[]},g=(0,t.Z0)({name:"templating/adhoc",initialState:s.j,reducers:{filterAdded:(d,p)=>{const m=(0,i.Fs)(d,p.payload.id);m.type==="adhoc"&&m.filters.push(p.payload.data)},filterRemoved:(d,p)=>{const m=(0,i.Fs)(d,p.payload.id);if(m.type!=="adhoc")return;const v=p.payload.data;m.filters.splice(v,1)},filterUpdated:(d,p)=>{const m=(0,i.Fs)(d,p.payload.id);if(m.type!=="adhoc")return;const{filter:v,index:l}=p.payload.data;m.filters[l]=v},filtersRestored:(d,p)=>{const m=(0,i.Fs)(d,p.payload.id);m.type==="adhoc"&&(m.filters=p.payload.data)}}}),{filterAdded:a,filterRemoved:c,filterUpdated:o,filtersRestored:h}=g.actions,f=g.reducer},13344:(k,R,e)=>{"use strict";e.d(R,{Ek:()=>r,To:()=>i,Zm:()=>n,ou:()=>s,qF:()=>t,qz:()=>g});const t="00000000-0000-0000-0000-000000000000",n="All",i="$__all",s="None",r="",g="var-"},35589:(k,R,e)=>{"use strict";e.d(R,{c:()=>c,z:()=>o});var t=e(74848),n=e(92145),i=e(96540),s=e(13544),r=e(40845),g=e(21744),a=e(85140);const c="Grafana-LegacyVariableQueryEditor",o=({onChange:h,query:f})=>{const d=(0,r.of)(a.$),[p,m]=(0,i.useState)(f),v=u=>{m(u.currentTarget.value)},l=(0,i.useCallback)(u=>{h(u.currentTarget.value,u.currentTarget.value)},[h]),y=(0,n.Bi)();return(0,t.jsx)(g.f,{id:y,rows:2,value:p,onChange:v,onBlur:l,placeholder:"Metric name or tags query",required:!0,"data-testid":s.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsQueryInput,cols:52,className:d.textarea})};o.displayName=c},70766:(k,R,e)=>{"use strict";e.d(R,{y:()=>a});var t=e(74848),n=e(96540),i=e(72574),s=e(59421),r=e(24240),g=e(35589);async function a(o,h=s.cS){if((0,r.zs)(o))return o.variables.editor;if((0,r.X3)(o)){const f=await h(o.meta);if(!f.components.QueryEditor)throw new Error("Missing QueryEditor in plugin definition.");return f.components.QueryEditor??null}return(0,r.Hf)(o)?c:(0,r.d5)(o)?(await h(o.meta)).components.VariableQueryEditor??g.z:null}function c({datasource:o,query:h,onChange:f}){const d=(0,n.useCallback)(p=>{f({refId:"StandardVariableQuery",query:p})},[f]);return(0,t.jsx)(g.z,{query:h.query,onChange:d,datasource:o,templateSrv:(0,i.w)()})}},3843:(k,R,e)=>{"use strict";e.d(R,{BC:()=>o,DW:()=>g,Eo:()=>f,FN:()=>r,NY:()=>h,T7:()=>c,nS:()=>n,sJ:()=>a,wf:()=>s,y8:()=>d});var t=e(65307);const n={id:"",isValid:!0,errors:{},name:"",extended:null},i=(0,t.Z0)({name:"templating/editor",initialState:n,reducers:{variableEditorMounted:(p,m)=>{p.name=m.payload.name,p.id=m.payload.id},variableEditorUnMounted:(p,m)=>n,changeVariableNameSucceeded:(p,m)=>{p.name=m.payload.data.newName,delete p.errors.name,p.isValid=Object.keys(p.errors).length===0},changeVariableNameFailed:(p,m)=>{p.name=m.payload.newName,p.errors.name=m.payload.errorText,p.isValid=Object.keys(p.errors).length===0},addVariableEditorError:(p,m)=>{p.errors[m.payload.errorProp]=m.payload.errorText,p.isValid=Object.keys(p.errors).length===0},removeVariableEditorError:(p,m)=>{delete p.errors[m.payload.errorProp],p.isValid=Object.keys(p.errors).length===0},changeVariableEditorExtended:(p,m)=>{p.extended={...p.extended,...m.payload}},cleanEditorState:()=>n}}),s=i.reducer,{changeVariableNameSucceeded:r,changeVariableNameFailed:g,variableEditorMounted:a,variableEditorUnMounted:c,changeVariableEditorExtended:o,addVariableEditorError:h,removeVariableEditorError:f,cleanEditorState:d}=i.actions},85830:(k,R,e)=>{"use strict";e.d(R,{M:()=>t});var t=(n=>(n[n.MaxSize=50]="MaxSize",n))(t||{})},25304:(k,R,e)=>{"use strict";e.d(R,{z:()=>s});var t=e(72574),n=e(20601),i=e(13344);function s(r){const g={},a=(0,t.w)().getVariables();for(let c=0;c<a.length;c++){const o=a[c],h=r&&r[o.name];o.skipUrlSync||(h?g[i.qz+o.name]=h.value:g[i.qz+o.name]=n.B.get(o.type).getValueForUrl(o))}return g}},24240:(k,R,e)=>{"use strict";e.d(R,{CH:()=>v,EW:()=>s,Hf:()=>f,P4:()=>i,SP:()=>a,VN:()=>m,VO:()=>r,X3:()=>p,d5:()=>h,iv:()=>g,m8:()=>c,zs:()=>d});var t=e(29505),n=e(35589);const i=l=>l.type==="query",s=l=>l.type==="adhoc",r=l=>l.type==="constant",g=l=>"multi"in l,a=l=>"options"in l,c=l=>"current"in l;function o(l){return l===null?!1:typeof l=="string"}const h=l=>!!l.metricFindQuery&&!l.variables,f=l=>{if(!l.variables||l.variables.getType()!==t.Qz.Standard)return!1;const y=l.variables;return"toDataQuery"in y&&!!y.toDataQuery},d=l=>{if(!l.variables||l.variables.getType()!==t.Qz.Custom)return!1;const y=l.variables;return"query"in y&&"editor"in y&&!!y.query&&!!y.editor},p=l=>l.variables?l.variables.getType()===t.Qz.Datasource:!1;function m(l,y){return l?l.displayName===n.c||h(y):!1}function v(l,y){return l?l.displayName!==n.c&&(p(y)||f(y)||d(y)):!1}},2223:(k,R,e)=>{"use strict";e.d(R,{i:()=>a});var t=e(74848),n=e(96540),i=e(37390);const s=({nodes:c,edges:o,direction:h,width:f,height:d,onDoubleClick:p})=>{const m=(0,n.useRef)(null),v=(0,n.useRef)(null),l=(0,n.useCallback)(y=>{p&&p(y.nodes[0])},[p]);return(0,n.useEffect)(()=>((async()=>{const u=await e.e(5083).then(e.t.bind(e,83416,23)),D={nodes:r(u,c),edges:g(u,o)},E={width:"100%",height:"100%",autoResize:!0,layout:{improvedLayout:!0,hierarchical:{enabled:!0,direction:h??"DU",sortMethod:"directed"}},interaction:{navigationButtons:!0,dragNodes:!1}};m.current=new u.Network(v.current,D,E),m.current?.on("doubleClick",l)})(),()=>{m.current&&m.current.off("doubleClick")}),[h,o,c,l]),(0,t.jsx)("div",{children:(0,t.jsx)("div",{ref:v,style:{width:f??"100%",height:d??"60vh"}})})};function r(c,o){const h=o.map(f=>({...f,shape:"box"}));return new c.DataSet(h)}function g(c,o){const h=o.map(f=>({...f,arrows:"to",dashes:!0}));return new c.DataSet(h)}function a({edges:c,nodes:o,show:h,title:f,children:d}){const[p,m]=(0,n.useState)(h),v=(0,n.useCallback)(()=>m(!0),[m]),l=(0,n.useCallback)(()=>m(!1),[m]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.a,{isOpen:p,title:f,icon:"info-circle",iconTooltip:"The graph can be moved, zoomed in, and zoomed out.",onClickBackdrop:l,onDismiss:l,children:(0,t.jsx)(s,{nodes:o,edges:c})}),d({showModal:v})]})}},27238:(k,R,e)=>{"use strict";e.d(R,{WT:()=>n,bX:()=>r,t4:()=>s});var t=e(65307);const n={usages:[],usagesNetwork:[]},i=(0,t.Z0)({name:"templating/inspect",initialState:n,reducers:{initInspect:(g,a)=>{const{usages:c,usagesNetwork:o}=a.payload;g.usages=c,g.usagesNetwork=o}}}),s=i.reducer,{initInspect:r}=i.actions},12846:(k,R,e)=>{"use strict";e.d(R,{qJ:()=>f,hI:()=>o,hM:()=>l,H7:()=>h,xU:()=>D,P5:()=>I,g0:()=>y,PK:()=>M,Ow:()=>P});var t=e(6709);function n(T,C){const S=new Set;for(const A of T)S.add(C(A));return S}var i=e(84423),s=e(87490),r=e(34214),g=e(20601),a=e(24240),c=e(75096);const o=T=>{const C=[];for(const S of T)C.push({id:S.id,label:`${S.id}`});return C},h=(T,C)=>T.filter(S=>C.some(A=>A.from===S.id||A.to===S.id)),f=T=>{const C=[];for(const S of T)for(const A of T){if(S===A)continue;g.B.get(S.type).dependsOn(S,A)&&C.push({from:S.id,to:A.id})}return C};function d(T){const C=(0,c.t4)(T);if(!C)return;const S=C.slice(1).find(A=>A!==void 0);if(!(S in{}))return S}const p=(T,C)=>{c.SY.lastIndex=0;const S=[],L=(0,s.MA)(C,2).match(c.SY);if(!L)return S;for(const N of L){if(!N||N.indexOf("$__")!==-1||N.indexOf("${__")!==-1||N.indexOf("$hashKey")!==-1)continue;const F=d(N);T.some(w=>w.id===F)||S.find(w=>w===F)||F&&S.push(F)}return S},m={alias:[/^m$/,/^measurement$/,/^col$/,/^tag_(\w+|\d+)$/],query:[/^timeFilter$/]},v=(T,C,S)=>{const A=Object.keys(C.value).reduce((N,F)=>{const w=C.value[F];if(!w||typeof w!="string")return N;const B=m[F]?m[F].find(K=>K.test(T)):void 0;let U=(0,c.wJ)(w,T);return F==="repeat"&&w===T&&(U=!0),!B&&U&&(N={...N,[F]:w}),N},{}),L=Object.keys(C.value).reduce((N,F)=>{const w=C.value[F];if(w&&typeof w=="object"&&Object.keys(w).length){let B=w.title||w.name||w.id||F;Array.isArray(C.value)&&C.key==="panels"&&(B=`${B}[${w.id}]`);const U=v(T,{key:F,value:w},{});Object.keys(U).length&&(N={...N,[B]:U})}return N},{});return(Object.keys(A).length||Object.keys(L).length)&&(S={...S,...A,...L}),S},l=(T,C)=>{if(!C)return{unUsed:[],usages:[]};const S=[];let A=[];const L=C.getSaveModelCloneOld();for(const N of T){const F=N.id,w=v(F,{key:"model",value:L},{});!Object.keys(w).length&&!(0,a.EW)(N)&&S.push(N),Object.keys(w).length&&A.push({variable:N,tree:w})}return{unUsed:S,usages:A}};async function y(T,C){return new Promise((S,A)=>{setTimeout(()=>{try{const L=u(T,C);S(P(L))}catch(L){A(L)}},200)})}function u(T,C){if(!C)return[];let S=[];const A=C.getSaveModelCloneOld(),L=p(T,A);for(const N of L){const F=v(N,{key:"model",value:A},{});if(Object.keys(F).length){const w={id:N,name:N};S.push({variable:w,tree:F})}}return S}function D(T,C,S){const A=n(C.descendants(T),N=>N.name);A.add(t.c.includeVars);for(const N of T)A.add(N);return E([...A],S)}function E(T,C){const S=[];for(const A of T)C[A]&&S.push(...C[A]);return new Set(S)}const x=(T,C)=>{const{id:S,value:A}=C,{nodes:L,edges:N}=T;if(A&&typeof A=="string"){const F=`${C.id}-${A}`;return L.push({id:F,label:A}),N.push({from:F,to:S}),T}if(A&&typeof A=="object"){const F=Object.keys(A);for(const w of F){const B=`${C.id}-${w}`;L.push({id:B,label:w}),N.push({from:B,to:S}),T=x(T,{id:B,value:A[w]})}return T}return T},P=T=>{const C=[];for(const S of T){const{variable:A,tree:L}=S,N={variable:A,nodes:[{id:"dashboard",label:"dashboard"}],edges:[],showGraph:!1};C.push(x(N,{id:"dashboard",value:L}))}return C},b=T=>Object.values(T).reduce((S,A)=>typeof A=="object"?S+b(A):S+1,0),M=(T,C)=>{const S=C.find(A=>A.variable.id===T);return S?b(S.tree):0};function O(T){const C=[];for(const S of T)C.push(S),S.panels?.length&&C.push(...O(S.panels.map(A=>new PanelModel(A))));return C}function I(T){const C={};for(const S of T){const A=(0,i.tw)(S),L=[...A.matchAll(/"repeat":"([^"]+)"/g)].map(w=>w[1]),N=A.match(c.SY)?.map(w=>d(w))??[],F=[...L,...N];for(const w of F)w in C?C[w].add(S.id):C[w]=new Set([S.id])}return C}},81515:(k,R,e)=>{"use strict";e.d(R,{E5:()=>h,Ez:()=>c,mn:()=>f});var t=e(65307),n=e(2543),i=e.n(n),s=e(12470),r=e(87421),g=e(83370),a=e(80484);const c={...a.Vg,type:"interval",auto_count:30,auto_min:"10s",options:[],auto:!1,query:"1m,10m,30m,1h,6h,12h,1d,7d,14d,30d",refresh:s.CO.onTimeRangeChanged,current:{}},o=(0,t.Z0)({name:"templating/interval",initialState:g.j,reducers:{createIntervalOptions:(d,p)=>{const m=(0,r.Fs)(d,p.payload.id);if(m.type!=="interval")return;const v=(0,n.map)(m.query.match(/(["'])(.*?)\1|\w+/g),l=>(l=l.replace(/["']+/g,""),{text:l.trim(),value:l.trim(),selected:!1}));m.auto&&v.length&&v[0].text!=="auto"&&v.unshift({text:"auto",value:"$__auto_interval_"+m.name,selected:!1}),m.options=v}}}),h=o.reducer,{createIntervalOptions:f}=o.actions},24300:(k,R,e)=>{"use strict";e.d(R,{jR:()=>T,Fu:()=>x,$z:()=>o,O$:()=>P,ho:()=>C,MO:()=>E,an:()=>b,U9:()=>D,fx:()=>O,qh:()=>I,S8:()=>M});var t=e(53076),n=e(65307),i=e(2543),s=e(92053);const r=(S,...A)=>A.reduce((L,N)=>N(L),S);var g=e(13344),a=e(24240);const c=/[^ -~]/gm,o={id:"",highlightIndex:-1,queryValue:"",selectedValues:[],options:[],multi:!1},h=1e3,f=new t.A({intraMode:1,intraIns:1,intraSub:1,intraTrn:1,intraDel:1}),d=S=>Array.isArray(S)?S.reduce((A,L)=>((0,i.isString)(L.value)&&(A[L.value]=L),A),{}):{},p=S=>{if(!Array.isArray(S.options))return S.options=[],S;const A=d(S.selectedValues);return S.selectedValues=Object.values(A),S.options=S.options.map(L=>{if(!(0,i.isString)(L.value))return L;const N=!!A[L.value];return L.selected===N?L:{...L,selected:N}}),S.options=m(S.options),S},m=S=>Array.isArray(S)?S.length<=h?S:S.slice(0,h):[],v=S=>{const{options:A,selectedValues:L}=S;return A.length===0||L.length>0||!A[0]||A[0].value!==g.To||(S.selectedValues=[{...A[0],selected:!0}]),S},l=S=>{const{selectedValues:A}=S;return A.length>1&&(S.selectedValues=A.filter(L=>L.value!==g.To)),S},y=S=>S.filter(A=>A.value!==g.To).map(A=>({...A,selected:!0})),u=(0,n.Z0)({name:"templating/optionsPicker",initialState:o,reducers:{showOptions:(S,A)=>{const{query:L,options:N}=A.payload;if(S.highlightIndex=-1,S.options=(0,i.cloneDeep)(N),S.id=A.payload.id,S.queryValue="",S.multi=!1,(0,a.iv)(A.payload)&&(S.multi=A.payload.multi??!1),(0,a.P4)(A.payload)){const{queryValue:F}=A.payload,w=(0,s.E)(L);S.queryValue=w&&F?F:""}return S.selectedValues=S.options.filter(F=>F.selected),r(S,v,p)},hideOptions:(S,A)=>({...o}),toggleOption:(S,A)=>{const{option:L,clearOthers:N,forceSelect:F}=A.payload,{multi:w,selectedValues:B}=S;if(L){const U=!B.find(K=>K.value===L.value&&K.text===L.text);if(L.value===g.To||!w||N)return U||F?S.selectedValues=[{...L,selected:!0}]:S.selectedValues=[],r(S,v,l,p);if(F||U)return S.selectedValues.push({...L,selected:!0}),r(S,v,l,p);S.selectedValues=B.filter(K=>K.value!==L.value&&K.text!==L.text)}else S.selectedValues=[];return r(S,v,l,p)},moveOptionsHighlight:(S,A)=>{let L=S.highlightIndex+A.payload;return L<0?L=-1:L>=S.options.length&&(L=S.options.length-1),{...S,highlightIndex:L}},toggleAllOptions:(S,A)=>{const L=S.selectedValues.find(F=>F.value===g.To),N=S.options.find(F=>F.value===g.To);return S.selectedValues.length>0&&N&&!L?(S.selectedValues=[],S.selectedValues.push({text:N.text??"All",value:N.value,selected:!0}),r(S,p)):L&&S.selectedValues.length===1?(S.selectedValues=y(S.options),r(S,p)):S.selectedValues.length>0&&!N?(S.selectedValues=[],r(S,p)):(S.selectedValues=y(S.options),r(S,p))},updateSearchQuery:(S,A)=>(S.queryValue=A.payload,S),updateOptionsAndFilter:(S,A)=>{const L=S.queryValue.trim();let N=[];if(L==="")N=A.payload;else if(c.test(L))N=A.payload.filter(F=>F.text.includes(L));else{const F=A.payload.map(({text:K})=>Array.isArray(K)?K.toString():K),[w,B,U]=f.search(F,L,5);w?.length&&(B&&U?N=U.map(K=>A.payload[B.idx[K]]):N=w.map(K=>A.payload[K]),N.sort((K,V)=>(K.value===g.To?-1:0)-(V.value===g.To?-1:0)))}if(S.highlightIndex=0,L!==""){let F=N.findIndex(w=>w.value!==g.To);(F===-1||N[F].value!==L)&&(N.unshift({selected:!1,text:"> "+L,value:L}),S.highlightIndex=F===-1?0:F+1)}return S.options=N,r(S,v,p)},updateOptionsFromSearch:(S,A)=>(S.options=A.payload,S.highlightIndex=0,r(S,v,p)),cleanPickerState:()=>o}}),{toggleOption:D,showOptions:E,hideOptions:x,moveOptionsHighlight:P,toggleAllOptions:b,updateSearchQuery:M,updateOptionsAndFilter:O,updateOptionsFromSearch:I,cleanPickerState:T}=u.actions,C=u.reducer},86886:(k,R,e)=>{"use strict";e.d(R,{C:()=>t});const t=(s,r)=>s&&(r&&!Array.isArray(s.value)?{...s,value:i(s.value),text:i(s.text)}:!r&&Array.isArray(s.value)?{...s,value:n(s.value),text:n(s.text)}:s),n=s=>Array.isArray(s)?s.length>0?s[0]:"":s,i=s=>Array.isArray(s)?s:[s]},72401:(k,R,e)=>{"use strict";e.d(R,{Y7:()=>ze,TI:()=>j,_q:()=>Pe,RK:()=>Le,t9:()=>ce,x7:()=>ie,Hn:()=>je,mZ:()=>qe,kl:()=>oe,us:()=>re});var t=e(2543),n=e(12470),i=e(92041),s=e(39070),r=e(22391),g=e(39601),a=e(32264),c=e(82467),o=e(16233),h=e(74856),f=e(99140),d=e(3169),p=e(10096),m=e(27677),v=e(34525),l=e(31193),y=e(23989),u=e(20601),D=e(13344),E=e(3843),x=e(24240),P=e(12846),b=e(24300),M=e(86886),O=e(80484),I=e(75096),T=e(73134),C=e(28601),S=e(48594),A=e(84014);const L=(Ve,pe=-1,Ee=!1,me=!1)=>{const ve={};if(me){const Se={...initialVariableModelState,id:"__dashboard",name:"__dashboard",type:"system",index:-3,skipUrlSync:!0,hide:VariableHide.hideVariable,current:{value:{name:"A dashboard title",uid:"An dashboard UID",toString:()=>"A dashboard title"}}},Ie={...initialVariableModelState,id:"__org",name:"__org",type:"system",index:-2,skipUrlSync:!0,hide:VariableHide.hideVariable,current:{value:{name:"An org name",id:1,toString:()=>"1"}}},Oe={...initialVariableModelState,id:"__user",name:"__user",type:"system",index:-1,skipUrlSync:!0,hide:VariableHide.hideVariable,current:{value:{login:"admin",id:1,email:"admin@test",toString:()=>"1"}}};ve[Se.id]=Se,ve[Ie.id]=Ie,ve[Oe.id]=Oe}for(let Se=0;Se<Ve;Se++)ve[Se]=createQueryVariable({id:Se.toString(),name:`Name-${Se}`,label:`Label-${Se}`,index:Se});return Ee&&(ve[NEW_VARIABLE_ID]=createQueryVariable({id:NEW_VARIABLE_ID,name:`Name-${NEW_VARIABLE_ID}`,label:`Label-${NEW_VARIABLE_ID}`,index:Ve})),ve},N=(Ve,pe={})=>{const Ee={id:"0",rootStateKey:"key",index:0,name:"0"};return{initialState:{0:{...{...Ve.initialState,...Ee},...pe}}}},F=()=>combineReducers({dashboard:dashboardReducer,templating:keyedVariablesReducer}),w=()=>combineReducers({templating:keyedVariablesReducer});function B(Ve,pe){return{templating:{lastKey:Ve,keys:{[Ve]:{...getInitialTemplatingState(),...pe}}}}}function U(Ve,pe){return Ve.find(me=>me.name===pe)}function K(Ve){return(Ve.type==="query"||Ve.type==="datasource"||Ve.type==="interval")&&Ve.refresh===T.CO.onTimeRangeChanged}var V=e(87421),H=e(56968),Y=e(85675),X=e(15120);const J=(Ve,pe)=>(Ee,me)=>{let ve=0;const Se=pe.templating.list;for(let Oe=0;Oe<Se.length;Oe++){const Re=q(Se[Oe]);Re.rootStateKey=Ve,u.B.getIfExists(Re.type)&&Ee((0,S.kb)(Ve,(0,H.QV)((0,I.qD)(Re,{global:!1,index:ve++,model:Re}))))}(0,y.w)().updateTimeRange((0,h.jG)().timeRange());const Ie=(0,V.SS)(Ve,me());for(const Oe of Ie)Ee((0,S.kb)(Ve,(0,H.wB)((0,I.qD)(Oe))))};function q(Ve){if(!(0,x.SP)(Ve))return Ve;let pe=!1;for(const Ee of Ve.options)if(Ee.selected=!1,Array.isArray(Ve.current.value))for(const me of Ve.current.value)Ee.value===me&&(Ee.selected=pe=!0);else Ee.value===Ve.current.value&&(Ee.selected=pe=!0);return!pe&&Ve.options.length&&(Ve.options[0].selected=!0),Ve}const ae=(Ve,pe)=>Ee=>{const me={...O.Vg,id:"__dashboard",name:"__dashboard",type:"system",index:-3,skipUrlSync:!0,hide:n.zL.hideVariable,current:{value:{name:pe.title,uid:pe.uid,toString:()=>pe.title}}};Ee((0,S.kb)(Ve,(0,H.QV)((0,I.qD)(me,{global:me.global,index:me.index,model:me}))));const ve={...O.Vg,id:"__org",name:"__org",type:"system",index:-2,skipUrlSync:!0,hide:n.zL.hideVariable,current:{value:{name:o.TP.user.orgName,id:o.TP.user.orgId,toString:()=>o.TP.user.orgId.toString()}}};Ee((0,S.kb)(Ve,(0,H.QV)((0,I.qD)(ve,{global:ve.global,index:ve.index,model:ve}))));const Se={...O.Vg,id:"__user",name:"__user",type:"system",index:-1,skipUrlSync:!0,hide:n.zL.hideVariable,current:{value:{login:o.TP.user.login,id:o.TP.user.id,email:o.TP.user.email,toString:()=>o.TP.user.id.toString()}}};Ee((0,S.kb)(Ve,(0,H.QV)((0,I.qD)(Se,{global:Se.global,index:Se.index,model:Se}))))},j=(Ve,pe)=>(Ee,me)=>{const{rootStateKey:ve}=Ve,Se=(0,V.dn)(Ve,me());if(!(0,x.iv)(Se)||(0,i.R)(Se.current))return;const Ie=(0,M.C)(Se.current,pe);Ee((0,S.kb)(ve,(0,H.QP)((0,I.qD)(Ve,{propName:"multi",propValue:pe})))),Ee((0,S.kb)(ve,(0,H.QP)((0,I.qD)(Ve,{propName:"current",propValue:Ie}))))},te=async(Ve,pe)=>{if(!Ve.rootStateKey)throw new Error(`rootStateKey not found for variable with id:${Ve.id}`);if(ne(Ve,pe))throw new Error("Circular dependency in dashboard variables detected. Dashboard may not work as expected.");const Ee=le(Ve,pe);z(Ve.rootStateKey,Ee,pe)&&await new Promise(me=>{const ve=f.M_.subscribe(()=>{if(!Ve.rootStateKey)throw new Error(`rootStateKey not found for variable with id:${Ve.id}`);z(Ve.rootStateKey,Ee,f.M_.getState())||(ve(),me())})})},ne=(Ve,pe,Ee=new Set)=>Ee.has(Ve.id)?!0:(Ee=new Set([...Ee,Ve.id]),le(Ve,pe).some(me=>ne(me,pe,Ee))),le=(Ve,pe)=>{if(!Ve.rootStateKey)return[];const Ee=[];for(const me of(0,V.SS)(Ve.rootStateKey,pe))Ve!==me&&u.B.getIfExists(Ve.type)&&u.B.get(Ve.type).dependsOn(Ve,me)&&Ee.push(me);return Ee},z=(Ve,pe,Ee)=>{if(pe.length===0)return!1;const me=(0,V.SS)(Ve,Ee);return pe.filter(Se=>me.some(Ie=>Ie.id===Se.id&&(Ie.state===s.Gu.NotStarted||Ie.state===s.Gu.Loading))).length>0},ee=(Ve,pe)=>async(Ee,me)=>{const ve=(0,V.dn)(Ve,me());await te(ve,me());const Se=pe[D.qz+ve.name];if(Se!==void 0){const Ie=(0,I.QT)(Se);await u.B.get(ve.type).setValueFromUrl(ve,Ie);return}if(ve.hasOwnProperty("refresh")){const Ie=ve;if(Ie.refresh===n.CO.onDashboardLoad||Ie.refresh===n.CO.onTimeRangeChanged){await Ee(qe((0,I.jX)(Ie)));return}}if(ve.type==="custom"){await Ee(qe((0,I.jX)(ve)));return}Ee(vt(Ve))},se=Ve=>async(pe,Ee)=>{const me=g.Ny.getSearchObject(),ve=(0,V.SS)(Ve,Ee()).map(async Se=>await pe(ee((0,I.jX)(Se),me)));await Promise.all(ve)},ie=(Ve,pe)=>async(Ee,me)=>{const ve=(0,I.QT)(pe),Se=(0,V.dn)(Ve,me());(0,I.q$)(Se)!==n.CO.never&&await Ee(qe((0,I.jX)(Se)));const Ie=(0,V.dn)((0,I.jX)(Se),me());if(!(0,x.SP)(Ie))return;if(!Ie)throw new Error(`Couldn't find variable with name: ${Se.name}`);let Oe=Ie.options.find(Re=>Re.text===ve||Re.value===ve);if(!Oe&&(0,x.iv)(Ie)&&Ie.allValue&&ve===Ie.allValue&&(Oe={text:D.Zm,value:D.To,selected:!1}),!Oe){let Re=ve;const he=ve;Array.isArray(ve)&&(Re=ve.reduce((Ce,We)=>{const et=Ie.options.find(rt=>rt.value===We);return et?[].concat(Ce,[et.text]):[].concat(Ce,[We])},[])),Oe={text:Re,value:he,selected:!1}}(0,x.iv)(Ie)&&(Oe=(0,M.C)({text:(0,t.castArray)(Oe.text),value:(0,t.castArray)(Oe.value),selected:!1},Ie.multi)),await u.B.get(Se.type).setValue(Ie,Oe)},Z=Ve=>{let pe,Ee,me,ve;const Se=[];for(pe=0;pe<Ve.options.length;pe++)if(ve={...Ve.options[pe]},ve.selected=!1,Array.isArray(Ve.current.value))for(Ee=0;Ee<Ve.current.value.length;Ee++)me=Ve.current.value[Ee],ve.value===me&&(ve.selected=!0,Se.push(ve));else ve.value===Ve.current.value&&(ve.selected=!0,Se.push(ve));return Se},oe=(Ve,pe)=>(Ee,me)=>{const ve=(0,V.dn)(Ve,me());if(!(0,x.SP)(ve))return Promise.resolve();const Se=ve.current||{},Ie=u.B.get(ve.type).setValue;if(Array.isArray(Se.value)){const Ce=Z(ve);if(Ce.length===0){const et=ve.options[0];return Ie(ve,{value:typeof et.value=="string"?[et.value]:et.value,text:typeof et.text=="string"?[et.text]:et.text,selected:!0})}const We={value:Ce.map(et=>et.value),text:Ce.map(et=>et.text),selected:!0};return Ie(ve,We)}let Oe=null;const Re=(0,I.Nz)(ve),he=(0,I.Lz)(ve);if(Oe=ve.options?.find(Ce=>Ce.text===Re||Ce.value===he),Oe||pe&&(Oe=ve.options?.find(Ce=>Ce.text===pe||Ce.value===pe),Oe))return Ie(ve,Oe);if(ve.options){const Ce=ve.options[0];if(Ce)return Ie(ve,Ce)}return Promise.resolve()},ce=(Ve,pe,Ee)=>async me=>{const{rootStateKey:ve}=Ve;return me((0,S.kb)(ve,(0,H.dE)((0,I.qD)(Ve,{option:pe})))),await me(re(Ve,Ee))},ye=Ve=>{const pe=new v.TS;return Ve.forEach(Ee=>{pe.createNode(Ee.name)}),Ve.forEach(Ee=>{Ve.forEach(me=>{Ee!==me&&u.B.get(Ee.type).dependsOn(Ee,me)&&pe.link(Ee.name,me.name)})}),pe},re=(Ve,pe,Ee=p.lE)=>async(me,ve)=>{const Se=ve(),{rootStateKey:Ie}=Ve,Oe=(0,V.dn)(Ve,Se);if((0,V.nx)(Ie,Se).transaction.status===O.x8.Fetching)return(0,I.q$)(Oe)===n.CO.never&&(await me(yt((0,I.jX)(Oe))),me(vt(Ve))),Promise.resolve();const Re=(0,V.SS)(Ie,Se),he=ye(Re),Ce=Se.dashboard?.getModel()?.panels??[],We=(0,P.P5)(Ce),et=Oe.type==="adhoc"?{refreshAll:!0,panelIds:[]}:{refreshAll:!1,panelIds:Array.from((0,P.xU)([Oe.id],he,We)),variable:(0,V.dn)(Ve,Se)},rt=he.getNode(Oe.name);let nt=[];return rt&&(nt=rt.getOptimizedInputEdges().map(gt=>{const xt=Re.find(St=>St.name===gt.inputNode?.name);return xt?me(qe((0,I.jX)(xt))):Promise.resolve()})),Promise.all(nt).then(()=>{pe&&(Ee.publish(new O.og(et)),g.Ny.partial(Ne(Ie,ve)))})},ue=(Ve,pe,Ee,me)=>(pe.includes(Ve.name)||pe.push(Ve.name),Ve.outputEdges.forEach(ve=>{const Se=ve.outputNode;if(Se&&!pe.includes(Se.name)){const Ie=Ee.find(Oe=>Oe.name===Se.name);Ie&&Ie.refresh===n.CO.onTimeRangeChanged&&me.indexOf(Ie)===-1?(me.push(Ie),pe.push(Se.name)):ue(Se,pe,Ee,me)}}),me),De=(Ve,pe)=>Ve.outputEdges.every(Ee=>{const me=Ee.outputNode;if(me){const ve=U(pe,me.name);if(ve&&ve.type==="query")return ve.refresh!==n.CO.onTimeRangeChanged}return!0}),ge=(Ve,pe)=>{const Ee=(0,V.SS)(Ve,pe),me=ye(Ee),ve=[],Se=[];return Ee.forEach(Ie=>{const Oe=me.getNode(Ie.name);if(!ve.includes(Ie.name)&&Oe){const Re=U(Ee,Oe.name);if(!Re)return;const he=K(Re);he&&Oe.outputEdges.length===0&&Se.push(Re),he&&Se.includes(Re)&&Oe.outputEdges.length>0&&(Se.push(Re),ue(Oe,ve,Ee,Se)),he&&Oe.outputEdges.length>0&&De(Oe,Ee)&&(Se.includes(Re)||Se.push(Re)),!he&&Oe.outputEdges.length>0&&ue(Oe,ve,Ee,Se)}}),Se},Te=(Ve,pe)=>(0,V.SS)(Ve,pe).filter(ve=>"refresh"in ve&&"options"in ve?ve.refresh===n.CO.onTimeRangeChanged:!1),Le=(Ve,pe,Ee={templateSrv:(0,y.w)(),events:p.lE})=>async(me,ve)=>{Ee.templateSrv.updateTimeRange(pe);let Se=[];a.$.featureToggles.refactorVariablesTimeRange?Se=ge(Ve,ve()):Se=Te(Ve,ve());const Ie=Se.map(Re=>Re.id),Oe=Se.map(Re=>me(Ye((0,I.jX)(Re))));try{await Promise.all(Oe),Ee.events.publish(new O.BS({variableIds:Ie}))}catch(Re){console.error(Re),me((0,c.dx)(dt("Template variable service failed",Re)))}},Ye=Ve=>async(pe,Ee)=>{const me=(0,V.dn)(Ve,Ee());if(!(0,x.SP)(me))return;const ve=me.options.slice();await pe(qe((0,I.jX)(me),!0));const Se=(0,V.dn)(Ve,Ee());if(!(0,x.SP)(Se))return;const Ie=Se.options;JSON.stringify(ve)!==JSON.stringify(Ie)&&Ee().dashboard.getModel()?.templateVariableValueUpdated()},je=(Ve,pe,Ee=p.lE)=>async(me,ve)=>{const Se=[],Ie=ve().dashboard.getModel(),Oe=(0,V.SS)(Ve,ve());for(const et of Oe){const rt=D.qz+et.name;if(!pe.hasOwnProperty(rt)||!Ze(et,pe[rt].value))continue;let nt=pe[rt].value;if(pe[rt].removed){const xt=Ie?.templating.list.find(St=>St.name===et.name);xt&&(0,x.m8)(xt)&&(nt=xt.current.value),xt&&xt.type==="constant"&&(nt=xt.query)}const gt=u.B.get(et.type).setValueFromUrl(et,nt);Se.push(gt)}const Re=Oe.filter(et=>{const rt=D.qz+et.name;return pe.hasOwnProperty(rt)&&Ze(et,pe[rt].value)&&et.type!=="adhoc"}),he=ye(Oe),Ce=(0,P.P5)(Ie?.panels??[]),We=(0,P.xU)(Re.map(et=>et.id),he,Ce);Se.length&&(await Promise.all(Se),Ee.publish(new O.eF({refreshAll:We.size===0,panelIds:Array.from(We)})))};function Ze(Ve,pe){const Ee=u.B.get(Ve.type).getValueForUrl(Ve);let me=(0,I.QT)(pe);return Array.isArray(Ee)&&!Array.isArray(me)&&(me=[me]),!(0,t.isEqual)(Ee,me)}const Ne=(Ve,pe)=>{const Ee=g.Ny.getSearchObject(),me=Object.keys(Ee).filter(ve=>ve.indexOf(D.qz)===-1).reduce((ve,Se)=>(ve[Se]=Ee[Se],ve),{});for(const ve of(0,V.SS)(Ve,pe())){if(ve.skipUrlSync)continue;const Se=u.B.get(ve.type);me[D.qz+ve.name]=Se.getValueForUrl(ve)}return me},Pe=(Ve,pe)=>async(Ee,me)=>{try{const ve=(0,I.q4)(Ve),Se=me(),Ie=(0,V.Tk)(Se);Ie&&(0,V.nx)(Ie,Se).transaction.status===O.x8.Fetching&&Ee(ze(Ie)),Ee((0,S.kb)(ve,(0,Y.kH)({uid:ve}))),Ee(ae(ve,pe)),Ee(J(ve,pe)),Ee(Ue(ve)),await Ee(se(ve)),Ee((0,S.kb)(ve,(0,Y.$O)({uid:ve})))}catch(ve){Ee((0,c.dx)(dt("Templating init failed",ve))),console.error(ve)}};function Ue(Ve,pe=l.tR){return(Ee,me)=>{const ve=(0,V.SS)(Ve,me());for(const Se of ve){if(Se.type!=="adhoc"&&Se.type!=="query")continue;const{datasource:Ie}=Se;if((0,r.fN)(Ie))continue;const Oe=pe().getInstanceSettings(Ie),Re=Oe?(0,r.p$)(Oe):{uid:Ie};Ee((0,S.kb)(Ve,(0,H.QP)((0,I.qD)(Se,{propName:"datasource",propValue:Re}))))}}}const $e=Ve=>pe=>{pe((0,S.kb)(Ve,(0,X.v)())),pe((0,S.kb)(Ve,(0,E.y8)())),pe((0,S.kb)(Ve,(0,b.jR)())),pe((0,S.kb)(Ve,(0,Y.pu)()))},ze=(Ve,pe={getBackendSrv:m.AI})=>Ee=>{pe.getBackendSrv().cancelAllInFlightRequests(),Ee($e(Ve))},qe=(Ve,pe=!1)=>async(Ee,me)=>{const{rootStateKey:ve}=Ve;try{if(!(0,I.sN)(ve,me()))return;const Se=(0,V.dn)(Ve,me());Ee((0,S.kb)(ve,(0,H.a7)((0,I.qD)(Se)))),await Ee(yt((0,I.jX)(Se))),await u.B.get(Se.type).updateOptions(Se),Ee(vt(Ve))}catch(Se){if(Ee((0,S.kb)(ve,(0,H.Te)((0,I.qD)(Ve,{error:Se})))),pe||(console.error(Se),Ee((0,c.dx)(dt("Error updating options:",Se,Ve)))),pe)throw Se}},dt=(Ve,pe,Ee)=>(0,d.gi)(`${Ee?`Templating [${Ee.id}]`:"Templating"}`,pe instanceof Error?`${Ve} ${pe.message}`:`${Ve}`),vt=Ve=>(pe,Ee)=>{const{rootStateKey:me}=Ve;if(!(0,I.sN)(me,Ee()))return;const ve=(0,V.dn)(Ve,Ee());ve.state!==s.Gu.Done&&pe((0,S.kb)(Ve.rootStateKey,(0,H.Pu)((0,I.qD)(ve))))};function yt(Ve,pe=l.tR){return async function(Ee,me){const{id:ve,rootStateKey:Se}=Ve;if(!(0,I.sN)(Se,me()))return;const Ie=(0,V.dn)(Ve,me());if(Ie.type==="query")try{const Oe=await pe().get(Ie.datasource??"");if((0,x.d5)(Oe)||!(0,x.Hf)(Oe)||st(Ie.query))return;const Re={refId:`${Oe.name}-${ve}-Variable-Query`,query:Ie.query};Ee((0,S.kb)(Se,(0,H.QP)((0,I.qD)(Ve,{propName:"query",propValue:Re}))))}catch(Oe){Ee((0,c.dx)(dt("Failed to upgrade legacy queries",Oe))),console.error(Oe)}}}function st(Ve){return(0,s.Gv)(Ve)&&"refId"in Ve&&typeof Ve.refId=="string"}},48594:(k,R,e)=>{"use strict";e.d(R,{Ay:()=>o,L1:()=>s,kb:()=>g});var t=e(75096),n=e(84014),i=e(85675);const s={keys:{}},r=h=>({type:`templating/keyed/${h.action.type.replace(/^templating\//,"")}`,payload:h});function g(h,f){const d=(0,t.q4)(h);return r({key:d,action:f})}const a=h=>typeof h.type=="string"&&h.type.startsWith("templating/keyed")&&"payload"in h&&typeof h.payload.key=="string";function c(h=s,f){if(a(f)){const{key:d,action:p}=f.payload,m=(0,t.q4)(d),v=i.kH.match(p)?m:h.lastKey,l=(0,n.H)(),y=h.keys[m],u=l(y,p);return{...h,lastKey:v,keys:{...h.keys,[m]:u}}}return h}const o={templating:c}},84014:(k,R,e)=>{"use strict";e.d(R,{H:()=>o,x:()=>h});var t=e(14644),n=e(3843),i=e(27238),s=e(24300),r=e(85675),g=e(83370),a=e(15120);let c;function o(){return c||(c=(0,t.combineReducers)({editor:n.wf,variables:a.Y,optionsPicker:s.ho,transaction:r.Dd,inspect:i.t4})),c}function h(){return{editor:n.nS,variables:g.j,optionsPicker:s.$z,transaction:r.i3,inspect:i.WT}}},87421:(k,R,e)=>{"use strict";e.d(R,{Fs:()=>E,SS:()=>c,Tk:()=>v,UN:()=>u,_2:()=>D,bZ:()=>y,dn:()=>r,hk:()=>d,nS:()=>f,nx:()=>a,pi:()=>h,wk:()=>p,y7:()=>l});var t=e(41811),n=e(99140),i=e(75096),s=e(84014);function r(x,P=(0,n.Gu)(),b=!0){const{id:M,rootStateKey:O}=x,T=a(O,P).variables[M];if(!T){if(b)throw new Error(`Couldn't find variable with id:${M}`);return}return T}function g(x,P,b=(0,n.Gu)()){return Object.values(a(P,b).variables).filter(x).sort((M,O)=>M.index-O.index)}function a(x,P=(0,n.Gu)()){return P.templating.keys[(0,i.q4)(x)]??(0,s.x)()}function c(x,P=(0,n.Gu)()){return g(o,x,P)}function o(x){return x.type!=="system"}const h=(0,t.A)((x,P)=>c(x,(0,n.Gu)())),f=(x,P)=>c(x,P);function d(x,P=(0,n.Gu)()){return p(Object.values(a(x,P).variables))}function p(x){const P=x.filter(o).sort((b,M)=>b.index-M.index);return P.length>0?P[P.length-1].index+1:0}function m(x,P=getState()){return a(x,P).transaction.isDirty}function v(x=(0,n.Gu)()){return x.templating?.lastKey}function l(x=(0,n.Gu)()){if(!x.templating?.lastKey)throw new Error("Accessing lastKey without initializing it variables");return x.templating.lastKey}function y(x,P=(0,n.Gu)()){const b=v(P);return b?g(x,b,P):[]}function u(x=(0,n.Gu)()){const P=v(x);return P?c(P,x):[]}function D(x,P=(0,n.Gu)()){const b=v(P);if(b)return r({id:x,rootStateKey:b,type:"query"},P,!1)}function E(x,P){return x[P]}},56968:(k,R,e)=>{"use strict";e.d(R,{Hr:()=>p,Pu:()=>P,QP:()=>v,QV:()=>m,Te:()=>b,a7:()=>x,dE:()=>u,hj:()=>l,l_:()=>D,qi:()=>d,ut:()=>y,wB:()=>E});var t=e(65307),n=e(2543),i=e.n(n),s=e(39070),r=e(20601),g=e(3843),a=e(24240),c=e(75096),o=e(87421),h=e(83370);const f=(0,t.Z0)({name:"templating/shared",initialState:h.j,reducers:{addVariable:(M,O)=>{const I=O.payload.id??O.payload.data.model.name,T=r.B.get(O.payload.type),C=(0,n.cloneDeep)(T.initialState),S=T.beforeAdding?T.beforeAdding(O.payload.data.model):(0,n.cloneDeep)(O.payload.data.model),A={...(0,n.defaults)({},S,C),id:I,index:O.payload.data.index,global:O.payload.data.global};M[I]=A},variableStateNotStarted:(M,O)=>{const I=(0,o.Fs)(M,O.payload.id);I.state=s.Gu.NotStarted,I.error=null},variableStateFetching:(M,O)=>{const I=(0,o.Fs)(M,O.payload.id);I.state=s.Gu.Loading,I.error=null},variableStateCompleted:(M,O)=>{const I=(0,o.Fs)(M,O.payload.id);I&&(I.state=s.Gu.Done,I.error=null)},variableStateFailed:(M,O)=>{const I=(0,o.Fs)(M,O.payload.id);I&&(I.state=s.Gu.Error,I.error=O.payload.data.error)},removeVariable:(M,O)=>{if(delete M[O.payload.id],!O.payload.data.reIndex)return;const I=Object.values(M).sort((T,C)=>T.index-C.index);for(let T=0;T<I.length;T++)I[T].index=T},duplicateVariable:(M,O)=>{function I(B){return B.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}const T=(0,n.cloneDeep)(M[O.payload.id]),C=new RegExp(`^copy_of_${I(T.name)}(_(\\d+))?$`),S=Object.values(M).map(({name:B})=>B.match(C)).filter(B=>B!=null),A=S.map(B=>B[2]).filter(B=>B!=null),L=S.length===0?null:A.length===0?1:A.map(B=>+B).sort((B,U)=>U-B)[0]+1,N=`copy_of_${T.name}${L?`_${L}`:""}`,F=O.payload.data?.newId??N,w=(0,o.wk)(Object.values(M));M[F]={...(0,n.cloneDeep)(r.B.get(O.payload.type).initialState),...T,id:F,name:N,index:w}},changeVariableOrder:(M,O)=>{const{toIndex:I,fromIndex:T}=O.payload.data,C=Object.values(M);for(let S=0;S<C.length;S++){const A=C[S];A.index===T?A.index=I:A.index>T&&A.index<=I?A.index--:A.index<T&&A.index>=I&&A.index++}},changeVariableType:(M,O)=>{const{id:I}=O.payload,{label:T,name:C,index:S,description:A,rootStateKey:L}=M[I];M[I]={...(0,n.cloneDeep)(r.B.get(O.payload.data.newType).initialState),id:I,rootStateKey:L,label:T,name:C,index:S,description:A}},setCurrentVariableValue:(M,O)=>{if(!O.payload.data.option)return;const I=(0,o.Fs)(M,O.payload.id);if(!(0,a.SP)(I))return;const{option:T}=O.payload.data,C={...T,text:(0,c.QT)(T?.text),value:(0,c.QT)(T?.value)};I.current=C,I.options=I.options.map(S=>{S.value=(0,c.QT)(S.value),S.text=(0,c.QT)(S.text);let A=!1;if(Array.isArray(C.value))for(let L=0;L<C.value.length;L++){const N=C.value[L];if(S.value===N){A=!0;break}}else S.value===C.value&&(A=!0);return S.selected=A,S})},changeVariableProp:(M,O)=>{const I=(0,o.Fs)(M,O.payload.id);I[O.payload.data.propName]=O.payload.data.propValue}},extraReducers:M=>M.addCase(g.FN,(O,I)=>{const T=(0,o.Fs)(O,I.payload.id);T.name=I.payload.data.newName})}),d=f.reducer,{removeVariable:p,addVariable:m,changeVariableProp:v,changeVariableOrder:l,duplicateVariable:y,setCurrentVariableValue:u,changeVariableType:D,variableStateNotStarted:E,variableStateFetching:x,variableStateCompleted:P,variableStateFailed:b}=f.actions},85675:(k,R,e)=>{"use strict";e.d(R,{$O:()=>o,Dd:()=>h,i3:()=>s,kH:()=>a,pu:()=>c});var t=e(65307),n=e(80484),i=e(56968);const s={uid:null,status:n.x8.NotStarted,isDirty:!1},r=(0,t.Z0)({name:"templating/transaction",initialState:s,reducers:{variablesInitTransaction:(f,d)=>{f.uid=d.payload.uid,f.status=n.x8.Fetching},variablesCompleteTransaction:(f,d)=>{f.uid===d.payload.uid&&(f.status=n.x8.Completed)},variablesClearTransaction:(f,d)=>{f.uid=null,f.status=n.x8.NotStarted,f.isDirty=!1}},extraReducers:f=>f.addMatcher(g,(d,p)=>{d.status===n.x8.Completed&&(d.isDirty=!0)})});function g(f){return i.Hr.match(f)||i.QV.match(f)||i.QP.match(f)||i.hj.match(f)||i.ut.match(f)||i.l_.match(f)}const{variablesInitTransaction:a,variablesClearTransaction:c,variablesCompleteTransaction:o}=r.actions,h=r.reducer},83370:(k,R,e)=>{"use strict";e.d(R,{j:()=>t});const t={}},15120:(k,R,e)=>{"use strict";e.d(R,{Y:()=>g,v:()=>r});var t=e(65307),n=e(20601),i=e(56968),s=e(83370);const r=(0,t.VP)("templating/cleanVariables"),g=(a=s.j,c)=>{if(r.match(c)){const o=Object.values(a).filter(f=>f.global);return o?o.reduce((f,d)=>(f[d.id]=d,f),{}):s.j}return c?.payload?.type&&n.B.getIfExists(c?.payload?.type)?n.B.get(c.payload.type).reducer((0,i.qi)(a,c),c):a}},80484:(k,R,e)=>{"use strict";e.d(R,{BS:()=>c,Vg:()=>g,eF:()=>o,og:()=>a,x8:()=>r});var t=e(12470),n=e(39070),i=e(65463),s=e(13344),r=(h=>(h.NotStarted="Not started",h.Fetching="Fetching",h.Completed="Completed",h))(r||{});const g={id:s.qF,rootStateKey:null,name:"",type:"query",global:!1,index:-1,hide:t.zL.dontHide,skipUrlSync:!1,state:n.Gu.NotStarted,error:null,description:null};class a extends i.x{static{this.type="variables-changed"}}class c extends i.x{static{this.type="variables-time-range-process-done"}}class o extends i.x{static{this.type="variables-changed-in-url"}}},75096:(k,R,e)=>{"use strict";e.d(R,{AX:()=>E,Lz:()=>l,ML:()=>m,Nz:()=>v,QT:()=>b,SY:()=>f,Wz:()=>P,iP:()=>u,jX:()=>I,q$:()=>D,q4:()=>O,qD:()=>T,sN:()=>M,t4:()=>d,u7:()=>y,wJ:()=>p});var t=e(2543),n=e.n(t),i=e(12470),s=e(72574),r=e(87490),g=e(99140),a=e(20601),c=e(13344),o=e(87421),h=e(80484);const f=/\$(\w+)|\[\[(\w+?)(?::(\w+))?\]\]|\${(\w+)(?:\.([^:^\}]+))?(?::([^\}]+))?}/g,d=S=>(f.lastIndex=0,f.exec(S));function p(...S){const A=S[S.length-1];S[0]=typeof S[0]=="string"?S[0]:(0,r.MA)(S[0]);const N=S.slice(0,-1).join(" ").match(f);return!!(N!==null?N.find(w=>{const B=d(w);return B!==null&&B.indexOf(A)>-1}):!1)}const m=S=>{if(!S||!S.current)return!1;if(S.current.value){const A=Array.isArray(S.current.value);if(A&&S.current.value.length&&S.current.value[0]===c.To||!A&&S.current.value===c.To)return!0}if(S.current.text){const A=Array.isArray(S.current.text);if(A&&S.current.text.length&&S.current.text[0]===c.Zm||!A&&S.current.text===c.Zm)return!0}return!1},v=S=>!S||!S.current||!S.current.text?"":Array.isArray(S.current.text)?S.current.text.toString():typeof S.current.text!="string"?"":S.current.text,l=S=>!S||!S.current||S.current.value===void 0||S.current.value===null?null:Array.isArray(S.current.value)?S.current.value.toString():typeof S.current.value!="string"?null:S.current.value;function y(S,A=(0,s.w)()){return!S||!S.regex?"":A.replace(S.regex,{},"regex")}function u(S,A,L,N){const F={range:void 0,variable:S,searchFilter:A,scopedVars:N};return(S.refresh===i.CO.onTimeRangeChanged||S.refresh===i.CO.onDashboardLoad)&&(F.range=L.timeRange()),F}function D(S){return S?.type==="custom"?i.CO.onDashboardLoad:!S||!("refresh"in S)||S.refresh!==i.CO.onTimeRangeChanged&&S.refresh!==i.CO.onDashboardLoad?i.CO.never:S.refresh}function E(){return a.B.list().filter(S=>S.id!=="system").map(({id:S,name:A,description:L})=>({label:A,value:S,description:L}))}function x(S){return(0,t.isArray)(S)&&(S.length===0?S=void 0:S.length===1&&(S=S[0])),S}function P(S,A){let L=0;const N={};for(const F in S){if(!F.startsWith(c.qz))continue;let w=x(A[F]),B=x(S[F]);(0,t.isEqual)(B,w)||(N[F]={value:S[F]},L++)}for(const F in A){if(!F.startsWith(c.qz))continue;const w=A[F];(0,t.isArray)(w)&&w.length===0||S.hasOwnProperty(F)||(N[F]={value:"",removed:!0},L++)}return L?N:void 0}function b(S){return Array.isArray(S)?S.map(String):S==null?"":typeof S=="number"?S.toString(10):typeof S=="string"?S:typeof S=="boolean"?S.toString():""}function M(S,A=(0,g.Gu)()){return(0,o.nx)(S,A).transaction.status!==h.x8.NotStarted}function O(S){return String(S)}const I=S=>{if(!S.rootStateKey)throw new Error(`rootStateKey not found for variable with id:${S.id}`);return{type:S.type,id:S.id,rootStateKey:S.rootStateKey}};function T(S,A){return{type:S.type,id:S.id,data:A}}function C(){const S=getTemplateSrv().getVariables(),A=locationService.getSearchObject();return Object.keys(A).filter(L=>L.indexOf(VARIABLE_PREFIX)!==-1&&S.some(N=>N.name===L.replace(VARIABLE_PREFIX,""))).reduce((L,N)=>{const F=N.replace(VARIABLE_PREFIX,"");return L[F]=A[N],L},{})}},1819:(k,R,e)=>{"use strict";e.d(R,{e:()=>d});var t=e(74848),n=e(32196),i=e(28240),s=e(83195),r=e(14588),g=e(52622),a=e(40845),c=e(72109),o=e(61994),h=e(74007);function f(m,v,l,y,u){const D=m.fields,E=l!=null?D[l]:null,x=D.filter(T=>!T.config.custom?.hideFrom?.tooltip),P=x.find(T=>T.name==="traceID")||D[0],b=[];if(x.filter(T=>P===T).length>0&&b.push(P),b.push(...x.filter(T=>P!==T)),b.length===0)return null;const M=[],O=[],I=new Set;for(const T of b){if(u===g.$N.Single&&T!==E)continue;const C=T.values[v],S=T.display?T.display(C):{text:`${C}`,numeric:+C};T.getLinks&&T.getLinks({calculatedValue:S,valueRowIndex:v}).forEach(A=>{const L=`${A.title}/${A.href}`;I.has(L)||(O.push(A),I.add(L))}),M.push({name:(0,i.Ct)(T,m),value:C,valueString:(0,s.cN)(S),highlight:T===E})}return y&&y!==g.xB.None&&M.sort((T,C)=>r.sortValues(y)(T.value,C.value)),{displayValues:M,links:O}}const d=({data:m,rowIndex:v,columnIndex:l,sortOrder:y,mode:u,header:D,padding:E=0})=>{const x=(0,a.of)(p,E);if(!m||v==null)return null;const P=f(m,v,l,y,u);if(P==null)return null;const{displayValues:b,links:M}=P;return D==="Exemplar"?(0,t.jsx)(h.i,{displayValues:b,links:M,header:D}):(0,t.jsxs)("div",{className:x.wrapper,children:[D&&(0,t.jsx)("div",{className:x.header,children:(0,t.jsx)("span",{className:x.title,children:D})}),(0,t.jsx)("table",{className:x.infoWrap,children:(0,t.jsxs)("tbody",{children:[b.map((O,I)=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:O.name}),(0,t.jsx)("td",{children:(0,o.A)(O.valueString)})]},`${I}/${v}`)),M.map((O,I)=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Link"}),(0,t.jsx)("td",{colSpan:2,children:(0,t.jsx)(c.Y,{href:O.href,external:O.target==="_blank",weight:"medium",inline:!1,children:O.title})})]},I))]})})]})},p=(m,v=0)=>({wrapper:(0,n.css)({padding:`${v}px`,background:m.components.tooltip.background,borderRadius:m.shape.borderRadius(2)}),header:(0,n.css)({background:m.colors.background.secondary,alignItems:"center",alignContent:"center",display:"flex",paddingBottom:m.spacing(1)}),title:(0,n.css)({fontWeight:m.typography.fontWeightMedium,overflow:"hidden",display:"inline-block",whiteSpace:"nowrap",textOverflow:"ellipsis",flexGrow:1}),infoWrap:(0,n.css)({padding:m.spacing(1),background:"transparent",border:"none",th:{fontWeight:m.typography.fontWeightMedium,padding:m.spacing(.25,2,.25,0)},tr:{borderBottom:`1px solid ${m.colors.border.weak}`,"&:last-child":{borderBottom:"none"}}}),link:(0,n.css)({color:m.colors.text.link})})},74007:(k,R,e)=>{"use strict";e.d(R,{i:()=>a});var t=e(74848),n=e(32196),i=e(40845),s=e(14689),r=e(13471),g=e(61994);const a=({displayValues:o,links:h,header:f="Exemplar"})=>{const d=(0,i.of)(c),p=o.find(m=>m.name==="Time");return o=o.filter(m=>m.name!=="Time"),(0,t.jsxs)("div",{className:d.exemplarWrapper,children:[(0,t.jsxs)("div",{className:d.exemplarHeader,children:[(0,t.jsx)("span",{className:d.title,children:f}),p&&(0,t.jsx)("span",{className:d.time,children:(0,g.A)(p.valueString)})]}),(0,t.jsx)("div",{className:d.exemplarContent,children:o.map((m,v)=>(0,t.jsx)(r.B,{label:m.name,value:(0,g.A)(m.valueString),justify:"space-between",isPinned:!1},v))}),h&&h.length>0&&(0,t.jsx)("div",{className:d.exemplarFooter,children:h.map((m,v)=>(0,t.jsx)(s.R,{link:m,buttonProps:{size:"md"}},v))})]})},c=(o,h=0)=>({exemplarWrapper:(0,n.css)({display:"flex",flexDirection:"column",flex:1,gap:4,whiteSpace:"pre",borderRadius:o.shape.radius.default,background:o.colors.background.primary,border:`1px solid ${o.colors.border.weak}`,boxShadow:`0 4px 8px ${o.colors.background.primary}`}),exemplarHeader:(0,n.css)({display:"flex",flexDirection:"column",alignItems:"flex-start",gap:o.spacing(.5),color:o.colors.text.secondary,padding:o.spacing(1)}),time:(0,n.css)({color:o.colors.text.primary}),exemplarContent:(0,n.css)({display:"flex",flexDirection:"column",flex:1,gap:4,borderTop:`1px solid ${o.colors.border.medium}`,padding:o.spacing(1)}),exemplarFooter:(0,n.css)({display:"flex",flexDirection:"column",padding:o.spacing(1),borderTop:`1px solid ${o.colors.border.medium}`,gap:4}),linkButton:(0,n.css)({width:"fit-content"}),label:(0,n.css)({color:o.colors.text.secondary,fontWeight:400,textOverflow:"ellipsis",overflow:"hidden",marginRight:o.spacing(.5)}),value:(0,n.css)({fontWeight:500,textOverflow:"ellipsis",overflow:"hidden"}),title:(0,n.css)({fontWeight:o.typography.fontWeightMedium,overflow:"hidden",display:"inline-block",whiteSpace:"nowrap",textOverflow:"ellipsis",flexGrow:1})})},11085:(k,R,e)=>{"use strict";var t=e(6262),n=e(9423),i=e(7452),s=e(78624),r=e(4213),g=e(34796),a=e(13609),c=e(31193),o=e(17493),h=e(14792),f=e(15858),d=e(16495),p=e(62639),m=e(2543),v=e.n(m),l=e(96540),y=e(5338),u=e(47232),D=e(1933),E=e(69550),x=e(97497),P=e(96915),b=e(71733),M=e(17172),O=e(23509),I=e(39601),T=e(96937),C=e(61706),S=e(3591),A=e(63639),L=e(89191),N=e(19347),F=e(4402),w=e(3197),B=e(79396),U=e(14778),K=e(23172),V=e(63415),H=e(97152),Y=e(24308),X=e(46235),J=e(2913),q=e(94041),ae=e(32264),j=e(74848),te=e(11261),ne=e(85200),le=e(1173),z=e(28240),ee=e(18282),se=e(57934),ie=e(73376),Z=e(14186),oe=e(94354),ce=e(90613),ye=e(55852),re=e(91847);function ue(W){if(W in re.uk){const{name:_,getHelperDocs:G,links:de}=re.uk[W],xe=G(re.g_.UIImage),Me=De(xe);if(de?.length){const we=de.map(ke=>`
  Or visit <a href="${ke.url}" target="_blank">${ke.title}</a>

  `).join("");return{name:_,helperDocs:`
        ${Me}
        ${(0,re.$n)()}
  ${we}
        `}}return{name:_,helperDocs:`
      ${Me}
      ${(0,re.$n)()}
      `}}return{name:"No documentation found",helperDocs:(0,re.$n)()}}const De=W=>W.replace(/\[(.*?)\]\(#.*?\)/g,"$1").replace(/\[[^\]]*\]\[\]/g,"");var ge=e(39268),Te=e(90182),Le=e(83077),Ye=e(91890),je=e(72574),Ze=e(10354),Ne=e(88841),Pe=e(94397);function Ue(W,_){switch(_.type){case te.PU.boolean:return(0,m.isUndefined)(W)?!1:$e(W);case te.PU.number:return isNaN(W)?0:parseFloat(W);case te.PU.string:return W?String(W):"";default:return W}}const $e=W=>(0,m.isString)(W)?!(W[0]==="F"||W[0]==="f"||W[0]==="0"):!!W;function ze(W){return function({options:G,onChange:de,field:xe}){const{validator:Me,converter:we=Ue}=W,{value:ke}=G,[Xe,ht]=(0,l.useState)(!Me(ke)),bt=(0,je.w)().getVariables().map(Ut=>({value:Ut.name,label:Ut.label||Ut.name,origin:Ye.$0.Template})),Kt=(0,l.useCallback)(Ut=>{ht(!Me(Ut.currentTarget.value))},[ht,Me]),Rt=(0,l.useCallback)(Ut=>{if(Xe)return;const{value:hn}=Ut.currentTarget;de({...G,value:we(hn,xe)})},[G,de,Xe,xe,we]),Ct=(0,l.useCallback)(Ut=>{ht(!Me(Ut)),de({...G,value:Ut})},[ht,Me,de,G]);return ae.$.featureToggles.transformationsVariableSupport?(0,j.jsx)(Ne.y,{invalid:Xe,value:ke,error:"Value needs to be an integer or a variable",onChange:Ct,placeholder:"Value or variable",suggestions:bt}):(0,j.jsx)(Ze.p,{className:"flex-grow-1",invalid:Xe,defaultValue:String(G.value),placeholder:"Value",onChange:Kt,onBlur:Rt})}}const qe=()=>[{name:"Is greater",id:le.Js.greater,component:ze({validator:Pe.N_})},{name:"Is greater or equal",id:le.Js.greaterOrEqual,component:ze({validator:Pe.N_})},{name:"Is lower",id:le.Js.lower,component:ze({validator:Pe.N_})},{name:"Is lower or equal",id:le.Js.lowerOrEqual,component:ze({validator:Pe.N_})},{name:"Is equal",id:le.Js.equal,component:ze({validator:()=>!0})},{name:"Is not equal",id:le.Js.notEqual,component:ze({validator:()=>!0})},{name:"Is Substring",id:le.Js.substring,component:ze({validator:()=>!0})},{name:"Is not substring",id:le.Js.notSubstring,component:ze({validator:()=>!0})}],dt=()=>null,vt=()=>[{name:"Is null",id:le.Js.isNull,component:dt},{name:"Is not null",id:le.Js.isNotNull,component:dt}];var yt=e(76892);function st(W){return function({options:G,onChange:de,field:xe}){const{validator:Me}=W,[we,ke]=(0,l.useState)({from:!Me(G.from),to:!Me(G.to)}),ht=(0,je.w)().getVariables().map(Rt=>({value:Rt.name,label:Rt.label||Rt.name,origin:Ye.$0.Template})),mt=(0,l.useCallback)((Rt,Ct)=>{ke({...we,[Ct]:!Me(Rt.currentTarget.value)})},[ke,Me,we]),bt=(0,l.useCallback)((Rt,Ct)=>{if(we[Ct])return;const{value:Ut}=Rt.currentTarget;de({...G,[Ct]:Ue(Ut,xe)})},[G,de,we,xe]),Kt=(0,l.useCallback)((Rt,Ct)=>{const Ut=!Me(Rt);ke({...we,[Ct]:Ut}),!Ut&&de({...G,[Ct]:Rt})},[G,de,we,ke,Me]);return ae.$.featureToggles.transformationsVariableSupport?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(Ne.y,{value:String(G.from),invalid:we.from,error:"Value needs to be an integer or a variable",placeholder:"From",onChange:Rt=>Kt(Rt,"from"),suggestions:ht}),(0,j.jsx)(yt.c,{children:"and"}),(0,j.jsx)(Ne.y,{invalid:we.to,error:"Value needs to be an integer or a variable",value:String(G.to),placeholder:"To",suggestions:ht,onChange:Rt=>Kt(Rt,"to")})]}):(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(Ze.p,{invalid:we.from,defaultValue:String(G.from),placeholder:"From",onChange:Rt=>mt(Rt,"from"),onBlur:Rt=>bt(Rt,"from")}),(0,j.jsx)(yt.c,{children:"and"}),(0,j.jsx)(Ze.p,{invalid:we.to,defaultValue:String(G.to),placeholder:"To",onChange:Rt=>mt(Rt,"to"),onBlur:Rt=>bt(Rt,"to")})]})}}const Ve=()=>[{name:"Is between",id:le.Js.between,component:st({validator:Pe.N_})}];function pe(W){return function({options:G,onChange:de,field:xe}){const{validator:Me,converter:we=Ue}=W,{value:ke}=G,[Xe,ht]=(0,l.useState)(!Me(ke)),bt=(0,je.w)().getVariables().map(Ut=>({value:Ut.name,label:Ut.label||Ut.name,origin:Ye.$0.Template})),Kt=(0,l.useCallback)(Ut=>{ht(!Me(Ut.currentTarget.value))},[ht,Me]),Rt=(0,l.useCallback)(Ut=>{ht(!Me(Ut)),de({...G,value:Ut})},[ht,Me,de,G]),Ct=(0,l.useCallback)(Ut=>{if(Xe)return;const{value:hn}=Ut.currentTarget;de({...G,value:we(hn,xe)})},[G,de,Xe,xe,we]);return ae.$.featureToggles.transformationsVariableSupport?(0,j.jsx)(Ne.y,{invalid:Xe,value:ke,onChange:Rt,placeholder:"Value or variable",suggestions:bt}):(0,j.jsx)(Ze.p,{className:"flex-grow-1",invalid:Xe,defaultValue:String(G.value),placeholder:"Value",onChange:Kt,onBlur:Ct})}}const Ee=()=>[{name:"Regex",id:le.Js.regex,component:pe({validator:()=>!0,converter:W=>String(W)})}],me=new Le.O(()=>[...qe(),...vt(),...Ve(),...Ee()]),ve=W=>{const{onDelete:_,onChange:G,filter:de,fieldsInfo:xe}=W,{fieldsAsOptions:Me,fieldByDisplayName:we}=xe,ke=Oe(de,Me)??"",Xe=we[ke],ht=Xe?Se(Xe):[],mt=Ie(de,ht),bt=me.getIfExists(mt),Kt=(0,l.useCallback)(Ut=>{Ut?.value&&G({...de,fieldName:Ut.value})},[G,de]),Rt=(0,l.useCallback)(Ut=>{if(!Ut?.value)return;const hn=Ut.value,Zn=ne.hI.get(hn).getDefaultOptions(Xe);G({...de,config:{id:hn,options:Zn}})},[G,de,Xe]),Ct=(0,l.useCallback)(Ut=>{G({...de,config:{...de.config,options:Ut}})},[G,de]);return!Xe||!bt||!bt.component?null:(0,j.jsxs)(ge.C,{children:[(0,j.jsx)(Z.I,{label:"Field",labelWidth:14,children:(0,j.jsx)(Te.l6,{className:"min-width-15 max-width-24",placeholder:"Field Name",options:Me,value:de.fieldName,onChange:Kt})}),(0,j.jsx)(Z.I,{label:"Match",children:(0,j.jsx)(Te.l6,{className:"width-12",placeholder:"Select test",options:ht,value:mt,onChange:Rt})}),(0,j.jsx)(Z.I,{label:"Value",grow:!0,children:(0,j.jsx)(bt.component,{field:Xe,options:de.config.options??{},onChange:Ct})}),(0,j.jsx)(ce.a,{marginBottom:.5,children:(0,j.jsx)(ye.$n,{icon:"times",onClick:_,variant:"secondary"})})]})},Se=W=>{const _=[];for(const G of ne.hI.list())!G.isApplicable(W)||!me.getIfExists(G.id)||_.push({value:G.id,label:G.name,description:G.description});return _},Ie=(W,_)=>{const G=_.find(de=>de.value===W.config.id);if(G&&G.value)return G.value;if(_[0]?.value)return _[0]?.value},Oe=(W,_)=>{const G=_.find(de=>de.value===W.fieldName);if(G&&G.value)return G.value;if(_[0]?.value)return _[0]?.value},Re=[{label:"Include",value:ie.j4.include},{label:"Exclude",value:ie.j4.exclude}],he=[{label:"Match all",value:ie.Sm.all},{label:"Match any",value:ie.Sm.any}],Ce=W=>{const{input:_,options:G,onChange:de}=W,xe=et(_),Me=(0,l.useCallback)(()=>{const mt=_[0],bt=mt.fields.find(Ct=>Ct.type!==te.PU.time);if(!bt)return;const Kt=(0,m.cloneDeep)(G.filters),Rt=ne.hI.get(le.Js.isNull);Kt.push({fieldName:(0,z.Ct)(bt,mt,_),config:{id:Rt.id,options:Rt.getDefaultOptions(bt)}}),de({...G,filters:Kt})},[de,G,_]),we=(0,l.useCallback)(mt=>{let bt=(0,m.cloneDeep)(G.filters);bt.splice(mt,1),de({...G,filters:bt})},[G,de]),ke=(0,l.useCallback)((mt,bt)=>{let Kt=(0,m.cloneDeep)(G.filters);Kt[bt]=mt,de({...G,filters:Kt})},[G,de]),Xe=(0,l.useCallback)(mt=>{de({...G,type:mt??ie.j4.include})},[G,de]),ht=(0,l.useCallback)(mt=>{de({...G,match:mt??ie.Sm.all})},[G,de]);return(0,j.jsxs)("div",{children:[(0,j.jsx)(Z.I,{label:"Filter type",labelWidth:16,children:(0,j.jsx)("div",{className:"width-15",children:(0,j.jsx)(oe.z,{options:Re,value:G.type,onChange:Xe,fullWidth:!0})})}),(0,j.jsx)(Z.I,{label:"Conditions",labelWidth:16,children:(0,j.jsx)("div",{className:"width-15",children:(0,j.jsx)(oe.z,{options:he,value:G.match,onChange:ht,fullWidth:!0})})}),(0,j.jsxs)(ce.a,{paddingLeft:2,children:[G.filters.map((mt,bt)=>(0,j.jsx)(ve,{filter:mt,fieldsInfo:xe,onChange:Kt=>ke(Kt,bt),onDelete:()=>we(bt)},bt)),(0,j.jsx)(ye.$n,{icon:"plus",size:"sm",onClick:Me,variant:"secondary",children:"Add condition"})]})]})},We={id:ee.F.filterByValue,editor:Ce,transformation:se.c.filterByValueTransformer,name:se.c.filterByValueTransformer.name,description:"Removes rows of the query results using user-defined filters. This is useful if you can not filter your data in the data source.",categories:new Set([x.m.Filter]),help:ue(ee.F.filterByValue).helperDocs},et=W=>(0,l.useMemo)(()=>{const _={fieldsAsOptions:[],fieldByDisplayName:{}};return Array.isArray(W)?W.reduce((G,de)=>de.fields.reduce((xe,Me)=>{const we=(0,z.Ct)(Me,de,W);return xe.fieldByDisplayName[we]||(xe.fieldsAsOptions.push({label:we,value:we,type:Me.type}),xe.fieldByDisplayName[we]=Me),xe},G),_):_},[W]);var rt=e(43429),nt=e(60264),gt=e(48192),xt=e(66211),St=e(54612);function zt(W,_){const G={data:W.input,options:W.options},de=new gt.C({id:"root",title:"root"}),xe=we=>{if(we?.length){const ke=we[0];let Xe=de.categories.find(ht=>ht.props.id===ke);return Xe||(Xe=new gt.C({id:ke,title:ke}),de.categories.push(Xe)),Xe}return de},Me={getValue:we=>(0,m.get)(W.options,we),onChange:(we,ke)=>{W.onChange((0,St.Sf)(W.options,we,ke))}};return(0,xt.g5)(_,Me,xe,G),de}function Nt(W){const _={data:[],options:{}},G={},de=new nt.pv;W(de,_);for(const xe of de.getItems())xe.defaultValue!=null&&(0,m.set)(G,xe.path,xe.defaultValue);return G}var Vt=e(27825),en=e(3290);const Je=(W,_)=>{const G=_.options??{};(0,Vt.J)("",W,G)},ct=W=>{(0,l.useEffect)(()=>{if(!W.options.xBuckets?.mode){const G=Nt(Je);W.onChange({...G,...W.options})}});const _=zt(W,Je);return(0,j.jsx)("div",{children:(0,j.jsx)("div",{children:_.items.map(G=>G.render())})})},ot={id:en.wY.id,editor:ct,transformation:en.wY,name:en.wY.name,description:en.wY.description,state:rt.pn.alpha,categories:new Set([x.m.CreateNewVisualization]),help:ue(en.wY.id).helperDocs};var Qe=e(32196),pt=e(40845),Pt=e(84349),At=e(75059),mn=e(42734),Pn=e(24293),fn=e(28802),Rn=e(50082),Kn=e(25019);function Bt(W,_,G){const de={},xe={};for(const Me of W.fields){const we=(0,z.Ct)(Me,W),ke=G.index[we],Xe=ke.handler;if(!Xe)continue;const ht=Me.values[_];if(ht==null)continue;const mt=Xe.processor(ht,de,xe,ke.handlerArguments);mt!=null&&(de[Xe.targetProperty??Xe.key]=mt)}return xe.mappingValues&&(de.mappings=Cn(xe)),de}var an=(W=>(W.Name="field.name",W.Value="field.value",W.Label="field.label",W.Ignore="__ignore",W))(an||{});const tn=[{key:"field.name",name:"Field name",processor:()=>{}},{key:"field.value",name:"Field value",processor:()=>{}},{key:"field.label",name:"Field label",processor:()=>{}},{key:"__ignore",name:"Ignore",processor:()=>{}},{key:"max",processor:Et},{key:"min",processor:Et},{key:"unit",processor:W=>W.toString()},{key:"decimals",processor:Et},{key:"displayName",name:"Display name",processor:W=>W.toString()},{key:"color",processor:W=>({fixedColor:W,mode:Pn.Y.Fixed})},{key:"threshold1",name:"Threshold",targetProperty:"thresholds",processor:(W,_,G,de)=>{const xe=(0,fn.t)(W);if(!isNaN(xe))return _.thresholds||(_.thresholds={mode:Rn.O.Absolute,steps:[{value:-1/0,color:"green"}]}),_.thresholds.steps.push({value:xe,color:de.threshold?.color??"red"}),_.thresholds}},{key:"mappings.value",name:"Value mappings / Value",targetProperty:"mappings",defaultReducer:At.gy.allValues,processor:(W,_,G)=>{if((0,m.isArray)(W))return G.mappingValues=W,_.mappings}},{key:"mappings.color",name:"Value mappings / Color",targetProperty:"mappings",defaultReducer:At.gy.allValues,processor:(W,_,G)=>{if((0,m.isArray)(W))return G.mappingColors=W,_.mappings}},{key:"mappings.text",name:"Value mappings / Display text",targetProperty:"mappings",defaultReducer:At.gy.allValues,processor:(W,_,G)=>{if((0,m.isArray)(W))return G.mappingTexts=W,_.mappings}}];function Cn(W){const _={type:Kn.d.ValueToText,options:{}};if(!W.mappingValues)return[];for(let G=0;G<W.mappingValues.length;G++){const de=W.mappingValues[G];de!=null&&(_.options[de.toString()]={color:W.mappingColors&&W.mappingColors[G],text:W.mappingTexts&&W.mappingTexts[G],index:G})}return[_]}let xn=null;function Vn(){if(xn===null){xn={};for(const W of tn)xn[W.key]=W}return xn}function Et(W){const _=(0,fn.t)(W);if(!isNaN(_))return _}function Ft(W,_){for(const G of _)if(W===G.fieldName)return G.handlerKey;return W.toLowerCase()}function Gt(W){return W?Vn()[W]:null}function ln(W,_,G){const de={index:{}};let xe=_.find(we=>we.handlerKey==="field.name"),Me=_.find(we=>we.handlerKey==="field.value");for(const we of W.fields){const ke=(0,z.Ct)(we,W),Xe=_.find(bt=>bt.fieldName===ke),ht=Xe?Xe.handlerKey:ke.toLowerCase();let mt=Gt(ht);G&&(mt?(mt.key==="field.name"&&(de.nameField=we),mt.key==="field.value"&&(de.valueField=we)):Xe||(!de.nameField&&!xe&&we.type===te.PU.string&&(de.nameField=we,mt=Gt("field.name")),!de.valueField&&!Me&&we.type===te.PU.number&&(de.valueField=we,mt=Gt("field.value")))),!mt&&G&&(mt=Gt("field.label")),de.index[ke]={automatic:!Xe,handler:mt,handlerArguments:Xe?.handlerArguments??{},reducerId:Xe?.reducerId??mt?.defaultReducer??At.gy.lastNotNull}}return de}var qt=e(83598);function cn(W){switch(W){case"threshold1":return!0;default:return!1}}function En({handlerArguments:W,handlerKey:_,onChange:G}){const de=xe=>{G(xe?{...W,threshold:{...W.threshold,color:xe}}:{...W,threshold:void 0})};return(0,j.jsx)(j.Fragment,{children:_==="threshold1"&&(0,j.jsx)(Ze.p,{type:"text",value:"Threshold color","aria-label":"Threshold color",disabled:!0,width:20,prefix:(0,j.jsx)(qt.sk,{color:W.threshold?.color??"red",onChange:de,enableNamedColors:!0})})})}function Sn({frame:W,mappings:_,onChange:G,withReducers:de,withNameAndValue:xe}){const Me=(0,pt.of)(Nn),we=Tn(W,_,xe),ke=tn.map(Kt=>Wn(Kt,!1)),Xe=_.reduce((Kt,Rt)=>Kt||cn(Rt.handlerKey),!1),ht=(Kt,Rt)=>{const Ct=_.findIndex(Ut=>Ut.fieldName===Kt.fieldName);if(Rt)if(Ct!==-1){const Ut=[..._];Ut.splice(Ct,1,{..._[Ct],handlerKey:Rt.value}),G(Ut)}else G([..._,{fieldName:Kt.fieldName,handlerKey:Rt.value}]);else G(Ct!==-1?_.filter((Ut,hn)=>hn!==Ct):[..._,{fieldName:Kt.fieldName,handlerKey:"__ignore"}])},mt=(Kt,Rt)=>{const Ct=_.findIndex(Ut=>Ut.fieldName===Kt.fieldName);if(Ct!==-1){const Ut=[..._];Ut.splice(Ct,1,{..._[Ct],reducerId:Rt}),G(Ut)}else G([..._,{fieldName:Kt.fieldName,handlerKey:Kt.handlerKey,reducerId:Rt}])},bt=(Kt,Rt)=>{const Ct=_.findIndex(Ut=>Ut.fieldName===Kt.fieldName);if(Ct!==-1){const Ut=[..._];Ut.splice(Ct,1,{..._[Ct],handlerArguments:Rt}),G(Ut)}else G([..._,{fieldName:Kt.fieldName,handlerKey:Kt.handlerKey,handlerArguments:Rt}])};return(0,j.jsxs)("table",{className:Me.table,children:[(0,j.jsx)("thead",{children:(0,j.jsxs)("tr",{children:[(0,j.jsx)("th",{children:"Field"}),(0,j.jsx)("th",{children:"Use as"}),de&&(0,j.jsx)("th",{children:"Select"}),Xe&&(0,j.jsx)("th",{children:"Additional settings"})]})}),(0,j.jsx)("tbody",{children:we.map(Kt=>(0,j.jsxs)("tr",{children:[(0,j.jsx)("td",{className:Me.labelCell,children:Kt.fieldName}),(0,j.jsx)("td",{className:Me.selectCell,"data-testid":`${Kt.fieldName}-config-key`,children:(0,j.jsx)(Te.l6,{options:ke,value:Kt.configOption,placeholder:Kt.placeholder,isClearable:!0,onChange:Rt=>ht(Kt,Rt)})}),de&&(0,j.jsx)("td",{"data-testid":`${Kt.fieldName}-reducer`,className:Me.selectCell,children:(0,j.jsx)(mn.S,{stats:[Kt.reducerId],defaultStat:Kt.reducerId,onChange:Rt=>mt(Kt,Rt[0])})}),Xe&&(0,j.jsx)("td",{"data-testid":`${Kt.fieldName}-handler-arg`,className:Me.selectCell,children:(0,j.jsx)(En,{handlerKey:Kt.handlerKey,handlerArguments:Kt.handlerArguments,onChange:Rt=>bt(Kt,Rt)})})]},Kt.fieldName))})]})}function Tn(W,_,G){const de=[],xe=ln(W,_??[],G);for(const Me of W.fields){const we=(0,z.Ct)(Me,W),ke=xe.index[we],Xe=Wn(ke.handler,ke.automatic);de.push({fieldName:we,configOption:ke.automatic?null:Xe,placeholder:ke.automatic?Xe?.label:"Choose",handlerKey:ke.handler?.key??null,reducerId:ke.reducerId,handlerArguments:ke.handlerArguments})}for(const Me of _)if(!de.find(we=>we.fieldName===Me.fieldName)){const we=Gt(Me.handlerKey);de.push({fieldName:Me.fieldName,handlerKey:Me.handlerKey,configOption:Wn(we,!1),missingInFrame:!0,reducerId:Me.reducerId??At.gy.lastNotNull,handlerArguments:{}})}return Object.values(de)}function Wn(W,_){if(!W)return null;let G=W.name??(0,m.capitalize)(W.key);return _&&(G=`${G} (auto)`),{label:G,value:W.key}}const Nn=W=>({table:(0,Qe.css)`
    margin-top: ${W.spacing(1)};

    td,
    th {
      border-right: 4px solid ${W.colors.background.primary};
      border-bottom: 4px solid ${W.colors.background.primary};
      white-space: nowrap;
    }
    th {
      font-size: ${W.typography.bodySmall.fontSize};
      line-height: ${W.spacing(4)};
      padding: ${W.spacing(0,1)};
    }
  `,labelCell:(0,Qe.css)`
    font-size: ${W.typography.bodySmall.fontSize};
    background: ${W.colors.background.secondary};
    padding: ${W.spacing(0,1)};
    max-width: 400px;
    overflow: hidden;
    text-overflow: ellipsis;
    min-width: 140px;
  `,selectCell:(0,Qe.css)`
    padding: 0;
    min-width: 161px;
  `});var Tt=e(81160);function Wt(W,_){let G=null;for(const ke of _)if(ke.refId===W.configRefId){G=ke;break}if(!G)return _;const de={fields:[],length:1},xe=ln(G,W.mappings??[],!1);for(const ke of G.fields){const Xe={...ke},ht=(0,z.Ct)(ke,G),mt=xe.index[ht],bt=(0,At.Nw)({field:ke,reducers:[mt.reducerId]});Xe.values=[bt[mt.reducerId]],de.fields.push(Xe)}const Me=[],we=(0,ne.NS)(W.applyTo||{id:le.Ct.numeric});for(const ke of _){if(ke===G&&_.length>1)continue;const Xe={fields:[],length:ke.length,refId:ke.refId};for(const ht of ke.fields)if(we(ht,ke,_)){const mt=Bt(de,0,xe);Xe.fields.push({...ht,config:{...ht.config,...mt}})}else Xe.fields.push(ht);Me.push(Xe)}return Me}const jt={id:ee.F.configFromData,name:"Config from query results",description:"Set unit, min, max and more from data.",defaultOptions:{configRefId:"config",mappings:[]},operator:W=>_=>_.pipe((0,Tt.T)(G=>Wt(W,G)))};function ut({input:W,onChange:_,options:G}){const de=(0,pt.of)(jn),xe=W.map(Rt=>Rt.refId).filter(Rt=>Rt!=null).map(Rt=>({label:Rt,value:Rt})),Me=G.configRefId||"config",we=G.applyTo??{id:le.Ct.byType,options:"number"},ke=Pt.g.get(we.id),Xe=W.find(Rt=>Rt.refId===Me),ht=Rt=>{_({...G,configRefId:Rt.value||"config"})},mt=Rt=>{_({...G,applyTo:{id:Rt.value}})},bt=Rt=>{_({...G,applyTo:{id:we.id,options:Rt}})},Kt=Pt.g.list().filter(Rt=>!Rt.excludeFromPicker).map(Rt=>({label:Rt.name,value:Rt.id,description:Rt.description}));return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(ge.C,{children:(0,j.jsx)(Z.I,{label:"Config query",labelWidth:20,children:(0,j.jsx)(Te.l6,{onChange:ht,options:xe,value:Me,width:30})})}),(0,j.jsx)(ge.C,{children:(0,j.jsx)(Z.I,{label:"Apply to",labelWidth:20,children:(0,j.jsx)(Te.l6,{onChange:mt,options:Kt,value:we.id,width:30})})}),(0,j.jsx)(ge.C,{children:(0,j.jsx)(Z.I,{label:"Apply to options",labelWidth:20,className:de.matcherOptions,children:(0,j.jsx)(ke.component,{matcher:ke.matcher,data:W,options:we.options,onChange:bt})})}),(0,j.jsx)(ge.C,{children:Xe&&(0,j.jsx)(Sn,{frame:Xe,mappings:G.mappings,onChange:Rt=>_({...G,mappings:Rt}),withReducers:!0})})]})}const Zt={id:jt.id,editor:ut,transformation:jt,name:jt.name,description:jt.description,state:rt.pn.beta,categories:new Set([x.m.CalculateNewFields]),help:ue(jt.id).helperDocs},jn=W=>({matcherOptions:(0,Qe.css)`
    min-width: 404px;
  `});var Xn=e(62467),Qn=e(58307),Fn=e(66350),qn=e(15292),js=e(11710);const ys=16,Ps=W=>{const{options:_,onChange:G}=W,{binary:de}=_;let xe=!de?.left,Me=!de?.right;const we=W.names.map(Ct=>(Ct===de?.left&&(xe=!0),Ct===de?.right&&(Me=!0),{label:Ct,value:Ct})),ke=xe?we:[...we,{label:de?.left,value:de?.left}],Xe=Me?we:[...we,{label:de?.right,value:de?.right}],ht=js.b.list().map(Ct=>({label:Ct.binaryOperationID,value:Ct.binaryOperationID})),mt=Ct=>{G({..._,mode:Fn.UY.BinaryOperation,binary:Ct})},bt=Ct=>{mt({...de,left:Ct.value})},Kt=Ct=>{mt({...de,right:Ct.value})},Rt=Ct=>{mt({...de,operator:Ct.value})};return(0,j.jsx)(j.Fragment,{children:(0,j.jsxs)(ge.C,{children:[(0,j.jsx)(Z.I,{label:"Operation",labelWidth:ys,children:(0,j.jsx)(Te.l6,{allowCustomValue:!0,placeholder:"Field or number",options:ke,className:"min-width-18",value:de?.left,onChange:bt})}),(0,j.jsx)(Z.I,{children:(0,j.jsx)(Te.l6,{className:"width-4",options:ht,value:de?.operator??ht[0].value,onChange:Rt})}),(0,j.jsx)(Z.I,{children:(0,j.jsx)(Te.l6,{allowCustomValue:!0,placeholder:"Field or number",className:"min-width-10",options:Xe,value:de?.right,onChange:Kt})})]})})},es=W=>{const{names:_,onChange:G,options:de}=W,{cumulative:xe}=de,Me=_.map(ht=>({label:ht,value:ht})),we=ht=>{const mt=ht.length?ht[0]:At.gy.sum;ke({...xe,reducer:mt})},ke=ht=>{G({...de,mode:Fn.UY.CumulativeFunctions,cumulative:ht})},Xe=ht=>{ke({...xe,field:ht.value})};return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(Z.I,{label:"Field",labelWidth:ys,children:(0,j.jsx)(Te.l6,{placeholder:"Field",options:Me,className:"min-width-18",value:xe?.field,onChange:Xe})}),(0,j.jsx)(Z.I,{label:"Calculation",labelWidth:ys,children:(0,j.jsx)(mn.S,{allowMultiple:!1,className:"width-18",stats:[xe?.reducer||At.gy.sum],onChange:we,defaultStat:At.gy.sum,filterOptions:ht=>ht.id===At.gy.sum||ht.id===At.gy.mean})})]})},_s=W=>{const{options:_,onChange:G}=W,{index:de}=_,xe=Me=>{G({..._,index:{asPercentile:Me.currentTarget.checked}})};return(0,j.jsx)(j.Fragment,{children:(0,j.jsx)(Z.I,{labelWidth:ys,label:"As percentile",tooltip:"Transform the row index as a percentile.",children:(0,j.jsx)(qn.K,{value:!!de?.asPercentile,onChange:xe})})})};var ca=e(66864),Ks=e(92174);const Zs=W=>{const{names:_,selected:G,onChange:de,options:xe}=W,{reduce:Me}=xe,we=mt=>{de({...xe,reduce:mt})},ke=mt=>{G.indexOf(mt)>-1?Xe(G.filter(bt=>bt!==mt)):Xe([...G,mt])},Xe=mt=>{we({...Me,include:mt})},ht=mt=>{const bt=mt.length?mt[0]:At.gy.sum,{reduce:Kt}=xe;we({...Kt,reducer:bt})};return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(Z.I,{label:"Operation",labelWidth:ys,grow:!0,children:(0,j.jsx)(ca.Gy,{spacing:"xs",align:"flex-start",wrap:!0,children:_.map((mt,bt)=>(0,j.jsx)(Ks.m,{onClick:()=>{ke(mt)},label:mt,selected:G.indexOf(mt)>-1},`${mt}/${bt}`))})}),(0,j.jsx)(Z.I,{label:"Calculation",labelWidth:ys,children:(0,j.jsx)(mn.S,{allowMultiple:!1,className:"width-18",stats:[Me?.reducer||At.gy.sum],onChange:ht,defaultStat:At.gy.sum})})]})};var nr=e(27618);const lr=W=>{const{options:_,onChange:G}=W,{unary:de}=_,xe=bt=>{G({..._,mode:Fn.UY.UnaryOperation,unary:bt})},Me=bt=>{xe({...de,operator:bt.value})},we=bt=>{xe({...de,fieldName:bt.value})};let ke=!de?.fieldName;const Xe=W.names.map(bt=>(bt===de?.fieldName&&(ke=!0),{label:bt,value:bt})),ht=nr.j.list().map(bt=>({label:bt.unaryOperationID,value:bt.unaryOperationID})),mt=ke?Xe:[...Xe,{label:de?.fieldName,value:de?.fieldName}];return(0,j.jsx)(j.Fragment,{children:(0,j.jsxs)(ge.C,{children:[(0,j.jsx)(Z.I,{label:"Operation",labelWidth:ys,children:(0,j.jsx)(Te.l6,{options:ht,value:de?.operator??ht[0].value,onChange:Me})}),(0,j.jsx)(Z.I,{label:"(",labelWidth:2,children:(0,j.jsx)(Te.l6,{placeholder:"Field",className:"min-width-11",options:mt,value:de?.fieldName,onChange:we})}),(0,j.jsx)(yt.c,{width:2,children:")"})]})})};var ga=e(60188);const $a=W=>{const{options:_,names:G,onChange:de}=W,{window:xe}=_,Me=G.map(Ct=>({label:Ct,value:Ct})),we=[{label:"Trailing",value:Fn.ip.Trailing},{label:"Centered",value:Fn.ip.Centered}],ke=[{label:"Percentage",value:Fn.Bp.Percentage},{label:"Fixed",value:Fn.Bp.Fixed}],Xe=Ct=>{de({..._,mode:Fn.UY.WindowFunctions,window:Ct})},ht=Ct=>{Xe({...xe,field:Ct.value})},mt=Ct=>{Xe({...xe,windowSize:Ct&&xe?.windowSizeMode===Fn.Bp.Percentage?Ct/100:Ct})},bt=Ct=>{Xe({...xe,windowSize:xe?.windowSize?Ct===Fn.Bp.Percentage?xe.windowSize/100:xe.windowSize*100:void 0,windowSizeMode:Ct})},Kt=Ct=>{const Ut=Ct.length?Ct[0]:At.gy.sum;Xe({...xe,reducer:Ut})},Rt=Ct=>{Xe({...xe,windowAlignment:Ct})};return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(Z.I,{label:"Field",labelWidth:ys,children:(0,j.jsx)(Te.l6,{placeholder:"Field",options:Me,className:"min-width-18",value:xe?.field,onChange:ht})}),(0,j.jsx)(Z.I,{label:"Calculation",labelWidth:ys,children:(0,j.jsx)(mn.S,{allowMultiple:!1,className:"width-18",stats:[xe?.reducer||At.gy.mean],onChange:Kt,defaultStat:At.gy.mean,filterOptions:Ct=>Ct.id===At.gy.mean||Ct.id===At.gy.variance||Ct.id===At.gy.stdDev})}),(0,j.jsx)(Z.I,{label:"Type",labelWidth:ys,children:(0,j.jsx)(oe.z,{value:xe?.windowAlignment??Fn.ip.Trailing,options:we,onChange:Rt})}),(0,j.jsx)(Z.I,{label:"Window size mode",children:(0,j.jsx)(oe.z,{value:xe?.windowSizeMode??Fn.Bp.Percentage,options:ke,onChange:bt})}),(0,j.jsx)(Z.I,{label:xe?.windowSizeMode===Fn.Bp.Percentage?"Window size %":"Window size",labelWidth:ys,tooltip:xe?.windowSizeMode===Fn.Bp.Percentage?"Set the window size as a percentage of the total data":"Window size",children:(0,j.jsx)(ga.Q,{placeholder:"Auto",min:.1,value:xe?.windowSize&&xe.windowSizeMode===Fn.Bp.Percentage?xe.windowSize*100:xe?.windowSize,onChange:mt})})]})},Za=[{value:Fn.UY.BinaryOperation,label:"Binary operation"},{value:Fn.UY.UnaryOperation,label:"Unary operation"},{value:Fn.UY.ReduceRow,label:"Reduce row"},{value:Fn.UY.Index,label:"Row index"}];ae.$.featureToggles.addFieldFromCalculationStatFunctions&&Za.push({value:Fn.UY.CumulativeFunctions,label:"Cumulative functions"},{value:Fn.UY.WindowFunctions,label:"Window functions"});const mr=new Set([te.PU.time,te.PU.number,te.PU.string]),Va=W=>{const{options:_,onChange:G,input:de}=W,xe=_?.reduce?.include,[Me,we]=(0,l.useState)({names:[],selected:[]});(0,l.useEffect)(()=>{const Ct={interpolate:hn=>hn},Ut=(0,Xn.of)(de).pipe(se.c.ensureColumnsTransformer.operator(null,Ct),Xe(),ke(),ht(xe||[])).subscribe(({selected:hn,names:Zn})=>{we({names:Zn,selected:hn})});return()=>{Ut.unsubscribe()}},[de,xe]);const ke=()=>{if(!ae.$.featureToggles.transformationsVariableSupport)return Qn.D;const Ct=(0,je.w)();return Ut=>Ut.pipe((0,Tt.T)(hn=>(hn.push(...Ct.getVariables().map(Zn=>"$"+Zn.name)),hn)))},Xe=()=>Ct=>Ct.pipe((0,Tt.T)(Ut=>{const hn=[],Zn={};for(const As of Ut)for(const Ds of As.fields){if(!mr.has(Ds.type))continue;const Fs=(0,z.Ct)(Ds,As,Ut);Zn[Fs]||(Zn[Fs]=!0,hn.push(Fs))}return hn})),ht=Ct=>Ut=>Ut.pipe((0,Tt.T)(hn=>{if(!Ct.length)return{names:hn,selected:[]};const Zn=[],As=[];for(const Ds of hn)Ct.includes(Ds)&&As.push(Ds),Zn.push(Ds);return{names:Zn,selected:As}})),mt=Ct=>{G({..._,replaceFields:Ct.currentTarget.checked})},bt=Ct=>{const Ut=Ct.value??Fn.UY.BinaryOperation;Ut===Fn.UY.WindowFunctions&&(_.window=_.window??Fn.Uj),G({..._,mode:Ut})},Kt=Ct=>{G({..._,alias:Ct.target.value})},Rt=_.mode??Fn.UY.BinaryOperation;return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(Z.I,{labelWidth:ys,label:"Mode",children:(0,j.jsx)(Te.l6,{className:"width-18",options:Za,value:Za.find(Ct=>Ct.value===Rt),onChange:bt})}),Rt===Fn.UY.BinaryOperation&&(0,j.jsx)(Ps,{options:_,names:Me.names,onChange:W.onChange}),Rt===Fn.UY.UnaryOperation&&(0,j.jsx)(lr,{names:Me.names,options:_,onChange:W.onChange}),Rt===Fn.UY.ReduceRow&&(0,j.jsx)(Zs,{names:Me.names,selected:Me.selected,options:_,onChange:W.onChange}),Rt===Fn.UY.CumulativeFunctions&&(0,j.jsx)(es,{names:Me.names,options:_,onChange:W.onChange}),Rt===Fn.UY.WindowFunctions&&(0,j.jsx)($a,{names:Me.names,options:_,onChange:W.onChange}),Rt===Fn.UY.Index&&(0,j.jsx)(_s,{options:_,onChange:W.onChange}),(0,j.jsx)(Z.I,{labelWidth:ys,label:"Alias",children:(0,j.jsx)(Ze.p,{className:"width-18",value:_.alias??"",placeholder:(0,Fn.sw)(_),onChange:Kt})}),(0,j.jsx)(Z.I,{labelWidth:ys,label:"Replace all fields",children:(0,j.jsx)(qn.K,{value:!!_.replaceFields,onChange:mt})})]})},Ea={id:ee.F.calculateField,editor:Va,transformation:se.c.calculateFieldTransformer,name:se.c.calculateFieldTransformer.name,description:"Use the row values to calculate a new field.",categories:new Set([x.m.CalculateNewFields]),help:ue(ee.F.calculateField).helperDocs};var cr=e(82150);const sn=[{value:cr.x1.FieldName,label:"Copy frame name to field name"},{value:cr.x1.Label,label:"Add a label with the frame name"},{value:cr.x1.Drop,label:"Ignore the frame name"}];class Ln extends l.PureComponent{constructor(_){super(_),this.onModeChanged=G=>{const{options:de,onChange:xe}=this.props,Me=G.value??cr.x1.FieldName;xe({...de,frameNameMode:Me})},this.onLabelChanged=G=>{const{options:de}=this.props;this.props.onChange({...de,frameNameLabel:G.target.value})}}render(){const{options:_}=this.props,G=_.frameNameMode??cr.x1.FieldName;return(0,j.jsxs)("div",{children:[(0,j.jsx)(Z.I,{label:"Name",labelWidth:16,grow:!0,children:(0,j.jsx)(Te.l6,{width:36,options:sn,value:sn.find(de=>de.value===G),onChange:this.onModeChanged})}),G===cr.x1.Label&&(0,j.jsx)(Z.I,{label:"Label",labelWidth:16,grow:!0,children:(0,j.jsx)(Ze.p,{width:36,value:_.frameNameLabel??"",placeholder:"frame",onChange:this.onLabelChanged})})]})}}const Jn={id:ee.F.concatenate,editor:Ln,transformation:se.c.concatenateTransformer,name:se.c.concatenateTransformer.name,description:"Combine all fields into a single frame.  Values will be appended with undefined values if not the same length.",categories:new Set([x.m.Combine]),help:ue(ee.F.concatenate).helperDocs};var gs=e(91410),kn=e(76218),Gn=e(9988),Gs=e(63577),$s=e(91076),Is=e(14578),pa=e(72093),Ta=e(29158);const ua=({transformIndex:W,value:_,index:G,mappedIndex:de,onChangeEnumValue:xe,onRemoveEnumRow:Me,checkIsEnumUniqueValue:we})=>{const ke=(0,pt.of)(sr),[Xe,ht]=(0,l.useState)(_),[mt,bt]=(0,l.useState)(Xe===""),[Kt,Rt]=(0,l.useState)(null),Ct=(0,l.useRef)(null);(0,l.useEffect)(()=>{Ct.current&&Ct.current.focus()},[Ct]);const Ut=Fs=>{Fs.currentTarget.value!==""&&we(Fs.currentTarget.value)&&Fs.currentTarget.value!==_?Rt("Enum value already exists"):Rt(null),ht(Fs.currentTarget.value)},hn=()=>{if(bt(!1),Rt(null),Xe===""||Kt!==null){Me(de);return}xe(de,Xe)},Zn=Fs=>{Fs.key==="Enter"&&(Fs.preventDefault(),hn())},As=()=>{bt(!0)},Ds=()=>{Me(de)};return(0,j.jsx)($s.sx,{draggableId:`${W}/${_}`,index:G,children:Fs=>(0,j.jsxs)("tr",{ref:Fs.innerRef,...Fs.draggableProps,children:[(0,j.jsx)("td",{children:(0,j.jsx)("div",{className:ke.dragHandle,...Fs.dragHandleProps,children:(0,j.jsx)(Is.I,{name:"draggabledots",size:"lg"})})}),mt?(0,j.jsxs)("td",{children:[(0,j.jsx)(Ze.p,{ref:Ct,type:"text",value:Xe,onChange:Ut,onBlur:hn,onKeyDown:Zn}),Kt&&(0,j.jsx)(pa.P,{children:Kt})]}):(0,j.jsx)("td",{onClick:As,className:ke.clickableTableCell,children:_&&_!==""?_:"Click to edit"}),(0,j.jsx)("td",{className:ke.textAlignCenter,children:(0,j.jsx)(ca.Gy,{spacing:"sm",children:(0,j.jsx)(Ta.K,{name:"trash-alt",onClick:Ds,"data-testid":"remove-enum-row","aria-label":"Delete enum row",tooltip:"Delete"})})})]},G)},`${W}/${_}`)},sr=W=>({dragHandle:(0,Qe.css)({cursor:"grab"}),textAlignCenter:(0,Qe.css)({textAlign:"center"}),clickableTableCell:(0,Qe.css)({cursor:"pointer",width:"100px","&:hover":{color:W.colors.text.maxContrast}})}),ma=ua,ar=({input:W,options:_,transformIndex:G,onChange:de})=>{const xe=(0,pt.of)(Ya),[Me,we]=(0,l.useState)(_.conversions[G].enumConfig?.text??[]);(0,l.useEffect)(()=>{!_.conversions[G].enumConfig?.text?.length&&W.length&&ke()},[W]),(0,l.useEffect)(()=>{(()=>{const Ut=Me.map(As=>As),hn=_.conversions,Zn={text:Ut};hn[G]={...hn[G],enumConfig:Zn},de({..._,conversions:hn})})()},[G,Me]);const ke=()=>{const Ct=W.flatMap(hn=>hn?.fields??[]).find(hn=>hn.name===_.conversions[G].targetField);if(!Ct)return;const Ut=new Set(Ct?.values);Me.length>0&&!(0,m.isEqual)(Me,Array.from(Ut))&&!window.confirm("This action will overwrite the existing configuration. Are you sure you want to continue?")||we([...Ut])},Xe=(Ct,Ut)=>{const hn=[...Me];hn.splice(Ct,1,Ut),we(hn)},ht=Ct=>{const Ut=[...Me];Ut.splice(Ct,1),we(Ut)},mt=()=>{we(["",...Me])},bt=(Ct,Ut)=>{Me.includes(Ut)||Xe(Ct,Ut)},Kt=Ct=>Me.includes(Ct),Rt=Ct=>{if(!Ct.destination)return;const Ut=Me.length-Ct.source.index-1,hn=Me.length-Ct.destination.index-1,Zn=[...Me],As=Zn[Ut];Zn.splice(Ut,1),Zn.splice(hn,0,As),we(Zn)};return(0,j.jsxs)(ge.C,{children:[(0,j.jsxs)(ca.Gy,{children:[(0,j.jsx)(ye.$n,{size:"sm",icon:"plus",onClick:()=>ke(),className:xe.button,children:"Generate enum values from data"}),(0,j.jsx)(ye.$n,{size:"sm",icon:"plus",onClick:()=>mt(),className:xe.button,children:"Add enum value"})]}),(0,j.jsx)(ca.gW,{children:(0,j.jsx)("table",{className:xe.compactTable,children:(0,j.jsx)($s.JY,{onDragEnd:Rt,children:(0,j.jsx)($s.gL,{droppableId:"sortable-enum-config-mappings",direction:"vertical",children:Ct=>(0,j.jsxs)("tbody",{ref:Ct.innerRef,...Ct.droppableProps,children:[[...Me].reverse().map((Ut,hn)=>{const Zn=Me.length-hn-1;return(0,j.jsx)(ma,{transformIndex:G,value:Ut,index:hn,mappedIndex:Zn,onChangeEnumValue:bt,onRemoveEnumRow:ht,checkIsEnumUniqueValue:Kt},`${G}/${Ut}`)}),Ct.placeholder]})})})})})]})},Ya=W=>({compactTable:(0,Qe.css)({"tbody td":{padding:W.spacing(.5)},marginTop:W.spacing(1),marginBottom:W.spacing(2)}),button:(0,Qe.css)({marginTop:W.spacing(1)})}),xr={settings:{width:24,isClearable:!1}},Sr=({input:W,options:_,onChange:G})=>{const de=Gn.bx.filter(Rt=>Rt.value!==te.PU.trace),xe=(0,Pe.qt)(!0),Me=(0,gs.P3)();xe.push({label:"Browser",value:"browser"}),xe.push({label:"UTC",value:"utc"});for(const Rt of Me)xe.push({label:Rt,value:Rt});const we=(0,l.useCallback)(Rt=>Ct=>{const Ut=_.conversions;Ut[Rt]={...Ut[Rt],targetField:Ct??"",dateFormat:void 0},G({..._,conversions:Ut})},[G,_]),ke=(0,l.useCallback)(Rt=>Ct=>{const Ut=_.conversions;Ut[Rt]={...Ut[Rt],destinationType:Ct.value},G({..._,conversions:Ut})},[G,_]),Xe=(0,l.useCallback)(Rt=>Ct=>{const Ut=_.conversions;Ut[Rt]={...Ut[Rt],dateFormat:Ct.currentTarget.value},G({..._,conversions:Ut})},[G,_]),ht=(0,l.useCallback)(Rt=>Ct=>{const Ut=_.conversions;Ut[Rt]={...Ut[Rt],joinWith:Ct.currentTarget.value},G({..._,conversions:Ut})},[G,_]),mt=(0,l.useCallback)(()=>{G({..._,conversions:[..._.conversions,{targetField:void 0,destinationType:void 0,dateFormat:void 0}]})},[G,_]),bt=(0,l.useCallback)(Rt=>{const Ct=_.conversions;Ct.splice(Rt,1),G({..._,conversions:Ct})},[G,_]),Kt=(0,l.useCallback)(Rt=>Ct=>{const Ut=_.conversions;Ut[Rt]={...Ut[Rt],timezone:Ct?.value},G({..._,conversions:Ut})},[G,_]);return(0,j.jsxs)(j.Fragment,{children:[_.conversions.map((Rt,Ct)=>{const Ut=(0,Gs.findField)(W?.[0],Rt.targetField);return(0,j.jsxs)("div",{children:[(0,j.jsxs)(ge.C,{children:[(0,j.jsx)(Z.I,{label:"Field",children:(0,j.jsx)(kn.O,{context:{data:W},value:Rt.targetField??"",onChange:we(Ct),item:xr})}),(0,j.jsx)(Z.I,{label:"as",children:(0,j.jsx)(Te.l6,{options:de,value:Rt.destinationType,placeholder:"Type",onChange:ke(Ct),width:18})}),Rt.destinationType===te.PU.time&&(0,j.jsx)(Z.I,{label:"Input format",tooltip:"Specify the format of the input field so Grafana can parse the date string correctly.",children:(0,j.jsx)(Ze.p,{value:Rt.dateFormat,placeholder:"e.g. YYYY-MM-DD",onChange:Xe(Ct),width:24})}),Rt.destinationType===te.PU.string&&(0,j.jsxs)(j.Fragment,{children:[(Rt.joinWith?.length||Ut?.type===te.PU.other)&&(0,j.jsx)(Z.I,{label:"Join with",tooltip:"Use an explicit separator when joining array values",children:(0,j.jsx)(Ze.p,{value:Rt.joinWith,placeholder:"JSON",onChange:ht(Ct),width:9})}),Rt.dateFormat||Ut?.type===te.PU.time&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(Z.I,{label:"Date format",tooltip:"Specify the output format.",children:(0,j.jsx)(Ze.p,{value:Rt.dateFormat,placeholder:"e.g. YYYY-MM-DD",onChange:Xe(Ct),width:24})}),(0,j.jsx)(Z.I,{label:"Set timezone",tooltip:"Set the timezone of the date manually",children:(0,j.jsx)(Te.l6,{options:xe,value:Rt.timezone,onChange:Kt(Ct),isClearable:!0})})]})]}),(0,j.jsx)(ye.$n,{size:"md",icon:"trash-alt",variant:"secondary",onClick:()=>bt(Ct),"aria-label":"Remove convert field type transformer"})]}),Rt.destinationType===te.PU.enum&&(0,j.jsx)(ar,{input:W,options:_,transformIndex:Ct,onChange:G})]},`${Rt.targetField}-${Ct}`)}),(0,j.jsx)(ye.$n,{size:"sm",icon:"plus",onClick:mt,variant:"secondary","aria-label":"Add a convert field type transformer",children:"Convert field type"})]})},Yr={id:ee.F.convertFieldType,editor:Sr,transformation:se.c.convertFieldTypeTransformer,name:se.c.convertFieldTypeTransformer.name,description:se.c.convertFieldTypeTransformer.description,categories:new Set([x.m.Reformat]),help:ue(ee.F.convertFieldType).helperDocs};var Hr=e(54479);class Rr extends l.PureComponent{constructor(_){super(_),this.onFieldToggle=G=>{const{selected:de}=this.state;de.indexOf(G)>-1?this.onChange(de.filter(xe=>xe!==G)):this.onChange([...de,G])},this.onChange=G=>{const{regex:de,isRegexValid:xe}=this.state,Me={...this.props.options,include:{names:G}};de&&xe&&(Me.include=Me.include??{},Me.include.pattern=de),this.setState({selected:G},()=>{this.props.onChange(Me)})},this.onInputBlur=G=>{const{selected:de,regex:xe}=this.state;let Me=!0;try{xe&&(0,Hr.dO)(xe)}catch{Me=!1}Me?this.props.onChange({...this.props.options,include:{pattern:xe}}):this.props.onChange({...this.props.options,include:{names:de}}),this.setState({isRegexValid:Me})},this.onVariableChange=G=>{this.props.onChange({...this.props.options,include:{variable:G.value}}),this.setState({variable:G.value})},this.onFromVariableChange=G=>{const de=G.currentTarget.checked;this.props.onChange({...this.props.options,byVariable:de}),this.setState({byVariable:de})},this.state={include:_.options.include?.names||[],regex:_.options.include?.pattern,variable:_.options.include?.variable,byVariable:_.options.byVariable||!1,options:[],variables:[],selected:[],isRegexValid:!0}}componentDidMount(){this.initOptions()}componentDidUpdate(_){this.props.input!==_.input&&this.initOptions()}initOptions(){const{input:_,options:G}=this.props,de=Array.from(G.include?.names??[]),xe=(0,je.w)().getVariables().map(ke=>({label:"$"+ke.name,value:"$"+ke.name})),Me=[],we={};for(const ke of _)for(const Xe of ke.fields){const ht=(0,z.Ct)(Xe,ke,_);let mt=we[ht];mt||(mt=we[ht]={name:ht,count:0},Me.push(mt)),mt.count++}if(G.include?.pattern)try{const ke=(0,Hr.dO)(G.include.pattern);for(const Xe of Me)ke.test(Xe.name)&&de.push(Xe.name)}catch(ke){console.error(ke)}if(de.length){const ke=Me.filter(Xe=>de.includes(Xe.name));this.setState({options:Me,selected:ke.map(Xe=>Xe.name),variables:xe,byVariable:G.byVariable||!1,variable:G.include?.variable,regex:G.include?.pattern})}else this.setState({options:Me,selected:Me.map(ke=>ke.name),variables:xe,byVariable:G.byVariable||!1,variable:G.include?.variable,regex:G.include?.pattern})}render(){const{options:_,selected:G,isRegexValid:de}=this.state;return(0,j.jsxs)("div",{children:[(0,j.jsx)(ge.C,{label:"Use variable",children:(0,j.jsx)(Z.I,{label:"From variable",children:(0,j.jsx)(qn.K,{value:this.state.byVariable,onChange:this.onFromVariableChange})})}),this.state.byVariable?(0,j.jsx)(ge.C,{children:(0,j.jsx)(Z.I,{label:"Variable",children:(0,j.jsx)(Te.l6,{value:this.state.variable,onChange:this.onVariableChange,options:this.state.variables||[]})})}):(0,j.jsxs)(ge.C,{label:"Identifier",children:[(0,j.jsx)(Z.I,{label:"Identifier",invalid:!de,error:de?void 0:"Invalid pattern",children:(0,j.jsx)(Ze.p,{placeholder:"Regular expression pattern",value:this.state.regex||"",onChange:xe=>this.setState({regex:xe.currentTarget.value}),onBlur:this.onInputBlur,width:25})}),_.map((xe,Me)=>{const we=`${xe.name}${xe.count>1?" ("+xe.count+")":""}`,ke=G.indexOf(xe.name)>-1;return(0,j.jsx)(Ks.m,{onClick:()=>{this.onFieldToggle(xe.name)},label:we,selected:ke},`${xe.name}/${Me}`)})]})]})}}const lo={id:ee.F.filterFieldsByName,editor:Rr,transformation:se.c.filterFieldsByNameTransformer,name:se.c.filterFieldsByNameTransformer.name,description:"Removes part of the query results using a regex pattern. The pattern can be inclusive or exclusive.",categories:new Set([x.m.Filter]),help:ue(ee.F.filterFieldsByName).helperDocs};class Bo extends l.PureComponent{constructor(_){super(_),this.onFieldToggle=G=>{const{selected:de}=this.state;de.indexOf(G)>-1?this.onChange(de.filter(xe=>xe!==G)):this.onChange([...de,G])},this.onChange=G=>{this.setState({selected:G}),this.props.onChange({...this.props.options,include:G.join("|")})},this.state={include:_.options.include||"",options:[],selected:[]}}componentDidMount(){this.initOptions()}componentDidUpdate(_){this.props.input!==_.input&&this.initOptions()}initOptions(){const{input:_,options:G}=this.props,de=G.include?G.include.split("|"):[],xe=[],Me={};for(const we of _)if(we.refId){let ke=Me[we.refId];ke||(ke=Me[we.refId]={refId:we.refId,count:0},xe.push(ke)),ke.count++}if(de.length){const we=[],ke=[];for(const Xe of xe)de.includes(Xe.refId)&&ke.push(Xe),we.push(Xe);this.setState({options:we,selected:ke.map(Xe=>Xe.refId)})}else this.setState({options:xe,selected:[]})}render(){const{options:_,selected:G}=this.state,{input:de}=this.props;return(0,j.jsxs)(j.Fragment,{children:[de.length<=1&&(0,j.jsx)("div",{children:(0,j.jsx)(pa.P,{children:"Filter data by query expects multiple queries in the input."})}),(0,j.jsx)(Z.I,{label:"Series refId",labelWidth:16,shrink:!0,children:(0,j.jsx)(ca.Gy,{spacing:"xs",align:"flex-start",wrap:!0,children:_.map((xe,Me)=>{const we=`${xe.refId}${xe.count>1?" ("+xe.count+")":""}`,ke=G.indexOf(xe.refId)>-1;return(0,j.jsx)(Ks.m,{onClick:()=>{this.onFieldToggle(xe.refId)},label:we,selected:ke},`${xe.refId}/${Me}`)})})})]})}}const po={id:ee.F.filterByRefId,editor:Bo,transformation:se.c.filterFramesByRefIdTransformer,name:se.c.filterFramesByRefIdTransformer.name,description:"Filter data by query. This is useful if you are sharing the results from a different panel that has many queries and you want to only visualize a subset of that in this panel.",categories:new Set([x.m.Filter]),help:ue(ee.F.filterByRefId).helperDocs};var vr=e(15400);const Ur={settings:{width:30,filter:W=>W.type===te.PU.string,placeholderText:"Select text field",noFieldsMessage:"No text fields found"},name:"",id:"",editor:()=>null};function Er({input:W,options:_,onChange:G}){const de=(0,l.useCallback)(Xe=>{G({..._,stringField:Xe??""})},[G,_]),xe=(0,l.useCallback)(Xe=>{const ht=Xe.value??vr.gs.UpperCase;G({..._,outputFormat:ht})},[G,_]),Me=(0,l.useCallback)(Xe=>{G({..._,substringStart:Xe??0})},[G,_]),we=(0,l.useCallback)(Xe=>{G({..._,substringEnd:Xe??0})},[G,_]),ke=Object.values(vr.gs).map(Xe=>({label:Xe,value:Xe}));return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(ge.C,{children:[(0,j.jsx)(Z.I,{label:"Field",labelWidth:10,children:(0,j.jsx)(kn.O,{context:{data:W},value:_.stringField??"",onChange:de,item:Ur})}),(0,j.jsx)(Z.I,{label:"Format",labelWidth:10,children:(0,j.jsx)(Te.l6,{options:ke,value:_.outputFormat,onChange:xe,width:20})})]}),_.outputFormat===vr.gs.Substring&&(0,j.jsxs)(ge.C,{children:[(0,j.jsx)(Z.I,{label:"Substring range",labelWidth:15,children:(0,j.jsx)(ga.Q,{min:0,value:_.substringStart??0,onChange:Me,width:7})}),(0,j.jsx)(Z.I,{children:(0,j.jsx)(ga.Q,{min:0,value:_.substringEnd??0,onChange:we,width:7})})]})]})}const Qo={id:ee.F.formatString,editor:Er,transformation:se.c.formatStringTransformer,name:se.c.formatStringTransformer.name,state:rt.pn.beta,description:se.c.formatStringTransformer.description,categories:new Set([x.m.Reformat])};function Eo({input:W,options:_,onChange:G}){const de=[],xe=(0,Pe.qt)(!0);for(const Xe of W)for(const ht of Xe.fields)if(ht.type==="time"){const mt=(0,z.Ct)(ht,Xe,W);de.push({label:mt,value:mt})}const Me=(0,l.useCallback)(Xe=>{const ht=Xe?.value!==void 0?Xe.value:"";G({..._,timeField:ht})},[G,_]),we=(0,l.useCallback)(Xe=>{const ht=Xe.target.value;G({..._,outputFormat:ht})},[G,_]),ke=(0,l.useCallback)(Xe=>{const ht=Xe?.value!==void 0?Xe.value:"";G({..._,timezone:ht})},[G,_]);return(0,j.jsx)(j.Fragment,{children:(0,j.jsxs)(ge.C,{children:[(0,j.jsx)(Z.I,{label:"Time Field",labelWidth:15,grow:!0,children:(0,j.jsx)(Te.l6,{options:de,value:_.timeField,onChange:Me,placeholder:"time",isClearable:!0})}),(0,j.jsx)(Z.I,{label:"Format",labelWidth:10,tooltip:(0,j.jsxs)(j.Fragment,{children:["The output format for the field specified as a"," ",(0,j.jsx)("a",{href:"https://momentjs.com/docs/#/displaying/",target:"_blank",rel:"noopener noreferrer",children:"Moment.js format string"}),"."]}),interactive:!0,children:(0,j.jsx)(Ze.p,{onChange:we,value:_.outputFormat})}),(0,j.jsx)(Z.I,{label:"Set Timezone",tooltip:"Set the timezone of the date manually",labelWidth:20,children:(0,j.jsx)(Te.l6,{options:xe,value:_.timezone,onChange:ke,isClearable:!0})})]})})}const Lt={id:ee.F.formatTime,editor:Eo,transformation:se.c.formatTimeTransformer,name:se.c.formatTimeTransformer.name,state:rt.pn.alpha,description:se.c.formatTimeTransformer.description,help:ue(ee.F.formatTime).helperDocs};var Ht=e(25094),on=e(67061),vn=e(42418);const Un=({input:W,options:_,onChange:G})=>{const de=(0,Pe.ZI)(W),xe=(0,l.useCallback)(Xe=>ht=>{G({..._,fields:{..._.fields,[Xe]:ht}})},[G]);let Me,we=!1;for(const Xe of Object.values(_.fields))Xe.aggregations.length>0&&Xe.operation!==null&&(we=!0),Xe.operation===Ht.R3.groupBy&&(Me=!0);const ke=we&&!Me;return(0,j.jsxs)(on.B,{direction:"column",children:[ke&&(0,j.jsx)(vn.F,{title:"Calculations will not have an effect if no fields are being grouped on.",severity:"warning"}),de.map(Xe=>(0,j.jsx)(os,{onConfigChange:xe(Xe),fieldName:Xe,config:_.fields[Xe]},Xe))]})},cs=[{label:"Group by",value:Ht.R3.groupBy},{label:"Calculate",value:Ht.R3.aggregate}],os=({fieldName:W,config:_,onConfigChange:G})=>{const de=(0,pt.$j)(),xe=Js(de),Me=(0,l.useCallback)(we=>{G({aggregations:_?.aggregations??[],operation:we?.value??null})},[_,G]);return(0,j.jsx)(Z.I,{className:xe.label,label:W,grow:!0,shrink:!0,children:(0,j.jsxs)(on.B,{gap:.5,direction:"row",children:[(0,j.jsx)("div",{className:xe.operation,children:(0,j.jsx)(Te.l6,{options:cs,value:_?.operation,placeholder:"Ignored",onChange:Me,isClearable:!0})}),_?.operation===Ht.R3.aggregate&&(0,j.jsx)(mn.S,{className:xe.aggregations,placeholder:"Select Stats",allowMultiple:!0,stats:_.aggregations,onChange:we=>{G({..._,aggregations:we})}})]})})},Js=W=>({label:(0,Qe.css)`
      label {
        min-width: ${W.spacing(32)};
      }
    `,operation:(0,Qe.css)`
      flex-shrink: 0;
      height: 100%;
      width: ${W.spacing(24)};
    `,aggregations:(0,Qe.css)`
      flex-grow: 1;
    `}),Ss={id:ee.F.groupBy,editor:Un,transformation:se.c.groupByTransformer,name:se.c.groupByTransformer.name,description:se.c.groupByTransformer.description,categories:new Set([x.m.Combine,x.m.CalculateNewFields,x.m.Reformat]),help:ue(ee.F.groupBy).helperDocs};var Ra=e(68133),Oa=e(88575);const ss=({input:W,options:_,onChange:G})=>{const de=(0,Pe.ZI)(W),xe=_.showSubframeHeaders===void 0?Ra.l:_.showSubframeHeaders,Me=(0,l.useCallback)(mt=>bt=>{G({..._,fields:{..._.fields,[mt]:bt}})},[G]),we=(0,l.useCallback)(()=>{const mt=_.showSubframeHeaders===void 0?!Ra.l:!_.showSubframeHeaders;G({showSubframeHeaders:mt,fields:{..._.fields}})},[G]);let ke,Xe=!1;for(const mt of Object.values(_.fields))mt.aggregations.length>0&&mt.operation!==null&&(Xe=!0),mt.operation===Ht.R3.groupBy&&(ke=!0);const ht=Xe&&!ke;return(0,j.jsxs)(on.B,{direction:"column",children:[ht&&(0,j.jsx)(vn.F,{title:"Calculations will not have an effect if no fields are being grouped on.",severity:"warning"}),(0,j.jsx)("div",{children:de.map(mt=>(0,j.jsx)(Cr,{onConfigChange:Me(mt),fieldName:mt,config:_.fields[mt]},mt))}),(0,j.jsx)(Oa.D,{label:"Show field names in nested tables",description:"If enabled nested tables will show field names as a table header",children:(0,j.jsx)(qn.d,{value:xe,onChange:we})})]})},Ia=[{label:"Group by",value:Ht.R3.groupBy},{label:"Calculate",value:Ht.R3.aggregate}],Cr=({fieldName:W,config:_,onConfigChange:G})=>{const de=(0,pt.$j)(),xe=Dr(de),Me=(0,l.useCallback)(we=>{G({aggregations:_?.aggregations??[],operation:we?.value??null})},[_,G]);return(0,j.jsx)(Z.I,{className:xe.label,label:W,grow:!0,shrink:!0,children:(0,j.jsxs)(on.B,{gap:.5,direction:"row",wrap:!1,children:[(0,j.jsx)("div",{className:xe.operation,children:(0,j.jsx)(Te.l6,{options:Ia,value:_?.operation,placeholder:"Ignored",onChange:Me,isClearable:!0})}),_?.operation===Ht.R3.aggregate&&(0,j.jsx)(mn.S,{className:xe.aggregations,placeholder:"Select Stats",allowMultiple:!0,stats:_.aggregations,onChange:we=>{G({..._,aggregations:we})}})]})})},Dr=W=>({label:(0,Qe.css)({minWidth:W.spacing(32)}),operation:(0,Qe.css)({flexShrink:0,height:"100%",width:W.spacing(24)}),aggregations:(0,Qe.css)({flexGrow:1})}),dr={id:ee.F.groupToNestedTable,editor:ss,transformation:se.c.groupToNestedTable,name:se.c.groupToNestedTable.name,description:se.c.groupToNestedTable.description,categories:new Set([x.m.Combine,x.m.CalculateNewFields,x.m.Reformat]),state:rt.pn.beta};var ur=e(81010);const Oo=({input:W,options:_,onChange:G})=>{const de=(0,Pe.ZI)(W).map(mt=>({label:mt,value:mt})),xe=(0,je.w)().getVariables().map(mt=>({value:"$"+mt.name,label:"$"+mt.name})),Me=(0,l.useCallback)(mt=>{G({..._,columnField:mt?.value})},[G,_]),we=(0,l.useCallback)(mt=>{G({..._,rowField:mt?.value})},[G,_]),ke=(0,l.useCallback)(mt=>{G({..._,valueField:mt?.value})},[G,_]),Xe=[{label:"Null",value:ur.N.Null,description:"Null value"},{label:"True",value:ur.N.True,description:"Boolean true value"},{label:"False",value:ur.N.False,description:"Boolean false value"},{label:"Empty",value:ur.N.Empty,description:"Empty string"}],ht=(0,l.useCallback)(mt=>{G({..._,emptyValue:mt?.value})},[G,_]);return(0,j.jsx)(j.Fragment,{children:(0,j.jsxs)(ge.C,{children:[(0,j.jsx)(Z.I,{label:"Column",labelWidth:8,children:(0,j.jsx)(Te.l6,{options:[...de,...xe],value:_.columnField,onChange:Me,isClearable:!0})}),(0,j.jsx)(Z.I,{label:"Row",labelWidth:8,children:(0,j.jsx)(Te.l6,{options:[...de,...xe],value:_.rowField,onChange:we,isClearable:!0})}),(0,j.jsx)(Z.I,{label:"Cell Value",labelWidth:10,children:(0,j.jsx)(Te.l6,{options:[...de,...xe],value:_.valueField,onChange:ke,isClearable:!0})}),(0,j.jsx)(Z.I,{label:"Empty Value",children:(0,j.jsx)(Te.l6,{options:Xe,value:_.emptyValue,onChange:ht,isClearable:!0})})]})})},Io={id:ee.F.groupingToMatrix,editor:Oo,transformation:se.c.groupingToMatrixTransformer,name:se.c.groupingToMatrixTransformer.name,description:"Takes a three fields combination and produces a Matrix.",categories:new Set([x.m.Combine,x.m.Reformat]),help:ue(ee.F.groupingToMatrix).helperDocs};var za=e(77678);const Do=({input:W,options:_,onChange:G})=>{const[xe,Me]=(0,l.useState)({bucketCount:!(0,Pe.N_)(_.bucketCount||""),bucketSize:!(0,Pe.N_)(_.bucketSize||""),bucketOffset:!(0,Pe.N_)(_.bucketOffset||"")}),we=(0,l.useCallback)(Ut=>{G({..._,bucketCount:Ut})},[G,_]),ke=(0,l.useCallback)(Ut=>{G({..._,bucketSize:Ut})},[G,_]),Xe=(0,l.useCallback)(Ut=>{G({..._,bucketOffset:Ut})},[G,_]),ht=(0,l.useCallback)(Ut=>{Me({...xe,bucketCount:!(0,Pe.N_)(Ut)}),G({..._,bucketCount:Number(Ut)===0?void 0:Number(Ut)})},[G,_,xe]),mt=(0,l.useCallback)(Ut=>{Me({...xe,bucketSize:!(0,Pe.N_)(Ut)}),G({..._,bucketSize:Ut})},[G,_,xe,Me]),bt=(0,l.useCallback)(Ut=>{Me({...xe,bucketOffset:!(0,Pe.N_)(Ut)}),G({..._,bucketOffset:Ut})},[G,_,xe,Me]),Kt=(0,l.useCallback)(()=>{G({..._,combine:!_.combine})},[G,_]),Ct=(0,je.w)().getVariables().map(Ut=>({value:Ut.name,label:Ut.label||Ut.name,origin:Ye.$0.Template}));if(!ae.$.featureToggles.transformationsVariableSupport){let Ut;typeof _.bucketSize=="string"?Ut=parseInt(_.bucketSize,10):Ut=_.bucketSize;let hn;return typeof _.bucketOffset=="string"?hn=parseInt(_.bucketOffset,10):hn=_.bucketOffset,(0,j.jsxs)("div",{children:[(0,j.jsx)(ge.C,{children:(0,j.jsx)(Z.I,{labelWidth:18,label:za.Rt.bucketCount.name,tooltip:za.Rt.bucketCount.description,children:(0,j.jsx)(ga.Q,{value:_.bucketCount,placeholder:"Default: 30",onChange:we,min:0})})}),(0,j.jsx)(ge.C,{children:(0,j.jsx)(Z.I,{labelWidth:18,label:za.Rt.bucketSize.name,tooltip:za.Rt.bucketSize.description,children:(0,j.jsx)(ga.Q,{value:Ut,placeholder:"auto",onChange:ke,min:0})})}),(0,j.jsx)(ge.C,{children:(0,j.jsx)(Z.I,{labelWidth:18,label:za.Rt.bucketOffset.name,tooltip:za.Rt.bucketOffset.description,children:(0,j.jsx)(ga.Q,{value:hn,placeholder:"none",onChange:Xe,min:0})})}),(0,j.jsx)(ge.C,{children:(0,j.jsx)(Z.I,{labelWidth:18,label:za.Rt.combine.name,tooltip:za.Rt.combine.description,children:(0,j.jsx)(qn.K,{value:_.combine??!1,onChange:Kt})})})]})}return(0,j.jsxs)("div",{children:[(0,j.jsx)(ge.C,{children:(0,j.jsx)(Z.I,{invalid:xe.bucketCount,error:"Value needs to be an integer or a variable",labelWidth:18,label:za.Rt.bucketCount.name,tooltip:za.Rt.bucketCount.description,children:(0,j.jsx)(Ne.y,{suggestions:Ct,value:_.bucketCount,placeholder:"Default: 30",onChange:ht})})}),(0,j.jsx)(ge.C,{children:(0,j.jsx)(Z.I,{invalid:xe.bucketSize,error:"Value needs to be an integer or a variable",labelWidth:18,label:za.Rt.bucketSize.name,tooltip:za.Rt.bucketSize.description,children:(0,j.jsx)(Ne.y,{suggestions:Ct,value:_.bucketSize,placeholder:"auto",onChange:mt})})}),(0,j.jsx)(ge.C,{children:(0,j.jsx)(Z.I,{labelWidth:18,label:za.Rt.bucketOffset.name,tooltip:za.Rt.bucketOffset.description,invalid:xe.bucketOffset,error:"Value needs to be an integer or a variable",children:(0,j.jsx)(Ne.y,{suggestions:Ct,value:_.bucketOffset,placeholder:"none",onChange:bt})})}),(0,j.jsx)(ge.C,{children:(0,j.jsx)(Z.I,{labelWidth:18,label:za.Rt.combine.name,tooltip:za.Rt.combine.description,children:(0,j.jsx)(qn.K,{value:_.combine??!1,onChange:Kt})})})]})},Ca={id:ee.F.histogram,editor:Do,transformation:se.c.histogramTransformer,name:se.c.histogramTransformer.name,description:se.c.histogramTransformer.description,categories:new Set([x.m.CreateNewVisualization]),help:ue(ee.F.histogram).helperDocs};var Aa=e(41511),hr=e(64278);const Ma=[{value:Aa.W.outer,label:"OUTER (TIME SERIES)",description:"Keep all rows from any table with a value. Join on distinct field values. Performant and best used for time series."},{value:Aa.W.outerTabular,label:"OUTER (TABULAR)",description:"Join on a field value with duplicated values. Non performant outer join best used for tabular(SQL like) data."},{value:Aa.W.inner,label:"INNER",description:"Combine data from two tables whenever there are matching values in a fields common to both tables."}];function ho({input:W,options:_,onChange:G}){const de=(0,hr.sE)(W),xe=(0,hr.m3)(de),Me=(0,je.w)().getVariables().map(Xe=>({value:"$"+Xe.name,label:"$"+Xe.name})),we=(0,l.useCallback)(Xe=>{G({..._,byField:Xe?.value})},[G,_]),ke=(0,l.useCallback)(Xe=>{G({..._,mode:Xe?.value})},[G,_]);return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(ge.C,{children:(0,j.jsx)(Z.I,{label:"Mode",labelWidth:8,grow:!0,children:(0,j.jsx)(Te.l6,{options:Ma,value:_.mode??Aa.W.outer,onChange:ke})})}),(0,j.jsx)(ge.C,{children:(0,j.jsx)(Z.I,{label:"Field",labelWidth:8,grow:!0,children:(0,j.jsx)(Te.l6,{options:[...xe,...Me],value:_.byField,onChange:we,placeholder:"time",isClearable:!0})})})]})}const Uo={id:ee.F.joinByField,aliasIds:[ee.F.seriesToColumns],editor:ho,transformation:se.c.joinByFieldTransformer,name:se.c.joinByFieldTransformer.name,description:se.c.joinByFieldTransformer.description,categories:new Set([x.m.Combine]),help:ue(ee.F.joinByField).helperDocs};var No=e(6829);const Mi=[{value:No.n.Columns,label:"Columns"},{value:No.n.Rows,label:"Rows"}],ri=({input:W,options:_,onChange:G})=>{const{labelNames:xe,selected:Me}=(0,l.useMemo)(()=>{let Xe=[],ht={};for(const bt of W)for(const Kt of bt.fields)if(Kt.labels)for(const Rt of Object.keys(Kt.labels))ht[Rt]||(Xe.push({value:Rt,label:Rt}),ht[Rt]=!0);const mt=new Set(_.keepLabels?.length?_.keepLabels:Object.keys(ht));return{labelNames:Xe,selected:mt}},[_.keepLabels,W]),we=Xe=>{G({..._,valueLabel:Xe?.value})},ke=Xe=>{if(Me.has(Xe)?Me.delete(Xe):Me.add(Xe),Me.size===xe.length||!Me.size){const{keepLabels:ht,...mt}=_;G(mt)}else G({..._,keepLabels:[...Me]})};return(0,j.jsxs)("div",{children:[(0,j.jsx)(ge.C,{children:(0,j.jsx)(Z.I,{label:"Mode",labelWidth:20,children:(0,j.jsx)(oe.z,{options:Mi,value:_.mode??No.n.Columns,onChange:Xe=>G({..._,mode:Xe})})})}),(0,j.jsx)(ge.C,{children:(0,j.jsx)(Z.I,{label:"Labels",labelWidth:20,children:(0,j.jsx)(on.B,{gap:1,wrap:"wrap",children:xe.map((Xe,ht)=>{const mt=Xe.label;return(0,j.jsx)(Ks.m,{onClick:()=>ke(mt),label:mt,selected:Me.has(mt)},`${mt}/${ht}`)})})})}),_.mode!==No.n.Rows&&(0,j.jsx)(ge.C,{children:(0,j.jsx)(Z.I,{label:"Value field name",labelWidth:20,tooltip:"Replace the value field name with a label",htmlFor:"labels-to-fields-as-name",children:(0,j.jsx)(Te.l6,{inputId:"labels-to-fields-as-name",isClearable:!0,allowCustomValue:!1,placeholder:"(Optional) Select label",options:xe,value:_?.valueLabel,onChange:we,className:"min-width-16"})})})]})},wo={id:ee.F.labelsToFields,editor:ri,transformation:se.c.labelsToFieldsTransformer,name:se.c.labelsToFieldsTransformer.name,description:`Groups series by time and return labels or tags as fields.
                Useful for showing time series with labels in a table where each label key becomes a separate column.`,categories:new Set([x.m.Reformat]),help:ue(ee.F.labelsToFields).helperDocs},oi=({options:W,onChange:_})=>{const[G,de]=(0,l.useState)(!1),xe=(0,l.useCallback)(Xe=>{_({...W,limitField:Number(Xe.currentTarget.value)})},[_,W]),Me=(0,l.useCallback)(Xe=>{de(!(0,Pe.N_)(Xe)),_({...W,limitField:Xe})},[_,W]),ke=(0,je.w)().getVariables().map(Xe=>({value:Xe.name,label:Xe.label||Xe.name,origin:Ye.$0.Template}));return ae.$.featureToggles.transformationsVariableSupport?(0,j.jsx)(j.Fragment,{children:(0,j.jsx)(ge.C,{children:(0,j.jsx)(Ne.y,{invalid:G,error:"Value needs to be an integer or a variable",value:String(W.limitField),onChange:Me,placeholder:"Value or variable",suggestions:ke})})}):(0,j.jsx)(j.Fragment,{children:(0,j.jsx)(ge.C,{children:(0,j.jsx)(Z.I,{label:"Limit",labelWidth:8,children:(0,j.jsx)(Ze.p,{placeholder:"Limit count",pattern:"[0-9]*",value:W.limitField,onChange:xe,width:25})})})})},cl={id:ee.F.limit,editor:oi,transformation:se.c.limitTransformer,name:se.c.limitTransformer.name,description:"Limit the number of items displayed.",categories:new Set([x.m.Filter]),help:ue(ee.F.limit).helperDocs},Lr=({input:W,options:_,onChange:G})=>W.length<=1?(0,j.jsx)(pa.P,{children:"Merge has no effect when applied on a single frame."}):null,Vi={id:ee.F.merge,editor:Lr,transformation:se.c.mergeTransformer,name:se.c.mergeTransformer.name,description:`Merge many series/tables and return a single table where mergeable values will be combined into the same row.
                Useful for showing multiple series, tables or a combination of both visualized in a table.`,categories:new Set([x.m.Combine]),help:ue(ee.F.merge).helperDocs};var Si=e(82280),Tr=e(94753);const ii=({options:W,input:_,onChange:G})=>{const{indexByName:de,excludeByName:xe,renameByName:Me,includeByName:we}=W,ke=(0,Pe.ZI)(_),Xe=(0,l.useMemo)(()=>zi(ke,de),[ke,de]),ht=we&&Object.keys(we).length>0?"include":"exclude",mt=(0,l.useCallback)((Ct,Ut)=>{G({...W,excludeByName:{...xe,[Ct]:Ut}})},[G,W,xe]),bt=(0,l.useCallback)((Ct,Ut)=>{const hn={...W,includeByName:{...we,[Ct]:!Ut}};G(hn)},[G,W,we]),Kt=(0,l.useCallback)(Ct=>{if(!Ct||!Ct.destination)return;const Ut=Ct.source.index,hn=Ct.destination.index;Ut!==hn&&G({...W,indexByName:_i(ke,Ut,hn)})},[G,W,ke]),Rt=(0,l.useCallback)((Ct,Ut)=>{G({...W,renameByName:{...W.renameByName,[Ct]:Ut}})},[G,W]);return _.length>1?(0,j.jsx)(pa.P,{children:"Organize fields only works with a single frame. Consider applying a join transformation or filtering the input first."}):(0,j.jsx)($s.JY,{onDragEnd:Kt,children:(0,j.jsx)($s.gL,{droppableId:"sortable-fields-transformer",direction:"vertical",children:Ct=>(0,j.jsxs)("div",{ref:Ct.innerRef,...Ct.droppableProps,children:[Xe.map((Ut,hn)=>{const Zn=we&&Ut in we?we[Ut]:!1,As=ht==="include"?Zn:!xe[Ut],Ds=ht==="include"?bt:mt;return(0,j.jsx)(Yo,{fieldName:Ut,renamedFieldName:Me[Ut],index:hn,onToggleVisibility:Ds,onRenameField:Rt,visible:As},Ut)}),Ct.placeholder]})})})};ii.displayName="OrganizeFieldsTransformerEditor";const Yo=({fieldName:W,renamedFieldName:_,index:G,visible:de,onToggleVisibility:xe,onRenameField:Me})=>{const we=(0,pt.of)(kr);return(0,j.jsx)($s.sx,{draggableId:W,index:G,children:ke=>(0,j.jsxs)(ce.a,{marginBottom:.5,display:"flex",gap:0,ref:ke.innerRef,...ke.draggableProps,children:[(0,j.jsx)(yt.c,{width:60,as:"div",children:(0,j.jsxs)(on.B,{gap:0,justifyContent:"flex-start",alignItems:"center",width:"100%",children:[(0,j.jsx)("span",{...ke.dragHandleProps,children:(0,j.jsx)(Is.I,{name:"draggabledots",title:"Drag and drop to reorder",size:"lg",className:we.draggable})}),(0,j.jsx)(Ta.K,{className:we.toggle,size:"md",name:de?"eye":"eye-slash",onClick:()=>xe(W,de),tooltip:de?"Disable":"Enable"}),(0,j.jsx)(Tr.E,{truncate:!0,element:"p",variant:"bodySmall",weight:"bold",children:W})]})}),(0,j.jsx)(Ze.p,{defaultValue:_||"",placeholder:`Rename ${W}`,onBlur:Xe=>Me(W,Xe.currentTarget.value)})]})})};Yo.displayName="DraggableFieldName";const kr=W=>({toggle:(0,Qe.css)({margin:W.spacing(0,1),color:W.colors.text.secondary}),draggable:(0,Qe.css)({opacity:.4,"&:hover":{color:W.colors.text.maxContrast}})}),_i=(W,_,G)=>{const de=Array.from(W),[xe]=de.splice(_,1);return de.splice(G,0,xe),de.reduce((Me,we,ke)=>(Me[we]=ke,Me),{})},zi=(W,_={})=>{if(!_||Object.keys(_).length===0)return W;const G=(0,Si.X)(_);return W.sort(G)},Po={id:ee.F.organize,editor:ii,transformation:se.c.organizeFieldsTransformer,name:se.c.organizeFieldsTransformer.name,description:"Allows the user to re-order, hide, or rename fields / columns. Useful when data source doesn't allow overrides for visualizing data.",categories:new Set([x.m.ReorderAndRename]),help:ue(ee.F.organize).helperDocs};var fo=e(21128),rr=e(13544);const li=({options:W,onChange:_})=>{const G=[{label:"Series to rows",value:fo.rV.SeriesToRows,description:"Create a table with one row for each series value"},{label:"Reduce fields",value:fo.rV.ReduceFields,description:"Collapse each field into a single value"}],de=(0,l.useCallback)(we=>{const ke=we.value;_({...W,mode:ke,includeTimeField:ke===fo.rV.ReduceFields?!!W.includeTimeField:!1})},[_,W]),xe=(0,l.useCallback)(()=>{_({...W,includeTimeField:!W.includeTimeField})},[_,W]),Me=(0,l.useCallback)(()=>{_({...W,labelsToFields:!W.labelsToFields})},[_,W]);return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(Z.I,{label:"Mode","data-testid":rr.Tp.components.Transforms.Reduce.modeLabel,grow:!0,labelWidth:16,children:(0,j.jsx)(Te.l6,{options:G,value:G.find(we=>we.value===W.mode)||G[0],onChange:de})}),(0,j.jsx)(Z.I,{label:"Calculations","data-testid":rr.Tp.components.Transforms.Reduce.calculationsLabel,grow:!0,labelWidth:16,children:(0,j.jsx)(mn.S,{placeholder:"Choose Stat",allowMultiple:!0,stats:W.reducers||[],onChange:we=>{_({...W,reducers:we})}})}),W.mode===fo.rV.ReduceFields&&(0,j.jsx)(Z.I,{htmlFor:"include-time-field",labelWidth:16,label:"Include time",children:(0,j.jsx)(qn.K,{id:"include-time-field",value:!!W.includeTimeField,onChange:xe})}),W.mode!==fo.rV.ReduceFields&&(0,j.jsx)(Z.I,{htmlFor:"labels-to-fields",labelWidth:16,label:"Labels to fields",children:(0,j.jsx)(qn.K,{id:"labels-to-fields",value:!!W.labelsToFields,onChange:Me})})]})},dl={id:ee.F.reduce,editor:li,transformation:se.c.reduceTransformer,name:se.c.reduceTransformer.name,description:se.c.reduceTransformer.description,categories:new Set([x.m.CalculateNewFields]),help:ue(ee.F.reduce).helperDocs};class Hi extends l.PureComponent{constructor(_){super(_),this.handleRegexChange=G=>{const de=G.currentTarget.value;let xe=!0;if(de)try{de&&(0,Hr.dO)(de)}catch{xe=!1}this.setState(Me=>({...Me,regex:de,isRegexValid:xe}))},this.handleRenameChange=G=>{const de=G.currentTarget.value;this.setState(xe=>({...xe,renamePattern:de}))},this.handleRegexBlur=G=>{const de=G.currentTarget.value;let xe=!0;try{de&&(0,Hr.dO)(de)}catch{xe=!1}this.setState({isRegexValid:xe},()=>{xe&&this.props.onChange({...this.props.options,regex:de})})},this.handleRenameBlur=G=>{const de=G.currentTarget.value;this.setState({renamePattern:de},()=>this.props.onChange({...this.props.options,renamePattern:de}))},this.state={regex:_.options.regex,renamePattern:_.options.renamePattern,isRegexValid:!0}}render(){const{regex:_,renamePattern:G,isRegexValid:de}=this.state;return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(Z.I,{label:"Match",labelWidth:16,invalid:!de,error:de?void 0:"Invalid pattern",children:(0,j.jsx)(Ze.p,{placeholder:"Regular expression pattern",value:_||"",onChange:this.handleRegexChange,onBlur:this.handleRegexBlur,width:25})}),(0,j.jsx)(Z.I,{label:"Replace",labelWidth:16,children:(0,j.jsx)(Ze.p,{placeholder:"Replacement pattern",value:G||"",onChange:this.handleRenameChange,onBlur:this.handleRenameBlur,width:25})})]})}}const ul={id:ee.F.renameByRegex,editor:Hi,transformation:se.c.renameByRegexTransformer,name:se.c.renameByRegexTransformer.name,description:"Renames part of the query result by using regular expression with placeholders.",categories:new Set([x.m.ReorderAndRename]),help:ue(ee.F.renameByRegex).helperDocs},ki=({input:W,options:_,onChange:G})=>null,hl={id:ee.F.seriesToRows,editor:ki,transformation:se.c.seriesToRowsTransformer,name:se.c.seriesToRowsTransformer.name,description:`Merge many series and return a single series with time, metric and value as columns.
                Useful for showing multiple time series visualized in a table.`,categories:new Set([x.m.Combine,x.m.Reformat]),help:ue(ee.F.seriesToRows).helperDocs},Gi=({input:W,options:_,onChange:G})=>{const de=(0,Pe.ZI)(W).map(Xe=>({label:Xe,value:Xe})),Me=(0,je.w)().getVariables().map(Xe=>({label:"$"+Xe.name,value:"$"+Xe.name})),we=(0,l.useCallback)((Xe,ht)=>{G({..._,sort:[ht]})},[G,_]),ke=_.sort?.length?_.sort:[{}];return(0,j.jsx)("div",{children:ke.map((Xe,ht)=>(0,j.jsxs)(ge.C,{children:[(0,j.jsx)(Z.I,{label:"Field",labelWidth:10,grow:!0,children:(0,j.jsx)(Te.l6,{options:ae.$.featureToggles.transformationsVariableSupport?[...de,...Me]:de,value:Xe.field,placeholder:"Select field",onChange:mt=>{we(ht,{...Xe,field:mt.value})}})}),(0,j.jsx)(Z.I,{label:"Reverse",children:(0,j.jsx)(qn.K,{value:!!Xe.desc,onChange:()=>{we(ht,{...Xe,desc:!Xe.desc})}})})]},`${Xe.field}/${ht}`))})},fl={id:ee.F.sortBy,editor:Gi,transformation:se.c.sortByTransformer,name:se.c.sortByTransformer.name,description:se.c.sortByTransformer.description,categories:new Set([x.m.ReorderAndRename]),help:ue(ee.F.sortBy).helperDocs};function Qi({options:W,onChange:_}){const[G,de]=(0,l.useState)(W),xe=Yi(),Me=Wo(),we=()=>{G.push({path:""}),de([...G]),ht()},ke=mt=>{G&&(G.splice(mt,1),de([...G]),ht())},Xe=(mt,bt,Kt)=>{G&&(Kt==="alias"?G[bt].alias=mt.currentTarget.value??"":G[bt].path=mt.currentTarget.value??"",de([...G]))},ht=()=>{_(G)};return(0,j.jsxs)("ol",{className:(0,Qe.cx)(Me.list),children:[G&&G.map((mt,bt)=>(0,j.jsx)("li",{children:(0,j.jsxs)(ge.C,{children:[(0,j.jsx)(Z.I,{label:"Field",tooltip:xe.field,grow:!0,children:(0,j.jsx)(Ze.p,{onBlur:ht,onChange:Kt=>Xe(Kt,bt,"path"),value:mt.path,placeholder:'A valid json path, e.g. "object.value1" or "object.value2[0]"'})}),(0,j.jsx)(Z.I,{label:"Alias",tooltip:xe.alias,children:(0,j.jsx)(Ze.p,{width:12,value:mt.alias,onBlur:ht,onChange:Kt=>Xe(Kt,bt,"alias")})}),(0,j.jsx)(Z.I,{className:(0,Qe.cx)(Me.removeIcon),children:(0,j.jsx)(Ta.K,{onClick:()=>ke(bt),name:"trash-alt",tooltip:"Remove path"})})]})},bt)),(0,j.jsx)(Z.I,{children:(0,j.jsx)(ye.$n,{icon:"plus",onClick:()=>we(),variant:"secondary",children:"Add path"})})]})}const Yi=()=>{const W=[{path:"object",description:"=> extract fields from object"},{path:"object.value1",description:"=> extract value1"},{path:"object.value2",description:"=> extract value2"},{path:"object.value2[0]",description:"=> extract value2 first element"},{path:"object.value2[1]",description:"=> extract value2 second element"}];return{field:(0,j.jsxs)("div",{children:["A valid path of an json object.",(0,j.jsx)("div",{children:(0,j.jsx)("strong",{children:"JSON Value:"})}),(0,j.jsx)("pre",{children:(0,j.jsx)("code",{children:["{",'  "object": {','    "value1": "hello world"','    "value2": [1, 2, 3, 4]',"  }","}"].join(`
`)})}),(0,j.jsx)("strong",{children:"Valid Paths:"}),W.map((_,G)=>(0,j.jsxs)("p",{children:[(0,j.jsx)("code",{children:_.path}),(0,j.jsx)("i",{children:_.description})]},G))]}),alias:"An alias name for the variable in the dashboard. If left blank the given path will be used."}};function Wo(){return{list:(0,Qe.css)`
      margin-left: 20px;
    `,removeIcon:(0,Qe.css)`
      margin: 0 0 0 4px;
      align-items: center;
    `}}var Fo=e(14236),bo=(W=>(W.JSON="json",W.KeyValues="kvp",W.Auto="auto",W))(bo||{});const ci={id:bo.JSON,name:"JSON",description:"Parse JSON string",parse:W=>JSON.parse(W)};function Ko(W){const _=[];let G="",de="";const xe={};for(let Me=0;Me<W.length;Me++){let we=W[Me];we===G&&(G="",we=W[++Me]);const ke=we==="\\";if(ke&&(we=W[++Me]),ke||G.length){_.push(we);continue}switch((we==='"'||we==="'")&&(G=we),we){case":":case"=":_.length&&(de&&(xe[de]=""),de=_.join(""),_.length=0);break;case'"':case"'":case" ":case`
`:case"	":case"\r":case`
`:_.length&&de===""&&(xe[_.join("")]="",_.length=0);case",":case";":case"&":case"{":case"}":if(_.length){const Xe=_.join("");de.length?(xe[de]=Xe,de=""):de=Xe,_.length=0}break;default:_.push(we),Me===W.length-1&&de===""&&_.length&&(xe[_.join("")]="",_.length=0)}}return de.length&&(xe[de]=_.join("")),xe}const Oi={id:bo.KeyValues,name:"Key+value pairs",description:"Look for a=b, c: d values in the line",parse:Ko},mo=[ci,Oi],Ii={id:bo.Auto,name:"Auto",description:"parse new fields automatically",parse:W=>{for(const _ of mo)try{const G=_.parse(W);if(G!=null)return G}catch{}}},Co=new Le.O(()=>[...mo,Ii]),jr={id:ee.F.extractFields,name:"Extract fields",description:"Parse fields from the contends of another",defaultOptions:{},operator:(W,_)=>G=>G.pipe((0,Tt.T)(de=>jr.transformer(W,_)(de))),transformer:W=>_=>_.map(G=>di(G,W))};function di(W,_){if(!_.source)return W;const G=(0,Gs.findField)(W,_.source);if(!G)return W;const de=Co.getIfExists(_.format??bo.Auto);if(!de)throw new Error("unkonwn extractor");const xe=W.length,Me=[],we=new Map;for(let Xe=0;Xe<xe;Xe++){let ht=G.values[Xe];if((0,m.isString)(ht))try{ht=de.parse(ht)}catch{ht={}}if(ht!=null){if(_.format===bo.JSON&&_.jsonPaths&&_.jsonPaths?.length>0){const mt={},bt=_.jsonPaths.filter(Kt=>Kt.path);bt.length>0&&(bt.forEach(Kt=>{const Rt=Kt.alias&&Kt.alias.length>0?Kt.alias:Kt.path;mt[Rt]=(0,m.get)(ht,Kt.path)??"Not Found"}),ht=mt)}for(const[mt,bt]of Object.entries(ht)){let Kt=we.get(mt);Kt==null&&(Kt=new Array(xe).fill(void 0),we.set(mt,Kt),Me.push(mt)),Kt[Xe]=bt}}}const ke=Me.map(Xe=>{const ht=we.get(Xe),mt={name:Xe,values:ht,type:ht?(0,Fo.oE)(ht.find(bt=>bt!=null)):te.PU.other,config:{}};return ae.$.featureToggles.extractFieldsNameDeduplication&&(mt.name=(0,z.fk)(mt,W)),mt});if(_.keepTime){const Xe=(0,Gs.findField)(W,"Time")||(0,Gs.findField)(W,"time");Xe&&ke.unshift(Xe)}return _.replace||ke.unshift(...W.fields),{...W,fields:ke}}const vo={settings:{width:30,placeholderText:"Select field"},name:"",id:"",editor:()=>null},ui=({input:W,options:_,onChange:G})=>{const de=ht=>{G({..._,source:ht})},xe=ht=>{G({..._,format:ht?.value})},Me=ht=>{G({..._,jsonPaths:ht})},we=()=>{_.replace&&(_.keepTime=!1),G({..._,replace:!_.replace})},ke=()=>{G({..._,keepTime:!_.keepTime})},Xe=Co.selectOptions(_.format?[_.format]:void 0);return(0,j.jsxs)("div",{children:[(0,j.jsx)(ge.C,{children:(0,j.jsx)(Z.I,{label:"Source",labelWidth:16,children:(0,j.jsx)(kn.O,{context:{data:W},value:_.source??"",onChange:de,item:vo})})}),(0,j.jsx)(ge.C,{children:(0,j.jsx)(Z.I,{label:"Format",labelWidth:16,children:(0,j.jsx)(Te.l6,{value:Xe.current[0],options:Xe.options,onChange:xe,width:24,placeholder:"Auto"})})}),_.format==="json"&&(0,j.jsx)(Qi,{options:_.jsonPaths??[],onChange:Me}),(0,j.jsx)(ge.C,{children:(0,j.jsx)(Z.I,{label:"Replace all fields",labelWidth:16,children:(0,j.jsx)(qn.K,{value:_.replace??!1,onChange:we})})}),_.replace&&(0,j.jsx)(ge.C,{children:(0,j.jsx)(Z.I,{label:"Keep time",labelWidth:16,children:(0,j.jsx)(qn.K,{value:_.keepTime??!1,onChange:ke})})})]})},gl={id:ee.F.extractFields,editor:ui,transformation:jr,name:jr.name,description:"Parse fields from content (JSON, labels, etc).",categories:new Set([x.m.Reformat]),help:ue(ee.F.extractFields).helperDocs};var yo=e(51986);const Jr={id:ee.F.joinByLabels,name:"Join by labels",description:"Flatten labeled results into a table joined by labels.",defaultOptions:{},operator:(W,_)=>G=>G.pipe((0,Tt.T)(de=>Jr.transformer(W,_)(de))),transformer:W=>_=>!_||!_.length?_:[Ji(W,_)]};function Ji(W,_){if(!W.value?.length)return $o("No value labele configured");const G=(0,Pe.aG)(_);if(G.size<1)return $o("No labels in result");if(!G.has(W.value))return $o("Value label not found");let de=W.join?.length?W.join:Array.from(G);de=de.filter(bt=>bt!==W.value);const xe=new Set,Me=new Map,we={};for(const bt of _)for(const Kt of bt.fields)if(Kt.labels&&Kt.type!==te.PU.time){const Rt=de.map(Ds=>Kt.labels[Ds]),Ct=Rt.join(",");let Ut=Me.get(Ct);Ut||(Ut={keys:Rt,values:{}},Me.set(Ct,Ut));const hn=Kt.labels[W.value],Zn=Kt.values,As=Ut.values[hn];As?Ut.values[hn]=As.concat(Zn):Ut.values[hn]=Zn,we[hn]||(we[hn]=Kt),xe.add(hn)}const ke=Array.from(xe),Xe=de.map(()=>[]),ht=ke.map(()=>[]);for(const bt of Me.values()){let Kt=-1,Rt=!1;for(;!Rt;){Kt++,Rt=!0;for(let Ct=0;Ct<de.length;Ct++)Xe[Ct].push(bt.keys[Ct]);for(let Ct=0;Ct<ke.length;Ct++){const Ut=ke[Ct],hn=bt.values[Ut]??[];ht[Ct].push(hn[Kt]),hn.length>Kt+1&&(Rt=!1)}}}const mt={fields:[],length:ht[0].length};for(let bt=0;bt<de.length;bt++)mt.fields.push({name:de[bt],config:{},type:te.PU.string,values:Xe[bt]});for(let bt=0;bt<ke.length;bt++){const Kt=we[ke[bt]];mt.fields.push({name:ke[bt],config:{},type:Kt.type??te.PU.number,values:ht[bt]})}return mt}function $o(W){return{meta:{notices:[{severity:"error",text:W}]},fields:[{name:"Error",type:te.PU.string,config:{},values:[W]}],length:0}}function Ai({input:W,options:_,onChange:G}){const de=(0,l.useMemo)(()=>{let Xe;const ht=(0,Pe.aG)(W),mt=Array.from(ht).map(hn=>({label:hn,value:hn}));let bt=mt.find(hn=>hn.value===_.value);!bt&&_.value&&(bt={label:`${_.value} (not found)`,value:_.value},mt.push(bt)),W.length?ht.size===0&&(Xe=(0,j.jsx)(vn.F,{title:"No labels found",children:"The input does not contain any labels"})):Xe=(0,j.jsx)(vn.F,{title:"No input found",children:"No input (or labels) found"}),ht.delete(_.value);const Kt=Array.from(ht).map(hn=>({label:hn,value:hn}));let Rt=Kt;const Ct=!!_.join?.length;let Ut="Join";return Ct?Rt=Kt.filter(hn=>!_.join.includes(hn.value)):Ut=Kt.map(hn=>hn.value).join(", "),{warn:Xe,valueOptions:mt,valueOption:bt,joinOptions:Kt,addOptions:Rt,addText:Ut,hasJoin:Ct,key:Date.now()}},[_,W]),xe=(Xe,ht)=>{if(!_.join)return;const mt=_.join.slice();if(ht)mt[Xe]=ht;else if(mt.splice(Xe,1),!mt.length){G({..._,join:void 0});return}const bt=new Set(mt);_.value&&bt.delete(_.value),G({..._,join:Array.from(bt)})},Me=Xe=>{const ht=Xe?.value;if(!ht)return;const mt=_.join?_.join.slice():[];mt.push(ht),G({..._,join:mt})},we=10,ke="No labels found";return(0,j.jsxs)("div",{children:[de.warn,(0,j.jsx)(ge.C,{children:(0,j.jsx)(Z.I,{error:"required",invalid:!_.value?.length,label:"Value",labelWidth:we,tooltip:"Select the label indicating the values name",children:(0,j.jsx)(Te.l6,{options:de.valueOptions,value:de.valueOption,onChange:Xe=>G({..._,value:Xe.value}),noOptionsMessage:ke})})}),de.hasJoin?_.join.map((Xe,ht)=>(0,j.jsx)(ge.C,{children:(0,j.jsx)(Z.I,{label:"Join",labelWidth:we,error:"Unable to join by the value label",invalid:Xe===_.value,children:(0,j.jsxs)(ca.Gy,{children:[(0,j.jsx)(Te.l6,{options:de.joinOptions,value:de.joinOptions.find(mt=>mt.value===Xe),isClearable:!0,onChange:mt=>xe(ht,mt?.value),noOptionsMessage:ke}),!!(de.addOptions.length&&ht===_.join.length-1)&&(0,j.jsx)(yo.i,{icon:"plus",label:"",options:de.addOptions,onChange:Me,variant:"secondary"})]})})},Xe+ht)):(0,j.jsx)(j.Fragment,{children:!!de.addOptions.length&&(0,j.jsx)(ge.C,{children:(0,j.jsx)(Z.I,{label:"Join",labelWidth:we,children:(0,j.jsx)(Te.l6,{options:de.addOptions,placeholder:de.addText,onChange:Me,noOptionsMessage:ke})})})})]})}const Vo={id:Jr.id,editor:Ai,transformation:Jr,name:Jr.name,description:Jr.description,state:rt.pn.beta,categories:new Set([x.m.Combine]),help:ue(Jr.id).helperDocs};var Xi=e(84350),Fr=e(69862),Xr=e(65474),Gr=e(67140);const Ri={id:ee.F.fieldLookup,name:"Lookup fields from resource",description:"Retrieve matching data based on specified field",defaultOptions:{},operator:W=>_=>_.pipe((0,Fr.Z)(G=>(0,Xr.H)(pl(G,W))))};async function pl(W,_){const G=ne.sJ.get(le.Ct.byName).get(_?.lookupField),de=await(0,Gr.q3)(_?.gazetteer??Gr.fx);return de.frame?Jo(W,de,G):Promise.reject("missing frame in gazetteer")}function Jo(W,_,G){const de=_.frame()?.fields;return de?W.map(xe=>{const Me=xe.length,we=[];for(const ke of xe.fields)if(we.push(ke),G(ke,xe,W)){const Xe=ke.values,ht=[];for(const mt of de){const bt=new Array(Me);ht.push(bt),we.push({...mt,values:bt})}for(let mt=0;mt<_.count;mt++){const bt=_.find(Xe[mt]);if(bt?.index!=null)for(let Kt=0;Kt<de.length;Kt++)ht[Kt][mt]=de[Kt].values[bt.index]}}return{...xe,fields:we}}):W}const Ul={settings:{width:30,filter:W=>W.type===te.PU.string,placeholderText:"Select text field",noFieldsMessage:"No text fields found"},name:"",id:"",editor:()=>null},hi={settings:{}},Zi=({input:W,options:_,onChange:G})=>{const de=(0,l.useCallback)(Me=>{G({..._,lookupField:Me})},[G,_]),xe=(0,l.useCallback)(Me=>{G({..._,gazetteer:Me})},[G,_]);return(0,j.jsxs)("div",{children:[(0,j.jsx)(ge.C,{children:(0,j.jsx)(Z.I,{label:"Field",labelWidth:12,children:(0,j.jsx)(kn.O,{context:{data:W},value:_?.lookupField??"",onChange:de,item:Ul})})}),(0,j.jsx)(ge.C,{children:(0,j.jsx)(Z.I,{label:"Lookup",labelWidth:12,children:(0,j.jsx)(Xi.G,{value:_?.gazetteer??"",context:{data:W},item:hi,onChange:xe})})})]})},qi={id:ee.F.fieldLookup,editor:Zi,transformation:Ri,name:Ri.name,description:"Use a field value to lookup additional fields from an external source. This currently supports spatial data, but will eventually support more formats.",state:rt.pn.alpha,categories:new Set([x.m.PerformSpatialOperations]),help:ue(ee.F.fieldLookup).helperDocs};var Li=e(35602),fi=e(64586);const ji=(W,_,G=[])=>(_===0?G.push(W):W.forEach(de=>{ji(de,_-1,G)}),G);function Xo(W){const _=W[0].length,G=W.length,de=new Map;for(let xe=0;xe<_;xe++){let Me=de;for(let we=0;we<G;we++){let ke=W[we][xe],Xe=Me.get(ke);Xe==null&&(Xe=we===G-1?[]:new Map,Me.set(ke,Xe)),Me=Xe}Me.push(xe)}return ji(de,G)}const Fe={asLabels:!0,append:!1,withNames:!1,separator1:"=",separator2:" "};function _e(W,_,G){return _.map((de,xe)=>W.withNames?`${de}${W.separator1}${G[xe]}`:G[xe]).join(W.separator2)}function tt(W,_){const G={};return W.forEach((de,xe)=>{G[de]=String(_[xe])}),G}const ft={id:ee.F.partitionByValues,name:"Partition by values",description:"Splits a one-frame dataset into multiple series discriminated by unique/enum values in one or more fields.",defaultOptions:{keepFields:!1},operator:(W,_)=>G=>G.pipe((0,Tt.T)(de=>ft.transformer(W,_)(de))),transformer:(W,_)=>{const G=(0,Li.R)(_,{names:W.fields});if(!G)return fi.W.transformer({},_);const de=(0,ne.NS)(G);return xe=>xe.length?Mt(xe[0],de,W):xe}};function Mt(W,_,G){const de=W.fields.filter(ke=>_(ke,W,[W]));if(!de.length)return[W];const xe=de.map(ke=>ke.values),Me=de.map(ke=>ke.name),we={...Fe,...G?.naming};return Xo(xe).map(ke=>{let Xe=W.name,ht={};if(we.asLabels)ht=tt(Me,de.map((bt,Kt)=>xe[Kt][ke[0]]));else{let bt=_e(we,Me,de.map((Kt,Rt)=>xe[Rt][ke[0]]));we?.append&&W.name&&(bt=`${W.name} ${bt}`),Xe=bt}let mt=W.fields;if(!G?.keepFields){const bt=new Set(Me);mt=W.fields.filter(Kt=>!bt.has(Kt.name))}return{name:Xe,meta:W.meta,length:ke.length,fields:mt.map(bt=>{const Kt=bt.values,Rt=Array(ke.length);for(let Ct=0;Ct<ke.length;Ct++)Rt[Ct]=Kt[ke[Ct]];return{name:bt.name,type:bt.type,config:bt.config,labels:{...bt.labels,...ht},values:Rt}})}})}function $t({input:W,options:_,onChange:G}){const de=(0,hr.sE)(W),xe=(0,hr.m3)(de),Me=(0,l.useMemo)(()=>{const Kt=new Set(_.fields);return Kt.size<1?xe:xe.filter(Rt=>!Kt.has(Rt.value))},[xe,_]),we=(0,l.useCallback)(Kt=>{if(!Kt.value)return;const Rt=new Set(_.fields);Rt.add(Kt.value),G({..._,fields:[...Rt]})},[G,_]);let ke;(Kt=>{Kt[Kt.asLabels=0]="asLabels",Kt[Kt.frameName=1]="frameName"})(ke||(ke={}));const Xe=[{label:"As label",value:0},{label:"As frame name",value:1}],ht=[{label:"Yes",value:!0},{label:"No",value:!1}],mt=(0,l.useCallback)(Kt=>{if(!Kt)return;const Rt=new Set(_.fields);Rt.delete(Kt),G({..._,fields:[...Rt]})},[G,_]);if(W.length>1)return(0,j.jsx)(pa.P,{children:"Partition by values only works with a single frame."});const bt=[...new Set(_.fields)];return(0,j.jsxs)("div",{children:[(0,j.jsx)(ge.C,{children:(0,j.jsx)(Z.I,{label:"Field",labelWidth:10,grow:!0,children:(0,j.jsxs)(ca.Gy,{children:[bt.map(Kt=>(0,j.jsx)(ye.$n,{icon:"times",variant:"secondary",size:"md",onClick:()=>mt(Kt),children:Kt},Kt)),Me.length&&(0,j.jsx)(yo.i,{variant:"secondary",size:"md",options:Me,onChange:we,label:"Select field",icon:"plus"})]})})}),(0,j.jsx)(ge.C,{children:(0,j.jsx)(Z.I,{tooltip:"Sets how the names of the selected fields are displayed. As frame name is usually better for tabular data",label:"Naming",labelWidth:10,children:(0,j.jsx)(oe.z,{options:Xe,value:_.naming?.asLabels===void 0||_.naming.asLabels?0:1,onChange:Kt=>G({..._,naming:{..._.naming,asLabels:Kt===0}})})})}),(0,j.jsx)(ge.C,{children:(0,j.jsx)(Z.I,{tooltip:"Keeps the partition fields in the frames.",label:"Keep fields",labelWidth:16,children:(0,j.jsx)(oe.z,{options:ht,value:_.keepFields,onChange:Kt=>G({..._,keepFields:Kt})})})})]})}const Jt={id:ee.F.partitionByValues,editor:$t,transformation:ft,name:ft.name,description:ft.description,state:rt.pn.alpha,categories:new Set([x.m.Reformat]),help:ue(ee.F.partitionByValues).helperDocs};var nn=e(41260),Dn=e(37471),In=e(73060),ts=(W=>(W.TimeSeriesWide="wide",W.TimeSeriesLong="long",W.TimeSeriesMulti="multi",W.TimeSeriesMany="many",W))(ts||{});function hs(W){if(!Array.isArray(W)||W.length===0)return W;const _=[];for(const G of Yn(W)){const de=G.fields[0];if(!de||de.type!==te.PU.time)continue;const xe=[],Me=[];for(const we of G.fields)switch(we.type){case te.PU.number:case te.PU.boolean:xe.push(we);break;case te.PU.string:Me.push(we);break}for(const we of xe)if(Me.length){const ke=new Map;for(let Xe=0;Xe<G.length;Xe++){const ht=de.values[Xe],mt=we.values[Xe];if(mt===void 0||ht==null)continue;const bt=Me.map(Rt=>Rt.values[Xe]).join("/");let Kt=ke.get(bt);if(!Kt){Kt={key:bt,time:[],value:[],labels:{}};for(const Rt of Me)Kt.labels[Rt.name]=Rt.values[Xe];ke.set(bt,Kt)}Kt.time.push(ht),Kt.value.push(mt)}for(const Xe of ke.values())_.push({name:G.name,refId:G.refId,meta:{...G.meta,type:nn.m.TimeSeriesMulti},fields:[{...de,values:Xe.time},{...we,values:Xe.value,labels:Xe.labels}],length:Xe.time.length})}else _.push({name:G.name,refId:G.refId,meta:{...G.meta,type:nn.m.TimeSeriesMulti},fields:[de,we],length:G.length})}return _}function Yn(W){if(!Array.isArray(W)||W.length===0)return W;const _=[];for(const G of W){let de;const xe=[],Me={},we={},ke={},Xe={};for(let Ct=0;Ct<G.fields.length;Ct++){const Ut=G.fields[Ct];switch(Ut.type){case te.PU.string:case te.PU.boolean:Ut.name in Xe||(Xe[Ut.name]=Ct,we[Ut.name]=!0);break;case te.PU.time:if(!de){de=Ut;break}default:if(Ut.name in Me){const As=Me[Ut.name];if(Ut.type!==As)continue}else Me[Ut.name]=Ut.type,xe.push(Ut.name);const hn=JSON.stringify(Ut.labels),Zn=ke[hn];if(Zn!==void 0?Zn.push(Ct):ke[hn]=[Ct],Ut.labels!=null)for(const As in Ut.labels)we[As]=!0}}if(!de)continue;const ht=[],mt=[],bt=[],Kt=[];for(let Ct=0;Ct<G.length;Ct++)ht.push({time:de.values[Ct],wideRowIndex:Ct});for(const Ct in ke)mt.push(Ct);for(const Ct in we)bt.push(Ct);for(const Ct in Xe)Kt.push(Ct);ht.sort((Ct,Ut)=>Ct.time-Ut.time),mt.sort(),bt.sort(),xe.sort();const Rt=new Dn.k({...G,meta:{...G.meta,type:nn.m.TimeSeriesLong},fields:[{name:de.name,type:de.type}]});for(const Ct of xe)Rt.addField({name:Ct,type:Me[Ct]});for(const Ct of bt)Rt.addField({name:Ct,type:te.PU.string});for(const Ct of ht){const{time:Ut,wideRowIndex:hn}=Ct;for(const Zn of mt){const As={};for(const Fs of Kt)As[Fs]=G.fields[Xe[Fs]].values[hn];let Ds=0;for(const Fs of ke[Zn]){const Ar=G.fields[Fs];if(Ds++===0&&Ar.labels!=null)for(const si in Ar.labels)As[si]=Ar.labels[si];As[Ar.name]=Ar.values[hn]}As[de.name]=Ut,Rt.add(As)}}_.push(Rt)}return _}function bs(W){return Mt(W,G=>G.type===te.PU.string).map(G=>(G.meta||(G.meta={}),G.meta.type=nn.m.TimeSeriesMulti,G))}const Ns={id:ee.F.prepareTimeSeries,name:"Prepare time series",description:"Will stretch data frames from the wide format into the long format. This is really helpful to be able to keep backwards compatibility for panels not supporting the new wide format.",defaultOptions:{},operator:(W,_)=>G=>G.pipe((0,Tt.T)(de=>Ns.transformer(W,_)(de))),transformer:W=>{const _=W?.format??"wide";if(_==="many"||_==="multi")return hs;if(_==="long")return Yn;const G=ne.sJ.get(le.Ct.firstTimeField).get({});return de=>{if(!de.length)return[];const xe=[];for(const we of de)we.meta?.type===nn.m.TimeSeriesLong?bs(we).forEach(ke=>xe.push(ke)):xe.push(we);const Me=(0,In.Fd)({frames:xe,joinBy:G,keepOriginIndices:!0});return Me?(Me.meta||(Me.meta={}),Me.meta.type=nn.m.TimeSeriesWide,[Me]):[]}}},ns={label:"Wide time series",value:ts.TimeSeriesWide,description:"Creates a single frame joined by time",info:(0,j.jsxs)("ul",{children:[(0,j.jsx)("li",{children:"Single frame"}),(0,j.jsx)("li",{children:"1st field is shared time field"}),(0,j.jsx)("li",{children:"Time in ascending order"}),(0,j.jsx)("li",{children:"Multiple value fields of any type"})]})},ta={label:"Multi-frame time series",value:ts.TimeSeriesMulti,description:"Creates a new frame for each time/number pair",info:(0,j.jsxs)("ul",{children:[(0,j.jsx)("li",{children:"Multiple frames"}),(0,j.jsx)("li",{children:"Each frame has two fields: time, value"}),(0,j.jsx)("li",{children:"Time in ascending order"}),(0,j.jsx)("li",{children:"String values are represented as labels"}),(0,j.jsx)("li",{children:"All values are numeric"})]})},Ms={label:"Long time series",value:ts.TimeSeriesLong,description:"Convert each frame to long format",info:(0,j.jsxs)("ul",{children:[(0,j.jsx)("li",{children:"Single frame"}),(0,j.jsx)("li",{children:"1st field is time field"}),(0,j.jsx)("li",{children:"Time in ascending order, but may have duplictes"}),(0,j.jsx)("li",{children:"String values are represented as separate fields rather than as labels"}),(0,j.jsx)("li",{children:"Multiple value fields may exist"})]})},Qs=[ns,ta,Ms];function oa(W){const{options:_,onChange:G}=W,de=(0,pt.of)(ms),xe=(0,l.useCallback)(Me=>{G({..._,format:Me.value})},[G,_]);return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(ge.C,{children:(0,j.jsx)(Z.I,{label:"Format",labelWidth:12,children:(0,j.jsx)(Te.l6,{width:35,options:Qs,value:Qs.find(Me=>Me.value===ts.TimeSeriesMulti&&_.format===ts.TimeSeriesMany?!0:Me.value===_.format)||Qs[0],onChange:xe,className:"flex-grow-1"})})}),(0,j.jsx)(ge.C,{children:(0,j.jsx)(Z.I,{label:"Info",labelWidth:12,children:(0,j.jsx)("div",{className:de.info,children:(Qs.find(Me=>Me.value===_.format)||Qs[0]).info})})})]})}const ms=W=>({info:(0,Qe.css)`
    margin-left: 20px;
  `}),xa={id:Ns.id,editor:oa,transformation:Ns,name:Ns.name,description:Ns.description,categories:new Set([x.m.Reformat]),help:ue(Ns.id).helperDocs};var Ua=e(66648),_a=e(48817),La=(W=>(W.linear="linear",W.polynomial="polynomial",W))(La||{});const va={predictionCount:100,modelType:"linear",degree:2},wa={id:ee.F.regression,name:"Regression analysis",operator:(W,_)=>G=>G.pipe((0,Tt.T)(de=>wa.transformer(W,_)(de))),transformer:(W,_)=>G=>{const{predictionCount:de,modelType:xe,degree:Me}={...va,...W};if(G.length===0)return G;const we=ne.sJ.get(le.Ct.byName).get(W.yFieldName),ke=ne.sJ.get(le.Ct.byName).get(W.xFieldName);let Xe,ht,mt;for(const Fs of G){const Ar=Fs.fields.find(si=>we(si,Fs,G));if(Ar){ht=Ar;const si=Fs.fields.find(xp=>ke(xp,Fs,G));if(si){Xe=si,mt=Fs;break}else throw"X and Y fields must be part of the same frame"}}if(!Xe||!ht)return G;let bt=Xe.values[0],Kt=Xe.values[0];for(let Fs=1;Fs<Xe.values.length;Fs++)Xe.values[Fs]<bt&&(bt=Xe.values[Fs]),Xe.values[Fs]>Kt&&(Kt=Xe.values[Fs]);const Rt=(Kt-bt)/(de-1),Ct=[...[...Array(de-1).keys()].map((Fs,Ar)=>Ar*Rt+bt),Kt],Ut=Xe.type===te.PU.time?bt:0,hn=[],Zn=[];for(let Fs=0;Fs<Xe.values.length;Fs++)ht.values[Fs]!==null&&!isNaN(ht.values[Fs])&&(Zn.push(Xe.values[Fs]-Ut),hn.push(ht.values[Fs]));let As;switch(xe){case"linear":As=new _a.X(Zn,hn);break;case"polynomial":As=new Ua.Y(Zn,hn,Me);break;default:return G}const Ds={name:`${xe} regression`,length:Ct.length,fields:[{name:Xe.name,type:Xe.type,values:Ct,config:{}},{name:`${(0,z.Ct)(ht,mt,G)} predicted`,type:ht.type,values:Ct.map(Fs=>As.predict(Fs-Ut)),config:{}}]};return[...G,Ds]}},Kr={editor:kn.O,id:"",name:"",settings:{width:24,isClearable:!1}},Pr=20,fr=({input:W,options:_,onChange:G})=>{const de=[{label:"Linear",value:La.linear},{label:"Polynomial",value:La.polynomial}];return(0,l.useEffect)(()=>{let xe,Me;if(!_.xFieldName){const we=ne.sJ.get(le.Ct.firstTimeField).get({});for(const ke of W)if(xe=ke.fields.find(Xe=>we(Xe,ke,W)),xe)break;if(!xe){const ke=ne.sJ.get(le.Ct.numeric).get({});for(const Xe of W)if(xe=Xe.fields.find(ht=>ke(ht,Xe,W)),xe)break}}if(!_.yFieldName){const we=ne.sJ.get(le.Ct.numeric).get({});for(const ke of W)if(Me=ke.fields.find(Xe=>we(Xe,ke,W)&&Xe!==xe),Me)break}xe&&Me&&G({..._,xFieldName:xe.name,yFieldName:Me.name})}),(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(Z.I,{labelWidth:Pr,label:"X field",children:(0,j.jsx)(kn.O,{context:{data:W},value:_.xFieldName??"",item:Kr,onChange:xe=>{G({..._,xFieldName:xe})}})}),(0,j.jsx)(Z.I,{labelWidth:Pr,label:"Y field",children:(0,j.jsx)(kn.O,{context:{data:W},value:_.yFieldName??"",item:Kr,onChange:xe=>{G({..._,yFieldName:xe})}})}),(0,j.jsx)(Z.I,{labelWidth:Pr,label:"Model type",children:(0,j.jsx)(Te.l6,{value:_.modelType??va.modelType,onChange:xe=>{G({..._,modelType:xe.value??va.modelType})},options:de})}),(0,j.jsx)(Z.I,{labelWidth:Pr,label:"Predicted points",tooltip:"Number of X,Y points to predict",children:(0,j.jsx)(ga.Q,{value:_.predictionCount??va.predictionCount,onChange:xe=>{G({..._,predictionCount:xe})}})}),_.modelType===La.polynomial&&(0,j.jsx)(Z.I,{labelWidth:Pr,label:"Degree",children:(0,j.jsx)(Te.l6,{value:_.degree??va.degree,options:[{label:"Quadratic",value:2},{label:"Cubic",value:3},{label:"Quartic",value:4},{label:"Quintic",value:5}],onChange:xe=>{G({..._,degree:xe.value})}})})]})},Qr={id:ee.F.regression,editor:fr,transformation:wa,name:wa.name,description:wa.description,categories:new Set([x.m.CalculateNewFields]),help:ue(ee.F.regression).helperDocs},$r={id:ee.F.rowsToFields,name:"Rows to fields",description:"Convert each row into a field with dynamic config.",defaultOptions:{},operator:W=>_=>_.pipe((0,Tt.T)(G=>G.map(de=>Zr(W,de))))};function Zr(W,_){const G=ln(_,W.mappings??[],!0),{nameField:de,valueField:xe}=G;if(!de||!xe)return _;const Me=[];for(let we=0;we<de.values.length;we++){const ke=de.values[we],Xe=xe.values[we],ht=Bt(_,we,G),mt=co(_,we,G),bt={name:`${ke}`,type:xe.type,values:[Xe],config:ht,labels:mt};Me.push(bt)}return{fields:Me,length:1}}function co(W,_,G){const de={...G.nameField.labels};for(let xe=0;xe<W.fields.length;xe++){const Me=W.fields[xe],we=(0,z.Ct)(Me,W),ke=G.index[we];if(ke.handler&&ke.handler.key!==an.Label)continue;const Xe=Me.values[_];Xe!=null&&(de[we]=Xe)}return de}function gr({input:W,options:_,onChange:G}){return W.length===0?null:(0,j.jsx)("div",{children:(0,j.jsx)(Sn,{frame:W[0],mappings:_.mappings??[],onChange:de=>G({..._,mappings:de}),withNameAndValue:!0})})}const as={id:$r.id,editor:gr,transformation:$r,name:$r.name,description:$r.description,state:rt.pn.beta,categories:new Set([x.m.Reformat]),help:ue($r.id).helperDocs};var ls=e(52622),Cs=e(61983),zs=e(9581),Nr=e(96606),Ge=e(31484),Ae=e(78134);const Ke={id:ee.F.spatial,name:"Spatial operations",description:"Apply spatial operations to query results.",defaultOptions:{},operator:W=>_=>_.pipe((0,Fr.Z)(G=>(0,Xr.H)(It(G,W))))};function lt(W){return W.action===zs.dy.Modify&&W.modify?.op===zs.YD.LineBuilder}async function It(W,_){const G=await(0,Ge.nE)(_.source);if(lt(_)){const de=await(0,Ge.nE)(_.modify?.target);return W.map(xe=>{const Me=(0,Ge.FM)(xe,G),we=(0,Ge.FM)(xe,de);if(Me.field&&we.field){const ke=[...xe.fields],Xe=(0,Nr.XR)(Me.field,we.field),ht=ke[0];return ht.type===te.PU.geo&&ht!==Me.field&&ht!==we.field?ke[0]=(0,Nr.RA)(ht,Xe):ke.unshift(Xe),{...xe,fields:ke}}return xe})}return W.map(de=>{let xe=(0,Ge.FM)(de,G);if(xe.field){if(_.action===zs.dy.Modify){switch(_.modify?.op){case zs.YD.AsLine:let we=xe.field.name;return(!we||we==="Point")&&(we="Line"),{...de,length:1,fields:[{...xe.field,name:we,type:te.PU.geo,values:[(0,Ae.tt)(xe.field)]}]}}return de}const Me=xe.derived?[xe.field,...de.fields]:de.fields.slice(0);if(_.action===zs.dy.Calculate&&(Me.push((0,Ae.pp)(xe.field,_.calculate??{})),xe.derived=!0),xe.derived)return{...de,fields:Me}}return de})}const Xt=(W,_)=>{const G=_.options??{};W.addSelect({path:"action",name:"Action",description:"",defaultValue:zs.dy.Prepare,settings:{options:[{value:zs.dy.Prepare,label:"Prepare spatial field",description:"Set a geometry field based on the results of other fields"},{value:zs.dy.Calculate,label:"Calculate value",description:"Use the geometry to define a new field (heading/distance/area)"},{value:zs.dy.Modify,label:"Transform",description:"Apply spatial operations to the geometry"}]}}),G.action===zs.dy.Calculate?W.addSelect({path:"calculate.calc",name:"Function",description:"",defaultValue:zs.kD.Heading,settings:{options:[{value:zs.kD.Heading,label:"Heading"},{value:zs.kD.Area,label:"Area"},{value:zs.kD.Distance,label:"Distance"}]}}):G.action===zs.dy.Modify&&W.addSelect({path:"modify.op",name:"Operation",description:"",defaultValue:zs.YD.AsLine,settings:{options:[{value:zs.YD.AsLine,label:"As line",description:"Create a single line feature with a vertex at each row"},{value:zs.YD.LineBuilder,label:"Line builder",description:"Create a line between two points"}]}}),lt(G)?(W.addNestedOptions({category:["Source"],path:"source",build:(de,xe)=>{const Me=G.source??{mode:ls.aG.Auto};(0,Cs.G)("Point","",de,Me)}}),W.addNestedOptions({category:["Target"],path:"modify",build:(de,xe)=>{const Me=G.modify?.target??{mode:ls.aG.Auto};(0,Cs.G)("Point","target.",de,Me)}})):(0,Cs.G)("Location","source.",W,G.source)},Yt=W=>{(0,l.useEffect)(()=>{if(!W.options.source?.mode){const de=Nt(Xt);W.onChange({...de,...W.options}),console.log("geometry useEffect",de)}},[]);const _=gn((0,pt.$j)()),G=zt(W,Xt);return(0,j.jsxs)("div",{children:[(0,j.jsx)("div",{children:G.items.map(de=>de.render())}),(0,j.jsx)("div",{children:G.categories.map(de=>(0,j.jsxs)("div",{className:_.wrap,children:[(0,j.jsx)("h5",{children:de.props.title}),(0,j.jsx)("div",{className:_.item,children:de.items.map(xe=>xe.render())})]},de.props.id))})]})},gn=W=>({wrap:(0,Qe.css)`
      margin-bottom: 20px;
    `,item:(0,Qe.css)`
      border-left: 4px solid ${W.colors.border.strong};
      padding-left: 10px;
    `}),yn={id:ee.F.spatial,editor:Yt,transformation:Ke,name:Ke.name,description:Ke.description,state:rt.pn.alpha,categories:new Set([x.m.PerformSpatialOperations]),help:ue(ee.F.spatial).helperDocs};var Mn=e(19845);const is={id:ee.F.timeSeriesTable,name:"Time series to table",description:"Convert time series data to table rows so that they can be viewed in tabular or sparkline format.",defaultOptions:{},isApplicable:W=>{for(const _ of W)if((0,Mn.aH)(_))return ur.M.Applicable;return ur.M.NotApplicable},isApplicableDescription:"The Time series to table transformation requires at least one time series frame to function. You currently have none.",operator:W=>_=>_.pipe((0,Tt.T)(G=>rs(W,G)))};function rs(W,_){const G={},de={},xe=[];let Me=Es(_);for(const we of Object.keys(Me)){const ke=_.filter(ht=>ht.refId===we);G[we]={},de[we]={};const Xe=[];ke.forEach(ht=>{ht.fields.forEach(mt=>{mt.type===te.PU.number&&mt.labels&&Object.keys(mt.labels).forEach(bt=>{Xe.includes(bt)||(de[we][bt]=ws(bt,te.PU.string),Xe.push(bt))})})});for(let ht=0;ht<ke.length;ht++){const mt=ke[ht];let bt=null,Kt=W[we]?.timeField;if(Kt&&Kt.length>0?bt=mt.fields.find(Rt=>Rt.name===Kt):bt=mt.fields.find(Rt=>(0,Mn.hF)(Rt)),!(0,Mn.aH)(mt)){xe.push(mt);continue}for(const Rt of mt.fields){if(Rt.type!==te.PU.number)continue;const Ct=W[we]?.stat??At.gy.lastNotNull,Ut=(0,At.Nw)({field:Rt,reducers:[Ct]})[Ct]??null,hn=new Dn.k;bt!==void 0&&(hn.addField(bt),hn.addField(Rt),G[we][`Trend #${we}`]===void 0&&(G[we][`Trend #${we}`]=ws(`Trend #${we}`,te.PU.frame)),G[we][`Trend #${we}`].values.push({...hn,value:Ut,length:Rt.values.length})),Xe.forEach(Zn=>{de[we][Zn].values.push(Rt.labels?.[Zn]??"")})}}}for(const we of Object.keys(Me)){const ke={},Xe=new Dn.k;Xe.refId=we;const ht=de[we];if(ht!==void 0)for(const[bt,Kt]of Object.entries(ht))ke[bt]===void 0&&(ke[bt]=Kt);for(const bt of Object.values(ke))Xe.addField(bt);const mt=G[we];for(const bt of Object.values(mt))Xe.addField(bt);Xe.fields.length>0&&xe.push(Xe)}return xe}function ws(W,_){return{name:W,type:_,config:{},values:[]}}function Es(W){let _={};for(const G of W)G.refId!==void 0&&(_[G.refId]===void 0?_[G.refId]=1:_[G.refId]++);return _}function Sa({input:W,options:_,onChange:G}){const de=Es(W),xe=(0,l.useCallback)((ke,Xe)=>{const ht=Xe?.value!==void 0?Xe.value:"";G({..._,[ke]:{..._[ke],timeField:ht}})},[G,_]),Me=(0,l.useCallback)((ke,Xe)=>{const ht=Xe[0];ht&&(0,At.Em)(ht)&&G({..._,[ke]:{..._[ke],stat:ht}})},[G,_]);let we=[];for(const ke of Object.keys(de)){const Xe={},ht=[];for(const mt of W)if(mt.refId===ke)for(const bt of mt.fields)(0,Mn.hF)(bt)&&(Xe[bt.name]=bt);for(const mt of Object.values(Xe)){const{name:bt}=mt;ht.push({label:bt,value:bt})}we.push((0,j.jsxs)(ge.C,{children:[(0,j.jsx)(Z.I,{children:(0,j.jsx)(yt.c,{children:`Trend #${ke}`})}),(0,j.jsx)(Z.I,{label:"Time field",tooltip:"The time field that will be used for the time series. If not selected the first found will be used.",children:(0,j.jsx)(Te.l6,{onChange:xe.bind(null,ke),options:ht,value:_[ke]?.timeField,isClearable:!0})}),(0,j.jsx)(Z.I,{label:"Stat",tooltip:"The statistic that should be calculated for this time series.",children:(0,j.jsx)(mn.S,{stats:[_[ke]?.stat??At.gy.lastNotNull],onChange:Me.bind(null,ke),filterOptions:mt=>mt.id!==At.gy.allValues&&mt.id!==At.gy.uniqueValues})})]},ke))}return(0,j.jsx)(j.Fragment,{children:we})}const Na={id:is.id,editor:Sa,transformation:is,name:is.name,description:is.description,state:rt.pn.beta,help:ue(is.id).helperDocs},sa=()=>[dl,lo,ul,po,We,Po,Uo,hl,Jn,Ea,wo,Ss,fl,Vi,Ca,as,Zt,xa,Yr,yn,qi,gl,ot,Io,cl,Vo,Jt,...ae.$.featureToggles.formatString?[Qo]:[],...ae.$.featureToggles.regressionTransformation?[Qr]:[],...ae.$.featureToggles.groupToNestedTableTransformation?[dr]:[],Lt,Na];var ea=e(67278);function Da(){return new ea.c(new URL(e.p+e.u(7887),e.b))}function or(){return[{id:"kusto",name:"kusto",init:Da}]}var Vs=e(1503),ka=e(71468),qa=e(24180),Bi=e(24160),Vr=e(14110),Or=e(66602),Ui=e(63211),uc=e(71678),Ni=e(17464),_r=e(39070),To=e(19361),aa=e(8484),Wu=e(53153),Fu=e(87570),qr=e(4691),hc=e(20851),Ku=e(58649);const fc=()=>{const W=!!J.Ay.oauth;return{saml:{bgColor:"#464646",enabled:J.Ay.samlEnabled,name:J.Ay.samlName||Ku.En,icon:"key-skeleton-alt"},google:{bgColor:"#e84d3c",enabled:W&&!!J.Ay.oauth.google,name:J.Ay.oauth?.google?.name||"Google",icon:J.Ay.oauth?.google?.icon||"google"},azuread:{bgColor:"#2f2f2f",enabled:W&&!!J.Ay.oauth.azuread,name:J.Ay.oauth?.azuread?.name||"Microsoft",icon:J.Ay.oauth?.azuread?.icon||"microsoft"},github:{bgColor:"#464646",enabled:W&&!!J.Ay.oauth.github,name:J.Ay.oauth?.github?.name||"GitHub",icon:J.Ay.oauth?.github?.icon||"github"},gitlab:{bgColor:"#fc6d26",enabled:W&&!!J.Ay.oauth.gitlab,name:J.Ay.oauth?.gitlab?.name||"GitLab",icon:J.Ay.oauth?.gitlab?.icon||"gitlab"},grafanacom:{bgColor:"#262628",enabled:W&&!!J.Ay.oauth.grafana_com,name:J.Ay.oauth?.grafana_com?.name||"Grafana.com",icon:J.Ay.oauth?.grafana_com?.icon||"grafana",hrefName:"grafana_com"},okta:{bgColor:"#2f2f2f",enabled:W&&!!J.Ay.oauth.okta,name:J.Ay.oauth?.okta?.name||"Okta",icon:J.Ay.oauth?.okta?.icon||"okta"},oauth:{bgColor:"#262628",enabled:W&&!!J.Ay.oauth.generic_oauth,name:J.Ay.oauth?.generic_oauth?.name||"OAuth",icon:J.Ay.oauth?.generic_oauth?.icon||"signin",hrefName:"generic_oauth"}}},dd=W=>({button:(0,Qe.css)({color:"#d8d9da",position:"relative"}),buttonIcon:(0,Qe.css)({position:"absolute",left:W.spacing(1),top:"50%",transform:"translateY(-50%)"}),divider:{base:(0,Qe.css)({color:W.colors.text.primary,display:"flex",marginBottom:W.spacing(1),justifyContent:"space-between",textAlign:"center",width:"100%"}),line:(0,Qe.css)({width:100,height:10,borderBottom:`1px solid ${W.colors.text}`})}}),Nl=()=>{const W=(0,pt.of)(dd);return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)("div",{className:W.divider.base,children:[(0,j.jsx)("div",{children:(0,j.jsx)("div",{className:W.divider.line})}),(0,j.jsx)("div",{children:(0,j.jsx)("span",{children:!J.Ay.disableLoginForm&&(0,j.jsx)("span",{children:"or"})})}),(0,j.jsx)("div",{children:(0,j.jsx)("div",{className:W.divider.line})})]}),(0,j.jsx)("div",{className:"clearfix"})]})};function $u(W,_,G){return(0,Qe.cx)(_.button,(0,Qe.css)({backgroundColor:W.bgColor,color:G.colors.getContrastText(W.bgColor),"&:hover":{backgroundColor:G.colors.emphasize(W.bgColor,.15),boxShadow:G.shadows.z1}}))}const Vu=()=>{const W=(0,m.pickBy)(fc(),xe=>xe.enabled),_=Object.keys(W).length>0,G=(0,pt.$j)(),de=(0,pt.of)(dd);return _?(0,j.jsxs)(on.B,{direction:"column",width:"100%",children:[(0,j.jsx)(Nl,{}),Object.entries(W).map(([xe,Me])=>{const we=Me.name;return(0,j.jsxs)(ye.z9,{className:$u(Me,de,G),href:`login/${Me.hrefName?Me.hrefName:xe}`,target:"_self",fullWidth:!0,children:[(0,j.jsx)(Is.I,{className:de.buttonIcon,name:Me.icon}),(0,j.jsxs)(aa.x6,{i18nKey:"login.services.sing-in-with-prefix",children:["Sign in with ",{serviceName:we}]})]},xe)})]}):null},_u=()=>{const W=(0,J.zj)().verifyEmailEnabled?`${(0,J.zj)().appSubUrl}/verify`:`${(0,J.zj)().appSubUrl}/signup`,_=(0,Qe.css)({paddingTop:"16px"});return(0,j.jsxs)(on.B,{direction:"column",children:[(0,j.jsx)("div",{className:_,children:(0,j.jsx)(aa.x6,{i18nKey:"login.signup.new-to-question",children:"New to Grafana?"})}),(0,j.jsx)(ye.z9,{className:(0,Qe.css)({width:"100%",justifyContent:"center"}),href:W,variant:"secondary",fill:"outline",children:(0,j.jsx)(aa.x6,{i18nKey:"login.signup.button-label",children:"Sign up"})})]})},zu=()=>{const W=(0,pt.of)(Hu);return document.title=To.M.AppTitle,(0,j.jsx)(Fu.A,{children:({loginHint:_,passwordHint:G,disableLoginForm:de,disableUserSignUp:xe,login:Me,isLoggingIn:we,changePassword:ke,skipPasswordChange:Xe,isChangingPassword:ht,showDefaultPasswordWarning:mt,loginErrorMessage:bt})=>(0,j.jsxs)(hc.GU,{isChangingPassword:ht,children:[!ht&&(0,j.jsxs)(hc.qm,{children:[bt&&(0,j.jsx)(vn.F,{className:W.alert,severity:"error",title:(0,aa.t)("login.error.title","Login failed"),children:bt}),!de&&(0,j.jsx)(qr.Q,{onSubmit:Me,loginHint:_,passwordHint:G,isLoggingIn:we,children:(0,j.jsx)(on.B,{justifyContent:"flex-end",children:!ae.$.auth.disableLogin&&(0,j.jsx)(ye.z9,{className:W.forgottenPassword,fill:"text",href:`${ae.$.appSubUrl}/user/password/send-reset-email`,children:(0,j.jsx)(aa.x6,{i18nKey:"login.forgot-password",children:"Forgot your password?"})})})}),(0,j.jsx)(Vu,{}),!xe&&(0,j.jsx)(_u,{})]}),ht&&(0,j.jsx)(hc.qm,{children:(0,j.jsx)(Wu.S,{showDefaultPasswordWarning:mt,onSubmit:ke,onSkip:()=>Xe()})})]})})},Hu=W=>({forgottenPassword:(0,Qe.css)({padding:0,marginTop:W.spacing(.5)}),alert:(0,Qe.css)({width:"100%"})});var zr=e(69444),ud=e(25249),gc=e(10860);function hd({description:W,text:_,url:G}){const de=(0,pt.of)(wl);return(0,j.jsxs)(gc.Z,{className:de.card,href:G,children:[(0,j.jsx)(gc.Z.Heading,{children:_}),(0,j.jsx)(gc.Z.Description,{className:de.description,children:W})]})}const wl=W=>({card:(0,Qe.css)({marginBottom:0,gridTemplateRows:"1fr 0 2fr"}),description:(0,Qe.css)({WebkitLineClamp:3,WebkitBoxOrient:"vertical",display:"-webkit-box",overflow:"hidden"})});function _o({navId:W,header:_}){const{node:G}=(0,ud.C)(W),de=(0,pt.of)(ku),xe=G.children?.filter(Me=>!Me.hideFromTabs);return(0,j.jsx)(zr.Y,{navId:G.id,children:(0,j.jsx)(zr.Y.Contents,{children:(0,j.jsxs)("div",{className:de.content,children:[_,xe&&xe.length>0&&(0,j.jsx)("section",{className:de.grid,children:xe?.map(Me=>(0,j.jsx)(hd,{description:Me.subTitle,text:Me.text,url:Me.url??""},Me.id))})]})})})}const ku=W=>({content:(0,Qe.css)({display:"flex",flexDirection:"column",gap:W.spacing(2)}),grid:(0,Qe.css)({display:"grid",gap:W.spacing(3),gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gridAutoRows:"138px",padding:W.spacing(2,0)})});var Wl=e(64388),fd=e(7392);function Gu(){return(0,j.jsx)(zr.Y,{navId:"home",layout:Wl.k.Canvas,pageNav:{text:"Page not found"},children:(0,j.jsx)(fd.L,{entity:"Page"})})}var ir=e(16233),pc=e(33378),Wa=e(10096),wn=e(31678),mc=e(72724),vc=e(46334);const Qu="dddd YYYY-MM-DD HH:mm zz",Yu="/admin/authentication/ldap";class Ju extends l.PureComponent{constructor(){super(...arguments),this.onUserSync=()=>{this.props.onUserSync()}}render(){const{ldapSyncInfo:_,user:G}=this.props,xe=_&&_.nextSync?(0,mc.LE)(_.nextSync,{format:Qu}):"",Me=`${Yu}?user=${G&&G.login}`,we=Wa.TP.hasPermission(wn.AccessControlAction.LDAPUsersRead),ke=Wa.TP.hasPermission(wn.AccessControlAction.LDAPUsersSync);return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("h3",{className:"page-heading",children:"LDAP Synchronisation"}),(0,j.jsxs)("div",{className:"gf-form-group",children:[(0,j.jsx)("div",{className:"gf-form",children:(0,j.jsx)("table",{className:"filter-table form-inline",children:(0,j.jsxs)("tbody",{children:[(0,j.jsxs)("tr",{children:[(0,j.jsx)("td",{children:"External sync"}),(0,j.jsx)("td",{children:"User synced via LDAP. Some changes must be done in LDAP or mappings."}),(0,j.jsx)("td",{children:(0,j.jsx)(vc.E,{label:"LDAP",removeIcon:!1,count:0,onClick:void 0})})]}),(0,j.jsx)("tr",{children:_.enabled?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("td",{children:"Next scheduled synchronization"}),(0,j.jsx)("td",{colSpan:2,children:xe})]}):(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("td",{children:"Next scheduled synchronization"}),(0,j.jsx)("td",{colSpan:2,children:"Not enabled"})]})})]})})}),(0,j.jsxs)("div",{className:"gf-form-button-row",children:[ke&&(0,j.jsx)(ye.$n,{variant:"secondary",onClick:this.onUserSync,children:"Sync user"}),we&&(0,j.jsx)(ye.z9,{variant:"secondary",href:Me,children:"Debug LDAP Mapping"})]})]})]})}}var Fl=e(3911),Br=e(82702),yc=e(37390),gi=e(56034),ml=e(89062),Kl=e(85927),gd=e(41053);function pd({onSelected:W,className:_,inputId:G,autoFocus:de,excludeOrgs:xe}){(0,l.useEffect)(()=>{de&&G&&document.getElementById(G)?.focus()},[de,G]);const[Me,we]=(0,gd.A)(async()=>{const Xe=(await(0,M.AI)().get("/api/orgs")).map(ht=>({value:{id:ht.id,name:ht.name},label:ht.name}));if(xe){let ht=xe.map(bt=>bt.orgId);return Xe.filter(bt=>!ht.includes(bt.value.id))}else return Xe});return(0,j.jsx)(Te.DW,{inputId:G,className:_,isLoading:Me.loading,defaultOptions:!0,loadOptions:we,filterOption:(ke,Xe)=>{const ht=Xe.toLowerCase();return!!ke.value?.name.toLowerCase().includes(ht)},onChange:W,placeholder:"Select organization",noOptionsMessage:"No organizations found"})}var md=e(5133);class Xu extends l.PureComponent{constructor(){super(...arguments),this.addToOrgButtonRef=(0,l.createRef)(),this.state={showAddOrgModal:!1},this.showOrgAddModal=()=>{this.setState({showAddOrgModal:!0})},this.dismissOrgAddModal=()=>{this.setState({showAddOrgModal:!1},()=>{this.addToOrgButtonRef.current?.focus()})}}render(){const{user:_,orgs:G,isExternalUser:de,onOrgRoleChange:xe,onOrgRemove:Me,onOrgAdd:we}=this.props,{showAddOrgModal:ke}=this.state,Xe=Wa.TP.hasPermission(wn.AccessControlAction.OrgUsersAdd)&&!de;return(0,j.jsxs)("div",{children:[(0,j.jsx)("h3",{className:"page-heading",children:"Organizations"}),(0,j.jsxs)(on.B,{gap:1.5,direction:"column",children:[(0,j.jsx)("table",{className:"filter-table form-inline",children:(0,j.jsx)("tbody",{children:G.map((ht,mt)=>(0,j.jsx)(qu,{isExternalUser:de,user:_,org:ht,onOrgRoleChange:xe,onOrgRemove:Me},`${ht.orgId}-${mt}`))})}),(0,j.jsx)("div",{children:Xe&&(0,j.jsx)(ye.$n,{variant:"secondary",onClick:this.showOrgAddModal,ref:this.addToOrgButtonRef,children:"Add user to organization"})}),(0,j.jsx)(yd,{user:_,userOrgs:G,isOpen:ke,onOrgAdd:we,onDismiss:this.dismissOrgAddModal})]})]})}}const Zu=(0,Fl.N)(W=>({removeButton:(0,Qe.css)({marginRight:"0.6rem",textDecoration:"underline",color:W.v1.palette.blue95}),label:(0,Qe.css)({fontWeight:500}),disabledTooltip:(0,Qe.css)({display:"flex"}),tooltipItem:(0,Qe.css)({marginLeft:"5px"}),tooltipItemLink:(0,Qe.css)({color:W.v1.palette.blue95}),rolePickerWrapper:(0,Qe.css)({display:"flex"}),rolePicker:(0,Qe.css)({flex:"auto",marginRight:W.spacing(1)})}));class vd extends l.PureComponent{constructor(){super(...arguments),this.state={currentRole:this.props.org.role,isChangingRole:!1,roleOptions:[]},this.onOrgRemove=async()=>{const{org:_}=this.props;this.props.onOrgRemove(_.orgId)},this.onChangeRoleClick=()=>{const{org:_}=this.props;this.setState({isChangingRole:!0,currentRole:_.role})},this.onOrgRoleChange=_=>{this.setState({currentRole:_})},this.onOrgRoleSave=()=>{this.props.onOrgRoleChange(this.props.org.orgId,this.state.currentRole)},this.onCancelClick=()=>{this.setState({isChangingRole:!1})},this.onBasicRoleChange=_=>{this.props.onOrgRoleChange(this.props.org.orgId,_)}}componentDidMount(){Wa.TP.licensedAccessControlEnabled()&&Wa.TP.hasPermission(wn.AccessControlAction.ActionRolesList)&&(0,Kl.RL)(this.props.org.orgId).then(_=>this.setState({roleOptions:_})).catch(_=>console.error(_))}render(){const{user:_,org:G,isExternalUser:de,theme:xe}=this.props,Me=_?.authLabels?.length&&_?.authLabels[0],we=Me?`Synced via ${Me}`:"",{currentRole:ke,isChangingRole:Xe}=this.state,ht=Zu(xe),mt=(0,Qe.cx)("width-16",ht.label),bt=Wa.TP.hasPermission(wn.AccessControlAction.OrgUsersWrite),Kt=Wa.TP.hasPermission(wn.AccessControlAction.OrgUsersRemove)&&!de,Rt=de||!bt,Ct=`${G.name}-input`;return(0,j.jsxs)("tr",{children:[(0,j.jsx)("td",{className:mt,children:(0,j.jsx)("label",{htmlFor:Ct,children:G.name})}),Wa.TP.licensedAccessControlEnabled()?(0,j.jsx)("td",{children:(0,j.jsxs)("div",{className:ht.rolePickerWrapper,children:[(0,j.jsx)("div",{className:ht.rolePicker,children:(0,j.jsx)(ml.y,{userId:_?.id||0,orgId:G.orgId,basicRole:G.role,roleOptions:this.state.roleOptions,onBasicRoleChange:this.onBasicRoleChange,basicRoleDisabled:Rt,basicRoleDisabledMessage:`This user's role is not editable because it is synchronized from your auth provider.
                    Refer to the Grafana authentication docs for details.`})}),de&&(0,j.jsx)(xc,{lockMessage:we})]})}):(0,j.jsxs)(j.Fragment,{children:[Xe?(0,j.jsx)("td",{children:(0,j.jsx)(md.r,{inputId:Ct,value:ke,onChange:this.onOrgRoleChange,autoFocus:!0})}):(0,j.jsx)("td",{className:"width-25",children:G.role}),(0,j.jsx)("td",{colSpan:1,children:bt&&(0,j.jsx)(Ed,{lockMessage:we,isExternalUser:de,onChangeRoleClick:this.onChangeRoleClick,onCancelClick:this.onCancelClick,onOrgRoleSave:this.onOrgRoleSave})})]}),(0,j.jsx)("td",{colSpan:1,children:Kt&&(0,j.jsx)(Br.Z,{confirmText:"Confirm removal",confirmVariant:"destructive",onCancel:this.onCancelClick,onConfirm:this.onOrgRemove,children:"Remove from organization"})})]})}}const qu=(0,pt.cV)(vd),eh=(0,Fl.N)(()=>({modal:(0,Qe.css)({width:"500px"}),buttonRow:(0,Qe.css)({textAlign:"center"}),modalContent:(0,Qe.css)({overflow:"visible"})}));class yd extends l.PureComponent{constructor(){super(...arguments),this.state={selectedOrg:null,role:wn.OrgRole.Viewer,roleOptions:[],pendingOrgId:null,pendingUserId:null,pendingRoles:[]},this.onOrgSelect=_=>{const G=this.props.userOrgs.find(de=>de.orgId===_.value?.id);this.setState({selectedOrg:_.value,role:G?.role||wn.OrgRole.Viewer}),Wa.TP.licensedAccessControlEnabled()&&Wa.TP.hasPermission(wn.AccessControlAction.ActionRolesList)&&(0,Kl.RL)(_.value?.id).then(de=>this.setState({roleOptions:de})).catch(de=>console.error(de))},this.onOrgRoleChange=_=>{this.setState({role:_})},this.onAddUserToOrg=async()=>{const{selectedOrg:_,role:G}=this.state;this.props.onOrgAdd(_.id,G),Wa.TP.licensedAccessControlEnabled()&&Wa.TP.hasPermission(wn.AccessControlAction.ActionUserRolesAdd)&&this.state.pendingUserId&&(await(0,Kl.eA)(this.state.pendingRoles,this.state.pendingUserId,this.state.pendingOrgId),this.setState({pendingOrgId:null,pendingRoles:[],pendingUserId:null}))},this.onCancel=()=>{this.setState({selectedOrg:null,pendingRoles:[],pendingOrgId:null,pendingUserId:null}),this.props.onDismiss&&this.props.onDismiss()},this.onRoleUpdate=async(_,G,de)=>{this.setState({pendingRoles:_,pendingOrgId:de,pendingUserId:G})}}render(){const{isOpen:_,user:G,userOrgs:de}=this.props,{role:xe,roleOptions:Me,selectedOrg:we}=this.state,ke=eh();return(0,j.jsxs)(yc.a,{className:ke.modal,contentClassName:ke.modalContent,title:"Add to an organization",isOpen:_,onDismiss:this.onCancel,children:[(0,j.jsx)(Oa.D,{label:"Organization",children:(0,j.jsx)(pd,{inputId:"new-org-input",onSelected:this.onOrgSelect,excludeOrgs:de,autoFocus:!0})}),(0,j.jsx)(Oa.D,{label:"Role",disabled:we===null,children:(0,j.jsx)(ml.y,{userId:G?.id||0,orgId:we?.id,basicRole:xe,onBasicRoleChange:this.onOrgRoleChange,basicRoleDisabled:!1,roleOptions:Me,apply:!0,onApplyRoles:this.onRoleUpdate,pendingRoles:this.state.pendingRoles})}),(0,j.jsx)(yc.a.ButtonRow,{children:(0,j.jsxs)(on.B,{gap:2,justifyContent:"center",children:[(0,j.jsx)(ye.$n,{variant:"secondary",fill:"outline",onClick:this.onCancel,children:"Cancel"}),(0,j.jsx)(ye.$n,{variant:"primary",disabled:we===null,onClick:this.onAddUserToOrg,children:"Add to organization"})]})})]})}}const xd=W=>({disabledTooltip:(0,Qe.css)({display:"flex"}),tooltipItemLink:(0,Qe.css)({color:W.v1.palette.blue95}),lockMessageClass:(0,Qe.css)({fontStyle:"italic",marginLeft:"1.8rem",marginRight:"0.6rem"}),icon:(0,Qe.css)({lineHeight:2})});function Ed({lockMessage:W,onChangeRoleClick:_,isExternalUser:G,onOrgRoleSave:de,onCancelClick:xe}){const Me=(0,pt.of)(xd);return(0,j.jsx)("div",{className:Me.disabledTooltip,children:G?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("span",{className:Me.lockMessageClass,children:W}),(0,j.jsx)(gi.m,{placement:"right-end",interactive:!0,content:(0,j.jsxs)("div",{children:["This user's role is not editable because it is synchronized from your auth provider. Refer to the\xA0",(0,j.jsx)("a",{className:Me.tooltipItemLink,href:"https://grafana.com/docs/grafana/latest/auth",rel:"noreferrer",target:"_blank",children:"Grafana authentication docs"}),"\xA0for details."]}),children:(0,j.jsx)("div",{className:Me.icon,children:(0,j.jsx)(Is.I,{name:"question-circle"})})})]}):(0,j.jsx)(Br.Z,{confirmText:"Save",onClick:_,onCancel:xe,onConfirm:de,disabled:G,children:"Change role"})})}const xc=({lockMessage:W})=>{const _=(0,pt.of)(Dd);return(0,j.jsxs)("div",{className:_.disabledTooltip,children:[(0,j.jsx)("span",{className:_.lockMessageClass,children:W}),(0,j.jsx)(gi.m,{placement:"right-end",interactive:!0,content:(0,j.jsxs)("div",{children:["This user's built-in role is not editable because it is synchronized from your auth provider. Refer to the\xA0",(0,j.jsx)("a",{className:_.tooltipItemLink,href:"https://grafana.com/docs/grafana/latest/auth",rel:"noreferrer noopener",target:"_blank",children:"Grafana authentication docs"}),"\xA0for details."]}),children:(0,j.jsx)(Is.I,{name:"question-circle"})})]})},Dd=W=>({disabledTooltip:(0,Qe.css)({display:"flex"}),tooltipItemLink:(0,Qe.css)({color:W.v1.palette.blue95}),lockMessageClass:(0,Qe.css)({fontStyle:"italic",marginLeft:"1.8rem",marginRight:"0.6rem"})}),th=[{label:"Yes",value:!0},{label:"No",value:!1}];function nh({isGrafanaAdmin:W,isExternalUser:_,lockMessage:G,onGrafanaAdminChange:de}){const[xe,Me]=(0,l.useState)(!1),[we,ke]=(0,l.useState)(W),Xe=()=>Me(!0),ht=()=>{Me(!1),ke(W)},mt=()=>de(we),bt=Wa.TP.hasPermission(wn.AccessControlAction.UsersPermissionsUpdate)&&!_,Kt=(0,pt.of)(sh);return(0,j.jsxs)("div",{children:[(0,j.jsx)("h3",{className:"page-heading",children:"Permissions"}),(0,j.jsx)("table",{className:"filter-table form-inline",children:(0,j.jsx)("tbody",{children:(0,j.jsxs)("tr",{children:[(0,j.jsx)("td",{className:"width-16",children:"Grafana Admin"}),xe?(0,j.jsx)("td",{colSpan:2,children:(0,j.jsx)(oe.z,{options:th,value:we,onChange:ke,autoFocus:!0})}):(0,j.jsx)("td",{colSpan:2,children:W?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(Is.I,{name:"shield"})," Yes"]}):(0,j.jsx)(j.Fragment,{children:"No"})}),(0,j.jsxs)("td",{children:[bt&&(0,j.jsx)(Br.Z,{onClick:Xe,onConfirm:mt,onCancel:ht,confirmText:"Change",children:"Change"}),_&&(0,j.jsx)("div",{className:Kt.lockMessageClass,children:(0,j.jsx)(xc,{lockMessage:G})})]})]})})})]})}const sh=W=>({lockMessageClass:(0,Qe.css)`
    display: flex;
    justify-content: flex-end;
    font-style: italic;
    margin-right: ${W.spacing(.6)};
  `});var vl=e(96374),Pd=e(91634);function ah({user:W,onUserUpdate:_,onUserDelete:G,onUserDisable:de,onUserEnable:xe,onPasswordChange:Me}){const[we,ke]=(0,l.useState)(!1),[Xe,ht]=(0,l.useState)(!1),mt=(0,l.useRef)(null),bt=ai=>()=>{ke(ai),!ai&&mt.current&&mt.current.focus()},Kt=(0,l.useRef)(null),Rt=ai=>()=>{ht(ai),!ai&&Kt.current&&Kt.current.focus()},Ct=()=>G(W.id),Ut=()=>de(W.id),hn=()=>xe(W.id),Zn=ai=>{_({...W,name:ai})},As=ai=>{_({...W,email:ai})},Ds=ai=>{_({...W,login:ai})},Fs=W.authLabels?.length&&W.authLabels[0],Ar=Fs?`Synced via ${Fs}`:"",si=W.isExternal||!Wa.TP.hasPermissionInMetadata(wn.AccessControlAction.UsersWrite,W),xp=W.isExternal||!Wa.TP.hasPermissionInMetadata(wn.AccessControlAction.UsersPasswordUpdate,W),qD=Wa.TP.hasPermissionInMetadata(wn.AccessControlAction.UsersDelete,W),eP=Wa.TP.hasPermissionInMetadata(wn.AccessControlAction.UsersDisable,W),tP=Wa.TP.hasPermissionInMetadata(wn.AccessControlAction.UsersEnable,W);return(0,j.jsxs)("div",{children:[(0,j.jsx)("h3",{className:"page-heading",children:"User information"}),(0,j.jsxs)(on.B,{direction:"column",gap:1.5,children:[(0,j.jsx)("div",{children:(0,j.jsx)("table",{className:"filter-table form-inline",children:(0,j.jsxs)("tbody",{children:[(0,j.jsx)(Zo,{label:"Name",value:W.name,locked:si,lockMessage:Ar,onChange:Zn}),(0,j.jsx)(Zo,{label:"Email",value:W.email,locked:si,lockMessage:Ar,onChange:As}),(0,j.jsx)(Zo,{label:"Username",value:W.login,locked:si,lockMessage:Ar,onChange:Ds}),(0,j.jsx)(Zo,{label:"Password",value:"********",inputType:"password",locked:xp,lockMessage:Ar,onChange:Me})]})})}),(0,j.jsxs)(on.B,{gap:2,children:[qD&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(ye.$n,{variant:"destructive",onClick:bt(!0),ref:mt,children:"Delete user"}),(0,j.jsx)(vl.u,{isOpen:we,title:"Delete user",body:"Are you sure you want to delete this user?",confirmText:"Delete user",onConfirm:Ct,onDismiss:bt(!1)})]}),W.isDisabled&&tP&&(0,j.jsx)(ye.$n,{variant:"secondary",onClick:hn,children:"Enable user"}),!W.isDisabled&&eP&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(ye.$n,{variant:"secondary",onClick:Rt(!0),ref:Kt,children:"Disable user"}),(0,j.jsx)(vl.u,{isOpen:Xe,title:"Disable user",body:"Are you sure you want to disable this user?",confirmText:"Disable user",onConfirm:Ut,onDismiss:Rt(!1)})]})]})]})]})}class Zo extends l.PureComponent{constructor(){super(...arguments),this.state={editing:!1,value:this.props.value||""},this.setInputElem=_=>{this.inputElem=_},this.onEditClick=()=>{this.props.inputType==="password"?this.setState({editing:!0,value:""},this.focusInput):this.setState({editing:!0},this.focusInput)},this.onCancelClick=()=>{this.setState({editing:!1,value:this.props.value||""})},this.onInputChange=(_,G)=>{G!==Pd.O.Invalid&&this.setState({value:_.target.value})},this.onInputBlur=(_,G)=>{G!==Pd.O.Invalid&&this.setState({value:_.target.value})},this.focusInput=()=>{this.inputElem&&this.inputElem.focus&&this.inputElem.focus()},this.onSave=()=>{this.props.onChange&&this.props.onChange(this.state.value)}}static{this.defaultProps={value:"",locked:!1,lockMessage:"",inputType:"text"}}render(){const{label:_,locked:G,lockMessage:de,inputType:xe}=this.props,{value:Me}=this.state,we=(0,Qe.cx)("width-16",(0,Qe.css)`
        font-weight: 500;
      `);if(G)return(0,j.jsx)(rh,{label:_,value:Me,lockMessage:de});const ke=`${_}-input`;return(0,j.jsxs)("tr",{children:[(0,j.jsx)("td",{className:we,children:(0,j.jsx)("label",{htmlFor:ke,children:_})}),(0,j.jsx)("td",{className:"width-25",colSpan:2,children:this.state.editing?(0,j.jsx)(Ze.p,{id:ke,type:xe,defaultValue:Me,onBlur:this.onInputBlur,onChange:this.onInputChange,ref:this.setInputElem,width:30}):(0,j.jsx)("span",{children:this.props.value})}),(0,j.jsx)("td",{children:(0,j.jsx)(Br.Z,{confirmText:"Save",onClick:this.onEditClick,onConfirm:this.onSave,onCancel:this.onCancelClick,children:"Edit"})})]})}}const rh=({label:W,value:_,lockMessage:G})=>{const de=(0,Qe.css)`
    font-style: italic;
    margin-right: 0.6rem;
  `,xe=(0,Qe.cx)("width-16",(0,Qe.css)`
      font-weight: 500;
    `);return(0,j.jsxs)("tr",{children:[(0,j.jsx)("td",{className:xe,children:W}),(0,j.jsx)("td",{className:"width-25",colSpan:2,children:_}),(0,j.jsx)("td",{children:(0,j.jsx)("span",{className:de,children:G})})]})};var eo=e(84753);class yl extends l.PureComponent{constructor(){super(...arguments),this.forceAllLogoutButton=(0,l.createRef)(),this.state={showLogoutModal:!1},this.showLogoutConfirmationModal=()=>{this.setState({showLogoutModal:!0})},this.dismissLogoutConfirmationModal=()=>{this.setState({showLogoutModal:!1},()=>{this.forceAllLogoutButton.current?.focus()})},this.onSessionRevoke=_=>()=>{this.props.onSessionRevoke(_)},this.onAllSessionsRevoke=()=>{this.setState({showLogoutModal:!1}),this.props.onAllSessionsRevoke()}}render(){const{sessions:_}=this.props,{showLogoutModal:G}=this.state,de=Wa.TP.hasPermission(wn.AccessControlAction.UsersLogout);return(0,j.jsxs)("div",{children:[(0,j.jsx)("h3",{className:"page-heading",children:"Sessions"}),(0,j.jsxs)(on.B,{direction:"column",gap:1.5,children:[(0,j.jsx)("div",{children:(0,j.jsxs)("table",{className:"filter-table form-inline",children:[(0,j.jsx)("thead",{children:(0,j.jsxs)("tr",{children:[(0,j.jsx)("th",{children:"Last seen"}),(0,j.jsx)("th",{children:"Logged on"}),(0,j.jsx)("th",{children:"IP address"}),(0,j.jsx)("th",{colSpan:2,children:"Browser and OS"})]})}),(0,j.jsx)("tbody",{children:_&&_.map((xe,Me)=>(0,j.jsxs)("tr",{children:[(0,j.jsx)("td",{children:xe.isActive?"Now":xe.seenAt}),(0,j.jsx)("td",{children:(0,eo.Y)(xe.createdAt,{dateStyle:"long"})}),(0,j.jsx)("td",{children:xe.clientIp}),(0,j.jsx)("td",{children:`${xe.browser} on ${xe.os} ${xe.osVersion}`}),(0,j.jsx)("td",{children:de&&(0,j.jsx)(Br.Z,{confirmText:"Confirm logout",confirmVariant:"destructive",onConfirm:this.onSessionRevoke(xe.id),children:"Force logout"})})]},`${xe.id}-${Me}`))})]})}),(0,j.jsxs)("div",{children:[de&&_.length>0&&(0,j.jsx)(ye.$n,{variant:"secondary",onClick:this.showLogoutConfirmationModal,ref:this.forceAllLogoutButton,children:"Force logout from all devices"}),(0,j.jsx)(vl.u,{isOpen:G,title:"Force logout from all devices",body:"Are you sure you want to force logout from all devices?",confirmText:"Force logout",onConfirm:this.onAllSessionsRevoke,onDismiss:this.dismissLogoutConfirmationModal})]})]})]})}}const oh=yl;var wr=e(57334);class ih extends l.PureComponent{constructor(){super(...arguments),this.onUserUpdate=_=>{this.props.updateUser(_)},this.onPasswordChange=_=>{const{user:G,setUserPassword:de}=this.props;G&&de(G.id,_)},this.onUserDelete=_=>{this.props.deleteUser(_)},this.onUserDisable=_=>{this.props.disableUser(_)},this.onUserEnable=_=>{this.props.enableUser(_)},this.onGrafanaAdminChange=_=>{const{user:G,updateUserPermissions:de}=this.props;G&&de(G.id,_)},this.onOrgRemove=_=>{const{user:G,deleteOrgUser:de}=this.props;G&&de(G.id,_)},this.onOrgRoleChange=(_,G)=>{const{user:de,updateOrgUserRole:xe}=this.props;de&&xe(de.id,_,G)},this.onOrgAdd=(_,G)=>{const{user:de,addOrgUser:xe}=this.props;de&&xe(de,_,G)},this.onSessionRevoke=_=>{const{user:G,revokeSession:de}=this.props;G&&de(_,G.id)},this.onAllSessionsRevoke=()=>{const{user:_,revokeAllSessions:G}=this.props;_&&G(_.id)},this.onUserSync=()=>{const{user:_,syncLdapUser:G}=this.props;_&&G(_.id)}}async componentDidMount(){const{match:_,loadAdminUserPage:G}=this.props;G(parseInt(_.params.id,10))}render(){const{user:_,orgs:G,sessions:de,ldapSyncInfo:xe,isLoading:Me}=this.props,we=_?.isExternal&&_?.authLabels?.includes("LDAP"),ke=Wa.TP.hasPermission(wn.AccessControlAction.UsersAuthTokenList),Xe=Wa.TP.hasPermission(wn.AccessControlAction.LDAPStatusRead),ht=_?.authLabels?.[0],mt=ht?`Synced via ${ht}`:"",bt={text:_?.login??"",icon:"shield",subTitle:"Manage settings for an individual user."};return(0,j.jsx)(zr.Y,{navId:"global-users",pageNav:bt,children:(0,j.jsx)(zr.Y.Contents,{isLoading:Me,children:(0,j.jsxs)(on.B,{gap:5,direction:"column",children:[_&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(ah,{user:_,onUserUpdate:this.onUserUpdate,onUserDelete:this.onUserDelete,onUserDisable:this.onUserDisable,onUserEnable:this.onUserEnable,onPasswordChange:this.onPasswordChange}),we&&_?.isExternallySynced&&(0,pc.a)("ldapsync")&&xe&&Xe&&(0,j.jsx)(Ju,{ldapSyncInfo:xe,user:_,onUserSync:this.onUserSync}),(0,j.jsx)(nh,{isGrafanaAdmin:_.isGrafanaAdmin,isExternalUser:_?.isGrafanaAdminExternallySynced,lockMessage:mt,onGrafanaAdminChange:this.onGrafanaAdminChange})]}),G&&(0,j.jsx)(Xu,{user:_,orgs:G,isExternalUser:_?.isExternallySynced,onOrgRemove:this.onOrgRemove,onOrgRoleChange:this.onOrgRoleChange,onOrgAdd:this.onOrgAdd}),de&&ke&&(0,j.jsx)(oh,{sessions:de,onSessionRevoke:this.onSessionRevoke,onAllSessionsRevoke:this.onAllSessionsRevoke})]})})})}}const lh=W=>({user:W.userAdmin.user,sessions:W.userAdmin.sessions,orgs:W.userAdmin.orgs,ldapSyncInfo:W.ldap.syncInfo,isLoading:W.userAdmin.isLoading,error:W.userAdmin.error}),ch={loadAdminUserPage:wr.kz,updateUser:wr.TK,setUserPassword:wr.ly,disableUser:wr.MV,enableUser:wr.nr,deleteUser:wr.hG,updateUserPermissions:wr.N6,addOrgUser:wr.nh,updateOrgUserRole:wr.P3,deleteOrgUser:wr.Pi,revokeSession:wr.T$,revokeAllSessions:wr.VR,syncLdapUser:wr.mI},dh=(0,ka.connect)(lh,ch)(ih);var bd=e(49785),pi=e(48840);const uh=({ldapConnectionInfo:W})=>{const _=(0,l.useMemo)(()=>[{id:"host",header:"Host",disableGrow:!0},{id:"port",header:"Port",disableGrow:!0},{id:"available",cell:de=>de.cell.value?(0,j.jsx)(on.B,{justifyContent:"end",children:(0,j.jsx)(gi.m,{content:"Connection is available",children:(0,j.jsx)(Is.I,{name:"check"})})}):(0,j.jsx)(on.B,{justifyContent:"end",children:(0,j.jsx)(gi.m,{content:"Connection is not available",children:(0,j.jsx)(Is.I,{name:"exclamation-triangle"})})})}],[]),G=(0,l.useMemo)(()=>W,[W]);return(0,j.jsx)("section",{children:(0,j.jsxs)(on.B,{direction:"column",gap:2,children:[(0,j.jsx)(Tr.E,{color:"primary",element:"h3",children:"LDAP Connection"}),(0,j.jsx)(pi.j,{data:G,columns:_,getRowId:de=>de.host+de.port}),(0,j.jsx)(wi,{ldapConnectionInfo:W})]})})},wi=({ldapConnectionInfo:W})=>{if(!W.some(xe=>xe.error))return null;const G=[];W.forEach(xe=>{xe.error&&G.push(xe)});const de=G.map((xe,Me)=>(0,j.jsxs)("div",{children:[(0,j.jsxs)("span",{style:{fontWeight:500},children:[xe.host,":",xe.port,(0,j.jsx)("br",{})]}),(0,j.jsx)("span",{children:xe.error}),Me!==G.length-1&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("br",{}),(0,j.jsx)("br",{})]})]},Me));return(0,j.jsx)(vn.F,{title:"Connection error",severity:wn.AppNotificationSeverity.Error,children:de})},mi="dddd YYYY-MM-DD HH:mm zz",hh=({ldapSyncInfo:W})=>{const _=(0,mc.LE)(W.nextSync,{format:mi}),G=[{id:"syncAttribute"},{id:"syncValue"}],de=[{syncAttribute:"Active synchronization",syncValue:W.enabled?"Enabled":"Disabled"},{syncAttribute:"Scheduled",syncValue:W.schedule},{syncAttribute:"Next synchronization",syncValue:_}];return(0,j.jsxs)("section",{children:[(0,j.jsx)(Tr.E,{element:"h3",children:"LDAP Synchronization"}),(0,j.jsx)(pi.j,{data:de,columns:G,getRowId:xe=>xe.syncAttribute})]})},$l=({groups:W})=>{const _=(0,l.useMemo)(()=>W,[W]),G=(0,l.useMemo)(()=>[{id:"groupDN",header:"LDAP Group"},{id:"orgName",header:"Organization",cell:de=>de.value&&de.row.original.orgRole?de.value:""},{id:"orgRole",header:"Role",cell:de=>de.value||(0,j.jsxs)(j.Fragment,{children:["No match"," ",(0,j.jsx)(gi.m,{content:"No matching organizations found",children:(0,j.jsx)(Is.I,{name:"info-circle"})})]})}],[]);return(0,j.jsx)(pi.j,{headerTooltips:{orgName:{content:"Only the first match for an Organization will be used",iconName:"info-circle"}},columns:G,data:_,getRowId:de=>de.orgId+de.orgRole+de.groupDN})},Cd=({info:W})=>{const _=(0,l.useMemo)(()=>[{id:"userInfo",header:"User Information",disableGrow:!0},{id:"ldapValue"},{id:"cfgAttrValue",header:"LDAP attribute"}],[]),G=(0,l.useMemo)(()=>[{userInfo:"First name",ldapValue:W.name.ldapValue,cfgAttrValue:W.name.cfgAttrValue},{userInfo:"Surname",ldapValue:W.surname.ldapValue,cfgAttrValue:W.surname.cfgAttrValue},{userInfo:"Username",ldapValue:W.login.ldapValue,cfgAttrValue:W.login.cfgAttrValue},{userInfo:"Email",ldapValue:W.email.ldapValue,cfgAttrValue:W.email.cfgAttrValue}],[W]);return(0,j.jsx)(pi.j,{columns:_,data:G,getRowId:de=>de.userInfo})},fh=({permissions:W})=>{const _=(0,l.useMemo)(()=>[{id:"permission",header:"Permissions",disableGrow:!0},{id:"value"}],[]),G=(0,l.useMemo)(()=>[{permission:"Grafana admin",value:W.isGrafanaAdmin?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(Is.I,{name:"shield"})," Yes"]}):"No"},{permission:"Status",value:W.isDisabled?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(Is.I,{name:"times"})," Inactive"]}):(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(Is.I,{name:"check"})," Active"]})}],[W]);return(0,j.jsx)(pi.j,{data:G,columns:_,getRowId:de=>de.permission})},gh=({teams:W})=>{const _=(0,l.useMemo)(()=>[{id:"groupDN",header:"LDAP Group"},{id:"orgName",header:"Organization",cell:({row:{original:{orgName:G}}})=>(0,j.jsx)(j.Fragment,{children:G||"No matching teams found"})},{id:"teamName",header:"Team",cell:({row:{original:{teamName:G,orgName:de}}})=>G&&de?G:""}],[]);return(0,j.jsx)(pi.j,{data:W,columns:_,getRowId:G=>G.teamName})},ph=({ldapUser:W})=>(0,j.jsxs)(on.B,{direction:"column",gap:4,children:[(0,j.jsx)(Cd,{info:W.info}),(0,j.jsx)(fh,{permissions:W.permissions}),W.roles&&W.roles.length>0&&(0,j.jsx)($l,{groups:W.roles}),W.teams&&W.teams.length>0?(0,j.jsx)(gh,{teams:W.teams}):(0,j.jsx)(ce.a,{children:(0,j.jsx)(Tr.E,{children:"No teams found via LDAP"})})]}),mh={text:"LDAP",subTitle:"Verify your LDAP and user mapping configuration.",icon:"book",id:"LDAP"},Td=({clearUserMappingInfo:W,queryParams:_,loadLdapState:G,loadLdapSyncStatus:de,loadUserMapping:xe,clearUserError:Me,ldapUser:we,userError:ke,ldapError:Xe,ldapSyncInfo:ht,ldapConnectionInfo:mt})=>{const[bt,Kt]=(0,l.useState)(!0),{register:Rt,handleSubmit:Ct}=(0,bd.mN)(),Ut=(0,l.useCallback)(async Ds=>xe(Ds),[xe]);(0,l.useEffect)(()=>{const Ds=async()=>Promise.all([G(),de()]);async function Fs(){await W(),await Ds(),_.username&&await Ut(_.username),Kt(!1)}Fs()},[W,Ut,G,de,_]);const hn=({username:Ds})=>{Ds&&Ut(Ds)},Zn=()=>{Me()},As=Wa.TP.hasPermission(wn.AccessControlAction.LDAPUsersRead);return(0,j.jsx)(zr.Y,{navId:"authentication",pageNav:mh,children:(0,j.jsx)(zr.Y.Contents,{isLoading:bt,children:(0,j.jsxs)(on.B,{direction:"column",gap:4,children:[Xe&&Xe.title&&(0,j.jsx)(vn.F,{title:Xe.title,severity:wn.AppNotificationSeverity.Error,children:Xe.body}),(0,j.jsx)(uh,{ldapConnectionInfo:mt}),(0,pc.a)("ldapsync")&&ht&&(0,j.jsx)(hh,{ldapSyncInfo:ht}),As&&(0,j.jsxs)("section",{children:[(0,j.jsx)("h3",{children:"Test user mapping"}),(0,j.jsx)("form",{onSubmit:Ct(hn),children:(0,j.jsx)(Oa.D,{label:"Username",children:(0,j.jsx)(Ze.p,{...Rt("username",{required:!0}),width:34,id:"username",type:"text",defaultValue:_.username,addonAfter:(0,j.jsx)(ye.$n,{variant:"primary",type:"submit",children:"Run"})})})}),ke&&ke.title&&(0,j.jsx)(vn.F,{title:ke.title,severity:wn.AppNotificationSeverity.Error,onRemove:Zn,children:ke.body}),we&&(0,j.jsx)(ph,{ldapUser:we})]})]})})})},Ec=W=>({ldapConnectionInfo:W.ldap.connectionInfo,ldapUser:W.ldap.user,ldapSyncInfo:W.ldap.syncInfo,userError:W.ldap.userError,ldapError:W.ldap.ldapError}),zo={loadLdapState:wr.JI,loadLdapSyncStatus:wr.pm,loadUserMapping:wr.Kg,clearUserError:wr.DX,clearUserMappingInfo:wr.Jc},vh=(0,ka.connect)(Ec,zo)(Td);var Bs=e(27921),Ir=e(75471);function yh(W=J.config){return[{path:"/alerting",component:Xa(()=>e.e(3236).then(e.bind(e,86695)))},{path:"/alerting/home",exact:!1,component:Xa(()=>e.e(3236).then(e.bind(e,86695)))},{path:"/alerting/list",roles:(0,Ir.C0)([wn.AccessControlAction.AlertingRuleRead,wn.AccessControlAction.AlertingRuleExternalRead]),component:Xa(()=>Promise.all([e.e(7049),e.e(3511)]).then(e.bind(e,76543)))},{path:"/alerting/routes",roles:(0,Ir.C0)([wn.AccessControlAction.AlertingNotificationsRead,wn.AccessControlAction.AlertingNotificationsExternalRead]),component:Xa(()=>e.e(6719).then(e.bind(e,6939)))},{path:"/alerting/routes/mute-timing/new",roles:(0,Ir.C0)([wn.AccessControlAction.AlertingNotificationsWrite,wn.AccessControlAction.AlertingNotificationsExternalWrite]),component:Xa(()=>e.e(4501).then(e.bind(e,39349)))},{path:"/alerting/routes/mute-timing/edit",roles:(0,Ir.C0)([wn.AccessControlAction.AlertingNotificationsWrite,wn.AccessControlAction.AlertingNotificationsExternalWrite]),component:Xa(()=>e.e(4501).then(e.bind(e,39349)))},{path:"/alerting/silences",roles:(0,Ir.C0)([wn.AccessControlAction.AlertingInstanceRead,wn.AccessControlAction.AlertingInstancesExternalRead,wn.AccessControlAction.AlertingSilenceRead]),component:Xa(()=>e.e(9347).then(e.bind(e,69645)))},{path:"/alerting/silence/new",roles:(0,Ir.C0)([wn.AccessControlAction.AlertingInstanceCreate,wn.AccessControlAction.AlertingInstancesExternalWrite]),component:Xa(()=>e.e(9347).then(e.bind(e,69645)))},{path:"/alerting/silence/:id/edit",component:Xa(()=>e.e(9347).then(e.bind(e,69645)))},{path:"/alerting/notifications",roles:(0,Ir.C0)([wn.AccessControlAction.AlertingNotificationsRead,wn.AccessControlAction.AlertingNotificationsExternalRead]),component:Xa(()=>e.e(4772).then(e.bind(e,78199)))},{path:"/alerting/notifications/templates/*",roles:(0,Ir.C0)([wn.AccessControlAction.AlertingNotificationsRead,wn.AccessControlAction.AlertingNotificationsExternalRead]),component:Xa(()=>e.e(9224).then(e.bind(e,35868)))},{path:"/alerting/notifications/:type/new",roles:(0,Ir.C0)([wn.AccessControlAction.AlertingNotificationsWrite,wn.AccessControlAction.AlertingNotificationsExternalWrite]),component:Xa(()=>e.e(4772).then(e.bind(e,78199)))},{path:"/alerting/notifications/receivers/:id/edit",roles:(0,Ir.C0)([wn.AccessControlAction.AlertingNotificationsWrite,wn.AccessControlAction.AlertingNotificationsExternalWrite,wn.AccessControlAction.AlertingNotificationsRead,wn.AccessControlAction.AlertingNotificationsExternalRead]),component:Xa(()=>e.e(4772).then(e.bind(e,78199)))},{path:"/alerting/notifications/:type/:id/edit",roles:(0,Ir.C0)([wn.AccessControlAction.AlertingNotificationsWrite,wn.AccessControlAction.AlertingNotificationsExternalWrite]),component:Xa(()=>e.e(4772).then(e.bind(e,78199)))},{path:"/alerting/notifications/:type/:id/duplicate",roles:(0,Ir.C0)([wn.AccessControlAction.AlertingNotificationsWrite,wn.AccessControlAction.AlertingNotificationsExternalWrite]),component:Xa(()=>e.e(4772).then(e.bind(e,78199)))},{path:"/alerting/notifications/:type",roles:(0,Ir.C0)([wn.AccessControlAction.AlertingNotificationsWrite,wn.AccessControlAction.AlertingNotificationsExternalWrite]),component:Xa(()=>e.e(4772).then(e.bind(e,78199)))},{path:"/alerting/groups/",roles:(0,Ir.C0)([wn.AccessControlAction.AlertingInstanceRead,wn.AccessControlAction.AlertingInstancesExternalRead]),component:Xa(()=>e.e(8427).then(e.bind(e,12564)))},{path:"/alerting/history/",roles:(0,Ir.C0)([wn.AccessControlAction.AlertingRuleRead]),component:Xa(()=>Promise.all([e.e(285),e.e(44)]).then(e.bind(e,53666)))},{path:"/alerting/new/:type?",pageClass:"page-alerting",roles:(0,Ir.C0)([wn.AccessControlAction.AlertingRuleCreate,wn.AccessControlAction.AlertingRuleExternalWrite]),component:Xa(()=>Promise.all([e.e(5682),e.e(9947),e.e(7049),e.e(4009)]).then(e.bind(e,50166)))},{path:"/alerting/:id/edit",pageClass:"page-alerting",roles:(0,Ir.C0)([wn.AccessControlAction.AlertingRuleUpdate,wn.AccessControlAction.AlertingRuleExternalWrite]),component:Xa(()=>Promise.all([e.e(5682),e.e(9947),e.e(7049),e.e(4009)]).then(e.bind(e,50166)))},{path:"/alerting/:id/modify-export",pageClass:"page-alerting",roles:(0,Ir.C0)([wn.AccessControlAction.AlertingRuleRead]),component:Xa(()=>Promise.all([e.e(5682),e.e(9947),e.e(7049),e.e(4009)]).then(e.bind(e,69179)))},{path:"/alerting/:sourceName/:id/view",pageClass:"page-alerting",roles:(0,Ir.C0)([wn.AccessControlAction.AlertingRuleRead,wn.AccessControlAction.AlertingRuleExternalRead]),component:Xa(()=>Promise.resolve().then(e.bind(e,79741)))},{path:"/alerting/:sourceName/:name/find",pageClass:"page-alerting",roles:(0,Ir.C0)([wn.AccessControlAction.AlertingRuleRead,wn.AccessControlAction.AlertingRuleExternalRead]),component:Xa(()=>e.e(5516).then(e.bind(e,6165)))},{path:"/alerting/admin",roles:()=>["Admin"],component:Xa(()=>e.e(9438).then(e.bind(e,53191)))}]}function Xa(W){const _=()=>e.e(9029).then(e.bind(e,5961));return(0,Bs.A)(J.config.unifiedAlertingEnabled?W:_)}var Dc=e(56361),el=e(6320);const xh=W=>({alertContent:(0,Qe.css)`
    display: flex;
    flex-direction: row;
    padding: 0;
    justify-content: space-between;
    align-items: center;
  `,alertParagraph:(0,Qe.css)`
    margin: 0 ${W.spacing(1)} 0 0;
    line-height: ${W.spacing(W.components.height.sm)};
  `});function Eh(){const W=(0,pt.of)(xh),_=Wa.TP.hasPermission(wn.AccessControlAction.DataSourcesCreate)||Wa.TP.hasPermission(wn.AccessControlAction.DataSourcesWrite),[G,de]=(0,l.useState)(_);return G?(0,j.jsx)(vn.F,{severity:"info",title:"",onRemove:()=>de(!1),children:(0,j.jsxs)("div",{className:W.alertContent,children:[(0,j.jsx)("p",{className:W.alertParagraph,children:"Data sources have a new home! You can discover new data sources or manage existing ones in the Connections page, accessible from the main menu."}),(0,j.jsx)(ye.z9,{"aria-label":"Link to Connections",icon:"arrow-right",href:el.b.DataSources,fill:"text",children:"Go to connections"})]})}):(0,j.jsx)(j.Fragment,{})}function Dh(){return[{path:`/${el.q}`,exact:!1,component:(0,Bs.A)(()=>Promise.all([e.e(6359),e.e(3418),e.e(2154)]).then(e.bind(e,19514)))}]}var tl=e(83883),Wi=e(57220),Vl=(W=>(W.ViewIRMMainPage="grafana_irm_configuration_tracker_main_page_view",W.OpenEssentials="grafana_irm_configuration_tracker_essentials_open",W.CloseEssentials="grafana_irm_configuration_tracker_essentials_closed",W.ClickDataSources="grafana_irm_configuration_tracker_data_sources_clicked",W))(Vl||{});function _l(W,_){(0,Vr.rR)(W,{..._})}var Pc=e(3704),Ph=e(79938),Md=e(82843),bh=e(37534),Ch=e(730);function Th(){const[W,{data:_,isLoading:G}]=Ph.hK.endpoints.rulerRules.useLazyQuery({refetchOnFocus:!0,refetchOnReconnect:!0}),{dsFeatures:de,isLoadingDsFeatures:xe}=(0,Ch.O3)(Wi.hY),Me=de?.rulerConfig;return(0,l.useEffect)(()=>{Me&&W({rulerConfig:Me})},[Me,W]),{isDone:(_?Object.entries(_).flatMap(([Xe,ht])=>ht.flatMap(mt=>mt.rules)):[]).length>0,isLoading:G||xe}}function Sd(W){return W.some(_=>_.grafana_managed_receiver_configs?.some(G=>G.type===bh.J4.OnCall))}function Od(){const W=Md.m.endpoints.getAlertmanagerConfiguration.useQuery(Wi.hY,{refetchOnFocus:!0,refetchOnReconnect:!0,refetchOnMountOrArgChange:!0});return{contactPoints:W.data?.alertmanager_config?.receivers??[],isLoading:W.isLoading}}function Mh(){const W=Md.m.endpoints.getAlertmanagerConfiguration.useQuery(Wi.hY,{refetchOnFocus:!0,refetchOnReconnect:!0,refetchOnMountOrArgChange:!0});return{defaultContactpoint:W.data?.alertmanager_config?.route?.receiver??"",isLoading:W.isLoading}}const Sh="<example@email.com>";function Oh(W,_){return _.some(de=>de.name===W&&de.grafana_managed_receiver_configs?.some(xe=>xe.name===W&&xe.settings?.address!==Sh))}var xl=e(99494),El=e(49962);const Ih=W=>`/api/plugins/${xl.W.Incident}/resources${W}`,Ah=El.Hr.injectEndpoints({endpoints:W=>({getIncidentsPluginConfig:W.query({query:()=>({url:Ih("/api/ConfigurationTrackerService.GetConfigurationTracker"),data:{},method:"POST",showErrorAlert:!1})})})});var bc=e(12210);function Rh(){const{installed:W,loading:_}=(0,bc._)(xl.W.Incident),{data:G,isLoading:de}=Ah.endpoints.getIncidentsPluginConfig.useQuery();return{isInstalled:W??!1,isChatOpsInstalled:G?.isChatOpsInstalled??!1,isIncidentCreated:G?.isIncidentCreated??!1,isLoading:_||de}}var Cc=e(26423);function Lh(){const{installed:W}=(0,bc._)(xl.W.OnCall),{data:_}=Cc.WG.endpoints.grafanaOnCallIntegrations.useQuery(void 0,{skip:!W,refetchOnFocus:!0,refetchOnReconnect:!0,refetchOnMountOrArgChange:!0});return _??[]}function jh(){const{data:W,isLoading:_}=Cc.WG.endpoints.onCallConfigChecks.useQuery(void 0,{refetchOnFocus:!0,refetchOnReconnect:!0,refetchOnMountOrArgChange:!0});return{isLoading:_,onCallConfigChecks:W??{is_chatops_connected:!1,is_integration_chatops_connected:!1}}}function Id(){return Lh().map(_=>({label:_.display_name,value:_.value}))}function Bh(){const{onCallConfigChecks:{is_chatops_connected:W,is_integration_chatops_connected:_},isLoading:G}=jh();return{is_chatops_connected:W,is_integration_chatops_connected:_,isLoading:G}}const Uh=`/api/plugins/${xl.W.Slo}/resources/v1`,Nh=El.Hr.injectEndpoints({endpoints:W=>({getSlos:W.query({query:()=>({url:`${Uh}/slo`,showErrorAlert:!1}),providesTags:["GrafanaSlo"]})})});function wh(){const{installed:W}=(0,bc._)(xl.W.Slo),{data:_,isLoading:G}=Nh.endpoints.getSlos.useQuery(void 0,{skip:!W,refetchOnFocus:!0,refetchOnReconnect:!0,refetchOnMountOrArgChange:!0});return{isLoading:G,hasSlo:!!_?.slos.length,hasSloWithAlert:!!_?.slos?.some(de=>de.alerting)}}function Wh(){const{contactPoints:W,isLoading:_}=Od(),{defaultContactpoint:G,isLoading:de}=Mh(),{isDone:xe,isLoading:Me}=Th(),{isChatOpsInstalled:we,isInstalled:ke,isLoading:Xe}=Rh(),ht=Id(),{is_chatops_connected:mt,is_integration_chatops_connected:bt,isLoading:Kt}=Bh(),{hasSlo:Rt,hasSloWithAlert:Ct,isLoading:Ut}=wh();return{alerting:{contactPoints:W,defaultContactpoint:G,isCreateAlertRuleDone:xe},incidents:{isChatOpsInstalled:we,isIncidentsInstalled:ke},onCall:{onCallOptions:ht,is_chatops_connected:mt,is_integration_chatops_connected:bt},slo:{hasSlo:Rt,hasSloWithAlert:Ct},isLoading:_||de||Me||Xe||Kt||Ut}}function Fh(){const{alerting:{contactPoints:W,defaultContactpoint:_,isCreateAlertRuleDone:G},incidents:{isChatOpsInstalled:de,isIncidentsInstalled:xe},onCall:{onCallOptions:Me,is_chatops_connected:we,is_integration_chatops_connected:ke},slo:{hasSlo:Xe,hasSloWithAlert:ht},isLoading:mt}=Wh();function bt(Ut,hn){const Zn=(0,Pc.G)(`${hn} + ${Ut}`,{returnTo:location.pathname+location.search});I.Ny.push(Zn)}const Kt={sections:[{title:"Detect",description:"Configure Grafana Alerting",steps:[{title:"Update default email contact point",description:"Add a valid email to the default email contact point.",button:{type:"openLink",urlLink:{url:`/alerting/notifications/receivers/${_}/edit`,queryParams:{alertmanager:"grafana"}},label:"Edit",labelOnDone:"View",urlLinkOnDone:{url:"/alerting/notifications"}},done:Oh(_,W)},{title:"Connect alerting to OnCall",description:"Create an OnCall integration for an alerting contact point.",button:{type:"openLink",urlLink:{url:"/alerting/notifications/receivers/new"},label:"Connect",urlLinkOnDone:{url:"/alerting/notifications"},labelOnDone:"View"},done:Sd(W)},{title:"Create alert rule",description:"Create an alert rule to monitor your system.",button:{type:"openLink",urlLink:{url:"/alerting/new"},label:"Create",urlLinkOnDone:{url:"/alerting/list"},labelOnDone:"View"},done:G},{title:"Create your first SLO",description:"Create SLOs to monitor your service.",button:{type:"openLink",urlLink:{url:"/a/grafana-slo-app/wizard/new"},label:"Create",urlLinkOnDone:{url:"/a/grafana-slo-app/manage-slos"},labelOnDone:"View"},done:Xe},{title:"Enable SLO alerting",description:"Configure SLO alerting to receive notifications when your SLOs are breached.",button:{type:"openLink",urlLink:{queryParams:{alertsEnabled:"disabled"},url:"/a/grafana-slo-app/manage-slos"},label:"Enable",urlLinkOnDone:{queryParams:{alertsEnabled:"enabled"},url:"/a/grafana-slo-app/manage-slos"},labelOnDone:"View"},done:ht}]},{title:"Respond",description:"Configure OnCall and Incident",steps:[{title:"Initialize Incident plugin",description:"Initialize the Incident plugin to declare and manage incidents.",button:{type:"openLink",urlLink:{url:"/a/grafana-incident-app/walkthrough/generate-key"},label:"Initialize",urlLinkOnDone:{url:"/a/grafana-incident-app"},labelOnDone:"View"},done:xe},{title:"Connect your Messaging workspace to OnCall",description:"Receive alerts and oncall notifications within your chat environment.",button:{type:"openLink",urlLink:{url:"/a/grafana-oncall-app/settings",queryParams:{tab:"ChatOps",chatOpsTab:"Slack"}},label:"Connect",urlLinkOnDone:{url:"/a/grafana-oncall-app/settings",queryParams:{tab:"ChatOps"}},labelOnDone:"View"},done:we},{title:"Connect your Messaging workspace to Incident",description:"Automatically create an incident channel and manage incidents directly within your chat environment.",button:{type:"openLink",urlLink:{url:"/a/grafana-incident-app/integrations/grate.slack"},label:"Connect",urlLinkOnDone:{url:"/a/grafana-incident-app/integrations"}},done:de},{title:"Add Messaging workspace channel to OnCall Integration",description:"Select ChatOps channels to route notifications",button:{type:"openLink",urlLink:{url:"/a/grafana-oncall-app/integrations/"},label:"Add",urlLinkOnDone:{url:"/a/grafana-oncall-app/integrations/"},labelOnDone:"View"},done:ke}]},{title:"Test your configuration",description:"",steps:[{title:"Send OnCall demo alert via Alerting integration",description:"In the integration page, click Send demo alert, to review your notification",button:{type:"dropDown",label:"Select integration",options:Me,onClickOption:Ut=>bt(Ut,"/a/grafana-oncall-app/integrations/"),stepNotAvailableText:"No integrations available"}},{title:"Create Incident drill",description:"Practice solving an Incident",button:{type:"openLink",urlLink:{url:"/a/grafana-incident-app",queryParams:{declare:"new",drill:"1"}},label:"Start drill"}}]}]},{stepsDone:Rt,totalStepsToDo:Ct}=Kt.sections.reduce((Ut,hn)=>{const Zn=hn.steps.filter(Ds=>Ds.done).length,As=hn.steps.reduce((Ds,Fs)=>Fs.done!==void 0?Ds+1:Ds,0);return{stepsDone:Ut.stepsDone+Zn,totalStepsToDo:Ut.totalStepsToDo+As}},{stepsDone:0,totalStepsToDo:0});return{essentialContent:Kt,stepsDone:Rt,totalStepsToDo:Ct,isLoading:mt}}const Kh=({dataSourceConfigurationData:{dataSourceCompatibleWithAlerting:W},essentialsConfigurationData:{stepsDone:_,totalStepsToDo:G}})=>(0,l.useMemo)(()=>{function de(){const xe=W?"You have connected a datasource.":"Connect at least one data source to start receiving data",Me=W?"View":"Connect";return{id:Tc.CONNECT_DATASOURCE,title:"Connect data source",description:xe,actionButtonTitle:Me,isDone:W}}return[de(),{id:Tc.ESSENTIALS,title:"Essentials",titleIcon:"star",description:"Set up the necessary features to start using Grafana IRM workflows",actionButtonTitle:_===G?"View":"Configure",stepsDone:_,totalStepsToDo:G}]},[W,_,G]);var $h=e(39558),Vh=e(76412);function zl({stepsDone:W,totalStepsToDo:_}){const G=(0,pt.of)(_h);return _===0?null:(0,j.jsx)("div",{className:G.containerStyles,role:"progressbar","aria-valuenow":W,"aria-valuemax":_,children:(0,j.jsx)("div",{className:G.fillerStyles(W/_*100)})})}function Ad({stepsDone:W,totalStepsToDo:_}){return(0,j.jsxs)("span",{children:[(0,j.jsx)(Tr.E,{color:"success",children:W})," of ",_]})}function _h(W){return{containerStyles:(0,Qe.css)({height:W.spacing(2),borderRadius:W.shape.radius.pill,backgroundColor:W.colors.border.weak,flex:"auto"}),fillerStyles:_=>(0,Qe.css)({height:"100%",width:`${_}%`,backgroundColor:W.colors.success.main,borderRadius:W.shape.radius.pill,textAlign:"right"})}}function zh({config:W,handleActionClick:_,isLoading:G=!1}){const de=(0,pt.of)(Hh);return(0,j.jsx)(on.B,{direction:"column",gap:1,justifyContent:"space-around",children:(0,j.jsxs)("div",{className:de.cardContent,children:[(0,j.jsxs)(on.B,{direction:"column",gap:1,children:[(0,j.jsxs)(on.B,{direction:"row",alignItems:"center",justifyContent:"space-between",gap:1,children:[(0,j.jsx)("div",{className:"fs-unmask",children:(0,j.jsxs)(on.B,{direction:"row",gap:1,alignItems:"center",children:[W.title,W.titleIcon&&(0,j.jsx)(Is.I,{name:W.titleIcon}),W.isDone&&!G&&(0,j.jsx)(Is.I,{name:"check-circle",color:"green",size:"lg"})]})}),W.stepsDone&&W.totalStepsToDo&&!G&&(0,j.jsx)("div",{className:"fs-unmask",children:(0,j.jsxs)(on.B,{direction:"row",gap:.5,children:[(0,j.jsx)(Ad,{stepsDone:W.stepsDone,totalStepsToDo:W.totalStepsToDo}),(0,j.jsx)(Vh.x,{children:"complete"})]})})]}),(0,j.jsxs)(on.B,{direction:"column",children:[G?(0,j.jsx)($h._,{text:"Loading configuration...."}):W.description,!G&&W.stepsDone&&W.totalStepsToDo&&(0,j.jsx)(zl,{stepsDone:W.stepsDone,totalStepsToDo:W.totalStepsToDo})]})]}),(0,j.jsx)(on.B,{direction:"row",gap:1,justifyContent:"flex-start",alignItems:"flex-end",children:(0,j.jsx)(ye.$n,{variant:"secondary",onClick:()=>_(W.id,W.isDone),className:"fs-unmask",children:W.actionButtonTitle})})]})})}const Hh=W=>({cardTitle:(0,Qe.css)({display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",width:"100%"}),cardContent:(0,Qe.css)({background:W.colors.background.secondary,padding:W.spacing(2),borderRadius:W.shape.radius.default,height:"100%",gap:W.spacing(1),display:"flex",flexDirection:"column",justifyContent:"space-between"})});var Rd=e(87978),Hl=e(83122),xo=e(38138);function Mo({onClose:W,essentialsConfig:_,stepsDone:G,totalStepsToDo:de}){return(0,j.jsx)(Rd._,{title:"Essentials",subtitle:"Complete the following configuration tasks",onClose:W,children:(0,j.jsx)(vi,{essentialContent:_,stepsDone:G,totalStepsToDo:de})})}function vi({essentialContent:W,stepsDone:_,totalStepsToDo:G}){return(0,j.jsxs)(on.B,{direction:"column",gap:1,children:[(0,j.jsx)(Bd,{stepsDone:_,totalStepsToDo:G}),W.sections.map(de=>(0,j.jsx)(Dp,{section:de},de.title))]})}function Dp({section:W}){const _=(0,pt.of)(Gh);return(0,j.jsxs)("div",{className:_.wrapper,children:[(0,j.jsx)(Tr.E,{element:"h4",children:(0,j.jsx)("span",{className:"fs-unmask",children:W.title})}),(0,j.jsx)(Tr.E,{color:"secondary",children:(0,j.jsx)("span",{className:"fs-unmask",children:W.description})}),(0,j.jsx)(on.B,{direction:"column",gap:2,children:W.steps.map((G,de)=>(0,j.jsx)(Ld,{step:G},de))})]})}function Pp({done:W}){return W?(0,j.jsx)(Is.I,{name:"check-circle",color:"green","data-testid":"checked-step",className:"fs-unmask"}):(0,j.jsx)(Is.I,{name:"circle","data-testid":"unckecked-step",className:"fs-unmask"})}function Ld({step:W}){return(0,j.jsxs)(on.B,{direction:"row",justifyContent:"space-between","data-testid":"step",children:[(0,j.jsxs)(on.B,{direction:"row",alignItems:"center",children:[W.done!==void 0&&(0,j.jsx)(Pp,{done:W.done}),(0,j.jsx)(Tr.E,{variant:"body",children:(0,j.jsx)("span",{className:"fs-unmask",children:W.title})}),(0,j.jsx)(gi.m,{content:W.description,placement:"right",children:(0,j.jsx)(Is.I,{name:"question-circle"})})]}),(0,j.jsx)(kh,{...W.button,done:W.done,"data-testid":"step-button"})]})}function jd(W){const{urlLink:_,label:G,urlLinkOnDone:de,labelOnDone:xe,done:Me}=W,we=_?.url?(0,Pc.G)(_.url,{returnTo:location.pathname+location.search,..._.queryParams}):"",ke=de?.url?(0,Pc.G)(de.url,{returnTo:location.pathname+location.search,...de.queryParams}):"",Xe=Me?ke:we;return(0,j.jsx)(ye.z9,{href:Xe,variant:"secondary",className:"fs-unmask",children:Me?xe??G:G})}function kh({type:W,urlLink:_,urlLinkOnDone:G,label:de,labelOnDone:xe,options:Me,onClickOption:we,done:ke,stepNotAvailableText:Xe}){switch(W){case"openLink":return(0,j.jsx)(jd,{urlLink:_,label:de,urlLinkOnDone:G,labelOnDone:xe,done:ke});case"dropDown":return Me?.length?(0,j.jsx)(Hl.m,{overlay:(0,j.jsx)(xo.W,{className:"fs-unmask",children:Me?.map(ht=>(0,j.jsx)(xo.W.Item,{label:ht.label,className:"fs-unmask",onClick:()=>{we?.(ht.value)}},ht.value))}),children:(0,j.jsxs)(ye.$n,{variant:"secondary",size:"md",className:"fs-unmask",children:[de,(0,j.jsx)(Is.I,{name:"angle-down"})]})}):(0,j.jsxs)(Tr.E,{children:[Xe??"No options available"," "]})}}function Bd({stepsDone:W,totalStepsToDo:_}){return(0,j.jsxs)(on.B,{direction:"row",gap:1,alignItems:"center",children:["Your progress",(0,j.jsx)(zl,{stepsDone:W,totalStepsToDo:_}),(0,j.jsx)(Ad,{stepsDone:W,totalStepsToDo:_})]})}const Gh=W=>({wrapper:(0,Qe.css)({margin:W.spacing(2,0),padding:W.spacing(2),border:`1px solid ${W.colors.border.medium}`,borderRadius:W.shape.radius.default,display:"flex",flexDirection:"column",gap:W.spacing(2)})});var Tc=(W=>(W[W.CONNECT_DATASOURCE=0]="CONNECT_DATASOURCE",W[W.ESSENTIALS=1]="ESSENTIALS",W))(Tc||{});function Qh(){return{dataSourceCompatibleWithAlerting:!!(0,Wi.k5)()}}function Yh(){const W=(0,pt.of)(Jh),_=(0,qa.W6)(),G=Qh(),de=Fh(),xe=Kh({dataSourceConfigurationData:G,essentialsConfigurationData:de});(0,l.useEffect)(()=>{_l(Vl.ViewIRMMainPage,{essentialStepsDone:0,essentialStepsToDo:0,dataSourceCompatibleWithAlerting:G.dataSourceCompatibleWithAlerting})},[G.dataSourceCompatibleWithAlerting]);const[Me,we]=(0,l.useState)(!1),ke=(ht,mt)=>{switch(_l(Vl.ClickDataSources,{essentialStepsDone:de.stepsDone,essentialStepsToDo:de.totalStepsToDo,dataSourceCompatibleWithAlerting:G.dataSourceCompatibleWithAlerting}),ht){case 0:mt?_.push(tl.I.List):_.push(tl.I.New);break;case 1:we(!0),_l(Vl.OpenEssentials,{essentialStepsDone:de.stepsDone,essentialStepsToDo:de.totalStepsToDo,dataSourceCompatibleWithAlerting:G.dataSourceCompatibleWithAlerting});break;default:return}};function Xe(){we(!1),_l(Vl.CloseEssentials,{essentialStepsDone:de.stepsDone,essentialStepsToDo:de.totalStepsToDo,dataSourceCompatibleWithAlerting:G.dataSourceCompatibleWithAlerting})}return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(Tr.E,{element:"h4",variant:"h4",children:"Configure"}),(0,j.jsxs)("section",{className:W.container,children:[xe.map(ht=>(0,j.jsx)(zh,{config:ht,handleActionClick:ke,isLoading:de.isLoading},ht.id)),Me&&(0,j.jsx)(Mo,{onClose:Xe,essentialsConfig:de.essentialContent,stepsDone:de.stepsDone,totalStepsToDo:de.totalStepsToDo})]}),(0,j.jsx)(Tr.E,{element:"h4",variant:"h4",children:"IRM apps"})]})}const Jh=W=>({container:(0,Qe.css)({marginBottom:0,display:"grid",gap:W.spacing(3),gridTemplateColumns:" 1fr 1fr"})});var Mc=e(66253);const Xh=[{path:"/plugins",navId:"plugins",roles:kl([wn.AccessControlAction.PluginsInstall,wn.AccessControlAction.PluginsWrite],["Admin","ServerAdmin"]),routeName:Mc.vk.Home,component:(0,Bs.A)(()=>e.e(4519).then(e.bind(e,65965)))},{path:"/plugins/browse",navId:"plugins",roles:kl([wn.AccessControlAction.PluginsInstall,wn.AccessControlAction.PluginsWrite],["Admin","ServerAdmin"]),routeName:Mc.vk.Browse,component:(0,Bs.A)(()=>e.e(4519).then(e.bind(e,65965)))},{path:"/plugins/:pluginId/",navId:"plugins",roles:kl([wn.AccessControlAction.PluginsInstall,wn.AccessControlAction.PluginsWrite],["Admin","ServerAdmin"]),routeName:Mc.vk.Details,component:(0,Bs.A)(()=>Promise.all([e.e(6359),e.e(3418),e.e(7891)]).then(e.bind(e,86400)))}];function kl(W,_){return()=>W.some(G=>Wa.TP.hasPermission(G))?[]:_}function Ud(){return Xh}var Sc=e(17422),Ho=e(65307),Zh=e(13834),Oc=e(62625),Fi=e(26272),qh=e(39419),Ro=e(76888);function bp(W){return console.error(W),Gl("Exception thrown","See console for details")}function ef(){return Gl("Page not found","404 Error")}function Gl(W,_){const G={text:W,subTitle:_,icon:"exclamation-triangle"};return{node:G,main:G}}var Nd=e(94954),Ic=e(27716),wd=e(59421),Wd=e(60677);const Ql=(0,l.createContext)(Ac());Ql.displayName="PluginPageContext";function Ac(){return{sectionNav:{main:{text:"Plugin page"},node:{text:"Plugin page"}}}}function Dl(W){return{sectionNav:W??Ac().sectionNav}}const Rc={loading:!0,loadingError:!1,pluginNav:null,plugin:null};function Lc({pluginId:W,pluginNavSection:_}){const G=(0,qa.W5)(),de=(0,qa.zy)(),[xe,Me]=(0,l.useReducer)(Pl.reducer,Rc),we=ae.$.appSubUrl+de.pathname+de.search,{plugin:ke,loading:Xe,loadingError:ht,pluginNav:mt}=xe,bt=(0,Wd.Wy)(_,mt,we),Kt=(0,l.useMemo)(()=>(0,I.SE)(de.search),[de.search]),Rt=(0,l.useMemo)(()=>Dl(bt),[bt]),Ct=(0,Ro.Il)();(0,l.useEffect)(()=>{tf(W,Me)},[W]);const Ut=(0,l.useCallback)(Ds=>Me(Pl.actions.changeNav(Ds)),[]);if(!ke||W!==ke.meta.id){const Ds=Ct.chrome.state.getValue().layout;return(0,j.jsxs)(zr.Y,{navModel:bt,pageNav:{text:""},layout:Ds,children:[Xe&&(0,j.jsx)(qh.A,{}),!Xe&&ht&&(0,j.jsx)(fd.L,{entity:"App"})]})}if(!ke.root)return(0,j.jsx)(zr.Y,{navModel:bt??Gl("Plugin load error"),children:(0,j.jsx)("div",{children:"No root app page component found"})});const hn=ke.root&&(0,j.jsx)(Zh.a,{meta:ke.meta,children:(0,j.jsx)(ke.root,{meta:ke.meta,basename:G.url,onNavChanged:Ut,query:Kt,path:de.pathname})}),Zn=()=>{if(!ke.meta?.includes)return!0;const Ds=ke.meta?.includes.find(Ar=>Ar.path===de.pathname);if(!Ds)return!0;if(Ds?.action&&ae.$.featureToggles.accessControlOnCall)return Wa.TP.hasPermission(Ds.action);if(Wa.TP.isGrafanaAdmin||Wa.TP.user.orgRole===Oc.X.Admin)return!0;const Fs=Ds?.role||"";return!Fs||Wa.TP.isEditor&&Fs===Oc.X.Viewer?!0:Wa.TP.hasRole(Fs)},As=()=>(0,j.jsx)(vn.F,{severity:"warning",title:"Access denied",children:"You do not have permission to see this page."});return Zn()?mt?(0,j.jsx)(j.Fragment,{children:bt?(0,j.jsx)(zr.Y,{navModel:bt,pageNav:mt?.node,children:(0,j.jsx)(zr.Y.Contents,{isLoading:Xe,children:hn})}):(0,j.jsx)(zr.Y,{children:hn})}):(0,j.jsx)(Ql.Provider,{value:Rt,children:hn}):(0,j.jsx)(As,{})}const Pl=(0,Ho.Z0)({name:"prom-builder-container",initialState:Rc,reducers:{setState:(W,_)=>{Object.assign(W,_.payload)},changeNav:(W,_)=>{let G=_.payload;G&&G.node.children&&(G={...G,node:{...G.main,hideFromBreadcrumbs:!0}}),W.pluginNav=G}}});async function tf(W,_){try{const G=await(0,Ic.x)(W).then(de=>{const xe=Fd(de);return xe?(Wa.lE.emit(Fi.r1.alertError,[xe]),_(Pl.actions.setState({pluginNav:Gl(xe)})),null):(0,wd.ui)(de)});_(Pl.actions.setState({plugin:G,loading:!1,loadingError:!1,pluginNav:null}))}catch(G){_(Pl.actions.setState({plugin:null,loading:!1,loadingError:!0,pluginNav:ef()}));const de=G instanceof Error?G:new Error((0,Nd.q)(G));Wd.z4.logError(de),console.error(de)}}function Fd(W){return W?W.type!==rt.QE.app?"Plugin must be an app":W.enabled?null:"Application Not Enabled":"Unknown Plugin"}const Kd=Lc;var er=e(99140);function nf(){const W=(0,er.Gu)(),{navIndex:_}=W,G=Me=>Me.startsWith("standalone-plugin-page-/"),de=Me=>"pluginId"in Me&&"id"in Me;return[...Object.values(_).filter(de).map(Me=>{const we=(0,Sc.rH)(Me),ke=`/a/${Me.pluginId}`,Xe=G(Me.id)&&Me.url||ke,ht=G(Me.id)&&!Me.url?.startsWith("/a/");return{path:Xe,exact:!1,sensitive:ht,component:()=>(0,j.jsx)(Kd,{pluginId:Me.pluginId,pluginNavSection:we})}}),{path:"/a/:pluginId",exact:!1,component:({match:Me})=>(0,j.jsx)(Kd,{pluginId:Me.params.pluginId,pluginNavSection:_.home})}]}const $d=[{path:"/profile",component:(0,Bs.A)(()=>e.e(2472).then(e.bind(e,48357)))},{path:"/profile/password",component:(0,Bs.A)(()=>e.e(8107).then(e.bind(e,28107)))},{path:"/profile/select-org",component:(0,Bs.A)(()=>e.e(7430).then(e.bind(e,44613)))},{path:"/profile/notifications",component:(0,Bs.A)(()=>e.e(4140).then(e.bind(e,78015)))}];function Cp(W=J.config){return W.profileEnabled?$d:(0,m.uniq)($d.map(G=>G.path)).map(G=>({path:G,component:(0,Bs.A)(()=>e.e(5173).then(e.bind(e,35208)))}))}var jc=e(69529),sf=e(75816),af=e(75505);function rf({baseURL:W}){async function _(G){try{const{data:de,...xe}=await(0,af.s)((0,M.AI)().fetch({...G,url:W+G.url,showErrorAlert:G.showErrorAlert,data:G.body}));return{data:de,meta:xe}}catch(de){return G.manageError?G.manageError(de):{error:de}}}return _}const nl=(0,sf.xP)({reducerPath:"userPreferencesAPI",baseQuery:rf({baseURL:"/api"}),endpoints:()=>({})}).injectEndpoints({endpoints:W=>({getUserPreferences:W.query({query:()=>({url:"/user/preferences"})}),patchUserPreferences:W.mutation({query:_=>({url:"/user/preferences",method:"PATCH",body:_.patchPrefsCmd})}),updateUserPreferences:W.mutation({query:_=>({url:"/user/preferences",method:"PUT",body:_.updatePrefsCmd})})}),overrideExisting:!1}),{useGetUserPreferencesQuery:Tp,usePatchUserPreferencesMutation:of,useUpdateUserPreferencesMutation:Mp}=nl,{useGetUserPreferencesQuery:lf,usePatchUserPreferencesMutation:cf,useUpdateUserPreferencesMutation:Sp}=nl,Bc=nl.enhanceEndpoints({addTagTypes:["UserPreferences"],endpoints:{getUserPreferences:{providesTags:["UserPreferences"]},updateUserPreferences:{invalidatesTags:["UserPreferences"]},patchUserPreferences:{invalidatesTags:["UserPreferences"]}}}),Vd=()=>{const W=lf(void 0,{skip:!ae.$.bootData.user.isSignedIn}),_=(0,l.useMemo)(()=>W.data?.navbar?.bookmarkUrls||[],[W]);return ae.$.featureToggles.pinNavItems?_:[]};var Jl=e(28215),to=e(28444),Mr=e(28138),df=e(38645),_d=e(93522);const zd=W=>{let _=W.children||[];if(W.id==="help"){const G=()=>{Mr.A.publish(new to.S8({component:_d.N}))};W.children=[..._,...(0,df.Dd)(),...kd(),{id:"keyboard-shortcuts",text:(0,aa.t)("nav.help/keyboard-shortcuts","Keyboard shortcuts"),icon:"keyboard",onClick:G}]}return W},Xl=(W,_)=>{const G={...W},de=G.onClick;return G.onClick=()=>{(0,Vr.rR)("grafana_navigation_item_clicked",{path:G.url??G.id,menuIsDocked:_,itemIsBookmarked:!!(ae.$.featureToggles.pinNavItems&&G?.parentItem?.id==="bookmarks"),bookmarkToggleOn:!!ae.$.featureToggles.pinNavItems}),de?.()},G.children&&(G.children=G.children.map(xe=>Xl(xe,_))),G},Hd=(W,_)=>!!W.children?.some(G=>G===_?!0:Hd(G,_)),Zl=(W,_,G)=>{const{id:de,parentItem:xe}=_;if(G==="/")return W.find(Me=>Me.id===Jl.Id);if(_.id!=="profile"){for(const Me of W){const we=!!(Me.id&&Me.id===de),ke=Me.text===_.text&&Me.url===_.url;if(we||ke)return Me;if(Me.children){const Xe=Zl(Me.children,_);if(Xe)return Xe}}if(xe)return Zl(W,xe)}};function kd(){const{buildInfo:W,licenseInfo:_}=ae.$,G=_.stateInfo?` (${_.stateInfo})`:"",de=[];return de.push({target:"_blank",id:"version",text:`${W.edition}${G}`,url:_.licenseUrl,icon:"external-link-alt"}),W.hasUpdate&&de.push({target:"_blank",id:"updateVersion",text:"New version available!",icon:"download-alt",url:"https://grafana.com/grafana/download?utm_source=grafana_footer"}),de}function ql(W,_){for(const G of W){if(G.url===_)return G;if(G.children?.length){const de=ql(G.children,_);if(de)return de}}return null}function ec(){const W=(0,pt.of)(uf),_=Vd(),G=(0,wn.useSelector)(xe=>xe.navBarTree),de=_.reduce((xe,Me)=>{const we=ql(G,Me);return we&&xe.push(we),xe},[]);return(0,j.jsx)(zr.Y,{navId:"bookmarks",children:(0,j.jsx)(zr.Y.Contents,{children:de.length===0?(0,j.jsx)(jc.p,{variant:"call-to-action",message:(0,aa.t)("bookmarks-page.empty.message","It looks like you haven\u2019t created any bookmarks yet"),children:(0,j.jsx)(aa.x6,{i18nKey:"bookmarks-page.empty.tip",children:"Hover over any item in the nav menu and click on the bookmark icon to add it here."})}):(0,j.jsx)("section",{className:W.grid,children:de.map(xe=>(0,j.jsx)(hd,{description:xe.subTitle,text:xe.text,url:xe.url??""},xe.id||xe.url))})})})}const uf=W=>({grid:(0,Qe.css)({display:"grid",gap:W.spacing(3),gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gridAutoRows:"138px",padding:W.spacing(2,0)})}),tc=()=>!J.config.publicDashboardsEnabled||!J.config.featureToggles.publicDashboards?[]:[{path:"/dashboard/public",pageClass:"page-dashboard",routeName:wn.DashboardRoutes.Public,component:(0,Bs.A)(()=>e.e(5761).then(e.bind(e,53371)))},{path:"/public-dashboards/:accessToken",pageClass:"page-dashboard",routeName:wn.DashboardRoutes.Public,chromeless:!0,component:(0,Bs.A)(()=>Promise.all([e.e(9569),e.e(6263),e.e(7197)]).then(e.bind(e,20302)))}],Gd=[];function hf(){return[...nf(),{path:"/",pageClass:"page-dashboard",routeName:wn.DashboardRoutes.Home,component:(0,Bs.A)(()=>Promise.all([e.e(9569),e.e(660),e.e(6263),e.e(9136)]).then(e.bind(e,77709)))},{path:"/d/:uid/:slug?",pageClass:"page-dashboard",routeName:wn.DashboardRoutes.Normal,component:(0,Bs.A)(()=>Promise.all([e.e(9569),e.e(660),e.e(6263),e.e(9136)]).then(e.bind(e,77709)))},{path:"/dashboard/new",roles:()=>ir.TP.evaluatePermission([wn.AccessControlAction.DashboardsCreate]),pageClass:"page-dashboard",routeName:wn.DashboardRoutes.New,component:(0,Bs.A)(()=>Promise.all([e.e(9569),e.e(660),e.e(6263),e.e(9136),e.e(2976)]).then(e.bind(e,77709)))},{path:"/dashboard/new-with-ds/:datasourceUid",roles:()=>ir.TP.evaluatePermission([wn.AccessControlAction.DashboardsCreate]),component:(0,Bs.A)(()=>Promise.all([e.e(9569),e.e(660),e.e(6263),e.e(9136),e.e(2976)]).then(e.bind(e,30798)))},{path:"/dashboard/:type/:slug",pageClass:"page-dashboard",routeName:wn.DashboardRoutes.Normal,component:(0,Bs.A)(()=>Promise.all([e.e(9569),e.e(660),e.e(6263),e.e(9136),e.e(2976)]).then(e.bind(e,77709)))},{path:"/dashboards/embedding-test",component:(0,Bs.A)(()=>Promise.all([e.e(9569),e.e(660),e.e(6263),e.e(9136),e.e(2976)]).then(e.bind(e,14962)))},{path:"/d-solo/:uid/:slug?",routeName:wn.DashboardRoutes.Normal,chromeless:!0,component:(0,Bs.A)(()=>J.Ay.featureToggles.dashboardSceneSolo?Promise.all([e.e(9569),e.e(7849)]).then(e.bind(e,24880)):Promise.all([e.e(9569),e.e(4492)]).then(e.bind(e,55087)))},{path:"/dashboard-solo/:type/:slug",routeName:wn.DashboardRoutes.Normal,chromeless:!0,component:(0,Bs.A)(()=>Promise.all([e.e(9569),e.e(7849)]).then(e.bind(e,55087)))},{path:"/dashboard/import",component:(0,Bs.A)(()=>e.e(2550).then(e.bind(e,23390)))},{path:tl.I.List,component:()=>(0,j.jsx)(qa.rd,{to:el.b.DataSources})},{path:tl.I.Edit,component:W=>(0,j.jsx)(qa.rd,{to:el.b.DataSourcesEdit.replace(":uid",W.match.params.uid)})},{path:tl.I.Dashboards,component:W=>(0,j.jsx)(qa.rd,{to:el.b.DataSourcesDashboards.replace(":uid",W.match.params.uid)})},{path:tl.I.New,component:()=>(0,j.jsx)(qa.rd,{to:el.b.DataSourcesNew})},{path:"/datasources/correlations",component:(0,Bs.A)(()=>J.Ay.featureToggles.correlations?e.e(9981).then(e.bind(e,32429)):e.e(8014).then(e.bind(e,55244)))},{path:"/dashboards",component:(0,Bs.A)(()=>Promise.all([e.e(6359),e.e(152)]).then(e.bind(e,2471)))},{path:"/dashboards/f/:uid/:slug",component:(0,Bs.A)(()=>Promise.all([e.e(6359),e.e(152)]).then(e.bind(e,2471)))},{path:"/dashboards/f/:uid",component:(0,Bs.A)(()=>Promise.all([e.e(6359),e.e(152)]).then(e.bind(e,2471)))},{path:"/explore",pageClass:"page-explore",roles:()=>ir.TP.evaluatePermission([wn.AccessControlAction.DataSourcesExplore]),component:(0,Bs.A)(()=>J.Ay.exploreEnabled?Promise.all([e.e(660),e.e(1698),e.e(5511),e.e(9604)]).then(e.bind(e,46277)):e.e(4422).then(e.bind(e,53518)))},{path:"/apps",component:()=>(0,j.jsx)(_o,{navId:"apps"})},{path:"/alerts-and-incidents",component:()=>(0,j.jsx)(_o,{navId:"alerts-and-incidents",header:!(0,Dc.y$)()&&(0,Dc.qc)()||(0,Dc.ES)()?(0,j.jsx)(Yh,{}):void 0})},{path:"/testing-and-synthetics",component:()=>(0,j.jsx)(_o,{navId:"testing-and-synthetics"})},{path:"/monitoring",component:()=>(0,j.jsx)(_o,{navId:"monitoring"})},{path:"/infrastructure",component:()=>(0,j.jsx)(_o,{navId:"infrastructure"})},{path:"/frontend",component:()=>(0,j.jsx)(_o,{navId:"frontend"})},{path:"/admin/general",component:()=>(0,j.jsx)(_o,{navId:"cfg/general"})},{path:"/admin/plugins",component:()=>(0,j.jsx)(_o,{navId:"cfg/plugins"})},{path:"/admin/access",component:()=>(0,j.jsx)(_o,{navId:"cfg/access"})},{path:"/org",component:(0,Bs.A)(()=>e.e(1510).then(e.bind(e,69047)))},{path:"/org/new",component:(0,Bs.A)(()=>e.e(7930).then(e.bind(e,25913)))},{path:"/org/users",component:()=>(0,j.jsx)(qa.rd,{to:"/admin/users"})},{path:"/org/users/invite",component:(0,Bs.A)(()=>e.e(7720).then(e.bind(e,91230)))},{path:"/org/apikeys",roles:()=>ir.TP.evaluatePermission([wn.AccessControlAction.ActionAPIKeysRead]),component:(0,Bs.A)(()=>e.e(4196).then(e.bind(e,9699)))},{path:"/org/serviceaccounts",roles:()=>ir.TP.evaluatePermission([wn.AccessControlAction.ServiceAccountsRead,wn.AccessControlAction.ServiceAccountsCreate]),component:(0,Bs.A)(()=>e.e(6777).then(e.bind(e,23645)))},{path:"/org/serviceaccounts/create",component:(0,Bs.A)(()=>e.e(4176).then(e.bind(e,63606)))},{path:"/org/serviceaccounts/:id",component:(0,Bs.A)(()=>e.e(6576).then(e.bind(e,82936)))},{path:"/org/teams",roles:()=>ir.TP.evaluatePermission([wn.AccessControlAction.ActionTeamsRead,wn.AccessControlAction.ActionTeamsCreate]),component:(0,Bs.A)(()=>e.e(1036).then(e.bind(e,52576)))},{path:"/org/teams/new",roles:()=>ir.TP.evaluatePermission([wn.AccessControlAction.ActionTeamsCreate]),component:(0,Bs.A)(()=>e.e(5436).then(e.bind(e,80011)))},{path:"/org/teams/edit/:id/:page?",roles:()=>ir.TP.evaluatePermission([wn.AccessControlAction.ActionTeamsRead,wn.AccessControlAction.ActionTeamsCreate]),component:(0,Bs.A)(()=>e.e(2212).then(e.bind(e,92886)))},{path:"/admin",component:()=>(0,j.jsx)(_o,{navId:"cfg",header:(0,j.jsx)(Eh,{})})},{path:"/admin/authentication",roles:()=>ir.TP.evaluatePermission([wn.AccessControlAction.SettingsWrite]),component:J.Ay.licenseInfo.enabledFeatures?.saml||J.Ay.ldapEnabled||J.Ay.featureToggles.ssoSettingsApi?(0,Bs.A)(()=>e.e(5592).then(e.bind(e,51332))):()=>(0,j.jsx)(qa.rd,{to:"/admin"})},{path:"/admin/authentication/ldap",component:vh},{path:"/admin/authentication/:provider",roles:()=>ir.TP.evaluatePermission([wn.AccessControlAction.SettingsWrite]),component:J.Ay.featureToggles.ssoSettingsApi?(0,Bs.A)(()=>e.e(5592).then(e.bind(e,22468))):()=>(0,j.jsx)(qa.rd,{to:"/admin"})},{path:"/admin/settings",component:(0,Bs.A)(()=>e.e(7659).then(e.bind(e,98493)))},{path:"/admin/upgrading",component:(0,Bs.A)(()=>e.e(5356).then(e.bind(e,55356)))},{path:"/admin/users",component:(0,Bs.A)(()=>e.e(1743).then(e.bind(e,21807)))},{path:"/admin/users/create",component:(0,Bs.A)(()=>e.e(9239).then(e.bind(e,64665)))},{path:"/admin/users/edit/:id",component:dh},{path:"/admin/orgs",component:(0,Bs.A)(()=>e.e(9736).then(e.bind(e,24870)))},{path:"/admin/orgs/edit/:id",component:(0,Bs.A)(()=>e.e(9119).then(e.bind(e,57582)))},{path:"/admin/featuretoggles",component:J.Ay.featureToggles.featureToggleAdminPage?(0,Bs.A)(()=>e.e(7024).then(e.bind(e,47295))):()=>(0,j.jsx)(qa.rd,{to:"/admin"})},{path:"/admin/storage/:path*",roles:()=>["Admin"],component:(0,Bs.A)(()=>e.e(1927).then(e.bind(e,68932)))},{path:"/admin/stats",component:(0,Bs.A)(()=>e.e(9299).then(e.bind(e,51372)))},J.Ay.featureToggles.onPremToCloudMigrations&&{path:"/admin/migrate-to-cloud",roles:()=>["Admin"],component:(0,Bs.A)(()=>e.e(3704).then(e.bind(e,76491)))},{path:"/login",component:zu,pageClass:"login-page",chromeless:!0},{path:"/invite/:code",component:(0,Bs.A)(()=>e.e(8576).then(e.bind(e,14383))),chromeless:!0},{path:"/verify",component:J.Ay.verifyEmailEnabled?(0,Bs.A)(()=>e.e(8786).then(e.bind(e,78786))):()=>(0,j.jsx)(qa.rd,{to:"/signup"}),pageClass:"login-page",chromeless:!0},{path:"/signup",component:J.Ay.disableUserSignUp?()=>(0,j.jsx)(qa.rd,{to:"/login"}):(0,Bs.A)(()=>e.e(7914).then(e.bind(e,27914))),pageClass:"login-page",chromeless:!0},{path:"/user/password/send-reset-email",chromeless:!0,component:(0,Bs.A)(()=>e.e(3818).then(e.bind(e,2713)))},{path:"/user/password/reset",component:(0,Bs.A)(()=>e.e(641).then(e.bind(e,37344))),pageClass:"login-page",chromeless:!0},{path:"/dashboard/snapshots",component:(0,Bs.A)(()=>e.e(6590).then(e.bind(e,72602)))},J.Ay.featureToggles.dashboardRestoreUI&&{path:"/dashboard/recently-deleted",roles:()=>["Admin"],component:(0,Bs.A)(()=>Promise.all([e.e(6359),e.e(6299)]).then(e.bind(e,10421)))},{path:"/playlists",component:(0,Bs.A)(()=>e.e(1168).then(e.bind(e,44450)))},{path:"/playlists/play/:uid",component:(0,Bs.A)(()=>e.e(1374).then(e.bind(e,93129)))},{path:"/playlists/new",component:(0,Bs.A)(()=>e.e(7616).then(e.bind(e,62579)))},{path:"/playlists/edit/:uid",component:(0,Bs.A)(()=>e.e(7620).then(e.bind(e,84535)))},{path:"/sandbox/benchmarks",component:(0,Bs.A)(()=>e.e(9354).then(e.bind(e,98351)))},{path:"/sandbox/test",component:(0,Bs.A)(()=>e.e(5354).then(e.bind(e,65802)))},{path:"/dashboards/f/:uid/:slug/library-panels",component:(0,Bs.A)(()=>e.e(5804).then(e.bind(e,15111)))},{path:"/dashboards/f/:uid/:slug/alerting",roles:()=>ir.TP.evaluatePermission([wn.AccessControlAction.AlertingRuleRead]),component:(0,Bs.A)(()=>e.e(4333).then(e.bind(e,30027)))},{path:"/library-panels",component:(0,Bs.A)(()=>e.e(8516).then(e.bind(e,45434)))},{path:"/notifications",component:(0,Bs.A)(()=>e.e(4140).then(e.bind(e,78015)))},J.Ay.featureToggles.exploreMetrics&&{path:"/explore/metrics",chromeless:!1,exact:!1,roles:()=>ir.TP.evaluatePermission([wn.AccessControlAction.DataSourcesExplore]),component:(0,Bs.A)(()=>e.e(4785).then(e.bind(e,89858)))},{path:"/bookmarks",component:()=>(0,j.jsx)(ec,{})},...Ud(),...ff(),...yh(),...Cp(),...Gd,...tc(),...Dh(),{path:"/*",component:Gu}].filter(_r.zz)}function ff(W=J.Ay){return W.supportBundlesEnabled?[{path:"/support-bundles",component:(0,Bs.A)(()=>e.e(123).then(e.bind(e,21821)))},{path:"/support-bundles/create",component:(0,Bs.A)(()=>e.e(1515).then(e.bind(e,33809)))}]:[]}const Qd=(0,l.forwardRef)((W,_)=>(0,j.jsx)("div",{id:"ngRoot",ref:_,dangerouslySetInnerHTML:{__html:"<grafana-app ng-cloak></grafana-app>"}}));Qd.displayName="AngularRoot";var yi=e(95344),gf=e(7376),no=e(81634),qo=e(74856),Op=e(71500),bl=e(6923);async function Yd(){if(ae.$.angularSupportEnabled){const{AngularApp:W}=await Promise.all([e.e(9362),e.e(7808),e.e(8888)]).then(e.bind(e,27808)),_=new W;_.init(),_.bootstrap()}else(0,gf.w)({load:(W,_,G)=>({destroy:()=>{},digest:()=>{},getScope:()=>({})})}),(0,no.j)({get:W=>{switch(W){case"backendSrv":return(0,yi.l)("getLegacyAngularInjector","backendSrv","use getBackendSrv() in @grafana/runtime"),(0,M.AI)();case"contextSrv":return(0,yi.l)("getLegacyAngularInjector","contextSrv"),Wa.TP;case"dashboardSrv":return(0,yi.l)("getLegacyAngularInjector","getDashboardSrv"),(0,h.UA)();case"datasourceSrv":return(0,yi.l)("getLegacyAngularInjector","datasourceSrv","use getDataSourceSrv() in @grafana/runtime"),(0,N.l)();case"linkSrv":return(0,yi.l)("getLegacyAngularInjector","linkSrv"),(0,bl.mQ)();case"validationSrv":return(0,yi.l)("getLegacyAngularInjector","validationSrv"),Op.P;case"timeSrv":return(0,yi.l)("getLegacyAngularInjector","timeSrv"),(0,qo.jG)();case"templateSrv":return(0,yi.l)("getLegacyAngularInjector","templateSrv","use getTemplateSrv() in @grafana/runtime"),(0,je.w)()}throw"Angular is disabled.  Unable to expose: "+W}})}var pf=e(46942),Jd=e.n(pf),Cl=e(60619),xi=e(33390),Xd=e(18828),Zd=e(85690),qd=e(93225),mf=e(57514),eu=e(65178),vf=e(35822);const nc=0,yf=W=>{const _=l.useRef(null),G=l.useRef(null),de=l.useRef(W.items);de.current=W.items;const xe=(0,vf.useVirtual)({size:de.current.length,parentRef:G}),{query:Me,search:we,currentRootActionId:ke,activeIndex:Xe,options:ht}=(0,Vs.useKBar)(Rt=>({search:Rt.searchQuery,currentRootActionId:Rt.currentRootActionId,activeIndex:Rt.activeIndex}));l.useEffect(()=>{const Rt=Ct=>{Ct.key==="ArrowUp"||Ct.ctrlKey&&Ct.key==="p"?(Ct.preventDefault(),Me.setActiveIndex(Ut=>{let hn=Ut>nc?Ut-1:Ut;if(typeof de.current[hn]=="string"){if(hn===0)return Ut;hn-=1}return hn})):Ct.key==="ArrowDown"||Ct.ctrlKey&&Ct.key==="n"?(Ct.preventDefault(),Me.setActiveIndex(Ut=>{let hn=Ut<de.current.length-1?Ut+1:Ut;if(typeof de.current[hn]=="string"){if(hn===de.current.length-1)return Ut;hn+=1}return hn})):Ct.key==="Enter"&&(Ct.preventDefault(),_.current?.click())};return window.addEventListener("keydown",Rt),()=>window.removeEventListener("keydown",Rt)},[Me]);const{scrollToIndex:mt}=xe;l.useEffect(()=>{mt(Xe,{align:Xe<=1?"end":"auto"})},[Xe,mt]),l.useEffect(()=>{Me.setActiveIndex(typeof W.items[nc]=="string"?nc+1:nc)},[we,ke,W.items,Me]);const bt=l.useCallback((Rt,Ct)=>{if(typeof Ct=="string")return;const Ut=Ct.url;Ct.command?(Ct.command.perform(Ct),Me.toggle()):Ut?Rt.ctrlKey||Rt.metaKey||Rt.shiftKey||Me.toggle():(Me.setSearch(""),Me.setCurrentRootAction(Ct.id)),ht.callbacks?.onSelectAction?.(Ct)},[Me,ht]),Kt=(0,eu.usePointerMovedSinceMount)();return(0,j.jsx)("div",{ref:G,style:{maxHeight:W.maxHeight||400,position:"relative",overflow:"auto"},children:(0,j.jsx)("div",{role:"listbox",id:Vs.KBAR_LISTBOX,style:{height:`${xe.totalSize}px`,width:"100%"},children:xe.virtualItems.map(Rt=>{const Ct=de.current[Rt.index],{target:Ut,url:hn}=Ct,Zn=typeof Ct!="string"&&{onPointerMove:()=>Kt&&Xe!==Rt.index&&Me.setActiveIndex(Rt.index),onPointerDown:()=>Me.setActiveIndex(Rt.index),onClick:Ar=>bt(Ar,Ct)},As=Rt.index===Xe,Ds={id:(0,Vs.getListboxItemId)(Rt.index),role:"option","aria-selected":As,style:{position:"absolute",top:0,left:0,width:"100%",transform:`translateY(${Rt.start}px)`},...Zn},Fs=l.cloneElement(W.onRender({item:Ct,active:As}),{ref:Rt.measureRef});return hn?(0,j.jsx)("a",{href:typeof hn=="function"?hn(we):hn,target:Ut,ref:As?_:null,...Ds,children:Fs},Rt.index):(0,j.jsx)("div",{ref:As?_:null,...Ds,children:Fs},Rt.index)})})})},tu=l.forwardRef(({action:W,active:_,currentRootActionId:G},de)=>{const xe=l.useMemo(()=>{if(!G)return W.ancestors;const Xe=W.ancestors.findIndex(ht=>ht.id===G);return W.ancestors.slice(Xe+1)},[W.ancestors,G]),Me=(0,pt.of)(xf);let we=W.name;const ke=Xe=>!!(Xe.command?.perform||Xe.url);return W.children.length&&!ke(W)&&!we.endsWith("...")&&(we+="..."),(0,j.jsx)("div",{ref:de,className:(0,Qe.cx)(Me.row,_&&Me.activeRow),children:(0,j.jsxs)("div",{className:Me.actionContainer,children:[W.icon,(0,j.jsxs)("div",{className:Me.textContainer,children:[xe.map(Xe=>(0,j.jsx)(l.Fragment,{children:!ke(Xe)&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("span",{className:Me.breadcrumbAncestor,children:Xe.name}),(0,j.jsx)("span",{className:Me.breadcrumbSeparator,children:"\u203A"})]})},Xe.id)),(0,j.jsx)("span",{children:we})]}),W.subtitle&&(0,j.jsx)("span",{className:Me.subtitleText,children:W.subtitle})]})})});tu.displayName="ResultItem";const xf=W=>({row:(0,Qe.css)({padding:W.spacing(1,2),display:"flex",alightItems:"center",justifyContent:"space-between",cursor:"pointer",position:"relative",borderRadius:W.shape.radius.default,margin:W.spacing(0,1)}),activeRow:(0,Qe.css)({color:W.colors.text.maxContrast,background:W.colors.emphasize(W.colors.background.primary,.03),"&:before":{display:"block",content:'" "',position:"absolute",left:0,top:0,bottom:0,width:W.spacing(.5),borderRadius:W.shape.radius.default,backgroundImage:W.colors.gradients.brandVertical}}),actionContainer:(0,Qe.css)({display:"flex",gap:W.spacing(1),alignItems:"baseline",fontSize:W.typography.fontSize,width:"100%"}),textContainer:(0,Qe.css)({display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}),breadcrumbAncestor:(0,Qe.css)({color:W.colors.text.secondary}),breadcrumbSeparator:(0,Qe.css)({color:W.colors.text.secondary,marginLeft:W.spacing(1),marginRight:W.spacing(1)}),subtitleText:(0,Qe.css)({...W.typography.bodySmall,color:W.colors.text.secondary,display:"block",flexBasis:"20%",flexGrow:1,flexShrink:0,maxWidth:"fit-content",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"})});var Uc=e(76459),Ef=e.n(Uc),Df=e(62301),nu=e(24439);const Pf=6,bf=5,Cf=4,Nc=3,Tf=2,Mf=1,wc=100,su=5,Sf=Ef()(au,200);async function Wc(){if(!ir.TP.user.isSignedIn)return[];const W=(await Df.A.getDashboardOpened()).slice(0,su),G=(await(0,nu.getGrafanaSearcher)().search({kind:["dashboard"],limit:su,uid:W})).view.toArray();return G.sort((xe,Me)=>{const we=W.indexOf(xe.uid),ke=W.indexOf(Me.uid);return we-ke}),G.map(xe=>{const{url:Me,name:we}=xe;return{id:`recent-dashboards${Me}`,name:`${we}`,section:(0,aa.t)("command-palette.section.recent-dashboards","Recent dashboards"),priority:Pf,url:Me}})}async function au(W){if(W.length===0||!ir.TP.user.isSignedIn&&!ae.$.bootData.settings.anonymousEnabled)return[];const _=await(0,nu.getGrafanaSearcher)().search({kind:["dashboard","folder"],query:W,limit:wc});return _.view.map(de=>{const{url:xe,name:Me,kind:we,location:ke}=de;return{id:`go/${we}${xe}`,name:`${Me}`,section:we==="dashboard"?(0,aa.t)("command-palette.section.dashboard-search-results","Dashboards"):(0,aa.t)("command-palette.section.folder-search-results","Folders"),priority:Mf,url:xe,subtitle:_.view.dataFrame.meta?.custom?.locationInfo[ke]?.name}})}function Of(W,_){const[G,de]=(0,l.useState)([]),[xe,Me]=(0,l.useState)(!1),we=(0,l.useRef)(0);return(0,l.useEffect)(()=>{const ke=Date.now();_&&W.length>0?(Me(!0),Sf(W).then(Xe=>{ke>we.current&&(de(Xe),Me(!1),we.current=ke)})):(de([]),Me(!1),we.current=ke)},[_,W]),{searchResults:G,isFetchingSearchResults:xe}}var sl=e(2769);function ru(W){return"navModel."+W.id}function ou(W,_=[]){const G=[];for(let de of W){de.id==="help"&&(de=zd({...de}),delete de.url);const{url:xe,target:Me,text:we,isCreateAction:ke,children:Xe,onClick:ht,keywords:mt}=de,bt=!!Xe?.length;if(!(xe||ht||bt))continue;let Kt=xe;xe&&(de.id==="connections-add-new-connection"||de.id==="standalone-plugin-page-/connections/add-new-connection")&&(Kt=Zn=>{const As=mt?.find(Ds=>Ds.toLowerCase().includes(Zn.toLowerCase()));return As?`${xe}?search=${As}`:xe});const Rt=ke?(0,aa.t)("command-palette.section.actions","Actions"):(0,aa.t)("command-palette.section.pages","Pages"),Ct=ke?bf:Cf,Ut=_.map(Zn=>Zn.text).join(" > "),hn={id:ru(de),name:we,section:Rt,url:Kt,target:Me,parent:_.length>0&&!ke?ru(_[_.length-1]):void 0,perform:ht,keywords:mt?.join(" "),priority:Ct,subtitle:ke?void 0:Ut};if(G.push(hn),Xe?.length){const Zn=ou(Xe,[..._,de]);G.push(...Zn)}}return G}const iu=(W,_)=>{const G=[{id:"preferences/theme",name:(0,aa.t)("command-palette.action.change-theme","Change theme..."),keywords:"interface color dark light",section:(0,aa.t)("command-palette.section.preferences","Preferences"),priority:Nc},{id:"preferences/dark-theme",name:(0,aa.t)("command-palette.action.dark-theme","Dark"),keywords:"dark theme",perform:()=>(0,sl.K)("dark"),parent:"preferences/theme",priority:Nc},{id:"preferences/light-theme",name:(0,aa.t)("command-palette.action.light-theme","Light"),keywords:"light theme",perform:()=>(0,sl.K)("light"),parent:"preferences/theme",priority:Nc}],de=ou(W);return[...G,..._,...de]};var Tl=e(74135);const If={};function Af(){const{extensions:W}=(0,w.vl)({extensionPointId:Tl.S.CommandPalette,context:If,limitPerPlugin:3});return(0,l.useMemo)(()=>W.map(_=>({section:_.category??"Extensions",priority:Tf,id:_.id,name:_.title,target:_.path,perform:()=>_.onClick&&_.onClick()})),[W])}function Rf(W){const[_,G]=(0,l.useState)([]),[de,xe]=(0,l.useState)([]),Me=Af(),we=(0,wn.useSelector)(ke=>ke.navBarTree);return(0,l.useEffect)(()=>{const ke=iu(we,Me);G(ke)},[we,Me]),(0,l.useEffect)(()=>{W||Wc().then(ke=>xe(ke)).catch(ke=>{console.error("Error loading recent dashboard actions",ke)})},[W]),W?_:[...de,..._]}var Lf=e(53076);const Fc={name:"none",priority:Vs.Priority.NORMAL};function Kc(W,_){return _.priority-W.priority}function jf(){const{search:W,actions:_,rootActionId:G}=(0,Vs.useKBar)(mt=>({search:mt.searchQuery,actions:mt.actions,rootActionId:mt.currentRootActionId})),de=l.useMemo(()=>Object.keys(_).reduce((mt,bt)=>{const Kt=_[bt];if(!Kt.parent&&!G&&mt.push(Kt),Kt.id===G)for(let Rt=0;Rt<Kt.children.length;Rt++)mt.push(Kt.children[Rt]);return mt},[]).sort(Kc),[_,G]),xe=l.useCallback(mt=>{let bt=[];for(let Kt=0;Kt<mt.length;Kt++)bt.push(mt[Kt]);return function Kt(Rt,Ct=bt){for(let Ut=0;Ut<Rt.length;Ut++)if(Rt[Ut].children.length>0){let hn=Rt[Ut].children;for(let Zn=0;Zn<hn.length;Zn++)Ct.push(hn[Zn]);Kt(Rt[Ut].children,Ct)}return Ct}(mt)},[]),Me=!W,we=l.useMemo(()=>Me?de:xe(de),[xe,de,Me]),ke=Bf(we,W),Xe=l.useMemo(()=>{let mt={},bt=[],Kt=[];for(let Ct=0;Ct<ke.length;Ct++){const Ut=ke[Ct],hn=Ut.action,Zn=Ut.score||Vs.Priority.NORMAL,As={name:typeof hn.section=="string"?hn.section:hn.section?.name||Fc.name,priority:typeof hn.section=="string"?Zn:hn.section?.priority||0+Zn};mt[As.name]||(mt[As.name]=[],bt.push(As)),mt[As.name].push({priority:hn.priority+Zn,action:hn})}Kt=bt.sort(Kc).map(Ct=>({name:Ct.name,actions:mt[Ct.name].sort(Kc).map(Ut=>Ut.action)}));let Rt=[];for(let Ct=0;Ct<Kt.length;Ct++){let Ut=Kt[Ct];Ut.name!==Fc.name&&Rt.push(Ut.name);for(let hn=0;hn<Ut.actions.length;hn++)Rt.push(Ut.actions[hn])}return Rt},[ke]),ht=l.useMemo(()=>G,[Xe]);return l.useMemo(()=>({results:Xe,rootActionId:ht}),[ht,Xe])}function Bf(W,_){const G=Nf(),de=l.useMemo(()=>({filtered:W,search:_}),[W,_]),{filtered:xe,search:Me}=(0,eu.useThrottledValue)(de);return l.useMemo(()=>{if(Me.trim()==="")return xe.map(Xe=>({score:0,action:Xe}));const we=xe.map(({name:Xe,keywords:ht})=>`${Xe} ${ht??""}`.toLowerCase()),ke=[];if(Me.length>Uf){const Xe=Me.toLowerCase();for(let ht=0;ht<we.length;ht++){const bt=we[ht].indexOf(Xe);if(bt>-1){const Kt=bt*-1,Rt=xe[ht];ke.push({score:Kt,action:Rt})}}}else{const Xe=G.split(Me).length,ht=1/0,mt=Xe<5?4:0,[,bt,Kt]=G.search(we,Me,mt,ht);if(bt&&Kt)for(let Rt=0;Rt<Kt.length;Rt++){const Ct=Kt[Rt],Ut=Kt.length-Rt,hn=xe[bt.idx[Ct]];ke.push({score:Ut,action:hn})}}return ke},[xe,Me,G])}const Uf=25;function Nf(){const W=l.useRef();return W.current||(W.current=new Lf.A({intraMode:0,intraIns:0})),W.current}function wf(){const W=(0,pt.of)(lu),{query:_,showing:G,searchQuery:de}=(0,Vs.useKBar)(mt=>({showing:mt.visualState===Vs.VisualState.showing,searchQuery:mt.searchQuery})),xe=Rf(de);(0,Vs.useRegisterActions)(xe,[xe]);const{searchResults:Me,isFetchingSearchResults:we}=Of(de,G),ke=(0,l.useRef)(null),{overlayProps:Xe}=(0,qd.e)({isOpen:G,onClose:()=>_.setVisualState(Vs.VisualState.animatingOut)},ke),{dialogProps:ht}=(0,Xd.s)({},ke);return(0,l.useEffect)(()=>{G&&(0,Vr.rR)("command_palette_opened")},[G]),xe.length>0?(0,j.jsx)(Vs.KBarPortal,{children:(0,j.jsx)(Vs.KBarPositioner,{className:W.positioner,children:(0,j.jsx)(Vs.KBarAnimator,{className:W.animator,children:(0,j.jsx)(Zd.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,j.jsxs)("div",{...Xe,...ht,children:[(0,j.jsxs)("div",{className:W.searchContainer,children:[(0,j.jsx)(Is.I,{name:"search",size:"md"}),(0,j.jsx)(Vs.KBarSearch,{defaultPlaceholder:(0,aa.t)("command-palette.search-box.placeholder","Search or jump to..."),className:W.search}),(0,j.jsx)("div",{className:W.loadingBarContainer,children:we&&(0,j.jsx)(mf.G,{width:500,delay:0})})]}),(0,j.jsx)("div",{className:W.resultsContainer,children:(0,j.jsx)(Wf,{isFetchingSearchResults:we,searchResults:Me})})]})})})})}):null}const Wf=({isFetchingSearchResults:W,searchResults:_})=>{const{results:G,rootActionId:de}=jf(),xe=(0,pt.of)(lu),Me=(0,aa.t)("command-palette.section.dashboard-search-results","Dashboards"),we=(0,aa.t)("command-palette.section.folder-search-results","Folders"),ke=(0,l.useMemo)(()=>_.filter(bt=>bt.id.startsWith("go/dashboard")).map(bt=>new Vs.ActionImpl(bt,{store:{}})),[_]),Xe=(0,l.useMemo)(()=>_.filter(bt=>bt.id.startsWith("go/folder")).map(bt=>new Vs.ActionImpl(bt,{store:{}})),[_]),ht=(0,l.useMemo)(()=>{const bt=[...G];return Xe.length>0&&(bt.push(we),bt.push(...Xe)),ke.length>0&&(bt.push(Me),bt.push(...ke)),bt},[G,Me,ke,we,Xe]);return!W&&ht.length===0?(0,j.jsx)(jc.p,{variant:"not-found",role:"alert",message:(0,aa.t)("command-palette.empty-state.message","No results found")}):(0,j.jsx)(yf,{items:ht,maxHeight:650,onRender:({item:bt,active:Kt})=>{const Rt=ht[0]===bt;return typeof bt=="string"?(0,j.jsx)("div",{className:(0,Qe.cx)(xe.sectionHeader,Rt&&xe.sectionHeaderFirst),children:bt}):(0,j.jsx)(tu,{action:bt,active:Kt,currentRootActionId:de})}})},lu=W=>({positioner:(0,Qe.css)({zIndex:W.zIndex.portal,marginTop:"0px",paddingTop:"4px !important","&::before":{content:'""',position:"fixed",top:0,right:0,bottom:0,left:0,background:W.components.overlay.background,backdropFilter:"blur(1px)"}}),animator:(0,Qe.css)({maxWidth:W.breakpoints.values.md,width:"100%",background:W.colors.background.primary,color:W.colors.text.primary,borderRadius:W.shape.radius.default,border:`1px solid ${W.colors.border.weak}`,overflow:"hidden",boxShadow:W.shadows.z3}),loadingBarContainer:(0,Qe.css)({position:"absolute",left:0,right:0,bottom:0}),searchContainer:(0,Qe.css)({alignItems:"center",background:W.components.input.background,borderBottom:`1px solid ${W.colors.border.weak}`,display:"flex",gap:W.spacing(1),padding:W.spacing(1,2),position:"relative"}),search:(0,Qe.css)({fontSize:W.typography.fontSize,width:"100%",boxSizing:"border-box",outline:"none",border:"none",color:W.components.input.text}),spinner:(0,Qe.css)({height:"22px"}),resultsContainer:(0,Qe.css)({paddingBottom:W.spacing(1)}),sectionHeader:(0,Qe.css)({padding:W.spacing(1.5,2,2,2),fontSize:W.typography.bodySmall.fontSize,fontWeight:W.typography.fontWeightMedium,color:W.colors.text.secondary,borderTop:`1px solid ${W.colors.border.weak}`,marginTop:W.spacing(1)}),sectionHeaderFirst:(0,Qe.css)({paddingBottom:W.spacing(1),borderTop:"none",marginTop:0})});var Ff=e(59875),cu=e(86634),Kf=e(40276),du=e(91219),Ip=e(78685),Ap=e(8887),Rp=e(18759);const Lp=({children:W})=>{const _=(0,pt.of)(jp);return(0,j.jsxs)(j.Fragment,{children:[W,(0,j.jsx)("span",{className:_.highlight})]})},jp=W=>({highlight:(0,Qe.css)({backgroundColor:W.colors.success.main,borderRadius:W.shape.radius.circle,width:"6px",height:"6px",display:"inline-block;",position:"absolute",top:"50%",transform:"translateY(-50%)"})});var Bp=e(50720);function $f({children:W,isActive:_,onClick:G,target:de,url:xe,onPin:Me,isPinned:we}){const ke=(0,pt.$j)(),Xe=Up(ke,_),ht=!de&&xe.startsWith("/")?Bp.N:"a",mt=(0,j.jsxs)("div",{className:Xe.linkContent,children:[W,de==="_blank"&&(0,j.jsx)(Is.I,{"data-testid":"external-link-icon",name:"external-link-alt"})]});return(0,j.jsxs)("div",{className:(0,Qe.cx)(Xe.wrapper,{[Xe.wrapperActive]:_,[Xe.wrapperBookmark]:ae.$.featureToggles.pinNavItems}),children:[(0,j.jsx)(ht,{"data-testid":rr.Tp.components.NavMenu.item,className:Xe.container,href:xe,target:de,onClick:G,..._&&{"aria-current":"page"},children:mt}),ae.$.featureToggles.pinNavItems&&xe&&xe!=="/bookmarks"&&(0,j.jsx)(Ta.K,{name:"bookmark",className:"pin-icon",iconType:we?"solid":"default",onClick:()=>Me(xe),"aria-label":we?(0,aa.t)("navigation.item.remove-bookmark","Remove from Bookmarks"):(0,aa.t)("navigation.item.add-bookmark","Add to Bookmarks")})]})}$f.displayName="MegaMenuItemText";const Up=(W,_)=>({wrapper:(0,Qe.css)({display:"flex",justifyContent:"space-between",width:"100%",height:"100%"}),wrapperBookmark:(0,Qe.css)({".pin-icon":{display:"none"},"&:hover, &:focus-within":{a:{width:"calc(100% - 20px)"},".pin-icon":{display:"inline-flex"}}}),wrapperActive:(0,Qe.css)({backgroundColor:W.colors.background.secondary,borderTopRightRadius:W.shape.radius.default,borderBottomRightRadius:W.shape.radius.default,position:"relative","&::before":{backgroundImage:W.colors.gradients.brandVertical,borderRadius:W.shape.radius.default,content:'" "',display:"block",height:"100%",position:"absolute",transform:"translateX(-50%)",width:W.spacing(.5)}}),container:(0,Qe.css)({alignItems:"center",color:_?W.colors.text.primary:W.colors.text.secondary,height:"100%",position:"relative",width:"100%","&:hover, &:focus-visible":{color:W.colors.text.primary,textDecoration:"underline"},"&:focus-visible":{boxShadow:"none",outline:`2px solid ${W.colors.primary.main}`,outlineOffset:"-2px",transition:"none"}}),linkContent:(0,Qe.css)({alignItems:"center",display:"flex",gap:"0.5rem",height:"100%",width:"100%",justifyContent:"space-between"})}),$c=2;function Vf({link:W,activeItem:_,level:G=0,onClick:de,onPin:xe,isPinned:Me}){const{chrome:we}=(0,Ro.Il)(),Xe=we.useState().megaMenuDocked,ht=(0,qa.zy)(),mt=W.highlightText?Lp:l.Fragment,bt=Hd(W,_),Kt=W===_||G===$c&&bt,[Rt,Ct]=(0,Ip.A)(`grafana.navigation.expanded[${W.text}]`,!!bt),Ut=G<$c&&!!(_f(W)||W.emptyMessage),hn=(0,l.useRef)(null),Zn=(0,pt.of)(Np);if((0,l.useEffect)(()=>{bt&&Ct(!0)},[bt,ht,Xe,Ct]),(0,l.useEffect)(()=>{Kt&&hn.current&&wp(hn.current)&&hn.current.scrollIntoView({block:"center"})},[Kt]),!W.url)return null;let As=null;return W.icon?As=(0,j.jsx)(Is.I,{className:Zn.icon,name:(0,Ap.Uo)(W.icon)??"link",size:"lg"}):W.img&&(As=(0,j.jsx)(on.B,{width:3,justifyContent:"center",children:(0,j.jsx)("img",{className:Zn.img,src:W.img,alt:""})})),(0,j.jsxs)("li",{ref:hn,className:Zn.listItem,children:[(0,j.jsxs)("div",{className:(0,Qe.cx)(Zn.menuItem,{[Zn.menuItemWithIcon]:!!(G===0&&As)}),children:[G!==0&&(0,j.jsx)(Rp.T,{level:G===$c?G-1:G,spacing:3}),G===$c&&(0,j.jsx)("div",{className:Zn.itemConnector}),(0,j.jsx)("div",{className:Zn.collapseButtonWrapper,children:Ut&&(0,j.jsx)(Ta.K,{"aria-label":`${Rt?"Collapse":"Expand"} section ${W.text}`,className:Zn.collapseButton,onClick:()=>Ct(!Rt),name:Rt?"angle-down":"angle-right",size:"md",variant:"secondary"})}),(0,j.jsx)("div",{className:Zn.collapsibleSectionWrapper,children:(0,j.jsx)($f,{isActive:Kt,onClick:()=>{W.onClick?.(),de?.()},target:W.target,url:W.url,onPin:()=>xe(W),isPinned:Me(W.url),children:(0,j.jsxs)("div",{className:(0,Qe.cx)(Zn.labelWrapper,{[Zn.hasActiveChild]:bt,[Zn.labelWrapperWithIcon]:!!(G===0&&As)}),children:[G===0&&As&&(0,j.jsx)(mt,{children:As}),(0,j.jsx)(Tr.E,{truncate:!0,children:W.text})]})})})]}),Ut&&Rt&&(0,j.jsx)("ul",{className:Zn.children,children:_f(W)?W.children.filter(Ds=>!Ds.isCreateAction).map(Ds=>(0,j.jsx)(Vf,{link:Ds,activeItem:_,onClick:de,level:G+1,onPin:xe,isPinned:Me},`${W.text}-${Ds.text}`)):(0,j.jsx)("div",{className:Zn.emptyMessage,"aria-live":"polite",children:W.emptyMessage})})]})}const Np=W=>({icon:(0,Qe.css)({width:W.spacing(3)}),img:(0,Qe.css)({height:W.spacing(2),width:W.spacing(2)}),listItem:(0,Qe.css)({flex:1,maxWidth:"100%"}),menuItem:(0,Qe.css)({display:"flex",alignItems:"center",gap:W.spacing(1),height:W.spacing(4),paddingLeft:W.spacing(.5),position:"relative"}),menuItemWithIcon:(0,Qe.css)({paddingLeft:W.spacing(0)}),collapseButtonWrapper:(0,Qe.css)({display:"flex",justifyContent:"center",width:W.spacing(3),flexShrink:0}),itemConnector:(0,Qe.css)({position:"relative",height:"100%",width:W.spacing(1.5),"&::before":{borderLeft:`1px solid ${W.colors.border.medium}`,content:'""',height:"100%",right:0,position:"absolute",transform:"translateX(50%)"}}),collapseButton:(0,Qe.css)({margin:0}),collapsibleSectionWrapper:(0,Qe.css)({alignItems:"center",display:"flex",flex:1,height:"100%",minWidth:0}),labelWrapper:(0,Qe.css)({display:"flex",alignItems:"center",gap:W.spacing(2),minWidth:0,paddingLeft:W.spacing(1)}),labelWrapperWithIcon:(0,Qe.css)({paddingLeft:W.spacing(.5)}),hasActiveChild:(0,Qe.css)({color:W.colors.text.primary}),children:(0,Qe.css)({display:"flex",listStyleType:"none",flexDirection:"column"}),emptyMessage:(0,Qe.css)({color:W.colors.text.secondary,fontStyle:"italic",padding:W.spacing(1,1.5,1,7)})});function _f(W){return!!(W.children&&W.children.length>0)}function wp(W){const _=W.getBoundingClientRect();return _.bottom<0||_.top>=window.innerHeight}const zf="300px",uu=(0,l.memo)((0,l.forwardRef)(({onClose:W,..._},G)=>{const de=(0,wn.useSelector)(hn=>hn.navBarTree),xe=(0,pt.of)(Wp),Me=(0,qa.zy)(),{chrome:we}=(0,Ro.Il)(),ke=(0,wn.useDispatch)(),Xe=we.useState(),[ht]=cf(),mt=Vd(),bt=de.filter(hn=>hn.id!=="profile"&&hn.id!=="help").map(hn=>Xl(hn,Xe.megaMenuDocked));if(ae.$.featureToggles.pinNavItems){const hn=ql(bt,"/bookmarks");hn&&(hn.children=mt.reduce((Zn,As)=>{const Ds=ql(bt,As);if(!Ds)return Zn;const Fs={id:Ds.id,text:Ds.text,url:Ds.url,parentItem:{id:"bookmarks",text:"Bookmarks"}};return Zn.push(Xl(Fs,Xe.megaMenuDocked)),Zn},[]))}const Kt=Zl(bt,Xe.sectionNav.node,Me.pathname),Rt=()=>{we.setMegaMenuDocked(!Xe.megaMenuDocked),Xe.megaMenuDocked&&we.setMegaMenuOpen(!1),setTimeout(()=>{document.getElementById(Xe.megaMenuDocked?"mega-menu-toggle":"dock-menu-button")?.focus()})},Ct=(0,l.useCallback)(hn=>!hn||!mt?.length?!1:mt?.includes(hn),[mt]),Ut=hn=>{const Zn=hn.url;if(Zn&&ae.$.featureToggles.pinNavItems){const As=Ct(Zn),Ds=As?mt.filter(Ar=>Zn!==Ar):[...mt,Zn],Fs=As?"grafana_nav_item_unpinned":"grafana_nav_item_pinned";(0,Vr.rR)(Fs,{path:Zn}),ht({patchPrefsCmd:{navbar:{bookmarkUrls:Ds}}}).then(Ar=>{Ar.error||ke((0,du.ve)({item:hn,isSaved:!As}))})}};return(0,j.jsxs)("div",{"data-testid":rr.Tp.components.NavMenu.Menu,ref:G,..._,children:[(0,j.jsxs)("div",{className:xe.mobileHeader,children:[(0,j.jsx)(Is.I,{name:"bars",size:"xl"}),(0,j.jsx)(Ta.K,{tooltip:(0,aa.t)("navigation.megamenu.close","Close menu"),name:"times",onClick:W,size:"xl",variant:"secondary"})]}),(0,j.jsx)("nav",{className:xe.content,children:(0,j.jsx)(Kf.E,{showScrollIndicators:!0,hideHorizontalTrack:!0,children:(0,j.jsx)("ul",{className:xe.itemList,"aria-label":(0,aa.t)("navigation.megamenu.list-label","Navigation"),children:bt.map((hn,Zn)=>(0,j.jsxs)(on.B,{direction:Zn===0?"row-reverse":"row",alignItems:"center",children:[Zn===0&&(0,j.jsx)(Ta.K,{id:"dock-menu-button",className:xe.dockMenuButton,tooltip:Xe.megaMenuDocked?(0,aa.t)("navigation.megamenu.undock","Undock menu"):(0,aa.t)("navigation.megamenu.dock","Dock menu"),name:"web-section-alt",onClick:Rt,variant:"secondary"}),(0,j.jsx)(Vf,{link:hn,isPinned:Ct,onClick:Xe.megaMenuDocked?void 0:W,activeItem:Kt,onPin:Ut})]},hn.text))})})})]})}));uu.displayName="MegaMenu";const Wp=W=>({content:(0,Qe.css)({display:"flex",flexDirection:"column",height:"100%",minHeight:0,position:"relative"}),mobileHeader:(0,Qe.css)({display:"flex",justifyContent:"space-between",padding:W.spacing(1,1,1,2),borderBottom:`1px solid ${W.colors.border.weak}`,[W.breakpoints.up("md")]:{display:"none"}}),itemList:(0,Qe.css)({boxSizing:"border-box",display:"flex",flexDirection:"column",listStyleType:"none",padding:W.spacing(1,1,2,1),[W.breakpoints.up("md")]:{width:zf}}),dockMenuButton:(0,Qe.css)({display:"none",[W.breakpoints.up("xl")]:{display:"inline-flex"}})});var Vc=e(13390),al=e(27746);function Fp({href:W,isCurrent:_,text:G,index:de,flexGrow:xe}){const Me=(0,pt.of)(Kp),we=()=>{(0,Vr.rR)("grafana_breadcrumb_clicked",{url:W})};return(0,j.jsx)("li",{className:Me.breadcrumbWrapper,style:{flexGrow:xe},children:_?(0,j.jsx)("span",{"data-testid":Vc.X.Breadcrumbs.breadcrumb(G),className:Me.breadcrumb,"aria-current":"page",title:G,children:G}):(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("a",{onClick:we,"data-testid":Vc.X.Breadcrumbs.breadcrumb(G),className:(0,Qe.cx)(Me.breadcrumb,Me.breadcrumbLink),title:G,href:W,children:G}),(0,j.jsx)("div",{className:Me.separator,"aria-hidden":!0,children:(0,j.jsx)(Is.I,{name:"angle-right"})})]})})}const Kp=W=>({breadcrumb:(0,Qe.css)({display:"block",textOverflow:"ellipsis",overflow:"hidden",padding:W.spacing(0,.5),whiteSpace:"nowrap",color:W.colors.text.secondary}),breadcrumbLink:(0,Qe.css)({color:W.colors.text.primary,"&:hover":{textDecoration:"underline"}}),breadcrumbWrapper:(0,Qe.css)({alignItems:"center",color:W.colors.text.primary,display:"flex",flex:1,minWidth:0,maxWidth:"max-content",[W.breakpoints.down("sm")]:{display:"none","&:nth-last-child(2)":{display:"flex",minWidth:"40px"},"&:last-child":{display:"flex"}}}),separator:(0,Qe.css)({color:W.colors.text.secondary})});function Hf({breadcrumbs:W,className:_}){const G=(0,pt.of)(sc);return(0,j.jsx)("nav",{"aria-label":"Breadcrumbs",className:_,children:(0,j.jsx)("ol",{className:G.breadcrumbs,children:W.map((de,xe)=>(0,l.createElement)(Fp,{...de,isCurrent:xe===W.length-1,key:xe,index:xe,flexGrow:Ml(xe,W.length)}))})})}function Ml(W,_){return _<5&&W>0&&W<_-2||_>6&&W>1&&W<_-3?4:10}const sc=W=>({breadcrumbs:(0,Qe.css)({display:"flex",alignItems:"center",flexWrap:"nowrap",overflow:"hidden"})});var kf=e(3984),ko=e(57571),hu=e(10804);const fu="mega-menu-toggle";function Gf({actions:W,searchBarHidden:_,sectionNav:G,pageNav:de,onToggleMegaMenu:xe,onToggleSearchBar:Me,onToggleKioskMode:we}){const{chrome:ke}=(0,Ro.Il)(),Xe=ke.useState(),ht=(0,wn.useSelector)(Kt=>Kt.navIndex)[Jl.Id],mt=(0,pt.of)(Qf),bt=(0,kf.Z)(G,de,ht);return(0,j.jsxs)("div",{"data-testid":Vc.X.NavToolbar.container,className:mt.pageToolbar,children:[(0,j.jsx)("div",{className:mt.menuButton,children:(0,j.jsx)(Ta.K,{id:fu,name:"bars",tooltip:Xe.megaMenuOpen?(0,aa.t)("navigation.toolbar.close-menu","Close menu"):(0,aa.t)("navigation.toolbar.open-menu","Open menu"),tooltipPlacement:"bottom",size:"xl",onClick:xe,"data-testid":Vc.X.NavBar.Toggle.button})}),(0,j.jsx)(Hf,{breadcrumbs:bt,className:mt.breadcrumbsWrapper}),(0,j.jsxs)("div",{className:mt.actions,children:[W,_&&(0,j.jsx)(al.I,{onClick:we,narrow:!0,title:(0,aa.t)("navigation.toolbar.enable-kiosk","Enable kiosk mode"),icon:"monitor"}),W&&(0,j.jsx)(hu.K,{}),(0,j.jsx)(al.I,{onClick:Me,narrow:!0,title:(0,aa.t)("navigation.toolbar.toggle-search-bar","Toggle top search bar"),children:(0,j.jsx)(Is.I,{name:_?"angle-down":"angle-up",size:"xl"})})]})]})}const Qf=W=>({breadcrumbsWrapper:(0,Qe.css)({display:"flex",overflow:"hidden",[W.breakpoints.down("sm")]:{minWidth:"50%"}}),pageToolbar:(0,Qe.css)({height:ko.l,display:"flex",padding:W.spacing(0,1,0,2),alignItems:"center",borderBottom:`1px solid ${W.colors.border.weak}`}),menuButton:(0,Qe.css)({display:"flex",alignItems:"center",marginRight:W.spacing(1)}),actions:(0,Qe.css)({label:"NavToolbar-actions",display:"flex",alignItems:"center",flexWrap:"nowrap",justifyContent:"flex-end",paddingLeft:W.spacing(1),flexGrow:1,gap:W.spacing(1),minWidth:0,".body-drawer-open &":{display:"none"}})});function Yf({}){const W=(0,pt.$j)(),{chrome:_}=(0,Ro.Il)(),G=_.useState(),de=G.searchBarHidden||G.kioskMode===wn.KioskMode.TV,xe=(0,l.useRef)(null),Me=(0,l.useRef)(null),we=W.transitions.duration.shortest,ke=(0,pt.of)(Xf,we),Xe=G.megaMenuOpen&&!G.megaMenuDocked,ht=()=>_.setMegaMenuOpen(!1),{overlayProps:mt,underlayProps:bt}=(0,qd.e)({isDismissable:!0,isOpen:!0,onClose:ht,shouldCloseOnInteractOutside:Ct=>!document.getElementById(fu)?.contains(Ct)},xe),{dialogProps:Kt}=(0,Xd.s)({},xe),Rt=(0,pt.of)(Jf,de);return(0,j.jsx)("div",{className:Rt.wrapper,children:(0,j.jsxs)(Ff.Sf,{children:[(0,j.jsx)(cu.A,{nodeRef:xe,in:Xe,unmountOnExit:!0,classNames:ke.overlay,timeout:{enter:we,exit:0},children:(0,j.jsx)(Zd.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,j.jsx)(uu,{className:Rt.menu,onClose:ht,ref:xe,...mt,...Kt})})}),(0,j.jsx)(cu.A,{nodeRef:Me,in:Xe,unmountOnExit:!0,classNames:ke.backdrop,timeout:{enter:we,exit:0},children:(0,j.jsx)("div",{ref:Me,className:Rt.backdrop,...bt})})]})})}const Jf=(W,_)=>{const G=_?ko.l:ko.l*2;return{backdrop:(0,Qe.css)({backdropFilter:"blur(1px)",backgroundColor:W.components.overlay.background,bottom:0,left:0,position:"fixed",right:0,top:_?0:ko.l,zIndex:W.zIndex.modalBackdrop,[W.breakpoints.up("md")]:{top:G}}),menu:(0,Qe.css)({display:"flex",bottom:0,flexDirection:"column",left:0,right:0,zIndex:W.zIndex.modal,position:"fixed",top:_?0:ko.l,backgroundColor:W.colors.background.primary,boxSizing:"content-box",flex:"1 1 0",[W.breakpoints.up("md")]:{right:"unset",borderRight:`1px solid ${W.colors.border.weak}`,top:G}}),wrapper:(0,Qe.css)({position:"fixed",display:"grid",gridAutoFlow:"column",height:"100%",zIndex:W.zIndex.sidemenu})}},Xf=(W,_)=>{const G={[W.transitions.handleMotion("no-preference")]:{transitionDuration:`${_}ms`,transitionTimingFunction:W.transitions.easing.easeInOut},[W.breakpoints.down("md")]:{overflow:"hidden"}},de={...G,transitionProperty:"box-shadow, width",".scrollbar-view":{overflow:"hidden !important"}},xe={...G,transitionProperty:"opacity"},Me={width:"100%",[W.breakpoints.up("md")]:{boxShadow:W.shadows.z3,width:zf}},we={boxShadow:"none",width:0},ke={opacity:1},Xe={opacity:0};return{backdrop:{enter:(0,Qe.css)(Xe),enterActive:(0,Qe.css)(xe,ke),enterDone:(0,Qe.css)(ke)},overlay:{enter:(0,Qe.css)(we),enterActive:(0,Qe.css)(de,Me),enterDone:(0,Qe.css)(Me)}}};var ac=e(24120),Zf=e(49426);function qf(W,_){if(W===_)return!0;if(!(W instanceof Object)||!(_ instanceof Object))return!1;const G=Object.keys(W),de=G.length;for(let xe=0;xe<de;xe++)if(!(G[xe]in _))return!1;for(let xe=0;xe<de;xe++)if(W[G[xe]]!==_[G[xe]])return!1;return de===Object.keys(_).length}const _c="grafana.navigation.docked",zc="grafana.navigation.open";class eg{constructor(){this.searchBarStorageKey="SearchBar_Hidden",this.routeChangeHandled=!0,this.megaMenuDocked=!!(window.innerWidth>=ae.$.theme2.breakpoints.values.xl&&xi.A.getBool(_c,window.innerWidth>=ae.$.theme2.breakpoints.values.xxl)),this.sessionStorageData=window.sessionStorage.getItem("returnToPrevious"),this.returnToPreviousData=this.sessionStorageData?JSON.parse(this.sessionStorageData):void 0,this.state=new Zf.t({chromeless:!0,sectionNav:{node:{text:(0,aa.t)("nav.home.title","Home")},main:{text:""}},searchBarHidden:xi.A.getBool(this.searchBarStorageKey,!1),megaMenuOpen:this.megaMenuDocked&&xi.A.getBool(zc,!0),megaMenuDocked:this.megaMenuDocked,kioskMode:null,layout:Wl.k.Canvas,returnToPrevious:this.returnToPreviousData}),this.setReturnToPrevious=_=>{const G=this.state.getValue().returnToPrevious;(0,Vr.rR)("grafana_return_to_previous_button_created",{page:_.href,previousPage:G?.href}),this.update({returnToPrevious:_}),window.sessionStorage.setItem("returnToPrevious",JSON.stringify(_))},this.clearReturnToPrevious=_=>{const G=this.state.getValue().returnToPrevious;G&&(0,Vr.rR)("grafana_return_to_previous_button_dismissed",{action:_,page:G.href}),this.update({returnToPrevious:void 0}),window.sessionStorage.removeItem("returnToPrevious")},this.setMegaMenuOpen=_=>{const{megaMenuDocked:G}=this.state.getValue();G&&xi.A.set(zc,_),(0,Vr.rR)("grafana_mega_menu_open",{state:_}),this.update({megaMenuOpen:_})},this.setMegaMenuDocked=(_,G=!0)=>{G&&xi.A.set(_c,_),(0,Vr.rR)("grafana_mega_menu_docked",{state:_}),this.update({megaMenuDocked:_})},this.onToggleSearchBar=()=>{const{searchBarHidden:_,kioskMode:G}=this.state.getValue(),de=!_;xi.A.set(this.searchBarStorageKey,de),G&&I.Ny.partial({kiosk:null}),this.update({searchBarHidden:de,kioskMode:null})},this.onToggleKioskMode=()=>{const _=this.getNextKioskMode();this.update({kioskMode:_}),I.Ny.partial({kiosk:this.getKioskUrlValue(_)})}}setMatchedRoute(_){this.currentRoute!==_&&(this.currentRoute=_,this.routeChangeHandled=!1)}update(_){const G=this.state.getValue(),de={...G};this.routeChangeHandled||(de.actions=void 0,de.pageNav=void 0,de.sectionNav={node:{text:(0,aa.t)("nav.home.title","Home")},main:{text:""}},de.chromeless=this.currentRoute?.chromeless,de.layout=Wl.k.Standard,this.routeChangeHandled=!0),Object.assign(de,_),de.chromeless=de.kioskMode===wn.KioskMode.Full||this.currentRoute?.chromeless,this.ignoreStateUpdate(de,G)||this.state.next(de)}ignoreStateUpdate(_,G){return!!(qf(_,G)||(_.sectionNav!==G.sectionNav||_.pageNav!==G.pageNav)&&_.actions===G.actions&&_.layout===G.layout&&Hc(_.sectionNav.node,G.sectionNav.node)&&Hc(_.pageNav,G.pageNav))}useState(){return(0,ac.A)(this.state,this.state.getValue())}exitKioskMode(){this.update({kioskMode:void 0}),I.Ny.partial({kiosk:null})}setKioskModeFromUrl(_){let G;switch(_){case"tv":G=wn.KioskMode.TV;break;case"1":case!0:G=wn.KioskMode.Full}G&&G!==this.state.getValue().kioskMode&&this.update({kioskMode:G})}getKioskUrlValue(_){switch(_){case wn.KioskMode.TV:return"tv";case wn.KioskMode.Full:return!0;default:return null}}getNextKioskMode(){const{kioskMode:_,searchBarHidden:G}=this.state.getValue();return G||_===wn.KioskMode.TV?(Mr.A.emit(Fi.r1.alertInfo,[(0,aa.t)("navigation.kiosk.tv-alert","Press ESC to exit kiosk mode")]),wn.KioskMode.Full):_?null:wn.KioskMode.TV}}function Hc(W,_){if(W===_)return!0;const G=W?.children?.find(xe=>xe.active),de=_?.children?.find(xe=>xe.active);return W?.text===_?.text&&W?.url===_?.url&&G?.url===de?.url&&Hc(W?.parentItem,_?.parentItem)}var tg=e(19727);const gu=({label:W,onClick:_,onDismiss:G})=>{const de=(0,pt.of)(ng);return(0,j.jsxs)(tg.e,{className:de.buttonGroup,children:[(0,j.jsx)(ye.$n,{icon:"angle-left",size:"sm",variant:"primary",fill:"outline",onClick:_,title:W,className:de.mainDismissableButton,"data-testid":rr.Tp.components.ReturnToPrevious.backButton,children:W}),(0,j.jsx)(ye.$n,{icon:"times","aria-label":(0,aa.t)("return-to-previous.dismissable-button","Close"),variant:"primary",fill:"outline",size:"sm",onClick:G,"data-testid":rr.Tp.components.ReturnToPrevious.dismissButton})]})},ng=W=>({mainDismissableButton:(0,Qe.css)({width:"100%","> span":{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"270px",display:"inline-block"}}),buttonGroup:(0,Qe.css)({width:"fit-content",backgroundColor:W.colors.background.secondary})});gu.displayName="DismissableButton";const pu=({href:W,title:_})=>{const G=(0,pt.of)(mu),{chrome:de}=(0,Ro.Il)(),xe=(0,l.useCallback)(()=>{I.Ny.push(W),de.clearReturnToPrevious("clicked")},[W,de]),Me=(0,l.useCallback)(()=>{de.clearReturnToPrevious("dismissed")},[de]);return(0,j.jsx)("div",{className:G.returnToPrevious,"data-testid":rr.Tp.components.ReturnToPrevious.buttonGroup,children:(0,j.jsx)(gu,{label:(0,aa.t)("return-to-previous.button.label","Back to {{title}}",{title:_}),onClick:xe,onDismiss:Me})})},mu=W=>({returnToPrevious:(0,Qe.css)({label:"return-to-previous",display:"flex",justifyContent:"center",left:"50%",transform:"translateX(-50%)",zIndex:W.zIndex.tooltip,position:"fixed",bottom:W.spacing.x4,boxShadow:W.shadows.z3})});pu.displayName="ReturnToPrevious";var vu=e(80997),$p=e(42941),Vp=e(62372),_p=e(49185),Sl=e(69386),zp=e(4172);function Hp({feedUrl:W}){const _=(0,pt.of)(kp),{state:G,getNews:de}=(0,zp.n)(W),[xe,Me]=(0,_p.A)();return(0,l.useEffect)(()=>{de()},[de]),G.error?(0,j.jsx)("div",{className:_.innerWrapper,children:G.error&&G.error.message}):(0,j.jsxs)("div",{ref:xe,children:[G.loading?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(Sl.K.Skeleton,{showImage:!0,width:Me.width}),(0,j.jsx)(Sl.K.Skeleton,{showImage:!0,width:Me.width}),(0,j.jsx)(Sl.K.Skeleton,{showImage:!0,width:Me.width}),(0,j.jsx)(Sl.K.Skeleton,{showImage:!0,width:Me.width}),(0,j.jsx)(Sl.K.Skeleton,{showImage:!0,width:Me.width})]}):(0,j.jsx)(j.Fragment,{children:Me.width>0&&G.value?.map((we,ke)=>(0,j.jsx)(Sl.K,{index:ke,showImage:!0,width:Me.width,data:G.value},ke))}),(0,j.jsx)("div",{className:_.grot,children:(0,j.jsx)("a",{href:"https://grafana.com/blog/",target:"_blank",rel:"noreferrer",title:"Go to Grafana labs blog",children:(0,j.jsx)("img",{src:"public/img/grot-news.svg",alt:"Grot reading news"})})})]})}const kp=W=>({innerWrapper:(0,Qe.css)({width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"}),grot:(0,Qe.css)({display:"flex",alignItems:"center",justifyContent:"center",padding:W.spacing(5,0),img:{width:"186px",height:"186px"}})});function Gp({className:W}){const[_,G]=(0,$p.A)(!1),de=(0,pt.of)(sg);return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(al.I,{className:W,onClick:G,iconOnly:!0,icon:"rss","aria-label":"News"}),_&&(0,j.jsx)(Rd._,{title:(0,j.jsxs)("div",{className:de.title,children:[(0,j.jsx)(Tr.E,{element:"h2",children:(0,aa.t)("news.title","Latest from the blog")}),(0,j.jsx)("a",{href:"https://grafana.com/blog/",target:"_blank",rel:"noreferrer",title:"Go to Grafana labs blog",className:de.grot,children:(0,j.jsx)("img",{src:"public/img/grot-news.svg",alt:"Grot reading news"})}),(0,j.jsx)("div",{className:de.actions,children:(0,j.jsx)(Ta.K,{name:"times",variant:"secondary",onClick:G,"data-testid":rr.Tp.components.Drawer.General.close,tooltip:(0,aa.t)("news.drawer.close","Close Drawer")})})]}),onClose:G,size:"md",children:(0,j.jsx)(Hp,{feedUrl:Vp.$})})]})}const sg=W=>({title:(0,Qe.css)({display:"flex",alignItems:"center",justifyContent:"center",gap:W.spacing(2),borderBottom:`1px solid ${W.colors.border.weak}`}),grot:(0,Qe.css)({display:"flex",alignItems:"center",justifyContent:"center",padding:W.spacing(2,0),img:{width:"75px",height:"75px"}}),actions:(0,Qe.css)({position:"absolute",right:W.spacing(1),top:W.spacing(2)})});var yu=e(32931);function ag({orgs:W,onSelectChange:_}){const G=(0,pt.of)(rg);return(0,j.jsx)(yo.i,{"aria-label":"Change organization",variant:"secondary",buttonCss:G.buttonCss,size:"md",label:"",fill:"text",isFullWidth:!1,options:W.map(de=>({label:de.name,description:de.role,value:de})),onChange:_,icon:"building"})}const rg=W=>({buttonCss:(0,Qe.css)({color:W.colors.text.secondary,"&:hover":{color:W.colors.text.primary}})});function og({orgs:W,onSelectChange:_}){const G=(0,pt.of)(xu),{orgName:de,orgId:xe,orgRole:Me}=ir.TP.user,[we,ke]=(0,l.useState)(()=>({label:de,value:{role:Me,orgId:xe,name:de},description:Me})),Xe=ht=>{ke(ht),_(ht)};return(0,j.jsx)(Te.l6,{"aria-label":"Change organization",width:"auto",value:we,prefix:(0,j.jsx)(Is.I,{className:"prefix-icon",name:"building"}),className:G.select,options:W.map(ht=>({label:ht.name,description:ht.role,value:ht})),onChange:Xe})}const xu=W=>({select:(0,Qe.css)({border:"none",background:"none",color:W.colors.text.secondary,"&:hover":{color:W.colors.text.primary,"& .prefix-icon":(0,Qe.css)({color:W.colors.text.primary})}})});function ig(){const W=(0,pt.$j)(),_=(0,wn.useDispatch)(),G=(0,wn.useSelector)(Xe=>Xe.organization.userOrgs),de=Xe=>{Xe.value&&((0,yu.bA)(Xe.value.orgId),I.Ny.push(`/?orgId=${Xe.value.orgId}`),window.location.reload())};(0,l.useEffect)(()=>{ir.TP.isSignedIn&&_((0,yu.wV)())},[_]);const xe=W.breakpoints.values.sm,[Me,we]=(0,l.useState)(!window.matchMedia(`(min-width: ${xe}px)`).matches);if((0,Cl.Y)({breakpoint:xe,onChange:Xe=>{we(!Xe.matches)}}),G?.length<=1)return null;const ke=Me?ag:og;return(0,j.jsx)(ke,{orgs:G,onSelectChange:de})}function Eu(W){const _=[];for(const G of W)G.isCreateAction&&_.push(G),G.children&&_.push(...Eu(G.children));return _}const lg=({})=>{const W=(0,pt.of)(Ol),_=(0,pt.$j)(),G=(0,wn.useSelector)(mt=>mt.navBarTree),de=_.breakpoints.values.sm,[xe,Me]=(0,l.useState)(!1),[we,ke]=(0,l.useState)(!window.matchMedia(`(min-width: ${de}px)`).matches),Xe=(0,l.useMemo)(()=>Eu(G),[G]);(0,Cl.Y)({breakpoint:de,onChange:mt=>{ke(!mt.matches)}});const ht=()=>(0,j.jsx)(xo.W,{children:Xe.map((mt,bt)=>(0,j.jsx)(xo.W.Item,{url:mt.url,label:mt.text,onClick:()=>(0,Vr.rR)("grafana_menu_item_clicked",{url:mt.url,from:"quickadd"})},bt))});return Xe.length>0?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(Hl.m,{overlay:ht,placement:"bottom-end",onVisibleChange:Me,children:(0,j.jsx)(al.I,{iconOnly:!0,icon:we?"plus-circle":"plus",isOpen:we?void 0:xe,"aria-label":"New"})}),(0,j.jsx)(hu.K,{className:W.separator})]}):null},Ol=W=>({buttonContent:(0,Qe.css)({alignItems:"center",display:"flex"}),buttonText:(0,Qe.css)({[W.breakpoints.down("md")]:{display:"none"}}),separator:(0,Qe.css)({[W.breakpoints.down("sm")]:{display:"none"}})});function cg(){const W=(0,qa.zy)(),_=(0,pt.of)(dg);let G=vu.sQ.sanitizeUrl(b.I.getUrlForPartial(W,{forceLogin:"true"}));return G.startsWith("//")&&(G=G.replace(/\/+/g,"/")),(0,j.jsx)("a",{className:_.link,href:G,target:"_self",children:"Sign in"})}const dg=W=>({link:(0,Qe.css)({paddingRight:W.spacing(1),whiteSpace:"nowrap","&:hover":{textDecoration:"underline"}})});var rl=e(64539);function rc({node:W}){const _=(0,pt.of)(Ei),G=Xl((0,m.cloneDeep)(W),!1);return G?(0,j.jsx)(xo.W,{header:(0,j.jsxs)("div",{onClick:de=>de.stopPropagation(),className:_.header,children:[(0,j.jsx)("div",{children:G.text}),G.subTitle&&(0,j.jsx)("div",{className:_.subTitle,children:G.subTitle})]}),children:G.children?.map(de=>de.url?(0,j.jsx)(rl.D,{url:de.url,label:de.text,icon:de.icon,target:de.target},de.id):(0,j.jsx)(rl.D,{icon:de.icon,onClick:de.onClick,label:de.text},de.id))}):null}const Ei=W=>({header:(0,Qe.css)({fontSize:W.typography.h5.fontSize,fontWeight:W.typography.h5.fontWeight,padding:W.spacing(.5,1),whiteSpace:"nowrap"}),subTitle:(0,Qe.css)({color:W.colors.text.secondary,fontSize:W.typography.bodySmall.fontSize})});var ug=e(16797),hg=e(63917);function fg(){const W=(0,pt.$j)(),{query:_}=(0,Vs.useKBar)(we=>({kbarSearchQuery:we.searchQuery,kbarIsOpen:we.visualState===Vs.VisualState.showing})),G=W.breakpoints.values.sm,[de,xe]=(0,l.useState)(!window.matchMedia(`(min-width: ${G}px)`).matches);(0,Cl.Y)({breakpoint:G,onChange:we=>{xe(!we.matches)}});const Me=()=>{_.toggle()};return de?(0,j.jsx)(al.I,{iconOnly:!0,icon:"search","aria-label":(0,aa.t)("nav.search.placeholderCommandPalette","Search or jump to..."),onClick:Me}):(0,j.jsx)(gg,{onClick:Me})}function gg({onClick:W}){const _=(0,pt.of)(pg),G=(0,l.useMemo)(()=>(0,hg.gn)(),[]);return(0,j.jsx)("div",{className:_.wrapper,children:(0,j.jsxs)("div",{className:_.inputWrapper,children:[(0,j.jsx)("div",{className:_.prefix,children:(0,j.jsx)(Is.I,{name:"search"})}),(0,j.jsx)("button",{className:_.fakeInput,onClick:W,children:(0,aa.t)("nav.search.placeholderCommandPalette","Search or jump to...")}),(0,j.jsxs)("div",{className:_.suffix,children:[(0,j.jsx)(Is.I,{name:"keyboard"}),(0,j.jsxs)(Tr.E,{variant:"bodySmall",children:[G,"+k"]})]})]})})}const pg=W=>{const _=(0,Ze.n)({theme:W});return{wrapper:_.wrapper,inputWrapper:_.inputWrapper,prefix:_.prefix,suffix:(0,Qe.css)([_.suffix,{display:"flex",gap:W.spacing(.5)}]),fakeInput:(0,Qe.css)([_.input,{textAlign:"left",paddingLeft:28,color:W.colors.text.disabled,"&:focus":{outline:"unset",boxShadow:"unset"},"&:focus-visible":(0,Qe.css)`
          ${(0,ug.focusCss)(W)}
        `}]),button:(0,Qe.css)({width:"100%",textAlign:"center","> *":{width:"100%",textAlign:"center",justifyContent:"center",gap:"1ch"}})}};function kc({children:W,align:_="left"}){const G=(0,pt.of)(Du),xe=(0,pt.$j)().breakpoints.values.sm,[Me,we]=(0,l.useState)(!window.matchMedia(`(min-width: ${xe}px)`).matches);return(0,Cl.Y)({breakpoint:xe,onChange:ke=>{we(!ke.matches)}}),Me?(0,j.jsx)(j.Fragment,{children:W}):(0,j.jsx)("div",{"data-testid":"wrapper",className:(0,Qe.cx)(G.wrapper,{[G[_]]:_==="right"}),children:W})}const Du=W=>({wrapper:(0,Qe.css)({display:"flex",gap:W.spacing(.5),alignItems:"center"}),right:(0,Qe.css)({justifyContent:"flex-end"}),left:(0,Qe.css)({}),center:(0,Qe.css)({})}),Il=(0,l.memo)(function(){const _=(0,pt.of)(mg),G=(0,wn.useSelector)(Xe=>Xe.navIndex),de=(0,qa.zy)(),xe=(0,m.cloneDeep)(G.help),Me=xe?zd(xe):void 0,we=G.profile;let ke=J.config.appSubUrl||"/";return!J.config.bootData.user.isSignedIn&&!J.config.anonymousEnabled&&(ke=vu.sQ.sanitizeUrl(b.I.getUrlForPartial(de,{forceLogin:"true"}))),(0,j.jsxs)("div",{className:_.layout,children:[(0,j.jsxs)(kc,{children:[(0,j.jsx)("a",{className:_.logo,href:ke,title:"Go to home",children:(0,j.jsx)(To.M.MenuLogo,{className:_.img})}),(0,j.jsx)(ig,{})]}),(0,j.jsx)(kc,{children:(0,j.jsx)(fg,{})}),(0,j.jsxs)(kc,{align:"right",children:[(0,j.jsx)(lg,{}),Me&&(0,j.jsx)(Hl.m,{overlay:()=>(0,j.jsx)(rc,{node:Me}),placement:"bottom-end",children:(0,j.jsx)(al.I,{iconOnly:!0,icon:"question-circle","aria-label":"Help"})}),J.config.newsFeedEnabled&&(0,j.jsx)(Gp,{}),!Wa.TP.user.isSignedIn&&(0,j.jsx)(cg,{}),we&&(0,j.jsx)(Hl.m,{overlay:()=>(0,j.jsx)(rc,{node:we}),placement:"bottom-end",children:(0,j.jsx)(al.I,{className:_.profileButton,imgSrc:Wa.TP.user.gravatarUrl,imgAlt:"User avatar","aria-label":"Profile"})})]})]})}),mg=W=>({layout:(0,Qe.css)({height:ko.l,display:"flex",gap:W.spacing(1),alignItems:"center",padding:W.spacing(0,1,0,2),borderBottom:`1px solid ${W.colors.border.weak}`,justifyContent:"space-between",[W.breakpoints.up("sm")]:{gridTemplateColumns:"1.5fr minmax(240px, 1fr) 1.5fr",display:"grid",justifyContent:"flex-start"}}),img:(0,Qe.css)({height:W.spacing(3),width:W.spacing(3)}),logo:(0,Qe.css)({display:"flex"}),profileButton:(0,Qe.css)({padding:W.spacing(0,.25),img:{borderRadius:W.shape.radius.circle,height:"24px",marginRight:0,width:"24px"}})});function vg({children:W}){const{chrome:_}=(0,Ro.Il)(),G=_.useState(),de=G.searchBarHidden||G.kioskMode===wn.KioskMode.TV,xe=(0,pt.$j)(),Me=(0,pt.of)(yg,de),we=xe.breakpoints.values.xl,ke=xi.A.getBool(_c,!0),Xe=!G.chromeless&&G.megaMenuDocked&&G.megaMenuOpen;(0,Cl.Y)({breakpoint:we,onChange:Ut=>{ke&&(_.setMegaMenuDocked(Ut.matches,!1),_.setMegaMenuOpen(Ut.matches?xi.A.getBool(zc,G.megaMenuOpen):!1))}});const ht=(0,Qe.cx)({[Me.content]:!0,[Me.contentNoSearchBar]:de,[Me.contentChromeless]:G.chromeless}),mt=()=>{_.setMegaMenuOpen(!G.megaMenuOpen)},{pathname:bt,search:Kt}=I.Ny.getLocation(),Rt=bt+Kt,Ct=G.returnToPrevious&&Rt!==G.returnToPrevious.href;return(0,l.useEffect)(()=>{G.returnToPrevious&&Rt===G.returnToPrevious.href&&_.clearReturnToPrevious("auto_dismissed")},[_,Rt]),(0,l.useEffect)(()=>{const Ut=(0,I.SE)(Kt);_.setKioskModeFromUrl(Ut.kiosk)},[_,Kt]),(0,j.jsxs)("div",{className:Jd()("main-view",{"main-view--search-bar-hidden":de&&!G.chromeless,"main-view--chrome-hidden":G.chromeless}),children:[!G.chromeless&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(ye.z9,{className:Me.skipLink,href:"#pageContent",children:"Skip to main content"}),(0,j.jsxs)("header",{className:(0,Qe.cx)(Me.topNav),children:[!de&&(0,j.jsx)(Il,{}),(0,j.jsx)(Gf,{searchBarHidden:de,sectionNav:G.sectionNav.node,pageNav:G.pageNav,actions:G.actions,onToggleSearchBar:_.onToggleSearchBar,onToggleMegaMenu:mt,onToggleKioskMode:_.onToggleKioskMode})]})]}),(0,j.jsx)("div",{className:ht,children:(0,j.jsxs)("div",{className:Me.panes,children:[Xe&&(0,j.jsx)(uu,{className:Me.dockedMegaMenu,onClose:()=>_.setMegaMenuOpen(!1)}),(0,j.jsx)("main",{className:(0,Qe.cx)(Me.pageContainer,{[Me.pageContainerMenuDocked]:ae.$.featureToggles.bodyScrolling&&Xe}),id:"pageContent",children:W})]})}),!G.chromeless&&!G.megaMenuDocked&&(0,j.jsx)(Yf,{}),!G.chromeless&&(0,j.jsx)(wf,{}),Ct&&G.returnToPrevious&&(0,j.jsx)(pu,{href:G.returnToPrevious.href,title:G.returnToPrevious.title})]})}const yg=(W,_)=>({content:(0,Qe.css)({display:"flex",flexDirection:"column",paddingTop:ko.l*2,flexGrow:1,height:ae.$.featureToggles.bodyScrolling?"auto":"100%"}),contentNoSearchBar:(0,Qe.css)({paddingTop:ko.l}),contentChromeless:(0,Qe.css)({paddingTop:0}),dockedMegaMenu:(0,Qe.css)({background:W.colors.background.primary,borderRight:`1px solid ${W.colors.border.weak}`,display:"none",[W.breakpoints.up("xl")]:{display:"block"}},ae.$.featureToggles.bodyScrolling?{position:"fixed",height:`calc(100% - ${_?ko.l:ko.l*2}px)`,zIndex:1}:{zIndex:W.zIndex.navbarFixed}),topNav:(0,Qe.css)({display:"flex",position:"fixed",zIndex:W.zIndex.navbarFixed,left:0,right:0,background:W.colors.background.primary,flexDirection:"column"}),panes:(0,Qe.css)({display:"flex",flexDirection:"column",flexGrow:1,label:"page-panes"},!ae.$.featureToggles.bodyScrolling&&{height:"100%",minHeight:0,width:"100%",[W.breakpoints.up("md")]:{flexDirection:"row"}}),pageContainerMenuDocked:(0,Qe.css)({paddingLeft:"300px"}),pageContainer:(0,Qe.css)({label:"page-container",display:"flex",flexDirection:"column",flexGrow:1},!ae.$.featureToggles.bodyScrolling&&{minHeight:0,minWidth:0,overflow:"auto","@media print":{overflow:"visible"},"@page":{margin:0,size:"auto",padding:0}}),skipLink:(0,Qe.css)({position:"fixed",top:-1e3,":focus":{left:W.spacing(1),top:W.spacing(1),zIndex:W.zIndex.portal}})});var ol=e(82467),Pu=e(16001),oc=e(3169),Di=e(94701);function Gc({appNotification:W,onClearNotification:_}){const G=(0,pt.of)(xg);(0,Di.A)(()=>{setTimeout(()=>{_(W.id)},wn.timeoutMap[W.severity])});const de=W.component||W.text||W.traceId;return(0,j.jsx)(vn.F,{severity:W.severity,title:W.title,onRemove:()=>_(W.id),elevated:!0,children:de&&(0,j.jsxs)("div",{className:G.wrapper,children:[(0,j.jsx)("span",{children:W.component||W.text}),W.traceId&&(0,j.jsxs)("span",{className:G.trace,children:["Trace ID: ",W.traceId]})]})})}function xg(W){return{wrapper:(0,Qe.css)({display:"flex",flexDirection:"column"}),trace:(0,Qe.css)({fontSize:W.typography.pxToRem(10)})}}function Eg(){const W=(0,wn.useSelector)(xe=>(0,Pu.fX)(xe.appNotifications)),_=(0,wn.useDispatch)(),G=(0,pt.of)(Dg);(0,l.useEffect)(()=>{Mr.A.on(Fi.r1.alertWarning,xe=>_((0,ol.dx)((0,oc.q8)(...xe)))),Mr.A.on(Fi.r1.alertSuccess,xe=>_((0,ol.dx)((0,oc.tZ)(...xe)))),Mr.A.on(Fi.r1.alertError,xe=>_((0,ol.dx)((0,oc.gi)(...xe)))),Mr.A.on(Fi.r1.alertInfo,xe=>_((0,ol.dx)((0,oc.Cf)(...xe))))},[_]);const de=xe=>{_((0,ol.Do)(xe))};return(0,j.jsx)("div",{className:G.wrapper,children:(0,j.jsx)(on.B,{direction:"column",children:W.map((xe,Me)=>(0,j.jsx)(Gc,{appNotification:xe,onClearNotification:de},`${xe.id}-${Me}`))})})}function Dg(W){return{wrapper:(0,Qe.css)({label:"app-notifications-list",zIndex:W.zIndex.portal,minWidth:400,maxWidth:600,position:"fixed",right:6,top:88})}}function Pg(W){const[_,G]=(0,l.useState)({component:null,props:{}}),de=(0,l.useMemo)(()=>{function xe(we,ke){G({component:we,props:ke})}function Me(){G({component:null,props:{}})}return{component:_.component,props:{..._.props,isOpen:!0,onDismiss:Me},showModal:xe,hideModal:Me}},[_]);return(0,l.useEffect)(()=>{Mr.A.subscribe(to.S8,({payload:Me})=>{G({component:Me.component,props:Me.props})}),Mr.A.subscribe(to.bY,Me=>{bg(Me,G)});let xe="";I.Ny.getHistory().listen(Me=>{Me.pathname!==xe&&G({component:null,props:{}}),xe=Me.pathname})},[]),(0,j.jsx)(uc.wE.Provider,{value:de,children:W.children})}function bg({payload:W},_){const{confirmText:G,onConfirm:de=()=>{},onDismiss:xe,text2:Me,altActionText:we,onAltAction:ke,noText:Xe,text:ht,text2htmlBind:mt,yesText:bt="Yes",icon:Kt,title:Rt="Confirm",yesButtonVariant:Ct}=W,Ut=()=>_({component:null,props:{}}),hn={confirmText:bt,confirmButtonVariant:Ct,confirmationText:G,icon:Kt,title:Rt,body:ht,description:Me&&mt?vu.sQ.sanitize(Me):Me,isOpen:!0,dismissText:Xe,onConfirm:()=>{de(),Ut()},onDismiss:()=>{xe?.(),Ut()},onAlternative:ke?()=>{ke(),Ut()}:void 0,alternativeText:we};_({component:vl.u,props:hn})}var Qp=e(66899),Qc=e.n(Qp),bu=e(52446);function Lo({error:W,errorInfo:_}){const G=(0,qa.zy)(),de=W?.name==="ChunkLoadError",xe=(0,pt.of)(Al);return(0,l.useEffect)(()=>{de&&G.search.indexOf("chunkNotFound")===-1&&(window.location.href=b.I.getUrlForPartial(G,{chunkNotFound:!0}))},[G,de]),(0,j.jsx)(zr.Y,{navId:"error",layout:Wl.k.Canvas,children:(0,j.jsxs)("div",{className:xe.container,children:[de&&(0,j.jsxs)("div",{children:[(0,j.jsx)("h2",{children:"Unable to find application file"}),(0,j.jsx)("br",{}),(0,j.jsx)("h2",{className:"page-heading",children:"Grafana has likely been updated. Please try reloading the page."}),(0,j.jsx)("br",{}),(0,j.jsx)(ye.$n,{size:"md",variant:"secondary",icon:"repeat",onClick:()=>window.location.reload(),children:"Reload"}),(0,j.jsx)(bu.D,{title:"Error details",error:W,errorInfo:_})]}),!de&&(0,j.jsx)(bu.D,{title:"An unexpected error happened",error:W,errorInfo:_})]})})}const Al=W=>({container:(0,Qe.css)({width:"500px",margin:W.spacing(8,"auto")})});function Cu(){const W=(0,pt.of)(Pi);return(0,j.jsx)("div",{className:W.container,"aria-live":"polite",role:"status","aria-label":(0,aa.t)("bouncing-loader.label","Loading"),children:(0,j.jsx)("div",{className:W.bounce,children:(0,j.jsx)("img",{alt:"",src:"public/img/grafana_icon.svg",className:W.logo})})})}const Cg=(0,Qe.keyframes)({"0%":{opacity:0,animationTimingFunction:"cubic-bezier(0, 0, 0.5, 1)"},"100%":{opacity:1}}),Tg=(0,Qe.keyframes)({"0%":{opacity:0},"50%":{opacity:1},"100%":{opacity:0}}),Yc=(0,Qe.keyframes)({"from, to":{transform:"translateY(0px)",animationTimingFunction:"cubic-bezier(0.3, 0, 0.1, 1)"},"50%":{transform:"translateY(-50px)",animationTimingFunction:"cubic-bezier(0.9, 0, 0.7, 1)"}}),Jc=(0,Qe.keyframes)({"0%":{transform:"scaleX(1.3) scaleY(0.8)",animationTimingFunction:"cubic-bezier(0.3, 0, 0.1, 1)"},"15%":{transform:"scaleX(0.75) scaleY(1.25)",animationTimingFunction:"cubic-bezier(0, 0, 0.7, 0.75)"},"55%":{transform:"scaleX(1.05) scaleY(0.95)",animationTimingFunction:"cubic-bezier(0.9, 0, 1, 1)"},"95%":{transform:"scaleX(0.75) scaleY(1.25)",animationTimingFunction:"cubic-bezier(0, 0, 0, 1)"},"100%":{transform:"scaleX(1.3) scaleY(0.8)",animationTimingFunction:"cubic-bezier(0, 0, 0.7, 1)"}}),Pi=W=>({container:(0,Qe.css)({opacity:0,[W.transitions.handleMotion("no-preference")]:{animationName:Cg,animationIterationCount:1,animationDuration:"0.9s",animationDelay:"0.5s",animationFillMode:"forwards"},[W.transitions.handleMotion("reduce")]:{animationName:Tg,animationIterationCount:"infinite",animationDuration:"4s",animationDelay:"0.5s"}}),bounce:(0,Qe.css)({textAlign:"center",[W.transitions.handleMotion("no-preference")]:{animationName:Yc,animationDuration:"0.9s",animationIterationCount:"infinite"}}),logo:(0,Qe.css)({display:"inline-block",[W.transitions.handleMotion("no-preference")]:{animationName:Jc,animationDuration:"0.9s",animationIterationCount:"infinite"},width:"60px",height:"60px"})});function Tu(){const W=(0,pt.of)(Mg);return(0,j.jsx)("div",{className:(0,Qe.cx)({[W.loadingPage]:!ae.$.featureToggles.bodyScrolling,[W.loadingPageBodyScrolling]:ae.$.featureToggles.bodyScrolling}),children:(0,j.jsx)(Cu,{})})}const Mg=W=>({loadingPage:(0,Qe.css)({backgroundColor:W.colors.background.primary,height:"100%",flexDrection:"column",display:"flex",justifyContent:"center",alignItems:"center"}),loadingPageBodyScrolling:(0,Qe.css)({backgroundColor:W.colors.background.primary,flex:1,flexDrection:"column",display:"flex",justifyContent:"center",alignItems:"center"})});function Sg(W){const{chrome:_,keybindings:G}=(0,Ro.Il)();return _.setMatchedRoute(W.route),(0,l.useLayoutEffect)(()=>{G.clearAndInitGlobalBindings(W.route)},[G,W.route]),(0,l.useEffect)(()=>(ic(W.route),Xc(),(0,I.Lc)("GrafanaRoute",!1,"Mounted",W.match),()=>{(0,I.Lc)("GrafanaRoute",!1,"Unmounted",W.route),ic(W.route,!0)}),[]),(0,l.useEffect)(()=>{Xc(),(0,Vr.Jy)(),(0,I.Lc)("GrafanaRoute",!1,"Updated",W)}),(0,I.Lc)("GrafanaRoute",!1,"Rendered",W.route),(0,j.jsx)(Or.tH,{children:({error:de,errorInfo:xe})=>de?(0,j.jsx)(Lo,{error:de,errorInfo:xe}):(0,j.jsx)(l.Suspense,{fallback:(0,j.jsx)(Tu,{}),children:(0,j.jsx)(W.route.component,{...W,queryParams:(0,I.SE)(W.location.search)})})})}function Og(W){return W.pageClass?W.pageClass.split(" "):[]}function ic(W,_=!1){for(const G of Og(W))_?document.body.classList.remove(G):document.body.classList.add(G)}function Xc(){document.body.classList.remove("sidemenu-open--xs");const W=document.getElementById("tooltip");W?.parentElement?.removeChild(W);const _=document.querySelectorAll(".tooltip");for(let G=0;G<_.length;G++){const de=_[G];de.parentElement?.removeChild(de)}for(const G of Qc().drops)G.destroy()}var Ig=e(96378),Zc=e(78731);class Ag extends l.PureComponent{constructor(){super(...arguments),this.styles=So(ae.$.theme2),this.state={},this.initListener=()=>{const _=(0,Zc.oF)();_&&(this.subscription=_.getConnectionState().subscribe({next:G=>{this.setState({show:!G})}}))}}componentDidMount(){}componentWillUnmount(){this.subscription&&this.subscription.unsubscribe()}render(){const{show:_}=this.state;return _?!ir.TP.isSignedIn||!ae.$.liveEnabled||ir.TP.user.orgRole===Oc.X.None?null:(0,j.jsx)("div",{className:this.styles.foot,children:(0,j.jsx)(vn.F,{severity:"warning",className:this.styles.warn,title:"connection to server is lost..."})}):null}}const So=(0,Fl.N)(W=>({foot:(0,Qe.css)({position:"fixed",bottom:0,left:0,right:0,zIndex:1e4,cursor:"wait",margin:W.spacing(2)}),warn:(0,Qe.css)({maxWidth:"400px",margin:"auto"})}));let Rg=[],qc=[];function Yp(W){Rg.push(W)}function Jp(W){qc.push(W)}class Lg extends l.Component{constructor(_){super(_),this.renderRoute=G=>{const de=G.roles?G.roles():[];return(0,j.jsx)(Bi.CompatRoute,{exact:G.exact===void 0?!0:G.exact,sensitive:G.sensitive===void 0?!1:G.sensitive,path:G.path,render:xe=>de?.length&&!de.some(Me=>ir.TP.hasRole(Me))?(0,j.jsx)(qa.rd,{to:"/"}):(0,j.jsx)(Sg,{...xe,route:G})},G.path)},this.state={}}async componentDidMount(){await Yd(),this.setState({ready:!0}),$(".preloader").remove()}renderRoutes(){return(0,j.jsx)(qa.dO,{children:hf().map(_=>this.renderRoute(_))})}render(){const{app:_}=this.props,{ready:G}=this.state;(0,I.Lc)("AppWrapper",!1,"rendering");const de=xe=>{(0,Vr.rR)("command_palette_action_selected",{actionId:xe.id,actionName:xe.name})};return(0,j.jsx)(ka.Provider,{store:er.M_,children:(0,j.jsx)(Or.Xw,{style:"page",children:(0,j.jsx)(Ro.YE.Provider,{value:_.context,children:(0,j.jsx)(Ig.N,{value:ae.$.theme2,children:(0,j.jsx)(Vs.KBarProvider,{actions:[],options:{enableHistory:!0,callbacks:{onSelectAction:de}},children:(0,j.jsx)(qa.Ix,{history:I.Ny.getHistory(),children:(0,j.jsx)(I._K,{service:I.Ny,children:(0,j.jsx)(Bi.CompatRouter,{children:(0,j.jsxs)(Pg,{children:[(0,j.jsx)(Ui.k,{}),(0,j.jsx)("div",{className:"grafana-app",children:(0,j.jsxs)(vg,{children:[(0,j.jsx)(Qd,{}),(0,j.jsx)(Eg,{}),(0,j.jsxs)(on.B,{gap:0,grow:1,direction:"column",children:[qc.map((xe,Me)=>(0,j.jsx)(xe,{},Me.toString())),G&&this.renderRoutes()]}),Rg.map((xe,Me)=>(0,j.jsx)(xe,{},Me.toString()))]})}),(0,j.jsx)(Ag,{}),(0,j.jsx)(uc.EO,{}),(0,j.jsx)(Ni.qB,{})]})})})})})})})})})}}var so=e(33919);function Go({actions:W,children:_,info:G,pageNav:de,layout:xe,renderTitle:Me,subTitle:we}){const ke=(0,l.useContext)(Ql);return(0,j.jsx)(zr.Y,{navModel:ke.sectionNav,pageNav:de,layout:xe,actions:W,renderTitle:Me,info:G,subTitle:we,children:(0,j.jsx)(zr.Y.Contents,{children:_})})}var Mu=e(8867),jg=e(91324),lc=e(23227),Bg=e(83712),Ug=e(93455),Ng=e(99443),wg=e(70699),Wg=e(63997),Fg=e(5798),Kg=e(61061),$g=e(85346),Vg=e(41731),Su=e(36294),_g=e(62575),zg=e(27798),Hg=e(53392),kg=e(17694),Gg=e(27743),Rl=e(66509),ed=e(98368),Ou=e(67341),Qg=e(51472),Yg=e(90517),Jg=e(78412),Xg=e(24548),ei=e(41366),Zg=e(63892),qg=e(53927),ep=e(22965),td=e(19336),tp=e(66163),np=e(30259),Q=e(96725),fe=e(30283),be=e(53141),Be=e(69382),He=e(88790),at=e(388),it=e(58689),Dt=e(29342),Ot=e(27583),wt=e(34153),_t=e(13852),Qt=e(5614),rn=e(34715),kt=e(25853),pn=e(98020),_n=e(90088),An=e(79764),$n=e(5422),Bn=e(61987),un=e(88225),bn=e(13896),Us=e(68018),us=e(63023),Ts=e(32437),zn=e(99996),On=e(99641),fs=e(70649),Hn=e(98828),ps=e(79151),ks=e(53663),Xs=e(27193),ia=e(53123),ja=e(4458),Ys=e(28643),xs=e(33311),Os=e(90841),ha=e(49018),Ha=e(63738),Ws=e(63263),Rs=e(29340),na=e(45937),ya=e(29339),da=e(6820),Ba=e(77444),Fa=e(3327),fa=e(70794),Ga=e(11273),Ja=e(80641),pr=e(28867),vs=e(11220),ds=e(23544),Ls=e(48339),ra=e(4240),qs=e(95224),la=e(82382),Pa=e(87048),br=e(53007),ao=e(12179),ba=e(17226),Ka=e(42982),ro=e(42806),go=e(50459),ti=e(84879),jo=e(52664),Ki=e(26868),bi=e(72805),oo=e(73575),Ll=e(56811),jl=e(53896),km=e(97918),Gm=e(81422),Qm=e(29130),Ym=e(45376),Jm=e(73642),Xm=e(83267),Zm=e(80021),qm=e(41684),e0=e(72215),t0=e(81656),n0=e(29424),s0=e(7682),a0=e(51764),r0=e(76151),o0=e(30781),i0=e(65972),l0=e(90756),c0=e(24289),d0=e(84472),u0=e(71533),h0=e(45298),f0=e(96906),g0=e(95311),p0=e(82349),m0=e(21101),v0=e(49935),y0=e(48761),x0=e(97231),E0=e(13835),D0=e(91381),P0=e(52859),b0=e(25928),C0=e(36714),T0=e(30815),M0=e(3465),S0=e(39012),O0=e(94675),I0=e(40051),A0=e(4543),R0=e(89579),L0=e(82524),j0=e(31115),B0=e(99003),U0=e(95684),N0=e(1624),w0=e(93644),W0=e(96619),F0=e(61748),K0=e(57169),$0=e(11769),V0=e(26551),_0=e(40295),z0=e(38514),H0=e(81312),k0=e(64298),G0=e(70866),Q0=e(30587),Y0=e(44850),J0=e(54556),X0=e(81615),Z0=e(82798),q0=e(8687),ev=e(77270),tv=e(10742),nv=e(41404),sv=e(72579),av=e(39973),rv=e(56963),ov=e(8807),iv=e(24109),lv=e(46255),cv=e(68636),dv=e(74305),uv=e(21391);let Xp=!1;function dn(W,_){Mu.cacheStore[_]={content:W,status:"loaded"}}function hv(){let W="public/img/icons/";const _=typeof window<"u"&&window.__grafana_public_path__;return _&&(W=_+"img/icons/"),G=>W+G}function fv(){if(Xp)return;Xp=!0;const W=hv();dn(jg,W("unicons/at.svg")),dn(lc,W("unicons/adjust-circle.svg")),dn(Bg,W("unicons/align-left.svg")),dn(Ug,W("unicons/align-right.svg")),dn(Ng,W("unicons/angle-double-down.svg")),dn(wg,W("unicons/angle-double-right.svg")),dn(Wg,W("unicons/angle-down.svg")),dn(Fg,W("unicons/angle-left.svg")),dn(Kg,W("unicons/angle-right.svg")),dn($g,W("unicons/angle-up.svg")),dn(Vg,W("unicons/apps.svg")),dn(Su,W("unicons/arrow.svg")),dn(_g,W("unicons/arrow-down.svg")),dn(zg,W("unicons/arrow-from-right.svg")),dn(Hg,W("unicons/arrow-left.svg")),dn(kg,W("unicons/arrow-random.svg")),dn(Gg,W("unicons/arrow-right.svg")),dn(Rl,W("unicons/arrow-to-right.svg")),dn(ed,W("unicons/arrow-up.svg")),dn(Ou,W("unicons/arrows-h.svg")),dn(Qg,W("unicons/backward.svg")),dn(Yg,W("unicons/bars.svg")),dn(Jg,W("unicons/bell.svg")),dn(Xg,W("unicons/bell-slash.svg")),dn(ei,W("unicons/bolt.svg")),dn(Zg,W("unicons/book.svg")),dn(qg,W("unicons/bookmark.svg")),dn(ep,W("unicons/book-open.svg")),dn(td,W("unicons/brackets-curly.svg")),dn(tp,W("unicons/bug.svg")),dn(np,W("unicons/building.svg")),dn(Q,W("unicons/calculator-alt.svg")),dn(fe,W("unicons/calendar-alt.svg")),dn(be,W("unicons/calendar-slash.svg")),dn(Be,W("unicons/camera.svg")),dn(He,W("unicons/channel-add.svg")),dn(at,W("unicons/chart-line.svg")),dn(it,W("unicons/check.svg")),dn(Dt,W("unicons/check-circle.svg")),dn(Ot,W("unicons/circle.svg")),dn(wt,W("unicons/clipboard-alt.svg")),dn(_t,W("unicons/clock-nine.svg")),dn(Qt,W("unicons/cloud.svg")),dn(rn,W("unicons/cloud-download.svg")),dn(kt,W("unicons/code-branch.svg")),dn(pn,W("unicons/cog.svg")),dn(_n,W("unicons/columns.svg")),dn(An,W("unicons/comment-alt.svg")),dn($n,W("unicons/comment-alt-share.svg")),dn(Bn,W("unicons/comments-alt.svg")),dn(un,W("unicons/compass.svg")),dn(bn,W("unicons/copy.svg")),dn(Us,W("unicons/corner-down-right-alt.svg")),dn(us,W("unicons/cube.svg")),dn(Ts,W("unicons/dashboard.svg")),dn(zn,W("unicons/database.svg")),dn(On,W("unicons/document-info.svg")),dn(fs,W("unicons/download-alt.svg")),dn(Hn,W("unicons/draggabledots.svg")),dn(ps,W("unicons/edit.svg")),dn(ks,W("unicons/ellipsis-v.svg")),dn(Xs,W("unicons/ellipsis-h.svg")),dn(ia,W("unicons/envelope.svg")),dn(ja,W("unicons/exchange-alt.svg")),dn(Ys,W("unicons/exclamation-circle.svg")),dn(xs,W("unicons/exclamation-triangle.svg")),dn(Os,W("unicons/external-link-alt.svg")),dn(ha,W("unicons/eye.svg")),dn(Ha,W("unicons/eye-slash.svg")),dn(Ws,W("unicons/file-alt.svg")),dn(Rs,W("unicons/file-blank.svg")),dn(na,W("unicons/filter.svg")),dn(ya,W("unicons/folder.svg")),dn(da,W("unicons/folder-open.svg")),dn(Ba,W("unicons/folder-plus.svg")),dn(Fa,W("unicons/folder-upload.svg")),dn(fa,W("unicons/forward.svg")),dn(Ga,W("unicons/graph-bar.svg")),dn(Ja,W("unicons/history.svg")),dn(pr,W("unicons/history-alt.svg")),dn(vs,W("unicons/home-alt.svg")),dn(ds,W("unicons/import.svg")),dn(Ls,W("unicons/info.svg")),dn(ra,W("unicons/info-circle.svg")),dn(qs,W("unicons/k6.svg")),dn(la,W("unicons/key-skeleton-alt.svg")),dn(Pa,W("unicons/keyboard.svg")),dn(br,W("unicons/link.svg")),dn(ao,W("unicons/list-ul.svg")),dn(ba,W("unicons/lock.svg")),dn(Ka,W("unicons/minus.svg")),dn(ro,W("unicons/minus-circle.svg")),dn(go,W("unicons/mobile-android.svg")),dn(ti,W("unicons/monitor.svg")),dn(jo,W("unicons/pause.svg")),dn(Ki,W("unicons/pen.svg")),dn(bi,W("unicons/play.svg")),dn(oo,W("unicons/plug.svg")),dn(Ll,W("unicons/plus.svg")),dn(jl,W("unicons/plus-circle.svg")),dn(km,W("unicons/power.svg")),dn(Gm,W("unicons/presentation-play.svg")),dn(Qm,W("unicons/process.svg")),dn(Ym,W("unicons/question-circle.svg")),dn(Jm,W("unicons/repeat.svg")),dn(Xm,W("unicons/rocket.svg")),dn(Zm,W("unicons/rss.svg")),dn(qm,W("unicons/save.svg")),dn(e0,W("unicons/search.svg")),dn(t0,W("unicons/search-minus.svg")),dn(n0,W("unicons/search-plus.svg")),dn(s0,W("unicons/share-alt.svg")),dn(a0,W("unicons/shield.svg")),dn(r0,W("unicons/signal.svg")),dn(o0,W("unicons/signin.svg")),dn(i0,W("unicons/signout.svg")),dn(l0,W("unicons/sitemap.svg")),dn(c0,W("unicons/slack.svg")),dn(d0,W("unicons/sliders-v-alt.svg")),dn(u0,W("unicons/sort-amount-down.svg")),dn(h0,W("unicons/sort-amount-up.svg")),dn(f0,W("unicons/square-shape.svg")),dn(g0,W("unicons/star.svg")),dn(p0,W("unicons/step-backward.svg")),dn(m0,W("unicons/sync.svg")),dn(v0,W("unicons/stopwatch.svg")),dn(y0,W("unicons/table.svg")),dn(x0,W("unicons/tag-alt.svg")),dn(E0,W("unicons/times.svg")),dn(D0,W("unicons/trash-alt.svg")),dn(P0,W("unicons/unlock.svg")),dn(b0,W("unicons/upload.svg")),dn(C0,W("unicons/user.svg")),dn(T0,W("unicons/users-alt.svg")),dn(M0,W("unicons/wrap-text.svg")),dn(S0,W("unicons/cloud-upload.svg")),dn(O0,W("unicons/credit-card.svg")),dn(I0,W("unicons/file-copy-alt.svg")),dn(A0,W("unicons/fire.svg")),dn(R0,W("unicons/hourglass.svg")),dn(L0,W("unicons/layer-group.svg")),dn(j0,W("unicons/layers-alt.svg")),dn(B0,W("unicons/line-alt.svg")),dn(U0,W("unicons/list-ui-alt.svg")),dn(N0,W("unicons/message.svg")),dn(w0,W("unicons/palette.svg")),dn(W0,W("unicons/percentage.svg")),dn(F0,W("unicons/shield-exclamation.svg")),dn(K0,W("unicons/plus-square.svg")),dn($0,W("unicons/x.svg")),dn(V0,W("unicons/capture.svg")),dn(_0,W("custom/gf-grid.svg")),dn(z0,W("custom/gf-landscape.svg")),dn(H0,W("custom/gf-layout-simple.svg")),dn(k0,W("custom/gf-portrait.svg")),dn(G0,W("custom/gf-show-context.svg")),dn(Q0,W("custom/gf-bar-alignment-after.svg")),dn(Y0,W("custom/gf-bar-alignment-before.svg")),dn(J0,W("custom/gf-bar-alignment-center.svg")),dn(X0,W("custom/gf-interpolation-linear.svg")),dn(Z0,W("custom/gf-interpolation-smooth.svg")),dn(q0,W("custom/gf-interpolation-step-after.svg")),dn(ev,W("custom/gf-interpolation-step-before.svg")),dn(tv,W("custom/gf-logs.svg")),dn(nv,W("custom/gf-movepane-left.svg")),dn(sv,W("custom/gf-movepane-right.svg")),dn(av,W("mono/favorite.svg")),dn(rv,W("mono/grafana.svg")),dn(ov,W("mono/heart.svg")),dn(iv,W("mono/heart-break.svg")),dn(lv,W("mono/panel-add.svg")),dn(cv,W("mono/library-panel.svg")),dn(dv,W("unicons/record-audio.svg")),dn(uv,W("solid/bookmark.svg"))}function gv(){self.MonacoEnvironment={getWorker(W,_){const G=P.l.getIfExists(_);return G?G.init():_==="json"?new ea.c(new URL(e.p+e.u(1162),e.b)):_==="css"||_==="scss"||_==="less"?new ea.c(new URL(e.p+e.u(9044),e.b)):_==="html"||_==="handlebars"||_==="razor"?new ea.c(new URL(e.p+e.u(4064),e.b)):_==="typescript"||_==="javascript"?new ea.c(new URL(e.p+e.u(2150),e.b)):new ea.c(new URL(e.p+e.u(1821),e.b))}}}var sp=e(76885);function pv(W){const _=W.target instanceof Element&&mv(W.target);if(!(W.ctrlKey||W.metaKey||W.defaultPrevented)&&_){let G=_.getAttribute("href");const de=_.getAttribute("target");if(G&&!de){const xe=sp.kM.parseKeyValue(G.split("?")[1]),Me=xe.orgId&&Number(xe.orgId)!==J.config.bootData.user.orgId;if((0,I.Lc)("utils",!1,"intercepting link click",W),W.preventDefault(),G=b.I.stripBaseFromUrl(G),G[0]!=="/"||Me)if(G.indexOf("://")>0||G.indexOf("mailto:")===0||Me){window.location.href=G;return}else if(G.indexOf("#")===0){window.location.hash=G;return}else G=`/${G}`;I.Ny.push(G)}}}function mv(W){for(;W!==null&&W.tagName;){if(W.tagName.toUpperCase()==="A")return W;W=W.parentElement}return null}class vv{constructor(_){this.hasUpdates=!1,this.checked=Date.now(),this.prevLocationPath="",this.interval=_??1e3*60*5}start(){const _=(0,Zc.oF)();_&&_.getConnectionState().subscribe(G=>{G&&this._checkForUpdates()}),I.Ny.getHistory().listen(this.locationUpdated.bind(this)),this.prevLocationPath=I.Ny.getLocation().pathname}locationUpdated(_){if(this.prevLocationPath===_.pathname)return;const G=_.pathname.split("/");G[1]==="/"&&this.prevLocationPath!=="/"?this.reloadIfUpdateDetected():G[1]==="d"?this.reloadIfUpdateDetected():this.hasUpdates&&(0,Vr.rR)("new_frontend_assets_reload_ignored",{newLocation:_.pathname,prevLocation:this.prevLocationPath}),this.prevLocationPath=_.pathname}async _checkForUpdates(){if(this.hasUpdates||Date.now()-this.checked<this.interval)return;this.checked=Date.now();const _=this.previous,G=await(0,M.AI)().get("/api/frontend/assets");_&&!(0,m.isEqual)(_,G)&&(this.hasUpdates=!0,(0,Vr.rR)("new_frontend_assets_detected",{assets:_.assets!==G.assets,plugins:_.plugins!==G.plugins,version:_.version!==G.version,flags:_.flags!==G.flags})),this.previous=G}reloadIfUpdateDetected(){this.hasUpdates&&((0,Vr.rR)("new_frontend_assets_reload",{}),window.location.reload()),this._checkForUpdates()}}var ap=e(27677),yv=e(91040),xv=e(40621);function rp(W,_=!1){return new Promise(G=>{const de=document.createElement("script");de.onload=G,de.src=W,de.async=_,document.head.appendChild(de)})}const Zp=(0,yv.h)("EchoSrv"),qp=Zp.logger;(0,xv.h)("echo",void 0,Zp);class Ev{constructor(_){this.config={flushInterval:1e4,debug:!1},this.backends=[],this.flush=()=>{for(const G of this.backends)G.flush()},this.addBackend=G=>{qp("Adding backend",!1,G),this.backends.push(G)},this.addEvent=(G,de)=>{const xe=this.getMeta(),Me={...G,meta:{...xe,...de}};for(const we of this.backends)(we.supportedEvents.length===0||we.supportedEvents.indexOf(Me.type)>-1)&&we.addEvent(Me);qp(`${G.type} event`,!1,{...G.payload,meta:Me.meta})},this.getMeta=()=>({sessionId:"",userId:ir.TP.user.id,userLogin:ir.TP.user.login,userSignedIn:ir.TP.user.isSignedIn,screenSize:{width:window.innerWidth,height:window.innerHeight},windowSize:{width:window.screen.width,height:window.screen.height},userAgent:window.navigator.userAgent,ts:new Date().getTime(),timeSinceNavigationStart:performance.now(),path:window.location.pathname,url:window.location.href}),this.config={...this.config,..._},setInterval(this.flush,this.config.flushInterval)}}var Dv=e(42614);class Pv{constructor(_){this.options=_,this.buffer=[],this.supportedEvents=[V.on.Performance],this.addEvent=G=>{this.buffer.push(G.payload)},this.flush=()=>{this.buffer.length!==0&&(ap.IB.post("/api/frontend-metrics",{events:this.buffer},{showErrorAlert:!1}).catch(()=>{}),this.buffer=[])}}}var nd=e(61298);class bv{constructor(_){this.options=_,this.supportedEvents=[V.on.Pageview,V.on.Interaction],this.addEvent=xe=>{window.applicationInsights&&((0,nd.nB)(xe)&&window.applicationInsights.trackPageView?.(),(0,nd.fX)(xe)&&window.applicationInsights.trackEvent?.({name:xe.payload.interactionName,properties:xe.payload.properties}))},this.flush=()=>{};const G={config:{connectionString:_.connectionString,endpointUrl:_.endpointUrl}};System.import("https://js.monitor.azure.com/scripts/b/ai.2.min.js").then(xe=>xe.default?xe.default:xe).then(({ApplicationInsights:xe})=>{const Me=new xe(G);window.applicationInsights=Me.loadAppInsights()})}}class Cv{constructor(_){this.options=_,this.supportedEvents=[V.on.Pageview],this.googleAnalytics4SendManualPageViews=!1,this.addEvent=xe=>{window.gtag&&this.googleAnalytics4SendManualPageViews&&window.gtag("event","page_view",{page_path:xe.payload.page})},this.flush=()=>{};const G=`https://www.googletagmanager.com/gtag/js?id=${_.googleAnalyticsId}`;rp(G,!0),window.dataLayer=window.dataLayer||[],window.gtag=function(){window.dataLayer.push(arguments)},window.gtag("js",new Date);const de={page_path:window.location.pathname};_.user&&(de.user_id=_.user.analytics.identifier),this.googleAnalytics4SendManualPageViews=_.googleAnalytics4SendManualPageViews,window.gtag("config",_.googleAnalyticsId,de)}}class Tv{constructor(_){this.options=_,this.supportedEvents=[V.on.Pageview],this.trackedUserId=null,this.addEvent=xe=>{if(!window.ga)return;window.ga("set",{page:xe.payload.page}),window.ga("send","pageview");const{userSignedIn:Me,userId:we}=xe.meta;Me&&we!==this.trackedUserId&&(this.trackedUserId=we,window.ga("set","userId",we))},this.flush=()=>{};const G=`https://www.google-analytics.com/analytics${_.debug?"_debug":""}.js`;rp(G);const de=window.ga=window.ga||function(){(de.q=de.q||[]).push(arguments)};de.l=+new Date,de("create",_.googleAnalyticsId,"auto"),de("set","anonymizeIp",!0)}}class Mv{constructor(_){this.options=_,this.supportedEvents=[V.on.Pageview,V.on.Interaction,V.on.ExperimentView],this.addEvent=Me=>{window.rudderanalytics&&((0,nd.nB)(Me)&&window.rudderanalytics.page?.(),(0,nd.fX)(Me)&&window.rudderanalytics.track?.(Me.payload.interactionName,Me.payload.properties),(0,nd.p6)(Me)&&window.rudderanalytics.track?.("experiment_viewed",{experiment_id:Me.payload.experimentId,experiment_group:Me.payload.experimentGroup,experiment_variant:Me.payload.experimentVariant}))},this.flush=()=>{};const G=_.sdkUrl||"https://cdn.rudderlabs.com/v1/rudder-analytics.min.js";rp(G);const de=window.rudderanalytics=[],xe=["load","page","track","identify","alias","group","ready","reset","getAnonymousId","setAnonymousId"];for(let Me=0;Me<xe.length;Me++){const we=xe[Me];de[we]=function(ke){return function(){de.push([ke].concat(Array.prototype.slice.call(arguments)))}}(we)}if(window.rudderanalytics?.load?.(_.writeKey,_.dataPlaneUrl,{configUrl:_.configUrl,destSDKBaseURL:_.integrationsUrl}),_.user){const{identifier:Me,intercomIdentifier:we}=_.user.analytics,ke={};we&&(ke.Intercom={user_hash:we}),window.rudderanalytics?.identify?.(Me,{email:_.user.email,orgId:_.user.orgId,language:_.user.language,version:_.buildInfo.version,edition:_.buildInfo.edition},ke)}}}var Sv=e(13515),Ov=e(88285),Iv=e(74940),Av=e(36043),Rv=e(19439),Lv=e(68738),jv=e(18024),Bv=e(54542),Uv=e(20467);class Nv extends Uv.j{constructor(){super(...arguments),this.name="EchoSrvTransport",this.version=ae.$.buildInfo.version}send(_){(0,V.x$)().addEvent({type:V.on.GrafanaJavascriptAgent,payload:_})}isBatched(){return!0}getIgnoreUrls(){return[]}}class wv{constructor(_){this.options=_,this.supportedEvents=[V.on.GrafanaJavascriptAgent],this.addEvent=Me=>{},this.flush=()=>{};const G=[],de=[new Nv];_.customEndpoint&&de.push(new Ov.m({url:_.customEndpoint,apiKey:_.apiKey})),_.errorInstrumentalizationEnabled&&G.push(new Iv.W),_.consoleInstrumentalizationEnabled&&G.push(new Av._),_.webVitalsInstrumentalizationEnabled&&G.push(new Rv.I),_.tracingInstrumentalizationEnabled&&G.push(new Bv.v),G.push(new Lv.D);const xe={globalObjectKey:_.globalObjectKey||"faro",preventGlobalExposure:_.preventGlobalExposure||!1,app:{name:"grafana-frontend",version:_.buildInfo.version,environment:_.buildInfo.env},instrumentations:G,transports:de,ignoreErrors:["ResizeObserver loop limit exceeded","ResizeObserver loop completed","Non-Error exception captured with keys"],ignoreUrls:[new RegExp(`/*${_.customEndpoint}/`),/frontend-metrics/],sessionTracking:{persistent:!0},batching:{sendTimeout:1e3},internalLoggerLevel:_.internalLoggerLevel||Sv.vI};this.faroInstance=(0,jv.p)(xe),_.user&&this.faroInstance.api.setUser({id:_.user.id,attributes:{orgId:String(_.user.orgId)||""}})}}var Wv=e(69129),Fv=e(87490),Kv=e(70497),$v=e(1702),Iu=e(4898);class Vv{constructor(_,G){this.locationService=_,this.chromeService=G,this.panelId=null,Mr.A.subscribe(Wv.Tp,de=>{this.panelId=de.payload.panelId})}clearAndInitGlobalBindings(_){Iu.R.reset(),_.chromeless||(this.bind("?",this.showHelpModal),this.bind("g h",this.goToHome),this.bind("g d",this.goToDashboards),this.bind("g e",this.goToExplore),this.bind("g a",this.openAlerting),this.bind("g p",this.goToProfile),this.bind("esc",this.exit),this.bindGlobalEsc()),this.bind("c t",()=>(0,sl.O)(!1)),this.bind("c r",()=>(0,sl.O)(!0))}bindGlobalEsc(){this.bindGlobal("esc",this.globalEsc)}globalEsc(){const G=document.activeElement;if(!(document.querySelectorAll(".slate-typeahead--open").length>0)){if(G&&G instanceof HTMLElement&&(G.nodeName==="INPUT"||G.nodeName==="TEXTAREA"||G.hasAttribute("data-slate-editor"))){G.blur();return}this.exit()}}closeSearch(){this.locationService.partial({search:null})}openAlerting(){this.locationService.push("/alerting")}goToDashboards(){this.locationService.push("/dashboards")}goToHome(){this.locationService.push("/")}goToProfile(){this.locationService.push("/profile")}goToExplore(){this.locationService.push("/explore")}showHelpModal(){Mr.A.publish(new to.S8({component:_d.N}))}exit(){const _=this.locationService.getSearchObject();if(_.editview){this.locationService.partial({editview:null,editIndex:null});return}if(_.inspect){this.locationService.partial({inspect:null,inspectTab:null});return}if(_.editPanel){this.locationService.partial({editPanel:null,tab:null});return}if(_.viewPanel){this.locationService.partial({viewPanel:null,tab:null});return}const{kioskMode:G}=this.chromeService.state.getValue();G&&this.chromeService.exitKioskMode(),_.search&&this.closeSearch()}showDashEditView(){this.locationService.partial({editview:"settings"})}bind(_,G){Iu.R.bind(_,de=>{de.preventDefault(),de.stopPropagation(),de.returnValue=!1,G.call(this)},"keydown")}bindGlobal(_,G){Iu.R.bindGlobal(_,de=>{de.preventDefault(),de.stopPropagation(),de.returnValue=!1,G.call(this)},"keydown")}unbind(_,G){Iu.R.unbind(_,G)}bindWithPanelId(_,G){this.bind(_,this.withFocusedPanel(G))}withFocusedPanel(_){return()=>{if(typeof this.panelId=="number"){_(this.panelId);return}}}setupTimeRangeBindings(_=!0){this.bind("t a",()=>{Mr.A.publish(new to.Rh({updateUrl:_}))}),this.bind("t z",()=>{Mr.A.publish(new to.U0({scale:2,updateUrl:_}))}),this.bind("ctrl+z",()=>{Mr.A.publish(new to.U0({scale:2,updateUrl:_}))}),this.bind("t left",()=>{Mr.A.publish(new to.Io({direction:to.xL.Left,updateUrl:_}))}),this.bind("t right",()=>{Mr.A.publish(new to.Io({direction:to.xL.Right,updateUrl:_}))}),this.bind("t c",()=>{Mr.A.publish(new to.Bt)}),this.bind("t v",()=>{Mr.A.publish(new to.VZ({updateUrl:_}))})}setupDashboardBindings(_){this.bind("mod+o",()=>{_.graphTooltip=(_.graphTooltip+1)%3,_.events.publish(new Fi.Tq),_.startRefresh()}),this.bind("mod+s",()=>{_.meta.canSave&&Mr.A.publish(new to.S8({component:Kv.$,props:{dashboard:_}}))}),this.setupTimeRangeBindings(),this.bindWithPanelId("e",G=>{if(_.canEditPanelById(G)){const de=this.locationService.getSearchObject().editPanel!==void 0;this.locationService.partial({editPanel:de?null:G})}}),this.bindWithPanelId("v",G=>{const de=this.locationService.getSearchObject().viewPanel!==void 0;this.locationService.partial({viewPanel:de?null:G})}),this.bindWithPanelId("p l",G=>{const de=_.getPanelById(G),xe={...de.options};xe.legend.showLegend?xe.legend.showLegend=!1:xe.legend.showLegend=!0,de.updateOptions(xe)}),this.bindWithPanelId("i",G=>{this.locationService.partial({inspect:G})}),Wa.TP.hasAccessToExplore()&&this.bindWithPanelId("p x",async G=>{const de=_.getPanelById(G),xe=await(0,Fv.Xe)({queries:de.targets,dsRef:de.datasource,scopedVars:de.scopedVars,timeRange:(0,qo.jG)().timeRange()});if(xe){const Me=b.I.stripBaseFromUrl(xe);Me&&this.locationService.push(Me)}}),this.bindWithPanelId("p r",G=>{_.canEditPanelById(G)&&!(_.panelInView||_.panelInEdit)&&Mr.A.publish(new to.Vz(G))}),this.bindWithPanelId("p d",G=>{if(_.canEditPanelById(G)){const de=_.getPanelInfoById(G).index;_.duplicatePanel(_.panels[de])}}),this.bindWithPanelId("p s",G=>{const de=_.getPanelInfoById(G);Mr.A.publish(new to.S8({component:$v.ShareModal,props:{dashboard:_,panel:de?.panel}}))}),this.bind("d l",()=>{_.toggleLegendsForAll()}),this.bind("d x",()=>{_.toggleExemplarsForAll()}),this.bind("d shift+c",()=>{_.collapseRows()}),this.bind("d shift+e",()=>{_.expandRows()}),this.bind("d n",()=>{this.locationService.push("/dashboard/new")}),this.bind("d r",()=>{_.startRefresh()}),this.bind("d s",()=>{this.showDashEditView()}),this.bind("d k",()=>{this.chromeService.onToggleKioskMode()}),this.bind("d a",()=>{const de=this.locationService.getSearchObject().autofitpanels?"":"&autofitpanels";window.location.href=window.location.href+de})}}var cc=e(78160);async function nP(){if(window.location.search.indexOf("why-render")!==-1){const{default:W}=await e.e(3718).then(e.t.bind(e,13718,23));W(React,{trackAllPureComponents:!0})}}var _v=e(20120);const zv=(0,l.lazy)(()=>e.e(192).then(e.bind(e,57029)));function Hv(){const W=(0,Ir.Wd)(Wi.hY),_=ae.$.unifiedAlertingEnabled;ir.TP.hasPermission(W.read)&&(0,_v.fP)({show:()=>_,component:({dashboard:G})=>_?(0,j.jsx)(l.Suspense,{fallback:null,children:G&&(0,j.jsx)(zv,{dashboardUid:G.uid})},"alert-rules-button"):null,index:-2})}var kv=e(73399);function Gv(W){return(0,j.jsx)(Qv,{...W})}const Qv=(0,l.lazy)(async()=>{const{EmbeddedDashboard:W}=await e.e(2859).then(e.bind(e,13251));return{default:W}});var Yv=e(61582),Jv=e(67027),Xv=e(97527),sP=e(99355),sd=e(14590),Zv=e(19895),qv=e(44838);const ey=()=>new ea.c(new URL(e.p+e.u(5358),e.b));var ty=e(88483),em=e(63720);const ny=W=>new ty.c(_=>{const G=W.subscribe(sd.BX(de=>{_.next(de)}),sd.BX(de=>{_.error(de)}),sd.BX(()=>{_.complete()}));return{unsubscribe:()=>{G.then(de=>de.unsubscribe())}}}),op=W=>(0,Xr.H)(W).pipe((0,em.n)(_=>ny(_)));class sy{constructor(_){this.getConnectionState=()=>op(this.centrifugeWorker.getConnectionState()),this.getDataStream=G=>op(this.centrifugeWorker.getDataStream(G)).pipe((0,Zv.Q)(qv.E)),this.getQueryData=async G=>{const de=JSON.parse(JSON.stringify(G));return this.centrifugeWorker.getQueryData(de)},this.getPresence=G=>this.centrifugeWorker.getPresence(G),this.getStream=G=>op(this.centrifugeWorker.getStream(G)),this.centrifugeWorker=sd.LV(ey()),this.centrifugeWorker.initialize(_,sd.BX(_.dataStreamSubscriberReadiness))}}var tm=e(9631),ay=e(55004),ry=e(47773),nm=e(26657),Au=e(47118);class oy{constructor(_){this.deps=_,this.getConnectionState=()=>this.deps.centrifugeSrv.getConnectionState(),this.getDataStream=G=>{let de;const xe=Me=>{const we=Me.data[0];if(!de&&!(0,Au.ot)(we,Au._w.FullFrame)){console.warn(`expected first packet to contain a full frame, received ${we?.type}`);return}switch(we.type){case Au._w.FullFrame:{de=tm.k9.deserialize(we.frame);return}case Au._w.NewValuesSameSchema:{de.pushNewValues(we.values);return}}};return this.deps.centrifugeSrv.getDataStream(G).pipe((0,Tt.T)(Me=>(xe(Me),{...Me,data:[de??tm.k9.empty()]})))},this.getStream=G=>this.deps.centrifugeSrv.getStream(G),this.getQueryData=G=>(0,Xr.H)(this.deps.centrifugeSrv.getQueryData(G)).pipe((0,em.n)(de=>{const xe=(0,ry.bE)(de,G.request.targets);return xe.data?.length&&xe.data.find(we=>we.meta?.channel)?(0,nm.x7)(xe,G.request,nm.ph):(0,Xn.of)(xe)})),this.publish=async(G,de)=>this.deps.backendSrv.post("api/live/publish",{channel:(0,ay.Qp)(G),data:de}),this.getPresence=G=>this.deps.centrifugeSrv.getPresence(G)}}function iy(){const W={appUrl:`${window.location.origin}${ae.$.appSubUrl}`,orgId:ir.TP.user.orgId,orgRole:ir.TP.user.orgRole,liveEnabled:ae.$.liveEnabled,dataStreamSubscriberReadiness:Yv.a.ok.asObservable(),grafanaAuthToken:(0,Jv.r)()},_=ae.$.featureToggles["live-service-web-worker"]?new sy(W):new Xv.w(W);(0,Zc.S8)(new oy({centrifugeSrv:_,backendSrv:(0,M.AI)()}))}function aP(){return getGrafanaLiveSrv()}var ly=e(17888),cy=e(20726),yr=e(75462),sm=e(29436),dy=e(23994),uy=e(11140),hy=e(12881);function fy(){try{return[(0,yr.io)({title:"Add to dashboard",description:"Use the query and panel from explore and create/add it to a dashboard",extensionPointId:Tl.S.ExploreToolbarAction,icon:"apps",category:"Dashboards",configure:()=>{if(Wa.TP.hasPermission(wn.AccessControlAction.DashboardsCreate)||Wa.TP.hasPermission(wn.AccessControlAction.DashboardsWrite))return{}},onClick:(W,{context:_,openModal:G})=>{G({title:(0,hy.t)(),body:({onDismiss:de})=>(0,j.jsx)(uy.v,{onClose:de,exploreId:_?.exploreId})})}}),(0,yr.io)({title:"Add correlation",description:"Create a correlation from this query",extensionPointId:Tl.S.ExploreToolbarAction,icon:"link",configure:W=>W?.shouldShowAddCorrelation?{}:void 0,onClick:(W,{context:_})=>{(0,er.JD)((0,sm.am)({editorMode:!0})),(0,er.JD)((0,dy.Od)({exploreId:_.exploreId}))}})]}catch(W){return(0,yr.FF)(`Could not configure extensions for Explore due to: "${W}"`),[]}}function gy(){return[...fy()]}function rP(W,_="extension is not a link extension"){if(!isPluginExtensionLink(W))throw new Error(_)}function oP(W,_="extension is not a command extension config"){if(!isPluginExtensionLinkConfig(W))throw new Error(_)}function am(W,_){if(!yy(W,_))throw new Error(`Invalid link extension. The "path" is required and should start with "/a/${W}/" (currently: "${_}"). Skipping the extension.`)}function rm(W){if(!by(W))throw new Error('Invalid component extension, the "component" property needs to be a valid React component.')}function py(W,_){if(!xy(W,_))throw new Error(`Invalid extension "${_.title}". The extensionPointId should start with either "grafana/", "plugins/" or "capabilities/${W}" (currently: "${_.extensionPointId}"). Skipping the extension.`)}function my(W){if(!Ey(W))throw new Error(`Invalid extension "${W.title}". The "configure" property must be a function. Skipping the extension.`)}function om(W,_){for(const G of _)if(!Dy(W[G]))throw new Error(`Invalid extension "${W.title}". Property "${G}" must be a string and cannot be empty. Skipping the extension.`)}function vy(W,_="The provided value is a Promise."){if(im(W))throw new Error(_)}function yy(W,_){return!!(typeof _=="string"&&_.length>0&&_.startsWith(`/a/${W}/`))}function xy(W,_){return!!(_.extensionPointId?.startsWith("grafana/")||_.extensionPointId?.startsWith("plugins/")||_.extensionPointId?.startsWith(`capabilities/${W}/`))}function Ey(W){return W.configure?typeof W.configure=="function":!0}function Dy(W){return typeof W=="string"&&W.length>0}function Py(W,_){try{if(om(_,["title","description","extensionPointId"]),py(W,_),(0,yr.z1)(_)){if(my(_),!_.path&&!_.onClick)return(0,yr.FF)(`Invalid extension "${_.title}". Either "path" or "onClick" is required.`),!1;_.path&&am(W,_.path)}return(0,yr.yS)(_)&&rm(_.component),!0}catch(G){return G instanceof Error&&(0,yr.FF)(G.message),!1}}function im(W){return W instanceof Promise||typeof W=="object"&&W!==null&&"then"in W&&"catch"in W}function by(W){const _=de=>typeof de=="object"&&de!==null&&"$$typeof"in de;return typeof W=="function"||(de=>_(de)&&de.$$typeof===Symbol.for("react.memo"))(W)}function Cy(W){let _={id:"",extensions:{}};return W.asObservable().subscribe(G=>{_=G}),G=>lm({...G,registry:_})}const lm=({context:W,extensionPointId:_,limitPerPlugin:G,registry:de})=>{const xe=W?(0,yr.$Y)(W):{},Me=de.extensions[_]??[],we=[],ke={};for(const Xe of Me)try{const ht=Xe.config,{pluginId:mt}=Xe;if(G&&ke[mt]>=G)continue;if(ke[mt]===void 0&&(ke[mt]=0),(0,yr.z1)(ht)){const bt=Ty(mt,ht,xe);if(ht.configure&&bt===void 0)continue;const Kt=bt?.path||ht.path,Rt={id:(0,yr.yt)(mt,ht),type:Tl.u.link,pluginId:mt,onClick:My(mt,ht,xe),icon:bt?.icon||ht.icon,title:bt?.title||ht.title,description:bt?.description||ht.description,path:(0,m.isString)(Kt)?Sy(mt,Kt,ht):void 0,category:bt?.category||ht.category};we.push(Rt),ke[mt]+=1}if((0,yr.yS)(ht)){rm(ht.component);const bt={id:(0,yr.yt)(Xe.pluginId,ht),type:Tl.u.component,pluginId:Xe.pluginId,title:ht.title,description:ht.description,component:(0,yr.nv)(mt,ht.component)};we.push(bt),ke[mt]+=1}}catch(ht){ht instanceof Error&&(0,yr.FF)(ht.message)}return{extensions:we}};function Ty(W,_,G){try{const de=_.configure?.(G);if(de===void 0)return;let{title:xe=_.title,description:Me=_.description,path:we=_.path,icon:ke=_.icon,category:Xe=_.category,...ht}=de;return vy(de,`The configure() function for "${_.title}" returned a promise, skipping updates.`),we&&am(W,we),om({title:xe,description:Me},["title","description"]),Object.keys(ht).length>0&&(0,yr.FF)(`Extension "${_.title}", is trying to override restricted properties: ${Object.keys(ht).join(", ")} which will be ignored.`),{title:xe,description:Me,path:we,icon:ke,category:Xe}}catch(de){de instanceof Error&&(0,yr.FF)(de.message);return}}function My(W,_,G){const{onClick:de}=_;if(de)return function(Me){try{(0,Vr.rR)("ui_extension_link_clicked",{pluginId:W,extensionPointId:_.extensionPointId,title:_.title,category:_.category});const we=de(Me,(0,yr.yb)(W,G));im(we)&&we.catch(ke=>{ke instanceof Error&&(0,yr.FF)(ke.message)})}catch(we){we instanceof Error&&(0,yr.FF)(we.message)}}}function Sy(W,_,G){return sp.kM.appendQueryToUrl(_,sp.kM.toUrlParams({uel_pid:W,uel_epid:G.extensionPointId}))}var Ru=e(13752),cm=e(39741),Oy=e(29405),Iy=e(96222),Ay=e(72985),dm=e(62938);class Ry{constructor(){this.resultSubject=new Ru.B,this.registrySubject=new cm.m(1),this.resultSubject.pipe((0,Oy.S)(Ly,{id:"",extensions:{}}),(0,Iy.Z)({id:"",extensions:{}}),(0,Tt.T)(_=>(0,yr.ol)(_))).subscribe(this.registrySubject)}register(_){this.resultSubject.next(_)}asObservable(){return this.registrySubject.asObservable()}getRegistry(){return(0,Ay._)(this.asObservable())}}function Ly(W,_){const{pluginId:G,extensionConfigs:de,error:xe}=_;if(xe)return(0,yr.FF)(`"${G}" plugin failed to load, skip registering its extensions.`),W;for(const Me of de){const{extensionPointId:we}=Me;if((0,yr.WW)(Me)){const ht=/capabilities\/([a-zA-Z0-9_.\-\/]+)$/.exec(we);if(!ht){(0,yr.FF)(`"${G}" plugin has an invalid capability ID: ${we.replace("capabilities/","")} (It must be a string)`);continue}Me.extensionPointId=`capabilities/${ht[1]}`}if(!Me||!Py(G,Me))return W;let ke={config:Me,pluginId:G};(0,yr.WW)(Me)?W.extensions[we]=[ke]:Array.isArray(W.extensions[we])?W.extensions[we].push(ke):W.extensions[we]=[ke]}return W.id=(0,dm.A)(),W}function jy(W){const _=W.asObservable();return function(de){const xe=(0,ac.A)(_);return(0,l.useMemo)(()=>{if(!xe)return{isLoading:!1,component:null};const Me=`capabilities/${de}`,we=xe.extensions[Me],ke=Array.isArray(we)?we[0]:null;return ke&&(0,yr.yS)(ke.config)?{isLoading:!1,component:(0,yr.nv)(ke.pluginId,ke.config.component)}:{isLoading:!1,component:null}},[de,xe])}}function By(W){const _=W.asObservable(),G={id:"",extensions:{}};return function(xe){const Me=(0,ac.A)(_);if(!Me)return{extensions:[],isLoading:!1};Me.id!==G.id&&(G.id=Me.id,G.extensions={});const we=`${xe.extensionPointId}-${xe.limitPerPlugin}`;if(G.extensions[we]&&G.extensions[we].context===xe.context)return{extensions:G.extensions[we].extensions,isLoading:!1};const{extensions:ke}=lm({...xe,registry:Me});return G.extensions[we]={context:xe.context,extensions:ke},{extensions:ke,isLoading:!1}}}var um=e(15162);async function hm(W=[],_,G="frontend_plugins_preload"){(0,cc.j)(G);const de=W.filter(Me=>Me.preload).map(Me=>Uy(Me)),xe=await Promise.all(de);for(const Me of xe)_.register(Me);(0,cc.z)(G)}async function Uy(W){const{path:_,version:G,id:de}=W;try{(0,cc.j)(`frontend_plugin_preload_${de}`);const{plugin:xe}=await wd.j4({path:_,version:G,isAngular:W.angular.detected,pluginId:de}),{extensionConfigs:Me=[]}=xe;return(0,Ic.x)(de),{pluginId:de,extensionConfigs:Me}}catch(xe){return console.error(`[Plugins] Failed to preload plugin: ${_} (version: ${G})`,xe),{pluginId:de,extensionConfigs:[],error:xe}}finally{(0,cc.z)(`frontend_plugin_preload_${de}`)}}var Ny=e(57532),fm=e(41987),gm=e(65879),wy=e(80924),Wy=e(72955),ip=e(39374);class Fy{constructor(){this.subject=new cm.m(1)}get(){return this.subject.asObservable()}run(_){const{queries:G,timezone:de,datasource:xe,panelId:Me,app:we,dashboardUID:ke,timeRange:Xe,timeInfo:ht,cacheTimeout:mt,queryCachingTTL:bt,maxDataPoints:Kt,scopedVars:Rt,minInterval:Ct}=_;this.subscription&&this.subscription.unsubscribe();const Ut={app:we??fm.Jk.Unknown,requestId:(0,wy.S)(),timezone:de,panelId:Me,dashboardUID:ke,range:Xe,timeInfo:ht,interval:"",intervalMs:0,targets:(0,m.cloneDeep)(G),maxDataPoints:Kt,scopedVars:Rt||{},cacheTimeout:mt,queryCachingTTL:bt,startTime:Date.now()};Ut.rangeRaw=Xe.raw,(0,Xr.H)(Ky(xe,Ut.scopedVars)).pipe((0,Ny.$)()).subscribe({next:hn=>{Ut.targets=Ut.targets.map(Ds=>(Ds.datasource||(Ds.datasource=hn.getRef()),Ds));const Zn=Ct?(0,je.w)().replace(Ct,Ut.scopedVars):hn.interval,As=gm.calculateInterval(Xe,Kt,Zn);Ut.scopedVars=Object.assign({},Ut.scopedVars,{__interval:{text:As.interval,value:As.interval},__interval_ms:{text:As.intervalMs.toString(),value:As.intervalMs}}),Ut.interval=As.interval,Ut.intervalMs=As.intervalMs,this.subscription=(0,ip.BN)(hn,Ut).subscribe({next:Ds=>{const Fs=(0,Fo.N$)(Ds,this.lastResult);this.lastResult=(0,Wy.B)(Fs,this.lastResult),this.subject.next(this.lastResult)}})},error:hn=>console.error("PanelQueryRunner Error",hn)})}cancel(){this.subscription&&(this.subscription.unsubscribe(),this.lastResult&&this.lastResult.state===_r.Gu.Loading&&this.subject.next({...this.lastResult,state:_r.Gu.Done}))}destroy(){this.subject&&this.subject.complete(),this.subscription&&this.subscription.unsubscribe()}}async function Ky(W,_){return W&&"query"in W?W:(0,c.tR)().get(W,_)}function $y(){window.grafanaRuntime={getDashboardSaveModel:()=>{const W=(0,h.UA)().getCurrent();if(W)return W.getSaveModelCloneOld()},getDashboardTimeRange:()=>{const W=(0,qo.jG)().timeRange();return{from:W.from.valueOf(),to:W.to.valueOf(),raw:W.raw}},getPanelData:()=>{const W=(0,h.UA)().getCurrent();if(W)return W.panels.reduce((_,G)=>(_[G.id]=G.getQueryRunner().getLastResult(),_),{})}}}var Vy=e(16757),ad=e(20601),Hs=e(75096),pm=e(22391),_y=e(27803),$i=e(3843);function mm(W){return W.extended&&"infoText"in W.extended?W.extended:null}function vm(W){return W.extended&&"dataSourceTypes"in W.extended?W.extended:null}function lp(W){return W.extended&&"dataSource"in W.extended?W.extended:null}var Qa=e(87421),rd=e(26260);const zy=(W,_)=>{const{rootStateKey:G}=_.variable;if(!G)return console.error("AdHocVariableEditor: variable has no rootStateKey"),{extended:mm($i.nS)};const{editor:de}=(0,Qa.nx)(G,W);return{extended:mm(de)}},Hy={changeVariableDatasource:rd.Iv},ky=(0,ka.connect)(zy,Hy);class Gy extends l.PureComponent{constructor(){super(...arguments),this.onDatasourceChanged=_=>{this.props.changeVariableDatasource((0,Hs.jX)(this.props.variable),(0,pm.p$)(_))}}componentDidMount(){const{rootStateKey:_}=this.props.variable;if(!_){console.error("AdHocVariableEditor: variable has no rootStateKey");return}}render(){const{variable:_,extended:G}=this.props;return(0,j.jsx)(_y.Q,{datasource:_.datasource??void 0,onDataSourceChange:this.onDatasourceChanged,infoText:G?.infoText})}}const Qy=ky(Gy);var ym=e(38401),cp=e(83684);const xm=90,Em=({datasource:W,onChange:_,disabled:G,filterKey:de,allFilters:xe})=>{const Me=()=>Dm(W,de,xe),we=()=>Xy(W,de,xe);return de===null?(0,j.jsx)("div",{className:"gf-form","data-testid":"AdHocFilterKey-add-key-wrapper",children:(0,j.jsx)(cp.s,{disabled:G,className:"query-segment-key",Component:Jy,value:de,onChange:_,loadOptions:Me,inputMinWidth:xm})}):(0,j.jsx)("div",{className:"gf-form","data-testid":"AdHocFilterKey-key-wrapper",children:(0,j.jsx)(cp.s,{disabled:G,className:"query-segment-key",value:de,onChange:_,loadOptions:we,inputMinWidth:xm})})},Lu="-- remove filter --",Yy={label:Lu,value:Lu},Jy=(0,j.jsx)("span",{className:"gf-form-label query-part","aria-label":"Add Filter",children:(0,j.jsx)(Is.I,{name:"plus"})}),Dm=async(W,_,G)=>{const de=await(0,c.tR)().get(W);if(!de||!de.getTagKeys)return[];const xe=G.filter(ke=>ke.key!==_),Me=await de.getTagKeys({filters:xe});return(Array.isArray(Me)?Me:Me.data).map(ke=>({label:ke.text,value:ke.text}))},Xy=async(W,_,G)=>{const de=await Dm(W,_,G);return[Yy,...de]},Zy=({datasource:W,disabled:_,onChange:G,filterKey:de,filterValue:xe,placeHolder:Me,allFilters:we})=>{const ke=(0,pt.of)(ex),Xe=()=>qy(W,de,we);return(0,j.jsx)("div",{className:"gf-form","data-testid":"AdHocFilterValue-value-wrapper",children:(0,j.jsx)(cp.s,{className:ke.segment,disabled:_,placeholder:Me,value:xe,onChange:G,loadOptions:Xe})})},qy=async(W,_,G)=>{const de=await(0,c.tR)().get(W);if(!de||!de.getTagValues)return[];const xe=(0,qo.jG)().timeRange(),Me=G.filter(Xe=>Xe.key!==_),we=await de.getTagValues({key:_,filters:Me,timeRange:xe});return(Array.isArray(we)?we:we.data).map(Xe=>({label:Xe.text,value:Xe.text}))};function ex(){return{segment:(0,Qe.css)({display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"500px"})}}const tx=["=","!=","<",">","=~","!~"].map(W=>({label:W,value:W})),nx=({value:W,disabled:_,onChange:G})=>(0,j.jsx)(ym.Y,{className:"query-segment-operator",value:W,disabled:_,options:tx,onChange:G}),Pm=({datasource:W,filter:{key:_,operator:G,value:de},onKeyChange:xe,onOperatorChange:Me,onValueChange:we,placeHolder:ke,allFilters:Xe,disabled:ht})=>(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(Em,{disabled:ht,datasource:W,filterKey:_,onChange:xe,allFilters:Xe}),(0,j.jsx)("div",{className:"gf-form",children:(0,j.jsx)(nx,{disabled:ht,value:G,onChange:Me})}),(0,j.jsx)(Zy,{disabled:ht,datasource:W,filterKey:_,filterValue:de,allFilters:Xe,onChange:we,placeHolder:ke})]}),sx=({datasource:W,appendBefore:_,onCompleted:G,allFilters:de})=>{const[xe,Me]=(0,l.useState)(null),[we,ke]=(0,l.useState)("="),Xe=(0,l.useCallback)(bt=>{if(bt.value!==Lu){Me(bt.value??"");return}Me(null)},[Me]),ht=(0,l.useCallback)(bt=>ke(bt.value??""),[ke]),mt=(0,l.useCallback)(bt=>{G({value:bt.value??"",operator:we,key:xe}),Me(null),ke("=")},[G,we,xe]);return xe===null?(0,j.jsx)(Em,{datasource:W,filterKey:xe,onChange:Xe,allFilters:de}):(0,j.jsxs)(l.Fragment,{children:[_,(0,j.jsx)(Pm,{datasource:W,filter:{key:xe,value:"",operator:we},placeHolder:(0,aa.t)("variable.adhoc.placeholder","Select value"),onKeyChange:Xe,onOperatorChange:ht,onValueChange:mt,allFilters:de})]},"filter-builder")},bm=({label:W})=>(0,j.jsx)("div",{className:"gf-form",children:(0,j.jsx)("span",{className:"gf-form-label query-keyword",children:W})});class ax extends l.PureComponent{constructor(){super(...arguments),this.onChange=(_,G)=>de=>{const{filters:xe}=this.props,{value:Me}=de;return de.value===Lu?this.props.removeFilter(_):this.props.changeFilter(_,{...xe[_],[G]:Me})},this.appendFilterToVariable=_=>{this.props.addFilter(_)}}render(){const{filters:_,disabled:G}=this.props;return(0,j.jsxs)("div",{className:"gf-form-inline",children:[this.renderFilters(_,G),!G&&(0,j.jsx)(sx,{datasource:this.props.datasource,appendBefore:_.length>0?(0,j.jsx)(bm,{label:"AND"}):null,onCompleted:this.appendFilterToVariable,allFilters:this.getAllFilters()})]})}getAllFilters(){return this.props.baseFilters?this.props.baseFilters.concat(this.props.filters):this.props.filters}renderFilters(_,G){return _.length===0&&G?(0,j.jsx)(ym.Y,{disabled:G,value:"No filters",options:[],onChange:()=>{}}):_.reduce((de,xe,Me)=>(de.length>0&&de.push((0,j.jsx)(bm,{label:"AND"},`condition-${Me}`)),de.push(this.renderFilterSegments(xe,Me,G)),de),[])}renderFilterSegments(_,G,de){return(0,j.jsx)(l.Fragment,{children:(0,j.jsx)(Pm,{disabled:de,datasource:this.props.datasource,filter:_,onKeyChange:this.onChange(G,"key"),onOperatorChange:this.onChange(G,"operator"),onValueChange:this.onChange(G,"value"),allFilters:this.getAllFilters()})},`filter-${G}`)}}const rx={addFilter:rd.U2,removeFilter:rd.VT,changeFilter:rd.$u},ox=(0,ka.connect)(null,rx);class ix extends l.PureComponent{constructor(){super(...arguments),this.addFilter=_=>{this.props.addFilter((0,Hs.jX)(this.props.variable),_)},this.removeFilter=_=>{this.props.removeFilter((0,Hs.jX)(this.props.variable),_)},this.changeFilter=(_,G)=>{this.props.changeFilter((0,Hs.jX)(this.props.variable),{index:_,filter:G})}}render(){const{filters:_,datasource:G,baseFilters:de}=this.props.variable;return(0,j.jsx)(ax,{datasource:G,filters:_,baseFilters:de,disabled:this.props.readOnly,addFilter:this.addFilter,removeFilter:this.removeFilter,changeFilter:this.changeFilter})}}const Cm=ox(ix);Cm.displayName="AdHocPicker";var Tm=e(53699);const lx=W=>W.map(_=>hx(_).map(dx).join("|")),cx=W=>{if((0,m.isArray)(W))return W.map(Mm).filter(fx);const _=Mm(W);return _===null?[]:[_]};function dx(W){return W==null?"":/\|/g[Symbol.replace](W,"__gfp__")}function ux(W){return W==null?"":/__gfp__/g[Symbol.replace](W,"|")}function hx(W){return[W.key,W.operator,W.value]}function Mm(W){if(!(0,m.isString)(W)||W.length===0)return null;const _=W.split("|").map(ux);return{key:_[0],operator:_[1],value:_[2]}}function fx(W){return W!==null&&(0,m.isString)(W.value)}const Sm=async()=>{},gx=()=>({id:"adhoc",description:"Add key/value filters on the fly.",name:"Ad hoc filters",initialState:Tm.MK,reducer:Tm.AA,picker:Cm,editor:Qy,dependsOn:()=>!1,setValue:Sm,setValueFromUrl:async(W,_)=>{const G=cx(_);await(0,er.JD)((0,rd.D4)((0,Hs.jX)(W),G))},updateOptions:Sm,getSaveModel:W=>{const{index:_,id:G,state:de,global:xe,rootStateKey:Me,...we}=(0,m.cloneDeep)(W);return we},getValueForUrl:W=>{const _=W?.filters??[];return lx(_)}});var ju=e(14644),px=e(8866),uo=e(13344),io=e(24240),Om=e(13288),mx=e(44240),Bu=e(16126),vx=e(38975),yx=e(67791),xx=e(66847),Ex=e(69850),Wr=e(72401),tr=e(48594),Bl=e(12470),od=e(83370),dc=e(80484);const Dx={...dc.Vg,type:"query",datasource:null,query:"",regex:"",sort:Bl.ZG.disabled,refresh:Bl.CO.onDashboardLoad,multi:!1,includeAll:!1,allValue:null,options:[],current:{},definition:""},Px=(W,_)=>{if(_===Bl.ZG.disabled)return W;const G=Math.ceil(_/2),de=_%2===0;return G===1?W=(0,m.sortBy)(W,"text"):G===2?W=(0,m.sortBy)(W,xe=>{if(!xe.text)return-1;const Me=xe.text.match(/.*?(\d+).*/);return!Me||Me.length<2?-1:parseInt(Me[1],10)}):G===3?W=(0,m.sortBy)(W,xe=>(0,m.toLower)(xe.text)):G===4&&W.sort((xe,Me)=>xe.text?Me.text?xe.text.localeCompare(Me.text,void 0,{numeric:!0}):1:-1),de&&(W=W.reverse()),W},bx=(W,_)=>{const G=[];let de=null;_.lastIndex=0;do de=_.exec(W),de&&G.push(de);while(_.global&&de&&de[0]!==""&&de[0]!==void 0);return G},Cx=(W,_,G)=>{let de,xe=[];W&&(de=(0,Hr.dO)(W));for(let Me=0;Me<G.length;Me++){const we=G[Me];let ke=we.text===void 0||we.text===null?we.value:we.text,Xe=we.value===void 0||we.value===null?we.text:we.value;if((0,m.isNumber)(Xe)&&(Xe=Xe.toString()),(0,m.isNumber)(ke)&&(ke=ke.toString()),de){const ht=bx(Xe,de);if(!ht.length)continue;const mt=ht.find(Ct=>Ct.groups&&Ct.groups.value),bt=ht.find(Ct=>Ct.groups&&Ct.groups.text),Kt=ht.find(Ct=>Ct.length>1),Rt=ht.length>1&&Kt;if(mt||bt)Xe=mt?.groups?.value??bt?.groups?.text,ke=bt?.groups?.text??mt?.groups?.value;else if(Rt){for(let Ct=0;Ct<ht.length;Ct++){const Ut=ht[Ct];xe.push({text:Ut[1],value:Ut[1],selected:!1})}continue}else Kt&&(ke=Kt[1],Xe=Kt[1])}xe.push({text:ke,value:Xe,selected:!1})}return xe=(0,m.uniqBy)(xe,"value"),Px(xe,_)},Im=(0,Ho.Z0)({name:"templating/query",initialState:od.j,reducers:{updateVariableOptions:(W,_)=>{const{results:G,templatedRegex:de}=_.payload.data,xe=(0,Qa.Fs)(W,_.payload.id);if(xe.type!=="query")return;const{includeAll:Me,sort:we}=xe,ke=Cx(de,we,G);Me&&ke.unshift({text:uo.Zm,value:uo.To,selected:!1}),ke.length||ke.push({text:uo.ou,value:uo.Ek,isNone:!0,selected:!1}),xe.options=ke}}}),Tx=Im.reducer,{updateVariableOptions:Mx}=Im.actions;function Sx(){return W=>W.pipe((0,Tt.T)(Ox))}function Ox(W){const _=W.series;if(!_||!_.length)return[];if(Rx(_))return _;const G=(0,Fo.Bt)(_),de=[];let xe=-1,Me=-1,we=-1,ke=-1;for(const Xe of G)for(let ht=0;ht<Xe.fields.length;ht++){const mt=Xe.fields[ht],bt=(0,z.Ct)(mt,Xe,_).toLowerCase();mt.type===te.PU.string&&we===-1&&(we=ht),bt==="text"&&mt.type===te.PU.string&&Me===-1&&(Me=ht),bt==="value"&&mt.type===te.PU.string&&xe===-1&&(xe=ht),bt==="expandable"&&(mt.type===te.PU.boolean||mt.type===te.PU.number)&&ke===-1&&(ke=ht)}if(we===-1)throw new Error("Couldn't find any field of type string in the results.");for(const Xe of G)for(let ht=0;ht<Xe.length;ht++){const mt=ke!==-1?Xe.fields[ke].values[ht]:void 0,bt=Xe.fields[we].values[ht],Kt=Me!==-1?Xe.fields[Me].values[ht]:null,Rt=xe!==-1?Xe.fields[xe].values[ht]:null;if(xe===-1&&Me===-1){de.push({text:bt,value:bt,expandable:mt});continue}if(xe===-1&&Me!==-1){de.push({text:Kt,value:Kt,expandable:mt});continue}if(xe!==-1&&Me===-1){de.push({text:Rt,value:Rt,expandable:mt});continue}de.push({text:Kt,value:Rt,expandable:mt})}return de}function Ix(W){return _=>_.pipe((0,Tt.T)(G=>{const{variable:de,dispatch:xe,getTemplatedRegexFunc:Me}=W;if(!de.rootStateKey){console.error("updateOptionsState: variable.rootStateKey is not defined");return}const we=Me(de),ke=(0,Hs.qD)(de,{results:G,templatedRegex:we});xe((0,tr.kb)(de.rootStateKey,Mx(ke)))}))}function Ax(W){return _=>_.pipe((0,Fr.Z)(()=>{const{dispatch:G,variable:de,searchFilter:xe}=W;return xe?(0,Xn.of)():(0,Xr.H)(G((0,Wr.kl)((0,Hs.jX)(de))))}))}function Rx(W){if(!W)return!1;if(!W.length)return!0;const _=W[0];if((0,Fo.ci)(_))return!1;for(const G in _){if(!_.hasOwnProperty(G)||_[G]!==null&&typeof _[G]!="string"&&typeof _[G]!="number")continue;const de=G.toLowerCase();if(de==="text"||de==="value")return!0}return!1}var Uu=e(29505),Lx=e(43127);class jx{constructor(){this.runners=[new Bx,new Ux,new Nx,new Wx]}getRunnerForDatasource(_){const G=this.runners.find(de=>de.canRun(_));if(G)return G;throw new Error("Couldn't find a query runner that matches supplied arguments.")}isQueryRunnerAvailableForDatasource(_){return this.runners.some(G=>G.canRun(_))}}class Bx{constructor(){this.type=Uu.Qz.Legacy}canRun(_){return(0,io.d5)(_)}getTarget({datasource:_,variable:G}){if((0,io.d5)(_))return G.query;throw new Error("Couldn't create a target with supplied arguments.")}runRequest({datasource:_,variable:G,searchFilter:de,timeSrv:xe},Me){if(!(0,io.d5)(_))return id();const we=(0,Hs.iP)(G,de,xe,Me.scopedVars);return(0,Xr.H)(_.metricFindQuery(G.query,we)).pipe((0,Fr.Z)(ke=>{if(!ke||!ke.length)return id();const Xe=ke;return(0,Xn.of)({series:Xe,state:_r.Gu.Done,timeRange:we.range})}))}}class Ux{constructor(){this.type=Uu.Qz.Standard}canRun(_){return(0,io.Hf)(_)}getTarget({datasource:_,variable:G}){if((0,io.Hf)(_))return _.variables.toDataQuery(G.query);throw new Error("Couldn't create a target with supplied arguments.")}runRequest({datasource:_,runRequest:G},de){return(0,io.Hf)(_)?_.variables.query?G(_,de,_.variables.query.bind(_.variables)):G(_,de):id()}}class Nx{constructor(){this.type=Uu.Qz.Custom}canRun(_){return(0,io.zs)(_)}getTarget({datasource:_,variable:G}){if((0,io.zs)(_))return G.query;throw new Error("Couldn't create a target with supplied arguments.")}runRequest({datasource:_,runRequest:G},de){return(0,io.zs)(_)?G(_,de,_.variables.query.bind(_.variables)):id()}}const wx="variable-query";class Wx{constructor(){this.type=Uu.Qz.Datasource}canRun(_){return(0,io.X3)(_)}getTarget({datasource:_,variable:G}){if((0,io.X3)(_))return{...G.query,refId:G.query.refId??wx};throw new Error("Couldn't create a target with supplied arguments.")}runRequest({datasource:_,runRequest:G},de){return(0,io.X3)(_)?G(_,de):id()}}function id(){return(0,Xn.of)({state:_r.Gu.Done,series:[],timeRange:(0,Lx.E2)()})}class Fx{constructor(_={dispatch:er.JD,getState:er.Gu,getVariable:Qa.dn,getTemplatedRegex:Hs.u7,getTimeSrv:qo.jG,queryRunners:new jx,runRequest:ip.BN}){this.dependencies=_,this.updateOptionsRequests=new Ru.B,this.updateOptionsResults=new Ru.B,this.cancelRequests=new Ru.B,this.onNewRequest=this.onNewRequest.bind(this),this.subscription=this.updateOptionsRequests.subscribe(this.onNewRequest)}queueRequest(_){this.updateOptionsRequests.next(_)}getResponse(_){return this.updateOptionsResults.asObservable().pipe((0,Bu.p)(G=>G.identifier===_))}cancelRequest(_){this.cancelRequests.next({identifier:_})}destroy(){this.subscription.unsubscribe()}onNewRequest(_){const{datasource:G,identifier:de,searchFilter:xe}=_;try{const{dispatch:Me,runRequest:we,getTemplatedRegex:ke,getVariable:Xe,queryRunners:ht,getTimeSrv:mt,getState:bt}=this.dependencies,Kt=(0,Qa.y7)(bt());this.updateOptionsResults.next({identifier:de,state:_r.Gu.Loading});const Rt=Xe(de,bt());if(Rt.type!=="query")return;const Ct=mt(),Ut={variable:Rt,datasource:G,searchFilter:xe,timeSrv:Ct,runRequest:we};if(!ht.isQueryRunnerAvailableForDatasource(G)){const Ds=new Error("Query Runner is not available for datasource.");this.updateOptionsResults.next({identifier:de,state:_r.Gu.Error,error:Ds});return}const hn=ht.getRunnerForDatasource(G),Zn=hn.getTarget({datasource:G,variable:Rt}),As=this.getRequest(Rt,_,Zn);hn.runRequest(Ut,As).pipe((0,Bu.p)(()=>{const Ds=(0,Qa.y7)(bt());return Kt===Ds}),(0,Bu.p)(Ds=>Ds.state===_r.Gu.Done||Ds.state===_r.Gu.Error),(0,vx.s)(1),(0,Fr.Z)(Ds=>Ds.state===_r.Gu.Error?(0,Om.$)(()=>Ds.error):(0,Xn.of)(Ds)),Sx(),Ix({variable:Rt,dispatch:Me,getTemplatedRegexFunc:ke}),Ax({variable:Rt,dispatch:Me,searchFilter:xe}),(0,yx.Q)((0,mx.h)(this.updateOptionsRequests,this.cancelRequests).pipe((0,Bu.p)(Ds=>{let Fs=!1;return Ds.identifier.id===de.id&&(Fs=!0,this.updateOptionsResults.next({identifier:de,state:_r.Gu.Loading,cancelled:Fs})),Fs}))),(0,xx.W)(Ds=>Ds.cancelled?(0,Xn.of)({}):(this.updateOptionsResults.next({identifier:de,state:_r.Gu.Error,error:Ds}),(0,Om.$)(()=>Ds))),(0,Ex.j)(()=>{this.updateOptionsResults.next({identifier:de,state:_r.Gu.Done})})).subscribe()}catch(Me){this.updateOptionsResults.next({identifier:de,state:_r.Gu.Error,error:Me})}}getRequest(_,G,de){const{searchFilter:xe}=G,Me={variable:{text:_.current.text,value:_.current.value}},Xe={...xe?{searchFilter:{text:xe,value:xe}}:{},...Me},ht=this.dependencies.getTimeSrv().timeRange();return{app:fm.Jk.Dashboard,requestId:(0,dm.A)(),timezone:"",range:ht,interval:"",intervalMs:0,targets:[de],scopedVars:Xe,startTime:Date.now()}}}let Am;function Kx(W){Am=W}function dp(){return Am}const $x=W=>{if(!Vx(W))return W.name;const{current:_}=W;return Array.isArray(_.text)?_.text.join(" + "):_.text},Vx=W=>Array.isArray(W?.options)||typeof W?.current=="object";var il=(W=>(W[W.moveUp=38]="moveUp",W[W.moveDown=40]="moveDown",W[W.select=32]="select",W[W.cancel=27]="cancel",W[W.selectAndClose=13]="selectAndClose",W))(il||{});class _x extends l.PureComponent{constructor(){super(...arguments),this.onKeyDown=_=>{if(il[_.keyCode]&&_.keyCode!==il.select){const G=_.ctrlKey||_.metaKey||_.shiftKey;this.props.onNavigate(_.keyCode,G),_.preventDefault()}},this.onChange=_=>{this.props.onChange(_.target.value)}}render(){const{value:_,id:G,onNavigate:de,...xe}=this.props;return(0,j.jsx)("input",{...xe,ref:Me=>{Me&&(Me.focus(),Me.setAttribute("style",`width:${Math.max(Me.width,150)}px`))},id:G,type:"text",className:"gf-form-input",value:_??"",onChange:this.onChange,onKeyDown:this.onKeyDown,placeholder:(0,aa.t)("variable.dropdown.placeholder","Enter variable value")})}}var zx=e(89963);const Hx=({loading:W,disabled:_,onClick:G,text:de,onCancel:xe,id:Me})=>{const we=(0,pt.of)(Lm),ke=(0,l.useCallback)(Xe=>{Xe.stopPropagation(),Xe.preventDefault(),G()},[G]);return W?(0,j.jsxs)("div",{className:we.container,"data-testid":rr.Tp.pages.Dashboard.SubMenu.submenuItemValueDropDownValueLinkTexts(`${de}`),title:de,id:Me,children:[(0,j.jsx)(Rm,{text:de}),(0,j.jsx)(zx.I,{loading:!0,onCancel:xe})]}):(0,j.jsxs)("button",{onClick:ke,className:we.container,"data-testid":rr.Tp.pages.Dashboard.SubMenu.submenuItemValueDropDownValueLinkTexts(`${de}`),"aria-expanded":!1,"aria-controls":`options-${Me}`,id:Me,title:de,disabled:_,children:[(0,j.jsx)(Rm,{text:de}),(0,j.jsx)(Is.I,{"aria-hidden":!0,name:"angle-down",size:"sm"})]})},Rm=({text:W})=>{const _=(0,pt.of)(Lm);return(0,j.jsx)("span",{className:_.textAndTags,children:W===uo.Zm?(0,aa.t)("variable.picker.link-all","All"):W})},Lm=W=>{const _=(0,vc.$)(W);return{container:(0,Qe.css)({maxWidth:"500px",paddingRight:"10px",padding:W.spacing(0,1),backgroundColor:W.components.input.background,border:`1px solid ${W.components.input.borderColor}`,borderRadius:W.shape.radius.default,display:"flex",alignItems:"center",color:W.colors.text.primary,height:W.spacing(W.components.height.md),[`.${_.badge}`]:{margin:"0 5px"},"&:disabled":{backgroundColor:W.colors.action.disabledBackground,color:W.colors.action.disabledText,border:`1px solid ${W.colors.action.disabledBackground}`}}),textAndTags:(0,Qe.css)({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",marginRight:W.spacing(.25),userSelect:"none"})}};class kx extends l.PureComponent{constructor(){super(...arguments),this.onToggle=_=>G=>{const de=G.shiftKey||G.ctrlKey||G.metaKey;this.handleEvent(G),this.props.onToggle(_,de)},this.onToggleAll=_=>{this.handleEvent(_),this.props.onToggleAll()}}handleEvent(_){_.preventDefault(),_.stopPropagation()}render(){const{multi:_,values:G,highlightIndex:de,selectedValues:xe,onToggle:Me,onToggleAll:we,theme:ke,...Xe}=this.props,ht=up(ke);return(0,j.jsx)("div",{className:ht.variableValueDropdown,children:(0,j.jsx)("div",{className:ht.variableOptionsWrapper,children:(0,j.jsxs)("ul",{className:ht.variableOptionsColumn,"aria-label":rr.Tp.pages.Dashboard.SubMenu.submenuItemValueDropDownDropDown,...Xe,children:[this.renderMultiToggle(),G.map((mt,bt)=>this.renderOption(mt,bt))]})})})}renderOption(_,G){const{highlightIndex:de,multi:xe,theme:Me}=this.props,we=up(Me),ke=_.value===uo.To;return(0,j.jsx)("li",{children:(0,j.jsxs)("button",{"data-testid":rr.Tp.components.Variables.variableOption,role:"checkbox",type:"button","aria-checked":_.selected,className:(0,Qe.cx)((0,ye.my)(Me),we.variableOption,{[we.highlighted]:G===de,[we.variableAllOption]:ke},we.noStyledButton),onClick:this.onToggle(_),children:[(0,j.jsx)("span",{className:(0,Qe.cx)(we.variableOptionIcon,{[we.variableOptionIconSelected]:_.selected,[we.hideVariableOptionIcon]:!xe})}),(0,j.jsx)("span",{"data-testid":rr.Tp.pages.Dashboard.SubMenu.submenuItemValueDropDownOptionTexts(`${_.text}`),children:ke?(0,aa.t)("variable.picker.option-all","All"):_.text})]})},`${_.value}`)}renderMultiToggle(){const{multi:_,selectedValues:G,theme:de,values:xe}=this.props,Me=up(de),we=xe.some(Xe=>Xe.value===uo.To);if(!_)return null;const ke=()=>(0,j.jsx)(aa.x6,{i18nKey:"variable.picker.option-tooltip",children:"Clear selections"});return(0,j.jsx)(gi.m,{content:ke,placement:"top",children:(0,j.jsxs)("button",{className:(0,Qe.cx)((0,ye.my)(de),Me.variableOption,Me.variableOptionColumnHeader,Me.noStyledButton,{[Me.noPaddingBotton]:we}),role:"checkbox","aria-checked":G.length>1?"mixed":"false",onClick:this.onToggleAll,"aria-label":"Toggle all values","data-placement":"top",children:[(0,j.jsx)("span",{className:(0,Qe.cx)(Me.variableOptionIcon,{[Me.variableOptionIconManySelected]:G.length>1})}),(0,j.jsx)(aa.x6,{i18nKey:"variable.picker.option-selected-values",children:"Selected"})," (",G.length,")"]})})}}const up=(0,Fl.N)(W=>{const _=W.isDark?"public/img/checkbox.png":"public/img/checkbox_white.png";return{hideVariableOptionIcon:(0,Qe.css)({display:"none"}),highlighted:(0,Qe.css)({backgroundColor:W.colors.action.hover}),noStyledButton:(0,Qe.css)({width:"100%",textAlign:"left"}),variableOption:(0,Qe.css)({display:"block",padding:"2px 27px 0 8px",position:"relative",whiteSpace:"nowrap",minWidth:"115px","&:hover":{backgroundColor:W.colors.action.hover}}),variableOptionColumnHeader:(0,Qe.css)({paddingTop:"5px",paddingBottom:"5px",marginBottom:"5px"}),variableOptionIcon:(0,Qe.css)({display:"inline-block",width:"24px",height:"18px",position:"relative",top:"4px",background:`url(${_}) left top no-repeat`}),variableOptionIconManySelected:(0,Qe.css)({background:`url(${_}) 0px -36px no-repeat`}),variableOptionIconSelected:(0,Qe.css)({background:`url(${_}) 0px -18px no-repeat`}),variableValueDropdown:(0,Qe.css)({backgroundColor:W.colors.background.primary,border:`1px solid ${W.colors.border.weak}`,borderRadius:W.shape.borderRadius(2),boxShadow:W.shadows.z2,position:"absolute",top:W.spacing(W.components.height.md),maxHeight:"400px",minHeight:"150px",minWidth:"150px",overflowY:"auto",overflowX:"hidden",zIndex:W.zIndex.typeahead}),variableOptionsColumn:(0,Qe.css)({maxHeight:"350px",display:"table-cell",lineHeight:"26px",listStyleType:"none"}),variableOptionsWrapper:(0,Qe.css)({display:"table",width:"100%"}),variableAllOption:(0,Qe.css)({borderBottom:`1px solid ${W.colors.border.weak}`,paddingBottom:W.spacing(1)}),noPaddingBotton:(0,Qe.css)({paddingBottom:0})}}),Gx=(0,pt.cV)(kx);var Qx=e(92053),jm=e(92041),ll=e(56968),ni=e(24300);const Yx=(W,_,G)=>async(de,xe)=>{if(_===il.cancel)return await de(Nu(W));if(_===il.select)return de(hp(W,G));if(_===il.selectAndClose)return(0,Qa.nx)(W,xe()).optionsPicker.multi?de(hp(W,G)):(de(hp(W,G,!0)),de(Nu(W)));if(_===il.moveDown)return de((0,tr.kb)(W,(0,ni.O$)(1)));if(_===il.moveUp)return de((0,tr.kb)(W,(0,ni.O$)(-1)))},Jx=(W,_="")=>async(G,de)=>{const{rootStateKey:xe}=W,{id:Me,queryValue:we}=(0,Qa.nx)(xe,de()).optionsPicker,ke={id:Me,rootStateKey:xe,type:"query"},Xe=(0,Qa.dn)(ke,de());if(!("options"in Xe)||(G((0,tr.kb)(xe,(0,ni.S8)(_))),(0,m.trim)(we)===(0,m.trim)(_)))return;const{query:ht,options:mt}=Xe,bt=typeof ht=="string"?ht:ht.target;return(0,Qx.E)(bt)?eE(G,de,_,xe):G((0,tr.kb)(xe,(0,ni.fx)(mt)))},Xx=async W=>{if((0,jm.R)(W.current))return;await ad.B.get(W.type).setValue(W,W.current,!0)},Nu=(W,_)=>async(G,de)=>{const xe=(0,Qa.nx)(W,de()).optionsPicker,Me={id:xe.id,rootStateKey:W,type:"query"},we=(0,Qa.dn)(Me,de());if(!(0,io.SP)(we))return;const ke={option:tE(xe)},Xe={propName:"queryValue",propValue:xe.queryValue};G((0,tr.kb)(W,(0,ll.dE)((0,Hs.qD)(we,ke)))),G((0,tr.kb)(W,(0,ll.QP)((0,Hs.qD)(we,Xe))));const ht=(0,Qa.dn)(Me,de());if((0,io.SP)(ht)&&(G((0,tr.kb)(W,(0,ni.Fu)())),(0,Hs.Lz)(we)!==(0,Hs.Lz)(ht)))return _?_(ht):await Xx(ht)},Zx=(W,_)=>async(G,de)=>{const{id:xe,rootStateKey:Me}=W,we=(0,Qa.nx)(Me,de()).optionsPicker;we.id&&we.id!==xe&&await G(Nu(Me,_));const ke=(0,Qa.dn)(W,de());(0,io.SP)(ke)&&G((0,tr.kb)(Me,(0,ni.MO)(ke)))},hp=(W,_,G=!1)=>(de,xe)=>{const{highlightIndex:Me,options:we}=(0,Qa.nx)(W,xe()).optionsPicker,ke=we[Me];de((0,tr.kb)(W,(0,ni.U9)({option:ke,forceSelect:G,clearOthers:_})))},qx=async(W,_,G,de)=>{try{const{id:xe}=(0,Qa.nx)(de,_()).optionsPicker,Me={id:xe,rootStateKey:de,type:"query"},we=(0,Qa.dn)(Me,_());if(!(0,io.SP)(we))return;await ad.B.get(we.type).updateOptions(we,G);const Xe=(0,Qa.dn)(Me,_());if(!(0,io.SP)(Xe))return;W((0,tr.kb)(de,(0,ni.qh)(Xe.options)))}catch(xe){console.error(xe)}},eE=(0,m.debounce)(qx,500);function tE(W){const{options:_,selectedValues:G,queryValue:de,multi:xe}=W;if(_.length===0&&de&&de.length>0)return{text:de,value:de,selected:!1};if(!xe)return G.find(ke=>ke.selected);const Me=[],we=[];for(const ke of G)ke.selected&&(Me.push(ke.text.toString()),we.push(ke.value.toString()));return{value:we,text:Me,selected:!0}}const ld=()=>{const W=Me=>({...(0,ju.bindActionCreators)({openOptions:Zx,commitChangesToVariable:Nu,navigateOptions:Yx},Me),filterOrSearchOptions:(we,ke="")=>{Me(Jx(we,ke))},toggleAllOptions:we=>Me((0,tr.kb)(we.rootStateKey,(0,ni.an)())),toggleOption:(we,ke,Xe,ht)=>Me((0,tr.kb)(we.rootStateKey,(0,ni.U9)({option:ke,clearOthers:Xe,forceSelect:ht})))}),_=(Me,we)=>{const{rootStateKey:ke}=we.variable;return ke?{picker:(0,Qa.nx)(ke,Me).optionsPicker}:(console.error("OptionPickerFactory: variable has no rootStateKey"),{picker:ni.$z})},G=(0,ka.connect)(_,W);class de extends l.PureComponent{constructor(){super(...arguments),this.onShowOptions=()=>this.props.openOptions((0,Hs.jX)(this.props.variable),this.props.onVariableChange),this.onHideOptions=()=>{if(!this.props.variable.rootStateKey){console.error("Variable has no rootStateKey");return}this.props.commitChangesToVariable(this.props.variable.rootStateKey,this.props.onVariableChange)},this.onToggleOption=(we,ke)=>{((0,io.iv)(this.props.variable)&&this.props.variable.multi?this.onToggleMultiValueVariable:this.onToggleSingleValueVariable)(we,ke)},this.onToggleSingleValueVariable=(we,ke)=>{this.props.toggleOption((0,Hs.jX)(this.props.variable),we,ke,!1),this.onHideOptions()},this.onToggleMultiValueVariable=(we,ke)=>{this.props.toggleOption((0,Hs.jX)(this.props.variable),we,ke,!1)},this.onToggleAllOptions=()=>{this.props.toggleAllOptions((0,Hs.jX)(this.props.variable))},this.onFilterOrSearchOptions=we=>{this.props.filterOrSearchOptions((0,Hs.jX)(this.props.variable),we)},this.onNavigate=(we,ke)=>{if(!this.props.variable.rootStateKey){console.error("Variable has no rootStateKey");return}this.props.navigateOptions(this.props.variable.rootStateKey,we,ke)},this.onCancel=()=>{dp().cancelRequest((0,Hs.jX)(this.props.variable))}}render(){const{variable:we,picker:ke}=this.props,Xe=ke.id===we.id,ht=nE();return(0,j.jsx)("div",{className:ht.variableLinkWrapper,"data-testid":rr.Tp.components.Variables.variableLinkWrapper,children:Xe?this.renderOptions(ke):this.renderLink(we)})}renderLink(we){const ke=$x(we),Xe=we.state===_r.Gu.Loading;return(0,j.jsx)(Hx,{id:uo.qz+we.id,text:ke,onClick:this.onShowOptions,loading:Xe,onCancel:this.onCancel,disabled:this.props.readOnly})}renderOptions(we){const{id:ke}=this.props.variable;return(0,j.jsxs)(px.N,{onClick:this.onHideOptions,children:[(0,j.jsx)(_x,{id:uo.qz+ke,value:we.queryValue,onChange:this.onFilterOrSearchOptions,onNavigate:this.onNavigate,"aria-expanded":!0,"aria-controls":`options-${ke}`}),(0,j.jsx)(Gx,{values:we.options,onToggle:this.onToggleOption,onToggleAll:this.onToggleAllOptions,highlightIndex:we.highlightIndex,multi:we.multi,selectedValues:we.selectedValues,id:`options-${ke}`})]})}}const xe=G(de);return xe.displayName="OptionsPicker",xe},nE=()=>({variableLinkWrapper:(0,Qe.css)({display:"inline-block",position:"relative"})});var sE=e(95802);class aE extends l.PureComponent{constructor(){super(...arguments),this.onChange=_=>{this.props.onPropChange({propName:"query",propValue:_.currentTarget.value,updateOptions:!0})}}render(){return(0,j.jsx)(sE.d,{constantValue:this.props.variable.query,onChange:this.onChange})}}const rE={...dc.Vg,type:"constant",hide:Bl.zL.hideVariable,query:"",current:{},options:[]},Bm=(0,Ho.Z0)({name:"templating/constant",initialState:od.j,reducers:{createConstantOptionsFromQuery:(W,_)=>{const G=(0,Qa.Fs)(W,_.payload.id);G.type==="constant"&&(G.options=[{text:G.query.trim(),value:G.query.trim(),selected:!1}])}}}),oE=Bm.reducer,{createConstantOptionsFromQuery:iE}=Bm.actions,lE=W=>async _=>{const{rootStateKey:G}=W;await _((0,tr.kb)(G,iE((0,Hs.qD)(W)))),await _((0,Wr.kl)(W))},cE=()=>({id:"constant",description:"Define a hidden constant variable, useful for metric prefixes in dashboards you want to share.",name:"Constant",initialState:rE,reducer:oE,picker:ld(),editor:aE,dependsOn:()=>!1,setValue:async(W,_,G=!1)=>{await(0,er.JD)((0,Wr.t9)((0,Hs.jX)(W),_,G))},setValueFromUrl:async(W,_)=>{await(0,er.JD)((0,Wr.x7)((0,Hs.jX)(W),_))},updateOptions:async W=>{await(0,er.JD)(lE((0,Hs.jX)(W)))},getSaveModel:W=>{const{index:_,id:G,state:de,global:xe,current:Me,options:we,rootStateKey:ke,...Xe}=(0,m.cloneDeep)(W);return Xe},getValueForUrl:W=>W.current.value,beforeAdding:W=>{const{current:_,options:G,query:de,...xe}=(0,m.cloneDeep)(W),Me={selected:!0,text:de,value:de};return{...xe,current:Me,options:[Me],query:de}}});function dE(W,..._){const G=(0,ka.connect)(..._)(W);return de=>(0,j.jsx)(G,{...de,store:er.M_})}function iP(W,..._){const G=connect(..._)(W);return de=>jsx(Provider,{store,children:jsx(G,{...de,store})})}var uE=e(58711);class hE extends l.PureComponent{constructor(){super(...arguments),this.onSelectionOptionsChange=async({propName:_,propValue:G})=>{this.props.onPropChange({propName:_,propValue:G,updateOptions:!0})},this.onQueryChange=_=>{this.props.onPropChange({propName:"query",propValue:_.currentTarget.value,updateOptions:!0})}}render(){return(0,j.jsx)(uE.w,{query:this.props.variable.query,multi:this.props.variable.multi,allValue:this.props.variable.allValue,includeAll:this.props.variable.includeAll,onQueryChange:this.onQueryChange,onMultiChange:_=>this.onSelectionOptionsChange({propName:"multi",propValue:_.currentTarget.checked}),onIncludeAllChange:_=>this.onSelectionOptionsChange({propName:"includeAll",propValue:_.currentTarget.checked}),onAllValueChange:_=>this.onSelectionOptionsChange({propName:"allValue",propValue:_.currentTarget.value})})}}const fE=(W,_)=>({}),gE={changeVariableMultiValue:Wr.TI},pE=dE(hE,fE,gE),mE={...dc.Vg,type:"custom",multi:!1,includeAll:!1,allValue:null,query:"",options:[],current:{}},Um=(0,Ho.Z0)({name:"templating/custom",initialState:od.j,reducers:{createCustomOptionsFromQuery:(W,_)=>{const G=(0,Qa.Fs)(W,_.payload.id);if(G.type!=="custom")return;const{includeAll:de}=G,we=(_.payload.data.match(/(?:\\,|[^,])+/g)??[]).map(ke=>{ke=ke.replace(/\\,/g,",");const Xe=/^(.+)\s:\s(.+)$/g.exec(ke)??[];if(Xe.length===3){const[,ht,mt]=Xe;return{text:ht.trim(),value:mt.trim(),selected:!1}}else return{text:ke.trim(),value:ke.trim(),selected:!1}});de&&we.unshift({text:uo.Zm,value:uo.To,selected:!1}),G.options=we}}}),vE=Um.reducer,{createCustomOptionsFromQuery:yE}=Um.actions,xE=W=>async(_,G)=>{const{rootStateKey:de}=W,xe=(0,Qa.dn)(W,G());if(xe.type!=="custom")return;const Me=(0,je.w)().replace(xe.query);await _((0,tr.kb)(de,yE((0,Hs.qD)(W,Me)))),await _((0,Wr.kl)(W))},EE=()=>({id:"custom",description:"Define variable values manually",name:"Custom",initialState:mE,reducer:vE,picker:ld(),editor:pE,dependsOn:(W,_)=>(0,Hs.wJ)(W.query,_.name),setValue:async(W,_,G=!1)=>{await(0,er.JD)((0,Wr.t9)((0,Hs.jX)(W),_,G))},setValueFromUrl:async(W,_)=>{await(0,er.JD)((0,Wr.x7)((0,Hs.jX)(W),_))},updateOptions:async W=>{await(0,er.JD)(xE((0,Hs.jX)(W)))},getSaveModel:W=>{const{index:_,id:G,state:de,global:xe,rootStateKey:Me,...we}=(0,m.cloneDeep)(W);return we},getValueForUrl:W=>(0,Hs.ML)(W)?uo.Zm:W.current.value});var DE=e(98917),PE=e(80147);const bE={...dc.Vg,type:"datasource",current:{},regex:"",options:[],query:"",multi:!1,includeAll:!1,refresh:Bl.CO.onDashboardLoad},Nm=(0,Ho.Z0)({name:"templating/datasource",initialState:od.j,reducers:{createDataSourceOptions:(W,_)=>{const{sources:G,regex:de}=_.payload.data,xe=[],Me=(0,Qa.Fs)(W,_.payload.id);if(Me.type==="datasource"){for(let we=0;we<G.length;we++){const ke=G[we];(0,PE._)(Me.query,ke.meta)&&(CE(ke,de)&&xe.push({text:ke.name,value:ke.uid,selected:!1}),TE(ke,de)&&xe.push({text:"default",value:"default",selected:!1}))}xe.length===0&&xe.push({text:"No data sources found",value:"",selected:!1}),Me.includeAll&&xe.unshift({text:uo.Zm,value:uo.To,selected:!1}),Me.options=xe}}}});function CE(W,_){return _?_.exec(W.name):!0}function TE(W,_){return W.isDefault?_?_.exec("default"):!0:!1}const ME=Nm.reducer,{createDataSourceOptions:SE}=Nm.actions,OE=(W,_={getDatasourceSrv:c.tR})=>async(G,de)=>{const{rootStateKey:xe}=W,Me=_.getDatasourceSrv().getList({metrics:!0,variables:!1}),we=(0,Qa.dn)(W,de());if(we.type!=="datasource")return;let ke;we.regex&&(ke=(0,je.w)().replace(we.regex,void 0,"regex"),ke=(0,Hr.dO)(ke)),G((0,tr.kb)(xe,SE((0,Hs.qD)(W,{sources:Me,regex:ke})))),await G((0,Wr.kl)(W))},IE=(W,_={getDatasourceSrv:c.tR})=>G=>{const de=_.getDatasourceSrv().getList({metrics:!0,variables:!0}),xe=(0,m.chain)(de).uniqBy("meta.id").map(Me=>({text:Me.meta.name,value:Me.meta.id})).value();xe.unshift({text:"",value:""}),G((0,tr.kb)(W,(0,$i.BC)({dataSourceTypes:xe})))},AE=(W,_)=>{const{variable:{rootStateKey:G}}=_;if(!G)return console.error("DataSourceVariableEditor: variable has no rootStateKey"),{extended:vm($i.nS)};const{editor:de}=(0,Qa.nx)(G,W);return{extended:vm(de)}},RE={initDataSourceVariableEditor:IE,changeVariableMultiValue:Wr.TI},LE=(0,ka.connect)(AE,RE);class jE extends l.PureComponent{constructor(){super(...arguments),this.onRegExBlur=_=>{this.props.onPropChange({propName:"regex",propValue:_.currentTarget.value,updateOptions:!0})},this.onSelectionOptionsChange=async({propValue:_,propName:G})=>{this.props.onPropChange({propName:G,propValue:_,updateOptions:!0})},this.onMultiChanged=_=>{this.props.changeVariableMultiValue((0,Hs.jX)(this.props.variable),_.currentTarget.checked)},this.onIncludeAllChanged=_=>{this.onSelectionOptionsChange({propName:"includeAll",propValue:_.currentTarget.checked})},this.onAllValueChanged=_=>{this.onSelectionOptionsChange({propName:"allValue",propValue:_.currentTarget.value})},this.getSelectedDataSourceTypeValue=()=>{const{extended:_}=this.props;if(!_?.dataSourceTypes.length)return"";const G=_.dataSourceTypes.find(xe=>xe.value===this.props.variable.query);return(G?G.value:_.dataSourceTypes[0].value)??""},this.onDataSourceTypeChanged=_=>{this.props.onPropChange({propName:"query",propValue:_.value,updateOptions:!0})}}componentDidMount(){const{rootStateKey:_}=this.props.variable;if(!_){console.error("DataSourceVariableEditor: variable has no rootStateKey");return}this.props.initDataSourceVariableEditor(_)}render(){const{variable:_,extended:G}=this.props,de=G?.dataSourceTypes?.length?G.dataSourceTypes?.map(xe=>({value:xe.value??"",label:xe.text})):[];return(0,j.jsx)(DE.y,{query:_.query,regex:_.regex,multi:_.multi,includeAll:_.includeAll,optionTypes:de,onChange:this.onDataSourceTypeChanged,onRegExBlur:this.onRegExBlur,onMultiChange:this.onMultiChanged,onIncludeAllChange:this.onIncludeAllChanged,onAllValueChange:this.onAllValueChanged})}}const BE=LE(jE),UE=()=>({id:"datasource",description:"Enables you to dynamically switch the data source for multiple panels.",name:"Data source",initialState:bE,reducer:ME,picker:ld(),editor:BE,dependsOn:(W,_)=>W.regex?(0,Hs.wJ)(W.regex,_.name):!1,setValue:async(W,_,G=!1)=>{await(0,er.JD)((0,Wr.t9)((0,Hs.jX)(W),_,G))},setValueFromUrl:async(W,_)=>{await(0,er.JD)((0,Wr.x7)((0,Hs.jX)(W),_))},updateOptions:async W=>{await(0,er.JD)(OE((0,Hs.jX)(W)))},getSaveModel:W=>{const{index:_,id:G,state:de,global:xe,rootStateKey:Me,...we}=(0,m.cloneDeep)(W);return{...we,options:[]}},getValueForUrl:W=>(0,Hs.ML)(W)?uo.Zm:W.current.value});var NE=e(25304),wE=e(49317);const wm=(0,l.memo)(({onPropChange:W,variable:_})=>{const G=we=>{W({propName:"auto",propValue:we.target.checked,updateOptions:!0})},de=we=>{W({propName:"query",propValue:we.currentTarget.value,updateOptions:!0})},xe=we=>{W({propName:"auto_count",propValue:we.value,updateOptions:!0})},Me=we=>{W({propName:"auto_min",propValue:we.currentTarget.value,updateOptions:!0})};return(0,j.jsx)(wE.s,{intervals:_.query,autoStepCount:_.auto_count,autoEnabled:_.auto,onAutoCountChanged:xe,onIntervalsChange:de,onAutoEnabledChange:G,onAutoMinIntervalChanged:Me,autoMinInterval:_.auto_min})});wm.displayName="IntervalVariableEditor";var WE=e(23989),fp=e(81515);const FE=W=>async _=>{const{rootStateKey:G}=W;await _((0,tr.kb)(G,(0,fp.mn)((0,Hs.qD)(W)))),await _(gp(W)),await _((0,Wr.kl)(W))},gp=(W,_={calculateInterval:gm.calculateInterval,getTimeSrv:qo.jG,templateSrv:(0,WE.w)()})=>(G,de)=>{const xe=(0,Qa.dn)(W,de());if(xe.type==="interval"&&xe.auto){const Me=_.calculateInterval(_.getTimeSrv().timeRange(),xe.auto_count,xe.auto_min);_.templateSrv.setGrafanaVariable("$__auto_interval_"+xe.name,Me.interval),_.templateSrv.setGrafanaVariable("$__auto_interval",Me.interval)}},KE=()=>({id:"interval",description:"Define a timespan interval (ex 1m, 1h, 1d)",name:"Interval",initialState:fp.Ez,reducer:fp.E5,picker:ld(),editor:wm,dependsOn:()=>!1,setValue:async(W,_,G=!1)=>{await(0,er.JD)(gp((0,Hs.jX)(W))),await(0,er.JD)((0,Wr.t9)((0,Hs.jX)(W),_,G))},setValueFromUrl:async(W,_)=>{await(0,er.JD)(gp((0,Hs.jX)(W))),await(0,er.JD)((0,Wr.x7)((0,Hs.jX)(W),_))},updateOptions:async W=>{await(0,er.JD)(FE((0,Hs.jX)(W)))},getSaveModel:W=>{const{index:_,id:G,state:de,global:xe,rootStateKey:Me,...we}=(0,m.cloneDeep)(W);return we},getValueForUrl:W=>W.current.value});var $E=e(44890),VE=e(64423),_E=e(12091),zE=e(70766);function HE(W,_,G){return{next:xe=>{if(xe.state===_r.Gu.Error){G.unsubscribe(),_(xe.error);return}if(xe.state===_r.Gu.Done){G.unsubscribe(),W();return}},error:xe=>{G.unsubscribe(),_(xe)},complete:()=>{G.unsubscribe(),W()}}}const kE=(W,_)=>async(G,de)=>{try{const{rootStateKey:xe}=W;if(!(0,Hs.sN)(xe,de()))return;const Me=(0,Qa.dn)(W,de());if(Me.type!=="query")return;(0,Qa.nx)(xe,de()).editor.id===Me.id&&G((0,tr.kb)(xe,(0,$i.Eo)({errorProp:"update"})));const we=await(0,N.l)().get(Me.datasource??"");await new Promise((ke,Xe)=>{const ht=new VE.yU,mt=HE(ke,Xe,ht),bt=dp().getResponse(W).subscribe(mt);ht.add(bt),dp().queueRequest({identifier:W,datasource:we,searchFilter:_})})}catch(xe){if(xe instanceof Error){const Me=(0,_E.u)(xe),{rootStateKey:we}=W;throw(0,Qa.nx)(we,de()).editor.id===W.id&&G((0,tr.kb)(we,(0,$i.NY)({errorProp:"update",errorText:Me.message}))),Me}}},GE=W=>async(_,G)=>{const de=(0,Qa.dn)(W,G());de.type==="query"&&await _(Wm((0,Hs.jX)(de),de.datasource))},Wm=(W,_)=>async(G,de)=>{try{const{rootStateKey:xe}=W,{editor:Me}=(0,Qa.nx)(xe,de()),ke=lp(Me)?.dataSource,Xe=await(0,N.l)().get(_??"");ke&&ke.type!==Xe?.type&&G((0,tr.kb)(xe,(0,ll.QP)((0,Hs.qD)(W,{propName:"query",propValue:""}))));const ht=await(0,zE.y)(Xe);G((0,tr.kb)(xe,(0,$i.BC)({dataSource:Xe,VariableQueryEditor:ht})))}catch(xe){console.error(xe)}},QE=(W,_,G)=>async(de,xe)=>{const{rootStateKey:Me}=W,we=(0,Qa.dn)(W,xe());if(we.type==="query"){if(YE(we.name,_)){const ke="Query cannot contain a reference to itself. Variable: $"+we.name;de((0,tr.kb)(Me,(0,$i.NY)({errorProp:"query",errorText:ke})));return}de((0,tr.kb)(Me,(0,$i.Eo)({errorProp:"query"}))),de((0,tr.kb)(Me,(0,ll.QP)((0,Hs.qD)(W,{propName:"query",propValue:_})))),G!==void 0?de((0,tr.kb)(Me,(0,ll.QP)((0,Hs.qD)(W,{propName:"definition",propValue:G})))):typeof _=="string"&&de((0,tr.kb)(Me,(0,ll.QP)((0,Hs.qD)(W,{propName:"definition",propValue:_})))),await de((0,Wr.mZ)(W))}};function YE(W,_){if(typeof _=="string"&&_.match(new RegExp("\\$"+W+"(/| |$)")))return!0;const G=Fm(_);for(let de in G)if(G.hasOwnProperty(de)){const xe=G[de];if(typeof xe=="string"&&xe.match(new RegExp("\\$"+W+"(/| |$)")))return!0}return!1}function Fm(W){return typeof W!="object"||W===null?{query:W}:Object.keys(W).reduce((de,xe)=>{const Me=W[xe];if(typeof Me!="object"||Me===null)return de[xe]=Me,de;const we=Fm(Me);for(let ke in we)we.hasOwnProperty(ke)&&(de[`${xe}_${ke}`]=we[ke]);return de},{})}const JE=(W,_)=>{const{rootStateKey:G}=_.variable;if(!G)return console.error("QueryVariableEditor: variable has no rootStateKey"),{extended:lp($i.nS)};const{editor:de}=(0,Qa.nx)(G,W);return{extended:lp(de)}},XE={initQueryVariableEditor:GE,changeQueryVariableDataSource:Wm,changeQueryVariableQuery:QE,changeVariableMultiValue:Wr.TI},ZE=(0,ka.connect)(JE,XE);class qE extends l.PureComponent{constructor(){super(...arguments),this.state={regex:null,tagsQuery:null,tagValuesQuery:null},this.onDataSourceChange=_=>{this.props.onPropChange({propName:"datasource",propValue:_.isDefault?null:(0,pm.p$)(_)})},this.onLegacyQueryChange=async(_,G)=>{this.props.variable.query!==_&&this.props.changeQueryVariableQuery((0,Hs.jX)(this.props.variable),_,G)},this.onQueryChange=async _=>{if(this.props.variable.query!==_){let G="";_&&_.hasOwnProperty("query")&&typeof _.query=="string"&&(G=_.query),this.props.changeQueryVariableQuery((0,Hs.jX)(this.props.variable),_,G)}},this.onRegExBlur=async _=>{const G=_.currentTarget.value;this.props.variable.regex!==G&&this.props.onPropChange({propName:"regex",propValue:G,updateOptions:!0})},this.onRefreshChange=_=>{this.props.onPropChange({propName:"refresh",propValue:_})},this.onSortChange=async _=>{this.props.onPropChange({propName:"sort",propValue:_.value,updateOptions:!0})},this.onMultiChange=_=>{this.props.onPropChange({propName:"multi",propValue:_.currentTarget.checked})},this.onIncludeAllChange=_=>{this.props.onPropChange({propName:"includeAll",propValue:_.currentTarget.checked})},this.onAllValueChange=_=>{this.props.onPropChange({propName:"allValue",propValue:_.currentTarget.value})}}async componentDidMount(){await this.props.initQueryVariableEditor((0,Hs.jX)(this.props.variable))}componentDidUpdate(_){_.variable.datasource!==this.props.variable.datasource&&this.props.changeQueryVariableDataSource((0,Hs.jX)(this.props.variable),this.props.variable.datasource)}render(){const{extended:_,variable:G}=this.props;if(!_||!_.dataSource)return null;const de=(0,qo.jG)().timeRange();return(0,j.jsx)($E.u,{datasource:G.datasource??void 0,onDataSourceChange:this.onDataSourceChange,query:G.query,onQueryChange:this.onQueryChange,onLegacyQueryChange:this.onLegacyQueryChange,timeRange:de,regex:G.regex,onRegExChange:this.onRegExBlur,sort:G.sort,onSortChange:this.onSortChange,refresh:G.refresh,onRefreshChange:this.onRefreshChange,isMulti:G.multi,includeAll:G.includeAll,allValue:G.allValue??"",onMultiChange:this.onMultiChange,onIncludeAllChange:this.onIncludeAllChange,onAllValueChange:this.onAllValueChange})}}const eD=ZE(qE),tD=()=>({id:"query",description:"Variable values are fetched from a datasource query",name:"Query",initialState:Dx,reducer:Tx,picker:ld(),editor:eD,dependsOn:(W,_)=>(0,Hs.wJ)(W.query,W.datasource?.uid,W.regex,_.name),setValue:async(W,_,G=!1)=>{await(0,er.JD)((0,Wr.t9)((0,Hs.jX)(W),_,G))},setValueFromUrl:async(W,_)=>{await(0,er.JD)((0,Wr.x7)((0,Hs.jX)(W),_))},updateOptions:async(W,_)=>{await(0,er.JD)(kE((0,Hs.jX)(W),_))},getSaveModel:W=>{const{index:_,id:G,state:de,global:xe,queryValue:Me,rootStateKey:we,...ke}=(0,m.cloneDeep)(W);return W.refresh!==Bl.CO.never?{...ke,options:[]}:ke},getValueForUrl:W=>(0,Hs.ML)(W)?uo.Zm:W.current.value}),nD=()=>({id:"system",description:"",name:"system",initialState:{...dc.Vg,type:"system",hide:Bl.zL.hideVariable,skipUrlSync:!0,current:{value:{toString:()=>""}},state:_r.Gu.Done},reducer:W=>W,picker:null,editor:null,dependsOn:()=>!1,setValue:async(W,_,G=!1)=>{},setValueFromUrl:async(W,_)=>{},updateOptions:async W=>{},getSaveModel:W=>({}),getValueForUrl:W=>""});var sD=e(58975),aD=e(14329);function rD({onPropChange:W,variable:{query:_}}){const G=(0,l.useCallback)((Me,we)=>{Me.preventDefault(),W({propName:"originalQuery",propValue:Me.currentTarget.value,updateOptions:!1}),W({propName:"query",propValue:Me.currentTarget.value,updateOptions:we})},[W]),de=(0,l.useCallback)(Me=>G(Me,!1),[G]),xe=(0,l.useCallback)(Me=>G(Me,!0),[G]);return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(sD.Y,{children:"Text options"}),(0,j.jsx)(aD._,{value:_,name:"Default value",placeholder:"default value, if any",onChange:de,onBlur:xe,width:30,testId:rr.Tp.pages.Dashboard.Settings.Variables.Edit.TextBoxVariable.textBoxOptionsQueryInputV2})]})}function oD({variable:W,onVariableChange:_,readOnly:G}){const de=(0,wn.useDispatch)(),[xe,Me]=(0,l.useState)(W.current.value);(0,l.useEffect)(()=>{Me(W.current.value)},[W]);const we=(0,l.useCallback)(()=>{if(!W.rootStateKey){console.error("Cannot update variable without rootStateKey");return}if(W.current.value!==xe){if(de((0,tr.kb)(W.rootStateKey,(0,ll.QP)((0,Hs.qD)({id:W.id,type:W.type},{propName:"query",propValue:xe})))),_){_({...W,current:(0,jm.R)(W.current)?{}:{...W.current,value:xe}});return}ad.B.get(W.type).updateOptions(W)}},[W,xe,de,_]),ke=(0,l.useCallback)(mt=>Me(mt.target.value),[Me]),Xe=mt=>we(),ht=mt=>{mt.keyCode===13&&(mt.preventDefault(),we())};return(0,j.jsx)(Ze.p,{type:"text",value:xe,onChange:ke,onBlur:Xe,disabled:G,onKeyDown:ht,placeholder:(0,aa.t)("variable.textbox.placeholder","Enter variable value"),id:uo.qz+W.id})}const iD={...dc.Vg,type:"textbox",query:"",current:{},options:[],originalQuery:null},Km=(0,Ho.Z0)({name:"templating/textbox",initialState:od.j,reducers:{createTextBoxOptions:(W,_)=>{const G=(0,Qa.Fs)(W,_.payload.id);if(G.type!=="textbox")return;const de={text:G.query.trim(),value:G.query.trim(),selected:!1};G.options=[de],G.current=de}}}),lD=Km.reducer,{createTextBoxOptions:cD}=Km.actions,dD=W=>async(_,G)=>{const{rootStateKey:de,type:xe}=W;_((0,tr.kb)(de,cD((0,Hs.qD)(W))));const Me=(0,Qa.dn)(W,G());Me.type==="textbox"&&await ad.B.get(xe).setValue(Me,Me.options[0],!0)},uD=(W,_)=>async(G,de)=>{const{rootStateKey:xe}=W,Me=(0,Qa.dn)(W,de());if(Me.type!=="textbox")return;const we=(0,Hs.QT)(_);G((0,tr.kb)(xe,(0,ll.QP)((0,Hs.qD)(Me,{propName:"query",propValue:we})))),await G((0,Wr.x7)((0,Hs.jX)(Me),we))},hD=()=>({id:"textbox",description:"Define a textbox variable, where users can enter any arbitrary string",name:"Text box",initialState:iD,reducer:lD,picker:oD,editor:rD,dependsOn:(W,_)=>!1,setValue:async(W,_,G=!1)=>{await(0,er.JD)((0,Wr.t9)((0,Hs.jX)(W),_,G))},setValueFromUrl:async(W,_)=>{await(0,er.JD)(uD((0,Hs.jX)(W),_))},updateOptions:async W=>{await(0,er.JD)(dD((0,Hs.jX)(W)))},getSaveModel:(W,_)=>{const{index:G,id:de,state:xe,global:Me,originalQuery:we,rootStateKey:ke,...Xe}=(0,m.cloneDeep)(W);if(W.query!==we&&!_){const ht=we??"",mt={selected:!1,text:ht,value:ht};return{...Xe,query:ht,current:mt,options:[mt]}}return Xe},getValueForUrl:W=>W.current.value,beforeAdding:W=>({...(0,m.cloneDeep)(W),originalQuery:W.query})});var fD=e(10378),pp=e(55314),mp=e(72686),vp=e(59120);const gD={navBarTree:du.I_,navIndex:Jl._h,appNotifications:Pu.g5};var pD=e(44672),Ci=e(88467),Ti=e(23770);const mD=(0,ju.combineReducers)({dataSources:(0,Ci.Xw)("dataSources",Ti.DC,({rulesSourceName:W})=>W).reducer,promRules:(0,Ci.Xw)("promRules",Ti.mB,({rulesSourceName:W})=>W).reducer,rulerRules:(0,Ci.Xw)("rulerRules",Ti.eB,({rulesSourceName:W})=>W).reducer,ruleForm:(0,ju.combineReducers)({saveRule:(0,Ci.J7)("saveRule",Ti._$).reducer}),saveAMConfig:(0,Ci.J7)("saveAMConfig",Ti.RW).reducer,deleteAMConfig:(0,Ci.J7)("deleteAMConfig",Ti.nO).reducer,folders:(0,Ci.Xw)("folders",Ti.Tp,W=>W).reducer,amAlertGroups:(0,Ci.Xw)("amAlertGroups",Ti.D3,W=>W).reducer,testReceivers:(0,Ci.J7)("testReceivers",Ti.bO).reducer,managedAlertStateHistory:(0,Ci.J7)("managedAlertStateHistory",Ti.JH).reducer});var vD=e(55907);const yD={items:[],searchQuery:"",isLoading:!1},xD={notificationChannelTypes:[],notificationChannel:{},notifiers:[]};function ED(W,_){const G=vD.A.getStateDisplayModel(_),de={...W,stateText:G.text,stateIcon:G.iconClass,stateClass:G.stateClass,stateAge:(0,u.KQ)(W.newStateDate).fromNow(!0)};return de.state!=="paused"&&(de.executionError&&(de.info="Execution Error: "+de.executionError),de.evalData&&de.evalData.noData&&(de.info="Query returned no data")),de}const $m=(0,Ho.Z0)({name:"alertRules",initialState:yD,reducers:{loadAlertRules:W=>({...W,isLoading:!0}),loadedAlertRules:(W,_)=>{const de=_.payload.map(xe=>ED(xe,xe.state));return{...W,items:de,isLoading:!1}},setSearchQuery:(W,_)=>({...W,searchQuery:_.payload})}}),Vm=(0,Ho.Z0)({name:"notificationChannel",initialState:xD,reducers:{setNotificationChannels:(W,_)=>({...W,notificationChannelTypes:TD(_.payload),notifiers:_.payload}),notificationChannelLoaded:(W,_)=>{const G=_.payload,xe=W.notifiers.find(Me=>Me.type===G.type).options.filter(Me=>Me.secure);return xe.length>0&&xe.some(Me=>G.settings[Me.propertyName]!=="")?CD(W,_.payload,xe):{...W,notificationChannel:G}},resetSecureField:(W,_)=>({...W,notificationChannel:{...W.notificationChannel,secureFields:{...W.notificationChannel.secureFields,[_.payload]:!1}}})}}),{loadAlertRules:cP,loadedAlertRules:dP,setSearchQuery:uP}=$m.actions,{setNotificationChannels:hP,notificationChannelLoaded:fP,resetSecureField:gP}=Vm.actions,DD=$m.reducer,PD=Vm.reducer,bD={alertRules:DD,notificationChannel:PD,unifiedAlerting:mD};function CD(W,_,G){const de={},xe={};return G.forEach(Me=>{xe[Me.propertyName]=_.settings[Me.propertyName],de[Me.propertyName]=""}),{...W,notificationChannel:{..._,settings:{..._.settings,...de},secureSettings:{...xe}}}}function TD(W){return W.map(_=>({value:_.type,label:_.name,..._,typeName:_.type})).sort((_,G)=>_.name>G.name?1:-1)}var MD=e(93584),SD=e(20604),OD=e(79763),ID=e(53466),AD=e(28601),RD=e(36227),LD=e(54650),jD=e(40823),BD=e(88264),UD=e(10943),ND=e(80095),wD=e(31326),WD=e(81862),FD=e(1936),KD=e(8212),$D=e(34655),VD=e(87617),yp=e(2858),_D=e(97007);const zD={...gD,...bD,...$D.Ay,...MD.Ay,...LD.Ay,...AD.Ay,...sm.Ay,...RD.Ay,...VD.Ay,...FD.Ay,...WD.Ay,...jD.Ay,...UD.Ay,...OD.Ay,...pD.Ay,...BD.Ay,...ID.Ay,...ND.Ay,...tr.Ay,...KD.Ay,...SD.Ay,plugins:wD.Ff,[El.Hr.reducerPath]:El.Hr.reducer,[mp.Sm.reducerPath]:mp.Sm.reducer,[pp.cU.reducerPath]:pp.cU.reducer,[vp.O5.reducerPath]:vp.O5.reducer,[yp.g.reducerPath]:yp.g.reducer,[Bc.reducerPath]:Bc.reducer},_m={},pP=W=>{Object.assign(_m,W)},HD=()=>{const W=(0,ju.combineReducers)({...zD,..._m});return(_,G)=>{if(G.type!==_D.N.type)return W(_,G);const{cleanupAction:de}=G.payload;return de(_),W(_,G)}};function mP(W){addReducer(W)}const kD=(0,Ho.Nc)(),zm=[];function vP(W){zm.push(W)}function GD(W){const _=(0,Ho.U1)({reducer:HD(),middleware:G=>G({thunk:!0,serializableCheck:!1,immutableCheck:!1}).concat(kD.middleware,El.Hr.middleware,mp.Sm.middleware,pp.cU.middleware,vp.O5.middleware,yp.g.middleware,Bc.middleware,...zm),devTools:!1,preloadedState:{navIndex:(0,Jl.s2)(),...W}});return(0,fD.$k)(_.dispatch),(0,er.k3)(_),_}v().move=q.b;const Hm=e(39572),wu=Hm.keys().map(W=>Hm(W));class QD{async init(){try{parent.postMessage("GrafanaAppInit","*");const _=(0,aa.JL)(J.Ay.bootData.user.language);_.then(({language:ht})=>(0,J._R)({language:ht})),(0,M.u5)(ap.IB),XD(),fv(),(0,cc.j)("frontend_app_init"),(0,u.xS)(J.Ay.bootData.user.locale),(0,u.$D)(J.Ay.bootData.user.weekStart),(0,Y.Y)(cy.m),(0,X.l)(Go),(0,H.e)(ly.a),(0,O.T)(I.Ny),(0,T.p)(Gv),(0,D.G)(()=>J.Ay.bootData.user.timezone),iy(),(0,C.l)(ir.TP.user),(0,kv.initAuthConfig)(),(0,S.H8)(Mr.A),await _,YD(),GD(),JD(),Hv(),E.D.setInit(so.H),E.G.setInit(so.u),x.h.setInit(sa),ad.B.setInit(()=>[tD(),EE(),hD(),cE(),UE(),KE(),gx(),nD()]),P.l.setInit(or),gv(),(0,A.HC)(()=>new Fy),Kx(new Fx),(0,A.pC)(ip.BN),(0,L.se)({importPanelPlugin:um.TV,getPanelPluginFromCache:um.PY}),b.I.initialize({config:J.Ay,getTimeRangeForUrl:(0,qo.jG)().timeRangeForUrl,getVariablesUrlParams:NE.z}),document.addEventListener("click",pv);const G=new c.xq;G.init(J.Ay.datasources,J.Ay.defaultDatasource),(0,N.h)(G),$y();const de=new Ry;if(de.register({pluginId:"grafana",extensionConfigs:gy()}),ir.TP.user.orgRole!==""){const ht=["cloud-home-app"],mt=Object.values(J.Ay.apps).filter(Kt=>ht.includes(Kt.id)),bt=Object.values(J.Ay.apps).filter(Kt=>!ht.includes(Kt.id));hm(bt,de),await hm(mt,de,"frontend_awaited_plugins_preload")}(0,F.cE)(Cy(de)),(0,w.Vu)(By(de)),(0,B.A)(jy(de));const xe=I.Ny.getSearchObject(),Me=new eg,we=new Vv(I.Ny,Me),ke=new vv;ke.start(),Me.setKioskModeFromUrl(xe.kiosk);try{(0,Vy.W1)()}catch(ht){console.warn("Failed to clean up old expanded folders",ht)}this.context={backend:ap.IB,location:I.Ny,chrome:Me,keybindings:we,newAssetsChecker:ke,config:J.Ay},(0,U._)(Ro.ni),(0,K._)(Ro.k9),(0,y.H)(document.getElementById("reactRoot")).render((0,l.createElement)(Lg,{app:this}))}catch(_){console.error("Failed to start Grafana",_),window.__grafana_load_failed()}finally{(0,cc.z)("frontend_app_init")}}}function YD(){wu.length>0&&wu[0].addExtensionReducers()}function JD(){wu.length>0&&wu[0].init()}function XD(){(0,V.H2)(new Ev({debug:!1})),window.addEventListener("load",W=>{const _="frontend_boot_load_time_seconds";performance&&(performance.mark(_),cd("first-paint","frontend_boot_","_time_seconds"),cd("first-contentful-paint","frontend_boot_","_time_seconds"),cd(_),cd("frontend_boot_js_done_time_seconds"),cd("frontend_boot_css_time_seconds"))}),ir.TP.user.orgRole!==""&&(0,V.pl)(new Pv({})),J.Ay.grafanaJavascriptAgent.enabled&&(0,V.pl)(new wv({...J.Ay.grafanaJavascriptAgent,app:{version:J.Ay.buildInfo.version,environment:J.Ay.buildInfo.env},buildInfo:J.Ay.buildInfo,user:{id:String(J.Ay.bootData.user?.id),email:J.Ay.bootData.user?.email}})),J.Ay.googleAnalyticsId&&(0,V.pl)(new Tv({googleAnalyticsId:J.Ay.googleAnalyticsId})),J.Ay.googleAnalytics4Id&&(0,V.pl)(new Cv({googleAnalyticsId:J.Ay.googleAnalytics4Id,googleAnalytics4SendManualPageViews:J.Ay.googleAnalytics4SendManualPageViews})),J.Ay.rudderstackWriteKey&&J.Ay.rudderstackDataPlaneUrl&&(0,V.pl)(new Mv({writeKey:J.Ay.rudderstackWriteKey,dataPlaneUrl:J.Ay.rudderstackDataPlaneUrl,user:J.Ay.bootData.user,sdkUrl:J.Ay.rudderstackSdkUrl,configUrl:J.Ay.rudderstackConfigUrl,integrationsUrl:J.Ay.rudderstackIntegrationsUrl,buildInfo:J.Ay.buildInfo})),J.Ay.applicationInsightsConnectionString&&(0,V.pl)(new bv({connectionString:J.Ay.applicationInsightsConnectionString,endpointUrl:J.Ay.applicationInsightsEndpointUrl}))}function cd(W,_="",G=""){const de=v().first(performance.getEntriesByName(W));if(de){const xe=de.name.replace(/-/g,"_");(0,Dv.n)(`${_}${xe}${G}`,Math.round(de.startTime)/1e3)}}const ZD=new QD;window.public_cdn_path&&(e.p=window.public_cdn_path),window.__grafana_public_path__=e.p.substring(0,e.p.lastIndexOf("build/"))||e.p,window.nonce&&(e.nc=window.nonce),window.__grafana_app_bundle_loaded=!0,ZD.init()},60021:(k,R,e)=>{"use strict";e.d(R,{Or:()=>n,Oz:()=>r,RC:()=>t,ho:()=>i,nA:()=>s});var t=(g=>(g.Active="active",g.Expired="expired",g.Pending="pending",g))(t||{}),n=(g=>(g.Unprocessed="unprocessed",g.Active="active",g.Suppressed="suppressed",g))(n||{}),i=(g=>(g.equal="=",g.notEqual="!=",g.regex="=~",g.notRegex="!~",g))(i||{}),s=(g=>(g.Internal="internal",g.External="external",g.All="all",g))(s||{}),r=(g=>(g.cortex="cortex",g.mimir="mimir",g.prometheus="prometheus",g))(r||{})},91621:(k,R,e)=>{"use strict";e.d(R,{Dw:()=>g,Rx:()=>i,_W:()=>r,d$:()=>n});const t={statistics:[]};var n=(c=>(c[c.Insights=1]="Insights",c[c.Search=0]="Search",c))(n||{}),i=(c=>(c[c.Builder=0]="Builder",c[c.Code=1]="Code",c))(i||{});const s={parameters:[]};var r=(c=>(c.And="and",c.Function="function",c.FunctionParameter="functionParameter",c.GroupBy="groupBy",c.Operator="operator",c.Or="or",c.Property="property",c))(r||{}),g=(c=>(c.String="string",c))(g||{});const a={logGroupNames:[],logGroups:[],statsGroups:[]}},25640:(k,R,e)=>{"use strict";e.d(R,{Rx:()=>t.Rx,YZ:()=>n,b4:()=>i,d$:()=>t.d$});var t=e(91621),n=(s=>(s.Scheduled="Scheduled",s.Running="Running",s.Complete="Complete",s.Failed="Failed",s.Cancelled="Cancelled",s.Timeout="Timeout",s))(n||{}),i=(s=>(s.Regions="regions",s.Namespaces="namespaces",s.Metrics="metrics",s.DimensionKeys="dimensionKeys",s.DimensionValues="dimensionValues",s.EBSVolumeIDs="ebsVolumeIDs",s.EC2InstanceAttributes="ec2InstanceAttributes",s.ResourceArns="resourceARNs",s.Statistics="statistics",s.LogGroups="logGroups",s.Accounts="accounts",s))(i||{})},36666:(k,R,e)=>{"use strict";e.d(R,{A:()=>I});var t=e(74848),n=e(32196),i=e(92145),s=e(55127),r=e.n(s),g=e(96540),a=e(16817),c=e(52622),o=e(21103),h=e(40845),f=e(67061),d=e(88575),p=e(90182),m=e(94354),v=e(15292),l=e(62930),y=e(2913),u=e(14792),D=e(34842),E=e(31193),x=e(48514),P=e(45994);function b(C){return JSON.stringify(C)}function M(C,S){let A=S;return window.__grafanaSceneContext&&window.__grafanaSceneContext instanceof D.H$&&(A=window.__grafanaSceneContext.state.editPanel?.state.panelId),C===A}const O=[{label:"All data",value:!1},{label:"Annotations",value:!0,description:"Include annotations as regular data"}];function I({data:C,query:S,onChange:A,onRunQuery:L}){const{value:N}=(0,a.A)(()=>(0,E.tR)().get()),F=(0,g.useMemo)(()=>(0,u.UA)().getCurrent()?.getPanelById(S.panelId??-124134),[S.panelId]),{value:w,loading:B}=(0,a.A)(async()=>{if(!F||!C)return[];const ne=await(0,E.tR)().get(F.datasource);return Promise.all(F.targets.map(async le=>{const z=le.datasource?await(0,E.tR)().get(le.datasource):ne,ee=z.getQueryDisplayText||b,se=(0,x.E)(C,le.refId)??C;return{refId:le.refId,query:ee(le),name:z.name,img:z.meta.info.logos.small,data:se.series,error:se.error}}))},[C,F]),U=(0,g.useCallback)(ne=>{A(ne),L()},[A,L]),K=(0,g.useCallback)(ne=>{U({...S,panelId:ne})},[S,U]),V=(0,g.useCallback)(()=>{U({...S,withTransforms:!S.withTransforms})},[S,U]),H=(0,g.useCallback)(ne=>{U({...S,topic:ne?c.QR.Annotations:void 0})},[S,U]),Y=(0,g.useCallback)(ne=>{const le=ne.datasource??N,z=(0,E.tR)().getInstanceSettings(le)?.name,ee=ne.targets.length;return`${ee} ${r()("query",ee)} to ${z}`},[N]),X=(0,u.UA)().getCurrent(),J=!!(S.withTransforms||F?.transformations?.length),q=(0,g.useMemo)(()=>X?.panels.filter(ne=>y.Ay.panels[ne.type]&&ne.targets&&!M(ne.id,X.panelInEdit?.id)&&ne.datasource?.uid!==P.K).map(ne=>({value:ne.id,label:ne.title??"Panel "+ne.id,description:Y(ne),imgUrl:y.Ay.panels[ne.type].info.logos.small}))??[],[X,Y]),ae=(0,h.of)(T),j=(0,i.Bi)();if(!X)return null;if(q.length<1)return(0,t.jsx)("p",{className:ae.noQueriesText,children:"This dashboard does not have any other panels. Add queries to other panels and try again."});const te=q.find(ne=>ne.value===S.panelId);return(0,t.jsx)(o.i,{children:(0,t.jsxs)(f.B,{direction:"column",children:[(0,t.jsxs)(f.B,{gap:3,children:[(0,t.jsx)(d.D,{label:"Source panel",description:"Use query results from another panel",children:(0,t.jsx)(p.l6,{inputId:j,placeholder:"Choose panel",isSearchable:!0,options:q,value:te,onChange:ne=>K(ne.value)})}),(0,t.jsx)(d.D,{label:"Data",description:"Use data or annotations from the panel",children:(0,t.jsx)(m.z,{options:O,value:S.topic===c.QR.Annotations,onChange:H})}),J&&(0,t.jsx)(d.D,{label:"Transform",description:"Apply transformations from the source panel",children:(0,t.jsx)(v.K,{value:!!S.withTransforms,onChange:V})})]}),B?(0,t.jsx)(l.y,{}):(0,t.jsx)(t.Fragment,{children:w&&!!w.length&&(0,t.jsx)(d.D,{label:"Queries from panel",children:(0,t.jsx)(f.B,{direction:"column",children:w.map((ne,le)=>(0,t.jsxs)(f.B,{alignItems:"center",gap:1,children:[(0,t.jsx)("div",{children:ne.refId}),(0,t.jsx)("img",{src:ne.img,alt:ne.name,title:ne.name,width:16}),(0,t.jsx)("div",{children:ne.query})]},le))})})})]})})}function T(C){return{noQueriesText:(0,n.css)({padding:C.spacing(1.25)})}}},14348:(k,R,e)=>{"use strict";e.d(R,{K:()=>a.K,kN:()=>c,mw:()=>o});var t=e(88483),n=e(52622),i=e(39070),s=e(43127),r=e(14792),g=e(34214),a=e(45994);function c(p){return p?typeof p=="string"?p===a.K:"meta"in p&&p.meta.name===a.K||p.uid===a.K:!1}function o(p,m){return new t.c(v=>{const l=(0,r.UA)().getCurrent(),y=h(p.queries);if(!y){v.next(f("Missing panel reference ID"));return}let u=l?.getPanelById(y,!0);if(u instanceof g.a||(u=new g.a(u)),!u){v.next(f("Unknown Panel: "+y));return}const D=u.getQueryRunner(),E=D.getData({withTransforms:!!m?.withTransforms,withFieldConfig:!1}).subscribe({next:x=>{m?.topic===n.QR.Annotations&&(x={...x,series:x.annotations??[],annotations:void 0}),v.next(x)}});if(!u.isInView&&u.refreshWhenInView||l?.otherPanelInFullscreen(u)){const{datasource:x,targets:P}=u,b={...p,datasource:x,panelId:y,queries:P};u.refreshWhenInView=!1,D.run(b)}return()=>{E.unsubscribe()}})}function h(p){if(!(!p||!p.length))return p[0].panelId}function f(p){return{state:i.Gu.Error,series:[],request:{},error:{message:p},timeRange:(0,s.E2)()}}var d=e(36666)},45994:(k,R,e)=>{"use strict";e.d(R,{K:()=>t});const t="-- Dashboard --",n="dashboard"},90183:(k,R,e)=>{"use strict";e.d(R,{i:()=>ge,o:()=>Te});var t=e(2543),n=e(65474),i=e(62467),s=e(44240),r=e(81160),g=e(89667),a=e(39070),c=e(55004),o=e(37471),h=e(78368),f=e(14236),d=e(26657),p=e(72574),m=e(78731),v=e(17172),l=e(19347),y=e(79056),u=e(14792),D=e(74848),E=e(32196),x=e(96540),P=e(40845),b=e(84167),M=e(88575),O=e(90182),I=e(15292),T=e(99818),C=e(10154),S=e(68706),A=e(95093),L=e.n(A),N=e(91410),F=e(20333),w=e(55852),B=e(67061),U=e(17624),K=e(67459),V=e(57389),H=e(14578),Y=e(87266),X=e(16797);const J="time-of-day-picker-panel",q=({minuteStep:Le=1,showHour:Ye=!0,showSeconds:je=!1,onChange:Ze,value:Ne,size:Pe="auto",disabled:Ue,disabledHours:$e,disabledMinutes:ze,disabledSeconds:qe,placeholder:dt,format:vt="HH:mm",defaultValue:yt=void 0,allowEmpty:st=!1,width:Ve})=>{const pe=(0,P.of)(j),Ee=()=>Ve?(0,E.css)`
        width: ${Ve}px;
      `:(0,Y.lH)()[Pe];return(0,D.jsx)(V.A,{value:Ne,defaultValue:yt,onChange:me=>Ze(me),showHour:Ye,showSecond:je,format:vt,allowEmpty:st,className:(0,E.cx)(Ee(),pe.input),popupClassName:(0,E.cx)(pe.picker,J),minuteStep:Le,inputIcon:(0,D.jsx)(ae,{wrapperStyle:pe.caretWrapper}),disabled:Ue,disabledHours:$e,disabledMinutes:ze,disabledSeconds:qe,placeholder:dt})},ae=({wrapperStyle:Le=""})=>(0,D.jsx)("div",{className:Le,children:(0,D.jsx)(H.I,{name:"angle-down"})}),j=Le=>{const Ye=Le.components.input.background,je=Le.v1.palette.black,Ze=Le.colors.background.secondary,Ne=Le.shape.radius.default,Pe=Le.components.input.borderColor;return{caretWrapper:(0,E.css)`
      position: absolute;
      right: 8px;
      top: 50%;
      transform: translateY(-50%);
      display: inline-block;
      text-align: right;
      color: ${Le.colors.text.secondary};
    `,picker:(0,E.css)`
      .rc-time-picker-panel-select {
        font-size: 14px;
        background-color: ${Ye};
        border-color: ${Pe};
        li {
          outline-width: 2px;
          &.rc-time-picker-panel-select-option-selected {
            background-color: inherit;
            border: 1px solid ${Le.v1.palette.orange};
            border-radius: ${Ne};
          }

          &:hover {
            background: ${Ze};
          }

          &.rc-time-picker-panel-select-option-disabled {
            color: ${Le.colors.action.disabledText};
          }
        }
      }

      .rc-time-picker-panel-inner {
        box-shadow: 0px 4px 4px ${je};
        background-color: ${Ye};
        border-color: ${Pe};
        border-radius: ${Ne};
        margin-top: 3px;

        .rc-time-picker-panel-input-wrap {
          margin-right: 2px;

          &,
          .rc-time-picker-panel-input {
            background-color: ${Ye};
            padding-top: 2px;
          }
        }

        .rc-time-picker-panel-combobox {
          display: flex;
        }
      }
    `,input:(0,E.css)`
      .rc-time-picker-input {
        background-color: ${Ye};
        border-radius: ${Ne};
        border-color: ${Pe};
        height: ${Le.spacing(4)};

        &:focus {
          ${(0,X.focusCss)(Le)}
        }

        &:disabled {
          background-color: ${Le.colors.action.disabledBackground};
          color: ${Le.colors.action.disabledText};
          border: 1px solid ${Le.colors.action.disabledBackground};
          &:focus {
            box-shadow: none;
          }
        }
      }

      .rc-time-picker-clear {
        position: absolute;
        right: 20px;
        top: 50%;
        cursor: pointer;
        overflow: hidden;
        transform: translateY(-50%);
        color: ${Le.colors.text.secondary};
      }
    `}},te=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"].map((Le,Ye)=>({label:Le,value:Ye+1})),ne=({value:Le,onChange:Ye})=>{const je=(0,P.of)(le),Ze=Date.now(),Ne=(0,N.QZ)(Le.timezone??"utc",Ze),Pe=(0,u.UA)().getCurrent()?.getTimezone()===Le.timezone,[Ue,$e]=(0,x.useState)(!1),ze=()=>{$e(!Ue)},qe=me=>{if(!me)return;const ve=L()();if(me){const Se=me.split(":");ve.set("hour",parseInt(Se[0],10)),ve.set("minute",parseInt(Se[1],10))}return ve},dt=()=>{let me="Everyday";return Le.fromDayOfWeek&&!Le.toDayOfWeek&&(me=te[Le.fromDayOfWeek-1].label),me},vt=()=>{const me=(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(K.U,{title:Ne?.name}),(0,D.jsx)(U.X,{timeZone:Le.timezone,timestamp:Ze})]});return Pe?(0,D.jsxs)(D.Fragment,{children:["Dashboard timezone (",me,")"]}):me},yt=(me,ve)=>{const Se=me?me.format("HH:mm"):void 0;Ye(ve==="from"?{...Le,from:Se}:{...Le,to:Se})},st=me=>{Ye({...Le,timezone:me})},Ve=me=>{const ve=me?me.value:void 0,Se=me?Le.toDayOfWeek:void 0;Ye({...Le,fromDayOfWeek:ve,toDayOfWeek:Se})},pe=me=>{Ye({...Le,toDayOfWeek:me?me.value:void 0})},Ee=()=>Ue?(0,D.jsx)(F.U,{value:Le.timezone,includeInternal:!0,onChange:me=>st(me),onBlur:()=>$e(!1),openMenuOnFocus:!1,width:100,autoFocus:!0}):(0,D.jsxs)("div",{className:je.timezoneContainer,children:[(0,D.jsx)("div",{className:je.timezone,children:vt()}),(0,D.jsx)(w.$n,{variant:"secondary",onClick:ze,size:"sm",children:"Change timezone"})]});return(0,D.jsxs)(b.n,{className:je.wrapper,children:[(0,D.jsx)(M.D,{label:"From",children:(0,D.jsxs)(B.B,{gap:.5,children:[(0,D.jsx)(O.l6,{options:te,isClearable:!0,placeholder:"Everyday",value:Le.fromDayOfWeek??null,onChange:me=>Ve(me),width:20}),(0,D.jsx)(q,{value:qe(Le.from),onChange:me=>yt(me,"from"),allowEmpty:!0,placeholder:"HH:mm",width:100})]})}),(0,D.jsx)(M.D,{label:"To",children:(0,D.jsxs)(B.B,{gap:.5,children:[(Le.fromDayOfWeek||Le.toDayOfWeek)&&(0,D.jsx)(O.l6,{options:te,isClearable:!0,placeholder:dt(),value:Le.toDayOfWeek??null,onChange:me=>pe(me),width:20}),(0,D.jsx)(q,{value:qe(Le.to),onChange:me=>yt(me,"to"),allowEmpty:!0,placeholder:"HH:mm",width:100})]})}),(0,D.jsx)(M.D,{label:"Timezone",children:Ee()})]})},le=Le=>({wrapper:(0,E.css)({maxWidth:Le.spacing(60),marginBottom:Le.spacing(2)}),timezoneContainer:(0,E.css)`
      padding: 5px;
      display: flex;
      flex-direction: row;
      justify-content: space-between;
      align-items: center;
      font-size: 12px;
    `,timezone:(0,E.css)`
      margin-right: 5px;
    `}),z="Enabling this returns annotations that match any of the tags specified below",ee=(0,D.jsx)("div",{children:"Specify a list of tags to match. To specify a key and value tag use `key:value` syntax."}),se=[{label:"Dashboard",value:S.St.Dashboard,description:"Query for events created on this dashboard and show them in the panels where they where created"},{label:"Tags",value:S.St.Tags,description:"This will fetch any annotation events that match the tags filter"}],ie=[{label:"Annotations & Alerts",value:S.nj.Annotations,description:"Show annotations or alerts managed by grafana"},{label:"Time regions",value:S.nj.TimeRegions,description:"Configure a repeating time region"}],Z=[10,50,100,200,300,500,1e3,2e3].map(Le=>({label:String(Le),value:Le}));function oe({query:Le,onChange:Ye}){const je=Le,{limit:Ze,matchAny:Ne,tags:Pe,type:Ue,queryType:$e}=je;let ze=$e??S.nj.Annotations;const qe=(0,x.useMemo)(()=>(0,u.UA)().dashboard?.getTimezone(),[]),dt=(0,P.of)(ce),vt=me=>Ye({...je,type:me.value}),yt=me=>Ye({...je,limit:me.value}),st=me=>Ye({...je,matchAny:me.target.checked}),Ve=me=>Ye({...je,tags:me}),pe=me=>{const ve={...je,queryType:me.value};ve.queryType===S.nj.TimeRegions?ve.timeRegion||(ve.timeRegion={timezone:qe}):delete ve.timeRegion,Ye(ve)},Ee=me=>{Ye({...je,timeRegion:me})};return(0,D.jsxs)(b.n,{className:dt.container,children:[(0,D.jsx)(M.D,{label:"Query type",children:(0,D.jsx)(O.l6,{inputId:"grafana-annotations__query-type",options:ie,value:ze,onChange:pe})}),ze===S.nj.Annotations&&(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(M.D,{label:"Filter by",children:(0,D.jsx)(O.l6,{inputId:"grafana-annotations__filter-by",options:se,value:Ue,onChange:vt})}),(0,D.jsx)(M.D,{label:"Max limit",children:(0,D.jsx)(O.l6,{inputId:"grafana-annotations__limit",width:16,options:Z,value:Ze,onChange:yt})}),Ue===S.St.Tags&&(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(M.D,{label:"Match any",description:z,children:(0,D.jsx)(I.d,{id:"grafana-annotations__match-any",value:Ne,onChange:st})}),(0,D.jsx)(M.D,{label:"Tags",description:ee,children:(0,D.jsx)(T.$,{allowCustomValue:!0,inputId:"grafana-annotations__tags",onChange:Ve,tagOptions:C.vy,tags:Pe??[]})})]})]}),ze===S.nj.TimeRegions&&je.timeRegion&&(0,D.jsx)(ne,{value:je.timeRegion,onChange:Ee})]})}const ce=Le=>({container:(0,E.css)({maxWidth:Le.spacing(60),marginBottom:Le.spacing(2)})});var ye=e(11261),re=e(94515);function ue(Le,Ye,je,Ze){if(!Ye)return;const Ne=(0,re.iU)(Ye,je);if(!Ne.length)return;const Pe=[],Ue=[],$e=[],ze=Ye.timezone??Ze;for(const qe of Ne){let dt=qe.from,vt=qe.to;const yt=(0,N.QZ)(ze,dt);if(yt){const st=yt.offsetInMins*60*1e3;dt+=st,vt+=st}Pe.push(dt),Ue.push(vt),$e.push(Le)}return{fields:[{name:"time",type:ye.PU.time,values:Pe,config:{}},{name:"timeEnd",type:ye.PU.time,values:Ue,config:{}},{name:"text",type:ye.PU.string,values:$e,config:{}}],length:Pe.length}}let De=100;class ge extends d.iy{constructor(Ye){super(Ye),this.annotations={QueryEditor:oe,prepareAnnotation(je){return je.target=je.target??{type:je.type??S.St.Dashboard,limit:je.limit??100,tags:je.tags??[],matchAny:je.matchAny??!1},je},prepareQuery(je){let Ze;if((0,t.isString)(je.datasource)){const Ue=(0,y.og)(je.datasource,{returnDefaultAsNull:!1});Ue&&(Ze=Ue)}else Ze=je.datasource;const{filter:Ne,...Pe}=je;return{...Pe,refId:je.name,queryType:S.nj.Annotations,datasource:Ze}}}}getDefaultQuery(){return{queryType:S.nj.RandomWalk}}query(Ye){const je=[],Ze=[],Ne=(0,p.w)();for(const Pe of Ye.targets){if(Pe.queryType===S.nj.Annotations)return(0,n.H)(this.getAnnotations({range:Ye.range,rangeRaw:Ye.range.raw,annotation:Pe,dashboard:(0,u.UA)().getCurrent()}));if(!Pe.hide){if(Pe.queryType===S.nj.Snapshot){je.push((0,i.of)({data:(Pe.snapshot??[]).map(Ue=>(0,g.or)(Ue)),state:a.Gu.Done}));continue}if(Pe.queryType===S.nj.TimeRegions){const Ue=ue("",Pe.timeRegion,Ye.range,Ye.timezone);je.push((0,i.of)({data:Ue?[Ue]:[],state:a.Gu.Done}));continue}if(Pe.queryType===S.nj.LiveMeasurements){let Ue=Ne.replace(Pe.channel,Ye.scopedVars);const{filter:$e}=Pe,ze=(0,c.DG)(Ue);if(!(0,c.aj)(ze))continue;const qe={maxLength:Ye.maxDataPoints??500};Pe.buffer?(qe.maxDelta=Pe.buffer,qe.maxLength=qe.maxLength*2):Ye.rangeRaw?.to==="now"&&(qe.maxDelta=Ye.range.to.valueOf()-Ye.range.from.valueOf()),je.push((0,m.oF)().getDataStream({key:`${Ye.requestId}.${De++}`,addr:ze,filter:$e,buffer:qe}))}else Pe.queryType||(Pe.queryType=S.nj.RandomWalk),Ze.push(Pe)}}return Ze.length&&je.push(super.query({...Ye,targets:Ze})),je.length?je.length===1?je[0]:(0,s.h)(...je):(0,i.of)()}listFiles(Ye,je){return this.query({targets:[{refId:"A",queryType:S.nj.List,path:Ye}],maxDataPoints:je}).pipe((0,r.T)(Ze=>{const Ne=Ze.data[0]??new o.k;return new h.R(Ne)}))}metricFindQuery(){return Promise.resolve([])}async getAnnotations(Ye){const je=Ye.annotation.target;if(je?.queryType===S.nj.TimeRegions){const $e=ue(Ye.annotation.name,je.timeRegion,Ye.range,(0,u.UA)().getCurrent()?.timezone);return Promise.resolve({data:$e?[$e]:[]})}const Ze=Ye.annotation,Ne=Ze.target,Pe={from:Ye.range.from.valueOf(),to:Ye.range.to.valueOf(),limit:Ne.limit,tags:Ne.tags,matchAny:Ne.matchAny};if(Ne.type===S.St.Dashboard){if(!Ye.dashboard?.uid)return Promise.resolve({data:[]});Pe.dashboardUID=Ye.dashboard.uid,delete Pe.tags}else{if(!Array.isArray(Ne.tags)||Ne.tags.length===0)return Promise.resolve({data:[]});const $e=(0,p.w)(),ze="__delimiter__",qe=[];for(const dt of Pe.tags){const vt=$e.replace(dt,{},yt=>typeof yt=="string"?yt:yt.join(ze));for(const yt of vt.split(ze))qe.push(yt)}Pe.tags=qe}const Ue=await(0,v.AI)().get("/api/annotations",Pe,`grafana-data-source-annotations-${Ze.name}-${Ye.dashboard?.uid}`);return{data:[(0,f.Vc)(Ue)]}}testDatasource(){return Promise.resolve({message:"",status:""})}}async function Te(){return await(0,l.l)().get("-- Grafana --")}},68706:(k,R,e)=>{"use strict";e.d(R,{St:()=>s,dx:()=>i,nj:()=>t,uJ:()=>n});var t=(r=>(r.LiveMeasurements="measurements",r.Annotations="annotations",r.Snapshot="snapshot",r.TimeRegions="timeRegions",r.RandomWalk="randomWalk",r.List="list",r.Read="read",r.Search="search",r))(t||{});const n={refId:"A",queryType:"randomWalk"},i={refId:"A",datasource:{type:"grafana",uid:"grafana"},queryType:"snapshot",snapshot:[]};var s=(r=>(r.Dashboard="dashboard",r.Tags="tags",r))(s||{})},90478:(k,R,e)=>{"use strict";e.d(R,{H:()=>a,j:()=>o});var t=e(89667),n=e(28138),i=e(57220),s=e(40489),r=e(28444),g=e(68706);function a(h,f){return new Promise(d=>{if(h.datasource?.uid===i.vv){c(f,h),d(!0);return}n.A.publish(new r.bY({title:"Change to panel embedded data",text:"If you want to change the data shown in this panel Grafana will need to remove the panels current query and replace it with a snapshot of the current data. This enables you to edit the data.",yesText:"Continue",icon:"pen",onConfirm:()=>{c(f,h),d(!0)},onDismiss:()=>{d(!1)}}))})}function c(h,f){const d=h.map(m=>(0,t.Nw)(m)),p={refId:"A",queryType:g.nj.Snapshot,snapshot:d,datasource:{uid:i.vv}};f.updateQueries({dataSource:{uid:i.vv},queries:[p]}),f.refresh()}function o(h){return(f,d,p)=>{s.vI(f).subscribe(async m=>{const v=[];m.dataFrames.forEach(l=>{const y=(0,t.Nw)(l);v.push(y)}),h({...g.dx,snapshot:v,file:m.file},d)})}}},64100:(k,R,e)=>{"use strict";e.d(R,{Q$:()=>i,U3:()=>n,ti:()=>s});var t=(r=>(r.Builder="builder",r.Code="code",r))(t||{}),n=(r=>(r.Instant="instant",r.Range="range",r.Stream="stream",r))(n||{}),i=(r=>(r.DataSample="dataSample",r.InfiniteScroll="infiniteScroll",r.LogsSample="logsSample",r.LogsVolume="logsVolume",r))(i||{}),s=(r=>(r.Backward="backward",r.Forward="forward",r))(s||{})},71713:(k,R,e)=>{"use strict";e.d(R,{AW:()=>g,Ay:()=>c,RQ:()=>s,dZ:()=>t,fV:()=>r,vB:()=>a});const t=[{label:"avg",insertText:"avg",documentation:"Calculate the average over dimensions"},{label:"bottomk",insertText:"bottomk",documentation:"Smallest k elements by sample value"},{label:"count",insertText:"count",documentation:"Count number of elements in the vector"},{label:"max",insertText:"max",documentation:"Select maximum over dimensions"},{label:"min",insertText:"min",documentation:"Select minimum over dimensions"},{label:"stddev",insertText:"stddev",documentation:"Calculate population standard deviation over dimensions"},{label:"stdvar",insertText:"stdvar",documentation:"Calculate population standard variance over dimensions"},{label:"sum",insertText:"sum",documentation:"Calculate sum over dimensions"},{label:"topk",insertText:"topk",documentation:"Largest k elements by sample value"}],n=[{label:"json",insertText:"json",documentation:"Extracting labels from the log line using json parser."},{label:"regexp",insertText:'regexp ""',documentation:"Extracting labels from the log line using regexp parser.",move:-1},{label:"logfmt",insertText:"logfmt",documentation:"Extracting labels from the log line using logfmt parser."},{label:"pattern",insertText:"pattern",documentation:"Extracting labels from the log line using pattern parser. Only available in Loki 2.3+."},{label:"unpack",insertText:"unpack",detail:"unpack identifier",documentation:'Parses a JSON log line, unpacking all embedded labels in the pack stage. A special property "_entry" will also be used to replace the original log line. Only available in Loki 2.2+.'}],i=[{label:"unwrap",insertText:"unwrap",detail:"unwrap identifier",documentation:"Take labels and use the values as sample data for metric aggregations."},{label:"label_format",insertText:"label_format",documentation:"Use to rename, modify or add labels. For example, | label_format foo=bar ."},{label:"line_format",insertText:"line_format",documentation:'Rewrites log line content. For example, | line_format "{{.query}} {{.duration}}" .'}],s=[{insertText:"avg_over_time",label:"avg_over_time",detail:"avg_over_time(range-vector)",documentation:"The average of all values in the specified interval."},{insertText:"bytes_over_time",label:"bytes_over_time",detail:"bytes_over_time(range-vector)",documentation:"Counts the amount of bytes used by each log stream for a given range"},{insertText:"bytes_rate",label:"bytes_rate",detail:"bytes_rate(range-vector)",documentation:"Calculates the number of bytes per second for each stream."},{insertText:"first_over_time",label:"first_over_time",detail:"first_over_time(range-vector)",documentation:"The first of all values in the specified interval. Only available in Loki 2.3+."},{insertText:"last_over_time",label:"last_over_time",detail:"last_over_time(range-vector)",documentation:"The last of all values in the specified interval. Only available in Loki 2.3+."},{insertText:"sum_over_time",label:"sum_over_time",detail:"sum_over_time(range-vector)",documentation:"The sum of all values in the specified interval."},{insertText:"count_over_time",label:"count_over_time",detail:"count_over_time(range-vector)",documentation:"The count of all values in the specified interval."},{insertText:"max_over_time",label:"max_over_time",detail:"max_over_time(range-vector)",documentation:"The maximum of all values in the specified interval."},{insertText:"min_over_time",label:"min_over_time",detail:"min_over_time(range-vector)",documentation:"The minimum of all values in the specified interval."},{insertText:"quantile_over_time",label:"quantile_over_time",detail:"quantile_over_time(scalar, range-vector)",documentation:"The \u03C6-quantile (0 \u2264 \u03C6 \u2264 1) of the values in the specified interval."},{insertText:"rate",label:"rate",detail:"rate(v range-vector)",documentation:"Calculates the number of entries per second."},{insertText:"stddev_over_time",label:"stddev_over_time",detail:"stddev_over_time(range-vector)",documentation:"The population standard deviation of the values in the specified interval."},{insertText:"stdvar_over_time",label:"stdvar_over_time",detail:"stdvar_over_time(range-vector)",documentation:"The population standard variance of the values in the specified interval."}],r=[{insertText:"vector",label:"vector",detail:"vector(scalar)",documentation:"Returns the scalar as a vector with no labels."}],g=[...t,...s,...r],a={comment:{pattern:/#.*/},"context-aggregation":{pattern:/((without|by)\s*)\([^)]*\)/,lookbehind:!0,inside:{"label-key":{pattern:/[^(),\s][^,)]*[^),\s]*/,alias:"attr-name"},punctuation:/[()]/}},"context-labels":{pattern:/\{[^}]*(?=}?)/,greedy:!0,inside:{comment:{pattern:/#.*/},"label-key":{pattern:/[a-zA-Z_]\w*(?=\s*(=|!=|=~|!~))/,alias:"attr-name",greedy:!0},"label-value":{pattern:/"(?:\\.|[^\\"])*"/,greedy:!0,alias:"attr-value"},punctuation:/[{]/}},"context-pipe":{pattern:/\s\|[^=~]\s?\w*/i,inside:{"pipe-operator":{pattern:/\|/i,alias:"operator"},"pipe-operations":{pattern:new RegExp(`${[...n,...i].map(o=>o.label).join("|")}`,"i"),alias:"keyword"}}},function:new RegExp(`\\b(?:${g.map(o=>o.label).join("|")})(?=\\s*\\()`,"i"),"context-range":[{pattern:/\[[^\]]*(?=\])/,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}},{pattern:/(offset\s+)\w+/,lookbehind:!0,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}}],quote:{pattern:/"(?:\\.|[^\\"])*"/,alias:"string",greedy:!0},backticks:{pattern:/`(?:\\.|[^\\`])*`/,alias:"string",greedy:!0},number:/\b-?\d+((\.\d*)?([eE][+-]?\d+)?)?\b/,operator:/\s?(\|[=~]?|!=?|<(?:=>?|<|>)?|>[>=]?)\s?/i,punctuation:/[{}(),.]/},c=a},13137:(k,R,e)=>{"use strict";e.d(R,{HD:()=>i,Q$:()=>t.Q$,U3:()=>t.U3,ie:()=>s,ti:()=>t.ti});var t=e(64100),n=(r=>(r.Stream="streams",r.Vector="vector",r.Matrix="matrix",r))(n||{}),i=(r=>(r.Indexed="I",r.StructuredMetadata="S",r.Parsed="P",r))(i||{}),s=(r=>(r[r.LabelNames=0]="LabelNames",r[r.LabelValues=1]="LabelValues",r))(s||{})},14678:(k,R,e)=>{"use strict";e.d(R,{N8:()=>D,qM:()=>u,uv:()=>y});var t=e(2543),n=e.n(t),i=e(62467),s=e(65474),r=e(45650),g=e(69862),a=e(81160),c=e(9084),o=e(66847),h=e(93031),f=e(71030),d=e(40187),p=e(39070),m=e(72574),v=e(19347),l=e(12091);const y="-- Mixed --",u=(x,P)=>`mixed-${x}-${P||""}`;class D extends d.mA{constructor(P){super(P)}query(P){const b=P.targets.filter(I=>I.datasource?.uid!==y);if(!b.length)return(0,i.of)({data:[]});const M=(0,t.groupBy)(b,"datasource.uid"),O=[];for(const I in M)O.push(...this.getBatchesForQueries(M[I],P));return O.length?this.batchQueries(O,P):(0,i.of)({data:[]})}getBatchesForQueries(P,b){const M=P[0].datasource,O=[],I=(0,m.w)().replace(M?.uid,b.scopedVars,(T,C)=>{if(!Array.isArray(T))return T;for(const S of T){if(S==="default")continue;const A=(0,v.l)().getInstanceSettings(S);O.push({datasource:(0,v.l)().get(S),queries:(0,t.cloneDeep)(P),scopedVars:{...b.scopedVars,[C.name]:{value:S,text:A?.name}}})}return""});return I!==""&&O.push({datasource:(0,v.l)().get(I),queries:(0,t.cloneDeep)(P),scopedVars:{...b.scopedVars}}),O}batchQueries(P,b){const M=P.filter(this.isQueryable).map((O,I)=>(0,s.H)(O.datasource).pipe((0,g.Z)(T=>{const C=(0,t.cloneDeep)(b);return C.requestId=u(I,C.requestId),C.targets=O.queries,C.scopedVars=O.scopedVars,(0,s.H)(T.query(C)).pipe((0,a.T)(S=>({...S,data:S.data||[],state:p.Gu.Loading,key:u(I,S.key)})),(0,c.$)(),(0,o.W)(S=>(S=(0,l.u)(S),S.message=`${T.name}: ${S.message}`,(0,i.of)([{data:[],state:p.Gu.Error,error:S,key:u(I,C.requestId)}]))))})));return(0,r.p)(M).pipe(E(),(0,a.T)(this.finalizeResponses),(0,h.U)())}testDatasource(){return Promise.resolve({message:"",status:""})}isQueryable(P){return P&&Array.isArray(P.queries)&&P.queries.length>0}finalizeResponses(P){const{length:b}=P;if(b===0)return P;const M=P.find(O=>O.state===p.Gu.Error);return M?P.push(M):P[b-1].state=p.Gu.Done,P}}function E(){return(0,f.T)((x,P)=>P.reduce((b,M)=>(b.push.apply(b,M),b),x),[])}},19071:(k,R,e)=>{"use strict";e.d(R,{cd:()=>H,xw:()=>N});var t=e(37471),n=e(11261);const i={filters:[],groupBy:[]};var s=(ie=>(ie.Done="done",ie.Error="error",ie.Pending="pending",ie.Streaming="streaming",ie))(s||{}),r=(ie=>(ie.Raw="raw",ie.Spans="spans",ie.Traces="traces",ie))(r||{}),g=(ie=>(ie.Intrinsic="intrinsic",ie.Resource="resource",ie.Span="span",ie.Unscoped="unscoped",ie))(g||{});function a(ie){const{nodes:Z,edges:oe}=c(ie),[ce,ye]=makeFrames();for(const re of Z)ce.add(re);for(const re of oe)ye.add(re);return[ce,ye]}function c(ie){const Z=[],oe=[],ce=new DataFrameView(ie),ye=o(ce),re=makeSpanMap(ue=>{if(ue>=ie.length)return;const De=ce.get(ue);return{span:{...De},id:De.spanID,parentIds:De.parentSpanID?[De.parentSpanID]:[]}});for(let ue=0;ue<ce.length;ue++){const De=ce.get(ue),ge=re[De.spanID].children.map(je=>{const Ze=re[je].span;return[Ze.startTime,Ze.startTime+Ze.duration]}),Te=getNonOverlappingDuration(ge),Le=De.duration-Te,Ye=getStats(De.duration,ye,Le);Z.push({[Fields.id]:De.spanID,[Fields.title]:De.serviceName??"",[Fields.subTitle]:De.operationName,[Fields.mainStat]:Ye.main,[Fields.secondaryStat]:Ye.secondary,[Fields.color]:Le/ye}),De.parentSpanID&&re[De.parentSpanID].span&&oe.push({[Fields.id]:De.parentSpanID+"--"+De.spanID,[Fields.target]:De.spanID,[Fields.source]:De.parentSpanID})}return{nodes:Z,edges:oe}}function o(ie){let Z=0,oe=1/0;for(let ce=0;ce<ie.length;ce++){const ye=ie.get(ce);ye.startTime<oe&&(oe=ye.startTime),ye.startTime+ye.duration>Z&&(Z=ye.startTime+ye.duration)}return Z-oe}const h="traces_service_graph_request_server_seconds_sum",f="traces_service_graph_request_total",d="traces_service_graph_request_failed_total",p="traces_service_graph_request_server_seconds_bucket",m={expr:"sum(rate(traces_spanmetrics_calls_total{}[$__range])) by (span_name)",topk:5,params:[]},v={expr:"sum(rate(traces_spanmetrics_calls_total{}[$__range])) by (span_name)",topk:5,params:['status_code="STATUS_CODE_ERROR"']},l={expr:"histogram_quantile(.9, sum(rate(traces_spanmetrics_latency_bucket{}[$__range])) by (le))",params:[]},y='span_kind="SPAN_KIND_SERVER"',u=[h,f,d,p];function D(ie,Z){const oe=x(ie),ce={},ye={};return b(oe[f],"total",f,ce,ye),b(oe[h],"seconds",h,ce,ye),b(oe[d],"failed",d,ce,ye),M(ce,ye,Z)}function E(){function ie(ce,ye){return new MutableDataFrame({name:ce,fields:ye,meta:{preferredVisualisationType:"nodeGraph"}})}const Z=ie("Nodes",[{name:Fields.id,type:FieldType.string,values:[]},{name:Fields.title,type:FieldType.string,config:{displayName:"Service name"},values:[]},{name:Fields.subTitle,type:FieldType.string,config:{displayName:"Service namespace"},values:[]},{name:Fields.mainStat,type:FieldType.number,config:{unit:"ms/r",displayName:"Average response time"},values:[]},{name:Fields.secondaryStat,type:FieldType.number,config:{unit:"r/sec",displayName:"Requests per second"},values:[]},{name:Fields.arc+"success",type:FieldType.number,config:{displayName:"Success",color:{fixedColor:"green",mode:FieldColorModeId.Fixed}},values:[]},{name:Fields.arc+"failed",type:FieldType.number,config:{displayName:"Failed",color:{fixedColor:"red",mode:FieldColorModeId.Fixed}},values:[]}]),oe=ie("Edges",[{name:Fields.id,type:FieldType.string,values:[]},{name:Fields.source,type:FieldType.string,values:[]},{name:"sourceName",type:FieldType.string,values:[]},{name:"sourceNamespace",type:FieldType.string,values:[]},{name:Fields.target,type:FieldType.string,values:[]},{name:"targetName",type:FieldType.string,values:[]},{name:"targetNamespace",type:FieldType.string,values:[]},{name:Fields.mainStat,type:FieldType.number,config:{unit:"ms/r",displayName:"Average response time"},values:[]},{name:Fields.secondaryStat,type:FieldType.number,config:{unit:"r/sec",displayName:"Requests per second"},values:[]}]);return[Z,oe]}function x(ie){return(ie[0]?.data||[]).reduce((Z,oe)=>{const ce=toDataFrame(oe);return Z[ce.refId??"A"]=new DataFrameView(ce),Z},{})}var P=(ie=>(ie.sourceName="sourceName",ie.sourceNamespace="sourceNamespace",ie.targetName="targetName",ie.targetNamespace="targetNamespace",ie))(P||{});function b(ie,Z,oe,ce,ye){if(!ie)return;const re=`Value #${oe}`;for(let ue=0;ue<ie.length;ue++){const De=ie.get(ue),ge=De.server_service_namespace?`${De.server_service_namespace}/${De.server}`:De.server,Te=De.client_service_namespace?`${De.client_service_namespace}/${De.client}`:De.client,Le=`${Te}_${ge}`;ye[Le]?ye[Le][Z]=(ye[Le][Z]||0)+De[re]:ye[Le]={target:ge,targetName:De.server,targetNamespace:De.server_service_namespace,source:Te,sourceName:De.client,sourceNamespace:De.client_service_namespace,[Z]:De[re]},ce[ge]?ce[ge][Z]=(ce[ge][Z]||0)+De[re]:ce[ge]={name:De.server,namespace:De.server_service_namespace,[Z]:De[re]},ce[Te]||(ce[Te]={name:De.client,namespace:De.client_service_namespace,[Z]:0})}}function M(ie,Z,oe){const[ce,ye]=E();for(const re of Object.keys(ie)){const ue=ie[re];ce.add({[Fields.id]:re,[Fields.title]:ue.name,[Fields.subTitle]:ue.namespace,[Fields.mainStat]:ue.total?ue.seconds/ue.total*1e3:Number.NaN,[Fields.secondaryStat]:ue.total?Math.round(ue.total*100)/100:Number.NaN,[Fields.arc+"success"]:ue.total?(ue.total-Math.min(ue.failed||0,ue.total))/ue.total:1,[Fields.arc+"failed"]:ue.total?Math.min(ue.failed||0,ue.total)/ue.total:0})}for(const re of Object.keys(Z)){const ue=Z[re];ye.add({[Fields.id]:re,[Fields.source]:ue.source,sourceName:ue.sourceName,sourceNamespace:ue.sourceNamespace,[Fields.target]:ue.target,targetName:ue.targetName,targetNamespace:ue.targetNamespace,[Fields.mainStat]:ue.total?ue.seconds/ue.total*1e3:Number.NaN,[Fields.secondaryStat]:ue.total?Math.round(ue.total*100)/100:Number.NaN})}return{nodes:ce,edges:ye}}function O(ie){if(ie.stringValue)return ie.stringValue;if(ie.boolValue!==void 0)return!!ie.boolValue;if(ie.intValue!==void 0)return Number.parseInt(ie.intValue,10);if(ie.doubleValue)return Number.parseFloat(ie.doubleValue);if(ie.arrayValue){const Z=[];for(const oe of ie.arrayValue.values)Z.push(O(oe));return Z}return""}function I(ie){const Z=[];let oe="OTLPResourceNoServiceName";if(!ie)return{serviceName:oe,serviceTags:Z};for(const ce of ie.attributes)ce.key===SemanticResourceAttributes.SERVICE_NAME&&(oe=ce.value.stringValue||oe),Z.push({key:ce.key,value:O(ce.value)});return{serviceName:oe,serviceTags:Z}}function T(ie){const Z=[];if(ie.attributes)for(const oe of ie.attributes)Z.push({key:oe.key,value:O(oe.value)});return Z}function C(ie){let Z;if(ie.kind){const oe=ie.kind.toString().toLowerCase().split("_");Z=oe.length?oe[oe.length-1]:ie.kind.toString()}return Z}function S(ie){const Z=[];if(ie.links)for(const oe of ie.links){const{traceId:ce,spanId:ye}=oe,re=[];if(oe.attributes)for(const ue of oe.attributes)re.push({key:ue.key,value:O(ue.value)});Z.push({traceID:ce,spanID:ye,tags:re})}return Z}function A(ie){const Z=[];if(ie.events)for(const oe of ie.events){const ce=[];if(oe.attributes)for(const ye of oe.attributes)ce.push({key:ye.key,value:O(ye.value)});Z.push({fields:ce,timestamp:oe.timeUnixNano/1e6})}return Z}function L(ie,Z=!1){const oe=new MutableDataFrame({fields:[{name:"traceID",type:FieldType.string,values:[]},{name:"spanID",type:FieldType.string,values:[]},{name:"parentSpanID",type:FieldType.string,values:[]},{name:"operationName",type:FieldType.string,values:[]},{name:"serviceName",type:FieldType.string,values:[]},{name:"kind",type:FieldType.string,values:[]},{name:"statusCode",type:FieldType.number,values:[]},{name:"statusMessage",type:FieldType.string,values:[]},{name:"instrumentationLibraryName",type:FieldType.string,values:[]},{name:"instrumentationLibraryVersion",type:FieldType.string,values:[]},{name:"traceState",type:FieldType.string,values:[]},{name:"serviceTags",type:FieldType.other,values:[]},{name:"startTime",type:FieldType.number,values:[]},{name:"duration",type:FieldType.number,values:[]},{name:"logs",type:FieldType.other,values:[]},{name:"references",type:FieldType.other,values:[]},{name:"tags",type:FieldType.other,values:[]}],meta:{preferredVisualisationType:"trace",custom:{traceFormat:"otlp"}}});try{for(const ye of ie){const{serviceName:re,serviceTags:ue}=I(ye.resource);for(const De of ye.instrumentationLibrarySpans)for(const ge of De.spans)oe.add({traceID:ge.traceId.length>16?ge.traceId.slice(16):ge.traceId,spanID:ge.spanId,parentSpanID:ge.parentSpanId||"",operationName:ge.name||"",serviceName:re,kind:C(ge),statusCode:ge.status?.code,statusMessage:ge.status?.message,instrumentationLibraryName:De.instrumentationLibrary?.name,instrumentationLibraryVersion:De.instrumentationLibrary?.version,traceState:ge.traceState,serviceTags:ue,startTime:ge.startTimeUnixNano/1e6,duration:(ge.endTimeUnixNano-ge.startTimeUnixNano)/1e6,tags:T(ge),logs:A(ge),references:S(ge)})}}catch(ye){return console.error(ye),{error:{message:"JSON is not valid OpenTelemetry format: "+ye},data:[]}}let ce=[oe];return Z&&ce.push(...createGraphFrames(oe)),{data:ce}}function N(ie){let Z={batches:[]},oe={};for(let ce=0;ce<ie.length;ce++){const ye=ie.get(ce);oe[ye.serviceName]||(oe[ye.serviceName]=Z.batches.length,Z.batches.push({resource:{attributes:[],droppedAttributesCount:0},instrumentationLibrarySpans:[{spans:[]}]}));let re=oe[ye.serviceName];Z.batches[re].resource.attributes.length===0&&(Z.batches[re].resource.attributes=w(ye.serviceTags)),Z.batches[re].instrumentationLibrarySpans[0].instrumentationLibrary||ye.instrumentationLibraryName&&(Z.batches[re].instrumentationLibrarySpans[0].instrumentationLibrary={name:ye.instrumentationLibraryName,version:ye.instrumentationLibraryVersion?ye.instrumentationLibraryVersion:""}),Z.batches[re].instrumentationLibrarySpans[0].spans.push({traceId:ye.traceID.padStart(32,"0"),spanId:ye.spanID,parentSpanId:ye.parentSpanID||"",traceState:ye.traceState||"",name:ye.operationName,kind:F(ye.kind),startTimeUnixNano:ye.startTime*1e6,endTimeUnixNano:(ye.startTime+ye.duration)*1e6,attributes:ye.tags?w(ye.tags):[],droppedAttributesCount:0,droppedEventsCount:0,droppedLinksCount:0,status:U(ye),events:K(ye.logs),links:V(ye.references)})}return Z}function F(ie){let Z;if(ie)switch(ie){case"server":Z="SPAN_KIND_SERVER";break;case"client":Z="SPAN_KIND_CLIENT";break;case"producer":Z="SPAN_KIND_PRODUCER";break;case"consumer":Z="SPAN_KIND_CONSUMER";break;case"internal":Z="SPAN_KIND_INTERNAL";break}return Z}function w(ie){return ie.reduce((Z,oe)=>[...Z,{key:oe.key,value:B(oe)}],[])}function B(ie){if(typeof ie.value=="string")return{stringValue:ie.value};if(typeof ie.value=="boolean")return{boolValue:ie.value};if(typeof ie.value=="number")return ie.value%1===0?{intValue:ie.value}:{doubleValue:ie.value};if(typeof ie.value=="object"&&Array.isArray(ie.value)){const Z=[];for(const oe of ie.value)Z.push(B(oe));return{arrayValue:{values:Z}}}return{stringValue:ie.value}}function U(ie){let Z;return ie.statusCode!==void 0&&(Z={code:ie.statusCode,message:ie.statusMessage?ie.statusMessage:""}),Z}function K(ie){if(!ie||!ie.length)return;let Z=[];for(const oe of ie){let ce={timeUnixNano:oe.timestamp*1e6,attributes:[],droppedAttributesCount:0,name:""};for(const ye of oe.fields)ce.attributes.push({key:ye.key,value:B(ye)});Z.push(ce)}return Z}function V(ie){if(!ie||!ie.length)return;let Z=[];for(const oe of ie){let ce={traceId:oe.traceID,spanId:oe.spanID,attributes:[],droppedAttributesCount:0};if(oe.tags?.length)for(const ye of oe.tags)ce.attributes?.push({key:ye.key,value:B(ye)});Z.push(ce)}return Z}const H="Related profiles";function Y(ie,Z,oe=!1){const ce=ie.data[0];if(!ce)return se;const re=Z?.jsonData?.tracesToProfiles;let ue;if(re?.datasourceUid&&(ue=getDataSourceSrv().getInstanceSettings(re.datasourceUid)),re&&ue){const ge=re.customQuery?re.query:void 0,Te={title:H,url:"",internal:{datasourceUid:ue.uid,datasourceName:ue.name,query:{labelSelector:ge||"{${__tags}}",groupBy:[],profileTypeId:re.profileTypeId??"",queryType:"profile",spanSelector:['${__span.tags["pyroscope.profile.id"]}'],refId:"profile"}},origin:DataLinkConfigOrigin.Datasource};ce.fields.forEach(Le=>{Le.name==="tags"&&(Le.config.links=[Te])})}let De=[...ie.data];return oe&&De.push(...createGraphFrames(toDataFrame(ce))),{...ie,data:De}}function X(ie){return{traceID:ie.traceID,startTime:parseInt(ie.startTimeUnixNano,10)/1e6,traceDuration:ie.durationMs,traceService:ie.rootServiceName||"",traceName:ie.rootTraceName||""}}const J=ie=>ie.stringValue?`"${ie.stringValue}"`:""+(ie.intValue||ie.doubleValue||ie.boolValue||'""');function q(ie,Z){return Z.series.map((ce,ye)=>{const re={};ce.labels?.forEach(De=>{re[De.key]=J(De.value)});let ue=Z.series.length===1?ie:"";return ce.labels&&(ce.labels.length===1?ue=J(ce.labels[0].value):ue=`{${ce.labels.map(De=>`${De.key}=${J(De.value)}`).join(", ")}}`),createDataFrame({refId:ue||`A${ye}`,fields:[{name:"time",type:FieldType.time,values:ce.samples.map(De=>parseInt(De.timestampMs,10))},{name:ue,labels:re,type:FieldType.number,values:ce.samples.map(De=>De.value),config:{displayNameFromDS:ue}}],meta:{preferredVisualisationType:"graph"}})})}function ae(ie,Z,oe){switch(oe){case SearchTableType.Spans:return ne(ie,Z);case SearchTableType.Raw:return j(ie);default:return te(ie,Z)}}function j(ie){return[createDataFrame({name:"Raw response",refId:"raw",fields:[{name:"response",type:FieldType.string,values:[JSON.stringify(ie,null,2)]}]})]}function te(ie,Z){const oe=createDataFrame({name:"Traces",refId:"traces",fields:[{name:"traceID",type:FieldType.string,config:{unit:"string",displayNameFromDS:"Trace ID",custom:{width:200},links:[{title:"Trace: ${__value.raw}",url:"",internal:{datasourceUid:Z.uid,datasourceName:Z.name,query:{query:"${__value.raw}",queryType:"traceql"}}}]}},{name:"startTime",type:FieldType.time,config:{displayNameFromDS:"Start time",custom:{width:200}}},{name:"traceService",type:FieldType.string,config:{displayNameFromDS:"Service"}},{name:"traceName",type:FieldType.string,config:{displayNameFromDS:"Name"}},{name:"traceDuration",type:FieldType.number,config:{displayNameFromDS:"Duration",unit:"ms",custom:{width:120}}},{name:"nested",type:FieldType.nestedFrames}],meta:{preferredVisualisationType:"table",uniqueRowIdFields:[0]}});return ie?.length?(oe.length=ie.length,ie.sort((ce,ye)=>parseInt(ye?.startTimeUnixNano,10)/1e6-parseInt(ce?.startTimeUnixNano,10)/1e6).forEach(ce=>{const ye=X(ce);oe.fields[0].values.push(ye.traceID),oe.fields[1].values.push(ye.startTime),oe.fields[2].values.push(ye.traceService),oe.fields[3].values.push(ye.traceName),oe.fields[4].values.push(ye.traceDuration?ye.traceDuration:"<1ms"),ce.spanSets?oe.fields[5].values.push(ce.spanSets.map(re=>z(ce,re,Z))):ce.spanSet&&oe.fields[5].values.push([z(ce,ce.spanSet,Z)])}),[oe]):[oe]}function ne(ie,Z){const oe={};let ce=!1;ie?.forEach(re=>le(re).forEach(ue=>{ue.attributes?.forEach(De=>{oe[De.key]={name:De.key,type:FieldType.string,config:{displayNameFromDS:De.key}}}),ue.spans.forEach(De=>{De.name&&(ce=!0),De.attributes?.forEach(ge=>{oe[ge.key]={name:ge.key,type:FieldType.string,config:{displayNameFromDS:ge.key}}})})}));const ye=new MutableDataFrame({name:"Spans",refId:"traces",fields:[{name:"traceIdHidden",type:FieldType.string,config:{custom:{hidden:!0}}},{name:"traceService",type:FieldType.string,config:{displayNameFromDS:"Trace Service",custom:{width:200}}},{name:"traceName",type:FieldType.string,config:{displayNameFromDS:"Trace Name",custom:{width:200}}},{name:"spanID",type:FieldType.string,config:{unit:"string",displayNameFromDS:"Span ID",custom:{width:200},links:[{title:"Span: ${__value.raw}",url:"",internal:{datasourceUid:Z.uid,datasourceName:Z.name,query:{query:"${__data.fields.traceIdHidden}",queryType:"traceql"},panelsState:{trace:{spanId:"${__value.raw}"}}}}]}},{name:"time",type:FieldType.time,config:{displayNameFromDS:"Start time"}},{name:"name",type:FieldType.string,config:{displayNameFromDS:"Name",custom:{hidden:!ce}}},...Object.values(oe).sort((re,ue)=>re.name.localeCompare(ue.name)),{name:"duration",type:FieldType.number,config:{displayNameFromDS:"Duration",unit:"ns",custom:{width:120}}}],meta:{preferredVisualisationType:"table"}});return!ie||!ie.length?[ye]:(ie.sort((re,ue)=>parseInt(ue?.startTimeUnixNano,10)/1e6-parseInt(re?.startTimeUnixNano,10)/1e6).forEach(re=>{le(re).forEach(ue=>{ue.spans.forEach(De=>{ye.add(ee(De,ue,re))})})}),[ye])}const le=ie=>ie.spanSets||(ie.spanSet?[ie.spanSet]:[]),z=(ie,Z,oe)=>{const ce={};let ye=!1;Z.attributes?.map(De=>{ce[De.key]={name:De.key,type:FieldType.string,config:{displayNameFromDS:De.key},values:[]}}),Z.spans.forEach(De=>{De.name&&(ye=!0),De.attributes?.forEach(ge=>{ce[ge.key]={name:ge.key,type:FieldType.string,config:{displayNameFromDS:ge.key},values:[]}})});const re=new MutableDataFrame({fields:[{name:"traceIdHidden",type:FieldType.string,config:{custom:{hidden:!0}},values:[]},{name:"spanID",type:FieldType.string,values:[],config:{unit:"string",displayNameFromDS:"Span ID",custom:{width:200},links:[{title:"Span: ${__value.raw}",url:"",internal:{datasourceUid:oe.uid,datasourceName:oe.name,query:{query:"${__data.fields.traceIdHidden}",queryType:"traceql"},panelsState:{trace:{spanId:"${__value.raw}"}}}}]}},{name:"time",type:FieldType.time,config:{displayNameFromDS:"Start time",custom:{width:200}}},{name:"name",type:FieldType.string,values:[],config:{displayNameFromDS:"Name",custom:{hidden:!ye}}},...Object.values(ce).sort((De,ge)=>De.name.localeCompare(ge.name)),{name:"duration",type:FieldType.number,values:[],config:{displayNameFromDS:"Duration",unit:"ns",custom:{width:120}}}],meta:{preferredVisualisationType:"table"}}),ue=createTheme();for(const De of re.fields)De.display=getDisplayProcessor({field:De,theme:ue});return Z.spans.forEach(De=>{re.add(ee(De,Z,ie))}),re};function ee(ie,Z,oe){const ce=parseInt(ie.startTimeUnixNano,10)/1e6,ye={traceIdHidden:oe.traceID,traceService:oe.rootServiceName||"",traceName:oe.rootTraceName||"",spanID:ie.spanID,time:ce,duration:parseInt(ie.durationNanos,10),name:ie.name};let re=[];return Z.attributes&&(re=re.concat(Z.attributes)),ie.attributes&&(re=re.concat(ie.attributes)),re.forEach(ue=>{(ue.value.boolValue||ue.value.Value?.bool_value)&&(ye[ue.key]=ue.value.boolValue||ue.value.Value?.bool_value),(ue.value.doubleValue||ue.value.Value?.double_value)&&(ye[ue.key]=ue.value.doubleValue||ue.value.Value?.double_value),(ue.value.intValue||ue.value.Value?.int_value)&&(ye[ue.key]=ue.value.intValue||ue.value.Value?.int_value),(ue.value.stringValue||ue.value.Value?.string_value)&&(ye[ue.key]=ue.value.stringValue||ue.value.Value?.string_value)}),ye}const se={data:[new t.k({fields:[{name:"trace",type:n.PU.trace,values:[]}],meta:{preferredVisualisationType:"trace",custom:{traceFormat:"otlp"}}})]}},64861:(k,R,e)=>{"use strict";e.d(R,{nE:()=>s,r6:()=>i,xB:()=>t});var t=(r=>(r[r.AlphaAsc=1]="AlphaAsc",r[r.AlphaDesc=2]="AlphaDesc",r[r.Importance=3]="Importance",r[r.TimeAsc=4]="TimeAsc",r[r.TimeDesc=5]="TimeDesc",r))(t||{}),n=(r=>(r.Current="current",r.RecentChanges="changes",r))(n||{}),i=(r=>(r.Default="default",r.Custom="custom",r))(i||{}),s=(r=>(r.List="list",r.Stat="stat",r))(s||{})},39758:(k,R,e)=>{"use strict";e.d(R,{mn:()=>g,ur:()=>n});var t=e(97706);const n=1,i=2,s=3,r=(a,c,o,h)=>(0,t.h)(c+a*(o+h),6);function g(a,c,o,h,f){let d=1-c,p=o===n?d/(a-1):o===i?d/a:o===s?d/(a+1):0;(isNaN(p)||p===1/0)&&(p=0);let m=o===n?0:o===i?p/2:o===s?p:0,v=c/a,l=(0,t.h)(v,6);if(h==null)for(let y=0;y<a;y++)f(y,r(y,m,v,p),l);else f(h,r(h,m,v,p),l)}},4134:(k,R,e)=>{"use strict";e.d(R,{C$:()=>g,HY:()=>r,Tr:()=>s,ur:()=>i});const t=10,n=4;function i(a,c,o,h,f,d){return a>=o&&a<=f&&c>=h&&c<=d}function s(a,c,o){let h=[];if(a.o.length&&h.push(...a.o.filter(f=>(c==null||f.sidx===c)&&(o==null||f.didx===o))),a.q)for(let f=0;f<a.q.length;f++)h.push(...s(a.q[f],c,o));return h}function r(a,c){return a.x<=c.x+c.w&&a.x+a.w>=c.x&&a.y+a.h>=c.y&&a.y<=c.y+c.h}class g{constructor(c,o,h,f,d=0){this.x=c,this.y=o,this.w=h,this.h=f,this.l=d,this.o=[],this.q=null}split(){let c=this,o=c.x,h=c.y,f=c.w/2,d=c.h/2,p=c.l+1;c.q=[new g(o+f,h,f,d,p),new g(o,h,f,d,p),new g(o,h+d,f,d,p),new g(o+f,h+d,f,d,p)]}quads(c,o,h,f,d){let p=this,m=p.q,v=p.x+p.w/2,l=p.y+p.h/2,y=o<l,u=c<v,D=c+h>v,E=o+f>l;y&&D&&d(m[0]),u&&y&&d(m[1]),u&&E&&d(m[2]),D&&E&&d(m[3])}add(c){let o=this;if(o.q!=null)o.quads(c.x,c.y,c.w,c.h,h=>{h.add(c)});else{let h=o.o;if(h.push(c),h.length>t&&o.l<n){o.split();for(let f=0;f<h.length;f++){let d=h[f];o.quads(d.x,d.y,d.w,d.h,p=>{p.add(d)})}o.o.length=0}}}get(c,o,h,f,d){let p=this,m=p.o;for(let v=0;v<m.length;v++)d(m[v]);p.q!=null&&p.quads(c,o,h,f,v=>{v.get(c,o,h,f,d)})}clear(){this.o.length=0,this.q=null}}},58384:(k,R,e)=>{"use strict";e.d(R,{d:()=>p,l:()=>m});var t=e(74848),n=e(2543),i=e.n(n),s=e(96540),r=e(47070),g=e(56323),a=e(52622),c=e(97696),o=e(59796),h=e(12509),f=e(2913),d=e(17516);class p extends s.PureComponent{constructor(){super(...arguments),this.renderComponent=(l,y)=>{const{options:u,fieldConfig:D}=this.props,{value:E,alignmentFactors:x,orientation:P,width:b,height:M,count:O}=l,{field:I,display:T,view:C,colIndex:S}=E,{openMenu:A,targetClassName:L}=y;let N;return C&&(0,n.isNumber)(S)&&(N=C.getFieldDisplayProcessor(S)),(0,t.jsx)(c.xE,{value:m(O,D.defaults,T),width:b,height:M,orientation:P,field:I,text:u.text,display:N,theme:f.config.theme2,itemSpacing:this.getItemSpacing(),displayMode:u.displayMode,onClick:A,className:L,alignmentFactors:O>1?x:void 0,showUnfilled:u.showUnfilled,valueDisplayMode:u.valueMode,namePlacement:u.namePlacement})},this.renderValue=l=>{const{value:y,orientation:u}=l,{hasLinks:D,getLinks:E}=y;return D&&E?(0,t.jsx)("div",{style:{width:"100%",display:u===r.wV.Vertical?"flex":"initial"},children:(0,t.jsx)(o.e,{style:{height:"100%"},links:E,children:x=>this.renderComponent(l,x)})}):this.renderComponent(l,{})},this.getValues=()=>{const{data:l,options:y,replaceVariables:u,fieldConfig:D,timeZone:E}=this.props;return(0,g.PI)({fieldConfig:D,reduceOptions:y.reduceOptions,replaceVariables:u,theme:f.config.theme2,data:l.series,timeZone:E})}}getItemSpacing(){return this.props.options.displayMode==="lcd"?2:10}getOrientation(){const{options:l,width:y,height:u}=this.props,{orientation:D}=l;return D===r.wV.Auto?y>u?r.wV.Vertical:r.wV.Horizontal:D}calcBarSize(){const{options:l}=this.props,y=this.getOrientation(),u=l.sizing===a.T6.Manual,D=y===r.wV.Vertical,E=y===r.wV.Horizontal,x=u&&D?l.minVizWidth:d.K.minVizWidth,P=u&&E?l.minVizHeight:d.K.minVizHeight,b=u&&E?l.maxVizHeight:d.K.maxVizHeight;return{minVizWidth:x,minVizHeight:P,maxVizHeight:b}}render(){const{height:l,width:y,options:u,data:D,renderCounter:E}=this.props,{minVizWidth:x,minVizHeight:P,maxVizHeight:b}=this.calcBarSize();return(0,t.jsx)(h.S,{source:D,getAlignmentFactors:g.XS,getValues:this.getValues,renderValue:this.renderValue,renderCounter:E,width:y,height:l,maxVizHeight:b,minVizWidth:x,minVizHeight:P,itemSpacing:this.getItemSpacing(),orientation:u.orientation})}}function m(v,l,y){return v===1&&!l.displayName?{...y,title:void 0}:y}},17516:(k,R,e)=>{"use strict";e.d(R,{K:()=>n});var t=e(52622);const n={displayMode:t.eX.Gradient,maxVizHeight:300,minVizHeight:16,minVizWidth:8,namePlacement:t.TZ.Auto,showUnfilled:!0,sizing:t.T6.Auto,valueMode:t.$l.Color}},14738:(k,R,e)=>{"use strict";e.r(R),e.d(R,{plugin:()=>P});var t=e(65158),n=e(52622),i=e(71242),s=e(23799),r=e(63250);const g=b=>(0,r._$)(b),a=(b,M,O)=>{const I=(0,r.gl)(b,M,O);if(M==="singlestat"&&O.angular){const T=O.angular.gauge;T&&(I.showThresholdMarkers=T.thresholdMarkers,I.showThresholdLabels=T.thresholdLabels)}return I};var c=e(74848),o=e(96540),h=e(57875),f=e(56323),d=e(95164),p=e(59796),m=e(12509),v=e(2913),l=e(58384);const y={minVizHeight:75,minVizWidth:75,showThresholdLabels:!1,showThresholdMarkers:!0,sizing:n.T6.Auto};class u extends o.PureComponent{constructor(){super(...arguments),this.renderComponent=(M,O)=>{const{options:I,fieldConfig:T}=this.props,{width:C,height:S,count:A,value:L}=M,{field:N,display:F}=L,{openMenu:w,targetClassName:B}=O;return(0,c.jsx)(d._,{value:(0,l.l)(A,T.defaults,F),width:C,height:S,field:N,text:I.text,showThresholdLabels:I.showThresholdLabels,showThresholdMarkers:I.showThresholdMarkers,theme:v.config.theme2,onClick:w,className:B,orientation:I.orientation})},this.renderValue=M=>{const{value:O}=M,{getLinks:I,hasLinks:T}=O;return T&&I?(0,c.jsx)(p.e,{links:I,style:{flexGrow:1},children:C=>this.renderComponent(M,C)}):this.renderComponent(M,{})},this.getValues=()=>{const{data:M,options:O,replaceVariables:I,fieldConfig:T,timeZone:C}=this.props;for(let S of M.series)for(let A of S.fields)if(A.config.unit==="percent"||A.config.unit==="percentunit"){const L=A.config.min??0,N=A.config.max??(A.config.unit==="percent"?100:1);A.state=A.state??{},A.state.range={min:L,max:N,delta:N-L},A.display=(0,h.J)({field:A,theme:v.config.theme2})}return(0,f.PI)({fieldConfig:T,reduceOptions:O.reduceOptions,replaceVariables:I,theme:v.config.theme2,data:M.series,timeZone:C})},this.calculateGaugeSize=()=>{const{options:M}=this.props,O=M.orientation,I=M.sizing===n.T6.Manual,T=O===n.wV.Vertical,C=O===n.wV.Horizontal,S=I&&T?M.minVizWidth:y.minVizWidth,A=I&&C?M.minVizHeight:y.minVizHeight;return{minVizWidth:S,minVizHeight:A}}}render(){const{height:M,width:O,data:I,renderCounter:T,options:C}=this.props,{minVizHeight:S,minVizWidth:A}=this.calculateGaugeSize();return(0,c.jsx)(m.S,{getValues:this.getValues,renderValue:this.renderValue,width:O,height:M,source:I,autoGrid:!0,renderCounter:T,orientation:C.orientation,minVizHeight:S,minVizWidth:A})}}var D=e(50082),E=e(38824);class x{getSuggestionsForData(M){const{dataSummary:O}=M;if(!O.hasData||!O.hasNumberField||O.numberFieldCount>=50)return;const I=M.getListAppender({name:E.m.Gauge,pluginId:"gauge",options:{},fieldConfig:{defaults:{thresholds:{steps:[{value:-1/0,color:"green"},{value:70,color:"orange"},{value:85,color:"red"}],mode:D.O.Percentage},custom:{}},overrides:[]},cardOptions:{previewModifier:T=>{T.options.reduceOptions.values&&(T.options.reduceOptions.limit=2)}}});O.hasStringField&&O.frameCount===1&&O.rowCountTotal<10?(I.append({name:E.m.Gauge,options:{reduceOptions:{values:!0,calcs:[]}}}),I.append({name:E.m.GaugeNoThresholds,options:{reduceOptions:{values:!0,calcs:[]},showThresholdMarkers:!1}})):(I.append({name:E.m.Gauge,options:{reduceOptions:{values:!1,calcs:["lastNotNull"]}}}),I.append({name:E.m.GaugeNoThresholds,options:{reduceOptions:{values:!1,calcs:["lastNotNull"]},showThresholdMarkers:!1}}))}}const P=new t.m(u).useFieldConfig({useCustomConfig:b=>{b.addNumberInput({path:"neutral",name:"Neutral",description:"Leave empty to use Min as neutral point",category:["Gauge"],settings:{placeholder:"auto"}})}}).setPanelOptions(b=>{(0,s.L)(b),(0,s.h)(b),b.addBooleanSwitch({path:"showThresholdLabels",name:"Show threshold labels",description:"Render the threshold values around the gauge bar",defaultValue:y.showThresholdLabels}).addBooleanSwitch({path:"showThresholdMarkers",name:"Show threshold markers",description:"Renders the thresholds as an outer bar",defaultValue:y.showThresholdMarkers}).addRadio({path:"sizing",name:"Gauge size",settings:{options:[{value:n.T6.Auto,label:"Auto"},{value:n.T6.Manual,label:"Manual"}]},defaultValue:y.sizing,showIf:M=>M.orientation!==n.wV.Auto}).addSliderInput({path:"minVizWidth",name:"Min width",description:"Minimum column width (vertical orientation)",defaultValue:y.minVizWidth,settings:{min:0,max:600,step:1},showIf:M=>M.sizing===n.T6.Manual&&M.orientation===n.wV.Vertical}).addSliderInput({path:"minVizHeight",name:"Min height",description:"Minimum row height (horizontal orientation)",defaultValue:y.minVizHeight,settings:{min:0,max:600,step:1},showIf:M=>M.sizing===n.T6.Manual&&M.orientation===n.wV.Horizontal}),i.I(b)}).setPanelChangeHandler(a).setSuggestionsSupplier(new x).setMigrationHandler(g)},19743:(k,R,e)=>{"use strict";e.d(R,{x:()=>r});var t=e(74848),n=e(96540),i=e(1173),s=e(74668);const r=({value:g,context:a,onChange:c})=>{const o=(0,n.useCallback)(h=>{c(h?.length?{id:i.jR.byRefId,options:h}:void 0)},[c]);return(0,t.jsx)(s.X,{value:g?.options,onChange:o,data:a.data,placeholder:"Change filter"})}},33744:(k,R,e)=>{"use strict";e.d(R,{DY:()=>s,G4:()=>a,Sq:()=>o,T5:()=>c,W_:()=>n,_7:()=>i,fX:()=>r,wq:()=>g,yQ:()=>h,yu:()=>f});var t=e(52622),n=(d=>(d.Point="point",d.Line="line",d.Polygon="polygon",d.Any="*any*",d))(n||{});const i=5;var s=(d=>(d.Left="left",d.Center="center",d.Right="right",d))(s||{}),r=(d=>(d.Top="top",d.Middle="middle",d.Bottom="bottom",d))(r||{}),g=(d=>(d.Left="left",d.Center="center",d.Right="right",d))(g||{}),a=(d=>(d.Top="top",d.Center="center",d.Bottom="bottom",d))(a||{});const c=Object.freeze({size:{fixed:i,min:2,max:15},color:{fixed:"dark-green"},opacity:.4,symbol:{mode:t.q_.Fixed,fixed:"img/icons/marker/circle.svg"},symbolAlign:{horizontal:"center",vertical:"center"},textConfig:{fontSize:12,textAlign:"center",textBaseline:"middle",offsetX:0,offsetY:0},rotation:{fixed:0,mode:t.WQ.Mod,min:-360,max:360}});var o=(d=>(d.color="fill",d.opacity="fill-opacity",d.lineWidth="stroke-width",d))(o||{}),h=(d=>(d.color="marker-color",d.size="marker-size",d))(h||{}),f=(d=>(d.color="stroke",d.lineWidth="stroke-width",d))(f||{})},61994:(k,R,e)=>{"use strict";e.d(R,{A:()=>s});var t=e(74848),n=e(32196),i=e(5636);const s=r=>(0,i.gU)(r)?(0,t.jsx)("a",{href:r,target:"_blank",className:(0,n.cx)("external-link"),rel:"noreferrer",children:r}):r},5636:(k,R,e)=>{"use strict";e.d(R,{Bz:()=>d,G_:()=>c,cA:()=>f,gU:()=>v,o3:()=>m,q:()=>p,rd:()=>h,ue:()=>g});var t=e(92347),n=e(40239),i=e(63577),s=e(90183),r=e(33744);function g(l,y,u,D){const E={};return D&&Object.keys(D).length?(E.color=(0,i.getColorDimension)(l,D.color??r.T5.color,u),E.size=(0,i.getScaledDimension)(l,D.size??r.T5.size),E.rotation=(0,i.getScalarDimension)(l,D.rotation??r.T5.rotation),D.text&&(D.text.field||D.text.fixed)&&(E.text=(0,i.getTextDimension)(l,D.text))):y.fields&&(y.fields.color&&(E.color=(0,i.getColorDimension)(l,y.config.color??r.T5.color,u)),y.fields.size&&(E.size=(0,i.getScaledDimension)(l,y.config.size??r.T5.size)),y.fields.text&&(E.text=(0,i.getTextDimension)(l,y.config.text)),y.fields.rotation&&(E.rotation=(0,i.getScalarDimension)(l,y.config.rotation??r.T5.rotation))),E}let a;function c(){return a||(a=[],o()),a}async function o(){const l=await(0,s.o)();for(let y of["maps","gazetteer"])l.listFiles(y).subscribe({next:u=>{u.forEach(D=>{if(D.name.endsWith(".geojson")){const E=`public/${y}/${D.name}`;a.push({value:E,label:E})}})}})}const h=(l,y,u)=>{const D=l.initMapView(y.view);return l.map=new t.A({view:D,pixelRatio:1,layers:[],controls:[],target:u,interactions:(0,n.N)({mouseWheelZoom:!1})})},f=(l,y)=>{l.initControls(y.controls),l.forceUpdate()},d=(l,y,u)=>{l.panelContext&&l.panelContext.onInstanceStateChange&&l.panelContext.onInstanceStateChange({map:l.map,layers:y,selected:u,actions:l.actions})},p=l=>{let y=l.layers.length;for(;y<100;){const u=`Layer ${y++}`;if(!l.byName.has(u))return u}return`Layer ${Date.now()}`};function m(l,y,u,D){const E=l.getPixelFromCoordinate(u),x=l.getPixelFromCoordinate(D),P=Math.abs(E[0]-x[0]),b=Math.abs(E[1]-x[1]);return P>y||b>y}const v=l=>{try{return new URL(l).protocol.includes("http")}catch{return!1}}},52995:(k,R,e)=>{"use strict";e.d(R,{P7:()=>n,uM:()=>i,iS:()=>s,KQ:()=>g});var t=e(52622),n=(a=>(a.Opacity="opacity",a.Scheme="scheme",a))(n||{}),i=(a=>(a.Exponential="exponential",a.Linear="linear",a))(i||{}),s=(a=>(a.X="x",a.Xy="xy",a.Y="y",a))(s||{});const r={calculate:!1,cellGap:1,cellValues:{},color:{scheme:"Oranges",fill:"dark-orange",reverse:!1,exponent:.5,steps:64},exemplars:{color:"rgba(255,0,255,0.7)"},filterValues:{le:1e-9},legend:{show:!0},selectionMode:"x",showValue:t.yL.Auto,tooltip:{mode:t.$N.Single,yHistogram:!1,showColorScale:!1}},g={...r,color:{...r.color,mode:n.Scheme,scale:i.Exponential},yAxis:{...r.yAxis,axisPlacement:t.vM.Left},rowsFrame:{...r.rowsFrame,layout:t.D7.auto}}},69386:(k,R,e)=>{"use strict";e.d(R,{K:()=>h});var t=e(74848),n=e(32196),i=e(70255),s=e(80997),r=e(72724),g=e(40845),a=e(72129);function c({width:d,showImage:p,data:m,index:v}){const l=(0,g.of)(f),y=d>600,u=m.get(v),D=encodeURI(u.title);return(0,t.jsxs)("article",{"aria-labelledby":D,className:(0,n.cx)(l.item,y&&l.itemWide),children:[p&&u.ogImage&&(0,t.jsx)("a",{tabIndex:-1,href:s.sQ.sanitizeUrl(u.link),target:"_blank",rel:"noopener noreferrer",className:(0,n.cx)(l.socialImage,y&&l.socialImageWide),"aria-hidden":!0,children:(0,t.jsx)("img",{src:u.ogImage,alt:u.title})}),(0,t.jsxs)("div",{className:l.body,children:[(0,t.jsxs)("time",{className:l.date,dateTime:(0,r.LE)(u.date,{format:"MMM DD"}),children:[(0,r.LE)(u.date,{format:"MMM DD"})," "]}),(0,t.jsx)("a",{className:l.link,href:s.sQ.sanitizeUrl(u.link),target:"_blank",rel:"noopener noreferrer",children:(0,t.jsx)("h3",{className:l.title,id:D,children:u.title})}),(0,t.jsx)("div",{className:l.content,dangerouslySetInnerHTML:{__html:s.sQ.sanitize(u.content)}})]})]})}const o=({width:d,showImage:p,rootProps:m})=>{const v=(0,g.of)(f),l=d>600;return(0,t.jsxs)("div",{className:(0,n.cx)(v.item,l&&v.itemWide),...m,children:[p&&(0,t.jsx)(i.A,{containerClassName:(0,n.cx)(v.socialImage,l&&v.socialImageWide),width:l?"250px":"100%",height:l?"150px":d*.5}),(0,t.jsxs)("div",{className:v.body,children:[(0,t.jsx)(i.A,{containerClassName:v.date,width:60}),(0,t.jsx)(i.A,{containerClassName:v.title,width:250}),(0,t.jsx)(i.A,{containerClassName:v.content,width:"100%",count:6})]})]})},h=(0,a.j)(c,o),f=d=>({container:(0,n.css)({height:"100%"}),item:(0,n.css)({display:"flex",padding:d.spacing(1),position:"relative",marginBottom:d.spacing(.5),marginRight:d.spacing(1),borderBottom:`2px solid ${d.colors.border.weak}`,background:d.colors.background.primary,flexDirection:"column",flexShrink:0}),itemWide:(0,n.css)({flexDirection:"row"}),body:(0,n.css)({display:"flex",flexDirection:"column",flex:1}),socialImage:(0,n.css)({display:"flex",alignItems:"center",marginBottom:d.spacing(1),"> img":{width:"100%",borderRadius:`${d.shape.radius.default} ${d.shape.radius.default} 0 0`}}),socialImageWide:(0,n.css)({marginRight:d.spacing(2),marginBottom:0,"> img":{width:"250px",borderRadius:d.shape.radius.default}}),link:(0,n.css)({color:d.colors.text.link,display:"inline-block","&:hover":{color:d.colors.text.link,textDecoration:"underline"}}),title:(0,n.css)({fontSize:"16px",marginBottom:d.spacing(.5)}),content:(0,n.css)({p:{marginBottom:d.spacing(.5),color:d.colors.text.primary}}),date:(0,n.css)({marginBottom:d.spacing(.5),fontWeight:500,borderRadius:`0 0 0 ${d.shape.radius.default}`,color:d.colors.text.secondary})})},62372:(k,R,e)=>{"use strict";e.d(R,{$:()=>t});const t="https://grafana.com/blog/news.xml"},4172:(k,R,e)=>{"use strict";e.d(R,{n:()=>d});var t=e(41053),n=e(78368);function i(p){const v=new DOMParser().parseFromString(p,"text/xml");return{items:Array.from(v.querySelectorAll("entry")).map(y=>({title:a(y,"title"),link:y.querySelector("link")?.getAttribute("href")??"",content:a(y,"content"),pubDate:a(y,"published"),ogImage:y.querySelector("meta[property='og:image']")?.getAttribute("content")}))}}function s(p){const v=new DOMParser().parseFromString(p,"text/xml");return{items:Array.from(v.querySelectorAll("item")).map(y=>({title:a(y,"title"),link:a(y,"link"),content:a(y,"description"),pubDate:a(y,"pubDate"),ogImage:y.querySelector("meta[property='og:image']")?.getAttribute("content")}))}}async function r(p){return await(await fetch(p)).text()}function g(p){return new DOMParser().parseFromString(p,"text/xml").querySelector("feed")!==null}function a(p,m){return p.querySelector(m)?.textContent??""}async function c(p){const m=await r(p);return g(m)?i(m):s(m)}var o=e(47232),h=e(11261);function f(p){const m=[],v=[],l=[],y=[],u=[];for(const D of p.items){const E=(0,o.KQ)(D.pubDate);try{if(m.push(E.valueOf()),v.push(D.title),l.push(D.link),u.push(D.ogImage),D.content){const x=D.content.replace(/<\/?[^>]+(>|$)/g,"");y.push(x)}}catch(x){console.warn("Error reading news item:",x,D)}}return{fields:[{name:"date",type:h.PU.time,config:{displayName:"Date"},values:m},{name:"title",type:h.PU.string,config:{},values:v},{name:"link",type:h.PU.string,config:{},values:l},{name:"content",type:h.PU.string,config:{},values:y},{name:"ogImage",type:h.PU.string,config:{},values:u}],length:m.length}}function d(p){const[m,v]=(0,t.A)(async()=>{const l=await c(p),y=f(l);return new n.R(y)},[p],{loading:!0});return{state:m,getNews:v}}},23799:(k,R,e)=>{"use strict";e.d(R,{L:()=>g,h:()=>a});var t=e(69550),n=e(75059),i=e(28240),s=e(54479),r=e(52622);function g(c,o=!0){const h=["Value options"];c.addRadio({path:"reduceOptions.values",name:"Show",description:"Calculate a single value per column or series or show each row",settings:{options:[{value:!1,label:"Calculate"},{value:!0,label:"All values"}]},category:h,defaultValue:!1}),c.addNumberInput({path:"reduceOptions.limit",name:"Limit",description:"Max number of rows to display",category:h,settings:{placeholder:"25",integer:!0,min:1,max:5e3},showIf:f=>f.reduceOptions.values===!0}),c.addCustomEditor({id:"reduceOptions.calcs",path:"reduceOptions.calcs",name:"Calculation",description:"Choose a reducer function / calculation",category:h,editor:t.D.get("stats-picker").editor,defaultValue:[n.gy.lastNotNull],showIf:f=>f.reduceOptions.values===!1}),o&&c.addSelect({path:"reduceOptions.fields",name:"Fields",description:"Select the fields that should be included in the panel",category:h,settings:{allowCustomValue:!0,options:[],getOptions:async f=>{const d=[{value:"",label:"Numeric Fields"},{value:"/.*/",label:"All Fields"}];if(f&&f.data)for(const p of f.data)for(const m of p.fields){const v=(0,i.Ct)(m,p,f.data),l=`/^${(0,s.jD)(v)}$/`;d.push({value:l,label:v})}return Promise.resolve(d)}},defaultValue:""})}function a(c,o){c.addRadio({path:"orientation",name:"Orientation",description:"Layout orientation",category:o,settings:{options:[{value:r.wV.Auto,label:"Auto"},{value:r.wV.Horizontal,label:"Horizontal"},{value:r.wV.Vertical,label:"Vertical"}]},defaultValue:r.wV.Auto})}},36373:(k,R,e)=>{"use strict";e.r(R),e.d(R,{plugin:()=>P});var t=e(65158),n=e(52622),i=e(71242),s=e(63250),r=e(24293);const g=(b,M,O)=>{const I=(0,s.gl)(b,M,O);if(O.angular&&(M==="singlestat"||M==="grafana-singlestat-panel")){const T=O.angular;if(I.graphMode=n.$p.None,T.sparkline&&T.sparkline.show&&(I.graphMode=n.$p.Area),T.colorBackground)I.colorMode=n.yp.Background;else if(T.colorValue)I.colorMode=n.yp.Value;else if(I.colorMode=n.yp.None,T.sparkline?.lineColor&&I.graphMode===n.$p.Area){const C=b.fieldConfig??{};C.defaults.color={mode:r.Y.Fixed,fixedColor:T.sparkline.lineColor},b.fieldConfig=C}T.valueName==="name"&&(I.textMode=n.SV.Name)}return I};var a=e(74848),c=e(2543),o=e(96540),h=e(11261),f=e(56323),d=e(90708),p=e(37494),m=e(59796),v=e(12509),l=e(2913);class y extends o.PureComponent{constructor(){super(...arguments),this.renderComponent=(M,O)=>{const{timeRange:I,options:T}=this.props,{value:C,alignmentFactors:S,width:A,height:L,count:N}=M,{openMenu:F,targetClassName:w}=O;let B=C.sparkline;return B&&(B.timeRange=I),(0,a.jsx)(p.yV,{value:C.display,count:N,sparkline:B,colorMode:T.colorMode,graphMode:T.graphMode,justifyMode:T.justifyMode,textMode:this.getTextMode(),alignmentFactors:S,text:T.text,width:A,height:L,theme:l.config.theme2,onClick:F,className:w,disableWideLayout:!T.wideLayout,percentChangeColorMode:T.percentChangeColorMode})},this.renderValue=M=>{const{value:O}=M,{getLinks:I,hasLinks:T}=O;return T&&I?(0,a.jsx)(m.e,{links:I,children:C=>this.renderComponent(M,C)}):this.renderComponent(M,{})},this.getValues=()=>{const{data:M,options:O,replaceVariables:I,fieldConfig:T,timeZone:C}=this.props;let S;for(let A of M.series)for(let L of A.fields){let{config:N}=L;if(L.type===h.PU.number){if(L.state?.range)continue;!S&&(!(0,c.isNumber)(N.min)||!(0,c.isNumber)(N.max))&&(S=(0,d.nJ)(M.series));const F=N.min??S.min,w=N.max??S.max;L.state=L.state??{},L.state.range={min:F,max:w,delta:w-F}}}return(0,f.PI)({fieldConfig:T,reduceOptions:O.reduceOptions,replaceVariables:I,theme:l.config.theme2,data:M.series,sparkline:O.graphMode!==n.$p.None,percentChange:O.showPercentChange,timeZone:C})}}getTextMode(){const{options:M,fieldConfig:O,title:I}=this.props;return M.textMode===n.SV.Auto&&(O.defaults.displayName||!I)?n.SV.ValueAndName:M.textMode}render(){const{height:M,options:O,width:I,data:T,renderCounter:C}=this.props;return(0,a.jsx)(v.S,{getValues:this.getValues,getAlignmentFactors:f.XS,renderValue:this.renderValue,width:I,height:M,source:T,itemSpacing:3,renderCounter:C,autoGrid:!0,orientation:O.orientation})}}var u=e(23799);const D={colorMode:n.yp.Value,graphMode:n.$p.Area,justifyMode:n.F8.Auto,percentChangeColorMode:n.CD.Standard,showPercentChange:!1,textMode:n.SV.Auto,wideLayout:!0};var E=e(38824);class x{getSuggestionsForData(M){const{dataSummary:O}=M;if(!O.hasData)return;const I=M.getListAppender({name:E.m.Stat,pluginId:"stat",options:{},fieldConfig:{defaults:{unit:"short",custom:{}},overrides:[]},cardOptions:{previewModifier:T=>{T.options.reduceOptions.values&&(T.options.reduceOptions.limit=1)}}});O.hasStringField&&O.hasNumberField&&O.frameCount===1&&O.rowCountTotal<10&&(I.append({name:E.m.Stat,options:{reduceOptions:{values:!0,calcs:[],fields:"/.*/"}}}),I.append({name:E.m.StatColoredBackground,options:{reduceOptions:{values:!0,calcs:[],fields:"/.*/"},colorMode:n.yp.Background}})),O.stringFieldCount===1&&O.frameCount===1&&O.rowCountTotal<10&&O.fieldCount===1&&I.append({name:E.m.Stat,options:{reduceOptions:{values:!0,calcs:[],fields:"/.*/"},colorMode:n.yp.None}}),O.hasNumberField&&O.hasTimeField&&(I.append({options:{reduceOptions:{values:!1,calcs:["lastNotNull"]}}}),I.append({name:E.m.StatColoredBackground,options:{reduceOptions:{values:!1,calcs:["lastNotNull"]},graphMode:n.$p.None,colorMode:n.yp.Background}}))}}const P=new t.m(y).useFieldConfig().setPanelOptions(b=>{const M=["Stat styles"];(0,u.L)(b),(0,u.h)(b,M),i.I(b),b.addSelect({path:"textMode",name:"Text mode",description:"Control if name and value is displayed or just name",category:M,settings:{options:[{value:n.SV.Auto,label:"Auto"},{value:n.SV.Value,label:"Value"},{value:n.SV.ValueAndName,label:"Value and name"},{value:n.SV.Name,label:"Name"},{value:n.SV.None,label:"None"}]},defaultValue:D.textMode}).addRadio({path:"wideLayout",name:"Wide layout",category:M,settings:{options:[{value:!0,label:"On"},{value:!1,label:"Off"}]},defaultValue:D.wideLayout,showIf:O=>O.textMode===n.SV.ValueAndName}),b.addSelect({path:"colorMode",name:"Color mode",defaultValue:n.yp.Value,category:M,settings:{options:[{value:n.yp.None,label:"None"},{value:n.yp.Value,label:"Value"},{value:n.yp.Background,label:"Background Gradient"},{value:n.yp.BackgroundSolid,label:"Background Solid"}]}}).addRadio({path:"graphMode",name:"Graph mode",description:"Stat panel graph / sparkline mode",category:M,defaultValue:D.graphMode,settings:{options:[{value:n.$p.None,label:"None"},{value:n.$p.Area,label:"Area"}]}}).addRadio({path:"justifyMode",name:"Text alignment",defaultValue:D.justifyMode,category:M,settings:{options:[{value:n.F8.Auto,label:"Auto"},{value:n.F8.Center,label:"Center"}]}}).addBooleanSwitch({path:"showPercentChange",name:"Show percent change",defaultValue:D.showPercentChange,category:M,showIf:O=>!O.reduceOptions.values}).addSelect({path:"percentChangeColorMode",name:"Percent change color mode",defaultValue:D.percentChangeColorMode,category:M,settings:{options:[{value:n.CD.Standard,label:"Standard"},{value:n.CD.Inverted,label:"Inverted"},{value:n.CD.SameAsValue,label:"Same as Value"}]},showIf:O=>O.showPercentChange})}).setNoPadding().setPanelChangeHandler(g).setSuggestionsSupplier(new x).setMigrationHandler(s._$)},21164:(k,R,e)=>{"use strict";e.d(R,{u:()=>t});const t=(n,i)=>{const s=[],r=new Set;if((n.config.links?.length??0)>0&&n.getLinks!=null){const g=n.values[i],a=n.display?n.display(g):{text:`${g}`,numeric:+g};n.getLinks({calculatedValue:a,valueRowIndex:i}).forEach(c=>{const o=`${c.title}/${c.href}`;r.has(o)||(s.push(c),r.add(o))})}return s}},65885:(k,R,e)=>{"use strict";e.d(R,{S5:()=>l,fq:()=>g,gy:()=>y,l1:()=>m});var t=e(2543),n=e.n(t),i=e(1173),s=e(50082),r=e(11261);const g=u=>(!u.pluginVersion&&"columns"in u&&console.log("Was angular table",u),u.options),a={timeseries_to_rows:"seriesToRows",timeseries_to_columns:"seriesToColumns",timeseries_aggregations:"reduce",table:"merge"},c={avg:"mean",min:"min",max:"max",total:"sum",current:"lastNotNull",count:"count"},o={cell:"color-background",row:"color-background",value:"color-text"},h=(u,D)=>[-1/0,...u].map((E,x)=>({color:D[x],value:(0,t.isNumber)(E)?E:parseInt(E,10)})),f=(u,D)=>{const E=u.transformations??[];if(Object.keys(a).includes(D.transform)){const x={reducers:[]};D.transform==="timeseries_aggregations"&&(x.includeTimeField=!1,x.reducers=D.columns.map(P=>c[P.value])),E.push({id:a[D.transform],options:x})}return E},d=u=>{const E={matcher:{id:/^\/.*\/$/.test(u.pattern)?i.Ct.byRegexp:i.Ct.byName,options:u.pattern},properties:[]};return u.alias&&E.properties.push({id:"displayName",value:u.alias}),u.unit&&E.properties.push({id:"unit",value:u.unit}),u.decimals&&E.properties.push({id:"decimals",value:u.decimals}),u.type==="date"&&E.properties.push({id:"unit",value:`time: ${u.dateFormat}`}),u.type==="hidden"&&E.properties.push({id:"custom.hidden",value:!0}),u.link&&E.properties.push({id:"links",value:[{title:(0,t.defaultTo)(u.linkTooltip,""),url:(0,t.defaultTo)(u.linkUrl,""),targetBlank:(0,t.defaultTo)(u.linkTargetBlank,!1)}]}),u.colorMode&&E.properties.push({id:"custom.cellOptions",value:{type:o[u.colorMode]}}),u.align&&E.properties.push({id:"custom.align",value:u.align==="auto"?null:u.align}),u.thresholds?.length&&E.properties.push({id:"thresholds",value:{mode:s.O.Absolute,steps:h(u.thresholds,u.colors)}}),E},p=u=>{let D={custom:{}};if(u){if(D=(0,t.omitBy)({unit:u.unit,decimals:u.decimals,displayName:u.alias,custom:{align:u.align==="auto"?null:u.align}},t.isNil),u.thresholds.length){const E={mode:s.O.Absolute,steps:h(u.thresholds,u.colors)};D.thresholds=E}u.colorMode&&(D.custom.cellOptions={type:o[u.colorMode]})}return D},m=(u,D,E)=>{if(D==="table-old"&&E.angular){const x=E.angular,P=f(u,x),b=x.styles.find(I=>I.pattern==="/.*/"),M=p(b),O=x.styles.filter(I=>I.pattern!=="/.*/").map(d);u.transformations=P,u.fieldConfig={defaults:M,overrides:O}}return{}},v=u=>u?.filter(D=>D.meta?.custom?.parentRowIndex===void 0)||[u?.[0]],l=u=>{const D=[];return v(u).filter(x=>!!x&&x.length!==0)?.forEach(x=>{const P=u?.filter(I=>x.refId===I.refId&&I.meta?.custom?.parentRowIndex!==void 0),b=(0,t.groupBy)(P,I=>I.meta?.custom?.parentRowIndex),M=Object.keys(b).map(I=>b[I]),O={...x};P&&P.length>0&&O.fields.push({name:"nested",type:r.PU.nestedFrames,config:{},values:M}),D.push(O)}),D},y=u=>u?.some(D=>D.meta?.custom?.parentRowIndex!==void 0)},11082:(k,R,e)=>{"use strict";e.d(R,{Z:()=>g});var t=e(74848),n=e(66864),i=e(94354),s=e(51275);const r=[{label:"Never",value:!1},{label:"Threshold",value:36e5}],g=({value:a,onChange:c,item:o})=>{const h=typeof a=="number";return r[1].value=h?a:36e5,(0,t.jsxs)(n.Gy,{children:[(0,t.jsx)(i.z,{value:a,options:r,onChange:c}),h&&(0,t.jsx)(s.g,{value:a,onChange:c,inputPrefix:s.F.GreaterThan,isTime:o.settings?.isTime??!1})]})}},43228:(k,R,e)=>{"use strict";e.d(R,{F:()=>h});var t=e(74848),n=e(96540),i=e(66864),s=e(94354),r=e(90182),g=e(29158);const a=[{label:"Solid",value:"solid"},{label:"Dash",value:"dash"},{label:"Dots",value:"dot"}],c=["10, 10","10, 15","10, 20","10, 25","10, 30","10, 40","15, 10","20, 10","25, 10","30, 10","40, 10","50, 10","5, 10","30, 3, 3"].map(d=>({label:d,value:d})),o=["0, 10","0, 20","0, 30","0, 40","0, 3, 3"].map(d=>({label:d,value:d})),h=({value:d,onChange:p})=>{const m=(0,n.useMemo)(()=>d?.fill==="dash"?c:o,[d]),v=(0,n.useMemo)(()=>{if(!d?.dash?.length)return m[0];const l=d.dash?.join(", "),y=m.find(u=>u.value===l);return y||{label:l,value:l}},[d,m]);return(0,t.jsxs)(i.Gy,{children:[(0,t.jsx)(s.z,{value:d?.fill||"solid",options:a,onChange:l=>{let y;l==="dot"?y=f(o[0].value):l==="dash"&&(y=f(c[0].value)),p({...d,fill:l,dash:y})}}),d?.fill&&d?.fill!=="solid"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.l6,{allowCustomValue:!0,options:m,value:v,width:20,onChange:l=>{p({...d,dash:f(l.value??"")})},formatCreateLabel:l=>`Segments: ${f(l).join(", ")}`}),(0,t.jsxs)("div",{children:["\xA0",(0,t.jsx)("a",{title:"The input expects a segment list",href:"https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/setLineDash#Parameters",target:"_blank",rel:"noreferrer",children:(0,t.jsx)(g.K,{name:"question-circle",tooltip:"Help"})})]})]})]})};function f(d){const p=[];for(const m of d.split(/(?:,| )+/)){const v=Number.parseInt(m,10);isNaN(v)||p.push(v)}return p}},51275:(k,R,e)=>{"use strict";e.d(R,{F:()=>s,g:()=>r});var t=e(74848),n=e(65879),i=e(10354),s=(g=>(g.LessThan="lessthan",g.GreaterThan="greaterthan",g))(s||{});const r=({value:g,onChange:a,inputPrefix:c,isTime:o})=>{let h=n.secondsToHms(g/1e3);o||(h="10");const f=v=>{let l=!1;if(v)try{o&&n.isValidTimeSpan(v)?l=n.intervalToMs(v):l=Number(v)}catch(y){console.warn("ERROR",y)}a(l)},d=v=>{v.key==="Enter"&&f(v.currentTarget.value)},p=v=>{f(v.currentTarget.value)},m=c==="greaterthan"?(0,t.jsx)("div",{children:">"}):c==="lessthan"?(0,t.jsx)("div",{children:"<"}):null;return(0,t.jsx)(i.p,{autoFocus:!1,placeholder:"never",width:10,defaultValue:h,onKeyDown:d,onBlur:p,prefix:m,spellCheck:!1})}},34163:(k,R,e)=>{"use strict";e.d(R,{e:()=>g});var t=e(74848),n=e(66864),i=e(94354),s=e(51275);const r=[{label:"Never",value:!1},{label:"Always",value:!0},{label:"Threshold",value:36e5}],g=({value:a,onChange:c,item:o})=>{const h=typeof a=="number";return r[2].value=h?a:36e5,(0,t.jsxs)(n.Gy,{children:[(0,t.jsx)(i.z,{value:a,options:r,onChange:c}),h&&(0,t.jsx)(s.g,{value:a,onChange:c,inputPrefix:s.F.LessThan,isTime:o.settings?.isTime??!1})]})}},24882:(k,R,e)=>{"use strict";e.d(R,{D:()=>s});var t=e(74848),n=e(96540),i=e(90182);const s=({item:r,value:g,onChange:a,id:c})=>{const o=(0,n.useCallback)(h=>{a({mode:h.value})},[a]);return(0,t.jsx)(i.l6,{inputId:c,value:g.mode,options:r.settings?.options??[],onChange:o})}},22731:(k,R,e)=>{"use strict";e.d(R,{$:()=>v,k:()=>m});var t=e(74848),n=e(32196),i=e(83195),s=e(11261),r=e(52622),g=e(40845),a=e(11389),c=e(58749),o=e(52415),h=e(10875),f=e(21164),d=e(5514),p=e(82915);const m=({series:l,_rest:y,dataIdxs:u,seriesIdx:D,mode:E=r.$N.Single,sortOrder:x=r.xB.None,isPinned:P,annotate:b,maxHeight:M})=>{const O=(0,g.of)(v),I=l.fields[0],T=(0,i.cN)(I.display(I.values[u[0]])),C=(0,h.cp)(l.fields,I,u,D,E,x,L=>L.type===s.PU.number||L.type===s.PU.enum);y?.forEach(L=>{L.config.custom?.hideFrom?.tooltip||C.push({label:L.state?.displayName??L.name,value:(0,d.S)(L,L.values[u[0]])})});let S;if(P&&D!=null){const L=l.fields[D],N=u[D],F=(0,f.u)(L,N);S=(0,t.jsx)(c.S,{dataLinks:F,annotate:b})}const A=I.config.custom?.hideFrom?.tooltip?null:{label:I.type===s.PU.time?"":I.state?.displayName??I.name,value:T};return(0,t.jsxs)("div",{className:O.wrapper,children:[A!=null&&(0,t.jsx)(o.A,{item:A,isPinned:P}),(0,t.jsx)(a.o,{items:C,isPinned:P,scrollable:(0,p.T5)({mode:E,maxHeight:M}),maxHeight:M}),S]})},v=()=>({wrapper:(0,n.css)({display:"flex",flexDirection:"column"})})},41706:(k,R,e)=>{"use strict";e.d(R,{S:()=>m,V:()=>l});var t=e(37055),n=e(24293),i=e(11261),s=e(27310),r=e(52622),g=e(52198),a=e(56675),c=e(38248),o=e(11404),h=e(11082),f=e(43228),d=e(34163),p=e(24882);const m={drawStyle:r.GR.Line,lineInterpolation:r.dx.Linear,lineWidth:1,fillOpacity:0,gradientMode:r.on.None,barAlignment:r.Nj.Center,barWidthFactor:.6,stacking:{mode:r.gs.None,group:"A"},axisGridShow:!0,axisCenteredZero:!1,axisBorderShow:!1},v=["Graph styles"];function l(y,u=!0){return{standardOptions:{[t.uo.Color]:{settings:{byValueSupport:!0,bySeriesSupport:!0,preferThresholdsMode:!1},defaultValue:{mode:n.Y.PaletteClassic}}},useCustomConfig:D=>{D.addRadio({path:"drawStyle",name:"Style",category:v,defaultValue:y.drawStyle,settings:{options:g.t.drawStyle}}).addRadio({path:"lineInterpolation",name:"Line interpolation",category:v,defaultValue:y.lineInterpolation,settings:{options:g.t.lineInterpolation},showIf:E=>E.drawStyle===r.GR.Line}).addRadio({path:"barAlignment",name:"Bar alignment",category:v,defaultValue:y.barAlignment,settings:{options:g.t.barAlignment},showIf:E=>E.drawStyle===r.GR.Bars}).addSliderInput({path:"barWidthFactor",name:"Bar width factor",category:v,defaultValue:y.barWidthFactor,settings:{min:.1,max:1,step:.1,ariaLabelForHandle:"Bar width factor"},showIf:E=>E.drawStyle===r.GR.Bars}).addSliderInput({path:"lineWidth",name:"Line width",category:v,defaultValue:y.lineWidth,settings:{min:0,max:10,step:1,ariaLabelForHandle:"Line width"},showIf:E=>E.drawStyle!==r.GR.Points}).addSliderInput({path:"fillOpacity",name:"Fill opacity",category:v,defaultValue:y.fillOpacity,settings:{min:0,max:100,step:1,ariaLabelForHandle:"Fill opacity"},showIf:E=>E.drawStyle!==r.GR.Points}).addRadio({path:"gradientMode",name:"Gradient mode",category:v,defaultValue:g.t.fillGradient[0].value,settings:{options:g.t.fillGradient},showIf:E=>E.drawStyle!==r.GR.Points}).addFieldNamePicker({path:"fillBelowTo",name:"Fill below to",category:v,hideFromDefaults:!0,settings:{filter:E=>E.type===i.PU.number}}).addCustomEditor({id:"lineStyle",path:"lineStyle",name:"Line style",category:v,showIf:E=>E.drawStyle===r.GR.Line,editor:f.F,override:f.F,process:s.hS,shouldApply:E=>E.type===i.PU.number}).addCustomEditor({id:"spanNulls",path:"spanNulls",name:"Connect null values",category:v,defaultValue:!1,editor:d.e,override:d.e,showIf:E=>E.drawStyle===r.GR.Line,shouldApply:E=>E.type!==i.PU.time,process:s.hS,settings:{isTime:u}}).addCustomEditor({id:"insertNulls",path:"insertNulls",name:"Disconnect values",category:v,defaultValue:!1,editor:h.Z,override:h.Z,showIf:E=>E.drawStyle===r.GR.Line,shouldApply:E=>E.type!==i.PU.time,process:s.hS,settings:{isTime:u}}).addRadio({path:"showPoints",name:"Show points",category:v,defaultValue:g.t.showPoints[0].value,settings:{options:g.t.showPoints},showIf:E=>E.drawStyle!==r.GR.Points}).addSliderInput({path:"pointSize",name:"Point size",category:v,defaultValue:5,settings:{min:1,max:40,step:1,ariaLabelForHandle:"Point size"},showIf:E=>E.showPoints!==r.yL.Never||E.drawStyle===r.GR.Points}),a.I(D,y.stacking,v),D.addSelect({category:v,name:"Transform",path:"transform",settings:{options:[{label:"Constant",value:r.NU.Constant,description:"The first value will be shown as a constant line"},{label:"Negative Y",value:r.NU.NegativeY,description:"Flip the results to negative values on the y axis"}],isClearable:!0},hideFromDefaults:!0}),c.r(D,y),o.e(D),D.addCustomEditor({id:"thresholdsStyle",path:"thresholdsStyle",name:"Show thresholds",category:["Thresholds"],defaultValue:{mode:r.Ly.Off},settings:{options:g.t.thresholdsDisplayModes},editor:p.D,override:p.D,process:s.hS,shouldApply:()=>!0})}}}},62567:(k,R,e)=>{"use strict";e.d(R,{W:()=>ne});var t=e(74848),n=e(32196),i=e(96540),s=e(40961),r=e(84140),g=e(36613),a=e(33948),c=e(52622),o=e(23596),h=e(24284),f=e(17464),d=e(40845),p=e(7315),m=e(36376),v=e(13544),l=e(49785),y=e(29647),u=e(41053),D=e(72724),E=e(42994),x=e(79041),P=e(67061),b=e(88575),M=e(21744),O=e(55852),I=e(72235),T=e(99818),C=e(10154);const S=({annoVals:z,annoIdx:ee,dismiss:se,timeZone:ie,...Z})=>{const oe=(0,d.of)(A),{onAnnotationCreate:ce,onAnnotationUpdate:ye}=(0,x.d2)(),re=(0,i.useRef)(null);(0,y.A)(re,se);const[ue,De]=(0,u.A)(async $e=>{const ze=await ce($e);return se(),ze}),[ge,Te]=(0,u.A)(async $e=>{const ze=await ye($e);return se(),ze}),Le=$e=>(0,D.LE)($e,{format:E.WC.fullDate,timeZone:ie}),Ye=z.id?.[ee]!=null,je=z.isRegion?.[ee],Ze=Ye?Te:De,Ne=Ye?ge:ue,Pe=je?`${Le(z.time[ee])} - ${Le(z.timeEnd[ee])}`:Le(z.time[ee]),Ue=({tags:$e,description:ze})=>{Ze({id:z.id?.[ee]??void 0,tags:$e,description:ze,from:Math.round(z.time[ee]),to:Math.round(z.timeEnd?.[ee]??z.time[ee])})};return(0,t.jsxs)("div",{ref:re,className:oe.editor,...Z,children:[(0,t.jsx)("div",{className:oe.header,children:(0,t.jsxs)(P.B,{justifyContent:"space-between",alignItems:"center",children:[(0,t.jsx)("div",{children:Ye?"Edit annotation":"Add annotation"}),(0,t.jsx)("div",{children:Pe})]})}),(0,t.jsx)(I.l,{onSubmit:Ue,defaultValues:{description:z.text?.[ee],tags:z.tags?.[ee]||[]},children:({register:$e,errors:ze,control:qe})=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:oe.content,children:[(0,t.jsx)(b.D,{label:"Description",invalid:!!ze.description,error:ze?.description?.message,children:(0,t.jsx)(M.f,{className:oe.textarea,...$e("description",{required:"Annotation description is required"})})}),(0,t.jsx)(b.D,{label:"Tags",children:(0,t.jsx)(l.xI,{control:qe,name:"tags",render:({field:{ref:dt,onChange:vt,...yt}})=>(0,t.jsx)(T.$,{allowCustomValue:!0,placeholder:"Add tags",onChange:vt,tagOptions:C.vy,tags:yt.value})})})]}),(0,t.jsx)("div",{className:oe.footer,children:(0,t.jsxs)(P.B,{justifyContent:"flex-end",children:[(0,t.jsx)(O.$n,{size:"sm",variant:"secondary",onClick:se,fill:"outline",children:"Cancel"}),(0,t.jsx)(O.$n,{size:"sm",type:"submit",disabled:Ne?.loading,children:Ne?.loading?"Saving":"Save"})]})})]})})]})},A=z=>({editor:(0,n.css)({background:z.colors.background.primary,border:`1px solid ${z.colors.border.weak}`,borderRadius:z.shape.radius.default,boxShadow:z.shadows.z3,userSelect:"text",width:"460px"}),content:(0,n.css)({padding:z.spacing(1)}),header:(0,n.css)({borderBottom:`1px solid ${z.colors.border.weak}`,padding:z.spacing(.5,1),fontWeight:z.typography.fontWeightBold,fontSize:z.typography.fontSize,color:z.colors.text.primary}),footer:(0,n.css)({borderTop:`1px solid ${z.colors.border.weak}`,padding:z.spacing(1,1)}),textarea:(0,n.css)({color:z.colors.text.secondary,fontSize:z.typography.bodySmall.fontSize})});var L=e(80997),N=e(66864),F=e(29158),w=e(78369),B=e(55907);const U=()=>!1,K=({annoVals:z,annoIdx:ee,timeZone:se,onEdit:ie})=>{const Z=z.id?.[ee],oe=(0,d.of)(V),{canEditAnnotations:ce=U,canDeleteAnnotations:ye=U,onAnnotationDelete:re}=(0,x.d2)(),ue=z.dashboardUID?.[ee],De=ce(ue),ge=ye(ue)&&re!=null,Te=Pe=>(0,D.LE)(Pe,{format:E.WC.fullDate,timeZone:se});let Le=Te(z.time[ee]),Ye=z.text?.[ee]??"";z.isRegion?.[ee]&&(Le+=" - "+Te(z.timeEnd[ee]));let je;z.login?.[ee]&&z.avatarUrl?.[ee]&&(je=(0,t.jsx)("img",{className:oe.avatar,alt:"Annotation avatar",src:z.avatarUrl[ee]}));let Ze=null,Ne="";if(z.alertId?.[ee]!==void 0&&z.newState?.[ee]){const Pe=B.A.getStateDisplayModel(z.newState[ee]);Ze=(0,t.jsx)("div",{className:oe.alertState,children:(0,t.jsx)("i",{className:Pe.stateClass,children:Pe.text})}),Ne=z.data?.[ee]?B.A.getAlertAnnotationText(z.data[ee]):""}else z.title?.[ee]&&(Ye=z.title[ee]+(Ye?`<br />${Ye}`:""));return(0,t.jsxs)("div",{className:oe.wrapper,children:[(0,t.jsx)("div",{className:oe.header,children:(0,t.jsxs)(N.Gy,{justify:"space-between",align:"center",spacing:"md",children:[(0,t.jsxs)("div",{className:oe.meta,children:[(0,t.jsxs)("span",{children:[je,Ze]}),Le]}),(De||ge)&&(0,t.jsxs)("div",{className:oe.editControls,children:[De&&(0,t.jsx)(F.K,{name:"pen",size:"sm",onClick:ie,tooltip:"Edit"}),ge&&(0,t.jsx)(F.K,{name:"trash-alt",size:"sm",onClick:()=>re(Z),tooltip:"Delete"})]})]})}),(0,t.jsxs)("div",{className:oe.body,children:[Ye&&(0,t.jsx)("div",{className:oe.text,dangerouslySetInnerHTML:{__html:L.sQ.sanitize(Ye)}}),Ne,(0,t.jsx)("div",{children:(0,t.jsx)(N.Gy,{spacing:"xs",wrap:!0,children:z.tags?.[ee]?.map((Pe,Ue)=>(0,t.jsx)(w.v,{name:Pe},`${Pe}-${Ue}`))})})]})]})},V=z=>({wrapper:(0,n.css)({zIndex:z.zIndex.tooltip,whiteSpace:"initial",borderRadius:z.shape.radius.default,background:z.colors.background.primary,border:`1px solid ${z.colors.border.weak}`,boxShadow:z.shadows.z2,userSelect:"text"}),header:(0,n.css)({padding:z.spacing(.5,1),borderBottom:`1px solid ${z.colors.border.weak}`,fontWeight:z.typography.fontWeightBold,fontSize:z.typography.fontSize,color:z.colors.text.primary,display:"flex"}),meta:(0,n.css)({display:"flex",justifyContent:"space-between",color:z.colors.text.primary,fontWeight:400}),editControls:(0,n.css)({display:"flex",alignItems:"center","> :last-child":{marginLeft:0}}),body:(0,n.css)({padding:z.spacing(1),fontSize:z.typography.bodySmall.fontSize,color:z.colors.text.secondary,fontWeight:400,a:{color:z.colors.text.link,"&:hover":{textDecoration:"underline"}}}),text:(0,n.css)({paddingBottom:z.spacing(1)}),avatar:(0,n.css)({borderRadius:z.shape.radius.circle,width:16,height:16,marginRight:z.spacing(1)}),alertState:(0,n.css)({paddingRight:z.spacing(1),fontWeight:z.typography.fontWeightMedium})}),H=0,Y=1,X=2,J=({annoVals:z,annoIdx:ee,className:se,style:ie,exitWipEdit:Z,timeZone:oe,portalRoot:ce})=>{const ye=(0,d.of)(q),[re,ue]=(0,i.useState)(Z!=null?Y:H),{refs:De,floatingStyles:ge}=(0,m.we)({open:!0,placement:"bottom",middleware:[(0,p.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,p.BN)()],whileElementsMounted:p.ll,strategy:"fixed"}),Te=re===X?(0,t.jsx)(K,{annoIdx:ee,annoVals:z,timeZone:oe,onEdit:()=>ue(Y)}):re===Y?(0,t.jsx)(S,{annoIdx:ee,annoVals:z,timeZone:oe,dismiss:()=>{Z?.(),ue(H)}}):null;return(0,t.jsx)("div",{ref:De.setReference,className:se,style:ie,onMouseEnter:()=>re!==Y&&ue(X),onMouseLeave:()=>re!==Y&&ue(H),"data-testid":v.Tp.pages.Dashboard.Annotations.marker,children:Te&&(0,s.createPortal)((0,t.jsx)("div",{ref:De.setFloating,className:ye.annoBox,style:ge,"data-testid":"annotation-marker",children:Te}),ce)})},q=z=>({annoBox:(0,n.css)({top:0,left:0,zIndex:z.zIndex.tooltip,borderRadius:z.shape.radius.default,position:"absolute",background:z.colors.background.primary,border:`1px solid ${z.colors.border.weak}`,boxShadow:z.shadows.z2,userSelect:"text",minWidth:"300px"})}),ae=(z,ee,se,ie,Z)=>{z.beginPath(),z.moveTo(ie,ee),z.lineTo(ie,se),z.strokeStyle=Z,z.stroke()},j=(0,r.A)(h.Mk).toHex8String();function te(z){let ee={};return z.fields.forEach(se=>{ee[se.name]=se.values}),ee}const ne=({annotations:z,timeZone:ee,config:se,newRange:ie,setNewRange:Z,canvasRegionRendering:oe=!0})=>{const[ce,ye]=(0,i.useState)(),[re]=(0,i.useState)(()=>(0,f.gF)()),ue=(0,d.of)(le),De=(0,d.$j)().visualization.getColorByName,[ge,Te]=(0,i.useReducer)(Pe=>Pe+1,0),Le=(0,i.useMemo)(()=>{let Pe=z.filter(Ue=>Ue.name!=="exemplar"&&Ue.length>0&&Ue.fields.some($e=>$e.name==="time"));if(ie){let Ue=ie.to>ie.from;const $e=(0,a.I)([{time:ie.from,timeEnd:Ue?ie.to:null,isRegion:Ue,color:j}]);$e.meta={dataTopic:c.QR.Annotations,custom:{isWip:!0}},Pe.push($e)}return Pe},[z,ie]),Ye=(0,i.useCallback)(()=>{Z(null)},[Z]),je=(0,i.useRef)(Le);je.current=Le;const Ze=(0,i.useRef)(ie);Ze.current=ie;const Ne=(0,i.useRef)();if((0,i.useLayoutEffect)(()=>{se.addHook("ready",Pe=>{let Ue=Pe.root.querySelector(".u-axis");Ne.current=Ue,ye(Pe)}),se.addHook("draw",Pe=>{let Ue=je.current;const $e=Pe.ctx;$e.save(),$e.beginPath(),$e.rect(Pe.bbox.left,Pe.bbox.top,Pe.bbox.width,Pe.bbox.height),$e.clip(),Ue.forEach(ze=>{let qe=te(ze);if(ze.name==="xymark"){let dt=se.scales[0].props.scaleKey,vt=se.scales[1].props.scaleKey;for(let yt=0;yt<ze.length;yt++){let st=De(qe.color?.[yt]||j),Ve=Pe.valToPos(qe.xMin[yt],dt,!0),pe=Pe.valToPos(qe.xMax[yt],dt,!0),Ee=Pe.valToPos(qe.yMax[yt],vt,!0),me=Pe.valToPos(qe.yMin[yt],vt,!0);$e.fillStyle=o.MV.alpha(st,qe.fillOpacity[yt]),$e.fillRect(Ve,Ee,pe-Ve,me-Ee),$e.lineWidth=Math.round(qe.lineWidth[yt]*g.A.pxRatio),qe.lineStyle[yt]==="dash"?$e.setLineDash([5,5]):$e.setLineDash([]),$e.strokeStyle=st,$e.strokeRect(Ve,Ee,pe-Ve,me-Ee)}}else{let dt=Pe.bbox.top,vt=dt+Pe.bbox.height;$e.lineWidth=2,$e.setLineDash([5,5]);for(let yt=0;yt<qe.time.length;yt++){let st=De(qe.color?.[yt]||j),Ve=Pe.valToPos(qe.time[yt],"x",!0);if(!qe.isRegion?.[yt])ae($e,dt,vt,Ve,st);else if(oe){ae($e,dt,vt,Ve,st);let pe=Pe.valToPos(qe.timeEnd[yt],"x",!0);ae($e,dt,vt,pe,st),$e.fillStyle=o.MV.alpha(st,.1),$e.fillRect(Ve,dt,pe-Ve,Pe.bbox.height)}}}}),$e.restore()})},[se,oe,De]),(0,i.useEffect)(()=>{ce&&(ce.redraw(),setTimeout(()=>{Te()},0))},[Le,ce]),ce){let Pe=Le.flatMap((Ue,$e)=>{let ze=te(Ue),qe=[];for(let dt=0;dt<ze.time.length;dt++){let vt=De(ze.color?.[dt]||h.Mk),yt=Math.round(ce.valToPos(ze.time[dt],"x"))||0,st=null,Ve="",pe=!0;if(ze.isRegion?.[dt]){let Ee=Math.round(ce.valToPos(ze.timeEnd?.[dt],"x"))||0;if(pe=yt<ce.rect.width&&Ee>0,pe){let me=Math.max(0,yt),ve=Math.min(ce.rect.width,Ee);st={left:me,background:vt,width:ve-me},Ve=ue.annoRegion}}else pe=yt>=0&&yt<=ce.rect.width,pe&&(st={left:yt,borderBottomColor:vt},Ve=ue.annoMarker);if(pe){let Ee=Ue.meta?.custom?.isWip;qe.push((0,t.jsx)(J,{annoIdx:dt,annoVals:ze,className:Ve,style:st,timeZone:ee,exitWipEdit:Ee?Ye:null,portalRoot:re},`${$e}:${dt}`))}}return qe});return(0,s.createPortal)(Pe,Ne.current)}return null},le=()=>({annoMarker:(0,n.css)({position:"absolute",width:0,height:0,borderLeft:"5px solid transparent",borderRight:"5px solid transparent",borderBottomWidth:"5px",borderBottomStyle:"solid",transform:"translateX(-50%)",cursor:"pointer",zIndex:1}),annoRegion:(0,n.css)({position:"absolute",height:"5px",cursor:"pointer",zIndex:1})})},7874:(k,R,e)=>{"use strict";e.d(R,{U:()=>s});var t=e(74848),n=e(96540),i=e(55852);const s=({config:r,onChangeTimeRange:g})=>{const a=(0,n.useRef)(),[c,o]=(0,n.useState)([]),[h,f]=(0,n.useState)();if((0,n.useLayoutEffect)(()=>{r.addHook("init",u=>{a.current=u}),r.addHook("setScale",u=>{o(u.data?.[0]??[]),f(u.scales.x??void 0)})},[r]),c.length<2||!g||!h||!h.time||!h.min||!h.max)return null;let d=0,p=c.length-1;for(;d<=p&&c[d]==null;)d++;for(;p>=0&&c[p]==null;)p--;const m=c[d],v=c[p],l=h.min,y=h.max;return m==null||v==null||m<=y&&v>=l?null:(0,t.jsx)("div",{style:{position:"absolute",top:"50%",transform:"translateY(-50%)",width:"100%",textAlign:"center"},children:(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{children:"Data outside time range"}),(0,t.jsx)(i.$n,{onClick:u=>g({from:m,to:v}),variant:"secondary","data-testid":"time-series-zoom-to-data",children:"Zoom to data"})]})})};s.displayName="OutsideRangePlugin"},82915:(k,R,e)=>{"use strict";e.d(R,{B_:()=>f,Fg:()=>m,O2:()=>p,T5:()=>v});var t=e(11261),n=e(28240),i=e(83195),s=e(57875),r=e(50311),g=e(46294),a=e(39624),c=e(52622),o=e(55129);function h(l){let y=new Map;return l.map(D=>({...D,fields:D.fields.map(E=>{if(E.type===t.PU.enum){let x=(0,o.M)(E.config,E.type),P=y.get(x);P||(P=[],y.set(x,P));let b=E.values.toArray().slice(),M=E.config.type.enum.text;if(P.length>0)for(let O=0;O<b.length;O++)b[O]+=P.length;return P.push(...M),E.config.type.enum.text=P,{...E,values:b}}return E})}))}function f(l,y,u,D){if(!l?.length)return null;(0,n.Fm)(l);let E=D!=null;D!=null&&D>0&&(l=[{...l[0],fields:[l[0].fields[D],...l[0].fields.filter((M,O)=>O!==D)]}]);for(let M of l)for(let O of M.fields)O.type===t.PU.time&&typeof O.values[0]!="number"&&(O.values=(0,r.s7)(O,{destinationType:t.PU.time}).values);let x=0;e:for(let M of l)for(let O of M.fields)if(O.type===t.PU.enum&&++x>1){l=h(l);break e}let P;const b=[];for(let M of l){const O=[];let I=!1,T=!1,C=E?M:(0,g.M)({frame:M,refFieldPseudoMin:u?.from.valueOf(),refFieldPseudoMax:u?.to.valueOf()});const S=(0,a.C)(C).fields;for(let A=0;A<S?.length;A++){const L=S[A];switch(L.type){case t.PU.time:I=!0,O.push(L);break;case t.PU.number:T=E?A>0:!0,P={...L,values:L.values.map(w=>Number.isFinite(w)||w==null?w:null)},O.push(P);break;case t.PU.enum:T=!0;case t.PU.string:P={...L,values:L.values},O.push(P);break;case t.PU.boolean:T=!0;const N=L.config?.custom??{},F={...L.config,max:1,min:0,custom:N};N.lineInterpolation!==c.dx.StepBefore&&(N.lineInterpolation=c.dx.StepAfter),P={...L,config:F,type:t.PU.number,values:L.values.map(w=>w==null?w:w?1:0)},(0,i.j9)(F.unit)||(F.unit="bool",P.display=(0,s.J)({field:P,theme:y})),O.push(P);break}}(E||I)&&T&&b.push({...M,length:C.length,fields:O})}return b.length?(p(b,y,0),d(b,y),b):null}const d=(l,y)=>{const{palette:u}=y.visualization;for(const D of l)for(const E of D.fields)if(E.type===t.PU.enum){const x=u[E.state?.seriesIndex%u.length],P=y.visualization.getColorByName(x),b=E.config.type.enum;b.color=Array(b.text.length).fill(P),E.display=(0,s.J)({field:E,theme:y})}},p=(l,y,u)=>{let D=0;l.forEach(E=>{E.fields.forEach((x,P)=>{P!==u&&(x.type===t.PU.number||x.type===t.PU.boolean||x.type===t.PU.enum)&&(x.state={...x.state,seriesIndex:D++},x.display=(0,s.J)({field:x,theme:y}))})})};function m(l,y){return!l||!l.length?[y]:l.map(u=>u?.length?u:y)}const v=l=>l.mode===c.$N.Multi&&l.maxHeight!=null},5514:(k,R,e)=>{"use strict";e.d(R,{S:()=>n});var t=e(83195);function n(i,s){return i.display?(0,t.cN)(i.display(s)):`${s}`}},99140:(k,R,e)=>{"use strict";e.d(R,{Gu:()=>s,JD:()=>r,M_:()=>n,k3:()=>i});var t=e(48594);let n;function i(g){n=g}function s(){return!n||!n.getState?{templating:{...t.L1,lastKey:"key"}}:n.getState()}function r(g){if(!(!n||!n.getState))return n.dispatch(g)}},24897:(k,R,e)=>{"use strict";e.d(R,{RG:()=>i,Vz:()=>s,XT:()=>t.X,Xe:()=>n});var t=e(62625),n=(r=>(r[r.Admin=4]="Admin",r[r.Editor=2]="Editor",r[r.Member=0]="Member",r[r.Viewer=1]="Viewer",r))(n||{}),i=(r=>(r.View="View",r.Edit="Edit",r.Admin="Admin",r))(i||{}),s=(r=>(r.Folder="dash-folder",r.Dashboard="dash-db",r.AlertFolder="dash-folder-alerting",r))(s||{})},50271:()=>{"use strict"},18625:()=>{"use strict"},14276:()=>{"use strict"},95425:(k,R,e)=>{"use strict";e.d(R,{Z4:()=>t,_g:()=>n,d9:()=>i});var t=(s=>(s.Home="home-dashboard",s.New="new-dashboard",s.Normal="normal-dashboard",s.Path="path-dashboard",s.Scripted="scripted-dashboard",s.Public="public-dashboard",s.Embedded="embedded-dashboard",s.Report="report-dashboard",s))(t||{}),n=(s=>(s.NotStarted="Not started",s.Fetching="Fetching",s.Services="Services",s.Failed="Failed",s.Completed="Completed",s))(n||{}),i=(s=>(s.TV="tv",s.Full="full",s))(i||{})},62543:()=>{"use strict"},28444:(k,R,e)=>{"use strict";e.d(R,{Bt:()=>u,Cf:()=>d,Eu:()=>I,Io:()=>y,JI:()=>o,PR:()=>h,Ps:()=>P,Q$:()=>f,Rh:()=>E,S8:()=>M,U0:()=>v,VZ:()=>D,Vz:()=>x,XM:()=>m,Yn:()=>g,aP:()=>O,bG:()=>r,bY:()=>b,i0:()=>A,sL:()=>S,u4:()=>a,vk:()=>p,xL:()=>l,xc:()=>T,yj:()=>C,zq:()=>c});var t=e(89550),n=e(65463);const i=(0,t.R)("ds-request-response"),s=(0,t.R)("ds-request-error"),r=(0,t.R)("template-variable-value-updated"),g=(0,t.R)("graph-click"),a=(0,t.R)("threshold-changed");class c extends n.a{static{this.type="panel-queries-changed"}}class o extends n.a{static{this.type="panel-transformations-changed"}}class h extends n.a{static{this.type="panels-options-changed"}}class f extends n.a{static{this.type="dashboard-panels-changed"}}class d extends n.a{static{this.type="dashboard-meta-changed"}}class p extends n.a{static{this.type="panel-directive-ready"}}class m extends n.a{static{this.type="render"}}class v extends n.x{static{this.type="zoom-out"}}var l=(L=>(L[L.Left=-1]="Left",L[L.Right=1]="Right",L))(l||{});class y extends n.x{static{this.type="shift-time"}}class u extends n.a{static{this.type="copy-time"}}class D extends n.x{static{this.type="paste-time"}}class E extends n.x{static{this.type="absolute-time"}}class x extends n.x{static{this.type="remove-panel"}}class P extends n.x{static{this.type="show-modal"}}class b extends n.x{static{this.type="show-confirm-modal"}}class M extends n.x{static{this.type="show-react-modal"}}class O extends n.a{static{this.type="hide-modal"}}class I extends n.a{static{this.type="dashboard-saved"}}class T extends n.x{static{this.type="annotation-query-started"}}class C extends n.x{static{this.type="annotation-query-finished"}}class S extends n.x{static{this.type="panel-edit-started"}}class A extends n.x{static{this.type="panel-edit-finished"}}},76698:(k,R,e)=>{"use strict";e.d(R,{IW:()=>t,aA:()=>i,jH:()=>s,sG:()=>n});var t=(r=>(r[r.CLOSE_PANE=0]="CLOSE_PANE",r[r.CHANGE_DATASOURCE=1]="CHANGE_DATASOURCE",r[r.CLOSE_EDITOR=2]="CLOSE_EDITOR",r))(t||{});const n=["lines","bars","points","stacked_lines","stacked_bars"];var i=(r=>(r.table="table",r.raw="raw",r))(i||{});const s=["table","raw"]},8904:()=>{"use strict"},31678:(k,R,e)=>{"use strict";e.d(R,{AccessControlAction:()=>x,AppNotificationSeverity:()=>p,CORRELATION_EDITOR_POST_CONFIRM_ACTION:()=>l.IW,CoreEvents:()=>P,DashboardInitPhase:()=>r._g,DashboardRoutes:()=>r.Z4,EXPLORE_GRAPH_STYLES:()=>l.sG,KioskMode:()=>r.d9,OrgRole:()=>g.XT,PermissionLevelString:()=>g.RG,SearchQueryType:()=>g.Vz,ServiceAccountStateFilter:()=>o,TABLE_RESULTS_STYLE:()=>l.aA,TeamPermissionLevel:()=>g.Xe,addListener:()=>y.ch,createAsyncThunk:()=>y.zD,timeoutMap:()=>v,useDispatch:()=>y.wA,useSelector:()=>y.d4});var t=e(17523),n=e(50271),i=e(54034),s=e(8904),r=e(95425),g=e(24897),a=e(18625),c=e(64998),o=(b=>(b.All="All",b.WithExpiredTokens="WithExpiredTokens",b.External="External",b.Disabled="Disabled",b))(o||{}),h=e(62543),f=e(77237),d=e(75330),p=(b=>(b.Success="success",b.Warning="warning",b.Error="error",b.Info="info",b))(p||{}),m=(b=>(b[b.Success=3e3]="Success",b[b.Warning=5e3]="Warning",b[b.Error=7e3]="Error",b))(m||{});const v={success:3e3,warning:5e3,error:7e3,info:3e3};var l=e(76698),y=e(64756),u=e(13868),D=e(14276),E=e(90697),x=(b=>(b.UsersRead="users:read",b.UsersWrite="users:write",b.UsersAuthTokenList="users.authtoken:read",b.UsersAuthTokenUpdate="users.authtoken:write",b.UsersPasswordUpdate="users.password:write",b.UsersDelete="users:delete",b.UsersCreate="users:create",b.UsersEnable="users:enable",b.UsersDisable="users:disable",b.UsersPermissionsUpdate="users.permissions:write",b.UsersLogout="users:logout",b.UsersQuotasList="users.quotas:read",b.UsersQuotasUpdate="users.quotas:write",b.ServiceAccountsRead="serviceaccounts:read",b.ServiceAccountsCreate="serviceaccounts:create",b.ServiceAccountsWrite="serviceaccounts:write",b.ServiceAccountsDelete="serviceaccounts:delete",b.ServiceAccountsPermissionsRead="serviceaccounts.permissions:read",b.ServiceAccountsPermissionsWrite="serviceaccounts.permissions:write",b.OrgsRead="orgs:read",b.OrgsPreferencesRead="orgs.preferences:read",b.OrgsWrite="orgs:write",b.OrgsPreferencesWrite="orgs.preferences:write",b.OrgsCreate="orgs:create",b.OrgsDelete="orgs:delete",b.OrgUsersRead="org.users:read",b.OrgUsersAdd="org.users:add",b.OrgUsersRemove="org.users:remove",b.OrgUsersWrite="org.users:write",b.LDAPUsersRead="ldap.user:read",b.LDAPUsersSync="ldap.user:sync",b.LDAPStatusRead="ldap.status:read",b.DataSourcesExplore="datasources:explore",b.DataSourcesRead="datasources:read",b.DataSourcesCreate="datasources:create",b.DataSourcesWrite="datasources:write",b.DataSourcesDelete="datasources:delete",b.DataSourcesPermissionsRead="datasources.permissions:read",b.DataSourcesCachingRead="datasources.caching:read",b.DataSourcesInsightsRead="datasources.insights:read",b.ActionServerStatsRead="server.stats:read",b.ActionTeamsCreate="teams:create",b.ActionTeamsDelete="teams:delete",b.ActionTeamsRead="teams:read",b.ActionTeamsWrite="teams:write",b.ActionTeamsPermissionsRead="teams.permissions:read",b.ActionTeamsPermissionsWrite="teams.permissions:write",b.ActionRolesList="roles:read",b.ActionTeamsRolesList="teams.roles:read",b.ActionTeamsRolesAdd="teams.roles:add",b.ActionTeamsRolesRemove="teams.roles:remove",b.ActionUserRolesList="users.roles:read",b.ActionUserRolesAdd="users.roles:add",b.ActionUserRolesRemove="users.roles:remove",b.DashboardsRead="dashboards:read",b.DashboardsWrite="dashboards:write",b.DashboardsDelete="dashboards:delete",b.DashboardsCreate="dashboards:create",b.DashboardsPermissionsRead="dashboards.permissions:read",b.DashboardsPermissionsWrite="dashboards.permissions:write",b.DashboardsPublicWrite="dashboards.public:write",b.FoldersRead="folders:read",b.FoldersWrite="folders:write",b.FoldersDelete="folders:delete",b.FoldersCreate="folders:create",b.FoldersPermissionsRead="folders.permissions:read",b.FoldersPermissionsWrite="folders.permissions:write",b.ActionSupportBundlesCreate="support.bundles:create",b.ActionSupportBundlesRead="support.bundles:read",b.ActionSupportBundlesDelete="support.bundles:delete",b.AlertingRuleCreate="alert.rules:create",b.AlertingRuleRead="alert.rules:read",b.AlertingRuleUpdate="alert.rules:write",b.AlertingRuleDelete="alert.rules:delete",b.AlertingInstanceCreate="alert.instances:create",b.AlertingInstanceUpdate="alert.instances:write",b.AlertingInstanceRead="alert.instances:read",b.AlertingSilenceCreate="alert.silences:create",b.AlertingSilenceUpdate="alert.silences:write",b.AlertingSilenceRead="alert.silences:read",b.AlertingNotificationsRead="alert.notifications:read",b.AlertingNotificationsWrite="alert.notifications:write",b.AlertingRuleExternalWrite="alert.rules.external:write",b.AlertingRuleExternalRead="alert.rules.external:read",b.AlertingInstancesExternalWrite="alert.instances.external:write",b.AlertingInstancesExternalRead="alert.instances.external:read",b.AlertingNotificationsExternalWrite="alert.notifications.external:write",b.AlertingNotificationsExternalRead="alert.notifications.external:read",b.AlertingProvisioningReadSecrets="alert.provisioning.secrets:read",b.AlertingProvisioningRead="alert.provisioning:read",b.AlertingProvisioningWrite="alert.provisioning:write",b.ActionAPIKeysRead="apikeys:read",b.ActionAPIKeysCreate="apikeys:create",b.ActionAPIKeysDelete="apikeys:delete",b.PluginsInstall="plugins:install",b.PluginsWrite="plugins:write",b.SettingsRead="settings:read",b.SettingsWrite="settings:write",b))(x||{}),P=e(28444)},13868:()=>{"use strict"},54034:()=>{"use strict"},75330:()=>{"use strict"},77237:()=>{"use strict"},90697:()=>{"use strict"},64756:(k,R,e)=>{"use strict";e.d(R,{ch:()=>g,d4:()=>s,wA:()=>i,zD:()=>r});var t=e(65307),n=e(71468);const i=n.useDispatch,s=n.useSelector,r=(a,c,o)=>(0,t.zD)(a,c,o),g=t.ch},38824:(k,R,e)=>{"use strict";e.d(R,{m:()=>t});var t=(n=>(n.LineChart="Line chart",n.LineChartSmooth="Line chart smooth",n.LineChartGradientColorScheme="Line chart with gradient color scheme",n.AreaChart="Area chart",n.AreaChartStacked="Area chart stacked",n.AreaChartStackedPercent="Area chart 100% stacked",n.BarChart="Bar chart",n.BarChartGradientColorScheme="Bar chart with gradient color scheme",n.BarChartStacked="Bar chart stacked",n.BarChartStackedPercent="Bar chart 100% stacked",n.BarChartHorizontal="Bar chart horizontal",n.BarChartHorizontalStacked="Bar chart horizontal stacked",n.BarChartHorizontalStackedPercent="Bar chart horizontal 100% stacked",n.Candlestick="Candlestick",n.PieChart="Pie chart",n.PieChartDonut="Pie chart donut",n.Stat="Stat",n.StatColoredBackground="Stat colored background",n.Gauge="Gauge",n.GaugeNoThresholds="Gauge no thresholds",n.BarGaugeBasic="Bar gauge basic",n.BarGaugeLCD="Bar gauge LCD",n.Table="Table",n.StateTimeline="State timeline",n.StatusHistory="Status history",n.TextPanel="Text",n.DashboardList="Dashboard list",n.Logs="Logs",n.FlameGraph="Flame graph",n.Trace="Trace",n.NodeGraph="Node graph",n))(t||{})},17523:()=>{"use strict"},94822:(k,R,e)=>{"use strict";e.d(R,{$k:()=>g,Gi:()=>n,JS:()=>c,N1:()=>o,Q8:()=>h,Si:()=>i,cF:()=>t,lh:()=>a,qr:()=>r,s1:()=>s});var t=(f=>(f.Firing="firing",f.Inactive="inactive",f.Pending="pending",f))(t||{}),n=(f=>(f.Normal="Normal",f.Alerting="Alerting",f.Pending="Pending",f.NoData="NoData",f.Error="Error",f))(n||{});function i(f){return Object.values(t).includes(f)}function s(f){return Object.values(n).some(d=>d===f)}function r(f){const d=Object.values(t);return f!=null&&!d.includes(f)}function g(f){const d=f.match(/\((.*?)\)/);return d?d[1]:""}function a(f){return r(f)?f.split(" ")[0]:f}var c=(f=>(f.Alerting="alerting",f.Recording="recording",f))(c||{}),o=(f=>(f.Cortex="Cortex",f.Mimir="Mimir",f.Prometheus="Prometheus",f.Thanos="Thanos",f))(o||{}),h=(f=>(f.Alerting="Alerting",f.NoData="NoData",f.KeepLast="KeepLast",f.OK="OK",f.Error="Error",f))(h||{})},54317:(k,R,e)=>{"use strict";e.d(R,{$:()=>s,S:()=>n});var t=e(94822);function n(r,g){return(0,t.lh)(r.state)===g}var i=(r=>(r.Firing="firing",r))(i||{}),s=(r=>(r.Alerting="alerting",r.Pending="pending",r.Normal="inactive",r.NoData="nodata",r.Error="error",r))(s||{})},64998:()=>{"use strict"},72834:k=>{const R="    ";function e(s){let r="";return s&&Object.keys(s).forEach(function(g){r+=g+":"+s[g]+";"}),r}function t(s){function r(a){return'class="'+a+'"'}function g(a){return'style="'+e(s["."+a])+'"'}return s?g:r}function n(s){return s===null?"null":Array.isArray(s)?"array":typeof s=="string"&&/^https?:/.test(s)?"link":typeof s=="object"&&typeof s.toISOString=="function"?"date":typeof s}function i(s){return s.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}k.exports=function(s,r){let g="";const a=t(r);let c=function(h,f,d,p){if(!h.length)return f+" "+d;let m=f+`
`;return g+=R,h.forEach(function(v,l){m+=g+p(v)+(l<h.length-1?",":"")+`
`}),g=g.slice(0,-R.length),m+g+d};function o(h){if(h===void 0)return"";switch(n(h)){case"boolean":return"<span "+a("json-markup-bool")+">"+h+"</span>";case"number":return"<span "+a("json-markup-number")+">"+h+"</span>";case"date":return'<span class="json-markup-string">"'+i(h.toISOString())+'"</span>';case"null":return"<span "+a("json-markup-null")+">null</span>";case"string":return"<span "+a("json-markup-string")+'>"'+i(h.replace(/\n/g,`
`+g))+'"</span>';case"link":return"<span "+a("json-markup-string")+'>"<a href="'+encodeURI(h)+'">'+i(h)+'</a>"</span>';case"array":return c(h,"[","]",o);case"object":const f=Object.keys(h).filter(function(d){return h[d]!==void 0});return c(f,"{","}",function(d){return"<span "+a("json-markup-key")+'>"'+i(d)+'":</span> '+o(h[d])})}return""}return"<div "+a("json-markup")+">"+o(s)+"</div>"}},13609:()=>{(function(k){"use strict";k(function(){k.support.transition=function(){var R=function(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},n;for(n in t)if(e.style[n]!==void 0)return t[n]}();return R&&{end:R}}()})})(window.jQuery),function(k){"use strict";var R="[data-toggle=dropdown]",e=function(s){var r=k(s).on("click.dropdown.data-api",this.toggle);k("html").on("click.dropdown.data-api",function(){r.parent().removeClass("open")})};e.prototype={constructor:e,toggle:function(s){var r=k(this),g,a;if(!r.is(".disabled, :disabled"))return g=n(r),a=g.hasClass("open"),t(),a||("ontouchstart"in document.documentElement&&k('<div class="dropdown-backdrop"/>').insertBefore(k(this)).on("click",t),g.toggleClass("open")),r.focus(),!1},keydown:function(s){var r,g,a,c,o,h;if(/(38|40|27)/.test(s.keyCode)&&(r=k(this),s.preventDefault(),s.stopPropagation(),!r.is(".disabled, :disabled"))){if(c=n(r),o=c.hasClass("open"),!o||o&&s.keyCode==27)return s.which==27&&c.find(R).focus(),r.click();g=k("[role=menu] li:not(.divider):visible a",c),g.length&&(h=g.index(g.filter(":focus")),s.keyCode==38&&h>0&&h--,s.keyCode==40&&h<g.length-1&&h++,~h||(h=0),g.eq(h).focus())}}};function t(){k(".dropdown-backdrop").remove(),k(R).each(function(){n(k(this)).removeClass("open")})}function n(s){var r=s.attr("data-target"),g;return r||(r=s.attr("href"),r=r&&/#[A-Za-z]/.test(r)&&r.replace(/.*(?=#[^\s]*$)/,"")),g=r&&k.find(r),(!g||!g.length)&&(g=s.parent()),g}var i=k.fn.dropdown;k.fn.dropdown=function(s){return this.each(function(){var r=k(this),g=r.data("dropdown");g||r.data("dropdown",g=new e(this)),typeof s=="string"&&g[s].call(r)})},k.fn.dropdown.Constructor=e,k.fn.dropdown.noConflict=function(){return k.fn.dropdown=i,this},k(document).on("click.dropdown.data-api",t).on("click.dropdown.data-api",".dropdown form",function(s){s.stopPropagation()}).on("click.dropdown.data-api",R,e.prototype.toggle).on("keydown.dropdown.data-api",R+", [role=menu]",e.prototype.keydown)}(window.jQuery),function(k){"use strict";var R=function(t,n){this.options=n,this.$element=k(t).delegate('[data-dismiss="modal"]',"click.dismiss.modal",k.proxy(this.hide,this)),this.options.remote&&this.$element.find(".modal-body").load(this.options.remote)};R.prototype={constructor:R,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var t=this,n=k.Event("show");this.$element.trigger(n),!(this.isShown||n.isDefaultPrevented())&&(this.isShown=!0,this.escape(),this.backdrop(function(){var i=k.support.transition&&t.$element.hasClass("fade");t.$element.parent().length||t.$element.appendTo(document.body),t.$element.show(),i&&t.$element[0].offsetWidth,t.$element.addClass("in").attr("aria-hidden",!1),t.enforceFocus(),i?t.$element.one(k.support.transition.end,function(){t.$element.focus().trigger("shown")}):t.$element.focus().trigger("shown")}))},hide:function(t){t&&t.preventDefault();var n=this;t=k.Event("hide"),this.$element.trigger(t),!(!this.isShown||t.isDefaultPrevented())&&(this.isShown=!1,this.escape(),k(document).off("focusin.modal"),this.$element.removeClass("in").attr("aria-hidden",!0),k.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal())},enforceFocus:function(){var t=this;k(document).on("focusin.modal",function(n){t.$element[0]!==n.target&&!t.$element.has(n.target).length&&t.$element.focus()})},escape:function(){var t=this;this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.modal",function(n){n.which==27&&t.hide()}):this.isShown||this.$element.off("keyup.dismiss.modal")},hideWithTransition:function(){var t=this,n=setTimeout(function(){t.$element.off(k.support.transition.end),t.hideModal()},500);this.$element.one(k.support.transition.end,function(){clearTimeout(n),t.hideModal()})},hideModal:function(){var t=this;this.$element.hide(),this.backdrop(function(){t.removeBackdrop(),t.$element.trigger("hidden")})},removeBackdrop:function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},backdrop:function(t){var n=this,i=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var s=k.support.transition&&i;if(this.$backdrop=k('<div class="modal-backdrop '+i+'" />').appendTo(document.body),this.$backdrop.click(this.options.backdrop=="static"?k.proxy(this.$element[0].focus,this.$element[0]):k.proxy(this.hide,this)),s&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!t)return;s?this.$backdrop.one(k.support.transition.end,t):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),k.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(k.support.transition.end,t):t()):t&&t()}};var e=k.fn.modal;k.fn.modal=function(t){return this.each(function(){var n=k(this),i=n.data("modal"),s=k.extend({},k.fn.modal.defaults,n.data(),typeof t=="object"&&t);i||n.data("modal",i=new R(this,s)),typeof t=="string"?i[t]():s.show&&i.show()})},k.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0},k.fn.modal.Constructor=R,k.fn.modal.noConflict=function(){return k.fn.modal=e,this},k(document).on("click.modal.data-api",'[data-toggle="modal"]',function(t){var n=k(this),i=n.attr("href"),s=k.find(n.attr("data-target")||i&&i.replace(/.*(?=#[^\s]+$)/,"")),r=s.data("modal")?"toggle":k.extend({remote:!/#/.test(i)&&i},s.data(),n.data());t.preventDefault(),s.modal(r).one("hide",function(){n.focus()})})}(window.jQuery),function(k){"use strict";var R=function(t,n){this.init("tooltip",t,n)};R.prototype={constructor:R,init:function(t,n,i){var s,r,g,a,c;for(this.type=t,this.$element=k(n),this.options=this.getOptions(i),this.enabled=!0,g=this.options.trigger.split(" "),c=g.length;c--;)a=g[c],a=="click"?this.$element.on("click."+this.type,this.options.selector,k.proxy(this.toggle,this)):a!="manual"&&(s=a=="hover"?"mouseenter":"focus",r=a=="hover"?"mouseleave":"blur",this.$element.on(s+"."+this.type,this.options.selector,k.proxy(this.enter,this)),this.$element.on(r+"."+this.type,this.options.selector,k.proxy(this.leave,this)));this.options.selector?this._options=k.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(t){return t=k.extend({},k.fn[this.type].defaults,this.$element.data(),t),t.delay&&typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),t},enter:function(t){var n=k.fn[this.type].defaults,i={},s;if(this._options&&k.each(this._options,function(r,g){n[r]!=g&&(i[r]=g)},this),s=k(t.currentTarget)[this.type](i).data(this.type),!s.options.delay||!s.options.delay.show)return s.show();clearTimeout(this.timeout),s.hoverState="in",this.timeout=setTimeout(function(){s.hoverState=="in"&&s.show()},s.options.delay.show)},leave:function(t){var n=k(t.currentTarget)[this.type](this._options).data(this.type);if(this.timeout&&clearTimeout(this.timeout),!n.options.delay||!n.options.delay.hide)return n.hide();n.hoverState="out",this.timeout=setTimeout(function(){n.hoverState=="out"&&n.hide()},n.options.delay.hide)},show:function(){var t,n,i,s,r,g,a=k.Event("show");if(this.hasContent()&&this.enabled){if(this.$element.trigger(a),a.isDefaultPrevented())return;switch(t=this.tip(),this.setContent(),this.options.animation&&t.addClass("fade"),r=typeof this.options.placement=="function"?this.options.placement.call(this,t[0],this.$element[0]):this.options.placement,t.detach().css({top:0,left:0,display:"block"}),this.options.container?t.appendTo(k.find(this.options.container)):t.insertAfter(this.$element),n=this.getPosition(),i=t[0].offsetWidth,s=t[0].offsetHeight,r){case"bottom":g={top:n.top+n.height,left:n.left+n.width/2-i/2};break;case"top":g={top:n.top-s,left:n.left+n.width/2-i/2};break;case"left":g={top:n.top+n.height/2-s/2,left:n.left-i};break;case"right":g={top:n.top+n.height/2-s/2,left:n.left+n.width};break;case"topLeft":g={top:n.top-s,left:n.left+n.width/2-i*.1};break;case"topRight":g={top:n.top-s,left:n.left+n.width/2-i*.9};break;case"rightTop":g={top:n.top+n.height/2-s*.1,left:n.left+n.width};break;case"rightBottom":g={top:n.top+n.height/2-s*.9,left:n.left+n.width};break;case"bottomLeft":g={top:n.top+n.height,left:n.left+n.width/2-i*.1};break;case"bottomRight":g={top:n.top+n.height,left:n.left+n.width/2-i*.9};break;case"leftTop":g={top:n.top+n.height/2-s*.1,left:n.left-i};break;case"leftBottom":g={top:n.top+n.height/2-s*.9,left:n.left-i};break}this.applyPlacement(g,r),this.$element.trigger("shown")}},applyPlacement:function(t,n){var i=this.tip(),s=i[0].offsetWidth,r=i[0].offsetHeight,g,a,c,o;i.offset(t).addClass(n).addClass("in"),g=i[0].offsetWidth,a=i[0].offsetHeight,n=="top"&&a!=r&&(t.top=t.top+r-a,o=!0),n=="bottom"||n=="top"?(c=0,t.left<0&&(c=t.left*-2,t.left=0,i.offset(t),g=i[0].offsetWidth,a=i[0].offsetHeight),this.replaceArrow(c-s+g,g,"left")):this.replaceArrow(a-r,a,"top"),o&&i.offset(t)},replaceArrow:function(t,n,i){this.arrow().css(i,t?50*(1-t/n)+"%":"")},setContent:function(){var t=this.tip(),n=this.getTitle();t.find(".tooltip-inner").text(n),t.removeClass("fade in top bottom left right")},hide:function(){var t=this,n=this.tip(),i=k.Event("hide");if(this.$element.trigger(i),i.isDefaultPrevented())return;n.removeClass("in");function s(){var r=setTimeout(function(){n.off(k.support.transition.end).detach()},500);n.one(k.support.transition.end,function(){clearTimeout(r),n.detach()})}return k.support.transition&&this.$tip.hasClass("fade")?s():n.detach(),this.$element.trigger("hidden"),this},fixTitle:function(){var t=this.$element;(t.attr("title")||typeof t.attr("data-original-title")!="string")&&t.attr("data-original-title",t.attr("title")||"").attr("title","")},hasContent:function(){return this.getTitle()},getPosition:function(){var t=this.$element[0];return k.extend({},typeof t.getBoundingClientRect=="function"?t.getBoundingClientRect():{width:t.offsetWidth,height:t.offsetHeight},this.$element.offset())},getTitle:function(){var t,n=this.$element,i=this.options;return t=n.attr("data-original-title")||(typeof i.title=="function"?i.title.call(n[0]):i.title),t},tip:function(){return this.$tip=this.$tip||k(this.options.template)},arrow:function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(t){var n=t?k(t.currentTarget)[this.type](this._options).data(this.type):this;n.tip().hasClass("in")?n.hide():n.show()},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}};var e=k.fn.tooltip;k.fn.tooltip=function(t){return this.each(function(){var n=k(this),i=n.data("tooltip"),s=typeof t=="object"&&t;i||n.data("tooltip",i=new R(this,s)),typeof t=="string"&&i[t]()})},k.fn.tooltip.Constructor=R,k.fn.tooltip.defaults={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},k.fn.tooltip.noConflict=function(){return k.fn.tooltip=e,this}}(window.jQuery),function(k){"use strict";var R=function(t){this.element=k(t)};R.prototype={constructor:R,show:function(){var t=this.element,n=t.closest("ul:not(.dropdown-menu)"),i=t.attr("data-target"),s,r,g;i||(i=t.attr("href"),i=i&&i.replace(/.*(?=#[^\s]*$)/,"")),!t.parent("li").hasClass("active")&&(s=n.find(".active:last a")[0],g=k.Event("show",{relatedTarget:s}),t.trigger(g),!g.isDefaultPrevented()&&(r=k.find(i),this.activate(t.parent("li"),n),this.activate(r,r.parent(),function(){t.trigger({type:"shown",relatedTarget:s})})))},activate:function(t,n,i){var s=n.find("> .active"),r=i&&k.support.transition&&s.hasClass("fade");function g(){s.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),t.addClass("active"),r?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu")&&t.closest("li.dropdown").addClass("active"),i&&i()}r?s.one(k.support.transition.end,g):g(),s.removeClass("in")}};var e=k.fn.tab;k.fn.tab=function(t){return this.each(function(){var n=k(this),i=n.data("tab");i||n.data("tab",i=new R(this)),typeof t=="string"&&i[t]()})},k.fn.tab.Constructor=R,k.fn.tab.noConflict=function(){return k.fn.tab=e,this},k(document).on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(t){t.preventDefault(),k(this).tab("show")})}(window.jQuery),function(k){"use strict";var R=function(t,n){this.$element=k(t),this.options=k.extend({},k.fn.typeahead.defaults,n),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.highlighter=this.options.highlighter||this.highlighter,this.updater=this.options.updater||this.updater,this.source=this.options.source,this.$menu=k(this.options.menu),this.shown=!1,this.listen()};R.prototype={constructor:R,select:function(){var t=this.$menu.find(".active").attr("data-value")||this.$element.val();return this.$element.val(this.updater(t)).change(),this.hide()},updater:function(t){return t},show:function(){var t=k.extend({},this.$element.position(),{height:this.$element[0].offsetHeight});return this.$menu.insertAfter(this.$element).css({top:t.top+t.height,left:t.left}).show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(t){var n;return this.query=this.$element.val(),!this.query||this.query.length<this.options.minLength?this.shown?this.hide():this:(n=k.isFunction(this.source)?this.source(this.query,k.proxy(this.process,this)):this.source,n?this.process(n):this)},process:function(t){var n=this;return t=k.grep(t,function(i){return n.matcher(i)}),t=this.sorter(t),t.length?this.render(t.slice(0,this.options.items)).show():this.shown?this.hide():this},matcher:function(t){return~t.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(t){for(var n=[],i=[],s=[],r;r=t.shift();)r.toLowerCase().indexOf(this.query.toLowerCase())?~r.indexOf(this.query)?i.push(r):s.push(r):n.push(r);return n.concat(i,s)},highlighter:function(t){var n=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return n?t.replace(new RegExp("("+n+")","ig"),function(i,s){return"<strong>"+s+"</strong>"}):t},render:function(t){var n=this;return t=k(t).map(function(i,s){return i=k(n.options.item).attr("data-value",s),i.find("a").html(n.highlighter(s)),i[0]}),this.$menu.html(t),this},next:function(t){var n=this.$menu.find(".active").removeClass("active"),i=n.next();i.length||(i=k(this.$menu.find("li")[0])),i.addClass("active")},prev:function(t){var n=this.$menu.find(".active").removeClass("active"),i=n.prev();i.length||(i=this.$menu.find("li").last()),i.addClass("active")},listen:function(){this.$element.on("focus",k.proxy(this.focus,this)).on("blur",k.proxy(this.blur,this)).on("keypress",k.proxy(this.keypress,this)).on("keyup",k.proxy(this.keyup,this)),this.eventSupported("keydown")&&this.$element.on("keydown",k.proxy(this.keydown,this)),this.$menu.on("click",k.proxy(this.click,this)).on("mouseenter","li",k.proxy(this.mouseenter,this)).on("mouseleave","li",k.proxy(this.mouseleave,this))},destroy:function(){this.$element.off().removeData("typeahead"),this.$menu.off()},eventSupported:function(t){var n=t in this.$element;return n||(this.$element.setAttribute(t,"return;"),n=typeof this.$element[t]=="function"),n},move:function(t){if(this.shown&&!(t.shiftKey&&t.keyCode===40)){switch(t.keyCode){case 9:case 13:case 27:t.preventDefault();break;case 38:t.preventDefault(),this.prev();break;case 40:t.preventDefault(),this.next();break}t.stopPropagation()}},keydown:function(t){this.suppressKeyPressRepeat=~k.inArray(t.keyCode,[40,38,9,13,27,57]),this.move(t)},keypress:function(t){this.suppressKeyPressRepeat||this.move(t)},keyup:function(t){switch(t.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}t.keyCode===13&&typeof this.$menu.find(".active").attr("data-value")>"u"?this.$element.submit():(t.stopPropagation(),t.preventDefault())},focus:function(t){this.focused=!0},blur:function(t){this.focused=!1,!this.mousedover&&this.shown&&this.hide()},click:function(t){t.stopPropagation(),t.preventDefault(),this.select(),this.$element.focus()},mouseenter:function(t){this.mousedover=!0,this.$menu.find(".active").removeClass("active"),k(t.currentTarget).addClass("active")},mouseleave:function(t){this.mousedover=!1,!this.focused&&this.shown&&this.hide()}};var e=k.fn.typeahead;k.fn.typeahead=function(t){return this.each(function(){var n=k(this),i=n.data("typeahead"),s=typeof t=="object"&&t;i||n.data("typeahead",i=new R(this,s)),typeof t=="string"&&i[t]()})},k.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1},k.fn.typeahead.Constructor=R,k.fn.typeahead.noConflict=function(){return k.fn.typeahead=e,this},k(document).on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(t){var n=k(this);n.data("typeahead")||n.typeahead(n.data())})}(window.jQuery),function(k){"use strict";var R=function(t,n){this.options=k.extend({},k.fn.affix.defaults,n),this.$window=k(window).on("scroll.affix.data-api",k.proxy(this.checkPosition,this)).on("click.affix.data-api",k.proxy(function(){setTimeout(k.proxy(this.checkPosition,this),1)},this)),this.$element=k(t),this.checkPosition()};R.prototype.checkPosition=function(){if(this.$element.is(":visible")){var t=k(document).height(),n=this.$window.scrollTop(),i=this.$element.offset(),s=this.options.offset,r=s.bottom,g=s.top,a="affix affix-top affix-bottom",c;typeof s!="object"&&(r=g=s),typeof g=="function"&&(g=s.top()),typeof r=="function"&&(r=s.bottom()),c=this.unpin!=null&&n+this.unpin<=i.top?!1:r!=null&&i.top+this.$element.height()>=t-r?"bottom":g!=null&&n<=g?"top":!1,this.affixed!==c&&(this.affixed=c,this.unpin=c=="bottom"?i.top-n:null,this.$element.removeClass(a).addClass("affix"+(c?"-"+c:"")))}};var e=k.fn.affix;k.fn.affix=function(t){return this.each(function(){var n=k(this),i=n.data("affix"),s=typeof t=="object"&&t;i||n.data("affix",i=new R(this,s)),typeof t=="string"&&i[t]()})},k.fn.affix.Constructor=R,k.fn.affix.defaults={offset:0},k.fn.affix.noConflict=function(){return k.fn.affix=e,this},k(window).on("load",function(){k('[data-spy="affix"]').each(function(){var t=k(this),n=t.data();n.offset=n.offset||{},n.offsetBottom&&(n.offset.bottom=n.offsetBottom),n.offsetTop&&(n.offset.top=n.offsetTop),t.affix(n)})})}(window.jQuery)},82013:()=>{(function(k){var R={crosshair:{mode:null,color:"rgba(170, 0, 0, 0.80)",lineWidth:1}};function e(t){var n={x:-1,y:-1,locked:!1};t.setCrosshair=function(g){if(!g)n.x=-1;else{var a=t.p2c(g);n.x=Math.max(0,Math.min(a.left,t.width())),n.y=Math.max(0,Math.min(a.top,t.height()))}t.triggerRedrawOverlay()},t.clearCrosshair=t.setCrosshair,t.lockCrosshair=function(g){g&&t.setCrosshair(g),n.locked=!0},t.unlockCrosshair=function(){n.locked=!1};function i(r){n.locked||n.x!=-1&&(n.x=-1,t.triggerRedrawOverlay())}function s(r){if(!n.locked){if(t.getSelection&&t.getSelection()){n.x=-1;return}var g=t.offset();n.x=Math.max(0,Math.min(r.pageX-g.left,t.width())),n.y=Math.max(0,Math.min(r.pageY-g.top,t.height())),t.triggerRedrawOverlay()}}t.hooks.bindEvents.push(function(r,g){r.getOptions().crosshair.mode&&(g.mouseout(i),g.mousemove(s))}),t.hooks.drawOverlay.push(function(r,g){var a=r.getOptions().crosshair;if(a.mode){var c=r.getPlotOffset();if(g.save(),g.translate(c.left,c.top),n.x!=-1){var o=r.getOptions().crosshair.lineWidth%2?.5:0;if(g.strokeStyle=a.color,g.lineWidth=a.lineWidth,g.lineJoin="round",g.beginPath(),a.mode.indexOf("x")!=-1){var h=Math.floor(n.x)+o;g.moveTo(h,0),g.lineTo(h,r.height())}if(a.mode.indexOf("y")!=-1){var f=Math.floor(n.y)+o;g.moveTo(0,f),g.lineTo(r.width(),f)}g.stroke()}g.restore()}}),t.hooks.shutdown.push(function(r,g){g.unbind("mouseout",i),g.unbind("mousemove",s)})}k.plot.plugins.push({init:e,options:R,name:"crosshair",version:"1.0"})})(jQuery)},2341:()=>{(function(k){function R(e){e.hooks.processDatapoints.push(function(t,n,i){n.dashes.show&&t.hooks.draw.push(function(s,r){var g=s.getPlotOffset(),a=n.xaxis,c=n.yaxis;function o(p,m){var v=i.points,l=i.pointsize,y=null,u=null,D=0,E=!0,x,P;n.dashes.dashLength[0]?(x=n.dashes.dashLength[0],n.dashes.dashLength[1]?P=n.dashes.dashLength[1]:P=x):P=x=n.dashes.dashLength,r.beginPath();for(var b=l;b<v.length;b+=l){let w=function(B){var U=Math.sqrt(Math.pow(A-C,2)+Math.pow(L-S,2));if(U<=B)return{deltaX:A-C,deltaY:L-S,distance:U,remainder:B-U};var K=A>C?1:-1,V=L>S?1:-1;return{deltaX:K*Math.sqrt(Math.pow(B,2)/(1+Math.pow((L-S)/(A-C),2))),deltaY:V*Math.sqrt(Math.pow(B,2)-Math.pow(B,2)/(1+Math.pow((L-S)/(A-C),2))),distance:B,remainder:0}};var F=w,M=v[b-l],O=v[b-l+1],I=v[b],T=v[b+1];if(!(M==null||I==null)){if(O<=T&&O<c.min){if(T<c.min)continue;M=(c.min-O)/(T-O)*(I-M)+M,O=c.min}else if(T<=O&&T<c.min){if(O<c.min)continue;I=(c.min-O)/(T-O)*(I-M)+M,T=c.min}if(O>=T&&O>c.max){if(T>c.max)continue;M=(c.max-O)/(T-O)*(I-M)+M,O=c.max}else if(T>=O&&T>c.max){if(O>c.max)continue;I=(c.max-O)/(T-O)*(I-M)+M,T=c.max}if(M<=I&&M<a.min){if(I<a.min)continue;O=(a.min-M)/(I-M)*(T-O)+O,M=a.min}else if(I<=M&&I<a.min){if(M<a.min)continue;T=(a.min-M)/(I-M)*(T-O)+O,I=a.min}if(M>=I&&M>a.max){if(I>a.max)continue;O=(a.max-M)/(I-M)*(T-O)+O,M=a.max}else if(I>=M&&I>a.max){if(M>a.max)continue;T=(a.max-M)/(I-M)*(T-O)+O,I=a.max}(M!=y||O!=u)&&r.moveTo(a.p2c(M)+p,c.p2c(O)+m);var C=a.p2c(M)+p,S=c.p2c(O)+m,A=a.p2c(I)+p,L=c.p2c(T)+m,N;do N=w(D>0?D:E?x:P),(N.deltaX!=0||N.deltaY!=0)&&(E?r.lineTo(C+N.deltaX,S+N.deltaY):r.moveTo(C+N.deltaX,S+N.deltaY)),E=!E,D=N.remainder,C+=N.deltaX,S+=N.deltaY;while(N.distance>0);y=I,u=T}}r.stroke()}r.save(),r.translate(g.left,g.top),r.lineJoin="round";var h=n.dashes.lineWidth,f=n.shadowSize;if(h>0&&f>0){r.lineWidth=f,r.strokeStyle="rgba(0,0,0,0.1)";var d=Math.PI/18;o(Math.sin(d)*(h/2+f/2),Math.cos(d)*(h/2+f/2)),r.lineWidth=f/2,o(Math.sin(d)*(h/2+f/4),Math.cos(d)*(h/2+f/4))}r.lineWidth=h,r.strokeStyle=n.color,h>0&&o(0,0),r.restore()})})}k.plot.plugins.push({init:R,options:{series:{dashes:{show:!1,lineWidth:2,dashLength:10}}},name:"dashes",version:"0.1"})})(jQuery)},92275:()=>{(function(k){"use strict";var R={series:{fillBelowTo:null}};function e(t){function n(r,g){var a;for(a=0;a<g.length;++a)if(g[a].id===r.fillBelowTo)return g[a];return null}function i(r,g,a,c,o,h,f,d){var p,m,v,l,y,u;return p=a-r,m=c-g,v=f-o,l=d-h,y=(-m*(r-o)+p*(g-h))/(-v*m+p*l),u=(v*(g-h)-l*(r-o))/(-v*m+p*l),y>=0&&y<=1&&u>=0&&u<=1?[r+u*p,g+u*m]:null}function s(r,g,a){if(a.fillBelowTo===null)return;var c,o,h,f,d,p,m;function v(P,b){g.beginPath(),g.moveTo(a.xaxis.p2c(P)+p.left,a.yaxis.p2c(b)+p.top)}function l(){g.closePath(),g.fill()}function y(){if(h.length/o!==d.length/f)return console.error("Refusing to graph inconsistent number of points"),!1;var P;for(P=0;P<h.length/o;P++)if(h[P*o]!==null&&d[P*f]!==null&&h[P*o]!==d[P*f])return console.error("Refusing to graph points without matching value"),!1;return!0}function u(P,b){console.assert(b>P,"expects the end index to be greater than the start index");var M=P===0||h[P-1]===null||d[P-1]===null,O=!1,I,T;for(I=P;I<b;I++)if(h[I*o+1]===null||d[I*o+1]===null)O=!1,M=!0;else if(h[I*o+1]===d[I*f+1])O=!0,M=!1;else if(h[I*o+1]>d[I*f+1]){M?v(h[I*o],h[I*o+1]):O?v(h[(I-1)*o],h[(I-1)*o+1]):(T=D(I),v(T[0],T[1])),x(I,b);return}else M=!1,O=!1}function D(P){console.assert(P>0,"expects the second point in the series line segment");var b,M;for(b=1;b<d.length/f;b++)if(M=i(h[(P-1)*o],h[(P-1)*o+1],h[P*o],h[P*o+1],d[(b-1)*f],d[(b-1)*f+1],d[b*f],d[b*f+1]),M!==null)return M;console.error("intersectionPoint() should only be called when an intersection happens")}function E(P,b){console.assert(P>=b,"the start should be the rightmost point, and the end should be the leftmost (excluding the equal or intersecting point)");var M;for(M=P;M>=b;M--)g.lineTo(c.xaxis.p2c(d[M*f])+p.left,c.yaxis.p2c(d[M*f+1])+p.top);l()}function x(P,b){console.assert(P<=b,"the start should be the rightmost point, and the end should be the leftmost (excluding the equal or intersecting point)");var M,O;for(M=P;M<b;M++)if(h[M*o+1]===null&&M>P){E(M-1,P),u(M,b);return}else if(h[M*o+1]===d[M*f+1]){E(M,P),u(M,b);return}else if(h[M*o+1]<d[M*f+1]){O=D(M),g.lineTo(a.xaxis.p2c(O[0])+p.left,a.yaxis.p2c(O[1])+p.top),E(M,P),u(M,b);return}else g.lineTo(a.xaxis.p2c(h[M*o])+p.left,a.yaxis.p2c(h[M*o+1])+p.top);E(b,P)}c=n(a,r.getData()),c&&(o=a.datapoints.pointsize,h=a.datapoints.points,f=c.datapoints.pointsize,d=c.datapoints.points,p=r.getPlotOffset(),y()&&(m=k.color.parse(a.color),m.a=.4,m.normalize(),g.fillStyle=m.toString(),u(0,h.length/o)))}t.hooks.drawSeries.push(s)}k.plot.plugins.push({init:e,options:R,name:"fillbelow",version:"0.1.0"})})(jQuery)},19538:()=>{/*!
 * jquery.flot.gauge v1.1.0 *
 *
 * Flot plugin for rendering gauge charts.
 *
 * Copyright (c) 2015 @toyoty99.
 * Licensed under the MIT license.
 */(function(k){var R=function(){var a,c,o,h,f,d,p=function(P,b){a=b,c=P.getPlaceholder(),o=P.getOptions(),h=o.series.gauges,f=P.getData(),d=e(h.debug)};p.prototype.calculateLayout=function(){var P=c.width(),b=c.height(),M=Math.min(f.length,h.layout.columns),O=Math.ceil(f.length/M),I=h.layout.margin,T=h.layout.hMargin,C=h.layout.vMargin,S=(P-I*2-T*(M-1))/M,A=(b-I*2-C*(O-1))/O;if(h.layout.square){var L=Math.min(S,A);S=L,A=L}m(h,S);var N=h.cell.margin,F=0,w=0;h.label.show&&(F=h.label.margin,w=h.label.font.size);var B=0,U=0;h.value.show&&(B=h.value.margin,U=h.value.font.size);var K=0;h.threshold.show&&(K=h.threshold.width);var V=0,H=0;h.threshold.label.show&&(V=h.threshold.label.margin,H=h.threshold.label.font.size);for(var Y=S/2-N-K-V*2-H,X=h.gauge.startAngle,J=h.gauge.endAngle,q=(J-X)/100,ae=-1,j=X;j<J;j+=q)ae=Math.max(ae,Math.sin(i(j)));ae=Math.max(ae,Math.sin(i(J)));var te=(A-N*2-F*2-w)/(1+ae);te*ae<B+U/2&&(te=A-N*2-F*2-w-B-U/2);var ne=te-V*2-H-K,le=Math.min(Y,ne),z=h.gauge.width;z>=le&&(z=Math.max(3,le/3));var ee=V*2+H+K+le,se=Math.max(ee*(1+ae),ee+B+U/2);return{canvasWidth:P,canvasHeight:b,margin:I,hMargin:T,vMargin:C,columns:M,rows:O,cellWidth:S,cellHeight:A,cellMargin:N,labelMargin:F,labelFontSize:w,valueMargin:B,valueFontSize:U,width:z,radius:le,thresholdWidth:K,thresholdLabelMargin:V,thresholdLabelFontSize:H,gaugeOuterHeight:se}};function m(P,b){P.gauge.width==="auto"&&(P.gauge.width=Math.max(5,b/8)),P.label.margin==="auto"&&(P.label.margin=Math.max(1,b/20)),P.label.font.size==="auto"&&(P.label.font.size=Math.max(5,b/8)),P.value.margin==="auto"&&(P.value.margin=Math.max(1,b/30)),P.value.font.size==="auto"&&(P.value.font.size=Math.max(5,b/9)),P.threshold.width==="auto"&&(P.threshold.width=Math.max(3,b/100)),P.threshold.label.margin==="auto"&&(P.threshold.label.margin=Math.max(3,b/40)),P.threshold.label.font.size==="auto"&&(P.threshold.label.font.size=Math.max(5,b/15))}p.prototype.calculateAutoValues=m,p.prototype.calculateCellLayout=function(P,b,M){var O=t(b.columns,M),I=n(b.columns,M),T=b.margin+(b.cellWidth+b.hMargin)*O,C=b.margin+(b.cellHeight+b.vMargin)*I,S=T+b.cellWidth/2,A=C+b.cellMargin+b.labelMargin*2+b.labelFontSize+b.thresholdWidth+b.thresholdLabelFontSize+b.thresholdLabelMargin*2+b.radius,L=b.cellHeight-b.cellMargin*2-b.labelMargin*2-b.labelFontSize-b.gaugeOuterHeight,N=0;return P.cell.vAlign==="middle"?N=L/2:P.cell.vAlign==="bottom"&&(N=L),A+=N,{col:O,row:I,x:T,y:C,offsetY:N,cellWidth:b.cellWidth,cellHeight:b.cellHeight,cellMargin:b.cellMargin,cx:S,cy:A}},p.prototype.drawBackground=function(P){h.frame.show&&(a.save(),a.strokeStyle=o.grid.borderColor,a.lineWidth=o.grid.borderWidth,a.strokeRect(0,0,P.canvasWidth,P.canvasHeight),o.grid.backgroundColor&&(a.fillStyle=o.grid.backgroundColor,a.fillRect(0,0,P.canvasWidth,P.canvasHeight)),a.restore())},p.prototype.drawCellBackground=function(P,b){a.save(),P.cell.border&&P.cell.border.show&&P.cell.border.color&&P.cell.border.width&&(a.strokeStyle=P.cell.border.color,a.lineWidth=P.cell.border.width,a.strokeRect(b.x,b.y,b.cellWidth,b.cellHeight)),P.cell.background&&P.cell.background.color&&(a.fillStyle=P.cell.background.color,a.fillRect(b.x,b.y,b.cellWidth,b.cellHeight)),a.restore()},p.prototype.drawGauge=function(P,b,M,O,I){var T=P.gauge.shadow.show?P.gauge.shadow.blur:0,C=y(P,I),S=v(P,b,I);D(M.cx,M.cy,b.radius,b.width,i(P.gauge.startAngle),i(P.gauge.endAngle),P.gauge.border.color,P.gauge.border.width,P.gauge.background.color,T),D(M.cx,M.cy,b.radius-1,b.width-2,i(S.a1),i(S.a2),C,1,C,T),P.gauge.neutralValue!=null&&l(P,b,M,C)};function v(P,b,M){let O={};var I=P.gauge.neutralValue;return I!=null?M<I?(O.a1=u(P,b,M),O.a2=u(P,b,I)):(O.a1=u(P,b,I),O.a2=u(P,b,M)):(O.a1=P.gauge.startAngle,O.a2=u(P,b,M)),O}function l(P,b,M,O){var I=(P.gauge.max-P.gauge.min)/600;s(a,M.cx,M.cy,b.radius-2,b.width-4,i(u(P,b,P.gauge.neutralValue-I)),i(u(P,b,P.gauge.neutralValue+I)),O,2,P.gauge.background.color)}function y(P,b){for(var M,O=0;O<P.threshold.values.length;O++){var I=P.threshold.values[O];if(M=I.color,b<I.value)break}return M}function u(P,b,M){var O=P.gauge.startAngle+(P.gauge.endAngle-P.gauge.startAngle)*((M-P.gauge.min)/(P.gauge.max-P.gauge.min));return O<P.gauge.startAngle?O=P.gauge.startAngle:O>P.gauge.endAngle&&(O=P.gauge.endAngle),O}p.prototype.drawThreshold=function(P,b,M){for(var O=P.gauge.startAngle,I=0;I<P.threshold.values.length;I++){var T=P.threshold.values[I];c1=T.color,a2=u(P,b,T.value),s(a,M.cx,M.cy,b.radius+b.thresholdWidth,b.thresholdWidth-2,i(O),i(a2),c1,1,c1),O=a2}};function D(P,b,M,O,I,T,C,S,A,L){I!==T&&(a.save(),s(a,P,b,M,O,I,T,C,S,A),L&&(s(a,P,b,M,O,I,T),a.clip(),a.shadowOffsetX=0,a.shadowOffsetY=0,a.shadowBlur=10,a.shadowColor="gray",s(a,P,b,M+1,O+2,I,T,C,1)),a.restore())}p.prototype.drawLable=function(P,b,M,O,I){x(M.cx,M.y+M.cellMargin+b.labelMargin+M.offsetY,"flotGaugeLabel"+O,P.label.formatter?P.label.formatter(I.label,I.data[0][1]):text,P.label)},p.prototype.drawValue=function(P,b,M,O,I){x(M.cx,M.cy-P.value.font.size/2,"flotGaugeValue"+O,P.value.formatter?P.value.formatter(I.label,I.data[0][1]):text,P.value)},p.prototype.drawThresholdValues=function(P,b,M,O){E(P,b,M,"Min"+O,P.gauge.min,P.gauge.startAngle),E(P,b,M,"Max"+O,P.gauge.max,P.gauge.endAngle);for(var I=0;I<P.threshold.values.length;I++){var T=P.threshold.values[I];if(T.value>P.gauge.min&&T.value<P.gauge.max){var C=u(P,b,T.value);E(P,b,M,O+"_"+I,T.value,C)}}var S=P.gauge.neutralValue;S!=null&&S>P.gauge.min&&S<P.gauge.max&&E(P,b,M,"Neutral"+O,S,u(P,b,S))};function E(P,b,M,O,I,T){x(M.cx+(b.thresholdLabelMargin+b.thresholdLabelFontSize/2+b.radius)*Math.cos(i(T)),M.cy+(b.thresholdLabelMargin+b.thresholdLabelFontSize/2+b.radius)*Math.sin(i(T)),"flotGaugeThresholdValue"+O,P.threshold.label.formatter?P.threshold.label.formatter(I):I,P.threshold.label,T)}function x(P,b,M,O,I,T){var C=k(c).find("#"+M),S=C.length;S||(C=k("<span></span>"),C.attr("id",M),C.attr("class","flot-temp-elem"),c.append(C)),C.css("position","absolute"),C.css("top",b+"px"),C.css("white-space","nowrap"),I.font.size&&C.css("font-size",I.font.size+"px"),I.font.family&&C.css("font-family",I.font.family),I.color&&C.css("color",I.color),I.background.color&&C.css("background-color",I.background.color),I.background.opacity&&C.css("opacity",I.background.opacity),C.text(O),C.css("left",P+"px"),C.css("left",parseInt(C.css("left"))-C.width()/2+"px"),!S&&T&&(C.css("top",parseInt(C.css("top"))-C.height()/2+"px"),C.css("transform","rotate("+(180*T+90)+"deg)"))}return p}();function e(a){return typeof Logger<"u"?new Logger(a):null}function t(a,c){return c%a}function n(a,c){return Math.floor(c/a)}function i(a){return a*Math.PI}function s(a,c,o,h,f,d,p,m,v,l){if(d!==p){var y=!1;a.save(),a.beginPath(),a.arc(c,o,h,d,p,y),a.lineTo(c+(h-f)*Math.cos(p),o+(h-f)*Math.sin(p)),a.arc(c,o,h-f,p,d,!y),a.closePath(),v&&(a.lineWidth=v),m&&(a.strokeStyle=m,a.stroke()),l&&(a.fillStyle=l,a.fill()),a.restore()}}function r(a){a.hooks.processOptions.push(function(c,o){var h=e(o.series.gauges.debug);o.series.gauges.show&&(o.grid.show=!1,o.legend.show=!1);var f=o.series.gauges.threshold.values;f.sort(function(d,p){return d.value<p.value?-1:d.value>p.value?1:0})}),a.hooks.draw.push(function(c,o){var h=c.getOptions(),f=h.series.gauges,d=e(f.debug);if(f.show){var p=c.getData();if(!(!p||!p.length)){var m=new R(c,o),v=m.calculateLayout();f.debug.layout,m.drawBackground(v);for(var l=0;l<p.length;l++){var y=p[l],u=k.extend({},f,y.gauges);y.gauges&&m.calculateAutoValues(u,v.cellWidth);var D=m.calculateCellLayout(u,v,l);m.drawCellBackground(u,D),u.debug.layout,u.label.show&&m.drawLable(u,v,D,l,y),m.drawGauge(u,v,D,y.label,y.data[0][1]),u.threshold.show&&m.drawThreshold(u,v,D),u.threshold.label.show&&m.drawThresholdValues(u,v,D,l),u.value.show&&m.drawValue(u,v,D,l,y)}}}})}var g={series:{gauges:{debug:{log:!1,layout:!1,alert:!1},show:!1,layout:{margin:5,columns:3,hMargin:5,vMargin:5,square:!1},frame:{show:!0},cell:{background:{color:null},border:{show:!0,color:"black",width:1},margin:5,vAlign:"middle"},gauge:{width:"auto",startAngle:.9,endAngle:2.1,min:0,max:100,background:{color:"white"},border:{color:"lightgray",width:2},shadow:{show:!0,blur:5}},label:{show:!0,margin:"auto",background:{color:null,opacity:0},font:{size:"auto",family:"sans-serif"},color:null,formatter:function(a,c){return a}},value:{show:!0,margin:"auto",background:{color:null,opacity:0},font:{size:"auto",family:"sans-serif"},color:null,formatter:function(a,c){return parseInt(c)}},threshold:{show:!0,width:"auto",label:{show:!0,margin:"auto",background:{color:null,opacity:0},font:{size:"auto",family:",sans-serif"},color:null,formatter:function(a){return a}},values:[]}}}};k.plot.plugins.push({init:r,options:g,name:"gauge",version:"1.1.0"})})(jQuery)},54087:()=>{(function(k){k.color={},k.color.make=function(e,t,n,i){var s={};return s.r=e||0,s.g=t||0,s.b=n||0,s.a=i??1,s.add=function(r,g){for(var a=0;a<r.length;++a)s[r.charAt(a)]+=g;return s.normalize()},s.scale=function(r,g){for(var a=0;a<r.length;++a)s[r.charAt(a)]*=g;return s.normalize()},s.toString=function(){return s.a>=1?"rgb("+[s.r,s.g,s.b].join(",")+")":"rgba("+[s.r,s.g,s.b,s.a].join(",")+")"},s.normalize=function(){function r(g,a,c){return a<g?g:a>c?c:a}return s.r=r(0,parseInt(s.r),255),s.g=r(0,parseInt(s.g),255),s.b=r(0,parseInt(s.b),255),s.a=r(0,s.a,1),s},s.clone=function(){return k.color.make(s.r,s.b,s.g,s.a)},s.normalize()},k.color.extract=function(e,t){var n;do{if(n=e.css(t).toLowerCase(),n!=""&&n!="transparent")break;e=e.parent()}while(e.length&&!k.nodeName(e.get(0),"body"));return n=="rgba(0, 0, 0, 0)"&&(n="transparent"),k.color.parse(n)},k.color.parse=function(e){var t,n=k.color.make;if(t=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(e))return n(parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3],10));if(t=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(e))return n(parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3],10),parseFloat(t[4]));if(t=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(e))return n(parseFloat(t[1])*2.55,parseFloat(t[2])*2.55,parseFloat(t[3])*2.55);if(t=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(e))return n(parseFloat(t[1])*2.55,parseFloat(t[2])*2.55,parseFloat(t[3])*2.55,parseFloat(t[4]));if(t=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(e))return n(parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16));if(t=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(e))return n(parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16));var i=k.trim(e).toLowerCase();return i=="transparent"?n(255,255,255,0):(t=R[i]||[0,0,0],n(t[0],t[1],t[2]))};var R={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}})(jQuery),function(k){var R=Object.prototype.hasOwnProperty;k.fn.detach||(k.fn.detach=function(){return this.each(function(){this.parentNode&&this.parentNode.removeChild(this)})});function e(i,s){var r=s.children("."+i)[0];if(r==null&&(r=document.createElement("canvas"),r.className=i,k(r).css({direction:"ltr",position:"absolute",left:0,top:0}).appendTo(s),!r.getContext))if(window.G_vmlCanvasManager)r=window.G_vmlCanvasManager.initElement(r);else throw new Error("Canvas is not available. If you're using IE with a fall-back such as Excanvas, then there's either a mistake in your conditional include, or the page has no DOCTYPE and is rendering in Quirks Mode.");this.element=r;var g=this.context=r.getContext("2d"),a=window.devicePixelRatio||1,c=g.webkitBackingStorePixelRatio||g.mozBackingStorePixelRatio||g.msBackingStorePixelRatio||g.oBackingStorePixelRatio||g.backingStorePixelRatio||1;this.pixelRatio=a/c,this.resize(s.width(),s.height()),this.textContainer=null,this.text={},this._textCache={},this._textSizeCache=window.flotTextSizeCache=window.flotTextSizeCache||{}}e.prototype.resize=function(i,s){if(i<=0||s<=0)throw new Error("Invalid dimensions for plot, width = "+i+", height = "+s);var r=this.element,g=this.context,a=this.pixelRatio;this.width!=i&&(r.width=i*a,r.style.width=i+"px",this.width=i),this.height!=s&&(r.height=s*a,r.style.height=s+"px",this.height=s),g.restore(),g.save(),g.scale(a,a)},e.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},e.prototype.render=function(){var i=this._textCache;for(var s in i)if(R.call(i,s)){var r=this.getTextLayer(s),g=i[s];r.hide();for(var a in g)if(R.call(g,a)){var c=g[a];for(var o in c)if(R.call(c,o)){for(var h=c[o].positions,f=0,d;d=h[f];f++)d.active?d.rendered||(r.append(d.element),d.rendered=!0):(h.splice(f--,1),d.rendered&&d.element.detach());h.length==0&&delete c[o]}}r.show()}},e.prototype.getTextLayer=function(i){var s=this.text[i];return s==null&&(this.textContainer==null&&(this.textContainer=k("<div class='flot-text flot-temp-elem'></div>").css({position:"absolute",top:0,left:0,bottom:0,right:0,"font-size":"smaller",color:"#545454"}).insertAfter(this.element)),s=this.text[i]=k("<div></div>").addClass(i).css({position:"absolute",top:0,left:0,bottom:0,right:0}).appendTo(this.textContainer)),s},e.prototype.getTextInfo=function(i,s,r,g,a){var c,o,h,f;if(s=""+s,typeof r=="object"?c=r.style+" "+r.variant+" "+r.weight+" "+r.size+"px/"+r.lineHeight+"px "+r.family:c=r,o=this._textCache[i],o==null&&(o=this._textCache[i]={}),h=o[c],h==null&&(h=o[c]={}),f=h[s],f==null){var d=k("<div></div>").html(s).css({position:"absolute","max-width":a,top:-9999}).appendTo(this.getTextLayer(i));typeof r=="object"?d.css({font:c,color:r.color}):typeof r=="string"&&d.addClass(r),f=h[s]={element:d,positions:[]};var p=this._textSizeCache[s];p?(f.width=p.width,f.height=p.height):(f.width=d.outerWidth(!0),f.height=d.outerHeight(!0),this._textSizeCache[s]={width:f.width,height:f.height}),d.detach()}return f},e.prototype.addText=function(i,s,r,g,a,c,o,h,f){var d=this.getTextInfo(i,g,a,c,o),p=d.positions;h=="center"?s-=d.width/2:h=="right"&&(s-=d.width),f=="middle"?r-=d.height/2:f=="bottom"&&(r-=d.height);for(var m=0,v;v=p[m];m++)if(v.x==s&&v.y==r){v.active=!0;return}v={active:!0,rendered:!1,element:p.length?d.element.clone():d.element,x:s,y:r},p.push(v),v.element.css({top:Math.round(r),left:Math.round(s),"text-align":h})},e.prototype.removeText=function(i,s,r,g,a,c){if(g==null){var o=this._textCache[i];if(o!=null){for(var h in o)if(R.call(o,h)){var f=o[h];for(var d in f)if(R.call(f,d))for(var p=f[d].positions,m=0,v;v=p[m];m++)v.active=!1}}}else for(var p=this.getTextInfo(i,g,a,c).positions,m=0,v;v=p[m];m++)v.x==s&&v.y==r&&(v.active=!1)};function t(i,s,r,g){var a=[],c={colors:["#edc240","#afd8f8","#cb4b4b","#4da74d","#9440ed"],legend:{show:!0,noColumns:1,labelFormatter:null,labelBoxBorderColor:"#ccc",container:null,position:"ne",margin:5,backgroundColor:null,backgroundOpacity:.85,sorted:null},xaxis:{show:null,position:"bottom",mode:null,font:null,color:null,tickColor:null,transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,reserveSpace:null,tickLength:null,alignTicksWithAxis:null,tickDecimals:null,tickSize:null,minTickSize:null},yaxis:{autoscaleMargin:.02,position:"left"},xaxes:[],yaxes:[],series:{points:{show:!1,radius:3,lineWidth:2,fill:!0,fillColor:"#ffffff",symbol:"circle"},lines:{lineWidth:2,fill:!1,fillColor:null,steps:!1},bars:{show:!1,lineWidth:2,barWidth:1,fill:!0,fillColor:null,align:"left",horizontal:!1,zero:!0},shadowSize:3,highlightColor:null},grid:{show:!0,aboveData:!1,color:"#545454",backgroundColor:null,borderColor:null,tickColor:null,margin:0,labelMargin:5,eventSectionHeight:0,axisMargin:8,borderWidth:2,minBorderMargin:null,markings:null,markingsColor:"#f4f4f4",markingsLineWidth:2,clickable:!1,hoverable:!1,autoHighlight:!0,mouseActiveRadius:10},interaction:{redrawOverlayInterval:16.666666666666668},hooks:{}},o=null,h=null,f=null,d=null,p=null,m=[],v=[],l={left:0,right:0,top:0,bottom:0},y=0,u=0,D={processOptions:[],processRawData:[],processDatapoints:[],processOffset:[],processRange:[],drawBackground:[],drawSeries:[],draw:[],bindEvents:[],drawOverlay:[],shutdown:[]},E=this;E.setData=M,E.setupGrid=X,E.draw=ne,E.getPlaceholder=function(){return i},E.getCanvas=function(){return o.element},E.getPlotOffset=function(){return l},E.width=function(){return y},E.height=function(){return u},E.offset=function(){var pe=f.offset();return pe.left+=l.left,pe.top+=l.top,pe},E.getData=function(){return a},E.getAxes=function(){var pe={},Ee;return k.each(m.concat(v),function(me,ve){ve&&(pe[ve.direction+(ve.n!=1?ve.n:"")+"axis"]=ve)}),pe},E.getXAxes=function(){return m},E.getYAxes=function(){return v},E.c2p=C,E.p2c=S,E.getOptions=function(){return c},E.highlight=qe,E.unhighlight=dt,E.triggerRedrawOverlay=$e,E.pointOffset=function(pe){return{left:parseInt(m[I(pe,"x")-1].p2c(+pe.x)+l.left,10),top:parseInt(v[I(pe,"y")-1].p2c(+pe.y)+l.top,10)}},E.shutdown=B,E.destroy=function(){B(),i.removeData("plot").empty(),a=[],c=null,o=null,h=null,f=null,d=null,p=null,m=[],v=[],D=null,ge=[],E=null},E.resize=function(){var pe=i.width(),Ee=i.height();o.resize(pe,Ee),h.resize(pe,Ee)},E.hooks=D,P(E),b(r),F(),M(s),X(),ne(),w();function x(pe,Ee){Ee=[E].concat(Ee);for(var me=0;me<pe.length;++me)pe[me].apply(this,Ee)}function P(){for(var pe={Canvas:e},Ee=0;Ee<g.length;++Ee){var me=g[Ee];me.init(E,pe),me.options&&k.extend(!0,c,me.options)}}function b(pe){k.extend(!0,c,pe),pe&&pe.colors&&(c.colors=pe.colors),c.xaxis.color==null&&(c.xaxis.color=k.color.parse(c.grid.color).scale("a",.22).toString()),c.yaxis.color==null&&(c.yaxis.color=k.color.parse(c.grid.color).scale("a",.22).toString()),c.xaxis.tickColor==null&&(c.xaxis.tickColor=c.grid.tickColor||c.xaxis.color),c.yaxis.tickColor==null&&(c.yaxis.tickColor=c.grid.tickColor||c.yaxis.color),c.grid.borderColor==null&&(c.grid.borderColor=c.grid.color),c.grid.tickColor==null&&(c.grid.tickColor=k.color.parse(c.grid.color).scale("a",.22).toString());var Ee,me,ve,Se=i.css("font-size"),Ie=Se?+Se.replace("px",""):13,Oe={style:i.css("font-style"),size:Math.round(.8*Ie),variant:i.css("font-variant"),weight:i.css("font-weight"),family:i.css("font-family")};for(ve=c.xaxes.length||1,Ee=0;Ee<ve;++Ee)me=c.xaxes[Ee],me&&!me.tickColor&&(me.tickColor=me.color),me=k.extend(!0,{},c.xaxis,me),c.xaxes[Ee]=me,me.font&&(me.font=k.extend({},Oe,me.font),me.font.color||(me.font.color=me.color),me.font.lineHeight||(me.font.lineHeight=Math.round(me.font.size*1.15)));for(ve=c.yaxes.length||1,Ee=0;Ee<ve;++Ee)me=c.yaxes[Ee],me&&!me.tickColor&&(me.tickColor=me.color),me=k.extend(!0,{},c.yaxis,me),c.yaxes[Ee]=me,me.font&&(me.font=k.extend({},Oe,me.font),me.font.color||(me.font.color=me.color),me.font.lineHeight||(me.font.lineHeight=Math.round(me.font.size*1.15)));for(c.xaxis.noTicks&&c.xaxis.ticks==null&&(c.xaxis.ticks=c.xaxis.noTicks),c.yaxis.noTicks&&c.yaxis.ticks==null&&(c.yaxis.ticks=c.yaxis.noTicks),c.x2axis&&(c.xaxes[1]=k.extend(!0,{},c.xaxis,c.x2axis),c.xaxes[1].position="top",c.x2axis.min==null&&(c.xaxes[1].min=null),c.x2axis.max==null&&(c.xaxes[1].max=null)),c.y2axis&&(c.yaxes[1]=k.extend(!0,{},c.yaxis,c.y2axis),c.yaxes[1].position="right",c.y2axis.min==null&&(c.yaxes[1].min=null),c.y2axis.max==null&&(c.yaxes[1].max=null)),c.grid.coloredAreas&&(c.grid.markings=c.grid.coloredAreas),c.grid.coloredAreasColor&&(c.grid.markingsColor=c.grid.coloredAreasColor),c.lines&&k.extend(!0,c.series.lines,c.lines),c.points&&k.extend(!0,c.series.points,c.points),c.bars&&k.extend(!0,c.series.bars,c.bars),c.shadowSize!=null&&(c.series.shadowSize=c.shadowSize),c.highlightColor!=null&&(c.series.highlightColor=c.highlightColor),Ee=0;Ee<c.xaxes.length;++Ee)A(m,Ee+1).options=c.xaxes[Ee];for(Ee=0;Ee<c.yaxes.length;++Ee)A(v,Ee+1).options=c.yaxes[Ee];for(var Re in D)c.hooks[Re]&&c.hooks[Re].length&&(D[Re]=D[Re].concat(c.hooks[Re]));x(D.processOptions,[c])}function M(pe){a=O(pe),L(),N()}function O(pe){for(var Ee=[],me=0;me<pe.length;++me){var ve=k.extend(!0,{},c.series);pe[me].data!=null?(ve.data=pe[me].data,delete pe[me].data,k.extend(!0,ve,pe[me]),pe[me].data=ve.data):ve.data=pe[me],Ee.push(ve)}return Ee}function I(pe,Ee){var me=pe[Ee+"axis"];return typeof me=="object"&&(me=me.n),typeof me!="number"&&(me=1),me}function T(){return k.grep(m.concat(v),function(pe){return pe})}function C(pe){var Ee={},me,ve;for(me=0;me<m.length;++me)ve=m[me],ve&&(Ee["x"+ve.n]=ve.c2p(pe.left));for(me=0;me<v.length;++me)ve=v[me],ve&&(Ee["y"+ve.n]=ve.c2p(pe.top));return Ee.x1!==void 0&&(Ee.x=Ee.x1),Ee.y1!==void 0&&(Ee.y=Ee.y1),Ee}function S(pe){var Ee={},me,ve,Se;for(me=0;me<m.length;++me)if(ve=m[me],ve&&ve.used&&(Se="x"+ve.n,pe[Se]==null&&ve.n==1&&(Se="x"),pe[Se]!=null)){Ee.left=ve.p2c(pe[Se]);break}for(me=0;me<v.length;++me)if(ve=v[me],ve&&ve.used&&(Se="y"+ve.n,pe[Se]==null&&ve.n==1&&(Se="y"),pe[Se]!=null)){Ee.top=ve.p2c(pe[Se]);break}return Ee}function A(pe,Ee){return pe[Ee-1]||(pe[Ee-1]={n:Ee,direction:pe==m?"x":"y",options:k.extend(!0,{},pe==m?c.xaxis:c.yaxis)}),pe[Ee-1]}function L(){var pe=a.length,Ee=-1,me;for(me=0;me<a.length;++me){var ve=a[me].color;ve!=null&&(pe--,typeof ve=="number"&&ve>Ee&&(Ee=ve))}pe<=Ee&&(pe=Ee+1);var Se,Ie=[],Oe=c.colors,Re=Oe.length,he=0;for(me=0;me<pe;me++)Se=k.color.parse(Oe[me%Re]||"#666"),me%Re==0&&me&&(he>=0?he<.5?he=-he-.2:he=0:he=-he),Ie[me]=Se.scale("rgb",1+he);var Ce=0,We;for(me=0;me<a.length;++me){if(We=a[me],We.color==null?(We.color=Ie[Ce].toString(),++Ce):typeof We.color=="number"&&(We.color=Ie[We.color].toString()),We.lines.show==null){var et,rt=!0;for(et in We)if(We[et]&&We[et].show){rt=!1;break}rt&&(We.lines.show=!0)}We.lines.zero==null&&(We.lines.zero=!!We.lines.fill),We.xaxis=A(m,I(We,"x")),We.yaxis=A(v,I(We,"y"))}}function N(){var pe=Number.POSITIVE_INFINITY,Ee=Number.NEGATIVE_INFINITY,me=Number.MAX_VALUE,ve,Se,Ie,Oe,Re,he,Ce,We,et,rt,nt,gt,xt,St,zt,Nt;function Vt(mn,Pn,fn){Pn<mn.datamin&&Pn!=-me&&(mn.datamin=Pn),fn>mn.datamax&&fn!=me&&(mn.datamax=fn)}for(k.each(T(),function(mn,Pn){Pn.datamin=pe,Pn.datamax=Ee,Pn.used=!1}),ve=0;ve<a.length;++ve)he=a[ve],he.datapoints={points:[]},x(D.processRawData,[he,he.data,he.datapoints]);for(ve=0;ve<a.length;++ve){if(he=a[ve],zt=he.data,Nt=he.datapoints.format,!Nt){if(Nt=[],Nt.push({x:!0,number:!0,required:!0}),Nt.push({y:!0,number:!0,required:!0}),he.stack||he.bars.show||he.lines.show&&he.lines.fill){var en=!!(he.bars.show&&he.bars.zero||he.lines.show&&he.lines.zero);Nt.push({y:!0,number:!0,required:!1,defaultValue:0,autoscale:en}),he.bars.horizontal&&(delete Nt[Nt.length-1].y,Nt[Nt.length-1].x=!0)}he.datapoints.format=Nt}if(he.datapoints.pointsize==null){he.datapoints.pointsize=Nt.length,We=he.datapoints.pointsize,Ce=he.datapoints.points;var Je=he.lines.show&&he.lines.steps;for(he.xaxis.used=he.yaxis.used=!0,Se=Ie=0;Se<zt.length;++Se,Ie+=We){St=zt[Se];var ct=St==null;if(!ct)for(Oe=0;Oe<We;++Oe)gt=St[Oe],xt=Nt[Oe],xt&&(xt.number&&gt!=null&&(gt=+gt,isNaN(gt)?gt=null:gt==1/0?gt=me:gt==-1/0&&(gt=-me)),gt==null&&(xt.required&&(ct=!0),xt.defaultValue!=null&&(gt=xt.defaultValue))),Ce[Ie+Oe]=gt;if(ct)for(Oe=0;Oe<We;++Oe)gt=Ce[Ie+Oe],gt!=null&&(xt=Nt[Oe],xt.autoscale!==!1&&(xt.x&&Vt(he.xaxis,gt,gt),xt.y&&Vt(he.yaxis,gt,gt))),Ce[Ie+Oe]=null;if(Je&&Ie>0&&(!ct||Ce[Ie-We]!=null)){for(Oe=0;Oe<We;++Oe)Ce[Ie+We+Oe]=Ce[Ie+Oe];Ce[Ie+1]=Ce[Ie-We+1]||0,ct&&(Ce[Ie]=St[0]),Ie+=We}}}}for(ve=0;ve<a.length;++ve){if(he=a[ve],Ce=he.datapoints.points,We=he.datapoints.pointsize,he.transform==="negative-Y")for(Se=0;Se<Ce.length;Se+=We)Ce[Se]!=null&&(gt=Ce[Se+1],Ce[Se+1]=-gt);x(D.processDatapoints,[he,he.datapoints])}for(ve=0;ve<a.length;++ve){he=a[ve],Ce=he.datapoints.points,We=he.datapoints.pointsize,Nt=he.datapoints.format;var ot=pe,Qe=pe,pt=Ee,Pt=Ee;for(Se=0;Se<Ce.length;Se+=We)if(Ce[Se]!=null)for(Oe=0;Oe<We;++Oe)gt=Ce[Se+Oe],xt=Nt[Oe],!(!xt||xt.autoscale===!1||gt==me||gt==-me)&&(xt.x&&(gt<ot&&(ot=gt),gt>pt&&(pt=gt)),xt.y&&(gt<Qe&&(Qe=gt),gt>Pt&&(Pt=gt)));if(he.bars.show){var At;switch(he.bars.align){case"left":At=0;break;case"right":At=-he.bars.barWidth;break;default:At=-he.bars.barWidth/2}he.bars.horizontal?(Qe+=At,Pt+=At+he.bars.barWidth):(ot+=At,pt+=At+he.bars.barWidth)}Vt(he.xaxis,ot,pt),Vt(he.yaxis,Qe,Pt)}k.each(T(),function(mn,Pn){Pn.datamin==pe&&(Pn.datamin=null),Pn.datamax==Ee&&(Pn.datamax=null)})}function F(){i.find(".flot-temp-elem").remove(),i.css("position")=="static"&&i.css("position","relative"),o=new e("flot-base",i),h=new e("flot-overlay",i),d=o.context,p=h.context,f=k(h.element).unbind();var pe=i.data("plot");pe&&(pe.shutdown(),h.clear()),i.data("plot",E)}function w(){c.grid.hoverable&&(f.mousemove(Ye),f.bind("mouseleave",je),k(document).bind("touchend",Ne)),c.grid.clickable&&f.click(Ze),x(D.bindEvents,[f])}function B(){Te&&clearTimeout(Te),f.unbind("mousemove",Ye),f.unbind("mouseleave",je),f.unbind("click",Ze),k(document).unbind("touchend",Ne),x(D.shutdown,[f])}function U(pe){function Ee(Oe){return Oe}var me,ve,Se=pe.options.transform||Ee,Ie=pe.options.inverseTransform;pe.direction=="x"?(me=pe.scale=y/Math.abs(Se(pe.max)-Se(pe.min)),ve=Math.min(Se(pe.max),Se(pe.min))):(me=pe.scale=u/Math.abs(Se(pe.max)-Se(pe.min)),me=-me,ve=Math.max(Se(pe.max),Se(pe.min))),Se==Ee?pe.p2c=function(Oe){return(Oe-ve)*me}:pe.p2c=function(Oe){return(Se(Oe)-ve)*me},Ie?pe.c2p=function(Oe){return Ie(ve+Oe/me)}:pe.c2p=function(Oe){return ve+Oe/me}}function K(pe){for(var Ee=pe.options,me=pe.ticks||[],ve=Ee.labelWidth||0,Se=Ee.labelHeight||0,Ie=ve||(pe.direction=="x"?Math.floor(o.width/(me.length||1)):null),Oe=pe.direction+"Axis "+pe.direction+pe.n+"Axis",Re="flot-"+pe.direction+"-axis flot-"+pe.direction+pe.n+"-axis "+Oe,he=Ee.font||"flot-tick-label tickLabel",Ce=0;Ce<me.length;++Ce){var We=me[Ce];if(We.label){var et=o.getTextInfo(Re,We.label,he,null,Ie);ve=Math.max(ve,et.width+1),Se=Math.max(Se,et.height)}}pe.labelWidth=Ee.labelWidth||ve,pe.labelHeight=Ee.labelHeight||Se}function V(pe){var Ee=pe.labelWidth,me=pe.labelHeight,ve=pe.options.position,Se=pe.direction==="x",Ie=pe.options.tickLength,Oe=c.grid.axisMargin,Re=c.grid.labelMargin,he=c.grid.eventSectionHeight,Ce=!0,We=!0,et=!0,rt=!1;k.each(Se?m:v,function(nt,gt){gt&&(gt.show||gt.reserveSpace)&&(gt===pe?rt=!0:gt.options.position===ve&&(rt?We=!1:Ce=!1),rt||(et=!1))}),We&&(Oe=0),Ie==null&&(Ie=et?"full":5),isNaN(+Ie)||(Re+=+Ie),Se?(me+=Re,me+=he,ve=="bottom"?(l.bottom+=me+Oe,pe.box={top:o.height-l.bottom,height:me}):(pe.box={top:l.top+Oe,height:me},l.top+=me+Oe)):(Ee+=Re,ve=="left"?(pe.box={left:l.left+Oe,width:Ee},l.left+=Ee+Oe):(l.right+=Ee+Oe,pe.box={left:o.width-l.right,width:Ee})),pe.position=ve,pe.tickLength=Ie,pe.box.padding=Re,pe.box.eventSectionPadding=he,pe.innermost=Ce}function H(pe){pe.direction=="x"?(pe.box.left=l.left-pe.labelWidth/2,pe.box.width=o.width-l.left-l.right+pe.labelWidth):(pe.box.top=l.top-pe.labelHeight/2,pe.box.height=o.height-l.bottom-l.top+pe.labelHeight)}function Y(){var pe=c.grid.minBorderMargin,Ee,me;if(pe==null)for(pe=0,me=0;me<a.length;++me)pe=Math.max(pe,2*(a[me].points.radius+a[me].points.lineWidth/2));var ve={left:pe,right:pe,top:pe,bottom:pe};k.each(T(),function(Se,Ie){Ie.reserveSpace&&Ie.ticks&&Ie.ticks.length&&(Ie.direction==="x"?(ve.left=Math.max(ve.left,Ie.labelWidth/2),ve.right=Math.max(ve.right,Ie.labelWidth/2)):(ve.bottom=Math.max(ve.bottom,Ie.labelHeight/2),ve.top=Math.max(ve.top,Ie.labelHeight/2)))}),l.left=Math.ceil(Math.max(ve.left,l.left)),l.right=Math.ceil(Math.max(ve.right,l.right)),l.top=Math.ceil(Math.max(ve.top,l.top)),l.bottom=Math.ceil(Math.max(ve.bottom,l.bottom))}function X(){var pe,Ee=T(),me=c.grid.show;for(var ve in l){var Se=c.grid.margin||0;l[ve]=typeof Se=="number"?Se:Se[ve]||0}x(D.processOffset,[l]);for(var ve in l)typeof c.grid.borderWidth=="object"?l[ve]+=me?c.grid.borderWidth[ve]:0:l[ve]+=me?c.grid.borderWidth:0;if(k.each(Ee,function(Re,he){var Ce=he.options;he.show=Ce.show==null?he.used:Ce.show,he.reserveSpace=Ce.reserveSpace==null?he.show:Ce.reserveSpace,J(he)}),x(D.processRange,[]),me){for(var Ie=k.grep(Ee,function(Re){return Re.show||Re.reserveSpace}),Oe=!1,pe=0;pe<2&&(k.each(Ie,function(he,Ce){ae(Ce),j(Ce),Oe=te(Ce,Ce.ticks)||Oe,K(Ce)}),Oe&&D.processRange.length>0);pe++)x(D.processRange,[]),Oe=!1;for(pe=Ie.length-1;pe>=0;--pe)V(Ie[pe]);Y(),k.each(Ie,function(Re,he){H(he)})}y=o.width-l.left-l.right,u=o.height-l.bottom-l.top,k.each(Ee,function(Re,he){U(he)}),me&&se(),De()}function J(pe){var Ee=pe.options,me=+(Ee.min!=null?Ee.min:pe.datamin),ve=+(Ee.max!=null?Ee.max:pe.datamax),Se=ve-me;if(Se==0){var Ie=.25,Oe=Math.abs(ve==0?1:ve*Ie);Ee.min==null&&(me-=Oe),(Ee.max==null||Ee.min!=null)&&(ve+=Oe)}else{var Re=Ee.autoscaleMargin;Re!=null&&(Ee.min==null&&(me-=Se*Re,me<0&&pe.datamin!=null&&pe.datamin>=0&&(me=0)),Ee.max==null&&(ve+=Se*Re,ve>0&&pe.datamax!=null&&pe.datamax<=0&&(ve=0)))}pe.min=me,pe.max=ve}function q(pe){if(pe=Math.abs(String(pe).replace(".","")),pe==0)return 0;for(;pe!=0&&pe%10==0;)pe/=10;return Math.floor(Math.log(pe)/Math.LN10)+1}function ae(pe){var Ee=pe.options,me;typeof Ee.ticks=="number"&&Ee.ticks>0?me=Ee.ticks:me=.3*Math.sqrt(pe.direction=="x"?o.width:o.height);var ve=(pe.max-pe.min)/me,Se=-Math.floor(Math.log(ve)/Math.LN10),Ie=Ee.tickDecimals;Ie!=null&&Se>Ie&&(Se=Ie);var Oe=Math.pow(10,-Se),Re=ve/Oe,he;if(Re<1.5?he=1:Re<3?(he=2,Re>2.25&&(Ie==null||Se+1<=Ie)&&(he=2.5,++Se)):Re<7.5?he=5:he=10,he*=Oe,Ee.minTickSize!=null&&he<Ee.minTickSize&&(he=Ee.minTickSize),pe.delta=ve,pe.tickDecimals=Math.max(0,Ie??Se),pe.tickSize=Ee.tickSize||he,Ee.mode=="time"&&!pe.tickGenerator)throw new Error("Time mode requires the flot.time plugin.");if(pe.tickGenerator||(pe.tickGenerator=function(nt){var gt=[],xt=n(nt.min,nt.tickSize),St=0,zt=Number.NaN,Nt;do Nt=zt,zt=xt+St*nt.tickSize,gt.push(zt),++St;while(zt<nt.max&&zt!=Nt);return gt},pe.tickFormatter=function(nt,gt){var xt=gt.tickDecimals?Math.pow(10,gt.tickDecimals):1,St=""+Math.round(nt*xt)/xt;if(gt.tickDecimals!=null){var zt=St.indexOf("."),Nt=zt==-1?0:St.length-zt-1;if(Nt<gt.tickDecimals)return(Nt?St:St+".")+(""+xt).substr(1,gt.tickDecimals-Nt)}return St}),k.isFunction(Ee.tickFormatter)&&(pe.tickFormatter=function(nt,gt){return""+Ee.tickFormatter(nt,gt)}),Ee.alignTicksWithAxis!=null){var Ce=(pe.direction=="x"?m:v)[Ee.alignTicksWithAxis-1];if(Ce&&Ce.used&&Ce!=pe){var We=pe.tickGenerator(pe);if(We.length>0&&(Ee.min==null&&(pe.min=Math.min(pe.min,We[0])),Ee.max==null&&We.length>1&&(pe.max=Math.max(pe.max,We[We.length-1]))),pe.tickGenerator=function(nt){var gt=[],xt,St;for(St=0;St<Ce.ticks.length;++St)xt=(Ce.ticks[St].v-Ce.min)/(Ce.max-Ce.min),xt=nt.min+xt*(nt.max-nt.min),gt.push(xt);return gt},!pe.mode&&Ee.tickDecimals==null){var et=Math.max(0,-Math.floor(Math.log(pe.delta)/Math.LN10)+1),rt=pe.tickGenerator(pe);rt.length>1&&/\..*0$/.test((rt[1]-rt[0]).toFixed(et))||(pe.tickDecimals=et)}}}}function j(pe){var Ee=pe.options.ticks,me=[];Ee==null||typeof Ee=="number"&&Ee>0?me=pe.tickGenerator(pe):Ee&&(k.isFunction(Ee)?me=Ee(pe):me=Ee);var ve,Se;for(pe.ticks=[],ve=0;ve<me.length;++ve){var Ie=null,Oe=me[ve];typeof Oe=="object"?(Se=+Oe[0],Oe.length>1&&(Ie=Oe[1])):Se=+Oe,Ie==null&&(Ie=pe.tickFormatter(Se,pe)),isNaN(Se)||pe.ticks.push({v:Se,label:Ie})}}function te(pe,Ee){var me=!1;return pe.options.autoscaleMargin&&Ee.length>0&&(pe.options.min==null&&(pe.min=Math.min(pe.min,Ee[0].v),me=!0),pe.options.max==null&&Ee.length>1&&(pe.max=Math.max(pe.max,Ee[Ee.length-1].v),me=!0)),me}function ne(){o.clear(),x(D.drawBackground,[d]);var pe=c.grid;pe.show&&pe.backgroundColor&&z(),pe.show&&!pe.aboveData&&ee();for(var Ee=0;Ee<a.length;++Ee)x(D.drawSeries,[d,a[Ee]]),Z(a[Ee]);x(D.draw,[d]),pe.show&&pe.aboveData&&ee(),o.render(),$e()}function le(pe,Ee){for(var me,ve,Se,Ie,Oe=T(),Re=0;Re<Oe.length;++Re)if(me=Oe[Re],me.direction==Ee&&(Ie=Ee+me.n+"axis",!pe[Ie]&&me.n==1&&(Ie=Ee+"axis"),pe[Ie])){ve=pe[Ie].from,Se=pe[Ie].to;break}if(pe[Ie]||(me=Ee=="x"?m[0]:v[0],ve=pe[Ee+"1"],Se=pe[Ee+"2"]),ve!=null&&Se!=null&&ve>Se){var he=ve;ve=Se,Se=he}return{from:ve,to:Se,axis:me}}function z(){d.save(),d.translate(l.left,l.top),d.fillStyle=Ve(c.grid.backgroundColor,u,0,"rgba(255, 255, 255, 0)"),d.fillRect(0,0,y,u),d.restore()}function ee(){var pe,Ee,me,ve;d.save(),d.translate(l.left,l.top);var Se=c.grid.markings;if(Se)for(k.isFunction(Se)&&(Ee=E.getAxes(),Ee.xmin=Ee.xaxis.min,Ee.xmax=Ee.xaxis.max,Ee.ymin=Ee.yaxis.min,Ee.ymax=Ee.yaxis.max,Se=Se(Ee)),pe=0;pe<Se.length;++pe){var Ie=Se[pe],Oe=le(Ie,"x"),Re=le(Ie,"y");if(Oe.from==null&&(Oe.from=Oe.axis.min),Oe.to==null&&(Oe.to=Oe.axis.max),Re.from==null&&(Re.from=Re.axis.min),Re.to==null&&(Re.to=Re.axis.max),!(Oe.to<Oe.axis.min||Oe.from>Oe.axis.max||Re.to<Re.axis.min||Re.from>Re.axis.max)){Oe.from=Math.max(Oe.from,Oe.axis.min),Oe.to=Math.min(Oe.to,Oe.axis.max),Re.from=Math.max(Re.from,Re.axis.min),Re.to=Math.min(Re.to,Re.axis.max);var he=Oe.from===Oe.to,Ce=Re.from===Re.to;if(!(he&&Ce))if(Oe.from=Math.floor(Oe.axis.p2c(Oe.from)),Oe.to=Math.floor(Oe.axis.p2c(Oe.to)),Re.from=Math.floor(Re.axis.p2c(Re.from)),Re.to=Math.floor(Re.axis.p2c(Re.to)),he||Ce){var We=Ie.lineWidth||c.grid.markingsLineWidth,et=We%2?.5:0;d.beginPath(),d.strokeStyle=Ie.color||c.grid.markingsColor,d.lineWidth=We,he?(d.moveTo(Oe.to+et,Re.from),d.lineTo(Oe.to+et,Re.to)):(d.moveTo(Oe.from,Re.to+et),d.lineTo(Oe.to,Re.to+et)),d.stroke()}else d.fillStyle=Ie.color||c.grid.markingsColor,d.fillRect(Oe.from,Re.to,Oe.to-Oe.from,Re.from-Re.to)}}Ee=T(),me=c.grid.borderWidth;for(var rt=0;rt<Ee.length;++rt){var nt=Ee[rt],gt=nt.box,xt=nt.tickLength,St,zt,Nt,Vt;if(!(!nt.show||nt.ticks.length==0)){for(d.lineWidth=1,nt.direction=="x"?(St=0,xt=="full"?zt=nt.position=="top"?0:u:zt=gt.top-l.top+(nt.position=="top"?gt.height:0)):(zt=0,xt=="full"?St=nt.position=="left"?0:y:St=gt.left-l.left+(nt.position=="left"?gt.width:0)),nt.innermost||(d.strokeStyle=nt.options.color,d.beginPath(),Nt=Vt=0,nt.direction=="x"?Nt=y+1:Vt=u+1,d.lineWidth==1&&(nt.direction=="x"?zt=Math.floor(zt)+.5:St=Math.floor(St)+.5),d.moveTo(St,zt),d.lineTo(St+Nt,zt+Vt),d.stroke()),d.strokeStyle=nt.options.tickColor,d.beginPath(),pe=0;pe<nt.ticks.length;++pe){var en=nt.ticks[pe].v;Nt=Vt=0,!(isNaN(en)||en<nt.min||en>nt.max||xt=="full"&&(typeof me=="object"&&me[nt.position]>0||me>0)&&(en==nt.min||en==nt.max))&&(nt.direction=="x"?(St=nt.p2c(en),Vt=xt=="full"?-u:xt,nt.position=="top"&&(Vt=-Vt)):(zt=nt.p2c(en),Nt=xt=="full"?-y:xt,nt.position=="left"&&(Nt=-Nt)),d.lineWidth==1&&(nt.direction=="x"?St=Math.floor(St)+.5:zt=Math.floor(zt)+.5),d.moveTo(St,zt),d.lineTo(St+Nt,zt+Vt))}d.stroke()}}me&&(ve=c.grid.borderColor,typeof me=="object"||typeof ve=="object"?(typeof me!="object"&&(me={top:me,right:me,bottom:me,left:me}),typeof ve!="object"&&(ve={top:ve,right:ve,bottom:ve,left:ve}),me.top>0&&(d.strokeStyle=ve.top,d.lineWidth=me.top,d.beginPath(),d.moveTo(0-me.left,0-me.top/2),d.lineTo(y,0-me.top/2),d.stroke()),me.right>0&&(d.strokeStyle=ve.right,d.lineWidth=me.right,d.beginPath(),d.moveTo(y+me.right/2,0-me.top),d.lineTo(y+me.right/2,u),d.stroke()),me.bottom>0&&(d.strokeStyle=ve.bottom,d.lineWidth=me.bottom,d.beginPath(),d.moveTo(y+me.right,u+me.bottom/2),d.lineTo(0,u+me.bottom/2),d.stroke()),me.left>0&&(d.strokeStyle=ve.left,d.lineWidth=me.left,d.beginPath(),d.moveTo(0-me.left/2,u+me.bottom),d.lineTo(0-me.left/2,0),d.stroke())):(d.lineWidth=me,d.strokeStyle=c.grid.borderColor,d.strokeRect(-me/2,-me/2,y+me,u+me))),d.restore()}function se(){k.each(T(),function(pe,Ee){var me=Ee.box,ve=Ee.direction+"Axis "+Ee.direction+Ee.n+"Axis",Se="flot-"+Ee.direction+"-axis flot-"+Ee.direction+Ee.n+"-axis "+ve,Ie=Ee.options.font||"flot-tick-label tickLabel",Oe,Re,he,Ce,We;if(o.removeText(Se),!(!Ee.show||Ee.ticks.length==0))for(var et=0;et<Ee.ticks.length;++et)Oe=Ee.ticks[et],!(!Oe.label||Oe.v<Ee.min||Oe.v>Ee.max)&&(Ee.direction=="x"?(Ce="center",Re=l.left+Ee.p2c(Oe.v),Ee.position=="bottom"?he=me.top+me.padding+me.eventSectionPadding:(he=me.top+me.height-me.padding,We="bottom")):(We="middle",he=l.top+Ee.p2c(Oe.v),Ee.position=="left"?(Re=me.left+me.width-me.padding,Ce="right"):Re=me.left+me.padding),o.addText(Se,Re,he,Oe.label,Ie,null,null,Ce,We))})}function ie(pe){for(var Ee=[],me=null,ve=null,Se=pe.datapoints,Ie=[],Oe=0;Oe<Se.pointsize-2;Oe++)Ie.push(0);for(var Re=0;Re<Se.points.length;Re+=Se.pointsize){var he=Se.points[Re],Ce=Se.points[Re+1];Re===Se.points.length-Se.pointsize?ve=null:ve=Se.points[Re+Se.pointsize],he!==null&&Ce!==null&&me===null&&ve===null&&(Ee.push(he),Ee.push(Ce),Ee.push.apply(Ee,Ie)),me=he}var We=Se.points;Se.points=Ee,pe.points.radius=pe.lines.lineWidth/2,ce(pe),Se.points=We}function Z(pe){pe.lines.show&&(oe(pe),!pe.points.show&&!pe.bars.show&&ie(pe)),pe.bars.show&&re(pe),pe.points.show&&ce(pe)}function oe(pe){function Ee(Re,he,Ce,We,et){var rt=Re.points,nt=Re.pointsize,gt=null,xt=null;d.beginPath();for(var St=nt;St<rt.length;St+=nt){var zt=rt[St-nt],Nt=rt[St-nt+1],Vt=rt[St],en=rt[St+1];if(!(zt==null||Vt==null)){if(Nt<=en&&Nt<et.min){if(en<et.min)continue;zt=(et.min-Nt)/(en-Nt)*(Vt-zt)+zt,Nt=et.min}else if(en<=Nt&&en<et.min){if(Nt<et.min)continue;Vt=(et.min-Nt)/(en-Nt)*(Vt-zt)+zt,en=et.min}if(Nt>=en&&Nt>et.max){if(en>et.max)continue;zt=(et.max-Nt)/(en-Nt)*(Vt-zt)+zt,Nt=et.max}else if(en>=Nt&&en>et.max){if(Nt>et.max)continue;Vt=(et.max-Nt)/(en-Nt)*(Vt-zt)+zt,en=et.max}if(zt<=Vt&&zt<We.min){if(Vt<We.min)continue;Nt=(We.min-zt)/(Vt-zt)*(en-Nt)+Nt,zt=We.min}else if(Vt<=zt&&Vt<We.min){if(zt<We.min)continue;en=(We.min-zt)/(Vt-zt)*(en-Nt)+Nt,Vt=We.min}if(zt>=Vt&&zt>We.max){if(Vt>We.max)continue;Nt=(We.max-zt)/(Vt-zt)*(en-Nt)+Nt,zt=We.max}else if(Vt>=zt&&Vt>We.max){if(zt>We.max)continue;en=(We.max-zt)/(Vt-zt)*(en-Nt)+Nt,Vt=We.max}(zt!=gt||Nt!=xt)&&d.moveTo(We.p2c(zt)+he,et.p2c(Nt)+Ce),gt=Vt,xt=en,d.lineTo(We.p2c(Vt)+he,et.p2c(en)+Ce)}}d.stroke()}function me(Re,he,Ce){for(var We=Re.points,et=Re.pointsize,rt=Math.min(Math.max(0,Ce.min),Ce.max),nt=0,gt,xt=!1,St=1,zt=0,Nt=0;!(et>0&&nt>We.length+et);){nt+=et;var Vt=We[nt-et],en=We[nt-et+St],Je=We[nt],ct=We[nt+St];if(xt){if(et>0&&Vt!=null&&Je==null){Nt=nt,et=-et,St=2;continue}if(et<0&&nt==zt+et){d.fill(),xt=!1,et=-et,St=1,nt=zt=Nt+et;continue}}if(!(Vt==null||Je==null)){if(Vt<=Je&&Vt<he.min){if(Je<he.min)continue;en=(he.min-Vt)/(Je-Vt)*(ct-en)+en,Vt=he.min}else if(Je<=Vt&&Je<he.min){if(Vt<he.min)continue;ct=(he.min-Vt)/(Je-Vt)*(ct-en)+en,Je=he.min}if(Vt>=Je&&Vt>he.max){if(Je>he.max)continue;en=(he.max-Vt)/(Je-Vt)*(ct-en)+en,Vt=he.max}else if(Je>=Vt&&Je>he.max){if(Vt>he.max)continue;ct=(he.max-Vt)/(Je-Vt)*(ct-en)+en,Je=he.max}if(xt||(d.beginPath(),d.moveTo(he.p2c(Vt),Ce.p2c(rt)),xt=!0),en>=Ce.max&&ct>=Ce.max){d.lineTo(he.p2c(Vt),Ce.p2c(Ce.max)),d.lineTo(he.p2c(Je),Ce.p2c(Ce.max));continue}else if(en<=Ce.min&&ct<=Ce.min){d.lineTo(he.p2c(Vt),Ce.p2c(Ce.min)),d.lineTo(he.p2c(Je),Ce.p2c(Ce.min));continue}var ot=Vt,Qe=Je;en<=ct&&en<Ce.min&&ct>=Ce.min?(Vt=(Ce.min-en)/(ct-en)*(Je-Vt)+Vt,en=Ce.min):ct<=en&&ct<Ce.min&&en>=Ce.min&&(Je=(Ce.min-en)/(ct-en)*(Je-Vt)+Vt,ct=Ce.min),en>=ct&&en>Ce.max&&ct<=Ce.max?(Vt=(Ce.max-en)/(ct-en)*(Je-Vt)+Vt,en=Ce.max):ct>=en&&ct>Ce.max&&en<=Ce.max&&(Je=(Ce.max-en)/(ct-en)*(Je-Vt)+Vt,ct=Ce.max),Vt!=ot&&d.lineTo(he.p2c(ot),Ce.p2c(en)),d.lineTo(he.p2c(Vt),Ce.p2c(en)),d.lineTo(he.p2c(Je),Ce.p2c(ct)),Je!=Qe&&(d.lineTo(he.p2c(Je),Ce.p2c(ct)),d.lineTo(he.p2c(Qe),Ce.p2c(ct)))}}}d.save(),d.translate(l.left,l.top),d.lineJoin="round";var ve=pe.lines.lineWidth,Se=pe.shadowSize;if(ve>0&&Se>0){d.lineWidth=Se,d.strokeStyle="rgba(0,0,0,0.1)";var Ie=Math.PI/18;Ee(pe.datapoints,Math.sin(Ie)*(ve/2+Se/2),Math.cos(Ie)*(ve/2+Se/2),pe.xaxis,pe.yaxis),d.lineWidth=Se/2,Ee(pe.datapoints,Math.sin(Ie)*(ve/2+Se/4),Math.cos(Ie)*(ve/2+Se/4),pe.xaxis,pe.yaxis)}d.lineWidth=ve,d.strokeStyle=pe.color;var Oe=ue(pe.lines,pe.color,0,u);Oe&&(d.fillStyle=Oe,me(pe.datapoints,pe.xaxis,pe.yaxis)),ve>0&&Ee(pe.datapoints,0,0,pe.xaxis,pe.yaxis),d.restore()}function ce(pe){function Ee(Re,he,Ce,We,et,rt,nt,gt){for(var xt=Re.points,St=Re.pointsize,zt=0;zt<xt.length;zt+=St){var Nt=xt[zt],Vt=xt[zt+1];Nt==null||Nt<rt.min||Nt>rt.max||Vt<nt.min||Vt>nt.max||(d.beginPath(),Nt=rt.p2c(Nt),Vt=nt.p2c(Vt)+We,gt=="circle"?d.arc(Nt,Vt,he,0,et?Math.PI:Math.PI*2,!1):gt(d,Nt,Vt,he,et),d.closePath(),Ce&&(d.fillStyle=Ce,d.fill()),d.stroke())}}d.save(),d.translate(l.left,l.top);var me=pe.points.lineWidth,ve=pe.shadowSize,Se=pe.points.radius,Ie=pe.points.symbol;if(me==0&&(me=1e-4),me>0&&ve>0){var Oe=ve/2;d.lineWidth=Oe,d.strokeStyle="rgba(0,0,0,0.1)",Ee(pe.datapoints,Se,null,Oe+Oe/2,!0,pe.xaxis,pe.yaxis,Ie),d.strokeStyle="rgba(0,0,0,0.2)",Ee(pe.datapoints,Se,null,Oe/2,!0,pe.xaxis,pe.yaxis,Ie)}d.lineWidth=me,d.strokeStyle=pe.color,Ee(pe.datapoints,Se,ue(pe.points,pe.color),0,!1,pe.xaxis,pe.yaxis,Ie),d.restore()}function ye(pe,Ee,me,ve,Se,Ie,Oe,Re,he,Ce,We){var et,rt,nt,gt,xt,St,zt,Nt,Vt;Ce?(Nt=St=zt=!0,xt=!1,et=me,rt=pe,gt=Ee+ve,nt=Ee+Se,rt<et&&(Vt=rt,rt=et,et=Vt,xt=!0,St=!1)):(xt=St=zt=!0,Nt=!1,et=pe+ve,rt=pe+Se,nt=me,gt=Ee,gt<nt&&(Vt=gt,gt=nt,nt=Vt,Nt=!0,zt=!1)),!(rt<Oe.min||et>Oe.max||gt<Re.min||nt>Re.max)&&(et<Oe.min&&(et=Oe.min,xt=!1),rt>Oe.max&&(rt=Oe.max,St=!1),nt<Re.min&&(nt=Re.min,Nt=!1),gt>Re.max&&(gt=Re.max,zt=!1),et=Oe.p2c(et),nt=Re.p2c(nt),rt=Oe.p2c(rt),gt=Re.p2c(gt),Ie&&(he.fillStyle=Ie(nt,gt),he.fillRect(et,gt,rt-et,nt-gt)),We>0&&(xt||St||zt||Nt)&&(he.beginPath(),he.moveTo(et,nt),xt?he.lineTo(et,gt):he.moveTo(et,gt),zt?he.lineTo(rt,gt):he.moveTo(rt,gt),St?he.lineTo(rt,nt):he.moveTo(rt,nt),Nt?he.lineTo(et,nt):he.moveTo(et,nt),he.stroke()))}function re(pe){function Ee(Se,Ie,Oe,Re,he,Ce){for(var We=Se.points,et=Se.pointsize,rt=0;rt<We.length;rt+=et)We[rt]!=null&&ye(We[rt],We[rt+1],We[rt+2],Ie,Oe,Re,he,Ce,d,pe.bars.horizontal,pe.bars.lineWidth)}d.save(),d.translate(l.left,l.top),d.lineWidth=pe.bars.lineWidth,d.strokeStyle=pe.color;var me;switch(pe.bars.align){case"left":me=0;break;case"right":me=-pe.bars.barWidth;break;default:me=-pe.bars.barWidth/2}var ve=pe.bars.fill?function(Se,Ie){return ue(pe.bars,pe.color,Se,Ie)}:null;Ee(pe.datapoints,me,me+pe.bars.barWidth,ve,pe.xaxis,pe.yaxis),d.restore()}function ue(pe,Ee,me,ve){var Se=pe.fill;if(!Se)return null;if(pe.fillColor)return Ve(pe.fillColor,me,ve,Ee);var Ie=k.color.parse(Ee);return Ie.a=typeof Se=="number"?Se:.4,Ie.normalize(),Ie.toString()}function De(){if(c.legend.container!=null?k.find(c.legend.container).html(""):i.find(".legend").remove(),!!c.legend.show){for(var pe=[],Ee=[],me=!1,ve=c.legend.labelFormatter,Se,Ie,Oe=0;Oe<a.length;++Oe)Se=a[Oe],Se.label&&(Ie=ve?ve(Se.label,Se):Se.label,Ie&&Ee.push({label:Ie,color:Se.color}));if(c.legend.sorted)if(k.isFunction(c.legend.sorted))Ee.sort(c.legend.sorted);else if(c.legend.sorted=="reverse")Ee.reverse();else{var Re=c.legend.sorted!="descending";Ee.sort(function(St,zt){return St.label==zt.label?0:St.label<zt.label!=Re?1:-1})}for(var Oe=0;Oe<Ee.length;++Oe){var he=Ee[Oe];Oe%c.legend.noColumns==0&&(me&&pe.push("</tr>"),pe.push("<tr>"),me=!0),pe.push('<td class="legendColorBox"><div style="border:1px solid '+c.legend.labelBoxBorderColor+';padding:1px"><div style="width:4px;height:0;border:5px solid '+he.color+';overflow:hidden"></div></div></td><td class="legendLabel">'+he.label+"</td>")}if(me&&pe.push("</tr>"),pe.length!=0){var Ce='<table style="font-size:smaller;color:'+c.grid.color+'">'+pe.join("")+"</table>";if(c.legend.container!=null)k(c.legend.container).html(Ce);else{var We="",et=c.legend.position,rt=c.legend.margin;rt[0]==null&&(rt=[rt,rt]),et.charAt(0)=="n"?We+="top:"+(rt[1]+l.top)+"px;":et.charAt(0)=="s"&&(We+="bottom:"+(rt[1]+l.bottom)+"px;"),et.charAt(1)=="e"?We+="right:"+(rt[0]+l.right)+"px;":et.charAt(1)=="w"&&(We+="left:"+(rt[0]+l.left)+"px;");var nt=k('<div class="legend">'+Ce.replace('style="','style="position:absolute;'+We+";")+"</div>").appendTo(i);if(c.legend.backgroundOpacity!=0){var gt=c.legend.backgroundColor;gt==null&&(gt=c.grid.backgroundColor,gt&&typeof gt=="string"?gt=k.color.parse(gt):gt=k.color.extract(nt,"background-color"),gt.a=1,gt=gt.toString());var xt=nt.children();k('<div style="position:absolute;width:'+xt.width()+"px;height:"+xt.height()+"px;"+We+"background-color:"+gt+';"> </div>').prependTo(nt).css("opacity",c.legend.backgroundOpacity)}}}}}var ge=[],Te=null;function Le(pe,Ee,me){var ve=c.grid.mouseActiveRadius,Se=ve*ve+1,Ie=null,Oe=!1,Re,he,Ce;for(Re=a.length-1;Re>=0;--Re)if(me(a[Re])){var We=a[Re],et=We.xaxis,rt=We.yaxis,nt=We.datapoints.points,gt=et.c2p(pe),xt=rt.c2p(Ee),St=ve/et.scale,zt=ve/rt.scale;if(Ce=We.datapoints.pointsize,et.options.inverseTransform&&(St=Number.MAX_VALUE),rt.options.inverseTransform&&(zt=Number.MAX_VALUE),We.lines.show||We.points.show)for(he=0;he<nt.length;he+=Ce){var Nt=nt[he],Vt=nt[he+1];if(Nt!=null&&!(Nt-gt>St||Nt-gt<-St||Vt-xt>zt||Vt-xt<-zt)){var en=Math.abs(et.p2c(Nt)-pe),Je=Math.abs(rt.p2c(Vt)-Ee),ct=en*en+Je*Je;ct<Se&&(Se=ct,Ie=[Re,he/Ce])}}if(We.bars.show&&!Ie){var ot,Qe;switch(We.bars.align){case"left":ot=0;break;case"right":ot=-We.bars.barWidth;break;default:ot=-We.bars.barWidth/2}for(Qe=ot+We.bars.barWidth,he=0;he<nt.length;he+=Ce){var Nt=nt[he],Vt=nt[he+1],pt=nt[he+2];Nt!=null&&(a[Re].bars.horizontal?gt<=Math.max(pt,Nt)&&gt>=Math.min(pt,Nt)&&xt>=Vt+ot&&xt<=Vt+Qe:gt>=Nt+ot&&gt<=Nt+Qe&&xt>=Math.min(pt,Vt)&&xt<=Math.max(pt,Vt))&&(Ie=[Re,he/Ce])}}}return Ie?(Re=Ie[0],he=Ie[1],Ce=a[Re].datapoints.pointsize,{datapoint:a[Re].datapoints.points.slice(he*Ce,(he+1)*Ce),dataIndex:he,series:a[Re],seriesIndex:Re}):null}function Ye(pe){c.grid.hoverable&&Ue("plothover",pe,function(Ee){return Ee.hoverable!=!1})}function je(pe){c.grid.hoverable&&Ue("plothover",pe,function(Ee){return!1})}function Ze(pe){E.isSelecting||Ue("plotclick",pe,function(Ee){return Ee.clickable!=!1})}function Ne(pe){if(pe.cancelable){if(!f.is(pe.target)&&f.has(pe.target).length===0){Ue("plotleave",pe,function(Ee){});return}Ye(Pe(pe)),pe.preventDefault()}}function Pe(pe){if(!pe||!pe.originalEvent||pe.pageX&&pe.pageY)return pe;var Ee=pe.originalEvent;if(Ee.changedTouches.length===0)return pe;var me=Ee.changedTouches[0];return pe.pageX=me.pageX,pe.pageY=me.pageY,pe}function Ue(pe,Ee,me){var ve=f.offset(),Se=Ee.pageX-ve.left-l.left,Ie=Ee.pageY-ve.top-l.top,Oe=C({left:Se,top:Ie});Oe.pageX=Ee.pageX,Oe.pageY=Ee.pageY,Oe.ctrlKey=Ee.ctrlKey,Oe.metaKey=Ee.metaKey;var Re=Le(Se,Ie,me);if(Re&&(Re.pageX=parseInt(Re.series.xaxis.p2c(Re.datapoint[0])+ve.left+l.left,10),Re.pageY=parseInt(Re.series.yaxis.p2c(Re.datapoint[1])+ve.top+l.top,10)),c.grid.autoHighlight){for(var he=0;he<ge.length;++he){var Ce=ge[he];Ce.auto==pe&&!(Re&&Ce.series==Re.series&&Ce.point[0]==Re.datapoint[0]&&Ce.point[1]==Re.datapoint[1])&&dt(Ce.series,Ce.point)}Re&&qe(Re.series,Re.datapoint,pe)}i.trigger(pe,[Oe,Re])}function $e(){var pe=c.interaction.redrawOverlayInterval;if(pe==-1){ze();return}Te||(Te=setTimeout(ze,pe))}function ze(){Te=null,p.save(),h.clear(),p.translate(l.left,l.top);var pe,Ee;for(pe=0;pe<ge.length;++pe)Ee=ge[pe],Ee.series.bars.show?st(Ee.series,Ee.point):yt(Ee.series,Ee.point);p.restore(),x(D.drawOverlay,[p])}function qe(pe,Ee,me){if(typeof pe=="number"&&(pe=a[pe]),typeof Ee=="number"){var ve=pe.datapoints.pointsize;Ee=pe.datapoints.points.slice(ve*Ee,ve*(Ee+1))}var Se=vt(pe,Ee);Se==-1?(ge.push({series:pe,point:Ee,auto:me}),$e()):me||(ge[Se].auto=!1)}function dt(pe,Ee){if(pe==null&&Ee==null){ge=[],$e();return}if(typeof pe=="number"&&(pe=a[pe]),typeof Ee=="number"){var me=pe.datapoints.pointsize;Ee=pe.datapoints.points.slice(me*Ee,me*(Ee+1))}var ve=vt(pe,Ee);ve!=-1&&(ge.splice(ve,1),$e())}function vt(pe,Ee){for(var me=0;me<ge.length;++me){var ve=ge[me];if(ve.series==pe&&ve.point[0]==Ee[0]&&ve.point[1]==Ee[1])return me}return-1}function yt(pe,Ee){var me=Ee[0],ve=Ee[1],Se=pe.xaxis,Ie=pe.yaxis,Oe=typeof pe.highlightColor=="string"?pe.highlightColor:k.color.parse(pe.color).scale("a",.5).toString();if(!(me<Se.min||me>Se.max||ve<Ie.min||ve>Ie.max)){var Re=pe.points.radius+pe.points.lineWidth/2;p.lineWidth=Re,p.strokeStyle=Oe;var he=1.5*Re;me=Se.p2c(me),ve=Ie.p2c(ve),p.beginPath(),pe.points.symbol=="circle"?p.arc(me,ve,he,0,2*Math.PI,!1):pe.points.symbol(p,me,ve,he,!1),p.closePath(),p.stroke()}}function st(pe,Ee){var me=typeof pe.highlightColor=="string"?pe.highlightColor:k.color.parse(pe.color).scale("a",.5).toString(),ve=me,Se;switch(pe.bars.align){case"left":Se=0;break;case"right":Se=-pe.bars.barWidth;break;default:Se=-pe.bars.barWidth/2}p.lineWidth=pe.bars.lineWidth,p.strokeStyle=me,ye(Ee[0],Ee[1],Ee[2]||0,Se,Se+pe.bars.barWidth,function(){return ve},pe.xaxis,pe.yaxis,p,pe.bars.horizontal,pe.bars.lineWidth)}function Ve(pe,Ee,me,ve){if(typeof pe=="string")return pe;for(var Se=d.createLinearGradient(0,me,0,Ee),Ie=0,Oe=pe.colors.length;Ie<Oe;++Ie){var Re=pe.colors[Ie];if(typeof Re!="string"){var he=k.color.parse(ve);Re.brightness!=null&&(he=he.scale("rgb",Re.brightness)),Re.opacity!=null&&(he.a*=Re.opacity),Re=he.toString()}Se.addColorStop(Ie/(Oe-1),Re)}return Se}}k.plot=function(i,s,r){var g=new t(k(i),s,r,k.plot.plugins);return g},k.plot.version="0.8.3",k.plot.plugins=[],k.fn.plot=function(i,s){return this.each(function(){k.plot(this,i,s)})};function n(i,s){return s*Math.floor(i/s)}}(jQuery)},80851:()=>{(function(k){function R(e){var t={first:{x:-1,y:-1},second:{x:-1,y:-1},show:!1,active:!1},n={},i=null;function s(l){t.active&&(f(l),e.getPlaceholder().trigger("plotselecting",[a()]))}function r(l){l.which==1&&(document.body.focus(),document.onselectstart!==void 0&&n.onselectstart==null&&(n.onselectstart=document.onselectstart,document.onselectstart=function(){return!1}),document.ondrag!==void 0&&n.ondrag==null&&(n.ondrag=document.ondrag,document.ondrag=function(){return!1}),h(t.first,l),t.active=!0,i=function(y){g(y)},k(document).one("mouseup",i))}function g(l){return i=null,document.onselectstart!==void 0&&(document.onselectstart=n.onselectstart),document.ondrag!==void 0&&(document.ondrag=n.ondrag),t.active=!1,f(l),v()?c(l):(e.getPlaceholder().trigger("plotunselected",[]),e.getPlaceholder().trigger("plotselecting",[null])),setTimeout(function(){e.isSelecting=!1},10),!1}function a(){if(!v()||!t.show)return null;var l={},y=t.first,u=t.second,D=e.getAxes(),E=!0;return k.each(D,function(x,P){P.used&&(anyUsed=!1)}),k.each(D,function(x,P){if(P.used||E){var b=P.c2p(y[P.direction]),M=P.c2p(u[P.direction]);l[x]={from:Math.min(b,M),to:Math.max(b,M)}}}),l}function c(l){var y=a();y.ctrlKey=l.ctrlKey,y.metaKey=l.metaKey,e.getPlaceholder().trigger("plotselected",[y]),y.xaxis&&y.yaxis&&e.getPlaceholder().trigger("selected",[{x1:y.xaxis.from,y1:y.yaxis.from,x2:y.xaxis.to,y2:y.yaxis.to}])}function o(l,y,u){return y<l?l:y>u?u:y}function h(l,y){var u=e.getOptions(),D=e.getPlaceholder().offset(),E=e.getPlotOffset();l.x=o(0,y.pageX-D.left-E.left,e.width()),l.y=o(0,y.pageY-D.top-E.top,e.height()),u.selection.mode=="y"&&(l.x=l==t.first?0:e.width()),u.selection.mode=="x"&&(l.y=l==t.first?0:e.height())}function f(l){l.pageX!=null&&(h(t.second,l),v()?(e.isSelecting=!0,t.show=!0,e.triggerRedrawOverlay()):d(!0))}function d(l){t.show&&(t.show=!1,e.triggerRedrawOverlay(),l||e.getPlaceholder().trigger("plotunselected",[]))}function p(l,y){var u,D,E,x,P=e.getAxes();for(var b in P)if(u=P[b],u.direction==y&&(x=y+u.n+"axis",!l[x]&&u.n==1&&(x=y+"axis"),l[x])){D=l[x].from,E=l[x].to;break}if(l[x]||(u=y=="x"?e.getXAxes()[0]:e.getYAxes()[0],D=l[y+"1"],E=l[y+"2"]),D!=null&&E!=null&&D>E){var M=D;D=E,E=M}return{from:D,to:E,axis:u}}function m(l,y){var u,D,E=e.getOptions();E.selection.mode=="y"?(t.first.x=0,t.second.x=e.width()):(D=p(l,"x"),t.first.x=D.axis.p2c(D.from),t.second.x=D.axis.p2c(D.to)),E.selection.mode=="x"?(t.first.y=0,t.second.y=e.height()):(D=p(l,"y"),t.first.y=D.axis.p2c(D.from),t.second.y=D.axis.p2c(D.to)),t.show=!0,e.triggerRedrawOverlay(),!y&&v()&&c()}function v(){var l=e.getOptions().selection.minSize;return Math.abs(t.second.x-t.first.x)>=l&&Math.abs(t.second.y-t.first.y)>=l}e.clearSelection=d,e.setSelection=m,e.getSelection=a,e.hooks.bindEvents.push(function(l,y){var u=l.getOptions();u.selection.mode!=null&&(y.mousemove(s),y.mousedown(r))}),e.hooks.drawOverlay.push(function(l,y){if(t.show&&v()){var u=l.getPlotOffset(),D=l.getOptions();y.save(),y.translate(u.left,u.top);var E=k.color.parse(D.selection.color);y.strokeStyle=E.scale("a",.8).toString(),y.lineWidth=1,y.lineJoin=D.selection.shape,y.fillStyle=E.scale("a",.4).toString();var x=Math.min(t.first.x,t.second.x)+.5,P=Math.min(t.first.y,t.second.y)+.5,b=Math.abs(t.second.x-t.first.x)-1,M=Math.abs(t.second.y-t.first.y)-1;y.fillRect(x,P,b,M),y.strokeRect(x,P,b,M),y.restore()}}),e.hooks.shutdown.push(function(l,y){y.unbind("mousemove",s),y.unbind("mousedown",r),i&&(k(document).unbind("mouseup",i),document.onselectstart!==void 0&&(document.onselectstart=n.onselectstart),document.ondrag!==void 0&&(document.ondrag=n.ondrag))})}k.plot.plugins.push({init:R,options:{selection:{mode:null,color:"#e8cfac",shape:"round",minSize:5}},name:"selection",version:"1.1"})})(jQuery)},31221:()=>{(function(k){var R={series:{stack:null}};function e(t){function n(s,r){for(var g=null,a=0;a<r.length&&s!=r[a];++a)r[a].stack==s.stack&&(g=r[a]);return g}function i(s,r,g){if(!(r.stack==null||r.stack===!1)){var a=n(r,s.getData());if(a){for(var c=g.pointsize,o=g.points,h=a.datapoints.pointsize,f=a.datapoints.points,d=[],p,m,v,l,y,u,D=r.lines.show,E=r.bars.horizontal,x=c>2&&(E?g.format[2].x:g.format[2].y),P=D&&r.lines.steps,b=E?1:0,M=E?0:1,O=0,I=0,T,C;!(O>=o.length&&I>=f.length);){if(T=d.length,O<o.length&&o[O]==null){for(C=0;C<c;++C)d.push(o[O+C]);O+=c}else if(O>=o.length){for(C=0;C<c;++C)d.push(f[I+C]);x&&(d[T+2]=f[I+M]),I+=h}else if(I>=f.length){for(C=0;C<c;++C)d.push(o[O+C]);O+=c}else if(I<f.length&&f[I]==null)I+=h;else{if(p=o[O+b],m=o[O+M],l=f[I+b],y=f[I+M],u=0,p==l){for(C=0;C<c;++C)d.push(o[O+C]);d[T+M]+=y,u=y,O+=c,I+=h}else if(p>l){if(O==0){for(C=0;C<c;++C)d.push(f[I+C]);u=y}if(O>0&&o[O-c]!=null){for(v=0,d.push(l),d.push(v+y),C=2;C<c;++C)d.push(o[O+C]);u=y}I+=h}else{for(C=0;C<c;++C)d.push(o[O+C]);I>0&&f[I-h]!=null&&(u=0),d[T+M]+=u,O+=c}fromgap=!1,T!=d.length&&x&&(d[T+2]=u)}if(P&&T!=d.length&&T>0&&d[T]!=null&&d[T]!=d[T-c]&&d[T+1]!=d[T-c+1]){for(C=0;C<c;++C)d[T+c+C]=d[T+C];d[T+1]=d[T-c+1]}}g.points=d}}}t.hooks.processDatapoints.push(i)}k.plot.plugins.push({init:e,options:R,name:"stack",version:"1.2"})})(jQuery)},91520:()=>{(function(k){var R={series:{stackpercent:null}};function e(t){var n={},i=!1,s={};function r(c,o,h,f){if(i||(i=!0,s=g(c.getData())),o.stackpercent==!0){var d=h.length;o.percents=[];var p=0,m=1;o.bars&&o.bars.horizontal&&o.bars.horizontal===!0&&(p=1,m=0);for(var v=0;v<d;v++){var l=s[h[v][p]+""];l>0?o.percents.push(h[v][m]*100/l):o.percents.push(0)}}}function g(c){var o=c.length,h={};if(o>0){for(var f=0;f<o;f++)if(c[f].stackpercent){var d=0,p=1;c[f].bars&&c[f].bars.horizontal&&c[f].bars.horizontal===!0&&(d=1,p=0);for(var m=c[f].data.length,v=0;v<m;v++){var l=0;c[f].data[v][1]!=null&&(l=c[f].data[v][p]),h[c[f].data[v][d]+""]?h[c[f].data[v][d]+""]+=l:h[c[f].data[v][d]+""]=l}}}return h}function a(c,o,h){if(o.stackpercent){i||(s=g(c.getData()));var f=[],d=0,p=1;o.bars&&o.bars.horizontal&&o.bars.horizontal===!0&&(d=1,p=0);for(var m=0;m<h.points.length;m+=3)n[h.points[m+d]]||(n[h.points[m+d]]=0),f[m+d]=h.points[m+d],f[m+p]=h.points[m+p]+n[h.points[m+d]],f[m+2]=n[h.points[m+d]],n[h.points[m+d]]+=h.points[m+p],s[f[m+d]+""]>0?(f[m+p]=f[m+p]*100/s[f[m+d]+""],f[m+2]=f[m+2]*100/s[f[m+d]+""]):(f[m+p]=0,f[m+2]=0);h.points=f}}t.hooks.processRawData.push(r),t.hooks.processDatapoints.push(a)}k.plot.plugins.push({init:e,options:R,name:"stackpercent",version:"0.1"})})(jQuery)},32176:()=>{(function(k){var R={xaxis:{timezone:null,timeformat:null,twelveHourClock:!1,monthNames:null}};function e(o,h){return h*Math.floor(o/h)}function t(o,h,f,d){if(typeof o.strftime=="function")return o.strftime(h);var p=function(x,P){return x=""+x,P=""+(P??"0"),x.length==1?P+x:x},m=[],v=!1,l=o.getHours(),y=l<12;f==null&&(f=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]),d==null&&(d=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]);var u;l>12?u=l-12:l==0?u=12:u=l;for(var D=0;D<h.length;++D){var E=h.charAt(D);if(v){switch(E){case"a":E=""+d[o.getDay()];break;case"b":E=""+f[o.getMonth()];break;case"d":E=p(o.getDate(),"");break;case"e":E=p(o.getDate()," ");break;case"h":case"H":E=p(l);break;case"I":E=p(u);break;case"l":E=p(u," ");break;case"m":E=p(o.getMonth()+1,"");break;case"M":E=p(o.getMinutes());break;case"q":E=""+(Math.floor(o.getMonth()/3)+1);break;case"S":E=p(o.getSeconds());break;case"y":E=p(o.getFullYear()%100);break;case"Y":E=""+o.getFullYear();break;case"p":E=y?"am":"pm";break;case"P":E=y?"AM":"PM";break;case"w":E=""+o.getDay();break}m.push(E),v=!1}else E=="%"?v=!0:m.push(E)}return m.join("")}function n(o){function h(m,v,l,y){m[v]=function(){return l[y].apply(l,arguments)}}var f={date:o};o.strftime!=null&&h(f,"strftime",o,"strftime"),h(f,"getTime",o,"getTime"),h(f,"setTime",o,"setTime");for(var d=["Date","Day","FullYear","Hours","Milliseconds","Minutes","Month","Seconds"],p=0;p<d.length;p++)h(f,"get"+d[p],o,"getUTC"+d[p]),h(f,"set"+d[p],o,"setUTC"+d[p]);return f}function i(o,h){if(h.timezone=="browser")return new Date(o);if(!h.timezone||h.timezone=="utc")return n(new Date(o));if(typeof timezoneJS<"u"&&typeof timezoneJS.Date<"u"){var f=new timezoneJS.Date;return f.setTimezone(h.timezone),f.setTime(o),f}else return n(new Date(o))}var s={second:1e3,minute:60*1e3,hour:60*60*1e3,day:24*60*60*1e3,month:30*24*60*60*1e3,quarter:3*30*24*60*60*1e3,year:365.2425*24*60*60*1e3},r=[[1,"second"],[2,"second"],[5,"second"],[10,"second"],[30,"second"],[1,"minute"],[2,"minute"],[5,"minute"],[10,"minute"],[30,"minute"],[1,"hour"],[2,"hour"],[4,"hour"],[8,"hour"],[12,"hour"],[1,"day"],[2,"day"],[3,"day"],[.25,"month"],[.5,"month"],[1,"month"],[2,"month"]],g=r.concat([[3,"month"],[6,"month"],[1,"year"]]),a=r.concat([[1,"quarter"],[2,"quarter"],[1,"year"]]);function c(o){o.hooks.processOptions.push(function(h,f){k.each(h.getAxes(),function(d,p){var m=p.options;m.mode=="time"&&(p.tickGenerator=function(v){var l=[],y=i(v.min,m),u=0,D=m.tickSize&&m.tickSize[1]==="quarter"||m.minTickSize&&m.minTickSize[1]==="quarter"?a:g;m.minTickSize!=null&&(typeof m.tickSize=="number"?u=m.tickSize:u=m.minTickSize[0]*s[m.minTickSize[1]]);for(var E=0;E<D.length-1&&!(v.delta<(D[E][0]*s[D[E][1]]+D[E+1][0]*s[D[E+1][1]])/2&&D[E][0]*s[D[E][1]]>=u);++E);var x=D[E][0],P=D[E][1];if(P=="year"){if(m.minTickSize!=null&&m.minTickSize[1]=="year")x=Math.floor(m.minTickSize[0]);else{var b=Math.pow(10,Math.floor(Math.log(v.delta/s.year)/Math.LN10)),M=v.delta/s.year/b;M<1.5?x=1:M<3?x=2:M<7.5?x=5:x=10,x*=b}x<1&&(x=1)}v.tickSize=m.tickSize||[x,P];var O=v.tickSize[0];P=v.tickSize[1];var I=O*s[P];P=="second"?y.setSeconds(e(y.getSeconds(),O)):P=="minute"?y.setMinutes(e(y.getMinutes(),O)):P=="hour"?y.setHours(e(y.getHours(),O)):P=="month"?y.setMonth(e(y.getMonth(),O)):P=="quarter"?y.setMonth(3*e(y.getMonth()/3,O)):P=="year"&&y.setFullYear(e(y.getFullYear(),O)),y.setMilliseconds(0),I>=s.minute&&y.setSeconds(0),I>=s.hour&&y.setMinutes(0),I>=s.day&&y.setHours(0),I>=s.day*4&&y.setDate(1),I>=s.month*2&&y.setMonth(e(y.getMonth(),3)),I>=s.quarter*2&&y.setMonth(e(y.getMonth(),6)),I>=s.year&&y.setMonth(0);var T=0,C=Number.NaN,S;do if(S=C,C=y.getTime(),l.push(C),P=="month"||P=="quarter")if(O<1){y.setDate(1);var A=y.getTime();y.setMonth(y.getMonth()+(P=="quarter"?3:1));var L=y.getTime();y.setTime(C+T*s.hour+(L-A)*O),T=y.getHours(),y.setHours(0)}else y.setMonth(y.getMonth()+O*(P=="quarter"?3:1));else P=="year"?y.setFullYear(y.getFullYear()+O):y.setTime(C+I);while(C<v.max&&C!=S);return l},p.tickFormatter=function(v,l){var y=i(v,l.options);if(m.timeformat!=null)return t(y,m.timeformat,m.monthNames,m.dayNames);var u=l.options.tickSize&&l.options.tickSize[1]=="quarter"||l.options.minTickSize&&l.options.minTickSize[1]=="quarter",D=l.tickSize[0]*s[l.tickSize[1]],E=l.max-l.min,x=m.twelveHourClock?" %p":"",P=m.twelveHourClock?"%I":"%H",b;D<s.minute?b=P+":%M:%S"+x:D<s.day?E<2*s.day?b=P+":%M"+x:b="%b %d "+P+":%M"+x:D<s.month?b="%b %d":u&&D<s.quarter||!u&&D<s.year?E<s.year?b="%b":b="%b %Y":u&&D<s.year?E<s.year?b="Q%q":b="Q%q %Y":b="%Y";var M=t(y,b,m.monthNames,m.dayNames);return M})})})}k.plot.plugins.push({init:c,options:R,name:"time",version:"1.0"}),k.plot.formatDate=t})(jQuery)}}]);

//# sourceMappingURL=3729.42275205de15974ec714.js.map