{"version":3,"file":"4085.270f66860a57d98fa0b8.js","mappings":"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","sources":["webpack://grafana/./public/app/features/alerting/unified/components/receivers/form/CollapsibleSection.tsx","webpack://grafana/./public/app/features/alerting/unified/components/receivers/form/fields/KeyValueMapInput.tsx","webpack://grafana/./public/app/features/alerting/unified/components/receivers/form/fields/StringArrayInput.tsx","webpack://grafana/./public/app/features/alerting/unified/components/receivers/form/fields/styles.ts","webpack://grafana/./public/app/features/alerting/unified/components/receivers/form/fields/SubformArrayField.tsx","webpack://grafana/./public/app/features/alerting/unified/components/receivers/form/fields/SubformField.tsx","webpack://grafana/./public/app/features/alerting/unified/components/receivers/form/fields/TemplateContentAndPreview.tsx","webpack://grafana/./public/app/features/alerting/unified/components/receivers/form/fields/TemplateSelector.tsx","webpack://grafana/./public/app/features/alerting/unified/components/receivers/form/fields/OptionField.tsx","webpack://grafana/./public/app/features/alerting/unified/hooks/useControlledFieldArray.ts","webpack://grafana/./public/app/features/alerting/unified/utils/receiver-form.ts"],"sourcesContent":["import { css, cx } from '@emotion/css';\nimport { useState } from 'react';\nimport * as React from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { IconSize, useStyles2 } from '@grafana/ui';\n\nimport { CollapseToggle } from '../../CollapseToggle';\n\ninterface Props {\n  label: string;\n  description?: string;\n  className?: string;\n  size?: IconSize;\n}\n\nexport const CollapsibleSection = ({\n  label,\n  description,\n  children,\n  className,\n  size = 'xl',\n}: React.PropsWithChildren<Props>) => {\n  const styles = useStyles2(getStyles);\n  const [isCollapsed, setIsCollapsed] = useState(true);\n\n  const toggleCollapse = () => setIsCollapsed(!isCollapsed);\n\n  return (\n    <div className={cx(styles.wrapper, className)}>\n      <CollapseToggle\n        className={styles.toggle}\n        size={size}\n        onToggle={toggleCollapse}\n        isCollapsed={isCollapsed}\n        text={label}\n      />\n      {description && <p className={styles.description}>{description}</p>}\n      <div className={isCollapsed ? styles.hidden : styles.content}>{children}</div>\n    </div>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  wrapper: css({\n    marginTop: theme.spacing(1),\n    paddingBottom: theme.spacing(1),\n  }),\n  toggle: css({\n    margin: theme.spacing(1, 0),\n    padding: 0,\n  }),\n  hidden: css({\n    display: 'none',\n  }),\n  description: css({\n    color: theme.colors.text.secondary,\n    fontSize: theme.typography.size.sm,\n    fontWeight: theme.typography.fontWeightRegular,\n    margin: 0,\n  }),\n  content: css({\n    paddingLeft: theme.spacing(3),\n  }),\n});\n","import { css } from '@emotion/css';\nimport { useEffect, useState } from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { Button, Input, useStyles2 } from '@grafana/ui';\n\nimport { ActionIcon } from '../../../rules/ActionIcon';\n\ninterface Props {\n  value?: Record<string, string>;\n  readOnly?: boolean;\n  onChange: (value: Record<string, string>) => void;\n}\n\nexport const KeyValueMapInput = ({ value, onChange, readOnly = false }: Props) => {\n  const styles = useStyles2(getStyles);\n  const [pairs, setPairs] = useState(recordToPairs(value));\n  useEffect(() => setPairs(recordToPairs(value)), [value]);\n\n  const emitChange = (pairs: Array<[string, string]>) => {\n    onChange(pairsToRecord(pairs));\n  };\n\n  const deleteItem = (index: number) => {\n    const newPairs = pairs.slice();\n    const removed = newPairs.splice(index, 1)[0];\n    setPairs(newPairs);\n    if (removed[0]) {\n      emitChange(newPairs);\n    }\n  };\n\n  const updatePair = (values: [string, string], index: number) => {\n    const old = pairs[index];\n    const newPairs = pairs.map((pair, i) => (i === index ? values : pair));\n    setPairs(newPairs);\n    if (values[0] || old[0]) {\n      emitChange(newPairs);\n    }\n  };\n\n  return (\n    <div>\n      {!!pairs.length && (\n        <table className={styles.table}>\n          <thead>\n            <tr>\n              <th>Name</th>\n              <th>Value</th>\n              {!readOnly && <th></th>}\n            </tr>\n          </thead>\n          <tbody>\n            {pairs.map(([key, value], index) => (\n              <tr key={index}>\n                <td>\n                  <Input\n                    readOnly={readOnly}\n                    value={key}\n                    onChange={(e) => updatePair([e.currentTarget.value, value], index)}\n                  />\n                </td>\n                <td>\n                  <Input\n                    readOnly={readOnly}\n                    value={value}\n                    onChange={(e) => updatePair([key, e.currentTarget.value], index)}\n                  />\n                </td>\n                {!readOnly && (\n                  <td>\n                    <ActionIcon icon=\"trash-alt\" tooltip=\"delete\" onClick={() => deleteItem(index)} />\n                  </td>\n                )}\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      )}\n      {!readOnly && (\n        <Button\n          className={styles.addButton}\n          type=\"button\"\n          variant=\"secondary\"\n          icon=\"plus\"\n          size=\"sm\"\n          onClick={() => setPairs([...pairs, ['', '']])}\n        >\n          Add\n        </Button>\n      )}\n    </div>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  addButton: css({\n    marginTop: theme.spacing(1),\n  }),\n  table: css({\n    'tbody td': {\n      padding: `0 ${theme.spacing(1)} ${theme.spacing(1)} 0`,\n    },\n  }),\n});\n\nconst pairsToRecord = (pairs: Array<[string, string]>): Record<string, string> => {\n  const record: Record<string, string> = {};\n  for (const [key, value] of pairs) {\n    if (key) {\n      record[key] = value;\n    }\n  }\n  return record;\n};\n\nconst recordToPairs = (obj?: Record<string, string>): Array<[string, string]> => Object.entries(obj ?? {});\n","import { css } from '@emotion/css';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { Button, Input, useStyles2 } from '@grafana/ui';\n\nimport { ActionIcon } from '../../../rules/ActionIcon';\n\ninterface Props {\n  value?: string[];\n  readOnly?: boolean;\n  onChange: (value: string[]) => void;\n}\n\nexport const StringArrayInput = ({ value, onChange, readOnly = false }: Props) => {\n  const styles = useStyles2(getStyles);\n\n  const deleteItem = (index: number) => {\n    if (!value) {\n      return;\n    }\n    const newValue = value.slice();\n    newValue.splice(index, 1);\n    onChange(newValue);\n  };\n\n  const updateValue = (itemValue: string, index: number) => {\n    if (!value) {\n      return;\n    }\n    onChange(value.map((v, i) => (i === index ? itemValue : v)));\n  };\n\n  return (\n    <div>\n      {!!value?.length &&\n        value.map((v, index) => (\n          <div key={index} className={styles.row}>\n            <Input readOnly={readOnly} value={v} onChange={(e) => updateValue(e.currentTarget.value, index)} />\n            {!readOnly && (\n              <ActionIcon\n                className={styles.deleteIcon}\n                icon=\"trash-alt\"\n                tooltip=\"delete\"\n                onClick={() => deleteItem(index)}\n              />\n            )}\n          </div>\n        ))}\n      {!readOnly && (\n        <Button\n          className={styles.addButton}\n          type=\"button\"\n          variant=\"secondary\"\n          icon=\"plus\"\n          size=\"sm\"\n          onClick={() => onChange([...(value ?? []), ''])}\n        >\n          Add\n        </Button>\n      )}\n    </div>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  row: css({\n    display: 'flex',\n    flexDirection: 'row',\n    marginBottom: theme.spacing(1),\n    alignItems: 'center',\n  }),\n  deleteIcon: css({\n    marginLeft: theme.spacing(1),\n  }),\n  addButton: css({\n    marginTop: theme.spacing(1),\n  }),\n});\n","import { css } from '@emotion/css';\n\nimport { GrafanaTheme2 } from '@grafana/data';\n\nexport const getReceiverFormFieldStyles = (theme: GrafanaTheme2) => ({\n  collapsibleSection: css({\n    margin: 0,\n    padding: 0,\n  }),\n  wrapper: css({\n    margin: theme.spacing(2, 0),\n    padding: theme.spacing(1),\n    border: `solid 1px ${theme.colors.border.medium}`,\n    borderRadius: theme.shape.radius.default,\n    position: 'relative',\n  }),\n  description: css({\n    color: theme.colors.text.secondary,\n    fontSize: theme.typography.size.sm,\n    fontWeight: theme.typography.fontWeightRegular,\n    margin: 0,\n  }),\n  deleteIcon: css({\n    position: 'absolute',\n    right: theme.spacing(1),\n    top: theme.spacing(1),\n  }),\n  addButton: css({\n    marginTop: theme.spacing(1),\n  }),\n});\n","import { FieldError, DeepMap, useFormContext } from 'react-hook-form';\n\nimport { Button, useStyles2 } from '@grafana/ui';\nimport { useControlledFieldArray } from 'app/features/alerting/unified/hooks/useControlledFieldArray';\nimport { NotificationChannelOption } from 'app/types';\n\nimport { ActionIcon } from '../../../rules/ActionIcon';\nimport { CollapsibleSection } from '../CollapsibleSection';\n\nimport { OptionField } from './OptionField';\nimport { getReceiverFormFieldStyles } from './styles';\n\ninterface Props {\n  defaultValues?: any[];\n  option: NotificationChannelOption;\n  pathPrefix: string;\n  errors?: Array<DeepMap<any, FieldError>>;\n  readOnly?: boolean;\n}\n\nexport const SubformArrayField = ({ option, pathPrefix, errors, defaultValues, readOnly = false }: Props) => {\n  const styles = useStyles2(getReceiverFormFieldStyles);\n  const path = `${pathPrefix}${option.propertyName}`;\n  const formAPI = useFormContext();\n  const { fields, append, remove } = useControlledFieldArray({ name: path, formAPI, defaults: defaultValues });\n\n  return (\n    <div className={styles.wrapper}>\n      <CollapsibleSection\n        className={styles.collapsibleSection}\n        label={`${option.label} (${fields.length})`}\n        description={option.description}\n      >\n        {(fields ?? defaultValues ?? []).map((field, itemIndex) => {\n          return (\n            <div key={itemIndex} className={styles.wrapper}>\n              {!readOnly && (\n                <ActionIcon\n                  data-testid={`${path}.${itemIndex}.delete-button`}\n                  icon=\"trash-alt\"\n                  tooltip=\"delete\"\n                  onClick={() => remove(itemIndex)}\n                  className={styles.deleteIcon}\n                />\n              )}\n              {option.subformOptions?.map((option) => (\n                <OptionField\n                  readOnly={readOnly}\n                  defaultValue={field?.[option.propertyName]}\n                  key={option.propertyName}\n                  option={option}\n                  pathPrefix={`${path}.${itemIndex}.`}\n                  error={errors?.[itemIndex]?.[option.propertyName]}\n                />\n              ))}\n            </div>\n          );\n        })}\n        {!readOnly && (\n          <Button\n            data-testid={`${path}.add-button`}\n            className={styles.addButton}\n            type=\"button\"\n            variant=\"secondary\"\n            icon=\"plus\"\n            size=\"sm\"\n            onClick={() => append({ __id: String(Math.random()) })}\n          >\n            Add\n          </Button>\n        )}\n      </CollapsibleSection>\n    </div>\n  );\n};\n","import { useState } from 'react';\nimport { FieldError, DeepMap, useFormContext } from 'react-hook-form';\n\nimport { Button, useStyles2 } from '@grafana/ui';\nimport { NotificationChannelOption } from 'app/types';\n\nimport { ActionIcon } from '../../../rules/ActionIcon';\n\nimport { OptionField } from './OptionField';\nimport { getReceiverFormFieldStyles } from './styles';\n\ninterface Props {\n  defaultValue: any;\n  option: NotificationChannelOption;\n  pathPrefix: string;\n  errors?: DeepMap<any, FieldError>;\n  readOnly?: boolean;\n}\n\nexport const SubformField = ({ option, pathPrefix, errors, defaultValue, readOnly = false }: Props) => {\n  const styles = useStyles2(getReceiverFormFieldStyles);\n  const name = `${pathPrefix}${option.propertyName}`;\n  const { watch } = useFormContext();\n  const _watchValue = watch(name);\n  const value = _watchValue === undefined ? defaultValue : _watchValue;\n\n  const [show, setShow] = useState(!!value);\n\n  return (\n    <div className={styles.wrapper} data-testid={`${name}.container`}>\n      <h6>{option.label}</h6>\n      {option.description && <p className={styles.description}>{option.description}</p>}\n      {show && (\n        <>\n          {!readOnly && (\n            <ActionIcon\n              data-testid={`${name}.delete-button`}\n              icon=\"trash-alt\"\n              tooltip=\"delete\"\n              onClick={() => setShow(false)}\n              className={styles.deleteIcon}\n            />\n          )}\n          {(option.subformOptions ?? []).map((subOption) => {\n            return (\n              <OptionField\n                readOnly={readOnly}\n                defaultValue={defaultValue?.[subOption.propertyName]}\n                key={subOption.propertyName}\n                option={subOption}\n                pathPrefix={`${name}.`}\n                error={errors?.[subOption.propertyName]}\n              />\n            );\n          })}\n        </>\n      )}\n      {!show && !readOnly && (\n        <Button\n          className={styles.addButton}\n          type=\"button\"\n          variant=\"secondary\"\n          icon=\"plus\"\n          size=\"sm\"\n          onClick={() => setShow(true)}\n          data-testid={`${name}.add-button`}\n        >\n          Add\n        </Button>\n      )}\n    </div>\n  );\n};\n","import { css, cx } from '@emotion/css';\nimport * as React from 'react';\nimport AutoSizer from 'react-virtualized-auto-sizer';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { Box, useStyles2 } from '@grafana/ui';\nimport { useAlertmanager } from 'app/features/alerting/unified/state/AlertmanagerContext';\nimport { GRAFANA_RULES_SOURCE_NAME } from 'app/features/alerting/unified/utils/datasource';\n\nimport { EditorColumnHeader } from '../../../contact-points/templates/EditorColumnHeader';\nimport { TemplateEditor } from '../../TemplateEditor';\nimport { getPreviewResults } from '../../TemplatePreview';\nimport { usePreviewTemplate } from '../../usePreviewTemplate';\n\nexport function TemplateContentAndPreview({\n  payload,\n  templateContent,\n  templateName,\n  payloadFormatError,\n  setPayloadFormatError,\n  className,\n}: {\n  payload: string;\n  templateName: string;\n  payloadFormatError: string | null;\n  setPayloadFormatError: (value: React.SetStateAction<string | null>) => void;\n  className?: string;\n  templateContent: string;\n}) {\n  const styles = useStyles2(getStyles);\n\n  const { selectedAlertmanager } = useAlertmanager();\n  const isGrafanaAlertManager = selectedAlertmanager === GRAFANA_RULES_SOURCE_NAME;\n\n  const { data, error } = usePreviewTemplate(templateContent, templateName, payload, setPayloadFormatError);\n  const previewToRender = getPreviewResults(error, payloadFormatError, data);\n\n  return (\n    <div className={cx(className, styles.mainContainer)}>\n      <div className={styles.container}>\n        <EditorColumnHeader label=\"Template content\" />\n        <Box flex={1}>\n          <div className={styles.viewerContainer({ height: 400 })}>\n            <AutoSizer>\n              {({ width, height }) => (\n                <TemplateEditor\n                  value={templateContent}\n                  containerStyles={styles.editorContainer}\n                  width={width}\n                  height={height}\n                  readOnly\n                />\n              )}\n            </AutoSizer>\n          </div>\n        </Box>\n      </div>\n\n      {isGrafanaAlertManager && (\n        <div className={styles.container}>\n          <EditorColumnHeader label=\"Preview with the default payload\" />\n          <Box flex={1}>\n            <div className={styles.viewerContainer({ height: 'minHeight' })}>{previewToRender}</div>\n          </Box>\n        </div>\n      )}\n    </div>\n  );\n}\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  mainContainer: css({\n    display: 'flex',\n    flexDirection: 'column',\n    gap: theme.spacing(2),\n  }),\n  container: css({\n    label: 'template-preview-container',\n    display: 'flex',\n    flexDirection: 'column',\n    borderRadius: theme.shape.radius.default,\n    border: `1px solid ${theme.colors.border.medium}`,\n  }),\n  viewerContainer: ({ height }: { height: number | string }) =>\n    css({\n      height,\n      overflow: 'auto',\n      backgroundColor: theme.colors.background.primary,\n    }),\n  editorContainer: css({\n    width: 'fit-content',\n    border: 'none',\n  }),\n});\n","import { css, cx } from '@emotion/css';\nimport { useState, PropsWithChildren, useEffect, useMemo } from 'react';\nimport { useFormContext } from 'react-hook-form';\nimport { useCopyToClipboard } from 'react-use';\n\nimport { GrafanaTheme2, SelectableValue } from '@grafana/data';\nimport {\n  Button,\n  Drawer,\n  IconButton,\n  Input,\n  RadioButtonGroup,\n  Select,\n  Stack,\n  Text,\n  TextArea,\n  useStyles2,\n} from '@grafana/ui';\nimport {\n  trackEditInputWithTemplate,\n  trackUseCustomInputInTemplate,\n  trackUseSingleTemplateInInput,\n} from 'app/features/alerting/unified/Analytics';\nimport { templatesApi } from 'app/features/alerting/unified/api/templateApi';\nimport { useAlertmanagerConfig } from 'app/features/alerting/unified/hooks/useAlertmanagerConfig';\nimport { useAlertmanager } from 'app/features/alerting/unified/state/AlertmanagerContext';\nimport { NotificationChannelOption } from 'app/types';\n\nimport { defaultPayloadString } from '../../TemplateForm';\n\nimport { TemplateContentAndPreview } from './TemplateContentAndPreview';\nimport { getTemplateName, getUseTemplateText, matchesOnlyOneTemplate, parseTemplates } from './utils';\n\ninterface TemplatesPickerProps {\n  onSelect: (temnplate: string) => void;\n  option: NotificationChannelOption;\n  valueInForm: string;\n}\nexport function TemplatesPicker({ onSelect, option, valueInForm }: TemplatesPickerProps) {\n  const [showTemplates, setShowTemplates] = useState(false);\n  const onClick = () => {\n    setShowTemplates(true);\n    trackEditInputWithTemplate();\n  };\n  return (\n    <>\n      <Button\n        icon=\"edit\"\n        tooltip={'Edit using existing templates.'}\n        onClick={onClick}\n        variant=\"secondary\"\n        size=\"sm\"\n        aria-label={'Select available template from the list of available templates.'}\n      >\n        {`Edit ${option.label}`}\n      </Button>\n\n      {showTemplates && (\n        <Drawer title={`Edit ${option.label}`} size=\"md\" onClose={() => setShowTemplates(false)}>\n          <TemplateSelector\n            onSelect={onSelect}\n            onClose={() => setShowTemplates(false)}\n            option={option}\n            valueInForm={valueInForm}\n          />\n        </Drawer>\n      )}\n    </>\n  );\n}\n\ntype TemplateFieldOption = 'Existing' | 'Custom';\n\nexport function getTemplateOptions(templateFiles: Record<string, string>, defaultTemplates: Template[] = []) {\n  // Add default templates\n  const templateMap = new Map<string, SelectableValue<Template>>();\n  Object.entries(templateFiles).forEach(([_, content]) => {\n    const templates: Template[] = parseTemplates(content);\n    templates.forEach((template) => {\n      templateMap.set(template.name, {\n        label: template.name,\n        value: {\n          name: template.name,\n          content: template.content,\n        },\n      });\n    });\n  });\n  // Add default templates to the map\n  defaultTemplates.forEach((template) => {\n    templateMap.set(template.name, {\n      label: template.name,\n      value: {\n        name: template.name,\n        content: template.content,\n      },\n    });\n  });\n  // return the sum of default and custom templates\n  return Array.from(templateMap.values());\n}\nfunction getContentFromOptions(name: string, options: Array<SelectableValue<Template>>) {\n  const template = options.find((option) => option.label === name);\n  return template?.value?.content ?? '';\n}\n\nexport interface Template {\n  name: string;\n  content: string;\n}\ninterface TemplateSelectorProps {\n  onSelect: (template: string) => void;\n  onClose: () => void;\n  option: NotificationChannelOption;\n  valueInForm: string;\n}\nfunction TemplateSelector({ onSelect, onClose, option, valueInForm }: TemplateSelectorProps) {\n  const styles = useStyles2(getStyles);\n  const useGetDefaultTemplatesQuery = templatesApi.endpoints.getDefaultTemplates.useQuery;\n  const [template, setTemplate] = useState<Template | undefined>(undefined);\n  const [inputToUpdate, setInputToUpdate] = useState<string>('');\n  const [inputToUpdateCustom, setInputToUpdateCustom] = useState<string>(valueInForm);\n\n  const { selectedAlertmanager } = useAlertmanager();\n  const { data, error } = useAlertmanagerConfig(selectedAlertmanager);\n  const { data: defaultTemplates } = useGetDefaultTemplatesQuery();\n  const [templateOption, setTemplateOption] = useState<TemplateFieldOption>('Existing');\n  const [_, copyToClipboard] = useCopyToClipboard();\n\n  const templateOptions: Array<SelectableValue<TemplateFieldOption>> = [\n    {\n      label: 'Selecting existing template',\n      value: 'Existing',\n      description: `Select a single template and preview it, or copy it to paste it in the custom tab. ${templateOption === 'Existing' ? 'Clicking Save will save your changes to the selected template.' : ''}`,\n    },\n    {\n      label: `Enter custom ${option.label.toLowerCase()}`,\n      value: 'Custom',\n      description: `Enter custom ${option.label.toLowerCase()}. ${templateOption === 'Custom' ? 'Clicking Save will save the custom value only.' : ''}`,\n    },\n  ];\n\n  useEffect(() => {\n    if (template) {\n      setInputToUpdate(getUseTemplateText(template.name));\n    }\n  }, [template]);\n\n  function onCustomTemplateChange(customInput: string) {\n    setInputToUpdateCustom(customInput);\n  }\n\n  const onTemplateOptionChange = (option: TemplateFieldOption) => {\n    setTemplateOption(option);\n  };\n\n  const options = useMemo(() => {\n    if (!defaultTemplates) {\n      return [];\n    }\n    return getTemplateOptions(data?.template_files ?? {}, defaultTemplates);\n  }, [data, defaultTemplates]);\n\n  // if we are using only one template, we should settemplate to that template\n  useEffect(() => {\n    if (Boolean(valueInForm)) {\n      if (matchesOnlyOneTemplate(valueInForm)) {\n        const name = getTemplateName(valueInForm);\n        setTemplate({\n          name,\n          content: getContentFromOptions(name, options),\n        });\n      } else {\n        // if it's empty we default to select existing template\n        setTemplateOption('Custom');\n      }\n    }\n  }, [valueInForm, setTemplate, setTemplateOption, options]);\n\n  if (error) {\n    return <div>Error loading templates</div>;\n  }\n\n  if (!data) {\n    return <div>Loading...</div>;\n  }\n\n  return (\n    <Stack direction=\"column\" gap={1} justifyContent=\"space-between\" height=\"100%\">\n      <Stack direction=\"column\" gap={1}>\n        <RadioButtonGroup\n          options={templateOptions}\n          value={templateOption}\n          onChange={onTemplateOptionChange}\n          className={styles.templateTabOption}\n        />\n\n        {templateOption === 'Existing' ? (\n          <Stack direction=\"column\" gap={1}>\n            <Stack direction=\"row\" gap={1} alignItems=\"center\">\n              <Select<Template>\n                aria-label=\"Template\"\n                onChange={(value: SelectableValue<Template>, _) => {\n                  setTemplate(value?.value);\n                }}\n                options={options}\n                width={50}\n                value={template ? { label: template.name, value: template } : undefined}\n              />\n              <IconButton\n                tooltip=\"Copy selected template to clipboard. You can use it in the custom tab.\"\n                onClick={() => copyToClipboard(getUseTemplateText(template?.name ?? ''))}\n                name=\"copy\"\n              />\n            </Stack>\n\n            <TemplateContentAndPreview\n              templateContent={template?.content ?? ''}\n              payload={defaultPayloadString}\n              templateName={template?.name ?? ''}\n              setPayloadFormatError={() => {}}\n              className={cx(styles.templatePreview, styles.minEditorSize)}\n              payloadFormatError={null}\n            />\n          </Stack>\n        ) : (\n          <OptionCustomfield\n            option={option}\n            onCustomTemplateChange={onCustomTemplateChange}\n            initialValue={inputToUpdateCustom}\n          />\n        )}\n      </Stack>\n      <div className={styles.actions}>\n        <Button variant=\"secondary\" onClick={onClose}>\n          Cancel\n        </Button>\n        <Button\n          variant=\"primary\"\n          onClick={() => {\n            onSelect(templateOption === 'Custom' ? inputToUpdateCustom : inputToUpdate);\n            onClose();\n            if (templateOption === 'Custom') {\n              trackUseCustomInputInTemplate();\n            } else {\n              trackUseSingleTemplateInInput();\n            }\n          }}\n        >\n          Save\n        </Button>\n      </div>\n    </Stack>\n  );\n}\n\nfunction OptionCustomfield({\n  option,\n  onCustomTemplateChange,\n  initialValue,\n}: {\n  option: NotificationChannelOption;\n  onCustomTemplateChange(customInput: string): void;\n  initialValue: string;\n}) {\n  switch (option.element) {\n    case 'textarea':\n      return (\n        <Stack direction=\"row\" gap={1} alignItems=\"center\">\n          <TextArea\n            placeholder={option.placeholder}\n            onChange={(e) => onCustomTemplateChange(e.currentTarget.value)}\n            defaultValue={initialValue}\n          />\n        </Stack>\n      );\n    case 'input':\n      return (\n        <Stack direction=\"row\" gap={1} alignItems=\"center\">\n          <Input\n            type={option.inputType}\n            placeholder={option.placeholder}\n            onChange={(e) => onCustomTemplateChange(e.currentTarget.value)}\n            defaultValue={initialValue}\n          />\n        </Stack>\n      );\n    default:\n      return null;\n  }\n}\n\ninterface WrapWithTemplateSelectionProps extends PropsWithChildren {\n  useTemplates: boolean;\n  onSelectTemplate: (template: string) => void;\n  option: NotificationChannelOption;\n  name: string;\n}\nexport function WrapWithTemplateSelection({\n  useTemplates,\n  onSelectTemplate,\n  option,\n  name,\n  children,\n}: WrapWithTemplateSelectionProps) {\n  const styles = useStyles2(getStyles);\n  const { getValues } = useFormContext();\n  const value = getValues(name) ?? '';\n  // if the placeholder does not contain a template, we don't need to show the template picker\n  if (!option.placeholder.includes('{{ template ') || typeof value !== 'string') {\n    return <>{children}</>;\n  }\n  // Otherwise, we can use templates on this field\n  // if the value is empty, we only show the template picker\n  if (!value) {\n    return (\n      <div className={styles.inputContainer}>\n        <Stack direction=\"row\" gap={1} alignItems=\"center\">\n          {useTemplates && (\n            <TemplatesPicker onSelect={onSelectTemplate} option={option} valueInForm={getValues(name) ?? ''} />\n          )}\n        </Stack>\n      </div>\n    );\n  }\n  const onlyOneTemplate = value ? matchesOnlyOneTemplate(value) : false;\n  if (onlyOneTemplate) {\n    return (\n      <div className={styles.inputContainer}>\n        <Stack direction=\"row\" gap={1} alignItems=\"center\">\n          <Text variant=\"bodySmall\">{`Template: ${getTemplateName(value)}`}</Text>\n          {useTemplates && (\n            <TemplatesPicker onSelect={onSelectTemplate} option={option} valueInForm={getValues(name) ?? ''} />\n          )}\n        </Stack>\n      </div>\n    );\n  }\n  // custom template  field\n  return (\n    <div className={styles.inputContainer}>\n      <Stack direction=\"row\" gap={1} alignItems=\"center\">\n        {children}\n        {useTemplates && (\n          <TemplatesPicker onSelect={onSelectTemplate} option={option} valueInForm={getValues(name) ?? ''} />\n        )}\n      </Stack>\n    </div>\n  );\n}\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  actions: css({\n    flex: 0,\n    justifyContent: 'flex-end',\n    display: 'flex',\n    gap: theme.spacing(1),\n  }),\n  templatePreview: css({\n    flex: 1,\n    display: 'flex',\n  }),\n  templateTabOption: css({\n    width: 'fit-content',\n  }),\n  minEditorSize: css({\n    minHeight: 300,\n    minWidth: 300,\n  }),\n  inputContainer: css({\n    marginTop: theme.spacing(1.5),\n  }),\n});\n","import { css } from '@emotion/css';\nimport { isEmpty } from 'lodash';\nimport { FC, useEffect } from 'react';\nimport { Controller, DeepMap, FieldError, useFormContext } from 'react-hook-form';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { Checkbox, Field, Input, RadioButtonList, Select, TextArea, useStyles2 } from '@grafana/ui';\nimport { NotificationChannelOption } from 'app/types';\n\nimport { KeyValueMapInput } from './KeyValueMapInput';\nimport { StringArrayInput } from './StringArrayInput';\nimport { SubformArrayField } from './SubformArrayField';\nimport { SubformField } from './SubformField';\nimport { WrapWithTemplateSelection } from './TemplateSelector';\n\ninterface Props {\n  defaultValue: any;\n  option: NotificationChannelOption;\n  invalid?: boolean;\n  pathPrefix: string;\n  pathSuffix?: string;\n  error?: FieldError | DeepMap<any, FieldError>;\n  readOnly?: boolean;\n  customValidator?: (value: string) => boolean | string | Promise<boolean | string>;\n}\n\nexport const OptionField: FC<Props> = ({\n  option,\n  invalid,\n  pathPrefix,\n  pathSuffix = '',\n  error,\n  defaultValue,\n  readOnly = false,\n  customValidator,\n}) => {\n  const optionPath = `${pathPrefix}${pathSuffix}`;\n\n  if (option.element === 'subform') {\n    return (\n      <SubformField\n        readOnly={readOnly}\n        defaultValue={defaultValue}\n        option={option}\n        errors={error}\n        pathPrefix={optionPath}\n      />\n    );\n  }\n  if (option.element === 'subform_array') {\n    return (\n      <SubformArrayField\n        readOnly={readOnly}\n        defaultValues={defaultValue}\n        option={option}\n        pathPrefix={optionPath}\n        errors={error as Array<DeepMap<any, FieldError>> | undefined}\n      />\n    );\n  }\n  return (\n    <Field\n      label={option.element !== 'checkbox' && option.element !== 'radio' ? option.label : undefined}\n      description={option.description || undefined}\n      invalid={!!error}\n      error={error?.message}\n      data-testid={`${optionPath}${option.propertyName}`}\n    >\n      <OptionInput\n        id={`${optionPath}${option.propertyName}`}\n        defaultValue={defaultValue}\n        option={option}\n        invalid={invalid}\n        pathPrefix={optionPath}\n        readOnly={readOnly}\n        pathIndex={pathPrefix}\n        customValidator={customValidator}\n      />\n    </Field>\n  );\n};\n\nconst OptionInput: FC<Props & { id: string; pathIndex?: string }> = ({\n  option,\n  invalid,\n  id,\n  pathPrefix = '',\n  pathIndex = '',\n  readOnly = false,\n  customValidator,\n}) => {\n  const styles = useStyles2(getStyles);\n  const { control, register, unregister, getValues, setValue } = useFormContext();\n  const name = `${pathPrefix}${option.propertyName}`;\n\n  // workaround for https://github.com/react-hook-form/react-hook-form/issues/4993#issuecomment-829012506\n  useEffect(\n    () => () => {\n      unregister(name, { keepValue: false });\n    },\n    [unregister, name]\n  );\n\n  const useTemplates = option.placeholder.includes('{{ template');\n\n  function onSelectTemplate(template: string) {\n    setValue(name, template);\n  }\n\n  switch (option.element) {\n    case 'checkbox':\n      return (\n        <Checkbox\n          id={id}\n          readOnly={readOnly}\n          disabled={readOnly}\n          className={styles.checkbox}\n          {...register(name)}\n          label={option.label}\n          description={option.description}\n        />\n      );\n    case 'input':\n      return (\n        <WrapWithTemplateSelection\n          useTemplates={useTemplates}\n          option={option}\n          name={name}\n          onSelectTemplate={onSelectTemplate}\n        >\n          <Input\n            id={id}\n            readOnly={readOnly || useTemplates || determineReadOnly(option, getValues, pathIndex)}\n            invalid={invalid}\n            type={option.inputType}\n            {...register(name, {\n              required: determineRequired(option, getValues, pathIndex),\n              validate: {\n                validationRule: (v) =>\n                  option.validationRule ? validateOption(v, option.validationRule, option.required) : true,\n                customValidator: (v) => (customValidator ? customValidator(v) : true),\n              },\n              setValueAs: option.setValueAs,\n            })}\n            placeholder={option.placeholder}\n          />\n        </WrapWithTemplateSelection>\n      );\n\n    case 'select':\n      return (\n        <Controller\n          render={({ field: { onChange, ref, ...field } }) => (\n            <Select\n              disabled={readOnly}\n              options={option.selectOptions ?? undefined}\n              invalid={invalid}\n              onChange={(value) => onChange(value.value)}\n              {...field}\n            />\n          )}\n          control={control}\n          name={name}\n          defaultValue={option.defaultValue?.value}\n          rules={{\n            validate: {\n              customValidator: (v) => (customValidator ? customValidator(v) : true),\n            },\n          }}\n        />\n      );\n    case 'radio':\n      return (\n        <>\n          <legend className={styles.legend}>{option.label}</legend>\n          <Controller\n            render={({ field: { ref, ...field } }) => (\n              <RadioButtonList disabled={readOnly} options={option.selectOptions ?? []} {...field} />\n            )}\n            control={control}\n            defaultValue={option.defaultValue?.value}\n            name={name}\n            rules={{\n              required: option.required ? 'Option is required' : false,\n              validate: {\n                validationRule: (v) =>\n                  option.validationRule ? validateOption(v, option.validationRule, option.required) : true,\n                customValidator: (v) => (customValidator ? customValidator(v) : true),\n              },\n            }}\n          />\n        </>\n      );\n    case 'textarea':\n      return (\n        <WrapWithTemplateSelection\n          useTemplates={useTemplates}\n          option={option}\n          name={name}\n          onSelectTemplate={onSelectTemplate}\n        >\n          <TextArea\n            id={id}\n            readOnly={readOnly || useTemplates}\n            invalid={invalid}\n            placeholder={option.placeholder}\n            {...register(name, {\n              required: option.required ? 'Required' : false,\n              validate: (v) =>\n                option.validationRule !== '' ? validateOption(v, option.validationRule, option.required) : true,\n            })}\n          />\n        </WrapWithTemplateSelection>\n      );\n    case 'string_array':\n      return (\n        <Controller\n          render={({ field: { value, onChange } }) => (\n            <StringArrayInput readOnly={readOnly} value={value} onChange={onChange} />\n          )}\n          control={control}\n          name={name}\n        />\n      );\n    case 'key_value_map':\n      return (\n        <Controller\n          render={({ field: { value, onChange } }) => (\n            <KeyValueMapInput readOnly={readOnly} value={value} onChange={onChange} />\n          )}\n          control={control}\n          name={name}\n        />\n      );\n\n    default:\n      console.error('Element not supported', option.element);\n      return null;\n  }\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  checkbox: css({\n    height: 'auto', // native checkbox has fixed height which does not take into account description\n  }),\n  legend: css({\n    fontSize: theme.typography.h6.fontSize,\n  }),\n});\n\nconst validateOption = (value: string, validationRule: string, required: boolean) => {\n  if (value === '' && !required) {\n    return true;\n  }\n\n  return RegExp(validationRule).test(value) ? true : 'Invalid format';\n};\n\nconst determineRequired = (option: NotificationChannelOption, getValues: any, pathIndex: string) => {\n  if (!option.dependsOn) {\n    return option.required ? 'Required' : false;\n  }\n  if (isEmpty(getValues(`${pathIndex}secureFields`))) {\n    const dependentOn = getValues(`${pathIndex}secureSettings.${option.dependsOn}`);\n    return !Boolean(dependentOn) && option.required ? 'Required' : false;\n  } else {\n    const dependentOn: boolean = getValues(`${pathIndex}secureFields.${option.dependsOn}`);\n    return !dependentOn && option.required ? 'Required' : false;\n  }\n};\n\nconst determineReadOnly = (option: NotificationChannelOption, getValues: any, pathIndex: string) => {\n  if (!option.dependsOn) {\n    return false;\n  }\n  if (isEmpty(getValues(`${pathIndex}secureFields`))) {\n    return getValues(`${pathIndex}secureSettings.${option.dependsOn}`);\n  } else {\n    return getValues(`${pathIndex}secureFields.${option.dependsOn}`);\n  }\n};\n","import { set } from 'lodash';\nimport { useCallback } from 'react';\nimport { UseFormReturn } from 'react-hook-form';\n\ninterface Options<R> {\n  name: string;\n  formAPI: UseFormReturn<any>;\n  defaults?: R[];\n\n  // if true, sets `__deleted: true` but does not remove item from the array in values\n  softDelete?: boolean;\n}\n\nexport type ControlledField<R> = R & {\n  __deleted?: boolean;\n};\n\nconst EMPTY_ARRAY = [] as const;\n\n/*\n * react-hook-form's own useFieldArray is uncontrolled and super buggy.\n * this is a simple controlled version. It's dead simple and more robust at the cost of re-rendering the form\n * on every change to the sub forms in the array.\n * Warning: you'll have to take care of your own unique identiifer to use as `key` for the ReactNode array.\n * Using index will cause problems.\n */\nexport function useControlledFieldArray<R>(options: Options<R>) {\n  const { name, formAPI, defaults, softDelete } = options;\n  const { watch, getValues, reset, setValue } = formAPI;\n\n  const fields: Array<ControlledField<R>> = watch(name) ?? defaults ?? EMPTY_ARRAY;\n\n  const update = useCallback(\n    (updateFn: (fields: R[]) => R[]) => {\n      const values = JSON.parse(JSON.stringify(getValues()));\n      const newItems = updateFn(fields ?? []);\n      reset(set(values, name, newItems));\n    },\n    [getValues, name, reset, fields]\n  );\n\n  return {\n    fields,\n    append: useCallback((values: R) => update((fields) => [...fields, values]), [update]),\n    remove: useCallback(\n      (index: number) => {\n        if (softDelete) {\n          setValue(`${name}.${index}.__deleted`, true);\n        } else {\n          update((items) => {\n            const newItems = items.slice();\n            newItems.splice(index, 1);\n            return newItems;\n          });\n        }\n      },\n      [update, name, setValue, softDelete]\n    ),\n  };\n}\n","import { isArray, omit, pick, isNil, omitBy } from 'lodash';\n\nimport {\n  AlertManagerCortexConfig,\n  AlertmanagerReceiver,\n  GrafanaManagedContactPoint,\n  GrafanaManagedReceiverConfig,\n  Receiver,\n  Route,\n} from 'app/plugins/datasource/alertmanager/types';\nimport { CloudNotifierType, NotifierDTO, NotifierType } from 'app/types';\n\nimport {\n  CloudChannelConfig,\n  CloudChannelMap,\n  CloudChannelValues,\n  GrafanaChannelMap,\n  GrafanaChannelValues,\n  ReceiverFormValues,\n} from '../types/receiver-form';\n\nexport function grafanaReceiverToFormValues(\n  receiver: GrafanaManagedContactPoint,\n  notifiers: NotifierDTO[]\n): [ReceiverFormValues<GrafanaChannelValues>, GrafanaChannelMap] {\n  const channelMap: GrafanaChannelMap = {};\n  // giving each form receiver item a unique id so we can use it to map back to \"original\" items\n  // as well as to use as `key` prop.\n  // @TODO use uid once backend is fixed to provide it. then we can get rid of the GrafanaChannelMap\n  let idCounter = 1;\n  const values = {\n    name: receiver.name,\n    items:\n      receiver.grafana_managed_receiver_configs?.map((channel) => {\n        const id = String(idCounter++);\n        channelMap[id] = channel;\n        const notifier = notifiers.find(({ type }) => type === channel.type);\n        return grafanaChannelConfigToFormChannelValues(id, channel, notifier);\n      }) ?? [],\n  };\n  return [values, channelMap];\n}\n\nexport function cloudReceiverToFormValues(\n  receiver: Receiver,\n  notifiers: NotifierDTO[]\n): [ReceiverFormValues<CloudChannelValues>, CloudChannelMap] {\n  const channelMap: CloudChannelMap = {};\n  // giving each form receiver item a unique id so we can use it to map back to \"original\" items\n  let idCounter = 1;\n  const items: CloudChannelValues[] = Object.entries(receiver)\n    // filter out only config items that are relevant to cloud\n    .filter(([type]) => type.endsWith('_configs') && type !== 'grafana_managed_receiver_configs')\n    // map property names to cloud notifier types by removing the `_config` suffix\n    .map(([type, configs]): [CloudNotifierType, CloudChannelConfig[]] => [\n      type.replace('_configs', '') as CloudNotifierType,\n      configs,\n    ])\n    // convert channel configs to form values\n    .map(([type, configs]) =>\n      configs.map((config) => {\n        const id = String(idCounter++);\n        channelMap[id] = { type, config };\n        const notifier = notifiers.find((notifier) => notifier.type === type);\n        if (!notifier) {\n          throw new Error(`unknown cloud notifier: ${type}`);\n        }\n        return cloudChannelConfigToFormChannelValues(id, type, config);\n      })\n    )\n    .flat();\n  const values = {\n    name: receiver.name,\n    items,\n  };\n  return [values, channelMap];\n}\n\nexport function formValuesToGrafanaReceiver(\n  values: ReceiverFormValues<GrafanaChannelValues>,\n  channelMap: GrafanaChannelMap,\n  defaultChannelValues: GrafanaChannelValues,\n  notifiers: NotifierDTO[]\n): Receiver {\n  return {\n    name: values.name,\n    grafana_managed_receiver_configs: (values.items ?? []).map((channelValues) => {\n      const existing: GrafanaManagedReceiverConfig | undefined = channelMap[channelValues.__id];\n      const notifier = notifiers.find((notifier) => notifier.type === channelValues.type);\n\n      return formChannelValuesToGrafanaChannelConfig(\n        channelValues,\n        defaultChannelValues,\n        values.name,\n        existing,\n        notifier\n      );\n    }),\n  };\n}\n\nexport function formValuesToCloudReceiver(\n  values: ReceiverFormValues<CloudChannelValues>,\n  defaults: CloudChannelValues\n): Receiver {\n  const recv: AlertmanagerReceiver = {\n    name: values.name,\n  };\n  values.items.forEach(({ __id, type, settings, sendResolved }) => {\n    const channel = omitEmptyValues({\n      ...omitTemporaryIdentifiers(settings),\n      send_resolved: sendResolved ?? defaults.sendResolved,\n    });\n\n    if (!(`${type}_configs` in recv)) {\n      recv[`${type}_configs`] = [channel];\n    } else {\n      recv[`${type}_configs`]?.push(channel);\n    }\n  });\n  return recv;\n}\n\n// will add new receiver, or replace exisitng one\nexport function updateConfigWithReceiver(\n  config: AlertManagerCortexConfig,\n  receiver: Receiver,\n  replaceReceiverName?: string\n): AlertManagerCortexConfig {\n  const oldReceivers = config.alertmanager_config.receivers ?? [];\n\n  // sanity check that name is not duplicated\n  if (receiver.name !== replaceReceiverName && !!oldReceivers.find(({ name }) => name === receiver.name)) {\n    throw new Error(`Duplicate receiver name ${receiver.name}`);\n  }\n\n  // sanity check that existing receiver exists\n  if (replaceReceiverName && !oldReceivers.find(({ name }) => name === replaceReceiverName)) {\n    throw new Error(`Expected receiver ${replaceReceiverName} to exist, but did not find it in the config`);\n  }\n\n  const updated: AlertManagerCortexConfig = {\n    ...config,\n    alertmanager_config: {\n      // @todo rename receiver on routes as necessary\n      ...config.alertmanager_config,\n      receivers: replaceReceiverName\n        ? oldReceivers.map((existingReceiver) =>\n            existingReceiver.name === replaceReceiverName ? receiver : existingReceiver\n          )\n        : [...oldReceivers, receiver],\n    },\n  };\n\n  // if receiver was renamed, rename it in routes as well\n  if (updated.alertmanager_config.route && replaceReceiverName && receiver.name !== replaceReceiverName) {\n    updated.alertmanager_config.route = renameReceiverInRoute(\n      updated.alertmanager_config.route,\n      replaceReceiverName,\n      receiver.name\n    );\n  }\n\n  return updated;\n}\n\nfunction renameReceiverInRoute(route: Route, oldName: string, newName: string) {\n  const updated: Route = {\n    ...route,\n  };\n  if (updated.receiver === oldName) {\n    updated.receiver = newName;\n  }\n  if (updated.routes) {\n    updated.routes = updated.routes.map((route) => renameReceiverInRoute(route, oldName, newName));\n  }\n  return updated;\n}\n\nfunction cloudChannelConfigToFormChannelValues(\n  id: string,\n  type: CloudNotifierType,\n  channel: CloudChannelConfig\n): CloudChannelValues {\n  return {\n    __id: id,\n    type,\n    settings: {\n      ...channel,\n    },\n    secureFields: {},\n    secureSettings: {},\n    sendResolved: channel.send_resolved,\n  };\n}\n\nfunction grafanaChannelConfigToFormChannelValues(\n  id: string,\n  channel: GrafanaManagedReceiverConfig,\n  notifier?: NotifierDTO\n): GrafanaChannelValues {\n  const values: GrafanaChannelValues = {\n    __id: id,\n    type: channel.type as NotifierType,\n    provenance: channel.provenance,\n    secureSettings: {},\n    settings: { ...channel.settings },\n    secureFields: { ...channel.secureFields },\n    disableResolveMessage: channel.disableResolveMessage,\n  };\n\n  // work around https://github.com/grafana/alerting-squad/issues/100\n  notifier?.options.forEach((option) => {\n    if (option.secure && values.secureSettings[option.propertyName]) {\n      delete values.settings[option.propertyName];\n      values.secureFields[option.propertyName] = true;\n    }\n    if (option.secure && values.settings[option.propertyName]) {\n      values.secureSettings[option.propertyName] = values.settings[option.propertyName];\n      delete values.settings[option.propertyName];\n    }\n  });\n\n  return values;\n}\n\nexport function formChannelValuesToGrafanaChannelConfig(\n  values: GrafanaChannelValues,\n  defaults: GrafanaChannelValues,\n  name: string,\n  existing?: GrafanaManagedReceiverConfig,\n  notifier?: NotifierDTO\n): GrafanaManagedReceiverConfig {\n  const channel: GrafanaManagedReceiverConfig = {\n    settings: omitEmptyValues({\n      ...(existing && existing.type === values.type ? (existing.settings ?? {}) : {}),\n      ...(values.settings ?? {}),\n    }),\n    secureSettings: omitEmptyUnlessExisting(values.secureSettings, existing?.secureFields),\n    type: values.type,\n    name,\n    disableResolveMessage:\n      values.disableResolveMessage ?? existing?.disableResolveMessage ?? defaults.disableResolveMessage,\n  };\n\n  // find all secure field definitions\n  const secureFieldNames: string[] =\n    notifier?.options.filter((option) => option.secure).map((option) => option.propertyName) ?? [];\n\n  // we make sure all fields that are marked as \"secure\" will be moved to \"SecureSettings\" instead of \"settings\"\n  const shouldBeSecure = pick(channel.settings, secureFieldNames);\n  channel.secureSettings = {\n    ...shouldBeSecure,\n    ...channel.secureSettings,\n  };\n\n  // remove the secure ones from the regular settings\n  channel.settings = omit(channel.settings, secureFieldNames);\n\n  if (existing) {\n    channel.uid = existing.uid;\n  }\n\n  return channel;\n}\n\n// null, undefined and '' are deemed unacceptable\nconst isUnacceptableValue = (value: unknown) => isNil(value) || value === '';\n\n// will remove properties that have empty ('', null, undefined) object properties.\n// traverses nested objects and arrays as well. in place, mutates the object.\n// this is needed because form will submit empty string for not filled in fields,\n// but for cloud alertmanager receiver config to use global default value the property must be omitted entirely\n// this isn't a perfect solution though. No way for user to intentionally provide an empty string. Will need rethinking later\nexport function omitEmptyValues<T>(obj: T): T {\n  if (isArray(obj)) {\n    obj.forEach(omitEmptyValues);\n  } else if (typeof obj === 'object' && obj !== null) {\n    Object.entries(obj).forEach(([key, value]) => {\n      if (isUnacceptableValue(value)) {\n        delete (obj as any)[key];\n      } else {\n        omitEmptyValues(value);\n      }\n    });\n  }\n  return obj;\n}\n\n// Will remove empty ('', null, undefined) object properties unless they were previously defined.\n// existing is a map of property names that were previously defined.\nexport function omitEmptyUnlessExisting(settings = {}, existing = {}): Record<string, unknown> {\n  return omitBy(settings, (value, key) => isUnacceptableValue(value) && !(key in existing));\n}\n\nexport function omitTemporaryIdentifiers<T>(object: Readonly<T>): T {\n  function omitIdentifiers<T>(obj: T) {\n    if (isArray(obj)) {\n      obj.forEach(omitIdentifiers);\n    } else if (typeof obj === 'object' && obj !== null) {\n      if ('__id' in obj) {\n        delete obj.__id;\n      }\n      Object.values(obj).forEach(omitIdentifiers);\n    }\n  }\n\n  const objectCopy = structuredClone(object);\n  omitIdentifiers(objectCopy);\n\n  return objectCopy;\n}\n"],"names":["CollapsibleSection","label","description","children","className","size","styles","getStyles","isCollapsed","setIsCollapsed","toggleCollapse","theme","KeyValueMapInput","value","onChange","readOnly","pairs","setPairs","recordToPairs","emitChange","pairsToRecord","deleteItem","index","newPairs","removed","updatePair","values","old","pair","i","key","Input","e","ActionIcon","Button","record","obj","StringArrayInput","newValue","updateValue","itemValue","v","getReceiverFormFieldStyles","SubformArrayField","option","pathPrefix","errors","defaultValues","path","formAPI","fields","append","remove","useControlledFieldArray","field","itemIndex","OptionField","SubformField","defaultValue","name","watch","_watchValue","show","setShow","subOption","TemplateContentAndPreview","payload","templateContent","templateName","payloadFormatError","setPayloadFormatError","selectedAlertmanager","isGrafanaAlertManager","data","error","usePreviewTemplate","previewToRender","EditorColumnHeader","Box","width","height","TemplateEditor","TemplatesPicker","onSelect","valueInForm","showTemplates","setShowTemplates","onClick","Drawer","TemplateSelector","getTemplateOptions","templateFiles","defaultTemplates","templateMap","_","content","template","getContentFromOptions","options","onClose","useGetDefaultTemplatesQuery","setTemplate","inputToUpdate","setInputToUpdate","inputToUpdateCustom","setInputToUpdateCustom","useAlertmanagerConfig","templateOption","setTemplateOption","copyToClipboard","useCopyToClipboard","templateOptions","onCustomTemplateChange","customInput","onTemplateOptionChange","Stack","RadioButtonGroup","Select","IconButton","OptionCustomfield","initialValue","TextArea","WrapWithTemplateSelection","useTemplates","onSelectTemplate","getValues","Text","invalid","pathSuffix","customValidator","optionPath","Field","OptionInput","id","pathIndex","control","register","unregister","setValue","Checkbox","determineReadOnly","determineRequired","validateOption","ref","RadioButtonList","validationRule","required","EMPTY_ARRAY","defaults","softDelete","reset","update","updateFn","newItems","items","grafanaReceiverToFormValues","receiver","notifiers","channelMap","idCounter","channel","notifier","type","grafanaChannelConfigToFormChannelValues","cloudReceiverToFormValues","configs","config","cloudChannelConfigToFormChannelValues","formValuesToGrafanaReceiver","defaultChannelValues","channelValues","existing","formChannelValuesToGrafanaChannelConfig","formValuesToCloudReceiver","recv","__id","settings","sendResolved","omitEmptyValues","omitTemporaryIdentifiers","updateConfigWithReceiver","replaceReceiverName","oldReceivers","updated","existingReceiver","renameReceiverInRoute","route","oldName","newName","omitEmptyUnlessExisting","secureFieldNames","shouldBeSecure","isUnacceptableValue","object","omitIdentifiers","objectCopy"],"sourceRoot":""}