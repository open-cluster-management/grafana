"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[7197],{20302:(gs,N,e)=>{e.r(N),e.d(N,{default:()=>ds});var a=e(74848),E=e(32264),t=e(32196),h=e(96540),v=e(64388),b=e(13544),k=e(80943),g=e(40845),S=e(67061),G=e(14578),y=e(69444),O=e(39419);const U="https://grafana.com/?src=grafananet&cnt=public-dashboards",B="public/img/grafana_text_logo_light.svg",M="public/img/grafana_text_logo_dark.svg",L="grafana-logo",C=s=>{const o=(0,g.$j)(),r=(0,g.of)(H),{footerHide:c,footerText:n,footerLink:d,footerLogo:l,headerLogoHide:u}=s||{footerHide:!1,footerText:"Powered by",footerLogo:L,footerLink:U,headerLogoHide:!1};return{footerHide:c,footerText:(0,a.jsx)("span",{className:r.text,children:n}),footerLogo:l===L?o.isDark?B:M:l,footerLink:d,headerLogoHide:u}};let P=()=>C();function fs(s){P=()=>C(s)}const H=s=>({text:(0,t.css)({color:s.colors.text.secondary,fontSize:s.typography.body.fontSize})}),Y=b.Tp.pages.PublicDashboard,A=function(){const s=(0,g.of)($),o=P();return o.footerHide?null:(0,a.jsx)("div",{className:s.footer,"data-testid":Y.footer,children:(0,a.jsxs)("a",{className:s.link,href:o.footerLink,target:"_blank",rel:"noreferrer noopener",children:[o.footerText," ",(0,a.jsx)("img",{className:s.logoImg,alt:"",src:o.footerLogo})]})})},$=s=>({footer:(0,t.css)({display:"flex",justifyContent:"end",height:"30px",backgroundColor:s.colors.background.canvas,position:"sticky",bottom:0,zIndex:s.zIndex.navbarFixed,padding:s.spacing(.5,0)}),link:(0,t.css)({display:"flex",alignItems:"center"}),logoImg:(0,t.css)({height:"16px",marginLeft:s.spacing(.5)})});var j=e(19361),Z=e(20851);const D=b.Tp.pages.PublicDashboard.NotAvailable,m=({paused:s})=>{const o=(0,g.of)(K),r=(0,g.of)(Z.YO),c=j.M.LoginBoxBackground();return(0,a.jsx)(j.M.LoginBackground,{className:o.container,"data-testid":D.container,children:(0,a.jsxs)("div",{className:(0,t.cx)(o.box,c),children:[(0,a.jsx)(j.M.LoginLogo,{className:r.loginLogo}),(0,a.jsx)("p",{className:o.title,"data-testid":D.title,children:s?"This dashboard has been paused by the administrator":"The dashboard your are trying to access does not exist"}),s&&(0,a.jsx)("p",{className:o.description,"data-testid":D.pausedDescription,children:"Try again later"})]})})},K=s=>({container:(0,t.css)({display:"flex",justifyContent:"center",alignItems:"center",height:"100%",":before":{opacity:1}}),box:(0,t.css)({width:"608px",display:"flex",alignItems:"center",flexDirection:"column",gap:s.spacing(4),zIndex:1,borderRadius:s.shape.borderRadius(4),padding:s.spacing(6,8),opacity:1}),title:(0,t.css)({fontSize:s.typography.h3.fontSize,textAlign:"center",margin:0}),description:(0,t.css)({fontSize:s.typography.h5.fontSize,margin:0})});var V=e(95425),J=e(72255);const I=b.Tp.pages.PublicDashboardScene;function Q({match:s,route:o}){const r=(0,J.sP)(),c=(0,g.of)(F),{dashboard:n,isLoading:d,loadError:l}=r.useState();return(0,h.useEffect)(()=>(r.loadDashboard({uid:s.params.accessToken,route:V.Z4.Public}),()=>{r.clearState()}),[r,s.params.accessToken,o.routeName]),n?n.state.meta.publicDashboardEnabled===!1?(0,a.jsx)(m,{paused:!0}):n.state.meta.dashboardNotFound?(0,a.jsx)(m,{}):n.state.controls?.state.hideTimeControls?(0,a.jsx)(R,{model:n}):(0,a.jsx)(k.$L,{scene:n,children:(0,a.jsx)(R,{model:n})}):(0,a.jsxs)(y.Y,{layout:v.k.Custom,className:c.loadingPage,"data-testid":I.loadingPage,children:[d&&(0,a.jsx)(O.A,{}),l&&(0,a.jsx)("h2",{children:l})]})}function R({model:s}){const[o,r]=(0,h.useState)(!1),{controls:c,title:n}=s.useState(),{timePicker:d,refreshPicker:l,hideTimeControls:u}=c.useState(),f=s.getBodyToRender(),i=(0,g.of)(F);return(0,h.useEffect)(()=>(r(!0),s.activate()),[s]),o?(0,a.jsxs)(y.Y,{layout:v.k.Custom,className:i.page,"data-testid":I.page,children:[(0,a.jsxs)("div",{className:i.controls,children:[(0,a.jsxs)(S.B,{alignItems:"center",children:[(0,a.jsx)("div",{className:i.iconTitle,children:(0,a.jsx)(G.I,{name:"grafana",size:"lg","aria-hidden":!0})}),(0,a.jsx)("span",{className:i.title,children:n})]}),!u&&(0,a.jsxs)(S.B,{children:[(0,a.jsx)(d.Component,{model:d}),(0,a.jsx)(l.Component,{model:l})]})]}),(0,a.jsx)("div",{className:i.body,children:(0,a.jsx)(f.Component,{model:f})}),(0,a.jsx)(A,{})]}):null}function F(s){return{loadingPage:(0,t.css)({justifyContent:"center"}),page:(0,t.css)({padding:s.spacing(0,2)}),controls:(0,t.css)({display:"flex",justifyContent:"space-between",alignItems:"center",position:"sticky",top:0,zIndex:s.zIndex.navbarFixed,background:s.colors.background.canvas,padding:s.spacing(2,0),[s.breakpoints.down("sm")]:{flexDirection:"column",gap:s.spacing(1),alignItems:"stretch"}}),iconTitle:(0,t.css)({display:"none",[s.breakpoints.up("sm")]:{display:"flex",alignItems:"center"}}),title:(0,t.css)({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"flex",fontSize:s.typography.h4.fontSize,margin:0}),body:(0,t.css)({label:"body",flex:1,overflowY:"auto"})}}var W=e(84596),X=e(95247),w=e(76888),q=e(81862),T=e(31678),_=e(62367),ss=e(82138),as=e(9980),es=e(2118),z=e(74856),os=e(20470);const ts=b.Tp.pages.PublicDashboard,ns=({dashboard:s})=>{const o=(0,T.useDispatch)(),r=P(),c=n=>{o((0,q.Cj)(n))};return(0,a.jsx)(X.d,{title:s.title,pageIcon:r.headerLogoHide?void 0:"grafana",buttonOverflowAlignment:"right",children:!s.timepicker.hidden&&(0,a.jsx)(_.$,{dashboard:s,onChangeTimeZone:c})})},rs=s=>{const{match:o,route:r,location:c}=s,n=(0,T.useDispatch)(),d=(0,w.Il)(),l=(0,W.A)(s),u=(0,g.of)(is),f=(0,T.useSelector)(x=>x.dashboard),i=f.getModel();return(0,h.useEffect)(()=>{n((0,os.vR)({routeName:r.routeName,fixUrl:!1,accessToken:o.params.accessToken,keybindingSrv:d.keybindings}))},[r.routeName,o.params.accessToken,d.keybindings,n]),(0,h.useEffect)(()=>{if(l?.location.search!==c.search){const x=l?.queryParams,p=s.queryParams;(p?.from!==x?.from||p?.to!==x?.to)&&!i?.timepicker.hidden&&(0,z.jG)().updateTimeRangeFromUrl(),!x?.refresh&&p?.refresh&&(0,z.jG)().setAutoRefresh(p.refresh)}},[l,c.search,s.queryParams,i?.timepicker.hidden,o.params.accessToken]),i?i.meta.publicDashboardEnabled===!1?(0,a.jsx)(m,{paused:!0}):i.meta.dashboardNotFound?(0,a.jsx)(m,{}):(0,a.jsxs)(y.Y,{pageNav:{text:i.title},layout:v.k.Custom,"data-testid":ts.page,children:[(0,a.jsx)(ns,{dashboard:i}),f.initError&&(0,a.jsx)(ss.y,{initError:f.initError}),(0,a.jsx)("div",{className:u.gridContainer,children:(0,a.jsx)(es.N,{dashboard:i,isEditable:!1,viewPanel:null,editPanel:null,hidePanelMenus:!0})}),(0,a.jsx)("div",{className:u.footer,children:(0,a.jsx)(A,{})})]}):(0,a.jsx)(as.P,{initPhase:f.initPhase})},is=s=>({gridContainer:(0,t.css)({flex:1,padding:s.spacing(2,2,2,2),overflow:"auto"}),footer:(0,t.css)({padding:s.spacing(0,2)})}),cs=rs;function ls(s){return E.$.featureToggles.publicDashboardsScene?(0,a.jsx)(Q,{...s}):(0,a.jsx)(cs,{...s})}const ds=ls}}]);

//# sourceMappingURL=PublicDashboardPage.177b18c07532439f8d98.js.map